(function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=132)})([function(module){var g=function(){return this}();try{g=g||Function('return this')()||(1,eval)('this')}catch(e){'object'==typeof window&&(g=window)}module.exports=g},function(module){module.exports=function clone(obj){return JSON.parse(JSON.stringify(obj))}},function(module){module.exports.getS3FileUrl=function getS3FileUrl(id,name){return`${'https://saber.supermedium.com'}/${id}-${name}?v=1`}},function(module){var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString;module.exports=function forEach(obj,fn,ctx){if('[object Function]'!==toString.call(fn))throw new TypeError('iterator must be a function');var l=obj.length;if(l===+l)for(var i=0;i<l;i++)fn.call(ctx,obj[i],i,obj);else for(var k in obj)hasOwn.call(obj,k)&&fn.call(ctx,obj[k],k,obj)}},function(module,exports,__webpack_require__){'use strict';function AlgoliaSearchError(message,extraProperties){var forEach=__webpack_require__(3),error=this;'function'==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):error.stack=new Error().stack||'Cannot get a stacktrace, browser is too old',this.name='AlgoliaSearchError',this.message=message||'Unknown error',extraProperties&&forEach(extraProperties,function addToErrorObject(value,key){error[key]=value})}function createCustomError(name,message){function AlgoliaSearchCustomError(){var args=Array.prototype.slice.call(arguments,0);'string'!=typeof args[0]&&args.unshift(message),AlgoliaSearchError.apply(this,args),this.name='AlgoliaSearch'+name+'Error'}return inherits(AlgoliaSearchCustomError,AlgoliaSearchError),AlgoliaSearchCustomError}var inherits=__webpack_require__(18);inherits(AlgoliaSearchError,Error),module.exports={AlgoliaSearchError:AlgoliaSearchError,UnparsableJSON:createCustomError('UnparsableJSON','Could not parse the incoming response as JSON, see err.more for details'),RequestTimeout:createCustomError('RequestTimeout','Request timedout before getting a response'),Network:createCustomError('Network','Network issue, see err.more for details'),JSONPScriptFail:createCustomError('JSONPScriptFail','<script> was loaded but did not call our provided callback'),JSONPScriptError:createCustomError('JSONPScriptError','<script> unable to load due to an `error` event on it'),Unknown:createCustomError('Unknown','Unknown error occured')}},function(module,exports,__webpack_require__){var foreach=__webpack_require__(3);module.exports=function map(arr,fn){var newArr=[];return foreach(arr,function(item,itemIndex){newArr.push(fn(item,itemIndex,arr))}),newArr}},function(module){module.exports={OFF:'#111',RED:'#ff3a7b',BLUE:'#08bfa2',UI_ACCENT:'#08bfa2',UI_ACCENT2:'#f01978',SKY_OFF:'#297547',SKY_BLUE:'#840d42',SKY_RED:'#154136',BG_OFF:'#081a0f',BG_BLUE:'#379f5e',BG_BRIGHTBLUE:'#4fd983',BG_RED:'#ff1f81',BG_BRIGHTRED:'#ff6bb0',NEON_OFF:'#000',NEON_BLUE:'#008a70',NEON_BRIGHTBLUE:'#87c2ff',NEON_RED:'#f01978',NEON_BRIGHTRED:'#ff70b5',TEXT_OFF:'#000',TEXT_NORMAL:'#444',TEXT_BOLD:'#888',BEAT_RED:'#660338',BEAT_BLUE:'#036657',MINE_RED:'#1c060e',MINE_RED_EMISSION:'#2a0d1b',MINE_BLUE:'#011114',MINE_BLUE_EMISSION:'#072020'}},function(module,exports,__webpack_require__){function load(){var r;try{r=exports.storage.debug}catch(e){}return r}exports=module.exports=__webpack_require__(138),exports.log=function log(){return'object'==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},exports.formatArgs=function formatArgs(){var args=arguments,useColors=this.useColors;if(args[0]=(useColors?'%c':'')+this.namespace+(useColors?' %c':' ')+args[0]+(useColors?'%c ':' '),!useColors)return args;var c='color: '+this.color;args=[args[0],c,'color: inherit'].concat(Array.prototype.slice.call(args,1));var index=0,lastC=0;return args[0].replace(/%[a-z%]/g,function(match){'%%'===match||(index++,'%c'===match&&(lastC=index))}),args.splice(lastC,0,c),args},exports.save=function save(namespaces){try{null==namespaces?exports.storage.removeItem('debug'):exports.storage.debug=namespaces}catch(e){}},exports.load=load,exports.useColors=function useColors(){return'WebkitAppearance'in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)},exports.storage='undefined'!=typeof chrome&&'undefined'!=typeof chrome.storage?chrome.storage.local:function localstorage(){try{return window.localStorage}catch(e){}}(),exports.colors=['lightseagreen','forestgreen','goldenrod','dodgerblue','darkorchid','crimson'],exports.formatters.j=function(v){return JSON.stringify(v)},exports.enable(load())},function(module){module.exports=Array.isArray||function(arr){return'[object Array]'==Object.prototype.toString.call(arr)}},function(module){function defaultSetTimout(){throw new Error('setTimeout has not been defined')}function defaultClearTimeout(){throw new Error('clearTimeout has not been defined')}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;(function(){try{cachedSetTimeout='function'==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout='function'==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}})();var queue=[],draining=!1,queueIndex=-1,currentQueue;process.nextTick=function(fun){var args=Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title='browser',process.browser=!0,process.env={},process.argv=[],process.version='',process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(){return[]},process.binding=function(){throw new Error('process.binding is not supported')},process.cwd=function(){return'/'},process.chdir=function(){throw new Error('process.chdir is not supported')},process.umask=function(){return 0}},function(module,__webpack_exports__){'use strict';const BEAT_WARMUP_SPEED=155;__webpack_exports__.a=BEAT_WARMUP_SPEED;__webpack_exports__.b=1e3*(25/BEAT_WARMUP_SPEED)},function(module){function getGridUvs(row,column,totalRows,totalColumns){const columnWidth=1/totalColumns,rowHeight=1/totalRows;return uvs[0].set(columnWidth*column,rowHeight*row+rowHeight),uvs[1].set(columnWidth*column,rowHeight*row),uvs[2].set(columnWidth*column+columnWidth,rowHeight*row),uvs[3].set(columnWidth*column+columnWidth,rowHeight*row+rowHeight),uvs}var uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2,new THREE.Vector2];AFRAME.registerComponent('atlas-uvs',{dependencies:['geometry'],schema:{totalColumns:{type:'int',default:1},totalRows:{type:'int',default:1},column:{type:'int',default:1},row:{type:'int',default:1}},update:function(){const data=this.data,uvs=getGridUvs(data.row-1,data.column-1,data.totalRows,data.totalColumns),geometry=this.el.getObject3D('mesh').geometry;geometry.faceVertexUvs[0][0][0].copy(uvs[0]),geometry.faceVertexUvs[0][0][1].copy(uvs[1]),geometry.faceVertexUvs[0][0][2].copy(uvs[3]),geometry.faceVertexUvs[0][1][0].copy(uvs[1]),geometry.faceVertexUvs[0][1][1].copy(uvs[2]),geometry.faceVertexUvs[0][1][2].copy(uvs[3]),geometry.uvsNeedUpdate=!0}}),AFRAME.registerComponent('dynamic-texture-atlas',{schema:{canvasId:{default:'dynamicAtlas'},canvasHeight:{default:1024},canvasWidth:{default:1024},debug:{default:!1},numColumns:{default:8},numRows:{default:8}},multiple:!0,init:function(){const canvas=this.canvas=document.createElement('canvas');canvas.id=this.data.canvasId,canvas.height=this.data.canvasHeight,canvas.width=this.data.canvasWidth,this.ctx=canvas.getContext('2d'),document.body.appendChild(canvas),this.data.debug&&(canvas.style.left=0,canvas.style.top=0,canvas.style.position='fixed',canvas.style.zIndex=9999999999)},drawTexture:function(image,row,column,width,height){const canvas=this.canvas,data=this.data;image.complete||(image.onload=()=>{this.drawTexture(image,row,column)});const gridHeight=height||canvas.height/data.numRows,gridWidth=width||canvas.width/data.numColumns;return this.ctx.drawImage(image,gridWidth*row,gridWidth*column,gridWidth,gridHeight),getGridUvs(row,column,data.numRows,data.numColumns)}}),module.exports.getGridUvs=getGridUvs},function(){THREE.BufferGeometryUtils={computeTangents:function(geometry){function handleTriangle(a,b,c){vA.fromArray(positions,3*a),vB.fromArray(positions,3*b),vC.fromArray(positions,3*c),uvA.fromArray(uvs,2*a),uvB.fromArray(uvs,2*b),uvC.fromArray(uvs,2*c);var x1=vB.x-vA.x,x2=vC.x-vA.x,y1=vB.y-vA.y,y2=vC.y-vA.y,z1=vB.z-vA.z,z2=vC.z-vA.z,s1=uvB.x-uvA.x,s2=uvC.x-uvA.x,t1=uvB.y-uvA.y,t2=uvC.y-uvA.y,r=1/(s1*t2-s2*t1);sdir.set((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r),tdir.set((s1*x2-s2*x1)*r,(s1*y2-s2*y1)*r,(s1*z2-s2*z1)*r),tan1[a].add(sdir),tan1[b].add(sdir),tan1[c].add(sdir),tan2[a].add(tdir),tan2[b].add(tdir),tan2[c].add(tdir)}function handleVertex(v){n.fromArray(normals,3*v),n2.copy(n),t=tan1[v],tmp.copy(t),tmp.sub(n.multiplyScalar(n.dot(t))).normalize(),tmp2.crossVectors(n2,t),test=tmp2.dot(tan2[v]),w=0>test?-1:1,tangents[4*v]=tmp.x,tangents[4*v+1]=tmp.y,tangents[4*v+2]=tmp.z,tangents[4*v+3]=w}var index=geometry.index,attributes=geometry.attributes;if(null===index||void 0===attributes.position||void 0===attributes.normal||void 0===attributes.uv)return void console.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');var indices=index.array,positions=attributes.position.array,normals=attributes.normal.array,uvs=attributes.uv.array,nVertices=positions.length/3;attributes.tangent===void 0&&geometry.addAttribute('tangent',new THREE.BufferAttribute(new Float32Array(4*nVertices),4));for(var tangents=attributes.tangent.array,tan1=[],tan2=[],k=0;k<nVertices;k++)tan1[k]=new THREE.Vector3,tan2[k]=new THREE.Vector3;var vA=new THREE.Vector3,vB=new THREE.Vector3,vC=new THREE.Vector3,uvA=new THREE.Vector2,uvB=new THREE.Vector2,uvC=new THREE.Vector2,sdir=new THREE.Vector3,tdir=new THREE.Vector3,groups=geometry.groups;0===groups.length&&(groups=[{start:0,count:indices.length}]);for(var j=0,jl=groups.length;j<jl;++j)for(var group=groups[j],start=group.start,count=group.count,i=start,il=start+count;i<il;i+=3)handleTriangle(indices[i+0],indices[i+1],indices[i+2]);for(var tmp=new THREE.Vector3,tmp2=new THREE.Vector3,n=new THREE.Vector3,n2=new THREE.Vector3,j=0,jl=groups.length,w,t,test;j<jl;++j)for(var group=groups[j],start=group.start,count=group.count,i=start,il=start+count;i<il;i+=3)handleVertex(indices[i+0]),handleVertex(indices[i+1]),handleVertex(indices[i+2])},mergeBufferGeometries:function(geometries,useGroups){for(var isIndexed=null!==geometries[0].index,attributesUsed=new Set(Object.keys(geometries[0].attributes)),morphAttributesUsed=new Set(Object.keys(geometries[0].morphAttributes)),attributes={},morphAttributes={},mergedGeometry=new THREE.BufferGeometry,offset=0,i=0,geometry;i<geometries.length;++i){if(geometry=geometries[i],isIndexed!=(null!==geometry.index))return null;for(var name in geometry.attributes){if(!attributesUsed.has(name))return null;void 0===attributes[name]&&(attributes[name]=[]),attributes[name].push(geometry.attributes[name])}for(var name in geometry.morphAttributes){if(!morphAttributesUsed.has(name))return null;void 0===morphAttributes[name]&&(morphAttributes[name]=[]),morphAttributes[name].push(geometry.morphAttributes[name])}if(mergedGeometry.userData.mergedUserData=mergedGeometry.userData.mergedUserData||[],mergedGeometry.userData.mergedUserData.push(geometry.userData),useGroups){var count;if(isIndexed)count=geometry.index.count;else if(void 0!==geometry.attributes.position)count=geometry.attributes.position.count;else return null;mergedGeometry.addGroup(offset,count,i),offset+=count}}if(isIndexed){for(var indexOffset=0,indexList=[],i=0,index;i<geometries.length;++i){if(index=geometries[i].index,0<indexOffset){index=index.clone();for(var j=0;j<index.count;++j)index.setX(j,index.getX(j)+indexOffset)}indexList.push(index),indexOffset+=geometries[i].attributes.position.count}var mergedIndex=this.mergeBufferAttributes(indexList);if(!mergedIndex)return null;mergedGeometry.index=mergedIndex}for(var name in attributes){var mergedAttribute=this.mergeBufferAttributes(attributes[name]);if(!mergedAttribute)return null;mergedGeometry.addAttribute(name,mergedAttribute)}for(var name in morphAttributes){var numMorphTargets=morphAttributes[name][0].length;if(0===numMorphTargets)break;mergedGeometry.morphAttributes=mergedGeometry.morphAttributes||{},mergedGeometry.morphAttributes[name]=[];for(var i=0,morphAttributesToMerge;i<numMorphTargets;++i){morphAttributesToMerge=[];for(var j=0;j<morphAttributes[name].length;++j)morphAttributesToMerge.push(morphAttributes[name][j][i]);var mergedMorphAttribute=this.mergeBufferAttributes(morphAttributesToMerge);if(!mergedMorphAttribute)return null;mergedGeometry.morphAttributes[name].push(mergedMorphAttribute)}}return mergedGeometry},mergeBufferAttributes:function(attributes){for(var arrayLength=0,i=0,TypedArray,itemSize,normalized,attribute;i<attributes.length;++i){if(attribute=attributes[i],attribute.isInterleavedBufferAttribute)return null;if(void 0==TypedArray&&(TypedArray=attribute.array.constructor),TypedArray!==attribute.array.constructor)return null;if(void 0==itemSize&&(itemSize=attribute.itemSize),itemSize!==attribute.itemSize)return null;if(void 0==normalized&&(normalized=attribute.normalized),normalized!==attribute.normalized)return null;arrayLength+=attribute.array.length}for(var array=new TypedArray(arrayLength),offset=0,j=0;j<attributes.length;++j)array.set(attributes[j].array,offset),offset+=attributes[j].array.length;return new THREE.BufferAttribute(array,itemSize,normalized)}}},function(module,exports,__webpack_require__){'use strict';function createFirebaseNamespace(){function app(name){return name=name||DEFAULT_ENTRY_NAME,contains(apps_,name)||error('no-app',{name:name}),apps_[name]}function getApps(){return Object.keys(apps_).map(function(name){return apps_[name]})}function callAppHooks(app,eventName){Object.keys(factories).forEach(function(serviceName){var factoryName=useAsService(app,serviceName);null===factoryName||appHooks[factoryName]&&appHooks[factoryName](eventName,app)})}function useAsService(app,name){if('serverAuth'===name)return null;app.options;return name}var apps_={},factories={},appHooks={},namespace={__esModule:!0,initializeApp:function initializeApp(options,rawConfig){if(void 0===rawConfig&&(rawConfig={}),'object'!=typeof rawConfig||null===rawConfig){var name_1=rawConfig;rawConfig={name:name_1}}var config=rawConfig;void 0===config.name&&(config.name=DEFAULT_ENTRY_NAME);var name=config.name;'string'==typeof name&&name||error('bad-app-name',{name:name+''}),contains(apps_,name)&&error('duplicate-app',{name:name});var app=new FirebaseAppImpl(options,config,namespace);return apps_[name]=app,callAppHooks(app,'create'),app},app:app,apps:null,Promise:Promise,SDK_VERSION:'5.5.0',INTERNAL:{registerService:function registerService(name,createService,serviceProperties,appHook,allowMultipleInstances){factories[name]&&error('duplicate-service',{name:name}),factories[name]=createService,appHook&&(appHooks[name]=appHook,getApps().forEach(function(app){appHook('create',app)}));var serviceNamespace=function(appArg){return void 0===appArg&&(appArg=app()),'function'!=typeof appArg[name]&&error('invalid-app-argument',{name:name}),appArg[name]()};return void 0!==serviceProperties&&util.deepExtend(serviceNamespace,serviceProperties),namespace[name]=serviceNamespace,FirebaseAppImpl.prototype[name]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var serviceFxn=this._getService.bind(this,name);return serviceFxn.apply(this,allowMultipleInstances?args:[])},serviceNamespace},createFirebaseNamespace:createFirebaseNamespace,extendNamespace:function extendNamespace(props){util.deepExtend(namespace,props)},createSubscribe:util.createSubscribe,ErrorFactory:util.ErrorFactory,removeApp:function removeApp(name){var app=apps_[name];callAppHooks(app,'delete'),delete apps_[name]},factories:factories,useAsService:useAsService,Promise:Promise,deepExtend:util.deepExtend}};return util.patchProperty(namespace,'default',namespace),Object.defineProperty(namespace,'apps',{get:getApps}),util.patchProperty(app,'App',FirebaseAppImpl),namespace}function error(code,args){throw appErrors.create(code,args)}Object.defineProperty(exports,'__esModule',{value:!0});var util=__webpack_require__(38),contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},DEFAULT_ENTRY_NAME='[DEFAULT]',tokenListeners=[],FirebaseAppImpl=function(){function FirebaseAppImpl(options,config,firebase_){this.firebase_=firebase_,this.isDeleted_=!1,this.services_={},this.name_=config.name,this._automaticDataCollectionEnabled=config.automaticDataCollectionEnabled||!1,this.options_=util.deepCopy(options),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(callback){tokenListeners.push(callback),setTimeout(function(){return callback(null)},0)},removeAuthTokenListener:function(callback){tokenListeners=tokenListeners.filter(function(listener){return listener!==callback})}}}return Object.defineProperty(FirebaseAppImpl.prototype,'automaticDataCollectionEnabled',{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(val){this.checkDestroyed_(),this._automaticDataCollectionEnabled=val},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,'name',{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,'options',{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),FirebaseAppImpl.prototype.delete=function(){var _this=this;return new Promise(function(resolve){_this.checkDestroyed_(),resolve()}).then(function(){_this.firebase_.INTERNAL.removeApp(_this.name_);var services=[];return Object.keys(_this.services_).forEach(function(serviceKey){Object.keys(_this.services_[serviceKey]).forEach(function(instanceKey){services.push(_this.services_[serviceKey][instanceKey])})}),Promise.all(services.map(function(service){return service.INTERNAL.delete()}))}).then(function(){_this.isDeleted_=!0,_this.services_={}})},FirebaseAppImpl.prototype._getService=function(name,instanceIdentifier){if(void 0===instanceIdentifier&&(instanceIdentifier=DEFAULT_ENTRY_NAME),this.checkDestroyed_(),this.services_[name]||(this.services_[name]={}),!this.services_[name][instanceIdentifier]){var instanceSpecifier=instanceIdentifier===DEFAULT_ENTRY_NAME?void 0:instanceIdentifier,service=this.firebase_.INTERNAL.factories[name](this,this.extendApp.bind(this),instanceSpecifier);this.services_[name][instanceIdentifier]=service}return this.services_[name][instanceIdentifier]},FirebaseAppImpl.prototype.extendApp=function(props){var _this=this;util.deepExtend(this,props),props.INTERNAL&&props.INTERNAL.addAuthTokenListener&&(tokenListeners.forEach(function(listener){_this.INTERNAL.addAuthTokenListener(listener)}),tokenListeners=[])},FirebaseAppImpl.prototype.checkDestroyed_=function(){this.isDeleted_&&error('app-deleted',{name:this.name_})},FirebaseAppImpl}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log('dc');var appErrors=new util.ErrorFactory('app','Firebase',{"no-app":'No Firebase App \'{$name}\' has been created - '+'call Firebase App.initializeApp()',"bad-app-name":'Illegal App name: \'{$name}',"duplicate-app":'Firebase App named \'{$name}\' already exists',"app-deleted":'Firebase App named \'{$name}\' already deleted',"duplicate-service":'Firebase service named \'{$name}\' already registered',"sa-not-supported":'Initializing the Firebase SDK with a service '+'account is only allowed in a Node.js environment. On client '+'devices, you should instead initialize the SDK with an api key and '+'auth domain',"invalid-app-argument":'firebase.{$name}() takes either no argument or a '+'Firebase App instance.'}),firebase=createFirebaseNamespace();exports.firebase=firebase,exports.default=firebase},function(module){const decorations=function(){const funcMap=new WeakMap;return{add:function add(func,decorator){const parent=funcMap.has(func)?func:void 0,decoratedFunc=function(){func.apply(this,arguments)};return funcMap.set(decoratedFunc,{parent:parent,decorator:decorator}),decoratedFunc},getAll:function getAll(func){for(var iter=funcMap.get(func),decorators=[];iter!==void 0;)decorators.push(iter.decorator),iter=iter.parent;return decorators},isFunctionDecorated:function isFunctionDecorated(func){return funcMap.has(func)}}}();(function(){function executeDecoratorsOnNewComponent(component){const prot=Object.getPrototypeOf(component);Object.getOwnPropertyNames(prot).forEach(function(name){const prop=prot[name];'function'==typeof prop&&decorations.isFunctionDecorated(prop)&&decorations.getAll(prop).forEach(function(decorator){component[name]=decorator.call(component,name,prop)})})}function wrapComponent(name){const orig=AFRAME.components[name].Component;AFRAME.components[name].Component=function(){this.init=function(){delete this.init,executeDecoratorsOnNewComponent(this),this.init.apply(this,arguments)},orig.apply(this,arguments)},AFRAME.components[name].Component.prototype=orig.prototype}Object.keys(AFRAME.components).forEach(function(c){wrapComponent(c)}),function wrapRegister(){const origRegister=AFRAME.registerComponent;AFRAME.registerComponent=function(name){return origRegister.apply(AFRAME,arguments),wrapComponent(name)}}()})(),module.exports.decorate=function decorate(func,decoratorFunc){return decorations.add(func,decoratorFunc)}},function(module,exports,__webpack_require__){if('undefined'==typeof AFRAME)throw new Error('aframe-event-decorators was loaded before AFRAME was available');const eventBinder=__webpack_require__(40),decorate=__webpack_require__(14).decorate;module.exports.bindEvent=eventBinder.bindEvent,module.exports.bindEventPlayPause=eventBinder.bindEventPlayPause,module.exports.decorate=decorate},function(module,exports,__webpack_require__){module.exports=function buildSearchMethod(queryParam,url){return function search(query,args,callback){if('function'==typeof query&&'object'==typeof args||'object'==typeof callback)throw new errors.AlgoliaSearchError('index.search usage is index.search(query, params, cb)');0===arguments.length||'function'==typeof query?(callback=query,query=''):(1===arguments.length||'function'==typeof args)&&(callback=args,args=void 0),'object'==typeof query&&null!==query?(args=query,query=void 0):(void 0===query||null===query)&&(query='');var params='';void 0!==query&&(params+=queryParam+'='+encodeURIComponent(query));var additionalUA;return void 0!==args&&(args.additionalUA&&(additionalUA=args.additionalUA,delete args.additionalUA),params=this.as._getSearchParams(args,params)),this._search(params,url,callback,additionalUA)}};var errors=__webpack_require__(4)},function(module,exports,__webpack_require__){module.exports=function omit(obj,test){var keys=__webpack_require__(143),foreach=__webpack_require__(3),filtered={};return foreach(keys(obj),function doFilter(keyName){!0!==test(keyName)&&(filtered[keyName]=obj[keyName])}),filtered}},function(module){module.exports='function'==typeof Object.create?function inherits(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},function(module,__webpack_exports__,__webpack_require__){'use strict';function __values(o){var m='function'==typeof Symbol&&o[Symbol.iterator],i=0;return m?m.call(o):{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}}}function __read(o,n){var m='function'==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),ar=[],r,e;try{for(;(void 0===n||0<n--)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i['return'])&&m.call(i)}finally{if(e)throw e.error}}return ar}function __await(v){return this instanceof __await?(this.v=v,this):new __await(v)}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_exports__.__extends=function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},__webpack_require__.d(__webpack_exports__,'__assign',function(){return __assign}),__webpack_exports__.__rest=function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&0>e.indexOf(p)&&(t[p]=s[p]);if(null!=s&&'function'==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)0>e.indexOf(p[i])&&(t[p[i]]=s[p[i]]);return t},__webpack_exports__.__decorate=function __decorate(decorators,target,key,desc){var c=arguments.length,r=3>c?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;0<=i;i--)(d=decorators[i])&&(r=(3>c?d(r):3<c?d(target,key,r):d(target,key))||r);return 3<c&&r&&Object.defineProperty(target,key,r),r},__webpack_exports__.__param=function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}},__webpack_exports__.__metadata=function __metadata(metadataKey,metadataValue){if('object'==typeof Reflect&&'function'==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)},__webpack_exports__.__awaiter=function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator['throw'](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__webpack_exports__.__generator=function __generator(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError('Generator is already executing.');for(;_;)try{if(f=1,y&&(t=y[2&op[0]?'return':op[0]?'throw':'next'])&&!(t=t.call(y,op[1])).done)return t;switch((y=0,t)&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if((t=_.trys,!(t=0<t.length&&t[t.length-1]))&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue;}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var _={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},'function'==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},__webpack_exports__.__exportStar=function __exportStar(m,exports){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])},__webpack_exports__.__values=__values,__webpack_exports__.__read=__read,__webpack_exports__.__spread=function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar},__webpack_exports__.__await=__await,__webpack_exports__.__asyncGenerator=function __asyncGenerator(thisArg,_arguments,generator){function verb(n){g[n]&&(i[n]=function(v){return new Promise(function(a,b){1<q.push([n,v,a,b])||resume(n,v)})})}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume('next',value)}function reject(value){resume('throw',value)}function settle(f,v){(f(v),q.shift(),q.length)&&resume(q[0][0],q[0][1])}if(!Symbol.asyncIterator)throw new TypeError('Symbol.asyncIterator is not defined.');var g=generator.apply(thisArg,_arguments||[]),q=[],i;return i={},verb('next'),verb('throw'),verb('return'),i[Symbol.asyncIterator]=function(){return this},i},__webpack_exports__.__asyncDelegator=function __asyncDelegator(o){function verb(n,f){o[n]&&(i[n]=function(v){return(p=!p)?{value:__await(o[n](v)),done:'return'===n}:f?f(v):v})}var i,p;return i={},verb('next'),verb('throw',function(e){throw e}),verb('return'),i[Symbol.iterator]=function(){return this},i},__webpack_exports__.__asyncValues=function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError('Symbol.asyncIterator is not defined.');var m=o[Symbol.asyncIterator];return m?m.call(o):'function'==typeof __values?__values(o):o[Symbol.iterator]()},__webpack_exports__.__makeTemplateObject=function __makeTemplateObject(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,'raw',{value:raw}):cooked.raw=raw,cooked},__webpack_exports__.__importStar=function __importStar(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result},__webpack_exports__.__importDefault=function __importDefault(mod){return mod&&mod.__esModule?mod:{default:mod}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},__assign=Object.assign||function __assign(t){for(var i=1,n=arguments.length,s;i<n;i++)for(var p in s=arguments[i],s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}},function(){function copyArray(dest,source){var i;for(dest.length=0,i=0;i<source.length;i++)dest[i]=source[i]}if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var OBSERVER_CONFIG={childList:!0,attributes:!0,subtree:!0};AFRAME.registerComponent('aabb-collider',{schema:{collideNonVisible:{default:!1},debug:{default:!1},enabled:{default:!0},interval:{default:80},objects:{default:''}},init:function(){this.centerDifferenceVec3=new THREE.Vector3,this.clearedIntersectedEls=[],this.closestIntersectedEl=null,this.boundingBox=new THREE.Box3,this.boxCenter=new THREE.Vector3,this.boxHelper=new THREE.BoxHelper,this.boxMax=new THREE.Vector3,this.boxMin=new THREE.Vector3,this.hitClosestClearEventDetail={},this.hitClosestEventDetail={},this.intersectedEls=[],this.objectEls=[],this.newIntersectedEls=[],this.prevCheckTime=void 0,this.previousIntersectedEls=[],this.setDirty=this.setDirty.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.hitStartEventDetail={intersectedEls:this.newIntersectedEls}},play:function(){this.observer.observe(this.el.sceneEl,OBSERVER_CONFIG),this.el.sceneEl.addEventListener('object3dset',this.setDirty),this.el.sceneEl.addEventListener('object3dremove',this.setDirty)},remove:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener('object3dset',this.setDirty),this.el.sceneEl.removeEventListener('object3dremove',this.setDirty)},tick:function(time){var boundingBox=this.boundingBox,centerDifferenceVec3=this.centerDifferenceVec3,clearedIntersectedEls=this.clearedIntersectedEls,intersectedEls=this.intersectedEls,el=this.el,newIntersectedEls=this.newIntersectedEls,objectEls=this.objectEls,prevCheckTime=this.prevCheckTime,previousIntersectedEls=this.previousIntersectedEls,self=this,boxHelper,closestCenterDifference,newClosestEl,i;if(this.data.enabled&&!(prevCheckTime&&time-prevCheckTime<this.data.interval)){for(this.prevCheckTime=time,this.dirty&&this.refreshObjects(),boundingBox.setFromObject(el.object3D),this.boxMin.copy(boundingBox.min),this.boxMax.copy(boundingBox.max),boundingBox.getCenter(this.boxCenter),this.data.debug&&(this.boxHelper.setFromObject(el.object3D),!this.boxHelper.parent&&el.sceneEl.object3D.add(this.boxHelper)),copyArray(previousIntersectedEls,intersectedEls),intersectedEls.length=0,i=0;i<objectEls.length;i++)if(objectEls[i]!==this.el){if(!this.data.collideNonVisible&&!objectEls[i].getAttribute('visible')){this.data.debug&&(boxHelper=objectEls[i].object3D.boxHelper,boxHelper&&(el.sceneEl.object3D.remove(boxHelper),objectEls[i].object3D.boxHelper=null));continue}this.isIntersecting(objectEls[i])&&intersectedEls.push(objectEls[i])}for(newIntersectedEls.length=0,i=0;i<intersectedEls.length;i++)-1===previousIntersectedEls.indexOf(intersectedEls[i])&&newIntersectedEls.push(intersectedEls[i]);for(clearedIntersectedEls.length=0,i=0;i<previousIntersectedEls.length;i++)-1===intersectedEls.indexOf(previousIntersectedEls[i])&&(previousIntersectedEls[i].hasAttribute('aabb-collider')||previousIntersectedEls[i].emit('hitend'),clearedIntersectedEls.push(previousIntersectedEls[i]));for(i=0;i<newIntersectedEls.length;i++)newIntersectedEls[i]!==this.el&&(newIntersectedEls[i].hasAttribute('aabb-collider')||newIntersectedEls[i].emit('hitstart'));for(i=0;i<intersectedEls.length;i++)intersectedEls[i]!==this.el&&(centerDifferenceVec3.copy(intersectedEls[i].object3D.boundingBoxCenter).sub(this.boxCenter),(void 0==closestCenterDifference||centerDifferenceVec3.length()<closestCenterDifference)&&(closestCenterDifference=centerDifferenceVec3.length(),newClosestEl=intersectedEls[i]));!intersectedEls.length&&this.closestIntersectedEl?(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit('hitclosestclear'),this.closestIntersectedEl=null,el.emit('hitclosestclear',this.hitClosestClearEventDetail)):newClosestEl!==this.closestIntersectedEl&&(this.closestIntersectedEl&&(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit('hitclosestclear',this.hitClosestClearEventDetail)),newClosestEl&&(newClosestEl.emit('hitclosest'),this.closestIntersectedEl=newClosestEl,this.hitClosestEventDetail.el=newClosestEl,el.emit('hitclosest',this.hitClosestEventDetail))),clearedIntersectedEls.length&&el.emit('hitend'),newIntersectedEls.length&&el.emit('hitstart',this.hitStartEventDetail)}},isIntersecting:function(){var boundingBox=new THREE.Box3;return function(el){var boxMin,boxMax;return boundingBox.setFromObject(el.object3D),this.data.debug&&(!el.object3D.boxHelper&&(el.object3D.boxHelper=new THREE.BoxHelper(el.object3D,new THREE.Color(Math.random(),Math.random(),Math.random())),el.sceneEl.object3D.add(el.object3D.boxHelper)),el.object3D.boxHelper.setFromObject(el.object3D)),boxMin=boundingBox.min,boxMax=boundingBox.max,el.object3D.boundingBoxCenter=el.object3D.boundingBoxCenter||new THREE.Vector3,boundingBox.getCenter(el.object3D.boundingBoxCenter),this.boxMin.x<=boxMax.x&&this.boxMax.x>=boxMin.x&&this.boxMin.y<=boxMax.y&&this.boxMax.y>=boxMin.y&&this.boxMin.z<=boxMax.z&&this.boxMax.z>=boxMin.z}}(),setDirty:function(){this.dirty=!0},refreshObjects:function(){var data=this.data;this.objectEls=data.objects?this.el.sceneEl.querySelectorAll(data.objects):this.el.sceneEl.children,this.dirty=!1}})},function(){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var audioBufferCache={};AFRAME.registerComponent('audioanalyser',{schema:{buffer:{default:!1},beatDetectionDecay:{default:0.99},beatDetectionMinVolume:{default:15},beatDetectionThrottle:{default:250},enabled:{default:!0},enableBeatDetection:{default:!0},enableLevels:{default:!0},enableWaveform:{default:!0},enableVolume:{default:!0},fftSize:{default:2048},smoothingTimeConstant:{default:0.8},src:{parse:function(val){return val.constructor===String?val.startsWith('#')||val.startsWith('.')?document.querySelector(val):val:val}},unique:{default:!1}},init:function(){var data=this.data,analyser,gainNode;this.audioEl=null,this.context=new AudioContext,this.levels=null,this.waveform=null,this.volume=0,this.xhr=null,analyser=this.analyser=this.context.createAnalyser(),gainNode=this.gainNode=this.context.createGain(),gainNode.connect(analyser),analyser.connect(this.context.destination),analyser.fftSize=data.fftSize,analyser.smoothingTimeConstant=data.smoothingTimeConstant,this.levels=new Uint8Array(analyser.frequencyBinCount),this.waveform=new Uint8Array(analyser.fftSize)},update:function(oldData){var analyser=this.analyser,data=this.data;(oldData.fftSize!==data.fftSize||oldData.smoothingTimeConstant!==data.smoothingTimeConstant)&&(analyser.fftSize=data.fftSize,analyser.smoothingTimeConstant=data.smoothingTimeConstant,this.levels=new Uint8Array(analyser.frequencyBinCount),this.waveform=new Uint8Array(analyser.fftSize));data.src&&this.refreshSource()},tick:function(t,dt){var data=this.data,volume;if(data.enabled){if((data.enableLevels||data.enableVolume)&&this.analyser.getByteFrequencyData(this.levels),data.enableWaveform&&this.analyser.getByteTimeDomainData(this.waveform),data.enableVolume||data.enableBeatDetection){for(var sum=0,i=0;i<this.levels.length;i++)sum+=this.levels[i];this.volume=sum/this.levels.length}data.enableBeatDetection&&(volume=this.volume,!this.beatCutOff&&(this.beatCutOff=volume),volume>this.beatCutOff&&volume>this.data.beatDetectionMinVolume?(this.el.emit('audioanalyserbeat',null,!1),this.beatCutOff=1.5*volume,this.beatTime=0):this.beatTime<=this.data.beatDetectionThrottle?this.beatTime+=dt:(this.beatCutOff*=this.data.beatDetectionDecay,this.beatCutOff=Math.max(this.beatCutOff,this.data.beatDetectionMinVolume)))}},refreshSource:function(){var analyser=this.analyser,data=this.data;data.buffer&&data.src.constructor===String?this.getBufferSource().then(source=>{this.source=source,this.source.connect(this.gainNode)}):(this.source=this.getMediaSource(),this.source.connect(this.gainNode))},suspendContext:function(){this.context.suspend()},resumeContext:function(){this.context.resume()},fetchAudioBuffer:function(src){return audioBufferCache[src]?audioBufferCache[src].constructor===Promise?audioBufferCache[src]:Promise.resolve(audioBufferCache[src]):(audioBufferCache[src]=new Promise(resolve=>{const xhr=this.xhr=new XMLHttpRequest;xhr.open('GET',src),xhr.responseType='arraybuffer',xhr.addEventListener('load',()=>{this.context.decodeAudioData(xhr.response).then(audioBuffer=>{audioBufferCache[src]=audioBuffer,resolve(audioBuffer)}).catch(console.error)}),xhr.send()}),audioBufferCache[src])},getBufferSource:function(){var data=this.data;return this.fetchAudioBuffer(data.src).then(()=>{var source;return source=this.context.createBufferSource(),source.buffer=audioBufferCache[data.src],this.el.emit('audioanalyserbuffersource',source,!1),source}).catch(console.error)},getMediaSource:function(){return this.data.src.constructor===String?(!this.audio&&(this.audio=document.createElement('audio'),this.audio.crossOrigin='anonymous'),this.audio.setAttribute('src',this.data.src)):this.audio=this.data.src,this.context.createMediaElementSource(this.audio)}})},function(){var styleParser=AFRAME.utils.styleParser;if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('event-set',{schema:{default:'',parse:function(value){return styleParser.parse(value)}},multiple:!0,init:function(){this.eventHandler=null,this.eventName=null},update:function(){this.removeEventListener(),this.updateEventListener(),this.addEventListener()},remove:function(){this.removeEventListener()},pause:function(){this.removeEventListener()},play:function(){this.addEventListener()},updateEventListener:function(){var data=this.data,el=this.el,event,target,targetEl;event=data._event||this.id,target=data._target,targetEl=target?el.sceneEl.querySelector(target):el,this.eventName=event,this.eventHandler=function handler(){for(var propName in data)'_event'!==propName&&'_target'!==propName&&AFRAME.utils.entity.setComponentProperty.call(this,targetEl,propName,data[propName])}},addEventListener:function(){this.el.addEventListener(this.eventName,this.eventHandler)},removeEventListener:function(){this.el.removeEventListener(this.eventName,this.eventHandler)}})},function(module,exports,__webpack_require__){THREE.BufferGeometryUtils||__webpack_require__(41),AFRAME.registerComponent('geometry-merger',{schema:{preserveOriginal:{default:!1}},init:function(){var self=this;this.geometry=new THREE.Geometry,this.mesh=new THREE.Mesh(this.geometry),this.el.setObject3D('mesh',this.mesh),this.faceIndex={},this.vertexIndex={},this.el.object3D.traverse(function(mesh){'Mesh'!==mesh.type||mesh===self.mesh||(self.faceIndex[mesh.parent.uuid]=[self.geometry.faces.length,self.geometry.faces.length+mesh.geometry.faces.length-1],self.vertexIndex[mesh.parent.uuid]=[self.geometry.vertices.length,self.geometry.vertices.length+mesh.geometry.vertices.length-1],mesh.parent.updateMatrix(),self.geometry.merge(mesh.geometry,mesh.parent.matrix),!self.data.preserveOriginal&&mesh.parent.remove(mesh))})}}),AFRAME.registerComponent('buffer-geometry-merger',{schema:{preserveOriginal:{default:!1}},init:function(){var geometries=[];this.el.sceneEl.object3D.updateMatrixWorld(),this.el.object3D.traverse(function(mesh){'Mesh'!==mesh.type||mesh.el===self.el||(mesh.geometry.applyMatrix(mesh.matrixWorld),geometries.push(mesh.geometry.clone()),mesh.parent.remove(mesh))});const geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);this.mesh=new THREE.Mesh(geometry),this.el.setObject3D('mesh',this.mesh)}})},function(){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('haptics',{dependencies:['tracked-controls'],schema:{actuatorIndex:{default:0},dur:{default:100},enabled:{default:!0},events:{type:'array'},eventsFrom:{type:'string'},force:{default:1}},multiple:!0,init:function(){var data=this.data,self=this;if(this.callPulse=function(){self.pulse()},this.el.components['tracked-controls'].controller){if(this.gamepad=this.el.components['tracked-controls'].controller,!this.gamepad||!this.gamepad.hapticActuators.length)return;this.addEventListeners()}else this.el.addEventListener('controllerconnected',function init(){setTimeout(function(){self.gamepad=self.el.components['tracked-controls'].controller,self.gamepad&&self.gamepad.hapticActuators.length&&self.addEventListeners()},150)})},remove:function(){this.removeEventListeners()},pulse:function(force,dur){var data=this.data,actuator;data.enabled&&this.gamepad&&this.gamepad.hapticActuators&&(actuator=this.gamepad.hapticActuators[data.actuatorIndex],actuator.pulse(force||data.force,dur||data.dur))},addEventListeners:function(){var data=this.data,i,listenTarget;for(listenTarget=data.eventsFrom?document.querySelector(data.eventsFrom):this.el,i=0;i<data.events.length;i++)listenTarget.addEventListener(data.events[i],this.callPulse)},removeEventListeners:function(){var data=this.data,i,listenTarget;for(listenTarget=data.eventsFrom?document.querySelector(data.eventsFrom):this.el,i=0;i<data.events.length;i++)listenTarget.removeEventListener(data.events[i],this.callPulse)}})},function(module){function getBoxPositions(data,numChildren,marginDefined){var rows=Math.ceil(numChildren/data.columns),column,marginColumn,marginRow,offsetColumn,offsetRow,row;for(marginColumn=data.marginColumn,marginRow=data.marginRow,marginDefined&&(marginColumn=data.margin,marginRow=data.margin),offsetRow=getOffsetItemIndex(data.align,rows),offsetColumn=getOffsetItemIndex(data.align,data.columns),row=0;row<rows;row++)for(column=0;column<data.columns;column++)positionHelper.set(0,0,0),0===data.plane.indexOf('x')&&(positionHelper.x=(column-offsetColumn)*marginColumn),0===data.plane.indexOf('y')&&(positionHelper.y=(column-offsetColumn)*marginColumn),1===data.plane.indexOf('y')&&(positionHelper.y=(row-offsetRow)*marginRow),1===data.plane.indexOf('z')&&(positionHelper.z=(row-offsetRow)*marginRow),pushPositionVec3(positionHelper);return positions}function getCirclePositions(data,numChildren){var i,rad;for(i=0;i<numChildren;i++)rad,rad=isNaN(data.angle)?i*(2*Math.PI)/numChildren:0.01745329252*(i*data.angle),positionHelper.set(0,0,0),0===data.plane.indexOf('x')&&(positionHelper.x=data.radius*_Mathcos(rad)),0===data.plane.indexOf('y')&&(positionHelper.y=data.radius*_Mathcos(rad)),1===data.plane.indexOf('y')&&(positionHelper.y=data.radius*_Mathsin(rad)),1===data.plane.indexOf('z')&&(positionHelper.z=data.radius*_Mathsin(rad)),pushPositionVec3(positionHelper);return positions}function getLinePositions(data,numChildren){return data.columns=numChildren,getBoxPositions(data,numChildren,!0)}function getCubePositions(data){return pushPositions(1,0,0,0,1,0,0,0,1,-1,0,0,0,-1,0,0,0,-1),scalePositions(data.radius/2),positions}function getDodecahedronPositions(data){var PHI=(1+2.23606797749979)/2,B=1/PHI,C=2-PHI,NB=-1*B,NC=-1*C;return pushPositions(-1,C,0,-1,NC,0,0,-1,C,0,-1,NC,0,1,C,0,1,NC,1,C,0,1,NC,0,B,B,B,B,B,NB,B,NB,B,B,NB,NB,C,0,1,C,0,-1,NB,B,B,NB,B,NB,NB,NB,B,NB,NB,NB,NC,0,1,NC,0,-1),scalePositions(data.radius/2),positions}function getPyramidPositions(data){var NEG_SQRT_1_3=-1/1.7320508075688772;return pushPositions(0,0,1.7320508075688772+NEG_SQRT_1_3,-1,0,NEG_SQRT_1_3,1,0,NEG_SQRT_1_3,0,2*0.816496580927726,0),scalePositions(data.radius/2),positions}function getOffsetItemIndex(align,numItems){return'start'===align?numItems-1:'center'===align?(numItems-1)/2:'end'===align?0:void 0}function scalePositions(scale){var i;for(i=0;i<positions.length;i++)positions[i]*=scale}function setPositions(els,positions,orderAttribute){var value,i,orderIndex;if(orderAttribute){for(i=0;i<els.length;i++)(value=els[i].getAttribute(orderAttribute),null!==value&&void 0!==value)&&(orderIndex=3*parseInt(value,10),els[i].object3D.position.set(positions[orderIndex],positions[orderIndex+1],positions[orderIndex+2]));return}for(i=0;i<positions.length;i+=3){if(!els[i/3])return;els[i/3].object3D.position.set(positions[i],positions[i+1],positions[i+2])}}function pushPositions(){var i;for(i=0;i<arguments.length;i++)positions.push(i)}function pushPositionVec3(vec3){positions.push(vec3.x),positions.push(vec3.y),positions.push(vec3.z)}var _Mathsin=Math.sin,_Mathcos=Math.cos,positions=[],positionHelper=new THREE.Vector3;AFRAME.registerComponent('layout',{schema:{angle:{type:'number',default:!1,min:0,max:360,if:{type:['circle']}},columns:{default:1,min:0,if:{type:['box']}},margin:{default:1,min:0,if:{type:['box','line']}},marginColumn:{default:1,min:0,if:{type:['box']}},marginRow:{default:1,min:0,if:{type:['box']}},orderAttribute:{default:''},plane:{default:'xy'},radius:{default:1,min:0,if:{type:['circle','cube','dodecahedron','pyramid']}},reverse:{default:!1},type:{default:'line',oneOf:['box','circle','cube','dodecahedron','line','pyramid']},fill:{default:!0,if:{type:['circle']}},align:{default:'end',oneOf:['start','center','end']}},init:function(){var self=this,el=this.el;this.children=el.getChildEntities(),this.initialPositions=[],this.children.forEach(function getInitialPositions(childEl){function _getPositions(){self.initialPositions.push(childEl.object3D.position.x),self.initialPositions.push(childEl.object3D.position.y),self.initialPositions.push(childEl.object3D.position.z)}return childEl.hasLoaded?_getPositions():void childEl.addEventListener('loaded',_getPositions)}),this.handleChildAttached=this.handleChildAttached.bind(this),this.handleChildDetached=this.handleChildDetached.bind(this),el.addEventListener('child-attached',this.handleChildAttached),el.addEventListener('child-detached',this.handleChildDetached),el.addEventListener('layoutrefresh',this.update.bind(this))},update:function(){var children=this.children,data=this.data,el=this.el,definedData,numChildren,positionFn;switch(numChildren=children.length,data.type){case'box':{positionFn=getBoxPositions;break}case'circle':{positionFn=getCirclePositions;break}case'cube':{positionFn=getCubePositions;break}case'dodecahedron':{positionFn=getDodecahedronPositions;break}case'pyramid':{positionFn=getPyramidPositions;break}default:positionFn=getLinePositions;}definedData=el.getDOMAttribute('layout'),positions.length=0,positions=positionFn(data,numChildren,'string'==typeof definedData?-1!==definedData.indexOf('margin'):'margin'in definedData),data.reverse&&positions.reverse(),setPositions(children,positions,data.orderAttribute)},remove:function(){this.el.removeEventListener('child-attached',this.handleChildAttached),this.el.removeEventListener('child-detached',this.handleChildDetached),setPositions(this.children,this.initialPositions)},handleChildAttached:function(evt){var el=this.el;evt.detail.el.parentNode!==el||(this.children.push(evt.detail.el),this.update())},handleChildDetached:function(evt){-1===this.children.indexOf(evt.detail.el)||(this.children.splice(this.children.indexOf(evt.detail.el),1),this.initialPositions.splice(this.children.indexOf(evt.detail.el),1),this.update())}}),module.exports.getBoxPositions=getBoxPositions,module.exports.getCirclePositions=getCirclePositions,module.exports.getLinePositions=getLinePositions,module.exports.getCubePositions=getCubePositions,module.exports.getDodecahedronPositions=getDodecahedronPositions,module.exports.getPyramidPositions=getPyramidPositions},function(module,exports,__webpack_require__){__webpack_require__(42),AFRAME.registerComponent('orbit-controls',{dependencies:['camera'],schema:{autoRotate:{type:'boolean'},autoRotateSpeed:{default:2},dampingFactor:{default:0.1},enabled:{default:!0},enableDamping:{default:!0},enableKeys:{default:!0},enablePan:{default:!0},enableRotate:{default:!0},enableZoom:{default:!0},initialPosition:{type:'vec3'},keyPanSpeed:{default:7},minAzimuthAngle:{type:'number',default:Infinity},maxAzimuthAngle:{type:'number',default:Infinity},maxDistance:{default:1e3},maxPolarAngle:{default:AFRAME.utils.device.isMobile()?90:120},minDistance:{default:1},minPolarAngle:{default:0},minZoom:{default:0},panSpeed:{default:1},rotateSpeed:{default:0.05},screenSpacePanning:{default:!1},target:{type:'vec3'},zoomSpeed:{default:0.5}},init:function(){var el=this.el,oldPosition;this.controls=new THREE.OrbitControls(el.getObject3D('camera'),el.sceneEl.renderer.domElement),oldPosition=new THREE.Vector3,el.sceneEl.addEventListener('enter-vr',()=>{(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!1,el.hasAttribute('look-controls')&&(el.setAttribute('look-controls','enabled',!0),oldPosition.copy(el.getObject3D('camera').position),el.getObject3D('camera').position.set(0,0,0)))}),el.sceneEl.addEventListener('exit-vr',()=>{(AFRAME.utils.device.checkHeadsetConnected()||AFRAME.utils.device.isMobile())&&(this.controls.enabled=!0,el.getObject3D('camera').position.copy(oldPosition),el.hasAttribute('look-controls')&&el.setAttribute('look-controls','enabled',!1))}),document.body.style.cursor='grab',document.addEventListener('mousedown',()=>{document.body.style.cursor='grabbing'}),document.addEventListener('mouseup',()=>{document.body.style.cursor='grab'}),this.target=new THREE.Vector3,el.getObject3D('camera').position.copy(this.data.initialPosition)},update:function(){var controls=this.controls,data=this.data;controls.target=this.target.copy(data.target),controls.autoRotate=data.autoRotate,controls.autoRotateSpeed=data.autoRotateSpeed,controls.dampingFactor=data.dampingFactor,controls.enabled=data.enabled,controls.enableDamping=data.enableDamping,controls.enableKeys=data.enableKeys,controls.enablePan=data.enablePan,controls.enableRotate=data.enableRotate,controls.enableZoom=data.enableZoom,controls.keyPanSpeed=data.keyPanSpeed,controls.maxPolarAngle=THREE.Math.degToRad(data.maxPolarAngle),controls.maxDistance=data.maxDistance,controls.minDistance=data.minDistance,controls.minPolarAngle=THREE.Math.degToRad(data.minPolarAngle),controls.minZoom=data.minZoom,controls.panSpeed=data.panSpeed,controls.rotateSpeed=data.rotateSpeed,controls.screenSpacePanning=data.screenSpacePanning,controls.zoomSpeed=data.zoomSpeed},tick:function(){var controls=this.controls,data=this.data;!data.enabled||controls.enabled&&(controls.enableDamping||controls.autoRotate)&&this.controls.update()}})},function(){AFRAME.registerComponent('proxy-event',{schema:{captureBubbles:{default:!1},enabled:{default:!0},event:{type:'string'},from:{type:'string'},to:{type:'string'},as:{type:'string'},bubbles:{default:!1}},multiple:!0,init:function(){var data=this.data,el=this.el,self=this,from,i,to;if(data.from?'PARENT'===data.from?from=[el.parentNode]:from=document.querySelectorAll(data.from):'CHILDREN'===data.to?to=el.querySelectorAll('*'):'SELF'===data.to?to=[el]:to=document.querySelectorAll(data.to),data.from)for(i=0;i<from.length;i++)this.addEventListenerFrom(from[i]);else el.addEventListener(data.event,function(evt){var data=self.data;if(data.enabled&&(data.captureBubbles||evt.target===el))for(i=0;i<to.length;i++)to[i].emit(data.as||data.event,evt.detail?evt.detail:null,data.bubbles)})},addEventListenerFrom:function(fromEl){var data=this.data,self=this;fromEl.addEventListener(data.event,function(evt){var data=self.data;data.enabled&&(data.captureBubbles||evt.target===fromEl)&&self.el.emit(data.as||data.event,evt.detail?evt.detail:null,!1)})}})},function(module){(function webpackUniversalModuleDefinition(root,factory){module.exports=factory()})('undefined'==typeof self?this:self,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=0)}([function(module,exports,__webpack_require__){if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerShader('ring',{schema:{blur:{default:0.01,is:'uniform'},color:{type:'color',is:'uniform'},progress:{default:0,is:'uniform'},radiusInner:{default:0.85,is:'uniform'},radiusOuter:{default:1,is:'uniform'}},vertexShader:__webpack_require__(1),fragmentShader:__webpack_require__(2)})},function(module){module.exports='varying vec2 vUv;\n\nvoid main () {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n'},function(module){module.exports='#define PI 3.14159265358979\nuniform float blur;\nuniform float progress;\nuniform float radiusInner;\nuniform float radiusOuter;\nuniform vec3 color;\n\nvarying vec2 vUv;\n\nvoid main () {\n  vec2 uv = vec2(vUv.x * 2. - 1., vUv.y * 2. - 1.);\n  float r = uv.x * uv.x + uv.y * uv.y;\n  float col = (1.0 - smoothstep(radiusOuter, radiusOuter + blur, r)) * smoothstep(radiusInner, radiusInner + blur, r);\n  float a = smoothstep(-PI, PI, atan(uv.y, uv.x));\n  float p = 1.0 - progress - blur;\n  col *= smoothstep(p, p + blur, a);\n  gl_FragColor = vec4(color * col, col);\n}\n'}])})},function(){function parseSide(side){return'back'===side?THREE.BackSide:'double'===side?THREE.DoubleSide:THREE.FrontSide}if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');AFRAME.registerComponent('slice9',{schema:{width:{default:1,min:0},height:{default:1,min:0},left:{default:0,min:0},right:{default:0,min:0},bottom:{default:0,min:0},top:{default:0,min:0},side:{default:'front',oneOf:['front','back','double']},padding:{default:0.1,min:0.01},color:{type:'color',default:'#fff'},opacity:{default:1,min:0,max:1},transparent:{default:!0},debug:{default:!1},src:{type:'map'}},multiple:!1,init:function(){var data=this.data,material=this.material=new THREE.MeshBasicMaterial({color:data.color,opacity:data.opacity,transparent:data.transparent,wireframe:data.debug}),geometry=this.geometry=new THREE.PlaneBufferGeometry(data.width,data.height,3,3),textureLoader=new THREE.TextureLoader;this.plane=new THREE.Mesh(geometry,material),this.el.setObject3D('mesh',this.plane),this.textureSrc=null},updateMap:function(){function setMap(texture){this.material.map=texture,this.material.needsUpdate=!0,this.regenerateMesh()}var src=this.data.src;return src?src===this.textureSrc?void 0:(this.textureSrc=src,void this.el.sceneEl.systems.material.loadTexture(src,{src:src},setMap.bind(this))):void(!this.material.map||setMap(null))},regenerateMesh:function(){function setPos(id,x,y){pos[3*id]=x,pos[3*id+1]=y}function setUV(id,u,v){uvs[2*id]=u,uvs[2*id+1]=v}var data=this.data,pos=this.geometry.attributes.position.array,uvs=this.geometry.attributes.uv.array,image=this.material.map.image;if(image){var uv={left:data.left/image.width,right:data.right/image.width,top:data.top/image.height,bottom:data.bottom/image.height};setUV(1,uv.left,1),setUV(2,uv.right,1),setUV(4,0,uv.bottom),setUV(5,uv.left,uv.bottom),setUV(6,uv.right,uv.bottom),setUV(7,1,uv.bottom),setUV(8,0,uv.top),setUV(9,uv.left,uv.top),setUV(10,uv.right,uv.top),setUV(11,1,uv.top),setUV(13,uv.left,0),setUV(14,uv.right,0);var w2=data.width/2,h2=data.height/2,left=-w2+data.padding,right=w2-data.padding,top=h2-data.padding,bottom=-h2+data.padding;setPos(0,-w2,h2),setPos(1,left,h2),setPos(2,right,h2),setPos(3,w2,h2),setPos(4,-w2,top),setPos(5,left,top),setPos(6,right,top),setPos(7,w2,top),setPos(8,-w2,bottom),setPos(9,left,bottom),setPos(10,right,bottom),setPos(11,w2,bottom),setPos(13,left,-h2),setPos(14,right,-h2),setPos(12,-w2,-h2),setPos(15,w2,-h2),this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0}},update:function(oldData){var data=this.data;this.material.color.setStyle(data.color),this.material.opacity=data.opacity,this.material.transparent=data.transparent,this.material.wireframe=data.debug,this.material.side=parseSide(data.side);var diff=AFRAME.utils.diff(data,oldData);'src'in diff?this.updateMap():('width'in diff||'height'in diff||'padding'in diff||'left'in diff||'top'in diff||'bottom'in diff||'right'in diff)&&this.regenerateMesh()},remove:function(){},pause:function(){},play:function(){}})},function(module){(function webpackUniversalModuleDefinition(root,factory){module.exports=factory()})('undefined'==typeof self?this:self,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};return __webpack_require__.d(getter,'a',getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p='',__webpack_require__(__webpack_require__.s=1)}([function(module){'use strict';function generateExpression(str){return str=str.replace(DOT_NOTATION_RE,'["$1"]'),str=str.replace(ROOT_STATE_SELECTOR_RE,'$1state["$2"]'),str=str.replace(STATE_SELECTOR_RE,'$1$2$3state["$4"]'),str=str.replace(ITEM_RE,'item'),str}function composeFunctions(){var functions=arguments;return function(){var i;for(i=0;i<functions.length;i++)functions[i].apply(this,arguments)}}function parseKeyToWatch(str){var dotIndex;return str=stripNot(str.trim()),dotIndex=str.indexOf('.'),-1===dotIndex?str:str.substring(0,str.indexOf('.'))}function stripNot(str){if(0===str.indexOf('!!'))return str.replace('!!','');return 0===str.indexOf('!')?str.replace('!',''):str}function split(str,delimiter){return(SPLIT_CACHE[delimiter]||(SPLIT_CACHE[delimiter]={}),SPLIT_CACHE[delimiter][str])?SPLIT_CACHE[delimiter][str]:(SPLIT_CACHE[delimiter][str]=str.split(delimiter),SPLIT_CACHE[delimiter][str])}var selectFunctions={};module.exports.select=function select(state,selector,item){return selectFunctions[selector]||(selectFunctions[selector]=new Function('state','item','return '+generateExpression(selector)+';')),selectFunctions[selector](state,item)};var DOT_NOTATION_RE=/\.([A-Za-z][\w_-]*)/g,WHITESPACE_RE=/\s/g,STATE_SELECTOR_RE=/([=&|!?:+-])(\s*)([\(]?)([A-Za-z][\w_-]*)/g,ROOT_STATE_SELECTOR_RE=/^([\(]?)([A-Za-z][\w_-]*)/g,ITEM_RE=/state\["item"\]/g;module.exports.generateExpression=generateExpression,module.exports.clearObject=function clearObject(obj){for(var key in obj)delete obj[key]},module.exports.composeHandlers=function composeHandlers(){var inputHandlers=arguments,actionName,i,outputHandlers;for(outputHandlers={},i=0;i<inputHandlers.length;i++)for(actionName in inputHandlers[i])actionName in outputHandlers?outputHandlers[actionName].constructor===Array?outputHandlers[actionName].push(inputHandlers[i][actionName]):outputHandlers[actionName]=[outputHandlers[actionName],inputHandlers[i][actionName]]:outputHandlers[actionName]=inputHandlers[i][actionName];for(actionName in outputHandlers)outputHandlers[actionName].constructor===Array&&(outputHandlers[actionName]=composeFunctions.apply(this,outputHandlers[actionName]));return outputHandlers},module.exports.composeFunctions=composeFunctions;var NO_WATCH_TOKENS=['||','&&','!=','!==','==','===','>','<','<=','>='],WHITESPACE_PLUS_RE=/\s+/;module.exports.parseKeysToWatch=function parseKeysToWatch(keys,str,isBindItem){var i,tokens;for(tokens=split(str,WHITESPACE_PLUS_RE),i=0;i<tokens.length;i++)if(-1===NO_WATCH_TOKENS.indexOf(tokens[i])&&!tokens[i].startsWith('\'')&&-1===keys.indexOf(tokens[i])){if(isBindItem&&'item'===tokens[i])continue;keys.push(parseKeyToWatch(tokens[i]))}};var SPLIT_CACHE={};module.exports.split=split,module.exports.copyArray=function copyArray(dest,src){var i;for(dest.length=0,i=0;i<src.length;i++)dest[i]=src[i]}},function(module,exports,__webpack_require__){'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&'function'==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};__webpack_require__(2);var diff=__webpack_require__(3),lib=__webpack_require__(0),wrapArray=__webpack_require__(4).wrapArray,State={initialState:{},nonBindedStateKeys:[],handlers:{},computeState:function computeState(){}},TYPE_OBJECT='object',WHITESPACE_REGEX=/s+/;AFRAME.registerState=function(definition){AFRAME.utils.extend(State,definition)},AFRAME.registerSystem('state',{init:function init(){var _this=this,key;for(key in this.arrays=[],this.dirtyArrays=[],this.diff={},this.state=AFRAME.utils.clone(State.initialState),this.subscriptions=[],this.initEventHandlers(),this.state)this.state[key]&&this.state[key].constructor===Array&&(this.arrays.push(key),this.state[key].__dirty=!0,wrapArray(this.state[key]));this.lastState=AFRAME.utils.clone(this.state),this.eventDetail={lastState:this.lastState,state:this.state},this.el.addEventListener('loaded',function(){var i;for(State.computeState(_this.state,'@@INIT'),i=0;i<_this.subscriptions.length;i++)_this.subscriptions[i].onStateUpdate(_this.state)})},dispatch:function dispatch(actionName,payload){var i,key;for(key in State.handlers[actionName](this.state,payload),State.computeState(this.state,actionName,payload),this.diff)delete this.diff[key];for(diff(this.lastState,this.state,this.diff,State.nonBindedStateKeys),this.dirtyArrays.length=0,i=0;i<this.arrays.length;i++)this.state[this.arrays[i]].__dirty&&this.dirtyArrays.push(this.arrays[i]);for(i=0;i<this.subscriptions.length;i++){if('bind-for'===this.subscriptions[i].name){if(!this.state[this.subscriptions[i].keysToWatch[0]].__dirty)continue;}else if(!this.shouldUpdate(this.subscriptions[i].keysToWatch,this.diff,this.dirtyArrays))continue;this.subscriptions[i].onStateUpdate()}for(key in this.state)this.state[key]&&this.state[key].constructor===Array&&(this.state[key].__dirty=!1);this.copyState(this.lastState,this.state),this.eventDetail.action=actionName,this.eventDetail.payload=payload,this.el.emit('stateupdate',this.eventDetail)},copyState:function copyState(lastState,state,isRecursive){for(var key in state)if(isRecursive||-1===State.nonBindedStateKeys.indexOf(key)){if(state[key]&&state[key].constructor===Object){if(!(key in lastState)){lastState[key]=AFRAME.utils.clone(state[key]);continue}this.copyState(lastState[key],state[key],!0);continue}lastState[key]=state[key]}},subscribe:function subscribe(component){this.subscriptions.push(component)},unsubscribe:function unsubscribe(component){this.subscriptions.splice(this.subscriptions.indexOf(component),1)},shouldUpdate:function shouldUpdate(keysToWatch,diff,dirtyArrays){for(var i=0;i<keysToWatch.length;i++)if(keysToWatch[i]in diff||-1!==dirtyArrays.indexOf(keysToWatch[i]))return!0;return!1},initEventHandlers:function initEventHandlers(){function registerListener(actionName){var _this2=this;this.el.addEventListener(actionName,function(evt){_this2.dispatch(actionName,evt.detail)})}var registeredActions=[],self=this,actionName;for(actionName in registerListener=registerListener.bind(this),State.handlers)-1===registeredActions.indexOf(actionName)&&(registeredActions.push(actionName),registerListener(actionName))},renderTemplate:function(){var interpRegex=/{{\s*(\w*\.)?([\w.]+)\s*}}/g;return function(template,data,asString){var match,str;if(str=template,data)for(;match=interpRegex.exec(template);)str=str.replace(match[0],('undefined'==typeof data?'undefined':_typeof(data))===TYPE_OBJECT?lib.select(data,match[2])||'':data);return asString?str:document.createRange().createContextualFragment(str)}}(),select:lib.select}),AFRAME.registerComponent('bind',{schema:{default:{},parse:function parse(value){var data,i,properties,pair;if(value.constructor===Object)return value;if(-1===value.indexOf(':'))return value;for(data={},properties=lib.split(value,';'),i=0;i<properties.length;i++)pair=lib.split(properties[i].trim(),':'),data[pair[0]]=pair[1].trim();return data}},multiple:!0,init:function init(){var data=this.data,componentId;this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system=this.el.sceneEl.systems.state,this.id&&(componentId=lib.split(this.id,'__')[0]),this.isNamespacedBind=this.id&&componentId in AFRAME.components&&!AFRAME.components[componentId].isSingleProp||componentId in AFRAME.systems,this.lastData={},this.updateObj={},this.system.subscribe(this),this.onStateUpdate=this.onStateUpdate.bind(this)},update:function update(){var data=this.data,key;if(this.keysToWatch.length=0,'string'==typeof data)lib.parseKeysToWatch(this.keysToWatch,data);else for(key in data)lib.parseKeysToWatch(this.keysToWatch,data[key]);this.onStateUpdate()},onStateUpdate:function onStateUpdate(){var hasKeys=!1,el=this.el,propertyName,stateSelector,state,value;if(el.parentNode){if(this.isNamespacedBind&&lib.clearObject(this.updateObj),state=this.system.state,_typeof(this.data)!==TYPE_OBJECT){try{value=lib.select(state,this.data)}catch(e){throw new Error('[aframe-state-component] Key \''+this.data+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}return('undefined'==typeof value?'undefined':_typeof(value))!==TYPE_OBJECT&&_typeof(this.lastData)!==TYPE_OBJECT&&this.lastData===value?void 0:(AFRAME.utils.entity.setComponentProperty(el,this.id,value),void(this.lastData=value))}for(propertyName in this.data){stateSelector=this.data[propertyName].trim();try{value=lib.select(state,stateSelector)}catch(e){throw console.log(e),new Error('[aframe-state-component] Key \''+stateSelector+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}if(('undefined'==typeof value?'undefined':_typeof(value))===TYPE_OBJECT||_typeof(this.lastData[propertyName])===TYPE_OBJECT||this.lastData[propertyName]!==value){if(propertyName in AFRAME.components&&void 0===value)return void el.removeAttribute(propertyName);this.isNamespacedBind?this.updateObj[propertyName]=value:AFRAME.utils.entity.setComponentProperty(el,propertyName,value),this.lastData[propertyName]=value}}for(hasKeys in this.updateObj);this.isNamespacedBind&&hasKeys&&el.setAttribute(this.id,this.updateObj)}},remove:function remove(){this.system.unsubscribe(this)}}),AFRAME.registerComponent('bind-toggle',{schema:{type:'string'},multiple:!0,init:function init(){this.system=this.el.sceneEl.systems.state,this.keysToWatch=[],this.onStateUpdate=this.onStateUpdate.bind(this),this.system.subscribe(this),this.onStateUpdate()},update:function update(){this.keysToWatch.length=0,lib.parseKeysToWatch(this.keysToWatch,this.data)},onStateUpdate:function onStateUpdate(){var el=this.el,state,value;state=this.system.state;try{value=lib.select(state,this.data)}catch(e){throw new Error('[aframe-state-component] Key \''+this.data+'\' not found in state.'+(' #'+this.el.getAttribute('id')+'['+this.attrName+']'))}value?el.setAttribute(this.id,''):el.removeAttribute(this.id)},remove:function remove(){this.system.unsubscribe(this)}}),module.exports={composeFunctions:lib.composeFunctions,composeHandlers:lib.composeHandlers,select:lib.select}},function(module,exports,__webpack_require__){'use strict';var lib=__webpack_require__(0),ITEM_RE=/item/,ITEM_PREFIX_RE=/item./,ITEM_SELECTOR_RE=/item.(\w+)/;AFRAME.registerComponent('bind-for',{schema:{delay:{default:0},for:{type:'string',default:'item'},in:{type:'string'},key:{type:'string'},pool:{default:0},template:{type:'string'},updateInPlace:{default:!1}},init:function init(){this.system=this.el.sceneEl.systems.state,this.onStateUpdate=this.onStateUpdate.bind(this),this.keysToWatch=[],this.renderedKeys=[],this.system.subscribe(this),this.template=this.el.children[0]&&'TEMPLATE'===this.el.children[0].tagName?this.el.children[0].innerHTML.trim():document.querySelector(this.data.template).innerHTML.trim();for(var i=0;i<this.data.pool;i++)this.el.appendChild(this.generateFromTemplate(null,i))},update:function update(){this.keysToWatch[0]=lib.split(this.data.in,'.')[0],this.onStateUpdate()},onStateUpdateNaive:function(){var activeKeys=[];return function(){var data=this.data,el=this.el,list;try{list=lib.select(this.system.state,data.in)}catch(e){throw new Error('[aframe-state-component] Key \''+data.in+'\' not found in state.'+(' #'+el.getAttribute('id')+'['+this.attrName+']'))}activeKeys.length=0;for(var i=0,item;i<list.length;i++)item=list[i],activeKeys.push(data.key?item[data.key].toString():item.toString());for(var toRemoveEls=this.getElsToRemove(activeKeys,this.renderedKeys),_i=0;_i<toRemoveEls.length;_i++)toRemoveEls[_i].parentNode.removeChild(toRemoveEls[_i]);list.length&&this.renderItems(list,activeKeys,0)}}(),renderItems:function renderItems(list,activeKeys,i){var _this=this,data=this.data,el=this.el,item=list[i],keyValue=data.key?item[data.key].toString():item.toString(),itemEl;if(-1===this.renderedKeys.indexOf(keyValue))itemEl=this.generateFromTemplate(item,i),el.appendChild(itemEl),this.renderedKeys.push(keyValue);else{if(list.length&&list[0].constructor===String){var _keyValue=data.key?item[data.key].toString():item.toString();itemEl=el.querySelector('[data-bind-for-value="'+_keyValue+'"]'),itemEl.setAttribute('data-bind-for-key',i)}else{var bindForKey=this.getBindForKey(item,i);itemEl=el.querySelector('[data-bind-for-key="'+bindForKey+'"]')}itemEl.emit('bindforupdate',item,!1)}list[i+1]&&(this.data.delay?setTimeout(function(){_this.renderItems(list,activeKeys,i+1)},this.data.delay):this.renderItems(list,activeKeys,i+1))},onStateUpdateInPlace:function(){var activeKeys=[];return function(){var data=this.data,el=this.el,list,keyValue;try{list=lib.select(this.system.state,data.in)}catch(e){throw console.log(e),new Error('[aframe-state-component] Key \''+data.in+'\' not found in state.'+(' #'+el.getAttribute('id')+'['+this.attrName+']'))}activeKeys.length=0;for(var i=0,item;i<list.length;i++)item=list[i],keyValue=data.key?item[data.key].toString():item.toString(),activeKeys.push(keyValue);for(var toRemoveEls=this.getElsToRemove(activeKeys,this.renderedKeys),_i2=0;_i2<toRemoveEls.length;_i2++)toRemoveEls[_i2].object3D.visible=!1,toRemoveEls[_i2].setAttribute('data-bind-for-active','false'),toRemoveEls[_i2].removeAttribute('data-bind-for-key'),toRemoveEls[_i2].removeAttribute('data-bind-for-value'),toRemoveEls[_i2].emit('bindfordeactivate',null,!1),toRemoveEls[_i2].pause();list.length&&this.renderItemsInPlace(list,activeKeys,0)}}(),renderItemsInPlace:function renderItemsInPlace(list,activeKeys,i){var _this2=this,data=this.data,el=this.el,item=list[i],bindForKey=this.getBindForKey(item,i),keyValue=data.key?item[data.key].toString():item.toString(),itemEl;if(-1===this.renderedKeys.indexOf(keyValue)){if(!el.querySelector(':scope > [data-bind-for-active="false"]')){var _itemEl=this.generateFromTemplate(item,i);_itemEl.addEventListener('loaded',function(){_itemEl.emit('bindforupdateinplace',item,!1)}),el.appendChild(_itemEl)}else itemEl=el.querySelector('[data-bind-for-active="false"]'),itemEl.setAttribute('data-bind-for-key',bindForKey),itemEl.setAttribute('data-bind-for-value',keyValue),itemEl.object3D.visible=!0,itemEl.play(),itemEl.setAttribute('data-bind-for-active','true'),itemEl.emit('bindforupdateinplace',item,!1);this.renderedKeys.push(keyValue)}else-1!==activeKeys.indexOf(keyValue)&&(list.length&&list[0].constructor===String?(itemEl=el.querySelector('[data-bind-for-value="'+keyValue+'"]'),itemEl.setAttribute('data-bind-for-key',i)):itemEl=el.querySelector('[data-bind-for-key="'+bindForKey+'"]'),itemEl.emit('bindforupdateinplace',item,!1));list[i+1]&&(this.data.delay?setTimeout(function(){_this2.renderItemsInPlace(list,activeKeys,i+1)},this.data.delay):this.renderItemsInPlace(list,activeKeys,i+1))},generateFromTemplate:function generateFromTemplate(item,i){var data=this.data;this.el.appendChild(this.system.renderTemplate(this.template,item));var newEl=this.el.children[this.el.children.length-1];if(!item)return newEl.setAttribute('data-bind-for-key',''),newEl.setAttribute('data-bind-for-active','false'),newEl;var bindForKey=this.getBindForKey(item,i);return newEl.setAttribute('data-bind-for-key',bindForKey),data.key||newEl.setAttribute('data-bind-for-value',item),newEl.setAttribute('data-bind-for-active','true'),newEl},getElsToRemove:function(){var toRemove=[];return function(activeKeys,renderedKeys){var data=this.data,el=this.el;toRemove.length=0;for(var i=0;i<el.children.length;i++)if('TEMPLATE'!==el.children[i].tagName){var key=data.key?el.children[i].getAttribute('data-bind-for-key'):el.children[i].getAttribute('data-bind-for-value');-1===activeKeys.indexOf(key)&&-1!==renderedKeys.indexOf(key)&&(toRemove.push(el.children[i]),renderedKeys.splice(renderedKeys.indexOf(key),1))}return toRemove}}(),getBindForKey:function getBindForKey(item,i){return this.data.key?item[this.data.key].toString():i.toString()},onStateUpdate:function onStateUpdate(){this.data.updateInPlace?this.onStateUpdateInPlace():this.onStateUpdateNaive()}}),AFRAME.registerComponent('bind-item',{schema:{type:'string'},multiple:!0,init:function init(){this.itemData=null,this.keysToWatch=[],this.prevValues={};var rootEl=this.rootEl=this.el.closest('[data-bind-for-key]');if(!rootEl)throw new Error('bind-item component must be attached to entity under a bind-for item.');rootEl.addEventListener('bindforupdateinplace',this.updateInPlace.bind(this)),rootEl.addEventListener('bindfordeactivate',this.deactivate.bind(this)),this.el.sceneEl.systems.state.subscribe(this)},update:function update(){this.parseSelector()},updateInPlace:function updateInPlace(evt){var propertyMap=this.propertyMap;if('false'!==this.rootEl.getAttribute('data-bind-for-active'))for(var property in evt&&(this.itemData=evt.detail),propertyMap){var value=this.select(this.itemData,propertyMap[property]);value!==this.prevValues[property]&&(AFRAME.utils.entity.setComponentProperty(this.el,property,value),this.prevValues[property]=value)}},onStateUpdate:function onStateUpdate(){this.updateInPlace()},select:function select(itemData,selector){return lib.select(this.el.sceneEl.systems.state.state,selector,itemData)},deactivate:function deactivate(){this.prevValues={}},parseSelector:function parseSelector(){var propertyMap=this.propertyMap={};this.keysToWatch.length=0;var componentName=lib.split(this.id,'__')[0];if(componentName in AFRAME.components&&!AFRAME.components[componentName].isSingleProp){for(var propertySplitList=lib.split(this.data,';'),i=0,propertySplit;i<propertySplitList.length;i++)propertySplit=lib.split(propertySplitList[i],':'),propertyMap[this.id+'.'+propertySplit[0].trim()]=propertySplit[1].trim(),lib.parseKeysToWatch(this.keysToWatch,propertySplit[1].trim(),!0);return}propertyMap[this.id]=this.data,lib.parseKeysToWatch(this.keysToWatch,this.data,!0)}})},function(module){'use strict';module.exports=function(){var keys=[];return function(a,b,targetObject,ignoreKeys){var aVal,bVal,bKey,diff,key,i,isComparingObjects;for(key in diff=targetObject||{},keys.length=0,a)keys.push(key);if(!b)return diff;for(bKey in b)-1===keys.indexOf(bKey)&&keys.push(bKey);for(i=0;i<keys.length;i++)(key=keys[i],!(ignoreKeys&&-1!==ignoreKeys.indexOf(key)))&&(aVal=a[key],bVal=b[key],isComparingObjects=aVal&&bVal&&aVal.constructor===Object&&bVal.constructor===Object,(!isComparingObjects||AFRAME.utils.deepEqual(aVal,bVal))&&(isComparingObjects||aVal===bVal)||(diff[key]=bVal));return diff}}()},function(module){'use strict';function makeCallDirty(arr,fn){var originalFn=arr[fn];arr[fn]=function(){originalFn.apply(arr,arguments),arr.__dirty=!0}}var fns=['push','pop','shift','unshift','splice'];module.exports.wrapArray=function wrapArray(arr){var i;if(!arr.__wrapped){for(i=0;i<fns.length;i++)makeCallDirty(arr,fns[i]);arr.__wrapped=!0}}}])})},function(){var TYPE_PAD='PAD',TYPE_STICK='STICK',ANGLES=[0,90,180,270],DIRECTIONS=['right','up','left','down'],EVENTS={NULL:{START:'thumbstart',END:'thumbend'}};DIRECTIONS.forEach(direction=>{EVENTS[direction]={},EVENTS[direction].START='thumb'+direction+'start',EVENTS[direction].END='thumb'+direction+'end'});var SIZE=240;AFRAME.registerComponent('thumb-controls',{dependencies:['tracked-controls'],schema:{thresholdAngle:{default:89.5},thresholdPad:{default:0.05},thresholdStick:{default:0.75}},init:function(){var el=this.el;this.onTrackpadDown=this.onTrackpadDown.bind(this),this.onTrackpadUp=this.onTrackpadUp.bind(this),this.directionStick='',this.directionTrackpad='',this.type=TYPE_STICK,el.addEventListener('controllerconnected',evt=>'oculus-touch-controls'===evt.detail.name||'windows-motion-controls'===evt.detail.name?void(this.type=TYPE_STICK):void(this.type=TYPE_PAD)),this.axis=el.components['tracked-controls'].axis},play:function(){var el=this.el;el.addEventListener('trackpaddown',this.onTrackpadDown),el.addEventListener('trackpadup',this.onTrackpadUp)},pause:function(){var el=this.el;el.removeEventListener('trackpaddown',this.onTrackpadDown),el.removeEventListener('trackpadup',this.onTrackpadUp)},onTrackpadDown:function(){var el=this.el,direction;this.getDistance()<this.data.thresholdPad||(direction=this.getDirection(),direction&&(this.directionTrackpad=direction,el.emit(EVENTS.NULL.START,null,!1),el.emit(EVENTS[this.directionTrackpad].START,null,!1)))},onTrackpadUp:function(){var el=this.el;this.directionTrackpad&&(el.emit(EVENTS.NULL.END,null,!1),el.emit(EVENTS[this.directionTrackpad].END,null,!1),this.directionTrackpad='')},tick:function(){var el=this.el,direction;return this.type===TYPE_PAD?void 0:!this.directionStick&&this.getDistance()>this.data.thresholdStick?(direction=this.getDirection(),!direction)?void 0:(this.directionStick=direction,el.emit(EVENTS.NULL.START,null,!1),void el.emit(EVENTS[this.directionStick].START,null,!1)):void(this.directionStick&&this.getDistance()<this.data.thresholdStick&&(el.emit(EVENTS.NULL.END,null,!1),el.emit(EVENTS[this.directionStick].END,null,!1),this.directionStick=''))},getDistance:function(){var axis=this.axis;return Math.sqrt(axis[1]*axis[1]+axis[0]*axis[0])},getDirection:function(){var angle,bottomThreshold,i,threshold,topThreshold;for(angle=this.getAngle(),threshold=this.data.thresholdAngle/2,i=0;i<ANGLES.length;i++){if(topThreshold=ANGLES[i]+threshold,360<topThreshold&&(topThreshold-=360),bottomThreshold=ANGLES[i]-threshold,0>bottomThreshold&&(angle>=360+bottomThreshold&&360>=angle||0<=angle&&angle<=topThreshold))return DIRECTIONS[i];if(angle>=bottomThreshold&&angle<=topThreshold)return DIRECTIONS[i]}},getAngle:function(){var axis=this.axis,angle,flipY;return flipY=this.type===TYPE_STICK?-1:1,angle=Math.atan2(axis[1]*flipY,axis[0]),0>angle&&(angle=2*Math.PI+angle),THREE.Math.radToDeg(angle)}}),AFRAME.registerComponent('thumb-controls-debug',{dependencies:['thumb-controls','tracked-controls'],schema:{controllerType:{type:'string'},hand:{type:'string'},enabled:{default:!1}},init:function(){var el=this.el,data=this.data,isActive,axis,axisMoveEventDetail,canvas;(data.enabled||AFRAME.utils.getUrlParameter('debug-thumb'))&&(console.log('%c debug-thumb','background: #111; color: red'),el.components['tracked-controls'].handleAxes=()=>{},axis=[0,0,0],axisMoveEventDetail={axis:axis},el.components['tracked-controls'].axis=axis,el.components['thumb-controls'].axis=axis,canvas=this.createCanvas(),canvas.addEventListener('click',()=>{'vive-controls'===this.data.controllerType?isActive?el.emit('trackpadup'):el.emit('trackpaddown'):isActive&&(axis[0]=0,axis[1]=0,el.emit('axismove',axisMoveEventDetail,!1)),isActive=!isActive}),canvas.addEventListener('mousemove',evt=>{var rect;isActive&&(rect=canvas.getBoundingClientRect(),axis[0]=2*((evt.clientX-rect.left)/SIZE)-1,axis[1]=2*((evt.clientY-rect.top)/SIZE)-1,el.emit('axismove',axisMoveEventDetail,!1))}),canvas.addEventListener('mouseleave',()=>{isActive&&(axis[0]=0,axis[1]=0,el.emit('axismove',axisMoveEventDetail,!1))}))},createCanvas:function(){var canvas,ctx;return canvas=document.createElement('canvas'),canvas.classList.add('debugThumb'),canvas.height=SIZE,canvas.width=SIZE,canvas.style.bottom=0,canvas.style.borderRadius='250px',canvas.style.opacity=0.5,canvas.style.position='fixed',canvas.style.zIndex=999999999,'left'===this.data.hand?canvas.style.left=0:canvas.style.right=0,ctx=canvas.getContext('2d'),ctx.fillStyle='#333',ctx.fillRect(0,0,SIZE,SIZE),document.body.appendChild(canvas),canvas}})},function(module,exports,__webpack_require__){var content=__webpack_require__(135);'string'==typeof content&&(content=[[module.i,content,'']]);var options={hmr:!0},transform;options.transform=transform,options.insertInto=void 0;__webpack_require__(147)(content,options);content.locals&&(module.exports=content.locals),!1},function(module,exports,__webpack_require__){function webpackContext(req){return __webpack_require__(webpackContextResolve(req))}function webpackContextResolve(req){var id=map[req];if(!(id+1))throw new Error('Cannot find module \''+req+'\'.');return id}var map={"./active-color.js":59,"./audio-columns.js":60,"./beams.js":61,"./beat-hit-sound.js":62,"./beat-loader.js":63,"./beat.js":64,"./console-shortcuts.js":65,"./copy-texture.js":66,"./cursor-laser.js":67,"./cursor-mesh.js":68,"./debug-beat-loader.js":69,"./debug-controller.js":70,"./debug-cursor.js":71,"./debug-song-time.js":72,"./debug-state.js":73,"./fake-glow.js":74,"./floor-shader.js":75,"./gameover.js":76,"./gpu-preloader.js":77,"./hack.js":78,"./hand-swapper.js":79,"./haptics-saber.js":80,"./haptics-wall.js":81,"./history.js":82,"./intro-song.js":83,"./keyboard-raycastable.js":84,"./leaderboard.js":85,"./logo-light.js":86,"./logoflicker.js":87,"./materials.js":88,"./menu-controls.js":89,"./menu-difficulty-select.js":90,"./menu-selected-challenge-image.js":91,"./menu-slide-animation.js":92,"./mine-fragments-loader.js":93,"./multiplier-ring.js":94,"./particleplayer.js":95,"./pause.js":96,"./pauser.js":97,"./play-sound.js":98,"./raycaster-target.js":99,"./recenter.js":100,"./saber-controls.js":101,"./saber-particles.js":102,"./score-beat.js":103,"./score-texts.js":104,"./search-thumbnail-atlas.js":105,"./search.js":106,"./song-preview.js":107,"./song-progress-ring.js":108,"./song.js":109,"./stage-colors.js":110,"./stage-lasers.js":111,"./stage-shader.js":112,"./stats-param.js":113,"./stepback.js":114,"./sub-object.js":115,"./super-keyboard.js":116,"./supercutfx-shader.js":117,"./supercutfx.js":118,"./text-counter.js":119,"./text-uppercase.js":120,"./toggle-pause-play.js":121,"./trail.js":122,"./tutorial-2d.js":123,"./twister.js":124,"./vertex-colors-buffer.js":125,"./victory-accuracy-ring.js":126,"./victory-rank.js":127,"./visible-raycastable.js":128,"./wall-shader.js":129,"./wall.js":130};webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=33},function(module,exports,__webpack_require__){function webpackContext(req){return __webpack_require__(webpackContextResolve(req))}function webpackContextResolve(req){var id=map[req];if(!(id+1))throw new Error('Cannot find module \''+req+'\'.');return id}var map={"./index.js":134};webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=34},function(module,exports,__webpack_require__){'use strict';var _Mathmin=Math.min,_Mathfloor=Math.floor,_Mathmax=Math.max;(function(process){function getLogLevel(){return logClient.logLevel===logger.LogLevel.DEBUG?LogLevel.DEBUG:logClient.logLevel===logger.LogLevel.SILENT?LogLevel.SILENT:LogLevel.ERROR}function setLogLevel(newLevel){newLevel===LogLevel.DEBUG?logClient.logLevel=logger.LogLevel.DEBUG:newLevel===LogLevel.ERROR?logClient.logLevel=logger.LogLevel.ERROR:newLevel===LogLevel.SILENT?logClient.logLevel=logger.LogLevel.SILENT:logClient.error('Firestore ('+SDK_VERSION+'): Invalid value passed to `setLogLevel`')}function debug(tag,msg){for(var obj=[],_i=2;_i<arguments.length;_i++)obj[_i-2]=arguments[_i];if(logClient.logLevel<=logger.LogLevel.DEBUG){var args=obj.map(argToString);logClient.debug.apply(logClient,['Firestore ('+SDK_VERSION+') ['+tag+']: '+msg].concat(args))}}function error(msg){for(var obj=[],_i=1;_i<arguments.length;_i++)obj[_i-1]=arguments[_i];if(logClient.logLevel<=logger.LogLevel.ERROR){var args=obj.map(argToString);logClient.error.apply(logClient,['Firestore ('+SDK_VERSION+'): '+msg].concat(args))}}function argToString(obj){if('string'==typeof obj)return obj;var platform=PlatformSupport.getPlatform();try{return platform.formatJSON(obj)}catch(e){return obj}}function fail(failure){var message='FIRESTORE ('+SDK_VERSION+') INTERNAL ASSERTION FAILED: '+failure;throw error(message),new Error(message)}function assert(assertion,message){assertion||fail(message)}function emptyByteString(){return PlatformSupport.getPlatform().emptyByteString}function makeConstructorPrivate(cls,optionalMessage){function PublicConstructor(){var error='This constructor is private.';throw optionalMessage&&(error+=' ',error+=optionalMessage),new FirestoreError(Code.INVALID_ARGUMENT,error)}for(var staticProperty in PublicConstructor.prototype=cls.prototype,cls)cls.hasOwnProperty(staticProperty)&&(PublicConstructor[staticProperty]=cls[staticProperty]);return PublicConstructor}function contains(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}function defaulted(value,defaultValue){return value===void 0?defaultValue:value}function forEachNumber(obj,fn){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var num=+key;isNaN(num)||fn(num,obj[key])}}function values(obj){var vs=[];return forEach(obj,function(_,v){return vs.push(v)}),vs}function forEach(obj,fn){for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&fn(key,obj[key])}function isEmpty(obj){for(var key in assert(null!=obj&&'object'==typeof obj,'isEmpty() expects object parameter.'),obj)if(Object.prototype.hasOwnProperty.call(obj,key))return!1;return!0}function shallowCopy(obj){assert(obj&&'object'==typeof obj,'shallowCopy() expects object parameter.');var result={};for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(result[key]=obj[key]);return result}function validateExactNumberOfArgs(functionName,args,numberOfArgs){if(args.length!==numberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires '+formatPlural(numberOfArgs,'argument')+', but was called with '+formatPlural(args.length,'argument')+'.')}function validateAtLeastNumberOfArgs(functionName,args,minNumberOfArgs){if(args.length<minNumberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires at least '+formatPlural(minNumberOfArgs,'argument')+', but was called with '+formatPlural(args.length,'argument')+'.')}function validateBetweenNumberOfArgs(functionName,args,minNumberOfArgs,maxNumberOfArgs){if(args.length<minNumberOfArgs||args.length>maxNumberOfArgs)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires between '+minNumberOfArgs+' and '+(maxNumberOfArgs+' arguments, but was called with ')+formatPlural(args.length,'argument')+'.')}function validateNamedArrayAtLeastNumberOfElements(functionName,value,name,minNumberOfElements){if(!(value instanceof Array)||value.length<minNumberOfElements)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+name+' argument to be an '+'array with at least '+(formatPlural(minNumberOfElements,'element')+'.'))}function validateArgType(functionName,type,position,argument){validateType(functionName,type,ordinal(position)+' argument',argument)}function validateOptionalArgType(functionName,type,position,argument){argument!==void 0&&validateArgType(functionName,type,position,argument)}function validateNamedType(functionName,type,optionName,argument){validateType(functionName,type,optionName+' option',argument)}function validateNamedOptionalType(functionName,type,optionName,argument){argument!==void 0&&validateNamedType(functionName,type,optionName,argument)}function validateArrayElements(functionName,optionName,typeDescription,argument,validator){if(!(argument instanceof Array))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+optionName+' '+('option to be an array, but it was: '+valueDescription(argument)));for(var i=0;i<argument.length;++i)if(!validator(argument[i]))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires all '+optionName+' '+('elements to be '+typeDescription+', but the value at index '+i+' ')+('was: '+valueDescription(argument[i])))}function validateOptionalArrayElements(functionName,optionName,typeDescription,argument,validator){argument!==void 0&&validateArrayElements(functionName,optionName,typeDescription,argument,validator)}function validateNamedPropertyEquals(functionName,inputName,optionName,input,expected){for(var expectedDescription=[],_i=0,expected_1=expected,val;_i<expected_1.length;_i++){if(val=expected_1[_i],val===input)return;expectedDescription.push(valueDescription(val))}var actualDescription=valueDescription(input);throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid value '+actualDescription+' provided to function '+functionName+'() for option '+('"'+optionName+'". Acceptable values: '+expectedDescription.join(', ')))}function validateNamedOptionalPropertyEquals(functionName,inputName,optionName,input,expected){input!==void 0&&validateNamedPropertyEquals(functionName,inputName,optionName,input,expected)}function validateType(functionName,type,inputName,input){var valid=!1;if(valid='object'===type?isPlainObject(input):'non-empty string'===type?'string'==typeof input&&''!==input:typeof input==type,!valid){var description=valueDescription(input);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+inputName+' '+('to be of type '+type+', but it was: '+description))}}function isPlainObject(input){return'object'==typeof input&&null!==input&&(Object.getPrototypeOf(input)===Object.prototype||null===Object.getPrototypeOf(input))}function valueDescription(input){if(input===void 0)return'undefined';if(null===input)return'null';if('string'==typeof input)return 20<input.length&&(input=input.substring(0,20)+'...'),JSON.stringify(input);if('number'==typeof input||'boolean'==typeof input)return''+input;if('object'==typeof input){if(input instanceof Array)return'an array';var customObjectName=tryGetCustomObjectType(input);return customObjectName?'a custom '+customObjectName+' object':'an object'}return'function'==typeof input?'a function':fail('Unknown wrong type: '+typeof input)}function tryGetCustomObjectType(input){if(input.constructor){var funcNameRegex=/function\s+([^\s(]+)\s*\(/,results=funcNameRegex.exec(input.constructor.toString());if(results&&1<results.length)return results[1]}return null}function validateDefined(functionName,position,argument){if(argument===void 0)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires a valid '+ordinal(position)+' '+'argument, but it was undefined.')}function validateOptionNames(functionName,options,optionNames){forEach(options,function(key){if(0>optionNames.indexOf(key))throw new FirestoreError(Code.INVALID_ARGUMENT,'Unknown option \''+key+'\' passed to function '+functionName+'(). '+'Available options: '+optionNames.join(', '))})}function invalidClassError(functionName,type,position,argument){var description=valueDescription(argument);return new FirestoreError(Code.INVALID_ARGUMENT,'Function '+functionName+'() requires its '+ordinal(position)+' '+('argument to be a '+type+', but it was: '+description))}function ordinal(num){return 1===num?'first':2===num?'second':3===num?'third':num+'th'}function formatPlural(num,str){return num+' '+str+(1===num?'':'s')}function primitiveComparator(left,right){return left<right?-1:left>right?1:0}function equals(left,right){return null!==left&&void 0!==left?!!(right&&left.isEqual(right)):left===right}function arrayEquals(left,right){if(left.length!==right.length)return!1;for(var i=0;i<left.length;i++)if(!left[i].isEqual(right[i]))return!1;return!0}function immediateSuccessor(s){return s+'\0'}function assertUint8ArrayAvailable(){if('undefined'==typeof Uint8Array)throw new FirestoreError(Code.UNIMPLEMENTED,'Uint8Arrays are not available in this environment.')}function assertBase64Available(){if(!PlatformSupport.getPlatform().base64Available)throw new FirestoreError(Code.UNIMPLEMENTED,'Blobs are unavailable in Firestore in this environment.')}function numericComparator(left,right){return left<right?-1:left>right?1:left===right?0:isNaN(left)?isNaN(right)?0:-1:1}function numericEquals(left,right){return left===right?0!==left||1/left==1/right:left!==left&&right!==right}function isNullOrUndefined(value){return null===value||value===void 0}function isSafeInteger(value){return isInteger(value)&&value<=MAX_SAFE_INTEGER&&value>=MIN_SAFE_INTEGER}function coercedFieldValuesArray(value){return value instanceof ArrayValue?value.internalValue.slice():[]}function isPermanentError(code){return code===Code.OK?fail('Treated status OK as error'):code===Code.CANCELLED||code===Code.UNKNOWN||code===Code.DEADLINE_EXCEEDED||code===Code.RESOURCE_EXHAUSTED||code===Code.INTERNAL||code===Code.UNAVAILABLE||code===Code.UNAUTHENTICATED?!1:code===Code.INVALID_ARGUMENT||code===Code.NOT_FOUND||code===Code.ALREADY_EXISTS||code===Code.PERMISSION_DENIED||code===Code.FAILED_PRECONDITION||code===Code.ABORTED||code===Code.OUT_OF_RANGE||code===Code.UNIMPLEMENTED||code===Code.DATA_LOSS||fail('Unknown status code: '+code)}function mapCodeFromRpcStatus(status){var code=RpcCode[status];return void 0===code?void 0:mapCodeFromRpcCode(code)}function mapCodeFromRpcCode(code){if(void 0===code)return error('GRPC error has no .code'),Code.UNKNOWN;return code===RpcCode.OK?Code.OK:code===RpcCode.CANCELLED?Code.CANCELLED:code===RpcCode.UNKNOWN?Code.UNKNOWN:code===RpcCode.DEADLINE_EXCEEDED?Code.DEADLINE_EXCEEDED:code===RpcCode.RESOURCE_EXHAUSTED?Code.RESOURCE_EXHAUSTED:code===RpcCode.INTERNAL?Code.INTERNAL:code===RpcCode.UNAVAILABLE?Code.UNAVAILABLE:code===RpcCode.UNAUTHENTICATED?Code.UNAUTHENTICATED:code===RpcCode.INVALID_ARGUMENT?Code.INVALID_ARGUMENT:code===RpcCode.NOT_FOUND?Code.NOT_FOUND:code===RpcCode.ALREADY_EXISTS?Code.ALREADY_EXISTS:code===RpcCode.PERMISSION_DENIED?Code.PERMISSION_DENIED:code===RpcCode.FAILED_PRECONDITION?Code.FAILED_PRECONDITION:code===RpcCode.ABORTED?Code.ABORTED:code===RpcCode.OUT_OF_RANGE?Code.OUT_OF_RANGE:code===RpcCode.UNIMPLEMENTED?Code.UNIMPLEMENTED:code===RpcCode.DATA_LOSS?Code.DATA_LOSS:fail('Unknown status code: '+code)}function mapRpcCodeFromCode(code){if(code===void 0)return RpcCode.OK;return code===Code.OK?RpcCode.OK:code===Code.CANCELLED?RpcCode.CANCELLED:code===Code.UNKNOWN?RpcCode.UNKNOWN:code===Code.DEADLINE_EXCEEDED?RpcCode.DEADLINE_EXCEEDED:code===Code.RESOURCE_EXHAUSTED?RpcCode.RESOURCE_EXHAUSTED:code===Code.INTERNAL?RpcCode.INTERNAL:code===Code.UNAVAILABLE?RpcCode.UNAVAILABLE:code===Code.UNAUTHENTICATED?RpcCode.UNAUTHENTICATED:code===Code.INVALID_ARGUMENT?RpcCode.INVALID_ARGUMENT:code===Code.NOT_FOUND?RpcCode.NOT_FOUND:code===Code.ALREADY_EXISTS?RpcCode.ALREADY_EXISTS:code===Code.PERMISSION_DENIED?RpcCode.PERMISSION_DENIED:code===Code.FAILED_PRECONDITION?RpcCode.FAILED_PRECONDITION:code===Code.ABORTED?RpcCode.ABORTED:code===Code.OUT_OF_RANGE?RpcCode.OUT_OF_RANGE:code===Code.UNIMPLEMENTED?RpcCode.UNIMPLEMENTED:code===Code.DATA_LOSS?RpcCode.DATA_LOSS:fail('Unknown status code: '+code)}function mapCodeFromHttpStatus(status){return 200===status?Code.OK:400===status?Code.INVALID_ARGUMENT:401===status?Code.UNAUTHENTICATED:403===status?Code.PERMISSION_DENIED:404===status?Code.NOT_FOUND:409===status?Code.ABORTED:416===status?Code.OUT_OF_RANGE:429===status?Code.RESOURCE_EXHAUSTED:499===status?Code.CANCELLED:500===status?Code.UNKNOWN:501===status?Code.UNIMPLEMENTED:503===status?Code.UNAVAILABLE:504===status?Code.DEADLINE_EXCEEDED:200<=status&&300>status?Code.OK:400<=status&&500>status?Code.FAILED_PRECONDITION:500<=status&&600>status?Code.INTERNAL:Code.UNKNOWN}function maybeDocumentMap(){return EMPTY_MAYBE_DOCUMENT_MAP}function documentMap(){return EMPTY_DOCUMENT_MAP}function documentVersionMap(){return EMPTY_DOCUMENT_VERSION_MAP}function documentKeySet(){return EMPTY_DOCUMENT_KEY_SET}function targetIdSet(){return EMPTY_TARGET_ID_SET}function documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}function assertPresent(value,description){assert(!isNullOrUndefined(value),description+' is missing')}function parseInt64(value){return'number'==typeof value?value:'string'==typeof value?+value:fail('can\'t parse '+value)}function hasTag(obj,type,tag){return type===tag||!type&&tag in obj}function encode(path){for(var result='',i=0;i<path.length;i++)0<result.length&&(result=encodeSeparator(result)),result=encodeSegment(path.get(i),result);return encodeSeparator(result)}function encodeSegment(segment,resultBuf){for(var result=resultBuf,length=segment.length,i=0,c;i<length;i++)c=segment.charAt(i),result+='\0'===c?escapeChar+encodedNul:c===escapeChar?escapeChar+encodedEscape:c;return result}function encodeSeparator(result){return result+escapeChar+encodedSeparatorChar}function decode$1(path){var length=path.length;if(assert(2<=length,'Invalid path '+path),2===length)return assert(path.charAt(0)===escapeChar&&path.charAt(1)===encodedSeparatorChar,'Non-empty path '+path+' had length 2'),ResourcePath.EMPTY_PATH;for(var segments=[],segmentBuilder='',start=0,end;start<length;){end=path.indexOf(escapeChar,start),(0>end||end>length-2)&&fail('Invalid encoded resource path: "'+path+'"');var next=path.charAt(end+1);switch(next){case encodedSeparatorChar:var currentPiece=path.substring(start,end),segment=void 0;0===segmentBuilder.length?segment=currentPiece:(segmentBuilder+=currentPiece,segment=segmentBuilder,segmentBuilder=''),segments.push(segment);break;case encodedNul:segmentBuilder+=path.substring(start,end),segmentBuilder+='\0';break;case encodedEscape:segmentBuilder+=path.substring(start,end+1);break;default:fail('Invalid encoded resource path: "'+path+'"');}start=end+2}return new ResourcePath(segments)}function wrapRequest(request){return new PersistencePromise(function(resolve,reject){request.onsuccess=function(event){var result=event.target.result;resolve(result)},request.onerror=function(event){reject(event.target.error)}})}function documentGlobalStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocumentGlobal.store)}function isDocumentChangeMissingError(err){return err.code===Code.DATA_LOSS&&err.message===REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG}function remoteDocumentsStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocument.store)}function documentChangesStore(txn){return IndexedDbPersistence.getStore(txn,DbRemoteDocumentChanges.store)}function dbKey(docKey){return docKey.path.toArray()}function dbDocumentSize(doc){var value;if(doc.document)value=doc.document;else if(doc.unknownDocument)value=doc.unknownDocument;else if(doc.noDocument)value=doc.noDocument;else throw fail('Unknown remote document type');return JSON.stringify(value).length}function createPrimaryClientStore(db){db.createObjectStore(DbPrimaryClient.store)}function createMutationQueue(db){db.createObjectStore(DbMutationQueue.store,{keyPath:DbMutationQueue.keyPath});var mutationBatchesStore=db.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath,autoIncrement:!0});mutationBatchesStore.createIndex(DbMutationBatch.userMutationsIndex,DbMutationBatch.userMutationsKeyPath,{unique:!0}),db.createObjectStore(DbDocumentMutation.store)}function upgradeMutationBatchSchemaAndMigrateData(db,txn){var v1MutationsStore=txn.store(DbMutationBatch.store);return v1MutationsStore.loadAll().next(function(existingMutations){db.deleteObjectStore(DbMutationBatch.store);var mutationsStore=db.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath,autoIncrement:!0});mutationsStore.createIndex(DbMutationBatch.userMutationsIndex,DbMutationBatch.userMutationsKeyPath,{unique:!0});var v3MutationsStore=txn.store(DbMutationBatch.store),writeAll=existingMutations.map(function(mutation){return v3MutationsStore.put(mutation)});return PersistencePromise.waitFor(writeAll)})}function createRemoteDocumentCache(db){db.createObjectStore(DbRemoteDocument.store)}function createDocumentGlobalStore(db){db.createObjectStore(DbRemoteDocumentGlobal.store)}function createQueryCache(db){var targetDocumentsStore=db.createObjectStore(DbTargetDocument.store,{keyPath:DbTargetDocument.keyPath});targetDocumentsStore.createIndex(DbTargetDocument.documentTargetsIndex,DbTargetDocument.documentTargetsKeyPath,{unique:!0});var targetStore=db.createObjectStore(DbTarget.store,{keyPath:DbTarget.keyPath});targetStore.createIndex(DbTarget.queryTargetsIndexName,DbTarget.queryTargetsKeyPath,{unique:!0}),db.createObjectStore(DbTargetGlobal.store)}function dropQueryCache(db){db.deleteObjectStore(DbTargetDocument.store),db.deleteObjectStore(DbTarget.store),db.deleteObjectStore(DbTargetGlobal.store)}function writeEmptyTargetGlobalEntry(txn){var globalStore=txn.store(DbTargetGlobal.store),metadata=new DbTargetGlobal(0,0,SnapshotVersion.MIN.toTimestamp(),0);return globalStore.put(DbTargetGlobal.key,metadata)}function createRemoteDocumentChangesStore(db){db.createObjectStore(DbRemoteDocumentChanges.store,{keyPath:'id',autoIncrement:!0})}function createClientMetadataStore(db){db.createObjectStore(DbClientMetadata.store,{keyPath:DbClientMetadata.keyPath})}function mutationQueueContainsKey(txn,userId,key){var indexKey=DbDocumentMutation.prefixForPath(userId,key.path),encodedPath=indexKey[1],startRange=IDBKeyRange.lowerBound(indexKey),containsKey=!1;return documentMutationsStore(txn).iterate({range:startRange,keysOnly:!0},function(key,value,control){var userID=key[0],keyPath=key[1],_=key[2];userID===userId&&keyPath===encodedPath&&(containsKey=!0),control.done()}).next(function(){return containsKey})}function mutationQueuesContainKey(txn,docKey){var found=!1;return mutationQueuesStore(txn).iterateSerial(function(userId){return mutationQueueContainsKey(txn,userId,docKey).next(function(containsKey){return containsKey&&(found=!0),PersistencePromise.resolve(!containsKey)})}).next(function(){return found})}function removeMutationBatch(txn,userId,batch){var mutationStore=txn.store(DbMutationBatch.store),indexTxn=txn.store(DbDocumentMutation.store),promises=[],range=IDBKeyRange.only(batch.batchId),numDeleted=0,removePromise=mutationStore.iterate({range:range},function(key,value,control){return numDeleted++,control.delete()});promises.push(removePromise.next(function(){assert(1==numDeleted,'Dangling document-mutation reference found: Missing batch '+batch.batchId)}));for(var removedDocuments=[],_i=0,_a=batch.mutations;_i<_a.length;_i++){var mutation=_a[_i],indexKey=DbDocumentMutation.key(userId,mutation.key.path,batch.batchId);promises.push(indexTxn.delete(indexKey)),removedDocuments.push(mutation.key)}return PersistencePromise.waitFor(promises).next(function(){return removedDocuments})}function convertStreamToken(token){return token instanceof Uint8Array?(assert('YES'===process.env.USE_MOCK_PERSISTENCE,'Persisting non-string stream tokens is only supported with mock persistence.'),token.toString()):token}function mutationsStore(txn){return IndexedDbPersistence.getStore(txn,DbMutationBatch.store)}function documentMutationsStore(txn){return IndexedDbPersistence.getStore(txn,DbDocumentMutation.store)}function mutationQueuesStore(txn){return IndexedDbPersistence.getStore(txn,DbMutationQueue.store)}function targetsStore(txn){return IndexedDbPersistence.getStore(txn,DbTarget.store)}function globalTargetStore(txn){return IndexedDbPersistence.getStore(txn,DbTargetGlobal.store)}function retrieveMetadata(txn){var globalStore=SimpleDb.getStore(txn,DbTargetGlobal.store);return globalStore.get(DbTargetGlobal.key).next(function(metadata){return assert(null!==metadata,'Missing metadata row.'),metadata})}function getHighestListenSequenceNumber(txn){return retrieveMetadata(txn).next(function(targetGlobal){return targetGlobal.highestListenSequenceNumber})}function documentTargetStore(txn){return IndexedDbPersistence.getStore(txn,DbTargetDocument.store)}function isDocumentQuery(dbQuery){return dbQuery.documents!==void 0}function bufferEntryComparator(_a,_b){var aSequence=_a[0],aIndex=_a[1],bSequence=_b[0],bIndex=_b[1],seqCmp=primitiveComparator(aSequence,bSequence);return 0===seqCmp?primitiveComparator(aIndex,bIndex):seqCmp}function isPrimaryLeaseLostError(err){return err.code===Code.FAILED_PRECONDITION&&err.message===PRIMARY_LEASE_LOST_ERROR_MSG}function primaryClientStore(txn){return txn.store(DbPrimaryClient.store)}function clientMetadataStore(txn){return txn.store(DbClientMetadata.store)}function sentinelKey(key){return[0,encode(key.path)]}function sentinelRow(key,sequenceNumber){return new DbTargetDocument(0,encode(key.path),sequenceNumber)}function writeSentinelKey(txn,key){return documentTargetStore(txn).put(sentinelRow(key,txn.currentSequenceNumber))}function documentSizeMap(){return new SortedMap(DocumentKey.comparator)}function compareChangeType(c1,c2){var order=function(change){return change===ChangeType.Added?1:change===ChangeType.Modified?2:change===ChangeType.Metadata?2:change===ChangeType.Removed?0:fail('Unknown ChangeType: '+change)};return order(c1)-order(c2)}function fromWebStorageSequenceNumber(seqString){var sequenceNumber=ListenSequence.INVALID;if(null!=seqString)try{var parsed=JSON.parse(seqString);assert('number'==typeof parsed,'Found non-numeric sequence number'),sequenceNumber=parsed}catch(e){error(LOG_TAG$10,'Failed to read sequence number from WebStorage',e)}return sequenceNumber}function fromDotSeparatedString(path){var found=path.search(RESERVED);if(0<=found)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not contain '+'\'~\', \'*\', \'/\', \'[\', or \']\'');try{return new(FieldPath$1.bind.apply(FieldPath$1,[void 0].concat(path.split('.'))))}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not be empty, '+'begin with \'.\', end with \'.\', or contain \'..\'')}}function makeCredentialsProvider(credentials){if(!credentials)return new EmptyCredentialsProvider;switch(credentials.type){case'gapi':return new FirstPartyCredentialsProvider(credentials.client,credentials.sessionIndex||'0');case'provider':return credentials.client;default:throw new FirestoreError(Code.INVALID_ARGUMENT,'makeCredentialsProvider failed due to invalid credential type');}}function isPartialObserver(obj){return implementsAnyMethods$1(obj,['next','error','complete'])}function implementsAnyMethods$1(obj,methods){if('object'!=typeof obj||null===obj)return!1;for(var object=obj,_i=0,methods_1=methods,method;_i<methods_1.length;_i++)if(method=methods_1[_i],method in object&&'function'==typeof object[method])return!0;return!1}function isWrite(dataSource){switch(dataSource){case UserDataSource.Set:case UserDataSource.MergeSet:case UserDataSource.Update:return!0;case UserDataSource.Argument:return!1;default:throw fail('Unexpected case for UserDataSource: '+dataSource);}}function looksLikeJsonObject(input){return'object'==typeof input&&null!==input&&!(input instanceof Array)&&!(input instanceof Date)&&!(input instanceof Timestamp)&&!(input instanceof GeoPoint)&&!(input instanceof Blob)&&!(input instanceof DocumentKeyReference)&&!(input instanceof FieldValueImpl)}function validatePlainObject(message,context,input){if(!looksLikeJsonObject(input)||!isPlainObject(input)){var description=valueDescription(input);if('an object'===description)throw context.createError(message+' a custom object');else throw context.createError(message+' '+description)}}function fieldPathFromArgument(methodName,path){if(path instanceof FieldPath$1)return path._internalPath;if('string'==typeof path)return fieldPathFromDotSeparatedString(methodName,path);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() called with invalid data. '+'Field path arguments must be of type string or FieldPath.')}function fieldPathFromDotSeparatedString(methodName,path){try{return fromDotSeparatedString(path)._internalPath}catch(e){var message=errorMessage(e);throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() called with invalid data. '+message)}}function errorMessage(error){return error instanceof Error?error.message:error.toString()}function throwDocChangesMethodError(){throw new FirestoreError(Code.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a '+'method, so usages like "querySnapshot.docChanges" should become '+'"querySnapshot.docChanges()"')}function validateSetOptions(methodName,options){if(void 0===options)return{merge:!1};if(validateOptionNames(methodName,options,['merge','mergeFields']),validateNamedOptionalType(methodName,'boolean','merge',options.merge),validateOptionalArrayElements(methodName,'mergeFields','a string or a FieldPath',options.mergeFields,function(element){return'string'==typeof element||element instanceof FieldPath$1}),void 0!==options.mergeFields&&void 0!==options.merge)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid options passed to function '+methodName+'(): You cannot specify both "merge" '+'and "mergeFields".');return options}function validateSnapshotOptions(methodName,options){return void 0===options?{}:(validateOptionNames(methodName,options,['serverTimestamps']),validateNamedOptionalPropertyEquals(methodName,'options','serverTimestamps',options.serverTimestamps,['estimate','previous','none']),options)}function validateGetOptions(methodName,options){validateOptionalArgType(methodName,'object',1,options),options&&(validateOptionNames(methodName,options,['source']),validateNamedOptionalPropertyEquals(methodName,'options','source',options.source,['default','server','cache']))}function validateReference(methodName,documentRef,firestore){if(!(documentRef instanceof DocumentReference))throw invalidClassError(methodName,'DocumentReference',1,documentRef);else if(documentRef.firestore!==firestore)throw new FirestoreError(Code.INVALID_ARGUMENT,'Provided document reference is from a different Firestore instance.');else return documentRef}function changesFromSnapshot(firestore,includeMetadataChanges,snapshot){if(snapshot.oldDocs.isEmpty()){var index_1=0,lastDoc_1;return snapshot.docChanges.map(function(change){var doc=new QueryDocumentSnapshot(firestore,change.doc.key,change.doc,snapshot.fromCache,snapshot.mutatedKeys.has(change.doc.key));return assert(change.type===ChangeType.Added,'Invalid event type for first snapshot'),assert(!lastDoc_1||0>snapshot.query.docComparator(lastDoc_1,change.doc),'Got added events in wrong order'),lastDoc_1=change.doc,{type:'added',doc:doc,oldIndex:-1,newIndex:index_1++}})}var indexTracker_1=snapshot.oldDocs;return snapshot.docChanges.filter(function(change){return includeMetadataChanges||change.type!==ChangeType.Metadata}).map(function(change){var doc=new QueryDocumentSnapshot(firestore,change.doc.key,change.doc,snapshot.fromCache,snapshot.mutatedKeys.has(change.doc.key)),oldIndex=-1,newIndex=-1;return change.type!==ChangeType.Added&&(oldIndex=indexTracker_1.indexOf(change.doc.key),assert(0<=oldIndex,'Index for document not found'),indexTracker_1=indexTracker_1.delete(change.doc.key)),change.type!==ChangeType.Removed&&(indexTracker_1=indexTracker_1.add(change.doc),newIndex=indexTracker_1.indexOf(change.doc.key)),{type:resultChangeType(change.type),doc:doc,oldIndex:oldIndex,newIndex:newIndex}})}function resultChangeType(type){return type===ChangeType.Added?'added':type===ChangeType.Modified||type===ChangeType.Metadata?'modified':type===ChangeType.Removed?'removed':fail('Unknown change type: '+type)}function configureForFirebase(firebase$$1){firebase$$1.INTERNAL.registerService('firestore',function(app){return new Firestore(app)},shallowCopy(firestoreNamespace))}function registerFirestore(instance){configureForFirebase(instance)}var _NumberPOSITIVE_INFINITY=Number.POSITIVE_INFINITY,_NumberNEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Object.defineProperty(exports,'__esModule',{value:!0});var firebase=function _interopDefault(ex){return ex&&'object'==typeof ex&&'default'in ex?ex['default']:ex}(__webpack_require__(13)),logger=__webpack_require__(36),tslib_1=__webpack_require__(19),webchannelWrapper=__webpack_require__(39),SDK_VERSION=firebase.SDK_VERSION,logClient=new logger.Logger('@firebase/firestore'),LogLevel;(function(LogLevel){LogLevel[LogLevel.DEBUG=0]='DEBUG',LogLevel[LogLevel.ERROR=1]='ERROR',LogLevel[LogLevel.SILENT=2]='SILENT'})(LogLevel||(LogLevel={}));var PlatformSupport=function(){function PlatformSupport(){}return PlatformSupport.setPlatform=function(platform){PlatformSupport.platform&&fail('Platform already defined'),PlatformSupport.platform=platform},PlatformSupport.getPlatform=function(){return PlatformSupport.platform||fail('Platform not set'),PlatformSupport.platform},PlatformSupport}(),Code={OK:'ok',CANCELLED:'cancelled',UNKNOWN:'unknown',INVALID_ARGUMENT:'invalid-argument',DEADLINE_EXCEEDED:'deadline-exceeded',NOT_FOUND:'not-found',ALREADY_EXISTS:'already-exists',PERMISSION_DENIED:'permission-denied',UNAUTHENTICATED:'unauthenticated',RESOURCE_EXHAUSTED:'resource-exhausted',FAILED_PRECONDITION:'failed-precondition',ABORTED:'aborted',OUT_OF_RANGE:'out-of-range',UNIMPLEMENTED:'unimplemented',INTERNAL:'internal',UNAVAILABLE:'unavailable',DATA_LOSS:'data-loss'},FirestoreError=function(_super){function FirestoreError(code,message){var _this=_super.call(this,message)||this;return _this.code=code,_this.message=message,_this.name='FirebaseError',_this.toString=function(){return _this.name+': [code='+_this.code+']: '+_this.message},_this}return tslib_1.__extends(FirestoreError,_super),FirestoreError}(Error),AutoId=function(){function AutoId(){}return AutoId.newId=function(){for(var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',autoId='',i=0;20>i;i++)autoId+=chars.charAt(_Mathfloor(Math.random()*chars.length));return assert(20===autoId.length,'Invalid auto ID: '+autoId),autoId},AutoId}(),Blob=function(){function Blob(binaryString){assertBase64Available(),this._binaryString=binaryString}return Blob.fromBase64String=function(base64){validateExactNumberOfArgs('Blob.fromBase64String',arguments,1),validateArgType('Blob.fromBase64String','string',1,base64),assertBase64Available();try{var binaryString=PlatformSupport.getPlatform().atob(base64);return new Blob(binaryString)}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,'Failed to construct Blob from Base64 string: '+e)}},Blob.fromUint8Array=function(array){if(validateExactNumberOfArgs('Blob.fromUint8Array',arguments,1),assertUint8ArrayAvailable(),!(array instanceof Uint8Array))throw invalidClassError('Blob.fromUint8Array','Uint8Array',1,array);var binaryString=Array.prototype.map.call(array,function(char){return String.fromCharCode(char)}).join('');return new Blob(binaryString)},Blob.prototype.toBase64=function(){return validateExactNumberOfArgs('Blob.toBase64',arguments,0),assertBase64Available(),PlatformSupport.getPlatform().btoa(this._binaryString)},Blob.prototype.toUint8Array=function(){validateExactNumberOfArgs('Blob.toUint8Array',arguments,0),assertUint8ArrayAvailable();for(var buffer=new Uint8Array(this._binaryString.length),i=0;i<this._binaryString.length;i++)buffer[i]=this._binaryString.charCodeAt(i);return buffer},Blob.prototype.toString=function(){return'Blob(base64: '+this.toBase64()+')'},Blob.prototype.isEqual=function(other){return this._binaryString===other._binaryString},Blob.prototype._compareTo=function(other){return primitiveComparator(this._binaryString,other._binaryString)},Blob}(),PublicBlob=makeConstructorPrivate(Blob,'Use Blob.fromUint8Array() or Blob.fromBase64String() instead.'),GeoPoint=function(){function GeoPoint(latitude,longitude){if(validateExactNumberOfArgs('GeoPoint',arguments,2),validateArgType('GeoPoint','number',1,latitude),validateArgType('GeoPoint','number',2,longitude),!isFinite(latitude)||-90>latitude||90<latitude)throw new FirestoreError(Code.INVALID_ARGUMENT,'Latitude must be a number between -90 and 90, but was: '+latitude);if(!isFinite(longitude)||-180>longitude||180<longitude)throw new FirestoreError(Code.INVALID_ARGUMENT,'Longitude must be a number between -180 and 180, but was: '+longitude);this._lat=latitude,this._long=longitude}return Object.defineProperty(GeoPoint.prototype,'latitude',{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(GeoPoint.prototype,'longitude',{get:function(){return this._long},enumerable:!0,configurable:!0}),GeoPoint.prototype.isEqual=function(other){return this._lat===other._lat&&this._long===other._long},GeoPoint.prototype._compareTo=function(other){return primitiveComparator(this._lat,other._lat)||primitiveComparator(this._long,other._long)},GeoPoint}(),Timestamp=function(){function Timestamp(seconds,nanoseconds){if(this.seconds=seconds,this.nanoseconds=nanoseconds,0>nanoseconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp nanoseconds out of range: '+nanoseconds);if(1e9<=nanoseconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp nanoseconds out of range: '+nanoseconds);if(-62135596800>seconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp seconds out of range: '+seconds);if(253402300800<=seconds)throw new FirestoreError(Code.INVALID_ARGUMENT,'Timestamp seconds out of range: '+seconds)}return Timestamp.now=function(){return Timestamp.fromMillis(Date.now())},Timestamp.fromDate=function(date){return Timestamp.fromMillis(date.getTime())},Timestamp.fromMillis=function(milliseconds){var seconds=_Mathfloor(milliseconds/1e3);return new Timestamp(seconds,1e6*(milliseconds-1e3*seconds))},Timestamp.prototype.toDate=function(){return new Date(this.toMillis())},Timestamp.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Timestamp.prototype._compareTo=function(other){return this.seconds===other.seconds?primitiveComparator(this.nanoseconds,other.nanoseconds):primitiveComparator(this.seconds,other.seconds)},Timestamp.prototype.isEqual=function(other){return other.seconds===this.seconds&&other.nanoseconds===this.nanoseconds},Timestamp.prototype.toString=function(){return'Timestamp(seconds='+this.seconds+', nanoseconds='+this.nanoseconds+')'},Timestamp}(),DatabaseInfo=function(){return function DatabaseInfo(databaseId,persistenceKey,host,ssl){this.databaseId=databaseId,this.persistenceKey=persistenceKey,this.host=host,this.ssl=ssl}}(),DEFAULT_DATABASE_NAME='(default)',DatabaseId=function(){function DatabaseId(projectId,database){this.projectId=projectId,this.database=database?database:DEFAULT_DATABASE_NAME}return Object.defineProperty(DatabaseId.prototype,'isDefaultDatabase',{get:function(){return this.database===DEFAULT_DATABASE_NAME},enumerable:!0,configurable:!0}),DatabaseId.prototype.isEqual=function(other){return other instanceof DatabaseId&&other.projectId===this.projectId&&other.database===this.database},DatabaseId.prototype.compareTo=function(other){return primitiveComparator(this.projectId,other.projectId)||primitiveComparator(this.database,other.database)},DatabaseId}(),DOCUMENT_KEY_NAME='__name__',Path=function(){function Path(segments,offset,length){this.init(segments,offset,length)}return Path.prototype.init=function(segments,offset,length){void 0===offset?offset=0:offset>segments.length&&fail('offset '+offset+' out of range '+segments.length),void 0===length?length=segments.length-offset:length>segments.length-offset&&fail('length '+length+' out of range '+(segments.length-offset)),this.segments=segments,this.offset=offset,this.len=length},Path.prototype.construct=function(segments,offset,length){var path=Object.create(Object.getPrototypeOf(this));return path.init(segments,offset,length),path},Object.defineProperty(Path.prototype,'length',{get:function(){return this.len},enumerable:!0,configurable:!0}),Path.prototype.isEqual=function(other){return 0===Path.comparator(this,other)},Path.prototype.child=function(nameOrPath){var segments=this.segments.slice(this.offset,this.limit());return nameOrPath instanceof Path?nameOrPath.forEach(function(segment){segments.push(segment)}):'string'==typeof nameOrPath?segments.push(nameOrPath):fail('Unknown parameter type for Path.child(): '+nameOrPath),this.construct(segments)},Path.prototype.limit=function(){return this.offset+this.length},Path.prototype.popFirst=function(size){return size=void 0===size?1:size,assert(this.length>=size,'Can\'t call popFirst() with less segments'),this.construct(this.segments,this.offset+size,this.length-size)},Path.prototype.popLast=function(){return assert(!this.isEmpty(),'Can\'t call popLast() on empty path'),this.construct(this.segments,this.offset,this.length-1)},Path.prototype.firstSegment=function(){return assert(!this.isEmpty(),'Can\'t call firstSegment() on empty path'),this.segments[this.offset]},Path.prototype.lastSegment=function(){return assert(!this.isEmpty(),'Can\'t call lastSegment() on empty path'),this.segments[this.limit()-1]},Path.prototype.get=function(index){return assert(index<this.length,'Index out of range'),this.segments[this.offset+index]},Path.prototype.isEmpty=function(){return 0===this.length},Path.prototype.isPrefixOf=function(other){if(other.length<this.length)return!1;for(var i=0;i<this.length;i++)if(this.get(i)!==other.get(i))return!1;return!0},Path.prototype.isImmediateParentOf=function(potentialChild){if(this.length+1!==potentialChild.length)return!1;for(var i=0;i<this.length;i++)if(this.get(i)!==potentialChild.get(i))return!1;return!0},Path.prototype.forEach=function(fn){for(var i=this.offset,end=this.limit();i<end;i++)fn(this.segments[i])},Path.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},Path.comparator=function(p1,p2){for(var len=_Mathmin(p1.length,p2.length),i=0;i<len;i++){var left=p1.get(i),right=p2.get(i);if(left<right)return-1;if(left>right)return 1}return p1.length<p2.length?-1:p1.length>p2.length?1:0},Path}(),ResourcePath=function(_super){function ResourcePath(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(ResourcePath,_super),ResourcePath.prototype.canonicalString=function(){return this.toArray().join('/')},ResourcePath.prototype.toString=function(){return this.canonicalString()},ResourcePath.fromString=function(path){if(0<=path.indexOf('//'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid path ('+path+'). Paths must not contain // in them.');var segments=path.split('/').filter(function(segment){return 0<segment.length});return new ResourcePath(segments)},ResourcePath.EMPTY_PATH=new ResourcePath([]),ResourcePath}(Path),identifierRegExp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,FieldPath=function(_super){function FieldPath(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(FieldPath,_super),FieldPath.isValidIdentifier=function(segment){return identifierRegExp.test(segment)},FieldPath.prototype.canonicalString=function(){return this.toArray().map(function(str){return str=str.replace('\\','\\\\').replace('`','\\`'),FieldPath.isValidIdentifier(str)||(str='`'+str+'`'),str}).join('.')},FieldPath.prototype.toString=function(){return this.canonicalString()},FieldPath.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===DOCUMENT_KEY_NAME},FieldPath.keyField=function(){return new FieldPath([DOCUMENT_KEY_NAME])},FieldPath.fromServerFormat=function(path){for(var segments=[],current='',i=0,addCurrentSegment=function(){if(0===current.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field path ('+path+'). Paths must not be empty, begin '+'with \'.\', end with \'.\', or contain \'..\'');segments.push(current),current=''},inBackticks=!1,c;i<path.length;)if(c=path[i],'\\'===c){if(i+1===path.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Path has trailing escape character: '+path);var next=path[i+1];if('\\'!==next&&'.'!==next&&'`'!==next)throw new FirestoreError(Code.INVALID_ARGUMENT,'Path has invalid escape sequence: '+path);current+=next,i+=2}else'`'===c?(inBackticks=!inBackticks,i++):'.'!==c||inBackticks?(current+=c,i++):(addCurrentSegment(),i++);if(addCurrentSegment(),inBackticks)throw new FirestoreError(Code.INVALID_ARGUMENT,'Unterminated ` in path: '+path);return new FieldPath(segments)},FieldPath.EMPTY_PATH=new FieldPath([]),FieldPath}(Path),DocumentKey=function(){function DocumentKey(path){this.path=path,assert(DocumentKey.isDocumentKey(path),'Invalid DocumentKey with an odd number of segments: '+path.toArray().join('/'))}return DocumentKey.prototype.isEqual=function(other){return null!==other&&0===ResourcePath.comparator(this.path,other.path)},DocumentKey.prototype.toString=function(){return this.path.toString()},DocumentKey.comparator=function(k1,k2){return ResourcePath.comparator(k1.path,k2.path)},DocumentKey.isDocumentKey=function(path){return 0==path.length%2},DocumentKey.fromSegments=function(segments){return new DocumentKey(new ResourcePath(segments.slice()))},DocumentKey.fromPathString=function(path){return new DocumentKey(ResourcePath.fromString(path))},DocumentKey.EMPTY=new DocumentKey(new ResourcePath([])),DocumentKey}(),MaybeDocument=function(){function MaybeDocument(key,version){this.key=key,this.version=version}return MaybeDocument.compareByKey=function(d1,d2){return DocumentKey.comparator(d1.key,d2.key)},MaybeDocument}(),Document=function(_super){function Document(key,version,data,options){var _this=_super.call(this,key,version)||this;return _this.data=data,_this.hasLocalMutations=!!options.hasLocalMutations,_this.hasCommittedMutations=!!options.hasCommittedMutations,_this}return tslib_1.__extends(Document,_super),Document.prototype.field=function(path){return this.data.field(path)},Document.prototype.fieldValue=function(path){var field=this.field(path);return field?field.value():void 0},Document.prototype.value=function(){return this.data.value()},Document.prototype.isEqual=function(other){return other instanceof Document&&this.key.isEqual(other.key)&&this.version.isEqual(other.version)&&this.data.isEqual(other.data)&&this.hasLocalMutations===other.hasLocalMutations&&this.hasCommittedMutations===other.hasCommittedMutations},Document.prototype.toString=function(){return'Document('+this.key+', '+this.version+', '+this.data.toString()+', '+('{hasLocalMutations: '+this.hasLocalMutations+'}), ')+('{hasCommittedMutations: '+this.hasCommittedMutations+'})')},Object.defineProperty(Document.prototype,'hasPendingWrites',{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Document.compareByField=function(field,d1,d2){var v1=d1.field(field),v2=d2.field(field);return void 0!==v1&&void 0!==v2?v1.compareTo(v2):fail('Trying to compare documents on fields that don\'t exist')},Document}(MaybeDocument),NoDocument=function(_super){function NoDocument(key,version,options){var _this=_super.call(this,key,version)||this;return _this.hasCommittedMutations=!!(options&&options.hasCommittedMutations),_this}return tslib_1.__extends(NoDocument,_super),NoDocument.prototype.toString=function(){return'NoDocument('+this.key+', '+this.version+')'},Object.defineProperty(NoDocument.prototype,'hasPendingWrites',{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),NoDocument.prototype.isEqual=function(other){return other instanceof NoDocument&&other.hasCommittedMutations===this.hasCommittedMutations&&other.version.isEqual(this.version)&&other.key.isEqual(this.key)},NoDocument}(MaybeDocument),UnknownDocument=function(_super){function UnknownDocument(key,version){return _super.call(this,key,version)||this}return tslib_1.__extends(UnknownDocument,_super),UnknownDocument.prototype.toString=function(){return'UnknownDocument('+this.key+', '+this.version+')'},Object.defineProperty(UnknownDocument.prototype,'hasPendingWrites',{get:function(){return!0},enumerable:!0,configurable:!0}),UnknownDocument.prototype.isEqual=function(other){return other instanceof UnknownDocument&&other.version.isEqual(this.version)&&other.key.isEqual(this.key)},UnknownDocument}(MaybeDocument),SortedMap=function(){function SortedMap(comparator,root){this.comparator=comparator,this.root=root?root:LLRBNode.EMPTY}return SortedMap.prototype.insert=function(key,value){return new SortedMap(this.comparator,this.root.insert(key,value,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.remove=function(key){return new SortedMap(this.comparator,this.root.remove(key,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.get=function(key){for(var node=this.root,cmp;!node.isEmpty();){if(cmp=this.comparator(key,node.key),0===cmp)return node.value;0>cmp?node=node.left:0<cmp&&(node=node.right)}return null},SortedMap.prototype.indexOf=function(key){for(var prunedNodes=0,node=this.root,cmp;!node.isEmpty();){if(cmp=this.comparator(key,node.key),0===cmp)return prunedNodes+node.left.size;0>cmp?node=node.left:(prunedNodes+=node.left.size+1,node=node.right)}return-1},SortedMap.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(SortedMap.prototype,'size',{get:function(){return this.root.size},enumerable:!0,configurable:!0}),SortedMap.prototype.minKey=function(){return this.root.minKey()},SortedMap.prototype.maxKey=function(){return this.root.maxKey()},SortedMap.prototype.inorderTraversal=function(action){return this.root.inorderTraversal(action)},SortedMap.prototype.forEach=function(fn){this.inorderTraversal(function(k,v){return fn(k,v),!1})},SortedMap.prototype.reverseTraversal=function(action){return this.root.reverseTraversal(action)},SortedMap.prototype.getIterator=function(){return new SortedMapIterator(this.root,null,this.comparator,!1)},SortedMap.prototype.getIteratorFrom=function(key){return new SortedMapIterator(this.root,key,this.comparator,!1)},SortedMap.prototype.getReverseIterator=function(){return new SortedMapIterator(this.root,null,this.comparator,!0)},SortedMap.prototype.getReverseIteratorFrom=function(key){return new SortedMapIterator(this.root,key,this.comparator,!0)},SortedMap}(),SortedMapIterator=function(){function SortedMapIterator(node,startKey,comparator,isReverse){this.isReverse=isReverse,this.nodeStack=[];for(var cmp=1;!node.isEmpty();)if(cmp=startKey?comparator(node.key,startKey):1,isReverse&&(cmp*=-1),0>cmp)node=this.isReverse?node.left:node.right;else if(0===cmp){this.nodeStack.push(node);break}else this.nodeStack.push(node),node=this.isReverse?node.right:node.left}return SortedMapIterator.prototype.getNext=function(){assert(0<this.nodeStack.length,'getNext() called on iterator when hasNext() is false.');var node=this.nodeStack.pop(),result={key:node.key,value:node.value};if(this.isReverse)for(node=node.left;!node.isEmpty();)this.nodeStack.push(node),node=node.right;else for(node=node.right;!node.isEmpty();)this.nodeStack.push(node),node=node.left;return result},SortedMapIterator.prototype.hasNext=function(){return 0<this.nodeStack.length},SortedMapIterator.prototype.peek=function(){if(0===this.nodeStack.length)return null;var node=this.nodeStack[this.nodeStack.length-1];return{key:node.key,value:node.value}},SortedMapIterator}(),LLRBNode=function(){function LLRBNode(key,value,color,left,right){this.key=key,this.value=value,this.color=null==color?LLRBNode.RED:color,this.left=null==left?LLRBNode.EMPTY:left,this.right=null==right?LLRBNode.EMPTY:right,this.size=this.left.size+1+this.right.size}return LLRBNode.prototype.copy=function(key,value,color,left,right){return new LLRBNode(null==key?this.key:key,null==value?this.value:value,null==color?this.color:color,null==left?this.left:left,null==right?this.right:right)},LLRBNode.prototype.isEmpty=function(){return!1},LLRBNode.prototype.inorderTraversal=function(action){return this.left.inorderTraversal(action)||action(this.key,this.value)||this.right.inorderTraversal(action)},LLRBNode.prototype.reverseTraversal=function(action){return this.right.reverseTraversal(action)||action(this.key,this.value)||this.left.reverseTraversal(action)},LLRBNode.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},LLRBNode.prototype.minKey=function(){return this.min().key},LLRBNode.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},LLRBNode.prototype.insert=function(key,value,comparator){var n=this,cmp=comparator(key,n.key);return n=0>cmp?n.copy(null,null,null,n.left.insert(key,value,comparator),null):0===cmp?n.copy(null,value,null,null,null):n.copy(null,null,null,null,n.right.insert(key,value,comparator)),n.fixUp()},LLRBNode.prototype.removeMin=function(){if(this.left.isEmpty())return LLRBNode.EMPTY;var n=this;return n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.removeMin(),null),n.fixUp()},LLRBNode.prototype.remove=function(key,comparator){var n=this,smallest;if(0>comparator(key,n.key))n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(key,comparator),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===comparator(key,n.key)){if(n.right.isEmpty())return LLRBNode.EMPTY;smallest=n.right.min(),n=n.copy(smallest.key,smallest.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(key,comparator))}return n.fixUp()},LLRBNode.prototype.isRed=function(){return this.color},LLRBNode.prototype.fixUp=function(){var n=this;return n.right.isRed()&&!n.left.isRed()&&(n=n.rotateLeft()),n.left.isRed()&&n.left.left.isRed()&&(n=n.rotateRight()),n.left.isRed()&&n.right.isRed()&&(n=n.colorFlip()),n},LLRBNode.prototype.moveRedLeft=function(){var n=this.colorFlip();return n.right.left.isRed()&&(n=n.copy(null,null,null,null,n.right.rotateRight()),n=n.rotateLeft(),n=n.colorFlip()),n},LLRBNode.prototype.moveRedRight=function(){var n=this.colorFlip();return n.left.left.isRed()&&(n=n.rotateRight(),n=n.colorFlip()),n},LLRBNode.prototype.rotateLeft=function(){var nl=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,nl,null)},LLRBNode.prototype.rotateRight=function(){var nr=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,nr)},LLRBNode.prototype.colorFlip=function(){var left=this.left.copy(null,null,!this.left.color,null,null),right=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,left,right)},LLRBNode.prototype.checkMaxDepth=function(){var blackDepth=this.check();return!!(Math.pow(2,blackDepth)<=this.size+1)},LLRBNode.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw fail('Red node has red child('+this.key+','+this.value+')');if(this.right.isRed())throw fail('Right child of ('+this.key+','+this.value+') is red');var blackDepth=this.left.check();if(blackDepth!==this.right.check())throw fail('Black depths differ');else return blackDepth+(this.isRed()?0:1)},LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode}(),LLRBEmptyNode=function(){function LLRBEmptyNode(){this.size=0}return LLRBEmptyNode.prototype.copy=function(){return this},LLRBEmptyNode.prototype.insert=function(key,value){return new LLRBNode(key,value)},LLRBEmptyNode.prototype.remove=function(){return this},LLRBEmptyNode.prototype.isEmpty=function(){return!0},LLRBEmptyNode.prototype.inorderTraversal=function(){return!1},LLRBEmptyNode.prototype.reverseTraversal=function(){return!1},LLRBEmptyNode.prototype.minKey=function(){return null},LLRBEmptyNode.prototype.maxKey=function(){return null},LLRBEmptyNode.prototype.isRed=function(){return!1},LLRBEmptyNode.prototype.checkMaxDepth=function(){return!0},LLRBEmptyNode.prototype.check=function(){return 0},LLRBEmptyNode}();LLRBNode.EMPTY=new LLRBEmptyNode;var TypeOrder;(function(TypeOrder){TypeOrder[TypeOrder.NullValue=0]='NullValue',TypeOrder[TypeOrder.BooleanValue=1]='BooleanValue',TypeOrder[TypeOrder.NumberValue=2]='NumberValue',TypeOrder[TypeOrder.TimestampValue=3]='TimestampValue',TypeOrder[TypeOrder.StringValue=4]='StringValue',TypeOrder[TypeOrder.BlobValue=5]='BlobValue',TypeOrder[TypeOrder.RefValue=6]='RefValue',TypeOrder[TypeOrder.GeoPointValue=7]='GeoPointValue',TypeOrder[TypeOrder.ArrayValue=8]='ArrayValue',TypeOrder[TypeOrder.ObjectValue=9]='ObjectValue'})(TypeOrder||(TypeOrder={}));var ServerTimestampBehavior;(function(ServerTimestampBehavior){ServerTimestampBehavior[ServerTimestampBehavior.Default=0]='Default',ServerTimestampBehavior[ServerTimestampBehavior.Estimate=1]='Estimate',ServerTimestampBehavior[ServerTimestampBehavior.Previous=2]='Previous'})(ServerTimestampBehavior||(ServerTimestampBehavior={}));var FieldValueOptions=function(){function FieldValueOptions(serverTimestampBehavior,timestampsInSnapshots){this.serverTimestampBehavior=serverTimestampBehavior,this.timestampsInSnapshots=timestampsInSnapshots}return FieldValueOptions.fromSnapshotOptions=function(options,timestampsInSnapshots){switch(options.serverTimestamps){case'estimate':return new FieldValueOptions(ServerTimestampBehavior.Estimate,timestampsInSnapshots);case'previous':return new FieldValueOptions(ServerTimestampBehavior.Previous,timestampsInSnapshots);case'none':case void 0:return new FieldValueOptions(ServerTimestampBehavior.Default,timestampsInSnapshots);default:return fail('fromSnapshotOptions() called with invalid options.');}},FieldValueOptions}(),FieldValue=function(){function FieldValue(){}return FieldValue.prototype.toString=function(){var val=this.value();return null===val?'null':val.toString()},FieldValue.prototype.defaultCompareTo=function(other){assert(this.typeOrder!==other.typeOrder,'Default compareTo should not be used for values of same type.');var cmp=primitiveComparator(this.typeOrder,other.typeOrder);return cmp},FieldValue}(),NullValue=function(_super){function NullValue(){var _this=_super.call(this)||this;return _this.typeOrder=TypeOrder.NullValue,_this.internalValue=null,_this}return tslib_1.__extends(NullValue,_super),NullValue.prototype.value=function(){return null},NullValue.prototype.isEqual=function(other){return other instanceof NullValue},NullValue.prototype.compareTo=function(other){return other instanceof NullValue?0:this.defaultCompareTo(other)},NullValue.INSTANCE=new NullValue,NullValue}(FieldValue),BooleanValue=function(_super){function BooleanValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.BooleanValue,_this}return tslib_1.__extends(BooleanValue,_super),BooleanValue.prototype.value=function(){return this.internalValue},BooleanValue.prototype.isEqual=function(other){return other instanceof BooleanValue&&this.internalValue===other.internalValue},BooleanValue.prototype.compareTo=function(other){return other instanceof BooleanValue?primitiveComparator(this,other):this.defaultCompareTo(other)},BooleanValue.of=function(value){return value?BooleanValue.TRUE:BooleanValue.FALSE},BooleanValue.TRUE=new BooleanValue(!0),BooleanValue.FALSE=new BooleanValue(!1),BooleanValue}(FieldValue),NumberValue=function(_super){function NumberValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.NumberValue,_this}return tslib_1.__extends(NumberValue,_super),NumberValue.prototype.value=function(){return this.internalValue},NumberValue.prototype.compareTo=function(other){return other instanceof NumberValue?numericComparator(this.internalValue,other.internalValue):this.defaultCompareTo(other)},NumberValue}(FieldValue),IntegerValue=function(_super){function IntegerValue(internalValue){return _super.call(this,internalValue)||this}return tslib_1.__extends(IntegerValue,_super),IntegerValue.prototype.isEqual=function(other){return!!(other instanceof IntegerValue)&&numericEquals(this.internalValue,other.internalValue)},IntegerValue}(NumberValue),DoubleValue=function(_super){function DoubleValue(internalValue){var _this=_super.call(this,internalValue)||this;return _this.internalValue=internalValue,_this}return tslib_1.__extends(DoubleValue,_super),DoubleValue.prototype.isEqual=function(other){return!!(other instanceof DoubleValue)&&numericEquals(this.internalValue,other.internalValue)},DoubleValue.NAN=new DoubleValue(NaN),DoubleValue.POSITIVE_INFINITY=new DoubleValue(Infinity),DoubleValue.NEGATIVE_INFINITY=new DoubleValue(-Infinity),DoubleValue}(NumberValue),StringValue=function(_super){function StringValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.StringValue,_this}return tslib_1.__extends(StringValue,_super),StringValue.prototype.value=function(){return this.internalValue},StringValue.prototype.isEqual=function(other){return other instanceof StringValue&&this.internalValue===other.internalValue},StringValue.prototype.compareTo=function(other){return other instanceof StringValue?primitiveComparator(this.internalValue,other.internalValue):this.defaultCompareTo(other)},StringValue}(FieldValue),TimestampValue=function(_super){function TimestampValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.TimestampValue,_this}return tslib_1.__extends(TimestampValue,_super),TimestampValue.prototype.value=function(options){return options&&options.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},TimestampValue.prototype.isEqual=function(other){return other instanceof TimestampValue&&this.internalValue.isEqual(other.internalValue)},TimestampValue.prototype.compareTo=function(other){return other instanceof TimestampValue?this.internalValue._compareTo(other.internalValue):other instanceof ServerTimestampValue?-1:this.defaultCompareTo(other)},TimestampValue}(FieldValue),ServerTimestampValue=function(_super){function ServerTimestampValue(localWriteTime,previousValue){var _this=_super.call(this)||this;return _this.localWriteTime=localWriteTime,_this.previousValue=previousValue,_this.typeOrder=TypeOrder.TimestampValue,_this}return tslib_1.__extends(ServerTimestampValue,_super),ServerTimestampValue.prototype.value=function(options){return options&&options.serverTimestampBehavior===ServerTimestampBehavior.Estimate?new TimestampValue(this.localWriteTime).value(options):options&&options.serverTimestampBehavior===ServerTimestampBehavior.Previous?this.previousValue?this.previousValue.value(options):null:null},ServerTimestampValue.prototype.isEqual=function(other){return other instanceof ServerTimestampValue&&this.localWriteTime.isEqual(other.localWriteTime)},ServerTimestampValue.prototype.compareTo=function(other){return other instanceof ServerTimestampValue?this.localWriteTime._compareTo(other.localWriteTime):other instanceof TimestampValue?1:this.defaultCompareTo(other)},ServerTimestampValue.prototype.toString=function(){return'<ServerTimestamp localTime='+this.localWriteTime.toString()+'>'},ServerTimestampValue}(FieldValue),BlobValue=function(_super){function BlobValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.BlobValue,_this}return tslib_1.__extends(BlobValue,_super),BlobValue.prototype.value=function(){return this.internalValue},BlobValue.prototype.isEqual=function(other){return other instanceof BlobValue&&this.internalValue.isEqual(other.internalValue)},BlobValue.prototype.compareTo=function(other){return other instanceof BlobValue?this.internalValue._compareTo(other.internalValue):this.defaultCompareTo(other)},BlobValue}(FieldValue),RefValue=function(_super){function RefValue(databaseId,key){var _this=_super.call(this)||this;return _this.databaseId=databaseId,_this.key=key,_this.typeOrder=TypeOrder.RefValue,_this}return tslib_1.__extends(RefValue,_super),RefValue.prototype.value=function(){return this.key},RefValue.prototype.isEqual=function(other){return!!(other instanceof RefValue)&&this.key.isEqual(other.key)&&this.databaseId.isEqual(other.databaseId)},RefValue.prototype.compareTo=function(other){if(other instanceof RefValue){var cmp=this.databaseId.compareTo(other.databaseId);return 0===cmp?DocumentKey.comparator(this.key,other.key):cmp}return this.defaultCompareTo(other)},RefValue}(FieldValue),GeoPointValue=function(_super){function GeoPointValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.GeoPointValue,_this}return tslib_1.__extends(GeoPointValue,_super),GeoPointValue.prototype.value=function(){return this.internalValue},GeoPointValue.prototype.isEqual=function(other){return other instanceof GeoPointValue&&this.internalValue.isEqual(other.internalValue)},GeoPointValue.prototype.compareTo=function(other){return other instanceof GeoPointValue?this.internalValue._compareTo(other.internalValue):this.defaultCompareTo(other)},GeoPointValue}(FieldValue),ObjectValue=function(_super){function ObjectValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.ObjectValue,_this}return tslib_1.__extends(ObjectValue,_super),ObjectValue.prototype.value=function(options){var result={};return this.internalValue.inorderTraversal(function(key,val){result[key]=val.value(options)}),result},ObjectValue.prototype.forEach=function(action){this.internalValue.inorderTraversal(action)},ObjectValue.prototype.isEqual=function(other){if(other instanceof ObjectValue){for(var it1=this.internalValue.getIterator(),it2=other.internalValue.getIterator();it1.hasNext()&&it2.hasNext();){var next1=it1.getNext(),next2=it2.getNext();if(next1.key!==next2.key||!next1.value.isEqual(next2.value))return!1}return!it1.hasNext()&&!it2.hasNext()}return!1},ObjectValue.prototype.compareTo=function(other){if(other instanceof ObjectValue){for(var it1=this.internalValue.getIterator(),it2=other.internalValue.getIterator();it1.hasNext()&&it2.hasNext();){var next1=it1.getNext(),next2=it2.getNext(),cmp=primitiveComparator(next1.key,next2.key)||next1.value.compareTo(next2.value);if(cmp)return cmp}return primitiveComparator(it1.hasNext(),it2.hasNext())}return this.defaultCompareTo(other)},ObjectValue.prototype.set=function(path,to){if(assert(!path.isEmpty(),'Cannot set field for empty path on ObjectValue'),1===path.length)return this.setChild(path.firstSegment(),to);var child=this.child(path.firstSegment());child instanceof ObjectValue||(child=ObjectValue.EMPTY);var newChild=child.set(path.popFirst(),to);return this.setChild(path.firstSegment(),newChild)},ObjectValue.prototype.delete=function(path){if(assert(!path.isEmpty(),'Cannot delete field for empty path on ObjectValue'),1===path.length)return new ObjectValue(this.internalValue.remove(path.firstSegment()));var child=this.child(path.firstSegment());if(child instanceof ObjectValue){var newChild=child.delete(path.popFirst());return new ObjectValue(this.internalValue.insert(path.firstSegment(),newChild))}return this},ObjectValue.prototype.contains=function(path){return void 0!==this.field(path)},ObjectValue.prototype.field=function(path){assert(!path.isEmpty(),'Can\'t get field of empty path');var field=this;return path.forEach(function(pathSegment){field=field instanceof ObjectValue?field.internalValue.get(pathSegment)||void 0:void 0}),field},ObjectValue.prototype.toString=function(){return JSON.stringify(this.value())},ObjectValue.prototype.child=function(childName){return this.internalValue.get(childName)||void 0},ObjectValue.prototype.setChild=function(childName,value){return new ObjectValue(this.internalValue.insert(childName,value))},ObjectValue.EMPTY=new ObjectValue(new SortedMap(primitiveComparator)),ObjectValue}(FieldValue),ArrayValue=function(_super){function ArrayValue(internalValue){var _this=_super.call(this)||this;return _this.internalValue=internalValue,_this.typeOrder=TypeOrder.ArrayValue,_this}return tslib_1.__extends(ArrayValue,_super),ArrayValue.prototype.value=function(options){return this.internalValue.map(function(v){return v.value(options)})},ArrayValue.prototype.forEach=function(action){this.internalValue.forEach(action)},ArrayValue.prototype.isEqual=function(other){if(other instanceof ArrayValue){if(this.internalValue.length!==other.internalValue.length)return!1;for(var i=0;i<this.internalValue.length;i++)if(!this.internalValue[i].isEqual(other.internalValue[i]))return!1;return!0}return!1},ArrayValue.prototype.compareTo=function(other){if(other instanceof ArrayValue){for(var minLength=_Mathmin(this.internalValue.length,other.internalValue.length),i=0,cmp;i<minLength;i++)if(cmp=this.internalValue[i].compareTo(other.internalValue[i]),cmp)return cmp;return primitiveComparator(this.internalValue.length,other.internalValue.length)}return this.defaultCompareTo(other)},ArrayValue.prototype.toString=function(){return JSON.stringify(this.value())},ArrayValue}(FieldValue),NumberAsAny=Number,MIN_SAFE_INTEGER=NumberAsAny.MIN_SAFE_INTEGER||-(9007199254740992-1),MAX_SAFE_INTEGER=NumberAsAny.MAX_SAFE_INTEGER||9007199254740992-1,isInteger=NumberAsAny.isInteger||function(value){return'number'==typeof value&&isFinite(value)&&_Mathfloor(value)===value},Query=function(){function Query(path,explicitOrderBy,filters,limit,startAt,endAt){void 0===explicitOrderBy&&(explicitOrderBy=[]),void 0===filters&&(filters=[]),void 0===limit&&(limit=null),void 0===startAt&&(startAt=null),void 0===endAt&&(endAt=null),this.path=path,this.explicitOrderBy=explicitOrderBy,this.filters=filters,this.limit=limit,this.startAt=startAt,this.endAt=endAt,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return Query.atPath=function(path){return new Query(path)},Object.defineProperty(Query.prototype,'orderBy',{get:function(){if(null===this.memoizedOrderBy){var inequalityField=this.getInequalityFilterField(),firstOrderByField=this.getFirstOrderByField();if(null!==inequalityField&&null===firstOrderByField)this.memoizedOrderBy=inequalityField.isKeyField()?[KEY_ORDERING_ASC]:[new OrderBy(inequalityField),KEY_ORDERING_ASC];else{assert(null===inequalityField||null!==firstOrderByField&&inequalityField.isEqual(firstOrderByField),'First orderBy should match inequality field.'),this.memoizedOrderBy=[];for(var foundKeyOrdering=!1,_i=0,_a=this.explicitOrderBy,orderBy;_i<_a.length;_i++)orderBy=_a[_i],this.memoizedOrderBy.push(orderBy),orderBy.field.isKeyField()&&(foundKeyOrdering=!0);if(!foundKeyOrdering){var lastDirection=0<this.explicitOrderBy.length?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Direction.ASCENDING;this.memoizedOrderBy.push(lastDirection===Direction.ASCENDING?KEY_ORDERING_ASC:KEY_ORDERING_DESC)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),Query.prototype.addFilter=function(filter){assert(null==this.getInequalityFilterField()||!(filter instanceof RelationFilter)||!filter.isInequality()||filter.field.isEqual(this.getInequalityFilterField()),'Query must only have one inequality field.'),assert(!DocumentKey.isDocumentKey(this.path),'No filtering allowed for document query');var newFilters=this.filters.concat([filter]);return new Query(this.path,this.explicitOrderBy.slice(),newFilters,this.limit,this.startAt,this.endAt)},Query.prototype.addOrderBy=function(orderBy){assert(!DocumentKey.isDocumentKey(this.path),'No ordering allowed for document query'),assert(!this.startAt&&!this.endAt,'Bounds must be set after orderBy');var newOrderBy=this.explicitOrderBy.concat([orderBy]);return new Query(this.path,newOrderBy,this.filters.slice(),this.limit,this.startAt,this.endAt)},Query.prototype.withLimit=function(limit){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),limit,this.startAt,this.endAt)},Query.prototype.withStartAt=function(bound){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,bound,this.endAt)},Query.prototype.withEndAt=function(bound){return new Query(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,bound)},Query.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var canonicalId=this.path.canonicalString();canonicalId+='|f:';for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)filter=_a[_i],canonicalId+=filter.canonicalId(),canonicalId+=',';canonicalId+='|ob:';for(var _b=0,_c=this.orderBy,orderBy;_b<_c.length;_b++)orderBy=_c[_b],canonicalId+=orderBy.canonicalId(),canonicalId+=',';isNullOrUndefined(this.limit)||(canonicalId+='|l:',canonicalId+=this.limit),this.startAt&&(canonicalId+='|lb:',canonicalId+=this.startAt.canonicalId()),this.endAt&&(canonicalId+='|ub:',canonicalId+=this.endAt.canonicalId()),this.memoizedCanonicalId=canonicalId}return this.memoizedCanonicalId},Query.prototype.toString=function(){var str='Query('+this.path.canonicalString();return 0<this.filters.length&&(str+=', filters: ['+this.filters.join(', ')+']'),isNullOrUndefined(this.limit)||(str+=', limit: '+this.limit),0<this.explicitOrderBy.length&&(str+=', orderBy: ['+this.explicitOrderBy.join(', ')+']'),this.startAt&&(str+=', startAt: '+this.startAt.canonicalId()),this.endAt&&(str+=', endAt: '+this.endAt.canonicalId()),str+')'},Query.prototype.isEqual=function(other){if(this.limit!==other.limit)return!1;if(this.orderBy.length!==other.orderBy.length)return!1;for(var i=0;i<this.orderBy.length;i++)if(!this.orderBy[i].isEqual(other.orderBy[i]))return!1;if(this.filters.length!==other.filters.length)return!1;for(var i=0;i<this.filters.length;i++)if(!this.filters[i].isEqual(other.filters[i]))return!1;return!!this.path.isEqual(other.path)&&(null===this.startAt?null===other.startAt:!!this.startAt.isEqual(other.startAt))&&(null===this.endAt?null===other.endAt:this.endAt.isEqual(other.endAt))},Query.prototype.docComparator=function(d1,d2){for(var comparedOnKeyField=!1,_i=0,_a=this.orderBy;_i<_a.length;_i++){var orderBy=_a[_i],comp=orderBy.compare(d1,d2);if(0!==comp)return comp;comparedOnKeyField=comparedOnKeyField||orderBy.field.isKeyField()}return assert(comparedOnKeyField,'orderBy used that doesn\'t compare on key field'),0},Query.prototype.matches=function(doc){return this.matchesAncestor(doc)&&this.matchesOrderBy(doc)&&this.matchesFilters(doc)&&this.matchesBounds(doc)},Query.prototype.hasLimit=function(){return!isNullOrUndefined(this.limit)},Query.prototype.getFirstOrderByField=function(){return 0<this.explicitOrderBy.length?this.explicitOrderBy[0].field:null},Query.prototype.getInequalityFilterField=function(){for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)if(filter=_a[_i],filter instanceof RelationFilter&&filter.isInequality())return filter.field;return null},Query.prototype.hasArrayContainsFilter=function(){return void 0!==this.filters.find(function(filter){return filter instanceof RelationFilter&&filter.op===RelationOp.ARRAY_CONTAINS})},Query.prototype.isDocumentQuery=function(){return DocumentKey.isDocumentKey(this.path)&&0===this.filters.length},Query.prototype.matchesAncestor=function(doc){var docPath=doc.key.path;return DocumentKey.isDocumentKey(this.path)?this.path.isEqual(docPath):this.path.isPrefixOf(docPath)&&this.path.length===docPath.length-1},Query.prototype.matchesOrderBy=function(doc){for(var _i=0,_a=this.explicitOrderBy,orderBy;_i<_a.length;_i++)if(orderBy=_a[_i],!orderBy.field.isKeyField()&&void 0===doc.field(orderBy.field))return!1;return!0},Query.prototype.matchesFilters=function(doc){for(var _i=0,_a=this.filters,filter;_i<_a.length;_i++)if(filter=_a[_i],!filter.matches(doc))return!1;return!0},Query.prototype.matchesBounds=function(doc){return this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,doc)?!1:this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,doc)?!1:!0},Query.prototype.assertValidBound=function(bound){assert(bound.position.length<=this.orderBy.length,'Bound is longer than orderBy')},Query}(),Filter=function(){function Filter(){}return Filter.create=function(field,op,value){if(value.isEqual(NullValue.INSTANCE)){if(op!==RelationOp.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You can only perform equals comparisons on null.');return new NullFilter(field)}if(value.isEqual(DoubleValue.NAN)){if(op!==RelationOp.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You can only perform equals comparisons on NaN.');return new NanFilter(field)}return new RelationFilter(field,op,value)},Filter}(),RelationOp=function(){function RelationOp(name){this.name=name}return RelationOp.fromString=function(op){return'<'===op?RelationOp.LESS_THAN:'<='===op?RelationOp.LESS_THAN_OR_EQUAL:'=='===op?RelationOp.EQUAL:'>='===op?RelationOp.GREATER_THAN_OR_EQUAL:'>'===op?RelationOp.GREATER_THAN:'array-contains'===op?RelationOp.ARRAY_CONTAINS:fail('Unknown relation: '+op)},RelationOp.prototype.toString=function(){return this.name},RelationOp.prototype.isEqual=function(other){return this.name===other.name},RelationOp.LESS_THAN=new RelationOp('<'),RelationOp.LESS_THAN_OR_EQUAL=new RelationOp('<='),RelationOp.EQUAL=new RelationOp('=='),RelationOp.GREATER_THAN=new RelationOp('>'),RelationOp.GREATER_THAN_OR_EQUAL=new RelationOp('>='),RelationOp.ARRAY_CONTAINS=new RelationOp('array-contains'),RelationOp}(),RelationFilter=function(_super){function RelationFilter(field,op,value){var _this=_super.call(this)||this;return _this.field=field,_this.op=op,_this.value=value,_this}return tslib_1.__extends(RelationFilter,_super),RelationFilter.prototype.matches=function(doc){if(this.field.isKeyField()){assert(this.value instanceof RefValue,'Comparing on key, but filter value not a RefValue'),assert(this.op!==RelationOp.ARRAY_CONTAINS,'array-contains queries don\'t make sense on document keys.');var refValue=this.value,comparison=DocumentKey.comparator(doc.key,refValue.key);return this.matchesComparison(comparison)}var val=doc.field(this.field);return void 0!==val&&this.matchesValue(val)},RelationFilter.prototype.matchesValue=function(value){var _this=this;return this.op===RelationOp.ARRAY_CONTAINS?value instanceof ArrayValue&&void 0!==value.internalValue.find(function(element){return element.isEqual(_this.value)}):this.value.typeOrder===value.typeOrder&&this.matchesComparison(value.compareTo(this.value))},RelationFilter.prototype.matchesComparison=function(comparison){switch(this.op){case RelationOp.LESS_THAN:return 0>comparison;case RelationOp.LESS_THAN_OR_EQUAL:return 0>=comparison;case RelationOp.EQUAL:return 0===comparison;case RelationOp.GREATER_THAN:return 0<comparison;case RelationOp.GREATER_THAN_OR_EQUAL:return 0<=comparison;default:return fail('Unknown relation op'+this.op);}},RelationFilter.prototype.isInequality=function(){return this.op!==RelationOp.EQUAL&&this.op!==RelationOp.ARRAY_CONTAINS},RelationFilter.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},RelationFilter.prototype.isEqual=function(other){return!!(other instanceof RelationFilter)&&this.op.isEqual(other.op)&&this.field.isEqual(other.field)&&this.value.isEqual(other.value)},RelationFilter.prototype.toString=function(){return this.field.canonicalString()+' '+this.op+' '+this.value.value()},RelationFilter}(Filter),NullFilter=function(_super){function NullFilter(field){var _this=_super.call(this)||this;return _this.field=field,_this}return tslib_1.__extends(NullFilter,_super),NullFilter.prototype.matches=function(doc){var val=doc.field(this.field);return void 0!==val&&null===val.value()},NullFilter.prototype.canonicalId=function(){return this.field.canonicalString()+' IS null'},NullFilter.prototype.toString=function(){return this.field.canonicalString()+' IS null'},NullFilter.prototype.isEqual=function(other){return!!(other instanceof NullFilter)&&this.field.isEqual(other.field)},NullFilter}(Filter),NanFilter=function(_super){function NanFilter(field){var _this=_super.call(this)||this;return _this.field=field,_this}return tslib_1.__extends(NanFilter,_super),NanFilter.prototype.matches=function(doc){var field=doc.field(this.field),val=field&&field.value();return'number'==typeof val&&isNaN(val)},NanFilter.prototype.canonicalId=function(){return this.field.canonicalString()+' IS NaN'},NanFilter.prototype.toString=function(){return this.field.canonicalString()+' IS NaN'},NanFilter.prototype.isEqual=function(other){return!!(other instanceof NanFilter)&&this.field.isEqual(other.field)},NanFilter}(Filter),Direction=function(){function Direction(name){this.name=name}return Direction.prototype.toString=function(){return this.name},Direction.ASCENDING=new Direction('asc'),Direction.DESCENDING=new Direction('desc'),Direction}(),Bound=function(){function Bound(position,before){this.position=position,this.before=before}return Bound.prototype.canonicalId=function(){for(var canonicalId=this.before?'b:':'a:',_i=0,_a=this.position,component;_i<_a.length;_i++)component=_a[_i],canonicalId+=component.toString();return canonicalId},Bound.prototype.sortsBeforeDocument=function(orderBy,doc){assert(this.position.length<=orderBy.length,'Bound has more components than query\'s orderBy');for(var comparison=0,i=0;i<this.position.length;i++){var orderByComponent=orderBy[i],component=this.position[i];if(orderByComponent.field.isKeyField())assert(component instanceof RefValue,'Bound has a non-key value where the key path is being used.'),comparison=DocumentKey.comparator(component.key,doc.key);else{var docValue=doc.field(orderByComponent.field);assert(void 0!==docValue,'Field should exist since document matched the orderBy already.'),comparison=component.compareTo(docValue)}if(orderByComponent.dir===Direction.DESCENDING&&(comparison*=-1),0!==comparison)break}return this.before?0>=comparison:0>comparison},Bound.prototype.isEqual=function(other){if(null===other)return!1;if(this.before!==other.before||this.position.length!==other.position.length)return!1;for(var i=0;i<this.position.length;i++){var thisPosition=this.position[i],otherPosition=other.position[i];return thisPosition.isEqual(otherPosition)}return!0},Bound}(),OrderBy=function(){function OrderBy(field,dir){this.field=field,void 0===dir&&(dir=Direction.ASCENDING),this.dir=dir,this.isKeyOrderBy=field.isKeyField()}return OrderBy.prototype.compare=function(d1,d2){var comparison=this.isKeyOrderBy?Document.compareByKey(d1,d2):Document.compareByField(this.field,d1,d2);switch(this.dir){case Direction.ASCENDING:return comparison;case Direction.DESCENDING:return-1*comparison;default:return fail('Unknown direction: '+this.dir);}},OrderBy.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},OrderBy.prototype.toString=function(){return this.field.canonicalString()+' ('+this.dir+')'},OrderBy.prototype.isEqual=function(other){return this.dir===other.dir&&this.field.isEqual(other.field)},OrderBy}(),KEY_ORDERING_ASC=new OrderBy(FieldPath.keyField(),Direction.ASCENDING),KEY_ORDERING_DESC=new OrderBy(FieldPath.keyField(),Direction.DESCENDING),SnapshotVersion=function(){function SnapshotVersion(timestamp){this.timestamp=timestamp}return SnapshotVersion.fromMicroseconds=function(value){var seconds=_Mathfloor(value/1e6);return new SnapshotVersion(new Timestamp(seconds,1e3*(value%1e6)))},SnapshotVersion.fromTimestamp=function(value){return new SnapshotVersion(value)},SnapshotVersion.forDeletedDoc=function(){return SnapshotVersion.MIN},SnapshotVersion.prototype.compareTo=function(other){return this.timestamp._compareTo(other.timestamp)},SnapshotVersion.prototype.isEqual=function(other){return this.timestamp.isEqual(other.timestamp)},SnapshotVersion.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},SnapshotVersion.prototype.toString=function(){return'SnapshotVersion('+this.timestamp.toString()+')'},SnapshotVersion.prototype.toTimestamp=function(){return this.timestamp},SnapshotVersion.MIN=new SnapshotVersion(new Timestamp(0,0)),SnapshotVersion}(),QueryPurpose;(function(QueryPurpose){QueryPurpose[QueryPurpose.Listen=0]='Listen',QueryPurpose[QueryPurpose.ExistenceFilterMismatch=1]='ExistenceFilterMismatch',QueryPurpose[QueryPurpose.LimboResolution=2]='LimboResolution'})(QueryPurpose||(QueryPurpose={}));var QueryData=function(){function QueryData(query,targetId,purpose,sequenceNumber,snapshotVersion,resumeToken){void 0===snapshotVersion&&(snapshotVersion=SnapshotVersion.MIN),void 0===resumeToken&&(resumeToken=emptyByteString()),this.query=query,this.targetId=targetId,this.purpose=purpose,this.sequenceNumber=sequenceNumber,this.snapshotVersion=snapshotVersion,this.resumeToken=resumeToken}return QueryData.prototype.copy=function(overwrite){return new QueryData(this.query,this.targetId,this.purpose,void 0===overwrite.sequenceNumber?this.sequenceNumber:overwrite.sequenceNumber,void 0===overwrite.snapshotVersion?this.snapshotVersion:overwrite.snapshotVersion,void 0===overwrite.resumeToken?this.resumeToken:overwrite.resumeToken)},QueryData.prototype.isEqual=function(other){return this.targetId===other.targetId&&this.purpose===other.purpose&&this.sequenceNumber===other.sequenceNumber&&this.snapshotVersion.isEqual(other.snapshotVersion)&&this.resumeToken===other.resumeToken&&this.query.isEqual(other.query)},QueryData}(),FieldMask=function(){function FieldMask(fields){this.fields=fields}return FieldMask.prototype.covers=function(fieldPath){for(var _i=0,_a=this.fields,fieldMaskPath;_i<_a.length;_i++)if(fieldMaskPath=_a[_i],fieldMaskPath.isPrefixOf(fieldPath))return!0;return!1},FieldMask.prototype.isEqual=function(other){return arrayEquals(this.fields,other.fields)},FieldMask}(),FieldTransform=function(){function FieldTransform(field,transform){this.field=field,this.transform=transform}return FieldTransform.prototype.isEqual=function(other){return this.field.isEqual(other.field)&&this.transform.isEqual(other.transform)},FieldTransform}(),MutationResult=function(){return function MutationResult(version,transformResults){this.version=version,this.transformResults=transformResults}}(),MutationType;(function(MutationType){MutationType[MutationType.Set=0]='Set',MutationType[MutationType.Patch=1]='Patch',MutationType[MutationType.Transform=2]='Transform',MutationType[MutationType.Delete=3]='Delete'})(MutationType||(MutationType={}));var Precondition=function(){function Precondition(updateTime,exists){this.updateTime=updateTime,this.exists=exists,assert(void 0===updateTime||void 0===exists,'Precondition can specify "exists" or "updateTime" but not both')}return Precondition.exists=function(exists){return new Precondition(void 0,exists)},Precondition.updateTime=function(version){return new Precondition(version)},Object.defineProperty(Precondition.prototype,'isNone',{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),Precondition.prototype.isValidFor=function(maybeDoc){return void 0===this.updateTime?void 0===this.exists?(assert(this.isNone,'Precondition should be empty'),!0):this.exists===maybeDoc instanceof Document:maybeDoc instanceof Document&&maybeDoc.version.isEqual(this.updateTime)},Precondition.prototype.isEqual=function(other){return equals(this.updateTime,other.updateTime)&&this.exists===other.exists},Precondition.NONE=new Precondition,Precondition}(),Mutation=function(){function Mutation(){}return Mutation.prototype.verifyKeyMatches=function(maybeDoc){null!=maybeDoc&&assert(maybeDoc.key.isEqual(this.key),'Can only apply a mutation to a document with the same key')},Mutation.getPostMutationVersion=function(maybeDoc){return maybeDoc instanceof Document?maybeDoc.version:SnapshotVersion.MIN},Mutation}(),SetMutation=function(_super){function SetMutation(key,value,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.value=value,_this.precondition=precondition,_this.type=MutationType.Set,_this}return tslib_1.__extends(SetMutation,_super),SetMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by SetMutation.');var version=mutationResult.version;return new Document(this.key,version,this.value,{hasCommittedMutations:!0})},SetMutation.prototype.applyToLocalView=function(maybeDoc){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var version=Mutation.getPostMutationVersion(maybeDoc);return new Document(this.key,version,this.value,{hasLocalMutations:!0})},SetMutation.prototype.isEqual=function(other){return other instanceof SetMutation&&this.key.isEqual(other.key)&&this.value.isEqual(other.value)&&this.precondition.isEqual(other.precondition)},SetMutation}(Mutation),PatchMutation=function(_super){function PatchMutation(key,data,fieldMask,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.data=data,_this.fieldMask=fieldMask,_this.precondition=precondition,_this.type=MutationType.Patch,_this}return tslib_1.__extends(PatchMutation,_super),PatchMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){if(this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by PatchMutation.'),!this.precondition.isValidFor(maybeDoc))return new UnknownDocument(this.key,mutationResult.version);var newData=this.patchDocument(maybeDoc);return new Document(this.key,mutationResult.version,newData,{hasCommittedMutations:!0})},PatchMutation.prototype.applyToLocalView=function(maybeDoc){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var version=Mutation.getPostMutationVersion(maybeDoc),newData=this.patchDocument(maybeDoc);return new Document(this.key,version,newData,{hasLocalMutations:!0})},PatchMutation.prototype.isEqual=function(other){return other instanceof PatchMutation&&this.key.isEqual(other.key)&&this.fieldMask.isEqual(other.fieldMask)&&this.precondition.isEqual(other.precondition)},PatchMutation.prototype.patchDocument=function(maybeDoc){var data;return data=maybeDoc instanceof Document?maybeDoc.data:ObjectValue.EMPTY,this.patchObject(data)},PatchMutation.prototype.patchObject=function(data){for(var _i=0,_a=this.fieldMask.fields,fieldPath;_i<_a.length;_i++)if(fieldPath=_a[_i],!fieldPath.isEmpty()){var newValue=this.data.field(fieldPath);data=void 0===newValue?data.delete(fieldPath):data.set(fieldPath,newValue)}return data},PatchMutation}(Mutation),TransformMutation=function(_super){function TransformMutation(key,fieldTransforms){var _this=_super.call(this)||this;return _this.key=key,_this.fieldTransforms=fieldTransforms,_this.type=MutationType.Transform,_this.precondition=Precondition.exists(!0),_this}return tslib_1.__extends(TransformMutation,_super),TransformMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){if(this.verifyKeyMatches(maybeDoc),assert(null!=mutationResult.transformResults,'Transform results missing for TransformMutation.'),!this.precondition.isValidFor(maybeDoc))return new UnknownDocument(this.key,mutationResult.version);var doc=this.requireDocument(maybeDoc),transformResults=this.serverTransformResults(maybeDoc,mutationResult.transformResults),version=mutationResult.version,newData=this.transformObject(doc.data,transformResults);return new Document(this.key,version,newData,{hasCommittedMutations:!0})},TransformMutation.prototype.applyToLocalView=function(maybeDoc,baseDoc,localWriteTime){if(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))return maybeDoc;var doc=this.requireDocument(maybeDoc),transformResults=this.localTransformResults(localWriteTime,baseDoc),newData=this.transformObject(doc.data,transformResults);return new Document(this.key,doc.version,newData,{hasLocalMutations:!0})},TransformMutation.prototype.isEqual=function(other){return other instanceof TransformMutation&&this.key.isEqual(other.key)&&arrayEquals(this.fieldTransforms,other.fieldTransforms)&&this.precondition.isEqual(other.precondition)},TransformMutation.prototype.requireDocument=function(maybeDoc){assert(maybeDoc instanceof Document,'Unknown MaybeDocument type '+maybeDoc);var doc=maybeDoc;return assert(doc.key.isEqual(this.key),'Can only transform a document with the same key'),doc},TransformMutation.prototype.serverTransformResults=function(baseDoc,serverTransformResults){var transformResults=[];assert(this.fieldTransforms.length===serverTransformResults.length,'server transform result count ('+serverTransformResults.length+') '+('should match field transform count ('+this.fieldTransforms.length+')'));for(var i=0;i<serverTransformResults.length;i++){var fieldTransform=this.fieldTransforms[i],transform=fieldTransform.transform,previousValue=null;baseDoc instanceof Document&&(previousValue=baseDoc.field(fieldTransform.field)||null),transformResults.push(transform.applyToRemoteDocument(previousValue,serverTransformResults[i]))}return transformResults},TransformMutation.prototype.localTransformResults=function(localWriteTime,baseDoc){for(var transformResults=[],_i=0,_a=this.fieldTransforms;_i<_a.length;_i++){var fieldTransform=_a[_i],transform=fieldTransform.transform,previousValue=null;baseDoc instanceof Document&&(previousValue=baseDoc.field(fieldTransform.field)||null),transformResults.push(transform.applyToLocalView(previousValue,localWriteTime))}return transformResults},TransformMutation.prototype.transformObject=function(data,transformResults){assert(transformResults.length===this.fieldTransforms.length,'TransformResults length mismatch.');for(var i=0;i<this.fieldTransforms.length;i++){var fieldTransform=this.fieldTransforms[i],fieldPath=fieldTransform.field;data=data.set(fieldPath,transformResults[i])}return data},TransformMutation}(Mutation),DeleteMutation=function(_super){function DeleteMutation(key,precondition){var _this=_super.call(this)||this;return _this.key=key,_this.precondition=precondition,_this.type=MutationType.Delete,_this}return tslib_1.__extends(DeleteMutation,_super),DeleteMutation.prototype.applyToRemoteDocument=function(maybeDoc,mutationResult){return this.verifyKeyMatches(maybeDoc),assert(null==mutationResult.transformResults,'Transform results received by DeleteMutation.'),new NoDocument(this.key,mutationResult.version,{hasCommittedMutations:!0})},DeleteMutation.prototype.applyToLocalView=function(maybeDoc){return(this.verifyKeyMatches(maybeDoc),!this.precondition.isValidFor(maybeDoc))?maybeDoc:(maybeDoc&&assert(maybeDoc.key.isEqual(this.key),'Can only apply mutation to document with same key'),new NoDocument(this.key,SnapshotVersion.forDeletedDoc()))},DeleteMutation.prototype.isEqual=function(other){return other instanceof DeleteMutation&&this.key.isEqual(other.key)&&this.precondition.isEqual(other.precondition)},DeleteMutation}(Mutation),ServerTimestampTransform=function(){function ServerTimestampTransform(){}return ServerTimestampTransform.prototype.applyToLocalView=function(previousValue,localWriteTime){return new ServerTimestampValue(localWriteTime,previousValue)},ServerTimestampTransform.prototype.applyToRemoteDocument=function(previousValue,transformResult){return transformResult},ServerTimestampTransform.prototype.isEqual=function(other){return other instanceof ServerTimestampTransform},ServerTimestampTransform.instance=new ServerTimestampTransform,ServerTimestampTransform}(),ArrayUnionTransformOperation=function(){function ArrayUnionTransformOperation(elements){this.elements=elements}return ArrayUnionTransformOperation.prototype.applyToLocalView=function(previousValue){return this.apply(previousValue)},ArrayUnionTransformOperation.prototype.applyToRemoteDocument=function(previousValue){return this.apply(previousValue)},ArrayUnionTransformOperation.prototype.apply=function(previousValue){for(var result=coercedFieldValuesArray(previousValue),_loop_1=function(toUnion){result.find(function(element){return element.isEqual(toUnion)})||result.push(toUnion)},_i=0,_a=this.elements,toUnion;_i<_a.length;_i++)toUnion=_a[_i],_loop_1(toUnion);return new ArrayValue(result)},ArrayUnionTransformOperation.prototype.isEqual=function(other){return other instanceof ArrayUnionTransformOperation&&arrayEquals(other.elements,this.elements)},ArrayUnionTransformOperation}(),ArrayRemoveTransformOperation=function(){function ArrayRemoveTransformOperation(elements){this.elements=elements}return ArrayRemoveTransformOperation.prototype.applyToLocalView=function(previousValue){return this.apply(previousValue)},ArrayRemoveTransformOperation.prototype.applyToRemoteDocument=function(previousValue){return this.apply(previousValue)},ArrayRemoveTransformOperation.prototype.apply=function(previousValue){for(var result=coercedFieldValuesArray(previousValue),_loop_2=function(toRemove){result=result.filter(function(element){return!element.isEqual(toRemove)})},_i=0,_a=this.elements,toRemove;_i<_a.length;_i++)toRemove=_a[_i],_loop_2(toRemove);return new ArrayValue(result)},ArrayRemoveTransformOperation.prototype.isEqual=function(other){return other instanceof ArrayRemoveTransformOperation&&arrayEquals(other.elements,this.elements)},ArrayRemoveTransformOperation}(),ExistenceFilter=function(){function ExistenceFilter(count){this.count=count}return ExistenceFilter.prototype.isEqual=function(other){return other&&other.count===this.count},ExistenceFilter}(),RpcCode;(function(RpcCode){RpcCode[RpcCode.OK=0]='OK',RpcCode[RpcCode.CANCELLED=1]='CANCELLED',RpcCode[RpcCode.UNKNOWN=2]='UNKNOWN',RpcCode[RpcCode.INVALID_ARGUMENT=3]='INVALID_ARGUMENT',RpcCode[RpcCode.DEADLINE_EXCEEDED=4]='DEADLINE_EXCEEDED',RpcCode[RpcCode.NOT_FOUND=5]='NOT_FOUND',RpcCode[RpcCode.ALREADY_EXISTS=6]='ALREADY_EXISTS',RpcCode[RpcCode.PERMISSION_DENIED=7]='PERMISSION_DENIED',RpcCode[RpcCode.UNAUTHENTICATED=16]='UNAUTHENTICATED',RpcCode[RpcCode.RESOURCE_EXHAUSTED=8]='RESOURCE_EXHAUSTED',RpcCode[RpcCode.FAILED_PRECONDITION=9]='FAILED_PRECONDITION',RpcCode[RpcCode.ABORTED=10]='ABORTED',RpcCode[RpcCode.OUT_OF_RANGE=11]='OUT_OF_RANGE',RpcCode[RpcCode.UNIMPLEMENTED=12]='UNIMPLEMENTED',RpcCode[RpcCode.INTERNAL=13]='INTERNAL',RpcCode[RpcCode.UNAVAILABLE=14]='UNAVAILABLE',RpcCode[RpcCode.DATA_LOSS=15]='DATA_LOSS'})(RpcCode||(RpcCode={}));var SortedSet=function(){function SortedSet(comparator){this.comparator=comparator,this.data=new SortedMap(this.comparator)}return SortedSet.fromMapKeys=function(map){var keys=new SortedSet(map.comparator);return map.forEach(function(key){keys=keys.add(key)}),keys},SortedSet.prototype.has=function(elem){return null!==this.data.get(elem)},SortedSet.prototype.first=function(){return this.data.minKey()},SortedSet.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(SortedSet.prototype,'size',{get:function(){return this.data.size},enumerable:!0,configurable:!0}),SortedSet.prototype.indexOf=function(elem){return this.data.indexOf(elem)},SortedSet.prototype.forEach=function(cb){this.data.inorderTraversal(function(k){return cb(k),!1})},SortedSet.prototype.forEachInRange=function(range,cb){for(var iter=this.data.getIteratorFrom(range[0]),elem;iter.hasNext();){if(elem=iter.getNext(),0<=this.comparator(elem.key,range[1]))return;cb(elem.key)}},SortedSet.prototype.forEachWhile=function(cb,start){var iter;for(iter=void 0===start?this.data.getIterator():this.data.getIteratorFrom(start);iter.hasNext();){var elem=iter.getNext(),result=cb(elem.key);if(!result)return}},SortedSet.prototype.firstAfterOrEqual=function(elem){var iter=this.data.getIteratorFrom(elem);return iter.hasNext()?iter.getNext().key:null},SortedSet.prototype.add=function(elem){return this.copy(this.data.remove(elem).insert(elem,!0))},SortedSet.prototype.delete=function(elem){return this.has(elem)?this.copy(this.data.remove(elem)):this},SortedSet.prototype.isEmpty=function(){return this.data.isEmpty()},SortedSet.prototype.unionWith=function(other){var result=this;return other.forEach(function(elem){result=result.add(elem)}),result},SortedSet.prototype.isEqual=function(other){if(!(other instanceof SortedSet))return!1;if(this.size!==other.size)return!1;for(var thisIt=this.data.getIterator(),otherIt=other.data.getIterator();thisIt.hasNext();){var thisElem=thisIt.getNext().key,otherElem=otherIt.getNext().key;if(0!==this.comparator(thisElem,otherElem))return!1}return!0},SortedSet.prototype.toArray=function(){var res=[];return this.forEach(function(targetId){res.push(targetId)}),res},SortedSet.prototype.toString=function(){var result=[];return this.forEach(function(elem){return result.push(elem)}),'SortedSet('+result.toString()+')'},SortedSet.prototype.copy=function(data){var result=new SortedSet(this.comparator);return result.data=data,result},SortedSet}(),EMPTY_MAYBE_DOCUMENT_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_VERSION_MAP=new SortedMap(DocumentKey.comparator),EMPTY_DOCUMENT_KEY_SET=new SortedSet(DocumentKey.comparator),EMPTY_TARGET_ID_SET=new SortedSet(primitiveComparator),DocumentSet=function(){function DocumentSet(comp){this.comparator=comp?function(d1,d2){return comp(d1,d2)||DocumentKey.comparator(d1.key,d2.key)}:function(d1,d2){return DocumentKey.comparator(d1.key,d2.key)},this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}return DocumentSet.emptySet=function(oldSet){return new DocumentSet(oldSet.comparator)},DocumentSet.prototype.has=function(key){return null!=this.keyedMap.get(key)},DocumentSet.prototype.get=function(key){return this.keyedMap.get(key)},DocumentSet.prototype.first=function(){return this.sortedSet.minKey()},DocumentSet.prototype.last=function(){return this.sortedSet.maxKey()},DocumentSet.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},DocumentSet.prototype.indexOf=function(key){var doc=this.keyedMap.get(key);return doc?this.sortedSet.indexOf(doc):-1},Object.defineProperty(DocumentSet.prototype,'size',{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),DocumentSet.prototype.forEach=function(cb){this.sortedSet.inorderTraversal(function(k){return cb(k),!1})},DocumentSet.prototype.add=function(doc){var set=this.delete(doc.key);return set.copy(set.keyedMap.insert(doc.key,doc),set.sortedSet.insert(doc,null))},DocumentSet.prototype.delete=function(key){var doc=this.get(key);return doc?this.copy(this.keyedMap.remove(key),this.sortedSet.remove(doc)):this},DocumentSet.prototype.isEqual=function(other){if(!(other instanceof DocumentSet))return!1;if(this.size!==other.size)return!1;for(var thisIt=this.sortedSet.getIterator(),otherIt=other.sortedSet.getIterator();thisIt.hasNext();){var thisDoc=thisIt.getNext().key,otherDoc=otherIt.getNext().key;if(!thisDoc.isEqual(otherDoc))return!1}return!0},DocumentSet.prototype.toString=function(){var docStrings=[];return this.forEach(function(doc){docStrings.push(doc.toString())}),0===docStrings.length?'DocumentSet ()':'DocumentSet (\n  '+docStrings.join('  \n')+'\n)'},DocumentSet.prototype.copy=function(keyedMap,sortedSet){var newSet=new DocumentSet;return newSet.comparator=this.comparator,newSet.keyedMap=keyedMap,newSet.sortedSet=sortedSet,newSet},DocumentSet}(),ChangeType;(function(ChangeType){ChangeType[ChangeType.Added=0]='Added',ChangeType[ChangeType.Removed=1]='Removed',ChangeType[ChangeType.Modified=2]='Modified',ChangeType[ChangeType.Metadata=3]='Metadata'})(ChangeType||(ChangeType={}));var SyncState;(function(SyncState){SyncState[SyncState.Local=0]='Local',SyncState[SyncState.Synced=1]='Synced'})(SyncState||(SyncState={}));var DocumentChangeSet=function(){function DocumentChangeSet(){this.changeMap=new SortedMap(DocumentKey.comparator)}return DocumentChangeSet.prototype.track=function(change){var key=change.doc.key,oldChange=this.changeMap.get(key);return oldChange?void(change.type!==ChangeType.Added&&oldChange.type===ChangeType.Metadata?this.changeMap=this.changeMap.insert(key,change):change.type===ChangeType.Metadata&&oldChange.type!==ChangeType.Removed?this.changeMap=this.changeMap.insert(key,{type:oldChange.type,doc:change.doc}):change.type===ChangeType.Modified&&oldChange.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Modified,doc:change.doc}):change.type===ChangeType.Modified&&oldChange.type===ChangeType.Added?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Added,doc:change.doc}):change.type===ChangeType.Removed&&oldChange.type===ChangeType.Added?this.changeMap=this.changeMap.remove(key):change.type===ChangeType.Removed&&oldChange.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Removed,doc:oldChange.doc}):change.type===ChangeType.Added&&oldChange.type===ChangeType.Removed?this.changeMap=this.changeMap.insert(key,{type:ChangeType.Modified,doc:change.doc}):fail('unsupported combination of changes: '+JSON.stringify(change)+' after '+JSON.stringify(oldChange))):void(this.changeMap=this.changeMap.insert(key,change))},DocumentChangeSet.prototype.getChanges=function(){var changes=[];return this.changeMap.inorderTraversal(function(key,change){changes.push(change)}),changes},DocumentChangeSet}(),ViewSnapshot=function(){function ViewSnapshot(query,docs,oldDocs,docChanges,mutatedKeys,fromCache,syncStateChanged,excludesMetadataChanges){this.query=query,this.docs=docs,this.oldDocs=oldDocs,this.docChanges=docChanges,this.mutatedKeys=mutatedKeys,this.fromCache=fromCache,this.syncStateChanged=syncStateChanged,this.excludesMetadataChanges=excludesMetadataChanges}return ViewSnapshot.fromInitialDocuments=function(query,documents,mutatedKeys,fromCache){var changes=[];return documents.forEach(function(doc){changes.push({type:ChangeType.Added,doc:doc})}),new ViewSnapshot(query,documents,DocumentSet.emptySet(documents),changes,mutatedKeys,fromCache,!0,!1)},Object.defineProperty(ViewSnapshot.prototype,'hasPendingWrites',{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!0,configurable:!0}),ViewSnapshot.prototype.isEqual=function(other){if(this.fromCache!==other.fromCache||this.syncStateChanged!==other.syncStateChanged||!this.mutatedKeys.isEqual(other.mutatedKeys)||!this.query.isEqual(other.query)||!this.docs.isEqual(other.docs)||!this.oldDocs.isEqual(other.oldDocs))return!1;var changes=this.docChanges,otherChanges=other.docChanges;if(changes.length!==otherChanges.length)return!1;for(var i=0;i<changes.length;i++)if(changes[i].type!==otherChanges[i].type||!changes[i].doc.isEqual(otherChanges[i].doc))return!1;return!0},ViewSnapshot}(),RemoteEvent=function(){function RemoteEvent(snapshotVersion,targetChanges,targetMismatches,documentUpdates,resolvedLimboDocuments){this.snapshotVersion=snapshotVersion,this.targetChanges=targetChanges,this.targetMismatches=targetMismatches,this.documentUpdates=documentUpdates,this.resolvedLimboDocuments=resolvedLimboDocuments}return RemoteEvent.createSynthesizedRemoteEventForCurrentChange=function(targetId,current){var targetChanges=(_a={},_a[targetId]=TargetChange.createSynthesizedTargetChangeForCurrentChange(targetId,current),_a);return new RemoteEvent(SnapshotVersion.MIN,targetChanges,targetIdSet(),maybeDocumentMap(),documentKeySet());var _a},RemoteEvent}(),TargetChange=function(){function TargetChange(resumeToken,current,addedDocuments,modifiedDocuments,removedDocuments){this.resumeToken=resumeToken,this.current=current,this.addedDocuments=addedDocuments,this.modifiedDocuments=modifiedDocuments,this.removedDocuments=removedDocuments}return TargetChange.createSynthesizedTargetChangeForCurrentChange=function(targetId,current){return new TargetChange(emptyByteString(),current,documentKeySet(),documentKeySet(),documentKeySet())},TargetChange}(),DocumentWatchChange=function(){return function DocumentWatchChange(updatedTargetIds,removedTargetIds,key,newDoc){this.updatedTargetIds=updatedTargetIds,this.removedTargetIds=removedTargetIds,this.key=key,this.newDoc=newDoc}}(),ExistenceFilterChange=function(){return function ExistenceFilterChange(targetId,existenceFilter){this.targetId=targetId,this.existenceFilter=existenceFilter}}(),WatchTargetChangeState;(function(WatchTargetChangeState){WatchTargetChangeState[WatchTargetChangeState.NoChange=0]='NoChange',WatchTargetChangeState[WatchTargetChangeState.Added=1]='Added',WatchTargetChangeState[WatchTargetChangeState.Removed=2]='Removed',WatchTargetChangeState[WatchTargetChangeState.Current=3]='Current',WatchTargetChangeState[WatchTargetChangeState.Reset=4]='Reset'})(WatchTargetChangeState||(WatchTargetChangeState={}));var WatchTargetChange=function(){return function WatchTargetChange(state,targetIds,resumeToken,cause){void 0===resumeToken&&(resumeToken=emptyByteString()),void 0===cause&&(cause=null),this.state=state,this.targetIds=targetIds,this.resumeToken=resumeToken,this.cause=cause}}(),TargetState=function(){function TargetState(){this.pendingResponses=0,this.documentChanges=snapshotChangesMap(),this._resumeToken=emptyByteString(),this._current=!1,this._hasPendingChanges=!0}return Object.defineProperty(TargetState.prototype,'current',{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'resumeToken',{get:function(){return this._resumeToken},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'isPending',{get:function(){return 0!==this.pendingResponses},enumerable:!0,configurable:!0}),Object.defineProperty(TargetState.prototype,'hasPendingChanges',{get:function(){return this._hasPendingChanges},enumerable:!0,configurable:!0}),TargetState.prototype.updateResumeToken=function(resumeToken){0<resumeToken.length&&(this._hasPendingChanges=!0,this._resumeToken=resumeToken)},TargetState.prototype.toTargetChange=function(){var addedDocuments=documentKeySet(),modifiedDocuments=documentKeySet(),removedDocuments=documentKeySet();return this.documentChanges.forEach(function(key,changeType){changeType===ChangeType.Added?addedDocuments=addedDocuments.add(key):changeType===ChangeType.Modified?modifiedDocuments=modifiedDocuments.add(key):changeType===ChangeType.Removed?removedDocuments=removedDocuments.add(key):fail('Encountered invalid change type: '+changeType)}),new TargetChange(this._resumeToken,this._current,addedDocuments,modifiedDocuments,removedDocuments)},TargetState.prototype.clearPendingChanges=function(){this._hasPendingChanges=!1,this.documentChanges=snapshotChangesMap()},TargetState.prototype.addDocumentChange=function(key,changeType){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.insert(key,changeType)},TargetState.prototype.removeDocumentChange=function(key){this._hasPendingChanges=!0,this.documentChanges=this.documentChanges.remove(key)},TargetState.prototype.recordPendingTargetRequest=function(){this.pendingResponses+=1},TargetState.prototype.recordTargetResponse=function(){this.pendingResponses-=1},TargetState.prototype.markCurrent=function(){this._hasPendingChanges=!0,this._current=!0},TargetState}(),WatchChangeAggregator=function(){function WatchChangeAggregator(metadataProvider){this.metadataProvider=metadataProvider,this.targetStates={},this.pendingDocumentUpdates=maybeDocumentMap(),this.pendingDocumentTargetMapping=documentTargetMap(),this.pendingTargetResets=new SortedSet(primitiveComparator)}return WatchChangeAggregator.prototype.handleDocumentChange=function(docChange){for(var _i=0,_a=docChange.updatedTargetIds,targetId;_i<_a.length;_i++)targetId=_a[_i],docChange.newDoc instanceof Document?this.addDocumentToTarget(targetId,docChange.newDoc):docChange.newDoc instanceof NoDocument&&this.removeDocumentFromTarget(targetId,docChange.key,docChange.newDoc);for(var _b=0,_c=docChange.removedTargetIds,targetId;_b<_c.length;_b++)targetId=_c[_b],this.removeDocumentFromTarget(targetId,docChange.key,docChange.newDoc)},WatchChangeAggregator.prototype.handleTargetChange=function(targetChange){var _this=this;this.forEachTarget(targetChange,function(targetId){var targetState=_this.ensureTargetState(targetId);switch(targetChange.state){case WatchTargetChangeState.NoChange:_this.isActiveTarget(targetId)&&targetState.updateResumeToken(targetChange.resumeToken);break;case WatchTargetChangeState.Added:targetState.recordTargetResponse(),targetState.isPending||targetState.clearPendingChanges(),targetState.updateResumeToken(targetChange.resumeToken);break;case WatchTargetChangeState.Removed:targetState.recordTargetResponse(),targetState.isPending||_this.removeTarget(targetId),assert(!targetChange.cause,'WatchChangeAggregator does not handle errored targets');break;case WatchTargetChangeState.Current:_this.isActiveTarget(targetId)&&(targetState.markCurrent(),targetState.updateResumeToken(targetChange.resumeToken));break;case WatchTargetChangeState.Reset:_this.isActiveTarget(targetId)&&(_this.resetTarget(targetId),targetState.updateResumeToken(targetChange.resumeToken));break;default:fail('Unknown target watch change state: '+targetChange.state);}})},WatchChangeAggregator.prototype.forEachTarget=function(targetChange,fn){0<targetChange.targetIds.length?targetChange.targetIds.forEach(fn):forEachNumber(this.targetStates,fn)},WatchChangeAggregator.prototype.handleExistenceFilter=function(watchChange){var targetId=watchChange.targetId,expectedCount=watchChange.existenceFilter.count,queryData=this.queryDataForActiveTarget(targetId);if(queryData){var query=queryData.query;if(!query.isDocumentQuery()){var currentSize=this.getCurrentDocumentCountForTarget(targetId);currentSize!==expectedCount&&(this.resetTarget(targetId),this.pendingTargetResets=this.pendingTargetResets.add(targetId))}else if(0===expectedCount){var key=new DocumentKey(query.path);this.removeDocumentFromTarget(targetId,key,new NoDocument(key,SnapshotVersion.forDeletedDoc()))}else assert(1===expectedCount,'Single document existence filter with count: '+expectedCount)}},WatchChangeAggregator.prototype.createRemoteEvent=function(snapshotVersion){var _this=this,targetChanges={};forEachNumber(this.targetStates,function(targetId,targetState){var queryData=_this.queryDataForActiveTarget(targetId);if(queryData){if(targetState.current&&queryData.query.isDocumentQuery()){var key=new DocumentKey(queryData.query.path);null!==_this.pendingDocumentUpdates.get(key)||_this.targetContainsDocument(targetId,key)||_this.removeDocumentFromTarget(targetId,key,new NoDocument(key,snapshotVersion))}targetState.hasPendingChanges&&(targetChanges[targetId]=targetState.toTargetChange(),targetState.clearPendingChanges())}});var resolvedLimboDocuments=documentKeySet();this.pendingDocumentTargetMapping.forEach(function(key,targets){var isOnlyLimboTarget=!0;targets.forEachWhile(function(targetId){var queryData=_this.queryDataForActiveTarget(targetId);return queryData&&queryData.purpose!==QueryPurpose.LimboResolution?(isOnlyLimboTarget=!1,!1):!0}),isOnlyLimboTarget&&(resolvedLimboDocuments=resolvedLimboDocuments.add(key))});var remoteEvent=new RemoteEvent(snapshotVersion,targetChanges,this.pendingTargetResets,this.pendingDocumentUpdates,resolvedLimboDocuments);return this.pendingDocumentUpdates=maybeDocumentMap(),this.pendingDocumentTargetMapping=documentTargetMap(),this.pendingTargetResets=new SortedSet(primitiveComparator),remoteEvent},WatchChangeAggregator.prototype.addDocumentToTarget=function(targetId,document){if(this.isActiveTarget(targetId)){var changeType=this.targetContainsDocument(targetId,document.key)?ChangeType.Modified:ChangeType.Added,targetState=this.ensureTargetState(targetId);targetState.addDocumentChange(document.key,changeType),this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(document.key,document),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(document.key,this.ensureDocumentTargetMapping(document.key).add(targetId))}},WatchChangeAggregator.prototype.removeDocumentFromTarget=function(targetId,key,updatedDocument){if(this.isActiveTarget(targetId)){var targetState=this.ensureTargetState(targetId);this.targetContainsDocument(targetId,key)?targetState.addDocumentChange(key,ChangeType.Removed):targetState.removeDocumentChange(key),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(key,this.ensureDocumentTargetMapping(key).delete(targetId)),updatedDocument&&(this.pendingDocumentUpdates=this.pendingDocumentUpdates.insert(key,updatedDocument))}},WatchChangeAggregator.prototype.removeTarget=function(targetId){delete this.targetStates[targetId]},WatchChangeAggregator.prototype.getCurrentDocumentCountForTarget=function(targetId){var targetState=this.ensureTargetState(targetId),targetChange=targetState.toTargetChange();return this.metadataProvider.getRemoteKeysForTarget(targetId).size+targetChange.addedDocuments.size-targetChange.removedDocuments.size},WatchChangeAggregator.prototype.recordPendingTargetRequest=function(targetId){var targetState=this.ensureTargetState(targetId);targetState.recordPendingTargetRequest()},WatchChangeAggregator.prototype.ensureTargetState=function(targetId){return this.targetStates[targetId]||(this.targetStates[targetId]=new TargetState),this.targetStates[targetId]},WatchChangeAggregator.prototype.ensureDocumentTargetMapping=function(key){var targetMapping=this.pendingDocumentTargetMapping.get(key);return targetMapping||(targetMapping=new SortedSet(primitiveComparator),this.pendingDocumentTargetMapping=this.pendingDocumentTargetMapping.insert(key,targetMapping)),targetMapping},WatchChangeAggregator.prototype.isActiveTarget=function(targetId){return null!==this.queryDataForActiveTarget(targetId)},WatchChangeAggregator.prototype.queryDataForActiveTarget=function(targetId){var targetState=this.targetStates[targetId];return targetState&&targetState.isPending?null:this.metadataProvider.getQueryDataForTarget(targetId)},WatchChangeAggregator.prototype.resetTarget=function(targetId){var _this=this;assert(!this.targetStates[targetId].isPending,'Should only reset active targets'),this.targetStates[targetId]=new TargetState;var existingKeys=this.metadataProvider.getRemoteKeysForTarget(targetId);existingKeys.forEach(function(key){_this.removeDocumentFromTarget(targetId,key,null)})},WatchChangeAggregator.prototype.targetContainsDocument=function(targetId,key){var existingKeys=this.metadataProvider.getRemoteKeysForTarget(targetId);return existingKeys.has(key)},WatchChangeAggregator}(),DIRECTIONS=function(){var dirs={};return dirs[Direction.ASCENDING.name]='ASCENDING',dirs[Direction.DESCENDING.name]='DESCENDING',dirs}(),OPERATORS=function(){var ops={};return ops[RelationOp.LESS_THAN.name]='LESS_THAN',ops[RelationOp.LESS_THAN_OR_EQUAL.name]='LESS_THAN_OR_EQUAL',ops[RelationOp.GREATER_THAN.name]='GREATER_THAN',ops[RelationOp.GREATER_THAN_OR_EQUAL.name]='GREATER_THAN_OR_EQUAL',ops[RelationOp.EQUAL.name]='EQUAL',ops[RelationOp.ARRAY_CONTAINS.name]='ARRAY_CONTAINS',ops}(),ISO_REG_EXP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),JsonProtoSerializer=function(){function JsonProtoSerializer(databaseId,options){this.databaseId=databaseId,this.options=options}return JsonProtoSerializer.prototype.emptyByteString=function(){return this.options.useProto3Json?'':new Uint8Array(0)},JsonProtoSerializer.prototype.unsafeCastProtoByteString=function(byteString){return byteString},JsonProtoSerializer.prototype.fromRpcStatus=function(status){var code=void 0===status.code?Code.UNKNOWN:mapCodeFromRpcCode(status.code);return new FirestoreError(code,status.message||'')},JsonProtoSerializer.prototype.toInt32Value=function(val){return isNullOrUndefined(val)?void 0:{value:val}},JsonProtoSerializer.prototype.fromInt32Value=function(val){var result;return result='object'==typeof val?val.value:val,isNullOrUndefined(result)?null:result},JsonProtoSerializer.prototype.toTimestamp=function(timestamp){return{seconds:timestamp.seconds,nanos:timestamp.nanoseconds}},JsonProtoSerializer.prototype.fromTimestamp=function(date){if('string'==typeof date)return this.fromIso8601String(date);assert(!!date,'Cannot deserialize null or undefined timestamp.');var seconds=parseInt64(date.seconds||'0'),nanos=date.nanos||0;return new Timestamp(seconds,nanos)},JsonProtoSerializer.prototype.fromIso8601String=function(utc){var nanos=0,fraction=ISO_REG_EXP.exec(utc);if(assert(!!fraction,'invalid timestamp: '+utc),fraction[1]){var nanoStr=fraction[1];nanoStr=(nanoStr+'000000000').substr(0,9),nanos=+nanoStr}var date=new Date(utc),seconds=_Mathfloor(date.getTime()/1e3);return new Timestamp(seconds,nanos)},JsonProtoSerializer.prototype.toBytes=function(bytes){return this.options.useProto3Json?bytes.toBase64():this.unsafeCastProtoByteString(bytes.toUint8Array())},JsonProtoSerializer.prototype.fromBlob=function(blob){return'string'==typeof blob?(assert(this.options.useProto3Json,'Expected bytes to be passed in as Uint8Array, but got a string instead.'),Blob.fromBase64String(blob)):(assert(!this.options.useProto3Json,'Expected bytes to be passed in as string, but got something else instead.'),Blob.fromUint8Array(blob))},JsonProtoSerializer.prototype.toVersion=function(version){return this.toTimestamp(version.toTimestamp())},JsonProtoSerializer.prototype.fromVersion=function(version){return assert(!!version,'Trying to deserialize version that isn\'t set'),SnapshotVersion.fromTimestamp(this.fromTimestamp(version))},JsonProtoSerializer.prototype.toResourceName=function(databaseId,path){return this.fullyQualifiedPrefixPath(databaseId).child('documents').child(path).canonicalString()},JsonProtoSerializer.prototype.fromResourceName=function(name){var resource=ResourcePath.fromString(name);return assert(this.isValidResourceName(resource),'Tried to deserialize invalid key '+resource.toString()),resource},JsonProtoSerializer.prototype.toName=function(key){return this.toResourceName(this.databaseId,key.path)},JsonProtoSerializer.prototype.fromName=function(name){var resource=this.fromResourceName(name);return assert(resource.get(1)===this.databaseId.projectId,'Tried to deserialize key from different project: '+resource.get(1)+' vs '+this.databaseId.projectId),assert(!resource.get(3)&&!this.databaseId.database||resource.get(3)===this.databaseId.database,'Tried to deserialize key from different database: '+resource.get(3)+' vs '+this.databaseId.database),new DocumentKey(this.extractLocalPathFromResourceName(resource))},JsonProtoSerializer.prototype.toQueryPath=function(path){return 0===path.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,path)},JsonProtoSerializer.prototype.fromQueryPath=function(name){var resourceName=this.fromResourceName(name);return 4===resourceName.length?ResourcePath.EMPTY_PATH:this.extractLocalPathFromResourceName(resourceName)},Object.defineProperty(JsonProtoSerializer.prototype,'encodedDatabaseId',{get:function(){var path=new ResourcePath(['projects',this.databaseId.projectId,'databases',this.databaseId.database]);return path.canonicalString()},enumerable:!0,configurable:!0}),JsonProtoSerializer.prototype.fullyQualifiedPrefixPath=function(databaseId){return new ResourcePath(['projects',databaseId.projectId,'databases',databaseId.database])},JsonProtoSerializer.prototype.extractLocalPathFromResourceName=function(resourceName){return assert(4<resourceName.length&&'documents'===resourceName.get(4),'tried to deserialize invalid key '+resourceName.toString()),resourceName.popFirst(5)},JsonProtoSerializer.prototype.isValidResourceName=function(path){return 4<=path.length&&'projects'===path.get(0)&&'databases'===path.get(2)},JsonProtoSerializer.prototype.toValue=function(val){if(val instanceof NullValue)return{nullValue:'NULL_VALUE'};if(val instanceof BooleanValue)return{booleanValue:val.value()};if(val instanceof IntegerValue)return{integerValue:''+val.value()};if(val instanceof DoubleValue){var doubleValue=val.value();if(this.options.useProto3Json){if(isNaN(doubleValue))return{doubleValue:'NaN'};if(doubleValue===Infinity)return{doubleValue:'Infinity'};if(doubleValue===-Infinity)return{doubleValue:'-Infinity'}}return{doubleValue:val.value()}}return val instanceof StringValue?{stringValue:val.value()}:val instanceof ObjectValue?{mapValue:this.toMapValue(val)}:val instanceof ArrayValue?{arrayValue:this.toArrayValue(val)}:val instanceof TimestampValue?{timestampValue:this.toTimestamp(val.internalValue)}:val instanceof GeoPointValue?{geoPointValue:{latitude:val.value().latitude,longitude:val.value().longitude}}:val instanceof BlobValue?{bytesValue:this.toBytes(val.value())}:val instanceof RefValue?{referenceValue:this.toResourceName(val.databaseId,val.key.path)}:fail('Unknown FieldValue '+JSON.stringify(val))},JsonProtoSerializer.prototype.fromValue=function(obj){var _this=this,type=obj.value_type;if(hasTag(obj,type,'nullValue'))return NullValue.INSTANCE;if(hasTag(obj,type,'booleanValue'))return BooleanValue.of(obj.booleanValue);if(hasTag(obj,type,'integerValue'))return new IntegerValue(parseInt64(obj.integerValue));if(hasTag(obj,type,'doubleValue')){if(this.options.useProto3Json){if('NaN'===obj.doubleValue)return DoubleValue.NAN;if('Infinity'===obj.doubleValue)return DoubleValue.POSITIVE_INFINITY;if('-Infinity'===obj.doubleValue)return DoubleValue.NEGATIVE_INFINITY}return new DoubleValue(obj.doubleValue)}if(hasTag(obj,type,'stringValue'))return new StringValue(obj.stringValue);if(hasTag(obj,type,'mapValue'))return this.fromFields(obj.mapValue.fields||{});if(hasTag(obj,type,'arrayValue')){assertPresent(obj.arrayValue,'arrayValue');var values$$1=obj.arrayValue.values||[];return new ArrayValue(values$$1.map(function(v){return _this.fromValue(v)}))}if(hasTag(obj,type,'timestampValue'))return assertPresent(obj.timestampValue,'timestampValue'),new TimestampValue(this.fromTimestamp(obj.timestampValue));if(hasTag(obj,type,'geoPointValue')){assertPresent(obj.geoPointValue,'geoPointValue');var latitude=obj.geoPointValue.latitude||0,longitude=obj.geoPointValue.longitude||0;return new GeoPointValue(new GeoPoint(latitude,longitude))}if(hasTag(obj,type,'bytesValue')){assertPresent(obj.bytesValue,'bytesValue');var blob=this.fromBlob(obj.bytesValue);return new BlobValue(blob)}if(hasTag(obj,type,'referenceValue')){assertPresent(obj.referenceValue,'referenceValue');var resourceName=this.fromResourceName(obj.referenceValue),dbId=new DatabaseId(resourceName.get(1),resourceName.get(3)),key=new DocumentKey(this.extractLocalPathFromResourceName(resourceName));return new RefValue(dbId,key)}return fail('Unknown Value proto '+JSON.stringify(obj))},JsonProtoSerializer.prototype.toMutationDocument=function(key,fields){return{name:this.toName(key),fields:this.toFields(fields)}},JsonProtoSerializer.prototype.toDocument=function(document){return assert(!document.hasLocalMutations,'Can\'t serialize documents with mutations.'),{name:this.toName(document.key),fields:this.toFields(document.data),updateTime:this.toTimestamp(document.version.toTimestamp())}},JsonProtoSerializer.prototype.fromDocument=function(document,hasCommittedMutations){return new Document(this.fromName(document.name),this.fromVersion(document.updateTime),this.fromFields(document.fields||{}),{hasCommittedMutations:!!hasCommittedMutations})},JsonProtoSerializer.prototype.toFields=function(fields){var _this=this,result={};return fields.forEach(function(key,value){result[key]=_this.toValue(value)}),result},JsonProtoSerializer.prototype.fromFields=function(object){var _this=this,result=ObjectValue.EMPTY;return forEach(object,function(key,value){result=result.set(new FieldPath([key]),_this.fromValue(value))}),result},JsonProtoSerializer.prototype.toMapValue=function(map){return{fields:this.toFields(map)}},JsonProtoSerializer.prototype.toArrayValue=function(array){var _this=this,result=[];return array.forEach(function(value){result.push(_this.toValue(value))}),{values:result}},JsonProtoSerializer.prototype.fromFound=function(doc){assert(!!doc.found,'Tried to deserialize a found document from a missing document.'),assertPresent(doc.found.name,'doc.found.name'),assertPresent(doc.found.updateTime,'doc.found.updateTime');var key=this.fromName(doc.found.name),version=this.fromVersion(doc.found.updateTime),fields=this.fromFields(doc.found.fields||{});return new Document(key,version,fields,{})},JsonProtoSerializer.prototype.fromMissing=function(result){assert(!!result.missing,'Tried to deserialize a missing document from a found document.'),assert(!!result.readTime,'Tried to deserialize a missing document without a read time.');var key=this.fromName(result.missing),version=this.fromVersion(result.readTime);return new NoDocument(key,version)},JsonProtoSerializer.prototype.fromMaybeDocument=function(result){var type=result.result;return hasTag(result,type,'found')?this.fromFound(result):hasTag(result,type,'missing')?this.fromMissing(result):fail('invalid batch get response: '+JSON.stringify(result))},JsonProtoSerializer.prototype.toWatchTargetChangeState=function(state){return state===WatchTargetChangeState.Added?'ADD':state===WatchTargetChangeState.Current?'CURRENT':state===WatchTargetChangeState.NoChange?'NO_CHANGE':state===WatchTargetChangeState.Removed?'REMOVE':state===WatchTargetChangeState.Reset?'RESET':fail('Unknown WatchTargetChangeState: '+state)},JsonProtoSerializer.prototype.toTestWatchChange=function(watchChange){if(watchChange instanceof ExistenceFilterChange)return{filter:{count:watchChange.existenceFilter.count,targetId:watchChange.targetId}};if(watchChange instanceof DocumentWatchChange){if(watchChange.newDoc instanceof Document){var doc=watchChange.newDoc;return{documentChange:{document:{name:this.toName(doc.key),fields:this.toFields(doc.data),updateTime:this.toVersion(doc.version)},targetIds:watchChange.updatedTargetIds,removedTargetIds:watchChange.removedTargetIds}}}if(watchChange.newDoc instanceof NoDocument){var doc=watchChange.newDoc;return{documentDelete:{document:this.toName(doc.key),readTime:this.toVersion(doc.version),removedTargetIds:watchChange.removedTargetIds}}}if(null===watchChange.newDoc)return{documentRemove:{document:this.toName(watchChange.key),removedTargetIds:watchChange.removedTargetIds}}}if(watchChange instanceof WatchTargetChange){var cause;return watchChange.cause&&(cause={code:mapRpcCodeFromCode(watchChange.cause.code),message:watchChange.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(watchChange.state),targetIds:watchChange.targetIds,resumeToken:this.unsafeCastProtoByteString(watchChange.resumeToken),cause:cause}}}return fail('Unrecognized watch change: '+JSON.stringify(watchChange))},JsonProtoSerializer.prototype.fromWatchChange=function(change){var type=change.response_type,watchChange;if(hasTag(change,type,'targetChange')){assertPresent(change.targetChange,'targetChange');var state=this.fromWatchTargetChangeState(change.targetChange.targetChangeType||'NO_CHANGE'),targetIds=change.targetChange.targetIds||[],resumeToken=change.targetChange.resumeToken||this.emptyByteString(),causeProto=change.targetChange.cause,cause=causeProto&&this.fromRpcStatus(causeProto);watchChange=new WatchTargetChange(state,targetIds,resumeToken,cause||null)}else if(hasTag(change,type,'documentChange')){assertPresent(change.documentChange,'documentChange'),assertPresent(change.documentChange.document,'documentChange.name'),assertPresent(change.documentChange.document.name,'documentChange.document.name'),assertPresent(change.documentChange.document.updateTime,'documentChange.document.updateTime');var entityChange=change.documentChange,key=this.fromName(entityChange.document.name),version=this.fromVersion(entityChange.document.updateTime),fields=this.fromFields(entityChange.document.fields||{}),doc=new Document(key,version,fields,{}),updatedTargetIds=entityChange.targetIds||[],removedTargetIds=entityChange.removedTargetIds||[];watchChange=new DocumentWatchChange(updatedTargetIds,removedTargetIds,doc.key,doc)}else if(hasTag(change,type,'documentDelete')){assertPresent(change.documentDelete,'documentDelete'),assertPresent(change.documentDelete.document,'documentDelete.document');var docDelete=change.documentDelete,key=this.fromName(docDelete.document),version=docDelete.readTime?this.fromVersion(docDelete.readTime):SnapshotVersion.forDeletedDoc(),doc=new NoDocument(key,version),removedTargetIds=docDelete.removedTargetIds||[];watchChange=new DocumentWatchChange([],removedTargetIds,doc.key,doc)}else if(hasTag(change,type,'documentRemove')){assertPresent(change.documentRemove,'documentRemove'),assertPresent(change.documentRemove.document,'documentRemove');var docRemove=change.documentRemove,key=this.fromName(docRemove.document),removedTargetIds=docRemove.removedTargetIds||[];watchChange=new DocumentWatchChange([],removedTargetIds,key,null)}else if(hasTag(change,type,'filter')){assertPresent(change.filter,'filter'),assertPresent(change.filter.targetId,'filter.targetId');var filter=change.filter,count=filter.count||0,existenceFilter=new ExistenceFilter(count),targetId=filter.targetId;watchChange=new ExistenceFilterChange(targetId,existenceFilter)}else return fail('Unknown change type '+JSON.stringify(change));return watchChange},JsonProtoSerializer.prototype.fromWatchTargetChangeState=function(state){return'NO_CHANGE'===state?WatchTargetChangeState.NoChange:'ADD'===state?WatchTargetChangeState.Added:'REMOVE'===state?WatchTargetChangeState.Removed:'CURRENT'===state?WatchTargetChangeState.Current:'RESET'===state?WatchTargetChangeState.Reset:fail('Got unexpected TargetChange.state: '+state)},JsonProtoSerializer.prototype.versionFromListenResponse=function(change){var type=change.response_type;if(!hasTag(change,type,'targetChange'))return SnapshotVersion.MIN;var targetChange=change.targetChange;return targetChange.targetIds&&targetChange.targetIds.length?SnapshotVersion.MIN:targetChange.readTime?this.fromVersion(targetChange.readTime):SnapshotVersion.MIN},JsonProtoSerializer.prototype.toMutation=function(mutation){var _this=this,result;if(mutation instanceof SetMutation)result={update:this.toMutationDocument(mutation.key,mutation.value)};else if(mutation instanceof DeleteMutation)result={delete:this.toName(mutation.key)};else if(mutation instanceof PatchMutation)result={update:this.toMutationDocument(mutation.key,mutation.data),updateMask:this.toDocumentMask(mutation.fieldMask)};else if(mutation instanceof TransformMutation)result={transform:{document:this.toName(mutation.key),fieldTransforms:mutation.fieldTransforms.map(function(transform){return _this.toFieldTransform(transform)})}};else return fail('Unknown mutation type '+mutation.type);return mutation.precondition.isNone||(result.currentDocument=this.toPrecondition(mutation.precondition)),result},JsonProtoSerializer.prototype.fromMutation=function(proto){var _this=this,precondition=proto.currentDocument?this.fromPrecondition(proto.currentDocument):Precondition.NONE;if(proto.update){assertPresent(proto.update.name,'name');var key=this.fromName(proto.update.name),value=this.fromFields(proto.update.fields||{});if(proto.updateMask){var fieldMask=this.fromDocumentMask(proto.updateMask);return new PatchMutation(key,value,fieldMask,precondition)}return new SetMutation(key,value,precondition)}if(proto.delete){var key=this.fromName(proto.delete);return new DeleteMutation(key,precondition)}if(proto.transform){var key=this.fromName(proto.transform.document),fieldTransforms=proto.transform.fieldTransforms.map(function(transform){return _this.fromFieldTransform(transform)});return assert(!0===precondition.exists,'Transforms only support precondition "exists == true"'),new TransformMutation(key,fieldTransforms)}return fail('unknown mutation proto: '+JSON.stringify(proto))},JsonProtoSerializer.prototype.toPrecondition=function(precondition){return assert(!precondition.isNone,'Can\'t serialize an empty precondition'),void 0===precondition.updateTime?void 0===precondition.exists?fail('Unknown precondition'):{exists:precondition.exists}:{updateTime:this.toVersion(precondition.updateTime)}},JsonProtoSerializer.prototype.fromPrecondition=function(precondition){return void 0===precondition.updateTime?void 0===precondition.exists?Precondition.NONE:Precondition.exists(precondition.exists):Precondition.updateTime(this.fromVersion(precondition.updateTime))},JsonProtoSerializer.prototype.fromWriteResult=function(proto,commitTime){var _this=this,version=proto.updateTime?this.fromVersion(proto.updateTime):this.fromVersion(commitTime),transformResults=null;return proto.transformResults&&0<proto.transformResults.length&&(transformResults=proto.transformResults.map(function(result){return _this.fromValue(result)})),new MutationResult(version,transformResults)},JsonProtoSerializer.prototype.fromWriteResults=function(protos,commitTime){var _this=this;return protos&&0<protos.length?(assert(void 0!==commitTime,'Received a write result without a commit time'),protos.map(function(proto){return _this.fromWriteResult(proto,commitTime)})):[]},JsonProtoSerializer.prototype.toFieldTransform=function(fieldTransform){var _this=this,transform=fieldTransform.transform;if(transform instanceof ServerTimestampTransform)return{fieldPath:fieldTransform.field.canonicalString(),setToServerValue:'REQUEST_TIME'};if(transform instanceof ArrayUnionTransformOperation)return{fieldPath:fieldTransform.field.canonicalString(),appendMissingElements:{values:transform.elements.map(function(v){return _this.toValue(v)})}};if(transform instanceof ArrayRemoveTransformOperation)return{fieldPath:fieldTransform.field.canonicalString(),removeAllFromArray:{values:transform.elements.map(function(v){return _this.toValue(v)})}};throw fail('Unknown transform: '+fieldTransform.transform)},JsonProtoSerializer.prototype.fromFieldTransform=function(proto){var _this=this,type=proto.transform_type,transform=null;if(hasTag(proto,type,'setToServerValue'))assert('REQUEST_TIME'===proto.setToServerValue,'Unknown server value transform proto: '+JSON.stringify(proto)),transform=ServerTimestampTransform.instance;else if(hasTag(proto,type,'appendMissingElements')){var values$$1=proto.appendMissingElements.values||[];transform=new ArrayUnionTransformOperation(values$$1.map(function(v){return _this.fromValue(v)}))}else if(hasTag(proto,type,'removeAllFromArray')){var values$$1=proto.removeAllFromArray.values||[];transform=new ArrayRemoveTransformOperation(values$$1.map(function(v){return _this.fromValue(v)}))}else fail('Unknown transform proto: '+JSON.stringify(proto));var fieldPath=FieldPath.fromServerFormat(proto.fieldPath);return new FieldTransform(fieldPath,transform)},JsonProtoSerializer.prototype.toDocumentsTarget=function(query){return{documents:[this.toQueryPath(query.path)]}},JsonProtoSerializer.prototype.fromDocumentsTarget=function(documentsTarget){var count=documentsTarget.documents.length;assert(1===count,'DocumentsTarget contained other than 1 document: '+count);var name=documentsTarget.documents[0];return Query.atPath(this.fromQueryPath(name))},JsonProtoSerializer.prototype.toQueryTarget=function(query){var result={structuredQuery:{}};if(query.path.isEmpty())result.parent=this.toQueryPath(ResourcePath.EMPTY_PATH);else{var path=query.path;assert(0!=path.length%2,'Document queries with filters are not supported.'),result.parent=this.toQueryPath(path.popLast()),result.structuredQuery.from=[{collectionId:path.lastSegment()}]}var where=this.toFilter(query.filters);where&&(result.structuredQuery.where=where);var orderBy=this.toOrder(query.orderBy);orderBy&&(result.structuredQuery.orderBy=orderBy);var limit=this.toInt32Value(query.limit);return void 0!==limit&&(result.structuredQuery.limit=limit),query.startAt&&(result.structuredQuery.startAt=this.toCursor(query.startAt)),query.endAt&&(result.structuredQuery.endAt=this.toCursor(query.endAt)),result},JsonProtoSerializer.prototype.fromQueryTarget=function(target){var path=this.fromQueryPath(target.parent),query=target.structuredQuery,fromCount=query.from?query.from.length:0;if(0<fromCount){assert(1===fromCount,'StructuredQuery.from with more than one collection is not supported.');var from=query.from[0];path=path.child(from.collectionId)}var filterBy=[];query.where&&(filterBy=this.fromFilter(query.where));var orderBy=[];query.orderBy&&(orderBy=this.fromOrder(query.orderBy));var limit=null;query.limit&&(limit=this.fromInt32Value(query.limit));var startAt=null;query.startAt&&(startAt=this.fromCursor(query.startAt));var endAt=null;return query.endAt&&(endAt=this.fromCursor(query.endAt)),new Query(path,orderBy,filterBy,limit,startAt,endAt)},JsonProtoSerializer.prototype.toListenRequestLabels=function(queryData){var value=this.toLabel(queryData.purpose);return null==value?null:{"goog-listen-tags":value}},JsonProtoSerializer.prototype.toLabel=function(purpose){return purpose===QueryPurpose.Listen?null:purpose===QueryPurpose.ExistenceFilterMismatch?'existence-filter-mismatch':purpose===QueryPurpose.LimboResolution?'limbo-document':fail('Unrecognized query purpose: '+purpose)},JsonProtoSerializer.prototype.toTarget=function(queryData){var query=queryData.query,result;return result=query.isDocumentQuery()?{documents:this.toDocumentsTarget(query)}:{query:this.toQueryTarget(query)},result.targetId=queryData.targetId,0<queryData.resumeToken.length&&(result.resumeToken=this.unsafeCastProtoByteString(queryData.resumeToken)),result},JsonProtoSerializer.prototype.toFilter=function(filters){var _this=this;if(0!==filters.length){var protos=filters.map(function(filter){return filter instanceof RelationFilter?_this.toRelationFilter(filter):_this.toUnaryFilter(filter)});return 1===protos.length?protos[0]:{compositeFilter:{op:'AND',filters:protos}}}},JsonProtoSerializer.prototype.fromFilter=function(filter){var _this=this;return filter?void 0===filter.unaryFilter?void 0===filter.fieldFilter?void 0===filter.compositeFilter?fail('Unknown filter: '+JSON.stringify(filter)):filter.compositeFilter.filters.map(function(f){return _this.fromFilter(f)}).reduce(function(accum,current){return accum.concat(current)}):[this.fromRelationFilter(filter)]:[this.fromUnaryFilter(filter)]:[]},JsonProtoSerializer.prototype.toOrder=function(orderBys){var _this=this;return 0===orderBys.length?void 0:orderBys.map(function(order){return _this.toPropertyOrder(order)})},JsonProtoSerializer.prototype.fromOrder=function(orderBys){var _this=this;return orderBys.map(function(order){return _this.fromPropertyOrder(order)})},JsonProtoSerializer.prototype.toCursor=function(cursor){var _this=this;return{before:cursor.before,values:cursor.position.map(function(component){return _this.toValue(component)})}},JsonProtoSerializer.prototype.fromCursor=function(cursor){var _this=this,before=!!cursor.before,position=cursor.values.map(function(component){return _this.fromValue(component)});return new Bound(position,before)},JsonProtoSerializer.prototype.toDirection=function(dir){return DIRECTIONS[dir.name]},JsonProtoSerializer.prototype.fromDirection=function(dir){return'ASCENDING'===dir?Direction.ASCENDING:'DESCENDING'===dir?Direction.DESCENDING:void 0},JsonProtoSerializer.prototype.toOperatorName=function(op){return OPERATORS[op.name]},JsonProtoSerializer.prototype.fromOperatorName=function(op){return'EQUAL'===op?RelationOp.EQUAL:'GREATER_THAN'===op?RelationOp.GREATER_THAN:'GREATER_THAN_OR_EQUAL'===op?RelationOp.GREATER_THAN_OR_EQUAL:'LESS_THAN'===op?RelationOp.LESS_THAN:'LESS_THAN_OR_EQUAL'===op?RelationOp.LESS_THAN_OR_EQUAL:'ARRAY_CONTAINS'===op?RelationOp.ARRAY_CONTAINS:'OPERATOR_UNSPECIFIED'===op?fail('Unspecified relation'):fail('Unknown relation')},JsonProtoSerializer.prototype.toFieldPathReference=function(path){return{fieldPath:path.canonicalString()}},JsonProtoSerializer.prototype.fromFieldPathReference=function(fieldReference){return FieldPath.fromServerFormat(fieldReference.fieldPath)},JsonProtoSerializer.prototype.toPropertyOrder=function(orderBy){return{field:this.toFieldPathReference(orderBy.field),direction:this.toDirection(orderBy.dir)}},JsonProtoSerializer.prototype.fromPropertyOrder=function(orderBy){return new OrderBy(this.fromFieldPathReference(orderBy.field),this.fromDirection(orderBy.direction))},JsonProtoSerializer.prototype.toRelationFilter=function(filter){return filter instanceof RelationFilter?{fieldFilter:{field:this.toFieldPathReference(filter.field),op:this.toOperatorName(filter.op),value:this.toValue(filter.value)}}:fail('Unrecognized filter: '+JSON.stringify(filter))},JsonProtoSerializer.prototype.fromRelationFilter=function(filter){return new RelationFilter(this.fromFieldPathReference(filter.fieldFilter.field),this.fromOperatorName(filter.fieldFilter.op),this.fromValue(filter.fieldFilter.value))},JsonProtoSerializer.prototype.toUnaryFilter=function(filter){return filter instanceof NanFilter?{unaryFilter:{field:this.toFieldPathReference(filter.field),op:'IS_NAN'}}:filter instanceof NullFilter?{unaryFilter:{field:this.toFieldPathReference(filter.field),op:'IS_NULL'}}:fail('Unrecognized filter: '+JSON.stringify(filter))},JsonProtoSerializer.prototype.fromUnaryFilter=function(filter){switch(filter.unaryFilter.op){case'IS_NAN':var nanField=this.fromFieldPathReference(filter.unaryFilter.field);return new NanFilter(nanField);case'IS_NULL':var nullField=this.fromFieldPathReference(filter.unaryFilter.field);return new NullFilter(nullField);case'OPERATOR_UNSPECIFIED':return fail('Unspecified filter');default:return fail('Unknown filter');}},JsonProtoSerializer.prototype.toDocumentMask=function(fieldMask){return{fieldPaths:fieldMask.fields.map(function(field){return field.canonicalString()})}},JsonProtoSerializer.prototype.fromDocumentMask=function(proto){var paths=proto.fieldPaths||[],fields=paths.map(function(path){return FieldPath.fromServerFormat(path)});return new FieldMask(fields)},JsonProtoSerializer}(),isReactNative=function(){return'object'==typeof navigator&&'ReactNative'===navigator.product},ERROR_NAME='FirebaseError',captureStackTrace=Error.captureStackTrace,FirebaseError=function(){return function FirebaseError(code,message){if(this.code=code,this.message=message,captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else try{throw Error.apply(this,arguments)}catch(err){this.name=ERROR_NAME,Object.defineProperty(this,'stack',{get:function(){return err.stack}})}}}();FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors,this.pattern=/\{\$([^}]+)}/g}return ErrorFactory.prototype.create=function(code,data){void 0===data&&(data={});var template=this.errors[code],fullCode=this.service+'/'+code,message;message=void 0===template?'Error':template.replace(this.pattern,function(match,key){var value=data[key];return void 0===value?'<'+key+'?>':value.toString()}),message=this.serviceName+': '+message+' ('+fullCode+').';var err=new FirebaseError(fullCode,message);for(var prop in data)data.hasOwnProperty(prop)&&'_'!==prop.slice(-1)&&(err[prop]=data[prop]);return err},ErrorFactory}(),Hash=function(){return function Hash(){this.blockSize=-1}}(),Sha1=function(_super){function Sha1(){var _this=_super.call(this)||this;_this.chain_=[],_this.buf_=[],_this.W_=[],_this.pad_=[],_this.inbuf_=0,_this.total_=0,_this.blockSize=512/8,_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i)_this.pad_[i]=0;return _this.reset(),_this}return tslib_1.__extends(Sha1,_super),Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,opt_offset){opt_offset||(opt_offset=0);var W=this.W_;if('string'==typeof buf)for(var i=0;16>i;i++)W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3),opt_offset+=4;else for(var i=0;16>i;i++)W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3],opt_offset+=4;for(var i=16,t;80>i;i++)t=W[i-3]^W[i-8]^W[i-14]^W[i-16],W[i]=4294967295&(t<<1|t>>>31);for(var a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0,f,k;80>i;i++){40>i?20>i?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):60>i?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=4294967295&(a<<5|a>>>27)+f+e+k+W[i];e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=4294967295&this.chain_[0]+a,this.chain_[1]=4294967295&this.chain_[1]+b,this.chain_[2]=4294967295&this.chain_[2]+c,this.chain_[3]=4294967295&this.chain_[3]+d,this.chain_[4]=4294967295&this.chain_[4]+e},Sha1.prototype.update=function(bytes,opt_length){if(null!=bytes){void 0===opt_length&&(opt_length=bytes.length);for(var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<opt_length;){if(0==inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if('string'==typeof bytes){for(;n<opt_length;)if(buf[inbuf]=bytes.charCodeAt(n),++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<opt_length;)if(buf[inbuf]=bytes[n],++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=opt_length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;56>this.inbuf_?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;56<=i;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);for(var n=0,i=0;5>i;i++)for(var j=24;0<=j;j-=8)digest[n]=255&this.chain_[i]>>j,++n;return digest},Sha1}(Hash),StreamBridge=function(){function StreamBridge(args){this.sendFn=args.sendFn,this.closeFn=args.closeFn}return StreamBridge.prototype.onOpen=function(callback){assert(!this.wrappedOnOpen,'Called onOpen on stream twice!'),this.wrappedOnOpen=callback},StreamBridge.prototype.onClose=function(callback){assert(!this.wrappedOnClose,'Called onClose on stream twice!'),this.wrappedOnClose=callback},StreamBridge.prototype.onMessage=function(callback){assert(!this.wrappedOnMessage,'Called onMessage on stream twice!'),this.wrappedOnMessage=callback},StreamBridge.prototype.close=function(){this.closeFn()},StreamBridge.prototype.send=function(msg){this.sendFn(msg)},StreamBridge.prototype.callOnOpen=function(){assert(void 0!==this.wrappedOnOpen,'Cannot call onOpen because no callback was set'),this.wrappedOnOpen()},StreamBridge.prototype.callOnClose=function(err){assert(void 0!==this.wrappedOnClose,'Cannot call onClose because no callback was set'),this.wrappedOnClose(err)},StreamBridge.prototype.callOnMessage=function(msg){assert(void 0!==this.wrappedOnMessage,'Cannot call onMessage because no callback was set'),this.wrappedOnMessage(msg)},StreamBridge}(),LOG_TAG='Connection',RPC_NAME_REST_MAPPING={BatchGetDocuments:'batchGet',Commit:'commit'},WebChannelConnection=function(){function WebChannelConnection(info){this.databaseId=info.databaseId,this.pool=new webchannelWrapper.XhrIoPool;var proto=info.ssl?'https':'http';this.baseUrl=proto+'://'+info.host}return WebChannelConnection.prototype.modifyHeadersForRequest=function(headers,token){if(token)for(var header in token.authHeaders)token.authHeaders.hasOwnProperty(header)&&(headers[header]=token.authHeaders[header]);headers['X-Goog-Api-Client']='gl-js/ fire/'+SDK_VERSION},WebChannelConnection.prototype.invokeRPC=function(rpcName,request,token){var _this=this,url=this.makeUrl(rpcName);return new Promise(function(resolve,reject){_this.pool.getObject(function(xhr){xhr.listenOnce(webchannelWrapper.EventType.COMPLETE,function(){try{switch(xhr.getLastErrorCode()){case webchannelWrapper.ErrorCode.NO_ERROR:var json=xhr.getResponseJson();debug(LOG_TAG,'XHR received:',JSON.stringify(json)),resolve(json);break;case webchannelWrapper.ErrorCode.TIMEOUT:debug(LOG_TAG,'RPC "'+rpcName+'" timed out'),reject(new FirestoreError(Code.DEADLINE_EXCEEDED,'Request time out'));break;case webchannelWrapper.ErrorCode.HTTP_ERROR:var status_1=xhr.getStatus();debug(LOG_TAG,'RPC "'+rpcName+'" failed with status:',status_1,'response text:',xhr.getResponseText()),0<status_1?reject(new FirestoreError(mapCodeFromHttpStatus(status_1),'Server responded with status '+xhr.getStatusText())):(debug(LOG_TAG,'RPC "'+rpcName+'" failed'),reject(new FirestoreError(Code.UNAVAILABLE,'Connection failed.')));break;default:fail('RPC "'+rpcName+'" failed with unanticipated '+'webchannel error '+xhr.getLastErrorCode()+': '+xhr.getLastError()+', giving up.');}}finally{debug(LOG_TAG,'RPC "'+rpcName+'" completed.'),_this.pool.releaseObject(xhr)}});var requestString=JSON.stringify(request);debug(LOG_TAG,'XHR sending: ',url+' '+requestString);var headers={"Content-Type":'text/plain'};_this.modifyHeadersForRequest(headers,token),xhr.send(url,'POST',requestString,headers,15)})})},WebChannelConnection.prototype.invokeStreamingRPC=function(rpcName,request,token){return this.invokeRPC(rpcName,request,token)},WebChannelConnection.prototype.openStream=function(rpcName,token){var urlParts=[this.baseUrl,'/','google.firestore.v1beta1.Firestore','/',rpcName,'/channel'],webchannelTransport=webchannelWrapper.createWebChannelTransport(),request={backgroundChannelTest:!0,httpSessionIdParam:'gsessionid',initMessageHeaders:{},messageUrlParams:{database:'projects/'+this.databaseId.projectId+'/databases/'+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(request.initMessageHeaders,token),isReactNative()||(request.httpHeadersOverwriteParam='$httpHeaders');var url=urlParts.join('');debug(LOG_TAG,'Creating WebChannel: '+url+' '+request);var channel=webchannelTransport.createWebChannel(url,request),opened=!1,closed=!1,streamBridge=new StreamBridge({sendFn:function(msg){closed?debug(LOG_TAG,'Not sending because WebChannel is closed:',msg):(!opened&&(debug(LOG_TAG,'Opening WebChannel transport.'),channel.open(),opened=!0),debug(LOG_TAG,'WebChannel sending:',msg),channel.send(msg))},closeFn:function(){return channel.close()}}),unguardedEventListen=function(type,fn){channel.listen(type,function(param){try{fn(param)}catch(e){setTimeout(function(){throw e},0)}})};return unguardedEventListen(webchannelWrapper.WebChannel.EventType.OPEN,function(){closed||debug(LOG_TAG,'WebChannel transport opened.')}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.CLOSE,function(){closed||(closed=!0,debug(LOG_TAG,'WebChannel transport closed'),streamBridge.callOnClose())}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.ERROR,function(err){closed||(closed=!0,debug(LOG_TAG,'WebChannel transport errored:',err),streamBridge.callOnClose(new FirestoreError(Code.UNAVAILABLE,'The operation could not be completed')))}),unguardedEventListen(webchannelWrapper.WebChannel.EventType.MESSAGE,function(msg){if(!closed){var msgData=msg.data[0];assert(!!msgData,'Got a webchannel message without data.');var error$$1=msgData.error||msgData[0]&&msgData[0].error;if(error$$1){debug(LOG_TAG,'WebChannel received error:',error$$1);var status_2=error$$1.status,code=mapCodeFromRpcStatus(status_2),message=error$$1.message;void 0===code&&(code=Code.INTERNAL,message='Unknown error status: '+status_2+' with message '+error$$1.message),closed=!0,streamBridge.callOnClose(new FirestoreError(code,message)),channel.close()}else debug(LOG_TAG,'WebChannel received:',msgData),streamBridge.callOnMessage(msgData)}}),setTimeout(function(){streamBridge.callOnOpen()},0),streamBridge},WebChannelConnection.prototype.makeUrl=function(rpcName){var urlRpcName=RPC_NAME_REST_MAPPING[rpcName];assert(void 0!==urlRpcName,'Unknown REST mapping for: '+rpcName);var url=[this.baseUrl,'/','v1beta1','/projects/',this.databaseId.projectId,'/databases/',this.databaseId.database,'/documents',':',urlRpcName];return url.join('')},WebChannelConnection}(),BrowserPlatform=function(){function BrowserPlatform(){this.emptyByteString='',this.base64Available='undefined'!=typeof atob}return Object.defineProperty(BrowserPlatform.prototype,'document',{get:function(){return'undefined'==typeof document?null:document},enumerable:!0,configurable:!0}),Object.defineProperty(BrowserPlatform.prototype,'window',{get:function(){return'undefined'==typeof window?null:window},enumerable:!0,configurable:!0}),BrowserPlatform.prototype.loadConnection=function(databaseInfo){return Promise.resolve(new WebChannelConnection(databaseInfo))},BrowserPlatform.prototype.newSerializer=function(databaseId){return new JsonProtoSerializer(databaseId,{useProto3Json:!0})},BrowserPlatform.prototype.formatJSON=function(value){return JSON.stringify(value)},BrowserPlatform.prototype.atob=function(encoded){return atob(encoded)},BrowserPlatform.prototype.btoa=function(raw){return btoa(raw)},BrowserPlatform}();PlatformSupport.setPlatform(new BrowserPlatform);var ListenSequence=function(){function ListenSequence(previousValue,sequenceNumberSyncer){var _this=this;this.previousValue=previousValue,sequenceNumberSyncer&&(sequenceNumberSyncer.sequenceNumberHandler=function(sequenceNumber){return _this.setPreviousValue(sequenceNumber)},this.writeNewSequenceNumber=function(sequenceNumber){return sequenceNumberSyncer.writeSequenceNumber(sequenceNumber)})}return ListenSequence.prototype.setPreviousValue=function(externalPreviousValue){return this.previousValue=_Mathmax(externalPreviousValue,this.previousValue),this.previousValue},ListenSequence.prototype.next=function(){var nextValue=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(nextValue),nextValue},ListenSequence.INVALID=-1,ListenSequence}(),Deferred$1=function(){return function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve,_this.reject=reject})}}(),TimerId;(function(TimerId){TimerId.All='all',TimerId.ListenStreamIdle='listen_stream_idle',TimerId.ListenStreamConnectionBackoff='listen_stream_connection_backoff',TimerId.WriteStreamIdle='write_stream_idle',TimerId.WriteStreamConnectionBackoff='write_stream_connection_backoff',TimerId.OnlineStateTimeout='online_state_timeout',TimerId.ClientMetadataRefresh='client_metadata_refresh'})(TimerId||(TimerId={}));var DelayedOperation=function(){function DelayedOperation(asyncQueue,timerId,targetTimeMs,op,removalCallback){this.asyncQueue=asyncQueue,this.timerId=timerId,this.targetTimeMs=targetTimeMs,this.op=op,this.removalCallback=removalCallback,this.deferred=new Deferred$1,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(){})}return DelayedOperation.createAndSchedule=function(asyncQueue,timerId,delayMs,op,removalCallback){var targetTime=Date.now()+delayMs,delayedOp=new DelayedOperation(asyncQueue,timerId,targetTime,op,removalCallback);return delayedOp.start(delayMs),delayedOp},DelayedOperation.prototype.start=function(delayMs){var _this=this;this.timerHandle=setTimeout(function(){return _this.handleDelayElapsed()},delayMs)},DelayedOperation.prototype.skipDelay=function(){return this.handleDelayElapsed()},DelayedOperation.prototype.cancel=function(reason){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(Code.CANCELLED,'Operation cancelled'+(reason?': '+reason:''))))},DelayedOperation.prototype.handleDelayElapsed=function(){var _this=this;this.asyncQueue.enqueueAndForget(function(){return null===_this.timerHandle?Promise.resolve():(_this.clearTimeout(),_this.op().then(function(result){return _this.deferred.resolve(result)}))})},DelayedOperation.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},DelayedOperation}(),AsyncQueue=function(){function AsyncQueue(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return AsyncQueue.prototype.enqueueAndForget=function(op){this.enqueue(op)},AsyncQueue.prototype.enqueue=function(op){var _this=this;this.verifyNotFailed();var newTail=this.tail.then(function(){return _this.operationInProgress=!0,op().catch(function(error$$1){_this.failure=error$$1,_this.operationInProgress=!1;var message=error$$1.stack||error$$1.message||'';throw error('INTERNAL UNHANDLED ERROR: ',message),0>message.indexOf('Firestore Test Simulated Error')&&setTimeout(function(){throw error$$1},0),error$$1}).then(function(result){return _this.operationInProgress=!1,result})});return this.tail=newTail,newTail},AsyncQueue.prototype.enqueueAfterDelay=function(timerId,delayMs,op){var _this=this;this.verifyNotFailed(),assert(0<=delayMs,'Attempted to schedule an operation with a negative delay of '+delayMs),assert(!this.containsDelayedOperation(timerId),'Attempted to schedule multiple operations with timer id '+timerId+'.');var delayedOp=DelayedOperation.createAndSchedule(this,timerId,delayMs,op,function(op){return _this.removeDelayedOperation(op)});return this.delayedOperations.push(delayedOp),delayedOp},AsyncQueue.prototype.verifyNotFailed=function(){this.failure&&fail('AsyncQueue is already failed: '+(this.failure.stack||this.failure.message))},AsyncQueue.prototype.verifyOperationInProgress=function(){assert(this.operationInProgress,'verifyOpInProgress() called when no op in progress on this queue.')},AsyncQueue.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},AsyncQueue.prototype.containsDelayedOperation=function(timerId){for(var _i=0,_a=this.delayedOperations,op;_i<_a.length;_i++)if(op=_a[_i],op.timerId===timerId)return!0;return!1},AsyncQueue.prototype.runDelayedOperationsEarly=function(lastTimerId){var _this=this;return this.drain().then(function(){assert(lastTimerId===TimerId.All||_this.containsDelayedOperation(lastTimerId),'Attempted to drain to missing operation '+lastTimerId),_this.delayedOperations.sort(function(a,b){return a.targetTimeMs-b.targetTimeMs});for(var _i=0,_a=_this.delayedOperations,op;_i<_a.length&&(op=_a[_i],op.skipDelay(),lastTimerId===TimerId.All||op.timerId!==lastTimerId);_i++);return _this.drain()})},AsyncQueue.prototype.removeDelayedOperation=function(op){var index=this.delayedOperations.indexOf(op);assert(0<=index,'Delayed operation not found.'),this.delayedOperations.splice(index,1)},AsyncQueue}(),escapeChar='\x01',encodedSeparatorChar='\x01',encodedNul='\x10',encodedEscape='\x11',BATCHID_UNKNOWN=-1,MutationBatch=function(){function MutationBatch(batchId,localWriteTime,mutations){this.batchId=batchId,this.localWriteTime=localWriteTime,this.mutations=mutations,assert(0<mutations.length,'Cannot create an empty mutation batch')}return MutationBatch.prototype.applyToRemoteDocument=function(docKey,maybeDoc,batchResult){maybeDoc&&assert(maybeDoc.key.isEqual(docKey),'applyToRemoteDocument: key '+docKey+' should match maybeDoc key\n        '+maybeDoc.key);var mutationResults=batchResult.mutationResults;assert(mutationResults.length===this.mutations.length,'Mismatch between mutations length\n      ('+this.mutations.length+') and mutation results length\n      ('+mutationResults.length+').');for(var i=0,mutation;i<this.mutations.length;i++)if(mutation=this.mutations[i],mutation.key.isEqual(docKey)){var mutationResult=mutationResults[i];maybeDoc=mutation.applyToRemoteDocument(maybeDoc,mutationResult)}return maybeDoc},MutationBatch.prototype.applyToLocalView=function(docKey,maybeDoc){maybeDoc&&assert(maybeDoc.key.isEqual(docKey),'applyToLocalDocument: key '+docKey+' should match maybeDoc key\n        '+maybeDoc.key);for(var baseDoc=maybeDoc,i=0,mutation;i<this.mutations.length;i++)mutation=this.mutations[i],mutation.key.isEqual(docKey)&&(maybeDoc=mutation.applyToLocalView(maybeDoc,baseDoc,this.localWriteTime));return maybeDoc},MutationBatch.prototype.keys=function(){for(var keySet=documentKeySet(),_i=0,_a=this.mutations,mutation;_i<_a.length;_i++)mutation=_a[_i],keySet=keySet.add(mutation.key);return keySet},MutationBatch.prototype.isEqual=function(other){return this.batchId===other.batchId&&arrayEquals(this.mutations,other.mutations)},MutationBatch}(),MutationBatchResult=function(){function MutationBatchResult(batch,commitVersion,mutationResults,streamToken,docVersions){this.batch=batch,this.commitVersion=commitVersion,this.mutationResults=mutationResults,this.streamToken=streamToken,this.docVersions=docVersions}return MutationBatchResult.from=function(batch,commitVersion,results,streamToken){assert(batch.mutations.length===results.length,'Mutations sent '+batch.mutations.length+' must equal results received '+results.length);for(var versionMap=documentVersionMap(),mutations=batch.mutations,i=0;i<mutations.length;i++)versionMap=versionMap.insert(mutations[i].key,results[i].version);return new MutationBatchResult(batch,commitVersion,results,streamToken,versionMap)},MutationBatchResult}(),PersistencePromise=function(){function PersistencePromise(callback){var _this=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,callback(function(value){_this.isDone=!0,_this.result=value,_this.nextCallback&&_this.nextCallback(value)},function(error){_this.isDone=!0,_this.error=error,_this.catchCallback&&_this.catchCallback(error)})}return PersistencePromise.prototype.catch=function(fn){return this.next(void 0,fn)},PersistencePromise.prototype.next=function(nextFn,catchFn){var _this=this;return this.callbackAttached&&fail('Called next() or catch() twice for PersistencePromise'),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(catchFn,this.error):this.wrapSuccess(nextFn,this.result):new PersistencePromise(function(resolve,reject){_this.nextCallback=function(value){_this.wrapSuccess(nextFn,value).next(resolve,reject)},_this.catchCallback=function(error){_this.wrapFailure(catchFn,error).next(resolve,reject)}})},PersistencePromise.prototype.toPromise=function(){var _this=this;return new Promise(function(resolve,reject){_this.next(resolve,reject)})},PersistencePromise.prototype.wrapUserFunction=function(fn){try{var result=fn();return result instanceof PersistencePromise?result:PersistencePromise.resolve(result)}catch(e){return PersistencePromise.reject(e)}},PersistencePromise.prototype.wrapSuccess=function(nextFn,value){return nextFn?this.wrapUserFunction(function(){return nextFn(value)}):PersistencePromise.resolve(value)},PersistencePromise.prototype.wrapFailure=function(catchFn,error){return catchFn?this.wrapUserFunction(function(){return catchFn(error)}):PersistencePromise.reject(error)},PersistencePromise.resolve=function(result){return new PersistencePromise(function(resolve){resolve(result)})},PersistencePromise.reject=function(error){return new PersistencePromise(function(resolve,reject){reject(error)})},PersistencePromise.waitFor=function(all){return new PersistencePromise(function(resolve,reject){var expectedCount=0,resolvedCount=0,done=!1;all.forEach(function(element){++expectedCount,element.next(function(){++resolvedCount,done&&resolvedCount==expectedCount&&resolve()},function(err){return reject(err)})}),done=!0,resolvedCount==expectedCount&&resolve()})},PersistencePromise.or=function(predicates){for(var p=PersistencePromise.resolve(!1),_loop_1=function(predicate){p=p.next(function(isTrue){return isTrue?PersistencePromise.resolve(isTrue):predicate()})},_i=0,predicates_1=predicates,predicate;_i<predicates_1.length;_i++)predicate=predicates_1[_i],_loop_1(predicate);return p},PersistencePromise.forEach=function(collection,f){var _this=this,promises=[];return collection.forEach(function(r,s){promises.push(f.call(_this,r,s))}),this.waitFor(promises)},PersistencePromise}(),ObjectMap=function(){function ObjectMap(mapKeyFn){this.mapKeyFn=mapKeyFn,this.inner={}}return ObjectMap.prototype.get=function(key){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0!==matches)for(var _i=0,matches_1=matches;_i<matches_1.length;_i++){var _a=matches_1[_i],otherKey=_a[0],value=_a[1];if(otherKey.isEqual(key))return value}},ObjectMap.prototype.has=function(key){return void 0!==this.get(key)},ObjectMap.prototype.set=function(key,value){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0===matches)return void(this.inner[id]=[[key,value]]);for(var i=0;i<matches.length;i++)if(matches[i][0].isEqual(key))return void(matches[i]=[key,value]);matches.push([key,value])},ObjectMap.prototype.delete=function(key){var id=this.mapKeyFn(key),matches=this.inner[id];if(void 0===matches)return!1;for(var i=0;i<matches.length;i++)if(matches[i][0].isEqual(key))return 1===matches.length?delete this.inner[id]:matches.splice(i,1),!0;return!1},ObjectMap.prototype.forEach=function(fn){forEach(this.inner,function(_,entries){for(var _i=0,entries_1=entries;_i<entries_1.length;_i++){var _a=entries_1[_i],k=_a[0],v=_a[1];fn(k,v)}})},ObjectMap.prototype.isEmpty=function(){return isEmpty(this.inner)},ObjectMap}(),RemoteDocumentChangeBuffer=function(){function RemoteDocumentChangeBuffer(){this.changes=maybeDocumentMap(),this.documentSizes=new ObjectMap(function(key){return key.toString()})}return RemoteDocumentChangeBuffer.prototype.addEntry=function(maybeDocument){var changes=this.assertChanges();this.changes=changes.insert(maybeDocument.key,maybeDocument)},RemoteDocumentChangeBuffer.prototype.getEntry=function(transaction,documentKey){var _this=this,changes=this.assertChanges(),bufferedEntry=changes.get(documentKey);return bufferedEntry?PersistencePromise.resolve(bufferedEntry):this.getFromCache(transaction,documentKey).next(function(getResult){return null===getResult?(_this.documentSizes.set(documentKey,0),null):(_this.documentSizes.set(documentKey,getResult.size),getResult.maybeDocument)})},RemoteDocumentChangeBuffer.prototype.apply=function(transaction){var result=this.applyChanges(transaction);return this.changes=null,result},RemoteDocumentChangeBuffer.prototype.assertChanges=function(){return assert(null!==this.changes,'Changes have already been applied.'),this.changes},RemoteDocumentChangeBuffer}(),LOG_TAG$1='SimpleDb',SimpleDb=function(){function SimpleDb(db){this.db=db}return SimpleDb.openOrCreate=function(name,version,schemaConverter){return assert(SimpleDb.isAvailable(),'IndexedDB not supported in current environment.'),debug(LOG_TAG$1,'Opening database:',name),new PersistencePromise(function(resolve,reject){var request=window.indexedDB.open(name,version);request.onsuccess=function(event){var db=event.target.result;resolve(new SimpleDb(db))},request.onblocked=function(){reject(new FirestoreError(Code.FAILED_PRECONDITION,'Cannot upgrade IndexedDB schema while another tab is open. '+'Close all tabs that access Firestore and reload this page to proceed.'))},request.onerror=function(event){reject(event.target.error)},request.onupgradeneeded=function(event){debug(LOG_TAG$1,'Database "'+name+'" requires upgrade from version:',event.oldVersion);var db=event.target.result,txn=new SimpleDbTransaction(request.transaction);schemaConverter.createOrUpgrade(db,txn,event.oldVersion,SCHEMA_VERSION).next(function(){debug(LOG_TAG$1,'Database upgrade to version '+SCHEMA_VERSION+' complete')})}}).toPromise()},SimpleDb.delete=function(name){return debug(LOG_TAG$1,'Removing database:',name),wrapRequest(window.indexedDB.deleteDatabase(name)).toPromise()},SimpleDb.isAvailable=function(){if('undefined'==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return'YES'===process.env.USE_MOCK_PERSISTENCE;var ua=window.navigator.userAgent;return 0<ua.indexOf('MSIE ')||0<ua.indexOf('Trident/')||0<ua.indexOf('Edge/')?!1:!0},SimpleDb.getStore=function(txn,store){return txn.store(store)},SimpleDb.prototype.runTransaction=function(mode,objectStores,transactionFn){var transaction=SimpleDbTransaction.open(this.db,mode,objectStores),transactionFnResult=transactionFn(transaction).catch(function(error$$1){transaction.abort(error$$1)}).toPromise();return transaction.completionPromise.then(function(){return transactionFnResult})},SimpleDb.prototype.close=function(){this.db.close()},SimpleDb}(),IterationController=function(){function IterationController(dbCursor){this.dbCursor=dbCursor,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(IterationController.prototype,'isDone',{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(IterationController.prototype,'skipToKey',{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(IterationController.prototype,'cursor',{set:function(value){this.dbCursor=value},enumerable:!0,configurable:!0}),IterationController.prototype.done=function(){this.shouldStop=!0},IterationController.prototype.skip=function(key){this.nextKey=key},IterationController.prototype.delete=function(){return wrapRequest(this.dbCursor.delete())},IterationController}(),SimpleDbTransaction=function(){function SimpleDbTransaction(transaction){var _this=this;this.transaction=transaction,this.aborted=!1,this.completionDeferred=new Deferred$1,this.transaction.oncomplete=function(){_this.completionDeferred.resolve()},this.transaction.onabort=function(){transaction.error?_this.completionDeferred.reject(transaction.error):_this.completionDeferred.resolve()},this.transaction.onerror=function(event){_this.completionDeferred.reject(event.target.error)}}return SimpleDbTransaction.open=function(db,mode,objectStoreNames){return new SimpleDbTransaction(db.transaction(objectStoreNames,mode))},Object.defineProperty(SimpleDbTransaction.prototype,'completionPromise',{get:function(){return this.completionDeferred.promise},enumerable:!0,configurable:!0}),SimpleDbTransaction.prototype.abort=function(error$$1){error$$1&&this.completionDeferred.reject(error$$1),this.aborted||(debug(LOG_TAG$1,'Aborting transaction:',error$$1?error$$1.message:'Client-initiated abort'),this.aborted=!0,this.transaction.abort())},SimpleDbTransaction.prototype.store=function(storeName){var store=this.transaction.objectStore(storeName);return assert(!!store,'Object store not part of transaction: '+storeName),new SimpleDbStore(store)},SimpleDbTransaction}(),SimpleDbStore=function(){function SimpleDbStore(store){this.store=store}return SimpleDbStore.prototype.put=function(keyOrValue,value){var request;return void 0===value?(debug(LOG_TAG$1,'PUT',this.store.name,'<auto-key>',keyOrValue),request=this.store.put(keyOrValue)):(debug(LOG_TAG$1,'PUT',this.store.name,keyOrValue,value),request=this.store.put(value,keyOrValue)),wrapRequest(request)},SimpleDbStore.prototype.add=function(value){debug(LOG_TAG$1,'ADD',this.store.name,value,value);var request=this.store.add(value);return wrapRequest(request)},SimpleDbStore.prototype.get=function(key){var _this=this,request=this.store.get(key);return wrapRequest(request).next(function(result){return void 0===result&&(result=null),debug(LOG_TAG$1,'GET',_this.store.name,key,result),result})},SimpleDbStore.prototype.delete=function(key){debug(LOG_TAG$1,'DELETE',this.store.name,key);var request=this.store.delete(key);return wrapRequest(request)},SimpleDbStore.prototype.count=function(){debug(LOG_TAG$1,'COUNT',this.store.name);var request=this.store.count();return wrapRequest(request)},SimpleDbStore.prototype.loadAll=function(indexOrRange,range){var cursor=this.cursor(this.options(indexOrRange,range)),results=[];return this.iterateCursor(cursor,function(key,value){results.push(value)}).next(function(){return results})},SimpleDbStore.prototype.deleteAll=function(indexOrRange,range){debug(LOG_TAG$1,'DELETE ALL',this.store.name);var options=this.options(indexOrRange,range);options.keysOnly=!1;var cursor=this.cursor(options);return this.iterateCursor(cursor,function(key,value,control){return control.delete()})},SimpleDbStore.prototype.iterate=function(optionsOrCallback,callback){var options;callback?options=optionsOrCallback:(options={},callback=optionsOrCallback);var cursor=this.cursor(options);return this.iterateCursor(cursor,callback)},SimpleDbStore.prototype.iterateSerial=function(callback){var cursorRequest=this.cursor({});return new PersistencePromise(function(resolve,reject){cursorRequest.onerror=function(event){reject(event.target.error)},cursorRequest.onsuccess=function(event){var cursor=event.target.result;return cursor?void callback(cursor.primaryKey,cursor.value).next(function(shouldContinue){shouldContinue?cursor.continue():resolve()}):void resolve()}})},SimpleDbStore.prototype.iterateCursor=function(cursorRequest,fn){var results=[];return new PersistencePromise(function(resolve,reject){cursorRequest.onerror=function(event){reject(event.target.error)},cursorRequest.onsuccess=function(event){var cursor=event.target.result;if(!cursor)return void resolve();var controller=new IterationController(cursor),userResult=fn(cursor.primaryKey,cursor.value,controller);if(userResult instanceof PersistencePromise){var userPromise=userResult.catch(function(err){return controller.done(),PersistencePromise.reject(err)});results.push(userPromise)}controller.isDone?resolve():null===controller.skipToKey?cursor.continue():cursor.continue(controller.skipToKey)}}).next(function(){return PersistencePromise.waitFor(results)})},SimpleDbStore.prototype.options=function(indexOrRange,range){var indexName;return void 0!==indexOrRange&&('string'==typeof indexOrRange?indexName=indexOrRange:(assert(void 0===range,'3rd argument must not be defined if 2nd is a range.'),range=indexOrRange)),{index:indexName,range:range}},SimpleDbStore.prototype.cursor=function(options){var direction='next';if(options.reverse&&(direction='prev'),options.index){var index=this.store.index(options.index);return options.keysOnly?index.openKeyCursor(options.range,direction):index.openCursor(options.range,direction)}return this.store.openCursor(options.range,direction)},SimpleDbStore}(),REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG='The remote document changelog no longer contains all changes for all '+'local query views. It may be necessary to rebuild these views.',IndexedDbRemoteDocumentCache=function(){function IndexedDbRemoteDocumentCache(serializer,keepDocumentChangeLog){this.serializer=serializer,this.keepDocumentChangeLog=keepDocumentChangeLog,this._lastProcessedDocumentChangeId=0}return Object.defineProperty(IndexedDbRemoteDocumentCache.prototype,'lastProcessedDocumentChangeId',{get:function(){return this._lastProcessedDocumentChangeId},enumerable:!0,configurable:!0}),IndexedDbRemoteDocumentCache.prototype.start=function(transaction){var store=SimpleDb.getStore(transaction,DbRemoteDocumentChanges.store);return this.synchronizeLastDocumentChangeId(store)},IndexedDbRemoteDocumentCache.prototype.addEntries=function(transaction,entries,sizeDelta){var promises=[];if(0<entries.length){for(var documentStore=remoteDocumentsStore(transaction),changedKeys=documentKeySet(),_i=0,entries_1=entries;_i<entries_1.length;_i++){var _a=entries_1[_i],key=_a.key,doc=_a.doc;promises.push(documentStore.put(dbKey(key),doc)),changedKeys=changedKeys.add(key)}this.keepDocumentChangeLog&&promises.push(documentChangesStore(transaction).put({changes:this.serializer.toDbResourcePaths(changedKeys)})),promises.push(this.updateSize(transaction,sizeDelta))}return PersistencePromise.waitFor(promises)},IndexedDbRemoteDocumentCache.prototype.removeEntry=function(transaction,documentKey){var store=remoteDocumentsStore(transaction),key=dbKey(documentKey);return store.get(key).next(function(document){return document?store.delete(key).next(function(){return dbDocumentSize(document)}):PersistencePromise.resolve(0)})},IndexedDbRemoteDocumentCache.prototype.getEntry=function(transaction,documentKey){var _this=this;return remoteDocumentsStore(transaction).get(dbKey(documentKey)).next(function(dbRemoteDoc){return dbRemoteDoc?_this.serializer.fromDbRemoteDocument(dbRemoteDoc):null})},IndexedDbRemoteDocumentCache.prototype.getSizedEntry=function(transaction,documentKey){var _this=this;return remoteDocumentsStore(transaction).get(dbKey(documentKey)).next(function(dbRemoteDoc){return dbRemoteDoc?{maybeDocument:_this.serializer.fromDbRemoteDocument(dbRemoteDoc),size:dbDocumentSize(dbRemoteDoc)}:null})},IndexedDbRemoteDocumentCache.prototype.getDocumentsMatchingQuery=function(transaction,query){var _this=this,results=documentMap(),startKey=query.path.toArray(),range=IDBKeyRange.lowerBound(startKey);return remoteDocumentsStore(transaction).iterate({range:range},function(key,dbRemoteDoc,control){var maybeDoc=_this.serializer.fromDbRemoteDocument(dbRemoteDoc);query.path.isPrefixOf(maybeDoc.key.path)?maybeDoc instanceof Document&&query.matches(maybeDoc)&&(results=results.insert(maybeDoc.key,maybeDoc)):control.done()}).next(function(){return results})},IndexedDbRemoteDocumentCache.prototype.getNewDocumentChanges=function(transaction){var _this=this;assert(this.keepDocumentChangeLog,'Can only call getNewDocumentChanges() when document change log is enabled');var changedKeys=documentKeySet(),changedDocs=maybeDocumentMap(),range=IDBKeyRange.lowerBound(this._lastProcessedDocumentChangeId+1),firstIteration=!0,changesStore=documentChangesStore(transaction);return changesStore.iterate({range:range},function(_,documentChange){return firstIteration&&(firstIteration=!1,_this._lastProcessedDocumentChangeId+1!==documentChange.id)?_this.synchronizeLastDocumentChangeId(changesStore).next(function(){return PersistencePromise.reject(new FirestoreError(Code.DATA_LOSS,REMOTE_DOCUMENT_CHANGE_MISSING_ERR_MSG))}):void(changedKeys=changedKeys.unionWith(_this.serializer.fromDbResourcePaths(documentChange.changes)),_this._lastProcessedDocumentChangeId=documentChange.id)}).next(function(){var documentPromises=[];return changedKeys.forEach(function(key){documentPromises.push(_this.getEntry(transaction,key).next(function(maybeDocument){var doc=maybeDocument||new NoDocument(key,SnapshotVersion.forDeletedDoc());changedDocs=changedDocs.insert(key,doc)}))}),PersistencePromise.waitFor(documentPromises)}).next(function(){return changedDocs})},IndexedDbRemoteDocumentCache.prototype.removeDocumentChangesThroughChangeId=function(transaction,changeId){var range=IDBKeyRange.upperBound(changeId);return documentChangesStore(transaction).delete(range)},IndexedDbRemoteDocumentCache.prototype.synchronizeLastDocumentChangeId=function(documentChangesStore){var _this=this;return this._lastProcessedDocumentChangeId=0,documentChangesStore.iterate({keysOnly:!0,reverse:!0},function(key,value,control){_this._lastProcessedDocumentChangeId=key,control.done()})},IndexedDbRemoteDocumentCache.prototype.newChangeBuffer=function(){return new IndexedDbRemoteDocumentChangeBuffer(this)},IndexedDbRemoteDocumentCache.prototype.getSize=function(txn){return this.getMetadata(txn).next(function(metadata){return metadata.byteSize})},IndexedDbRemoteDocumentCache.prototype.getMetadata=function(txn){return documentGlobalStore(txn).get(DbRemoteDocumentGlobal.key).next(function(metadata){return assert(!!metadata,'Missing document cache metadata'),metadata})},IndexedDbRemoteDocumentCache.prototype.setMetadata=function(txn,metadata){return documentGlobalStore(txn).put(DbRemoteDocumentGlobal.key,metadata)},IndexedDbRemoteDocumentCache.prototype.updateSize=function(txn,sizeDelta){var _this=this;return this.getMetadata(txn).next(function(metadata){return metadata.byteSize+=sizeDelta,_this.setMetadata(txn,metadata)})},IndexedDbRemoteDocumentCache}(),IndexedDbRemoteDocumentChangeBuffer=function(_super){function IndexedDbRemoteDocumentChangeBuffer(documentCache){var _this=_super.call(this)||this;return _this.documentCache=documentCache,_this}return tslib_1.__extends(IndexedDbRemoteDocumentChangeBuffer,_super),IndexedDbRemoteDocumentChangeBuffer.prototype.applyChanges=function(transaction){var _this=this,changes=this.assertChanges(),delta=0,toApply=[];return changes.forEach(function(key,maybeDocument){var doc=_this.documentCache.serializer.toDbRemoteDocument(maybeDocument),previousSize=_this.documentSizes.get(key);assert(void 0!==previousSize,'Attempting to change document '+key.toString()+' without having read it first');var size=dbDocumentSize(doc);delta+=size-previousSize,toApply.push({key:key,doc:doc})}),this.documentCache.addEntries(transaction,toApply,delta)},IndexedDbRemoteDocumentChangeBuffer.prototype.getFromCache=function(transaction,documentKey){return this.documentCache.getSizedEntry(transaction,documentKey)},IndexedDbRemoteDocumentChangeBuffer}(RemoteDocumentChangeBuffer),SCHEMA_VERSION=6,SchemaConverter=function(){function SchemaConverter(serializer){this.serializer=serializer}return SchemaConverter.prototype.createOrUpgrade=function(db,txn,fromVersion,toVersion){var _this=this;assert(fromVersion<toVersion&&0<=fromVersion&&toVersion<=SCHEMA_VERSION,'Unexpected schema upgrade from v'+fromVersion+' to v{toVersion}.'),1>fromVersion&&1<=toVersion&&(createPrimaryClientStore(db),createMutationQueue(db),createQueryCache(db),createRemoteDocumentCache(db));var p=PersistencePromise.resolve();return 3>fromVersion&&3<=toVersion&&(0!==fromVersion&&(dropQueryCache(db),createQueryCache(db)),p=p.next(function(){return writeEmptyTargetGlobalEntry(txn)})),4>fromVersion&&4<=toVersion&&(0!==fromVersion&&(p=p.next(function(){return upgradeMutationBatchSchemaAndMigrateData(db,txn)})),p=p.next(function(){createClientMetadataStore(db),createRemoteDocumentChangesStore(db)})),5>fromVersion&&5<=toVersion&&(p=p.next(function(){return _this.removeAcknowledgedMutations(txn)})),6>fromVersion&&6<=toVersion&&(p=p.next(function(){return createDocumentGlobalStore(db),_this.addDocumentGlobal(txn)})),p},SchemaConverter.prototype.addDocumentGlobal=function(txn){var byteCount=0;return txn.store(DbRemoteDocument.store).iterate(function(_,doc){byteCount+=dbDocumentSize(doc)}).next(function(){var metadata=new DbRemoteDocumentGlobal(byteCount);return txn.store(DbRemoteDocumentGlobal.store).put(DbRemoteDocumentGlobal.key,metadata)})},SchemaConverter.prototype.removeAcknowledgedMutations=function(txn){var _this=this,queuesStore=txn.store(DbMutationQueue.store),mutationsStore=txn.store(DbMutationBatch.store);return queuesStore.loadAll().next(function(queues){return PersistencePromise.forEach(queues,function(queue){var range=IDBKeyRange.bound([queue.userId,BATCHID_UNKNOWN],[queue.userId,queue.lastAcknowledgedBatchId]);return mutationsStore.loadAll(DbMutationBatch.userMutationsIndex,range).next(function(dbBatches){return PersistencePromise.forEach(dbBatches,function(dbBatch){assert(dbBatch.userId===queue.userId,'Cannot process batch '+dbBatch.batchId+' from unexpected user');var batch=_this.serializer.fromDbMutationBatch(dbBatch);return removeMutationBatch(txn,queue.userId,batch).next(function(){})})})})})},SchemaConverter}(),DbTimestamp=function(){return function DbTimestamp(seconds,nanoseconds){this.seconds=seconds,this.nanoseconds=nanoseconds}}(),DbPrimaryClient=function(){function DbPrimaryClient(ownerId,allowTabSynchronization,leaseTimestampMs){this.ownerId=ownerId,this.allowTabSynchronization=allowTabSynchronization,this.leaseTimestampMs=leaseTimestampMs}return DbPrimaryClient.store='owner',DbPrimaryClient.key='owner',DbPrimaryClient}(),DbMutationQueue=function(){function DbMutationQueue(userId,lastAcknowledgedBatchId,lastStreamToken){this.userId=userId,this.lastAcknowledgedBatchId=lastAcknowledgedBatchId,this.lastStreamToken=lastStreamToken}return DbMutationQueue.store='mutationQueues',DbMutationQueue.keyPath='userId',DbMutationQueue}(),DbMutationBatch=function(){function DbMutationBatch(userId,batchId,localWriteTimeMs,mutations){this.userId=userId,this.batchId=batchId,this.localWriteTimeMs=localWriteTimeMs,this.mutations=mutations}return DbMutationBatch.store='mutations',DbMutationBatch.keyPath='batchId',DbMutationBatch.userMutationsIndex='userMutationsIndex',DbMutationBatch.userMutationsKeyPath=['userId','batchId'],DbMutationBatch}(),DbDocumentMutation=function(){function DbDocumentMutation(){}return DbDocumentMutation.prefixForUser=function(userId){return[userId]},DbDocumentMutation.prefixForPath=function(userId,path){return[userId,encode(path)]},DbDocumentMutation.key=function(userId,path,batchId){return[userId,encode(path),batchId]},DbDocumentMutation.store='documentMutations',DbDocumentMutation.PLACEHOLDER=new DbDocumentMutation,DbDocumentMutation}(),DbNoDocument=function(){return function DbNoDocument(path,readTime){this.path=path,this.readTime=readTime}}(),DbUnknownDocument=function(){return function DbUnknownDocument(path,version){this.path=path,this.version=version}}(),DbRemoteDocument=function(){function DbRemoteDocument(unknownDocument,noDocument,document,hasCommittedMutations){this.unknownDocument=unknownDocument,this.noDocument=noDocument,this.document=document,this.hasCommittedMutations=hasCommittedMutations}return DbRemoteDocument.store='remoteDocuments',DbRemoteDocument}(),DbRemoteDocumentGlobal=function(){function DbRemoteDocumentGlobal(byteSize){this.byteSize=byteSize}return DbRemoteDocumentGlobal.store='remoteDocumentGlobal',DbRemoteDocumentGlobal.key='remoteDocumentGlobalKey',DbRemoteDocumentGlobal}(),DbTarget=function(){function DbTarget(targetId,canonicalId,readTime,resumeToken,lastListenSequenceNumber,query){this.targetId=targetId,this.canonicalId=canonicalId,this.readTime=readTime,this.resumeToken=resumeToken,this.lastListenSequenceNumber=lastListenSequenceNumber,this.query=query}return DbTarget.store='targets',DbTarget.keyPath='targetId',DbTarget.queryTargetsIndexName='queryTargetsIndex',DbTarget.queryTargetsKeyPath=['canonicalId','targetId'],DbTarget}(),DbTargetDocument=function(){function DbTargetDocument(targetId,path,sequenceNumber){this.targetId=targetId,this.path=path,this.sequenceNumber=sequenceNumber,assert(0===targetId==(void 0!==sequenceNumber),'A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number')}return DbTargetDocument.store='targetDocuments',DbTargetDocument.keyPath=['targetId','path'],DbTargetDocument.documentTargetsIndex='documentTargetsIndex',DbTargetDocument.documentTargetsKeyPath=['path','targetId'],DbTargetDocument}(),DbTargetGlobal=function(){function DbTargetGlobal(highestTargetId,highestListenSequenceNumber,lastRemoteSnapshotVersion,targetCount){this.highestTargetId=highestTargetId,this.highestListenSequenceNumber=highestListenSequenceNumber,this.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion,this.targetCount=targetCount}return DbTargetGlobal.key='targetGlobalKey',DbTargetGlobal.store='targetGlobal',DbTargetGlobal}(),DbRemoteDocumentChanges=function(){function DbRemoteDocumentChanges(changes){this.changes=changes}return DbRemoteDocumentChanges.store='remoteDocumentChanges',DbRemoteDocumentChanges.keyPath='id',DbRemoteDocumentChanges}(),DbClientMetadata=function(){function DbClientMetadata(clientId,updateTimeMs,networkEnabled,inForeground,lastProcessedDocumentChangeId){this.clientId=clientId,this.updateTimeMs=updateTimeMs,this.networkEnabled=networkEnabled,this.inForeground=inForeground,this.lastProcessedDocumentChangeId=lastProcessedDocumentChangeId}return DbClientMetadata.store='clientMetadata',DbClientMetadata.keyPath='clientId',DbClientMetadata}(),V1_STORES=[DbMutationQueue.store,DbMutationBatch.store,DbDocumentMutation.store,DbRemoteDocument.store,DbTarget.store,DbPrimaryClient.store,DbTargetGlobal.store,DbTargetDocument.store],V4_STORES=V1_STORES.concat([DbClientMetadata.store,DbRemoteDocumentChanges.store]),V6_STORES=V4_STORES.concat([DbRemoteDocumentGlobal.store]),ALL_STORES=V6_STORES,IndexedDbMutationQueue=function(){function IndexedDbMutationQueue(userId,serializer,referenceDelegate){this.userId=userId,this.serializer=serializer,this.referenceDelegate=referenceDelegate,this.documentKeysByBatchId={}}return IndexedDbMutationQueue.forUser=function(user,serializer,referenceDelegate){assert(''!==user.uid,'UserID must not be an empty string.');var userId=user.isAuthenticated()?user.uid:'';return new IndexedDbMutationQueue(userId,serializer,referenceDelegate)},IndexedDbMutationQueue.prototype.checkEmpty=function(transaction){var empty=!0,range=IDBKeyRange.bound([this.userId,_NumberNEGATIVE_INFINITY],[this.userId,_NumberPOSITIVE_INFINITY]);return mutationsStore(transaction).iterate({index:DbMutationBatch.userMutationsIndex,range:range},function(key,value,control){empty=!1,control.done()}).next(function(){return empty})},IndexedDbMutationQueue.prototype.acknowledgeBatch=function(transaction,batch,streamToken){return this.getMutationQueueMetadata(transaction).next(function(metadata){var batchId=batch.batchId;return assert(batchId>metadata.lastAcknowledgedBatchId,'Mutation batchIDs must be acknowledged in order'),metadata.lastAcknowledgedBatchId=batchId,metadata.lastStreamToken=convertStreamToken(streamToken),mutationQueuesStore(transaction).put(metadata)})},IndexedDbMutationQueue.prototype.getLastStreamToken=function(transaction){return this.getMutationQueueMetadata(transaction).next(function(metadata){return metadata.lastStreamToken})},IndexedDbMutationQueue.prototype.setLastStreamToken=function(transaction,streamToken){return this.getMutationQueueMetadata(transaction).next(function(metadata){return metadata.lastStreamToken=convertStreamToken(streamToken),mutationQueuesStore(transaction).put(metadata)})},IndexedDbMutationQueue.prototype.addMutationBatch=function(transaction,localWriteTime,mutations){var _this=this,documentStore=documentMutationsStore(transaction),mutationStore=mutationsStore(transaction);return mutationStore.add({}).next(function(batchId){assert('number'==typeof batchId,'Auto-generated key is not a number');var batch=new MutationBatch(batchId,localWriteTime,mutations),dbBatch=_this.serializer.toDbMutationBatch(_this.userId,batch);_this.documentKeysByBatchId[batchId]=batch.keys();for(var promises=[],_i=0,mutations_1=mutations;_i<mutations_1.length;_i++){var mutation=mutations_1[_i],indexKey=DbDocumentMutation.key(_this.userId,mutation.key.path,batchId);promises.push(mutationStore.put(dbBatch)),promises.push(documentStore.put(indexKey,DbDocumentMutation.PLACEHOLDER))}return PersistencePromise.waitFor(promises).next(function(){return batch})})},IndexedDbMutationQueue.prototype.lookupMutationBatch=function(transaction,batchId){var _this=this;return mutationsStore(transaction).get(batchId).next(function(dbBatch){return dbBatch?(assert(dbBatch.userId===_this.userId,'Unexpected user \''+dbBatch.userId+'\' for mutation batch '+batchId),_this.serializer.fromDbMutationBatch(dbBatch)):null})},IndexedDbMutationQueue.prototype.lookupMutationKeys=function(transaction,batchId){var _this=this;return this.documentKeysByBatchId[batchId]?PersistencePromise.resolve(this.documentKeysByBatchId[batchId]):this.lookupMutationBatch(transaction,batchId).next(function(batch){if(batch){var keys=batch.keys();return _this.documentKeysByBatchId[batchId]=keys,keys}return null})},IndexedDbMutationQueue.prototype.getNextMutationBatchAfterBatchId=function(transaction,batchId){var _this=this;return this.getMutationQueueMetadata(transaction).next(function(metadata){var nextBatchId=_Mathmax(batchId,metadata.lastAcknowledgedBatchId)+1,range=IDBKeyRange.lowerBound([_this.userId,nextBatchId]),foundBatch=null;return mutationsStore(transaction).iterate({index:DbMutationBatch.userMutationsIndex,range:range},function(key,dbBatch,control){dbBatch.userId===_this.userId&&(assert(dbBatch.batchId>=nextBatchId,'Should have found mutation after '+nextBatchId),foundBatch=_this.serializer.fromDbMutationBatch(dbBatch)),control.done()}).next(function(){return foundBatch})})},IndexedDbMutationQueue.prototype.getAllMutationBatches=function(transaction){var _this=this,range=IDBKeyRange.bound([this.userId,BATCHID_UNKNOWN],[this.userId,_NumberPOSITIVE_INFINITY]);return mutationsStore(transaction).loadAll(DbMutationBatch.userMutationsIndex,range).next(function(dbBatches){return dbBatches.map(function(dbBatch){return _this.serializer.fromDbMutationBatch(dbBatch)})})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKey=function(transaction,documentKey){var _this=this,indexPrefix=DbDocumentMutation.prefixForPath(this.userId,documentKey.path),indexStart=IDBKeyRange.lowerBound(indexPrefix),results=[];return documentMutationsStore(transaction).iterate({range:indexStart},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchId=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&documentKey.path.isEqual(path)?mutationsStore(transaction).get(batchId).next(function(mutation){if(!mutation)throw fail('Dangling document-mutation reference found: '+indexKey+' which points to '+batchId);assert(mutation.userId===_this.userId,'Unexpected user \''+mutation.userId+'\' for mutation batch '+batchId),results.push(_this.serializer.fromDbMutationBatch(mutation))}):void control.done()}).next(function(){return results})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKeys=function(transaction,documentKeys){var _this=this,uniqueBatchIDs=new SortedSet(primitiveComparator),promises=[];return documentKeys.forEach(function(documentKey){var indexStart=DbDocumentMutation.prefixForPath(_this.userId,documentKey.path),range=IDBKeyRange.lowerBound(indexStart),promise=documentMutationsStore(transaction).iterate({range:range},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchID=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&documentKey.path.isEqual(path)?void(uniqueBatchIDs=uniqueBatchIDs.add(batchID)):void control.done()});promises.push(promise)}),PersistencePromise.waitFor(promises).next(function(){return _this.lookupMutationBatches(transaction,uniqueBatchIDs)})},IndexedDbMutationQueue.prototype.getAllMutationBatchesAffectingQuery=function(transaction,query){var _this=this;assert(!query.isDocumentQuery(),'Document queries shouldn\'t go down this path');var queryPath=query.path,immediateChildrenLength=queryPath.length+1,indexPrefix=DbDocumentMutation.prefixForPath(this.userId,queryPath),indexStart=IDBKeyRange.lowerBound(indexPrefix),uniqueBatchIDs=new SortedSet(primitiveComparator);return documentMutationsStore(transaction).iterate({range:indexStart},function(indexKey,_,control){var userID=indexKey[0],encodedPath=indexKey[1],batchID=indexKey[2],path=decode$1(encodedPath);return userID===_this.userId&&queryPath.isPrefixOf(path)?void(path.length!==immediateChildrenLength||(uniqueBatchIDs=uniqueBatchIDs.add(batchID))):void control.done()}).next(function(){return _this.lookupMutationBatches(transaction,uniqueBatchIDs)})},IndexedDbMutationQueue.prototype.lookupMutationBatches=function(transaction,batchIDs){var _this=this,results=[],promises=[];return batchIDs.forEach(function(batchId){promises.push(mutationsStore(transaction).get(batchId).next(function(mutation){if(null===mutation)throw fail('Dangling document-mutation reference found, '+'which points to '+batchId);assert(mutation.userId===_this.userId,'Unexpected user \''+mutation.userId+'\' for mutation batch '+batchId),results.push(_this.serializer.fromDbMutationBatch(mutation))}))}),PersistencePromise.waitFor(promises).next(function(){return results})},IndexedDbMutationQueue.prototype.removeMutationBatch=function(transaction,batch){var _this=this;return removeMutationBatch(transaction.simpleDbTransaction,this.userId,batch).next(function(removedDocuments){return _this.removeCachedMutationKeys(batch.batchId),PersistencePromise.forEach(removedDocuments,function(key){return _this.referenceDelegate.removeMutationReference(transaction,key)})})},IndexedDbMutationQueue.prototype.removeCachedMutationKeys=function(batchId){delete this.documentKeysByBatchId[batchId]},IndexedDbMutationQueue.prototype.performConsistencyCheck=function(txn){var _this=this;return this.checkEmpty(txn).next(function(empty){if(!empty)return PersistencePromise.resolve();var startRange=IDBKeyRange.lowerBound(DbDocumentMutation.prefixForUser(_this.userId)),danglingMutationReferences=[];return documentMutationsStore(txn).iterate({range:startRange},function(key,_,control){var userID=key[0];if(userID!==_this.userId)return void control.done();var path=decode$1(key[1]);danglingMutationReferences.push(path)}).next(function(){assert(0===danglingMutationReferences.length,'Document leak -- detected dangling mutation references when queue is empty. '+'Dangling keys: '+danglingMutationReferences.map(function(p){return p.canonicalString()}))})})},IndexedDbMutationQueue.prototype.containsKey=function(txn,key){return mutationQueueContainsKey(txn,this.userId,key)},IndexedDbMutationQueue.prototype.getMutationQueueMetadata=function(transaction){var _this=this;return mutationQueuesStore(transaction).get(this.userId).next(function(metadata){return metadata||new DbMutationQueue(_this.userId,BATCHID_UNKNOWN,'')})},IndexedDbMutationQueue}(),RESERVED_BITS=1,GeneratorIds;(function(GeneratorIds){GeneratorIds[GeneratorIds.QueryCache=0]='QueryCache',GeneratorIds[GeneratorIds.SyncEngine=1]='SyncEngine'})(GeneratorIds||(GeneratorIds={}));var TargetIdGenerator=function(){function TargetIdGenerator(generatorId,seed){this.generatorId=generatorId,assert((generatorId&RESERVED_BITS)===generatorId,'Generator ID '+generatorId+' contains more than '+RESERVED_BITS+' reserved bits'),this.seek(void 0===seed?this.generatorId:seed)}return TargetIdGenerator.prototype.next=function(){var nextId=this.nextId;return this.nextId+=1<<RESERVED_BITS,nextId},TargetIdGenerator.prototype.after=function(targetId){return this.seek(targetId+(1<<RESERVED_BITS)),this.next()},TargetIdGenerator.prototype.seek=function(targetId){assert((targetId&RESERVED_BITS)===this.generatorId,'Cannot supply target ID from different generator ID'),this.nextId=targetId},TargetIdGenerator.forQueryCache=function(){var targetIdGenerator=new TargetIdGenerator(GeneratorIds.QueryCache,2);return targetIdGenerator},TargetIdGenerator.forSyncEngine=function(){return new TargetIdGenerator(GeneratorIds.SyncEngine)},TargetIdGenerator}(),IndexedDbQueryCache=function(){function IndexedDbQueryCache(referenceDelegate,serializer){this.referenceDelegate=referenceDelegate,this.serializer=serializer,this.targetIdGenerator=TargetIdGenerator.forQueryCache()}return IndexedDbQueryCache.prototype.allocateTargetId=function(transaction){var _this=this;return this.retrieveMetadata(transaction).next(function(metadata){return metadata.highestTargetId=_this.targetIdGenerator.after(metadata.highestTargetId),_this.saveMetadata(transaction,metadata).next(function(){return metadata.highestTargetId})})},IndexedDbQueryCache.prototype.getLastRemoteSnapshotVersion=function(transaction){return this.retrieveMetadata(transaction).next(function(metadata){return SnapshotVersion.fromTimestamp(new Timestamp(metadata.lastRemoteSnapshotVersion.seconds,metadata.lastRemoteSnapshotVersion.nanoseconds))})},IndexedDbQueryCache.prototype.getHighestSequenceNumber=function(transaction){return getHighestListenSequenceNumber(transaction.simpleDbTransaction)},IndexedDbQueryCache.prototype.setTargetsMetadata=function(transaction,highestListenSequenceNumber,lastRemoteSnapshotVersion){var _this=this;return this.retrieveMetadata(transaction).next(function(metadata){return metadata.highestListenSequenceNumber=highestListenSequenceNumber,lastRemoteSnapshotVersion&&(metadata.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion.toTimestamp()),highestListenSequenceNumber>metadata.highestListenSequenceNumber&&(metadata.highestListenSequenceNumber=highestListenSequenceNumber),_this.saveMetadata(transaction,metadata)})},IndexedDbQueryCache.prototype.addQueryData=function(transaction,queryData){var _this=this;return this.saveQueryData(transaction,queryData).next(function(){return _this.retrieveMetadata(transaction).next(function(metadata){return metadata.targetCount+=1,_this.updateMetadataFromQueryData(queryData,metadata),_this.saveMetadata(transaction,metadata)})})},IndexedDbQueryCache.prototype.updateQueryData=function(transaction,queryData){return this.saveQueryData(transaction,queryData)},IndexedDbQueryCache.prototype.removeQueryData=function(transaction,queryData){var _this=this;return this.removeMatchingKeysForTargetId(transaction,queryData.targetId).next(function(){return targetsStore(transaction).delete(queryData.targetId)}).next(function(){return _this.retrieveMetadata(transaction)}).next(function(metadata){return assert(0<metadata.targetCount,'Removing from an empty query cache'),metadata.targetCount-=1,_this.saveMetadata(transaction,metadata)})},IndexedDbQueryCache.prototype.removeTargets=function(txn,upperBound,activeTargetIds){var _this=this,count=0,promises=[];return targetsStore(txn).iterate(function(key,value){var queryData=_this.serializer.fromDbTarget(value);queryData.sequenceNumber<=upperBound&&void 0===activeTargetIds[queryData.targetId]&&(count++,promises.push(_this.removeQueryData(txn,queryData)))}).next(function(){return PersistencePromise.waitFor(promises)}).next(function(){return count})},IndexedDbQueryCache.prototype.forEachTarget=function(txn,f){var _this=this;return targetsStore(txn).iterate(function(key,value){var queryData=_this.serializer.fromDbTarget(value);f(queryData)})},IndexedDbQueryCache.prototype.retrieveMetadata=function(transaction){return retrieveMetadata(transaction.simpleDbTransaction)},IndexedDbQueryCache.prototype.saveMetadata=function(transaction,metadata){return globalTargetStore(transaction).put(DbTargetGlobal.key,metadata)},IndexedDbQueryCache.prototype.saveQueryData=function(transaction,queryData){return targetsStore(transaction).put(this.serializer.toDbTarget(queryData))},IndexedDbQueryCache.prototype.updateMetadataFromQueryData=function(queryData,metadata){var updated=!1;return queryData.targetId>metadata.highestTargetId&&(metadata.highestTargetId=queryData.targetId,updated=!0),queryData.sequenceNumber>metadata.highestListenSequenceNumber&&(metadata.highestListenSequenceNumber=queryData.sequenceNumber,updated=!0),updated},IndexedDbQueryCache.prototype.getQueryCount=function(transaction){return this.retrieveMetadata(transaction).next(function(metadata){return metadata.targetCount})},IndexedDbQueryCache.prototype.getQueryData=function(transaction,query){var _this=this,canonicalId=query.canonicalId(),range=IDBKeyRange.bound([canonicalId,_NumberNEGATIVE_INFINITY],[canonicalId,_NumberPOSITIVE_INFINITY]),result=null;return targetsStore(transaction).iterate({range:range,index:DbTarget.queryTargetsIndexName},function(key,value,control){var found=_this.serializer.fromDbTarget(value);query.isEqual(found.query)&&(result=found,control.done())}).next(function(){return result})},IndexedDbQueryCache.prototype.addMatchingKeys=function(txn,keys,targetId){var _this=this,promises=[],store=documentTargetStore(txn);return keys.forEach(function(key){var path=encode(key.path);promises.push(store.put(new DbTargetDocument(targetId,path))),promises.push(_this.referenceDelegate.addReference(txn,key))}),PersistencePromise.waitFor(promises)},IndexedDbQueryCache.prototype.removeMatchingKeys=function(txn,keys,targetId){var _this=this,store=documentTargetStore(txn);return PersistencePromise.forEach(keys,function(key){var path=encode(key.path);return PersistencePromise.waitFor([store.delete([targetId,path]),_this.referenceDelegate.removeReference(txn,key)])})},IndexedDbQueryCache.prototype.removeMatchingKeysForTargetId=function(txn,targetId){var store=documentTargetStore(txn),range=IDBKeyRange.bound([targetId],[targetId+1],!1,!0);return store.delete(range)},IndexedDbQueryCache.prototype.getMatchingKeysForTargetId=function(txn,targetId){var range=IDBKeyRange.bound([targetId],[targetId+1],!1,!0),store=documentTargetStore(txn),result=documentKeySet();return store.iterate({range:range,keysOnly:!0},function(key){var path=decode$1(key[1]),docKey=new DocumentKey(path);result=result.add(docKey)}).next(function(){return result})},IndexedDbQueryCache.prototype.containsKey=function(txn,key){var path=encode(key.path),range=IDBKeyRange.bound([path],[immediateSuccessor(path)],!1,!0),count=0;return documentTargetStore(txn).iterate({index:DbTargetDocument.documentTargetsIndex,keysOnly:!0,range:range},function(_a,_,control){var targetId=_a[0],path=_a[1];0!==targetId&&(count++,control.done())}).next(function(){return 0<count})},IndexedDbQueryCache.prototype.getQueryDataForTarget=function(transaction,targetId){var _this=this;return targetsStore(transaction).get(targetId).next(function(found){return found?_this.serializer.fromDbTarget(found):null})},IndexedDbQueryCache}(),LocalSerializer=function(){function LocalSerializer(remoteSerializer){this.remoteSerializer=remoteSerializer}return LocalSerializer.prototype.fromDbRemoteDocument=function(remoteDoc){if(remoteDoc.document)return this.remoteSerializer.fromDocument(remoteDoc.document,!!remoteDoc.hasCommittedMutations);if(remoteDoc.noDocument){var key=DocumentKey.fromSegments(remoteDoc.noDocument.path),version=this.fromDbTimestamp(remoteDoc.noDocument.readTime);return new NoDocument(key,version,{hasCommittedMutations:!!remoteDoc.hasCommittedMutations})}if(remoteDoc.unknownDocument){var key=DocumentKey.fromSegments(remoteDoc.unknownDocument.path),version=this.fromDbTimestamp(remoteDoc.unknownDocument.version);return new UnknownDocument(key,version)}return fail('Unexpected DbRemoteDocument')},LocalSerializer.prototype.toDbRemoteDocument=function(maybeDoc){if(maybeDoc instanceof Document){var doc=this.remoteSerializer.toDocument(maybeDoc),hasCommittedMutations=maybeDoc.hasCommittedMutations;return new DbRemoteDocument(null,null,doc,hasCommittedMutations)}if(maybeDoc instanceof NoDocument){var path=maybeDoc.key.path.toArray(),readTime=this.toDbTimestamp(maybeDoc.version),hasCommittedMutations=maybeDoc.hasCommittedMutations;return new DbRemoteDocument(null,new DbNoDocument(path,readTime),null,hasCommittedMutations)}if(maybeDoc instanceof UnknownDocument){var path=maybeDoc.key.path.toArray(),readTime=this.toDbTimestamp(maybeDoc.version);return new DbRemoteDocument(new DbUnknownDocument(path,readTime),null,null,!0)}return fail('Unexpected MaybeDocumment')},LocalSerializer.prototype.toDbTimestamp=function(snapshotVersion){var timestamp=snapshotVersion.toTimestamp();return new DbTimestamp(timestamp.seconds,timestamp.nanoseconds)},LocalSerializer.prototype.fromDbTimestamp=function(dbTimestamp){var timestamp=new Timestamp(dbTimestamp.seconds,dbTimestamp.nanoseconds);return SnapshotVersion.fromTimestamp(timestamp)},LocalSerializer.prototype.toDbMutationBatch=function(userId,batch){var _this=this,serializedMutations=batch.mutations.map(function(m){return _this.remoteSerializer.toMutation(m)});return new DbMutationBatch(userId,batch.batchId,batch.localWriteTime.toMillis(),serializedMutations)},LocalSerializer.prototype.fromDbMutationBatch=function(dbBatch){var _this=this,mutations=dbBatch.mutations.map(function(m){return _this.remoteSerializer.fromMutation(m)}),timestamp=Timestamp.fromMillis(dbBatch.localWriteTimeMs);return new MutationBatch(dbBatch.batchId,timestamp,mutations)},LocalSerializer.prototype.toDbResourcePaths=function(keys){var encodedKeys=[];return keys.forEach(function(key){encodedKeys.push(encode(key.path))}),encodedKeys},LocalSerializer.prototype.fromDbResourcePaths=function(encodedPaths){for(var keys=documentKeySet(),_i=0,encodedPaths_1=encodedPaths,documentKey;_i<encodedPaths_1.length;_i++)documentKey=encodedPaths_1[_i],keys=keys.add(new DocumentKey(decode$1(documentKey)));return keys},LocalSerializer.prototype.fromDbTarget=function(dbTarget){var version=this.fromDbTimestamp(dbTarget.readTime),query;return query=isDocumentQuery(dbTarget.query)?this.remoteSerializer.fromDocumentsTarget(dbTarget.query):this.remoteSerializer.fromQueryTarget(dbTarget.query),new QueryData(query,dbTarget.targetId,QueryPurpose.Listen,dbTarget.lastListenSequenceNumber,version,dbTarget.resumeToken)},LocalSerializer.prototype.toDbTarget=function(queryData){assert(QueryPurpose.Listen===queryData.purpose,'Only queries with purpose '+QueryPurpose.Listen+' may be stored, got '+queryData.purpose);var dbTimestamp=this.toDbTimestamp(queryData.snapshotVersion),queryProto;queryProto=queryData.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(queryData.query):this.remoteSerializer.toQueryTarget(queryData.query);var resumeToken;return queryData.resumeToken instanceof Uint8Array?(assert('YES'===process.env.USE_MOCK_PERSISTENCE,'Persisting non-string stream tokens is only supported with mock persistence .'),resumeToken=queryData.resumeToken.toString()):resumeToken=queryData.resumeToken,new DbTarget(queryData.targetId,queryData.query.canonicalId(),dbTimestamp,resumeToken,queryData.sequenceNumber,queryProto)},LocalSerializer}(),RollingSequenceNumberBuffer=function(){function RollingSequenceNumberBuffer(maxElements){this.maxElements=maxElements,this.buffer=new SortedSet(bufferEntryComparator),this.previousIndex=0}return RollingSequenceNumberBuffer.prototype.nextIndex=function(){return++this.previousIndex},RollingSequenceNumberBuffer.prototype.addElement=function(sequenceNumber){var entry=[sequenceNumber,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(entry);else{var highestValue=this.buffer.last();0>bufferEntryComparator(entry,highestValue)&&(this.buffer=this.buffer.delete(highestValue).add(entry))}},Object.defineProperty(RollingSequenceNumberBuffer.prototype,'maxValue',{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),RollingSequenceNumberBuffer}(),LruGarbageCollector=function(){function LruGarbageCollector(delegate){this.delegate=delegate}return LruGarbageCollector.prototype.calculateTargetCount=function(txn,percentile){return this.delegate.getTargetCount(txn).next(function(targetCount){return _Mathfloor(percentile/100*targetCount)})},LruGarbageCollector.prototype.nthSequenceNumber=function(txn,n){var _this=this;if(0===n)return PersistencePromise.resolve(ListenSequence.INVALID);var buffer=new RollingSequenceNumberBuffer(n);return this.delegate.forEachTarget(txn,function(target){return buffer.addElement(target.sequenceNumber)}).next(function(){return _this.delegate.forEachOrphanedDocumentSequenceNumber(txn,function(sequenceNumber){return buffer.addElement(sequenceNumber)})}).next(function(){return buffer.maxValue})},LruGarbageCollector.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.delegate.removeTargets(txn,upperBound,activeTargetIds)},LruGarbageCollector.prototype.removeOrphanedDocuments=function(txn,upperBound){return this.delegate.removeOrphanedDocuments(txn,upperBound)},LruGarbageCollector}(),PersistenceTransaction=function(){return function PersistenceTransaction(){}}(),LOG_TAG$2='IndexedDbPersistence',MAX_CLIENT_AGE_MS=1e3*(60*30),MAX_PRIMARY_ELIGIBLE_AGE_MS=5e3,PRIMARY_LEASE_LOST_ERROR_MSG='The current tab is not in the required state to perform this operation. '+'It might be necessary to refresh the browser tab.',PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG='Another tab has exclusive access to the persistence layer. '+'To allow shared access, make sure to invoke '+'`enablePersistence()` with `experimentalTabSynchronization:true` in all tabs.',IndexedDbTransaction=function(_super){function IndexedDbTransaction(simpleDbTransaction,currentSequenceNumber){var _this=_super.call(this)||this;return _this.simpleDbTransaction=simpleDbTransaction,_this.currentSequenceNumber=currentSequenceNumber,_this}return tslib_1.__extends(IndexedDbTransaction,_super),IndexedDbTransaction}(PersistenceTransaction),IndexedDbPersistence=function(){function IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer,multiClientParams){if(this.persistenceKey=persistenceKey,this.clientId=clientId,this.queue=queue,this.multiClientParams=multiClientParams,this._started=!1,this.isPrimary=!1,this.networkEnabled=!0,this.inForeground=!1,this.lastGarbageCollectionTime=_NumberNEGATIVE_INFINITY,this.primaryStateListener=function(){return Promise.resolve()},!IndexedDbPersistence.isAvailable())throw new FirestoreError(Code.UNIMPLEMENTED,'This platform is either missing'+' IndexedDB or is known to have an incomplete implementation. Offline'+' persistence has been disabled.');if(this.referenceDelegate=new IndexedDbLruDelegate(this),this.dbName=persistenceKey+IndexedDbPersistence.MAIN_DATABASE,this.serializer=new LocalSerializer(serializer),this.document=platform.document,this.allowTabSynchronization=void 0!==multiClientParams,this.queryCache=new IndexedDbQueryCache(this.referenceDelegate,this.serializer),this.remoteDocumentCache=new IndexedDbRemoteDocumentCache(this.serializer,this.allowTabSynchronization),platform.window&&platform.window.localStorage)this.window=platform.window,this.webStorage=this.window.localStorage;else throw new FirestoreError(Code.UNIMPLEMENTED,'IndexedDB persistence is only available on platforms that support LocalStorage.')}return IndexedDbPersistence.getStore=function(txn,store){if(txn instanceof IndexedDbTransaction)return SimpleDb.getStore(txn.simpleDbTransaction,store);throw fail('IndexedDbPersistence must use instances of IndexedDbTransaction')},IndexedDbPersistence.createIndexedDbPersistence=function(persistenceKey,clientId,platform,queue,serializer){return tslib_1.__awaiter(this,void 0,void 0,function(){var persistence;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return persistence=new IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer),[4,persistence.start()];case 1:return _a.sent(),[2,persistence];}})})},IndexedDbPersistence.createMultiClientIndexedDbPersistence=function(persistenceKey,clientId,platform,queue,serializer,multiClientParams){return tslib_1.__awaiter(this,void 0,void 0,function(){var persistence;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return persistence=new IndexedDbPersistence(persistenceKey,clientId,platform,queue,serializer,multiClientParams),[4,persistence.start()];case 1:return _a.sent(),[2,persistence];}})})},IndexedDbPersistence.prototype.start=function(){var _this=this;return assert(!this.started,'IndexedDbPersistence double-started!'),assert(null!==this.window,'Expected \'window\' to be defined'),SimpleDb.openOrCreate(this.dbName,SCHEMA_VERSION,new SchemaConverter(this.serializer)).then(function(db){_this.simpleDb=db}).then(function(){return _this.startRemoteDocumentCache()}).then(function(){return _this.attachVisibilityHandler(),_this.attachWindowUnloadHook(),_this.updateClientMetadataAndTryBecomePrimary().then(function(){return _this.scheduleClientMetadataAndPrimaryLeaseRefreshes()})}).then(function(){return _this.simpleDb.runTransaction('readonly',[DbTargetGlobal.store],function(txn){return getHighestListenSequenceNumber(txn).next(function(highestListenSequenceNumber){var sequenceNumberSyncer=_this.multiClientParams?_this.multiClientParams.sequenceNumberSyncer:void 0;_this.listenSequence=new ListenSequence(highestListenSequenceNumber,sequenceNumberSyncer)})})}).then(function(){_this._started=!0}).catch(function(reason){return _this.simpleDb&&_this.simpleDb.close(),Promise.reject(reason)})},IndexedDbPersistence.prototype.startRemoteDocumentCache=function(){var _this=this;return this.simpleDb.runTransaction('readonly',ALL_STORES,function(txn){return _this.remoteDocumentCache.start(txn)})},IndexedDbPersistence.prototype.setPrimaryStateListener=function(primaryStateListener){var _this=this;return this.primaryStateListener=function(primaryState){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.started?[2,primaryStateListener(primaryState)]:[2]})})},primaryStateListener(this.isPrimary)},IndexedDbPersistence.prototype.setNetworkEnabled=function(networkEnabled){var _this=this;this.networkEnabled!==networkEnabled&&(this.networkEnabled=networkEnabled,this.queue.enqueueAndForget(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.started?[4,this.updateClientMetadataAndTryBecomePrimary()]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})})}))},IndexedDbPersistence.prototype.updateClientMetadataAndTryBecomePrimary=function(){var _this=this;return this.simpleDb.runTransaction('readwrite',ALL_STORES,function(txn){var metadataStore=clientMetadataStore(txn);return metadataStore.put(new DbClientMetadata(_this.clientId,Date.now(),_this.networkEnabled,_this.inForeground,_this.remoteDocumentCache.lastProcessedDocumentChangeId)).next(function(){if(_this.isPrimary)return _this.verifyPrimaryLease(txn).next(function(success){success||(_this.isPrimary=!1,_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(!1)}))})}).next(function(){return _this.canActAsPrimary(txn)}).next(function(canActAsPrimary){var wasPrimary=_this.isPrimary;return(_this.isPrimary=canActAsPrimary,wasPrimary!==_this.isPrimary&&_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(_this.isPrimary)}),wasPrimary&&!_this.isPrimary)?_this.releasePrimaryLeaseIfHeld(txn):_this.isPrimary?_this.acquireOrExtendPrimaryLease(txn):void 0})})},IndexedDbPersistence.prototype.verifyPrimaryLease=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(primaryClient){return PersistencePromise.resolve(_this.isLocalClient(primaryClient))})},IndexedDbPersistence.prototype.removeClientMetadata=function(txn){var metadataStore=clientMetadataStore(txn);return metadataStore.delete(this.clientId)},IndexedDbPersistence.prototype.maybeGarbageCollectMultiClientState=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,activeClients_1,inactiveClients_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return!this.isPrimary||this.isWithinAge(this.lastGarbageCollectionTime,MAX_CLIENT_AGE_MS)?[3,2]:(this.lastGarbageCollectionTime=Date.now(),inactiveClients_1=[],[4,this.runTransaction('maybeGarbageCollectMultiClientState','readwrite-primary',function(txn){var metadataStore=IndexedDbPersistence.getStore(txn,DbClientMetadata.store);return metadataStore.loadAll().next(function(existingClients){activeClients_1=_this.filterActiveClients(existingClients,MAX_CLIENT_AGE_MS),inactiveClients_1=existingClients.filter(function(client){return-1===activeClients_1.indexOf(client)})}).next(function(){return PersistencePromise.forEach(inactiveClients_1,function(inactiveClient){return metadataStore.delete(inactiveClient.clientId)})}).next(function(){if(activeClients_1=activeClients_1.filter(function(client){return client.clientId!==_this.clientId}),0<activeClients_1.length){var processedChangeIds=activeClients_1.map(function(client){return client.lastProcessedDocumentChangeId||0}),oldestChangeId=_Mathmin.apply(Math,processedChangeIds);return _this.remoteDocumentCache.removeDocumentChangesThroughChangeId(txn,oldestChangeId)}})})]);case 1:_a.sent(),inactiveClients_1.forEach(function(inactiveClient){_this.window.localStorage.removeItem(_this.zombiedClientLocalStorageKey(inactiveClient.clientId))}),_a.label=2;case 2:return[2];}})})},IndexedDbPersistence.prototype.scheduleClientMetadataAndPrimaryLeaseRefreshes=function(){var _this=this;this.clientMetadataRefresher=this.queue.enqueueAfterDelay(TimerId.ClientMetadataRefresh,4e3,function(){return _this.updateClientMetadataAndTryBecomePrimary().then(function(){return _this.maybeGarbageCollectMultiClientState()}).then(function(){return _this.scheduleClientMetadataAndPrimaryLeaseRefreshes()})})},IndexedDbPersistence.prototype.isLocalClient=function(client){return!!client&&client.ownerId===this.clientId},IndexedDbPersistence.prototype.canActAsPrimary=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(currentPrimary){var currentLeaseIsValid=null!==currentPrimary&&_this.isWithinAge(currentPrimary.leaseTimestampMs,MAX_PRIMARY_ELIGIBLE_AGE_MS)&&!_this.isClientZombied(currentPrimary.ownerId);if(currentLeaseIsValid){if(_this.isLocalClient(currentPrimary)&&_this.networkEnabled)return!0;if(!_this.isLocalClient(currentPrimary)){if(!currentPrimary.allowTabSynchronization)throw new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG);return!1}}return _this.networkEnabled&&_this.inForeground||clientMetadataStore(txn).loadAll().next(function(existingClients){var preferredCandidate=_this.filterActiveClients(existingClients,MAX_PRIMARY_ELIGIBLE_AGE_MS).find(function(otherClient){if(_this.clientId!==otherClient.clientId){var otherClientHasBetterNetworkState=!_this.networkEnabled&&otherClient.networkEnabled,otherClientHasBetterVisibility=!_this.inForeground&&otherClient.inForeground,otherClientHasSameNetworkState=_this.networkEnabled===otherClient.networkEnabled;if(otherClientHasBetterNetworkState||otherClientHasBetterVisibility&&otherClientHasSameNetworkState)return!0}return!1});return void 0===preferredCandidate})}).next(function(canActAsPrimary){return _this.isPrimary!==canActAsPrimary&&debug(LOG_TAG$2,'Client '+(canActAsPrimary?'is':'is not')+' eligible for a primary lease.'),canActAsPrimary})},IndexedDbPersistence.prototype.shutdown=function(deleteData){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this._started=!1,this.markClientZombied(),this.clientMetadataRefresher&&this.clientMetadataRefresher.cancel(),this.detachVisibilityHandler(),this.detachWindowUnloadHook(),[4,this.simpleDb.runTransaction('readwrite',[DbPrimaryClient.store,DbClientMetadata.store],function(txn){return _this.releasePrimaryLeaseIfHeld(txn).next(function(){return _this.removeClientMetadata(txn)})})];case 1:return _a.sent(),this.simpleDb.close(),this.removeClientZombiedEntry(),deleteData?[4,SimpleDb.delete(this.dbName)]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},IndexedDbPersistence.prototype.filterActiveClients=function(clients,activityThresholdMs){var _this=this;return clients.filter(function(client){return _this.isWithinAge(client.updateTimeMs,activityThresholdMs)&&!_this.isClientZombied(client.clientId)})},IndexedDbPersistence.prototype.getActiveClients=function(){var _this=this;return this.simpleDb.runTransaction('readonly',[DbClientMetadata.store],function(txn){return clientMetadataStore(txn).loadAll().next(function(clients){return _this.filterActiveClients(clients,MAX_CLIENT_AGE_MS).map(function(clientMetadata){return clientMetadata.clientId})})})},Object.defineProperty(IndexedDbPersistence.prototype,'started',{get:function(){return this._started},enumerable:!0,configurable:!0}),IndexedDbPersistence.prototype.getMutationQueue=function(user){return assert(this.started,'Cannot initialize MutationQueue before persistence is started.'),IndexedDbMutationQueue.forUser(user,this.serializer,this.referenceDelegate)},IndexedDbPersistence.prototype.getQueryCache=function(){return assert(this.started,'Cannot initialize QueryCache before persistence is started.'),this.queryCache},IndexedDbPersistence.prototype.getRemoteDocumentCache=function(){return assert(this.started,'Cannot initialize RemoteDocumentCache before persistence is started.'),this.remoteDocumentCache},IndexedDbPersistence.prototype.runTransaction=function(action,mode,transactionOperation){var _this=this;return debug(LOG_TAG$2,'Starting transaction:',action),this.simpleDb.runTransaction('readonly'===mode?'readonly':'readwrite',ALL_STORES,function(simpleDbTxn){return'readwrite-primary'===mode?_this.verifyPrimaryLease(simpleDbTxn).next(function(success){if(!success)throw error('Failed to obtain primary lease for action \''+action+'\'.'),_this.isPrimary=!1,_this.queue.enqueueAndForget(function(){return _this.primaryStateListener(!1)}),new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_LOST_ERROR_MSG);return transactionOperation(new IndexedDbTransaction(simpleDbTxn,_this.listenSequence.next()))}).next(function(result){return _this.acquireOrExtendPrimaryLease(simpleDbTxn).next(function(){return result})}):_this.verifyAllowTabSynchronization(simpleDbTxn).next(function(){return transactionOperation(new IndexedDbTransaction(simpleDbTxn,_this.listenSequence.next()))})})},IndexedDbPersistence.prototype.verifyAllowTabSynchronization=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(currentPrimary){var currentLeaseIsValid=null!==currentPrimary&&_this.isWithinAge(currentPrimary.leaseTimestampMs,MAX_PRIMARY_ELIGIBLE_AGE_MS)&&!_this.isClientZombied(currentPrimary.ownerId);if(currentLeaseIsValid&&!_this.isLocalClient(currentPrimary)&&!currentPrimary.allowTabSynchronization)throw new FirestoreError(Code.FAILED_PRECONDITION,PRIMARY_LEASE_EXCLUSIVE_ERROR_MSG)})},IndexedDbPersistence.prototype.acquireOrExtendPrimaryLease=function(txn){var newPrimary=new DbPrimaryClient(this.clientId,this.allowTabSynchronization,Date.now());return primaryClientStore(txn).put(DbPrimaryClient.key,newPrimary)},IndexedDbPersistence.isAvailable=function(){return SimpleDb.isAvailable()},IndexedDbPersistence.buildStoragePrefix=function(databaseInfo){var database=databaseInfo.databaseId.projectId;return databaseInfo.databaseId.isDefaultDatabase||(database+='.'+databaseInfo.databaseId.database),'firestore/'+databaseInfo.persistenceKey+'/'+database+'/'},IndexedDbPersistence.prototype.releasePrimaryLeaseIfHeld=function(txn){var _this=this,store=primaryClientStore(txn);return store.get(DbPrimaryClient.key).next(function(primaryClient){return _this.isLocalClient(primaryClient)?(debug(LOG_TAG$2,'Releasing primary lease.'),store.delete(DbPrimaryClient.key)):PersistencePromise.resolve()})},IndexedDbPersistence.prototype.isWithinAge=function(updateTimeMs,maxAgeMs){var now=Date.now(),maxAcceptable=now;return!(updateTimeMs<now-maxAgeMs)&&(!(updateTimeMs>maxAcceptable)||(error('Detected an update time that is in the future: '+updateTimeMs+' > '+maxAcceptable),!1))},IndexedDbPersistence.prototype.attachVisibilityHandler=function(){var _this=this;null!==this.document&&'function'==typeof this.document.addEventListener&&(this.documentVisibilityHandler=function(){_this.queue.enqueueAndForget(function(){return _this.inForeground='visible'===_this.document.visibilityState,_this.updateClientMetadataAndTryBecomePrimary()})},this.document.addEventListener('visibilitychange',this.documentVisibilityHandler),this.inForeground='visible'===this.document.visibilityState)},IndexedDbPersistence.prototype.detachVisibilityHandler=function(){this.documentVisibilityHandler&&(assert(null!==this.document&&'function'==typeof this.document.addEventListener,'Expected \'document.addEventListener\' to be a function'),this.document.removeEventListener('visibilitychange',this.documentVisibilityHandler),this.documentVisibilityHandler=null)},IndexedDbPersistence.prototype.attachWindowUnloadHook=function(){var _this=this;'function'==typeof this.window.addEventListener&&(this.windowUnloadHandler=function(){_this.markClientZombied(),_this.queue.enqueueAndForget(function(){return _this.shutdown()})},this.window.addEventListener('unload',this.windowUnloadHandler))},IndexedDbPersistence.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(assert('function'==typeof this.window.removeEventListener,'Expected \'window.removeEventListener\' to be a function'),this.window.removeEventListener('unload',this.windowUnloadHandler),this.windowUnloadHandler=null)},IndexedDbPersistence.prototype.isClientZombied=function(clientId){try{var isZombied=null!==this.webStorage.getItem(this.zombiedClientLocalStorageKey(clientId));return debug(LOG_TAG$2,'Client \''+clientId+'\' '+(isZombied?'is':'is not')+' zombied in LocalStorage'),isZombied}catch(e){return error(LOG_TAG$2,'Failed to get zombied client id.',e),!1}},IndexedDbPersistence.prototype.markClientZombied=function(){try{this.webStorage.setItem(this.zombiedClientLocalStorageKey(this.clientId),Date.now()+'')}catch(e){error('Failed to set zombie client id.',e)}},IndexedDbPersistence.prototype.removeClientZombiedEntry=function(){try{this.webStorage.removeItem(this.zombiedClientLocalStorageKey(this.clientId))}catch(e){}},IndexedDbPersistence.prototype.zombiedClientLocalStorageKey=function(clientId){return'firestore_zombie'+'_'+this.persistenceKey+'_'+clientId},IndexedDbPersistence.MAIN_DATABASE='main',IndexedDbPersistence}(),IndexedDbLruDelegate=function(){function IndexedDbLruDelegate(db){this.db=db,this.garbageCollector=new LruGarbageCollector(this)}return IndexedDbLruDelegate.prototype.getTargetCount=function(txn){return this.db.getQueryCache().getQueryCount(txn)},IndexedDbLruDelegate.prototype.forEachTarget=function(txn,f){return this.db.getQueryCache().forEachTarget(txn,f)},IndexedDbLruDelegate.prototype.forEachOrphanedDocumentSequenceNumber=function(txn,f){return this.forEachOrphanedDocument(txn,function(docKey,sequenceNumber){return f(sequenceNumber)})},IndexedDbLruDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},IndexedDbLruDelegate.prototype.addReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.removeReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.db.getQueryCache().removeTargets(txn,upperBound,activeTargetIds)},IndexedDbLruDelegate.prototype.removeMutationReference=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.isPinned=function(txn,docKey){return this.inMemoryPins.containsKey(docKey)?PersistencePromise.resolve(!0):mutationQueuesContainKey(txn,docKey)},IndexedDbLruDelegate.prototype.removeOrphanedDocuments=function(txn,upperBound){var _this=this,count=0,bytesRemoved=0,promises=[],iteration=this.forEachOrphanedDocument(txn,function(docKey,sequenceNumber){if(sequenceNumber<=upperBound){var p=_this.isPinned(txn,docKey).next(function(isPinned){if(!isPinned)return count++,_this.removeOrphanedDocument(txn,docKey).next(function(documentBytes){bytesRemoved+=documentBytes})});promises.push(p)}});return iteration.next(function(){return PersistencePromise.waitFor(promises)}).next(function(){return _this.db.getRemoteDocumentCache().updateSize(txn,-bytesRemoved)}).next(function(){return count})},IndexedDbLruDelegate.prototype.removeOrphanedDocument=function(txn,docKey){var totalBytesRemoved=0,documentCache=this.db.getRemoteDocumentCache();return PersistencePromise.waitFor([documentTargetStore(txn).delete(sentinelKey(docKey)),documentCache.removeEntry(txn,docKey).next(function(bytesRemoved){totalBytesRemoved+=bytesRemoved})]).next(function(){return totalBytesRemoved})},IndexedDbLruDelegate.prototype.removeTarget=function(txn,queryData){var updated=queryData.copy({sequenceNumber:txn.currentSequenceNumber});return this.db.getQueryCache().updateQueryData(txn,updated)},IndexedDbLruDelegate.prototype.updateLimboDocument=function(txn,key){return writeSentinelKey(txn,key)},IndexedDbLruDelegate.prototype.forEachOrphanedDocument=function(txn,f){var store=documentTargetStore(txn),nextToReport=ListenSequence.INVALID,nextPath;return store.iterate({index:DbTargetDocument.documentTargetsIndex},function(_a,_b){var targetId=_a[0],docKey=_a[1],path=_b.path,sequenceNumber=_b.sequenceNumber;0===targetId?(nextToReport!==ListenSequence.INVALID&&f(new DocumentKey(decode$1(nextPath)),nextToReport),nextToReport=sequenceNumber,nextPath=path):nextToReport=ListenSequence.INVALID}).next(function(){nextToReport!==ListenSequence.INVALID&&f(new DocumentKey(decode$1(nextPath)),nextToReport)})},IndexedDbLruDelegate}(),LocalDocumentsView=function(){function LocalDocumentsView(remoteDocumentCache,mutationQueue){this.remoteDocumentCache=remoteDocumentCache,this.mutationQueue=mutationQueue}return LocalDocumentsView.prototype.getDocument=function(transaction,key){var _this=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(transaction,key).next(function(batches){return _this.getDocumentInternal(transaction,key,batches)})},LocalDocumentsView.prototype.getDocumentInternal=function(transaction,key,inBatches){return this.remoteDocumentCache.getEntry(transaction,key).next(function(doc){for(var _i=0,inBatches_1=inBatches,batch;_i<inBatches_1.length;_i++)batch=inBatches_1[_i],doc=batch.applyToLocalView(key,doc);return doc})},LocalDocumentsView.prototype.getDocuments=function(transaction,keys){var _this=this;return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(transaction,keys).next(function(batches){var promises=[],results=maybeDocumentMap();return keys.forEach(function(key){promises.push(_this.getDocumentInternal(transaction,key,batches).next(function(maybeDoc){maybeDoc||(maybeDoc=new NoDocument(key,SnapshotVersion.forDeletedDoc())),results=results.insert(key,maybeDoc)}))}),PersistencePromise.waitFor(promises).next(function(){return results})})},LocalDocumentsView.prototype.getDocumentsMatchingQuery=function(transaction,query){return DocumentKey.isDocumentKey(query.path)?this.getDocumentsMatchingDocumentQuery(transaction,query.path):this.getDocumentsMatchingCollectionQuery(transaction,query)},LocalDocumentsView.prototype.getDocumentsMatchingDocumentQuery=function(transaction,docPath){return this.getDocument(transaction,new DocumentKey(docPath)).next(function(maybeDoc){var result=documentMap();return maybeDoc instanceof Document&&(result=result.insert(maybeDoc.key,maybeDoc)),result})},LocalDocumentsView.prototype.getDocumentsMatchingCollectionQuery=function(transaction,query){var _this=this,results;return this.remoteDocumentCache.getDocumentsMatchingQuery(transaction,query).next(function(queryResults){return results=queryResults,_this.mutationQueue.getAllMutationBatchesAffectingQuery(transaction,query)}).next(function(matchingMutationBatches){for(var _i=0,matchingMutationBatches_1=matchingMutationBatches,batch;_i<matchingMutationBatches_1.length;_i++){batch=matchingMutationBatches_1[_i];for(var _a=0,_b=batch.mutations;_a<_b.length;_a++){var mutation=_b[_a],key=mutation.key;if(query.path.isImmediateParentOf(key.path)){var baseDoc=results.get(key),mutatedDoc=mutation.applyToLocalView(baseDoc,baseDoc,batch.localWriteTime);results=mutatedDoc instanceof Document?results.insert(key,mutatedDoc):results.remove(key)}}}}).next(function(){return results.forEach(function(key,doc){query.matches(doc)||(results=results.remove(key))}),results})},LocalDocumentsView}(),ReferenceSet=function(){function ReferenceSet(){this.refsByKey=new SortedSet(DocReference.compareByKey),this.refsByTarget=new SortedSet(DocReference.compareByTargetId)}return ReferenceSet.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},ReferenceSet.prototype.addReference=function(key,id){var ref=new DocReference(key,id);this.refsByKey=this.refsByKey.add(ref),this.refsByTarget=this.refsByTarget.add(ref)},ReferenceSet.prototype.addReferences=function(keys,id){var _this=this;keys.forEach(function(key){return _this.addReference(key,id)})},ReferenceSet.prototype.removeReference=function(key,id){this.removeRef(new DocReference(key,id))},ReferenceSet.prototype.removeReferences=function(keys,id){var _this=this;keys.forEach(function(key){return _this.removeReference(key,id)})},ReferenceSet.prototype.removeReferencesForId=function(id){var _this=this,emptyKey=DocumentKey.EMPTY,startRef=new DocReference(emptyKey,id),endRef=new DocReference(emptyKey,id+1),keys=[];return this.refsByTarget.forEachInRange([startRef,endRef],function(ref){_this.removeRef(ref),keys.push(ref.key)}),keys},ReferenceSet.prototype.removeAllReferences=function(){var _this=this;this.refsByKey.forEach(function(ref){return _this.removeRef(ref)})},ReferenceSet.prototype.removeRef=function(ref){this.refsByKey=this.refsByKey.delete(ref),this.refsByTarget=this.refsByTarget.delete(ref)},ReferenceSet.prototype.referencesForId=function(id){var emptyKey=DocumentKey.EMPTY,startRef=new DocReference(emptyKey,id),endRef=new DocReference(emptyKey,id+1),keys=documentKeySet();return this.refsByTarget.forEachInRange([startRef,endRef],function(ref){keys=keys.add(ref.key)}),keys},ReferenceSet.prototype.containsKey=function(key){var ref=new DocReference(key,0),firstRef=this.refsByKey.firstAfterOrEqual(ref);return null!==firstRef&&key.isEqual(firstRef.key)},ReferenceSet}(),DocReference=function(){function DocReference(key,targetOrBatchId){this.key=key,this.targetOrBatchId=targetOrBatchId}return DocReference.compareByKey=function(left,right){return DocumentKey.comparator(left.key,right.key)||primitiveComparator(left.targetOrBatchId,right.targetOrBatchId)},DocReference.compareByTargetId=function(left,right){return primitiveComparator(left.targetOrBatchId,right.targetOrBatchId)||DocumentKey.comparator(left.key,right.key)},DocReference}(),LocalStore=function(){function LocalStore(persistence,initialUser){this.persistence=persistence,this.localViewReferences=new ReferenceSet,this.queryDataByTarget={},assert(persistence.started,'LocalStore was passed an unstarted persistence implementation'),this.persistence.referenceDelegate.setInMemoryPins(this.localViewReferences),this.mutationQueue=persistence.getMutationQueue(initialUser),this.remoteDocuments=persistence.getRemoteDocumentCache(),this.queryCache=persistence.getQueryCache(),this.localDocuments=new LocalDocumentsView(this.remoteDocuments,this.mutationQueue)}return LocalStore.prototype.handleUserChange=function(user){var _this=this;return this.persistence.runTransaction('Handle user change','readonly',function(txn){var oldBatches;return _this.mutationQueue.getAllMutationBatches(txn).next(function(promisedOldBatches){return oldBatches=promisedOldBatches,_this.mutationQueue=_this.persistence.getMutationQueue(user),_this.localDocuments=new LocalDocumentsView(_this.remoteDocuments,_this.mutationQueue),_this.mutationQueue.getAllMutationBatches(txn)}).next(function(newBatches){for(var removedBatchIds=[],addedBatchIds=[],changedKeys=documentKeySet(),_i=0,oldBatches_1=oldBatches,batch;_i<oldBatches_1.length;_i++){batch=oldBatches_1[_i],removedBatchIds.push(batch.batchId);for(var _a=0,_b=batch.mutations,mutation;_a<_b.length;_a++)mutation=_b[_a],changedKeys=changedKeys.add(mutation.key)}for(var _c=0,newBatches_1=newBatches,batch;_c<newBatches_1.length;_c++){batch=newBatches_1[_c],addedBatchIds.push(batch.batchId);for(var _d=0,_e=batch.mutations,mutation;_d<_e.length;_d++)mutation=_e[_d],changedKeys=changedKeys.add(mutation.key)}return _this.localDocuments.getDocuments(txn,changedKeys).next(function(affectedDocuments){return{affectedDocuments:affectedDocuments,removedBatchIds:removedBatchIds,addedBatchIds:addedBatchIds}})})})},LocalStore.prototype.localWrite=function(mutations){var _this=this;return this.persistence.runTransaction('Locally write mutations','readwrite',function(txn){var localWriteTime=Timestamp.now(),batch;return _this.mutationQueue.addMutationBatch(txn,localWriteTime,mutations).next(function(promisedBatch){batch=promisedBatch;var keys=batch.keys();return _this.localDocuments.getDocuments(txn,keys)}).next(function(changedDocuments){return{batchId:batch.batchId,changes:changedDocuments}})})},LocalStore.prototype.lookupMutationDocuments=function(batchId){var _this=this;return this.persistence.runTransaction('Lookup mutation documents','readonly',function(txn){return _this.mutationQueue.lookupMutationKeys(txn,batchId).next(function(keys){return keys?_this.localDocuments.getDocuments(txn,keys):PersistencePromise.resolve(null)})})},LocalStore.prototype.acknowledgeBatch=function(batchResult){var _this=this;return this.persistence.runTransaction('Acknowledge batch','readwrite-primary',function(txn){var affected=batchResult.batch.keys(),documentBuffer=_this.remoteDocuments.newChangeBuffer();return _this.mutationQueue.acknowledgeBatch(txn,batchResult.batch,batchResult.streamToken).next(function(){return _this.applyWriteToRemoteDocuments(txn,batchResult,documentBuffer)}).next(function(){return documentBuffer.apply(txn)}).next(function(){return _this.mutationQueue.performConsistencyCheck(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,affected)})})},LocalStore.prototype.rejectBatch=function(batchId){var _this=this;return this.persistence.runTransaction('Reject batch','readwrite-primary',function(txn){var affectedKeys;return _this.mutationQueue.lookupMutationBatch(txn,batchId).next(function(batch){return assert(null!==batch,'Attempt to reject nonexistent batch!'),affectedKeys=batch.keys(),_this.mutationQueue.removeMutationBatch(txn,batch)}).next(function(){return _this.mutationQueue.performConsistencyCheck(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,affectedKeys)})})},LocalStore.prototype.getLastStreamToken=function(){var _this=this;return this.persistence.runTransaction('Get last stream token','readonly',function(txn){return _this.mutationQueue.getLastStreamToken(txn)})},LocalStore.prototype.setLastStreamToken=function(streamToken){var _this=this;return this.persistence.runTransaction('Set last stream token','readwrite-primary',function(txn){return _this.mutationQueue.setLastStreamToken(txn,streamToken)})},LocalStore.prototype.getLastRemoteSnapshotVersion=function(){var _this=this;return this.persistence.runTransaction('Get last remote snapshot version','readonly',function(txn){return _this.queryCache.getLastRemoteSnapshotVersion(txn)})},LocalStore.prototype.applyRemoteEvent=function(remoteEvent){var _this=this,documentBuffer=this.remoteDocuments.newChangeBuffer();return this.persistence.runTransaction('Apply remote event','readwrite-primary',function(txn){var promises=[],authoritativeUpdates=documentKeySet();forEachNumber(remoteEvent.targetChanges,function(targetId,change){var queryData=_this.queryDataByTarget[targetId];if(queryData){change.addedDocuments.forEach(function(key){authoritativeUpdates=authoritativeUpdates.add(key)}),change.modifiedDocuments.forEach(function(key){authoritativeUpdates=authoritativeUpdates.add(key)}),promises.push(_this.queryCache.removeMatchingKeys(txn,change.removedDocuments,targetId).next(function(){return _this.queryCache.addMatchingKeys(txn,change.addedDocuments,targetId)}));var resumeToken=change.resumeToken;if(0<resumeToken.length){var oldQueryData=queryData;queryData=queryData.copy({resumeToken:resumeToken,snapshotVersion:remoteEvent.snapshotVersion}),_this.queryDataByTarget[targetId]=queryData,LocalStore.shouldPersistQueryData(oldQueryData,queryData,change)&&promises.push(_this.queryCache.updateQueryData(txn,queryData))}}});var changedDocKeys=documentKeySet();remoteEvent.documentUpdates.forEach(function(key,doc){changedDocKeys=changedDocKeys.add(key),promises.push(documentBuffer.getEntry(txn,key).next(function(existingDoc){null==existingDoc||doc.version.isEqual(SnapshotVersion.MIN)||authoritativeUpdates.has(doc.key)&&!existingDoc.hasPendingWrites||0<=doc.version.compareTo(existingDoc.version)?documentBuffer.addEntry(doc):debug('LocalStore','Ignoring outdated watch update for ',key,'. Current version:',existingDoc.version,' Watch version:',doc.version)})),remoteEvent.resolvedLimboDocuments.has(key)&&promises.push(_this.persistence.referenceDelegate.updateLimboDocument(txn,key))});var remoteVersion=remoteEvent.snapshotVersion;if(!remoteVersion.isEqual(SnapshotVersion.MIN)){var updateRemoteVersion=_this.queryCache.getLastRemoteSnapshotVersion(txn).next(function(lastRemoteVersion){return assert(0<=remoteVersion.compareTo(lastRemoteVersion),'Watch stream reverted to previous snapshot?? '+remoteVersion+' < '+lastRemoteVersion),_this.queryCache.setTargetsMetadata(txn,txn.currentSequenceNumber,remoteVersion)});promises.push(updateRemoteVersion)}return PersistencePromise.waitFor(promises).next(function(){return documentBuffer.apply(txn)}).next(function(){return _this.localDocuments.getDocuments(txn,changedDocKeys)})})},LocalStore.shouldPersistQueryData=function(oldQueryData,newQueryData,change){if(0===newQueryData.resumeToken.length)return!1;if(0===oldQueryData.resumeToken.length)return!0;var timeDelta=newQueryData.snapshotVersion.toMicroseconds()-oldQueryData.snapshotVersion.toMicroseconds();if(timeDelta>=this.RESUME_TOKEN_MAX_AGE_MICROS)return!0;var changes=change.addedDocuments.size+change.modifiedDocuments.size+change.removedDocuments.size;return 0<changes},LocalStore.prototype.notifyLocalViewChanges=function(viewChanges){var _this=this;return this.persistence.runTransaction('notifyLocalViewChanges','readwrite',function(txn){return PersistencePromise.forEach(viewChanges,function(viewChange){return _this.localViewReferences.addReferences(viewChange.addedKeys,viewChange.targetId),_this.localViewReferences.removeReferences(viewChange.removedKeys,viewChange.targetId),PersistencePromise.forEach(viewChange.removedKeys,function(key){return _this.persistence.referenceDelegate.removeReference(txn,key)})})})},LocalStore.prototype.nextMutationBatch=function(afterBatchId){var _this=this;return this.persistence.runTransaction('Get next mutation batch','readonly',function(txn){return void 0===afterBatchId&&(afterBatchId=BATCHID_UNKNOWN),_this.mutationQueue.getNextMutationBatchAfterBatchId(txn,afterBatchId)})},LocalStore.prototype.readDocument=function(key){var _this=this;return this.persistence.runTransaction('read document','readonly',function(txn){return _this.localDocuments.getDocument(txn,key)})},LocalStore.prototype.allocateQuery=function(query){var _this=this;return this.persistence.runTransaction('Allocate query','readwrite',function(txn){var queryData;return _this.queryCache.getQueryData(txn,query).next(function(cached){return cached?(queryData=cached,PersistencePromise.resolve()):_this.queryCache.allocateTargetId(txn).next(function(targetId){return queryData=new QueryData(query,targetId,QueryPurpose.Listen,txn.currentSequenceNumber),_this.queryCache.addQueryData(txn,queryData)})}).next(function(){return assert(!_this.queryDataByTarget[queryData.targetId],'Tried to allocate an already allocated query: '+query),_this.queryDataByTarget[queryData.targetId]=queryData,queryData})})},LocalStore.prototype.releaseQuery=function(query,keepPersistedQueryData){var _this=this,mode=keepPersistedQueryData?'readwrite':'readwrite-primary';return this.persistence.runTransaction('Release query',mode,function(txn){return _this.queryCache.getQueryData(txn,query).next(function(queryData){assert(null!=queryData,'Tried to release nonexistent query: '+query);var targetId=queryData.targetId,cachedQueryData=_this.queryDataByTarget[targetId],removed=_this.localViewReferences.removeReferencesForId(targetId);return delete _this.queryDataByTarget[targetId],keepPersistedQueryData?PersistencePromise.resolve():PersistencePromise.forEach(removed,function(key){return _this.persistence.referenceDelegate.removeReference(txn,key)}).next(function(){return _this.persistence.referenceDelegate.removeTarget(txn,cachedQueryData)})})})},LocalStore.prototype.executeQuery=function(query){var _this=this;return this.persistence.runTransaction('Execute query','readonly',function(txn){return _this.localDocuments.getDocumentsMatchingQuery(txn,query)})},LocalStore.prototype.remoteDocumentKeys=function(targetId){var _this=this;return this.persistence.runTransaction('Remote document keys','readonly',function(txn){return _this.queryCache.getMatchingKeysForTargetId(txn,targetId)})},LocalStore.prototype.getActiveClients=function(){return this.persistence.getActiveClients()},LocalStore.prototype.removeCachedMutationBatchMetadata=function(batchId){this.mutationQueue.removeCachedMutationKeys(batchId)},LocalStore.prototype.setNetworkEnabled=function(networkEnabled){this.persistence.setNetworkEnabled(networkEnabled)},LocalStore.prototype.applyWriteToRemoteDocuments=function(txn,batchResult,documentBuffer){var _this=this,batch=batchResult.batch,docKeys=batch.keys(),promiseChain=PersistencePromise.resolve();return docKeys.forEach(function(docKey){promiseChain=promiseChain.next(function(){return documentBuffer.getEntry(txn,docKey)}).next(function(remoteDoc){var doc=remoteDoc,ackVersion=batchResult.docVersions.get(docKey);assert(null!==ackVersion,'ackVersions should contain every doc in the write.'),(!doc||0>doc.version.compareTo(ackVersion))&&(doc=batch.applyToRemoteDocument(docKey,doc,batchResult),doc?documentBuffer.addEntry(doc):assert(!remoteDoc,'Mutation batch '+batch+' applied to document '+remoteDoc+' resulted in null'))})}),promiseChain.next(function(){return _this.mutationQueue.removeMutationBatch(txn,batch)})},LocalStore.prototype.getQueryForTarget=function(targetId){var _this=this;return this.queryDataByTarget[targetId]?Promise.resolve(this.queryDataByTarget[targetId].query):this.persistence.runTransaction('Get query data','readonly',function(txn){return _this.queryCache.getQueryDataForTarget(txn,targetId).next(function(queryData){return queryData?queryData.query:null})})},LocalStore.prototype.getNewDocumentChanges=function(){var _this=this;return this.persistence.runTransaction('Get new document changes','readonly',function(txn){return _this.remoteDocuments.getNewDocumentChanges(txn)})},LocalStore.RESUME_TOKEN_MAX_AGE_MICROS=1e6*(60*5),LocalStore}(),MemoryMutationQueue=function(){function MemoryMutationQueue(referenceDelegate){this.referenceDelegate=referenceDelegate,this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=BATCHID_UNKNOWN,this.lastStreamToken=emptyByteString(),this.batchesByDocumentKey=new SortedSet(DocReference.compareByKey)}return MemoryMutationQueue.prototype.checkEmpty=function(){return PersistencePromise.resolve(0===this.mutationQueue.length)},MemoryMutationQueue.prototype.acknowledgeBatch=function(transaction,batch,streamToken){var batchId=batch.batchId;assert(batchId>this.highestAcknowledgedBatchId,'Mutation batchIDs must be acknowledged in order');var batchIndex=this.indexOfExistingBatchId(batchId,'acknowledged');assert(0===batchIndex,'Can only acknowledge the first batch in the mutation queue');var check=this.mutationQueue[batchIndex];return assert(batchId===check.batchId,'Queue ordering failure: expected batch '+batchId+', got batch '+check.batchId),this.highestAcknowledgedBatchId=batchId,this.lastStreamToken=streamToken,PersistencePromise.resolve()},MemoryMutationQueue.prototype.getLastStreamToken=function(){return PersistencePromise.resolve(this.lastStreamToken)},MemoryMutationQueue.prototype.setLastStreamToken=function(transaction,streamToken){return this.lastStreamToken=streamToken,PersistencePromise.resolve()},MemoryMutationQueue.prototype.addMutationBatch=function(transaction,localWriteTime,mutations){assert(0!==mutations.length,'Mutation batches should not be empty');var batchId=this.nextBatchId;if(this.nextBatchId++,0<this.mutationQueue.length){var prior=this.mutationQueue[this.mutationQueue.length-1];assert(prior.batchId<batchId,'Mutation batchIDs must be monotonically increasing order')}var batch=new MutationBatch(batchId,localWriteTime,mutations);this.mutationQueue.push(batch);for(var _i=0,mutations_1=mutations,mutation;_i<mutations_1.length;_i++)mutation=mutations_1[_i],this.batchesByDocumentKey=this.batchesByDocumentKey.add(new DocReference(mutation.key,batchId));return PersistencePromise.resolve(batch)},MemoryMutationQueue.prototype.lookupMutationBatch=function(transaction,batchId){return PersistencePromise.resolve(this.findMutationBatch(batchId))},MemoryMutationQueue.prototype.lookupMutationKeys=function(transaction,batchId){var mutationBatch=this.findMutationBatch(batchId);return assert(null!=mutationBatch,'Failed to find local mutation batch.'),PersistencePromise.resolve(mutationBatch.keys())},MemoryMutationQueue.prototype.getNextMutationBatchAfterBatchId=function(transaction,batchId){var nextBatchId=_Mathmax(batchId,this.highestAcknowledgedBatchId)+1,rawIndex=this.indexOfBatchId(nextBatchId),index=0>rawIndex?0:rawIndex;return PersistencePromise.resolve(this.mutationQueue.length>index?this.mutationQueue[index]:null)},MemoryMutationQueue.prototype.getAllMutationBatches=function(){return PersistencePromise.resolve(this.mutationQueue.slice())},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKey=function(transaction,documentKey){var _this=this,start=new DocReference(documentKey,0),end=new DocReference(documentKey,_NumberPOSITIVE_INFINITY),result=[];return this.batchesByDocumentKey.forEachInRange([start,end],function(ref){assert(documentKey.isEqual(ref.key),'Should only iterate over a single key\'s batches');var batch=_this.findMutationBatch(ref.targetOrBatchId);assert(null!==batch,'Batches in the index must exist in the main table'),result.push(batch)}),PersistencePromise.resolve(result)},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingDocumentKeys=function(transaction,documentKeys){var _this=this,uniqueBatchIDs=new SortedSet(primitiveComparator);return documentKeys.forEach(function(documentKey){var start=new DocReference(documentKey,0),end=new DocReference(documentKey,_NumberPOSITIVE_INFINITY);_this.batchesByDocumentKey.forEachInRange([start,end],function(ref){assert(documentKey.isEqual(ref.key),'For each key, should only iterate over a single key\'s batches'),uniqueBatchIDs=uniqueBatchIDs.add(ref.targetOrBatchId)})}),PersistencePromise.resolve(this.findMutationBatches(uniqueBatchIDs))},MemoryMutationQueue.prototype.getAllMutationBatchesAffectingQuery=function(transaction,query){var prefix=query.path,immediateChildrenPathLength=prefix.length+1,startPath=prefix;DocumentKey.isDocumentKey(startPath)||(startPath=startPath.child(''));var start=new DocReference(new DocumentKey(startPath),0),uniqueBatchIDs=new SortedSet(primitiveComparator);return this.batchesByDocumentKey.forEachWhile(function(ref){var rowKeyPath=ref.key.path;return!!prefix.isPrefixOf(rowKeyPath)&&(rowKeyPath.length===immediateChildrenPathLength&&(uniqueBatchIDs=uniqueBatchIDs.add(ref.targetOrBatchId)),!0)},start),PersistencePromise.resolve(this.findMutationBatches(uniqueBatchIDs))},MemoryMutationQueue.prototype.findMutationBatches=function(batchIDs){var _this=this,result=[];return batchIDs.forEach(function(batchId){var batch=_this.findMutationBatch(batchId);null!==batch&&result.push(batch)}),result},MemoryMutationQueue.prototype.removeMutationBatch=function(transaction,batch){var _this=this,batchIndex=this.indexOfExistingBatchId(batch.batchId,'removed');assert(0===batchIndex,'Can only remove the first entry of the mutation queue'),this.mutationQueue.shift();var references=this.batchesByDocumentKey;return PersistencePromise.forEach(batch.mutations,function(mutation){var ref=new DocReference(mutation.key,batch.batchId);return references=references.delete(ref),_this.referenceDelegate.removeMutationReference(transaction,mutation.key)}).next(function(){_this.batchesByDocumentKey=references})},MemoryMutationQueue.prototype.removeCachedMutationKeys=function(){},MemoryMutationQueue.prototype.containsKey=function(txn,key){var ref=new DocReference(key,0),firstRef=this.batchesByDocumentKey.firstAfterOrEqual(ref);return PersistencePromise.resolve(key.isEqual(firstRef&&firstRef.key))},MemoryMutationQueue.prototype.performConsistencyCheck=function(){return 0===this.mutationQueue.length&&assert(this.batchesByDocumentKey.isEmpty(),'Document leak -- detected dangling mutation references when queue is empty.'),PersistencePromise.resolve()},MemoryMutationQueue.prototype.indexOfExistingBatchId=function(batchId,action){var index=this.indexOfBatchId(batchId);return assert(0<=index&&index<this.mutationQueue.length,'Batches must exist to be '+action),index},MemoryMutationQueue.prototype.indexOfBatchId=function(batchId){if(0===this.mutationQueue.length)return 0;var firstBatchId=this.mutationQueue[0].batchId;return batchId-firstBatchId},MemoryMutationQueue.prototype.findMutationBatch=function(batchId){var index=this.indexOfBatchId(batchId);if(0>index||index>=this.mutationQueue.length)return null;var batch=this.mutationQueue[index];return assert(batch.batchId===batchId,'If found batch must match'),batch},MemoryMutationQueue}(),MemoryQueryCache=function(){function MemoryQueryCache(persistence){this.persistence=persistence,this.queries=new ObjectMap(function(q){return q.canonicalId()}),this.lastRemoteSnapshotVersion=SnapshotVersion.MIN,this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new ReferenceSet,this.targetCount=0,this.targetIdGenerator=TargetIdGenerator.forQueryCache()}return MemoryQueryCache.prototype.getTargetCount=function(){return PersistencePromise.resolve(this.targetCount)},MemoryQueryCache.prototype.forEachTarget=function(txn,f){return this.queries.forEach(function(_,queryData){return f(queryData)}),PersistencePromise.resolve()},MemoryQueryCache.prototype.getLastRemoteSnapshotVersion=function(){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)},MemoryQueryCache.prototype.getHighestSequenceNumber=function(){return PersistencePromise.resolve(this.highestSequenceNumber)},MemoryQueryCache.prototype.allocateTargetId=function(){var nextTargetId=this.targetIdGenerator.after(this.highestTargetId);return this.highestTargetId=nextTargetId,PersistencePromise.resolve(nextTargetId)},MemoryQueryCache.prototype.setTargetsMetadata=function(transaction,highestListenSequenceNumber,lastRemoteSnapshotVersion){return lastRemoteSnapshotVersion&&(this.lastRemoteSnapshotVersion=lastRemoteSnapshotVersion),highestListenSequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=highestListenSequenceNumber),PersistencePromise.resolve()},MemoryQueryCache.prototype.saveQueryData=function(queryData){this.queries.set(queryData.query,queryData);var targetId=queryData.targetId;targetId>this.highestTargetId&&(this.highestTargetId=targetId),queryData.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=queryData.sequenceNumber)},MemoryQueryCache.prototype.addQueryData=function(transaction,queryData){return assert(!this.queries.has(queryData.query),'Adding a query that already exists'),this.saveQueryData(queryData),this.targetCount+=1,PersistencePromise.resolve()},MemoryQueryCache.prototype.updateQueryData=function(transaction,queryData){return assert(this.queries.has(queryData.query),'Updating a non-existent query'),this.saveQueryData(queryData),PersistencePromise.resolve()},MemoryQueryCache.prototype.removeQueryData=function(transaction,queryData){return assert(0<this.targetCount,'Removing a target from an empty cache'),assert(this.queries.has(queryData.query),'Removing a non-existent target from the cache'),this.queries.delete(queryData.query),this.references.removeReferencesForId(queryData.targetId),this.targetCount-=1,PersistencePromise.resolve()},MemoryQueryCache.prototype.removeTargets=function(transaction,upperBound,activeTargetIds){var _this=this,count=0,removals=[];return this.queries.forEach(function(key,queryData){queryData.sequenceNumber<=upperBound&&!activeTargetIds[queryData.targetId]&&(_this.queries.delete(key),removals.push(_this.removeMatchingKeysForTargetId(transaction,queryData.targetId)),count++)}),PersistencePromise.waitFor(removals).next(function(){return count})},MemoryQueryCache.prototype.getQueryCount=function(){return PersistencePromise.resolve(this.targetCount)},MemoryQueryCache.prototype.getQueryData=function(transaction,query){var queryData=this.queries.get(query)||null;return PersistencePromise.resolve(queryData)},MemoryQueryCache.prototype.getQueryDataForTarget=function(){return fail('Not yet implemented.')},MemoryQueryCache.prototype.addMatchingKeys=function(txn,keys,targetId){this.references.addReferences(keys,targetId);var referenceDelegate=this.persistence.referenceDelegate,promises=[];return referenceDelegate&&keys.forEach(function(key){promises.push(referenceDelegate.addReference(txn,key))}),PersistencePromise.waitFor(promises)},MemoryQueryCache.prototype.removeMatchingKeys=function(txn,keys,targetId){this.references.removeReferences(keys,targetId);var referenceDelegate=this.persistence.referenceDelegate,promises=[];return referenceDelegate&&keys.forEach(function(key){promises.push(referenceDelegate.removeReference(txn,key))}),PersistencePromise.waitFor(promises)},MemoryQueryCache.prototype.removeMatchingKeysForTargetId=function(txn,targetId){return this.references.removeReferencesForId(targetId),PersistencePromise.resolve()},MemoryQueryCache.prototype.getMatchingKeysForTargetId=function(txn,targetId){var matchingKeys=this.references.referencesForId(targetId);return PersistencePromise.resolve(matchingKeys)},MemoryQueryCache.prototype.containsKey=function(txn,key){return PersistencePromise.resolve(this.references.containsKey(key))},MemoryQueryCache}(),MemoryRemoteDocumentCache=function(){function MemoryRemoteDocumentCache(sizer){this.sizer=sizer,this.docs=documentSizeMap(),this.newDocumentChanges=documentKeySet(),this.size=0}return MemoryRemoteDocumentCache.prototype.addEntries=function(transaction,entries,sizeDelta){for(var _i=0,entries_1=entries;_i<entries_1.length;_i++){var entry=entries_1[_i],key=entry.maybeDocument.key;this.docs=this.docs.insert(key,entry),this.newDocumentChanges=this.newDocumentChanges.add(key)}return this.size+=sizeDelta,PersistencePromise.resolve()},MemoryRemoteDocumentCache.prototype.removeEntry=function(transaction,documentKey){var entry=this.docs.get(documentKey);return entry?(this.docs=this.docs.remove(documentKey),this.size-=entry.size,PersistencePromise.resolve(entry.size)):PersistencePromise.resolve(0)},MemoryRemoteDocumentCache.prototype.getEntry=function(transaction,documentKey){var entry=this.docs.get(documentKey);return PersistencePromise.resolve(entry?entry.maybeDocument:null)},MemoryRemoteDocumentCache.prototype.getSizedEntry=function(transaction,documentKey){return PersistencePromise.resolve(this.docs.get(documentKey))},MemoryRemoteDocumentCache.prototype.getDocumentsMatchingQuery=function(transaction,query){for(var results=documentMap(),prefix=new DocumentKey(query.path.child('')),iterator=this.docs.getIteratorFrom(prefix);iterator.hasNext();){var _a=iterator.getNext(),key=_a.key,maybeDocument=_a.value.maybeDocument;if(!query.path.isPrefixOf(key.path))break;maybeDocument instanceof Document&&query.matches(maybeDocument)&&(results=results.insert(maybeDocument.key,maybeDocument))}return PersistencePromise.resolve(results)},MemoryRemoteDocumentCache.prototype.forEachDocumentKey=function(transaction,f){return PersistencePromise.forEach(this.docs,function(key){return f(key)})},MemoryRemoteDocumentCache.prototype.getNewDocumentChanges=function(){var _this=this,changedDocs=maybeDocumentMap();return this.newDocumentChanges.forEach(function(key){var entry=_this.docs.get(key),changedDoc=entry?entry.maybeDocument:new NoDocument(key,SnapshotVersion.forDeletedDoc());changedDocs=changedDocs.insert(key,changedDoc)}),this.newDocumentChanges=documentKeySet(),PersistencePromise.resolve(changedDocs)},MemoryRemoteDocumentCache.prototype.newChangeBuffer=function(){return new MemoryRemoteDocumentChangeBuffer(this.sizer,this)},MemoryRemoteDocumentCache.prototype.getSize=function(){return PersistencePromise.resolve(this.size)},MemoryRemoteDocumentCache}(),MemoryRemoteDocumentChangeBuffer=function(_super){function MemoryRemoteDocumentChangeBuffer(sizer,documentCache){var _this=_super.call(this)||this;return _this.sizer=sizer,_this.documentCache=documentCache,_this}return tslib_1.__extends(MemoryRemoteDocumentChangeBuffer,_super),MemoryRemoteDocumentChangeBuffer.prototype.applyChanges=function(transaction){var _this=this,changes=this.assertChanges(),delta=0,docs=[];return changes.forEach(function(key,maybeDocument){var previousSize=_this.documentSizes.get(key);assert(void 0!==previousSize,'Attempting to change document '+key.toString()+' without having read it first');var size=_this.sizer(maybeDocument);delta+=size-previousSize,docs.push({maybeDocument:maybeDocument,size:size})}),this.documentCache.addEntries(transaction,docs,delta)},MemoryRemoteDocumentChangeBuffer.prototype.getFromCache=function(transaction,documentKey){return this.documentCache.getSizedEntry(transaction,documentKey)},MemoryRemoteDocumentChangeBuffer}(RemoteDocumentChangeBuffer),MemoryPersistence=function(){function MemoryPersistence(clientId,isEager,serializer){var _this=this;this.clientId=clientId,this.mutationQueues={},this.listenSequence=new ListenSequence(0),this._started=!1,this._started=!0,this.referenceDelegate=isEager?new MemoryEagerDelegate(this):new MemoryLruDelegate(this,new LocalSerializer(serializer)),this.queryCache=new MemoryQueryCache(this);this.remoteDocumentCache=new MemoryRemoteDocumentCache(function(doc){return _this.referenceDelegate.documentSize(doc)})}return MemoryPersistence.createLruPersistence=function(clientId,serializer){return new MemoryPersistence(clientId,!1,serializer)},MemoryPersistence.createEagerPersistence=function(clientId,serializer){return new MemoryPersistence(clientId,!0,serializer)},MemoryPersistence.prototype.shutdown=function(){return this._started=!1,Promise.resolve()},Object.defineProperty(MemoryPersistence.prototype,'started',{get:function(){return this._started},enumerable:!0,configurable:!0}),MemoryPersistence.prototype.getActiveClients=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return[2,[this.clientId]]})})},MemoryPersistence.prototype.setPrimaryStateListener=function(primaryStateListener){return primaryStateListener(!0)},MemoryPersistence.prototype.setNetworkEnabled=function(){},MemoryPersistence.prototype.getMutationQueue=function(user){var queue=this.mutationQueues[user.toKey()];return queue||(queue=new MemoryMutationQueue(this.referenceDelegate),this.mutationQueues[user.toKey()]=queue),queue},MemoryPersistence.prototype.getQueryCache=function(){return this.queryCache},MemoryPersistence.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},MemoryPersistence.prototype.runTransaction=function(action,mode,transactionOperation){var _this=this;debug('MemoryPersistence','Starting transaction:',action);var txn=new MemoryTransaction(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),transactionOperation(txn).next(function(result){return _this.referenceDelegate.onTransactionCommitted(txn).next(function(){return result})}).toPromise()},MemoryPersistence.prototype.mutationQueuesContainKey=function(transaction,key){return PersistencePromise.or(values(this.mutationQueues).map(function(queue){return function(){return queue.containsKey(transaction,key)}}))},MemoryPersistence}(),MemoryTransaction=function(){return function MemoryTransaction(currentSequenceNumber){this.currentSequenceNumber=currentSequenceNumber}}(),MemoryEagerDelegate=function(){function MemoryEagerDelegate(persistence){this.persistence=persistence}return MemoryEagerDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},MemoryEagerDelegate.prototype.addReference=function(txn,key){return this.orphanedDocuments.delete(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeReference=function(txn,key){return this.orphanedDocuments.add(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeMutationReference=function(txn,key){return this.orphanedDocuments.add(key),PersistencePromise.resolve()},MemoryEagerDelegate.prototype.removeTarget=function(txn,queryData){var _this=this,cache=this.persistence.getQueryCache();return cache.getMatchingKeysForTargetId(txn,queryData.targetId).next(function(keys){keys.forEach(function(key){return _this.orphanedDocuments.add(key)})}).next(function(){return cache.removeQueryData(txn,queryData)})},MemoryEagerDelegate.prototype.onTransactionStarted=function(){this.orphanedDocuments=new Set},MemoryEagerDelegate.prototype.onTransactionCommitted=function(txn){var _this=this,cache=this.persistence.getRemoteDocumentCache();return PersistencePromise.forEach(this.orphanedDocuments,function(key){return _this.isReferenced(txn,key).next(function(isReferenced){return isReferenced?PersistencePromise.resolve():cache.removeEntry(txn,key).next(function(){})})})},MemoryEagerDelegate.prototype.updateLimboDocument=function(txn,key){var _this=this;return this.isReferenced(txn,key).next(function(isReferenced){isReferenced?_this.orphanedDocuments.delete(key):_this.orphanedDocuments.add(key)})},MemoryEagerDelegate.prototype.documentSize=function(){return 0},MemoryEagerDelegate.prototype.isReferenced=function(txn,key){var _this=this;return PersistencePromise.or([function(){return _this.persistence.getQueryCache().containsKey(txn,key)},function(){return _this.persistence.mutationQueuesContainKey(txn,key)},function(){return PersistencePromise.resolve(_this.inMemoryPins.containsKey(key))}])},MemoryEagerDelegate}(),MemoryLruDelegate=function(){function MemoryLruDelegate(persistence,serializer){this.persistence=persistence,this.serializer=serializer,this.orphanedSequenceNumbers=new ObjectMap(function(k){return encode(k.path)}),this.garbageCollector=new LruGarbageCollector(this)}return MemoryLruDelegate.prototype.onTransactionStarted=function(){},MemoryLruDelegate.prototype.onTransactionCommitted=function(){return PersistencePromise.resolve()},MemoryLruDelegate.prototype.forEachTarget=function(txn,f){return this.persistence.getQueryCache().forEachTarget(txn,f)},MemoryLruDelegate.prototype.getTargetCount=function(txn){return this.persistence.getQueryCache().getTargetCount(txn)},MemoryLruDelegate.prototype.forEachOrphanedDocumentSequenceNumber=function(txn,f){var _this=this;return PersistencePromise.forEach(this.orphanedSequenceNumbers,function(key,sequenceNumber){return _this.isPinned(txn,key,sequenceNumber).next(function(isPinned){return isPinned?PersistencePromise.resolve():f(sequenceNumber)})})},MemoryLruDelegate.prototype.setInMemoryPins=function(inMemoryPins){this.inMemoryPins=inMemoryPins},MemoryLruDelegate.prototype.removeTargets=function(txn,upperBound,activeTargetIds){return this.persistence.getQueryCache().removeTargets(txn,upperBound,activeTargetIds)},MemoryLruDelegate.prototype.removeOrphanedDocuments=function(txn,upperBound){var _this=this,count=0,cache=this.persistence.getRemoteDocumentCache(),p=cache.forEachDocumentKey(txn,function(key){return _this.isPinned(txn,key,upperBound).next(function(isPinned){return isPinned?PersistencePromise.resolve():(count++,cache.removeEntry(txn,key).next())})});return p.next(function(){return count})},MemoryLruDelegate.prototype.removeMutationReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.removeTarget=function(txn,queryData){var updated=queryData.copy({sequenceNumber:txn.currentSequenceNumber});return this.persistence.getQueryCache().updateQueryData(txn,updated)},MemoryLruDelegate.prototype.addReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.removeReference=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.updateLimboDocument=function(txn,key){return this.orphanedSequenceNumbers.set(key,txn.currentSequenceNumber),PersistencePromise.resolve()},MemoryLruDelegate.prototype.documentSize=function(maybeDoc){var remoteDocument=this.serializer.toDbRemoteDocument(maybeDoc),value;if(remoteDocument.document)value=remoteDocument.document;else if(remoteDocument.unknownDocument)value=remoteDocument.unknownDocument;else if(remoteDocument.noDocument)value=remoteDocument.noDocument;else throw fail('Unknown remote document type');return JSON.stringify(value).length},MemoryLruDelegate.prototype.isPinned=function(txn,key,upperBound){var _this=this;return PersistencePromise.or([function(){return _this.persistence.mutationQueuesContainKey(txn,key)},function(){return PersistencePromise.resolve(_this.inMemoryPins.containsKey(key))},function(){return _this.persistence.getQueryCache().containsKey(txn,key)},function(){var orphanedAt=_this.orphanedSequenceNumbers.get(key);return PersistencePromise.resolve(void 0!==orphanedAt&&orphanedAt>upperBound)}])},MemoryLruDelegate}(),ExponentialBackoff=function(){function ExponentialBackoff(queue,timerId,initialDelayMs,backoffFactor,maxDelayMs){this.queue=queue,this.timerId=timerId,this.initialDelayMs=initialDelayMs,this.backoffFactor=backoffFactor,this.maxDelayMs=maxDelayMs,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}return ExponentialBackoff.prototype.reset=function(){this.currentBaseMs=0},ExponentialBackoff.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},ExponentialBackoff.prototype.backoffAndRun=function(op){var _this=this;this.cancel();var desiredDelayWithJitterMs=_Mathfloor(this.currentBaseMs+this.jitterDelayMs()),delaySoFarMs=_Mathmax(0,Date.now()-this.lastAttemptTime),remainingDelayMs=_Mathmax(0,desiredDelayWithJitterMs-delaySoFarMs);0<this.currentBaseMs&&debug('ExponentialBackoff','Backing off for '+remainingDelayMs+' ms '+('(base delay: '+this.currentBaseMs+' ms, ')+('delay with jitter: '+desiredDelayWithJitterMs+' ms, ')+('last attempt: '+delaySoFarMs+' ms ago)')),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,remainingDelayMs,function(){return _this.lastAttemptTime=Date.now(),op()}),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},ExponentialBackoff.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},ExponentialBackoff.prototype.jitterDelayMs=function(){return(Math.random()-0.5)*this.currentBaseMs},ExponentialBackoff}(),LOG_TAG$6='PersistentStream',PersistentStreamState;(function(PersistentStreamState){PersistentStreamState[PersistentStreamState.Initial=0]='Initial',PersistentStreamState[PersistentStreamState.Starting=1]='Starting',PersistentStreamState[PersistentStreamState.Open=2]='Open',PersistentStreamState[PersistentStreamState.Error=3]='Error',PersistentStreamState[PersistentStreamState.Backoff=4]='Backoff'})(PersistentStreamState||(PersistentStreamState={}));var PersistentStream=function(){function PersistentStream(queue,connectionTimerId,idleTimerId,connection,credentialsProvider,listener){this.queue=queue,this.idleTimerId=idleTimerId,this.connection=connection,this.credentialsProvider=credentialsProvider,this.listener=listener,this.state=PersistentStreamState.Initial,this.closeCount=0,this.idleTimer=null,this.stream=null,this.backoff=new ExponentialBackoff(queue,connectionTimerId,1e3,1.5,1e3*60)}return PersistentStream.prototype.isStarted=function(){return this.state===PersistentStreamState.Starting||this.state===PersistentStreamState.Open||this.state===PersistentStreamState.Backoff},PersistentStream.prototype.isOpen=function(){return this.state===PersistentStreamState.Open},PersistentStream.prototype.start=function(){return this.state===PersistentStreamState.Error?void this.performBackoff():void(assert(this.state===PersistentStreamState.Initial,'Already started'),this.auth())},PersistentStream.prototype.stop=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.isStarted()?[4,this.close(PersistentStreamState.Initial)]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})})},PersistentStream.prototype.inhibitBackoff=function(){assert(!this.isStarted(),'Can only inhibit backoff in a stopped state'),this.state=PersistentStreamState.Initial,this.backoff.reset()},PersistentStream.prototype.markIdle=function(){var _this=this;this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,1e3*60,function(){return _this.handleIdleCloseTimer()}))},PersistentStream.prototype.sendRequest=function(msg){this.cancelIdleCheck(),this.stream.send(msg)},PersistentStream.prototype.handleIdleCloseTimer=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.isOpen()?[2,this.close(PersistentStreamState.Initial)]:[2]})})},PersistentStream.prototype.cancelIdleCheck=function(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},PersistentStream.prototype.close=function(finalState,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return assert(this.isStarted(),'Only started streams should be closed.'),assert(finalState===PersistentStreamState.Error||isNullOrUndefined(error$$1),'Can\'t provide an error when not in an error state.'),this.cancelIdleCheck(),this.backoff.cancel(),this.closeCount++,finalState===PersistentStreamState.Error?error$$1&&error$$1.code===Code.RESOURCE_EXHAUSTED?(error(error$$1.toString()),error('Using maximum backoff delay to prevent overloading the backend.'),this.backoff.resetToMax()):error$$1&&error$$1.code===Code.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken():this.backoff.reset(),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=finalState,[4,this.listener.onClose(error$$1)];case 1:return _a.sent(),[2];}})})},PersistentStream.prototype.tearDown=function(){},PersistentStream.prototype.auth=function(){var _this=this;assert(this.state===PersistentStreamState.Initial,'Must be in initial state to auth'),this.state=PersistentStreamState.Starting;var dispatchIfNotClosed=this.getCloseGuardedDispatcher(this.closeCount),closeCount=this.closeCount;this.credentialsProvider.getToken().then(function(token){_this.closeCount===closeCount&&_this.startStream(token)},function(error$$1){dispatchIfNotClosed(function(){var rpcError=new FirestoreError(Code.UNKNOWN,'Fetching auth token failed: '+error$$1.message);return _this.handleStreamClose(rpcError)})})},PersistentStream.prototype.startStream=function(token){var _this=this;assert(this.state===PersistentStreamState.Starting,'Trying to start stream in a non-starting state');var dispatchIfNotClosed=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(token),this.stream.onOpen(function(){dispatchIfNotClosed(function(){return assert(_this.state===PersistentStreamState.Starting,'Expected stream to be in state Starting, but was '+_this.state),_this.state=PersistentStreamState.Open,_this.listener.onOpen()})}),this.stream.onClose(function(error$$1){dispatchIfNotClosed(function(){return _this.handleStreamClose(error$$1)})}),this.stream.onMessage(function(msg){dispatchIfNotClosed(function(){return _this.onMessage(msg)})})},PersistentStream.prototype.performBackoff=function(){var _this=this;assert(this.state===PersistentStreamState.Error,'Should only perform backoff when in Error state'),this.state=PersistentStreamState.Backoff,this.backoff.backoffAndRun(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return assert(this.state===PersistentStreamState.Backoff,'Backoff elapsed but state is now: '+this.state),this.state=PersistentStreamState.Initial,this.start(),assert(this.isStarted(),'PersistentStream should have started'),[2]})})})},PersistentStream.prototype.handleStreamClose=function(error$$1){return assert(this.isStarted(),'Can\'t handle server close on non-started stream'),debug(LOG_TAG$6,'close with error: '+error$$1),this.stream=null,this.close(PersistentStreamState.Error,error$$1)},PersistentStream.prototype.getCloseGuardedDispatcher=function(startCloseCount){var _this=this;return function(fn){_this.queue.enqueueAndForget(function(){return _this.closeCount===startCloseCount?fn():(debug(LOG_TAG$6,'stream callback skipped by getCloseGuardedDispatcher.'),Promise.resolve())})}},PersistentStream}(),PersistentListenStream=function(_super){function PersistentListenStream(queue,connection,credentials,serializer,listener){var _this=_super.call(this,queue,TimerId.ListenStreamConnectionBackoff,TimerId.ListenStreamIdle,connection,credentials,listener)||this;return _this.serializer=serializer,_this}return tslib_1.__extends(PersistentListenStream,_super),PersistentListenStream.prototype.startRpc=function(token){return this.connection.openStream('Listen',token)},PersistentListenStream.prototype.onMessage=function(watchChangeProto){this.backoff.reset();var watchChange=this.serializer.fromWatchChange(watchChangeProto),snapshot=this.serializer.versionFromListenResponse(watchChangeProto);return this.listener.onWatchChange(watchChange,snapshot)},PersistentListenStream.prototype.watch=function(queryData){var request={database:this.serializer.encodedDatabaseId,addTarget:this.serializer.toTarget(queryData)},labels=this.serializer.toListenRequestLabels(queryData);labels&&(request.labels=labels),this.sendRequest(request)},PersistentListenStream.prototype.unwatch=function(targetId){var request={};request.database=this.serializer.encodedDatabaseId,request.removeTarget=targetId,this.sendRequest(request)},PersistentListenStream}(PersistentStream),PersistentWriteStream=function(_super){function PersistentWriteStream(queue,connection,credentials,serializer,listener){var _this=_super.call(this,queue,TimerId.WriteStreamConnectionBackoff,TimerId.WriteStreamIdle,connection,credentials,listener)||this;return _this.serializer=serializer,_this.handshakeComplete_=!1,_this}return tslib_1.__extends(PersistentWriteStream,_super),Object.defineProperty(PersistentWriteStream.prototype,'handshakeComplete',{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),PersistentWriteStream.prototype.start=function(){this.handshakeComplete_=!1,_super.prototype.start.call(this)},PersistentWriteStream.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},PersistentWriteStream.prototype.startRpc=function(token){return this.connection.openStream('Write',token)},PersistentWriteStream.prototype.onMessage=function(responseProto){if(assert(!!responseProto.streamToken,'Got a write response without a stream token'),this.lastStreamToken=responseProto.streamToken,!this.handshakeComplete_)return assert(!responseProto.writeResults||0===responseProto.writeResults.length,'Got mutation results for handshake'),this.handshakeComplete_=!0,this.listener.onHandshakeComplete();this.backoff.reset();var results=this.serializer.fromWriteResults(responseProto.writeResults,responseProto.commitTime),commitVersion=this.serializer.fromVersion(responseProto.commitTime);return this.listener.onMutationResult(commitVersion,results)},PersistentWriteStream.prototype.writeHandshake=function(){assert(this.isOpen(),'Writing handshake requires an opened stream'),assert(!this.handshakeComplete_,'Handshake already completed');var request={};request.database=this.serializer.encodedDatabaseId,this.sendRequest(request)},PersistentWriteStream.prototype.writeMutations=function(mutations){var _this=this;assert(this.isOpen(),'Writing mutations requires an opened stream'),assert(this.handshakeComplete_,'Handshake must be complete before writing mutations'),assert(0<this.lastStreamToken.length,'Trying to write mutation without a token');var request={streamToken:this.lastStreamToken,writes:mutations.map(function(mutation){return _this.serializer.toMutation(mutation)})};this.sendRequest(request)},PersistentWriteStream}(PersistentStream),Datastore=function(){function Datastore(queue,connection,credentials,serializer){this.queue=queue,this.connection=connection,this.credentials=credentials,this.serializer=serializer}return Datastore.prototype.newPersistentWriteStream=function(listener){return new PersistentWriteStream(this.queue,this.connection,this.credentials,this.serializer,listener)},Datastore.prototype.newPersistentWatchStream=function(listener){return new PersistentListenStream(this.queue,this.connection,this.credentials,this.serializer,listener)},Datastore.prototype.commit=function(mutations){var _this=this,params={database:this.serializer.encodedDatabaseId,writes:mutations.map(function(m){return _this.serializer.toMutation(m)})};return this.invokeRPC('Commit',params).then(function(response){return _this.serializer.fromWriteResults(response.writeResults,response.commitTime)})},Datastore.prototype.lookup=function(keys){var _this=this,params={database:this.serializer.encodedDatabaseId,documents:keys.map(function(k){return _this.serializer.toName(k)})};return this.invokeStreamingRPC('BatchGetDocuments',params).then(function(response){var docs=maybeDocumentMap();response.forEach(function(proto){var doc=_this.serializer.fromMaybeDocument(proto);docs=docs.insert(doc.key,doc)});var result=[];return keys.forEach(function(key){var doc=docs.get(key);assert(!!doc,'Missing entity in write response for '+key),result.push(doc)}),result})},Datastore.prototype.invokeRPC=function(rpcName,request){var _this=this;return this.credentials.getToken().then(function(token){return _this.connection.invokeRPC(rpcName,request,token)}).catch(function(error){throw error.code===Code.UNAUTHENTICATED&&_this.credentials.invalidateToken(),error})},Datastore.prototype.invokeStreamingRPC=function(rpcName,request){var _this=this;return this.credentials.getToken().then(function(token){return _this.connection.invokeStreamingRPC(rpcName,request,token)}).catch(function(error){throw error.code===Code.UNAUTHENTICATED&&_this.credentials.invalidateToken(),error})},Datastore}(),Transaction=function(){function Transaction(datastore){this.datastore=datastore,this.readVersions=documentVersionMap(),this.mutations=[],this.committed=!1}return Transaction.prototype.recordVersion=function(doc){var docVersion;if(doc instanceof Document)docVersion=doc.version;else if(doc instanceof NoDocument)docVersion=SnapshotVersion.forDeletedDoc();else throw fail('Document in a transaction was a '+doc.constructor.name);var existingVersion=this.readVersions.get(doc.key);if(null===existingVersion)this.readVersions=this.readVersions.insert(doc.key,docVersion);else if(!docVersion.isEqual(existingVersion))throw new FirestoreError(Code.ABORTED,'Document version changed between two reads.')},Transaction.prototype.lookup=function(keys){var _this=this;return this.committed?Promise.reject('Transaction has already completed.'):0<this.mutations.length?Promise.reject('Transactions lookups are invalid after writes.'):this.datastore.lookup(keys).then(function(docs){return docs.forEach(function(doc){doc instanceof NoDocument||doc instanceof Document?_this.recordVersion(doc):fail('Document in a transaction was a '+doc.constructor.name)}),docs})},Transaction.prototype.write=function(mutations){if(this.committed)throw new FirestoreError(Code.FAILED_PRECONDITION,'Transaction has already completed.');this.mutations=this.mutations.concat(mutations)},Transaction.prototype.precondition=function(key){var version=this.readVersions.get(key);return version?Precondition.updateTime(version):Precondition.NONE},Transaction.prototype.preconditionForUpdate=function(key){var version=this.readVersions.get(key);if(version&&version.isEqual(SnapshotVersion.forDeletedDoc()))throw new FirestoreError(Code.FAILED_PRECONDITION,'Can\'t update a document that doesn\'t exist.');else return version?Precondition.updateTime(version):Precondition.exists(!0)},Transaction.prototype.set=function(key,data){this.write(data.toMutations(key,this.precondition(key)))},Transaction.prototype.update=function(key,data){this.write(data.toMutations(key,this.preconditionForUpdate(key)))},Transaction.prototype.delete=function(key){this.write([new DeleteMutation(key,this.precondition(key))]),this.readVersions=this.readVersions.insert(key,SnapshotVersion.forDeletedDoc())},Transaction.prototype.commit=function(){var _this=this,unwritten=this.readVersions;return this.mutations.forEach(function(mutation){unwritten=unwritten.remove(mutation.key)}),unwritten.isEmpty()?this.datastore.commit(this.mutations).then(function(){_this.committed=!0}):Promise.reject(Error('Every document read in a transaction must also be written.'))},Transaction}(),OnlineState;(function(OnlineState){OnlineState[OnlineState.Unknown=0]='Unknown',OnlineState[OnlineState.Online=1]='Online',OnlineState[OnlineState.Offline=2]='Offline'})(OnlineState||(OnlineState={}));var OnlineStateSource;(function(OnlineStateSource){OnlineStateSource[OnlineStateSource.RemoteStore=0]='RemoteStore',OnlineStateSource[OnlineStateSource.SharedClientState=1]='SharedClientState'})(OnlineStateSource||(OnlineStateSource={}));var MAX_WATCH_STREAM_FAILURES=1,ONLINE_STATE_TIMEOUT_MS=1e3*10,OnlineStateTracker=function(){function OnlineStateTracker(asyncQueue,onlineStateHandler){this.asyncQueue=asyncQueue,this.onlineStateHandler=onlineStateHandler,this.state=OnlineState.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return OnlineStateTracker.prototype.handleWatchStreamStart=function(){var _this=this;0===this.watchStreamFailures&&(this.setAndBroadcast(OnlineState.Unknown),assert(null===this.onlineStateTimer,'onlineStateTimer shouldn\'t be started yet'),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(TimerId.OnlineStateTimeout,ONLINE_STATE_TIMEOUT_MS,function(){return _this.onlineStateTimer=null,assert(_this.state===OnlineState.Unknown,'Timer should be canceled if we transitioned to a different state.'),_this.logClientOfflineWarningIfNecessary('Backend didn\'t respond within '+ONLINE_STATE_TIMEOUT_MS/1e3+' '+'seconds.'),_this.setAndBroadcast(OnlineState.Offline),Promise.resolve()}))},OnlineStateTracker.prototype.handleWatchStreamFailure=function(error$$1){this.state===OnlineState.Online?(this.setAndBroadcast(OnlineState.Unknown),assert(0===this.watchStreamFailures,'watchStreamFailures must be 0'),assert(null===this.onlineStateTimer,'onlineStateTimer must be null')):(this.watchStreamFailures++,this.watchStreamFailures>=MAX_WATCH_STREAM_FAILURES&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary('Connection failed '+MAX_WATCH_STREAM_FAILURES+' '+('times. Most recent error: '+error$$1.toString())),this.setAndBroadcast(OnlineState.Offline)))},OnlineStateTracker.prototype.set=function(newState){this.clearOnlineStateTimer(),this.watchStreamFailures=0,newState===OnlineState.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(newState)},OnlineStateTracker.prototype.setAndBroadcast=function(newState){newState!==this.state&&(this.state=newState,this.onlineStateHandler(newState))},OnlineStateTracker.prototype.logClientOfflineWarningIfNecessary=function(details){var message='Could not reach Cloud Firestore backend. '+details+'\n'+'This typically indicates that your device does not have a healthy '+'Internet connection at the moment. The client will operate in offline '+'mode until it is able to successfully connect to the backend.';this.shouldWarnClientIsOffline?(error(message),this.shouldWarnClientIsOffline=!1):debug('OnlineStateTracker',message)},OnlineStateTracker.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},OnlineStateTracker}(),LOG_TAG$8='RemoteStore',RemoteStore=function(){function RemoteStore(localStore,datastore,asyncQueue,onlineStateHandler){this.localStore=localStore,this.datastore=datastore,this.writePipeline=[],this.listenTargets={},this.watchChangeAggregator=null,this.networkEnabled=!1,this.isPrimary=!1,this.onlineStateTracker=new OnlineStateTracker(asyncQueue,onlineStateHandler),this.watchStream=this.datastore.newPersistentWatchStream({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.writeStream=this.datastore.newPersistentWriteStream({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})}return RemoteStore.prototype.start=function(){return this.enableNetwork()},RemoteStore.prototype.enableNetwork=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _a;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:return(this.networkEnabled=!0,!this.canUseNetwork())?[3,3]:(_a=this.writeStream,[4,this.localStore.getLastStreamToken()]);case 1:return _a.lastStreamToken=_b.sent(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(OnlineState.Unknown),[4,this.fillWritePipeline()];case 2:_b.sent(),_b.label=3;case 3:return[2];}})})},RemoteStore.prototype.disableNetwork=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Offline),[2];}})})},RemoteStore.prototype.disableNetworkInternal=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return[4,this.writeStream.stop()];case 1:return _a.sent(),[4,this.watchStream.stop()];case 2:return _a.sent(),0<this.writePipeline.length&&(debug(LOG_TAG$8,'Stopping write stream with '+this.writePipeline.length+' pending writes'),this.writePipeline=[]),this.cleanUpWatchStreamState(),[2];}})})},RemoteStore.prototype.shutdown=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return debug(LOG_TAG$8,'RemoteStore shutting down.'),this.networkEnabled=!1,[4,this.disableNetworkInternal()];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),[2];}})})},RemoteStore.prototype.listen=function(queryData){assert(!contains(this.listenTargets,queryData.targetId),'listen called with duplicate targetId!'),this.listenTargets[queryData.targetId]=queryData,this.shouldStartWatchStream()?this.startWatchStream():this.watchStream.isOpen()&&this.sendWatchRequest(queryData)},RemoteStore.prototype.unlisten=function(targetId){assert(contains(this.listenTargets,targetId),'unlisten called without assigned target ID!'),delete this.listenTargets[targetId],this.watchStream.isOpen()&&this.sendUnwatchRequest(targetId),isEmpty(this.listenTargets)&&(this.watchStream.isOpen()?this.watchStream.markIdle():this.canUseNetwork()&&this.onlineStateTracker.set(OnlineState.Unknown))},RemoteStore.prototype.getQueryDataForTarget=function(targetId){return this.listenTargets[targetId]||null},RemoteStore.prototype.getRemoteKeysForTarget=function(targetId){return this.syncEngine.getRemoteKeysForTarget(targetId)},RemoteStore.prototype.sendWatchRequest=function(queryData){this.watchChangeAggregator.recordPendingTargetRequest(queryData.targetId),this.watchStream.watch(queryData)},RemoteStore.prototype.sendUnwatchRequest=function(targetId){this.watchChangeAggregator.recordPendingTargetRequest(targetId),this.watchStream.unwatch(targetId)},RemoteStore.prototype.startWatchStream=function(){assert(this.shouldStartWatchStream(),'startWatchStream() called when shouldStartWatchStream() is false.'),this.watchChangeAggregator=new WatchChangeAggregator(this),this.watchStream.start(),this.onlineStateTracker.handleWatchStreamStart()},RemoteStore.prototype.shouldStartWatchStream=function(){return this.canUseNetwork()&&!this.watchStream.isStarted()&&!isEmpty(this.listenTargets)},RemoteStore.prototype.canUseNetwork=function(){return this.isPrimary&&this.networkEnabled},RemoteStore.prototype.cleanUpWatchStreamState=function(){this.watchChangeAggregator=null},RemoteStore.prototype.onWatchStreamOpen=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(){return forEachNumber(this.listenTargets,function(targetId,queryData){_this.sendWatchRequest(queryData)}),[2]})})},RemoteStore.prototype.onWatchStreamClose=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return void 0===error$$1&&assert(!this.shouldStartWatchStream(),'Watch stream was stopped gracefully while still needed.'),this.cleanUpWatchStreamState(),this.shouldStartWatchStream()?(this.onlineStateTracker.handleWatchStreamFailure(error$$1),this.startWatchStream()):this.onlineStateTracker.set(OnlineState.Unknown),[2]})})},RemoteStore.prototype.onWatchStreamChange=function(watchChange,snapshotVersion){return tslib_1.__awaiter(this,void 0,void 0,function(){var lastRemoteSnapshotVersion;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.onlineStateTracker.set(OnlineState.Online),watchChange instanceof WatchTargetChange&&watchChange.state===WatchTargetChangeState.Removed&&watchChange.cause)?[2,this.handleTargetError(watchChange)]:(watchChange instanceof DocumentWatchChange?this.watchChangeAggregator.handleDocumentChange(watchChange):watchChange instanceof ExistenceFilterChange?this.watchChangeAggregator.handleExistenceFilter(watchChange):(assert(watchChange instanceof WatchTargetChange,'Expected watchChange to be an instance of WatchTargetChange'),this.watchChangeAggregator.handleTargetChange(watchChange)),snapshotVersion.isEqual(SnapshotVersion.MIN)?[3,3]:[4,this.localStore.getLastRemoteSnapshotVersion()]);case 1:return lastRemoteSnapshotVersion=_a.sent(),0<=snapshotVersion.compareTo(lastRemoteSnapshotVersion)?[4,this.raiseWatchSnapshot(snapshotVersion)]:[3,3];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},RemoteStore.prototype.raiseWatchSnapshot=function(snapshotVersion){var _this=this;assert(!snapshotVersion.isEqual(SnapshotVersion.MIN),'Can\'t raise event for unknown SnapshotVersion');var remoteEvent=this.watchChangeAggregator.createRemoteEvent(snapshotVersion);return forEachNumber(remoteEvent.targetChanges,function(targetId,change){if(0<change.resumeToken.length){var queryData=_this.listenTargets[targetId];queryData&&(_this.listenTargets[targetId]=queryData.copy({resumeToken:change.resumeToken,snapshotVersion:snapshotVersion}))}}),remoteEvent.targetMismatches.forEach(function(targetId){var queryData=_this.listenTargets[targetId];if(queryData){_this.listenTargets[targetId]=queryData.copy({resumeToken:emptyByteString()}),_this.sendUnwatchRequest(targetId);var requestQueryData=new QueryData(queryData.query,targetId,QueryPurpose.ExistenceFilterMismatch,queryData.sequenceNumber);_this.sendWatchRequest(requestQueryData)}}),this.syncEngine.applyRemoteEvent(remoteEvent)},RemoteStore.prototype.handleTargetError=function(watchChange){var _this=this;assert(!!watchChange.cause,'Handling target error without a cause');var error$$1=watchChange.cause,promiseChain=Promise.resolve();return watchChange.targetIds.forEach(function(targetId){promiseChain=promiseChain.then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return contains(this.listenTargets,targetId)?(delete this.listenTargets[targetId],this.watchChangeAggregator.removeTarget(targetId),[2,this.syncEngine.rejectListen(targetId,error$$1)]):[2]})})})}),promiseChain},RemoteStore.prototype.fillWritePipeline=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var lastBatchIdRetrieved,batch;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.canAddToWritePipeline()?(lastBatchIdRetrieved=0<this.writePipeline.length?this.writePipeline[this.writePipeline.length-1].batchId:BATCHID_UNKNOWN,[4,this.localStore.nextMutationBatch(lastBatchIdRetrieved)]):[3,4];case 1:return(batch=_a.sent(),null!==batch)?[3,2]:(0===this.writePipeline.length&&this.writeStream.markIdle(),[3,4]);case 2:return this.addToWritePipeline(batch),[4,this.fillWritePipeline()];case 3:_a.sent(),_a.label=4;case 4:return this.shouldStartWriteStream()&&this.startWriteStream(),[2];}})})},RemoteStore.prototype.canAddToWritePipeline=function(){return this.canUseNetwork()&&this.writePipeline.length<10},RemoteStore.prototype.outstandingWrites=function(){return this.writePipeline.length},RemoteStore.prototype.addToWritePipeline=function(batch){assert(this.canAddToWritePipeline(),'addToWritePipeline called when pipeline is full'),this.writePipeline.push(batch),this.writeStream.isOpen()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(batch.mutations)},RemoteStore.prototype.shouldStartWriteStream=function(){return this.canUseNetwork()&&!this.writeStream.isStarted()&&0<this.writePipeline.length},RemoteStore.prototype.startWriteStream=function(){assert(this.shouldStartWriteStream(),'startWriteStream() called when shouldStartWriteStream() is false.'),this.writeStream.start()},RemoteStore.prototype.onWriteStreamOpen=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.writeStream.writeHandshake(),[2]})})},RemoteStore.prototype.onWriteHandshakeComplete=function(){var _this=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var _i=0,_a=_this.writePipeline,batch;_i<_a.length;_i++)batch=_a[_i],_this.writeStream.writeMutations(batch.mutations)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},RemoteStore.prototype.ignoreIfPrimaryLeaseLoss=function(err){if(isPrimaryLeaseLostError(err))debug(LOG_TAG$8,'Unexpectedly lost primary lease');else throw err},RemoteStore.prototype.onMutationResult=function(commitVersion,results){var _this=this;assert(0<this.writePipeline.length,'Got result for empty write pipeline');var batch=this.writePipeline.shift(),success=MutationBatchResult.from(batch,commitVersion,results,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(success).then(function(){return _this.fillWritePipeline()})},RemoteStore.prototype.onWriteStreamClose=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,errorHandling;return tslib_1.__generator(this,function(){return void 0===error$$1&&assert(!this.shouldStartWriteStream(),'Write stream was stopped gracefully while still needed.'),error$$1&&0<this.writePipeline.length?(errorHandling=void 0,errorHandling=this.writeStream.handshakeComplete?this.handleWriteError(error$$1):this.handleHandshakeError(error$$1),[2,errorHandling.then(function(){_this.shouldStartWriteStream()&&_this.startWriteStream()})]):[2]})})},RemoteStore.prototype.handleHandshakeError=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this;return tslib_1.__generator(this,function(){return isPermanentError(error$$1.code)||error$$1.code===Code.ABORTED?(debug(LOG_TAG$8,'RemoteStore error before completed handshake; resetting stream token: ',this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=emptyByteString(),[2,this.localStore.setLastStreamToken(emptyByteString()).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]):[2]})})},RemoteStore.prototype.handleWriteError=function(error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,batch;return tslib_1.__generator(this,function(){return isPermanentError(error$$1.code)?(batch=this.writePipeline.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(batch.batchId,error$$1).then(function(){return _this.fillWritePipeline()})]):[2]})})},RemoteStore.prototype.createTransaction=function(){return new Transaction(this.datastore)},RemoteStore.prototype.handleCredentialChange=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.canUseNetwork()?(debug(LOG_TAG$8,'RemoteStore restarting streams for new credential'),this.networkEnabled=!1,[4,this.disableNetworkInternal()]):[3,3];case 1:return _a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),[4,this.enableNetwork()];case 2:_a.sent(),_a.label=3;case 3:return[2];}})})},RemoteStore.prototype.applyPrimaryState=function(isPrimary){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.isPrimary=isPrimary,isPrimary&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return _a.sent(),[3,4];case 2:return isPrimary?[3,4]:[4,this.disableNetworkInternal()];case 3:_a.sent(),this.onlineStateTracker.set(OnlineState.Unknown),_a.label=4;case 4:return[2];}})})},RemoteStore}(),QueryListenersInfo=function(){return function QueryListenersInfo(){this.listeners=[]}}(),EventManager=function(){function EventManager(syncEngine){this.syncEngine=syncEngine,this.queries=new ObjectMap(function(q){return q.canonicalId()}),this.onlineState=OnlineState.Unknown,this.syncEngine.subscribe(this)}return EventManager.prototype.listen=function(listener){var query=listener.query,firstListen=!1,queryInfo=this.queries.get(query);return queryInfo||(firstListen=!0,queryInfo=new QueryListenersInfo,this.queries.set(query,queryInfo)),queryInfo.listeners.push(listener),listener.applyOnlineStateChange(this.onlineState),queryInfo.viewSnap&&listener.onViewSnapshot(queryInfo.viewSnap),firstListen?this.syncEngine.listen(query).then(function(targetId){return queryInfo.targetId=targetId,targetId}):Promise.resolve(queryInfo.targetId)},EventManager.prototype.unlisten=function(listener){return tslib_1.__awaiter(this,void 0,void 0,function(){var query,lastListen,queryInfo,i;return tslib_1.__generator(this,function(){return query=listener.query,lastListen=!1,queryInfo=this.queries.get(query),queryInfo&&(i=queryInfo.listeners.indexOf(listener),0<=i&&(queryInfo.listeners.splice(i,1),lastListen=0===queryInfo.listeners.length)),lastListen?(this.queries.delete(query),[2,this.syncEngine.unlisten(query)]):[2]})})},EventManager.prototype.onWatchChange=function(viewSnaps){for(var _i=0,viewSnaps_1=viewSnaps;_i<viewSnaps_1.length;_i++){var viewSnap=viewSnaps_1[_i],query=viewSnap.query,queryInfo=this.queries.get(query);if(queryInfo){for(var _a=0,_b=queryInfo.listeners,listener;_a<_b.length;_a++)listener=_b[_a],listener.onViewSnapshot(viewSnap);queryInfo.viewSnap=viewSnap}}},EventManager.prototype.onWatchError=function(query,error){var queryInfo=this.queries.get(query);if(queryInfo)for(var _i=0,_a=queryInfo.listeners,listener;_i<_a.length;_i++)listener=_a[_i],listener.onError(error);this.queries.delete(query)},EventManager.prototype.onOnlineStateChange=function(onlineState){this.onlineState=onlineState,this.queries.forEach(function(_,queryInfo){for(var _i=0,_a=queryInfo.listeners,listener;_i<_a.length;_i++)listener=_a[_i],listener.applyOnlineStateChange(onlineState)})},EventManager}(),QueryListener=function(){function QueryListener(query,queryObserver,options){this.query=query,this.queryObserver=queryObserver,this.raisedInitialEvent=!1,this.onlineState=OnlineState.Unknown,this.options=options||{}}return QueryListener.prototype.onViewSnapshot=function(snap){if(assert(0<snap.docChanges.length||snap.syncStateChanged,'We got a new snapshot with no changes?'),!this.options.includeMetadataChanges){for(var docChanges=[],_i=0,_a=snap.docChanges,docChange;_i<_a.length;_i++)docChange=_a[_i],docChange.type!==ChangeType.Metadata&&docChanges.push(docChange);snap=new ViewSnapshot(snap.query,snap.docs,snap.oldDocs,docChanges,snap.mutatedKeys,snap.fromCache,snap.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(snap)&&this.queryObserver.next(snap):this.shouldRaiseInitialEvent(snap,this.onlineState)&&this.raiseInitialEvent(snap),this.snap=snap},QueryListener.prototype.onError=function(error){this.queryObserver.error(error)},QueryListener.prototype.applyOnlineStateChange=function(onlineState){this.onlineState=onlineState,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,onlineState)&&this.raiseInitialEvent(this.snap)},QueryListener.prototype.shouldRaiseInitialEvent=function(snap,onlineState){if(assert(!this.raisedInitialEvent,'Determining whether to raise first event but already had first event'),!snap.fromCache)return!0;var maybeOnline=onlineState!==OnlineState.Offline;return this.options.waitForSyncWhenOnline&&maybeOnline?(assert(snap.fromCache,'Waiting for sync, but snapshot is not from cache'),!1):!snap.docs.isEmpty()||onlineState===OnlineState.Offline},QueryListener.prototype.shouldRaiseEvent=function(snap){if(0<snap.docChanges.length)return!0;var hasPendingWritesChanged=this.snap&&this.snap.hasPendingWrites!==snap.hasPendingWrites;return(snap.syncStateChanged||hasPendingWritesChanged)&&!0===this.options.includeMetadataChanges},QueryListener.prototype.raiseInitialEvent=function(snap){assert(!this.raisedInitialEvent,'Trying to raise initial events for second time'),snap=ViewSnapshot.fromInitialDocuments(snap.query,snap.docs,snap.mutatedKeys,snap.fromCache),this.raisedInitialEvent=!0,this.queryObserver.next(snap)},QueryListener}(),LocalViewChanges=function(){function LocalViewChanges(targetId,addedKeys,removedKeys){this.targetId=targetId,this.addedKeys=addedKeys,this.removedKeys=removedKeys}return LocalViewChanges.fromSnapshot=function(targetId,viewSnapshot){for(var addedKeys=documentKeySet(),removedKeys=documentKeySet(),_i=0,_a=viewSnapshot.docChanges,docChange;_i<_a.length;_i++)switch(docChange=_a[_i],docChange.type){case ChangeType.Added:addedKeys=addedKeys.add(docChange.doc.key);break;case ChangeType.Removed:removedKeys=removedKeys.add(docChange.doc.key);break;default:}return new LocalViewChanges(targetId,addedKeys,removedKeys)},LocalViewChanges}(),AddedLimboDocument=function(){return function AddedLimboDocument(key){this.key=key}}(),RemovedLimboDocument=function(){return function RemovedLimboDocument(key){this.key=key}}(),View=function(){function View(query,_syncedDocuments){this.query=query,this._syncedDocuments=_syncedDocuments,this.syncState=null,this.current=!1,this.limboDocuments=documentKeySet(),this.mutatedKeys=documentKeySet(),this.documentSet=new DocumentSet(query.docComparator.bind(query))}return Object.defineProperty(View.prototype,'syncedDocuments',{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),View.prototype.computeDocChanges=function(docChanges,previousChanges){var _this=this,changeSet=previousChanges?previousChanges.changeSet:new DocumentChangeSet,oldDocumentSet=previousChanges?previousChanges.documentSet:this.documentSet,newMutatedKeys=previousChanges?previousChanges.mutatedKeys:this.mutatedKeys,newDocumentSet=oldDocumentSet,needsRefill=!1,lastDocInLimit=this.query.hasLimit()&&oldDocumentSet.size===this.query.limit?oldDocumentSet.last():null;if(docChanges.inorderTraversal(function(key,newMaybeDoc){var oldDoc=oldDocumentSet.get(key),newDoc=newMaybeDoc instanceof Document?newMaybeDoc:null;newDoc&&(assert(key.isEqual(newDoc.key),'Mismatching keys found in document changes: '+key+' != '+newDoc.key),newDoc=_this.query.matches(newDoc)?newDoc:null);var oldDocHadPendingMutations=!!oldDoc&&_this.mutatedKeys.has(oldDoc.key),newDocHasPendingMutations=!!newDoc&&(newDoc.hasLocalMutations||_this.mutatedKeys.has(newDoc.key)&&newDoc.hasCommittedMutations),changeApplied=!1;if(oldDoc&&newDoc){var docsEqual=oldDoc.data.isEqual(newDoc.data);docsEqual?oldDocHadPendingMutations!==newDocHasPendingMutations&&(changeSet.track({type:ChangeType.Metadata,doc:newDoc}),changeApplied=!0):!_this.shouldWaitForSyncedDocument(oldDoc,newDoc)&&(changeSet.track({type:ChangeType.Modified,doc:newDoc}),changeApplied=!0,lastDocInLimit&&0<_this.query.docComparator(newDoc,lastDocInLimit)&&(needsRefill=!0))}else!oldDoc&&newDoc?(changeSet.track({type:ChangeType.Added,doc:newDoc}),changeApplied=!0):oldDoc&&!newDoc&&(changeSet.track({type:ChangeType.Removed,doc:oldDoc}),changeApplied=!0,lastDocInLimit&&(needsRefill=!0));changeApplied&&(newDoc?(newDocumentSet=newDocumentSet.add(newDoc),newMutatedKeys=newDocHasPendingMutations?newMutatedKeys.add(key):newMutatedKeys.delete(key)):(newDocumentSet=newDocumentSet.delete(key),newMutatedKeys=newMutatedKeys.delete(key)))}),this.query.hasLimit())for(;newDocumentSet.size>this.query.limit;){var oldDoc=newDocumentSet.last();newDocumentSet=newDocumentSet.delete(oldDoc.key),newMutatedKeys=newMutatedKeys.delete(oldDoc.key),changeSet.track({type:ChangeType.Removed,doc:oldDoc})}return assert(!needsRefill||!previousChanges,'View was refilled using docs that themselves needed refilling.'),{documentSet:newDocumentSet,changeSet:changeSet,needsRefill:needsRefill,mutatedKeys:newMutatedKeys}},View.prototype.shouldWaitForSyncedDocument=function(oldDoc,newDoc){return oldDoc.hasLocalMutations&&newDoc.hasCommittedMutations&&!newDoc.hasLocalMutations},View.prototype.applyChanges=function(docChanges,updateLimboDocuments,targetChange){var _this=this;assert(!docChanges.needsRefill,'Cannot apply changes that need a refill');var oldDocs=this.documentSet;this.documentSet=docChanges.documentSet,this.mutatedKeys=docChanges.mutatedKeys;var changes=docChanges.changeSet.getChanges();changes.sort(function(c1,c2){return compareChangeType(c1.type,c2.type)||_this.query.docComparator(c1.doc,c2.doc)}),this.applyTargetChange(targetChange);var limboChanges=updateLimboDocuments?this.updateLimboDocuments():[],synced=0===this.limboDocuments.size&&this.current,newSyncState=synced?SyncState.Synced:SyncState.Local,syncStateChanged=newSyncState!==this.syncState;if(this.syncState=newSyncState,0===changes.length&&!syncStateChanged)return{limboChanges:limboChanges};var snap=new ViewSnapshot(this.query,docChanges.documentSet,oldDocs,changes,docChanges.mutatedKeys,newSyncState===SyncState.Local,syncStateChanged,!1);return{snapshot:snap,limboChanges:limboChanges}},View.prototype.applyOnlineStateChange=function(onlineState){return this.current&&onlineState===OnlineState.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new DocumentChangeSet,mutatedKeys:this.mutatedKeys,needsRefill:!1},!1)):{limboChanges:[]}},View.prototype.shouldBeInLimbo=function(key){return!this._syncedDocuments.has(key)&&!!this.documentSet.has(key)&&!this.documentSet.get(key).hasLocalMutations},View.prototype.applyTargetChange=function(targetChange){var _this=this;targetChange&&(targetChange.addedDocuments.forEach(function(key){return _this._syncedDocuments=_this._syncedDocuments.add(key)}),targetChange.modifiedDocuments.forEach(function(key){return assert(_this._syncedDocuments.has(key),'Modified document '+key+' not found in view.')}),targetChange.removedDocuments.forEach(function(key){return _this._syncedDocuments=_this._syncedDocuments.delete(key)}),this.current=targetChange.current)},View.prototype.updateLimboDocuments=function(){var _this=this;if(!this.current)return[];var oldLimboDocuments=this.limboDocuments;this.limboDocuments=documentKeySet(),this.documentSet.forEach(function(doc){_this.shouldBeInLimbo(doc.key)&&(_this.limboDocuments=_this.limboDocuments.add(doc.key))});var changes=[];return oldLimboDocuments.forEach(function(key){_this.limboDocuments.has(key)||changes.push(new RemovedLimboDocument(key))}),this.limboDocuments.forEach(function(key){oldLimboDocuments.has(key)||changes.push(new AddedLimboDocument(key))}),changes},View.prototype.synchronizeWithPersistedState=function(localDocs,remoteKeys){this._syncedDocuments=remoteKeys,this.limboDocuments=documentKeySet();var docChanges=this.computeDocChanges(localDocs);return this.applyChanges(docChanges,!0)},View.prototype.computeInitialSnapshot=function(){return ViewSnapshot.fromInitialDocuments(this.query,this.documentSet,this.mutatedKeys,this.syncState===SyncState.Local)},View}(),LOG_TAG$9='SyncEngine',QueryView=function(){return function QueryView(query,targetId,view){this.query=query,this.targetId=targetId,this.view=view}}(),LimboResolution=function(){return function LimboResolution(key){this.key=key}}(),SyncEngine=function(){function SyncEngine(localStore,remoteStore,sharedClientState,currentUser){this.localStore=localStore,this.remoteStore=remoteStore,this.sharedClientState=sharedClientState,this.currentUser=currentUser,this.syncEngineListener=null,this.queryViewsByQuery=new ObjectMap(function(q){return q.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new SortedMap(DocumentKey.comparator),this.limboResolutionsByTarget={},this.limboDocumentRefs=new ReferenceSet,this.mutationUserCallbacks={},this.limboTargetIdGenerator=TargetIdGenerator.forSyncEngine(),this.isPrimary=void 0,this.onlineState=OnlineState.Unknown}return Object.defineProperty(SyncEngine.prototype,'isPrimaryClient',{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),SyncEngine.prototype.subscribe=function(syncEngineListener){assert(null!==syncEngineListener,'SyncEngine listener cannot be null'),assert(null===this.syncEngineListener,'SyncEngine already has a subscriber.'),this.syncEngineListener=syncEngineListener},SyncEngine.prototype.listen=function(query){return tslib_1.__awaiter(this,void 0,void 0,function(){var targetId,viewSnapshot,queryView,queryData,status_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('listen()'),queryView=this.queryViewsByQuery.get(query),!queryView)?[3,1]:(targetId=queryView.targetId,this.sharedClientState.addLocalQueryTarget(targetId),viewSnapshot=queryView.view.computeInitialSnapshot(),[3,4]);case 1:return[4,this.localStore.allocateQuery(query)];case 2:return queryData=_a.sent(),status_1=this.sharedClientState.addLocalQueryTarget(queryData.targetId),targetId=queryData.targetId,[4,this.initializeViewAndComputeSnapshot(queryData,'current'===status_1)];case 3:viewSnapshot=_a.sent(),this.isPrimary&&this.remoteStore.listen(queryData),_a.label=4;case 4:return this.syncEngineListener.onWatchChange([viewSnapshot]),[2,targetId];}})})},SyncEngine.prototype.initializeViewAndComputeSnapshot=function(queryData,current){var _this=this,query=queryData.query;return this.localStore.executeQuery(query).then(function(docs){return _this.localStore.remoteDocumentKeys(queryData.targetId).then(function(remoteKeys){var view=new View(query,remoteKeys),viewDocChanges=view.computeDocChanges(docs),synthesizedTargetChange=TargetChange.createSynthesizedTargetChangeForCurrentChange(queryData.targetId,current&&_this.onlineState!==OnlineState.Offline),viewChange=view.applyChanges(viewDocChanges,!0===_this.isPrimary,synthesizedTargetChange);assert(0===viewChange.limboChanges.length,'View returned limbo docs before target ack from the server.'),assert(!!viewChange.snapshot,'applyChanges for new view should always return a snapshot');var data=new QueryView(query,queryData.targetId,view);return _this.queryViewsByQuery.set(query,data),_this.queryViewsByTarget[queryData.targetId]=data,viewChange.snapshot})})},SyncEngine.prototype.synchronizeViewAndComputeSnapshot=function(queryView){var _this=this;return this.localStore.executeQuery(queryView.query).then(function(docs){return _this.localStore.remoteDocumentKeys(queryView.targetId).then(function(remoteKeys){return tslib_1.__awaiter(_this,void 0,void 0,function(){var viewSnapshot;return tslib_1.__generator(this,function(){return viewSnapshot=queryView.view.synchronizeWithPersistedState(docs,remoteKeys),this.isPrimary&&this.updateTrackedLimbos(queryView.targetId,viewSnapshot.limboChanges),[2,viewSnapshot]})})})})},SyncEngine.prototype.unlisten=function(query){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,queryView,targetRemainsActive;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('unlisten()'),queryView=this.queryViewsByQuery.get(query),assert(!!queryView,'Trying to unlisten on query not found:'+query),!this.isPrimary)?[3,3]:(this.sharedClientState.removeLocalQueryTarget(queryView.targetId),targetRemainsActive=this.sharedClientState.isActiveQueryTarget(queryView.targetId),targetRemainsActive?[3,2]:[4,this.localStore.releaseQuery(query,!1).then(function(){_this.sharedClientState.clearQueryState(queryView.targetId),_this.remoteStore.unlisten(queryView.targetId),_this.removeAndCleanupQuery(queryView)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]);case 1:_a.sent(),_a.label=2;case 2:return[3,5];case 3:return this.removeAndCleanupQuery(queryView),[4,this.localStore.releaseQuery(query,!0)];case 4:_a.sent(),_a.label=5;case 5:return[2];}})})},SyncEngine.prototype.write=function(batch,userCallback){var _this=this;return this.assertSubscribed('write()'),this.localStore.localWrite(batch).then(function(result){return _this.sharedClientState.addPendingMutation(result.batchId),_this.addMutationCallback(result.batchId,userCallback),_this.emitNewSnapsAndNotifyLocalStore(result.changes)}).then(function(){return _this.remoteStore.fillWritePipeline()})},SyncEngine.prototype.wrapUpdateFunctionError=function(error$$1){return error$$1},SyncEngine.prototype.runTransaction=function(updateFunction,retries){var _this=this;void 0===retries&&(retries=5),assert(0<=retries,'Got negative number of retries for transaction.');var transaction=this.remoteStore.createTransaction();return function(){try{var userPromise=updateFunction(transaction);return!isNullOrUndefined(userPromise)&&userPromise.catch&&userPromise.then?userPromise.catch(function(e){return Promise.reject(_this.wrapUpdateFunctionError(e))}):Promise.reject(Error('Transaction callback must return a Promise'))}catch(e){return Promise.reject(_this.wrapUpdateFunctionError(e))}}().then(function(result){return transaction.commit().then(function(){return result}).catch(function(error$$1){return 0===retries?Promise.reject(error$$1):_this.runTransaction(updateFunction,retries-1)})})},SyncEngine.prototype.applyRemoteEvent=function(remoteEvent){var _this=this;return this.assertSubscribed('applyRemoteEvent()'),this.localStore.applyRemoteEvent(remoteEvent).then(function(changes){return forEach(remoteEvent.targetChanges,function(targetId,targetChange){var limboResolution=_this.limboResolutionsByTarget[targetId];limboResolution&&(assert(1>=targetChange.addedDocuments.size+targetChange.modifiedDocuments.size+targetChange.removedDocuments.size,'Limbo resolution for single document contains multiple changes.'),0<targetChange.addedDocuments.size?limboResolution.receivedDocument=!0:0<targetChange.modifiedDocuments.size?assert(limboResolution.receivedDocument,'Received change for limbo target document without add.'):0<targetChange.removedDocuments.size&&(assert(limboResolution.receivedDocument,'Received remove for limbo target document without add.'),limboResolution.receivedDocument=!1))}),_this.emitNewSnapsAndNotifyLocalStore(changes,remoteEvent)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.applyOnlineStateChange=function(onlineState,source){if(this.isPrimary&&source===OnlineStateSource.RemoteStore||!this.isPrimary&&source===OnlineStateSource.SharedClientState){var newViewSnapshots_1=[];this.queryViewsByQuery.forEach(function(query,queryView){var viewChange=queryView.view.applyOnlineStateChange(onlineState);assert(0===viewChange.limboChanges.length,'OnlineState should not affect limbo documents.'),viewChange.snapshot&&newViewSnapshots_1.push(viewChange.snapshot)}),this.syncEngineListener.onOnlineStateChange(onlineState),this.syncEngineListener.onWatchChange(newViewSnapshots_1),this.onlineState=onlineState,this.isPrimary&&this.sharedClientState.setOnlineState(onlineState)}},SyncEngine.prototype.rejectListen=function(targetId,err){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,limboResolution,limboKey,documentUpdates,resolvedLimboDocuments,event_1,queryView_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return(this.assertSubscribed('rejectListens()'),this.sharedClientState.updateQueryState(targetId,'rejected',err),limboResolution=this.limboResolutionsByTarget[targetId],limboKey=limboResolution&&limboResolution.key,!limboKey)?[3,1]:(this.limboTargetsByKey=this.limboTargetsByKey.remove(limboKey),delete this.limboResolutionsByTarget[targetId],documentUpdates=new SortedMap(DocumentKey.comparator),documentUpdates=documentUpdates.insert(limboKey,new NoDocument(limboKey,SnapshotVersion.forDeletedDoc())),resolvedLimboDocuments=documentKeySet().add(limboKey),event_1=new RemoteEvent(SnapshotVersion.MIN,{},new SortedSet(primitiveComparator),documentUpdates,resolvedLimboDocuments),[2,this.applyRemoteEvent(event_1)]);case 1:return queryView_1=this.queryViewsByTarget[targetId],assert(!!queryView_1,'Unknown targetId: '+targetId),[4,this.localStore.releaseQuery(queryView_1.query,!1).then(function(){return _this.removeAndCleanupQuery(queryView_1)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})];case 2:_a.sent(),this.syncEngineListener.onWatchError(queryView_1.query,err),_a.label=3;case 3:return[2];}})})},SyncEngine.prototype.applyBatchState=function(batchId,batchState,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var documents;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.assertSubscribed('applyBatchState()'),[4,this.localStore.lookupMutationDocuments(batchId)];case 1:return documents=_a.sent(),null===documents?(debug(LOG_TAG$9,'Cannot apply mutation batch with id: '+batchId),[2]):'pending'===batchState?[4,this.remoteStore.fillWritePipeline()]:[3,3];case 2:return _a.sent(),[3,4];case 3:'acknowledged'===batchState||'rejected'===batchState?(this.processUserCallback(batchId,error$$1?error$$1:null),this.localStore.removeCachedMutationBatchMetadata(batchId)):fail('Unknown batchState: '+batchState),_a.label=4;case 4:return[4,this.emitNewSnapsAndNotifyLocalStore(documents)];case 5:return _a.sent(),[2];}})})},SyncEngine.prototype.applySuccessfulWrite=function(mutationBatchResult){var _this=this;this.assertSubscribed('applySuccessfulWrite()');var batchId=mutationBatchResult.batch.batchId;return this.processUserCallback(batchId,null),this.localStore.acknowledgeBatch(mutationBatchResult).then(function(changes){return _this.sharedClientState.updateMutationState(batchId,'acknowledged'),_this.emitNewSnapsAndNotifyLocalStore(changes)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.rejectFailedWrite=function(batchId,error$$1){var _this=this;return this.assertSubscribed('rejectFailedWrite()'),this.processUserCallback(batchId,error$$1),this.localStore.rejectBatch(batchId).then(function(changes){return _this.sharedClientState.updateMutationState(batchId,'rejected',error$$1),_this.emitNewSnapsAndNotifyLocalStore(changes)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})},SyncEngine.prototype.addMutationCallback=function(batchId,callback){var newCallbacks=this.mutationUserCallbacks[this.currentUser.toKey()];newCallbacks||(newCallbacks=new SortedMap(primitiveComparator)),newCallbacks=newCallbacks.insert(batchId,callback),this.mutationUserCallbacks[this.currentUser.toKey()]=newCallbacks},SyncEngine.prototype.processUserCallback=function(batchId,error$$1){var newCallbacks=this.mutationUserCallbacks[this.currentUser.toKey()];if(newCallbacks){var callback=newCallbacks.get(batchId);callback&&(assert(batchId===newCallbacks.minKey(),'Mutation callbacks processed out-of-order?'),error$$1?callback.reject(error$$1):callback.resolve(),newCallbacks=newCallbacks.remove(batchId)),this.mutationUserCallbacks[this.currentUser.toKey()]=newCallbacks}},SyncEngine.prototype.removeAndCleanupQuery=function(queryView){var _this=this;if(this.sharedClientState.removeLocalQueryTarget(queryView.targetId),this.queryViewsByQuery.delete(queryView.query),delete this.queryViewsByTarget[queryView.targetId],this.isPrimary){var limboKeys=this.limboDocumentRefs.referencesForId(queryView.targetId);this.limboDocumentRefs.removeReferencesForId(queryView.targetId),limboKeys.forEach(function(limboKey){var isReferenced=_this.limboDocumentRefs.containsKey(limboKey);isReferenced||_this.removeLimboTarget(limboKey)})}},SyncEngine.prototype.removeLimboTarget=function(key){var limboTargetId=this.limboTargetsByKey.get(key);null===limboTargetId||(this.remoteStore.unlisten(limboTargetId),this.limboTargetsByKey=this.limboTargetsByKey.remove(key),delete this.limboResolutionsByTarget[limboTargetId])},SyncEngine.prototype.updateTrackedLimbos=function(targetId,limboChanges){for(var _i=0,limboChanges_1=limboChanges,limboChange;_i<limboChanges_1.length;_i++)if(limboChange=limboChanges_1[_i],limboChange instanceof AddedLimboDocument)this.limboDocumentRefs.addReference(limboChange.key,targetId),this.trackLimboChange(limboChange);else if(limboChange instanceof RemovedLimboDocument){debug(LOG_TAG$9,'Document no longer in limbo: '+limboChange.key),this.limboDocumentRefs.removeReference(limboChange.key,targetId);var isReferenced=this.limboDocumentRefs.containsKey(limboChange.key);isReferenced||this.removeLimboTarget(limboChange.key)}else fail('Unknown limbo change: '+JSON.stringify(limboChange))},SyncEngine.prototype.trackLimboChange=function(limboChange){var key=limboChange.key;if(!this.limboTargetsByKey.get(key)){debug(LOG_TAG$9,'New document in limbo: '+key);var limboTargetId=this.limboTargetIdGenerator.next(),query=Query.atPath(key.path);this.limboResolutionsByTarget[limboTargetId]=new LimboResolution(key),this.remoteStore.listen(new QueryData(query,limboTargetId,QueryPurpose.LimboResolution,ListenSequence.INVALID)),this.limboTargetsByKey=this.limboTargetsByKey.insert(key,limboTargetId)}},SyncEngine.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},SyncEngine.prototype.emitNewSnapsAndNotifyLocalStore=function(changes,remoteEvent){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,newSnaps,docChangesInAllViews,queriesProcessed;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return newSnaps=[],docChangesInAllViews=[],queriesProcessed=[],this.queryViewsByQuery.forEach(function(_,queryView){queriesProcessed.push(Promise.resolve().then(function(){var viewDocChanges=queryView.view.computeDocChanges(changes);return viewDocChanges.needsRefill?_this.localStore.executeQuery(queryView.query).then(function(docs){return queryView.view.computeDocChanges(docs,viewDocChanges)}):viewDocChanges}).then(function(viewDocChanges){var targetChange=remoteEvent&&remoteEvent.targetChanges[queryView.targetId],viewChange=queryView.view.applyChanges(viewDocChanges,!0===_this.isPrimary,targetChange);if(_this.updateTrackedLimbos(queryView.targetId,viewChange.limboChanges),viewChange.snapshot){_this.isPrimary&&_this.sharedClientState.updateQueryState(queryView.targetId,viewChange.snapshot.fromCache?'not-current':'current'),newSnaps.push(viewChange.snapshot);var docChanges=LocalViewChanges.fromSnapshot(queryView.targetId,viewChange.snapshot);docChangesInAllViews.push(docChanges)}}))}),[4,Promise.all(queriesProcessed)];case 1:return _a.sent(),this.syncEngineListener.onWatchChange(newSnaps),[4,this.localStore.notifyLocalViewChanges(docChangesInAllViews)];case 2:return _a.sent(),[2];}})})},SyncEngine.prototype.ignoreIfPrimaryLeaseLoss=function(err){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){if(isPrimaryLeaseLostError(err))debug(LOG_TAG$9,'Unexpectedly lost primary lease');else throw err;return[2]})})},SyncEngine.prototype.assertSubscribed=function(fnName){assert(null!==this.syncEngineListener,'Trying to call '+fnName+' before calling subscribe().')},SyncEngine.prototype.handleCredentialChange=function(user){return tslib_1.__awaiter(this,void 0,void 0,function(){var userChanged,result;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return userChanged=!this.currentUser.isEqual(user),this.currentUser=user,userChanged?[4,this.localStore.handleUserChange(user)]:[3,3];case 1:return result=_a.sent(),this.sharedClientState.handleUserChange(user,result.removedBatchIds,result.addedBatchIds),[4,this.emitNewSnapsAndNotifyLocalStore(result.affectedDocuments)];case 2:_a.sent(),_a.label=3;case 3:return[4,this.remoteStore.handleCredentialChange()];case 4:return _a.sent(),[2];}})})},SyncEngine.prototype.applyPrimaryState=function(isPrimary){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,activeTargets,activeQueries,_i,activeQueries_1,queryData,activeTargets_1,p_1;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return!0!==isPrimary||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.remoteStore.applyPrimaryState(!0)]);case 1:return _a.sent(),activeTargets=this.sharedClientState.getAllActiveQueryTargets(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets.toArray())];case 2:for(activeQueries=_a.sent(),_i=0,activeQueries_1=activeQueries;_i<activeQueries_1.length;_i++)queryData=activeQueries_1[_i],this.remoteStore.listen(queryData);return[3,7];case 3:return!1!==isPrimary||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,activeTargets_1=[],p_1=Promise.resolve(),forEachNumber(this.queryViewsByTarget,function(targetId,queryView){_this.sharedClientState.isLocalQueryTarget(targetId)?activeTargets_1.push(targetId):p_1=p_1.then(function(){return _this.unlisten(queryView.query)}),_this.remoteStore.unlisten(queryView.targetId)}),[4,p_1]);case 4:return _a.sent(),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets_1)];case 5:return _a.sent(),this.resetLimboDocuments(),[4,this.remoteStore.applyPrimaryState(!1)];case 6:_a.sent(),_a.label=7;case 7:return[2];}})})},SyncEngine.prototype.resetLimboDocuments=function(){var _this=this;forEachNumber(this.limboResolutionsByTarget,function(targetId){_this.remoteStore.unlisten(targetId)}),this.limboDocumentRefs.removeAllReferences(),this.limboResolutionsByTarget=[],this.limboTargetsByKey=new SortedMap(DocumentKey.comparator)},SyncEngine.prototype.synchronizeQueryViewsAndRaiseSnapshots=function(targets){for(var _this=this,p=Promise.resolve(),activeQueries=[],newViewSnapshots=[],_loop_1=function(targetId){p=p.then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var queryData,queryView,viewChange,query;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return queryView=this.queryViewsByTarget[targetId],queryView?[4,this.localStore.releaseQuery(queryView.query,!0)]:[3,4];case 1:return _a.sent(),[4,this.localStore.allocateQuery(queryView.query)];case 2:return queryData=_a.sent(),[4,this.synchronizeViewAndComputeSnapshot(queryView)];case 3:return viewChange=_a.sent(),viewChange.snapshot&&newViewSnapshots.push(viewChange.snapshot),[3,8];case 4:return assert(!0===this.isPrimary,'A secondary tab should never have an active query without an active view.'),[4,this.localStore.getQueryForTarget(targetId)];case 5:return query=_a.sent(),assert(!!query,'Query data for target '+targetId+' not found'),[4,this.localStore.allocateQuery(query)];case 6:return queryData=_a.sent(),[4,this.initializeViewAndComputeSnapshot(queryData,!1)];case 7:_a.sent(),_a.label=8;case 8:return activeQueries.push(queryData),[2];}})})})},_i=0,targets_1=targets,targetId;_i<targets_1.length;_i++)targetId=targets_1[_i],_loop_1(targetId);return p.then(function(){return _this.syncEngineListener.onWatchChange(newViewSnapshots),activeQueries})},SyncEngine.prototype.getActiveClients=function(){return this.localStore.getActiveClients()},SyncEngine.prototype.applyTargetState=function(targetId,state,error$$1){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,_a,queryView;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:return this.isPrimary?(debug(LOG_TAG$9,'Ignoring unexpected query state notification.'),[2]):this.queryViewsByTarget[targetId]?(_a=state,'current'===_a?[3,1]:'not-current'===_a?[3,1]:'rejected'===_a?[3,2]:[3,4]):[3,5];case 1:return[2,this.localStore.getNewDocumentChanges().then(function(changes){return tslib_1.__awaiter(_this,void 0,void 0,function(){var synthesizedRemoteEvent;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return synthesizedRemoteEvent=RemoteEvent.createSynthesizedRemoteEventForCurrentChange(targetId,'current'===state),[4,this.emitNewSnapsAndNotifyLocalStore(changes,synthesizedRemoteEvent)];case 1:return _a.sent(),[2];}})})},function(err){return tslib_1.__awaiter(_this,void 0,void 0,function(){var activeTargets_2;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return isDocumentChangeMissingError(err)?(activeTargets_2=[],forEachNumber(this.queryViewsByTarget,function(target){return activeTargets_2.push(target)}),[4,this.synchronizeQueryViewsAndRaiseSnapshots(activeTargets_2)]):[3,2];case 1:return _a.sent(),[3,3];case 2:throw err;case 3:return[2];}})})})];_b.label=2;case 2:return queryView=this.queryViewsByTarget[targetId],this.removeAndCleanupQuery(queryView),[4,this.localStore.releaseQuery(queryView.query,!0)];case 3:return _b.sent(),this.syncEngineListener.onWatchError(queryView.query,error$$1),[3,5];case 4:fail('Unexpected target state: '+state),_b.label=5;case 5:return[2];}})})},SyncEngine.prototype.applyActiveTargetsChange=function(added,removed){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,_i,added_1,targetId,query,queryData,_loop_2,this_1,_a,removed_1,targetId;return tslib_1.__generator(this,function(_b){switch(_b.label){case 0:if(!this.isPrimary)return[2];_i=0,added_1=added,_b.label=1;case 1:return _i<added_1.length?(targetId=added_1[_i],assert(!this.queryViewsByTarget[targetId],'Trying to add an already active target'),[4,this.localStore.getQueryForTarget(targetId)]):[3,6];case 2:return query=_b.sent(),assert(!!query,'Query data for active target '+targetId+' not found'),[4,this.localStore.allocateQuery(query)];case 3:return queryData=_b.sent(),[4,this.initializeViewAndComputeSnapshot(queryData,!1)];case 4:_b.sent(),this.remoteStore.listen(queryData),_b.label=5;case 5:return _i++,[3,1];case 6:_loop_2=function(targetId){var queryView;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return queryView=this_1.queryViewsByTarget[targetId],queryView?[4,this_1.localStore.releaseQuery(queryView.query,!1).then(function(){_this.remoteStore.unlisten(targetId),_this.removeAndCleanupQuery(queryView)}).catch(function(err){return _this.ignoreIfPrimaryLeaseLoss(err)})]:[3,2];case 1:_a.sent(),_a.label=2;case 2:return[2];}})},this_1=this,_a=0,removed_1=removed,_b.label=7;case 7:return _a<removed_1.length?(targetId=removed_1[_a],[5,_loop_2(targetId)]):[3,10];case 8:_b.sent(),_b.label=9;case 9:return _a++,[3,7];case 10:return[2];}})})},SyncEngine.prototype.enableNetwork=function(){return this.localStore.setNetworkEnabled(!0),this.remoteStore.enableNetwork()},SyncEngine.prototype.disableNetwork=function(){return this.localStore.setNetworkEnabled(!1),this.remoteStore.disableNetwork()},SyncEngine.prototype.getRemoteKeysForTarget=function(targetId){var limboResolution=this.limboResolutionsByTarget[targetId];return limboResolution&&limboResolution.receivedDocument?documentKeySet().add(limboResolution.key):this.queryViewsByTarget[targetId]?this.queryViewsByTarget[targetId].view.syncedDocuments:documentKeySet()},SyncEngine}(),User=function(){function User(uid){this.uid=uid}return User.prototype.isAuthenticated=function(){return null!=this.uid},User.prototype.toKey=function(){return this.isAuthenticated()?'uid:'+this.uid:'anonymous-user'},User.prototype.isEqual=function(otherUser){return otherUser.uid===this.uid},User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User('google-credentials-uid'),User.FIRST_PARTY=new User('first-party-uid'),User}(),LOG_TAG$10='SharedClientState',CLIENT_STATE_KEY_PREFIX='firestore_clients',MUTATION_BATCH_KEY_PREFIX='firestore_mutations',QUERY_TARGET_KEY_PREFIX='firestore_targets',MutationMetadata=function(){function MutationMetadata(user,batchId,state,error$$1){this.user=user,this.batchId=batchId,this.state=state,this.error=error$$1,assert(void 0!==error$$1==('rejected'===state),'MutationMetadata must contain an error iff state is \'rejected\'')}return MutationMetadata.fromWebStorageEntry=function(user,batchId,value){var mutationBatch=JSON.parse(value),validData='object'==typeof mutationBatch&&-1!==['pending','acknowledged','rejected'].indexOf(mutationBatch.state)&&(void 0===mutationBatch.error||'object'==typeof mutationBatch.error),firestoreError=void 0;return validData&&mutationBatch.error&&(validData='string'==typeof mutationBatch.error.message&&'string'==typeof mutationBatch.error.code,validData&&(firestoreError=new FirestoreError(mutationBatch.error.code,mutationBatch.error.message))),validData?new MutationMetadata(user,batchId,mutationBatch.state,firestoreError):(error(LOG_TAG$10,'Failed to parse mutation state for ID \''+batchId+'\': '+value),null)},MutationMetadata.prototype.toWebStorageJSON=function(){var batchMetadata={state:this.state,updateTimeMs:Date.now()};return this.error&&(batchMetadata.error={code:this.error.code,message:this.error.message}),JSON.stringify(batchMetadata)},MutationMetadata}(),QueryTargetMetadata=function(){function QueryTargetMetadata(targetId,state,error$$1){this.targetId=targetId,this.state=state,this.error=error$$1,assert(void 0!==error$$1==('rejected'===state),'QueryTargetMetadata must contain an error iff state is \'rejected\'')}return QueryTargetMetadata.fromWebStorageEntry=function(targetId,value){var targetState=JSON.parse(value),validData='object'==typeof targetState&&-1!==['not-current','current','rejected'].indexOf(targetState.state)&&(void 0===targetState.error||'object'==typeof targetState.error),firestoreError=void 0;return validData&&targetState.error&&(validData='string'==typeof targetState.error.message&&'string'==typeof targetState.error.code,validData&&(firestoreError=new FirestoreError(targetState.error.code,targetState.error.message))),validData?new QueryTargetMetadata(targetId,targetState.state,firestoreError):(error(LOG_TAG$10,'Failed to parse target state for ID \''+targetId+'\': '+value),null)},QueryTargetMetadata.prototype.toWebStorageJSON=function(){var targetState={state:this.state,updateTimeMs:Date.now()};return this.error&&(targetState.error={code:this.error.code,message:this.error.message}),JSON.stringify(targetState)},QueryTargetMetadata}(),RemoteClientState=function(){function RemoteClientState(clientId,activeTargetIds){this.clientId=clientId,this.activeTargetIds=activeTargetIds}return RemoteClientState.fromWebStorageEntry=function(clientId,value){for(var clientState=JSON.parse(value),validData='object'==typeof clientState&&clientState.activeTargetIds instanceof Array,activeTargetIdsSet=targetIdSet(),i=0;validData&&i<clientState.activeTargetIds.length;++i)validData=isSafeInteger(clientState.activeTargetIds[i]),activeTargetIdsSet=activeTargetIdsSet.add(clientState.activeTargetIds[i]);return validData?new RemoteClientState(clientId,activeTargetIdsSet):(error(LOG_TAG$10,'Failed to parse client data for instance \''+clientId+'\': '+value),null)},RemoteClientState}(),SharedOnlineState=function(){function SharedOnlineState(clientId,onlineState){this.clientId=clientId,this.onlineState=onlineState}return SharedOnlineState.fromWebStorageEntry=function(value){var onlineState=JSON.parse(value),validData='object'==typeof onlineState&&void 0!==OnlineState[onlineState.onlineState]&&'string'==typeof onlineState.clientId;return validData?new SharedOnlineState(onlineState.clientId,OnlineState[onlineState.onlineState]):(error(LOG_TAG$10,'Failed to parse online state: '+value),null)},SharedOnlineState}(),LocalClientState=function(){function LocalClientState(){this.activeTargetIds=targetIdSet()}return LocalClientState.prototype.addQueryTarget=function(targetId){assert(!this.activeTargetIds.has(targetId),'Target with ID \''+targetId+'\' already active.'),this.activeTargetIds=this.activeTargetIds.add(targetId)},LocalClientState.prototype.removeQueryTarget=function(targetId){this.activeTargetIds=this.activeTargetIds.delete(targetId)},LocalClientState.prototype.toWebStorageJSON=function(){var data={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(data)},LocalClientState}(),WebStorageSharedClientState=function(){function WebStorageSharedClientState(queue,platform,persistenceKey,localClientId,initialUser){if(this.queue=queue,this.platform=platform,this.persistenceKey=persistenceKey,this.localClientId=localClientId,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.activeClients={},this.storageListener=this.handleWebStorageEvent.bind(this),this.started=!1,this.earlyEvents=[],!WebStorageSharedClientState.isAvailable(this.platform))throw new FirestoreError(Code.UNIMPLEMENTED,'LocalStorage is not available on this platform.');var escapedPersistenceKey=persistenceKey.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');this.storage=this.platform.window.localStorage,this.currentUser=initialUser,this.localClientStorageKey=this.toWebStorageClientStateKey(this.localClientId),this.sequenceNumberKey='firestore_sequence_number'+'_'+persistenceKey,this.activeClients[this.localClientId]=new LocalClientState,this.clientStateKeyRe=new RegExp('^'+CLIENT_STATE_KEY_PREFIX+'_'+escapedPersistenceKey+'_([^_]*)$'),this.mutationBatchKeyRe=new RegExp('^'+MUTATION_BATCH_KEY_PREFIX+'_'+escapedPersistenceKey+'_(\\d+)(?:_(.*))?$'),this.queryTargetKeyRe=new RegExp('^'+QUERY_TARGET_KEY_PREFIX+'_'+escapedPersistenceKey+'_(\\d+)$'),this.onlineStateKey='firestore_online_state'+'_'+persistenceKey,this.platform.window.addEventListener('storage',this.storageListener)}return WebStorageSharedClientState.isAvailable=function(platform){return!!(platform.window&&null!=platform.window.localStorage)},WebStorageSharedClientState.prototype.start=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){var _this=this,existingClients,_i,existingClients_1,clientId,storageItem,clientState,onlineStateJSON,onlineState,_a,_b,event_1;return tslib_1.__generator(this,function(_c){switch(_c.label){case 0:return assert(!this.started,'WebStorageSharedClientState already started'),assert(null!==this.syncEngine,'syncEngine property must be set before calling start()'),assert(null!==this.onlineStateHandler,'onlineStateHandler property must be set before calling start()'),[4,this.syncEngine.getActiveClients()];case 1:for(existingClients=_c.sent(),_i=0,existingClients_1=existingClients;_i<existingClients_1.length;_i++)(clientId=existingClients_1[_i],clientId!==this.localClientId)&&(storageItem=this.getItem(this.toWebStorageClientStateKey(clientId)),storageItem&&(clientState=RemoteClientState.fromWebStorageEntry(clientId,storageItem),clientState&&(this.activeClients[clientState.clientId]=clientState)));for(this.persistClientState(),onlineStateJSON=this.storage.getItem(this.onlineStateKey),onlineStateJSON&&(onlineState=this.fromWebStorageOnlineState(onlineStateJSON),onlineState&&this.handleOnlineStateEvent(onlineState)),(_a=0,_b=this.earlyEvents);_a<_b.length;_a++)event_1=_b[_a],this.handleWebStorageEvent(event_1);return this.earlyEvents=[],this.platform.window.addEventListener('unload',function(){return _this.shutdown()}),this.started=!0,[2];}})})},WebStorageSharedClientState.prototype.writeSequenceNumber=function(sequenceNumber){this.setItem(this.sequenceNumberKey,JSON.stringify(sequenceNumber))},WebStorageSharedClientState.prototype.getAllActiveQueryTargets=function(){var activeTargets=targetIdSet();return forEach(this.activeClients,function(key,value){activeTargets=activeTargets.unionWith(value.activeTargetIds)}),activeTargets},WebStorageSharedClientState.prototype.isActiveQueryTarget=function(targetId){for(var clientId in this.activeClients)if(this.activeClients.hasOwnProperty(clientId)&&this.activeClients[clientId].activeTargetIds.has(targetId))return!0;return!1},WebStorageSharedClientState.prototype.addPendingMutation=function(batchId){this.persistMutationState(batchId,'pending')},WebStorageSharedClientState.prototype.updateMutationState=function(batchId,state,error$$1){this.persistMutationState(batchId,state,error$$1),this.removeMutationState(batchId)},WebStorageSharedClientState.prototype.addLocalQueryTarget=function(targetId){var queryState='not-current';if(this.isActiveQueryTarget(targetId)){var storageItem=this.storage.getItem(this.toWebStorageQueryTargetMetadataKey(targetId));if(storageItem){var metadata=QueryTargetMetadata.fromWebStorageEntry(targetId,storageItem);metadata&&(queryState=metadata.state)}}return this.localClientState.addQueryTarget(targetId),this.persistClientState(),queryState},WebStorageSharedClientState.prototype.removeLocalQueryTarget=function(targetId){this.localClientState.removeQueryTarget(targetId),this.persistClientState()},WebStorageSharedClientState.prototype.isLocalQueryTarget=function(targetId){return this.localClientState.activeTargetIds.has(targetId)},WebStorageSharedClientState.prototype.clearQueryState=function(targetId){this.removeItem(this.toWebStorageQueryTargetMetadataKey(targetId))},WebStorageSharedClientState.prototype.updateQueryState=function(targetId,state,error$$1){this.persistQueryTargetState(targetId,state,error$$1)},WebStorageSharedClientState.prototype.handleUserChange=function(user,removedBatchIds,addedBatchIds){var _this=this;removedBatchIds.forEach(function(batchId){_this.removeMutationState(batchId)}),this.currentUser=user,addedBatchIds.forEach(function(batchId){_this.addPendingMutation(batchId)})},WebStorageSharedClientState.prototype.setOnlineState=function(onlineState){this.persistOnlineState(onlineState)},WebStorageSharedClientState.prototype.shutdown=function(){this.started&&(this.platform.window.removeEventListener('storage',this.storageListener),this.removeItem(this.localClientStorageKey),this.started=!1)},WebStorageSharedClientState.prototype.getItem=function(key){var value=this.storage.getItem(key);return debug(LOG_TAG$10,'READ',key,value),value},WebStorageSharedClientState.prototype.setItem=function(key,value){debug(LOG_TAG$10,'SET',key,value),this.storage.setItem(key,value)},WebStorageSharedClientState.prototype.removeItem=function(key){debug(LOG_TAG$10,'REMOVE',key),this.storage.removeItem(key)},WebStorageSharedClientState.prototype.handleWebStorageEvent=function(event){var _this=this;if(event.storageArea===this.storage){if(debug(LOG_TAG$10,'EVENT',event.key,event.newValue),event.key===this.localClientStorageKey)return void error('Received WebStorage notification for local change. Another client might have '+'garbage-collected our state');this.queue.enqueueAndForget(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var clientState,clientId,mutationMetadata,queryTargetMetadata,onlineState,sequenceNumber;return tslib_1.__generator(this,function(){if(!this.started)return this.earlyEvents.push(event),[2];if(null===event.key)return[2];if(this.clientStateKeyRe.test(event.key)){if(null==event.newValue)return clientId=this.fromWebStorageClientStateKey(event.key),[2,this.handleClientStateEvent(clientId,null)];if(clientState=this.fromWebStorageClientState(event.key,event.newValue),clientState)return[2,this.handleClientStateEvent(clientState.clientId,clientState)]}else if(this.mutationBatchKeyRe.test(event.key)){if(null!==event.newValue&&(mutationMetadata=this.fromWebStorageMutationMetadata(event.key,event.newValue),mutationMetadata))return[2,this.handleMutationBatchEvent(mutationMetadata)];}else if(this.queryTargetKeyRe.test(event.key)){if(null!==event.newValue&&(queryTargetMetadata=this.fromWebStorageQueryTargetMetadata(event.key,event.newValue),queryTargetMetadata))return[2,this.handleQueryTargetEvent(queryTargetMetadata)];}else if(event.key!==this.onlineStateKey)event.key===this.sequenceNumberKey&&(assert(!!this.sequenceNumberHandler,'Missing sequenceNumberHandler'),sequenceNumber=fromWebStorageSequenceNumber(event.newValue),sequenceNumber!==ListenSequence.INVALID&&this.sequenceNumberHandler(sequenceNumber));else if(null!==event.newValue&&(onlineState=this.fromWebStorageOnlineState(event.newValue),onlineState))return[2,this.handleOnlineStateEvent(onlineState)];return[2]})})})}},Object.defineProperty(WebStorageSharedClientState.prototype,'localClientState',{get:function(){return this.activeClients[this.localClientId]},enumerable:!0,configurable:!0}),WebStorageSharedClientState.prototype.persistClientState=function(){this.setItem(this.localClientStorageKey,this.localClientState.toWebStorageJSON())},WebStorageSharedClientState.prototype.persistMutationState=function(batchId,state,error$$1){var mutationState=new MutationMetadata(this.currentUser,batchId,state,error$$1),mutationKey=this.toWebStorageMutationBatchKey(batchId);this.setItem(mutationKey,mutationState.toWebStorageJSON())},WebStorageSharedClientState.prototype.removeMutationState=function(batchId){var mutationKey=this.toWebStorageMutationBatchKey(batchId);this.removeItem(mutationKey)},WebStorageSharedClientState.prototype.persistOnlineState=function(onlineState){var entry={clientId:this.localClientId,onlineState:OnlineState[onlineState]};this.storage.setItem(this.onlineStateKey,JSON.stringify(entry))},WebStorageSharedClientState.prototype.persistQueryTargetState=function(targetId,state,error$$1){var targetKey=this.toWebStorageQueryTargetMetadataKey(targetId),targetMetadata=new QueryTargetMetadata(targetId,state,error$$1);this.setItem(targetKey,targetMetadata.toWebStorageJSON())},WebStorageSharedClientState.prototype.toWebStorageClientStateKey=function(clientId){return assert(-1===clientId.indexOf('_'),'Client key cannot contain \'_\', but was \''+clientId+'\''),CLIENT_STATE_KEY_PREFIX+'_'+this.persistenceKey+'_'+clientId},WebStorageSharedClientState.prototype.toWebStorageQueryTargetMetadataKey=function(targetId){return QUERY_TARGET_KEY_PREFIX+'_'+this.persistenceKey+'_'+targetId},WebStorageSharedClientState.prototype.toWebStorageMutationBatchKey=function(batchId){var mutationKey=MUTATION_BATCH_KEY_PREFIX+'_'+this.persistenceKey+'_'+batchId;return this.currentUser.isAuthenticated()&&(mutationKey+='_'+this.currentUser.uid),mutationKey},WebStorageSharedClientState.prototype.fromWebStorageClientStateKey=function(key){var match=this.clientStateKeyRe.exec(key);return match?match[1]:null},WebStorageSharedClientState.prototype.fromWebStorageClientState=function(key,value){var clientId=this.fromWebStorageClientStateKey(key);return assert(null!==clientId,'Cannot parse client state key \''+key+'\''),RemoteClientState.fromWebStorageEntry(clientId,value)},WebStorageSharedClientState.prototype.fromWebStorageMutationMetadata=function(key,value){var match=this.mutationBatchKeyRe.exec(key);assert(null!==match,'Cannot parse mutation batch key \''+key+'\'');var batchId=+match[1],userId=void 0===match[2]?null:match[2];return MutationMetadata.fromWebStorageEntry(new User(userId),batchId,value)},WebStorageSharedClientState.prototype.fromWebStorageQueryTargetMetadata=function(key,value){var match=this.queryTargetKeyRe.exec(key);assert(null!==match,'Cannot parse query target key \''+key+'\'');var targetId=+match[1];return QueryTargetMetadata.fromWebStorageEntry(targetId,value)},WebStorageSharedClientState.prototype.fromWebStorageOnlineState=function(value){return SharedOnlineState.fromWebStorageEntry(value)},WebStorageSharedClientState.prototype.handleMutationBatchEvent=function(mutationBatch){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return mutationBatch.user.uid===this.currentUser.uid?[2,this.syncEngine.applyBatchState(mutationBatch.batchId,mutationBatch.state,mutationBatch.error)]:(debug(LOG_TAG$10,'Ignoring mutation for non-active user '+mutationBatch.user.uid),[2])})})},WebStorageSharedClientState.prototype.handleQueryTargetEvent=function(targetMetadata){return this.syncEngine.applyTargetState(targetMetadata.targetId,targetMetadata.state,targetMetadata.error)},WebStorageSharedClientState.prototype.handleClientStateEvent=function(clientId,clientState){var _this=this,existingTargets=this.getAllActiveQueryTargets();clientState?this.activeClients[clientId]=clientState:delete this.activeClients[clientId];var newTargets=this.getAllActiveQueryTargets(),addedTargets=[],removedTargets=[];return newTargets.forEach(function(targetId){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return existingTargets.has(targetId)||addedTargets.push(targetId),[2]})})}),existingTargets.forEach(function(targetId){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return newTargets.has(targetId)||removedTargets.push(targetId),[2]})})}),this.syncEngine.applyActiveTargetsChange(addedTargets,removedTargets)},WebStorageSharedClientState.prototype.handleOnlineStateEvent=function(onlineState){this.activeClients[onlineState.clientId]&&this.onlineStateHandler(onlineState.onlineState)},WebStorageSharedClientState}(),MemorySharedClientState=function(){function MemorySharedClientState(){this.localState=new LocalClientState,this.queryState={},this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null}return MemorySharedClientState.prototype.addPendingMutation=function(){},MemorySharedClientState.prototype.updateMutationState=function(){},MemorySharedClientState.prototype.addLocalQueryTarget=function(targetId){return this.localState.addQueryTarget(targetId),this.queryState[targetId]||'not-current'},MemorySharedClientState.prototype.updateQueryState=function(targetId,state){this.queryState[targetId]=state},MemorySharedClientState.prototype.removeLocalQueryTarget=function(targetId){this.localState.removeQueryTarget(targetId)},MemorySharedClientState.prototype.isLocalQueryTarget=function(targetId){return this.localState.activeTargetIds.has(targetId)},MemorySharedClientState.prototype.clearQueryState=function(targetId){delete this.queryState[targetId]},MemorySharedClientState.prototype.getAllActiveQueryTargets=function(){return this.localState.activeTargetIds},MemorySharedClientState.prototype.isActiveQueryTarget=function(targetId){return this.localState.activeTargetIds.has(targetId)},MemorySharedClientState.prototype.start=function(){return this.localState=new LocalClientState,Promise.resolve()},MemorySharedClientState.prototype.handleUserChange=function(){},MemorySharedClientState.prototype.setOnlineState=function(){},MemorySharedClientState.prototype.shutdown=function(){},MemorySharedClientState.prototype.writeSequenceNumber=function(){},MemorySharedClientState}(),LOG_TAG$11='FirestoreClient',FirestoreClient=function(){function FirestoreClient(platform,databaseInfo,credentials,asyncQueue){this.platform=platform,this.databaseInfo=databaseInfo,this.credentials=credentials,this.asyncQueue=asyncQueue,this.clientId=AutoId.newId()}return FirestoreClient.prototype.start=function(persistenceSettings){var _this=this,initializationDone=new Deferred$1,persistenceResult=new Deferred$1,initialized=!1;return this.credentials.setChangeListener(function(user){initialized?_this.asyncQueue.enqueueAndForget(function(){return _this.handleCredentialChange(user)}):(initialized=!0,_this.initializePersistence(persistenceSettings,persistenceResult,user).then(function(){return _this.initializeRest(user)}).then(initializationDone.resolve,initializationDone.reject))}),this.asyncQueue.enqueueAndForget(function(){return initializationDone.promise}),persistenceResult.promise},FirestoreClient.prototype.enableNetwork=function(){var _this=this;return this.asyncQueue.enqueue(function(){return _this.syncEngine.enableNetwork()})},FirestoreClient.prototype.initializePersistence=function(persistenceSettings,persistenceResult,user){var _this=this;return persistenceSettings.enabled?this.startIndexedDbPersistence(user,persistenceSettings).then(persistenceResult.resolve).catch(function(error$$1){return(persistenceResult.reject(error$$1),!_this.canFallback(error$$1))?Promise.reject(error$$1):(console.warn('Error enabling offline storage. Falling back to'+' storage disabled: '+error$$1),_this.startMemoryPersistence())}):(persistenceResult.resolve(),this.startMemoryPersistence())},FirestoreClient.prototype.canFallback=function(error$$1){return error$$1 instanceof FirestoreError?error$$1.code===Code.FAILED_PRECONDITION||error$$1.code===Code.UNIMPLEMENTED:'undefined'!=typeof DOMException&&error$$1 instanceof DOMException?error$$1.code===22||error$$1.code===20:!0},FirestoreClient.prototype.startIndexedDbPersistence=function(user,settings){var _this=this;assert(settings.enabled,'Should only start IndexedDb persitence with offline persistence enabled.');var storagePrefix=IndexedDbPersistence.buildStoragePrefix(this.databaseInfo),serializer=new JsonProtoSerializer(this.databaseInfo.databaseId,{useProto3Json:!0});return Promise.resolve().then(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){var _a,_b;return tslib_1.__generator(this,function(_c){switch(_c.label){case 0:if(settings.experimentalTabSynchronization&&!WebStorageSharedClientState.isAvailable(this.platform))throw new FirestoreError(Code.UNIMPLEMENTED,'IndexedDB persistence is only available on platforms that support LocalStorage.');return settings.experimentalTabSynchronization?(this.sharedClientState=new WebStorageSharedClientState(this.asyncQueue,this.platform,storagePrefix,this.clientId,user),_a=this,[4,IndexedDbPersistence.createMultiClientIndexedDbPersistence(storagePrefix,this.clientId,this.platform,this.asyncQueue,serializer,{sequenceNumberSyncer:this.sharedClientState})]):[3,2];case 1:return _a.persistence=_c.sent(),[3,4];case 2:return this.sharedClientState=new MemorySharedClientState,_b=this,[4,IndexedDbPersistence.createIndexedDbPersistence(storagePrefix,this.clientId,this.platform,this.asyncQueue,serializer)];case 3:_b.persistence=_c.sent(),_c.label=4;case 4:return[2];}})})})},FirestoreClient.prototype.startMemoryPersistence=function(){var serializer=new JsonProtoSerializer(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=MemoryPersistence.createEagerPersistence(this.clientId,serializer),this.sharedClientState=new MemorySharedClientState,Promise.resolve()},FirestoreClient.prototype.initializeRest=function(user){var _this=this;return debug(LOG_TAG$11,'Initializing. user=',user.uid),this.platform.loadConnection(this.databaseInfo).then(function(connection){return tslib_1.__awaiter(_this,void 0,void 0,function(){var _this=this,serializer,datastore,remoteStoreOnlineStateChangedHandler,sharedClientStateOnlineStateChangedHandler;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return this.localStore=new LocalStore(this.persistence,user),serializer=this.platform.newSerializer(this.databaseInfo.databaseId),datastore=new Datastore(this.asyncQueue,connection,this.credentials,serializer),remoteStoreOnlineStateChangedHandler=function(onlineState){return _this.syncEngine.applyOnlineStateChange(onlineState,OnlineStateSource.RemoteStore)},sharedClientStateOnlineStateChangedHandler=function(onlineState){return _this.syncEngine.applyOnlineStateChange(onlineState,OnlineStateSource.SharedClientState)},this.remoteStore=new RemoteStore(this.localStore,datastore,this.asyncQueue,remoteStoreOnlineStateChangedHandler),this.syncEngine=new SyncEngine(this.localStore,this.remoteStore,this.sharedClientState,user),this.sharedClientState.onlineStateHandler=sharedClientStateOnlineStateChangedHandler,this.remoteStore.syncEngine=this.syncEngine,this.sharedClientState.syncEngine=this.syncEngine,this.eventMgr=new EventManager(this.syncEngine),[4,this.sharedClientState.start()];case 1:return _a.sent(),[4,this.remoteStore.start()];case 2:return _a.sent(),[4,this.persistence.setPrimaryStateListener(function(isPrimary){return _this.syncEngine.applyPrimaryState(isPrimary)})];case 3:return _a.sent(),[2];}})})})},FirestoreClient.prototype.handleCredentialChange=function(user){return this.asyncQueue.verifyOperationInProgress(),debug(LOG_TAG$11,'Credential Changed. Current user: '+user.uid),this.syncEngine.handleCredentialChange(user)},FirestoreClient.prototype.disableNetwork=function(){var _this=this;return this.asyncQueue.enqueue(function(){return _this.syncEngine.disableNetwork()})},FirestoreClient.prototype.shutdown=function(options){var _this=this;return this.asyncQueue.enqueue(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return[4,this.remoteStore.shutdown()];case 1:return _a.sent(),[4,this.sharedClientState.shutdown()];case 2:return _a.sent(),[4,this.persistence.shutdown(options&&options.purgePersistenceWithDataLoss)];case 3:return _a.sent(),this.credentials.removeChangeListener(),[2];}})})})},FirestoreClient.prototype.listen=function(query,observer,options){var _this=this,listener=new QueryListener(query,observer,options);return this.asyncQueue.enqueueAndForget(function(){return _this.eventMgr.listen(listener)}),listener},FirestoreClient.prototype.unlisten=function(listener){var _this=this;this.asyncQueue.enqueueAndForget(function(){return _this.eventMgr.unlisten(listener)})},FirestoreClient.prototype.getDocumentFromLocalCache=function(docKey){var _this=this;return this.asyncQueue.enqueue(function(){return _this.localStore.readDocument(docKey)}).then(function(maybeDoc){if(maybeDoc instanceof Document)return maybeDoc;if(maybeDoc instanceof NoDocument)return null;throw new FirestoreError(Code.UNAVAILABLE,'Failed to get document from cache. (However, this document may '+'exist on the server. Run again without setting \'source\' in '+'the GetOptions to attempt to retrieve the document from the '+'server.)')})},FirestoreClient.prototype.getDocumentsFromLocalCache=function(query){var _this=this;return this.asyncQueue.enqueue(function(){return _this.localStore.executeQuery(query)}).then(function(docs){var remoteKeys=documentKeySet(),view=new View(query,remoteKeys),viewDocChanges=view.computeDocChanges(docs);return view.applyChanges(viewDocChanges,!1).snapshot})},FirestoreClient.prototype.write=function(mutations){var _this=this,deferred=new Deferred$1;return this.asyncQueue.enqueueAndForget(function(){return _this.syncEngine.write(mutations,deferred)}),deferred.promise},FirestoreClient.prototype.databaseId=function(){return this.databaseInfo.databaseId},FirestoreClient.prototype.transaction=function(updateFunction){var _this=this;return this.asyncQueue.enqueue(function(){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return[2]})})}).then(function(){return _this.syncEngine.runTransaction(updateFunction)})},FirestoreClient}(),AsyncObserver=function(){function AsyncObserver(observer){this.observer=observer,this.muted=!1}return AsyncObserver.prototype.next=function(value){this.scheduleEvent(this.observer.next,value)},AsyncObserver.prototype.error=function(error){this.scheduleEvent(this.observer.error,error)},AsyncObserver.prototype.mute=function(){this.muted=!0},AsyncObserver.prototype.scheduleEvent=function(eventHandler,event){var _this=this;this.muted||setTimeout(function(){_this.muted||eventHandler(event)},0)},AsyncObserver}(),FieldPath$1=function(){function FieldPath$$1(){for(var fieldNames=[],_i=0;_i<arguments.length;_i++)fieldNames[_i]=arguments[_i];validateNamedArrayAtLeastNumberOfElements('FieldPath',fieldNames,'fieldNames',1);for(var i=0;i<fieldNames.length;++i)if(validateArgType('FieldPath','string',i,fieldNames[i]),0===fieldNames[i].length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid field name at argument $(i + 1). '+'Field names must not be empty.');this._internalPath=new FieldPath(fieldNames)}return FieldPath$$1.documentId=function(){return FieldPath$$1._DOCUMENT_ID},FieldPath$$1.prototype.isEqual=function(other){if(!(other instanceof FieldPath$$1))throw invalidClassError('isEqual','FieldPath',1,other);return this._internalPath.isEqual(other._internalPath)},FieldPath$$1._DOCUMENT_ID=new FieldPath$$1(FieldPath.keyField().canonicalString()),FieldPath$$1}(),RESERVED=/[~\*\/\[\]]/,OAuthToken=function(){return function OAuthToken(value,user){this.user=user,this.type='OAuth',this.authHeaders={Authorization:'Bearer '+value}}}(),EmptyCredentialsProvider=function(){function EmptyCredentialsProvider(){this.changeListener=null}return EmptyCredentialsProvider.prototype.getToken=function(){return Promise.resolve(null)},EmptyCredentialsProvider.prototype.invalidateToken=function(){},EmptyCredentialsProvider.prototype.setChangeListener=function(changeListener){assert(!this.changeListener,'Can only call setChangeListener() once.'),this.changeListener=changeListener,changeListener(User.UNAUTHENTICATED)},EmptyCredentialsProvider.prototype.removeChangeListener=function(){assert(null!==this.changeListener,'removeChangeListener() when no listener registered'),this.changeListener=null},EmptyCredentialsProvider}(),FirebaseCredentialsProvider=function(){function FirebaseCredentialsProvider(app){var _this=this;this.app=app,this.tokenListener=null,this.tokenCounter=0,this.changeListener=null,this.forceRefresh=!1,this.tokenListener=function(){_this.tokenCounter++,_this.currentUser=_this.getUser(),_this.changeListener&&_this.changeListener(_this.currentUser)},this.tokenCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return FirebaseCredentialsProvider.prototype.getToken=function(){var _this=this;assert(null!=this.tokenListener,'getToken cannot be called after listener removed.');var initialTokenCounter=this.tokenCounter,forceRefresh=this.forceRefresh;return this.forceRefresh=!1,this.app.INTERNAL.getToken(forceRefresh).then(function(tokenData){if(_this.tokenCounter!==initialTokenCounter)throw new FirestoreError(Code.ABORTED,'getToken aborted due to token change.');else return tokenData?(assert('string'==typeof tokenData.accessToken,'Invalid tokenData returned from getToken():'+tokenData),new OAuthToken(tokenData.accessToken,_this.currentUser)):null})},FirebaseCredentialsProvider.prototype.invalidateToken=function(){this.forceRefresh=!0},FirebaseCredentialsProvider.prototype.setChangeListener=function(changeListener){assert(!this.changeListener,'Can only call setChangeListener() once.'),this.changeListener=changeListener,this.currentUser&&changeListener(this.currentUser)},FirebaseCredentialsProvider.prototype.removeChangeListener=function(){assert(null!=this.tokenListener,'removeChangeListener() called twice'),assert(null!==this.changeListener,'removeChangeListener() called when no listener registered'),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.changeListener=null},FirebaseCredentialsProvider.prototype.getUser=function(){var currentUid=this.app.INTERNAL.getUid();return assert(null===currentUid||'string'==typeof currentUid,'Received invalid UID: '+currentUid),new User(currentUid)},FirebaseCredentialsProvider}(),FirstPartyToken=function(){function FirstPartyToken(gapi,sessionIndex){this.gapi=gapi,this.sessionIndex=sessionIndex,this.type='FirstParty',this.user=User.FIRST_PARTY,assert(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,'unexpected gapi interface')}return Object.defineProperty(FirstPartyToken.prototype,'authHeaders',{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),FirstPartyToken}(),FirstPartyCredentialsProvider=function(){function FirstPartyCredentialsProvider(gapi,sessionIndex){this.gapi=gapi,this.sessionIndex=sessionIndex,assert(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,'unexpected gapi interface')}return FirstPartyCredentialsProvider.prototype.getToken=function(){return Promise.resolve(new FirstPartyToken(this.gapi,this.sessionIndex))},FirstPartyCredentialsProvider.prototype.setChangeListener=function(changeListener){changeListener(User.FIRST_PARTY)},FirstPartyCredentialsProvider.prototype.removeChangeListener=function(){},FirstPartyCredentialsProvider.prototype.invalidateToken=function(){},FirstPartyCredentialsProvider}(),FieldValueImpl=function(){function FieldValueImpl(_methodName){this._methodName=_methodName}return FieldValueImpl.delete=function(){return DeleteFieldValueImpl.instance},FieldValueImpl.serverTimestamp=function(){return ServerTimestampFieldValueImpl.instance},FieldValueImpl.arrayUnion=function(){for(var elements=[],_i=0;_i<arguments.length;_i++)elements[_i]=arguments[_i];return validateAtLeastNumberOfArgs('FieldValue.arrayUnion',arguments,1),new ArrayUnionFieldValueImpl(elements)},FieldValueImpl.arrayRemove=function(){for(var elements=[],_i=0;_i<arguments.length;_i++)elements[_i]=arguments[_i];return validateAtLeastNumberOfArgs('FieldValue.arrayRemove',arguments,1),new ArrayRemoveFieldValueImpl(elements)},FieldValueImpl.prototype.isEqual=function(other){return this===other},FieldValueImpl}(),DeleteFieldValueImpl=function(_super){function DeleteFieldValueImpl(){return _super.call(this,'FieldValue.delete')||this}return tslib_1.__extends(DeleteFieldValueImpl,_super),DeleteFieldValueImpl.instance=new DeleteFieldValueImpl,DeleteFieldValueImpl}(FieldValueImpl),ServerTimestampFieldValueImpl=function(_super){function ServerTimestampFieldValueImpl(){return _super.call(this,'FieldValue.serverTimestamp')||this}return tslib_1.__extends(ServerTimestampFieldValueImpl,_super),ServerTimestampFieldValueImpl.instance=new ServerTimestampFieldValueImpl,ServerTimestampFieldValueImpl}(FieldValueImpl),ArrayUnionFieldValueImpl=function(_super){function ArrayUnionFieldValueImpl(_elements){var _this=_super.call(this,'FieldValue.arrayUnion')||this;return _this._elements=_elements,_this}return tslib_1.__extends(ArrayUnionFieldValueImpl,_super),ArrayUnionFieldValueImpl}(FieldValueImpl),ArrayRemoveFieldValueImpl=function(_super){function ArrayRemoveFieldValueImpl(_elements){var _this=_super.call(this,'FieldValue.arrayRemove')||this;return _this._elements=_elements,_this}return tslib_1.__extends(ArrayRemoveFieldValueImpl,_super),ArrayRemoveFieldValueImpl}(FieldValueImpl),PublicFieldValue=makeConstructorPrivate(FieldValueImpl,'Use FieldValue.<field>() instead.'),RESERVED_FIELD_REGEX=/^__.*__$/,ParsedSetData=function(){function ParsedSetData(data,fieldMask,fieldTransforms){this.data=data,this.fieldMask=fieldMask,this.fieldTransforms=fieldTransforms}return ParsedSetData.prototype.toMutations=function(key,precondition){var mutations=[];return null===this.fieldMask?mutations.push(new SetMutation(key,this.data,precondition)):mutations.push(new PatchMutation(key,this.data,this.fieldMask,precondition)),0<this.fieldTransforms.length&&mutations.push(new TransformMutation(key,this.fieldTransforms)),mutations},ParsedSetData}(),ParsedUpdateData=function(){function ParsedUpdateData(data,fieldMask,fieldTransforms){this.data=data,this.fieldMask=fieldMask,this.fieldTransforms=fieldTransforms}return ParsedUpdateData.prototype.toMutations=function(key,precondition){var mutations=[new PatchMutation(key,this.data,this.fieldMask,precondition)];return 0<this.fieldTransforms.length&&mutations.push(new TransformMutation(key,this.fieldTransforms)),mutations},ParsedUpdateData}(),UserDataSource;(function(UserDataSource){UserDataSource[UserDataSource.Set=0]='Set',UserDataSource[UserDataSource.Update=1]='Update',UserDataSource[UserDataSource.MergeSet=2]='MergeSet',UserDataSource[UserDataSource.Argument=3]='Argument'})(UserDataSource||(UserDataSource={}));var ParseContext=function(){function ParseContext(dataSource,methodName,path,arrayElement,fieldTransforms,fieldMask){this.dataSource=dataSource,this.methodName=methodName,this.path=path,this.arrayElement=arrayElement,void 0===fieldTransforms&&this.validatePath(),this.arrayElement=void 0!==arrayElement&&arrayElement,this.fieldTransforms=fieldTransforms||[],this.fieldMask=fieldMask||[]}return ParseContext.prototype.childContextForField=function(field){var childPath=null==this.path?null:this.path.child(field),context=new ParseContext(this.dataSource,this.methodName,childPath,!1,this.fieldTransforms,this.fieldMask);return context.validatePathSegment(field),context},ParseContext.prototype.childContextForFieldPath=function(field){var childPath=null==this.path?null:this.path.child(field),context=new ParseContext(this.dataSource,this.methodName,childPath,!1,this.fieldTransforms,this.fieldMask);return context.validatePath(),context},ParseContext.prototype.childContextForArray=function(){return new ParseContext(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},ParseContext.prototype.createError=function(reason){var fieldDescription=null===this.path||this.path.isEmpty()?'':' (found in field '+this.path.toString()+')';return new FirestoreError(Code.INVALID_ARGUMENT,'Function '+this.methodName+'() called with invalid data. '+reason+fieldDescription)},ParseContext.prototype.contains=function(fieldPath){return void 0!==this.fieldMask.find(function(field){return fieldPath.isPrefixOf(field)})||void 0!==this.fieldTransforms.find(function(transform){return fieldPath.isPrefixOf(transform.field)})},ParseContext.prototype.validatePath=function(){if(null!==this.path)for(var i=0;i<this.path.length;i++)this.validatePathSegment(this.path.get(i))},ParseContext.prototype.validatePathSegment=function(segment){if(isWrite(this.dataSource)&&RESERVED_FIELD_REGEX.test(segment))throw this.createError('Document fields cannot begin and end with __')},ParseContext}(),DocumentKeyReference=function(){return function DocumentKeyReference(databaseId,key){this.databaseId=databaseId,this.key=key}}(),UserDataConverter=function(){function UserDataConverter(preConverter){this.preConverter=preConverter}return UserDataConverter.prototype.parseSetData=function(methodName,input){var context=new ParseContext(UserDataSource.Set,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var updateData=this.parseData(input,context);return new ParsedSetData(updateData,null,context.fieldTransforms)},UserDataConverter.prototype.parseMergeData=function(methodName,input,fieldPaths){var context=new ParseContext(UserDataSource.MergeSet,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var updateData=this.parseData(input,context),fieldMask,fieldTransforms;if(!fieldPaths)fieldMask=new FieldMask(context.fieldMask),fieldTransforms=context.fieldTransforms;else{for(var validatedFieldPaths=[],_i=0,fieldPaths_1=fieldPaths;_i<fieldPaths_1.length;_i++){var stringOrFieldPath=fieldPaths_1[_i],fieldPath=void 0;if(stringOrFieldPath instanceof FieldPath$1)fieldPath=stringOrFieldPath._internalPath;else if('string'==typeof stringOrFieldPath)fieldPath=fieldPathFromDotSeparatedString(methodName,stringOrFieldPath);else throw fail('Expected stringOrFieldPath to be a string or a FieldPath');if(!context.contains(fieldPath))throw new FirestoreError(Code.INVALID_ARGUMENT,'Field \''+fieldPath+'\' is specified in your field mask but missing from your input data.');validatedFieldPaths.push(fieldPath)}fieldMask=new FieldMask(validatedFieldPaths),fieldTransforms=context.fieldTransforms.filter(function(transform){return fieldMask.covers(transform.field)})}return new ParsedSetData(updateData,fieldMask,fieldTransforms)},UserDataConverter.prototype.parseUpdateData=function(methodName,input){var _this=this,context=new ParseContext(UserDataSource.Update,methodName,FieldPath.EMPTY_PATH);validatePlainObject('Data must be an object, but it was:',context,input);var fieldMaskPaths=[],updateData=ObjectValue.EMPTY;forEach(input,function(key,value){var path=fieldPathFromDotSeparatedString(methodName,key),childContext=context.childContextForFieldPath(path);if(value=_this.runPreConverter(value,childContext),value instanceof DeleteFieldValueImpl)fieldMaskPaths.push(path);else{var parsedValue=_this.parseData(value,childContext);null!=parsedValue&&(fieldMaskPaths.push(path),updateData=updateData.set(path,parsedValue))}});var mask=new FieldMask(fieldMaskPaths);return new ParsedUpdateData(updateData,mask,context.fieldTransforms)},UserDataConverter.prototype.parseUpdateVarargs=function(methodName,field,value,moreFieldsAndValues){var context=new ParseContext(UserDataSource.Update,methodName,FieldPath.EMPTY_PATH),keys=[fieldPathFromArgument(methodName,field)],values$$1=[value];if(0!=moreFieldsAndValues.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function '+methodName+'() needs to be called with an even number '+'of arguments that alternate between field names and values.');for(var i=0;i<moreFieldsAndValues.length;i+=2)keys.push(fieldPathFromArgument(methodName,moreFieldsAndValues[i])),values$$1.push(moreFieldsAndValues[i+1]);for(var fieldMaskPaths=[],updateData=ObjectValue.EMPTY,i=0;i<keys.length;++i){var path=keys[i],childContext=context.childContextForFieldPath(path),value_1=this.runPreConverter(values$$1[i],childContext);if(value_1 instanceof DeleteFieldValueImpl)fieldMaskPaths.push(path);else{var parsedValue=this.parseData(value_1,childContext);null!=parsedValue&&(fieldMaskPaths.push(path),updateData=updateData.set(path,parsedValue))}}var mask=new FieldMask(fieldMaskPaths);return new ParsedUpdateData(updateData,mask,context.fieldTransforms)},UserDataConverter.prototype.parseQueryValue=function(methodName,input){var context=new ParseContext(UserDataSource.Argument,methodName,FieldPath.EMPTY_PATH),parsed=this.parseData(input,context);return assert(null!=parsed,'Parsed data should not be null.'),assert(0===context.fieldTransforms.length,'Field transforms should have been disallowed.'),parsed},UserDataConverter.prototype.runPreConverter=function(input,context){try{return this.preConverter(input)}catch(e){var message=errorMessage(e);throw context.createError(message)}},UserDataConverter.prototype.parseData=function(input,context){if(input=this.runPreConverter(input,context),looksLikeJsonObject(input))return validatePlainObject('Unsupported field value:',context,input),this.parseObject(input,context);if(input instanceof FieldValueImpl)return this.parseSentinelFieldValue(input,context),null;if(context.path&&context.fieldMask.push(context.path),input instanceof Array){if(context.arrayElement)throw context.createError('Nested arrays are not supported');return this.parseArray(input,context)}return this.parseScalarValue(input,context)},UserDataConverter.prototype.parseObject=function(obj,context){var _this=this,result=new SortedMap(primitiveComparator);return isEmpty(obj)?context.path&&0<context.path.length&&context.fieldMask.push(context.path):forEach(obj,function(key,val){var parsedValue=_this.parseData(val,context.childContextForField(key));null!=parsedValue&&(result=result.insert(key,parsedValue))}),new ObjectValue(result)},UserDataConverter.prototype.parseArray=function(array,context){for(var result=[],entryIndex=0,_i=0,array_1=array;_i<array_1.length;_i++){var entry=array_1[_i],parsedEntry=this.parseData(entry,context.childContextForArray(entryIndex));null==parsedEntry&&(parsedEntry=NullValue.INSTANCE),result.push(parsedEntry),entryIndex++}return new ArrayValue(result)},UserDataConverter.prototype.parseSentinelFieldValue=function(value,context){if(!isWrite(context.dataSource))throw context.createError(value._methodName+'() can only be used with update() and set()');if(null===context.path)throw context.createError(value._methodName+'() is not currently supported inside arrays');if(value instanceof DeleteFieldValueImpl){if(context.dataSource===UserDataSource.MergeSet)context.fieldMask.push(context.path);else if(context.dataSource===UserDataSource.Update)throw assert(0<context.path.length,'FieldValue.delete() at the top level should have already'+' been handled.'),context.createError('FieldValue.delete() can only appear at the top level '+'of your update data');else throw context.createError('FieldValue.delete() cannot be used with set() unless you pass '+'{merge:true}');}else if(value instanceof ServerTimestampFieldValueImpl)context.fieldTransforms.push(new FieldTransform(context.path,ServerTimestampTransform.instance));else if(value instanceof ArrayUnionFieldValueImpl){var parsedElements=this.parseArrayTransformElements(value._methodName,value._elements),arrayUnion=new ArrayUnionTransformOperation(parsedElements);context.fieldTransforms.push(new FieldTransform(context.path,arrayUnion))}else if(value instanceof ArrayRemoveFieldValueImpl){var parsedElements=this.parseArrayTransformElements(value._methodName,value._elements),arrayRemove=new ArrayRemoveTransformOperation(parsedElements);context.fieldTransforms.push(new FieldTransform(context.path,arrayRemove))}else fail('Unknown FieldValue type: '+value)},UserDataConverter.prototype.parseScalarValue=function(value,context){if(null===value)return NullValue.INSTANCE;if('number'==typeof value)return isSafeInteger(value)?new IntegerValue(value):new DoubleValue(value);if('boolean'==typeof value)return BooleanValue.of(value);if('string'==typeof value)return new StringValue(value);if(value instanceof Date)return new TimestampValue(Timestamp.fromDate(value));if(value instanceof Timestamp)return new TimestampValue(new Timestamp(value.seconds,1e3*_Mathfloor(value.nanoseconds/1e3)));if(value instanceof GeoPoint)return new GeoPointValue(value);if(value instanceof Blob)return new BlobValue(value);if(value instanceof DocumentKeyReference)return new RefValue(value.databaseId,value.key);throw context.createError('Unsupported field value: '+valueDescription(value))},UserDataConverter.prototype.parseArrayTransformElements=function(methodName,elements){var _this=this;return elements.map(function(element,i){var context=new ParseContext(UserDataSource.Argument,methodName,FieldPath.EMPTY_PATH);return _this.parseData(element,context.childContextForArray(i))})},UserDataConverter}(),DEFAULT_SSL=!0,FirestoreSettings=function(){function FirestoreSettings(settings){if(void 0===settings.host){if(void 0!==settings.ssl)throw new FirestoreError(Code.INVALID_ARGUMENT,'Can\'t provide ssl option if host option is not set');this.host='firestore.googleapis.com',this.ssl=DEFAULT_SSL}else validateNamedType('settings','non-empty string','host',settings.host),this.host=settings.host,validateNamedOptionalType('settings','boolean','ssl',settings.ssl),this.ssl=defaulted(settings.ssl,DEFAULT_SSL);validateOptionNames('settings',settings,['host','ssl','credentials','timestampsInSnapshots']),validateNamedOptionalType('settings','object','credentials',settings.credentials),this.credentials=settings.credentials,validateNamedOptionalType('settings','boolean','timestampsInSnapshots',settings.timestampsInSnapshots),this.timestampsInSnapshots=defaulted(settings.timestampsInSnapshots,!1)}return FirestoreSettings.prototype.isEqual=function(other){return this.host===other.host&&this.ssl===other.ssl&&this.timestampsInSnapshots===other.timestampsInSnapshots&&this.credentials===other.credentials},FirestoreSettings}(),FirestoreConfig=function(){return function FirestoreConfig(){}}(),PersistenceSettings=function(){function PersistenceSettings(enabled,settings){this.enabled=enabled,assert(enabled||!settings,'Can only provide PersistenceSettings with persistence enabled'),settings=settings||{},this.experimentalTabSynchronization=defaulted(settings.experimentalTabSynchronization,!1)}return PersistenceSettings.prototype.isEqual=function(other){return this.enabled===other.enabled&&this.experimentalTabSynchronization===other.experimentalTabSynchronization},PersistenceSettings}(),Firestore=function(){function Firestore(databaseIdOrApp){var _this=this;this._queue=new AsyncQueue,this.INTERNAL={delete:function(options){return tslib_1.__awaiter(_this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this._firestoreClient?[2,this._firestoreClient.shutdown(options)]:[2]})})}};var config=new FirestoreConfig;if('object'==typeof databaseIdOrApp.options){var app=databaseIdOrApp;config.firebaseApp=app,config.databaseId=Firestore.databaseIdFromApp(app),config.persistenceKey=config.firebaseApp.name,config.credentials=new FirebaseCredentialsProvider(app)}else{var external_1=databaseIdOrApp;if(!external_1.projectId)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide projectId');config.databaseId=new DatabaseId(external_1.projectId,external_1.database),config.persistenceKey='[DEFAULT]',config.credentials=new EmptyCredentialsProvider}config.settings=new FirestoreSettings({}),this._config=config,this._databaseId=config.databaseId}return Firestore.prototype.settings=function(settingsLiteral){if(validateExactNumberOfArgs('Firestore.settings',arguments,1),validateArgType('Firestore.settings','object',1,settingsLiteral),contains(settingsLiteral,'persistence'))throw new FirestoreError(Code.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to '+'firestore.enablePersistence().');var newSettings=new FirestoreSettings(settingsLiteral);if(this._firestoreClient&&!this._config.settings.isEqual(newSettings))throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore has already been started and its settings can no longer '+'be changed. You can only call settings() before calling any other '+'methods on a Firestore object.');this._config.settings=newSettings,void 0!==newSettings.credentials&&(this._config.credentials=makeCredentialsProvider(newSettings.credentials))},Firestore.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},Firestore.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},Firestore.prototype.enablePersistence=function(settings){if(this._firestoreClient)throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore has already been started and persistence can no longer '+'be enabled. You can only call enablePersistence() before calling '+'any other methods on a Firestore object.');return this.configureClient(new PersistenceSettings(!0,settings))},Firestore.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(new PersistenceSettings(!1)),this._firestoreClient},Firestore.prototype.configureClient=function(persistenceSettings){var _this=this;assert(!!this._config.settings.host,'FirestoreSettings.host cannot be falsey'),this._config.settings.timestampsInSnapshots||error('\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = firebase.firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get(\'created_at\');\n  // New:\n  const timestamp = snapshot.get(\'created_at\');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK.'),assert(!this._firestoreClient,'configureClient() called multiple times');var databaseInfo=new DatabaseInfo(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl);return this._dataConverter=new UserDataConverter(function(value){if(value instanceof DocumentReference){var thisDb=_this._config.databaseId,otherDb=value.firestore._config.databaseId;if(!otherDb.isEqual(thisDb))throw new FirestoreError(Code.INVALID_ARGUMENT,'Document reference is for database '+(otherDb.projectId+'/'+otherDb.database+' but should be ')+('for database '+thisDb.projectId+'/'+thisDb.database));return new DocumentKeyReference(_this._config.databaseId,value._key)}return value}),this._firestoreClient=new FirestoreClient(PlatformSupport.getPlatform(),databaseInfo,this._config.credentials,this._queue),this._firestoreClient.start(persistenceSettings)},Firestore.databaseIdFromApp=function(app){var options=app.options;if(!contains(options,'projectId'))throw new FirestoreError(Code.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var projectId=options.projectId;if(!projectId||'string'!=typeof projectId)throw new FirestoreError(Code.INVALID_ARGUMENT,'projectId must be a string in FirebaseApp.options');return new DatabaseId(projectId)},Object.defineProperty(Firestore.prototype,'app',{get:function(){if(!this._config.firebaseApp)throw new FirestoreError(Code.FAILED_PRECONDITION,'Firestore was not initialized using the Firebase SDK. \'app\' is '+'not available');return this._config.firebaseApp},enumerable:!0,configurable:!0}),Firestore.prototype.collection=function(pathString){if(validateExactNumberOfArgs('Firestore.collection',arguments,1),validateArgType('Firestore.collection','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty collection path to collection()');return this.ensureClientConfigured(),new CollectionReference(ResourcePath.fromString(pathString),this)},Firestore.prototype.doc=function(pathString){if(validateExactNumberOfArgs('Firestore.doc',arguments,1),validateArgType('Firestore.doc','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty document path to doc()');return this.ensureClientConfigured(),DocumentReference.forPath(ResourcePath.fromString(pathString),this)},Firestore.prototype.runTransaction=function(updateFunction){var _this=this;return validateExactNumberOfArgs('Firestore.runTransaction',arguments,1),validateArgType('Firestore.runTransaction','function',1,updateFunction),this.ensureClientConfigured().transaction(function(transaction){return updateFunction(new Transaction$1(_this,transaction))})},Firestore.prototype.batch=function(){return this.ensureClientConfigured(),new WriteBatch(this)},Object.defineProperty(Firestore,'logLevel',{get:function(){switch(getLogLevel()){case LogLevel.DEBUG:return'debug';case LogLevel.ERROR:return'error';case LogLevel.SILENT:return'silent';default:return fail('Unknown log level: '+getLogLevel());}},enumerable:!0,configurable:!0}),Firestore.setLogLevel=function(level){switch(validateExactNumberOfArgs('Firestore.setLogLevel',arguments,1),validateArgType('Firestore.setLogLevel','non-empty string',1,level),level){case'debug':setLogLevel(LogLevel.DEBUG);break;case'error':setLogLevel(LogLevel.ERROR);break;case'silent':setLogLevel(LogLevel.SILENT);break;default:throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid log level: '+level);}},Firestore.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},Firestore}(),Transaction$1=function(){function Transaction(_firestore,_transaction){this._firestore=_firestore,this._transaction=_transaction}return Transaction.prototype.get=function(documentRef){var _this=this;validateExactNumberOfArgs('Transaction.get',arguments,1);var ref=validateReference('Transaction.get',documentRef,this._firestore);return this._transaction.lookup([ref._key]).then(function(docs){if(!docs||1!==docs.length)return fail('Mismatch in docs returned from document lookup.');var doc=docs[0];if(doc instanceof NoDocument)return new DocumentSnapshot(_this._firestore,ref._key,null,!1,!1);if(doc instanceof Document)return new DocumentSnapshot(_this._firestore,ref._key,doc,!1,!1);throw fail('BatchGetDocumentsRequest returned unexpected document type: '+doc.constructor.name)})},Transaction.prototype.set=function(documentRef,value,options){validateBetweenNumberOfArgs('Transaction.set',arguments,2,3);var ref=validateReference('Transaction.set',documentRef,this._firestore);options=validateSetOptions('Transaction.set',options);var parsed=options.merge||options.mergeFields?this._firestore._dataConverter.parseMergeData('Transaction.set',value,options.mergeFields):this._firestore._dataConverter.parseSetData('Transaction.set',value);return this._transaction.set(ref._key,parsed),this},Transaction.prototype.update=function(documentRef,fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=3;_i<arguments.length;_i++)moreFieldsAndValues[_i-3]=arguments[_i];var ref,parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('Transaction.update',arguments,3),ref=validateReference('Transaction.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateVarargs('Transaction.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('Transaction.update',arguments,2),ref=validateReference('Transaction.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateData('Transaction.update',fieldOrUpdateData)),this._transaction.update(ref._key,parsed),this},Transaction.prototype.delete=function(documentRef){validateExactNumberOfArgs('Transaction.delete',arguments,1);var ref=validateReference('Transaction.delete',documentRef,this._firestore);return this._transaction.delete(ref._key),this},Transaction}(),WriteBatch=function(){function WriteBatch(_firestore){this._firestore=_firestore,this._mutations=[],this._committed=!1}return WriteBatch.prototype.set=function(documentRef,value,options){validateBetweenNumberOfArgs('WriteBatch.set',arguments,2,3),this.verifyNotCommitted();var ref=validateReference('WriteBatch.set',documentRef,this._firestore);options=validateSetOptions('WriteBatch.set',options);var parsed=options.merge||options.mergeFields?this._firestore._dataConverter.parseMergeData('WriteBatch.set',value,options.mergeFields):this._firestore._dataConverter.parseSetData('WriteBatch.set',value);return this._mutations=this._mutations.concat(parsed.toMutations(ref._key,Precondition.NONE)),this},WriteBatch.prototype.update=function(documentRef,fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=3;_i<arguments.length;_i++)moreFieldsAndValues[_i-3]=arguments[_i];this.verifyNotCommitted();var ref,parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('WriteBatch.update',arguments,3),ref=validateReference('WriteBatch.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateVarargs('WriteBatch.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('WriteBatch.update',arguments,2),ref=validateReference('WriteBatch.update',documentRef,this._firestore),parsed=this._firestore._dataConverter.parseUpdateData('WriteBatch.update',fieldOrUpdateData)),this._mutations=this._mutations.concat(parsed.toMutations(ref._key,Precondition.exists(!0))),this},WriteBatch.prototype.delete=function(documentRef){validateExactNumberOfArgs('WriteBatch.delete',arguments,1),this.verifyNotCommitted();var ref=validateReference('WriteBatch.delete',documentRef,this._firestore);return this._mutations=this._mutations.concat(new DeleteMutation(ref._key,Precondition.NONE)),this},WriteBatch.prototype.commit=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(){return this.verifyNotCommitted(),this._committed=!0,0<this._mutations.length?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},WriteBatch.prototype.verifyNotCommitted=function(){if(this._committed)throw new FirestoreError(Code.FAILED_PRECONDITION,'A write batch can no longer be used after commit() '+'has been called.')},WriteBatch}(),DocumentReference=function(){function DocumentReference(_key,firestore){this._key=_key,this.firestore=firestore,this._firestoreClient=this.firestore.ensureClientConfigured()}return DocumentReference.forPath=function(path,firestore){if(0!=path.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid document reference. Document '+'references must have an even number of segments, but '+(path.canonicalString()+' has '+path.length));return new DocumentReference(new DocumentKey(path),firestore)},Object.defineProperty(DocumentReference.prototype,'id',{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentReference.prototype,'parent',{get:function(){return new CollectionReference(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentReference.prototype,'path',{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),DocumentReference.prototype.collection=function(pathString){if(validateExactNumberOfArgs('DocumentReference.collection',arguments,1),validateArgType('DocumentReference.collection','non-empty string',1,pathString),!pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Must provide a non-empty collection name to collection()');var path=ResourcePath.fromString(pathString);return new CollectionReference(this._key.path.child(path),this.firestore)},DocumentReference.prototype.isEqual=function(other){if(!(other instanceof DocumentReference))throw invalidClassError('isEqual','DocumentReference',1,other);return this.firestore===other.firestore&&this._key.isEqual(other._key)},DocumentReference.prototype.set=function(value,options){validateBetweenNumberOfArgs('DocumentReference.set',arguments,1,2),options=validateSetOptions('DocumentReference.set',options);var parsed=options.merge||options.mergeFields?this.firestore._dataConverter.parseMergeData('DocumentReference.set',value,options.mergeFields):this.firestore._dataConverter.parseSetData('DocumentReference.set',value);return this._firestoreClient.write(parsed.toMutations(this._key,Precondition.NONE))},DocumentReference.prototype.update=function(fieldOrUpdateData,value){for(var moreFieldsAndValues=[],_i=2;_i<arguments.length;_i++)moreFieldsAndValues[_i-2]=arguments[_i];var parsed;return'string'==typeof fieldOrUpdateData||fieldOrUpdateData instanceof FieldPath$1?(validateAtLeastNumberOfArgs('DocumentReference.update',arguments,2),parsed=this.firestore._dataConverter.parseUpdateVarargs('DocumentReference.update',fieldOrUpdateData,value,moreFieldsAndValues)):(validateExactNumberOfArgs('DocumentReference.update',arguments,1),parsed=this.firestore._dataConverter.parseUpdateData('DocumentReference.update',fieldOrUpdateData)),this._firestoreClient.write(parsed.toMutations(this._key,Precondition.exists(!0)))},DocumentReference.prototype.delete=function(){return validateExactNumberOfArgs('DocumentReference.delete',arguments,0),this._firestoreClient.write([new DeleteMutation(this._key,Precondition.NONE)])},DocumentReference.prototype.onSnapshot=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];validateBetweenNumberOfArgs('DocumentReference.onSnapshot',arguments,1,4);var options={includeMetadataChanges:!1},currArg=0,observer;'object'!=typeof args[currArg]||isPartialObserver(args[currArg])||(options=args[currArg],validateOptionNames('DocumentReference.onSnapshot',options,['includeMetadataChanges']),validateNamedOptionalType('DocumentReference.onSnapshot','boolean','includeMetadataChanges',options.includeMetadataChanges),currArg++);var internalOptions={includeMetadataChanges:options.includeMetadataChanges};return isPartialObserver(args[currArg])?observer=args[currArg]:(validateArgType('DocumentReference.onSnapshot','function',currArg,args[currArg]),validateOptionalArgType('DocumentReference.onSnapshot','function',currArg+1,args[currArg+1]),validateOptionalArgType('DocumentReference.onSnapshot','function',currArg+2,args[currArg+2]),observer={next:args[currArg],error:args[currArg+1],complete:args[currArg+2]}),this.onSnapshotInternal(internalOptions,observer)},DocumentReference.prototype.onSnapshotInternal=function(options,observer){var _this=this,errHandler=function(err){console.error('Uncaught Error in onSnapshot:',err)};observer.error&&(errHandler=observer.error.bind(observer));var asyncObserver=new AsyncObserver({next:function(snapshot){if(observer.next){assert(1>=snapshot.docs.size,'Too many documents returned on a document query');var doc=snapshot.docs.get(_this._key);observer.next(new DocumentSnapshot(_this.firestore,_this._key,doc,snapshot.fromCache,snapshot.hasPendingWrites))}},error:errHandler}),internalListener=this._firestoreClient.listen(Query.atPath(this._key.path),asyncObserver,options);return function(){asyncObserver.mute(),_this._firestoreClient.unlisten(internalListener)}},DocumentReference.prototype.get=function(options){var _this=this;return validateBetweenNumberOfArgs('DocumentReference.get',arguments,0,1),validateGetOptions('DocumentReference.get',options),new Promise(function(resolve,reject){options&&'cache'===options.source?_this.firestore.ensureClientConfigured().getDocumentFromLocalCache(_this._key).then(function(doc){resolve(new DocumentSnapshot(_this.firestore,_this._key,doc,!0,!!(doc instanceof Document)&&doc.hasLocalMutations))},reject):_this.getViaSnapshotListener(resolve,reject,options)})},DocumentReference.prototype.getViaSnapshotListener=function(resolve,reject,options){var unlisten=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(snap){unlisten(),!snap.exists&&snap.metadata.fromCache?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get document because the client is '+'offline.')):snap.exists&&snap.metadata.fromCache&&options&&'server'===options.source?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get document from server. (However, this '+'document does exist in the local cache. Run again '+'without setting source to "server" to '+'retrieve the cached document.)')):resolve(snap)},error:reject})},DocumentReference}(),SnapshotMetadata=function(){function SnapshotMetadata(hasPendingWrites,fromCache){this.hasPendingWrites=hasPendingWrites,this.fromCache=fromCache}return SnapshotMetadata.prototype.isEqual=function(other){return this.hasPendingWrites===other.hasPendingWrites&&this.fromCache===other.fromCache},SnapshotMetadata}(),DocumentSnapshot=function(){function DocumentSnapshot(_firestore,_key,_document,_fromCache,_hasPendingWrites){this._firestore=_firestore,this._key=_key,this._document=_document,this._fromCache=_fromCache,this._hasPendingWrites=_hasPendingWrites}return DocumentSnapshot.prototype.data=function(options){return validateBetweenNumberOfArgs('DocumentSnapshot.data',arguments,0,1),options=validateSnapshotOptions('DocumentSnapshot.data',options),this._document?this.convertObject(this._document.data,FieldValueOptions.fromSnapshotOptions(options,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},DocumentSnapshot.prototype.get=function(fieldPath,options){if(validateBetweenNumberOfArgs('DocumentSnapshot.get',arguments,1,2),options=validateSnapshotOptions('DocumentSnapshot.get',options),this._document){var value=this._document.data.field(fieldPathFromArgument('DocumentSnapshot.get',fieldPath));if(void 0!==value)return this.convertValue(value,FieldValueOptions.fromSnapshotOptions(options,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(DocumentSnapshot.prototype,'id',{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'ref',{get:function(){return new DocumentReference(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'exists',{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(DocumentSnapshot.prototype,'metadata',{get:function(){return new SnapshotMetadata(this._hasPendingWrites,this._fromCache)},enumerable:!0,configurable:!0}),DocumentSnapshot.prototype.isEqual=function(other){if(!(other instanceof DocumentSnapshot))throw invalidClassError('isEqual','DocumentSnapshot',1,other);return this._firestore===other._firestore&&this._fromCache===other._fromCache&&this._key.isEqual(other._key)&&(null===this._document?null===other._document:this._document.isEqual(other._document))},DocumentSnapshot.prototype.convertObject=function(data,options){var _this=this,result={};return data.forEach(function(key,value){result[key]=_this.convertValue(value,options)}),result},DocumentSnapshot.prototype.convertValue=function(value,options){if(value instanceof ObjectValue)return this.convertObject(value,options);if(value instanceof ArrayValue)return this.convertArray(value,options);if(value instanceof RefValue){var key=value.value(options),database=this._firestore.ensureClientConfigured().databaseId();return value.databaseId.isEqual(database)||error('Document '+this._key.path+' contains a document '+'reference within a different database ('+(value.databaseId.projectId+'/'+value.databaseId.database+') which is not ')+'supported. It will be treated as a reference in the current '+('database ('+database.projectId+'/'+database.database+') ')+'instead.'),new DocumentReference(key,this._firestore)}return value.value(options)},DocumentSnapshot.prototype.convertArray=function(data,options){var _this=this;return data.internalValue.map(function(value){return _this.convertValue(value,options)})},DocumentSnapshot}(),QueryDocumentSnapshot=function(_super){function QueryDocumentSnapshot(firestore,key,document,fromCache,hasPendingWrites){return _super.call(this,firestore,key,document,fromCache,hasPendingWrites)||this}return tslib_1.__extends(QueryDocumentSnapshot,_super),QueryDocumentSnapshot.prototype.data=function(options){var data=_super.prototype.data.call(this,options);return assert('object'==typeof data,'Document in a QueryDocumentSnapshot should exist'),data},QueryDocumentSnapshot}(DocumentSnapshot),Query$1=function(){function Query$$1(_query,firestore){this._query=_query,this.firestore=firestore}return Query$$1.prototype.where=function(field,opStr,value){validateExactNumberOfArgs('Query.where',arguments,3),validateArgType('Query.where','non-empty string',2,opStr),validateDefined('Query.where',3,value);var fieldPath=fieldPathFromArgument('Query.where',field),relationOp=RelationOp.fromString(opStr),fieldValue;if(fieldPath.isKeyField()){if(relationOp===RelationOp.ARRAY_CONTAINS)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid Query. You can\'t perform array-contains queries on '+'FieldPath.documentId() since document IDs are not arrays.');if('string'==typeof value){if(-1!==value.indexOf('/'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'valid document ID if the first parameter is '+'FieldPath.documentId(), but it contains a slash.');if(''===value)throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'valid document ID if the first parameter is '+'FieldPath.documentId(), but it was an empty string.');var path=this._query.path.child(new ResourcePath([value]));assert(0==path.length%2,'Path should be a document key'),fieldValue=new RefValue(this.firestore._databaseId,new DocumentKey(path))}else if(value instanceof DocumentReference){fieldValue=new RefValue(this.firestore._databaseId,value._key)}else throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.where() requires its third parameter to be a '+'string or a DocumentReference if the first parameter is '+'FieldPath.documentId(), but it was: '+(valueDescription(value)+'.'))}else fieldValue=this.firestore._dataConverter.parseQueryValue('Query.where',value);var filter=Filter.create(fieldPath,relationOp,fieldValue);return this.validateNewFilter(filter),new Query$$1(this._query.addFilter(filter),this.firestore)},Query$$1.prototype.orderBy=function(field,directionStr){validateBetweenNumberOfArgs('Query.orderBy',arguments,1,2),validateOptionalArgType('Query.orderBy','non-empty string',2,directionStr);var direction;if(void 0===directionStr||'asc'===directionStr)direction=Direction.ASCENDING;else if('desc'===directionStr)direction=Direction.DESCENDING;else throw new FirestoreError(Code.INVALID_ARGUMENT,'Function Query.orderBy() has unknown direction \''+directionStr+'\', '+'expected \'asc\' or \'desc\'.');if(null!==this._query.startAt)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You must not call Query.startAt() or '+'Query.startAfter() before calling Query.orderBy().');if(null!==this._query.endAt)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You must not call Query.endAt() or '+'Query.endBefore() before calling Query.orderBy().');var fieldPath=fieldPathFromArgument('Query.orderBy',field),orderBy=new OrderBy(fieldPath,direction);return this.validateNewOrderBy(orderBy),new Query$$1(this._query.addOrderBy(orderBy),this.firestore)},Query$$1.prototype.limit=function(n){if(validateExactNumberOfArgs('Query.limit',arguments,1),validateArgType('Query.limit','number',1,n),0>=n)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid Query. Query limit ('+n+') is invalid. Limit must be '+'positive.');return new Query$$1(this._query.withLimit(n),this.firestore)},Query$$1.prototype.startAt=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.startAt',arguments,1);var bound=this.boundFromDocOrFields('Query.startAt',docOrField,fields,!0);return new Query$$1(this._query.withStartAt(bound),this.firestore)},Query$$1.prototype.startAfter=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.startAfter',arguments,1);var bound=this.boundFromDocOrFields('Query.startAfter',docOrField,fields,!1);return new Query$$1(this._query.withStartAt(bound),this.firestore)},Query$$1.prototype.endBefore=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.endBefore',arguments,1);var bound=this.boundFromDocOrFields('Query.endBefore',docOrField,fields,!0);return new Query$$1(this._query.withEndAt(bound),this.firestore)},Query$$1.prototype.endAt=function(docOrField){for(var fields=[],_i=1;_i<arguments.length;_i++)fields[_i-1]=arguments[_i];validateAtLeastNumberOfArgs('Query.endAt',arguments,1);var bound=this.boundFromDocOrFields('Query.endAt',docOrField,fields,!1);return new Query$$1(this._query.withEndAt(bound),this.firestore)},Query$$1.prototype.isEqual=function(other){if(!(other instanceof Query$$1))throw invalidClassError('isEqual','Query',1,other);return this.firestore===other.firestore&&this._query.isEqual(other._query)},Query$$1.prototype.boundFromDocOrFields=function(methodName,docOrField,fields,before){if(validateDefined(methodName,1,docOrField),docOrField instanceof DocumentSnapshot){if(0<fields.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Too many arguments provided to '+methodName+'().');var snap=docOrField;if(!snap.exists)throw new FirestoreError(Code.NOT_FOUND,'Can\'t use a DocumentSnapshot that doesn\'t exist for '+(methodName+'().'));return this.boundFromDocument(methodName,snap._document,before)}var allFields=[docOrField].concat(fields);return this.boundFromFields(methodName,allFields,before)},Query$$1.prototype.boundFromDocument=function(methodName,doc,before){for(var components=[],_i=0,_a=this._query.orderBy,orderBy;_i<_a.length;_i++)if(orderBy=_a[_i],orderBy.field.isKeyField())components.push(new RefValue(this.firestore._databaseId,doc.key));else{var value=doc.field(orderBy.field);if(void 0!==value)components.push(value);else{var field=orderBy.field.canonicalString();throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a '+('document for which the field \''+field+'\' (used as the ')+'orderBy) does not exist.')}}return new Bound(components,before)},Query$$1.prototype.boundFromFields=function(methodName,values$$1,before){var orderBy=this._query.explicitOrderBy;if(values$$1.length>orderBy.length)throw new FirestoreError(Code.INVALID_ARGUMENT,'Too many arguments provided to '+methodName+'(). '+'The number of arguments must be less than or equal to the '+'number of Query.orderBy() clauses');for(var components=[],i=0;i<values$$1.length;i++){var rawValue=values$$1[i],orderByComponent=orderBy[i];if(orderByComponent.field.isKeyField()){if('string'!=typeof rawValue)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Expected a string for document ID in '+(methodName+'(), but got a '+typeof rawValue));if(-1!==rawValue.indexOf('/'))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Document ID \''+rawValue+'\' contains a slash in '+(methodName+'()'));var key=new DocumentKey(this._query.path.child(rawValue));components.push(new RefValue(this.firestore._databaseId,key))}else{var wrapped=this.firestore._dataConverter.parseQueryValue(methodName,rawValue);components.push(wrapped)}}return new Bound(components,before)},Query$$1.prototype.onSnapshot=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];validateBetweenNumberOfArgs('Query.onSnapshot',arguments,1,4);var options={},currArg=0,observer;return'object'!=typeof args[currArg]||isPartialObserver(args[currArg])||(options=args[currArg],validateOptionNames('Query.onSnapshot',options,['includeMetadataChanges']),validateNamedOptionalType('Query.onSnapshot','boolean','includeMetadataChanges',options.includeMetadataChanges),currArg++),isPartialObserver(args[currArg])?observer=args[currArg]:(validateArgType('Query.onSnapshot','function',currArg,args[currArg]),validateOptionalArgType('Query.onSnapshot','function',currArg+1,args[currArg+1]),validateOptionalArgType('Query.onSnapshot','function',currArg+2,args[currArg+2]),observer={next:args[currArg],error:args[currArg+1],complete:args[currArg+2]}),this.onSnapshotInternal(options,observer)},Query$$1.prototype.onSnapshotInternal=function(options,observer){var _this=this,errHandler=function(err){console.error('Uncaught Error in onSnapshot:',err)};observer.error&&(errHandler=observer.error.bind(observer));var asyncObserver=new AsyncObserver({next:function(result){observer.next&&observer.next(new QuerySnapshot(_this.firestore,_this._query,result))},error:errHandler}),firestoreClient=this.firestore.ensureClientConfigured(),internalListener=firestoreClient.listen(this._query,asyncObserver,options);return function(){asyncObserver.mute(),firestoreClient.unlisten(internalListener)}},Query$$1.prototype.get=function(options){var _this=this;return validateBetweenNumberOfArgs('Query.get',arguments,0,1),validateGetOptions('Query.get',options),new Promise(function(resolve,reject){options&&'cache'===options.source?_this.firestore.ensureClientConfigured().getDocumentsFromLocalCache(_this._query).then(function(viewSnap){resolve(new QuerySnapshot(_this.firestore,_this._query,viewSnap))},reject):_this.getViaSnapshotListener(resolve,reject,options)})},Query$$1.prototype.getViaSnapshotListener=function(resolve,reject,options){var unlisten=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(result){unlisten(),result.metadata.fromCache&&options&&'server'===options.source?reject(new FirestoreError(Code.UNAVAILABLE,'Failed to get documents from server. (However, these '+'documents may exist in the local cache. Run again '+'without setting source to "server" to '+'retrieve the cached documents.)')):resolve(result)},error:reject})},Query$$1.prototype.validateNewFilter=function(filter){if(filter instanceof RelationFilter)if(filter.isInequality()){var existingField=this._query.getInequalityFilterField();if(null!==existingField&&!existingField.isEqual(filter.field))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. All where filters with an inequality'+' (<, <=, >, or >=) must be on the same field. But you have'+(' inequality filters on \''+existingField.toString()+'\'')+(' and \''+filter.field.toString()+'\''));var firstOrderByField=this._query.getFirstOrderByField();null!==firstOrderByField&&this.validateOrderByAndInequalityMatch(filter.field,firstOrderByField)}else if(filter.op===RelationOp.ARRAY_CONTAINS&&this._query.hasArrayContainsFilter())throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. Queries only support a single array-contains '+'filter.')},Query$$1.prototype.validateNewOrderBy=function(orderBy){if(null===this._query.getFirstOrderByField()){var inequalityField=this._query.getInequalityFilterField();null!==inequalityField&&this.validateOrderByAndInequalityMatch(inequalityField,orderBy.field)}},Query$$1.prototype.validateOrderByAndInequalityMatch=function(inequality,orderBy){if(!orderBy.isEqual(inequality))throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid query. You have a where filter with an inequality '+('(<, <=, >, or >=) on field \''+inequality.toString()+'\' ')+('and so you must also use \''+inequality.toString()+'\' ')+'as your first Query.orderBy(), but your first Query.orderBy() '+('is on field \''+orderBy.toString()+'\' instead.'))},Query$$1}(),QuerySnapshot=function(){function QuerySnapshot(_firestore,_originalQuery,_snapshot){this._firestore=_firestore,this._originalQuery=_originalQuery,this._snapshot=_snapshot,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new SnapshotMetadata(_snapshot.hasPendingWrites,_snapshot.fromCache)}return Object.defineProperty(QuerySnapshot.prototype,'docs',{get:function(){var result=[];return this.forEach(function(doc){return result.push(doc)}),result},enumerable:!0,configurable:!0}),Object.defineProperty(QuerySnapshot.prototype,'empty',{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(QuerySnapshot.prototype,'size',{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),QuerySnapshot.prototype.forEach=function(callback,thisArg){var _this=this;validateBetweenNumberOfArgs('QuerySnapshot.forEach',arguments,1,2),validateArgType('QuerySnapshot.forEach','function',1,callback),this._snapshot.docs.forEach(function(doc){callback.call(thisArg,_this.convertToDocumentImpl(doc))})},Object.defineProperty(QuerySnapshot.prototype,'query',{get:function(){return new Query$1(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),QuerySnapshot.prototype.docChanges=function(options){options&&(validateOptionNames('QuerySnapshot.docChanges',options,['includeMetadataChanges']),validateNamedOptionalType('QuerySnapshot.docChanges','boolean','includeMetadataChanges',options.includeMetadataChanges));var includeMetadataChanges=!!(options&&options.includeMetadataChanges);if(includeMetadataChanges&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(Code.INVALID_ARGUMENT,'To include metadata changes with your document changes, you must '+'also pass { includeMetadataChanges:true } to onSnapshot().');return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===includeMetadataChanges||(this._cachedChanges=changesFromSnapshot(this._firestore,includeMetadataChanges,this._snapshot),this._cachedChangesIncludeMetadataChanges=includeMetadataChanges),this._cachedChanges},QuerySnapshot.prototype.isEqual=function(other){if(!(other instanceof QuerySnapshot))throw invalidClassError('isEqual','QuerySnapshot',1,other);return this._firestore===other._firestore&&this._originalQuery.isEqual(other._originalQuery)&&this._snapshot.isEqual(other._snapshot)},QuerySnapshot.prototype.convertToDocumentImpl=function(doc){return new QueryDocumentSnapshot(this._firestore,doc.key,doc,this.metadata.fromCache,this._snapshot.mutatedKeys.has(doc.key))},QuerySnapshot}(),docChangesPropertiesToOverride=['length','forEach','map'].concat('undefined'==typeof Symbol?[]:[Symbol.iterator]);docChangesPropertiesToOverride.forEach(function(property){try{Object.defineProperty(QuerySnapshot.prototype.docChanges,property,{get:function(){return throwDocChangesMethodError()}})}catch(err){}});var CollectionReference=function(_super){function CollectionReference(path,firestore){var _this=_super.call(this,Query.atPath(path),firestore)||this;if(1!=path.length%2)throw new FirestoreError(Code.INVALID_ARGUMENT,'Invalid collection reference. Collection '+'references must have an odd number of segments, but '+(path.canonicalString()+' has '+path.length));return _this}return tslib_1.__extends(CollectionReference,_super),Object.defineProperty(CollectionReference.prototype,'id',{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(CollectionReference.prototype,'parent',{get:function(){var parentPath=this._query.path.popLast();return parentPath.isEmpty()?null:new DocumentReference(new DocumentKey(parentPath),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(CollectionReference.prototype,'path',{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),CollectionReference.prototype.doc=function(pathString){if(validateBetweenNumberOfArgs('CollectionReference.doc',arguments,0,1),0===arguments.length&&(pathString=AutoId.newId()),validateArgType('CollectionReference.doc','non-empty string',1,pathString),''===pathString)throw new FirestoreError(Code.INVALID_ARGUMENT,'Document path must be a non-empty string');var path=ResourcePath.fromString(pathString);return DocumentReference.forPath(this._query.path.child(path),this.firestore)},CollectionReference.prototype.add=function(value){validateExactNumberOfArgs('CollectionReference.add',arguments,1),validateArgType('CollectionReference.add','object',1,value);var docRef=this.doc();return docRef.set(value).then(function(){return docRef})},CollectionReference}(Query$1),PublicFirestore=makeConstructorPrivate(Firestore,'Use firebase.firestore() instead.'),PublicTransaction=makeConstructorPrivate(Transaction$1,'Use firebase.firestore().runTransaction() instead.'),PublicWriteBatch=makeConstructorPrivate(WriteBatch,'Use firebase.firestore().batch() instead.'),PublicDocumentReference=makeConstructorPrivate(DocumentReference,'Use firebase.firestore().doc() instead.'),PublicDocumentSnapshot=makeConstructorPrivate(DocumentSnapshot),PublicQueryDocumentSnapshot=makeConstructorPrivate(QueryDocumentSnapshot),PublicQuery=makeConstructorPrivate(Query$1),PublicQuerySnapshot=makeConstructorPrivate(QuerySnapshot),PublicCollectionReference=makeConstructorPrivate(CollectionReference,'Use firebase.firestore().collection() instead.'),firestoreNamespace={Firestore:PublicFirestore,GeoPoint:GeoPoint,Timestamp:Timestamp,Blob:PublicBlob,Transaction:PublicTransaction,WriteBatch:PublicWriteBatch,DocumentReference:PublicDocumentReference,DocumentSnapshot:PublicDocumentSnapshot,Query:PublicQuery,QueryDocumentSnapshot:PublicQueryDocumentSnapshot,QuerySnapshot:PublicQuerySnapshot,CollectionReference:PublicCollectionReference,FieldPath:FieldPath$1,FieldValue:PublicFieldValue,setLogLevel:Firestore.setLogLevel};registerFirestore(firebase),exports.registerFirestore=registerFirestore}).call(exports,__webpack_require__(9))},function(module,__webpack_exports__,__webpack_require__){'use strict';function setLogLevel(level){instances.forEach(function(inst){inst.logLevel=level})}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_require__.d(__webpack_exports__,'setLogLevel',function(){return setLogLevel}),__webpack_require__.d(__webpack_exports__,'Logger',function(){return Logger}),__webpack_require__.d(__webpack_exports__,'LogLevel',function(){return LogLevel});var instances=[],LogLevel;(function(LogLevel){LogLevel[LogLevel.DEBUG=0]='DEBUG',LogLevel[LogLevel.VERBOSE=1]='VERBOSE',LogLevel[LogLevel.INFO=2]='INFO',LogLevel[LogLevel.WARN=3]='WARN',LogLevel[LogLevel.ERROR=4]='ERROR',LogLevel[LogLevel.SILENT=5]='SILENT'})(LogLevel||(LogLevel={}));var defaultLogLevel=LogLevel.INFO,defaultLogHandler=function(instance,logType){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];if(!(logType<instance.logLevel)){var now=new Date().toISOString();switch(logType){case LogLevel.DEBUG:console.log.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.VERBOSE:console.log.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.INFO:console.info.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.WARN:console.warn.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;case LogLevel.ERROR:console.error.apply(console,['['+now+']  '+instance.name+':'].concat(args));break;default:throw new Error('Attempted to log a message with an invalid logType (value: '+logType+')');}}},Logger=function(){function Logger(name){this.name=name,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,instances.push(this)}return Object.defineProperty(Logger.prototype,'logLevel',{get:function(){return this._logLevel},set:function(val){if(!(val in LogLevel))throw new TypeError('Invalid value assigned to `logLevel`');this._logLevel=val},enumerable:!0,configurable:!0}),Object.defineProperty(Logger.prototype,'logHandler',{get:function(){return this._logHandler},set:function(val){if('function'!=typeof val)throw new TypeError('Value assigned to `logHandler` must be a function');this._logHandler=val},enumerable:!0,configurable:!0}),Logger.prototype.debug=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.DEBUG].concat(args))},Logger.prototype.log=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.VERBOSE].concat(args))},Logger.prototype.info=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.INFO].concat(args))},Logger.prototype.warn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.WARN].concat(args))},Logger.prototype.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,LogLevel.ERROR].concat(args))},Logger}()},function(module,__webpack_exports__,__webpack_require__){'use strict';var _Mathmin2=Math.min;(function(setImmediate,global){function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError('Promises must be constructed via new');if('function'!=typeof fn)throw new TypeError('not a function');this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;return 0===self._state?void self._deferreds.push(deferred):void(self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(1===self._state?resolve:reject)(deferred.promise,self._value);var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}))}function resolve(self,newValue){try{if(newValue===self)throw new TypeError('A promise cannot be resolved with itself.');if(newValue&&('object'==typeof newValue||'function'==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if('function'==typeof then)return void doResolve(bind(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled='function'==typeof onFulfilled?onFulfilled:null,this.onRejected='function'==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0_whatwg_fetch__=__webpack_require__(152),setTimeoutFunc=setTimeout;Promise.prototype['catch']=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.prototype['finally']=function(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})},Promise.all=function(arr){return new Promise(function(resolve,reject){function res(i,val){try{if(val&&('object'==typeof val||'function'==typeof val)){var then=val.then;if('function'==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}if(!arr||'undefined'==typeof arr.length)throw new TypeError('Promise.all accepts an array');var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&'object'==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn='function'==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){'undefined'!=typeof console&&console&&console.warn('Possible Unhandled Promise Rejection:',err)};var globalNS=function(){if('undefined'!=typeof self)return self;if('undefined'!=typeof window)return window;if('undefined'!=typeof global)return global;throw new Error('unable to locate global object')}();globalNS.Promise||(globalNS.Promise=Promise);var _global=createCommonjsModule(function(module){var global=module.exports='undefined'!=typeof window&&window.Math==Math?window:'undefined'!=typeof self&&self.Math==Math?self:Function('return this')();'number'==typeof __g&&(__g=global)}),_core=createCommonjsModule(function(module){var core=module.exports={version:'2.5.5'};'number'==typeof __e&&(__e=core)}),_core_1=_core.version,_isObject=function(it){return'object'==typeof it?null!==it:'function'==typeof it},_anObject=function(it){if(!_isObject(it))throw TypeError(it+' is not an object!');return it},_fails=function(exec){try{return!!exec()}catch(e){return!0}},_descriptors=!_fails(function(){return 7!=Object.defineProperty({},'a',{get:function(){return 7}}).a}),document=_global.document,is=_isObject(document)&&_isObject(document.createElement),_domCreate=function(it){return is?document.createElement(it):{}},_ie8DomDefine=!_descriptors&&!_fails(function(){return 7!=Object.defineProperty(_domCreate('div'),'a',{get:function(){return 7}}).a}),_toPrimitive=function(it,S){if(!_isObject(it))return it;var fn,val;if(S&&'function'==typeof(fn=it.toString)&&!_isObject(val=fn.call(it)))return val;if('function'==typeof(fn=it.valueOf)&&!_isObject(val=fn.call(it)))return val;if(!S&&'function'==typeof(fn=it.toString)&&!_isObject(val=fn.call(it)))return val;throw TypeError('Can\'t convert object to primitive value')},dP=Object.defineProperty,f=_descriptors?Object.defineProperty:function defineProperty(O,P,Attributes){if(_anObject(O),P=_toPrimitive(P,!0),_anObject(Attributes),_ie8DomDefine)try{return dP(O,P,Attributes)}catch(e){}if('get'in Attributes||'set'in Attributes)throw TypeError('Accessors not supported!');return'value'in Attributes&&(O[P]=Attributes.value),O},_objectDp={f:f},_propertyDesc=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}},_hide=_descriptors?function(object,key,value){return _objectDp.f(object,key,_propertyDesc(1,value))}:function(object,key,value){return object[key]=value,object},hasOwnProperty={}.hasOwnProperty,_has=function(it,key){return hasOwnProperty.call(it,key)},id=0,px=Math.random(),_uid=function(key){return'Symbol('.concat(key===void 0?'':key,')_',(++id+px).toString(36))},_redefine=createCommonjsModule(function(module){var SRC=_uid('src'),TO_STRING='toString',$toString=Function[TO_STRING],TPL=(''+$toString).split(TO_STRING);_core.inspectSource=function(it){return $toString.call(it)},(module.exports=function(O,key,val,safe){var isFunction='function'==typeof val;isFunction&&(_has(val,'name')||_hide(val,'name',key));O[key]===val||(isFunction&&(_has(val,SRC)||_hide(val,SRC,O[key]?''+O[key]:TPL.join(key+''))),O===_global?O[key]=val:safe?O[key]?O[key]=val:_hide(O,key,val):(delete O[key],_hide(O,key,val)))})(Function.prototype,TO_STRING,function toString(){return'function'==typeof this&&this[SRC]||$toString.call(this)})}),_aFunction=function(it){if('function'!=typeof it)throw TypeError(it+' is not a function!');return it},_ctx=function(fn,that,length){return(_aFunction(fn),void 0===that)?fn:1===length?function(a){return fn.call(that,a)}:2===length?function(a,b){return fn.call(that,a,b)}:3===length?function(a,b,c){return fn.call(that,a,b,c)}:function(){return fn.apply(that,arguments)}},PROTOTYPE='prototype',$export=function(type,name,source){var IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,target=IS_GLOBAL?_global:IS_STATIC?_global[name]||(_global[name]={}):(_global[name]||{})[PROTOTYPE],exports=IS_GLOBAL?_core:_core[name]||(_core[name]={}),expProto=exports[PROTOTYPE]||(exports[PROTOTYPE]={}),key,own,out,exp;for(key in IS_GLOBAL&&(source=name),source)own=!IS_FORCED&&target&&void 0!==target[key],out=(own?target:source)[key],exp=IS_BIND&&own?_ctx(out,_global):IS_PROTO&&'function'==typeof out?_ctx(Function.call,out):out,target&&_redefine(target,key,out,type&$export.U),exports[key]!=out&&_hide(exports,key,exp),IS_PROTO&&expProto[key]!=out&&(expProto[key]=out)};_global.core=_core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,toString={}.toString,_cof=function(it){return toString.call(it).slice(8,-1)},_iobject=Object('z').propertyIsEnumerable(0)?Object:function(it){return'String'==_cof(it)?it.split(''):Object(it)},_defined=function(it){if(it==void 0)throw TypeError('Can\'t call method on  '+it);return it},_toObject=function(it){return Object(_defined(it))},ceil=Math.ceil,floor=Math.floor,_toInteger=function(it){return isNaN(it=+it)?0:(0<it?floor:ceil)(it)},_toLength=function(it){return 0<it?_Mathmin2(_toInteger(it),9007199254740991):0},_isArray=Array.isArray||function isArray(arg){return'Array'==_cof(arg)},SHARED='__core-js_shared__',store=_global[SHARED]||(_global[SHARED]={}),_shared=function(key){return store[key]||(store[key]={})},_wks=createCommonjsModule(function(module){var store=_shared('wks'),Symbol=_global.Symbol,USE_SYMBOL='function'==typeof Symbol,$exports=module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:_uid)('Symbol.'+name))};$exports.store=store}),SPECIES=_wks('species'),_arraySpeciesConstructor=function(original){var C;return _isArray(original)&&(C=original.constructor,'function'==typeof C&&(C===Array||_isArray(C.prototype))&&(C=void 0),_isObject(C)&&(C=C[SPECIES],null===C&&(C=void 0))),void 0===C?Array:C},_arraySpeciesCreate=function(original,length){return new(_arraySpeciesConstructor(original))(length)},_arrayMethods=function(TYPE,$create){var IS_MAP=1==TYPE,IS_EVERY=4==TYPE,IS_FIND_INDEX=6==TYPE,create=$create||_arraySpeciesCreate;return function($this,callbackfn,that){for(var O=_toObject($this),self=_iobject(O),f=_ctx(callbackfn,that,3),length=_toLength(self.length),index=0,result=IS_MAP?create($this,length):2==TYPE?create($this,0):void 0,val,res;length>index;index++)if((5==TYPE||IS_FIND_INDEX||index in self)&&(val=self[index],res=f(val,index,O),TYPE))if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return!0;case 5:return val;case 6:return index;case 2:result.push(val);}else if(IS_EVERY)return!1;return IS_FIND_INDEX?-1:3==TYPE||IS_EVERY?IS_EVERY:result}},UNSCOPABLES=_wks('unscopables'),ArrayProto=Array.prototype;ArrayProto[UNSCOPABLES]==void 0&&_hide(ArrayProto,UNSCOPABLES,{});var _addToUnscopables=function(key){ArrayProto[UNSCOPABLES][key]=!0},$find=_arrayMethods(5),KEY='find',forced=!0;KEY in[]&&[,][KEY](function(){forced=!1}),_export(_export.P+_export.F*forced,'Array',{find:function find(callbackfn){return $find(this,callbackfn,1<arguments.length?arguments[1]:void 0)}}),_addToUnscopables(KEY);var find=_core.Array.find,$find$1=_arrayMethods(6),KEY$1='findIndex',forced$1=!0;KEY$1 in[]&&[,][KEY$1](function(){forced$1=!1}),_export(_export.P+_export.F*forced$1,'Array',{findIndex:function findIndex(callbackfn){return $find$1(this,callbackfn,1<arguments.length?arguments[1]:void 0)}}),_addToUnscopables(KEY$1);var findIndex=_core.Array.findIndex,_toIobject=function(it){return _iobject(_defined(it))},max=Math.max,_toAbsoluteIndex=function(index,length){return index=_toInteger(index),0>index?max(index+length,0):_Mathmin2(index,length)},shared=_shared('keys'),_sharedKey=function(key){return shared[key]||(shared[key]=_uid(key))},arrayIndexOf=function(IS_INCLUDES){return function($this,el,fromIndex){var O=_toIobject($this),length=_toLength(O.length),index=_toAbsoluteIndex(fromIndex,length),value;if(IS_INCLUDES&&el!=el){for(;length>index;)if(value=O[index++],value!=value)return!0;}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}}(!1),IE_PROTO=_sharedKey('IE_PROTO'),_objectKeysInternal=function(object,names){var O=_toIobject(object),i=0,result=[],key;for(key in O)key!=IE_PROTO&&_has(O,key)&&result.push(key);for(;names.length>i;)_has(O,key=names[i++])&&(~arrayIndexOf(result,key)||result.push(key));return result},_enumBugKeys='constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'.split(','),_objectKeys=Object.keys||function keys(O){return _objectKeysInternal(O,_enumBugKeys)},f$1=Object.getOwnPropertySymbols,_objectGops={f:f$1},f$2={}.propertyIsEnumerable,_objectPie={f:f$2},$assign=Object.assign,_objectAssign=!$assign||_fails(function(){var A={},B={},S=Symbol(),K='abcdefghijklmnopqrst';return A[S]=7,K.split('').forEach(function(k){B[k]=k}),7!=$assign({},A)[S]||Object.keys($assign({},B)).join('')!=K})?function assign(target){for(var T=_toObject(target),aLen=arguments.length,index=1,getSymbols=_objectGops.f,isEnum=_objectPie.f;aLen>index;)for(var S=_iobject(arguments[index++]),keys=getSymbols?_objectKeys(S).concat(getSymbols(S)):_objectKeys(S),length=keys.length,j=0,key;length>j;)isEnum.call(S,key=keys[j++])&&(T[key]=S[key]);return T}:$assign;_export(_export.S+_export.F,'Object',{assign:_objectAssign});var assign=_core.Object.assign,MATCH=_wks('match'),_isRegexp=function(it){var isRegExp;return _isObject(it)&&((isRegExp=it[MATCH])===void 0?'RegExp'==_cof(it):!!isRegExp)},_stringContext=function(that,searchString,NAME){if(_isRegexp(searchString))throw TypeError('String#'+NAME+' doesn\'t accept regex!');return _defined(that)+''},MATCH$1=_wks('match'),STARTS_WITH='startsWith',$startsWith=''[STARTS_WITH];_export(_export.P+_export.F*function(KEY){var re=/./;try{'/./'[KEY](re)}catch(e){try{return re[MATCH$1]=!1,!'/./'[KEY](re)}catch(f){}}return!0}(STARTS_WITH),'String',{startsWith:function startsWith(searchString){var that=_stringContext(this,searchString,STARTS_WITH),index=_toLength(_Mathmin2(1<arguments.length?arguments[1]:void 0,that.length)),search=searchString+'';return that.slice(index,index+search.length)===search}});var startsWith=_core.String.startsWith;_export(_export.P,'String',{repeat:function repeat(count){var str=_defined(this)+'',res='',n=_toInteger(count);if(0>n||n==Infinity)throw RangeError('Count can\'t be negative');for(;0<n;(n>>>=1)&&(str+=str))1&n&&(res+=str);return res}});var repeat=_core.String.repeat,_meta=createCommonjsModule(function(module){var META=_uid('meta'),setDesc=_objectDp.f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!_fails(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(it){setDesc(it,META,{value:{i:'O'+ ++id,w:{}}})},meta=module.exports={KEY:META,NEED:!1,fastKey:function(it,create){if(!_isObject(it))return'symbol'==typeof it?it:('string'==typeof it?'S':'P')+it;if(!_has(it,META)){if(!isExtensible(it))return'F';if(!create)return'E';setMeta(it)}return it[META].i},getWeak:function(it,create){if(!_has(it,META)){if(!isExtensible(it))return!0;if(!create)return!1;setMeta(it)}return it[META].w},onFreeze:function(it){return FREEZE&&meta.NEED&&isExtensible(it)&&!_has(it,META)&&setMeta(it),it}}}),_meta_1=_meta.KEY,_meta_2=_meta.NEED,_meta_3=_meta.fastKey,_meta_4=_meta.getWeak,_meta_5=_meta.onFreeze,def=_objectDp.f,TAG=_wks('toStringTag'),_setToStringTag=function(it,tag,stat){it&&!_has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})},_wksExt={f:_wks},_library=!1,defineProperty=_objectDp.f,_wksDefine=function(name){var $Symbol=_core.Symbol||(_core.Symbol=_global.Symbol||{});'_'==name.charAt(0)||name in $Symbol||defineProperty($Symbol,name,{value:_wksExt.f(name)})},_enumKeys=function(it){var result=_objectKeys(it),getSymbols=_objectGops.f;if(getSymbols)for(var symbols=getSymbols(it),isEnum=_objectPie.f,i=0,key;symbols.length>i;)isEnum.call(it,key=symbols[i++])&&result.push(key);return result},_objectDps=_descriptors?Object.defineProperties:function defineProperties(O,Properties){_anObject(O);for(var keys=_objectKeys(Properties),length=keys.length,i=0,P;length>i;)_objectDp.f(O,P=keys[i++],Properties[P]);return O},document$1=_global.document,_html=document$1&&document$1.documentElement,IE_PROTO$1=_sharedKey('IE_PROTO'),Empty=function(){},PROTOTYPE$1='prototype',createDict=function(){var iframe=_domCreate('iframe'),i=_enumBugKeys.length,lt='<',gt='>',iframeDocument;for(iframe.style.display='none',_html.appendChild(iframe),iframe.src='javascript:',iframeDocument=iframe.contentWindow.document,iframeDocument.open(),iframeDocument.write(lt+'script'+gt+'document.F=Object'+lt+'/script'+gt),iframeDocument.close(),createDict=iframeDocument.F;i--;)delete createDict[PROTOTYPE$1][_enumBugKeys[i]];return createDict()},_objectCreate=Object.create||function create(O,Properties){var result;return null===O?result=createDict():(Empty[PROTOTYPE$1]=_anObject(O),result=new Empty,Empty[PROTOTYPE$1]=null,result[IE_PROTO$1]=O),void 0===Properties?result:_objectDps(result,Properties)},hiddenKeys=_enumBugKeys.concat('length','prototype'),f$4=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return _objectKeysInternal(O,hiddenKeys)},_objectGopn={f:f$4},gOPN=_objectGopn.f,toString$1={}.toString,windowNames='object'==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}},_objectGopnExt={f:function getOwnPropertyNames(it){return windowNames&&'[object Window]'==toString$1.call(it)?getWindowNames(it):gOPN(_toIobject(it))}},gOPD=Object.getOwnPropertyDescriptor,f$6=_descriptors?gOPD:function getOwnPropertyDescriptor(O,P){if(O=_toIobject(O),P=_toPrimitive(P,!0),_ie8DomDefine)try{return gOPD(O,P)}catch(e){}return _has(O,P)?_propertyDesc(!_objectPie.f.call(O,P),O[P]):void 0},_objectGopd={f:f$6},META=_meta.KEY,gOPD$1=_objectGopd.f,dP$1=_objectDp.f,gOPN$1=_objectGopnExt.f,$Symbol=_global.Symbol,$JSON=_global.JSON,_stringify=$JSON&&$JSON.stringify,PROTOTYPE$2='prototype',HIDDEN=_wks('_hidden'),TO_PRIMITIVE=_wks('toPrimitive'),isEnum={}.propertyIsEnumerable,SymbolRegistry=_shared('symbol-registry'),AllSymbols=_shared('symbols'),OPSymbols=_shared('op-symbols'),ObjectProto=Object[PROTOTYPE$2],USE_NATIVE='function'==typeof $Symbol,QObject=_global.QObject,setter=!QObject||!QObject[PROTOTYPE$2]||!QObject[PROTOTYPE$2].findChild,setSymbolDesc=_descriptors&&_fails(function(){return 7!=_objectCreate(dP$1({},'a',{get:function(){return dP$1(this,'a',{value:7}).a}})).a})?function(it,key,D){var protoDesc=gOPD$1(ObjectProto,key);protoDesc&&delete ObjectProto[key],dP$1(it,key,D),protoDesc&&it!==ObjectProto&&dP$1(ObjectProto,key,protoDesc)}:dP$1,wrap=function(tag){var sym=AllSymbols[tag]=_objectCreate($Symbol[PROTOTYPE$2]);return sym._k=tag,sym},isSymbol=USE_NATIVE&&'symbol'==typeof $Symbol.iterator?function(it){return'symbol'==typeof it}:function(it){return it instanceof $Symbol},$defineProperty=function defineProperty(it,key,D){return it===ObjectProto&&$defineProperty(OPSymbols,key,D),_anObject(it),key=_toPrimitive(key,!0),_anObject(D),_has(AllSymbols,key)?(D.enumerable?(_has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=_objectCreate(D,{enumerable:_propertyDesc(0,!1)})):(!_has(it,HIDDEN)&&dP$1(it,HIDDEN,_propertyDesc(1,{})),it[HIDDEN][key]=!0),setSymbolDesc(it,key,D)):dP$1(it,key,D)},$defineProperties=function defineProperties(it,P){_anObject(it);for(var keys=_enumKeys(P=_toIobject(P)),i=0,l=keys.length,key;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key=_toPrimitive(key,!0));return this===ObjectProto&&_has(AllSymbols,key)&&!_has(OPSymbols,key)?!1:E||!_has(this,key)||!_has(AllSymbols,key)||_has(this,HIDDEN)&&this[HIDDEN][key]?E:!0},$getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){if(it=_toIobject(it),key=_toPrimitive(key,!0),it!==ObjectProto||!_has(AllSymbols,key)||_has(OPSymbols,key)){var D=gOPD$1(it,key);return D&&_has(AllSymbols,key)&&!(_has(it,HIDDEN)&&it[HIDDEN][key])&&(D.enumerable=!0),D}},$getOwnPropertyNames=function getOwnPropertyNames(it){for(var names=gOPN$1(_toIobject(it)),result=[],i=0,key;names.length>i;)_has(AllSymbols,key=names[i++])||key==HIDDEN||key==META||result.push(key);return result},$getOwnPropertySymbols=function getOwnPropertySymbols(it){for(var IS_OP=it===ObjectProto,names=gOPN$1(IS_OP?OPSymbols:_toIobject(it)),result=[],i=0,key;names.length>i;)_has(AllSymbols,key=names[i++])&&(!IS_OP||_has(ObjectProto,key))&&result.push(AllSymbols[key]);return result};USE_NATIVE||($Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError('Symbol is not a constructor!');var tag=_uid(0<arguments.length?arguments[0]:void 0),$set=function(value){this===ObjectProto&&$set.call(OPSymbols,value),_has(this,HIDDEN)&&_has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDesc(this,tag,_propertyDesc(1,value))};return _descriptors&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:!0,set:$set}),wrap(tag)},_redefine($Symbol[PROTOTYPE$2],'toString',function toString(){return this._k}),_objectGopd.f=$getOwnPropertyDescriptor,_objectDp.f=$defineProperty,_objectGopn.f=_objectGopnExt.f=$getOwnPropertyNames,_objectPie.f=$propertyIsEnumerable,_objectGops.f=$getOwnPropertySymbols,_descriptors&&!_library&&_redefine(ObjectProto,'propertyIsEnumerable',$propertyIsEnumerable,!0),_wksExt.f=function(name){return wrap(_wks(name))}),_export(_export.G+_export.W+_export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols='hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'.split(','),j=0;es6Symbols.length>j;)_wks(es6Symbols[j++]);for(var wellKnownSymbols=_objectKeys(_wks.store),k=0;wellKnownSymbols.length>k;)_wksDefine(wellKnownSymbols[k++]);_export(_export.S+_export.F*!USE_NATIVE,'Symbol',{for:function(key){return _has(SymbolRegistry,key+='')?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+' is not a symbol!');for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),_export(_export.S+_export.F*!USE_NATIVE,'Object',{create:function create(it,P){return P===void 0?_objectCreate(it):$defineProperties(_objectCreate(it),P)},defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),$JSON&&_export(_export.S+_export.F*(!USE_NATIVE||_fails(function(){var S=$Symbol();return'[null]'!=_stringify([S])||'{}'!=_stringify({a:S})||'{}'!=_stringify(Object(S))})),'JSON',{stringify:function stringify(it){for(var args=[it],i=1,replacer,$replacer;arguments.length>i;)args.push(arguments[i++]);if($replacer=replacer=args[1],(_isObject(replacer)||void 0!==it)&&!isSymbol(it))return _isArray(replacer)||(replacer=function(key,value){if('function'==typeof $replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,_stringify.apply($JSON,args)}}),$Symbol[PROTOTYPE$2][TO_PRIMITIVE]||_hide($Symbol[PROTOTYPE$2],TO_PRIMITIVE,$Symbol[PROTOTYPE$2].valueOf),_setToStringTag($Symbol,'Symbol'),_setToStringTag(Math,'Math',!0),_setToStringTag(_global.JSON,'JSON',!0);var TAG$1=_wks('toStringTag'),ARG='Arguments'==_cof(function(){return arguments}()),tryGet=function(it,key){try{return it[key]}catch(e){}},_classof=function(it){var O,T,B;return it===void 0?'Undefined':null===it?'Null':'string'==typeof(T=tryGet(O=Object(it),TAG$1))?T:ARG?_cof(O):'Object'==(B=_cof(O))&&'function'==typeof O.callee?'Arguments':B};({})[_wks('toStringTag')]='z',_redefine(Object.prototype,'toString',function toString(){return'[object '+_classof(this)+']'},!0),_wksDefine('asyncIterator'),_wksDefine('observable');var symbol=_core.Symbol,_iterators={},IteratorPrototype={};_hide(IteratorPrototype,_wks('iterator'),function(){return this});var _iterCreate=function(Constructor,NAME,next){Constructor.prototype=_objectCreate(IteratorPrototype,{next:_propertyDesc(1,next)}),_setToStringTag(Constructor,NAME+' Iterator')},IE_PROTO$2=_sharedKey('IE_PROTO'),ObjectProto$1=Object.prototype,_objectGpo=Object.getPrototypeOf||function(O){return O=_toObject(O),_has(O,IE_PROTO$2)?O[IE_PROTO$2]:'function'==typeof O.constructor&&O instanceof O.constructor?O.constructor.prototype:O instanceof Object?ObjectProto$1:null},ITERATOR=_wks('iterator'),BUGGY=!([].keys&&'next'in[].keys()),KEYS='keys',VALUES='values',returnThis=function(){return this},_iterDefine=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){_iterCreate(Constructor,NAME,next);var getMethod=function(kind){return!BUGGY&&kind in proto?proto[kind]:kind===KEYS?function keys(){return new Constructor(this,kind)}:kind===VALUES?function values(){return new Constructor(this,kind)}:function entries(){return new Constructor(this,kind)}},TAG=NAME+' Iterator',DEF_VALUES=DEFAULT==VALUES,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto['@@iterator']||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT),$entries=DEFAULT?DEF_VALUES?getMethod('entries'):$default:void 0,$anyNative='Array'==NAME?proto.entries||$native:$native,methods,key,IteratorPrototype;if($anyNative&&(IteratorPrototype=_objectGpo($anyNative.call(new Base)),IteratorPrototype!==Object.prototype&&IteratorPrototype.next&&(_setToStringTag(IteratorPrototype,TAG,!0),'function'!=typeof IteratorPrototype[ITERATOR]&&_hide(IteratorPrototype,ITERATOR,returnThis))),DEF_VALUES&&$native&&$native.name!==VALUES&&(VALUES_BUG=!0,$default=function values(){return $native.call(this)}),(BUGGY||VALUES_BUG||!proto[ITERATOR])&&_hide(proto,ITERATOR,$default),_iterators[NAME]=$default,_iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:$entries},FORCED)for(key in methods)key in proto||_redefine(proto,key,methods[key]);else _export(_export.P+_export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods},$at=function(TO_STRING){return function(that,pos){var s=_defined(that)+'',i=_toInteger(pos),l=s.length,a,b;return 0>i||i>=l?TO_STRING?'':void 0:(a=s.charCodeAt(i),55296>a||56319<a||i+1===l||56320>(b=s.charCodeAt(i+1))||57343<b?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536)}}(!0);_iterDefine(String,'String',function(iterated){this._t=iterated+'',this._i=0},function(){var O=this._t,index=this._i,point;return index>=O.length?{value:void 0,done:!0}:(point=$at(O,index),this._i+=point.length,{value:point,done:!1})});var _iterStep=function(done,value){return{value:value,done:!!done}},es6_array_iterator=_iterDefine(Array,'Array',function(iterated,kind){this._t=_toIobject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,_iterStep(1)):'keys'==kind?_iterStep(0,index):'values'==kind?_iterStep(0,O[index]):_iterStep(0,[index,O[index]])},'values');_iterators.Arguments=_iterators.Array,_addToUnscopables('keys'),_addToUnscopables('values'),_addToUnscopables('entries');for(var ITERATOR$1=_wks('iterator'),TO_STRING_TAG=_wks('toStringTag'),ArrayValues=_iterators.Array,DOMIterables={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},collections=_objectKeys(DOMIterables),i=0;i<collections.length;i++){var NAME=collections[i],explicit=DOMIterables[NAME],Collection=_global[NAME],proto=Collection&&Collection.prototype,key;if(proto&&(proto[ITERATOR$1]||_hide(proto,ITERATOR$1,ArrayValues),proto[TO_STRING_TAG]||_hide(proto,TO_STRING_TAG,NAME),_iterators[NAME]=ArrayValues,explicit))for(key in es6_array_iterator)proto[key]||_redefine(proto,key,es6_array_iterator[key],!0)}_wksExt.f('iterator')}).call(__webpack_exports__,__webpack_require__(149).setImmediate,__webpack_require__(0))},function(module,exports,__webpack_require__){'use strict';function deepExtend(target,source){if(!(source instanceof Object))return source;switch(source.constructor){case Date:return new Date(source.getTime());case Object:target===void 0&&(target={});break;case Array:target=[];break;default:return source;}for(var prop in source)source.hasOwnProperty(prop)&&(target[prop]=deepExtend(target[prop],source[prop]));return target}function jsonEval(str){return JSON.parse(str)}function implementsAnyMethods(obj,methods){if('object'!=typeof obj||null===obj)return!1;for(var _i=0,methods_1=methods,method;_i<methods_1.length;_i++)if(method=methods_1[_i],method in obj&&'function'==typeof obj[method])return!0;return!1}function noop(){}function errorPrefix(fnName,argumentNumber,optional){var argName='';switch(argumentNumber){case 1:argName=optional?'first':'First';break;case 2:argName=optional?'second':'Second';break;case 3:argName=optional?'third':'Third';break;case 4:argName=optional?'fourth':'Fourth';break;default:throw new Error('errorPrefix called with argumentNumber > 4.  Need to update it?');}var error=fnName+' failed: ';return error+=argName+' argument ',error}var _StringfromCharCode=String.fromCharCode;Object.defineProperty(exports,'__esModule',{value:!0});var tslib_1=__webpack_require__(19),CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:'${JSCORE_VERSION}'},assert=function(assertion,message){if(!assertion)throw assertionError(message)},assertionError=function(message){return new Error('Firebase Database ('+CONSTANTS.SDK_VERSION+') INTERNAL ASSERT FAILED: '+message)},stringToByteArray=function(str){for(var out=[],p=0,i=0,c;i<str.length;i++)c=str.charCodeAt(i),128>c?out[p++]=c:2048>c?(out[p++]=192|c>>6,out[p++]=128|63&c):55296==(64512&c)&&i+1<str.length&&56320==(64512&str.charCodeAt(i+1))?(c=65536+((1023&c)<<10)+(1023&str.charCodeAt(++i)),out[p++]=240|c>>18,out[p++]=128|63&c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c):(out[p++]=224|c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c);return out},byteArrayToString=function(bytes){for(var out=[],pos=0,c=0;pos<bytes.length;){var c1=bytes[pos++];if(128>c1)out[c++]=_StringfromCharCode(c1);else if(191<c1&&224>c1){var c2=bytes[pos++];out[c++]=_StringfromCharCode((31&c1)<<6|63&c2)}else if(239<c1&&365>c1){var c2=bytes[pos++],c3=bytes[pos++],c4=bytes[pos++],u=((7&c1)<<18|(63&c2)<<12|(63&c3)<<6|63&c4)-65536;out[c++]=_StringfromCharCode(55296+(u>>10)),out[c++]=_StringfromCharCode(56320+(1023&u))}else{var c2=bytes[pos++],c3=bytes[pos++];out[c++]=_StringfromCharCode((15&c1)<<12|(63&c2)<<6|63&c3)}}return out.join('')},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:'ABCDEFGHIJKLMNOPQRSTUVWXYZ'+'abcdefghijklmnopqrstuvwxyz'+'0123456789',get ENCODED_VALS(){return this.ENCODED_VALS_BASE+'+/='},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+'-_.'},HAS_NATIVE_SUPPORT:'function'==typeof atob,encodeByteArray:function(input,opt_webSafe){if(!Array.isArray(input))throw Error('encodeByteArray takes an array as a parameter');this.init_();for(var byteToCharMap=opt_webSafe?this.byteToCharMapWebSafe_:this.byteToCharMap_,output=[],i=0;i<input.length;i+=3){var byte1=input[i],haveByte2=i+1<input.length,byte2=haveByte2?input[i+1]:0,haveByte3=i+2<input.length,byte3=haveByte3?input[i+2]:0,outByte3=(15&byte2)<<2|byte3>>6,outByte4=63&byte3;haveByte3||(outByte4=64,!haveByte2&&(outByte3=64)),output.push(byteToCharMap[byte1>>2],byteToCharMap[(3&byte1)<<4|byte2>>4],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join('')},encodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?btoa(input):this.encodeByteArray(stringToByteArray(input),opt_webSafe)},decodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?atob(input):byteArrayToString(this.decodeStringToByteArray(input,opt_webSafe))},decodeStringToByteArray:function(input,opt_webSafe){this.init_();for(var charToByteMap=opt_webSafe?this.charToByteMapWebSafe_:this.charToByteMap_,output=[],i=0;i<input.length;){var byte1=charToByteMap[input.charAt(i++)],haveByte2=i<input.length,byte2=haveByte2?charToByteMap[input.charAt(i)]:0;++i;var haveByte3=i<input.length,byte3=haveByte3?charToByteMap[input.charAt(i)]:64;++i;var haveByte4=i<input.length,byte4=haveByte4?charToByteMap[input.charAt(i)]:64;if(++i,null==byte1||null==byte2||null==byte3||null==byte4)throw Error();if(output.push(byte1<<2|byte2>>4),64!=byte3){if(output.push(240&byte2<<4|byte3>>2),64!=byte4){output.push(192&byte3<<6|byte4)}}}return output},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},base64Decode=function(str){try{return base64.decodeString(str,!0)}catch(e){console.error('base64Decode failed: ',e)}return null},Deferred=function(){function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve,_this.reject=reject})}return Deferred.prototype.wrapCallback=function(callback){var _this=this;return function(error,value){error?_this.reject(error):_this.resolve(value),'function'==typeof callback&&(_this.promise.catch(function(){}),1===callback.length?callback(error):callback(error,value))}},Deferred}(),getUA=function(){return'undefined'!=typeof navigator&&'string'==typeof navigator.userAgent?navigator.userAgent:''},ERROR_NAME='FirebaseError',captureStackTrace=Error.captureStackTrace,FirebaseError=function(){return function FirebaseError(code,message){if(this.code=code,this.message=message,captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else try{throw Error.apply(this,arguments)}catch(err){this.name=ERROR_NAME,Object.defineProperty(this,'stack',{get:function(){return err.stack}})}}}();FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors,this.pattern=/\{\$([^}]+)}/g}return ErrorFactory.prototype.create=function(code,data){void 0===data&&(data={});var template=this.errors[code],fullCode=this.service+'/'+code,message;message=void 0===template?'Error':template.replace(this.pattern,function(match,key){var value=data[key];return void 0===value?'<'+key+'?>':value.toString()}),message=this.serviceName+': '+message+' ('+fullCode+').';var err=new FirebaseError(fullCode,message);for(var prop in data)data.hasOwnProperty(prop)&&'_'!==prop.slice(-1)&&(err[prop]=data[prop]);return err},ErrorFactory}(),decode=function(token){var header={},claims={},data={},signature='';try{var parts=token.split('.');header=jsonEval(base64Decode(parts[0])||''),claims=jsonEval(base64Decode(parts[1])||''),signature=parts[2],data=claims.d||{},delete claims.d}catch(e){}return{header:header,claims:claims,data:data,signature:signature}},forEach=function(obj,fn){for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&fn(key,obj[key])},extend=function(objTo,objFrom){return forEach(objFrom,function(key,value){objTo[key]=value}),objTo},findKey=function(obj,fn,opt_this){for(var key in obj)if(fn.call(opt_this,obj[key],key,obj))return key},Hash=function(){return function Hash(){this.blockSize=-1}}(),Sha1=function(_super){function Sha1(){var _this=_super.call(this)||this;_this.chain_=[],_this.buf_=[],_this.W_=[],_this.pad_=[],_this.inbuf_=0,_this.total_=0,_this.blockSize=512/8,_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i)_this.pad_[i]=0;return _this.reset(),_this}return tslib_1.__extends(Sha1,_super),Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,opt_offset){opt_offset||(opt_offset=0);var W=this.W_;if('string'==typeof buf)for(var i=0;16>i;i++)W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3),opt_offset+=4;else for(var i=0;16>i;i++)W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3],opt_offset+=4;for(var i=16,t;80>i;i++)t=W[i-3]^W[i-8]^W[i-14]^W[i-16],W[i]=4294967295&(t<<1|t>>>31);for(var a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0,f,k;80>i;i++){40>i?20>i?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):60>i?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=4294967295&(a<<5|a>>>27)+f+e+k+W[i];e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=4294967295&this.chain_[0]+a,this.chain_[1]=4294967295&this.chain_[1]+b,this.chain_[2]=4294967295&this.chain_[2]+c,this.chain_[3]=4294967295&this.chain_[3]+d,this.chain_[4]=4294967295&this.chain_[4]+e},Sha1.prototype.update=function(bytes,opt_length){if(null!=bytes){void 0===opt_length&&(opt_length=bytes.length);for(var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<opt_length;){if(0==inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if('string'==typeof bytes){for(;n<opt_length;)if(buf[inbuf]=bytes.charCodeAt(n),++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<opt_length;)if(buf[inbuf]=bytes[n],++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=opt_length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;56>this.inbuf_?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;56<=i;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);for(var n=0,i=0;5>i;i++)for(var j=24;0<=j;j-=8)digest[n]=255&this.chain_[i]>>j,++n;return digest},Sha1}(Hash),ObserverProxy=function(){function ObserverProxy(executor,onNoObservers){var _this=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=onNoObservers,this.task.then(function(){executor(_this)}).catch(function(e){_this.error(e)})}return ObserverProxy.prototype.next=function(value){this.forEachObserver(function(observer){observer.next(value)})},ObserverProxy.prototype.error=function(error){this.forEachObserver(function(observer){observer.error(error)}),this.close(error)},ObserverProxy.prototype.complete=function(){this.forEachObserver(function(observer){observer.complete()}),this.close()},ObserverProxy.prototype.subscribe=function(nextOrObserver,error,complete){var _this=this,observer;if(void 0===nextOrObserver&&void 0===error&&void 0===complete)throw new Error('Missing Observer.');observer=implementsAnyMethods(nextOrObserver,['next','error','complete'])?nextOrObserver:{next:nextOrObserver,error:error,complete:complete},void 0===observer.next&&(observer.next=noop),void 0===observer.error&&(observer.error=noop),void 0===observer.complete&&(observer.complete=noop);var unsub=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{_this.finalError?observer.error(_this.finalError):observer.complete()}catch(e){}}),this.observers.push(observer),unsub},ObserverProxy.prototype.unsubscribeOne=function(i){void 0===this.observers||void 0===this.observers[i]||(delete this.observers[i],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ObserverProxy.prototype.forEachObserver=function(fn){if(!this.finalized)for(var i=0;i<this.observers.length;i++)this.sendOne(i,fn)},ObserverProxy.prototype.sendOne=function(i,fn){var _this=this;this.task.then(function(){if(void 0!==_this.observers&&void 0!==_this.observers[i])try{fn(_this.observers[i])}catch(e){'undefined'!=typeof console&&console.error&&console.error(e)}})},ObserverProxy.prototype.close=function(err){var _this=this;this.finalized||(this.finalized=!0,void 0!==err&&(this.finalError=err),this.task.then(function(){_this.observers=void 0,_this.onNoObservers=void 0}))},ObserverProxy}();exports.assert=assert,exports.assertionError=assertionError,exports.base64=base64,exports.base64Decode=base64Decode,exports.base64Encode=function(str){var utf8Bytes=stringToByteArray(str);return base64.encodeByteArray(utf8Bytes,!0)},exports.CONSTANTS=CONSTANTS,exports.deepCopy=function deepCopy(value){return deepExtend(void 0,value)},exports.deepExtend=deepExtend,exports.patchProperty=function patchProperty(obj,prop,value){obj[prop]=value},exports.Deferred=Deferred,exports.getUA=getUA,exports.isMobileCordova=function(){return'undefined'!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())},exports.isNodeSdk=function(){return!0===CONSTANTS.NODE_CLIENT||!0===CONSTANTS.NODE_ADMIN},exports.isReactNative=function(){return'object'==typeof navigator&&'ReactNative'===navigator.product},exports.ErrorFactory=ErrorFactory,exports.FirebaseError=FirebaseError,exports.patchCapture=function patchCapture(captureFake){var result=captureStackTrace;return captureStackTrace=captureFake,result},exports.jsonEval=jsonEval,exports.stringify=function stringify(data){return JSON.stringify(data)},exports.decode=decode,exports.isAdmin=function(token){var claims=decode(token).claims;return'object'==typeof claims&&!0===claims.admin},exports.issuedAtTime=function(token){var claims=decode(token).claims;return'object'==typeof claims&&claims.hasOwnProperty('iat')?claims.iat:null},exports.isValidFormat=function(token){var decoded=decode(token),claims=decoded.claims;return!!claims&&'object'==typeof claims&&claims.hasOwnProperty('iat')},exports.isValidTimestamp=function(token){var claims=decode(token).claims,now=Math.floor(new Date().getTime()/1e3),validSince,validUntil;return'object'==typeof claims&&(claims.hasOwnProperty('nbf')?validSince=claims.nbf:claims.hasOwnProperty('iat')&&(validSince=claims.iat),validUntil=claims.hasOwnProperty('exp')?claims.exp:validSince+86400),now&&validSince&&validUntil&&now>=validSince&&now<=validUntil},exports.clone=function(obj){return extend({},obj)},exports.contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},exports.every=function(obj,fn){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&!fn(key,obj[key]))return!1;return!0},exports.extend=extend,exports.findKey=findKey,exports.findValue=function(obj,fn,opt_this){var key=findKey(obj,fn,opt_this);return key&&obj[key]},exports.forEach=forEach,exports.getAnyKey=function(obj){for(var key in obj)return key},exports.getCount=function(obj){var rv=0;for(var key in obj)rv++;return rv},exports.getValues=function(obj){var res=[],i=0;for(var key in obj)res[i++]=obj[key];return res},exports.isEmpty=function(obj){for(var key in obj)return!1;return!0},exports.isNonNullObject=function(obj){return'object'==typeof obj&&null!==obj},exports.map=function(obj,f,opt_obj){var res={};for(var key in obj)res[key]=f.call(opt_obj,obj[key],key,obj);return res},exports.safeGet=function(obj,key){if(Object.prototype.hasOwnProperty.call(obj,key))return obj[key]},exports.querystring=function(querystringParams){var params=[];return forEach(querystringParams,function(key,value){Array.isArray(value)?value.forEach(function(arrayVal){params.push(encodeURIComponent(key)+'='+encodeURIComponent(arrayVal))}):params.push(encodeURIComponent(key)+'='+encodeURIComponent(value))}),params.length?'&'+params.join('&'):''},exports.querystringDecode=function(querystring){var obj={},tokens=querystring.replace(/^\?/,'').split('&');return tokens.forEach(function(token){if(token){var key=token.split('=');obj[key[0]]=key[1]}}),obj},exports.Sha1=Sha1,exports.async=function async(fn,onError){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];Promise.resolve(!0).then(function(){fn.apply(void 0,args)}).catch(function(error){onError&&onError(error)})}},exports.createSubscribe=function createSubscribe(executor,onNoObservers){var proxy=new ObserverProxy(executor,onNoObservers);return proxy.subscribe.bind(proxy)},exports.errorPrefix=errorPrefix,exports.validateArgCount=function(fnName,minCount,maxCount,argCount){var argError;if(argCount<minCount?argError='at least '+minCount:argCount>maxCount&&(argError=0===maxCount?'none':'no more than '+maxCount),argError){var error=fnName+' failed: Was called with '+argCount+(1===argCount?' argument.':' arguments.')+' Expects '+argError+'.';throw new Error(error)}},exports.validateCallback=function validateCallback(fnName,argumentNumber,callback,optional){if((!optional||callback)&&'function'!=typeof callback)throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid function.')},exports.validateContextObject=function validateContextObject(fnName,argumentNumber,context,optional){if((!optional||context)&&('object'!=typeof context||null===context))throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid context object.')},exports.validateNamespace=function validateNamespace(fnName,argumentNumber,namespace,optional){if((!optional||namespace)&&'string'!=typeof namespace)throw new Error(errorPrefix(fnName,argumentNumber,optional)+'must be a valid firebase namespace.')},exports.stringLength=function(str){for(var p=0,i=0,c;i<str.length;i++)c=str.charCodeAt(i),128>c?p++:2048>c?p+=2:55296<=c&&56319>=c?(p+=4,i++):p+=3;return p},exports.stringToByteArray=function(str){for(var out=[],p=0,i=0,c;i<str.length;i++){if(c=str.charCodeAt(i),55296<=c&&56319>=c){var high=c-55296;i++,assert(i<str.length,'Surrogate pair missing trail surrogate.');var low=str.charCodeAt(i)-56320;c=65536+(high<<10)+low}128>c?out[p++]=c:2048>c?(out[p++]=192|c>>6,out[p++]=128|63&c):65536>c?(out[p++]=224|c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c):(out[p++]=240|c>>18,out[p++]=128|63&c>>12,out[p++]=128|63&c>>6,out[p++]=128|63&c)}return out}},function(module,__webpack_exports__,__webpack_require__){'use strict';var _Mathround=Math.round,_Mathfloor2=Math.floor,_Mathmax2=Math.max;(function(global){function l(a){return'string'==typeof a}function m(a,b){a=a.split('.'),b=b||h;for(var c=0;c<a.length;c++)if(b=b[a[c]],null==b)return null;return b}function aa(){}function ba(a){var b=typeof a;if('object'==b){if(a){if(a instanceof Array)return'array';if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if('[object Window]'==c)return'object';if('[object Array]'==c||'number'==typeof a.length&&'undefined'!=typeof a.splice&&'undefined'!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable('splice'))return'array';if('[object Function]'==c||'undefined'!=typeof a.call&&'undefined'!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable('call'))return'function'}else return'null';}else if('function'==b&&'undefined'==typeof a.call)return'object';return b}function n(a){return'array'==ba(a)}function ca(a){var b=ba(a);return'array'==b||'object'==b&&'number'==typeof a.length}function q(a){return'function'==ba(a)}function r(a){var b=typeof a;return'object'==b&&null!=a||'function'==b}function ea(a){return a.call.apply(a.bind,arguments)}function fa(a,b){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function u(){return u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf('native code')?ea:fa,u.apply(null,arguments)}function v(a){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();return b.push.apply(b,arguments),a.apply(this,b)}}function x(a,b){function c(){}c.prototype=b.prototype,a.L=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.mh=function(a,c){for(var d=Array(arguments.length-2),f=2;f<arguments.length;f++)d[f-2]=arguments[f];return b.prototype[c].apply(a,d)}}function y(a){if(Error.captureStackTrace)Error.captureStackTrace(this,y);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=a+'')}function ha(a,b){a=a.split('%s');for(var c='',d=a.length-1,f=0;f<d;f++)c+=a[f]+(f<b.length?b[f]:'%s');y.call(this,c+a[d])}function ia(a){throw new ha('Failure'+(a?': '+a:''),Array.prototype.slice.call(arguments,1))}function z(){0!=ja&&(ka[this[t]||(this[t]=++da)]=this),this.Ka=this.Ka,this.Qa=this.Qa}function pa(a){a:{for(var b=qa,c=a.length,d=l(a)?a.split(''):a,f=0;f<c;f++)if(f in d&&b.call(void 0,d[f],f,a)){b=f;break a}b=-1}return 0>b?null:l(a)?a.charAt(b):a[b]}function ra(a){if(!n(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function sa(a,b){b=la(a,b);var c;return(c=0<=b)&&Array.prototype.splice.call(a,b,1),c}function ta(){return Array.prototype.concat.apply([],arguments)}function ua(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function va(a){return /^[\s\xa0]*$/.test(a)}function xa(a,b){return a<b?-1:a>b?1:0}function B(a){return-1!=A.indexOf(a)}function Aa(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function Ba(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Ca(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Da(a){var b={},c;for(c in a)b[c]=a[c];return b}function Fa(a){for(var f=1,c,d;f<arguments.length;f++){for(c in d=arguments[f],d)a[c]=d[c];for(var g=0;g<Ea.length;g++)c=Ea[g],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Ga(a){return Ga[' '](a),a}function Ha(a,b){var c=Ia;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)}function Oa(){var a=h.document;return a?a.documentMode:void 0}function Ta(a){return Ha(a,function(){for(var b=0,c=wa(Pa+'').split('.'),d=wa(a+'').split('.'),f=_Mathmax2(c.length,d.length),g=0;0==b&&g<f;g++){var k=c[g]||'',p=d[g]||'';do{if(k=/(\d*)(\D*)(.*)/.exec(k)||['','','',''],p=/(\d*)(\D*)(.*)/.exec(p)||['','','',''],0==k[0].length&&0==p[0].length)break;b=xa(0==k[1].length?0:parseInt(k[1],10),0==p[1].length?0:parseInt(p[1],10))||xa(0==k[2].length,0==p[2].length)||xa(k[2],p[2]),k=k[3],p=p[3]}while(0==b)}return 0<=b})}function D(a,b){this.type=a,this.currentTarget=this.target=b,this.defaultPrevented=this.Ea=!1,this.Be=!0}function E(a,b){D.call(this,a?a.type:''),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key='',this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType='',this.fb=null,a&&this.Kf(a,b)}function F(a){return a&&a[ab]}function cb(a,b,c,d,f){this.listener=a,this.proxy=null,this.src=b,this.type=c,this.capture=!!d,this.Ob=f,this.key=++bb,this.Sa=this.Eb=!1}function db(a){this.src=a,this.J={},this.xb=0}function eb(a,b,c,d){for(var f=0,g;f<a.length;++f)if(g=a[f],!g.Sa&&g.listener==b&&g.capture==!!c&&g.Ob==d)return f;return-1}function ib(a,b,c,d,f){if(d&&d.once)return jb(a,b,c,d,f);if(n(b)){for(var g=0;g<b.length;g++)ib(a,b[g],c,d,f);return null}return c=kb(c),F(a)?a.nb(b,c,r(d)?!!d.capture:!!d,f):lb(a,b,c,!1,d,f)}function lb(a,b,c,d,f,g){if(!b)throw Error('Invalid event type');var k=r(f)?!!f.capture:!!f,p=G(a);if(p||(a[fb]=p=new db(a)),c=p.add(b,c,d,k,g),c.proxy)return c;if(d=mb(),c.proxy=d,d.src=a,d.listener=c,a.addEventListener)Za||(f=k),void 0===f&&(f=!1),a.addEventListener(b.toString(),d,f);else if(a.attachEvent)a.attachEvent(nb(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error('addEventListener and attachEvent are unavailable.');return c}function mb(){var a=ob,b=Xa?function(c){return a.call(b.src,b.listener,c)}:function(c){if(c=a.call(b.src,b.listener,c),!c)return c};return b}function jb(a,b,c,d,f){if(n(b)){for(var g=0;g<b.length;g++)jb(a,b[g],c,d,f);return null}return c=kb(c),F(a)?a.Oc(b,c,r(d)?!!d.capture:!!d,f):lb(a,b,c,!0,d,f)}function pb(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)pb(a,b[g],c,d,f);else d=r(d)?!!d.capture:!!d,c=kb(c),F(a)?a.ed(b,c,d,f):a&&(a=G(a))&&(b=a.jb(b,c,d,f))&&qb(b)}function qb(a){if('number'!=typeof a&&a&&!a.Sa){var b=a.src;if(F(b))b.Le(a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(nb(c),d):b.addListener&&b.removeListener&&b.removeListener(d),(c=G(b))?(c.ye(a),0==c.xb&&(c.src=null,b[fb]=null)):a.Vb()}}}function nb(a){return a in gb?gb[a]:gb[a]='on'+a}function rb(a,b,c,d){var f=!0;if((a=G(a))&&(b=a.J[b.toString()]))for(b=b.concat(),a=0;a<b.length;a++){var g=b[a];g&&g.capture==c&&!g.Sa&&(g=sb(g,d),f=f&&!1!==g)}return f}function sb(a,b){var c=a.listener,d=a.Ob||a.src;return a.Eb&&qb(a),c.call(d,b)}function ob(a,b){if(a.Sa)return!0;if(!Xa){var c=b||m('window.event');b=new E(c,this);var d=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(k){f=!0}(f||void 0==c.returnValue)&&(c.returnValue=!0)}for(c=[],f=b.currentTarget;f;f=f.parentNode)c.push(f);for(a=a.type,f=c.length-1;!b.Ea&&0<=f;f--){b.currentTarget=c[f];var g=rb(c[f],a,!0,b);d=d&&g}for(f=0;!b.Ea&&f<c.length;f++)b.currentTarget=c[f],g=rb(c[f],a,!1,b),d=d&&g}return d}return sb(a,new E(b,this))}function G(a){return a=a[fb],a instanceof db?a:null}function kb(a){return q(a)?a:(a[tb]||(a[tb]=function(b){return a.handleEvent(b)}),a[tb])}function H(){z.call(this),this.ka=new db(this),this.Pe=this,this.Uc=null}function vb(a,b){this.Sf=100,this.ef=a,this.ug=b,this.Zb=0,this.Pb=null}function I(){this.lc=this.Va=null}function wb(){this.next=this.scope=this.Gc=null}function yb(a){h.setTimeout(function(){throw a},0)}function Ab(){var a=h.MessageChannel;if('undefined'==typeof a&&'undefined'!=typeof window&&window.postMessage&&window.addEventListener&&!B('Presto')&&(a=function(){var a=document.createElement('IFRAME');a.style.display='none',a.src='',document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document,a.open(),a.write(''),a.close();var c='callImmediate'+Math.random(),d='file:'==b.location.protocol?'*':b.location.protocol+'//'+b.location.host;a=u(function(a){('*'==d||a.origin==d)&&a.data==c&&this.port1.onmessage()},this),b.addEventListener('message',a,!1),this.port1={},this.port2={postMessage:function(){b.postMessage(c,d)}}}),'undefined'!=typeof a&&!B('Trident')&&!B('MSIE')){var b=new a,c={},d=c;return b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.rd;c.rd=null,a()}},function(a){d.next={rd:a},d=d.next,b.port2.postMessage(0)}}return'undefined'!=typeof document&&'onreadystatechange'in document.createElement('SCRIPT')?function(a){var b=document.createElement('SCRIPT');b.onreadystatechange=function(){b.onreadystatechange=null,b.parentNode.removeChild(b),b=null,a(),a=null},document.documentElement.appendChild(b)}:function(a){h.setTimeout(a,0)}}function Cb(){if(h.Promise&&h.Promise.resolve){var a=h.Promise.resolve(void 0);Bb=function(){a.then(Db)}}else Bb=function(){var a=Db;!q(h.setImmediate)||h.Window&&h.Window.prototype&&!B('Edge')&&h.Window.prototype.setImmediate==h.setImmediate?(zb||(zb=Ab()),zb(a)):h.setImmediate(a)}}function Db(){for(var a;a=Fb.remove();){try{a.Gc.call(a.scope)}catch(b){yb(b)}Fb.wg(a)}Eb=!1}function Gb(a,b){H.call(this),this.Na=a||1,this.wb=b||h,this.nd=u(this.Rg,this),this.ie=w()}function Hb(a,b,c){if(q(a))c&&(a=u(a,c));else if(a&&'function'==typeof a.handleEvent)a=u(a.handleEvent,a);else throw Error('Invalid listener argument');return 2147483647<+b?-1:h.setTimeout(a,b||0)}function Ib(a,b,c){z.call(this),this.Uf=null==c?a:u(a,c),this.Na=b,this.Xe=u(this.fg,this),this.qc=[]}function Jb(a){z.call(this),this.i=a,this.o={}}function J(a,b,c){this.reset(a,b,c,void 0,void 0)}function Mb(a){this.pe=a,this.Zd=this.uc=this.mb=this.$b=null}function K(a,b){this.name=a,this.value=b}function Vb(a){Tb||(Tb=new Mb(''),Sb['']=Tb,Tb.Ge(Qb));var b;if(!(b=Sb[a])){b=new Mb(a);var c=a.lastIndexOf('.'),d=a.substr(c+1);c=Vb(a.substr(0,c)),c.Qe(d,b),b.Fg(c),Sb[a]=b}return b}function Wb(a,b){a&&a.info(b,void 0)}function L(a,b){a&&a.lf(b)}function Xb(){this.s=Vb('goog.labs.net.webChannel.WebChannelDebug'),this.Wc=!0}function Yb(a){D.call(this,'serverreachability',a)}function N(a){M.dispatchEvent(new Yb(M,a))}function Zb(a,b){D.call(this,'statevent',a),this.stat=b}function O(a){M.dispatchEvent(new Zb(M,a))}function $b(a,b,c){D.call(this,'timingevent',a),this.size=b,this.rtt=c}function ac(a,b,c){M.dispatchEvent(new $b(M,a,b,c))}function P(a,b){if(!q(a))throw Error('Fn must not be null and must be a function');return h.setTimeout(function(){a()},b)}function dc(){}function ec(){}function fc(){D.call(this,'d')}function gc(){D.call(this,'c')}function ic(){}function R(a,b,c,d,f){this.b=a,this.a=b,this.ra=c,this.R=d,this.Xc=f||1,this.Fc=new Jb(this),this.Ua=jc,a=La?125:void 0,this.Vc=new Gb(a),this.A=null,this.S=!1,this.Da=this.pa=this.ua=this.ic=this.qb=this.hd=this.Ga=null,this.ba=[],this.h=null,this.Bb=0,this.I=this.Fa=null,this.w=-1,this.Za=!1,this.Ra=0,this.ac=null,this.lb=this.Ed=this.yc=!1}function kc(a,b){return 0===a?'Non-200 return code ('+b+')':1===a?'XMLHTTP failure (no data)':2===a?'HttpConnection timeout':'Unknown error'}function nc(a){if(a.H&&'function'==typeof a.H)return a.H();if(l(a))return a.split('');if(ca(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Ba(a)}function oc(a,b,c){if(a.forEach&&'function'==typeof a.forEach)a.forEach(b,c);else if(ca(a)||l(a))na(a,b,c);else{if(a.W&&'function'==typeof a.W)var d=a.W();else if(a.H&&'function'==typeof a.H)d=void 0;else if(ca(a)||l(a)){d=[];for(var f=a.length,g=0;g<f;g++)d.push(g)}else d=Ca(a);f=nc(a),g=f.length;for(var k=0;k<g;k++)b.call(c,f[k],d&&d[k],a)}}function S(a){this.D={},this.o=[],this.j=0;var c=arguments.length;if(1<c){if(c%2)throw Error('Uneven number of arguments');for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.addAll(a)}function T(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function qc(a,b){if(a){a=a.split('&');for(var c=0;c<a.length;c++){var d=a[c].indexOf('='),f=null;if(0<=d){var g=a[c].substring(0,d);f=a[c].substring(d+1)}else g=a[c];b(g,f?decodeURIComponent(f.replace(/\+/g,' ')):'')}}}function U(a,b){this.xa=this.zb=this.qa='',this.Ca=null,this.ib=this.K='',this.O=this.Qf=!1;var c;a instanceof U?(this.O=void 0===b?a.O:b,this.tb(a.qa),this.cd(a.zb),this.rb(a.xa),this.sb(a.Ca),this.ec(a.K),this.bd(a.P.clone()),this.$c(a.ib)):a&&(c=(a+'').match(pc))?(this.O=!!b,this.tb(c[1]||'',!0),this.cd(c[2]||'',!0),this.rb(c[3]||'',!0),this.sb(c[4]),this.ec(c[5]||'',!0),this.bd(c[6]||'',!0),this.$c(c[7]||'',!0)):(this.O=!!b,this.P=new rc(null,this.O))}function Ac(a){return a instanceof U?a.clone():new U(a,void 0)}function Bc(a,b,c,d){var f=new U(null,void 0);return a&&f.tb(a),b&&f.rb(b),c&&f.sb(c),d&&f.ec(d),f}function yc(a,b){return a?b?decodeURI(a.replace(/%25/g,'%2525')):decodeURIComponent(a):''}function sc(a,b,c){return l(a)?(a=encodeURI(a).replace(b,Cc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,'%$1')),a):null}function Cc(a){return a=a.charCodeAt(0),'%'+(15&a>>4).toString(16)+(15&a).toString(16)}function rc(a,b){this.j=this.m=null,this.ja=a||null,this.O=!!b}function Hc(a,b){this.b=a,this.a=b,this.f=this.A=null,this.bc=!1,this.K=null,this.w=-1,this.Ad=this.na=null}function Ic(){this.od=this.$d=null}function Jc(a){this.D=new S,a&&this.addAll(a)}function Kc(a){var b=typeof a;return'object'==b&&a||'function'==b?'o'+(a[t]||(a[t]=++da)):b.substr(0,1)+a}function Lc(a,b){this.Pc=a,this.map=b,this.context=null}function Mc(a){this.me=a||Nc,h.PerformanceNavigationTiming?(a=h.performance.getEntriesByType('navigation'),a=0<a.length&&('hq'==a[0].nextHopProtocol||'h2'==a[0].nextHopProtocol)):a=!!(h.vc&&h.vc.ke&&h.vc.ke()&&h.vc.ke().nh),this.Xb=a?this.me:1,this.v=null,1<this.Xb&&(this.v=new Jc),this.f=null,this.ba=[]}function Oc(){this.xg=this.rg=void 0}function Pc(){this.jg=new Oc}function Qc(a,b){var c=new Xb;c.debug('TestLoadImage: loading '+a);var d=new Image;d.onload=v(Rc,c,d,'TestLoadImage: loaded',!0,b),d.onerror=v(Rc,c,d,'TestLoadImage: error',!1,b),d.onabort=v(Rc,c,d,'TestLoadImage: abort',!1,b),d.ontimeout=v(Rc,c,d,'TestLoadImage: timeout',!1,b),h.setTimeout(function(){d.ontimeout&&d.ontimeout()},1E4),d.src=a}function Rc(a,b,c,d,f){try{a.debug(c),b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,f(d)}catch(g){a.cb(g)}}function V(a){H.call(this),this.headers=new S,this.Xa=a||null,this.ha=!1,this.mc=this.c=null,this.ge=this.Tb='',this.Pa=0,this.I='',this.Aa=this.Lc=this.Qb=this.Ec=!1,this.vb=0,this.hc=null,this.Ae=Tc,this.jc=this.lg=this.Ab=!1}function Wc(a){return C&&Ta(9)&&'number'==typeof a.timeout&&void 0!==a.ontimeout}function qa(a){return'content-type'==a.toLowerCase()}function Xc(a,b){return{type:b,lengthComputable:a.lengthComputable,loaded:a.loaded,total:a.total}}function Yc(a){var b='';return Aa(a,function(a,d){b+=d,b+=':',b+=a,b+='\r\n'}),b}function Zc(a,b,c){a:{for(d in c){var d=!1;break a}d=!0}if(d)return a;if(c=Yc(c),l(a)){if(b=encodeURIComponent(b+''),c=null==c?'':'='+encodeURIComponent(c+''),b+=c){if(c=a.indexOf('#'),0>c&&(c=a.length),d=a.indexOf('?'),0>d||d>c){d=c;var f=''}else f=a.substring(d+1,c);a=[a.substr(0,d),f,a.substr(c)],c=a[1],a[1]=b?c?c+'&'+b:b:c,a=a[0]+(a[1]?'?'+a[1]:'')+a[2]}return a}return a.l(b,c),a}function $c(a){this.Bd=22,this.De=0,this.M=[],this.a=new Xb,this.Ib=new Ic,this.na=this.md=this.hb=this.K=this.u=this.Kc=this.aa=this.gb=this.N=this.Rb=this.A=null,this.Te=!0,this.ag=this.Yb=0,this.kf=!!m('internalChannelParams.failFast',a),this.fd=this.Ja=this.wa=this.ia=this.ea=this.i=null,this.Se=!0,this.w=this.he=this.Sb=-1,this.rc=this.Ha=this.La=0,this.Ve=m('internalChannelParams.baseRetryDelayMs',a)||5E3,this.vg=m('internalChannelParams.retryDelaySeedMs',a)||1E4,this.nf=m('internalChannelParams.forwardChannelMaxRetries',a)||2,this.Od=m('internalChannelParams.forwardChannelRequestTimeoutMs',a)||2E4,this.Xa=a&&a.oh||void 0,this.Db=void 0,this.Ra=0,this.gc=a&&a.supportsCrossDomainXhr||!1,this.ra='',this.G=new Mc(a&&a.concurrentRequestLimit),this.kc=new Pc,this.ta=a&&void 0!==a.backgroundChannelTest?a.backgroundChannelTest:!0,(this.Nd=a&&a.fastHandshake||!1)&&!this.ta&&(this.a.T('Force backgroundChannelTest when fastHandshake is enabled.'),this.ta=!0),a&&a.Id&&this.a.Id()}function ad(){}function bd(){for(var b=arguments[0],c=1,d;c<arguments.length;c++)if(d=arguments[c],0==d.lastIndexOf('/',0))b=d;else{var f;(f=''==b)||(f=b.length-1,f=0<=f&&b.indexOf('/',f)==f),b=f?b+d:b+('/'+d)}return b}function cd(){if(C&&!(10<=+Ua))throw Error('Environmental error: no available transport.')}function W(a,b){H.call(this),this.b=new $c(b),this.yb=a,this.Qg=b&&b.testUrl?b.testUrl:bd(this.yb,'test'),this.s=Vb('goog.labs.net.webChannel.WebChannelBaseTransport'),this.Rc=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a['X-Client-Protocol']='webchannel':a={"X-Client-Protocol":'webchannel'}),this.b.ga(a),a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a['X-WebChannel-Content-Type']=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.zd&&(a?a['X-WebChannel-Client-Profile']=b.zd:a={"X-WebChannel-Client-Profile":b.zd}),this.b.Eg(a),(a=b&&b.httpHeadersOverwriteParam)&&!va(a)&&this.b.Cg(a),this.Og=b&&b.supportsCrossDomainXhr||!1,this.zg=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!va(b)&&(this.b.Dg(b),a=this.Rc,null!==a&&b in a&&(a=this.Rc,b in a&&delete a[b],(a=this.s)&&a.T('Ignore httpSessionIdParam also specified with messageUrlParams: '+b,void 0))),this.vd=new X(this)}function dd(a){fc.call(this);var b=a.__sm__;if(b){a:{for(var c in b){a=c;break a}a=void 0}(this.ne=a)&&(a=this.ne,b=null!==b&&a in b?b[a]:void 0),this.data=b}else this.data=a}function ed(a){gc.call(this),this.status=1,this.errorCode=a}function X(a){this.b=a}function gd(){this.V=[],this.Z=[]}function hd(a,b){if(z.call(this),this.oe=a||0,this.Wb=b||10,this.oe>this.Wb)throw Error(id);this.fa=new gd,this.oa=new Jc,this.Ac=0,this.Nc=null,this.Cb()}function jd(a,b){this.fe=a,this.gd=b}function kd(a){this.Y=[],a&&this.Lf(a)}function ld(){kd.call(this)}function Y(a,b){this.Gd=void 0,this.cc=new ld,hd.call(this,a,b)}function Z(a,b,c,d){this.Jf=a,this.Ab=!!d,Y.call(this,b,c)}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0}),__webpack_require__.d(__webpack_exports__,'createWebChannelTransport',function(){return src_1}),__webpack_require__.d(__webpack_exports__,'ErrorCode',function(){return src_2}),__webpack_require__.d(__webpack_exports__,'EventType',function(){return src_3}),__webpack_require__.d(__webpack_exports__,'WebChannel',function(){return src_4}),__webpack_require__.d(__webpack_exports__,'XhrIoPool',function(){return src_5});var commonjsGlobal='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,goog=goog||{},h=commonjsGlobal,t='closure_uid_'+(1E9*Math.random()>>>0),da=0,w=Date.now||function(){return+new Date},e;x(y,Error),y.prototype.name='CustomError',x(ha,y),ha.prototype.name='AssertionError';var ja=0,ka={};z.prototype.Ka=!1,z.prototype.bb=function(){if(!this.Ka&&(this.Ka=!0,this.F(),0!=ja)){var a=this[t]||(this[t]=++da);if(0!=ja)throw Error(this+' did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass\' method.');delete ka[a]}},z.prototype.F=function(){if(this.Qa)for(;this.Qa.length;)this.Qa.shift()()};var la=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if(l(a))return l(b)&&1==b.length?a.indexOf(b,0):-1;for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ma=Array.prototype.lastIndexOf?function(a,b){return Array.prototype.lastIndexOf.call(a,b,a.length-1)}:function(a,b){var c=a.length-1;if(0>c&&(c=_Mathmax2(0,a.length+c)),l(a))return l(b)&&1==b.length?a.lastIndexOf(b,c):-1;for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1},na=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=l(a)?a.split(''):a,g=0;g<d;g++)g in f&&b.call(c,f[g],g,a)},oa=Array.prototype.some?function(a,b){return Array.prototype.some.call(a,b,void 0)}:function(a,b){for(var c=a.length,d=l(a)?a.split(''):a,f=0;f<c;f++)if(f in d&&b.call(void 0,d[f],f,a))return!0;return!1},wa=String.prototype.trim?function(a){return a.trim()}:function(a){return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]},A;a:{var ya=h.navigator;if(ya){var za=ya.userAgent;if(za){A=za;break a}}A=''}var Ea='constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf'.split(' ');Ga[' ']=aa;var Ja=B('Opera'),C=B('Trident')||B('MSIE'),Ka=B('Edge'),La=Ka||C,Ma=B('Gecko')&&(-1==A.toLowerCase().indexOf('webkit')||B('Edge'))&&!(B('Trident')||B('MSIE'))&&!B('Edge'),Na=-1!=A.toLowerCase().indexOf('webkit')&&!B('Edge'),Pa;a:{var Qa='',Ra=function(){var a=A;return Ma?/rv:([^\);]+)(\)|;)/.exec(a):Ka?/Edge\/([\d\.]+)/.exec(a):C?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):Na?/WebKit\/(\S+)/.exec(a):Ja?/(?:Version)[ \/]?(\S+)/.exec(a):void 0}();if(Ra&&(Qa=Ra?Ra[1]:''),C){var Sa=Oa();if(null!=Sa&&Sa>parseFloat(Qa)){Pa=Sa+'';break a}}Pa=Qa}var Ia={},Va=h.document,Ua;Ua=Va&&C?Oa()||('CSS1Compat'==Va.compatMode?parseInt(Pa,10):5):void 0;var Wa=Object.freeze||function(a){return a},Xa=!C||9<=+Ua,Ya=C&&!Ta('9'),Za=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},'passive',{get:function(){a=!0}});try{h.addEventListener('test',aa,b),h.removeEventListener('test',aa,b)}catch(c){}return a}();D.prototype.stopPropagation=function(){this.Ea=!0},D.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Be=!1},x(E,D);var $a=Wa({2:'touch',3:'pen',4:'mouse'});E.prototype.Kf=function(a,b){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.currentTarget=b,!(b=a.relatedTarget))'mouseover'==c?b=a.fromElement:'mouseout'==c&&(b=a.toElement);else if(Ma){a:{try{Ga(b.nodeName);var f=!0;break a}catch(g){}f=!1}f||(b=null)}this.relatedTarget=b,null===d?(this.offsetX=Na||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=Na||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0===a.clientX?a.pageX:a.clientX,this.clientY=void 0===a.clientY?a.pageY:a.clientY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0===d.clientX?d.pageX:d.clientX,this.clientY=void 0===d.clientY?d.pageY:d.clientY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=a.button,this.keyCode=a.keyCode||0,this.key=a.key||'',this.charCode=a.charCode||('keypress'==c?a.keyCode:0),this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=l(a.pointerType)?a.pointerType:$a[a.pointerType]||'',this.state=a.state,this.fb=a,a.defaultPrevented&&this.preventDefault()},E.prototype.stopPropagation=function(){E.L.stopPropagation.call(this),this.fb.stopPropagation?this.fb.stopPropagation():this.fb.cancelBubble=!0},E.prototype.preventDefault=function(){E.L.preventDefault.call(this);var a=this.fb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Ya)try{(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)&&(a.keyCode=-1)}catch(b){}};var ab='closure_listenable_'+(0|1E6*Math.random()),bb=0;cb.prototype.Vb=function(){this.Sa=!0,this.Ob=this.src=this.proxy=this.listener=null},e=db.prototype,e.add=function(a,b,c,d,f){var g=a.toString();a=this.J[g],a||(a=this.J[g]=[],this.xb++);var k=eb(a,b,d,f);return-1<k?(b=a[k],c||(b.Eb=!1)):(b=new cb(b,this.src,g,!!d,f),b.Eb=c,a.push(b)),b},e.remove=function(a,b,c,d){if(a=a.toString(),!(a in this.J))return!1;var f=this.J[a];return b=eb(f,b,c,d),!!(-1<b)&&(f[b].Vb(),Array.prototype.splice.call(f,b,1),0==f.length&&(delete this.J[a],this.xb--),!0)},e.ye=function(a){var b=a.type;b in this.J&&sa(this.J[b],a)&&(a.Vb(),0==this.J[b].length&&(delete this.J[b],this.xb--))},e.pb=function(a){a=a&&a.toString();for(var c in this.J)if(!a||c==a){for(var d=this.J[c],f=0;f<d.length;f++)d[f].Vb();delete this.J[c],this.xb--}},e.jb=function(a,b,c,d){a=this.J[a.toString()];var f=-1;return a&&(f=eb(a,b,c,d)),-1<f?a[f]:null};var fb='closure_lm_'+(0|1E6*Math.random()),gb={},tb='__closure_events_fn_'+(1E9*Math.random()>>>0);x(H,z),H.prototype[ab]=!0,e=H.prototype,e.addEventListener=function(a,b,c,d){ib(this,a,b,c,d)},e.removeEventListener=function(a,b,c,d){pb(this,a,b,c,d)},e.dispatchEvent=function(a){var c=this.Uc,b;if(c)for(b=[];c;c=c.Uc)b.push(c);c=this.Pe;var d=a.type||a;if(l(a))a=new D(a,c);else if(a instanceof D)a.target=a.target||c;else{var f=a;a=new D(d,c),Fa(a,f)}if(f=!0,b)for(var g=b.length-1,k;!a.Ea&&0<=g;g--)k=a.currentTarget=b[g],f=k.Lb(d,!0,a)&&f;if(a.Ea||(k=a.currentTarget=c,f=k.Lb(d,!0,a)&&f,a.Ea||(f=k.Lb(d,!1,a)&&f)),b)for(g=0;!a.Ea&&g<b.length;g++)k=a.currentTarget=b[g],f=k.Lb(d,!1,a)&&f;return f},e.F=function(){H.L.F.call(this),this.pg(),this.Uc=null},e.nb=function(a,b,c,d){return this.ka.add(a+'',b,!1,c,d)},e.Oc=function(a,b,c,d){return this.ka.add(a+'',b,!0,c,d)},e.ed=function(a,b,c,d){this.ka.remove(a+'',b,c,d)},e.Le=function(a){this.ka.ye(a)},e.pg=function(){this.ka&&this.ka.pb(void 0)},e.Lb=function(a,b,c){if(a=this.ka.J[a+''],!a)return!0;a=a.concat();for(var d=!0,f=0,g;f<a.length;++f)if(g=a[f],g&&!g.Sa&&g.capture==b){var k=g.listener,p=g.Ob||g.src;g.Eb&&this.Le(g),d=!1!==k.call(p,c)&&d}return d&&0!=c.Be},e.jb=function(a,b,c,d){return this.ka.jb(a+'',b,c,d)};var ub=h.JSON.stringify;vb.prototype.get=function(){if(0<this.Zb){this.Zb--;var a=this.Pb;this.Pb=a.next,a.next=null}else a=this.ef();return a},vb.prototype.put=function(a){this.ug(a),this.Zb<this.Sf&&(this.Zb++,a.next=this.Pb,this.Pb=a)};var xb=new vb(function(){return new wb},function(a){a.reset()});I.prototype.add=function(a,b){var c=this.Af();c.set(a,b),this.lc?this.lc.next=c:this.Va=c,this.lc=c},I.prototype.remove=function(){var a=null;return this.Va&&(a=this.Va,this.Va=this.Va.next,this.Va||(this.lc=null),a.next=null),a},I.prototype.wg=function(a){xb.put(a)},I.prototype.Af=function(){return xb.get()},wb.prototype.set=function(a,b){this.Gc=a,this.scope=b,this.next=null},wb.prototype.reset=function(){this.next=this.scope=this.Gc=null};var Eb=!1,Fb=new I,zb,Bb;x(Gb,H),e=Gb.prototype,e.enabled=!1,e.B=null,e.setInterval=function(a){this.Na=a,this.B&&this.enabled?(this.stop(),this.start()):this.B&&this.stop()},e.Rg=function(){if(this.enabled){var a=w()-this.ie;0<a&&a<.8*this.Na?this.B=this.wb.setTimeout(this.nd,this.Na-a):(this.B&&(this.wb.clearTimeout(this.B),this.B=null),this.ff(),this.enabled&&(this.stop(),this.start()))}},e.ff=function(){this.dispatchEvent('tick')},e.start=function(){this.enabled=!0,this.B||(this.B=this.wb.setTimeout(this.nd,this.Na),this.ie=w())},e.stop=function(){this.enabled=!1,this.B&&(this.wb.clearTimeout(this.B),this.B=null)},e.F=function(){Gb.L.F.call(this),this.stop(),delete this.wb},x(Ib,z),e=Ib.prototype,e.Ta=!1,e.ob=0,e.B=null,e.mf=function(){this.qc=arguments,this.B||this.ob?this.Ta=!0:this.Cc()},e.stop=function(){this.B&&(h.clearTimeout(this.B),this.B=null,this.Ta=!1,this.qc=[])},e.pause=function(){this.ob++},e.resume=function(){this.ob--,this.ob||!this.Ta||this.B||(this.Ta=!1,this.Cc())},e.F=function(){Ib.L.F.call(this),this.stop()},e.fg=function(){this.B=null,this.Ta&&!this.ob&&(this.Ta=!1,this.Cc())},e.Cc=function(){this.B=Hb(this.Xe,this.Na),this.Uf.apply(null,this.qc)},x(Jb,z);var Kb=[];e=Jb.prototype,e.nb=function(a,b,c,d){return this.Tf(a,b,c,d)},e.Tf=function(a,b,c,d){n(b)||(b&&(Kb[0]=b.toString()),b=Kb);for(var f=0,g;f<b.length&&(g=ib(a,b[f],c||this.handleEvent,d||!1,this.i||this),!!g);f++)this.o[g.key]=g;return this},e.Oc=function(a,b,c,d){return this.je(a,b,c,d)},e.je=function(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)this.je(a,b[g],c,d,f);else{if(a=jb(a,b,c||this.handleEvent,d,f||this.i||this),!a)return this;this.o[a.key]=a}return this},e.ed=function(a,b,c,d,f){if(n(b))for(var g=0;g<b.length;g++)this.ed(a,b[g],c,d,f);else c=c||this.handleEvent,d=r(d)?!!d.capture:!!d,f=f||this.i||this,c=kb(c),d=!!d,b=F(a)?a.jb(b,c,d,f):a?(a=G(a))?a.jb(b,c,d,f):null:null,b&&(qb(b),delete this.o[b.key])},e.pb=function(){Aa(this.o,function(a,b){this.o.hasOwnProperty(b)&&qb(a)},this),this.o={}},e.F=function(){Jb.L.F.call(this),this.pb()},e.handleEvent=function(){throw Error('EventHandler.handleEvent not implemented')},J.prototype.Md=null,J.prototype.reset=function(a){this.mb=a,delete this.Md},J.prototype.Bg=function(a){this.Md=a},J.prototype.Ge=function(a){this.mb=a},K.prototype.toString=function(){return this.name};var Nb=new K('SEVERE',1E3),Ob=new K('WARNING',900),Pb=new K('INFO',800),Qb=new K('CONFIG',700),Rb=new K('FINE',500);e=Mb.prototype,e.getName=function(){return this.pe},e.getParent=function(){return this.$b},e.pf=function(){return this.uc||(this.uc={}),this.uc},e.Ge=function(a){this.mb=a},e.Qd=function(){return this.mb?this.mb:this.$b?this.$b.Qd():(ia('Root logger has no level set.'),null)},e.Pf=function(a){return a.value>=this.Qd().value},e.log=function(a,b,c){this.Pf(a)&&(q(b)&&(b=b()),this.gf(this.uf(a,b,c)))},e.uf=function(a,b,c){return a=new J(a,b+'',this.pe),c&&a.Bg(c),a},e.ca=function(a,b){this.log(Nb,a,b)},e.T=function(a,b){this.log(Ob,a,b)},e.info=function(a,b){this.log(Pb,a,b)},e.lf=function(a){this.log(Rb,a,void 0)},e.gf=function(a){for(var b=this;b;)b.We(a),b=b.getParent()},e.We=function(a){if(this.Zd)for(var b=0,c;c=this.Zd[b];b++)c(a)},e.Fg=function(a){this.$b=a},e.Qe=function(a,b){this.pf()[a]=b};var Sb={},Tb=null;e=Xb.prototype,e.Id=function(){this.Wc=!1},e.Tg=function(a,b,c,d,f){var g=this;this.info(function(){return'XMLHTTP REQ ('+c+') [attempt '+d+']: '+a+'\n'+b+'\n'+g.Xf(f)})},e.Ug=function(a,b,c,d,f,g){this.info(function(){return'XMLHTTP RESP ('+c+') [ attempt '+d+']: '+a+'\n'+b+'\n'+f+' '+g})},e.Wa=function(a,b,c){var d=this;this.info(function(){return'XMLHTTP TEXT ('+a+'): '+d.ng(b)+(c?' '+c:'')})},e.Sg=function(a){this.info(function(){return'TIMEOUT: '+a})},e.debug=function(a){L(this.s,a)},e.cb=function(a,b){var c=this.s;c&&c.ca(b||'Exception',a)},e.info=function(a){Wb(this.s,a)},e.T=function(a){var b=this.s;b&&b.T(a,void 0)},e.ca=function(a){var b=this.s;b&&b.ca(a,void 0)},e.ng=function(a){if(!this.Wc)return a;if(!a)return null;try{var b=JSON.parse(a);if(b)for(var c=0;c<b.length;c++)n(b[c])&&this.Wf(b[c]);return ub(b)}catch(d){return this.debug('Exception parsing expected JS array - probably was not JS'),a}},e.Wf=function(a){if(!(2>a.length||(a=a[1],!n(a)||1>a.length))){var b=a[0];if('noop'!=b&&'stop'!=b&&'close'!=b)for(b=1;b<a.length;b++)a[b]=''}},e.Xf=function(a){if(!this.Wc)return a;if(!a)return null;var b='';a=a.split('&');for(var c=0,d;c<a.length;c++)if(d=a[c].split('='),1<d.length){var f=d[0];d=d[1];var g=f.split('_');b=2<=g.length&&'type'==g[1]?b+(f+'='+d+'&'):b+(f+'=redacted&')}return b};var M=new H;x(Yb,D),x(Zb,D),x($b,D);var bc={NO_ERROR:0,Vg:1,bh:2,ah:3,Yg:4,$g:5,dh:6,Ne:7,TIMEOUT:8,gh:9},cc={Xg:'complete',kh:'success',Oe:'error',Ne:'abort',ih:'ready',jh:'readystatechange',TIMEOUT:'timeout',eh:'incrementaldata',hh:'progress',Zg:'downloadprogress',lh:'uploadprogress'};dc.prototype.pd=null,dc.prototype.Vd=function(){return this.pd||(this.pd=this.Mf())};var Q={OPEN:'a',Wg:'b',Oe:'c',fh:'d'};x(fc,D),x(gc,D);var hc;x(ic,dc),ic.prototype.Dd=function(){var a=this.Wd();return a?new ActiveXObject(a):new XMLHttpRequest},ic.prototype.Mf=function(){var a={};return this.Wd()&&(a[0]=!0,a[1]=!0),a},ic.prototype.Wd=function(){if(!this.be&&'undefined'==typeof XMLHttpRequest&&'undefined'!=typeof ActiveXObject){for(var a=['MSXML2.XMLHTTP.6.0','MSXML2.XMLHTTP.3.0','MSXML2.XMLHTTP','Microsoft.XMLHTTP'],b=0,c;b<a.length;b++){c=a[b];try{return new ActiveXObject(c),this.be=c}catch(d){}}throw Error('Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed')}return this.be},hc=new ic;var jc=45E3,lc={},mc={};e=R.prototype,e.ga=function(a){this.A=a},e.setTimeout=function(a){this.Ua=a},e.He=function(a){this.Ra=a},e.Gg=function(a){this.ba=a},e.la=function(){return this.ba},e.kd=function(a,b){this.ic=1,this.ua=a.clone().Ub(),this.Da=b,this.yc=!0,this.Ce(null)},e.jd=function(a,b,c){this.ic=1,this.ua=a.clone().Ub(),this.Da=null,this.yc=b,this.Ce(c)},e.Ce=function(a){this.qb=w(),this.eb(),this.pa=this.ua.clone(),this.pa.dc('t',this.Xc),this.Bb=0,this.h=this.b.Jb(this.b.fc()?a:null),0<this.Ra&&(this.ac=new Ib(u(this.Me,this,this.h),this.Ra)),this.Fc.nb(this.h,'readystatechange',this.mg),a=this.A?Da(this.A):{},this.Da?(this.Fa||(this.Fa='POST'),a['Content-Type']='application/x-www-form-urlencoded',this.h.send(this.pa,this.Fa,this.Da,a)):(this.Fa='GET',this.h.send(this.pa,this.Fa,null,a)),N(1),this.a.Tg(this.Fa,this.pa,this.R,this.Xc,this.Da)},e.mg=function(a){a=a.target;var b=this.ac;b&&3==a.ma()?(this.a.debug('Throttling readystatechange.'),b.mf()):this.Me(a)},e.Me=function(a){try{a==this.h?this.hg():this.a.T('Called back with an unexpected xmlhttp')}catch(c){if(this.a.debug('Failed call to OnXmlHttpReadyStateChanged_'),this.h&&this.h.ya()){var b=this;this.a.cb(c,function(){return'ResponseText: '+b.h.ya()})}else this.a.cb(c,'No response text')}finally{}},e.hg=function(){var a=this.h.ma(),b=this.h.Ud(),c=this.h.za();if(!(3>a)&&(3!=a||La||this.h.ya())){this.Za||4!=a||7==b||(8==b||0>=c?N(3):N(2)),this.Fb();var d=this.h.za();if(this.w=d,b=this.h.ya(),!b){var f=this;this.a.debug(function(){return'No response text for uri '+f.pa+' status '+d})}if(this.S=200==d,this.a.Ug(this.Fa,this.pa,this.R,this.Xc,a,d),this.S){if(this.Ig())if(c=this.sf())this.a.Wa(this.R,c,'Initial handshake response via X-HTTP-Initial-Response'),this.lb=!0,this.Yc(c);else return this.S=!1,this.I=3,O(12),this.a.T('XMLHTTP Missing X_HTTP_INITIAL_RESPONSE ('+this.R+')'),this.Ia(),void this.Kb();this.yc?(this.Fd(a,b),La&&this.S&&3==a&&this.Ng()):(this.a.Wa(this.R,b,null),this.Yc(b)),4==a&&this.Ia(),this.S&&!this.Za&&(4==a?this.b.Tc(this):(this.S=!1,this.eb()))}else 400==d&&0<b.indexOf('Unknown SID')?(this.I=3,O(12),this.a.T('XMLHTTP Unknown SID ('+this.R+')')):(this.I=0,O(13),this.a.T('XMLHTTP Bad status '+d+' ('+this.R+')')),this.Ia(),this.Kb()}},e.Ig=function(){return this.Ed&&!this.lb},e.sf=function(){if(this.h){var a=this.h.kb('X-HTTP-Initial-Response');if(a&&!va(a))return a}return null},e.Ag=function(){this.Ed=!0},e.Fd=function(a,b){for(var c=!0,d;!this.Za&&this.Bb<b.length;)if(d=this.vf(b),d==mc){4==a&&(this.I=4,O(14),c=!1),this.a.Wa(this.R,null,'[Incomplete Response]');break}else if(d==lc){this.I=4,O(15),this.a.Wa(this.R,b,'[Invalid Chunk]'),c=!1;break}else this.a.Wa(this.R,d,null),this.Yc(d);4==a&&0==b.length&&(this.I=1,O(16),c=!1),this.S=this.S&&c,c||(this.a.Wa(this.R,b,'[Invalid Chunked Response]'),this.Ia(),this.Kb())},e.kg=function(){if(this.h){var a=this.h.ma(),b=this.h.ya();this.Bb<b.length&&(this.Fb(),this.Fd(a,b),this.S&&4!=a&&this.eb())}},e.Ng=function(){this.Fc.nb(this.Vc,'tick',this.kg),this.Vc.start()},e.vf=function(a){var b=this.Bb,c=a.indexOf('\n',b);return-1==c?mc:(b=+a.substring(b,c),isNaN(b))?lc:(c+=1,c+b>a.length)?mc:(a=a.substr(c,b),this.Bb=c+b,a)},e.yg=function(a){this.ic=2,this.ua=a.clone().Ub(),a=!1,h.navigator&&h.navigator.sendBeacon&&(a=h.navigator.sendBeacon(this.ua.toString(),'')),!a&&h.Image&&(new Image().src=this.ua,a=!0),a||(this.h=this.b.Jb(null),this.h.send(this.ua)),this.qb=w(),this.eb()},e.cancel=function(){this.Za=!0,this.Ia()},e.tg=function(a){a&&this.setTimeout(a),this.Ga&&(this.Fb(),this.eb())},e.eb=function(){this.hd=w()+this.Ua,this.Ke(this.Ua)},e.Ke=function(a){if(null!=this.Ga)throw Error('WatchDog timer not null');this.Ga=P(u(this.gg,this),a)},e.Fb=function(){this.Ga&&(h.clearTimeout(this.Ga),this.Ga=null)},e.gg=function(){this.Ga=null;var a=w();0<=a-this.hd?this.Df():(this.a.T('WatchDog timer called too early'),this.Ke(this.hd-a))},e.Df=function(){this.S&&this.a.ca('Received watchdog timeout even though request loaded successfully'),this.a.Sg(this.pa),2!=this.ic&&(N(3),O(17)),this.Ia(),this.I=2,this.Kb()},e.Kb=function(){this.b.de()||this.Za||this.b.Tc(this)},e.Ia=function(){this.Fb();var a=this.ac;a&&'function'==typeof a.bb&&a.bb(),this.ac=null,this.Vc.stop(),this.Fc.pb(),this.h&&(a=this.h,this.h=null,a.abort(),a.bb())},e.Hc=function(){return this.I},e.Yc=function(a){try{this.b.ue(this,a),N(4)}catch(b){this.a.cb(b,'Error in httprequest callback')}},e=S.prototype,e.C=function(){return this.j},e.H=function(){this.wc();for(var a=[],b=0;b<this.o.length;b++)a.push(this.D[this.o[b]]);return a},e.W=function(){return this.wc(),this.o.concat()},e.va=function(a){return T(this.D,a)},e.X=function(){return 0==this.j},e.clear=function(){this.D={},this.j=this.o.length=0},e.remove=function(a){return!!T(this.D,a)&&(delete this.D[a],this.j--,this.o.length>2*this.j&&this.wc(),!0)},e.wc=function(){if(this.j!=this.o.length){for(var a=0,b=0,c;a<this.o.length;)c=this.o[a],T(this.D,c)&&(this.o[b++]=c),a++;this.o.length=b}if(this.j!=this.o.length){var d={};for(b=a=0;a<this.o.length;)c=this.o[a],T(d,c)||(this.o[b++]=c,d[c]=1),a++;this.o.length=b}},e.get=function(a,b){return T(this.D,a)?this.D[a]:b},e.set=function(a,b){T(this.D,a)||(this.j++,this.o.push(a)),this.D[a]=b},e.addAll=function(a){if(a instanceof S)for(var b=a.W(),c=0;c<b.length;c++)this.set(b[c],a.get(b[c]));else for(b in a)this.set(b,a[b])},e.forEach=function(a,b){for(var c=this.W(),d=0;d<c.length;d++){var f=c[d],g=this.get(f);a.call(b,g,f,this)}},e.clone=function(){return new S(this)};var pc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;e=U.prototype,e.toString=function(){var a=[],b=this.qa;b&&a.push(sc(b,tc,!0),':');var c=this.xa;return(c||'file'==b)&&(a.push('//'),(b=this.zb)&&a.push(sc(b,tc,!0),'@'),a.push(encodeURIComponent(c+'').replace(/%25([0-9a-fA-F]{2})/g,'%$1')),c=this.Ca,null!=c&&a.push(':',c+'')),(c=this.K)&&(this.Ic()&&'/'!=c.charAt(0)&&a.push('/'),a.push(sc(c,'/'==c.charAt(0)?uc:wc,!0))),(c=this.Rd())&&a.push('?',c),(c=this.ib)&&a.push('#',sc(c,xc)),a.join('')},e.resolve=function(a){var b=this.clone(),c=a.Hf();c?b.tb(a.qa):c=a.If(),c?b.cd(a.zb):c=a.Ic(),c?b.rb(a.xa):c=a.Ff();var d=a.K;if(c)b.sb(a.Ca);else if(c=a.ae()){if('/'!=d.charAt(0))if(this.Ic()&&!this.ae())d='/'+d;else{var f=b.K.lastIndexOf('/');-1!=f&&(d=b.K.substr(0,f+1)+d)}if(f=d,'..'==f||'.'==f)d='';else if(-1!=f.indexOf('./')||-1!=f.indexOf('/.')){d=0==f.lastIndexOf('/',0),f=f.split('/');for(var g=[],k=0,p;k<f.length;)p=f[k++],'.'==p?d&&k==f.length&&g.push(''):'..'==p?((1<g.length||1==g.length&&''!=g[0])&&g.pop(),d&&k==f.length&&g.push('')):(g.push(p),d=!0);d=g.join('/')}else d=f}return c?b.ec(d):c=a.Gf(),c?b.bd(a.P.clone()):c=a.Ef(),c&&b.$c(a.ib),b},e.clone=function(){return new U(this)},e.tb=function(a,b){this.U(),(this.qa=b?yc(a,!0):a)&&(this.qa=this.qa.replace(/:$/,''))},e.Hf=function(){return!!this.qa},e.cd=function(a,b){this.U(),this.zb=b?yc(a):a},e.If=function(){return!!this.zb},e.rb=function(a,b){this.U(),this.xa=b?yc(a,!0):a},e.Ic=function(){return!!this.xa},e.sb=function(a){if(this.U(),a){if(a=+a,isNaN(a)||0>a)throw Error('Bad port number '+a);this.Ca=a}else this.Ca=null},e.Ff=function(){return null!=this.Ca},e.ec=function(a,b){this.U(),this.K=b?yc(a,!0):a},e.ae=function(){return!!this.K},e.Gf=function(){return''!==this.P.toString()},e.bd=function(a,b){this.U(),a instanceof rc?(this.P=a,this.P.ad(this.O)):(b||(a=sc(a,zc)),this.P=new rc(a,this.O))},e.Rd=function(){return this.P.toString()},e.getQuery=function(){return this.Rd()},e.l=function(a,b){this.U(),this.P.set(a,b)},e.dc=function(a,b){this.U(),n(b)||(b=[b+'']),this.P.Ie(a,b)},e.$c=function(a,b){this.U(),this.ib=b?yc(a):a},e.Ef=function(){return!!this.ib},e.Ub=function(){return this.U(),this.l('zx',_Mathfloor2(2147483648*Math.random()).toString(36)+Math.abs(_Mathfloor2(2147483648*Math.random())^w()).toString(36)),this},e.removeParameter=function(a){return this.U(),this.P.remove(a),this},e.U=function(){if(this.Qf)throw Error('Tried to modify a read-only Uri')},e.ad=function(a){this.O=a,this.P&&this.P.ad(a)};var tc=/[#\/\?@]/g,wc=/[#\?:]/g,uc=/[#\?]/g,zc=/[#\?@]/g,xc=/#/g;e=rc.prototype,e.$=function(){if(!this.m&&(this.m=new S,this.j=0,this.ja)){var a=this;qc(this.ja,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g,' ')),c)})}},e.C=function(){return this.$(),this.j},e.add=function(a,b){this.$(),this.Oa(),a=this.Ma(a);var c=this.m.get(a);return c||this.m.set(a,c=[]),c.push(b),this.j+=1,this},e.remove=function(a){return this.$(),a=this.Ma(a),!!this.m.va(a)&&(this.Oa(),this.j-=this.m.get(a).length,this.m.remove(a))},e.clear=function(){this.Oa(),this.m=null,this.j=0},e.X=function(){return this.$(),0==this.j},e.va=function(a){return this.$(),a=this.Ma(a),this.m.va(a)},e.forEach=function(a,b){this.$(),this.m.forEach(function(c,d){na(c,function(c){a.call(b,c,d,this)},this)},this)},e.W=function(){this.$();for(var a=this.m.H(),b=this.m.W(),c=[],d=0;d<b.length;d++)for(var f=a[d],g=0;g<f.length;g++)c.push(b[d]);return c},e.H=function(a){this.$();var b=[];if(l(a))this.va(a)&&(b=ta(b,this.m.get(this.Ma(a))));else{a=this.m.H();for(var c=0;c<a.length;c++)b=ta(b,a[c])}return b},e.set=function(a,b){return this.$(),this.Oa(),a=this.Ma(a),this.va(a)&&(this.j-=this.m.get(a).length),this.m.set(a,[b]),this.j+=1,this},e.get=function(a,b){return a?(a=this.H(a),0<a.length?a[0]+'':b):b},e.Ie=function(a,b){this.remove(a),0<b.length&&(this.Oa(),this.m.set(this.Ma(a),ua(b)),this.j+=b.length)},e.toString=function(){if(this.ja)return this.ja;if(!this.m)return'';for(var a=[],b=this.m.W(),c=0;c<b.length;c++){var d=b[c],f=encodeURIComponent(d+'');d=this.H(d);for(var g=0,k;g<d.length;g++)k=f,''!==d[g]&&(k+='='+encodeURIComponent(d[g]+'')),a.push(k)}return this.ja=a.join('&')},e.Oa=function(){this.ja=null},e.clone=function(){var a=new rc;return a.ja=this.ja,this.m&&(a.m=this.m.clone(),a.j=this.j),a},e.Ma=function(a){return a+='',this.O&&(a=a.toLowerCase()),a},e.ad=function(a){a&&!this.O&&(this.$(),this.Oa(),this.m.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),this.Ie(b,a))},this)),this.O=a},e.extend=function(){for(var b=0;b<arguments.length;b++)oc(arguments[b],function(a,b){this.add(b,a)},this)},x(function Gc(){},function Fc(){}),e=Hc.prototype,e.g=null,e.ga=function(a){this.A=a},e.connect=function(a){this.K=a,a=this.b.Sd(this.K),O(3);var b=this.b.Ib.$d;null==b?(a.dc('MODE','init'),!this.b.ta&&this.b.aa&&a.dc('X-HTTP-Session-Id',this.b.aa),this.f=new R(this,this.a,void 0,void 0,void 0),this.f.ga(this.A),this.f.jd(a,!1,null),this.g=0):(this.na=this.b.$a(b[0]),this.g=1,this.xd())},e.xd=function(){this.a.debug('TestConnection: starting stage 2');var a=this.b.Ib.od;if(null!=a)this.a.debug(function(){return'Buffered'}),O(4),a?(O(10),this.b.ub(this,!1)):(O(11),this.b.ub(this,!0));else{this.f=new R(this,this.a,void 0,void 0,void 0),this.f.ga(this.A);var b=this.b.Pd(this.na,this.K);O(4),b.dc('TYPE','xmlhttp');var c=this.b.aa,d=this.b.Kc;c&&d&&b.l(c,d),this.f.jd(b,!1,this.na)}},e.Jb=function(a){return this.b.Jb(a)},e.abort=function(){this.f&&(this.f.cancel(),this.f=null),this.w=-1},e.de=function(){return!1},e.ue=function(a,b){if(this.w=a.w,0!=this.g)1==this.g&&(this.bc?O(6):'11111'==b?(O(5),this.bc=!0,this.Ze()&&(this.w=200,this.f.cancel(),this.a.debug('Test connection succeeded; using streaming connection'),O(11),this.b.ub(this,!0))):(O(7),this.bc=!1));else if(this.a.debug('TestConnection: Got data for stage 1'),this.pc(a),b){try{var c=this.b.kc.zc(b)}catch(d){return this.a.cb(d),void this.b.dd(this)}this.na=this.b.$a(c[0])}else this.a.debug('TestConnection: Null responseText'),this.b.dd(this)},e.Tc=function(){this.w=this.f.w,this.f.S?0==this.g?(this.g=1,this.a.debug('TestConnection: request complete for initial check'),this.xd()):1==this.g&&(this.a.debug('TestConnection: request complete for stage 2'),this.bc?(this.a.debug('Test connection succeeded; using streaming connection'),O(11),this.b.ub(this,!0)):(this.a.debug('Test connection failed; not using streaming'),O(10),this.b.ub(this,!1))):(this.a.debug('TestConnection: request failed, in state '+this.g),0==this.g?O(8):1==this.g&&O(9),this.b.dd(this))},e.pc=function(a){if(!this.b.ta&&(a=a.h)){var b=a.kb('X-Client-Wire-Protocol');this.Ad=b?b:null,this.b.aa&&((a=a.kb('X-HTTP-Session-Id'))?this.b.Fe(a):this.a.T('Missing X_HTTP_SESSION_ID in the handshake response'))}},e.fc=function(){return this.b.fc()},e.Ba=function(){return this.b.Ba()},e.Ze=function(){return!C||10<=+Ua},e=Jc.prototype,e.C=function(){return this.D.C()},e.add=function(a){this.D.set(Kc(a),a)},e.addAll=function(a){a=nc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])},e.pb=function(a){a=nc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])},e.remove=function(a){return this.D.remove(Kc(a))},e.clear=function(){this.D.clear()},e.X=function(){return this.D.X()},e.contains=function(a){return this.D.va(Kc(a))},e.H=function(){return this.D.H()},e.clone=function(){return new Jc(this)};var Nc=10;e=Mc.prototype,e.ld=function(a){this.v||-1==a.indexOf('spdy')&&-1==a.indexOf('quic')&&-1==a.indexOf('h2')||(this.Xb=this.me,this.v=new Jc,this.f&&(this.oc(this.f),this.f=null))},e.ee=function(){return!!this.f||!!this.v&&this.v.C()>=this.Xb},e.xf=function(){return this.f?1:this.v?this.v.C():0},e.Jc=function(a){return this.f?this.f==a:!!this.v&&this.v.contains(a)},e.oc=function(a){this.v?this.v.add(a):this.f=a},e.ze=function(a){this.f&&this.f==a?this.f=null:this.v&&this.v.contains(a)&&this.v.remove(a)},e.cancel=function(){this.ba=this.la(),this.f?(this.f.cancel(),this.f=null):this.v&&!this.v.X()&&(na(this.v.H(),function(a){a.cancel()}),this.v.clear())},e.la=function(){if(null!=this.f)return this.ba.concat(this.f.la());if(null!=this.v&&!this.v.X()){var a=this.ba;return na(this.v.H(),function(b){a=a.concat(b.la())}),a}return ua(this.ba)},e.Re=function(a){this.ba=this.ba.concat(a)},e.$e=function(){this.ba.length=0},Oc.prototype.stringify=function(a){return h.JSON.stringify(a,this.rg)},Oc.prototype.parse=function(a){return h.JSON.parse(a,this.xg)},Pc.prototype.hf=function(a,b,c){var d=c||'';try{oc(a,function(a,c){var f=a;r(a)&&(f=ub(a)),b.push(d+c+'='+encodeURIComponent(f))})}catch(f){throw b.push(d+'type='+encodeURIComponent('_badmap')),f}},Pc.prototype.jf=function(a,b,c){for(var d=-1,f;;){f=['count='+b],-1==d?0<b?(d=a[0].Pc,f.push('ofs='+d)):d=0:f.push('ofs='+d);for(var g=!0,k=0;k<b;k++){var p=a[k].Pc,Ub=a[k].map;if(p-=d,0>p)d=_Mathmax2(0,a[k].Pc-100),g=!1;else try{this.hf(Ub,f,'req'+p+'_')}catch(md){c&&c(Ub)}}if(g)return f.join('&')}},Pc.prototype.zc=function(a){return this.jg.parse(a)};var Sc=h.JSON.parse;x(V,H);var Tc='';V.prototype.s=Vb('goog.net.XhrIo');var Uc=/^https?$/i,Vc=['POST','PUT'];e=V.prototype,e.Je=function(a){this.Ab=a},e.send=function(a,b,c,d){if(this.c)throw Error('[goog.net.XhrIo] Object is active with another request='+this.Tb+'; newUri='+a);b=b?b.toUpperCase():'GET',this.Tb=a,this.I='',this.Pa=0,this.ge=b,this.Ec=!1,this.ha=!0,this.c=this.df(),this.mc=this.Xa?this.Xa.Vd():hc.Vd(),this.c.onreadystatechange=u(this.te,this),this.lg&&'onprogress'in this.c&&(this.c.onprogress=u(function(a){this.re(a,!0)},this),this.c.upload&&(this.c.upload.onprogress=u(this.re,this)));try{L(this.s,this.da('Opening Xhr')),this.Lc=!0,this.c.open(b,a+'',!0),this.Lc=!1}catch(g){return L(this.s,this.da('Error opening Xhr: '+g.message)),void this.Ld(g)}a=c||'';var f=this.headers.clone();d&&oc(d,function(a,b){f.set(b,a)}),d=pa(f.W()),c=h.FormData&&a instanceof h.FormData,!(0<=la(Vc,b))||d||c||f.set('Content-Type','application/x-www-form-urlencoded;charset=utf-8'),f.forEach(function(a,b){this.c.setRequestHeader(b,a)},this),this.Ae&&(this.c.responseType=this.Ae),'withCredentials'in this.c&&this.c.withCredentials!==this.Ab&&(this.c.withCredentials=this.Ab);try{this.yd(),0<this.vb&&(this.jc=Wc(this.c),L(this.s,this.da('Will abort after '+this.vb+'ms if incomplete, xhr2 '+this.jc)),this.jc?(this.c.timeout=this.vb,this.c.ontimeout=u(this.Ua,this)):this.hc=Hb(this.Ua,this.vb,this)),L(this.s,this.da('Sending request')),this.Qb=!0,this.c.send(a),this.Qb=!1}catch(g){L(this.s,this.da('Send error: '+g.message)),this.Ld(g)}},e.df=function(){return this.Xa?this.Xa.Dd():hc.Dd()},e.Ua=function(){'undefined'!=typeof goog&&this.c&&(this.I='Timed out after '+this.vb+'ms, aborting',this.Pa=8,L(this.s,this.da(this.I)),this.dispatchEvent('timeout'),this.abort(8))},e.Ld=function(a){this.ha=!1,this.c&&(this.Aa=!0,this.c.abort(),this.Aa=!1),this.I=a,this.Pa=5,this.Jd(),this.Gb()},e.Jd=function(){this.Ec||(this.Ec=!0,this.dispatchEvent('complete'),this.dispatchEvent('error'))},e.abort=function(a){this.c&&this.ha&&(L(this.s,this.da('Aborting')),this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1,this.Pa=a||7,this.dispatchEvent('complete'),this.dispatchEvent('abort'),this.Gb())},e.F=function(){this.c&&(this.ha&&(this.ha=!1,this.Aa=!0,this.c.abort(),this.Aa=!1),this.Gb(!0)),V.L.F.call(this)},e.te=function(){this.Ka||(this.Lc||this.Qb||this.Aa?this.se():this.eg())},e.eg=function(){this.se()},e.se=function(){if(this.ha&&'undefined'!=typeof goog)if(this.mc[1]&&4==this.ma()&&2==this.za())L(this.s,this.da('Local request error detected and ignored'));else if(this.Qb&&4==this.ma())Hb(this.te,0,this);else if(this.dispatchEvent('readystatechange'),this.Mc()){L(this.s,this.da('Request complete')),this.ha=!1;try{this.Rf()?(this.dispatchEvent('complete'),this.dispatchEvent('success')):(this.Pa=6,this.I=this.Yd()+' ['+this.za()+']',this.Jd())}finally{this.Gb()}}},e.re=function(a,b){this.dispatchEvent(Xc(a,'progress')),this.dispatchEvent(Xc(a,b?'downloadprogress':'uploadprogress'))},e.Gb=function(a){if(this.c){this.yd();var b=this.c,c=this.mc[0]?aa:null;this.mc=this.c=null,a||this.dispatchEvent('ready');try{b.onreadystatechange=c}catch(d){(a=this.s)&&a.ca('Problem encountered resetting onreadystatechange: '+d.message,void 0)}}},e.yd=function(){this.c&&this.jc&&(this.c.ontimeout=null),this.hc&&(h.clearTimeout(this.hc),this.hc=null)},e.Ba=function(){return!!this.c},e.Mc=function(){return 4==this.ma()},e.Rf=function(){var a=this.za();a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1;}return b||0===a&&!this.Of()},e.Of=function(){var a=(this.Tb+'').match(pc)[1]||null;return!a&&h.self&&h.self.location&&(a=h.self.location.protocol,a=a.substr(0,a.length-1)),Uc.test(a?a.toLowerCase():'')},e.ma=function(){return this.c?this.c.readyState:0},e.za=function(){try{return 2<this.ma()?this.c.status:-1}catch(a){return-1}},e.Yd=function(){try{return 2<this.ma()?this.c.statusText:''}catch(a){return L(this.s,'Can not get status: '+a.message),''}},e.ya=function(){try{return this.c?this.c.responseText:''}catch(a){return L(this.s,'Can not get responseText: '+a.message),''}},e.yf=function(a){if(this.c){var b=this.c.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),Sc(b)}},e.getResponseHeader=function(a){if(this.c&&this.Mc())return a=this.c.getResponseHeader(a),null===a?void 0:a},e.getAllResponseHeaders=function(){return this.c&&this.Mc()?this.c.getAllResponseHeaders()||'':''},e.kb=function(a){return this.c?this.c.getResponseHeader(a):null},e.Ud=function(){return this.Pa},e.Hc=function(){return l(this.I)?this.I:this.I+''},e.da=function(a){return a+' ['+this.ge+' '+this.Tb+' '+this.za()+']'},e=$c.prototype,e.tc=8,e.g=1,e.connect=function(a,b,c,d,f){this.a.debug('connect()'),O(0),this.K=b,this.gb=c||{},d&&void 0!==f&&(this.gb.OSID=d,this.gb.OAID=f),this.ta&&(this.a.debug('connect() bypassed channel-test.'),this.Ib.$d=[],this.Ib.od=!1),this.bf(a)},e.disconnect=function(){if(this.a.debug('disconnect()'),this.qd(),3==this.g){var a=this.Yb++,b=this.hb.clone();b.l('SID',this.ra),b.l('RID',a),b.l('TYPE','terminate'),this.Ya(b),new R(this,this.a,this.ra,a,void 0).yg(b)}this.qe()},e.bf=function(a){this.a.debug('connectTest_()'),this.Ja=new Hc(this,this.a),null===this.N&&this.Ja.ga(this.A);var b=a;this.N&&this.A&&(b=Zc(a,this.N,this.A)),this.Ja.connect(b)},e.af=function(){this.a.debug('connectChannel_()'),this.hb=this.Sd(this.K),this.Dc()},e.qd=function(){this.Ja&&(this.Ja.abort(),this.Ja=null),this.u&&(this.u.cancel(),this.u=null),this.ia&&(h.clearTimeout(this.ia),this.ia=null),this.Hb(),this.G.cancel(),this.ea&&(h.clearTimeout(this.ea),this.ea=null)},e.ga=function(a){this.A=a},e.Eg=function(a){this.Rb=a},e.Cg=function(a){this.N=a},e.Dg=function(a){this.aa=a},e.Fe=function(a){this.Kc=a},e.He=function(a){this.Ra=a},e.Hg=function(){this.gc=!0},e.Ee=function(a){this.i=a},e.Nf=function(){return!this.fd},e.Zc=function(a){1E3==this.M.length&&this.a.ca(function(){return'Already have 1000 queued maps upon queueing '+ub(a)}),this.M.push(new Lc(this.ag++,a)),3==this.g&&this.Dc()},e.qf=function(){return this.kf?0:this.nf},e.de=function(){return 0==this.g},e.getState=function(){return this.g},e.Dc=function(){this.G.ee()||this.ea||(this.ea=P(u(this.we,this),0),this.La=0)},e.Yf=function(a){return this.G.xf()>=this.G.Xb-(this.ea?1:0)?(this.a.ca('Unexpected retry request is scheduled.'),!1):this.ea?(this.a.debug('Use the retry request that is already scheduled.'),this.M=a.la().concat(this.M),!0):1==this.g||2==this.g||this.La>=this.qf()?!1:(this.a.debug('Going to retry POST'),this.ea=P(u(this.we,this,a),this.Xd(this.La)),this.La++,!0)},e.we=function(a){this.ea=null,this.Mg(a)},e.Mg=function(a){this.a.debug('startForwardChannel_'),1==this.g?a?this.a.ca('Not supposed to retry the open'):(this.ig(),this.g=2):3==this.g&&(a?this.le(a):0==this.M.length?this.a.debug('startForwardChannel_ returned: nothing to send'):this.G.ee()?this.a.ca('startForwardChannel_ returned: connection already in progress'):(this.le(),this.a.debug('startForwardChannel_ finished, sent request')))},e.ig=function(){this.a.debug('open_()'),this.Yb=_Mathfloor2(1E5*Math.random());var a=this.Yb++,b=new R(this,this.a,'',a,void 0),c=this.A;this.Rb&&(c?(c=Da(c),Fa(c,this.Rb)):c=this.Rb),null===this.N&&b.ga(c);var d=this.Hd(b),f=this.hb.clone();f.l('RID',a),0<this.Bd&&f.l('CVER',this.Bd),this.ta&&this.aa&&f.l('X-HTTP-Session-Id',this.aa),this.Ya(f),this.N&&c&&Zc(f,this.N,c),this.G.oc(b),this.Nd?(f.l('$req',d),f.l('SID','null'),b.Ag(),b.kd(f,null)):b.kd(f,d)},e.le=function(a){var b=a?a.R:this.Yb++,c=this.hb.clone();c.l('SID',this.ra),c.l('RID',b),c.l('AID',this.Sb),this.Ya(c),this.N&&this.A&&Zc(c,this.N,this.A),b=new R(this,this.a,this.ra,b,this.La+1),null===this.N&&b.ga(this.A),a&&this.sg(a),a=this.Hd(b),b.setTimeout(_Mathround(.5*this.Od)+_Mathround(.5*this.Od*Math.random())),this.G.oc(b),b.kd(c,a)},e.Ya=function(a){this.i&&oc({},function(b,c){a.l(c,b)})},e.Hd=function(a){var b=Math.min(this.M.length,1E3),c=this.i?u(this.i.Ue,this.i,this):null;return c=this.kc.jf(this.M,b,c),a.Gg(this.M.splice(0,b)),c},e.sg=function(a){this.M=a.la().concat(this.M)},e.Kd=function(){if(!this.u&&!this.ia){this.rc=1;var a=this.ve;Bb||Cb(),Eb||(Bb(),Eb=!0),Fb.add(a,this),this.Ha=0}},e.Qc=function(){return this.u||this.ia?(this.a.ca('Request already in progress'),!1):!(3<=this.Ha)&&(this.a.debug('Going to retry GET'),this.rc++,this.ia=P(u(this.ve,this),this.Xd(this.Ha)),this.Ha++,!0)},e.ve=function(){this.ia=null,this.Kg()},e.Kg=function(){this.a.debug('Creating new HttpRequest'),this.u=new R(this,this.a,this.ra,'rpc',this.rc),null===this.N&&this.u.ga(this.A),this.u.He(this.Ra);var a=this.md.clone();a.l('RID','rpc'),a.l('SID',this.ra),a.l('CI',this.fd?'0':'1'),a.l('AID',this.Sb),this.Ya(a),a.l('TYPE','xmlhttp'),this.N&&this.A&&Zc(a,this.N,this.A),this.Db&&this.u.setTimeout(this.Db),this.u.jd(a,!0,this.na),this.a.debug('New Request created')},e.ub=function(a,b){this.a.debug('Test Connection Finished');var c=a.Ad;c&&this.G.ld(c),this.fd=this.Se&&b,this.w=a.w,this.af()},e.dd=function(a){this.a.debug('Test Connection Failed'),this.w=a.w,this.sa(2)},e.ue=function(a,b){if(0!=this.g&&(this.u==a||this.G.Jc(a)))if(this.w=a.w,!a.lb&&this.G.Jc(a)&&3==this.g){try{var c=this.kc.zc(b)}catch(d){c=null}n(c)&&3==c.length?this.Cf(c,a):(this.a.debug('Bad POST response data returned'),this.sa(11))}else(a.lb||this.u==a)&&this.Hb(),va(b)||(c=this.kc.zc(b),this.dg(c,a))},e.Cf=function(a,b){0==a[0]?this.Bf(b):(this.he=a[1],b=this.he-this.Sb,0<b&&(a=a[2],this.a.debug(a+' bytes (in '+b+' arrays) are outstanding on the BackChannel'),this.Jg(a)&&!this.wa&&(this.wa=P(u(this.bg,this),6E3))))},e.Bf=function(a){if(this.a.debug('Server claims our backchannel is missing.'),this.ia)this.a.debug('But we are currently starting the request.');else{if(!this.u)this.a.T('We do not have a BackChannel established');else if(this.u.qb+3E3<a.qb)this.Hb(),this.u.cancel(),this.u=null;else return;this.Qc(),O(18)}},e.Jg=function(a){return 37500>a&&!this.Nf()&&0==this.Ha},e.$a=function(a){return this.Te?this.i?this.i.$a(a):a:null},e.bg=function(){null!=this.wa&&(this.wa=null,this.u.cancel(),this.u=null,this.Qc(),O(19))},e.Hb=function(){null!=this.wa&&(h.clearTimeout(this.wa),this.wa=null)},e.Tc=function(a){this.a.debug('Request complete');var b=null;if(this.u==a){this.Hb(),this.u=null;var c=2}else if(this.G.Jc(a))b=a.la(),this.G.ze(a),c=1;else return;if(this.w=a.w,0!=this.g)if(a.S)1==c?(ac(a.Da?a.Da.length:0,w()-a.qb,this.La),this.Dc()):this.Kd();else{var d=a.Hc();if(3==d||0==d&&0<this.w)this.a.debug('Not retrying due to error type');else{var f=this;if(this.a.debug(function(){return'Maybe retrying, last error: '+kc(d,f.w)}),1==c&&this.Yf(a)||2==c&&this.Qc())return;this.a.debug('Exceeded max number of retries')}b&&0<b.length&&this.G.Re(b),this.a.debug('Error: HTTP request failed'),1===d?this.sa(5):4===d?this.sa(10):3===d?this.sa(6):this.sa(2)}},e.Xd=function(a){var b=this.Ve+_Mathfloor2(Math.random()*this.vg);return this.Ba()||(this.a.debug('Inactive channel'),b*=2),b*a},e.pc=function(a){if(this.ta&&(a=a.h)){var b=a.kb('X-Client-Wire-Protocol');b&&this.G.ld(b),this.aa&&((a=a.kb('X-HTTP-Session-Id'))?(this.Fe(a),this.hb.l(this.aa,a)):this.a.T('Missing X_HTTP_SESSION_ID in the handshake response'))}},e.dg=function(a,b){for(var c=this.i&&this.i.sc?[]:null,d=0,f;d<a.length;d++)if(f=a[d],this.Sb=f[0],f=f[1],2!=this.g)3==this.g&&('stop'==f[0]||'close'==f[0]?(c&&0!=c.length&&(this.i.sc(this,c),c.length=0),'stop'==f[0]?this.sa(7):this.disconnect()):'noop'!=f[0]&&(c?c.push(f):this.i&&this.i.ud(f)),this.Ha=0);else if('c'==f[0]){this.ra=f[1],this.na=this.$a(f[2]);var g=f[3];null!=g&&(this.tc=g,this.a.info('VER='+this.tc)),g=f[4],null!=g&&(this.De=g,this.a.info('SVER='+this.De)),f=f[5],null!=f&&'number'==typeof f&&0<f&&(this.Db=f*=1.5,this.a.info('backChannelRequestTimeoutMs_='+f)),this.pc(b),this.g=3,this.i&&this.i.wd(),this.Lg(b)}else'stop'!=f[0]&&'close'!=f[0]||this.sa(7);c&&0!=c.length&&this.i.sc(this,c)},e.Lg=function(a){this.md=this.Pd(this.na,this.K),a.lb?(this.a.debug('Upgrade the handshake request to a backchannel.'),this.G.ze(a),a.tg(this.Db),this.u=a):this.Kd()},e.sa=function(a){if(this.a.info('Error code '+a),2==a){var b=null;this.i&&(b=null);var c=u(this.Pg,this);b||(b=new U('//www.google.com/images/cleardot.gif'),h.location&&'http'==h.location.protocol||b.tb('https'),b.Ub()),Qc(b.toString(),c)}else O(2);this.cg(a)},e.Pg=function(a){a?(this.a.info('Successfully pinged google.com'),O(2)):(this.a.info('Failed to ping google.com'),O(1))},e.cg=function(a){this.a.debug('HttpChannel: error - '+a),this.g=0,this.i&&this.i.td(a),this.qe(),this.qd()},e.qe=function(){if(this.g=0,this.w=-1,this.i){var a=this.G.la();if(0!=a.length||0!=this.M.length){var b=this;this.a.debug(function(){return'Number of undelivered maps, pending: '+a.length+', outgoing: '+b.M.length}),this.G.$e(),ua(this.M),this.M.length=0}this.i.sd()}},e.Sd=function(a){return a=this.Cd(null,a),this.a.debug('GetForwardChannelUri: '+a),a},e.Pd=function(a,b){return a=this.Cd(this.fc()?a:null,b),this.a.debug('GetBackChannelUri: '+a),a},e.Cd=function(a,b){var c=Ac(b);if(''!=c.xa)a&&c.rb(a+'.'+c.xa),c.sb(c.Ca);else{var d=h.location;c=Bc(d.protocol,a?a+'.'+d.hostname:d.hostname,+d.port,b)}return this.gb&&Aa(this.gb,function(a,b){c.l(b,a)}),a=this.aa,b=this.Kc,a&&b&&c.l(a,b),c.l('VER',this.tc),this.Ya(c),c},e.Jb=function(a){if(a&&!this.gc)throw Error('Can\'t create secondary domain capable XhrIo object.');return a=new V(this.Xa),a.Je(this.gc),a},e.Ba=function(){return!!this.i&&this.i.Ba()},e.fc=function(){return this.gc},e=ad.prototype,e.sc=null,e.wd=function(){},e.ud=function(){},e.td=function(){},e.sd=function(){},e.Ba=function(){return!0},e.Ue=function(){},e.$a=function(a){return a},cd.prototype.cf=function(a,b){return new W(a,b)},x(W,H),e=W.prototype,e.addEventListener=function(a,b,c,d){W.L.addEventListener.call(this,a,b,c,d)},e.removeEventListener=function(a,b,c,d){W.L.removeEventListener.call(this,a,b,c,d)},e.open=function(){this.b.Ee(this.vd),this.Og&&this.b.Hg(),this.b.connect(this.Qg,this.yb,this.Rc||void 0)},e.close=function(){this.b.disconnect()},e.send=function(a){if(l(a)){var b={};b.__data__=a,this.b.Zc(b)}else this.zg?(b={},b.__data__=ub(a),this.b.Zc(b)):this.b.Zc(a)},e.F=function(){this.b.Ee(null),delete this.vd,this.b.disconnect(),delete this.b,W.L.F.call(this)},x(dd,fc),x(ed,gc),x(X,ad),X.prototype.wd=function(){Wb(this.b.s,'WebChannel opened on '+this.b.yb),this.b.dispatchEvent('a')},X.prototype.ud=function(a){this.b.dispatchEvent(new dd(a))},X.prototype.td=function(a){Wb(this.b.s,'WebChannel aborted on '+this.b.yb+' due to channel error: '+a),this.b.dispatchEvent(new ed(a))},X.prototype.sd=function(){Wb(this.b.s,'WebChannel closed on '+this.b.yb),this.b.dispatchEvent('b')};var fd=v(function(a){function c(){}c.prototype=a.prototype;var d=new c;return a.apply(d,Array.prototype.slice.call(arguments,1)),d},cd);e=gd.prototype,e.Vf=function(){0==this.V.length&&(this.V=this.Z,this.V.reverse(),this.Z=[])},e.enqueue=function(a){this.Z.push(a)},e.ab=function(){return this.Vf(),this.V.pop()},e.C=function(){return this.V.length+this.Z.length},e.X=function(){return 0==this.V.length&&0==this.Z.length},e.clear=function(){this.V=[],this.Z=[]},e.contains=function(a){return 0<=la(this.V,a)||0<=la(this.Z,a)},e.remove=function(a){var b=this.V,c=ma(b,a);return 0<=c?(Array.prototype.splice.call(b,c,1),b=!0):b=!1,b||sa(this.Z,a)},e.H=function(){for(var a=[],b=this.V.length-1;0<=b;--b)a.push(this.V[b]);var c=this.Z.length;for(b=0;b<c;++b)a.push(this.Z[b]);return a},x(hd,z);var id='[goog.structs.Pool] Min can not be greater than max';e=hd.prototype,e.Mb=function(){var a=w();if(!(null!=this.Nc&&a-this.Nc<this.Ac)){var b=this.qg();return b&&(this.Nc=a,this.oa.add(b)),b}},e.og=function(a){return!!this.oa.remove(a)&&(this.nc(a),!0)},e.qg=function(){for(var a;0<this.Td()&&(a=this.fa.ab(),!this.Sc(a));)this.Cb();return!a&&this.C()<this.Wb&&(a=this.xc()),a},e.nc=function(a){this.oa.remove(a),this.Sc(a)&&this.C()<this.Wb?this.fa.enqueue(a):this.Bc(a)},e.Cb=function(){for(var a=this.fa;this.C()<this.oe;)a.enqueue(this.xc());for(;this.C()>this.Wb&&0<this.Td();)this.Bc(a.ab())},e.xc=function(){return{}},e.Bc=function(a){if('function'==typeof a.bb)a.bb();else for(var b in a)a[b]=null},e.Sc=function(a){return'function'!=typeof a.Ye||a.Ye()},e.contains=function(a){return this.fa.contains(a)||this.oa.contains(a)},e.C=function(){return this.fa.C()+this.oa.C()},e.rf=function(){return this.oa.C()},e.Td=function(){return this.fa.C()},e.X=function(){return this.fa.X()&&this.oa.X()},e.F=function(){if(hd.L.F.call(this),0<this.rf())throw Error('[goog.structs.Pool] Objects not released');delete this.oa;for(var a=this.fa;!a.X();)this.Bc(a.ab());delete this.fa},jd.prototype.getKey=function(){return this.fe},jd.prototype.clone=function(){return new jd(this.fe,this.gd)},e=kd.prototype,e.ce=function(a,b){var c=this.Y;c.push(new jd(a,b)),this.$f(c.length-1)},e.Lf=function(a){if(a instanceof kd){var b=a.W();if(a=a.H(),0>=this.C()){for(var c=this.Y,d=0;d<b.length;d++)c.push(new jd(b[d],a[d]));return}}else b=Ca(a),a=Ba(a);for(d=0;d<b.length;d++)this.ce(b[d],a[d])},e.remove=function(){var a=this.Y,b=a.length,c=a[0];if(!(0>=b))return 1==b?ra(a):(a[0]=a.pop(),this.Zf()),c.gd},e.Zf=function(){for(var a=0,b=this.Y,c=b.length,d=b[a];a<c>>1;){var f=this.tf(a),g=this.zf(a);if(f=g<c&&b[g].getKey()<b[f].getKey()?g:f,b[f].getKey()>d.getKey())break;b[a]=b[f],a=f}b[a]=d},e.$f=function(a){for(var b=this.Y,c=b[a],d;0<a&&(d=this.wf(a),b[d].getKey()>c.getKey());)b[a]=b[d],a=d;b[a]=c},e.tf=function(a){return 2*a+1},e.zf=function(a){return 2*a+2},e.wf=function(a){return a-1>>1},e.H=function(){for(var a=this.Y,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].gd);return b},e.W=function(){for(var a=this.Y,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].getKey());return b},e.va=function(a){return oa(this.Y,function(b){return b.getKey()==a})},e.clone=function(){return new kd(this)},e.C=function(){return this.Y.length},e.X=function(){return 0==this.Y.length},e.clear=function(){ra(this.Y)},x(ld,kd),ld.prototype.enqueue=function(a,b){this.ce(a,b)},ld.prototype.ab=function(){return this.remove()},x(Y,hd),e=Y.prototype,e.Mb=function(a,b){return a?void(this.cc.enqueue(void 0===b?100:b,a),this.Nb()):((a=Y.L.Mb.call(this))&&this.Ac&&(this.Gd=h.setTimeout(u(this.Nb,this),this.Ac)),a)},e.Nb=function(){for(var a=this.cc,b;0<a.C()&&(b=this.Mb(),b);)a.ab().apply(this,[b])},e.nc=function(a){Y.L.nc.call(this,a),this.Nb()},e.Cb=function(){Y.L.Cb.call(this),this.Nb()},e.F=function(){Y.L.F.call(this),h.clearTimeout(this.Gd),this.cc.clear(),this.cc=null},x(Z,Y),Z.prototype.xc=function(){var a=new V,b=this.Jf;return b&&b.forEach(function(b,d){a.headers.set(d,b)}),this.Ab&&a.Je(!0),a},Z.prototype.Sc=function(a){return!a.Ka&&!a.Ba()},cd.prototype.createWebChannel=cd.prototype.cf,W.prototype.send=W.prototype.send,W.prototype.open=W.prototype.open,W.prototype.close=W.prototype.close,bc.NO_ERROR=0,bc.TIMEOUT=8,bc.HTTP_ERROR=6,cc.COMPLETE='complete',ec.EventType=Q,Q.OPEN='a',Q.CLOSE='b',Q.ERROR='c',Q.MESSAGE='d',H.prototype.listen=H.prototype.nb,Z.prototype.getObject=Z.prototype.Mb,Z.prototype.releaseObject=Z.prototype.og,V.prototype.listenOnce=V.prototype.Oc,V.prototype.getLastError=V.prototype.Hc,V.prototype.getLastErrorCode=V.prototype.Ud,V.prototype.getStatus=V.prototype.za,V.prototype.getStatusText=V.prototype.Yd,V.prototype.getResponseJson=V.prototype.yf,V.prototype.getResponseText=V.prototype.ya,V.prototype.getResponseText=V.prototype.ya,V.prototype.send=V.prototype.send;var src={createWebChannelTransport:fd,ErrorCode:bc,EventType:cc,WebChannel:ec,XhrIoPool:Z},src_1=src.createWebChannelTransport,src_2=src.ErrorCode,src_3=src.EventType,src_4=src.WebChannel,src_5=src.XhrIoPool;__webpack_exports__['default']=src}).call(__webpack_exports__,__webpack_require__(0))},function(module,exports,__webpack_require__){function BindToEventDecorator(_event,_target,_listenIn,_removeIn){return function(propertyName,func){const scope=this,event=_event||propertyName,target=_target?document.querySelector(_target):this.el;if(!target)return void console.warn('Couldn\'t subscribe '+this.name+'.'+propertyName+' to '+event+' on '+_target+' because querySelector returned undefined.');const listenIn=_listenIn||'init',removeIn=_removeIn||'remove',listenFunc=this[listenIn],removeFunc=this[removeIn],boundFunc=func.bind(this);return this[listenIn]=function(){void 0!==listenFunc&&listenFunc.apply(scope,arguments),target.addEventListener(event,boundFunc)},this[removeIn]=function(){void 0!==removeFunc&&removeFunc.apply(scope,arguments),target.removeEventListener(event,boundFunc)},func}}const decorate=__webpack_require__(14).decorate;module.exports.bindEvent=function bindEvent(p1,p2){if('function'==typeof p1)return decorate(p1,BindToEventDecorator());if('object'==typeof p1&&'function'==typeof p2)return decorate(p2,BindToEventDecorator(p1.event,p1.target,p1.listenIn,p1.removeIn));throw new Error('bindEvent must take: (function), or a ([object], function)')},module.exports.bindEventPlayPause=function bindEventPlayPause(p1,p2){if('function'==typeof p1)return decorate(p1,BindToEventDecorator(void 0,void 0,'play','pause'));if('object'==typeof p1&&'function'==typeof p2)return decorate(p2,BindToEventDecorator(p1.event,p1.target,'play','pause'));throw new Error('bindEventPlayPause must take: (function), or a ([object], function)')}},function(){THREE.BufferGeometryUtils={computeTangents:function(geometry){function handleTriangle(a,b,c){vA.fromArray(positions,3*a),vB.fromArray(positions,3*b),vC.fromArray(positions,3*c),uvA.fromArray(uvs,2*a),uvB.fromArray(uvs,2*b),uvC.fromArray(uvs,2*c);var x1=vB.x-vA.x,x2=vC.x-vA.x,y1=vB.y-vA.y,y2=vC.y-vA.y,z1=vB.z-vA.z,z2=vC.z-vA.z,s1=uvB.x-uvA.x,s2=uvC.x-uvA.x,t1=uvB.y-uvA.y,t2=uvC.y-uvA.y,r=1/(s1*t2-s2*t1);sdir.set((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r),tdir.set((s1*x2-s2*x1)*r,(s1*y2-s2*y1)*r,(s1*z2-s2*z1)*r),tan1[a].add(sdir),tan1[b].add(sdir),tan1[c].add(sdir),tan2[a].add(tdir),tan2[b].add(tdir),tan2[c].add(tdir)}function handleVertex(v){n.fromArray(normals,3*v),n2.copy(n),t=tan1[v],tmp.copy(t),tmp.sub(n.multiplyScalar(n.dot(t))).normalize(),tmp2.crossVectors(n2,t),test=tmp2.dot(tan2[v]),w=0>test?-1:1,tangents[4*v]=tmp.x,tangents[4*v+1]=tmp.y,tangents[4*v+2]=tmp.z,tangents[4*v+3]=w}var index=geometry.index,attributes=geometry.attributes;if(null===index||void 0===attributes.position||void 0===attributes.normal||void 0===attributes.uv)return void console.warn('THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()');var indices=index.array,positions=attributes.position.array,normals=attributes.normal.array,uvs=attributes.uv.array,nVertices=positions.length/3;attributes.tangent===void 0&&geometry.addAttribute('tangent',new THREE.BufferAttribute(new Float32Array(4*nVertices),4));for(var tangents=attributes.tangent.array,tan1=[],tan2=[],i=0;i<nVertices;i++)tan1[i]=new THREE.Vector3,tan2[i]=new THREE.Vector3;var vA=new THREE.Vector3,vB=new THREE.Vector3,vC=new THREE.Vector3,uvA=new THREE.Vector2,uvB=new THREE.Vector2,uvC=new THREE.Vector2,sdir=new THREE.Vector3,tdir=new THREE.Vector3,groups=geometry.groups;0===groups.length&&(groups=[{start:0,count:indices.length}]);for(var i=0,il=groups.length;i<il;++i)for(var group=groups[i],start=group.start,count=group.count,j=start,jl=start+count;j<jl;j+=3)handleTriangle(indices[j+0],indices[j+1],indices[j+2]);for(var tmp=new THREE.Vector3,tmp2=new THREE.Vector3,n=new THREE.Vector3,n2=new THREE.Vector3,i=0,il=groups.length,w,t,test;i<il;++i)for(var group=groups[i],start=group.start,count=group.count,j=start,jl=start+count;j<jl;j+=3)handleVertex(indices[j+0]),handleVertex(indices[j+1]),handleVertex(indices[j+2])},mergeBufferGeometries:function(geometries,useGroups){for(var isIndexed=null!==geometries[0].index,attributesUsed=new Set(Object.keys(geometries[0].attributes)),morphAttributesUsed=new Set(Object.keys(geometries[0].morphAttributes)),attributes={},morphAttributes={},mergedGeometry=new THREE.BufferGeometry,offset=0,i=0,geometry;i<geometries.length;++i){if(geometry=geometries[i],isIndexed!=(null!==geometry.index))return null;for(var name in geometry.attributes){if(!attributesUsed.has(name))return null;void 0===attributes[name]&&(attributes[name]=[]),attributes[name].push(geometry.attributes[name])}for(var name in geometry.morphAttributes){if(!morphAttributesUsed.has(name))return null;void 0===morphAttributes[name]&&(morphAttributes[name]=[]),morphAttributes[name].push(geometry.morphAttributes[name])}if(mergedGeometry.userData&&(mergedGeometry.userData.mergedUserData=mergedGeometry.userData.mergedUserData||[],mergedGeometry.userData.mergedUserData.push(geometry.userData)),useGroups){var count;if(isIndexed)count=geometry.index.count;else if(void 0!==geometry.attributes.position)count=geometry.attributes.position.count;else return null;mergedGeometry.addGroup(offset,count,i),offset+=count}}if(isIndexed){for(var indexOffset=0,mergedIndex=[],i=0,index;i<geometries.length;++i){index=geometries[i].index;for(var j=0;j<index.count;++j)mergedIndex.push(index.getX(j)+indexOffset);indexOffset+=geometries[i].attributes.position.count}mergedGeometry.setIndex(mergedIndex)}for(var name in attributes){var mergedAttribute=this.mergeBufferAttributes(attributes[name]);if(!mergedAttribute)return null;mergedGeometry.addAttribute(name,mergedAttribute)}for(var name in morphAttributes){var numMorphTargets=morphAttributes[name][0].length;if(0===numMorphTargets)break;mergedGeometry.morphAttributes=mergedGeometry.morphAttributes||{},mergedGeometry.morphAttributes[name]=[];for(var i=0,morphAttributesToMerge;i<numMorphTargets;++i){morphAttributesToMerge=[];for(var j=0;j<morphAttributes[name].length;++j)morphAttributesToMerge.push(morphAttributes[name][j][i]);var mergedMorphAttribute=this.mergeBufferAttributes(morphAttributesToMerge);if(!mergedMorphAttribute)return null;mergedGeometry.morphAttributes[name].push(mergedMorphAttribute)}}return mergedGeometry},mergeBufferAttributes:function(attributes){for(var arrayLength=0,i=0,TypedArray,itemSize,normalized,attribute;i<attributes.length;++i){if(attribute=attributes[i],attribute.isInterleavedBufferAttribute)return null;if(void 0==TypedArray&&(TypedArray=attribute.array.constructor),TypedArray!==attribute.array.constructor)return null;if(void 0==itemSize&&(itemSize=attribute.itemSize),itemSize!==attribute.itemSize)return null;if(void 0==normalized&&(normalized=attribute.normalized),normalized!==attribute.normalized)return null;arrayLength+=attribute.array.length}for(var array=new TypedArray(arrayLength),offset=0,i=0;i<attributes.length;++i)array.set(attributes[i].array,offset),offset+=attributes[i].array.length;return new THREE.BufferAttribute(array,itemSize,normalized)}}},function(){var _Mathmin3=Math.min,_Mathsqrt=Math.sqrt,_MathPI=Math.PI,_Mathmax3=Math.max;THREE.OrbitControls=function(object,domElement){function getAutoRotationAngle(){return 2*_MathPI/60/60*scope.autoRotateSpeed}function getZoomScale(){return Math.pow(0.95,scope.zoomSpeed)}function rotateLeft(angle){sphericalDelta.theta-=angle}function rotateUp(angle){sphericalDelta.phi-=angle}function dollyIn(dollyScale){scope.object.isPerspectiveCamera?scale/=dollyScale:scope.object.isOrthographicCamera?(scope.object.zoom=_Mathmax3(scope.minZoom,_Mathmin3(scope.maxZoom,scope.object.zoom*dollyScale)),scope.object.updateProjectionMatrix(),zoomChanged=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),scope.enableZoom=!1)}function dollyOut(dollyScale){scope.object.isPerspectiveCamera?scale*=dollyScale:scope.object.isOrthographicCamera?(scope.object.zoom=_Mathmax3(scope.minZoom,_Mathmin3(scope.maxZoom,scope.object.zoom/dollyScale)),scope.object.updateProjectionMatrix(),zoomChanged=!0):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'),scope.enableZoom=!1)}function handleMouseDownRotate(event){rotateStart.set(event.clientX,event.clientY)}function handleMouseDownDolly(event){dollyStart.set(event.clientX,event.clientY)}function handleMouseDownPan(event){panStart.set(event.clientX,event.clientY)}function handleMouseMoveRotate(event){rotateEnd.set(event.clientX,event.clientY),rotateDelta.subVectors(rotateEnd,rotateStart);var element=scope.domElement===document?scope.domElement.body:scope.domElement;rotateLeft(2*_MathPI*rotateDelta.x/element.clientWidth*scope.rotateSpeed),rotateUp(2*_MathPI*rotateDelta.y/element.clientHeight*scope.rotateSpeed),rotateStart.copy(rotateEnd),scope.update()}function handleMouseMoveDolly(event){dollyEnd.set(event.clientX,event.clientY),dollyDelta.subVectors(dollyEnd,dollyStart),0<dollyDelta.y?dollyIn(getZoomScale()):0>dollyDelta.y&&dollyOut(getZoomScale()),dollyStart.copy(dollyEnd),scope.update()}function handleMouseMovePan(event){panEnd.set(event.clientX,event.clientY),panDelta.subVectors(panEnd,panStart),pan(panDelta.x,panDelta.y),panStart.copy(panEnd),scope.update()}function handleMouseUp(){}function handleMouseWheel(event){0>event.deltaY?dollyOut(getZoomScale()):0<event.deltaY&&dollyIn(getZoomScale()),scope.update()}function handleKeyDown(event){switch(event.keyCode){case scope.keys.UP:pan(0,scope.keyPanSpeed),scope.update();break;case scope.keys.BOTTOM:pan(0,-scope.keyPanSpeed),scope.update();break;case scope.keys.LEFT:pan(scope.keyPanSpeed,0),scope.update();break;case scope.keys.RIGHT:pan(-scope.keyPanSpeed,0),scope.update();}}function handleTouchStartRotate(event){rotateStart.set(event.touches[0].pageX,event.touches[0].pageY)}function handleTouchStartDolly(event){var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY,distance=_Mathsqrt(dx*dx+dy*dy);dollyStart.set(0,distance)}function handleTouchStartPan(event){panStart.set(event.touches[0].pageX,event.touches[0].pageY)}function handleTouchMoveRotate(event){rotateEnd.set(event.touches[0].pageX,event.touches[0].pageY),rotateDelta.subVectors(rotateEnd,rotateStart);var element=scope.domElement===document?scope.domElement.body:scope.domElement;rotateLeft(2*_MathPI*rotateDelta.x/element.clientWidth*scope.rotateSpeed),rotateUp(2*_MathPI*rotateDelta.y/element.clientHeight*scope.rotateSpeed),rotateStart.copy(rotateEnd),scope.update()}function handleTouchMoveDolly(event){var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY,distance=_Mathsqrt(dx*dx+dy*dy);dollyEnd.set(0,distance),dollyDelta.subVectors(dollyEnd,dollyStart),0<dollyDelta.y?dollyOut(getZoomScale()):0>dollyDelta.y&&dollyIn(getZoomScale()),dollyStart.copy(dollyEnd),scope.update()}function handleTouchMovePan(event){panEnd.set(event.touches[0].pageX,event.touches[0].pageY),panDelta.subVectors(panEnd,panStart),pan(panDelta.x,panDelta.y),panStart.copy(panEnd),scope.update()}function handleTouchEnd(){}function onMouseDown(event){if(!1!==scope.enabled){switch(event.preventDefault(),event.button){case scope.mouseButtons.ORBIT:if(!1===scope.enableRotate)return;handleMouseDownRotate(event),state=STATE.ROTATE;break;case scope.mouseButtons.ZOOM:if(!1===scope.enableZoom)return;handleMouseDownDolly(event),state=STATE.DOLLY;break;case scope.mouseButtons.PAN:if(!1===scope.enablePan)return;handleMouseDownPan(event),state=STATE.PAN;}state!==STATE.NONE&&(document.addEventListener('mousemove',onMouseMove,!1),document.addEventListener('mouseup',onMouseUp,!1),scope.dispatchEvent(startEvent))}}function onMouseMove(event){if(!1!==scope.enabled)switch(event.preventDefault(),state){case STATE.ROTATE:if(!1===scope.enableRotate)return;handleMouseMoveRotate(event);break;case STATE.DOLLY:if(!1===scope.enableZoom)return;handleMouseMoveDolly(event);break;case STATE.PAN:if(!1===scope.enablePan)return;handleMouseMovePan(event);}}function onMouseUp(event){!1===scope.enabled||(handleMouseUp(event),document.removeEventListener('mousemove',onMouseMove,!1),document.removeEventListener('mouseup',onMouseUp,!1),scope.dispatchEvent(endEvent),state=STATE.NONE)}function onMouseWheel(event){!1===scope.enabled||!1===scope.enableZoom||state!==STATE.NONE&&state!==STATE.ROTATE||(event.preventDefault(),event.stopPropagation(),scope.dispatchEvent(startEvent),handleMouseWheel(event),scope.dispatchEvent(endEvent))}function onKeyDown(event){!1===scope.enabled||!1===scope.enableKeys||!1===scope.enablePan||handleKeyDown(event)}function onTouchStart(event){if(!1!==scope.enabled){switch(event.touches.length){case 1:if(!1===scope.enableRotate)return;handleTouchStartRotate(event),state=STATE.TOUCH_ROTATE;break;case 2:if(!1===scope.enableZoom)return;handleTouchStartDolly(event),state=STATE.TOUCH_DOLLY;break;case 3:if(!1===scope.enablePan)return;handleTouchStartPan(event),state=STATE.TOUCH_PAN;break;default:state=STATE.NONE;}state!==STATE.NONE&&scope.dispatchEvent(startEvent)}}function onTouchMove(event){if(!1!==scope.enabled)switch(event.preventDefault(),event.stopPropagation(),event.touches.length){case 1:if(!1===scope.enableRotate)return;if(state!==STATE.TOUCH_ROTATE)return;handleTouchMoveRotate(event);break;case 2:if(!1===scope.enableZoom)return;if(state!==STATE.TOUCH_DOLLY)return;handleTouchMoveDolly(event);break;case 3:if(!1===scope.enablePan)return;if(state!==STATE.TOUCH_PAN)return;handleTouchMovePan(event);break;default:state=STATE.NONE;}}function onTouchEnd(event){!1===scope.enabled||(handleTouchEnd(event),scope.dispatchEvent(endEvent),state=STATE.NONE)}function onContextMenu(event){!1===scope.enabled||event.preventDefault()}this.object=object,this.domElement=domElement===void 0?document:domElement,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=_MathPI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=0.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return spherical.phi},this.getAzimuthalAngle=function(){return spherical.theta},this.saveState=function(){scope.target0.copy(scope.target),scope.position0.copy(scope.object.position),scope.zoom0=scope.object.zoom},this.reset=function(){scope.target.copy(scope.target0),scope.object.position.copy(scope.position0),scope.object.zoom=scope.zoom0,scope.object.updateProjectionMatrix(),scope.dispatchEvent(changeEvent),scope.update(),state=STATE.NONE},this.update=function(){var offset=new THREE.Vector3,quat=new THREE.Quaternion().setFromUnitVectors(object.up,new THREE.Vector3(0,1,0)),quatInverse=quat.clone().inverse(),lastPosition=new THREE.Vector3,lastQuaternion=new THREE.Quaternion;return function update(){var position=scope.object.position;return offset.copy(position).sub(scope.target),offset.applyQuaternion(quat),spherical.setFromVector3(offset),scope.autoRotate&&state===STATE.NONE&&rotateLeft(getAutoRotationAngle()),spherical.theta+=sphericalDelta.theta,spherical.phi+=sphericalDelta.phi,spherical.theta=_Mathmax3(scope.minAzimuthAngle,_Mathmin3(scope.maxAzimuthAngle,spherical.theta)),spherical.phi=_Mathmax3(scope.minPolarAngle,_Mathmin3(scope.maxPolarAngle,spherical.phi)),spherical.makeSafe(),spherical.radius*=scale,spherical.radius=_Mathmax3(scope.minDistance,_Mathmin3(scope.maxDistance,spherical.radius)),scope.target.add(panOffset),offset.setFromSpherical(spherical),offset.applyQuaternion(quatInverse),position.copy(scope.target).add(offset),scope.object.lookAt(scope.target),!0===scope.enableDamping?(sphericalDelta.theta*=1-scope.dampingFactor,sphericalDelta.phi*=1-scope.dampingFactor):sphericalDelta.set(0,0,0),scale=1,panOffset.set(0,0,0),(zoomChanged||lastPosition.distanceToSquared(scope.object.position)>EPS||8*(1-lastQuaternion.dot(scope.object.quaternion))>EPS)&&(scope.dispatchEvent(changeEvent),lastPosition.copy(scope.object.position),lastQuaternion.copy(scope.object.quaternion),zoomChanged=!1,!0)}}(),this.dispose=function(){scope.domElement.removeEventListener('contextmenu',onContextMenu,!1),scope.domElement.removeEventListener('mousedown',onMouseDown,!1),scope.domElement.removeEventListener('wheel',onMouseWheel,!1),scope.domElement.removeEventListener('touchstart',onTouchStart,!1),scope.domElement.removeEventListener('touchend',onTouchEnd,!1),scope.domElement.removeEventListener('touchmove',onTouchMove,!1),document.removeEventListener('mousemove',onMouseMove,!1),document.removeEventListener('mouseup',onMouseUp,!1),window.removeEventListener('keydown',onKeyDown,!1)};var scope=this,changeEvent={type:'change'},startEvent={type:'start'},endEvent={type:'end'},STATE={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},state=STATE.NONE,EPS=1e-6,spherical=new THREE.Spherical,sphericalDelta=new THREE.Spherical,scale=1,panOffset=new THREE.Vector3,zoomChanged=!1,rotateStart=new THREE.Vector2,rotateEnd=new THREE.Vector2,rotateDelta=new THREE.Vector2,panStart=new THREE.Vector2,panEnd=new THREE.Vector2,panDelta=new THREE.Vector2,dollyStart=new THREE.Vector2,dollyEnd=new THREE.Vector2,dollyDelta=new THREE.Vector2,panLeft=function(){var v=new THREE.Vector3;return function panLeft(distance,objectMatrix){v.setFromMatrixColumn(objectMatrix,0),v.multiplyScalar(-distance),panOffset.add(v)}}(),panUp=function(){var v=new THREE.Vector3;return function panUp(distance,objectMatrix){v.setFromMatrixColumn(objectMatrix,1),v.multiplyScalar(distance),panOffset.add(v)}}(),pan=function(){var offset=new THREE.Vector3;return function pan(deltaX,deltaY){var element=scope.domElement===document?scope.domElement.body:scope.domElement;if(scope.object.isPerspectiveCamera){var position=scope.object.position;offset.copy(position).sub(scope.target);var targetDistance=offset.length();targetDistance*=Math.tan(scope.object.fov/2*_MathPI/180),panLeft(2*deltaX*targetDistance/element.clientHeight,scope.object.matrix),panUp(2*deltaY*targetDistance/element.clientHeight,scope.object.matrix)}else scope.object.isOrthographicCamera?(panLeft(deltaX*(scope.object.right-scope.object.left)/scope.object.zoom/element.clientWidth,scope.object.matrix),panUp(deltaY*(scope.object.top-scope.object.bottom)/scope.object.zoom/element.clientHeight,scope.object.matrix)):(console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.'),scope.enablePan=!1)}}();scope.domElement.addEventListener('contextmenu',onContextMenu,!1),scope.domElement.addEventListener('mousedown',onMouseDown,!1),scope.domElement.addEventListener('wheel',onMouseWheel,!1),scope.domElement.addEventListener('touchstart',onTouchStart,!1),scope.domElement.addEventListener('touchend',onTouchEnd,!1),scope.domElement.addEventListener('touchmove',onTouchMove,!1),window.addEventListener('keydown',onKeyDown,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn('THREE.OrbitControls: .center has been renamed to .target'),this.target}},noZoom:{get:function(){return console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),!this.enableZoom},set:function(value){console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.'),this.enableZoom=!value}},noRotate:{get:function(){return console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),!this.enableRotate},set:function(value){console.warn('THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'),this.enableRotate=!value}},noPan:{get:function(){return console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),!this.enablePan},set:function(value){console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.'),this.enablePan=!value}},noKeys:{get:function(){return console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),!this.enableKeys},set:function(value){console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.'),this.enableKeys=!value}},staticMoving:{get:function(){return console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),!this.enableDamping},set:function(value){console.warn('THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'),this.enableDamping=!value}},dynamicDampingFactor:{get:function(){return console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor},set:function(value){console.warn('THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'),this.dampingFactor=value}}})},function(module,exports,__webpack_require__){var _Mathfloor3=Math.floor;(function(process){function AlgoliaSearchCore(applicationID,apiKey,opts){var debug=__webpack_require__(7)('algoliasearch'),clone=__webpack_require__(1),isArray=__webpack_require__(8),map=__webpack_require__(5),usage='Usage: algoliasearch(applicationID, apiKey, opts)';if(!0!==opts._allowEmptyCredentials&&!applicationID)throw new errors.AlgoliaSearchError('Please provide an application ID. '+usage);if(!0!==opts._allowEmptyCredentials&&!apiKey)throw new errors.AlgoliaSearchError('Please provide an API key. '+usage);this.applicationID=applicationID,this.apiKey=apiKey,this.hosts={read:[],write:[]},opts=opts||{},this._timeouts=opts.timeouts||{connect:1*1e3,read:2*1e3,write:30*1e3},opts.timeout&&(this._timeouts.connect=this._timeouts.read=this._timeouts.write=opts.timeout);var protocol=opts.protocol||'https:';if(/:$/.test(protocol)||(protocol+=':'),'http:'!==protocol&&'https:'!==protocol)throw new errors.AlgoliaSearchError('protocol must be `http:` or `https:` (was `'+opts.protocol+'`)');if(this._checkAppIdData(),!opts.hosts){var defaultHosts=map(this._shuffleResult,function(hostNumber){return applicationID+'-'+hostNumber+'.algolianet.com'}),mainSuffix=(!1===opts.dsn?'':'-dsn')+'.algolia.net';this.hosts.read=[this.applicationID+mainSuffix].concat(defaultHosts),this.hosts.write=[this.applicationID+'.algolia.net'].concat(defaultHosts)}else isArray(opts.hosts)?(this.hosts.read=clone(opts.hosts),this.hosts.write=clone(opts.hosts)):(this.hosts.read=clone(opts.hosts.read),this.hosts.write=clone(opts.hosts.write));this.hosts.read=map(this.hosts.read,prepareHost(protocol)),this.hosts.write=map(this.hosts.write,prepareHost(protocol)),this.extraHeaders={},this.cache=opts._cache||{},this._ua=opts._ua,this._useCache=void 0===opts._useCache||opts._cache||opts._useCache,this._useRequestCache=this._useCache&&opts._useRequestCache,this._useFallback=void 0===opts.useFallback||opts.useFallback,this._setTimeout=opts._setTimeout,debug('init done, %j',this)}function prepareHost(protocol){return function prepare(host){return protocol+'//'+host.toLowerCase()}}function safeJSONStringify(obj){if(void 0===Array.prototype.toJSON)return JSON.stringify(obj);var toJSON=Array.prototype.toJSON;delete Array.prototype.toJSON;var out=JSON.stringify(obj);return Array.prototype.toJSON=toJSON,out}function shuffle(array){for(var currentIndex=array.length,temporaryValue,randomIndex;0!==currentIndex;)randomIndex=_Mathfloor3(Math.random()*currentIndex),currentIndex-=1,temporaryValue=array[currentIndex],array[currentIndex]=array[randomIndex],array[randomIndex]=temporaryValue;return array}function removeCredentials(headers){var newHeaders={};for(var headerName in headers)if(Object.prototype.hasOwnProperty.call(headers,headerName)){var value;value='x-algolia-api-key'==headerName||'x-algolia-application-id'==headerName?'**hidden for security purposes**':headers[headerName],newHeaders[headerName]=value}return newHeaders}module.exports=AlgoliaSearchCore;var errors=__webpack_require__(4),exitPromise=__webpack_require__(51),IndexCore=__webpack_require__(44),store=__webpack_require__(54),RESET_APP_DATA_TIMER=process.env.RESET_APP_DATA_TIMER&&parseInt(process.env.RESET_APP_DATA_TIMER,10)||1e3*(2*60);AlgoliaSearchCore.prototype.initIndex=function(indexName){return new IndexCore(this,indexName)},AlgoliaSearchCore.prototype.setExtraHeader=function(name,value){this.extraHeaders[name.toLowerCase()]=value},AlgoliaSearchCore.prototype.getExtraHeader=function(name){return this.extraHeaders[name.toLowerCase()]},AlgoliaSearchCore.prototype.unsetExtraHeader=function(name){delete this.extraHeaders[name.toLowerCase()]},AlgoliaSearchCore.prototype.addAlgoliaAgent=function(algoliaAgent){-1===this._ua.indexOf(';'+algoliaAgent)&&(this._ua+=';'+algoliaAgent)},AlgoliaSearchCore.prototype._jsonRequest=function(initialOpts){function doRequest(requester,reqOpts){function retryRequest(){return requestDebug('retrying request'),client._incrementHostIndex(initialOpts.hostType),doRequest(requester,reqOpts)}function retryRequestWithHigherTimeout(){return requestDebug('retrying request with higher timeout'),client._incrementHostIndex(initialOpts.hostType),client._incrementTimeoutMultipler(),reqOpts.timeouts=client._getTimeoutsForRequest(initialOpts.hostType),doRequest(requester,reqOpts)}client._checkAppIdData();var startTime=new Date;if(client._useCache&&!client._useRequestCache&&(cacheID=initialOpts.url),client._useCache&&!client._useRequestCache&&body&&(cacheID+='_body_'+reqOpts.body),isCacheValidWithCurrentID(!client._useRequestCache,cache,cacheID)){requestDebug('serving response from cache');var responseText=cache[cacheID];return client._promise.resolve({body:JSON.parse(responseText),responseText:responseText})}if(tries>=client.hosts[initialOpts.hostType].length)return!hasFallback||usingFallback?(requestDebug('could not get any response'),client._promise.reject(new errors.AlgoliaSearchError('Cannot connect to the AlgoliaSearch API.'+' Send an email to support@algolia.com to report and resolve the issue.'+' Application id was: '+client.applicationID,{debugData:debugData}))):(requestDebug('switching to fallback'),tries=0,reqOpts.method=initialOpts.fallback.method,reqOpts.url=initialOpts.fallback.url,reqOpts.jsonBody=initialOpts.fallback.body,reqOpts.jsonBody&&(reqOpts.body=safeJSONStringify(reqOpts.jsonBody)),headers=client._computeRequestHeaders({additionalUA:additionalUA,headers:initialOpts.headers}),reqOpts.timeouts=client._getTimeoutsForRequest(initialOpts.hostType),client._setHostIndexByType(0,initialOpts.hostType),usingFallback=!0,doRequest(client._request.fallback,reqOpts));var currentHost=client._getHostByType(initialOpts.hostType),url=currentHost+reqOpts.url,options={body:reqOpts.body,jsonBody:reqOpts.jsonBody,method:reqOpts.method,headers:headers,timeouts:reqOpts.timeouts,debug:requestDebug,forceAuthHeaders:reqOpts.forceAuthHeaders};return requestDebug('method: %s, url: %s, headers: %j, timeouts: %d',options.method,url,options.headers,options.timeouts),requester===client._request.fallback&&requestDebug('using fallback'),requester.call(client,url,options).then(function success(httpResponse){var status=httpResponse&&httpResponse.body&&httpResponse.body.message&&httpResponse.body.status||httpResponse.statusCode||httpResponse&&httpResponse.body&&200;requestDebug('received response: statusCode: %s, computed statusCode: %d, headers: %j',httpResponse.statusCode,status,httpResponse.headers);var httpResponseOk=2===_Mathfloor3(status/100),endTime=new Date;if(debugData.push({currentHost:currentHost,headers:removeCredentials(headers),content:body||null,contentLength:void 0===body?null:body.length,method:reqOpts.method,timeouts:reqOpts.timeouts,url:reqOpts.url,startTime:startTime,endTime:endTime,duration:endTime-startTime,statusCode:status}),httpResponseOk)return client._useCache&&!client._useRequestCache&&cache&&(cache[cacheID]=httpResponse.responseText),{responseText:httpResponse.responseText,body:httpResponse.body};var shouldRetry=4!==_Mathfloor3(status/100);if(shouldRetry)return tries+=1,retryRequest();requestDebug('unrecoverable error');var unrecoverableError=new errors.AlgoliaSearchError(httpResponse.body&&httpResponse.body.message,{debugData:debugData,statusCode:status});return client._promise.reject(unrecoverableError)},function tryFallback(err){requestDebug('error: %s, stack: %s',err.message,err.stack);var endTime=new Date;return debugData.push({currentHost:currentHost,headers:removeCredentials(headers),content:body||null,contentLength:void 0===body?null:body.length,method:reqOpts.method,timeouts:reqOpts.timeouts,url:reqOpts.url,startTime:startTime,endTime:endTime,duration:endTime-startTime}),err instanceof errors.AlgoliaSearchError||(err=new errors.Unknown(err&&err.message,err)),tries+=1,err instanceof errors.Unknown||err instanceof errors.UnparsableJSON||tries>=client.hosts[initialOpts.hostType].length&&(usingFallback||!hasFallback)?(err.debugData=debugData,client._promise.reject(err)):err instanceof errors.RequestTimeout?retryRequestWithHigherTimeout():retryRequest()})}function isCacheValidWithCurrentID(useRequestCache,currentCache,currentCacheID){return client._useCache&&useRequestCache&&currentCache&&void 0!==currentCache[currentCacheID]}function interopCallbackReturn(request,callback){return isCacheValidWithCurrentID(client._useRequestCache,cache,cacheID)&&request.catch(function(){delete cache[cacheID]}),'function'==typeof initialOpts.callback?void request.then(function okCb(content){exitPromise(function(){initialOpts.callback(null,callback(content))},client._setTimeout||setTimeout)},function nookCb(err){exitPromise(function(){initialOpts.callback(err)},client._setTimeout||setTimeout)}):request.then(callback)}this._checkAppIdData();var requestDebug=__webpack_require__(7)('algoliasearch:'+initialOpts.url),additionalUA=initialOpts.additionalUA||'',cache=initialOpts.cache,client=this,tries=0,usingFallback=!1,hasFallback=client._useFallback&&client._request.fallback&&initialOpts.fallback,body,cacheID,headers;this.apiKey.length>500&&void 0!==initialOpts.body&&(void 0!==initialOpts.body.params||void 0!==initialOpts.body.requests)?(initialOpts.body.apiKey=this.apiKey,headers=this._computeRequestHeaders({additionalUA:additionalUA,withApiKey:!1,headers:initialOpts.headers})):headers=this._computeRequestHeaders({additionalUA:additionalUA,headers:initialOpts.headers}),void 0!==initialOpts.body&&(body=safeJSONStringify(initialOpts.body)),requestDebug('request start');var debugData=[];if(client._useCache&&client._useRequestCache&&(cacheID=initialOpts.url),client._useCache&&client._useRequestCache&&body&&(cacheID+='_body_'+body),isCacheValidWithCurrentID(client._useRequestCache,cache,cacheID)){requestDebug('serving request from cache');var maybePromiseForCache=cache[cacheID],promiseForCache='function'==typeof maybePromiseForCache.then?maybePromiseForCache:client._promise.resolve({responseText:maybePromiseForCache});return interopCallbackReturn(promiseForCache,function(content){return JSON.parse(content.responseText)})}var request=doRequest(client._request,{url:initialOpts.url,method:initialOpts.method,body:body,jsonBody:initialOpts.body,timeouts:client._getTimeoutsForRequest(initialOpts.hostType),forceAuthHeaders:initialOpts.forceAuthHeaders});return client._useCache&&client._useRequestCache&&cache&&(cache[cacheID]=request),interopCallbackReturn(request,function(content){return content.body})},AlgoliaSearchCore.prototype._getSearchParams=function(args,params){if(args===void 0||null===args)return params;for(var key in args)null!==key&&void 0!==args[key]&&args.hasOwnProperty(key)&&(params+=''===params?'':'&',params+=key+'='+encodeURIComponent('[object Array]'===Object.prototype.toString.call(args[key])?safeJSONStringify(args[key]):args[key]));return params},AlgoliaSearchCore.prototype._computeRequestHeaders=function(options){var forEach=__webpack_require__(3),ua=options.additionalUA?this._ua+';'+options.additionalUA:this._ua,requestHeaders={"x-algolia-agent":ua,"x-algolia-application-id":this.applicationID};return!1!==options.withApiKey&&(requestHeaders['x-algolia-api-key']=this.apiKey),this.userToken&&(requestHeaders['x-algolia-usertoken']=this.userToken),this.securityTags&&(requestHeaders['x-algolia-tagfilters']=this.securityTags),forEach(this.extraHeaders,function addToRequestHeaders(value,key){requestHeaders[key]=value}),options.headers&&forEach(options.headers,function addToRequestHeaders(value,key){requestHeaders[key]=value}),requestHeaders},AlgoliaSearchCore.prototype.search=function(queries,opts,callback){var isArray=__webpack_require__(8),map=__webpack_require__(5);if(!isArray(queries))throw new Error('Usage: client.search(arrayOfQueries[, callback])');'function'==typeof opts?(callback=opts,opts={}):void 0===opts&&(opts={});var client=this,postObj={requests:map(queries,function prepareRequest(query){var params='';return void 0!==query.query&&(params+='query='+encodeURIComponent(query.query)),{indexName:query.indexName,params:client._getSearchParams(query.params,params)}})},JSONPParams=map(postObj.requests,function prepareJSONPParams(request,requestId){return requestId+'='+encodeURIComponent('/1/indexes/'+encodeURIComponent(request.indexName)+'?'+request.params)}).join('&'),url='/1/indexes/*/queries';return void 0!==opts.strategy&&(url+='?strategy='+opts.strategy),this._jsonRequest({cache:this.cache,method:'POST',url:url,body:postObj,hostType:'read',fallback:{method:'GET',url:'/1/indexes/*',body:{params:JSONPParams}},callback:callback})},AlgoliaSearchCore.prototype.searchForFacetValues=function(queries){var isArray=__webpack_require__(8),map=__webpack_require__(5),usage='Usage: client.searchForFacetValues([{indexName, params: {facetName, facetQuery, ...params}}, ...queries])';if(!isArray(queries))throw new Error(usage);var client=this;return client._promise.all(map(queries,function performQuery(query){if(!query||query.indexName===void 0||query.params.facetName===void 0||query.params.facetQuery===void 0)throw new Error(usage);var clone=__webpack_require__(1),omit=__webpack_require__(17),indexName=query.indexName,params=query.params,facetName=params.facetName,filteredParams=omit(clone(params),function(keyName){return'facetName'===keyName}),searchParameters=client._getSearchParams(filteredParams,'');return client._jsonRequest({cache:client.cache,method:'POST',url:'/1/indexes/'+encodeURIComponent(indexName)+'/facets/'+encodeURIComponent(facetName)+'/query',hostType:'read',body:{params:searchParameters}})}))},AlgoliaSearchCore.prototype.setSecurityTags=function(tags){if('[object Array]'===Object.prototype.toString.call(tags)){for(var strTags=[],i=0;i<tags.length;++i)if('[object Array]'===Object.prototype.toString.call(tags[i])){for(var oredTags=[],j=0;j<tags[i].length;++j)oredTags.push(tags[i][j]);strTags.push('('+oredTags.join(',')+')')}else strTags.push(tags[i]);tags=strTags.join(',')}this.securityTags=tags},AlgoliaSearchCore.prototype.setUserToken=function(userToken){this.userToken=userToken},AlgoliaSearchCore.prototype.clearCache=function(){this.cache={}},AlgoliaSearchCore.prototype.setRequestTimeout=function(milliseconds){milliseconds&&(this._timeouts.connect=this._timeouts.read=this._timeouts.write=milliseconds)},AlgoliaSearchCore.prototype.setTimeouts=function(timeouts){this._timeouts=timeouts},AlgoliaSearchCore.prototype.getTimeouts=function(){return this._timeouts},AlgoliaSearchCore.prototype._getAppIdData=function(){var data=store.get(this.applicationID);return null!==data&&this._cacheAppIdData(data),data},AlgoliaSearchCore.prototype._setAppIdData=function(data){return data.lastChange=new Date().getTime(),this._cacheAppIdData(data),store.set(this.applicationID,data)},AlgoliaSearchCore.prototype._checkAppIdData=function(){var data=this._getAppIdData(),now=new Date().getTime();return null===data||now-data.lastChange>RESET_APP_DATA_TIMER?this._resetInitialAppIdData(data):data},AlgoliaSearchCore.prototype._resetInitialAppIdData=function(data){var newData=data||{};return newData.hostIndexes={read:0,write:0},newData.timeoutMultiplier=1,newData.shuffleResult=newData.shuffleResult||shuffle([1,2,3]),this._setAppIdData(newData)},AlgoliaSearchCore.prototype._cacheAppIdData=function(data){this._hostIndexes=data.hostIndexes,this._timeoutMultiplier=data.timeoutMultiplier,this._shuffleResult=data.shuffleResult},AlgoliaSearchCore.prototype._partialAppIdDataUpdate=function(newData){var foreach=__webpack_require__(3),currentData=this._getAppIdData();return foreach(newData,function(value,key){currentData[key]=value}),this._setAppIdData(currentData)},AlgoliaSearchCore.prototype._getHostByType=function(hostType){return this.hosts[hostType][this._getHostIndexByType(hostType)]},AlgoliaSearchCore.prototype._getTimeoutMultiplier=function(){return this._timeoutMultiplier},AlgoliaSearchCore.prototype._getHostIndexByType=function(hostType){return this._hostIndexes[hostType]},AlgoliaSearchCore.prototype._setHostIndexByType=function(hostIndex,hostType){var clone=__webpack_require__(1),newHostIndexes=clone(this._hostIndexes);return newHostIndexes[hostType]=hostIndex,this._partialAppIdDataUpdate({hostIndexes:newHostIndexes}),hostIndex},AlgoliaSearchCore.prototype._incrementHostIndex=function(hostType){return this._setHostIndexByType((this._getHostIndexByType(hostType)+1)%this.hosts[hostType].length,hostType)},AlgoliaSearchCore.prototype._incrementTimeoutMultipler=function(){var timeoutMultiplier=Math.max(this._timeoutMultiplier+1,4);return this._partialAppIdDataUpdate({timeoutMultiplier:timeoutMultiplier})},AlgoliaSearchCore.prototype._getTimeoutsForRequest=function(hostType){return{connect:this._timeouts.connect*this._timeoutMultiplier,complete:this._timeouts[hostType]*this._timeoutMultiplier}}}).call(exports,__webpack_require__(9))},function(module,exports,__webpack_require__){function IndexCore(algoliasearch,indexName){this.indexName=indexName,this.as=algoliasearch,this.typeAheadArgs=null,this.typeAheadValueOption=null,this.cache={}}var buildSearchMethod=__webpack_require__(16),deprecate=__webpack_require__(49),deprecatedMessage=__webpack_require__(50);module.exports=IndexCore,IndexCore.prototype.clearCache=function(){this.cache={}},IndexCore.prototype.search=buildSearchMethod('query'),IndexCore.prototype.similarSearch=buildSearchMethod('similarQuery'),IndexCore.prototype.browse=function(query,queryParameters,callback){var merge=__webpack_require__(52),indexObj=this,page,hitsPerPage;0===arguments.length||1===arguments.length&&'function'==typeof arguments[0]?(page=0,callback=arguments[0],query=void 0):'number'==typeof arguments[0]?(page=arguments[0],'number'==typeof arguments[1]?hitsPerPage=arguments[1]:'function'==typeof arguments[1]&&(callback=arguments[1],hitsPerPage=void 0),query=void 0,queryParameters=void 0):'object'==typeof arguments[0]?('function'==typeof arguments[1]&&(callback=arguments[1]),queryParameters=arguments[0],query=void 0):'string'==typeof arguments[0]&&'function'==typeof arguments[1]&&(callback=arguments[1],queryParameters=void 0),queryParameters=merge({},queryParameters||{},{page:page,hitsPerPage:hitsPerPage,query:query});var params=this.as._getSearchParams(queryParameters,'');return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(indexObj.indexName)+'/browse',body:{params:params},hostType:'read',callback:callback})},IndexCore.prototype.browseFrom=function(cursor,callback){return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(this.indexName)+'/browse',body:{cursor:cursor},hostType:'read',callback:callback})},IndexCore.prototype.searchForFacetValues=function(params,callback){var clone=__webpack_require__(1),omit=__webpack_require__(17);if(params.facetName===void 0||params.facetQuery===void 0)throw new Error('Usage: index.searchForFacetValues({facetName, facetQuery, ...params}[, callback])');var facetName=params.facetName,filteredParams=omit(clone(params),function(keyName){return'facetName'===keyName}),searchParameters=this.as._getSearchParams(filteredParams,'');return this.as._jsonRequest({method:'POST',url:'/1/indexes/'+encodeURIComponent(this.indexName)+'/facets/'+encodeURIComponent(facetName)+'/query',hostType:'read',body:{params:searchParameters},callback:callback})},IndexCore.prototype.searchFacet=deprecate(function(params,callback){return this.searchForFacetValues(params,callback)},deprecatedMessage('index.searchFacet(params[, callback])','index.searchForFacetValues(params[, callback])')),IndexCore.prototype._search=function(params,url,callback,additionalUA){return this.as._jsonRequest({cache:this.cache,method:'POST',url:url||'/1/indexes/'+encodeURIComponent(this.indexName)+'/query',body:{params:params},hostType:'read',fallback:{method:'GET',url:'/1/indexes/'+encodeURIComponent(this.indexName),body:{params:params}},callback:callback,additionalUA:additionalUA})},IndexCore.prototype.getObject=function(objectID,attrs,callback){var indexObj=this;(1===arguments.length||'function'==typeof attrs)&&(callback=attrs,attrs=void 0);var params='';if(attrs!==void 0){params='?attributes=';for(var i=0;i<attrs.length;++i)0!==i&&(params+=','),params+=attrs[i]}return this.as._jsonRequest({method:'GET',url:'/1/indexes/'+encodeURIComponent(indexObj.indexName)+'/'+encodeURIComponent(objectID)+params,hostType:'read',callback:callback})},IndexCore.prototype.getObjects=function(objectIDs,attributesToRetrieve,callback){var isArray=__webpack_require__(8),map=__webpack_require__(5);if(!isArray(objectIDs))throw new Error('Usage: index.getObjects(arrayOfObjectIDs[, callback])');var indexObj=this;(1===arguments.length||'function'==typeof attributesToRetrieve)&&(callback=attributesToRetrieve,attributesToRetrieve=void 0);var body={requests:map(objectIDs,function prepareRequest(objectID){var request={indexName:indexObj.indexName,objectID:objectID};return attributesToRetrieve&&(request.attributesToRetrieve=attributesToRetrieve.join(',')),request})};return this.as._jsonRequest({method:'POST',url:'/1/indexes/*/objects',hostType:'read',body:body,callback:callback})},IndexCore.prototype.as=null,IndexCore.prototype.indexName=null,IndexCore.prototype.typeAheadArgs=null,IndexCore.prototype.typeAheadValueOption=null},function(module,exports,__webpack_require__){'use strict';var AlgoliaSearchCore=__webpack_require__(43),createAlgoliasearch=__webpack_require__(46);module.exports=createAlgoliasearch(AlgoliaSearchCore,'(lite) ')},function(module,exports,__webpack_require__){'use strict';var global=__webpack_require__(142),Promise=global.Promise||__webpack_require__(139).Promise;module.exports=function createAlgoliasearch(AlgoliaSearch,uaSuffix){function algoliasearch(applicationID,apiKey,opts){var cloneDeep=__webpack_require__(1);return opts=cloneDeep(opts||{}),opts._ua=opts._ua||algoliasearch.ua,new AlgoliaSearchBrowser(applicationID,apiKey,opts)}function AlgoliaSearchBrowser(){AlgoliaSearch.apply(this,arguments)}var inherits=__webpack_require__(18),errors=__webpack_require__(4),inlineHeaders=__webpack_require__(47),jsonpRequest=__webpack_require__(48),places=__webpack_require__(53);uaSuffix=uaSuffix||'',!1,algoliasearch.version=__webpack_require__(55),algoliasearch.ua='Algolia for vanilla JavaScript '+uaSuffix+algoliasearch.version,algoliasearch.initPlaces=places(algoliasearch),global.__algolia={debug:__webpack_require__(7),algoliasearch:algoliasearch};var support={hasXMLHttpRequest:'XMLHttpRequest'in global,hasXDomainRequest:'XDomainRequest'in global};return support.hasXMLHttpRequest&&(support.cors='withCredentials'in new XMLHttpRequest),inherits(AlgoliaSearchBrowser,AlgoliaSearch),AlgoliaSearchBrowser.prototype._request=function request(url,opts){return new Promise(function wrapRequest(resolve,reject){function onTimeout(){timedOut=!0,req.abort(),reject(new errors.RequestTimeout)}function onConnect(){connected=!0,clearTimeout(reqTimeout),reqTimeout=setTimeout(onTimeout,opts.timeouts.complete)}if(!support.cors&&!support.hasXDomainRequest)return void reject(new errors.Network('CORS not supported'));url=inlineHeaders(url,opts.headers);var body=opts.body,req=support.cors?new XMLHttpRequest:new XDomainRequest,connected=!1,reqTimeout,timedOut;reqTimeout=setTimeout(onTimeout,opts.timeouts.connect),req.onprogress=function onProgress(){connected||onConnect()},'onreadystatechange'in req&&(req.onreadystatechange=function onReadyStateChange(){!connected&&1<req.readyState&&onConnect()}),req.onload=function onLoad(){if(!timedOut){clearTimeout(reqTimeout);var out;try{out={body:JSON.parse(req.responseText),responseText:req.responseText,statusCode:req.status,headers:req.getAllResponseHeaders&&req.getAllResponseHeaders()||{}}}catch(e){out=new errors.UnparsableJSON({more:req.responseText})}out instanceof errors.UnparsableJSON?reject(out):resolve(out)}},req.onerror=function onError(event){timedOut||(clearTimeout(reqTimeout),reject(new errors.Network({more:event})))},req instanceof XMLHttpRequest?(req.open(opts.method,url,!0),opts.forceAuthHeaders&&(req.setRequestHeader('x-algolia-application-id',opts.headers['x-algolia-application-id']),req.setRequestHeader('x-algolia-api-key',opts.headers['x-algolia-api-key']))):req.open(opts.method,url),support.cors&&(body&&('POST'===opts.method?req.setRequestHeader('content-type','application/x-www-form-urlencoded'):req.setRequestHeader('content-type','application/json')),req.setRequestHeader('accept','application/json')),body?req.send(body):req.send()})},AlgoliaSearchBrowser.prototype._request.fallback=function requestFallback(url,opts){return url=inlineHeaders(url,opts.headers),new Promise(function wrapJsonpRequest(resolve,reject){jsonpRequest(url,opts,function jsonpRequestDone(err,content){return err?void reject(err):void resolve(content)})})},AlgoliaSearchBrowser.prototype._promise={reject:function rejectPromise(val){return Promise.reject(val)},resolve:function resolvePromise(val){return Promise.resolve(val)},delay:function delayPromise(ms){return new Promise(function resolveOnTimeout(resolve){setTimeout(resolve,ms)})},all:function all(promises){return Promise.all(promises)}},algoliasearch}},function(module,exports,__webpack_require__){'use strict';module.exports=function inlineHeaders(url,headers){return url+=/\?/.test(url)?'&':'?',url+encode(headers)};var encode=__webpack_require__(145)},function(module,exports,__webpack_require__){'use strict';module.exports=function jsonpRequest(url,opts,cb){function success(){opts.debug('JSONP: success');done||timedOut||(done=!0,!cbCalled&&(opts.debug('JSONP: Fail. Script loaded but did not call the callback'),clean(),cb(new errors.JSONPScriptFail)))}function clean(){clearTimeout(ontimeout),script.onload=null,script.onreadystatechange=null,script.onerror=null,head.removeChild(script)}function removeGlobals(){try{delete window[cbName],delete window[cbName+'_loaded']}catch(e){window[cbName]=window[cbName+'_loaded']=void 0}}if('GET'!==opts.method)return void cb(new Error('Method '+opts.method+' '+url+' is not supported by JSONP.'));opts.debug('JSONP: start');var cbCalled=!1,timedOut=!1;JSONPCounter+=1;var head=document.getElementsByTagName('head')[0],script=document.createElement('script'),cbName='algoliaJSONP_'+JSONPCounter,done=!1;window[cbName]=function(data){return removeGlobals(),timedOut?void opts.debug('JSONP: Late answer, ignoring'):void(cbCalled=!0,clean(),cb(null,{body:data,responseText:JSON.stringify(data)}))},url+='&callback='+cbName,opts.jsonBody&&opts.jsonBody.params&&(url+='&'+opts.jsonBody.params);var ontimeout=setTimeout(function timeout(){opts.debug('JSONP: Script timeout'),timedOut=!0,clean(),cb(new errors.RequestTimeout)},opts.timeouts.complete);script.onreadystatechange=function readystatechange(){('loaded'===this.readyState||'complete'===this.readyState)&&success()},script.onload=success,script.onerror=function error(){opts.debug('JSONP: Script error');done||timedOut||(clean(),cb(new errors.JSONPScriptError))},script.async=!0,script.defer=!0,script.src=url,head.appendChild(script)};var errors=__webpack_require__(4),JSONPCounter=0},function(module){module.exports=function deprecate(fn,message){var warned=!1;return function deprecated(){return warned||(console.warn(message),warned=!0),fn.apply(this,arguments)}}},function(module){module.exports=function deprecatedMessage(previousUsage,newUsage){var githubAnchorLink=previousUsage.toLowerCase().replace(/[\.\(\)]/g,'');return'algoliasearch: `'+previousUsage+'` was replaced by `'+newUsage+'`. Please see https://github.com/algolia/algoliasearch-client-javascript/wiki/Deprecated#'+githubAnchorLink}},function(module){module.exports=function exitPromise(fn,_setTimeout){_setTimeout(fn,0)}},function(module,exports,__webpack_require__){var foreach=__webpack_require__(3);module.exports=function merge(destination){var sources=Array.prototype.slice.call(arguments);return foreach(sources,function(source){for(var keyName in source)source.hasOwnProperty(keyName)&&('object'==typeof destination[keyName]&&'object'==typeof source[keyName]?destination[keyName]=merge({},destination[keyName],source[keyName]):void 0!==source[keyName]&&(destination[keyName]=source[keyName]))}),destination}},function(module,exports,__webpack_require__){module.exports=function createPlacesClient(algoliasearch){return function places(appID,apiKey,opts){var cloneDeep=__webpack_require__(1);opts=opts&&cloneDeep(opts)||{},opts.hosts=opts.hosts||['places-dsn.algolia.net','places-1.algolianet.com','places-2.algolianet.com','places-3.algolianet.com'],(0===arguments.length||'object'==typeof appID||void 0===appID)&&(appID='',apiKey='',opts._allowEmptyCredentials=!0);var client=algoliasearch(appID,apiKey,opts),index=client.initIndex('places');return index.search=buildSearchMethod('query','/1/places/query'),index.getObject=function(objectID,callback){return this.as._jsonRequest({method:'GET',url:'/1/places/'+encodeURIComponent(objectID),hostType:'read',callback:callback})},index}};var buildSearchMethod=__webpack_require__(16)},function(module,exports,__webpack_require__){(function(global){function localStorageFailure(key,e){return debug('localStorage failed with',e),cleanup(),store=moduleStore,store.get(key)}function getOrSet(key,data){return 1===arguments.length?store.get(key):store.set(key,data)}function supportsLocalStorage(){try{return'localStorage'in global&&null!==global.localStorage&&(global.localStorage[localStorageNamespace]||global.localStorage.setItem(localStorageNamespace,JSON.stringify({})),!0)}catch(_){return!1}}function cleanup(){try{global.localStorage.removeItem(localStorageNamespace)}catch(_){}}var debug=__webpack_require__(7)('algoliasearch:src/hostIndexState.js'),localStorageNamespace='algoliasearch-client-js',moduleStore={state:{},set:function(key,data){return this.state[key]=data,this.state[key]},get:function(key){return this.state[key]||null}},store;store=supportsLocalStorage()?{set:function(key,data){moduleStore.set(key,data);try{var namespace=JSON.parse(global.localStorage[localStorageNamespace]);return namespace[key]=data,global.localStorage[localStorageNamespace]=JSON.stringify(namespace),namespace[key]}catch(e){return localStorageFailure(key,e)}},get:function(key){try{return JSON.parse(global.localStorage[localStorageNamespace])[key]||null}catch(e){return localStorageFailure(key,e)}}}:moduleStore,module.exports={get:getOrSet,set:getOrSet,supportsLocalStorage:supportsLocalStorage}}).call(exports,__webpack_require__(0))},function(module){'use strict';module.exports='3.29.0'},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    void main() {
      uvs.xy = uv.xy;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
  `,fragmentShader:`
    varying vec2 uvs;
    uniform sampler2D src;

    void main() {
      gl_FragColor = texture2D(src, uvs);
    }
`}},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 tunnelNeon;
    uniform vec3 leftLaser;
    uniform vec3 rightLaser;
    uniform vec3 floorNeon;
    uniform vec3 textGlow;
    uniform sampler2D src;

    void main() {
      float mask;
      vec4 col = texture2D(src, uvs);

      // tunnel neon
      mask = step(0.87, uvs.x) *  step(0.5, uvs.y) * (1.0 - step(0.935, uvs.x)) * ( 1.0 - step(0.75, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * tunnelNeon, mask);

      // floor & corridor neons
      mask = step(0.935, uvs.x) * step(0.5, uvs.y) * ( 1.0 - step(0.75, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * floorNeon, mask);

      // left laser
      mask = step(0.5, uvs.x) * (1.0 - step(0.625, uvs.x)) * (1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * leftLaser, mask);

      // right laser
      mask = step(0.625, uvs.x) * (1.0 - step(0.75, uvs.x)) * (1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * rightLaser, mask);

      // text glows
      mask = step(0.87, uvs.x) *  step(0.25, uvs.y) * (1.0 - step(0.935, uvs.x)) * ( 1.0 - step(0.5, uvs.y));
      col.xyz = mix(col.xyz, col.xyz * textGlow, mask);

      gl_FragColor = col;
    }
  `}},function(module){module.exports={vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    #define FOG_RADIUS  55.0
    #define FOG_FALLOFF 48.0
    #define FOG_COLOR_MULT 0.8
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 skyColor;
    uniform vec3 backglowColor;
    uniform sampler2D src;

    void main() {
      vec4 col = texture2D(src, uvs);
      float mask;

      // bg
      mask = step(0.5, uvs.x);
      col.xyz = mix(col.xyz * skyColor, col.xyz, mask);

      // backglow
      mask = step(0.5, uvs.x) * step(0.5, uvs.y) * (1.0 - step(0.75, uvs.x));
      col.xyz = mix(col.xyz, col.xyz * backglowColor, mask);

      float fogDensity = 1.0 - pow(clamp(distance(worldPos, vec3(0., 0., -FOG_RADIUS)) / FOG_FALLOFF, 0.0, 1.0), 1.5);
      fogDensity += clamp(0.2 - pow(distance(worldPos, vec3(0.0, 0.0, worldPos.z)) / 10.0, 2.0), 0.0, 1.0);
      col.xyz = mix(col.xyz, backglowColor * FOG_COLOR_MULT, fogDensity);

      gl_FragColor = col;
    }
  `}},function(){AFRAME.registerComponent('active-color',{dependencies:['material'],schema:{active:{default:!1},color:{default:'#ffffff'}},init:function(){this.defaultColor=this.el.getAttribute('material').color,this.materialObj={color:this.data.color,opacity:1}},update:function(){var el=this.el;this.data.active?(el.setAttribute('material',this.materialObj),el.object3D.visible=!0):(el.setAttribute('material','color',this.defaultColor),el.components.animation__mouseleave&&setTimeout(()=>{el.emit('mouseleave',null,!1)}))}}),AFRAME.registerComponent('active-text-color',{dependencies:['text'],schema:{active:{default:!1},color:{default:'#333'}},init:function(){this.defaultColor=this.el.getAttribute('text').color},update:function(){var el=this.el;this.data.active?el.setAttribute('text','color',this.data.color):el.setAttribute('text','color',this.defaultColor)}})},function(){const NUM_VALUES_PER_BOX=90;AFRAME.registerComponent('audio-columns',{schema:{analyser:{type:'selector',default:'#audioAnalyser'},height:{default:1},mirror:{default:3},scale:{default:4},separation:{default:0.3},thickness:{default:0.1}},init:function(){var objData=document.getElementById('audiocolumnObj').data,loader=new THREE.OBJLoader,columnGeometry=loader.parse(objData).children[0].geometry;this.analyser=this.data.analyser.components.audioanalyser,this.frequencyBinCount=this.analyser.data.fftSize/2;const geometries=[];let zPosition=0;for(let i=0;i<this.frequencyBinCount;i++)for(let side=0;2>side;side++){const box=columnGeometry.clone();this.initBox(box,0===side?1:-1,zPosition),geometries.push(box),zPosition-=this.data.separation}this.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);const mesh=new THREE.Mesh(this.geometry,this.el.sceneEl.systems.materials.stageNormal);this.el.setObject3D('mesh',mesh)},tick:function(){for(let i=0,yScale;i<2*this.frequencyBinCount;i+=2){if(yScale=this.data.height/2+this.analyser.levels[Math.floor(i/2)]/256*this.data.scale,isNaN(yScale))return;this.setBoxHeight(2*this.frequencyBinCount-i-1,yScale),this.setBoxHeight(2*this.frequencyBinCount-i-2,yScale),this.geometry.attributes.position.needsUpdate=!0}},initBox:function(box,flip,zPosition){const data=this.data;for(let v=0;v<box.attributes.position.array.length;v+=3)box.attributes.position.array[v+2]+=zPosition,box.attributes.position.array[v+1]*=data.height/2,box.attributes.position.array[v]+=flip*data.mirror},setBoxHeight:function(boxNumber,height){const boxIndex=boxNumber*NUM_VALUES_PER_BOX;for(let i=boxIndex,yValue;i<boxIndex+NUM_VALUES_PER_BOX;i+=3)yValue=this.geometry.attributes.position.array[i+1],this.geometry.attributes.position.array[i+1]=0<=yValue?height:-1*height}})},function(){const ANIME=AFRAME.ANIME||AFRAME.anime;AFRAME.registerComponent('beams',{schema:{isPlaying:{default:!1},poolSize:{default:3}},init:function(){this.beams=[],this.currentRed=0,this.currentBlue=0,this.clearBeams=this.clearBeams.bind(this),this.el.sceneEl.addEventListener('cleargame',this.clearBeams)},update:function(){for(let i=0;i<this.beams.length;i++)this.beams[i].time&&(this.beams[i].visible=this.data.isPlaying)},play:function(){var loader=new THREE.OBJLoader,objData,loader,redGeometry,blueGeometry;objData=document.getElementById('redbeamObj').data,redGeometry=loader.parse(objData).children[0].geometry,objData=document.getElementById('bluebeamObj').data,blueGeometry=loader.parse(objData).children[0].geometry,this.redBeams=this.createBeamPool(redGeometry,this.el.sceneEl.systems.materials.stageAdditive),this.blueBeams=this.createBeamPool(blueGeometry,this.el.sceneEl.systems.materials.stageAdditive)},tick:function(t,dt){if(this.data.isPlaying)for(let i=0,beam;i<this.beams.length;i++)(beam=this.beams[i],!!beam.visible)&&(beam.time+=dt,beam.animation.tick(beam.time))},createBeamPool:function(geometry,material){const beams=[];for(let i=0,beam;i<this.data.poolSize;i++)beam=new THREE.Mesh(geometry,material),beam.visible=!1,beam.animation=ANIME({autoplay:!1,targets:beam.scale,x:1e-5,duration:300,easing:'easeInCubic',complete:()=>{beam.visible=!1}}),this.el.object3D.add(beam),beams.push(beam),this.beams.push(beam);return beams},newBeam:function(color,position){var beam;'red'===color?(beam=this.redBeams[this.currentRed],this.currentRed=(this.currentRed+1)%this.redBeams.length,beam.position.set(position.x,position.y,position.z+this.currentRed/50)):(beam=this.blueBeams[this.currentBlue],this.currentBlue=(this.currentBlue+1)%this.blueBeams.length,beam.position.set(position.x,position.y,position.z+this.currentBlue/50)),beam.visible=!0,beam.scale.x=1,beam.time=0},clearBeams:function(){for(let i=0;i<this.beams.length;i++)this.beams[i].visible=!1,this.beams[i].time=0,this.beams[i].scale.x=1}})},function(){var audioContext=new window.AudioContext,sourceCreatedCallback;const LAYER_BOTTOM='bottom',LAYER_TOP='top',VOLUME=0.25;THREE.Audio.prototype.play=function(){if(!0===this.isPlaying)return void console.warn('THREE.Audio: Audio is already playing.');if(!1===this.hasPlaybackControl)return void console.warn('THREE.Audio: this Audio has no playback control.');var source=this.context.createBufferSource();return source.buffer=this.buffer,source.detune.value=this.detune,source.loop=this.loop,source.onended=this.onEnded.bind(this),source.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,sourceCreatedCallback&&sourceCreatedCallback(source),source.start(this.startTime,this.offset),this.isPlaying=!0,this.source=source,this.connect()},AFRAME.registerComponent('beat-hit-sound',{directionsToSounds:{up:'',down:'',upleft:'left',upright:'right',downleft:'left',downright:'right',left:'left',right:'right'},init:function(){this.currentBeatEl=null,this.currentCutDirection='',this.processSound=this.processSound.bind(this),sourceCreatedCallback=this.sourceCreatedCallback.bind(this);for(let i=1;10>=i;i++)this.el.setAttribute(`sound__beathit${i}`,{poolSize:4,src:`#hitSound${i}`,volume:VOLUME}),this.el.setAttribute(`sound__beathit${i}left`,{poolSize:4,src:`#hitSound${i}left`,volume:VOLUME}),this.el.setAttribute(`sound__beathit${i}right`,{poolSize:4,src:`#hitSound${i}right`,volume:VOLUME})},play:function(){for(let i=1;10>=i;i++)this.el.components[`sound__beathit${i}`].loaded||(this.el.setAttribute(`sound__beathit${i}`,'src',''),this.el.setAttribute(`sound__beathit${i}`,'src',`#hitSound${i}`)),this.el.components[`sound__beathit${i}left`].loaded||(this.el.setAttribute(`sound__beathit${i}left`,'src',''),this.el.setAttribute(`sound__beathit${i}left`,'src',`#hitSound${i}left`)),this.el.components[`sound__beathit${i}right`].loaded||(this.el.setAttribute(`sound__beathit${i}right`,'src',''),this.el.setAttribute(`sound__beathit${i}right`,'src',`#hitSound${i}right`))},playSound:function(beatEl,cutDirection){const rand=1+Math.floor(10*Math.random()),dir=this.directionsToSounds[cutDirection||'up'],soundPool=this.el.components[`sound__beathit${rand}${dir}`];this.currentBeatEl=beatEl,soundPool.playSound(this.processSound)},processSound:function(audio){audio.detune=0,this.currentBeatEl.object3D.getWorldPosition(audio.position)},sourceCreatedCallback:function(source){const layer=this.getLayer(this.currentBeatEl.object3D.position.y);layer===LAYER_BOTTOM?source.detune.setValueAtTime(-400,0):layer===LAYER_TOP&&source.detune.setValueAtTime(200,0),'down'===this.currentCutDirection&&source.detune.linearRampToValueAtTime(-400,1),'up'===this.currentCutDirection&&source.detune.linearRampToValueAtTime(400,1)},getLayer:function(y){return 1===y?LAYER_BOTTOM:1.7===y?LAYER_TOP:'middle'}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function lessThan(a,b){return a._time-b._time}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10),__WEBPACK_IMPORTED_MODULE_1__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_1__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__utils__);let skipDebug=AFRAME.utils.getUrlParameter('skip')||0;skipDebug=parseInt(skipDebug,10),AFRAME.registerComponent('beat-loader',{dependencies:['stage-colors'],schema:{beatAnticipationTime:{default:1.1},beatSpeed:{default:8},beatWarmupTime:{default:__WEBPACK_IMPORTED_MODULE_0__constants_beat__.b/1e3},beatWarmupSpeed:{default:__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a},challengeId:{type:'string'},difficulty:{type:'string'},isPlaying:{default:!1},menuSelectedChallengeId:{type:'string'}},orientationsHumanized:['up','down','left','right','upleft','upright','downleft','downright'],horizontalPositions:[-0.75,-0.25,0.25,0.75],horizontalPositionsHumanized:{0:'left',1:'middleleft',2:'middleright',3:'right'},positionHumanized:{topLeft:{layer:2,index:0},topCenterLeft:{layer:2,index:1},topCenterRight:{layer:2,index:2},topRight:{layer:2,index:3},middleLeft:{layer:1,index:0},middleCenterLeft:{layer:1,index:1},middleCenterRight:{layer:1,index:2},middleRight:{layer:1,index:3},bottomLeft:{layer:0,index:0},bottomCenterLeft:{layer:0,index:1},bottomCenterRight:{layer:0,index:2},bottomRight:{layer:0,index:3}},verticalPositionsHumanized:{0:'bottom',1:'middle',2:'top'},init:function(){this.audioAnalyserEl=document.getElementById('audioanalyser'),this.beatData=null,this.beatDataProcessed=!1,this.beatContainer=document.getElementById('beatContainer'),this.beatsTime=void 0,this.beatsPreloadTime=0,this.beatsPreloadTimeTotal=1e3*(this.data.beatAnticipationTime+this.data.beatWarmupTime),this.bpm=void 0,this.xhr=null,this.stageColors=this.el.components['stage-colors'],this.swordOffset=1.5,this.twister=document.getElementById('twister'),this.leftStageLasers=document.getElementById('leftStageLasers'),this.rightStageLasers=document.getElementById('rightStageLasers'),this.el.addEventListener('cleargame',this.clearBeats.bind(this))},update:function(oldData){const data=this.data;return!oldData.challengeId&&data.challengeId&&this.beatData?void this.processBeats():void(!data.menuSelectedChallengeId||!data.difficulty||(data.menuSelectedChallengeId!==oldData.menuSelectedChallengeId||data.difficulty!==oldData.difficulty)&&this.fetchBeats())},fetchBeats:function(){var el=this.el;this.xhr&&this.xhr.abort();let url=__WEBPACK_IMPORTED_MODULE_1__utils___default.a.getS3FileUrl(this.data.menuSelectedChallengeId,`${this.data.difficulty}.json`);const xhr=this.xhr=new XMLHttpRequest;el.emit('beatloaderstart'),console.log(`[beat-loader] Fetching ${url}...`),xhr.open('GET',url),xhr.addEventListener('load',()=>{this.beatData=JSON.parse(xhr.responseText),this.beatDataProcessed=!1,this.xhr=null,this.el.sceneEl.emit('beatloaderfinish',null,!1)}),xhr.send()},processBeats:function(){this.beatsTime=0,this.beatsPreloadTime=0,this.beatData._events.sort(lessThan),this.beatData._obstacles.sort(lessThan),this.beatData._notes.sort(lessThan),this.bpm=this.beatData._beatsPerMinute;const events=this.beatData._events;if(events.length&&0>events[0]._time)for(let i=0;0>events[i]._time;i++)this.generateEvent(events[i]);this.beatDataProcessed=!0,console.log('[beat-loader] Finished processing beat data.')},tick:function(time,delta){if(this.data.isPlaying&&this.data.challengeId&&this.beatData){const prevBeatsTime=this.beatsTime+skipDebug;if(void 0===this.beatsPreloadTime){const song=this.el.components.song;if(!song.isPlaying)return;this.beatsTime=1e3*(song.getCurrentTime()+this.data.beatAnticipationTime+this.data.beatWarmupTime)}else this.beatsTime=this.beatsPreloadTime;const beatsTime=this.beatsTime+skipDebug,bpm=this.beatData._beatsPerMinute,msPerBeat=1e3*60/this.beatData._beatsPerMinute,notes=this.beatData._notes;for(let i=0,noteTime;i<notes.length;++i)noteTime=notes[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&(notes[i].time=noteTime,this.generateBeat(notes[i]));const obstacles=this.beatData._obstacles;for(let i=0,noteTime;i<obstacles.length;++i)noteTime=obstacles[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&this.generateWall(obstacles[i]);const events=this.beatData._events;for(let i=0,noteTime;i<events.length;++i)noteTime=events[i]._time*msPerBeat,noteTime>prevBeatsTime&&noteTime<=beatsTime&&this.generateEvent(events[i]);void 0===this.beatsPreloadTime||(this.beatsPreloadTime>=this.beatsPreloadTimeTotal?(this.el.sceneEl.emit('beatloaderpreloadfinish',null,!1),this.beatsPreloadTime=void 0):this.beatsPreloadTime+=delta)}},generateBeat:function(){const beatObj={};return function(noteInfo){const data=this.data;let type=8===noteInfo._cutDirection?'dot':'arrow',color;0===noteInfo._type?color='red':1===noteInfo._type?color='blue':(type='mine',color=void 0);const beatEl=this.requestBeat(type,color);beatEl&&(beatObj.anticipationPosition=-data.beatAnticipationTime*data.beatSpeed-this.swordOffset,beatObj.color=color,beatObj.cutDirection=this.orientationsHumanized[noteInfo._cutDirection],beatObj.horizontalPosition=this.horizontalPositionsHumanized[noteInfo._lineIndex],beatObj.speed=this.data.beatSpeed,beatObj.type=type,beatObj.verticalPosition=this.verticalPositionsHumanized[noteInfo._lineLayer],beatObj.warmupPosition=-data.beatWarmupTime*data.beatWarmupSpeed,beatEl.setAttribute('beat',beatObj),beatEl.components.beat.updatePosition(),beatEl.play(),beatEl.components.beat.onGenerate())}}(),generateWall:function(){const wallObj={};return function(wallInfo){const el=this.el.sceneEl.components.pool__wall.requestEntity();if(el){const data=this.data,speed=this.data.beatSpeed,durationSeconds=60*(wallInfo._duration/this.bpm);wallObj.anticipationPosition=-data.beatAnticipationTime*data.beatSpeed-this.swordOffset,wallObj.durationSeconds=durationSeconds,wallObj.horizontalPosition=this.horizontalPositionsHumanized[wallInfo._lineIndex],wallObj.isCeiling=1===wallInfo._type,wallObj.speed=speed,wallObj.warmupPosition=-data.beatWarmupTime*data.beatWarmupSpeed,wallObj.width=wallInfo._width,el.setAttribute('wall',wallObj),el.play()}}}(),generateEvent:function(event){switch(event._type){case 0:this.stageColors.setColor('bg',event._value);break;case 1:this.stageColors.setColor('tunnel',event._value);break;case 2:this.stageColors.setColor('leftlaser',event._value);break;case 3:this.stageColors.setColor('rightlaser',event._value);break;case 4:this.stageColors.setColor('floor',event._value);break;case 8:this.twister.components.twister.pulse(event._value);break;case 9:this.twister.components.twister.pulse(event._value);break;case 12:this.leftStageLasers.components['stage-lasers'].pulse(event._value);break;case 13:this.rightStageLasers.components['stage-lasers'].pulse(event._value);}},requestBeat:function(type,color){var beatPoolName='pool__beat-'+type,pool;return color&&(beatPoolName+='-'+color),pool=this.el.sceneEl.components[beatPoolName],pool?pool.requestEntity():void console.warn('Pool '+beatPoolName+' unavailable')},clearBeats:function(){this.beatsPreloadTime=0,this.beatsTime=0;for(let i=0,child;i<this.beatContainer.children.length;i++)child=this.beatContainer.children[i],child.components.beat&&child.components.beat.returnToPool(!0),child.components.wall&&child.components.wall.returnToPool(!0)}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function getGravityVelocity(velocity,timeDelta){return velocity+-9.8*(timeDelta/1e3)}var _MathPI2=Math.PI,_Mathmax4=Math.max;Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10);const COLORS=__webpack_require__(6),auxObj3D=new THREE.Object3D,BEAT_WARMUP_ROTATION_TIME=750,DESTROYED_SPEED=1,ONCE={once:!0},SCORE_POOL={OK:'pool__beatscoreok',GOOD:'pool__beatscoregood',GREAT:'pool__beatscoregreat',SUPER:'pool__beatscoresuper'};AFRAME.registerComponent('beat',{schema:{anticipationPosition:{default:0},color:{default:'red',oneOf:['red','blue']},cutDirection:{default:'down'},debug:{default:!1},horizontalPosition:{default:'middleleft',oneOf:['left','middleleft','middleright','right']},size:{default:0.4},speed:{default:8},type:{default:'arrow',oneOf:['arrow','dot','mine']},verticalPosition:{default:'middle',oneOf:['bottom','middle','top']},warmupPosition:{default:0}},materialColor:{blue:COLORS.BEAT_BLUE,red:COLORS.BEAT_RED},cutColor:{blue:'#fff',red:'#fff'},models:{arrow:'beatObjTemplate',dot:'beatObjTemplate',mine:'mineObjTemplate'},signModels:{arrowred:'arrowRedObjTemplate',arrowblue:'arrowBlueObjTemplate',dotred:'dotRedObjTemplate',dotblue:'dotBlueObjTemplate'},orientations:[180,0,270,90,225,135,315,45,0],rotations:{up:180,down:0,left:270,right:90,upleft:225,upright:135,downleft:315,downright:45},horizontalPositions:{left:-0.75,middleleft:-0.25,middleright:0.25,right:0.75},verticalPositions:{bottom:0.7,middle:1.2,top:1.7},init:function(){this.backToPool=!1,this.beams=document.getElementById('beams').components.beams,this.beatBoundingBox=new THREE.Box3,this.currentRotationWarmupTime=0,this.cutDirection=new THREE.Vector3,this.destroyed=!1,this.gravityVelocity=0,this.hitEventDetail={},this.hitBoundingBox=new THREE.Box3,this.poolName=void 0,this.returnToPoolTimer=800,this.rotationAxis=new THREE.Vector3,this.saberEls=this.el.sceneEl.querySelectorAll('[saber-controls]'),this.scoreEl=null,this.scoreElTime=void 0,this.startPositionZ=void 0,this.rightCutPlanePoints=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.leftCutPlanePoints=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.mineParticles=document.getElementById('mineParticles'),this.wrongElLeft=document.getElementById('wrongLeft'),this.wrongElRight=document.getElementById('wrongRight'),this.missElLeft=document.getElementById('missLeft'),this.missElRight=document.getElementById('missRight'),this.particles=document.getElementById('saberParticles'),this.mineParticles=document.getElementById('mineParticles'),this.superCuts=document.querySelectorAll('.superCutFx'),this.superCutIdx=0,this.explodeEventDetail={position:null,rotation:null},this.saberColors={right:'blue',left:'red'},this.onEndStroke=this.onEndStroke.bind(this),this.initBlock(),'mine'===this.data.type?this.initMineFragments():this.initFragments()},updatePosition:function(){const el=this.el,data=this.data;el.object3D.position.set(this.horizontalPositions[data.horizontalPosition],this.verticalPositions[data.verticalPosition],data.anticipationPosition+data.warmupPosition),el.object3D.rotation.z=THREE.Math.degToRad(this.rotations[data.cutDirection])},update:function(){this.updatePosition(),this.updateBlock(),this.updateFragments(),this.poolName='mine'===this.data.type?`pool__beat-mine`:`pool__beat-${this.data.type}-${this.data.color}`},pause:function(){this.el.object3D.visible=!1,'mine'!==this.data.type&&(this.partLeftEl.object3D.visible=!1,this.partRightEl.object3D.visible=!1)},play:function(){this.blockEl.object3D.visible=!0,this.destroyed=!1,this.el.object3D.visible=!0},tock:function(time,timeDelta){const el=this.el,data=this.data,position=el.object3D.position,rotation=el.object3D.rotation;if(this.destroyed)this.tockDestroyed(timeDelta);else{if(position.z>-1.65&&this.checkCollisions(),position.z<data.anticipationPosition){let newPositionZ=position.z+__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a*(timeDelta/1e3);newPositionZ<data.anticipationPosition?position.z=newPositionZ:(position.z=data.anticipationPosition,this.beams.newBeam(this.data.color,position))}else position.z+=this.data.speed*(timeDelta/1e3),rotation.z=this.startRotationZ;if(position.z>data.anticipationPosition-0.4&&this.currentRotationWarmupTime<BEAT_WARMUP_ROTATION_TIME){const progress=AFRAME.ANIME.easings.easeOutBack(this.currentRotationWarmupTime/BEAT_WARMUP_ROTATION_TIME);el.object3D.rotation.z=this.rotationZStart+progress*this.rotationZChange,this.currentRotationWarmupTime+=timeDelta}this.backToPool=2<=position.z,this.backToPool&&this.missHit()}this.returnToPool()},onGenerate:function(){this.startRotationZ=this.el.object3D.rotation.z,this.currentRotationWarmupTime=0,this.rotationZChange=_MathPI2/5,0.5<Math.random&&(this.rotationZChange*=-1),this.el.object3D.rotation.z-=this.rotationZChange,this.rotationZStart=this.el.object3D.rotation.z,'mine'==this.data.type&&this.resetMineFragments()},initBlock:function(){var el=this.el,blockEl=this.blockEl=document.createElement('a-entity'),signEl=this.signEl=document.createElement('a-entity');blockEl.setAttribute('mixin','beatBlock'),blockEl.setAttribute('mixin','beatSign'),signEl.object3D.position.z+=0.02,blockEl.appendChild(signEl),el.appendChild(blockEl)},updateBlock:function(){const blockEl=this.blockEl,signEl=this.signEl;if(blockEl)if(blockEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color]}),this.setObjModelFromTemplate(blockEl,this.models[this.data.type]),blockEl.object3D.scale.set(1,1,1),blockEl.object3D.scale.multiplyScalar(3.45).multiplyScalar(this.data.size),'mine'===this.data.type){const model=blockEl.getObject3D('mesh');model?model.material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color]:blockEl.addEventListener('model-loaded',()=>{model.material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color]},ONCE)}else signEl.setAttribute('materials',{name:'stageAdditive'}),this.setObjModelFromTemplate(signEl,this.signModels[this.data.type+this.data.color])},initFragments:function(){var cutEl,partEl;partEl=this.partLeftEl=document.createElement('a-entity'),cutEl=this.cutLeftEl=document.createElement('a-entity'),partEl.appendChild(cutEl),this.el.appendChild(partEl),partEl=this.partRightEl=document.createElement('a-entity'),cutEl=this.cutRightEl=document.createElement('a-entity'),partEl.appendChild(cutEl),this.el.appendChild(partEl),this.initCuttingClippingPlanes()},initMineFragments:function(){var fragments=this.el.sceneEl.systems['mine-fragments-loader'].fragments.children,material=this.el.sceneEl.systems.materials['mineMaterial'+this.data.color],fragment;this.randVec=new THREE.Vector3(Math.random()*_MathPI2,Math.random()*_MathPI2,Math.random()*_MathPI2),this.mineFragments=[],this.mineBroken=document.createElement('a-entity'),this.el.appendChild(this.mineBroken);for(var i=0;i<fragments.length;i++)fragment=new THREE.Mesh(fragments[i].geometry,material),fragment.speed=new THREE.Vector3,fragment.speed.set(Math.random()-0.5,Math.random()-0.5,Math.random()-0.5),this.mineFragments.push(fragment),this.mineBroken.object3D.add(fragment)},updateFragments:function(){var cutLeftEl=this.cutLeftEl,cutRightEl=this.cutRightEl,partLeftEl=this.partLeftEl,partRightEl=this.partRightEl;return partLeftEl?'mine'===this.data.type?void this.resetMineFragments():void(partLeftEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color],side:'double'}),this.setObjModelFromTemplate(partLeftEl,this.models.dot),partLeftEl.object3D.visible=!1,cutLeftEl.setAttribute('material',{shader:'flat',color:this.data.cutColor,side:'double'}),this.setObjModelFromTemplate(cutLeftEl,this.models.dot),partRightEl.setAttribute('material',{metalness:0.7,roughness:0.1,sphericalEnvMap:'#envmapTexture',emissive:this.materialColor[this.data.color],emissiveIntensity:0.05,color:this.materialColor[this.data.color],side:'double'}),this.setObjModelFromTemplate(partRightEl,this.models.dot),partRightEl.object3D.visible=!1,cutRightEl.setAttribute('material',{shader:'flat',color:this.data.cutColor,side:'double'}),this.setObjModelFromTemplate(cutRightEl,this.models.dot)):void 0},resetMineFragments:function(){if('mine'===this.data.type)for(let i=0,fragment;i<this.mineFragments.length;i++)fragment=this.mineFragments[i],fragment.visible=!1,fragment.position.set(0,0,0),fragment.scale.set(1,1,1),fragment.speed.set(5*Math.random()-2.5,5*Math.random()-2.5,5*Math.random()-2.5)},wrongHit:function(hand){var wrongEl='left'===hand?this.wrongElLeft:this.wrongElRight;wrongEl&&(wrongEl.object3D.position.copy(this.el.object3D.position),wrongEl.object3D.position.y+=0.2,wrongEl.object3D.position.z-=0.5,wrongEl.object3D.visible=!0,wrongEl.emit('beatwrong',null,!0),this.destroyed=!0)},missHit:function(hand){var missEl='left'===hand?this.missElLeft:this.missElRight;missEl&&'mine'!==this.data.type&&(missEl.object3D.position.copy(this.el.object3D.position),missEl.object3D.position.y+=0.2,missEl.object3D.position.z-=0.5,missEl.object3D.visible=!0,missEl.emit('beatmiss',null,!0),AFRAME.utils.getUrlParameter('synctest')&&console.log(this.el.sceneEl.components.song.getCurrentTime()))},destroyBeat:function(){var parallelPlaneMaterial=new THREE.MeshBasicMaterial({color:'#00008b',side:THREE.DoubleSide}),planeMaterial=new THREE.MeshBasicMaterial({color:'grey',side:THREE.DoubleSide}),point1=new THREE.Vector3,point2=new THREE.Vector3,point3=new THREE.Vector3;return function(saberEl){var cutThickness=this.cutThickness=0.02,direction=this.cutDirection,leftBorderInnerPlane=this.leftBorderInnerPlane,leftBorderOuterPlane=this.leftBorderOuterPlane,leftCutPlane=this.leftCutPlane,rightBorderInnerPlane=this.rightBorderInnerPlane,rightBorderOuterPlane=this.rightBorderOuterPlane,rightCutPlane=this.rightCutPlane,trailPoints=saberEl.components.trail.saberTrajectory,coplanarPoint,planeGeometry,planeMesh;if(point1.copy(trailPoints[0].top),point2.copy(trailPoints[0].center),point3.copy(trailPoints[trailPoints.length-1].top),direction.copy(point1).sub(point3),this.partRightEl.object3D.position.set(0,0,0),this.partRightEl.object3D.rotation.set(0,0,0),this.partRightEl.object3D.updateMatrixWorld(),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[0].copy(point1)),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[1].copy(point2)),this.partRightEl.object3D.worldToLocal(this.rightCutPlanePoints[2].copy(point3)),this.partLeftEl.object3D.position.set(0,0,0),this.partLeftEl.object3D.rotation.set(0,0,0),this.partLeftEl.object3D.updateMatrixWorld(),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[0].copy(point3)),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[1].copy(point2)),this.partLeftEl.object3D.worldToLocal(this.leftCutPlanePoints[2].copy(point1)),this.generateCutClippingPlanes(),this.data.debug){coplanarPoint=new THREE.Vector3,planeGeometry=new THREE.PlaneGeometry(4,4,1,1),rightCutPlane.coplanarPoint(coplanarPoint),planeGeometry.lookAt(rightCutPlane.normal),planeGeometry.translate(coplanarPoint.x,coplanarPoint.y,coplanarPoint.z),planeMesh=new THREE.Mesh(planeGeometry,planeMaterial),this.el.sceneEl.setObject3D('rightCutPlane',planeMesh),planeGeometry=new THREE.PlaneGeometry(4,4,1,1),rightBorderOuterPlane.coplanarPoint(coplanarPoint),planeGeometry.lookAt(rightBorderOuterPlane.normal),planeGeometry.translate(coplanarPoint.x,coplanarPoint.y,coplanarPoint.z);const parallelPlaneMesh=new THREE.Mesh(planeGeometry,parallelPlaneMaterial);this.el.sceneEl.setObject3D('planeParallel',parallelPlaneMesh)}this.blockEl.object3D.visible=!1;const partRightMaterial=this.partRightEl.getObject3D('mesh').material;partRightMaterial.clippingPlanes=partRightMaterial.clippingPlanes||[],partRightMaterial.clippingPlanes.length=0,partRightMaterial.clippingPlanes.push(rightCutPlane);const cutRightMaterial=this.cutRightEl.getObject3D('mesh').material;cutRightMaterial.clippingPlanes=cutRightMaterial.clippingPlanes||[],cutRightMaterial.clippingPlanes.length=0,cutRightMaterial.clippingPlanes.push(rightBorderOuterPlane),cutRightMaterial.clippingPlanes.push(rightBorderInnerPlane);const partLeftMaterial=this.partLeftEl.getObject3D('mesh').material;partLeftMaterial.clippingPlanes=partLeftMaterial.clippingPlanes||[],partLeftMaterial.clippingPlanes.length=0,partLeftMaterial.clippingPlanes.push(leftCutPlane);const cutLeftMaterial=this.cutLeftEl.getObject3D('mesh').material;cutLeftMaterial.clippingPlanes=cutLeftMaterial.clippingPlanes||[],cutLeftMaterial.clippingPlanes.length=0,cutLeftMaterial.clippingPlanes.push(leftBorderInnerPlane),cutLeftMaterial.clippingPlanes.push(leftBorderOuterPlane),this.partLeftEl.object3D.visible=!0,this.partRightEl.object3D.visible=!0,this.el.sceneEl.renderer.localClippingEnabled=!0,this.destroyed=!0,this.gravityVelocity=0.1,this.rotationAxis.copy(this.rightCutPlanePoints[0]).sub(this.rightCutPlanePoints[1]),this.returnToPoolTimer=800,auxObj3D.up.copy(rightCutPlane.normal),auxObj3D.lookAt(direction),this.explodeEventDetail.position=this.el.object3D.position,this.explodeEventDetail.rotation=auxObj3D.rotation,this.particles.emit('explode',this.explodeEventDetail,!1)}}(),destroyMine:function(){for(let i=0;i<this.mineFragments.length;i++)this.mineFragments[i].visible=!0;this.blockEl.object3D.visible=!1,this.destroyed=!0,this.gravityVelocity=0.1,this.returnToPoolTimer=800,this.explodeEventDetail.position=this.el.object3D.position,this.explodeEventDetail.rotation=this.randVec,this.mineParticles.emit('explode',this.explodeEventDetail,!1)},initCuttingClippingPlanes:function(){this.leftCutPlanePointsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.rightCutPlanePointsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.rightCutPlane=new THREE.Plane,this.rightBorderOuterPlane=new THREE.Plane,this.rightBorderInnerPlane=new THREE.Plane,this.leftCutPlane=new THREE.Plane,this.leftBorderOuterPlane=new THREE.Plane,this.leftBorderInnerPlane=new THREE.Plane},generateCutClippingPlanes:function(){var leftBorderInnerPlane=this.leftBorderInnerPlane,leftBorderOuterPlane=this.leftBorderOuterPlane,leftCutPlane=this.leftCutPlane,leftCutPlanePointsWorld=this.leftCutPlanePointsWorld,partLeftEl=this.partLeftEl,partRightEl=this.partRightEl,rightBorderInnerPlane=this.rightBorderInnerPlane,rightBorderOuterPlane=this.rightBorderOuterPlane,rightCutPlane=this.rightCutPlane,rightCutPlanePointsWorld=this.rightCutPlanePointsWorld;partRightEl.object3D.updateMatrixWorld(),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[0].copy(this.rightCutPlanePoints[0])),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[1].copy(this.rightCutPlanePoints[1])),partRightEl.object3D.localToWorld(rightCutPlanePointsWorld[2].copy(this.rightCutPlanePoints[2])),partLeftEl.object3D.updateMatrixWorld(),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[0].copy(this.leftCutPlanePoints[0])),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[1].copy(this.leftCutPlanePoints[1])),partLeftEl.object3D.localToWorld(leftCutPlanePointsWorld[2].copy(this.leftCutPlanePoints[2])),rightCutPlane.setFromCoplanarPoints(rightCutPlanePointsWorld[0],rightCutPlanePointsWorld[1],rightCutPlanePointsWorld[2]),rightBorderOuterPlane.set(rightCutPlane.normal,rightCutPlane.constant+this.cutThickness),leftCutPlane.setFromCoplanarPoints(leftCutPlanePointsWorld[0],leftCutPlanePointsWorld[1],leftCutPlanePointsWorld[2]),leftBorderOuterPlane.set(leftCutPlane.normal,leftCutPlane.constant+this.cutThickness),rightBorderInnerPlane.setFromCoplanarPoints(rightCutPlanePointsWorld[2],rightCutPlanePointsWorld[1],rightCutPlanePointsWorld[0]),leftBorderInnerPlane.setFromCoplanarPoints(leftCutPlanePointsWorld[2],leftCutPlanePointsWorld[1],leftCutPlanePointsWorld[0])},returnToPool:function(force){(this.backToPool||force)&&this.el.sceneEl.components[this.poolName].returnEntity(this.el)},checkCollisions:function(){const cutDirection=this.data.cutDirection,saberColors=this.saberColors,saberEls=this.saberEls,hitBoundingBox=this.hitColliderEl&&this.hitBoundingBox.setFromObject(this.hitColliderEl.getObject3D('mesh')),beatBoundingBox=this.beatBoundingBox.setFromObject(this.blockEl.getObject3D('mesh'));var wrongHandHit;for(let i=0;i<saberEls.length;i++){let saberBoundingBox=saberEls[i].components['saber-controls'].boundingBox,saberControls,maxAngle;if(!saberBoundingBox)break;const hand=saberEls[i].getAttribute('saber-controls').hand;if(saberBoundingBox.intersectsBox(beatBoundingBox)){if(this.el.emit(`beatcollide${hand}`,null,!0),this.el.parentNode.components['beat-hit-sound'].playSound(this.el),'mine'===this.data.type){this.el.emit('minehit',null,!0),this.destroyMine();break}if(this.destroyBeat(saberEls[i]),saberEls[i].components['saber-controls'].swinging&&this.data.color===saberColors[hand]){if(this.hitSaberEl=saberEls[i],this.hitSaberEl.addEventListener('strokeend',this.onEndStroke,ONCE),saberControls=saberEls[i].components['saber-controls'],this.hitHand=hand,saberControls.maxAnglePlaneX=0,saberControls.maxAnglePlaneY=0,saberControls.maxAnglePlaneXY=0,'arrow'===this.data.type){if(saberControls.updateStrokeDirection(),!saberControls.strokeDirection[this.data.cutDirection]){this.wrongHit(hand);break}maxAngle='up'===cutDirection||'down'===cutDirection?saberControls.maxAnglePlaneX:'left'===cutDirection||'right'===cutDirection?saberControls.maxAnglePlaneY:saberControls.maxAnglePlaneXY}else maxAngle=_Mathmax4(saberControls.maxAnglePlaneX,saberControls.maxAnglePlaneY,saberControls.maxAnglePlaneXY);wrongHandHit=void 0,this.angleBeforeHit=maxAngle}else wrongHandHit=hand;break}wrongHandHit&&this.wrongHit(wrongHandHit)}},onEndStroke:function(){var cutDirection=this.data.cutDirection,hitEventDetail=this.hitEventDetail,saberControls=this.hitSaberEl.components['saber-controls'],maxAngle;const saberRotation=3.14/12;maxAngle='up'===cutDirection||'down'===cutDirection?saberControls.maxAnglePlaneX:'left'===cutDirection||'right'===cutDirection?saberControls.maxAnglePlaneY:saberControls.maxAnglePlaneXY;const angleBeforeHit=_Mathmax4(0,180*(this.angleBeforeHit-saberRotation)/_MathPI2),angleAfterHit=_Mathmax4(0,180*(maxAngle-saberRotation)/_MathPI2);let score=0;score+=85<=angleBeforeHit?70:70*(angleBeforeHit/80),score+=60<=angleAfterHit?30:30*(angleAfterHit/60),hitEventDetail.score=score,this.el.emit('beathit',hitEventDetail,!0),this.el.sceneEl.emit('textglowbold',null,!1);let beatScorePool;60>score?beatScorePool=SCORE_POOL.OK:80>score?beatScorePool=SCORE_POOL.GOOD:100>score?beatScorePool=SCORE_POOL.GREAT:(beatScorePool=SCORE_POOL.SUPER,this.superCuts[this.superCutIdx].components.supercutfx.createSuperCut(this.el.object3D.position),this.superCutIdx=(this.superCutIdx+1)%this.superCuts.length);const scoreEl=this.el.sceneEl.components[beatScorePool].requestEntity();scoreEl&&(scoreEl.object3D.position.copy(this.el.object3D.position),scoreEl.play(),scoreEl.emit('beatscorestart',null,!1))},tockDestroyed:function(){var leftCutNormal=new THREE.Vector3,leftRotation=0,rightCutNormal=new THREE.Vector3,rightRotation=0,rotationStep=2*_MathPI2/150,fragment;return function(timeDelta){if(this.gravityVelocity=getGravityVelocity(this.gravityVelocity,timeDelta),this.el.object3D.position.y+=this.gravityVelocity*(timeDelta/1e3),'mine'==this.data.type){for(var i=0;i<this.mineFragments.length;i++)(fragment=this.mineFragments[i],!!fragment.visible)&&(fragment.position.addScaledVector(fragment.speed,timeDelta/1e3),fragment.scale.multiplyScalar(0.97),0.1>fragment.scale.y&&(fragment.visible=!1));return}rightCutNormal.copy(this.rightCutPlane.normal).multiplyScalar(DESTROYED_SPEED*(timeDelta/500)),rightCutNormal.y=0,this.partRightEl.object3D.position.add(rightCutNormal),this.partRightEl.object3D.setRotationFromAxisAngle(this.rotationAxis,rightRotation),rightRotation=rightRotation>=2*_MathPI2?0:rightRotation+rotationStep,leftCutNormal.copy(this.leftCutPlane.normal).multiplyScalar(DESTROYED_SPEED*(timeDelta/500)),leftCutNormal.y=0,this.partLeftEl.object3D.position.add(leftCutNormal),this.partLeftEl.object3D.setRotationFromAxisAngle(this.rotationAxis,leftRotation),leftRotation=leftRotation>=2*_MathPI2?0:leftRotation+rotationStep,this.generateCutClippingPlanes(),this.returnToPoolTimer-=timeDelta,this.backToPool=0>=this.returnToPoolTimer}}(),setObjModelFromTemplate:function(){const geometries={};return function(el,templateId){if(!geometries[templateId]){const templateEl=document.getElementById(templateId);if(templateEl.getObject3D('mesh'))geometries[templateId]=templateEl.getObject3D('mesh').children[0].geometry;else return void templateEl.addEventListener('model-loaded',()=>{geometries[templateId]=templateEl.getObject3D('mesh').children[0].geometry,this.setObjModelFromTemplate(el,templateId)})}el.getObject3D('mesh')||el.setObject3D('mesh',new THREE.Mesh),el.getObject3D('mesh').geometry=geometries[templateId]}}()})},function(){AFRAME.registerComponent('console-shortcuts',{play:function(){window.$=val=>document.querySelector(val),window.$$=val=>document.querySelectorAll(val),window.$$$=val=>document.querySelector(`[${val}]`).getAttribute(val),window.$$$$=val=>document.querySelector(`[${val}]`).components[val],window.scene=this.el,window.state=this.el.systems.state.state}})},function(){AFRAME.registerComponent('copy-texture',{dependencies:['geometry','material'],schema:{from:{type:'selector'}},init:function(){const data=this.data;data.from.addEventListener('materialtextureloaded',()=>{this.copyTexture()}),this.copyTexture()},copyTexture:function(){const el=this.el,target=this.data.from,material=el.getObject3D('mesh').material;target.getObject3D('mesh')&&(material.map=target.getObject3D('mesh').material.map,material.map&&(material.map.needsUpdate=!0,material.needsUpdate=!0))}})},function(){AFRAME.registerComponent('cursor-laser',{dependencies:['geometry'],schema:{enabled:{default:!0}},init:function(){const el=this.el;this.saberEl=this.el.closest('.saber');const geometry=this.el.getAttribute('geometry');el.object3D.position.z=-1*geometry.height/2,this.originalSize=geometry.height,this.currentLength=geometry.height},update:function(){this.el.object3D.visible=this.data.enabled},tick:function(){const el=this.el;if(this.data.enabled){const cursor=this.saberEl.components.cursor;if(cursor){const intersectedEl=cursor.intersectedEl;if(!intersectedEl)return el.object3D.position.z=-25,el.object3D.scale.x=0.75,el.getObject3D('mesh').scale.y=50,void(this.currentLength=1);const intersection=this.saberEl.components.raycaster.intersections[0];intersection&&(el.object3D.scale.x=1,el.object3D.position.z=-intersection.distance/2,el.getObject3D('mesh').scale.y=this.currentLength=intersection.distance)}}}})},function(){AFRAME.registerComponent('cursor-mesh',{schema:{active:{default:!0},cursorEl:{type:'selector'}},init:function(){this.scenePivotEl=document.getElementById('scenePivot')},update:function(){this.el.object3D.visible=this.data.active},tick:function(){var cursorEl=this.data.cursorEl,el=this.el,scenePivotEl=this.scenePivotEl,cursor,intersection,intersectedEl;if(this.data.active&&(cursor=cursorEl.components.cursor,!!cursor)){if(intersectedEl=cursorEl.components.cursor.intersectedEl,intersectedEl)el.object3D.visible=!0;else return void(el.object3D.visible=!1);intersection=cursorEl.components.raycaster.getIntersection(intersectedEl),intersection&&(el.object3D.position.copy(intersection.point),scenePivotEl&&el.object3D.rotation.copy(scenePivotEl.object3D.rotation))}}})},function(){AFRAME.registerComponent('debug-beat-loader',{dependencies:['beat-loader'],schema:{beatEnabled:{default:!1},stageEnabled:{default:!1}},init:function(){this.beatLoader=this.el.components['beat-loader'],this.selectedBeat={color:'red',position:'middleCenterLeft',type:'arrow',orientation:'up'},this.beats={},this.onKeyDown=this.onKeyDown.bind(this),(this.data.stageEnabled||AFRAME.utils.getUrlParameter('debugstage'))&&this.addDebugStageControls(),(this.data.beatEnabled||'gameplay'===AFRAME.utils.getUrlParameter('debugstate').trim())&&(window.addEventListener('keydown',this.onKeyDown),this.addDebugBeatControls())},spawn:function(){var self=this;Object.keys(this.beats).forEach(function(key){self.generateBeat(self.beats[key])})},generateBeat:function(beatInfo){var type;return'wall'===beatInfo.type?void this.generateWall(beatInfo):void(type='mine'===beatInfo.type?3:'red'===beatInfo.color?0:1,this.beatLoader.generateBeat({_lineIndex:this.beatLoader.positionHumanized[beatInfo.position].index,_lineLayer:this.beatLoader.positionHumanized[beatInfo.position].layer,_cutDirection:'dot'===beatInfo.type?8:this.beatLoader.orientationsHumanized.indexOf(beatInfo.orientation),_type:type}))},generateWall:function(wallInfo){this.beatLoader.bpm=90,this.beatLoader.generateWall({_lineIndex:this.beatLoader.positionHumanized[wallInfo.position].index,_width:1,_duration:3})},onKeyDown:function(event){const keyCode=event.keyCode;switch(keyCode){case 32:{this.spawn();break}}},addDebugBeatControls:function(){function addMenu(name){const menuDiv=document.createElement('div');return menuDiv.id=name,menuDiv.style.marginBottom='20px',menuDiv.style.width='500px',menuDiv.style.display='inline-block',parentDiv.appendChild(menuDiv),menuDiv}function addButton(text,containerEl,clickHandler){const div=document.createElement('div');return div.classList.add('button'),div.id=text,div.style.width='100px',div.style.height='30px',div.style.background='#000',div.style.color='#fff',div.style.zIndex=999999999,div.style.padding='5px',div.style.margin='5px',div.style.font='14px sans-serif',div.style.textAlign='center',div.style.lineHeight='30px',div.style.cursor='pointer',div.style.display='inline-block',div.innerHTML=text,containerEl.appendChild(div),div.addEventListener('click',clickHandler||function onClick(){const buttons=div.parentElement.querySelectorAll('.button');for(let i=0;i<buttons.length;i++)buttons[i].style.background='#000';div.style.background='#66f',self.selectedBeat[div.parentElement.id]=this.id,self['selected'+div.parentElement.id.charAt(0).toUpperCase()+div.parentElement.id.slice(1)+'El']=this}),div}const parentDiv=document.createElement('div'),self=this;parentDiv.style.position='absolute',parentDiv.style.right='0',parentDiv.style.top='0',parentDiv.style.padding='10px',parentDiv.style.width='500px',parentDiv.style.height='600px',document.body.appendChild(parentDiv),function addTypeBeatMenu(){const menuDiv=addMenu('type');addButton('arrow',menuDiv),addButton('dot',menuDiv),addButton('mine',menuDiv),addButton('wall',menuDiv),parentDiv.appendChild(menuDiv)}(),function addColorBeatMenu(){const menuDiv=addMenu('color');addButton('blue',menuDiv),addButton('red',menuDiv),parentDiv.appendChild(menuDiv)}(),function addOrientationMenu(){const menuDiv=addMenu('orientation');addButton('top',menuDiv),addButton('left',menuDiv),addButton('right',menuDiv),addButton('down',menuDiv),parentDiv.appendChild(menuDiv)}(),function setBeatButton(){var buttonEl=addButton('Set Beat',parentDiv,function(){var color='mine'===self.selectedBeat.type?'':' '+self.selectedBeat.color,orientation='arrow'===self.selectedBeat.type?' '+self.selectedBeat.orientation:'';self.selectedBeat={position:self.selectedBeat.position,type:self.selectedBeat.type,orientation:self.selectedBeat.orientation,color:self.selectedBeat.color};self.selectedPositionEl&&(self.selectedPositionEl.innerHTML=self.selectedBeat.type+color+orientation,self.beats[self.selectedPositionEl.id]={position:self.selectedBeat.position,type:self.selectedBeat.type,orientation:self.selectedBeat.orientation,color:self.selectedBeat.color})});buttonEl.style.width='460px',buttonEl.style.bottomMargin='10px'}(),function addBeatPositionMenu(){const menuDiv=addMenu('position');addButton('topLeft',menuDiv),addButton('topCenterLeft',menuDiv),addButton('topCenterRight',menuDiv),addButton('topRight',menuDiv),addButton('middleLeft',menuDiv),addButton('middleCenterLeft',menuDiv),addButton('middleCenterRight',menuDiv),addButton('middleRight',menuDiv),addButton('bottomLeft',menuDiv),addButton('bottomCenterLeft',menuDiv),addButton('bottomCenterRight',menuDiv),addButton('bottomRight',menuDiv)}(),function addGenerateButton(){const buttonEl=addButton('Spawn (Space Bar)',parentDiv,()=>{self.spawn()});buttonEl.style.width='460px',buttonEl.style.bottomMargin='10px'}()},addDebugStageControls:function(){var currControl=0;const addControl=(i,name,type)=>{const div=document.createElement('div');div.style.position='absolute',div.id='stagecontrol'+i,div.style.width='100px',div.style.height='30px',div.style.top='element'===type?'20px':'70px',div.style.background='#000',div.style.color='#fff',div.style.zIndex=999999999,div.style.padding='5px',div.style.font='14px sans-serif',div.style.textAlign='center',div.style.cursor='pointer',div.style.left=20+120*i+'px',div.innerHTML=name,'element'===type?div.addEventListener('click',()=>{document.getElementById('stagecontrol'+currControl).style.background='#000',div.style.background='#66f',currControl=i}):div.addEventListener('click',()=>{this.beatLoader.generateEvent({_type:currControl,_value:i})}),document.body.appendChild(div)};['sky','tunnelNeon','leftStageLasers','rightStageLasers','floor'].forEach((id,i)=>{addControl(i,id,'element')}),['off','blue','blue','bluefade','','red','red','redfade'].forEach((id,i)=>{addControl(i,id,'value')})}})},function(){AFRAME.registerComponent('debug-controller',{init:function(){var primaryHand,secondaryHand;AFRAME.utils.getUrlParameter('debug')&&(console.log('%c debug-controller enabled ','background: #111; color: red'),this.isCloning=!1,this.isDeleting=!1,this.isTriggerDown=!1,window.addEventListener('mousemove',this.onMouseMove.bind(this)),primaryHand=document.getElementById('rightHand'),secondaryHand=document.getElementById('leftHand'),window.addEventListener('click',evt=>{evt.isTrusted&&(primaryHand.emit('triggerdown'),primaryHand.emit('triggerup'))}),'oculus'===AFRAME.utils.getUrlParameter('debug')?(primaryHand.emit('controllerconnected',{name:'oculus-touch-controls'}),secondaryHand.emit('controllerconnected',{name:'oculus-touch-controls'}),primaryHand.setAttribute('controller','controllerType','oculus-touch-controls'),secondaryHand.setAttribute('controller','controllerType','oculus-touch-controls')):(primaryHand.emit('controllerconnected',{name:'vive-controls'}),secondaryHand.emit('controllerconnected',{name:'vive-controls'}),primaryHand.setAttribute('controller','controllerType','vive-controls'),secondaryHand.setAttribute('controller','controllerType','vive-controls')),this.el.emit('enter-vr',null,!1),document.addEventListener('keydown',evt=>{var primaryPosition,primaryRotation,secondaryPosition,secondaryRotation;return evt.shiftKey?32===evt.keyCode?void(this.isTriggerDown?(primaryHand.emit('triggerup'),this.isTriggerDown=!1):(primaryHand.emit('triggerdown'),this.isTriggerDown=!0)):81===evt.keyCode?void(this.isSecondaryTriggerDown?(secondaryHand.emit('triggerup'),this.isSecondaryTriggerDown=!1):(secondaryHand.emit('triggerdown'),this.isSecondaryTriggerDown=!0)):void(78===evt.keyCode&&(this.secondaryGripDown?(secondaryHand.emit('gripup'),this.secondaryGripDown=!1):(secondaryHand.emit('gripdown'),this.secondaryGripDown=!0)),77===evt.keyCode&&(this.primaryGripDown?(primaryHand.emit('gripup'),this.primaryGripDown=!1):(primaryHand.emit('gripdown'),this.primaryGripDown=!0)),49===evt.keyCode&&secondaryHand.emit('menudown'),evt.ctrlKey?(secondaryPosition=secondaryHand.getAttribute('position'),72===evt.keyCode&&(secondaryPosition.x-=0.01),74===evt.keyCode&&(secondaryPosition.y-=0.01),75===evt.keyCode&&(secondaryPosition.y+=0.01),76===evt.keyCode&&(secondaryPosition.x+=0.01),(59===evt.keyCode||186===evt.keyCode)&&(secondaryPosition.z-=0.01),222===evt.keyCode&&(secondaryPosition.z+=0.01),secondaryHand.setAttribute('position',AFRAME.utils.clone(secondaryPosition))):(primaryPosition=primaryHand.getAttribute('position'),72===evt.keyCode&&(primaryPosition.x-=0.01),74===evt.keyCode&&(primaryPosition.y-=0.01),75===evt.keyCode&&(primaryPosition.y+=0.01),76===evt.keyCode&&(primaryPosition.x+=0.01),(59===evt.keyCode||186===evt.keyCode)&&(primaryPosition.z-=0.01),222===evt.keyCode&&(primaryPosition.z+=0.01),primaryHand.setAttribute('position',AFRAME.utils.clone(primaryPosition))),evt.ctrlKey?(secondaryRotation=secondaryHand.getAttribute('rotation'),89===evt.keyCode&&(secondaryRotation.x-=10),79===evt.keyCode&&(secondaryRotation.x+=10),85===evt.keyCode&&(secondaryRotation.y-=10),73===evt.keyCode&&(secondaryRotation.y+=10),secondaryHand.setAttribute('rotation',AFRAME.utils.clone(secondaryRotation))):(primaryRotation=primaryHand.getAttribute('rotation'),89===evt.keyCode&&(primaryRotation.x-=10),79===evt.keyCode&&(primaryRotation.x+=10),85===evt.keyCode&&(primaryRotation.y-=10),73===evt.keyCode&&(primaryRotation.y+=10),primaryHand.setAttribute('rotation',AFRAME.utils.clone(primaryRotation)))):void 0}))},play:function(){var primaryHand,secondaryHand;this.bounds=document.body.getBoundingClientRect();AFRAME.utils.getUrlParameter('debug')&&(primaryHand=document.getElementById('rightHand'),secondaryHand=document.getElementById('leftHand'),secondaryHand.object3D.position.set(-0.2,1.5,-0.5),primaryHand.object3D.position.set(0.2,1.5,-0.5),secondaryHand.setAttribute('rotation',{x:35,y:0,z:0}))},onMouseMove:function(){const direction=new THREE.Vector3,mouse=new THREE.Vector2,cameraPos=new THREE.Vector3;return function(evt){const bounds=this.bounds,camera=this.el.sceneEl.camera,left=evt.clientX-bounds.left,top=evt.clientY-bounds.top;mouse.x=2*(left/bounds.width)-1,mouse.y=2*(-top/bounds.height)-1,document.getElementById('camera').object3D.getWorldPosition(cameraPos),direction.set(mouse.x,mouse.y,0.5).unproject(camera).sub(cameraPos).normalize();const handPos=document.getElementById('rightHand').object3D.position,distance=-cameraPos.z/direction.z;camera.getWorldPosition(handPos).add(direction.multiplyScalar(distance)),handPos.y+=0.8}}()})},function(){AFRAME.registerComponent('debug-cursor',{init:function(){},log:function(event,intersectedEl,color){intersectedEl.id?console.log(`%c[${event}] ${intersectedEl.id}`,`color: ${color}`):(console.log(`%c[${event}]`,`color: ${color}`),console.log(intersectedEl))}})},function(){AFRAME.registerComponent('debug-song-time',{dependencies:['song'],init:function(){AFRAME.utils.getUrlParameter('debug-song-time')&&setInterval(()=>{console.log(this.el.components.song.getCurrentTime())},250)}})},function(){AFRAME.registerComponent('debug-state',{play:function(){const flags=AFRAME.utils.getUrlParameter('debugstate').trim();flags&&setTimeout(()=>{flags.split(',').forEach(flag=>{this.el.sceneEl.emit(`debug${flag.trim()}`,null,!1)})},500)}})},function(module,__webpack_exports__,__webpack_require__){'use strict';function createGeometry(color){colorHelper.set(color);const geometries=[{height:0.1831,radius:0.0055},{height:0.1832,radius:0.0065},{height:0.1833,radius:0.0075},{height:0.1834,radius:0.0085}].map((cylinderData,i)=>{const cylinder=new THREE.CylinderBufferGeometry(cylinderData.radius,cylinderData.radius,cylinderData.height),colorArray=[];for(let i=0;i<cylinder.attributes.position.array.length;i+=3)colorArray[i]=colorHelper.r,colorArray[i+1]=colorHelper.g,colorArray[i+2]=colorHelper.b;cylinder.addAttribute('color',new THREE.Float32BufferAttribute(colorArray,3));const alphaUvs=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__.getGridUvs)(0,i,1,4),uvs=cylinder.attributes.uv.array;for(let i=0;i<uvs.length;i+=6)uvs[i]=alphaUvs[0].x,uvs[i+1]=alphaUvs[0].y,uvs[i+2]=alphaUvs[1].x,uvs[i+3]=alphaUvs[1].y,uvs[i+4]=alphaUvs[2].x,uvs[i+5]=alphaUvs[2].y;return cylinder.attributes.uv.needsUpdate=!0,cylinder}),geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(geometries);return geometry}Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__=__webpack_require__(11),__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_aframe_atlas_uvs_component__);__webpack_require__(12);const colorHelper=new THREE.Color,geometry=createGeometry(),material=new THREE.MeshBasicMaterial({alphaMap:function createAlphaMap(){const alphaCanvas=document.createElement('canvas');alphaCanvas.height=1,alphaCanvas.width=4;const ctx=alphaCanvas.getContext('2d');return ctx.fillStyle='rgb(10, 10, 10)',ctx.fillRect(0,0,1,1),ctx.fillStyle='rgb(15, 15, 15)',ctx.fillRect(1,0,1,1),ctx.fillStyle='rgb(23, 23 ,23)',ctx.fillRect(2,0,1,1),ctx.fillStyle='rgb(28, 28, 28)',ctx.fillRect(3,0,1,1),setTimeout(()=>{alphaCanvas.style.position='fixed',alphaCanvas.style.zIndex=999999999999,alphaCanvas.style.left=0,alphaCanvas.style.top=0,document.body.appendChild(alphaCanvas)},1e3),new THREE.CanvasTexture(alphaCanvas)}(),transparent:!0,vertexColors:THREE.VertexColors});AFRAME.registerComponent('fake-glow',{schema:{color:{default:'#FFF'}},play:function(){this.el.setObject3D('mesh',new THREE.Mesh(createGeometry(this.data.color),material))}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(6),HIT_COLOR=new THREE.Color(COLORS.NEON_RED),BORDER_COLOR=new THREE.Color(COLORS.NEON_BLUE);AFRAME.registerShader('floorShader',{schema:{normalMap:{type:'map',is:'uniform'},envMap:{type:'map',is:'uniform'},hitRight:{type:'vec3',is:'uniform',default:{x:0,y:1,z:0}},hitLeft:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 color;
    uniform sampler2D normalMap;
    uniform sampler2D envMap;
    uniform vec3 hitRight;
    uniform vec3 hitLeft;

    #define HIT_COLOR vec3(${HIT_COLOR.r}, ${HIT_COLOR.g}, ${HIT_COLOR.b})
    #define BORDER_COLOR vec3(${BORDER_COLOR.r}, ${BORDER_COLOR.g}, ${BORDER_COLOR.b})

    vec3 drawCircle(vec3 p, vec3 center, float radius, float edgeWidth, vec3 color) {
      return color*(1.0-smoothstep(radius, radius+edgeWidth, length(p-center)));
    }

    void main() {
      vec2 p = uvs.xy - 0.5;
      vec3 border = vec3(smoothstep(0.49, 0.495, abs(p.x)) + smoothstep(0.49, 0.495, abs(p.y)));
      border += BORDER_COLOR * (smoothstep(0.475, 0.495, abs(p.x)) + smoothstep(0.475, 0.495, abs(p.y))) * .7;
      p*= 4.0;

      vec3 hitColor = HIT_COLOR;
      vec3 hit = vec3(0.0);

      hit += drawCircle(worldPos, hitRight, 0.04, 0.05, hitColor);
      hit += drawCircle(worldPos, hitRight, 0.02, 0.03, vec3(0.7, 0.7, 0.7));
      hit += drawCircle(worldPos, hitLeft, 0.04, 0.05, hitColor);
      hit += drawCircle(worldPos, hitLeft, 0.02, 0.03, vec3(0.7, 0.7, 0.7));

      vec3 normal = normalize(texture2D(normalMap, uvs).xyz);

      // environment reflection
      vec3 reflectVec = normalize(reflect(normalize(worldPos - cameraPosition), normal));
      //vec3 reflectView = normalize((viewMatrix * vec4(reflectVec, 0.0)).xyz + vec3(0.0, 0.0, 1.0));

      vec3 ref = texture2D(envMap, reflectVec.xy * vec2(0.3, 1.0) + vec2(0.75, -cameraPosition.z * 0.05)).xyz * 0.14;

      gl_FragColor = vec4(ref + border + hit, 1.0);
    }
  `})},function(){AFRAME.registerComponent('gameover',{schema:{isGameOver:{default:!1}},init:function(){this.beatContainer=document.getElementById('beatContainer'),this.gameOverEls=document.querySelectorAll('[animation__gameover]')},update:function(oldData){this.data;!oldData.isGameOver&&this.data.isGameOver&&(this.triggerAnimations(),this.countDown=1),oldData.isGameOver&&!this.data.isGameOver&&this.reset()},tick:function(time,delta){!this.data.isGameOver||0<=this.countDown&&(this.beatContainer.object3D.position.z=1.5*-Math.pow(1-this.countDown,2),this.countDown-=delta/1e3)},reset:function(){this.beatContainer.object3D.position.z=0,this.el.sceneEl.setAttribute('stage-colors','color','blue')},triggerAnimations:function(){for(let i=0;i<this.gameOverEls.length;i++)this.gameOverEls[i].emit('gameover',null,!1);this.el.emit('textglowoff',null,!1),this.el.emit('bgcolorgameover',null,!1)}})},function(){let i=0;AFRAME.registerComponent('gpu-preloader',{dependencies:['materials'],play:function(){this.preloadMineEnvMaps(),setTimeout(()=>{this.preloadAtlas(),this.preloadLogo(),this.preloadBeatEnvMap(),this.preloadCutParticles(),this.preloadKeyboard(),this.preloadPlayButton(),this.preloadSearchPrevPage(),this.preloadGenres()},1e3)},preloadAtlas:function(){const stage=document.querySelector('#stageObj');this.preloadTexture(stage.getObject3D('mesh').children[0].material.uniforms.src.value)},preloadLogo:function(){const logo=document.querySelector('#logoBody');this.preloadTexture(logo.getObject3D('mesh').children[0].material.uniforms.src.value)},preloadBeamMap:function(){const beams=document.querySelector('[beams]');this.preloadTexture(beams.components.beams.texture)},preloadBeatEnvMap:function(){const beat=document.querySelector('#beatContainer [mixin~="beat"]');beat.object3D.traverse(node=>{node.material&&(node.material.envMap&&this.preloadTexture(node.material.envMap),node.material.map&&this.preloadTexture(node.material.map))})},preloadCutParticles:function(){const particles=document.querySelector('#saberParticles');this.preloadTexture(particles.components.particleplayer.material.map)},preloadKeyboard:function(){const keyboard=document.getElementById('keyboard').components['super-keyboard'];this.preloadTexture(keyboard.kbImg.getObject3D('mesh').material.map),this.preloadTexture(keyboard.keyColorPlane.getObject3D('mesh').material.map)},preloadMineEnvMaps:function(){const stageColors=this.el.sceneEl.components['stage-colors'];this.el.sceneEl.addEventListener('mineredenvmaploaded',()=>{this.preloadTexture(stageColors.mineEnvMap.red)}),this.el.sceneEl.addEventListener('mineblueenvmaploaded',()=>{this.preloadTexture(stageColors.mineEnvMap.blue)})},preloadMissMap:function(){const miss=document.querySelector('#missLeft');this.preloadTexture(miss.getObject3D('mesh').material.map)},preloadPlayButton:function(){const playButton=document.querySelector('#playButton');this.preloadTexture(playButton.getObject3D('mesh').material.map)},preloadSearchPrevPage:function(){const prevPage=document.querySelector('#searchPrevPage');this.preloadTexture(prevPage.children[0].getObject3D('mesh').material.map)},preloadWallMap:function(){const wall=document.querySelector('a-entity[wall]');this.preloadTexture(wall.getObject3D('mesh').material.uniforms.tex.value),this.preloadTexture(wall.getObject3D('mesh').material.uniforms.env.value)},preloadWrongMap:function(){const wrong=document.querySelector('#wrongLeft');this.preloadTexture(wrong.getObject3D('mesh').material.map)},preloadGenres:function(){const genres=document.querySelector('.genreIcon');this.preloadTexture(genres.getObject3D('mesh').material.map)},preloadTexture:function(texture){return texture&&texture.image?texture.image.complete?void this.el.renderer.setTexture2D(texture,i++%8):void console.warn('[gpu-preloader] Error preloading, image not loaded',texture):void console.warn('[gpu-preloader] Error preloading texture',texture)}})},function(){AFRAME.registerComponent('hack',{play:function(){setTimeout(()=>{this.el.sceneEl.enterVR()},3e3)}})},function(){const events=['triggerdown','gripdown','abuttondown','bbuttondown','xbuttondown','ybuttondown','trackpaddown'];AFRAME.registerComponent('hand-swapper',{schema:{enabled:{default:!1}},init:function(){this.swapHand=this.swapHand.bind(this),events.forEach(event=>{this.el.addEventListener(event,this.swapHand)})},swapHand:function(){this.data.enabled&&this.el.sceneEl.emit('activehandswap',null,!1)}})},function(){AFRAME.registerComponent('haptics-saber',{init:function(){const el=this.el;this.isColliding=!1,this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),100),el.setAttribute('haptics__saber',{dur:100,force:0.075}),el.addEventListener('mouseenter',evt=>{if(evt.detail&&evt.detail.intersectedEl){const intersectedEl=evt.detail.intersectedEl;return intersectedEl.classList.contains('blade')&&intersectedEl!==el?void(this.isColliding=!0,this.el.components.haptics__saber.pulse()):void(this.isColliding=!1)}}),el.addEventListener('mouseleave',()=>{this.isColliding=!1})},tick:function(){this.isColliding&&this.el.components.haptics__saber.pulse()}})},function(){AFRAME.registerComponent('haptics-wall',{init:function(){const el=this.el;this.isHittingWall=!1,el.setAttribute('haptics__wall',{dur:50,force:0.075}),this.checkIfHittingWall=this.checkIfHittingWall.bind(this),el.addEventListener('mouseenter',this.checkIfHittingWall),el.addEventListener('mouseleave',this.checkIfHittingWall),this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),50)},checkIfHittingWall:function(){const intersectedEls=this.el.components.raycaster__game.intersectedEls;this.isHittingWall=!1;for(let i=0;i<intersectedEls.length;i++)if(intersectedEls[i].components.wall)return void(this.isHittingWall=!0)},tick:function(){this.isHittingWall&&this.el.components.haptics__wall.pulse()}})},function(){AFRAME.registerComponent('history',{schema:{challengeId:{type:'string'},songName:{type:'string'},songSubName:{type:'string'}},update:function(){const data=this.data;history.pushState('',data.songName,updateQueryParam(window.location.href,'challenge',data.challengeId)),document.title=`Super Saber - ${data.songName}`}})},function(){AFRAME.registerComponent('intro-song',{schema:{isPlaying:{default:!0},isSearching:{default:!1}},init:function(){this.analyserEl=document.getElementById('audioAnalyser'),this.audio=document.getElementById('introSong'),this.timeout=null},update:function(oldData){const audio=this.audio;this.el.sceneEl.isPlaying&&(oldData.isSearching||!this.data.isSearching)&&(!oldData.isPlaying&&this.data.isPlaying&&(this.analyserEl.components.audioanalyser.resumeContext(),this.analyserEl.setAttribute('audioanalyser','src',audio),this.fadeInAudio()),oldData.isPlaying&&!this.data.isPlaying&&audio.pause())},pause:function(){this.audio.pause()},play:function(){this.fadeInAudio()},fadeInAudio:function(){if(!AFRAME.utils.getUrlParameter('mute')){const context=this.analyserEl.components.audioanalyser.context,gainNode=this.analyserEl.components.audioanalyser.gainNode;gainNode.gain.setValueAtTime(0,context.currentTime),this.audio.play(),gainNode.gain.linearRampToValueAtTime(0.5,context.currentTime+0.5)}}})},function(){AFRAME.registerComponent('keyboard-raycastable',{dependencies:['super-keyboard'],schema:{condition:{default:''}},play:function(){this.el.components['super-keyboard'].kbImg.setAttribute('bind-toggle__raycastable',this.data.condition)}})},function(module,exports,__webpack_require__){const firebase=__webpack_require__(140);__webpack_require__(141);AFRAME.registerComponent('leaderboard',{schema:{apiKey:{type:'string'},authDomain:{type:'string'},databaseURL:{type:'string'},projectId:{type:'string'},storageBucket:{type:'string'},messagingSenderId:{type:'string'},challengeId:{default:''},menuSelectedChallengeId:{default:''},isVictory:{default:!1}},init:function(){this.qualifyingIndex=void 0,this.scores=[],this.eventDetail={scores:this.scores},this.addEventDetail={scoreData:void 0,index:void 0},this.username=localStorage.getItem('supersaberusername')||'Super Zealot',this.el.addEventListener('leaderboardusername',evt=>{this.username=evt.detail.value,localStorage.setItem('supersaberusername',this.username)}),this.el.addEventListener('leaderboardsubmit',this.addScore.bind(this))},update:function(oldData){!firebase.apps.length&&this.data.apiKey&&(firebase.initializeApp({apiKey:this.data.apiKey,authDomain:this.data.authDomain,databaseURL:this.data.databaseURL,projectId:this.data.projectId,storageBucket:this.data.storageBucket,messagingSenderId:this.data.messagingSenderId}),this.firestore=firebase.firestore(),this.firestore.settings({timestampsInSnapshots:!0}),this.db=this.firestore.collection('scores')),!oldData.isVictory&&this.data.isVictory&&this.checkLeaderboardQualify(),this.data.menuSelectedChallengeId&&oldData.menuSelectedChallengeId!==this.data.menuSelectedChallengeId&&this.fetchScores(this.data.menuSelectedChallengeId),this.data.challengeId&&oldData.challengeId!==this.data.challengeId&&this.fetchScores(this.data.challengeId)},addScore:function(){const state=this.el.sceneEl.systems.state.state;if(state.isVictory){const scoreData={accuracy:state.score.accuracy,challengeId:state.challenge.id,score:state.score.score,username:this.username,difficulty:state.challenge.difficulty,time:new Date};this.db.add(scoreData),this.addEventDetail.scoreData=scoreData,this.el.emit('leaderboardscoreadded',this.addEventDetail,!1)}},fetchScores:function(challengeId){const state=this.el.sceneEl.systems.state.state,query=this.db.where('challengeId','==',challengeId).where('difficulty','==',state.menuSelectedChallenge.id?state.menuSelectedChallenge.difficulty:state.challenge.difficulty).orderBy('score','desc').orderBy('time','asc').limit(10);query.get().then(snapshot=>{this.eventDetail.challengeId=challengeId,this.scores.length=0,snapshot.empty||snapshot.forEach(score=>this.scores.push(score.data())),this.el.sceneEl.emit('leaderboard',this.eventDetail,!1)}).catch(e=>{console.error('[firestore]',e)})},checkLeaderboardQualify:function(){const state=this.el.sceneEl.systems.state.state,score=state.score.score;if(this.scores.length<10)return this.qualifyingIndex=this.scores.length,void this.el.sceneEl.emit('leaderboardqualify',this.scores.length,!1);for(let i=0;i<this.scores.length;i++)if(score>this.scores[i].score)return this.qualifyingIndex=i,void this.el.sceneEl.emit('leaderboardqualify',i,!1)}})},function(){var ONCE={once:!0};AFRAME.registerComponent('logo-light',{init:function(){this.logoBack=document.getElementById('logoBack'),this.logoFront=document.getElementById('logoFront'),this.logoFrontU=document.getElementById('logoFrontU')},play:function(){setTimeout(()=>{this.el.setAttribute('light',{type:'spot',penumbra:1,intensity:5,angle:20}),this.waitAndUpdate(this.logoBack),this.waitAndUpdate(this.logoFront),this.waitAndUpdate(this.logoFrontU)},1e3)},waitAndUpdate:function(el){el.getObject3D('mesh')?el.object3D.traverse(this.updateMaterials):el.addEventListener('model-loaded',()=>{el.object3D.traverse(this.updateMaterials)},ONCE)},updateMaterials:function(node){node.material&&(node.material.needsUpdate=!0)}})},function(){var _Mathfloor4=Math.floor;AFRAME.registerComponent('logoflicker',{schema:{delay:{default:1e3},active:{default:!0}},init:function(){this.setOff=this.setOff.bind(this),this.setOn=this.setOn.bind(this),this.timeout=0,this.sparks=document.getElementById('logosparks'),this.sparkPositions=[{position:new THREE.Vector3(0,0.1,0)},{position:new THREE.Vector3(0.3,0.8,0)},{position:new THREE.Vector3(-0.3,0.8,0)}]},update:function(oldData){this.data.active!==oldData.active&&(this.data.active?this.setOn():clearTimeout(this.timeout))},setOff:function(){this.el.object3D.visible=!1,this.sparks.emit('logoflicker',this.sparkPositions[_Mathfloor4(Math.random()*this.sparkPositions.length)],!1),this.timeout=setTimeout(this.setOn,50)},setOn:function(){this.el.object3D.visible=!0,this.timeout=setTimeout(this.setOff,_Mathfloor4(3*this.data.delay/10+Math.random()*this.data.delay))}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(6),flatShaders=__webpack_require__(56),stageAdditiveShaders=__webpack_require__(57),stageNormalShaders=__webpack_require__(58);AFRAME.registerSystem('materials',{init:function(){'loading'===document.readyState?document.addEventListener('DOMContentLoaded',this.createMaterials.bind(this)):this.createMaterials()},createMaterials:function(){this.stageNormal=new THREE.ShaderMaterial({uniforms:{skyColor:{value:new THREE.Color(COLORS.SKY_BLUE)},backglowColor:{value:new THREE.Color(COLORS.BG_BLUE)},src:{value:new THREE.TextureLoader().load(document.getElementById('atlasImg').src)}},vertexShader:stageNormalShaders.vertexShader,fragmentShader:stageNormalShaders.fragmentShader,fog:!1,transparent:!0}),this.stageAdditive=new THREE.ShaderMaterial({uniforms:{tunnelNeon:{value:new THREE.Color(COLORS.NEON_RED)},floorNeon:{value:new THREE.Color(COLORS.NEON_RED)},leftLaser:{value:new THREE.Color(COLORS.NEON_BLUE)},rightLaser:{value:new THREE.Color(COLORS.NEON_BLUE)},textGlow:{value:new THREE.Color(COLORS.TEXT_OFF)},src:{value:new THREE.TextureLoader().load(document.getElementById('atlasImg').src)}},vertexShader:stageAdditiveShaders.vertexShader,fragmentShader:stageAdditiveShaders.fragmentShader,blending:THREE.AdditiveBlending,fog:!1,transparent:!0}),this.logo=new THREE.ShaderMaterial({uniforms:{src:{value:new THREE.TextureLoader().load(document.getElementById('logotexImg').src)}},vertexShader:flatShaders.vertexShader,fragmentShader:flatShaders.fragmentShader,depthTest:!1,fog:!1,transparent:!0}),this.logoadditive=new THREE.ShaderMaterial({uniforms:{src:{value:new THREE.TextureLoader().load(document.getElementById('logotexImg').src)}},vertexShader:flatShaders.vertexShader,fragmentShader:flatShaders.fragmentShader,depthTest:!1,blending:THREE.AdditiveBlending,fog:!1,transparent:!0}),this.mineMaterialred=new THREE.MeshStandardMaterial({roughness:0.38,metalness:0.48,color:new THREE.Color(COLORS.MINE_RED),emissive:new THREE.Color(COLORS.MINE_RED_EMISSION),envMap:new THREE.TextureLoader().load('assets/img/mineenviro-red.jpg')}),this.mineMaterialblue=new THREE.MeshStandardMaterial({roughness:0.38,metalness:0.48,color:new THREE.Color(COLORS.MINE_BLUE),emissive:new THREE.Color(COLORS.MINE_BLUE_EMISSION),envMap:new THREE.TextureLoader().load('assets/img/mineenviro-blue.jpg')})}}),AFRAME.registerComponent('materials',{schema:{name:{default:''},recursive:{default:!0}},update:function(){if(''!==this.data.name){const material=this.system[this.data.name];if(!material)return void console.warn(`undefined material "${this.system[this.data.name]}"`);const mesh=this.el.getObject3D('mesh');mesh?this.applyMaterial(mesh):this.el.addEventListener('model-loaded',this.applyMaterial.bind(this))}},applyMaterial:function(obj){const material=this.system[this.data.name];obj.detail&&(obj=obj.detail.model),this.data.recursive?obj.traverse(o=>{'Mesh'===o.type&&(o.material=material)}):obj.material=material}})},function(){var keyEventsRegistered=!1,results=null,hoveredIndex;const PER_PAGE=6;AFRAME.registerComponent('menu-controls',{schema:{enabled:{default:!0},page:{default:0},selectedChallengeId:{default:''}},init:function(){const el=this.el;results=document.getElementById('searchResultList').children,this.goPrevResult=this.goPrevResult.bind(this),this.goNextResult=this.goNextResult.bind(this),this.select=this.select.bind(this),this.unselect=this.unselect.bind(this),el.addEventListener('thumbupstart',this.goPrevResult),el.addEventListener('thumbdownstart',this.goNextResult),el.addEventListener('thumbleftstart',this.unselect),el.addEventListener('thumbrightstart',this.select),el.addEventListener('mouseenter',()=>{!el.components.cursor.intersectedEl||el.components.cursor.intersectedEl.closest('#searchResultList')&&this.cancelMenuControls()}),AFRAME.utils.getUrlParameter('debug')&&!keyEventsRegistered&&(window.addEventListener('keydown',evt=>{37===evt.keyCode&&this.unselect(),38===evt.keyCode&&this.goPrevResult(),39===evt.keyCode&&this.select(),40===evt.keyCode&&this.goNextResult()}),keyEventsRegistered=!0)},goPrevResult:function(){return this.data.enabled?void 0==hoveredIndex?void this.hoverResult(0):void(0<hoveredIndex?results[hoveredIndex-1].dataset.id===this.data.selectedChallengeId?0>hoveredIndex-2?this.goPrevPage():this.hoverResult(hoveredIndex-2):this.hoverResult(hoveredIndex-1):this.goPrevPage()):void 0},goPrevPage:function(){this.hoverResult(PER_PAGE-1),this.el.sceneEl.emit('searchprevpage',null,!1)},goNextResult:function(){return this.data.enabled?void 0==hoveredIndex?void this.hoverResult(0):void(hoveredIndex<PER_PAGE-1?results[hoveredIndex+1].dataset.id===this.data.selectedChallengeId?hoveredIndex+2>PER_PAGE-1?this.goNextPage():this.hoverResult(hoveredIndex+2):this.hoverResult(hoveredIndex+1):this.goNextPage()):void 0},goNextPage:function(){this.hoverResult(0),this.el.sceneEl.emit('searchnextpage',null,!1)},select:function(){this.data.enabled&&void 0!=hoveredIndex&&this.el.sceneEl.emit('menuchallengeselect',results[hoveredIndex].dataset.id,!1)},unselect:function(){!this.data.enabled||this.data.selectedChallengeId&&this.el.sceneEl.emit('menuchallengeunselect',null,!1)},hoverResult:function(i){hoveredIndex!=void 0&&results[hoveredIndex].querySelector('.searchResultBackground').emit('mouseleave',null,!1),hoveredIndex=i,results[i].querySelector('.searchResultBackground').emit('mouseenter',null,!1)},cancelMenuControls:function(){void 0===hoveredIndex||(results[hoveredIndex].querySelector('.searchResultBackground').emit('mouseleave',null,!1),hoveredIndex=void 0)}})},function(module,exports,__webpack_require__){var bindEvent=__webpack_require__(15).bindEvent;AFRAME.registerComponent('menu-difficulty-select',{init:function(){this.el.sceneEl.addEventListener('menuchallengeselect',()=>{this.el.object3D.visible=!1,setTimeout(()=>{this.el.components.layout.update(),this.el.object3D.visible=!0},150)})},click:bindEvent(function(evt){this.el.sceneEl.emit('menudifficultyselect',evt.target.closest('.difficultyOption').dataset.difficulty,!1)})})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_0__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__utils__);AFRAME.registerComponent('menu-selected-challenge-image',{schema:{selectedChallengeId:{type:'string'}},update:function(){const el=this.el;this.data.selectedChallengeId&&el.setAttribute('material','src',__WEBPACK_IMPORTED_MODULE_0__utils___default.a.getS3FileUrl(this.data.selectedChallengeId,'image.jpg'))}})},function(){AFRAME.registerComponent('menu-slide-animation',{schema:{isSearching:{default:!1},menuSelectedChallengeId:{type:'string'}},init:function(){this.isLeft=!1},update:function(oldData){const data=this.data;return this.isLeft?(!oldData.menuSelectedChallengeId||data.menuSelectedChallengeId||data.isSearching||this.rightMenu(),void(!oldData.isSearching||data.isSearching||data.menuSelectedChallengeId||this.rightMenu())):void(!this.isLeft&&(!oldData.menuSelectedChallengeId&&data.menuSelectedChallengeId&&this.leftMenu(),!oldData.isSearching&&data.isSearching&&this.leftMenu()))},rightMenu:function(){this.isLeft&&(this.el.components.animation__menuright.beginAnimation(),this.isLeft=!1)},leftMenu:function(){this.isLeft||(this.el.components.animation__menuleft.beginAnimation(),this.isLeft=!0)}})},function(){const objLoader=new THREE.OBJLoader;AFRAME.registerSystem('mine-fragments-loader',{init:function(){this.fragments=null;const objData=document.getElementById('mineBrokenObj');objData.addEventListener('loaded',evt=>{this.fragments=objLoader.parse(evt.target.data)})}})},function(){const COMBO_PROGRESS_MAP={0:0,1:0.5,2:0,3:0.25,4:0.5,5:0.75,6:0,7:0.125,8:0.25,9:0.375,10:0.5,11:0.625,12:0.75,13:0.875};AFRAME.registerComponent('multiplier-ring',{dependencies:['geometry','material'],schema:{combo:{default:0},multiplier:{default:1}},init:function(){this.animationSet={from:void 0,to:void 0},this.progress=this.el.getObject3D('mesh').material.uniforms.progress,this.el.setAttribute('animation',{property:'components.material.material.uniforms.progress.value',dur:100,autoplay:!1})},update:function(){this.updateRing()},updateRing:function(){const data=this.data,el=this.el,progress=this.progress;if(8===data.multiplier)return void(progress.value=1);const animationSet=this.animationSet;animationSet.from=progress.value,animationSet.to=COMBO_PROGRESS_MAP[data.combo],el.setAttribute('animation',animationSet),el.components.animation.beginAnimation()}})},function(module){function transformPlane(particleIndex,geometry,originalArray,position,rotation,scale){const array=geometry.attributes.position.array,index=particleIndex*NUM_PLANE_POSITIONS;tri.vertices[0].set(originalArray[index+0],originalArray[index+1],originalArray[index+2]),tri.vertices[1].set(originalArray[index+3],originalArray[index+4],originalArray[index+5]),tri.vertices[2].set(originalArray[index+6],originalArray[index+7],originalArray[index+8]),null!==scale&&tri.scale(scale.x,scale.y,scale.z),rotation&&(tri.rotateX(rotation.x),tri.rotateY(rotation.y),tri.rotateZ(rotation.z)),tri.vertices[0].add(position),tri.vertices[1].add(position),tri.vertices[2].add(position),array[index+0]=tri.vertices[0].x,array[index+1]=tri.vertices[0].y,array[index+2]=tri.vertices[0].z,array[index+3]=tri.vertices[1].x,array[index+4]=tri.vertices[1].y,array[index+5]=tri.vertices[1].z,array[index+6]=tri.vertices[2].x,array[index+7]=tri.vertices[2].y,array[index+8]=tri.vertices[2].z,tri.vertices[0].set(originalArray[index+3],originalArray[index+4],originalArray[index+5]),tri.vertices[1].set(originalArray[index+6],originalArray[index+7],originalArray[index+8]),tri.vertices[2].set(originalArray[index+9],originalArray[index+10],originalArray[index+11]),null!==scale&&tri.scale(scale.x,scale.y,scale.z),rotation&&(tri.rotateX(rotation.x),tri.rotateY(rotation.y),tri.rotateZ(rotation.z)),tri.vertices[0].add(position),tri.vertices[1].add(position),tri.vertices[2].add(position),array[index+9]=tri.vertices[2].x,array[index+10]=tri.vertices[2].y,array[index+11]=tri.vertices[2].z,geometry.attributes.position.needsUpdate=!0}function copyArray(dest,src){dest.length=0;for(let i=0;i<src.length;i++)dest[i]=src[i]}var _Mathfloor5=Math.floor,_MathPI3=Math.PI;const NUM_PLANE_POSITIONS=12,BLENDINGS={normal:THREE.NormalBlending,additive:THREE.AdditiveBlending,substractive:THREE.SubstractiveBlending,multiply:THREE.MultiplyBlending},SHADERS={flat:THREE.MeshBasicMaterial,lambert:THREE.MeshLambertMaterial,phong:THREE.MeshPhongMaterial,standard:THREE.MeshStandardMaterial},OFFSCREEN_VEC3=new THREE.Vector3(-99999,-99999,-99999);AFRAME.registerComponent('particleplayer',{schema:{blending:{default:'additive',oneOf:['normal','additive','multiply','substractive']},color:{default:'#fff',type:'color'},count:{default:'100%'},delay:{default:0,type:'int'},dur:{default:1e3,type:'int'},img:{type:'selector'},interpolate:{default:!1},loop:{default:'false'},on:{default:'init'},poolSize:{default:5,type:'int'},protation:{type:'vec3'},pscale:{default:1,type:'float'},scale:{default:1,type:'float'},initialScale:{type:'vec3'},finalScale:{type:'vec3'},animateScale:{default:!1},shader:{default:'flat',oneOf:['flat','lambert','phong','standard']},src:{type:'selector'}},multiple:!0,init:function(){this.frame=0,this.framedata=null,this.indexPool=null,this.lastFrame=0,this.material=null,this.msPerFrame=0,this.numFrames=0,this.numParticles=0,this.originalVertexPositions=[],this.particleCount=0,this.particleSystems=[],this.protation=!1,this.restPositions=[],this.restRotations=[],this.sprite_rotation=!1,this.systems=null,this.useRotation=!1,this.useAge=!1,this.scaleAnim=new THREE.Vector3,this.partScale=new THREE.Vector3(1,1,1)},update:function(oldData){const data=this.data;if(data.src){oldData.on!==data.on&&(oldData.on&&this.el.removeEventListener(oldData.on,this.start),'play'!==data.on&&this.el.addEventListener(data.on,this.start.bind(this))),this.partScale.set(1,1,1),this.loadParticlesJSON(data.src,data.scale),this.numFrames=this.framedata.length,this.numParticles=0<this.numFrames?this.framedata[0].length:0,this.particleCount='%'===data.count[data.count.length-1]?_Mathfloor5(parseInt(data.count)*this.numParticles/100):parseInt(data.count),this.particleCount=Math.min(this.numParticles,Math.max(0,this.particleCount)),this.msPerFrame=data.dur/this.numFrames,this.indexPool=Array(this.numParticles);const materialParams={color:new THREE.Color(data.color),side:THREE.DoubleSide,blending:BLENDINGS[data.blending],map:data.img?new THREE.TextureLoader().load(data.img.src):null,depthWrite:!1,opacity:data.opacity,transparent:!!data.img||'normal'!==data.blending||1>data.opacity};this.material=void 0===SHADERS[data.shader]?new SHADERS.flat(materialParams):new SHADERS[data.shader](materialParams),this.createParticles(data.poolSize),'init'===data.on&&this.start()}},loadParticlesJSON:function(json,scale){var alive;this.restPositions.length=0,this.restRotations.length=0;const jsonData=JSON.parse(json.data),frames=jsonData.frames,precision=jsonData.precision;this.useRotation=jsonData.rotation,this.useAge=jsonData.age!==void 0&&jsonData.age,this.sprite_rotation=!1!==jsonData.sprite_rotation&&{x:jsonData.sprite_rotation[0]/precision,y:jsonData.sprite_rotation[1]/precision,z:jsonData.sprite_rotation[2]/precision},this.framedata=Array(frames.length);for(let frameIndex=0;frameIndex<frames.length;frameIndex++){this.framedata[frameIndex]=Array(frames[frameIndex].length);for(let particleIndex=0,rawP;particleIndex<frames[frameIndex].length;particleIndex++){rawP=frames[frameIndex][particleIndex],alive=0!==rawP;let p=this.framedata[frameIndex][particleIndex]={position:alive?{x:rawP[0]/precision*scale,y:rawP[1]/precision*scale,z:rawP[2]/precision*scale}:null,alive:alive};this.useRotation&&(p.rotation=alive?{x:rawP[3]/precision,y:rawP[4]/precision,z:rawP[5]/precision}:null),this.useAge&&(p.age=alive?rawP[6]/precision:0),alive&&0===frameIndex&&(this.restPositions[particleIndex]=p.position?{x:p.position.y,y:p.position.y,z:p.position.z}:null,this.restRotations[particleIndex]=p.rotation?{x:p.rotation.y,y:p.rotation.y,z:p.rotation.z}:null)}}},createParticles:function(){const tempGeometries=[];return function(numParticleSystems){const data=this.data;var loop=parseInt(this.data.loop);this.particleSystems.length=0,isNaN(loop)&&(loop='true'===this.data.loop?Number.MAX_VALUE:0);for(let i=0,particleSystem;i<numParticleSystems;i++){particleSystem={active:!1,activeParticleIndices:Array(this.particleCount),loopCount:0,loopTotal:loop,mesh:null,time:0};const ratio=data.img?data.img.width/data.img.height:1;tempGeometries.length=0;for(let p=0,geometry;p<this.numParticles;p++)geometry=new THREE.PlaneBufferGeometry(0.1*ratio*data.pscale,0.1*data.pscale),!1===this.sprite_rotation?(geometry.rotateX(this.data.protation.x*_MathPI3/180),geometry.rotateY(this.data.protation.y*_MathPI3/180),geometry.rotateZ(this.data.protation.z*_MathPI3/180)):(geometry.rotateX(this.sprite_rotation.x),geometry.rotateY(this.sprite_rotation.y),geometry.rotateZ(this.sprite_rotation.z)),tempGeometries.push(geometry);let mergedBufferGeometry=THREE.BufferGeometryUtils.mergeBufferGeometries(tempGeometries);particleSystem.mesh=new THREE.Mesh(mergedBufferGeometry,this.material),particleSystem.mesh.visible=!1,this.el.setObject3D(`particleplayer${i}`,particleSystem.mesh),copyArray(this.originalVertexPositions,mergedBufferGeometry.attributes.position.array);for(let i=0;i<mergedBufferGeometry.attributes.position.array.length;i++)mergedBufferGeometry.attributes.position.array[i]=-99999;for(let i=0;i<particleSystem.activeParticleIndices.length;i++)particleSystem.activeParticleIndices[i]=i;this.particleSystems.push(particleSystem)}}}(),start:function(evt){0<this.data.delay?setTimeout(()=>this.startAfterDelay(evt),this.data.delay):this.startAfterDelay(evt)},startAfterDelay:function(evt){var found=-1,oldestTime=0,position=evt?evt.detail.position:null,rotation=evt?evt.detail.rotation:null,particleSystem;position instanceof THREE.Vector3||(position=new THREE.Vector3),rotation instanceof THREE.Euler||(rotation=new THREE.Euler);for(var i=0;i<this.particleSystems.length;i++){if(!1===this.particleSystems[i].active){found=i;break}this.particleSystems[i].time>oldestTime&&(found=i,oldestTime=this.particleSystems[i].time)}if(-1!==found)return particleSystem=this.particleSystems[found],particleSystem.active=!0,particleSystem.loopCount=1,particleSystem.mesh.visible=!0,particleSystem.mesh.position.copy(position),particleSystem.mesh.rotation.copy(rotation),particleSystem.time=0,this.resetParticles(particleSystem),particleSystem},doLoop:function(particleSystem){particleSystem.loopCount++,particleSystem.frame=-1,particleSystem.time=0,this.resetParticles(particleSystem)},resetParticle:function(particleSystem,particleIndex){const geometry=particleSystem.mesh.geometry;this.restPositions[particleIndex]?transformPlane(particleIndex,geometry,this.originalVertexPositions,this.restPositions[particleIndex],this.useRotation&&this.restRotations[particleIndex],null):transformPlane(particleIndex,geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null)},resetParticles:function(particleSystem){var i,rand;if(this.particleCount===this.numParticles){for(i=0;i<this.numParticles;i++)this.resetParticle(particleSystem,i);return}const geometry=particleSystem.mesh.geometry;for(i=0;i<this.numParticles;i++)i<this.particleCount&&transformPlane(particleSystem.activeParticleIndices[i],geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null),this.indexPool[i]=i;for(i=0;i<this.particleCount;i++)rand=i+_Mathfloor5(Math.random()*(this.numParticles-i)),particleSystem.activeParticleIndices[i]=this.indexPool[rand],this.indexPool[rand]=this.indexPool[i],this.resetParticle(particleSystem,particleSystem.activeParticleIndices[i])},tick:function(){const helperPositionVec3=new THREE.Vector3;return function(time,delta){var useRotation=this.useRotation,frame,fdata,fdataNext,frameTime,relTime,interpolate;const scaleSystem=this.data.animateScale&&!this.useAge,scaleParticle=this.data.animateScale&&this.useAge;for(let particleSystemIndex=0,particleSystem;particleSystemIndex<this.particleSystems.length;particleSystemIndex++)if(particleSystem=this.particleSystems[particleSystemIndex],!!particleSystem.active){interpolate=this.data.interpolate&&this.data.dur/this.numFrames>delta,relTime=particleSystem.time/this.data.dur,frame=relTime*this.numFrames,fdata=this.framedata[_Mathfloor5(frame)],interpolate&&(frameTime=frame-_Mathfloor5(frame),fdataNext=frame<this.numFrames-1?this.framedata[_Mathfloor5(frame)+1]:null),scaleSystem&&this.partScale.lerpVectors(this.data.initialScale,this.data.finalScale,relTime);for(let activeParticleIndex=0;activeParticleIndex<particleSystem.activeParticleIndices.length;activeParticleIndex++){let particleIndex=particleSystem.activeParticleIndices[activeParticleIndex],rotation=useRotation&&fdata[particleIndex].rotation;if(scaleParticle&&this.partScale.lerpVectors(this.data.initialScale,this.data.finalScale,fdata[particleIndex].age),!fdata[particleIndex].alive){transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,OFFSCREEN_VEC3,void 0,null);continue}interpolate&&fdataNext&&fdataNext[particleIndex].alive?(helperPositionVec3.lerpVectors(fdata[particleIndex].position,fdataNext[particleIndex].position,frameTime),transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,helperPositionVec3,rotation,this.partScale)):transformPlane(particleIndex,particleSystem.mesh.geometry,this.originalVertexPositions,fdata[particleIndex].position,rotation,this.partScale)}if(particleSystem.time+=delta,particleSystem.time>=this.data.dur){particleSystem.loopCount<particleSystem.loopTotal?(this.el.emit('particleplayerloop',null,!1),this.doLoop(particleSystem)):(this.el.emit('particleplayerfinished',null,!1),particleSystem.active=!1,particleSystem.mesh.visible=!1);continue}}}}(),_transformPlane:transformPlane});const tri=function(){const tri=new THREE.Geometry;return tri.vertices.push(new THREE.Vector3),tri.vertices.push(new THREE.Vector3),tri.vertices.push(new THREE.Vector3),tri.faces.push(new THREE.Face3(0,1,2)),tri}();module.exports.transformPlane=transformPlane},function(){AFRAME.registerComponent('pause',{schema:{isPaused:{default:!1}},update:function(){this.data.isPaused&&this.el.isPlaying?this.el.pause():!this.data.isPaused&&!this.el.isPlaying&&this.el.sceneEl.isPlaying&&this.el.play()}})},function(){AFRAME.registerComponent('pauser',{schema:{enabled:{default:!0}},init:function(){this.pauseGame=this.pauseGame.bind(this),this.el.sceneEl.addEventListener('controllerconnected',evt=>{'vive-controls'===evt.detail.name?this.el.addEventListener('menudown',this.pauseGame):this.el.addEventListener('thumbstickdown',this.pauseGame)}),document.addEventListener('visibilitychange',()=>{'hidden'===document.visibilityState&&this.pauseGame()})},pauseGame:function(){this.data.enabled&&this.el.sceneEl.emit('pausegame',null,!1)}})},function(module,exports,__webpack_require__){var SoundPool=__webpack_require__(133);AFRAME.registerSystem('play-sound',{init:function(){this.lastSoundPlayed='',this.lastSoundPlayedTime=0,this.pools={}},createPool:function(sound,volume){this.pools[sound]||(this.pools[sound]=new SoundPool(sound,volume))},playSound:function(sound,volume){this.pools[sound]||this.createPool(sound,volume),this.pools[sound].play(),this.lastSoundPlayed=sound,this.lastSoundTime=this.el.time}}),AFRAME.registerComponent('play-sound',{schema:{enabled:{default:!0},event:{type:'string'},sound:{type:'string'},volume:{type:'number',default:1}},multiple:!0,init:function(){this.el.addEventListener(this.data.event,()=>{this.data.enabled&&this.system.playSound(this.src,this.data.volume)})},update:function(){this.src=this.data.sound,this.data.sound.startsWith('#')&&(this.src=document.querySelector(this.data.sound).getAttribute('src'))}})},function(){AFRAME.registerComponent('raycaster-target',{schema:{bindToggle:{default:''},depth:{type:'number'},height:{type:'number'},position:{type:'vec3',default:{x:0,y:0,z:0}},rotation:{type:'vec3',default:{x:0,y:0,z:0}},useBoxTarget:{default:!1},width:{type:'number'}},init:function(){var boxGeometry={primitive:'box'},planeGeometry={primitive:'plane'};return function(){var data=this.data,el=this.el,geometry,raycastTarget;raycastTarget=document.createElement('a-entity'),raycastTarget.classList.add('raycasterTarget'),data.bindToggle?raycastTarget.setAttribute('bind-toggle__raycastable',data.bindToggle):raycastTarget.setAttribute('data-raycastable',''),data.useBoxTarget?(geometry=boxGeometry,geometry.depth=data.depth,geometry.height=data.height,geometry.width=data.width):(geometry=planeGeometry,geometry.height=data.height,geometry.width=data.width),raycastTarget.setAttribute('geometry',geometry),raycastTarget.object3D.visible=!1,raycastTarget.object3D.position.copy(data.position),raycastTarget.object3D.rotation.x=THREE.Math.degToRad(data.rotation.x),raycastTarget.object3D.rotation.y=THREE.Math.degToRad(data.rotation.y),raycastTarget.object3D.rotation.z=THREE.Math.degToRad(data.rotation.z),el.appendChild(raycastTarget)}}()})},function(){AFRAME.registerComponent('recenter',{schema:{enabled:{default:!0}},init:function(){this.el.sceneEl;this.recenter=this.recenter.bind(this),document.querySelectorAll('[tracked-controls]').forEach(controlEl=>{controlEl.addEventListener('menudown',this.recenter),controlEl.addEventListener('thumbstickdown',this.recenter)}),this.el.addEventListener('recenter',this.recenter)},recenter:function(){var euler=new THREE.Euler,matrix=new THREE.Matrix4,rotationMatrix=new THREE.Matrix4,translationMatrix=new THREE.Matrix4;return function(){const el=this.el;if(this.data.enabled){const camera=el.sceneEl.camera.el.object3D;matrix.identity(),euler.set(0,-1*camera.rotation.y,0),rotationMatrix.makeRotationFromEuler(euler),translationMatrix.makeTranslation(-1*camera.position.x,0,-1*camera.position.z),matrix.multiply(rotationMatrix).multiply(translationMatrix),matrix.decompose(el.object3D.position,el.object3D.quaternion,el.object3D.scale),el.object3D.updateMatrixWorld(!0),el.emit('recentered',null,!1)}}}()})},function(){AFRAME.registerComponent('saber-controls',{schema:{bladeEnabled:{default:!1},hand:{default:'right',oneOf:['left','right']},isPaused:{default:!1},strokeMinSpeed:{default:2e-3},strokeMinDuration:{default:30}},init:function(){var el=this.el,data=this.data;this.boundingBox=new THREE.Box3,this.controllerType='',this.xPlaneNormal=new THREE.Vector3(0,1,0),this.yPlaneNormal=new THREE.Vector3(1,0,0),this.xyPlaneNormal=new THREE.Vector3(1,1,0),this.bladeTipPosition=new THREE.Vector3,this.bladePosition=new THREE.Vector3,this.bladeVector=new THREE.Vector3,this.bladeTipPreviousPosition=new THREE.Vector3,this.projectedBladeVector=new THREE.Vector3,this.saberPosition=new THREE.Vector3,this.swinging=!1,this.strokeCount=0,this.distanceSamples=[],this.deltaSamples=[],this.startStrokePosition=new THREE.Vector3,this.strokeDirectionVector=new THREE.Vector3,this.strokeDirection={down:!1,left:!1,right:!1,up:!1},this.accumulatedDistance=0,this.accumulatedDelta=0,el.addEventListener('controllerconnected',this.initSaber.bind(this));const hand={hand:data.hand,model:!1};el.setAttribute('oculus-touch-controls',hand),el.setAttribute('vive-controls',hand),el.setAttribute('windows-motion-controls',hand),this.bladeEl=this.el.querySelector('.blade')},update:function(oldData){!oldData.bladeEnabled&&this.data.bladeEnabled&&this.bladeEl.emit('drawblade')},tick:function(time,delta){this.data.bladeEnabled&&(this.boundingBox.setFromObject(this.bladeEl.getObject3D('mesh')),this.detectStroke(delta))},detectStroke:function(delta){var distanceSamples=this.distanceSamples,data=this.data,distance;this.bladeTipPosition.set(0,0,-0.8),this.bladePosition.set(0,0,0);const saberObj=this.el.object3D;saberObj.parent.updateMatrixWorld(),saberObj.localToWorld(this.bladeTipPosition),saberObj.localToWorld(this.bladePosition),this.bladeVector.copy(this.bladeTipPosition).sub(this.bladePosition).normalize();var anglePlaneX=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.xPlaneNormal).angleTo(this.bladeVector),anglePlaneY=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.yPlaneNormal).angleTo(this.bladeVector),anglePlaneXY=this.projectedBladeVector.copy(this.bladeTipPosition).projectOnPlane(this.xyPlaneNormal).angleTo(this.bladeVector);if(distance=this.bladeTipPreviousPosition.sub(this.bladeTipPosition).length(),5===this.distanceSamples.length&&(this.accumulatedDistance-=this.distanceSamples.shift(),this.accumulatedDelta-=this.deltaSamples.shift()),this.distanceSamples.push(distance),this.accumulatedDistance+=distance,this.deltaSamples.push(delta),this.accumulatedDelta+=delta,this.accumulatedDistance/this.accumulatedDelta>this.data.strokeMinSpeed){this.swinging||(this.startStrokePosition.copy(this.bladeTipPosition),this.swinging=!0,this.strokeDuration=0,this.maxAnglePlaneX=0,this.maxAnglePlaneY=0,this.maxAnglePlaneXY=0),this.updateStrokeDirection(),this.strokeDuration+=delta;const anglePlaneXIncreased=anglePlaneX>this.maxAnglePlaneX,anglePlaneYIncreased=anglePlaneY>this.maxAnglePlaneY,anglePlaneXYIncreased=anglePlaneXY>this.maxAnglePlaneXY;this.maxAnglePlaneX=anglePlaneXIncreased?anglePlaneX:this.maxAnglePlaneX,this.maxAnglePlaneY=anglePlaneYIncreased?anglePlaneY:this.maxAnglePlaneY,this.maxAnglePlaneXY=anglePlaneXYIncreased?anglePlaneXY:this.maxAnglePlaneXY,anglePlaneXIncreased||anglePlaneYIncreased||this.endStroke()}else this.endStroke();this.bladeTipPreviousPosition.copy(this.bladeTipPosition)},endStroke:function(){if(this.swinging&&!(this.strokeDuration<this.data.strokeMinDuration)){this.el.emit('strokeend'),this.swinging=!1,this.accumulatedDistance=0,this.accumulatedDelta=0,this.maxAnglePlaneX=0,this.maxAnglePlaneY=0,this.maxAnglePlaneXY=0;for(let i=0;i<this.distanceSamples.length;i++)this.distanceSamples[i]=0;for(let i=0;i<this.deltaSamples.length;i++)this.deltaSamples[i]=0;var direction='DIRECTION ';direction+=this.strokeDirection.right?'RIGHT':'LEFT',direction+=this.strokeDirection.up?' TOP':' BOTTOM',console.log(direction),this.el.emit('strokeend')}},updateStrokeDirection:function(){this.strokeDirectionVector.copy(this.bladeTipPosition).sub(this.startStrokePosition);0===this.strokeDirectionVector.x&&0===this.strokeDirectionVector.y||(this.strokeDirection.right=0<this.strokeDirectionVector.x,this.strokeDirection.left=0>this.strokeDirectionVector.x,this.strokeDirection.up=0<this.strokeDirectionVector.y,this.strokeDirection.down=0>this.strokeDirectionVector.y)},initSaber:function(evt){this.controllerType=evt.detail.name,this.el.setAttribute('cursor',this.config[this.controllerType].cursor||{})},config:{"oculus-touch-controls":{cursor:{downEvents:['triggerdown','gripdown','abuttondown','bbuttondown','xbuttondown','ybuttondown'],upEvents:['triggerup','gripup','abuttonup','bbuttonup','xbuttonup','ybuttonup']}},"vive-controls":{cursor:{downEvents:['trackpaddown','triggerdown','gripdown'],upEvents:['trackpadup','triggerup','gripup']}},"windows-motion-controls":{cursor:{downEvents:['trackpaddown','triggerdown','gripdown'],upEvents:['trackpadup','triggerup','gripup']}}}})},function(){AFRAME.registerComponent('saber-particles',{schema:{enabled:{default:!1},hand:{type:'string'}},init:function(){this.hiddenIntersection={x:999,y:0,z:0},this.intersectedEl=null,this.particles=document.getElementById('sparkParticles'),this.particleEventDetail={position:new THREE.Vector3,rotation:new THREE.Euler},this.particleEvent={detail:this.particleEventDetail},this.particleSystem=null,this.saberEnter=this.saberEnter.bind(this),this.saberLeave=this.saberLeave.bind(this)},pause:function(){this.el.removeEventListener('mouseenter',this.saberEnter),this.el.removeEventListener('mouseleave',this.saberLeave)},play:function(){this.el.addEventListener('mouseenter',this.saberEnter),this.el.addEventListener('mouseleave',this.saberLeave),this.particlesDur=this.particles.getAttribute('particleplayer').dur},saberEnter:function(evt){this.data.enabled&&evt.target===this.el&&evt.detail.intersectedEl.hasAttribute('data-saber-particles')&&(this.intersectedEl=evt.detail.intersectedEl)},saberLeave:function(evt){if(evt.detail.target===this.el){if(this.intersectedEl.components.wall||'floor'===this.intersectedEl.id){const uniform=this.data.hand==='right'?'hitRight':'hitLeft',material=this.intersectedEl.getObject3D('mesh').material;material.uniforms[uniform].value=this.hiddenIntersection}this.intersectedEl=null,this.particleSystem=null}},tick:function(){if(this.data.enabled&&this.intersectedEl){const raycaster=this.el.components.raycaster__game,intersection=raycaster.getIntersection(this.intersectedEl);intersection&&(this.particleSystem&&this.particleSystem.active?this.particleSystem.mesh.position.copy(intersection.point):(this.particleEventDetail.position.copy(intersection.point),this.particleSystem=this.particles.components.particleplayer.startAfterDelay(this.particleEvent)))}}})},function(){AFRAME.registerComponent('score-beat',{schema:{type:{type:'string'}},play:function(){this.poolComponent=`pool__beatscore${this.data.type}`,this.startTime=this.el.sceneEl.time},tick:function(time){time>this.startTime+1200&&this.el.sceneEl.components[this.poolComponent].returnEntity(this.el)}})},function(){AFRAME.registerComponent('score-texts',{schema:{isSongLoading:{default:!1}},init:function(){this.textEls=this.el.querySelectorAll('[text]');for(let i=0;i<this.textEls.length;i++)this.textEls[i].setAttribute('animation__fadein',{autoplay:!1,property:'components.text.material.uniforms.opacity.value',delay:250,dur:750,easing:'easeInOutCubic',from:0,to:1})},update:function(oldData){if(oldData.isSongLoading&&!this.data.isSongLoading){for(let i=0;i<this.textEls.length;i++)this.textEls[i].components.animation__fadein.beginAnimation();this.el.sceneEl.emit('textglownormal',null,!1)}if(!oldData.isSongLoading&&this.data.isSongLoading){for(let i=0;i<this.textEls.length;i++)this.textEls[i].components.text.material.uniforms.opacity.value=0;this.el.sceneEl.emit('textglowoff',null,!1)}}})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__utils__=__webpack_require__(2),__WEBPACK_IMPORTED_MODULE_0__utils___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__utils__),CANVAS_HEIGHT=512,HEIGHT=64,NUM_PER_PAGE=6,WIDTH=64,IMAGE_HEIGHT_CANVAS=HEIGHT*(CANVAS_HEIGHT/(HEIGHT*NUM_PER_PAGE));AFRAME.registerComponent('search-thumbnail-atlas',{dependencies:['geometry','material'],schema:{dummyUpdater:{type:'string'}},init:function(){const canvas=this.canvas=document.createElement('canvas');canvas.setAttribute('id','thumbnailAtlasMap'),canvas.height=CANVAS_HEIGHT,canvas.width=WIDTH,this.ctx=canvas.getContext('2d'),this.clearCanvas(),document.body.appendChild(canvas);const alphaCanvas=this.alphaCanvas=document.createElement('canvas');alphaCanvas.setAttribute('id','thumbnailAlphaMap'),alphaCanvas.height=CANVAS_HEIGHT,alphaCanvas.width=WIDTH,this.alphaCtx=alphaCanvas.getContext('2d'),document.body.appendChild(alphaCanvas),this.el.components.material.material.alphaMap=new THREE.CanvasTexture(alphaCanvas),this.el.setAttribute('material','src',canvas),this.images=[],this.lastNumResults=NUM_PER_PAGE},update:function(){var el=this.el;const results=el.sceneEl.systems.state.state.searchResultsPage;for(let i=0,img;i<results.length;i++)img=this.images[i]=this.images[i]||document.createElement('img'),img.crossOrigin='anonymous',img.src=__WEBPACK_IMPORTED_MODULE_0__utils___default.a.getS3FileUrl(results[i].id,'image.jpg'),img.complete?this.draw(img,i):img.onload=()=>{this.draw(img,i)};results.length!==this.lastNumResults&&this.updateAlphaMap(results.length),this.lastNumResults=results.length},draw:function(img,i){this.ctx.drawImage(img,0,i*IMAGE_HEIGHT_CANVAS,WIDTH,IMAGE_HEIGHT_CANVAS),this.el.getObject3D('mesh').material.map.needsUpdate=!0},clearCanvas:function(){const canvas=this.canvas;this.ctx.fillStyle='#111',this.ctx.fillRect(0,0,canvas.width,canvas.height)},updateAlphaMap:function(numResults){const canvas=this.alphaCanvas,ctx=this.alphaCtx;ctx.fillStyle='#FFF',ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle='#000',ctx.fillRect(0,numResults*IMAGE_HEIGHT_CANVAS,canvas.width,canvas.height-numResults*IMAGE_HEIGHT_CANVAS),this.el.getObject3D('mesh').material.alphaMap.needsUpdate=!0,this.el.getObject3D('mesh').material.needsUpdate=!0}})},function(module,exports,__webpack_require__){var algoliasearch=__webpack_require__(45),bindEvent=__webpack_require__(15).bindEvent,client=algoliasearch('QULTOY3ZWU','be07164192471df7e97e6fa70c1d041d'),algolia=client.initIndex('supersaber');AFRAME.registerComponent('search',{init:function(){this.eventDetail={query:'',results:[]},this.popularHits=null,this.queryObject={hitsPerPage:100,query:''},this.search(''),this.queryObject.hitsPerPage=30,this.el.sceneEl.addEventListener('searchclear',()=>{this.search('')})},superkeyboardchange:bindEvent(function(evt){evt.target!==this.el||this.search(evt.detail.value)}),search:function(query){return!query&&this.popularHits?(this.eventDetail.results=this.popularHits,this.eventDetail.query='',void this.el.sceneEl.emit('searchresults',this.eventDetail)):void(this.eventDetail.query=query,this.queryObject.query=query,algolia.search(this.queryObject,(err,content)=>err?(this.el.sceneEl.emit('searcherror',null,!1),void console.error(err)):void(!query&&(this.popularHits=content.hits),this.eventDetail.results=content.hits,this.el.sceneEl.emit('searchresults',this.eventDetail))))}}),AFRAME.registerComponent('search-genre',{init:function(){this.eventDetail={isGenreSearch:!0,genre:'',results:[]},this.queryObject={filters:'',hitsPerPage:100},this.el.addEventListener('click',evt=>{this.search(evt.target.closest('.genre').dataset.bindForKey)})},search:function(genre){this.queryObject.filters='Video Games'===genre?`genre:"Video Game" OR genre:"Video Games"`:`genre:"${genre}"`,algolia.search(this.queryObject,(err,content)=>err?(this.el.sceneEl.emit('searcherror',null,!1),void console.error(err)):void(this.eventDetail.genre=genre,this.eventDetail.results=content.hits,this.el.sceneEl.emit('searchresults',this.eventDetail)))}}),AFRAME.registerComponent('search-result-list',{init:function(){const obv=new MutationObserver(mutations=>{for(let i=0;i<mutations.length;i++)'data-index'===mutations[i].attributeName&&this.refreshLayout()});obv.observe(this.el,{attributes:!0,childList:!1,subtree:!0})},refreshLayout:function(){this.el.emit('layoutrefresh',null,!1)},click:bindEvent(function(evt){this.el.sceneEl.emit('menuchallengeselect',evt.target.closest('.searchResult').dataset.id,!1)})}),AFRAME.registerComponent('search-song-name-selected',{schema:{anchor:{default:0},index:{default:0},offset:{default:0},selectedChallengeId:{default:''}},update:function(){const data=this.data,el=this.el;el.object3D.visible=!!data.selectedChallengeId&&-1!==data.index,el.object3D.position.y=data.index*data.offset+data.anchor}})},function(module,exports,__webpack_require__){var utils=__webpack_require__(2);AFRAME.registerComponent('song-preview-system',{schema:{challengeId:{default:''},debug:{default:!1},isSearching:{default:!1},isSongLoading:{default:!1},selectedChallengeId:{type:'string'}},init:function(){this.analyserEl=document.getElementById('audioAnalyser'),this.audio=document.createElement('audio'),this.audioStore={},this.preloadedAudioIds=[],this.preloadQueue=[]},update:function(oldData){const data=this.data;return!oldData.challengeId&&data.challengeId?void((0===this.analyserEl.components.audioanalyser.volume||1>this.audio.currentTime)&&this.stopSong()):(!oldData.selectedChallengeId||data.selectedChallengeId||data.isSearching||this.stopSong(),oldData.isSongLoading&&!data.isSongLoading?void this.stopSong():void(data.selectedChallengeId&&oldData.selectedChallengeId!==data.selectedChallengeId&&(this.audio&&this.stopSong(),!this.preloadedAudioIds.includes(data.selectedChallengeId)&&data.selectedChallengeId!==this.currentLoadingId&&this.prioritizePreloadSong(),this.playSong(data.selectedChallengeId))))},log:function(str){this.data.debug&&console.log(str)},prioritizePreloadSong:function(){const data=this.data,preloadQueue=this.preloadQueue;this.log(`[song-preview] Prioritizing loading of ${data.selectedChallengeId}`),this.priorityLoadingChallengeId=data.selectedChallengeId,this.audioStore[data.selectedChallengeId].addEventListener('loadeddata',()=>{this.log(`[song-preview] Finished load of priority ${data.selectedChallengeId}`),this.preloadedAudioIds.push(data.selectedChallengeId),this.priorityLoadingChallengeId='',preloadQueue.length&&(this.log(`[song-preview] Resuming queue with ${preloadQueue[0].challengeId}`),this.preloadMetadata(preloadQueue[0]))}),this.audioStore[data.selectedChallengeId].src=utils.getS3FileUrl(data.selectedChallengeId,'song.ogg');for(let i=0;i<preloadQueue.length;i++)if(preloadQueue[i].challengeId===data.selectedChallengeId){preloadQueue.splice(i,1);break}},queuePreloadSong:function(challengeId,previewStartTime){if(!this.audioStore[challengeId]){const audio=document.createElement('audio');audio.crossOrigin='anonymous',audio.dataset.previewStartTime=previewStartTime,this.audioStore[challengeId]=audio;let src=utils.getS3FileUrl(challengeId,'song.ogg');this.currentLoadingId?this.preloadQueue.push({audio:audio,challengeId:challengeId,src:src}):this.preloadMetadata({audio:audio,challengeId:challengeId,src:src})}},preloadMetadata:function(preloadItem){const audio=preloadItem.audio;this.log(`[song-preview] Preloading song preview ${preloadItem.challengeId}`),audio.addEventListener('loadedmetadata',()=>{this.log(`[song-preview] Finished preloading song preview ${preloadItem.challengeId}`),this.preloadedAudioIds.push(preloadItem.challengeId),this.currentLoadingId='',this.log(`[song-preview] ${this.preloadQueue.length} in queue`),this.preloadQueue.length&&!this.priorityLoadingChallengeId&&this.preloadMetadata(this.preloadQueue.shift())}),audio.preload='metadata',audio.src=preloadItem.src,this.currentLoadingId=preloadItem.challengeId},stopSong:function(){this.audio&&(this.audio.paused||this.audio.pause())},playSong:function(challengeId){if(challengeId){this.audio=this.audioStore[challengeId],this.audio.load(),this.audio.volume=0.5,this.audio.currentTime=this.audio.dataset.previewStartTime,this.analyserEl.setAttribute('audioanalyser','src',this.audio);const audioanalyser=this.analyserEl.components.audioanalyser;audioanalyser.resumeContext(),this.audio.play(),audioanalyser.xhr&&audioanalyser.xhr.abort(),audioanalyser.fetchAudioBuffer(utils.getS3FileUrl(challengeId,'song.ogg'))}},clearSong:function(challengeId){let audio=this.audioStore[challengeId];audio.preload='none';let index;for(let i=0;i<this.preloadQueue.length;i++)if(this.preloadQueue[i].id===challengeId){index=i;break}index&&this.preloadQueue.splice(index,1)}}),AFRAME.registerComponent('song-preview',{schema:{challengeId:{type:'string'},previewStartTime:{type:'number'}},update:function(oldData){oldData.challengeId&&this.data.challengeId!==oldData.challengeId&&this.el.sceneEl.components['song-preview-system'].clearSong(oldData.challengeId),this.el.sceneEl.components['song-preview-system'].queuePreloadSong(this.data.challengeId,this.data.previewStartTime)}})},function(){AFRAME.registerComponent('song-progress-ring',{dependencies:['geometry','material'],schema:{enabled:{default:!1}},init:function(){this.tick=AFRAME.utils.throttleTick(this.tick.bind(this),1e3),this.progress=this.el.getObject3D('mesh').material.uniforms.progress,this.el.sceneEl.addEventListener('cleargame',()=>{this.progress.value=0})},update:function(){this.progress.value=0},updateRing:function(){const source=this.el.sceneEl.components.song.source;if(source){const progress=this.el.sceneEl.components.song.getCurrentTime()/source.buffer.duration;this.progress.value=progress}},tick:function(){this.data.enabled&&this.updateRing()}})},function(module,exports,__webpack_require__){const utils=__webpack_require__(2),GAME_OVER_LENGTH=3.5,ONCE={once:!0},BASE_VOLUME=0.75;let skipDebug=AFRAME.utils.getUrlParameter('skip');!skipDebug||(skipDebug=parseInt(skipDebug)/1e3),AFRAME.registerComponent('song',{schema:{analyserEl:{type:'selector',default:'#audioAnalyser'},challengeId:{default:''},isBeatsPreloaded:{default:!1},isGameOver:{default:!1},isPlaying:{default:!1},isVictory:{default:!1}},init:function(){this.analyserSetter={buffer:!0},this.audioAnalyser=this.data.analyserEl.components.audioanalyser,this.context=this.audioAnalyser.context,this.isPlaying=!1,this.songLoadingIndicator=document.getElementById('songLoadingIndicator'),this.songStartTime=0,this.victory=this.victory.bind(this),this.audioAnalyser.gainNode.gain.value=BASE_VOLUME,this.el.addEventListener('gamemenurestart',this.onRestart.bind(this)),this.el.addEventListener('wallhitstart',this.onWallHitStart.bind(this)),this.el.addEventListener('wallhitend',this.onWallHitEnd.bind(this)),!1},update:function(oldData){var data=this.data;return!oldData.isGameOver&&data.isGameOver?void this.onGameOver():(oldData.isGameOver&&!data.isGameOver&&(this.audioAnalyser.gainNode.value=BASE_VOLUME),!oldData.isVictory&&data.isVictory)?(this.data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.audioAnalyser.resumeContext();const gain=this.audioAnalyser.gainNode.gain;gain.cancelScheduledValues(0),gain.setValueAtTime(0.05,0),this.source=evt.detail,this.source.start()},ONCE),void this.audioAnalyser.refreshSource()):(!oldData.isBeatsPreloaded&&this.data.isBeatsPreloaded&&this.source&&this.startAudio(),oldData.challengeId&&!data.challengeId?void this.stopAudio():void(oldData.challengeId!==data.challengeId&&data.challengeId&&(this.el.sceneEl.emit('songloadstart',null,!1),this.getAudio().then(()=>{this.el.sceneEl.emit('songloadfinish',null,!1)}).catch(console.error)),oldData.isPlaying&&!data.isPlaying&&this.audioAnalyser.suspendContext(),!oldData.isPlaying&&data.isPlaying&&this.source&&this.audioAnalyser.resumeContext()))},getAudio:function(){const data=this.data;return this.isPlaying=!1,new Promise(resolve=>(data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.source=evt.detail,resolve(this.source)},ONCE),this.analyserSetter.src=utils.getS3FileUrl(data.challengeId,'song.ogg'),data.analyserEl.setAttribute('audioanalyser',this.analyserSetter),this.audioAnalyser.xhr.response?(this.songLoadingIndicator.setAttribute('material','progress',1),void this.el.sceneEl.emit('songfetchfinish',null,!1)):void this.audioAnalyser.xhr.addEventListener('progress',evt=>{this.onFetchProgress(evt)})))},stopAudio:function(){return this.source?void(this.source.stop(),this.source.disconnect(),this.source=null,this.isPlaying=!1):void console.warn('[song] Tried to stopAudio, but not playing.')},victory:function(){this.data.isPlaying&&this.el.sceneEl.emit('victory',null,!1)},onFetchProgress:function(evt){const progress=evt.loaded/evt.total;this.songLoadingIndicator.setAttribute('material','progress',progress),1<=progress&&this.el.sceneEl.emit('songfetchfinish',null,!1)},onGameOver:function(){this.isPlaying=!1;const playbackRate=this.source.playbackRate;playbackRate.setValueAtTime(playbackRate.value,this.context.currentTime),playbackRate.linearRampToValueAtTime(0,this.context.currentTime+GAME_OVER_LENGTH);const gain=this.audioAnalyser.gainNode.gain;gain.setValueAtTime(gain.value,this.context.currentTime),gain.linearRampToValueAtTime(0,this.context.currentTime+GAME_OVER_LENGTH),setTimeout(()=>{this.data.isGameOver&&this.stopAudio()},3500)},onRestart:function(){this.isPlaying=!1,this.source&&this.source.disconnect();const gain=this.audioAnalyser.gainNode.gain;gain.cancelScheduledValues(0),this.data.analyserEl.addEventListener('audioanalyserbuffersource',evt=>{this.source=evt.detail,this.el.sceneEl.emit('songloadfinish',null,!1)},ONCE),this.audioAnalyser.refreshSource()},onWallHitStart:function(){const gain=this.audioAnalyser.gainNode.gain;gain.linearRampToValueAtTime(0.2,this.context.currentTime+0.1)},onWallHitEnd:function(){const gain=this.audioAnalyser.gainNode.gain;gain.linearRampToValueAtTime(BASE_VOLUME,this.context.currentTime+0.1)},startAudio:function(){const gain=this.audioAnalyser.gainNode.gain;gain.setValueAtTime(BASE_VOLUME,this.context.currentTime),this.songStartTime=this.context.currentTime,this.source.onended=this.victory,this.source.start(0,skipDebug),this.isPlaying=!0},getCurrentTime:function(){return this.context.currentTime-this.songStartTime}})},function(){AFRAME.registerComponent('stage-colors',{dependencies:['background'],schema:{color:{default:'blue',oneOf:['blue','red']}},init:function(){this.colorCodes=['off','blue','blue','bluefade','','red','red','redfade'],this.el.addEventListener('cleargame',this.resetColors.bind(this))},update:function(){this.updateColors(this.data.color)},setColor:function(target,code){this.el.emit(`${target}color${this.colorCodes[code]}`,null,!1)},resetColors:function(){this.updateColors('blue'),this.el.emit('bgcolorblue',null,!1),this.el.emit('tunnelcolorred',null,!1),this.el.emit('floorcolorred',null,!1),this.el.emit('leftlasercolorblue',null,!1),this.el.emit('rightlasercolorblue',null,!1)},updateColors:function(){}})},function(){AFRAME.registerComponent('stage-lasers',{schema:{enabled:{default:!0}},init:function(){this.speed=0,this.lasers=[this.el.children[0].object3D,this.el.children[1].object3D,this.el.children[2].object3D]},pulse:function(speed){this.speed=speed/8},tick:function(time,delta){if(0!==this.speed)return delta/=1e3,!this.data.enabled&&(this.speed*=0.97,0.01>Math.abs(this.speed))?void(this.speed=0):void(this.lasers[0].rotation.z+=this.speed*delta,this.lasers[1].rotation.z-=1.01*(this.speed*delta),this.lasers[2].rotation.z+=1.02*(this.speed*delta))}})},function(){AFRAME.registerShader('stageShader',{schema:{color:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}},fogColor:{type:'vec3',is:'uniform',default:{x:0,y:0.48,z:0.72}},src:{type:'map',is:'uniform'}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    #define FOG_RADIUS  50.0
    #define FOG_FALLOFF 45.0
    varying vec2 uvs;
    varying vec3 worldPos;
    uniform vec3 color;
    uniform vec3 fogColor;
    uniform sampler2D src;

    void main() {
      vec4 col = texture2D(src, uvs);
      col.xyz = mix(fogColor, col.xyz, clamp(distance(worldPos, vec3(0., 0., -FOG_RADIUS)) / FOG_FALLOFF, 0., 1.));
      gl_FragColor = col;
    }
  `})},function(){AFRAME.registerComponent('stats-param',{init:function(){'true'===AFRAME.utils.getUrlParameter('stats')&&this.el.setAttribute('stats','')}})},function(){AFRAME.registerComponent('stepback',{init:function(){this.message=document.getElementById('stepback'),this.camera=document.getElementById('camera'),this.lastTime=0,this.limit=-(this.el.getAttribute('geometry').height/2-0.6),this.throttling=300},tick:function(time){if(!(time-this.lastTime<this.throttling)){var camPos=this.camera.object3D.position,msgPos=this.message.object3D.position;camPos.z<this.limit?(this.throttling=20,this.message.object3D.visible=!0,this.message.getObject3D('mesh').material.opacity=1-Math.abs(camPos.z-msgPos.z),msgPos.x=camPos.x,msgPos.y=camPos.y):(this.message.object3D.visible=!1,this.throttling=300),this.lastTime=time}}})},function(){AFRAME.registerComponent('sub-object',{schema:{from:{type:'selector'},name:{type:'string'}},init:function(){var el=this.el,data=this.data;data.from.addEventListener('model-loaded',evt=>{const model=evt.detail.model,subset=model.getObjectByName(data.name);el.setObject3D('mesh',subset.clone()),el.setAttribute('material','shader','flat'),el.emit('subobjectloaded',null,!1)})}})},function(){function findFontChar(chars,code){for(var i=0;i<chars.length;i++)if(chars[i].id===code)return chars[i];return null}var _Mathfloor6=Math.floor,KEYBOARDS={supersaber:{wrapCount:20,inputOffsetY:8e-3,inputOffsetX:0.08,img:'keyboard.png',hoverImg:'keyboard-hover.png',layout:[{key:'1',x:0.014,y:0.024,w:0.094,h:0.183},{key:'2',x:0.108,y:0.024,w:0.094,h:0.183},{key:'3',x:0.203,y:0.024,w:0.095,h:0.183},{key:'4',x:0.299,y:0.024,w:0.094,h:0.183},{key:'5',x:0.394,y:0.024,w:0.093,h:0.183},{key:'6',x:0.487,y:0.024,w:0.095,h:0.183},{key:'7',x:0.583,y:0.024,w:0.093,h:0.183},{key:'8',x:0.677,y:0.024,w:0.095,h:0.183},{key:'9',x:0.772,y:0.024,w:0.093,h:0.183},{key:'0',x:0.866,y:0.024,w:0.093,h:0.183},{key:'q',x:0.014,y:0.215,w:0.094,h:0.183},{key:'w',x:0.108,y:0.215,w:0.094,h:0.183},{key:'e',x:0.203,y:0.215,w:0.095,h:0.183},{key:'r',x:0.299,y:0.215,w:0.094,h:0.183},{key:'t',x:0.394,y:0.215,w:0.093,h:0.183},{key:'y',x:0.487,y:0.215,w:0.095,h:0.183},{key:'i',x:0.677,y:0.215,w:0.095,h:0.183},{key:'u',x:0.583,y:0.215,w:0.093,h:0.183},{key:'o',x:0.772,y:0.215,w:0.093,h:0.183},{key:'p',x:0.866,y:0.215,w:0.093,h:0.183},{key:'a',x:0.063,y:0.405,w:0.094,h:0.183},{key:'s',x:0.158,y:0.405,w:0.094,h:0.183},{key:'d',x:0.253,y:0.405,w:0.095,h:0.183},{key:'f',x:0.349,y:0.405,w:0.094,h:0.183},{key:'g',x:0.443,y:0.405,w:0.093,h:0.183},{key:'h',x:0.537,y:0.405,w:0.095,h:0.183},{key:'j',x:0.633,y:0.405,w:0.092,h:0.183},{key:'k',x:0.726,y:0.405,w:0.095,h:0.183},{key:'l',x:0.821,y:0.405,w:0.093,h:0.183},{key:'z',x:0.111,y:0.598,w:0.093,h:0.181},{key:'x',x:0.205,y:0.598,w:0.095,h:0.181},{key:'c',x:0.301,y:0.598,w:0.095,h:0.181},{key:'v',x:0.396,y:0.598,w:0.093,h:0.181},{key:'b',x:0.49,y:0.598,w:0.094,h:0.181},{key:'n',x:0.585,y:0.598,w:0.094,h:0.181},{key:'m',x:0.68,y:0.598,w:0.093,h:0.181},{key:'Delete',x:0.777,y:0.598,w:0.137,h:0.181},{key:' ',x:0.297,y:0.788,w:0.381,h:0.201},{key:'Escape',x:0.013,y:0.797,w:0.137,h:0.181},{key:'Insert',x:0.014,y:-1e-3,w:0.01,h:5e-3}]}};if('undefined'==typeof AFRAME)throw new Error('Component attempted to register before AFRAME was available.');var FontFactors={roboto:17,aileronsemibold:20,dejavu:20.5,exo2bold:20,exo2semibold:20.3,kelsonsans:22.8,monoid:19.5,mozillavr:9.5,sourcecodepro:20.3};AFRAME.registerComponent('super-keyboard',{schema:{align:{default:'left',oneOf:['left','center','right']},blinkingSpeed:{type:'int',default:400},filters:{type:'array'},font:{default:'aileronsemibold'},hand:{type:'selector'},imagePath:{default:'.'},injectToRaycasterObjects:{default:!0},inputColor:{type:'color',default:'#6699ff'},interval:{type:'int',default:50},keyBgColor:{type:'color',default:'#000'},keyColor:{type:'color',default:'#6699ff'},keyHoverColor:{type:'color',default:'#1A407F'},keyPressColor:{type:'color',default:'#5290F6'},label:{type:'string',default:''},labelColor:{type:'color',default:'#aaa'},maxLength:{type:'int',default:0},model:{default:'basic'},show:{default:!0},value:{type:'string',default:''},width:{default:0.8}},init:function(){this.el.addEventListener('click',this.click.bind(this)),this.changeEventDetail={},this.textInputObject={},this.keys=null,this.focused=!1,this.keyHover=null,this.prevCheckTime=null,this.shift=!1,this.rawValue=this.data.value,this.defaultValue=this.data.value,this.userFilterFunc=null,this.intervalId=0,this.kbImg=document.createElement('a-entity'),this.kbImg.classList.add('keyboardRaycastable'),this.kbImg.classList.add('superKeyboardImage'),this.kbImg.addEventListener('raycaster-intersected',this.hover.bind(this)),this.kbImg.addEventListener('raycaster-intersected-cleared',this.blur.bind(this)),this.el.appendChild(this.kbImg),this.label=document.createElement('a-entity'),this.label.setAttribute('text',{align:'center',font:this.data.font,baseline:'bottom',lineHeight:40,shader:'msdf',negate:!0,value:this.data.label,color:this.data.labelColor,width:this.data.width,wrapCount:30}),this.el.appendChild(this.label),this.textInput=document.createElement('a-entity'),this.textInput.setAttribute('mixin','superKeyboardTextInput'),this.textInput.setAttribute('text',{align:this.data.align,font:this.data.font,lineHeight:35,value:this.data.value,color:this.data.inputColor,width:this.data.width,wrapCount:20}),this.el.appendChild(this.textInput),this.cursor=document.createElement('a-entity'),this.cursor.object3D.position.set(0,0,1e-3),this.cursor.setAttribute('material',{shader:'flat',color:this.data.inputColor}),this.textInput.appendChild(this.cursor),this.cursorUpdated=!1,this.keyBgColor=new THREE.Color,this.keyHoverColor=new THREE.Color,this.keyPressColor=new THREE.Color;var self=this;document.addEventListener('keydown',function(ev){if('t'===ev.key){for(var ss='',s='abcdefghijklmopqrstuvQWIEUTGASDLIGKBXACQWETL102394676457',l=_Mathfloor6(20*Math.random()),i=0;i<l;i++)ss+=s[_Mathfloor6(Math.random()*s.length)];self.el.setAttribute('super-keyboard',{value:ss})}}),document.addEventListener('show',this.open.bind(this)),this.hand=null,this.handListenersSet=!1,this.raycaster=null},update:function(oldData){var kbdata=KEYBOARDS[this.data.model],w=this.data.width,h=this.data.width/2;if(void 0===kbdata)return void console.error('super-keyboard ERROR: model "'+this.data.model+'" undefined.');oldData&&this.defaultValue===oldData.defaultValue?this.updateTextInput(this.filter(this.rawValue)):(this.rawValue=this.data.value,this.defaultValue=this.data.value,this.updateTextInput(this.filter(this.data.value))),(this.data.width!==oldData.width||this.data.height!==oldData.height||this.data.keyColor!==oldData.keyColor)&&(this.kbImg.setAttribute('geometry',{primitive:'plane',width:w,height:h}),this.kbImg.setAttribute('material',{shader:'flat',src:this.data.imagePath+'/'+kbdata.img,color:this.data.keyColor,transparent:!0})),(this.data.label!==oldData.label||this.data.labelColor!==oldData.labelColor||this.data.width!==oldData.width)&&(this.label.setAttribute('text',{value:this.data.label,color:this.data.labelColor,width:this.data.width}),this.label.object3D.position.set(0,0.35*w,-0.02)),(this.data.width!==oldData.width||this.data.keyBgColor!==oldData.keyBgColor)&&this.initKeyColorPlane();var inputx='center'===this.data.align?0:kbdata.inputOffsetX*w;'right'===this.data.align&&(inputx*=-1),(this.data.font!==oldData.font||this.data.inputColor!==oldData.inputColor||this.data.width!==oldData.width||this.data.align!==oldData.align)&&this.textInput.setAttribute('text',{font:this.data.font,color:this.data.inputColor,width:w,wrapCount:kbdata.wrapCount,align:this.data.align});for(var i=0,kdata;i<kbdata.layout.length;i++)kdata=kbdata.layout[i],'Insert'===kdata.key&&(this.inputRect=kdata);this.textInput.object3D.position.set(inputx,w/4-(this.inputRect.y+this.inputRect.h/2)*w/2+kbdata.inputOffsetY*w,2e-3),this.data.width!==oldData.width&&this.cursor.setAttribute('geometry',{primitive:'plane',width:0.03*w,height:0.01*w}),this.updateCursorPosition(),this.setupHand(),this.keyBgColor.set(this.data.keyBgColor),this.keyHoverColor.set(this.data.keyHoverColor),this.keyPressColor.set(this.data.keyPressColor),this.data.show?this.open():this.close()},tick:function(time){var intersection;if(!(this.prevCheckTime&&time-this.prevCheckTime<this.data.interval)){if(!this.prevCheckTime)return void(this.prevCheckTime=time);if(this.raycaster&&this.focused&&(intersection=this.raycaster.getIntersection(this.kbImg),!!intersection))for(var uv=intersection.uv,keys=KEYBOARDS[this.data.model].layout,i=0,k;i<keys.length;i++)if(k=keys[i],uv.x>k.x&&uv.x<k.x+k.w&&1-uv.y>k.y&&1-uv.y<k.y+k.h){this.keyHover!==k&&(this.keyHover=k,this.updateKeyColorPlane(this.keyHover.key,this.keyHoverColor));break}}},play:function(){this.cursorUpdated&&this.startBlinking()},pause:function(){this.stopBlinking()},initKeyColorPlane:function(){var kbdata=KEYBOARDS[this.data.model],keyColorPlane=this.keyColorPlane=document.createElement('a-entity');keyColorPlane.classList.add('superKeyboardKeyColorPlane'),keyColorPlane.object3D.position.z=1e-3,keyColorPlane.object3D.visible=!1,keyColorPlane.setAttribute('geometry',{primitive:'plane',buffer:!1}),keyColorPlane.setAttribute('material',{shader:'flat',color:this.data.keyBgColor,transparent:!0}),kbdata.hoverImg&&keyColorPlane.setAttribute('material',{src:this.data.imagePath+'/'+kbdata.hoverImg}),keyColorPlane.addEventListener('componentinitialized',function(evt){'material'===evt.detail.name&&(kbdata.hoverImg||(this.getObject3D('mesh').material.blending=THREE.AdditiveBlending))}),this.el.appendChild(keyColorPlane)},updateKeyColorPlane:function(key,color){var kbdata=KEYBOARDS[this.data.model],keyColorPlane=this.keyColorPlane;if(!key)return void(keyColorPlane.object3D.visible=!1);for(var i=0,kdata;i<kbdata.layout.length;i++)if(kdata=kbdata.layout[i],kdata.key===key){var w=this.data.width,h=this.data.width/2,keyw=kdata.w*w,keyh=kdata.h*h;keyColorPlane.object3D.scale.x=keyw,keyColorPlane.object3D.scale.y=keyh,keyColorPlane.object3D.position.x=kdata.x*w-w/2+keyw/2,keyColorPlane.object3D.position.y=(1-kdata.y)*h-h/2-keyh/2,keyColorPlane.getObject3D('mesh').material.color.copy(color);var geometry=keyColorPlane.getObject3D('mesh').geometry,uvSet=geometry.faceVertexUvs[0],kdataY=1-kdata.y;uvSet[0][0].set(kdata.x,kdataY),uvSet[0][1].set(kdata.x,kdataY-kdata.h),uvSet[0][2].set(kdata.x+kdata.w,kdataY),uvSet[1][0].set(kdata.x,kdataY-kdata.h),uvSet[1][1].set(kdata.x+kdata.w,kdataY-kdata.h),uvSet[1][2].set(kdata.x+kdata.w,kdataY),geometry.uvsNeedUpdate=!0;break}keyColorPlane.object3D.visible=!0},setupHand:function(){if(this.hand&&this.hand.ownRaycaster&&this.hand.removeAttribute('raycaster'),this.hand=this.data.hand?this.data.hand:document.querySelector(['[cursor]','[vive-controls]','[tracked-controls]','[oculus-touch-controls]','[windows-motion-controls]','[hand-controls]','[daydream-controls] [cursor] > [raycaster]'].join(',')),!this.hand)console.error('super-keyboard: no controller found. Add <a-entity> with controller or specify with super-keyboard="hand: #selectorToController".');else{if(!this.hand.hasLoaded)return void this.hand.addEventListener('loaded',this.setupHand.bind(this));var raycaster=this.hand.components.raycaster,params={};if(!raycaster)this.hand.ownRaycaster=!0,params.showLine=this.data.show,params.enabled=this.data.show,this.data.injectToRaycasterObjects&&(params.objects='.keyboardRaycastable'),this.hand.setAttribute('raycaster',params);else if(this.hand.ownRaycaster=!1,this.data.injectToRaycasterObjects){var objs=raycaster.data.objects.split(',');-1===objs.indexOf('.keyboardRaycastable')&&objs.push('.keyboardRaycastable'),params.objects=objs.join(',').replace(/^,/,''),this.hand.setAttribute('raycaster',params)}this.raycaster=this.hand.components.raycaster}},filter:function(str){if(''===str)return'';for(var i=0;i<this.data.filters.length;i++)switch(this.data.filters[i]){case'custom':{this.userFilterFunc&&(str=this.userFilterFunc(str));break}case'allupper':{str=str.toUpperCase();break}case'alllower':{str=str.toLowerCase();break}case'title':{str=str.split(' ').map(function(s){return s[0].toUpperCase()+s.substr(1)}).join(' ');break}case'numbers':{str=str.split('').filter(function(c){return!isNaN(parseInt(c))||'.'===c}).join('');break}case'first':{str=str[0].toUpperCase()+str.substr(1);break}case'trim':{str=str.trim();break}}return 0<this.data.maxLength?str.substr(0,this.data.maxLength):str},click:function(){if(this.keyHover){switch(this.keyHover.key){case'Enter':{this.accept();break}case'Insert':return;case'Delete':{this.rawValue=this.rawValue.substr(0,this.rawValue.length-1);var newValue=this.filter(this.rawValue);this.el.setAttribute('super-keyboard','value',newValue),this.updateTextInput(newValue),this.changeEventDetail.value=newValue,this.el.emit('superkeyboardchange',this.changeEventDetail);break}case'Shift':{this.shift=!this.shift,this.keyHover.el.setAttribute('material','color',this.shift?this.data.keyHoverColor:this.data.keyBgColor);break}case'Escape':{this.dismiss();break}default:{if(0<this.data.maxLength&&this.rawValue.length>this.data.maxLength)break;this.rawValue+=this.shift?this.keyHover.key.toUpperCase():this.keyHover.key;var newValue=this.filter(this.rawValue);this.el.setAttribute('super-keyboard','value',newValue),this.updateTextInput(newValue),this.changeEventDetail.value=newValue,this.el.emit('superkeyboardchange',this.changeEventDetail);break}}this.updateKeyColorPlane(this.keyHover.key,this.keyPressColor);var self=this;setTimeout(function(){self.updateKeyColorPlane(self.keyHover.key,self.keyHoverColor)},100),this.updateCursorPosition()}},open:function(){this.el.object3D.visible=!0,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!0,enabled:!0})},close:function(){this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1})},accept:function(){this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1}),this.el.emit('superkeyboardinput',{value:this.data.value}),this.data.show=!1},dismiss:function(){this.data.value=this.defaultValue,this.updateTextInput(),this.el.object3D.visible=!1,this.hand&&this.hand.ownRaycaster&&this.hand.setAttribute('raycaster',{showLine:!1,enabled:!1}),this.el.emit('superkeyboarddismiss'),this.data.show=!1},blur:function(){this.focused=!1,this.keyHover&&'Shift'!==this.keyHover.key&&this.updateKeyColorPlane(this.keyHover.key,this.keyBgColor),this.keyHover=null},hover:function(){this.focused=!0},startBlinking:function(){this.stopBlinking(),this.intervalId=window.setInterval(this.blink.bind(this),this.data.blinkingSpeed)},stopBlinking:function(){window.clearInterval(this.intervalId),this.intervalId=0},blink:function(){this.cursor.object3D.visible=!this.cursor.object3D.visible},setCustomFilter:function(f){this.userFilterFunc=f},addCustomModel:function(name,model){name&&(KEYBOARDS[name]=model)},updateCursorPosition:function(){var font=this.textInput.components.text.currentFont;if(!font){var self=this;return this.cursor.object3D.visible=!1,void window.setTimeout(function(){self.updateCursorPosition(),self.startBlinking()},700)}var w=this.data.width,kbdata=KEYBOARDS[this.data.model],posy=-this.inputRect.h/2*w/2.4+kbdata.inputOffsetY*w,ratio=this.data.width/this.textInput.components.text.data.wrapCount,pos=0,fontFactor=FontFactors[this.textInput.components.text.data.font];fontFactor===void 0&&(fontFactor=20);for(var i=0,char;i<this.data.value.length;i++)char=findFontChar(font.chars,this.data.value.charCodeAt(i)),pos+=char.width+char.xadvance*(32===char.id?2:1);'center'===this.data.align?pos=0.0011*(pos*ratio*fontFactor)/2+0.02*w:'left'===this.data.align?(pos=0.0011*(pos*ratio*fontFactor)+0.02*w,pos-=w/2):'right'===this.data.align&&(pos=0.0011*(-pos*ratio*fontFactor)-0.02*w,pos+=w/2),this.cursor.object3D.position.set(pos,posy,1e-3),this.cursorUpdated=!0},updateTextInput:function(value){this.textInputObject.value=value||this.data.value,this.textInput.setAttribute('text',this.textInputObject)}})},function(){AFRAME.registerShader('superCutFxShader',{schema:{startTime:{type:'float',is:'uniform'},timems:{type:'time',is:'uniform'}},vertexShader:`
    varying vec2 uvs;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
  `,fragmentShader:`
    uniform float startTime;
    uniform float timems;
    varying vec2 uvs;
    varying vec3 worldPos;

    #define COLOR vec3(0, 0.67, 0.98)

    void main() {
      float time = (timems - startTime) / 2000.0;
      vec2 p = uvs.xy - 0.5;
      float r = p.x * p.x + p.y * p.y;
      float alpha = 1.0 - smoothstep(time - 0.01, time, r);
      alpha *= smoothstep(time - 0.1, time, r);
      alpha *= 1.0 - time * 5.5;
      gl_FragColor = vec4(COLOR, alpha);
    }
  `})},function(){AFRAME.registerComponent('supercutfx',{init:function(){this.startTime=-1100},createSuperCut:function(position){const mesh=this.el.getObject3D('mesh');this.el.object3D.position.copy(position),this.el.object3D.position.z=-1,this.el.object3D.visible=!0,this.startTime=this.el.sceneEl.time,mesh.material.uniforms.startTime.value=this.startTime-50,this.el.play()},tick:function(time){time>this.startTime+1e3&&(this.el.object3D.visible=!1,this.el.pause())}})},function(){AFRAME.registerComponent('text-counter',{dependencies:['text'],schema:{decimals:{default:0},dur:{default:2e3,type:'int'},enabled:{default:!1},emit:{default:!1},prefix:{default:''},suffix:{default:''},value:{default:0,type:'float'}},init:function(){this.currentValue=0,this.hasCompleted=!1,this.textValue={value:''}},update:function(){this.currentValue=0,this.textValue.value=`${this.data.prefix}${this.decimals(0)}${this.data.suffix}`,this.el.setAttribute('text',this.textValue),this.hasCompleted=!1},tick:function(time,timeDelta){!this.data.enabled||this.hasCompleted||(this.currentValue+=this.data.value*(timeDelta/this.data.dur),this.currentValue>=this.data.value&&(this.currentValue=this.data.value,this.data.emit&&this.el.emit('textcounterdone',null,!1),this.hasCompleted=!0),this.textValue.value=`${this.data.prefix}${this.decimals(this.currentValue)}${this.data.suffix}`,this.el.setAttribute('text',this.textValue))},decimals:function(n){var d=Math.pow(10,this.data.decimals);return(parseInt(n*d)/d).toFixed(this.data.decimals)}})},function(){AFRAME.registerComponent('text-uppercase',{schema:{value:{type:'string'}},update:function(){this.el.setAttribute('text','value',this.data.value.toUpperCase())}})},function(){AFRAME.registerComponent('toggle-pause-play',{schema:{isPlaying:{default:!1}},update:function(){const action=this.data.isPlaying?'pause':'play';parent.postMessage(JSON.stringify({verify:'game-action',action}),'*')}})},function(){AFRAME.registerComponent('trail',{schema:{color:{type:'color'},enabled:{default:!1},hand:{type:'string'}},init:function(){var geometry=this.geometry=new THREE.BufferGeometry,maxPoints=this.maxPoints=12,vertices=this.vertices=new Float32Array(36*maxPoints),colors=this.colors=new Float32Array(48*maxPoints),bladeColor=this.bladeColor=new THREE.Color(this.data.color);this.bladeColor={red:bladeColor.r,green:bladeColor.g,blue:bladeColor.b,alpha:1},this.saberEl=this.el.querySelector('.blade'),this.layers=0,this.saberTrajectory=[{top:new THREE.Vector3(-0.5,0,0),center:new THREE.Vector3(0,0,0),bottom:new THREE.Vector3(0.5,0,0)},{top:new THREE.Vector3(-0.5,0.5,0),center:new THREE.Vector3(0,0.5,0),bottom:new THREE.Vector3(0.5,0.5,0)},{top:new THREE.Vector3(-0.5,1,0),center:new THREE.Vector3(0,1,0),bottom:new THREE.Vector3(0.5,1,0)}],geometry.addAttribute('position',new THREE.BufferAttribute(vertices,3).setDynamic(!0)),geometry.addAttribute('vertexColor',new THREE.BufferAttribute(colors,4).setDynamic(!0));const material=new THREE.ShaderMaterial({side:THREE.DoubleSide,vertexColors:THREE.VertexColors,transparent:!0,blending:THREE.AdditiveBlending,vertexShader:['varying vec4 vColor;','attribute vec4 vertexColor;','void main() {','vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);','vColor = vertexColor;','gl_Position = projectionMatrix * modelViewPosition;','}'].join(''),fragmentShader:['varying vec4 vColor;','void main() {','gl_FragColor = vColor;','}'].join('')}),mesh=this.mesh=new THREE.Mesh(geometry,material);mesh.frustumCulled=!1,mesh.vertices=vertices,this.el.sceneEl.setObject3D(`trail__${this.data.hand}`,mesh)},update:function(oldData){!oldData.enabled&&this.data.enabled&&(this.enabledTime=this.el.sceneEl.time,this.mesh.visible=!1),oldData.enabled&&!this.data.enabled&&(this.mesh.visible=!1)},tock:function(time){this.data.enabled&&(!this.mesh.visible&&time>this.enabledTime+250&&(this.mesh.visible=!0),this.sampleSaberPosition())},addLayer:function(length){var startX=-1,segments=this.segments,dx=2/segments,colors=this.colors,vertices=this.vertices,color=this.bladeColor;this.layers>=this.maxLayers&&(this.layers=0);const bottomLayer=this.layers*length;length=bottomLayer+length;const indexOffset=18*(this.layers*segments),colorOffset=24*(this.layers*segments);for(var i=0;i<segments;++i)vertices[indexOffset+18*i]=startX+i*dx,vertices[indexOffset+18*i+1]=bottomLayer,vertices[indexOffset+18*i+2]=0,colors[colorOffset+24*i]=color.red,colors[colorOffset+24*i+1]=color.green,colors[colorOffset+24*i+2]=color.blue,colors[colorOffset+24*i+3]=color.alpha,vertices[indexOffset+18*i+3]=startX+i*dx,vertices[indexOffset+18*i+4]=length,vertices[indexOffset+18*i+5]=0,colors[colorOffset+24*i+4]=color.red,colors[colorOffset+24*i+5]=color.green,colors[colorOffset+24*i+6]=color.blue,colors[colorOffset+24*i+7]=color.alpha,vertices[indexOffset+18*i+6]=startX+i*dx+dx,vertices[indexOffset+18*i+7]=length,vertices[indexOffset+18*i+8]=0,colors[colorOffset+24*i+8]=color.red,colors[colorOffset+24*i+9]=color.green,colors[colorOffset+24*i+10]=color.blue,colors[colorOffset+24*i+11]=color.alpha,vertices[indexOffset+18*i+9]=startX+i*dx+dx,vertices[indexOffset+18*i+10]=bottomLayer,vertices[indexOffset+18*i+11]=0,colors[colorOffset+24*i+12]=color.red,colors[colorOffset+24*i+13]=color.green,colors[colorOffset+24*i+14]=color.blue,colors[colorOffset+24*i+15]=color.alpha,vertices[indexOffset+18*i+12]=startX+i*dx,vertices[indexOffset+18*i+13]=bottomLayer,vertices[indexOffset+18*i+14]=0,colors[colorOffset+24*i+16]=color.red,colors[colorOffset+24*i+17]=color.green,colors[colorOffset+24*i+18]=color.blue,colors[colorOffset+24*i+19]=color.alpha,vertices[indexOffset+18*i+15]=startX+i*dx+dx,vertices[indexOffset+18*i+16]=length,vertices[indexOffset+18*i+17]=0,colors[colorOffset+24*i+20]=color.red,colors[colorOffset+24*i+21]=color.green,colors[colorOffset+24*i+22]=color.blue,colors[colorOffset+24*i+23]=color.alpha;this.layers++,this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.vertexColor.needsUpdate=!0,this.geometry.attributes.uv.needsUpdate=!0},initGeometry:function(){var saberTrajectory=this.saberTrajectory,vertices=this.geometry.attributes.position.array,colors=this.geometry.attributes.vertexColor.array,color=this.bladeColor,i,previousPoint,currentPoint,alpha,previousAlpha;for(i=1;i<saberTrajectory.length;i++)1===i&&(previousAlpha=alpha),alpha=1-(saberTrajectory.length-i)/saberTrajectory.length,currentPoint=saberTrajectory[i],previousPoint=saberTrajectory[i-1],vertices[36*i]=previousPoint.center.x,vertices[36*i+1]=previousPoint.center.y,vertices[36*i+2]=previousPoint.center.z,colors[48*i]=color.red,colors[48*i+1]=color.green,colors[48*i+2]=color.blue,colors[48*i+3]=0.2*previousAlpha,vertices[36*i+3]=currentPoint.top.x,vertices[36*i+4]=currentPoint.top.y,vertices[36*i+5]=currentPoint.top.z,colors[48*i+4]=color.red,colors[48*i+5]=color.green,colors[48*i+6]=color.blue,colors[48*i+7]=alpha,vertices[36*i+6]=previousPoint.top.x,vertices[36*i+7]=previousPoint.top.y,vertices[36*i+8]=previousPoint.top.z,colors[48*i+8]=color.red,colors[48*i+9]=color.green,colors[48*i+10]=color.blue,colors[48*i+11]=previousAlpha,vertices[36*i+9]=previousPoint.center.x,vertices[36*i+10]=previousPoint.center.y,vertices[36*i+11]=previousPoint.center.z,colors[48*i+12]=color.red,colors[48*i+13]=color.green,colors[48*i+14]=color.blue,colors[48*i+15]=0.2*previousAlpha,vertices[36*i+12]=currentPoint.center.x,vertices[36*i+13]=currentPoint.center.y,vertices[36*i+14]=currentPoint.center.z,colors[48*i+16]=color.red,colors[48*i+17]=color.green,colors[48*i+18]=color.blue,colors[48*i+19]=0.2*alpha,vertices[36*i+15]=currentPoint.top.x,vertices[36*i+16]=currentPoint.top.y,vertices[36*i+17]=currentPoint.top.z,colors[48*i+20]=color.red,colors[48*i+21]=color.green,colors[48*i+22]=color.blue,colors[48*i+23]=alpha,vertices[36*i+18]=previousPoint.bottom.x,vertices[36*i+19]=previousPoint.bottom.y,vertices[36*i+20]=previousPoint.bottom.z,colors[48*i+24]=color.red,colors[48*i+25]=color.green,colors[48*i+26]=color.blue,colors[48*i+27]=0,vertices[36*i+21]=currentPoint.center.x,vertices[36*i+22]=currentPoint.center.y,vertices[36*i+23]=currentPoint.center.z,colors[48*i+28]=color.red,colors[48*i+29]=color.green,colors[48*i+30]=color.blue,colors[48*i+31]=0.2*alpha,vertices[36*i+24]=previousPoint.center.x,vertices[36*i+25]=previousPoint.center.y,vertices[36*i+26]=previousPoint.center.z,colors[48*i+32]=color.red,colors[48*i+33]=color.green,colors[48*i+34]=color.blue,colors[48*i+35]=0.2*previousAlpha,vertices[36*i+27]=previousPoint.bottom.x,vertices[36*i+28]=previousPoint.bottom.y,vertices[36*i+29]=previousPoint.bottom.z,colors[48*i+36]=color.red,colors[48*i+37]=color.green,colors[48*i+38]=color.blue,colors[48*i+39]=0,vertices[36*i+30]=currentPoint.bottom.x,vertices[36*i+31]=currentPoint.bottom.y,vertices[36*i+32]=currentPoint.bottom.z,colors[48*i+40]=color.red,colors[48*i+41]=color.green,colors[48*i+42]=color.blue,colors[48*i+43]=0,vertices[36*i+33]=currentPoint.center.x,vertices[36*i+34]=currentPoint.center.y,vertices[36*i+35]=currentPoint.center.z,colors[48*i+44]=color.red,colors[48*i+45]=color.green,colors[48*i+46]=color.blue,colors[48*i+47]=0.2*alpha,previousAlpha=alpha;this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.vertexColor.needsUpdate=!0},sampleSaberPosition:function(){var saberEl=this.saberEl,saberObject,sample;this.saberTrajectory.length===this.maxPoints?(sample=this.saberTrajectory.shift(),sample.top.set(0,-0.4,0),sample.center.set(0,0,0),sample.bottom.set(0,0.4,0)):sample={top:new THREE.Vector3(0,-0.4,0),center:new THREE.Vector3(0,0,0),bottom:new THREE.Vector3(0,0.4,0)},saberObject=saberEl.object3D,saberObject.parent.updateMatrixWorld(),saberObject.localToWorld(sample.top),saberObject.localToWorld(sample.center),saberObject.localToWorld(sample.bottom),this.saberTrajectory.push(sample),this.initGeometry()}})},function(){AFRAME.registerComponent('tutorial-2d',{init:function(){this.el.sceneEl.canvas.style.display='none'},play:function(){this.el.sceneEl.canvas.style.display='block',document.getElementById('tutorial2d').style.display='none'}})},function(){var _Mathabs=Math.abs;const NUM_VALUES_PER_SEGMENT=75;AFRAME.registerComponent('twister',{schema:{enabled:{default:!1},twist:{default:0},vertices:{default:4,type:'int'},count:{default:12,type:'int'},positionIncrement:{default:1.4},radiusIncrement:{default:0.4},thickness:{default:0.37}},init:function(){this.currentTwist=0,this.animate=!1,this.geometry=null},pulse:function(twist){this.data.enabled&&(twist=0==twist?0.03+0.25*Math.random():Math.min(0.4*twist,0.4),twist*=0.5>Math.random()?-1:1,this.el.setAttribute('twister',{twist:twist}))},update:function(){var radius=6,segments=[];if(1e-3<_Mathabs(this.data.twist-this.currentTwist))return void(this.animate=!0);this.clear();for(var i=0;i<this.data.count;i++){let segment=this.createSegment(radius);segment.translate(0,this.data.positionIncrement*i,0),segments.push(segment),radius+=this.data.radiusIncrement}this.geometry=THREE.BufferGeometryUtils.mergeBufferGeometries(segments);var material=this.el.sceneEl.systems.materials.stageNormal,mesh=new THREE.Mesh(this.geometry,material);this.el.object3D.add(mesh)},createSegment:function(radius){const R=this.data.thickness;var points=[new THREE.Vector2(radius-R,R),new THREE.Vector2(radius-R,-R),new THREE.Vector2(radius+R,-R),new THREE.Vector2(radius+R,R),new THREE.Vector2(radius-R,R)],geometry;geometry=new THREE.LatheBufferGeometry(points,this.data.vertices);for(let i=0;i<geometry.attributes.uv.array.length;i+=2)geometry.attributes.uv.array[i]=0.77,geometry.attributes.uv.array[i+1]=1e-3;return geometry},clear:function(){this.el.object3D.remove(this.el.object3D.children[0]),this.geometry&&this.geometry.dispose(),this.geometry=new THREE.BufferGeometry},tick:function(time,delta){if(this.animate){var posArray=this.geometry.attributes.position.array,rotation,x,y,sin,cos,diff;delta*=1e-3,diff=(this.data.twist-this.currentTwist)*delta,this.currentTwist+=diff,rotation=3*diff;for(var s=0;s<this.data.count;s++){for(var i=0;i<NUM_VALUES_PER_SEGMENT;i+=3)cos=Math.cos(rotation),sin=Math.sin(rotation),x=posArray[s*NUM_VALUES_PER_SEGMENT+i],y=posArray[s*NUM_VALUES_PER_SEGMENT+i+2],posArray[s*NUM_VALUES_PER_SEGMENT+i]=x*cos-y*sin,posArray[s*NUM_VALUES_PER_SEGMENT+i+2]=y*cos+x*sin;rotation*=1.05}this.geometry.attributes.position.needsUpdate=!0,1e-3>_Mathabs(this.data.twist-this.currentTwist)&&(this.animate=!1)}}})},function(){var colorHelper=new THREE.Color;AFRAME.registerComponent('vertex-colors-buffer',{schema:{baseColor:{type:'color'},itemSize:{default:3}},update:function(oldData){var data=this.data,el=this.el,self=this,colors,i,geometry,mesh;if(mesh=this.el.getObject3D('mesh'),!mesh||!mesh.geometry)return void el.addEventListener('object3dset',function reUpdate(evt){'mesh'!==evt.detail.type||(el.removeEventListener('object3dset',reUpdate),self.update(oldData))});if(geometry=mesh.geometry,!geometry.attributes.position)return void console.warn('Geometry has no vertices',el);for(geometry.attributes.color||geometry.addAttribute('color',new THREE.BufferAttribute(new Float32Array(geometry.attributes.position.array.length),3)),colors=geometry.attributes.color.array,colorHelper.set(data.baseColor),i=0;i<colors.length;i+=data.itemSize)colors[i]=colorHelper.r,colors[i+1]=colorHelper.g,colors[i+2]=colorHelper.b;geometry.attributes.color.needsUpdate=!0}})},function(){AFRAME.registerComponent('victory-accuracy-ring',{dependencies:['geometry','material'],schema:{accuracy:{default:0}},update:function(){this.el.getObject3D('mesh').material.uniforms.progress.value=0,this.el.setAttribute('animation','to',this.data.accuracy/100),this.el.components.animation.beginAnimation()}})},function(){AFRAME.registerComponent('victory-rank',{schema:{rank:{type:'string'}},update:function(){const rank=this.data.rank;if(rank)switch(this.el.setAttribute('text','value',rank),rank[0]){case'S':{this.setColor('#FFF');break}case'A':{this.setColor('#c2d076');break}case'B':{this.setColor('#23f0c7');break}case'C':{this.setColor('#ffe347');break}case'D':{this.setColor('#ce6c47');break}case'F':{this.setColor('#960200');break}}},setColor:function(color){this.el.setAttribute('text','color',color)}})},function(){AFRAME.registerComponent('visible-raycastable',{schema:{default:!0},update:function(){this.el.object3D.visible=this.data,this.data?this.el.setAttribute('raycastable',''):this.el.removeAttribute('raycastable','')}})},function(module,exports,__webpack_require__){const COLORS=__webpack_require__(6),WALL_COLOR=new THREE.Color(COLORS.NEON_RED),WALL_BG=new THREE.Color(COLORS.SKY_RED);AFRAME.registerShader('wallShader',{schema:{iTime:{type:'time',is:'uniform'},hitRight:{type:'vec3',is:'uniform',default:{x:0,y:1,z:0}},hitLeft:{type:'vec3',is:'uniform',default:{x:0,y:0,z:0}}},vertexShader:`
    varying vec2 uvs;
    varying vec3 nrml;
    varying vec3 worldPos;
    void main() {
      uvs.xy = uv.xy;
      nrml.xyz = normal.xyz;
      vec4 p = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      worldPos = (modelMatrix * vec4( position, 1.0 )).xyz;
      gl_Position = p;
    }
  `,fragmentShader:`
    varying vec2 uvs;
    varying vec3 nrml;
    varying vec3 worldPos;
    uniform float iTime;
    //uniform sampler2D env;
    uniform vec3 hitRight;
    uniform vec3 hitLeft;

    #define SEED 19.1254
    #define time (3.0 + iTime)/1000.0 * 0.15

    float noise(vec3 uv) {
      return fract(sin(uv.x*123243. + uv.y*424. + uv.z*642. + SEED) * 1524.);
    }

    vec3 drawCircle(vec3 p, vec3 center, float radius, float edgeWidth, vec3 color) {
      return color * (1.0 - smoothstep(radius, radius + edgeWidth, length(p - center)));
    }

    float smoothNoise(vec3 uvw, float frec){
      vec3 luvw = vec3(smoothstep(0.0, 1.0, fract(uvw.xy * frec)), fract(uvw.z * frec));
      vec3 id = floor(uvw * frec);
      float blt = noise(id);
      float brt = noise(id + vec3(1.0, 0.0, 0.0));
      float tlt = noise(id + vec3(0.0, 1.0, 0.0));
      float trt = noise(id + vec3(1.0, 1.0, 0.0));

      float blb = noise(id + vec3(0.0, 0.0, 1.0));
      float brb = noise(id + vec3(1.0, 0.0, 1.0));
      float tlb = noise(id + vec3(0.0, 1.0, 1.0));
      float trb = noise(id + vec3(1.0, 1.0, 1.0));

      float a = mix(blt, brt, luvw.x);
      float b = mix(tlt, trt, luvw.x);
      float c = mix(a, b, luvw.y);

      float d = mix(blb, brb, luvw.x);
      float e = mix(tlb, trb, luvw.x);
      float f = mix(d, e, luvw.y);

      return mix(c, f, luvw.z);
    }

    #define WALL_COLOR vec3(${WALL_COLOR.r}, ${WALL_COLOR.g}, ${WALL_COLOR.b})
    #define WALL_BG vec3(${WALL_BG.r}, ${WALL_BG.g}, ${WALL_BG.b})

    void main() {
      vec2 uv1 = uvs.xy-0.5;
      float angle = time / 10.0;
      vec2 uv;
      uv.x = uv1.x * cos(angle) - uv1.y * sin(angle);
      uv.y = uv1.y * cos(angle) + uv1.x * sin(angle);
      uv.x += sin(uv.y * 2.7 + time / 1.7) * 0.2;
      uv.y += sin(uv.x * 3.1 + time / 2.4) * 0.3;

      float w, r, bg;
      r = smoothNoise(vec3(uv + worldPos.x, time / 2.0), 3.0) * 0.65;
      r += smoothNoise(vec3(uv, time / 6.0), 8.0) * 0.3;
      r += smoothNoise(vec3(uv, time / 14.0), 50.0) * 0.04;

      bg = smoothstep(0.5, 1.0, r) + smoothstep(0.5, 0.0, r);
      r = smoothstep(0.4, 0.50, r) - smoothstep(0.50, 0.6, r);
      w = smoothstep(0.97, 1.0, r);


      r += smoothstep(0.44, 0.50, abs(uv1.x));
      r += smoothstep(0.44, 0.50, abs(uv1.y));

      w += smoothstep(0.49, 0.498, abs(uv1.x));
      w += smoothstep(0.49, 0.498, abs(uv1.y));

      w *= 0.9;
      bg *= 0.5;

      vec3 COL = WALL_COLOR;
      vec3 BG = WALL_BG * 0.1;

      vec3 col = vec3(r * COL.r + w + BG.r, r * COL.g + w + BG.g, r * COL.b + w + BG.b);

      vec3 hit;
      hit = drawCircle(worldPos, hitRight, 0.04, 0.05, COL);
      hit += drawCircle(worldPos, hitRight, 0.02, 0.03, vec3(0.7, 0.7, 0.7));
      hit += drawCircle(worldPos, hitLeft, 0.04, 0.05, COL);
      hit += drawCircle(worldPos, hitLeft, 0.02, 0.03, vec3(0.7, 0.7, 0.7));

      gl_FragColor = vec4(col + hit, 0.7 + w + hit.x);
    }
`})},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__constants_beat__=__webpack_require__(10);const CEILING_THICKNESS=1.5;AFRAME.registerComponent('wall',{schema:{anticipationPosition:{default:0},durationSeconds:{default:0},height:{default:1.3},horizontalPosition:{default:'middleleft',oneOf:['left','middleleft','middleright','right']},isCeiling:{default:!1},speed:{default:1},warmupPosition:{default:0},width:{default:1}},horizontalPositions:{left:-0.75,middleleft:-0.25,middleright:0.25,right:0.75},init:function(){this.maxZ=10},update:function(){const el=this.el,data=this.data,width=data.width*0.5,halfDepth=data.durationSeconds*data.speed/2;return data.isCeiling?(el.object3D.position.set(0,1.4+CEILING_THICKNESS/2,data.anticipationPosition+data.warmupPosition-halfDepth),void el.object3D.scale.set(width,CEILING_THICKNESS,data.durationSeconds*data.speed)):void(el.object3D.position.set(this.horizontalPositions[data.horizontalPosition]+width/2-0.25,data.height+0.1,data.anticipationPosition+data.warmupPosition-halfDepth),el.object3D.scale.set(width,2.5,data.durationSeconds*data.speed))},pause:function(){this.el.object3D.visible=!1,this.el.removeAttribute('data-collidable-head')},play:function(){this.el.object3D.visible=!0,this.el.setAttribute('data-collidable-head',''),this.el.setAttribute('data-saber-particles',''),this.el.setAttribute('raycastable-game','')},tock:function(time,timeDelta){const data=this.data,halfDepth=data.durationSeconds*data.speed/2,position=this.el.object3D.position;if(position.z<data.anticipationPosition-halfDepth){let newPositionZ=position.z+__WEBPACK_IMPORTED_MODULE_0__constants_beat__.a*(timeDelta/1e3);position.z=newPositionZ<data.anticipationPosition-halfDepth?newPositionZ:data.anticipationPosition-halfDepth}else position.z+=this.data.speed*(timeDelta/1e3);return this.el.object3D.position.z>this.maxZ+halfDepth?void this.returnToPool():void 0},returnToPool:function(){this.el.sceneEl.components.pool__wall.returnEntity(this.el),this.el.object3D.position.z=9999,this.el.pause(),this.el.removeAttribute('data-collidable-head'),this.el.removeAttribute('raycastable-game')}})},function(module){module.exports=[{name:'Pop',row:1,column:1},{name:'R&B',row:1,column:2},{name:'Rap',row:1,column:3},{name:'Rock',row:1,column:4},{name:'Soundtrack',row:1,column:5},{name:'Video Games',row:1,column:6},{name:'Electronic',row:2,column:1},{name:'Hip Hop',row:2,column:2},{name:'House',row:2,column:3},{name:'J-Pop',row:2,column:4},{name:'K-Pop',row:2,column:5},{name:'Meme',row:2,column:6},{name:'Alternative',row:3,column:1},{name:'Anime',row:3,column:2},{name:'Comedy',row:3,column:3},{name:'Disney',row:3,column:4},{name:'Dubstep',row:3,column:5},{name:'EDM',row:3,column:6}]},function(module,exports,__webpack_require__){function requireAll(req){req.keys().forEach(req)}__webpack_require__(12),__webpack_require__(20),__webpack_require__(11),__webpack_require__(21),__webpack_require__(22),__webpack_require__(23),__webpack_require__(24),__webpack_require__(25),__webpack_require__(26),__webpack_require__(27),__webpack_require__(28),__webpack_require__(30),__webpack_require__(29),__webpack_require__(31),requireAll(__webpack_require__(33)),requireAll(__webpack_require__(34)),__webpack_require__(32)},function(module){module.exports=function SoundPool(src,volume){var currSound=0,pool=[],sound;return sound=new Audio(src),sound.volume=volume,pool.push(sound),{play:function(){0===pool[currSound].currentTime&&pool[currSound].ended||(sound=new Audio(src),sound.volume=volume,pool.push(sound),currSound++),(0===pool[currSound].currentTime||pool[currSound].ended)&&pool[currSound].play(),currSound=(currSound+1)%pool.length}}}},function(module,exports,__webpack_require__){function computeSearchPagination(state){let numPages=_Mathceil(state.search.results.length/SEARCH_PER_PAGE);state.search.hasPrev=0<state.search.page,state.search.hasNext=state.search.page<numPages-1,state.search.songNameTexts='',state.search.songSubNameTexts='',state.searchResultsPage.length=0,state.searchResultsPage.__dirty=!0;for(let i=state.search.page*SEARCH_PER_PAGE;i<state.search.page*SEARCH_PER_PAGE+SEARCH_PER_PAGE&&!!state.search.results[i];i++)state.searchResultsPage.push(state.search.results[i]),state.search.songNameTexts+=truncate(state.search.results[i].songName,SONG_NAME_TRUNCATE).toUpperCase()+'\n',state.search.songSubNameTexts+=truncate(state.search.results[i].songSubName,SONG_SUB_NAME_TRUNCATE)+'\n';for(let i=0;i<state.searchResultsPage.length;i++)state.searchResultsPage[i].index=i;computeMenuSelectedChallengeIndex(state)}function truncate(str,length){return str?str.length>=length?str.substring(0,length-3)+'...':str:''}function difficultyComparator(a,b){const aIndex=DIFFICULTIES.indexOf(a),bIndex=DIFFICULTIES.indexOf(b);return aIndex<bIndex?-1:aIndex>bIndex?1:0}function takeDamage(state){state.isPlaying&&(state.score.combo=0,state.score.multiplier=1<state.score.multiplier?_Mathceil(state.score.multiplier/2):1,AFRAME.utils.getUrlParameter('godmode')||(state.damage++,checkGameOver(state)))}function checkGameOver(state){state.damage>=DAMAGE_MAX&&(state.damage=0,state.isGameOver=!0)}function resetScore(state){state.damage=0,state.score.beatsHit=0,state.score.beatsMissed=0,state.score.combo=0,state.score.maxCombo=0,state.score.score=0,state.score.multiplier=1}function computeMenuSelectedChallengeIndex(state){state.menuSelectedChallenge.index=-1;for(let i=0;i<state.searchResultsPage.length;i++)if(state.searchResultsPage[i].id===state.menuSelectedChallenge.id){state.menuSelectedChallenge.index=i;break}}function formatSongLength(songLength){songLength/=60;const minutes=`${_Mathfloor7(songLength)}`;return`${minutes}:${Math.round(60*(songLength-minutes))}`}function computeBeatsText(state){state.score.beatsText=`${state.score.beatsHit} / ${state.score.beatsMissed+state.score.beatsHit} BEATS`}function clearLeaderboard(state){state.leaderboard.length=0,state.leaderboard.__dirty=!0,state.leaderboardNames='',state.leaderboardScores='',state.leaderboardFetched=!1}function updateMenuSongInfo(state,challenge){state.menuSelectedChallenge.songInfoText=`By ${truncate(challenge.author,12)} ${challenge.genre&&'Uncategorized'!==challenge.genre?'/ '+challenge.genre:''}\n${challenge.downloads} Downloads\nUpvotes: ${challenge.upvotes} / Downvotes: ${challenge.downvotes}\n${formatSongLength(challenge.songDuration)} / ${challenge.numBeats[state.menuSelectedChallenge.difficulty]} beats`}function updateScoreAccuracy(state){const currentNumBeats=state.score.beatsHit+state.score.beatsMissed;state.score.accuracy=100*(state.score.score/(110*currentNumBeats))}var _Mathfloor7=Math.floor,_Mathceil=Math.ceil,utils=__webpack_require__(2);const challengeDataStore={},SEARCH_PER_PAGE=6,SONG_NAME_TRUNCATE=24,SONG_SUB_NAME_TRUNCATE=32,DAMAGE_DECAY=0.25,DAMAGE_MAX=10,DEBUG_CHALLENGE={author:'Superman',difficulty:'Expert',id:'31',image:'assets/img/molerat.jpg',songName:'Friday',songLength:100,songSubName:'Rebecca Black'};AFRAME.registerState({nonBindedStateKeys:['genres'],initialState:{activeHand:localStorage.getItem('hand')||'right',challenge:{author:'',difficulty:'',id:AFRAME.utils.getUrlParameter('challenge'),image:'',isLoading:!1,isBeatsPreloaded:!1,numBeats:void 0,songDuration:0,songName:'',songSubName:''},controllerType:'',damage:0,genre:'',genres:__webpack_require__(131),genreMenuOpen:!1,inVR:!1,isGameOver:!1,isPaused:!1,isPlaying:!1,isSearching:!1,isSongFetching:!1,isSongLoading:!1,isVictory:!1,leaderboard:[],leaderboardFetched:!1,leaderboardQualified:!1,leaderboardNames:'',leaderboardScores:'',menuActive:!0,menuDifficulties:[],menuSelectedChallenge:{author:'',difficulty:'',downloads:'',downloadsText:'',genre:'',id:'',index:-1,image:'',numBeats:void 0,songDuration:0,songInfoText:'',songLength:void 0,songName:'',songSubName:''},score:{accuracy:0,beatsHit:0,beatsMissed:0,beatsText:'',combo:0,maxCombo:0,multiplier:1,rank:'',score:0},search:{active:!0,page:0,hasError:!1,hasNext:!1,hasPrev:!1,query:'',results:[],songNameTexts:'',songSubNameTexts:''},searchResultsPage:[]},handlers:{activehandswap:state=>{state.activeHand='right'===state.activeHand?'left':'right',localStorage.setItem('activeHand',state.activeHand)},beathit:(state,payload)=>{state.damage>DAMAGE_DECAY&&(state.damage-=DAMAGE_DECAY),state.score.beatsHit++,state.score.combo++,state.score.combo>state.score.maxCombo&&(state.score.maxCombo=state.score.combo),state.score.score+=_Mathfloor7(payload.score*state.score.multiplier),state.score.multiplier=2>state.score.combo?1:6>state.score.combo?2:14>state.score.combo?4:8,updateScoreAccuracy(state)},beatmiss:state=>{state.score.beatsMissed++,takeDamage(state),updateScoreAccuracy(state)},beatwrong:state=>{state.score.beatsMissed++,takeDamage(state),updateScoreAccuracy(state)},beatloaderfinish:state=>{state.challenge.isLoading=!1},beatloaderpreloadfinish:state=>{state.menuActive||(state.challenge.isBeatsPreloaded=!0)},beatloaderstart:state=>{state.challenge.isBeatsPreloaded=!1,state.challenge.isLoading=!0},controllerconnected:(state,payload)=>{state.controllerType=payload.name},debuggameplay:state=>{resetScore(state),Object.assign(state.challenge,state.menuSelectedChallenge),state.menuActive=!1,state.menuSelectedChallenge.id='',state.isSearching=!1,state.isSongLoading=!1},debuggameover:state=>{state.isGameOver=!0,state.menuActive=!1},debugloading:state=>{DEBUG_CHALLENGE.id='-1',Object.assign(state.menuSelectedChallenge,DEBUG_CHALLENGE),Object.assign(state.challenge,DEBUG_CHALLENGE),state.menuActive=!1,state.isSongFetching=!0,state.isSongLoading=!0},debugvictory:state=>{Object.assign(state.menuSelectedChallenge,DEBUG_CHALLENGE),Object.assign(state.challenge,DEBUG_CHALLENGE),state.isVictory=!0,state.leaderboardQualified=!0,state.menuActive=!1,state.score.accuracy=74.99,state.score.beatsHit=125,state.score.beatsMissed=125,state.score.maxCombo=123,state.score.rank='C',state.score.score=9001,computeBeatsText(state)},gamemenuresume:state=>{state.isPaused=!1},gamemenurestart:state=>{resetScore(state),state.challenge.isBeatsPreloaded=!1,state.isGameOver=!1,state.isPaused=!1,state.isSongLoading=!0,state.isVictory=!1,state.leaderboardQualified=!1},gamemenuexit:state=>{resetScore(state),state.challenge.isBeatsPreloaded=!1,state.isGameOver=!1,state.isPaused=!1,state.isVictory=!1,state.menuActive=!0,state.challenge.id='',state.leaderboardQualified=!1},genreclear:state=>{state.genre=''},genremenuclose:state=>{state.genreMenuOpen=!1},genremenuopen:state=>{state.genreMenuOpen=!0},keyboardclose:state=>{state.isSearching=!1},keyboardopen:state=>{state.isSearching=!0,state.menuSelectedChallenge.id=''},leaderboard:(state,payload)=>{state.leaderboard.length=0,state.leaderboardFetched=!0,state.leaderboardNames='',state.leaderboardScores='';for(let i=0,score;i<payload.scores.length;i++)score=payload.scores[i],state.leaderboard.push(score),state.leaderboardNames+=`${score.username} (${score.accuracy||0}%)\n`,state.leaderboardScores+=`${score.score}\n`;state.leaderboardLoading=!1},leaderboardqualify:state=>{state.leaderboardQualified=!0},leaderboardscoreadded:(state,payload)=>{state.leaderboard.splice(payload.index,0,payload.scoreData),state.leaderboardNames='',state.leaderboardScores='';for(let i=0,score;i<10;i++)score=state.leaderboard[i],state.leaderboardNames+=`${score.username} (${score.accuracy||0}%)\n`,state.leaderboardScores+=`${score.score}\n`},leaderboardsubmit:state=>{state.leaderboardQualified=!1},menuchallengeselect:(state,id)=>{let challenge=challengeDataStore[id];Object.assign(state.menuSelectedChallenge,challenge),state.menuDifficulties.length=0;for(let i=0;i<challenge.difficulties.length;i++)state.menuDifficulties.unshift(challenge.difficulties[i]);state.menuDifficulties.sort(difficultyComparator),state.menuSelectedChallenge.difficulty=state.menuDifficulties[0],state.menuSelectedChallenge.image=utils.getS3FileUrl(id,'image.jpg'),updateMenuSongInfo(state,challenge),computeMenuSelectedChallengeIndex(state),state.isSearching=!1,clearLeaderboard(state),state.leaderboardLoading=!0},menuchallengeunselect:state=>{state.menuSelectedChallenge.id='',clearLeaderboard(state)},menudifficultyselect:(state,difficulty)=>{state.menuSelectedChallenge.difficulty=difficulty,updateMenuSongInfo(state,state.menuSelectedChallenge),clearLeaderboard(state),state.leaderboardLoading=!0},minehit:state=>{takeDamage(state)},pausegame:state=>{state.isPlaying&&(state.isPaused=!0)},playbuttonclick:state=>{resetScore(state),Object.assign(state.challenge,state.menuSelectedChallenge),state.menuActive=!1,state.menuSelectedChallenge.id='',state.isSearching=!1,state.isSongLoading=!0},searcherror:state=>{state.search.hasError=!0},searchprevpage:function(state){0===state.search.page||(state.search.page--,computeSearchPagination(state))},searchnextpage:function(state){state.search.page>_Mathfloor7(state.search.results.length/SEARCH_PER_PAGE)||(state.search.page++,computeSearchPagination(state))},searchresults:(state,payload)=>{var i;for(state.search.hasError=!1,state.search.page=0,state.search.query=payload.query,state.search.results=payload.results,i=0;i<payload.results.length;i++){let result=payload.results[i];result.songSubName=result.songSubName||'Unknown Artist',result.shortSongName=truncate(result.songName,SONG_NAME_TRUNCATE).toUpperCase(),result.shortSongSubName=truncate(result.songSubName,SONG_SUB_NAME_TRUNCATE),challengeDataStore[result.id]=result}computeSearchPagination(state),payload.isGenreSearch?(state.genreMenuOpen=!1,state.genre=payload.genre,state.menuSelectedChallenge.id=''):(state.genre='',computeMenuSelectedChallengeIndex(state))},songfetchfinish:state=>{state.isSongFetching=!1},songloadcancel:state=>{state.challenge.isBeatsPreloaded=!1,state.challenge.isLoading=!1,state.isSongLoading=!1,state.isSongFetching=!1,state.menuActive=!0},songloadfinish:state=>{state.isSongFetching=!1,state.isSongLoading=!1},songloadstart:state=>{state.isSongFetching=!0,state.isSongLoading=!0},"enter-vr":state=>{state.inVR=!0},"exit-vr":state=>{state.inVR=!1},victory:function(state){state.isVictory=!0;const accuracy=100*(state.score.score/(110*state.challenge.numBeats));state.score.accuracy=isNaN(accuracy)?0:accuracy,state.score.score=isNaN(state.score.score)?0:state.score.score,state.score.rank=95<=accuracy?'S':93<=accuracy?'A':90<=accuracy?'A-':88<=accuracy?'B+':83<=accuracy?'B':80<=accuracy?'B-':78<=accuracy?'C+':73<=accuracy?'C':70<=accuracy?'C-':60<=accuracy?'D':'F',computeBeatsText(state)},victoryfake:function(state){state.score.accuracy='74.99',state.score.rank='C'},wallhitstart:function(state){takeDamage(state)}},computeState:state=>{state.isPlaying=!state.menuActive&&!state.isPaused&&!state.isVictory&&!state.isGameOver&&!state.challenge.isLoading&&!state.isSongLoading&&!!state.challenge.id;const anyMenuOpen=state.menuActive||state.isPaused||state.isVictory||state.isGameOver||state.isSongLoading||state.isSongFetching;state.leftRaycasterActive=anyMenuOpen&&'left'===state.activeHand&&state.inVR,state.rightRaycasterActive=anyMenuOpen&&'right'===state.activeHand&&state.inVR,state.loadingText=state.isSongLoading?state.isSongFetching?'Downloading song...':'Processing song...':''}});const DIFFICULTIES=['Easy','Normal','Hard','Expert','ExpertPlus']},function(module,exports,__webpack_require__){var escape=__webpack_require__(137);exports=module.exports=__webpack_require__(136)(!1),exports.push([module.i,'html {\n  background: #000;\n}\n\n#vrButton {\n  position: absolute;\n  background: url('+escape(__webpack_require__(150))+') no-repeat;\n  background-size: cover;\n  border: 0;\n  cursor: pointer;\n  right: 20px;\n  bottom: 20px;\n  z-index: 9999999;\n  width: 84px;\n  height: 47px;\n}\n\n#vrButton.a-hidden {\n  visibility: hidden;\n}\n\n#vrButton:active {\n  border: 0;\n}\n\n#vrButton:hover {\n  background-position: 0 -50.5px;\n}\n\n.a-loader-title {\n  animation: loaderTitle 1s infinite alternate;\n  color: rgba(0,0,0,0);\n  background: none;\n  background-image: url('+escape(__webpack_require__(151))+');\n  height: 36.2vh;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-top: 0;\n  background-size: contain;\n  margin-left: -1vh;\n}\n\n@keyframes loaderTitle {\n  0% { opacity: 1; }\n  50% { opacity: 0.8; }\n  100% { opacity: 1; }\n}\n\n#tutorial2d {\n  position: absolute;\n  width: 60%;\n  left: 20%;\n  top: 35%;\n}\n\n@media (max-width: 1280px) {\n  #tutorial2d {\n    width: 80%;\n    left: 10%;\n  }\n}\n',''])},function(module){function cssWithMappingToString(item,useSourceMap){var content=item[1]||'',cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&'function'==typeof btoa){var sourceMapping=toComment(cssMapping),sourceURLs=cssMapping.sources.map(function(source){return'/*# sourceURL='+cssMapping.sourceRoot+source+' */'});return[content].concat(sourceURLs).concat([sourceMapping]).join('\n')}return[content].join('\n')}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));return'/*# '+('sourceMappingURL=data:application/json;charset=utf-8;base64,'+base64)+' */'}module.exports=function(useSourceMap){var list=[];return list.toString=function toString(){return this.map(function(item){var content=cssWithMappingToString(item,useSourceMap);return item[2]?'@media '+item[2]+'{'+content+'}':content}).join('')},list.i=function(modules,mediaQuery){'string'==typeof modules&&(modules=[[null,modules,'']]);for(var alreadyImportedModules={},i=0,id;i<this.length;i++)id=this[i][0],'number'==typeof id&&(alreadyImportedModules[id]=!0);for(i=0;i<modules.length;i++){var item=modules[i];'number'==typeof item[0]&&alreadyImportedModules[item[0]]||(mediaQuery&&!item[2]?item[2]=mediaQuery:mediaQuery&&(item[2]='('+item[2]+') and ('+mediaQuery+')'),list.push(item))}},list}},function(module){module.exports=function escape(url){return'string'==typeof url?(/^['"].*['"]$/.test(url)&&(url=url.slice(1,-1)),/["'() \t\n]/.test(url)?'"'+url.replace(/"/g,'\\"').replace(/\n/g,'\\n')+'"':url):url}},function(module,exports){function selectColor(){return exports.colors[prevColor++%exports.colors.length]}exports=module.exports=function debug(namespace){function disabled(){}function enabled(){var self=enabled;null==self.useColors&&(self.useColors=exports.useColors()),null==self.color&&self.useColors&&(self.color=selectColor());var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]),'string'!=typeof args[0]&&(args=['%o'].concat(args));var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if('%%'===match)return match;index++;var formatter=exports.formatters[format];if('function'==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),'function'==typeof exports.formatArgs&&(args=exports.formatArgs.apply(self,args));var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}disabled.enabled=!1,enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;return fn.namespace=namespace,fn},exports.coerce=function coerce(val){return val instanceof Error?val.stack||val.message:val},exports.disable=function disable(){exports.enable('')},exports.enable=function enable(namespaces){exports.save(namespaces);for(var split=(namespaces||'').split(/[\s,]+/),len=split.length,i=0;i<len;i++)split[i]&&(namespaces=split[i].replace(/\*/g,'.*?'),'-'===namespaces[0]?exports.skips.push(new RegExp('^'+namespaces.substr(1)+'$')):exports.names.push(new RegExp('^'+namespaces+'$')))},exports.enabled=function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++)if(exports.skips[i].test(name))return!1;for(i=0,len=exports.names.length;i<len;i++)if(exports.names[i].test(name))return!0;return!1},exports.names=[],exports.skips=[],exports.formatters={};var prevColor=0},function(module,exports,__webpack_require__){(function(process,global){(function(global,factory){module.exports=factory()})(this,function(){'use strict';function objectOrFunction(x){var type=typeof x;return null!==x&&('object'==type||'function'==type)}function isFunction(x){return'function'==typeof x}function useVertxTimer(){return'undefined'==typeof vertxNext?useSetTimeout():function(){vertxNext(flush)}}function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1)}}function flush(){for(var i=0;i<len;i+=2){var callback=queue[i],arg=queue[i+1];callback(arg),queue[i]=void 0,queue[i+1]=void 0}len=0}function then(onFulfillment,onRejection){var parent=this,child=new this.constructor(noop);void 0===child[PROMISE_ID]&&makePromise(child);var _state=parent._state;if(_state){var callback=arguments[_state-1];asap(function(){return invokeCallback(_state,child,callback,parent._result)})}else subscribe(parent,child,onFulfillment,onRejection);return child}function resolve$1(object){var Constructor=this;if(object&&'object'==typeof object&&object.constructor===Constructor)return object;var promise=new Constructor(noop);return resolve(promise,object),promise}function noop(){}function selfFulfillment(){return new TypeError('You cannot resolve a promise with itself')}function cannotReturnOwn(){return new TypeError('A promises callback cannot return that same promise.')}function getThen(promise){try{return promise.then}catch(error){return TRY_CATCH_ERROR.error=error,TRY_CATCH_ERROR}}function tryThen(then$$1,value,fulfillmentHandler,rejectionHandler){try{then$$1.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function handleForeignThenable(promise,thenable,then$$1){asap(function(promise){var sealed=!1,error=tryThen(then$$1,thenable,function(value){sealed||(sealed=!0,thenable===value?fulfill(promise,value):resolve(promise,value))},function(reason){sealed||(sealed=!0,reject(promise,reason))},'Settle: '+(promise._label||' unknown promise'));!sealed&&error&&(sealed=!0,reject(promise,error))},promise)}function handleOwnThenable(promise,thenable){thenable._state===FULFILLED?fulfill(promise,thenable._result):thenable._state===REJECTED?reject(promise,thenable._result):subscribe(thenable,void 0,function(value){return resolve(promise,value)},function(reason){return reject(promise,reason)})}function handleMaybeThenable(promise,maybeThenable,then$$1){maybeThenable.constructor===promise.constructor&&then$$1===then&&maybeThenable.constructor.resolve===resolve$1?handleOwnThenable(promise,maybeThenable):then$$1===TRY_CATCH_ERROR?(reject(promise,TRY_CATCH_ERROR.error),TRY_CATCH_ERROR.error=null):void 0===then$$1?fulfill(promise,maybeThenable):isFunction(then$$1)?handleForeignThenable(promise,maybeThenable,then$$1):fulfill(promise,maybeThenable)}function resolve(promise,value){promise===value?reject(promise,selfFulfillment()):objectOrFunction(value)?handleMaybeThenable(promise,value,getThen(value)):fulfill(promise,value)}function publishRejection(promise){promise._onerror&&promise._onerror(promise._result),publish(promise)}function fulfill(promise,value){promise._state!==PENDING||(promise._result=value,promise._state=FULFILLED,0!==promise._subscribers.length&&asap(publish,promise))}function reject(promise,reason){promise._state!==PENDING||(promise._state=REJECTED,promise._result=reason,asap(publishRejection,promise))}function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers,length=_subscribers.length;parent._onerror=null,_subscribers[length]=child,_subscribers[length+FULFILLED]=onFulfillment,_subscribers[length+REJECTED]=onRejection,0===length&&parent._state&&asap(publish,parent)}function publish(promise){var subscribers=promise._subscribers,settled=promise._state;if(0!==subscribers.length){for(var child=void 0,callback=void 0,detail=promise._result,i=0;i<subscribers.length;i+=3)child=subscribers[i],callback=subscribers[i+settled],child?invokeCallback(settled,child,callback,detail):callback(detail);promise._subscribers.length=0}}function tryCatch(callback,detail){try{return callback(detail)}catch(e){return TRY_CATCH_ERROR.error=e,TRY_CATCH_ERROR}}function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value,error,succeeded,failed;if(!hasCallback)value=detail,succeeded=!0;else if(value=tryCatch(callback,detail),value===TRY_CATCH_ERROR?(failed=!0,error=value.error,value.error=null):succeeded=!0,promise===value)return void reject(promise,cannotReturnOwn());promise._state!==PENDING||(hasCallback&&succeeded?resolve(promise,value):failed?reject(promise,error):settled===FULFILLED?fulfill(promise,value):settled===REJECTED&&reject(promise,value))}function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){resolve(promise,value)},function rejectPromise(reason){reject(promise,reason)})}catch(e){reject(promise,e)}}function nextId(){return id++}function makePromise(promise){promise[PROMISE_ID]=id++,promise._state=void 0,promise._result=void 0,promise._subscribers=[]}function validationError(){return new Error('Array Methods must be provided an Array')}function needsResolver(){throw new TypeError('You must pass a resolver function as the first argument to the promise constructor')}function needsNew(){throw new TypeError('Failed to construct \'Promise\': Please use the \'new\' operator, this object constructor cannot be called as a function.')}var _isArray=Array.isArray?Array.isArray:function(x){return'[object Array]'===Object.prototype.toString.call(x)};var isArray=_isArray,len=0,vertxNext=void 0,customSchedulerFn=void 0,asap=function asap(callback,arg){queue[len]=callback,queue[len+1]=arg,len+=2,2==len&&(customSchedulerFn?customSchedulerFn(flush):scheduleFlush())},browserWindow='undefined'==typeof window?void 0:window,browserGlobal=browserWindow||{},BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver,isNode='undefined'==typeof self&&'undefined'!=typeof process&&'[object process]'==={}.toString.call(process),isWorker='undefined'!=typeof Uint8ClampedArray&&'undefined'!=typeof importScripts&&'undefined'!=typeof MessageChannel,queue=Array(1e3),scheduleFlush=void 0;scheduleFlush=isNode?function useNextTick(){return function(){return process.nextTick(flush)}}():BrowserMutationObserver?function useMutationObserver(){var iterations=0,observer=new BrowserMutationObserver(flush),node=document.createTextNode('');return observer.observe(node,{characterData:!0}),function(){node.data=iterations=++iterations%2}}():isWorker?function useMessageChannel(){var channel=new MessageChannel;return channel.port1.onmessage=flush,function(){return channel.port2.postMessage(0)}}():void 0===browserWindow&&'function'=='function'?function attemptVertx(){try{var vertx=Function('return this')().require('vertx');return vertxNext=vertx.runOnLoop||vertx.runOnContext,useVertxTimer()}catch(e){return useSetTimeout()}}():useSetTimeout();var PROMISE_ID=Math.random().toString(36).substring(2),PENDING=void 0,FULFILLED=1,REJECTED=2,TRY_CATCH_ERROR={error:null},id=0,Enumerator=function(){function Enumerator(Constructor,input){this._instanceConstructor=Constructor,this.promise=new Constructor(noop),this.promise[PROMISE_ID]||makePromise(this.promise),isArray(input)?(this.length=input.length,this._remaining=input.length,this._result=Array(this.length),0===this.length?fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(input),0===this._remaining&&fulfill(this.promise,this._result))):reject(this.promise,validationError())}return Enumerator.prototype._enumerate=function _enumerate(input){for(var i=0;this._state===PENDING&&i<input.length;i++)this._eachEntry(input[i],i)},Enumerator.prototype._eachEntry=function _eachEntry(entry,i){var c=this._instanceConstructor,resolve$$1=c.resolve;if(resolve$$1===resolve$1){var _then=getThen(entry);if(_then===then&&entry._state!==PENDING)this._settledAt(entry._state,i,entry._result);else if('function'!=typeof _then)this._remaining--,this._result[i]=entry;else if(c===Promise$1){var promise=new c(noop);handleMaybeThenable(promise,entry,_then),this._willSettleAt(promise,i)}else this._willSettleAt(new c(function(resolve$$1){return resolve$$1(entry)}),i)}else this._willSettleAt(resolve$$1(entry),i)},Enumerator.prototype._settledAt=function _settledAt(state,i,value){var promise=this.promise;promise._state===PENDING&&(this._remaining--,state===REJECTED?reject(promise,value):this._result[i]=value),0===this._remaining&&fulfill(promise,this._result)},Enumerator.prototype._willSettleAt=function _willSettleAt(promise,i){var enumerator=this;subscribe(promise,void 0,function(value){return enumerator._settledAt(FULFILLED,i,value)},function(reason){return enumerator._settledAt(REJECTED,i,reason)})},Enumerator}(),Promise$1=function(){function Promise(resolver){this[PROMISE_ID]=nextId(),this._result=this._state=void 0,this._subscribers=[],noop!==resolver&&('function'!=typeof resolver&&needsResolver(),this instanceof Promise?initializePromise(this,resolver):needsNew())}return Promise.prototype.catch=function _catch(onRejection){return this.then(null,onRejection)},Promise.prototype.finally=function _finally(callback){var promise=this,constructor=promise.constructor;return promise.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){throw reason})})},Promise}();return Promise$1.prototype.then=then,Promise$1.all=function all(entries){return new Enumerator(this,entries).promise},Promise$1.race=function race(entries){var Constructor=this;return isArray(entries)?new Constructor(function(resolve,reject){for(var length=entries.length,i=0;i<length;i++)Constructor.resolve(entries[i]).then(resolve,reject)}):new Constructor(function(_,reject){return reject(new TypeError('You must pass an array to race.'))})},Promise$1.resolve=resolve$1,Promise$1.reject=function reject$1(reason){var Constructor=this,promise=new Constructor(noop);return reject(promise,reason),promise},Promise$1._setScheduler=function setScheduler(scheduleFn){customSchedulerFn=scheduleFn},Promise$1._setAsap=function setAsap(asapFn){asap=asapFn},Promise$1._asap=asap,Promise$1.polyfill=function polyfill(){var local;if('undefined'!=typeof global)local=global;else if('undefined'!=typeof self)local=self;else try{local=Function('return this')()}catch(e){throw new Error('polyfill failed because global object is unavailable in this environment')}var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve())}catch(e){}if('[object Promise]'===promiseToString&&!P.cast)return}local.Promise=Promise$1},Promise$1.Promise=Promise$1,Promise$1})}).call(exports,__webpack_require__(9),__webpack_require__(0))},function(module,exports,__webpack_require__){'use strict';__webpack_require__(37);var firebase=function _interopDefault(ex){return ex&&'object'==typeof ex&&'default'in ex?ex['default']:ex}(__webpack_require__(13));module.exports=firebase},function(module,__webpack_exports__,__webpack_require__){'use strict';Object.defineProperty(__webpack_exports__,'__esModule',{value:!0});var __WEBPACK_IMPORTED_MODULE_0__firebase_firestore__=__webpack_require__(35),__WEBPACK_IMPORTED_MODULE_0__firebase_firestore___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_firestore__)},function(module,exports,__webpack_require__){(function(global){var win;win='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,module.exports=win}).call(exports,__webpack_require__(0))},function(module,exports,__webpack_require__){'use strict';var has=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,slice=Array.prototype.slice,isArgs=__webpack_require__(144),isEnumerable=Object.prototype.propertyIsEnumerable,hasDontEnumBug=!isEnumerable.call({toString:null},'toString'),hasProtoEnumBug=isEnumerable.call(function(){},'prototype'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},excludedKeys={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},hasAutomationEqualityBug=function(){if('undefined'==typeof window)return!1;for(var k in window)try{if(!excludedKeys['$'+k]&&has.call(window,k)&&null!==window[k]&&'object'==typeof window[k])try{equalsConstructorPrototype(window[k])}catch(e){return!0}}catch(e){return!0}return!1}(),equalsConstructorPrototypeIfNotBuggy=function(o){if('undefined'==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(o);try{return equalsConstructorPrototype(o)}catch(e){return!1}},keysShim=function keys(object){var isObject=null!==object&&'object'==typeof object,isFunction='[object Function]'===toStr.call(object),isArguments=isArgs(object),isString=isObject&&'[object String]'===toStr.call(object),theKeys=[];if(!isObject&&!isFunction&&!isArguments)throw new TypeError('Object.keys called on a non-object');if(isString&&0<object.length&&!has.call(object,0))for(var i=0;i<object.length;++i)theKeys.push(i+'');if(isArguments&&0<object.length)for(var j=0;j<object.length;++j)theKeys.push(j+'');else for(var name in object)!(hasProtoEnumBug&&isFunction&&'prototype'==name)&&has.call(object,name)&&theKeys.push(name+'');if(hasDontEnumBug)for(var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object),k=0;k<dontEnums.length;++k)!(skipConstructor&&'constructor'===dontEnums[k])&&has.call(object,dontEnums[k])&&theKeys.push(dontEnums[k]);return theKeys};keysShim.shim=function shimObjectKeys(){if(Object.keys){var keysWorksWithArguments=function(){return 2===(Object.keys(arguments)||'').length}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function keys(object){return isArgs(object)?originalKeys(slice.call(object)):originalKeys(object)}}}else Object.keys=keysShim;return Object.keys||keysShim},module.exports=keysShim},function(module){'use strict';var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value),isArgs='[object Arguments]'===str;return isArgs||(isArgs='[object Array]'!==str&&null!==value&&'object'==typeof value&&'number'==typeof value.length&&0<=value.length&&'[object Function]'===toStr.call(value.callee)),isArgs}},function(module){'use strict';function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case'string':return v;case'boolean':return v?'true':'false';case'number':return isFinite(v)?v:'';default:return'';}};module.exports=function(obj,sep,eq,name){return sep=sep||'&',eq=eq||'=',null===obj&&(obj=void 0),'object'==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):''};var isArray=Array.isArray||function(xs){return'[object Array]'===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},function(module,exports,__webpack_require__){(function(global,process){(function(global){'use strict';function setImmediate(callback){'function'!=typeof callback&&(callback=new Function(''+callback));for(var args=Array(arguments.length-1),i=0;i<args.length;i++)args[i]=arguments[i+1];var task={callback:callback,args:args};return tasksByHandle[nextHandle]=task,registerImmediate(nextHandle),nextHandle++}function clearImmediate(handle){delete tasksByHandle[handle]}function run(task){var callback=task.callback,args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(void 0,args);}}function runIfPresent(handle){if(currentlyRunningATask)setTimeout(runIfPresent,0,handle);else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=!0;try{run(task)}finally{clearImmediate(handle),currentlyRunningATask=!1}}}}function installNextTickImplementation(){registerImmediate=function(handle){process.nextTick(function(){runIfPresent(handle)})}}function canUsePostMessage(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=!0,oldOnMessage=global.onmessage;return global.onmessage=function(){postMessageIsAsynchronous=!1},global.postMessage('','*'),global.onmessage=oldOnMessage,postMessageIsAsynchronous}}function installPostMessageImplementation(){var messagePrefix='setImmediate$'+Math.random()+'$',onGlobalMessage=function(event){event.source===global&&'string'==typeof event.data&&0===event.data.indexOf(messagePrefix)&&runIfPresent(+event.data.slice(messagePrefix.length))};global.addEventListener?global.addEventListener('message',onGlobalMessage,!1):global.attachEvent('onmessage',onGlobalMessage),registerImmediate=function(handle){global.postMessage(messagePrefix+handle,'*')}}function installMessageChannelImplementation(){var channel=new MessageChannel;channel.port1.onmessage=function(event){var handle=event.data;runIfPresent(handle)},registerImmediate=function(handle){channel.port2.postMessage(handle)}}function installReadyStateChangeImplementation(){var html=doc.documentElement;registerImmediate=function(handle){var script=doc.createElement('script');script.onreadystatechange=function(){runIfPresent(handle),script.onreadystatechange=null,html.removeChild(script),script=null},html.appendChild(script)}}function installSetTimeoutImplementation(){registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}}if(!global.setImmediate){var nextHandle=1,tasksByHandle={},currentlyRunningATask=!1,doc=global.document,attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global),registerImmediate;attachTo=attachTo&&attachTo.setTimeout?attachTo:global,'[object process]'==={}.toString.call(global.process)?installNextTickImplementation():canUsePostMessage()?installPostMessageImplementation():global.MessageChannel?installMessageChannelImplementation():doc&&'onreadystatechange'in doc.createElement('script')?installReadyStateChangeImplementation():installSetTimeoutImplementation(),attachTo.setImmediate=setImmediate,attachTo.clearImmediate=clearImmediate}})('undefined'==typeof self?'undefined'==typeof global?this:global:self)}).call(exports,__webpack_require__(0),__webpack_require__(9))},function(module,exports,__webpack_require__){function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j],options))}else{for(var parts=[],j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j],options));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list,options){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],css=item[1],media=item[2],sourceMap=item[3],part={css:css,media:media,sourceMap:sourceMap};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}function insertStyleElement(options,style){var target=getElement(options.insertInto);if(!target)throw new Error('Couldn\'t find a style target. This probably means that the value for the \'insertInto\' parameter is invalid.');var lastStyleElementInsertedAtTop=stylesInsertedAtTop[stylesInsertedAtTop.length-1];if('top'===options.insertAt)lastStyleElementInsertedAtTop?lastStyleElementInsertedAtTop.nextSibling?target.insertBefore(style,lastStyleElementInsertedAtTop.nextSibling):target.appendChild(style):target.insertBefore(style,target.firstChild),stylesInsertedAtTop.push(style);else if('bottom'===options.insertAt)target.appendChild(style);else if('object'==typeof options.insertAt&&options.insertAt.before){var nextSibling=getElement(options.insertAt.before,target);target.insertBefore(style,nextSibling)}else throw new Error('[Style Loader]\n\n Invalid value for parameter \'insertAt\' (\'options.insertAt\') found.\n Must be \'top\', \'bottom\', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n')}function removeStyleElement(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style);var idx=stylesInsertedAtTop.indexOf(style);0<=idx&&stylesInsertedAtTop.splice(idx,1)}function createStyleElement(options){var style=document.createElement('style');if(void 0===options.attrs.type&&(options.attrs.type='text/css'),void 0===options.attrs.nonce){var nonce=getNonce();nonce&&(options.attrs.nonce=nonce)}return addAttrs(style,options.attrs),insertStyleElement(options,style),style}function createLinkElement(options){var link=document.createElement('link');return void 0===options.attrs.type&&(options.attrs.type='text/css'),options.attrs.rel='stylesheet',addAttrs(link,options.attrs),insertStyleElement(options,link),link}function addAttrs(el,attrs){Object.keys(attrs).forEach(function(key){el.setAttribute(key,attrs[key])})}function getNonce(){return __webpack_require__.nc}function addStyle(obj,options){var style,update,remove,result;if(options.transform&&obj.css)if(result='function'==typeof options.transform?options.transform(obj.css):options.transform.default(obj.css),result)obj.css=result;else return function(){};if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=createStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else obj.sourceMap&&'function'==typeof URL&&'function'==typeof URL.createObjectURL&&'function'==typeof URL.revokeObjectURL&&'function'==typeof Blob&&'function'==typeof btoa?(style=createLinkElement(options),update=updateLink.bind(null,style,options),remove=function(){removeStyleElement(style),style.href&&URL.revokeObjectURL(style.href)}):(style=createStyleElement(options),update=applyToTag.bind(null,style),remove=function(){removeStyleElement(style)});return update(obj),function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}function applyToSingletonTag(style,index,remove,obj){var css=remove?'':obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}function applyToTag(style,obj){var css=obj.css,media=obj.media;if(media&&style.setAttribute('media',media),style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}function updateLink(link,options,obj){var css=obj.css,sourceMap=obj.sourceMap,autoFixUrls=options.convertToAbsoluteUrls===void 0&&sourceMap;(options.convertToAbsoluteUrls||autoFixUrls)&&(css=fixUrls(css)),sourceMap&&(css+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+' */');var blob=new Blob([css],{type:'text/css'}),oldSrc=link.href;link.href=URL.createObjectURL(blob),oldSrc&&URL.revokeObjectURL(oldSrc)}var stylesInDom={},isOldIE=function(fn){var memo;return function(){return'undefined'==typeof memo&&(memo=fn.apply(this,arguments)),memo}}(function(){return window&&document&&document.all&&!window.atob}),getTarget=function(target,parent){return parent?parent.querySelector(target):document.querySelector(target)},getElement=function(){var memo={};return function(target,parent){if('function'==typeof target)return target();if('undefined'==typeof memo[target]){var styleTarget=getTarget.call(this,target,parent);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),singleton=null,singletonCounter=0,stylesInsertedAtTop=[],fixUrls=__webpack_require__(148);module.exports=function(list,options){if('undefined'!=typeof DEBUG&&DEBUG&&'object'!=typeof document)throw new Error('The style-loader cannot be used in a non-browser environment');options=options||{},options.attrs='object'==typeof options.attrs?options.attrs:{},options.singleton||'boolean'==typeof options.singleton||(options.singleton=isOldIE()),options.insertInto||(options.insertInto='head'),options.insertAt||(options.insertAt='bottom');var styles=listToStyles(list,options);return addStylesToDom(styles,options),function update(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];domStyle.refs--,mayRemove.push(domStyle)}if(newList){var newStyles=listToStyles(newList,options);addStylesToDom(newStyles,options)}for(var i=0,domStyle;i<mayRemove.length;i++)if(domStyle=mayRemove[i],0===domStyle.refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}};var replaceText=function(){var textStore=[];return function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join('\n')}}()},function(module){module.exports=function(css){var location='undefined'!=typeof window&&window.location;if(!location)throw new Error('fixUrls requires window.location');if(!css||'string'!=typeof css)return css;var baseUrl=location.protocol+'//'+location.host,currentDir=baseUrl+location.pathname.replace(/\/[^\/]*$/,'/'),fixedCss=css.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(fullMatch,origUrl){var unquotedOrigUrl=origUrl.trim().replace(/^"(.*)"$/,function(o,$1){return $1}).replace(/^'(.*)'$/,function(o,$1){return $1});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(unquotedOrigUrl))return fullMatch;var newUrl;return newUrl=0===unquotedOrigUrl.indexOf('//')?unquotedOrigUrl:0===unquotedOrigUrl.indexOf('/')?baseUrl+unquotedOrigUrl:currentDir+unquotedOrigUrl.replace(/^\.\//,''),'url('+JSON.stringify(newUrl)+')'});return fixedCss}},function(module,exports,__webpack_require__){(function(global){function Timeout(id,clearFn){this._id=id,this._clearFn=clearFn}var scope='undefined'!=typeof global&&global||'undefined'!=typeof self&&self||window,apply=Function.prototype.apply;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,scope,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,scope,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(timeout){timeout&&timeout.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(scope,this._id)},exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId),item._idleTimeout=msecs},exports.unenroll=function(item){clearTimeout(item._idleTimeoutId),item._idleTimeout=-1},exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;0<=msecs&&(item._idleTimeoutId=setTimeout(function onTimeout(){item._onTimeout&&item._onTimeout()},msecs))},__webpack_require__(146),exports.setImmediate='undefined'!=typeof self&&self.setImmediate||'undefined'!=typeof global&&global.setImmediate||this&&this.setImmediate,exports.clearImmediate='undefined'!=typeof self&&self.clearImmediate||'undefined'!=typeof global&&global.clearImmediate||this&&this.clearImmediate}).call(exports,__webpack_require__(0))},function(module){module.exports='data:image/png;base64,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'},function(module){module.exports='data:image/jpeg;base64,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'},function(){'use strict';function isDataView(obj){return obj&&DataView.prototype.isPrototypeOf(obj)}function normalizeName(name){if('string'!=typeof name&&(name+=''),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(name))throw new TypeError('Invalid character in header field name');return name.toLowerCase()}function normalizeValue(value){return'string'!=typeof value&&(value+=''),value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:void 0===value,value:value}}};return support.iterable&&(iterator[Symbol.iterator]=function(){return iterator}),iterator}function Headers(headers){this.map={},headers instanceof Headers?headers.forEach(function(value,name){this.append(name,value)},this):Array.isArray(headers)?headers.forEach(function(header){this.append(header[0],header[1])},this):headers&&Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}function consumed(body){return body.bodyUsed?Promise.reject(new TypeError('Already read')):void(body.bodyUsed=!0)}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsArrayBuffer(blob),promise}function readBlobAsText(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsText(blob),promise}function readArrayBufferAsText(buf){for(var view=new Uint8Array(buf),chars=Array(view.length),i=0;i<view.length;i++)chars[i]=String.fromCharCode(view[i]);return chars.join('')}function bufferClone(buf){if(buf.slice)return buf.slice(0);var view=new Uint8Array(buf.byteLength);return view.set(new Uint8Array(buf)),view.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(body){this._bodyInit=body,body?'string'==typeof body?this._bodyText=body:support.blob&&Blob.prototype.isPrototypeOf(body)?this._bodyBlob=body:support.formData&&FormData.prototype.isPrototypeOf(body)?this._bodyFormData=body:support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)?this._bodyText=body.toString():support.arrayBuffer&&support.blob&&isDataView(body)?(this._bodyArrayBuffer=bufferClone(body.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(body)||isArrayBufferView(body))?this._bodyArrayBuffer=bufferClone(body):this._bodyText=body=Object.prototype.toString.call(body):this._bodyText='',this.headers.get('content-type')||('string'==typeof body?this.headers.set('content-type','text/plain;charset=UTF-8'):this._bodyBlob&&this._bodyBlob.type?this.headers.set('content-type',this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)&&this.headers.set('content-type','application/x-www-form-urlencoded;charset=UTF-8'))},support.blob&&(this.blob=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error('could not read FormData body as blob');else return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error('could not read FormData body as text');else return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}function normalizeMethod(method){var upcased=method.toUpperCase();return-1<methods.indexOf(upcased)?upcased:method}function Request(input,options){options=options||{};var body=options.body;if(input instanceof Request){if(input.bodyUsed)throw new TypeError('Already read');this.url=input.url,this.credentials=input.credentials,options.headers||(this.headers=new Headers(input.headers)),this.method=input.method,this.mode=input.mode,this.signal=input.signal,body||null==input._bodyInit||(body=input._bodyInit,input.bodyUsed=!0)}else this.url=input+'';if(this.credentials=options.credentials||this.credentials||'same-origin',(options.headers||!this.headers)&&(this.headers=new Headers(options.headers)),this.method=normalizeMethod(options.method||this.method||'GET'),this.mode=options.mode||this.mode||null,this.signal=options.signal||this.signal,this.referrer=null,('GET'===this.method||'HEAD'===this.method)&&body)throw new TypeError('Body not allowed for GET or HEAD requests');this._initBody(body)}function decode(body){var form=new FormData;return body.trim().split('&').forEach(function(bytes){if(bytes){var split=bytes.split('='),name=split.shift().replace(/\+/g,' '),value=split.join('=').replace(/\+/g,' ');form.append(decodeURIComponent(name),decodeURIComponent(value))}}),form}function parseHeaders(rawHeaders){var headers=new Headers,preProcessedHeaders=rawHeaders.replace(/\r?\n[\t ]+/g,' ');return preProcessedHeaders.split(/\r?\n/).forEach(function(line){var parts=line.split(':'),key=parts.shift().trim();if(key){var value=parts.join(':').trim();headers.append(key,value)}}),headers}function Response(bodyInit,options){options||(options={}),this.type='default',this.status=options.status===void 0?200:options.status,this.ok=200<=this.status&&300>this.status,this.statusText='statusText'in options?options.statusText:'OK',this.headers=new Headers(options.headers),this.url=options.url||'',this._initBody(bodyInit)}function fetch(input,init){return new Promise(function(resolve,reject){function abortXhr(){xhr.abort()}var request=new Request(input,init);if(request.signal&&request.signal.aborted)return reject(new DOMException('Aborted','AbortError'));var xhr=new XMLHttpRequest;xhr.onload=function(){var options={status:xhr.status,statusText:xhr.statusText,headers:parseHeaders(xhr.getAllResponseHeaders()||'')};options.url='responseURL'in xhr?xhr.responseURL:options.headers.get('X-Request-URL');var body='response'in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))},xhr.onerror=function(){reject(new TypeError('Network request failed'))},xhr.ontimeout=function(){reject(new TypeError('Network request failed'))},xhr.onabort=function(){reject(new DOMException('Aborted','AbortError'))},xhr.open(request.method,request.url,!0),'include'===request.credentials?xhr.withCredentials=!0:'omit'===request.credentials&&(xhr.withCredentials=!1),'responseType'in xhr&&support.blob&&(xhr.responseType='blob'),request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)}),request.signal&&(request.signal.addEventListener('abort',abortXhr),xhr.onreadystatechange=function(){4===xhr.readyState&&request.signal.removeEventListener('abort',abortXhr)}),xhr.send('undefined'==typeof request._bodyInit?null:request._bodyInit)})}var support={searchParams:'URLSearchParams'in self,iterable:'Symbol'in self&&'iterator'in Symbol,blob:'FileReader'in self&&'Blob'in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:'FormData'in self,arrayBuffer:'ArrayBuffer'in self};if(support.arrayBuffer)var viewClasses=['[object Int8Array]','[object Uint8Array]','[object Uint8ClampedArray]','[object Int16Array]','[object Uint16Array]','[object Int32Array]','[object Uint32Array]','[object Float32Array]','[object Float64Array]'],isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&-1<viewClasses.indexOf(Object.prototype.toString.call(obj))};Headers.prototype.append=function(name,value){name=normalizeName(name),value=normalizeValue(value);var oldValue=this.map[name];this.map[name]=oldValue?oldValue+', '+value:value},Headers.prototype['delete']=function(name){delete this.map[normalizeName(name)]},Headers.prototype.get=function(name){return name=normalizeName(name),this.has(name)?this.map[name]:null},Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))},Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=normalizeValue(value)},Headers.prototype.forEach=function(callback,thisArg){for(var name in this.map)this.map.hasOwnProperty(name)&&callback.call(thisArg,this.map[name],name,this)},Headers.prototype.keys=function(){var items=[];return this.forEach(function(value,name){items.push(name)}),iteratorFor(items)},Headers.prototype.values=function(){var items=[];return this.forEach(function(value){items.push(value)}),iteratorFor(items)},Headers.prototype.entries=function(){var items=[];return this.forEach(function(value,name){items.push([name,value])}),iteratorFor(items)},support.iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=['DELETE','GET','HEAD','OPTIONS','POST','PUT'];Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var response=new Response(null,{status:0,statusText:''});return response.type='error',response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(-1===redirectStatuses.indexOf(status))throw new RangeError('Invalid status code');return new Response(null,{status:status,headers:{location:url}})};var DOMException=self.DOMException;try{new DOMException}catch(err){DOMException=function(message,name){this.message=message,this.name=name;var error=Error(message);this.stack=error.stack},DOMException.prototype=Object.create(Error.prototype),DOMException.prototype.constructor=DOMException}fetch.polyfill=!0,self.fetch||(self.fetch=fetch,self.Headers=Headers,self.Request=Request,self.Response=Response)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNDRiNzdiNTg4ZDRhYmFmMzYzMTYiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Nsb25lLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlscy5qcyIsIndlYnBhY2s6Ly8vLi9+L2ZvcmVhY2gvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9lcnJvcnMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9tYXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50cy9jb2xvcnMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9kZWJ1Zy9icm93c2VyLmpzIiwid2VicGFjazovLy8uL34vaXNhcnJheS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L25vZGUtbGlicy1icm93c2VyL34vcHJvY2Vzcy9icm93c2VyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb25zdGFudHMvYmVhdC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1hdGxhcy11dnMtY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL3ZlbmRvci9CdWZmZXJHZW9tZXRyeVV0aWxzLmpzIiwid2VicGFjazovLy8uL34vQGZpcmViYXNlL2FwcC9kaXN0L2luZGV4LmNqcy5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzL2NvbXBvbmVudC1kZWNvcmF0b3JzLmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9idWlsZFNlYXJjaE1ldGhvZC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL29taXQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9pbmhlcml0cy9pbmhlcml0c19icm93c2VyLmpzIiwid2VicGFjazovLy8uL34vdHNsaWIvdHNsaWIuZXM2LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWFhYmItY29sbGlkZXItY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWF1ZGlvYW5hbHlzZXItY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWV2ZW50LXNldC1jb21wb25lbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtZ2VvbWV0cnktbWVyZ2VyLWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1oYXB0aWNzLWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1sYXlvdXQtY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLW9yYml0LWNvbnRyb2xzL2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLXByb3h5LWV2ZW50LWNvbXBvbmVudC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1yaW5nLXNoYWRlci9kaXN0L2FmcmFtZS1yaW5nLXNoYWRlci5qcyIsIndlYnBhY2s6Ly8vLi9+L2FmcmFtZS1zbGljZTktY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLXN0YXRlLWNvbXBvbmVudC9kaXN0L2FmcmFtZS1zdGF0ZS1jb21wb25lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtdGh1bWItY29udHJvbHMtY29tcG9uZW50L2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5jc3M/Y2I3MyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cyBcXC5qcyQiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0YXRlIFxcLmpzJCIsIndlYnBhY2s6Ly8vLi9+L0BmaXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5janMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9AZmlyZWJhc2UvbG9nZ2VyL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovLy8uL34vQGZpcmViYXNlL3BvbHlmaWxsL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovLy8uL34vQGZpcmViYXNlL3V0aWwvZGlzdC9pbmRleC5janMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9AZmlyZWJhc2Uvd2ViY2hhbm5lbC13cmFwcGVyL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMvZXZlbnQtYmluZGVyLmpzIiwid2VicGFjazovLy8uL34vYWZyYW1lLWdlb21ldHJ5LW1lcmdlci1jb21wb25lbnQvbGliL0J1ZmZlckdlb21ldHJ5VXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hZnJhbWUtb3JiaXQtY29udHJvbHMvbGliL09yYml0Q29udHJvbHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9BbGdvbGlhU2VhcmNoQ29yZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL0luZGV4Q29yZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvYnVpbGRzL2FsZ29saWFzZWFyY2hMaXRlLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvYnJvd3Nlci9jcmVhdGVBbGdvbGlhc2VhcmNoLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvYnJvd3Nlci9pbmxpbmUtaGVhZGVycy5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvanNvbnAtcmVxdWVzdC5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2RlcHJlY2F0ZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL2RlcHJlY2F0ZWRNZXNzYWdlLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvZXhpdFByb21pc2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9hbGdvbGlhc2VhcmNoL3NyYy9tZXJnZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL3BsYWNlcy5qcyIsIndlYnBhY2s6Ly8vLi9+L2FsZ29saWFzZWFyY2gvc3JjL3N0b3JlLmpzIiwid2VicGFjazovLy8uL34vYWxnb2xpYXNlYXJjaC9zcmMvdmVyc2lvbi5qcyIsIndlYnBhY2s6Ly8vLi9hc3NldHMvc2hhZGVycy9mbGF0LmpzIiwid2VicGFjazovLy8uL2Fzc2V0cy9zaGFkZXJzL3N0YWdlQWRkaXRpdmUuanMiLCJ3ZWJwYWNrOi8vLy4vYXNzZXRzL3NoYWRlcnMvc3RhZ2VOb3JtYWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYWN0aXZlLWNvbG9yLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2F1ZGlvLWNvbHVtbnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmVhbXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmVhdC1oaXQtc291bmQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmVhdC1sb2FkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvYmVhdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jb25zb2xlLXNob3J0Y3V0cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jb3B5LXRleHR1cmUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvY3Vyc29yLWxhc2VyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2N1cnNvci1tZXNoLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2RlYnVnLWJlYXQtbG9hZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2RlYnVnLWNvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZGVidWctY3Vyc29yLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2RlYnVnLXNvbmctdGltZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1zdGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9mYWtlLWdsb3cuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvZmxvb3Itc2hhZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2dhbWVvdmVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2dwdS1wcmVsb2FkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGFjay5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9oYW5kLXN3YXBwZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGFwdGljcy1zYWJlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9oYXB0aWNzLXdhbGwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvaGlzdG9yeS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9pbnRyby1zb25nLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2tleWJvYXJkLXJheWNhc3RhYmxlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2xlYWRlcmJvYXJkLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2xvZ28tbGlnaHQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbG9nb2ZsaWNrZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWF0ZXJpYWxzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL21lbnUtY29udHJvbHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbWVudS1kaWZmaWN1bHR5LXNlbGVjdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9tZW51LXNlbGVjdGVkLWNoYWxsZW5nZS1pbWFnZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9tZW51LXNsaWRlLWFuaW1hdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9taW5lLWZyYWdtZW50cy1sb2FkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvbXVsdGlwbGllci1yaW5nLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3BhcnRpY2xlcGxheWVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3BhdXNlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3BhdXNlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9wbGF5LXNvdW5kLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3JheWNhc3Rlci10YXJnZXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvcmVjZW50ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2FiZXItY29udHJvbHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2FiZXItcGFydGljbGVzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3Njb3JlLWJlYXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2NvcmUtdGV4dHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2VhcmNoLXRodW1ibmFpbC1hdGxhcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zZWFyY2guanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc29uZy1wcmV2aWV3LmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NvbmctcHJvZ3Jlc3MtcmluZy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zb25nLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N0YWdlLWNvbG9ycy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zdGFnZS1sYXNlcnMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc3RhZ2Utc2hhZGVyLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N0YXRzLXBhcmFtLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N0ZXBiYWNrLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3N1Yi1vYmplY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc3VwZXIta2V5Ym9hcmQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc3VwZXJjdXRmeC1zaGFkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc3VwZXJjdXRmeC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy90ZXh0LWNvdW50ZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdGV4dC11cHBlcmNhc2UuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdG9nZ2xlLXBhdXNlLXBsYXkuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdHJhaWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdHV0b3JpYWwtMmQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdHdpc3Rlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy92ZXJ0ZXgtY29sb3JzLWJ1ZmZlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy92aWN0b3J5LWFjY3VyYWN5LXJpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvdmljdG9yeS1yYW5rLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3Zpc2libGUtcmF5Y2FzdGFibGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvd2FsbC1zaGFkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvd2FsbC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29uc3RhbnRzL2dlbnJlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2xpYi9zb3VuZHBvb2wuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0YXRlL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5jc3MiLCJ3ZWJwYWNrOi8vLy4vfi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2Nzcy1sb2FkZXIvbGliL3VybC9lc2NhcGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9kZWJ1Zy9kZWJ1Zy5qcyIsIndlYnBhY2s6Ly8vLi9+L2VzNi1wcm9taXNlL2Rpc3QvZXM2LXByb21pc2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9maXJlYmFzZS9hcHAvZGlzdC9pbmRleC5janMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9maXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vLy4vfi9nbG9iYWwvd2luZG93LmpzIiwid2VicGFjazovLy8uL34vb2JqZWN0LWtleXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9vYmplY3Qta2V5cy9pc0FyZ3VtZW50cy5qcyIsIndlYnBhY2s6Ly8vLi9+L3F1ZXJ5c3RyaW5nLWVzMy9lbmNvZGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9zZXRpbW1lZGlhdGUvc2V0SW1tZWRpYXRlLmpzIiwid2VicGFjazovLy8uL34vc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9zdHlsZS1sb2FkZXIvbGliL3VybHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi90aW1lcnMtYnJvd3NlcmlmeS9tYWluLmpzIiwid2VicGFjazovLy8uL2Fzc2V0cy9pbWcvZW50ZXItdnItYnV0dG9uLWJhY2tncm91bmQucG5nIiwid2VicGFjazovLy8uL2Fzc2V0cy9pbWcvbG9hZGluZ0xvZ28uanBnIiwid2VicGFjazovLy8uL34vd2hhdHdnLWZldGNoL2ZldGNoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJrQkFDQSx1Q0FNQSxxQkFDQSw0Q0FHQSw4Q0FDQSxHQUNBLFNBQ0EsYUFJQSx1RUFHQSw0QkFHQSxZQUNBLE9BSUEsc0JBekJBLGdDQTRCQSw4QkFHQSxzREFBMkMsT0FBYyxNQUd6RCxxREFDQSwrQkFDQSwwQ0FDQSxDQUNBLGdCQUNBLGtCQUdBLFFBR0Esd0NBQ0EsMkJBQ0EsZ0NBQTJCLGVBQTBCLFVBQ3JELDZCQUFpQyxPQUFlLE9BQ2hELDBDQUNBLFFBQ0EsTUFHQSxpREFBc0Qsb0RBQStELFNBR3JILHdCQUdBLHNFQ2hFQSxHQUdBLGFBQ0EsT0FDQSxLQUFDLElBRUQsR0FFQSwwQ0FDQSxPQUFDLFNBRUQsQ0FDQSw0QkFDQSxPQUk0QyxDQUU1QyxtQ0NwQkEsa0NBQ0Esa0NBQ0Esd0JDRk0sQ0FLTixPQUFPLFFBQXVCLGFBSDlCLFFBQVMsY0FBYyxHQUFJLEtBQ3pCLENBQVEsTUFBVyxHQUhKLG1DQUdVLE1BQVEsSUFDbEMseUJDSEQsNkJBQ0Esa0RBRUEsMkNBQ0EsSUFDQSw0REFFQSx5Q0FDQSxlQUNBLFlBQXVCLElBQU8sRUFDOUIseUJBR0Esc0JBQ0EscUJBQ0EseUJBSUEsb0RDaEJBLGFBSUEsb0RBQ0EsaUNBRUEsU0FHQSxLQUNBLDZFQUVBLDRDQUdBLHdEQUNBLDJDQUVBLGdCQUNBLDZFQUNBLFlBQ0EsS0FFQSxHQUlBLHdDQUNBLG9DQUNBLCtDQUdBLEdBQ0EsdUNBR0EsdUNBQ0EscUNBQ0EsT0FFQSwwQ0FFQSxvQkFDQSx3QkFFQSxDQTVDQSxxQ0F3QkEsbUNBcUJBLGVBQ0Esb0JBQ0Esa0NBQ0Esa0JBQ0EsaUJBRUEsMEZBQ0Esa0JBQ0EsaUJBRUEsc0RBQ0Esa0JBQ0EsVUFFQSwyREFDQSxrQkFDQSxrQkFFQSwrRUFDQSxrQkFDQSxtQkFFQSxpRUFDQSxrQkFDQSxVQUVBLHdFQzdFQSxtQ0FFQSxtQ0FDQSxZQUNBLDhDQUNBLCtCQUNBLEtBQ0EsR0FDQSwwQkNSQSxPQUFPLFFBQ0wsS0FDQSxXQUNBLGVBRUEsb0JBQ0EscUJBRUEsa0JBQ0EsbUJBQ0Esa0JBRUEsaUJBQ0Esa0JBQ0Esd0JBQ0EsaUJBQ0EsdUJBRUEsbUJBQ0EsaUJBQ0EsMEJBQ0EsbUJBQ0EseUJBRUEsbUJBQ0EsbUJBQ0EsaUJBRUEsZ0JBQ0Esb0JBRUEsbUJBQ0EsNEJBQ0Esb0JBQ0EsNkJBQW9CLHdEQzdCdEIsQ0FvSUEsZUFDQSxJQUNBLE1BQ0EsbUJBQ0EsS0FBRyxVQUNILE9BQ0EsRUFJQSxDQTVJQSxnREFDQSxZQWlHQSxjQUdBLHVCQUNBLGtCQUNBLHVEQUNBLFVBT0EsRUE3R0EsbUJBdURBLHFCQUNBLFVBQ0EseUJBRUEscUNBQ0EsU0FDQSwyQkFDQSxVQUNBLG9CQUVBLHNCQUVBLDJCQUNBLCtFQUtBLGNBQ0EsUUFDQSxtREFDQSxRQUNBLFFBQ0EsZUFHQSxjQUVBLE9BRUEsdUJBQ0EsR0FDQSxJQU9BLEVBN0ZBLGFBOEdBLHlCQUNBLElBQ0EsT0FDQSxzQ0FFQSwrQkFFQSxVQUFHLFVBQ0gsQ0FPQSxFQTVIQSxrQkFDQSxrQkEyQkEsb0JBRUEscURBRUEsb0VBR0EsbUVBQ0EsMEJBSUEsRUF0Q0EsbUNBQ0Esb0NBQ0EsdUJBQ0EsTUFrSkEsdUJBQ0EsSUFDQSxlQUNBLFlBQUcsVUFDSCxFQWxKQSxHQUVBLGVBQ0EsQ0FDQSxnQkFDQSxjQUNBLFlBQ0EsYUFDQSxhQVNBLFdBZ0JBLGdDQUNBLHVCQUNBLEVBT0EsRUF1RkEsZUFXQSwwQkNoS0EsMkNBQ0EsT0FDQSx3RUNEQSxDQVVBLDJCQUNBLGlCQUNBLG1DQUNBLDhCQUNBLGlCQUNBLG9DQUNBLENBb0JBLHdCQUNBLHVCQUVBLGlDQUdBLGdFQUNBLG1DQUNBLDBCQUVBLE1BRUEsNkJBQ0EsRUFBSyxTQUNMLElBRUEsdUNBQ0EsRUFBUyxTQUVULHVDQUNBLEVBQ0EsQ0FHQSxFQUNBLGdDQUNBLHlCQUVBLGlDQUdBLDRFQUNBLHVDQUNBLDBCQUVBLFdBRUEsMkJBQ0EsT0FBSyxTQUNMLElBRUEscUNBQ0EsT0FBUyxTQUdULHFDQUNBLE9BQ0EsQ0FJQSxDQUNBLENBS0EsMEJBQ0EsV0FHQSxlQUNBLHlCQUNBLGlDQUVBLG1CQUVBLFFBQ0EsUUFFQSxjQUVBLHFCQUNBLEtBR0EsaUNBQ0EsaUJBRUEsOEJBQ0EsWUFDQSxrQkFDQSxZQUNBLGdCQUNBLEtBQ0EsdUNBR0Esa0JBQ0EsWUFDQSxNQUNBLGNBQ0EsS0FDQSw0QkFDQSxVQWdCQSx3QkFDQSxVQUNBLGVBQ0EsTUFXQSw0Q0F6SkEsR0FDQSwrQ0FTQSxJQUNBLGtCQUNBLDhCQUVBLFdBRUEsZ0JBQUssU0FDTCxrQkFDQSxnQkFDQSxJQUNBLG9CQUNBLGdDQUVBLGFBRUEsbUJBQUssU0FDTCxvQkFDQSxtQkFDQSxDQUFDLGVBc0RELEdBQ0EsMEJBQ0EsYUF5Q0EsOEJBQ0EsaUNBQ0EsTUFDQSw2QkFBdUIsY0FBc0IsT0FDN0Msd0JBR0EsMkJBQ0EseUJBQ0EscUJBRUEsV0FFQSxFQUtBLDZCQUNBLDBCQUNBLFFBQ0Esd0JBQ0EsbUJBQ0EsZUFDQSxnQkFDQSxnQkFBcUIsR0FDckIsb0JBSUEsZ0JBQ0EseUJBQ0Esa0JBQ0EsaUJBQ0EsNEJBQ0EsZ0NBQ0Esa0JBQ0EsNkJBQ0EsaUNBRUEsNEJBQXFDLFdBRXJDLDBCQUNBLGlCQUNBLHFDQUVBLHNCQUEyQixZQUMzQix3QkFDQSxpQkFDQSxtQ0FDQSx3QkFBNEIsT0FBVSwwQ0N2THpCLGtCQUNBLG1CQUFvQiwwQkFDcEIsd0NBQW9CLEtBRDFCLEdBQ29FLG9DQ0YzRSxDQXNGQSxzREFDQSxxQkFDQSx5QkFFQSx3Q0FDQSxxQkFDQSxrQ0FDQSxpQkFDQSxtQ0FDQSxzQkFDQSxtQ0FDQSwwQkFDQSxXQUNBLElBbEdBLFFBQ0EsV0FDQSxrQkFDQSxrQkFDQSxrQkFLQSxTQUNBLHFDQUNBLGVBRUEsbUJBQ0EsZUFBbUIsbUJBQ25CLGNBQWdCLG1CQUNoQixXQUFhLG1CQUNiLFFBQVUsbUJBR1YscUJBQ0EsaUJBQ0EsaUVBRUEsbURBQ0Esa0RBQ0EsNkNBQ0EsNkNBQ0EsNkNBQ0EsNkNBQ0EsNkNBQ0EsYUFDQSxnQkFDQyxJQUVELGlEQUNBLFFBQ0EsV0FBZSxRQUNmLDhCQUFtQixRQUNuQixtQkFBa0IsUUFDbEIsYUFDQSx3QkFBaUIsUUFDakIsWUFBYyxRQUdkLElBRUEsMkJBQ0EsaURBQ0EsOEJBQ0EsaUNBQ0Esb0NBQ0EsdUNBQ0EsZ0NBRUEsa0JBQ0EsMEJBQ0EsbUJBQ0Esd0JBQ0EsNEJBRUEsV0FFQSxxREFDQSxtQkFDQSxpQkFFQSxXQUNBLDRCQUE0Qiw0QkFBc0MsT0FHbEUsK0NBQ0EsMkNBR0Esb0ZBR0Esb0RBQ0EsV0FLQSxJQWVBLGdEQ3BHQSxDQUlBLE1BQU0sb0JBRUwsaUJBQWlCLFNBQVcsU0FFM0IsU0FtRFMsZ0JBQWdCLEVBQUcsRUFBRyxFQUU5QixJQUFHLFVBQVcsVUFDZCxDQUR5QixPQUN0QixVQUFXLFVBQ2QsQ0FEeUIsT0FDdEIsVUFBVyxVQUVkLENBRnlCLFFBRXJCLFVBQVcsSUFDZixDQURvQixRQUNoQixVQUFXLElBQ2YsQ0FEb0IsUUFDaEIsVUFBVyxJQUVmLENBRm9CLE9BRWhCLElBQUssR0FBRyxFQUFJLEdBQ2hCLEVBQUksR0FBSyxHQUFHLEVBQUksR0FFaEIsRUFBSSxHQUFLLEdBQUcsRUFBSSxHQUNoQixFQUFJLEdBQUssR0FBRyxFQUFJLEdBRWhCLEVBQUksR0FBSyxHQUFHLEVBQUksR0FDaEIsRUFBSSxHQUFLLEdBQUcsRUFBSSxHQUVoQixFQUFJLEdBQUssSUFBSSxFQUFJLElBQ2pCLEVBQUksR0FBSyxJQUFJLEVBQUksSUFFakIsRUFBSSxHQUFLLElBQUksRUFBSSxJQUNqQixFQUFJLEdBQUssSUFBSSxFQUFJLElBRWpCLEVBQUksRUFBSSxHQUFRLEdBQUssR0FBSyxHQUUxQixTQUFLLElBQ0osQ0FBRSxHQUFLLEdBQUssR0FBSyxJQUFPLEVBQ3hCLENBQUUsR0FBSyxHQUFLLEdBQUssSUFBTyxFQUN4QixDQUFFLEdBQUssR0FBSyxHQUFLLElBR2xCLFFBQUssSUFDSixDQUFFLEdBQUssR0FBSyxHQUFLLElBQU8sRUFDeEIsQ0FBRSxHQUFLLEdBQUssR0FBSyxJQUFPLEVBQ3hCLENBQUUsR0FBSyxHQUFLLEdBQUssSUFHbEIsUUFBTSxHQUFJLElBQ1YsV0FBTSxHQUFJLElBQ1YsV0FBTSxHQUFJLElBRVYsV0FBTSxHQUFJLElBQ1YsV0FBTSxHQUFJLElBQ1YsV0FBTSxHQUFJLElBRVYsS0FFRCxTQWtDUyxjQUFjLEVBRXRCLEdBQUUsVUFBVyxRQUNiLENBRHNCLE9BQ25CLEtBRUgsS0FBSSxLQUlKLE9BQUksS0FDSixPQUFJLElBQUssRUFBRSxlQUFnQixFQUFFLElBQUssS0FJbEMsaUJBQUssYUFBYyxHQUNuQixRQUFPLEtBQUssSUFBSyxLQUNqQixNQUFhLE9BRWIsY0FBYyxDQUFKLElBQVUsSUFDcEIsV0FBYyxDQUFKLEdBQVEsR0FBTSxJQUN4QixXQUFjLENBQUosR0FBUSxHQUFNLElBQ3hCLFdBQWMsQ0FBSixHQUFRLEdBRWxCLENBRUQsSUEvSkksT0FBUSxTQUNaLE1BQUksV0FBYSxTQUtqQixjQUFlLElBQVYsVUFDSCxvQkFBd0IsVUFDeEIsb0JBQXNCLFFBQ3RCLG9CQUVELEdBS0Qsb0JBTFMsS0FDUiw0SEFJRyxTQUFVLE1BQ2QsTUFBSSxVQUFZLFdBQVcsU0FDM0IsTUFBSSxRQUFVLFdBQVcsT0FDekIsTUFBSSxJQUFNLFdBQVcsR0FFckIsTUFBSSxVQUFZLFVBQVUsT0FFMUIsRUFBSyxXQUVKLDJCQUFTLGFBQWMsVUFBVyxHQUFJLE9BQU0sZ0JBQWlCLEdBQUksY0FBYyxFQUFJLFdBSXBGLElBSU0sT0FKRixVQUFXLFdBQVcsUUFFMUIsTUFBSSxLQUFPLEdBQUksS0FFZixHQUFVLEVBQUksRUFBRyxFQUFJLFVBRXBCLFNBQU0sR0FBTSxHQUFJLE9BQ2hCLGFBQU0sR0FBTSxHQUFJLE9BSWpCLFdBQUksSUFBSyxHQUFJLE9BQU0sUUFDbEIsR0FBSyxHQUFJLE9BQU0sUUFDZixHQUFLLEdBQUksT0FBTSxRQUVmLElBQU0sR0FBSSxPQUFNLFFBQ2hCLElBQU0sR0FBSSxPQUFNLFFBQ2hCLElBQU0sR0FBSSxPQUFNLFFBRWhCLEtBQU8sR0FBSSxPQUFNLFFBQ2pCLEtBQU8sR0FBSSxPQUVaLFFBaURJLE9BQVMsU0FFYixPQUVDLENBRkksVUFBTyxnQkFFRixDQUNSLE9BQ0EsUUFBTyxRQUtULGNBQU0sR0FBSSxHQUFJLEVBQUcsR0FBSyxPQUFPLE9BQVEsRUFBSSxHQUFJLEVBRTVDLEVBS00sT0FMRixPQUFRLE9BRVosR0FBSSxNQUFRLE1BQ1osTUFBSSxNQUFRLE1BRVosTUFBVSxFQUFJLE1BQU8sR0FBSyxNQUFRLE1BQU8sRUFBSSxHQUFJLEdBRWhELGlCQUNDLFFBQVMsRUFBSSxHQUNiLFFBQVMsRUFBSSxHQUNiLFFBQVMsRUFPWixJQTZCTSxPQTdCRixLQUFNLEdBQUksT0FBTSxRQUFXLEtBQU8sR0FBSSxPQUMxQyxRQUFJLEVBQUksR0FBSSxPQUFNLFFBQVcsR0FBSyxHQUFJLE9BQ3RDLFFBMkJVLEVBQUksRUFBRyxHQUFLLE9BQU8sT0EzQnpCLEVBQUcsRUFFUCxLQXlCcUMsRUFBSSxHQUFJLEVBRTVDLEVBS00sT0FMRixPQUFRLE9BRVosR0FBSSxNQUFRLE1BQ1osTUFBSSxNQUFRLE1BRVosTUFBVSxFQUFJLE1BQU8sR0FBSyxNQUFRLE1BQU8sRUFBSSxHQUFJLEdBRWhELGVBQWMsUUFBUyxFQUN2QixpQkFBYyxRQUFTLEVBQ3ZCLGlCQUFjLFFBQVMsRUFNekIsR0FNRCx3QkFBdUIsU0FBVyxXQUFZLFVBRTdDLENBWU0sT0FaRixXQUVKLElBRmdCLGNBQVksR0FBSSxNQUU1QixlQUFpQixHQUFJLEtBQUssT0FBTyxLQUFNLFdBQVksR0FDdkQsYUFBSSxvQkFBc0IsR0FBSSxLQUFLLE9BQU8sS0FBTSxXQUFZLEdBRTVELGtCQUFJLFdBQ0osR0FBSSxnQkFFSixHQUFJLGVBQWlCLEdBQUksT0FFekIsZUFBSSxPQUVKLEVBQVUsRUFBSSxFQUVULFNBRlksRUFBSSxXQUFXLE9BQVEsRUFBRyxFQUUxQyxhQUFlLFdBSWYsR0FBSyxZQUFtQyxJQUFuQixZQUFTLE9BQW1CLE1BSWpELFVBQU0sR0FBSSxRQUFRLFVBQVMsV0FFMUIsSUFBSyxDQUFDLGVBQWUsSUFBSyxNQUFTLE1BRW5DLE1BQUssb0JBQXVCLFFBQVksV0FBWSxNQUVwRCxlQUFZLE1BQU8sS0FBTSxTQUFTLFdBRWxDLE1BSUQsS0FBTSxHQUFJLFFBQVEsVUFBUyxnQkFFMUIsSUFBSyxDQUFDLG9CQUFvQixJQUFLLE1BQVMsTUFFeEMsTUFBSyx5QkFBNEIsUUFBWSxnQkFBaUIsTUFFOUQsb0JBQWlCLE1BQU8sS0FBTSxTQUFTLGdCQUV2QyxNQUlELG1CQUFlLFNBQVMsZUFBaUIsZUFBZSxTQUFTLGdCQUNqRSxrQkFBZSxTQUFTLGVBQWUsS0FBTSxTQUU3QyxVQUFLLFVBRUosSUFFQSxVQUVDLGdCQUFRLFNBQVMsTUFFakIsVUFBTSxJQUFLLGtCQUFTLFdBRXBCLGVBQVEsU0FBUyxXQUFXLFNBSTVCLGlCQUlELHFCQUFlLFNBQVUsT0FBUSxNQUVqQyxXQUVBLEtBRUQsQ0FJRCxJQUFLLFVBRUosQ0FHTSxPQUhGLGFBQ0osRUFBSSxVQUVKLEdBQVUsRUFBSSxFQUVULE1BRlksRUFBSSxXQUFXLE9BQVEsRUFBRyxFQUUxQyxVQUFZLFdBQVksR0FFeEIsTUFBbUIsQ0FBZCxhQUVKLE9BQVEsTUFFUixZQUFNLEdBQUksR0FBSSxFQUFHLEVBQUksTUFBTSxNQUFPLEVBRWpDLFFBQU0sS0FBTSxFQUFHLE1BQU0sS0FBTSxHQUk1QixZQUVELFdBQVUsS0FDVixvQkFBZSxXQUFZLEdBQUksV0FBVyxTQUUxQyxLQUVELElBQUksYUFBYyxLQUFLLHNCQUV2QixjQUFLLENBQUMsWUFBYyxNQUVwQixxQkFBZSxNQUVmLFdBSUQsS0FBTSxHQUFJLFFBQVEsWUFFakIsSUFBSSxpQkFBa0IsS0FBSyxzQkFBdUIsV0FFbEQsVUFBSyxDQUFFLGdCQUFrQixNQUV6QixxQkFBZSxhQUFjLEtBRTdCLGdCQUlELEtBQU0sR0FBSSxRQUFRLGlCQUVqQixJQUFJLGlCQUFrQixnQkFBaUIsTUFBUSxHQUUvQyxVQUF5QixDQUFwQixtQkFFTCxxQkFBZSxnQkFBa0IsZUFBZSxpQkFDaEQsa0JBQWUsZ0JBQWlCLE1BRWhDLE9BQU0sR0FBSSxHQUFJLEVBRVQsdUJBRlksRUFBSSxnQkFBaUIsRUFBRyxFQUV4Qyx3QkFFQSxPQUFNLEdBQUksR0FBSSxFQUFHLEVBQUksZ0JBQWlCLE1BQU8sT0FBUSxFQUVwRCx5QkFBdUIsS0FBTSxnQkFBaUIsTUFBUSxHQUl2RCxPQUFJLHNCQUF1QixLQUFLLHNCQUVoQywyQkFBSyxDQUFDLHFCQUF1QixNQUU3QixxQkFBZSxnQkFBaUIsTUFBTyxLQUV2QyxxQkFFRCxDQUVELE9BRUEsZUFNRCx3QkFBdUIsU0FBVyxXQUVqQyxDQUtNLE9BRkYsYUFFSixFQUFVLEVBQUksRUFKZCxXQUNBLFNBQ0EsV0FJSyxVQUZZLEVBQUksV0FBVyxPQUFRLEVBQUcsRUFFMUMsY0FBZ0IsV0FFaEIsR0FBSyxVQUFVLDZCQUErQixNQUU5QyxTQUFvQixxQkFBWSxXQUFhLFVBQVUsTUFDdkQsYUFBSyxhQUFlLFVBQVUsTUFBTSxZQUFjLE1BRWxELFNBQWtCLG1CQUFZLFNBQVcsVUFDekMsVUFBSyxXQUFhLFVBQVUsU0FBVyxNQUV2QyxTQUFvQixxQkFBWSxXQUFhLFVBQzdDLFlBQUssYUFBZSxVQUFVLFdBQWEsTUFFM0MsbUJBQWUsVUFBVSxNQUV6QixNQUVELENBR00sT0FIRixPQUFRLEdBQUksWUFDaEIsYUFBSSxPQUVKLEVBQVUsRUFBSSxFQUFHLEVBQUksV0FBVyxPQUFRLEVBRXZDLFFBQU0sSUFBSyxXQUFZLEdBQUksTUFFM0IsZ0JBQVUsV0FBWSxHQUFJLE1BSTNCLGFBQU8sSUFBSSxPQUFNLGdCQUFpQixNQUFPLFNBRXpDLFdBclkwQixpRENKNUIsYUF5TEEsa0NBQ0EsbUJBc0RBLG1CQUNBLGtDQUNBLHNCQUE2QixNQUU3QixhQUNBLEtBQ0EsbUJBNEJBLDZDQUF1RCxjQUFvQixLQUMzRSxFQVFBLHFDQW9EQSxxREFFQSxrQ0FDQSxhQUdBLDZCQUNBLDhDQUVBLElBQ0EsRUFHQSxnQ0FDQSxJQUNBLDBCQUVBLFVBRUEsUUFDQSxNQUZBLEtBR0EsV0F6S0EsYUFDQSxZQUVBLGFBR0EsQ0FDQSxjQUNBLHVEQXFEQSxRQUFtQywyQkFDbkMsaURBQ0EsWUFDQSxvQkFBeUIsTUFDekIsT0FDQSxZQUNBLDBCQUNBLG1CQUVBLG9DQUNBLDRCQUNBLDJCQUFtQyxXQUVuQyxvQkFDQSw2QkFBb0MsTUFFcEMsa0RBQ0EsOEJBQ0EscUJBQ0EsVUFDQSxHQUlBLE1BNUVBLFNBQ0EsYUFDQSxvQkFDQSxpQkFDQSxDQUNBLDZHQW9GQSxXQUNBLGlDQUF3QyxNQUd4Qyx1QkFFQSxjQUNBLHlCQUVBLHVDQUNBLGtCQUNBLElBR0EseUNBQ0EsWUFBb0MscUJBQ3BDLE9BR0EsOERBQStDLE1BRy9DLGNBQ0EsT0FFQSxRQUNBLDhEQUdBLG1DQUVBLDJEQUNBLGNBQ0EsTUFBNEIsZUFBdUIsT0FDbkQsd0JBRUEsOENBQ0EsK0RBQ0EsR0FDQSxFQUNBLGdCQU1BLDBCQWpJQSx3QkFDQSwrQ0FpSUEsMkJBQ0EsTUFDQSx1QkFsSUEsa0NBQ0EsYUFDQSxrQ0EwQkEsZUFDQSx1QkFDQSx1QkFDQSxLQUlBLFlBaENBLHVCQUNBLHFCQUNBLHdCQWFBLDJEQUVBLGtEQUNBLEtBTUEsdUNBZ0JBLGlCQThHQSxVQUNBLHlCQUNBLDZCQUNBLEtBR0EsQ0F6V0EsMkNBQThDLENBRTlDLHdDQWlCQSw4QkFDQSxpREFDQSxJQUNBLHFCQUdBLDJCQUtBLDZCQUNBLG1EQUNBLGdCQUNBLGVBQ0EsNkJBQ0EscUJBQ0EsVUFDQSx1Q0FDQSwrREFDQSx1QkFDQSxrQkFBaUMsT0FBYSxLQUM5QyxxQkFBbUMsd0JBQThCLEtBQ2pFLHlDQUNBLHFCQUVBLCtCQUF3QyxpQkFBdUIsS0FBRSxFQUNqRSxFQUNBLDRDQUNBLHdEQUE0RSxtQkFBOEIsUUFDMUcsRUFFQSxFQUNBLHlGQUNBLGVBQ0EsYUFDQSx1QkFDQSwrQkFDQSxtQkFDQSxNQUNBLHVEQUNBLEdBQ0EsRUFDQSxjQUVBLHlFQUNBLGVBQ0EsYUFDQSx1QkFDQSxLQUNBLEVBQ0EsY0FFQSw0RUFDQSxlQUNBLGFBQ0EsdUJBQ0EsUUFDQSxFQUNBLGNBRUEsNkRBQ0EsV0FDQSx5Q0FDQSxPQUNBLGtCQUNBLFNBQ0Esa0JBQ0EsMENBQ0Esb0JBQ0EsbUVBQ0EsdUVBQ0EsMkNBQ0EsYUFDQSxFQUNBLDZDQUNBLHlCQUNBLFFBQ0EsR0FDQSxrQkFDQSxPQUNBLDhCQUNBLEVBQ0EsRUFlQSx5RUFDQSxRQUE0Qyw2Q0FDNUMseUJBQ0EsaUNBQ0EsNkJBRUEsOENBS0EsNENBQ0EsMEJBRUEsa0dBQ0EsNERBQ0EsT0FDQSw2QkFDQSxtQkFLQSxxREFDQSxXQUVBLDBCQVVBLHNDQUNBLGdFQUNBLHFDQUNBLFNBQ0Esa0JBRUEsR0FLQSxzREFDQSxNQUNBLGdDQUFrQyxXQUVsQyxPQUNBLEVBQ0EsZUFFQSw4REFFQSxPQURBLDRCQUVBLG9CQU9BLGdEQWtOQSxXQTlCQSxVQUNBLGtEQUNBLG1EQUNBLDhDQUNBLDhEQUNBLHFFQUNBLDJFQUNBLGdEQUNBLCtEQUNBLHNFQUNBLHFDQUNBLG9EQUVBLDhEQW1CQSwwQkFDQSwwQ0NsWEEsQ0FNQSw0QkFDQSxrQkFFQSxlQXdCQSxDQUNBLGdDQXhCQSxnQ0FDQSxvQ0FDQSxpQkFDQSxVQUNBLG9DQUFnQyx3QkFDaEMsWUFDQSxhQUVBLEVBaUJBLDRCQWhCQSwwQkFDQSxpQkFDQSxHQUNBLG9DQUNBLHFCQUVBLGFBQ0EsV0FFQSxFQVNBLHNEQVJBLG9CQUNBLEtBRUEsRUFTQSxJQUNBLFdBQ0Esb0RBTUEsa0NBQ0Esa0VBQ0EsaUJBQ0EsK0RBQ0EsMkRBQ0EsK0NBQ0EsS0FFQSxFQUNBLEVBRUEsNkJBQ0Esb0NBRUEsc0RBRUEscUJBQ0EsYUFDQSxxQ0FDQSwyQkFDQSxVQUNBLGtCQUNBLFVBQ0EsbURBQ0EsU0FFQSxtREEvQkEsZUFDQSxFQUNBLDBCQThCQSwyQkFDQSx5REFDQSxrQ0FDQSx5QkFDQSxLQUNBLENBQ0EsQ0FsQ0EsRUFrQ0MsS0FFRCxlLFNBbkZBLHFDQUNBLDZCQUNBLGNBRUEsK0NDaENBLENBRUEsR0FDQSwyQ0FHQSx3R0FDQSw4Q0FFQSwrQ0FDQSxpRUFDQSx3Qix1RENYQSxlQVVBLDBDQVFBLDRDQUVBLDhCQUNBLHVCQUdBLDhEQUlBLCtFQUVBLG1DQUNBLFlBQ0ssMkJBRUwsb0NBQ0EsS0FLQSxxQ0FDQSxtQkFDQSxNQUNLLCtCQUNMLHNCQUdBLGVBRUEsR0FDQSwyREFHQSxXQUNBLG9CQUNBLHNCQUNBLGlDQUNBLHlCQUdBLG1EQUlBLDBDQUNBLGFBQ0EsR0FoRUEsK0JBT0EsaURDVEEsc0NBQ0EsOEJBQ0EsaUNBRUEsWUFFQSxzREFDQSxXQUNBLGlDQUVBLFNBRUEsR0FDQSwyQkNiQSxnQkFFQSxrRUFDQSxhQUNBLDJEQUNBLGFBQ0EsT0FDQSxLQUNBLGNBQ0EsWUFHQSxrQkFHQSxtQ0FDQSxhQUNBLGtDQUNBLCtCQUNBLDRCQUNBLHFDQUNBLElBQ0EseUVDOEVBLG9CQUNBLHVEQUNBLGtCQUNBLEdBQ0EsZ0JBQ0EsK0JBQ0EsSUFBb0IsdUJBQ3BCLEVBRUEsR0FFQSxvQkFDQSwyQ0FDQSxzQkFDQSwyQkFDQSxLQUNBLHlEQUNBLE1BQ0EsYUFBbUIsR0FBTSxPQUFnQixNQUN6QyxRQUNBLElBQ0EscUNBQ0EsRUFDQSxRQUFpQixjQUFzQixLQUN2QyxDQUNBLE9BQ0EsSUFRQSxtQkFDQSw0REFDQSxvR0FwSEEsdUJBQ0EsY0FDbUIsa0JBQXNCLENBQ3pDLGlCQURBLHNFQUVBLElBRUEsK0dBUUEsb0JBQ0EsT0FDQSw2REFDQSx3QkFDQSxnQkFDQSwyRkFBNEQsT0FBYyxXQUMxRSxnQ0FDQSxXQUNBLG1DQUVBLCtDQUNBLHVHQUNBLDRHQUNBLHVDQUE0QyxFQUFRLDZFQUNwRCxzREFDQSwrQkFFQSxzQ0FDQSw0QkFBbUMsc0JBQW9DLFdBQ3ZFLGtDQUVBLDhDQUNBLHNHQUNBLDhDQUVBLGtEQUNBLG9EQUNBLDBCQUFtQyxJQUFNLHFCQUE2QixPQUFFLFNBQVksUUFBVyxFQUFFLENBQ2pHLHlCQUFrQyxJQUFNLHlCQUFpQyxPQUFFLFNBQVksUUFBVyxFQUFFLENBQ3BHLHNCQUErQiwwREFBaUUsZ0JBQXVCLE1BQUUsa0JBQTRCLFNBQ3JKLDBEQUNBLE9BQ0Esb0NBRUEsa0NBQ0EsaUJBRXNCLG1CQUFzQixnQkFBcUIsR0FBRyxDQUNwRSxrQkFDQSwwQkFDQSw4Q0FDQSx5RkFDQSw0QkFDQSxXQUNBLG9CQUF1QyxHQUN2QyxzQkFBa0MsUUFBUyxhQUMzQyxrQkFBa0MsYUFBVyxPQUFVLEdBQ3ZELHlCQUF5QyxhQUFjLE1BQ3ZELFNBQ0EsNkVBQTZHLEdBQU8sRUFBVSxRQUM5SCw0Q0FBZ0YsWUFBaUIsR0FBTyxLQUN4Ryw0QkFBd0QsV0FBZ0IsS0FBUSxHQUFPLEtBQ3ZGLG9CQUE4QyxXQUFnQixjQUFnQixJQUFPLEtBQ3JGLGFBQ0EsYUFBaUMsTUFFakMsK0JBQ0EsRUFBUyxTQUFZLE9BQWEsS0FBTyxDQUFFLFFBQVUsS0FBVyxDQUNoRSxxQkFBbUMsU0FBUywwQkFDNUMsUUFDQSxPQXpCYSx3QkFBNkIsbUJBQTBCLFlBQWEsRUFBRSxjQUFxQixVQUN4RyxXQUFnQix3Q0FBcUQsNkRBQW9FLE9BQWEsS0FBRSxHQUN4SixvQ0F5QkEsZ0NBQ0EseURBQ0EsMEdBOEJBLG1CQUNBLGlCQUE0QixjQUFzQixPQUNsRCxrQ0FDQSxXQUNBLDhFQU1BLHVEQUNBLGlCQUdzQix3QkFBZ0MsaUNBQXFDLCtCQUEwQyxFQUFJLEVBQUcsRUFDNUkscUJBQTJCLElBQU0sV0FBZSxHQUFFLFNBQVksZ0JBQW9CLEVBQUUsQ0FDcEYsaUJBQXNCLDJGQUFvRyxFQUMxSCx3QkFBNkIsZUFBdUIsTUFDcEQsdUJBQTRCLGdCQUF3QixNQUNwRCxxQkFBMkIsZ0RBQXlELEdBQ3BGLDhDQVJBLHdGQUNBLGNBQWlCLCtFQUFzRixPQUFhLEtBQUUsRUFDdEgsd0NBUUEsNEJBQ0EsbUJBRXlCLHdCQUFnQyxjQUFvQiw2QkFBZ0QscUJBQWdCLENBQUcsRUFDaEosT0FGQSxXQUFpQix3Q0FBNEMsTUFBUyxFQUFFLCtDQUFxRCxPQUFhLEtBQUUsRUFDNUkscUNBR0EseUJBQ0EsOENBQ0EsdURBQ0EsbUZBQ0Esc0RBRUEseUNBQ0EsZUFBZ0Msa0RBQXVDLE9BQXdCLGlCQUMvRixJQUNBLFFBcktBLGlDQXVLQSwwQkFDQSw4QkFDQSxnQkFDQSxtRkFDQSwwQkFDQSxJQUNBLDRDQUVBLDZCQUNBLGdDQUE0QyxTQUM1QyxNQWpLQTs7Ozs7Ozs7Ozs7Ozt5R0FDQSxnQkFBTSxXQUFnQixrQ0FBc0MsYUFBaUIsQ0FDN0UsZ0JBQXFCLDZDQUF1RCxpREFTNUUseUJBQTRDLFdBQU8sRUFDbkQsNkJBQ0Esd0RBRUEsVUFDQSxlQ2hDQSxDQXdQQSwrQkFDQSxJQUNBLG1CQUNBLElBQWEsV0FBbUIsT0FBTyxtQkFDdkMsR0ExUEEsR0FDQSwyQ0FJQSxnRUFDQSxvQkFDQSxDQUNBLGFBQ0EsY0FRQSxZQUNBLHlDQUNBLFFBQ0Esb0JBQ0EsbUJBQ0EscUJBQ0Esc0JBQWUsUUFDZixhQUFjLFFBR2Qsb0JBQ0EscUNBQ0EsbUNBQ0EsNkJBQ0EsZ0NBQ0EsOEJBQ0EsaUNBQ0EsZ0NBQ0EsOEJBQ0Esd0NBQ0EsOEJBQ0EsdUJBQ0Esa0JBQ0EsMEJBQ0EsUUFDQSxpREFFQSxvQ0FDQSw4Q0FDQSxlQUVBLG1DQUFnQyxvQkFDaEMsa0JBRUEsaUJBQ0EsdUNBQ0EscUVBQ0EsaUVBQ0EsU0FFQSxtQkFDQSxlQUNBLG9FQUNBLG9FQUNBLFNBRUEscUJBQ0Esc0JBRUEsc0NBQ0EsZ0RBQ0EsMENBR0EsdUJBQ0EsMEJBRUEsaUNBQ0EsNkJBQ0EsMENBQ0EsNEJBRUEsS0FkQSxVQUlBLHdCQUNBLGFBR0EsZUFTQSx1REFFQSxrQ0FFQSxVQUFxQixZQUdyQiw4Q0FDQSx1Q0FDQSxrQ0FDQSxnQ0FFQSxxQkFDQSx3Q0FDQSwwQkFBbUMscUNBR25DLDZDQUdBLHNDQUNBLElBQWUsY0FBc0IsT0FDckMsMkJBR0EsMkVBRUEsV0FDQSx3Q0FDQSxVQUNBLHVDQUNBLDJDQUdBLE9BQ0EsUUFHQSwrQkFBOEMsbUNBSTlDLGlDQUNBLElBQWUsbUJBQTJCLE9BQzFDLEtBQ0EsNkZBS0EscUNBQ0EsSUFBZSwyQkFBbUMsT0FDbEQsS0FDQSwrRkFDQSxpREFFQSw0REFJQSxXQUFlLHNCQUE4QixPQUM3QyxnQ0FDQSx1Q0FDQSw0Q0FJQSxtQkFBZSxtQkFBMkIsT0FDMUMsNkJBQ0EsS0FDQSxxREFDQSw0QkFDQSxZQUNBLCtEQUNBLHdFQUNBLHFDQUtBLGtDQUVBLDhEQUNBLG9EQUNBLDZDQUNBLG9DQUNLLGlEQUVMLDRCQUNBLCtEQUNBLDJFQUVBLDZCQUVBLGlDQUNBLHdDQUNBLDJDQUNBLHVDQUlBLCtDQUNBLGdCQUdBLDRCQUNBLGdDQUVBLHFCQU1BLDJCQUNBLDJCQUVBLHdCQUdBLElBQ0EsUUFFQSwyQ0FFQSxvQkFDQSxxQkFDQSw0Q0FDQSx1RUFDQSwrQ0FFQSxtREFHQSw4QkFDQSx1QkFDQSwyRUFDQSwwQ0FDQSxrRUFDQSxrREFDQSxrREFDQSxDQUNBLENBS0EsdUJBQ0EsTUFDQSxRQUtBLDJCQUNBLGVBRUEseUJBQ0EsOENBQ0EseUJBQ0EsY0FDQSxRQUNDLGdCQ3RQRCxHQUNBLDJDQUNBLGdFQUVBLHFCQUlBLEdBQ0EseUNBQ0EsUUFDQSxTQUNBLGdDQUF5QixRQUN6Qiw4QkFBNkIsUUFDN0IsMkJBQTRCLFFBQzVCLGNBQ0EsaUNBQ0EsMEJBQ0EsNEJBQ0EsMEJBQ0EscUJBQWMsUUFDZCw2QkFBNEIsUUFDNUIsU0FDQSxvQkFDQSwwQkFBeUMsMkNBRXpDLDRCQUVBLEtBQ0EsSUFKQSxHQU1BLFdBR0EsNEJBQ0EsZUFFQSxLQURBLFNBR0Esc0JBQ0EscUJBQ0EsMEJBQ0EsbUJBQ0EsaUJBQ0EsV0FFQSx5Q0FDQSxxREFDQSw4QkFDQSx3Q0FDQSxtQ0FDQSw0Q0FDQSwwREFDQSx5REFDQSxRQUVBLDBCQUNBLG1CQUNBLG1CQUdBLDZCQUNBLDhDQUNBLCtDQUNBLDRDQUNBLDBEQUNBLHlEQUdBLGVBQ0EsVUFDQSxlQUtBLHFCQUNBLGVBQ0EsS0FFQSxlQUdBLHFDQUNBLHVEQUlBLGFBQ0EseURBSUEsc0RBQ0EsYUFDQSxJQUFxQixnQkFBd0IsT0FDN0MscUJBRUEsK0JBQ0EsTUFHQSxNQUNBLGtDQUNBLGFBQTZCLDZCQUM3QixpREFDQSx5REFDQSx5QkFDQSx5QkFFQSw0QkFDQSxxQ0FFQSwrQkFDQSxzRUFJQSwwQkFFQSwwQkFDQSxtQkFDQSxtQkFFQSx5Q0FDQSwyQ0FDQSxhQUNBLGdDQUNBLFNBRUEscUJBQ0EsMENBRUEsVUFFQSwyQkFDQSxjQUNBLFNBRUEsMEJBQ0EsY0FDQSxRQUtBLGdDQUVBLHlCQUNBLHlDQUNBLHlCQUVBLHNDQUlBLGtEQUVBLHVCQUNBLCtCQUNBLHNCQUNBLDhDQUNBLDhEQUNBLHVCQUNBLG9CQUNBLFlBQVMsaUJBQ1QsTUFDQSxPQUNBLE1BQ0Esb0JBQ0EsS0FFQSw0QkFDQSxlQUNBLHFEQUNBLElBQ0EsbUNBQ0EseURBQ0EsOENBQ0EsV0FDQSxNQUFLLGlCQUNMLE1BRUEsMkJBQ0Esb0NBQ0EsY0FDQSwwQ0FDQSxnQ0FFQSxxREFFQSwyQkFFQSwrQ0FDQSxNQUNDLGVDbk1ELENBQ0EseUNBRUEsR0FDQSwyQ0FDQSxnRUFFQSxxQ0FDQSxRQUNBLFNBQ0Esd0JBQ0EsMEJBQ0EsTUFHQSxHQUVBLDJCQUNBLG1CQUNBLG9CQUNBLElBRUEsbUJBQ0EsTUFDQSwyQkFDQSwyQkFDQSxrQkFFQSxtQkFDQSxNQUNBLHFCQUVBLGtCQUNBLE1BQ0EscUJBRUEsaUJBQ0EsTUFDQSxrQkFNQSxnQ0FDQSxlQUNBLGFBQ0EsR0FDQSxNQUNBLE9BR0EsaUNBQ0EsZUFHQSx5REFFQSxrQkFDQSwwQ0FHQSxvQkFDQSwyQkFDQSxrRkFDQSxjQUVBLFVBQ0EsQ0FFQSw2QkFDQSw4Q0FDQSxhQUVBLGdDQUNBLGlEQUNBLGFBQ0MsaURDN0VELE9BQ0EseUNBQ0EsSUFFQSwyQ0FDQSxRQUNBLG1CQUdBLDRCQUdBLFVBRUEsNkJBQ0EsdUNBQ0EsMENBRUEscUJBQ0Esb0JBRUEsMkNBQ0EsQ0FDQSxnQ0FFQSx3Q0FDQSxxQkFDQSw2REFHQSxzQ0FDQSx3QkFDQSxtRUFJQSxlQUNBLDZEQUdBLG1CQUF3QyxxQ0FDeEMsTUFDQSxFQUNDLElBRUQsa0RBQ0EsUUFDQSxtQkFHQSw0QkFDQSxnQkFFQSw0QkFDQSw0REFDQSxvQ0FDQSxvQ0FDQSwyQ0FDQSw0QkFDQSxNQUVBLGtFQUNBLHFDQUNBLDBDQUNBLEtBQ0MsZUNqRUQsQ0FFQSxHQUNBLDJDQUtBLGdFQUNBLG1DQUNBLGVBRUEsMkJBQ0EsZ0JBQW9CLFFBQ3BCLFFBQVUsUUFDVixjQUNBLG9CQUFhLEtBQ2IscUJBQWlCLEtBQ2pCLGlCQUFZLFFBR1osSUFFQSwyQkFDQSxlQUVBLFVBRUEsaUNBQWtDLE1BQWMsT0FFaEQsb0RBQ0Esd0RBQ0Esd0RBQWtFLE9BQ2xFLFlBQ0EsbUJBQ0Esb0VBQ0Esc0JBQ0EscURBQ0Esc0RBQ0EsYUFDQSxtQkFBUyxFQUNULElBRUEsRUFFQSxtQkFDQSxNQUNBLHNCQUVBLDJCQUNBLGVBRUEsS0FEQSxrREFFQSw2REFDQSwwREFDQSxLQUVBLDhCQUNBLGVBQ0EsS0FDQSxFQUVBLDJGQUNBLEtBQWUsZ0JBQXdCLE9BQ3ZDLHNEQUVBLFVBRUEsaUNBQ0EsZUFDQSxLQUNBLEVBRUEsMkZBQ0EsS0FBZSxnQkFBd0IsT0FDdkMseURBRUEsVUFDQyxxQkM5RUQsQ0FzSUEsd0RBQ0EscUNBUUEsU0FQQSxPQUNBLGFBQ0EsVUFDQSxhQUNBLFVBQ0EsMEJBR0EsNEJBQ0EsVUFDQSxrQ0FDQSxzQkFHQSxnREFDQSxzREFFQSxhQUFlLE1BQVksS0FDM0IsaUJBQW9CLGNBQXVCLFFBQzNDLGdDQUNBLEdBQ0EscUVBRUEsY0FDQSxxRUFFQSxjQUNBLCtEQUVBLFdBQ0EsK0RBRUEsNEJBSUEsc0JBQ0EsV0FNQSw2Q0FDQSxJQUNBLEdBRUEsVUFBYSxJQUFpQixZQUM5QixJQUVBLG1CQUNBLHFCQUVBLFlBR0Esb0RBQ0EsR0FDQSxvRUFFQSxNQUNBLG9FQUVBLE1BQ0Esb0VBRUEsTUFDQSxvRUFFQSx1QkFFQSxzQkFDQSxXQU9BLDJDQUNBLHFCQUNBLGlDQUNBLGdCQU1BLCtCQUNBLE9BQ0EsbUJBQ0EsTUFDQSxNQUNBLE9BQ0EsT0FDQSxPQUVBLDhCQUNBLEdBQ0EsVUFNQSx1Q0FDQSw4QkFDQSxNQUNBLFFBQ0EsVUFDQSxRQUNBLFFBQ0Esb0JBQ0EsUUFDQSxPQUNBLE9BQ0EsT0FDQSxNQUNBLE9BQ0EsT0FDQSxNQUNBLE1BQ0EsUUFDQSxPQUNBLE9BQ0EsT0FDQSxPQUNBLE9BQ0EsU0FDQSxRQUNBLFFBQ0EsUUFFQSw4QkFDQSxHQUNBLFVBTUEsa0NBRUEsbUJBQ0EsMkJBRUEsc0NBQ0Esa0JBQ0EsaUJBQ0EsZUFKQSxvQkFNQSw4QkFDQSxHQUNBLFVBU0EsMkNBQ0EsT0FFQSxVQURBLGVBRUEsRUFDQSw4QkFDQSxFQUNBLGNBRUEsUUFPQSxDQUNBLDhCQUNBLElBQ0EsU0FBYSxjQUFzQixPQUNuQyxrQkFFQSxLQU9BLENBQ0EsbURBQ0EsSUFDQSxPQUNBLEVBSUEsNkJBQ0EsT0FBZSxRQUFnQixPQUMvQiwrQkFDQSw4QkFDQSw2QkFDQSw2RkFDQSx3QkFFQSxLQUNBLE1BRUEsT0FBYSxjQUFzQixZQUNuQyxXQUFzQixHQUN0Qiw4RUFDQSxHQUNBLEVBRUEsd0JBQ0EsSUFDQSxTQUFhLGNBQXNCLE9BQ25DLG1CQUVBLEdBRUEsK0JBQ0EscUJBQ0EsdUJBQ0EsdUJBQ0EscURBMVdBLDRCQUtBLFFBQ0Esa0NBQ0EsUUFDQSxRQUFZLDJDQUF1RCxNQUNuRSxxQkFBYyxvQkFBeUIsTUFDdkMsaUJBQWEsb0JBQXlCLFlBQ3RDLHdCQUFtQixvQkFBeUIsTUFDNUMsb0JBQWdCLG9CQUF5QixNQUN6Qyx5QkFBcUIsUUFDckIsV0FBWSxRQUNaLGNBQWEsb0JBQXlCLHFDQUN0QyxzQkFDQSxrQkFBVywyREFDWCxPQUNBLGtCQUFXLGVBQW9CLE1BQy9CLG1CQUFZLHNDQU1aLHdCQUNBLFVBQ0EsYUFFQSxvQkFDQSx5Q0FFQSw4REFDQSx5QkFHQSxzREFDQSx3REFDQSx3REFDQSxFQUNBLGdCQVA4QixVQUM5Qix1REFDQSxjQU9BLDBEQUNBLDZEQUVBLGdEQUNBLCtEQUNBLDBFQUNBLE1BS0EsbUJBQ0EsbUJBQ0EsbUJBQ0EsYUFFQSxHQURBLFlBRUEsWUFFQSx1Q0FHQSxZQUNBLGdCQUNBLFlBQ0EsZ0JBQ0EsS0FDQSxjQUNBLFlBQ0EsbUJBQ0EsS0FDQSxZQUNBLFlBQ0EsaUJBQ0EsS0FDQSxvQkFDQSxZQUNBLHlCQUNBLEtBQ0EsZUFDQSxZQUNBLG9CQUNBLEtBQ0EsQ0FFQSxtQkFJQSxpREFDQSwyQkFDQSxZQUNBLGdCQUNBLFlBQ0EsOEJBQ0EsNENBRUEsbUJBQXVCLG1CQUN2QiwrQ0FDQSxlQUtBLG1CQUNBLG1EQUNBLHVFQUNBLHFEQUNBLGlCQUVBLG1DQUVBLGFBQ0EsOEJBQ0EsbUNBQ0EsU0FDQSxTQUVBLG1DQUVBLEVBQ0EscUdBQ0EscUVBQ0EsUUFDQSxTQUtBLElBeUNBLCtCQUlBLGdCQStCQSxrQ0FLQSxtQkFLQSxnQ0FJQSxpQkFhQSxnQ0FJQSxpQkFnQ0Esd0NBSUEseUJBY0EsbUNBT0Esa0VDelNBLHdCQUVBLDBDQUNBLGVBRUEsaUJBQ0EsYUFBaUIsS0FDakIsNEJBQXNCLFFBQ3RCLGtCQUFvQixRQUNwQixjQUNBLDJCQUNBLHdCQUNBLHVCQUNBLDBCQUNBLHdCQUNBLDZCQUFzQixLQUN0QixxQkFBa0IsUUFDbEIsb0JBQXNCLHNCQUN0QiwyQkFBc0Isc0JBQ3RCLHVCQUNBLDRCQUFvQiwwQ0FDcEIsa0JBQWtCLFFBQ2xCLGtCQUFvQixRQUNwQixZQUFjLFFBQ2QsYUFBZSxRQUNmLGdCQUFrQixRQUNsQiwwQkFDQSxvQkFBYSxLQUNiLG1CQUFnQixRQUdoQixxQkFDQSxhQUNBLEdBRUEsaUVBQ0EsOEJBRUEsa0NBRUEsbURBQ0Esc0JBQ0EsNkNBQ0EsNEJBQ0EsMkJBQ0EsbURBQ0Esd0RBQ0Esb0RBRUEsSUFFQSw2Q0FDQSxzQkFDQSw2Q0FDQSw0QkFDQSxrREFDQSw2QkFDQSxrREFFQSxjQUVBLDhCQUNBLGlEQUNBLDRCQUNBLFVBQ0EsMkNBQ0EsNEJBQ0EsTUFFQSx5QkFDQSx5REFDQSxnQkFFQSxtQkFDQSxtQkFDQSxtQkFFQSwyQ0FDQSxpQ0FDQSx5Q0FDQSw0Q0FDQSxvQ0FDQSxvQ0FDQSx1Q0FDQSxtQ0FDQSxxQ0FDQSxzQ0FDQSxxQ0FDQSw0REFDQSx5Q0FDQSxzQ0FDQSw0REFDQSxxQ0FDQSwrQkFDQSxtQ0FDQSw2Q0FDQSwyQ0FDQSxTQUVBLGlCQUNBLG1CQUNBLG1CQUNBLFdBQ0EsNkRBQ0EsMkJBRUEsUUFDQyxlQ3pHRCxDQUNBLHVDQUNBLFFBQ0EsaUJBQ0EscUJBQ0EsbUJBQVksS0FDWixnQkFBVyxLQUNYLGNBQVMsS0FDVCxjQUFTLEtBQ1QsbUJBR0EsYUFFQSwyQkFDQSxlQUNBLGFBQ0EsUUFLQSxLQUpBLEtBQ0EsRUFDQSxXQUdBLEtBQ0EsOEJBRUEsZ0RBR0EsTUFDQSw0Q0FDTyxLQUNQLHFCQUVBLHNDQUlBLFNBQ0EsV0FBaUIsU0FBaUIsT0FDbEMsbUNBR0EscURBQ0EsZUFDQSxhQUNBLDRDQUNBLFVBQW1CLE9BQWUsT0FDbEMsbUVBRUEsUUFFQSxFQUVBLHVDQUNBLGVBQ0EsVUFDQSxxREFDQSxlQUNBLFVBQ0EsNENBQ0EsZ0VBQ0EsUUFDQSxFQUNDLHNCQ2xFRCx3REFFQSxnQkFPQSxTQUFDLGlEQUNELHdCQUVBLHVDQU1BLHFCQUNBLDRDQUdBLDhDQUNBLEdBQ0EsU0FDQSxhQUlBLHVFQUdBLDRCQUdBLFlBQ0EsT0FJQSxzQkF6QkEsZ0NBNEJBLDhCQUdBLG9FQUNBLCtCQUNBLDBDQUNBLENBQ0EsZ0JBQ0Esa0JBR0EsUUFHQSx3Q0FDQSwyQkFDQSxnQ0FBbUMsZUFBMEIsVUFDN0QsNkJBQXlDLE9BQWUsT0FDeEQsMENBQ0EsUUFDQSxNQUdBLGlEQUE4RCxvREFBK0QsU0FHN0gsd0JBR0EsNkNBQ0EsRUFFQSxFQUVBLDZDQUVBLENBRUEsR0FDQSwyQ0FDQSxnRUFFQSw2QkFDQSxRQUNBLE1BQVMsaUJBQ1QsaUJBQVUsaUJBQ1Ysb0JBQWEsY0FDYix1QkFBZ0IsaUJBQ2hCLHVCQUFnQixjQUdoQiw2Q0FFQSxzQ0FHQSxJQUVBLG1CQUVBLGVBRUEsa0lBRUEsbUJBRUEsZUFFQSxpa0JBRUEsR0FBQyxjQ2pIRCxDQXVNQSx3QkFDQSxPQUVBLFNBREEsV0FHQSxTQUNBLHNCQUlBLGlCQUdBLFVBbE5BLEdBQ0EsMkNBS0EsZ0VBQ0Esa0NBQ0EsUUFDQSxRQUFZLGNBQ1osV0FBYSxjQUNiLFNBQVcsY0FDWCxVQUFZLGNBQ1osV0FBYSxjQUNiLFFBQVUsY0FDVixTQUFXLHNDQUNYLG9CQUFjLGdCQUNkLGFBQVkscUJBQ1osaUJBQWMsb0JBQ2QsZ0JBQ0EsbUJBQ0EsaUJBQVUsS0FNVixRQUtBLDJCQUNBLGVBQ0EseURBQWdFLGtGQUNoRSxzRkFFQSwyQkFDQSxpREFDQSwwQ0FDQSx1QkFDQSxJQUVBLHNCQUNBLHlCQWdCQSxtQkFDQSxzQkFDQSxvQkFDQSxnQkFDQSxtQkFsQkEsVUFDQSxnQkFFQSxtQ0FDQSwyREFBeUQsSUFBUyxpQkFLbEUsNEJBQ0EsWUFHQSxNQU9BLDJCQUNBLHdCQW1CQSxXQUNBLGNBQ0EsQ0FFQSx1QkFDQSxXQUNBLGNBQ0EsQ0FHQSxlQTVCQSwyQ0FDQSxzQ0FDQSw4QkFFQSxTQWFBLGNBWUEsc0JBQ0EsNkJBQ0EseUJBQ0EsZ0NBR0Esd0JBQ0Esb0JBRUEsZ0JBQ0EsMkJBQ0EsNEJBQ0EscUJBRUEscUJBQ0Esd0JBQ0EsMEJBQ0EsbUJBRUEsc0JBQ0EscUJBR0EscUJBQ0EsaUJBQ0EsZ0JBQ0Esc0JBQ0Esb0JBQ0Esd0JBRUEscUJBQ0Esa0JBQ0EsbUJBQ0EsZ0JBRUEsaUJBQ0EsbUJBQ0Esb0JBQ0EsaUJBRUEsa0JBQ0Esc0JBQ0Esd0JBQ0EscUJBRUEsd0JBQ0EscUJBQ0EsbUJBQ0Esa0JBRUEsc0NBQ0EsMkNBQ0EsZUFNQSwwQkFDQSxlQUVBLHVDQUNBLGtDQUNBLHVDQUNBLHlDQUNBLHdDQUVBLHNDQUNBLGdCQUNBLFdBRUEsdUhBQ0EsYUFFQSxnQkFNQSxtQkFBdUIsQ0FXdkIsa0JBQXNCLENBTXRCLGlCQUFxQixDQUNwQixzQkNyTUQsd0RBRUEsZ0JBT0EsU0FBQyxpREFDRCx3QkFFQSx1Q0FNQSxxQkFDQSw0Q0FHQSw4Q0FDQSxHQUNBLFNBQ0EsYUFJQSx1RUFHQSw0QkFHQSxZQUNBLE9BSUEsc0JBekJBLGdDQTRCQSw4QkFHQSxvRUFDQSwrQkFDQSwwQ0FDQSxDQUNBLGdCQUNBLGtCQUdBLFFBR0Esd0NBQ0EsMkJBQ0EsZ0NBQW1DLGVBQTBCLFVBQzdELDZCQUF5QyxPQUFlLE9BQ3hELDBDQUNBLFFBQ0EsTUFHQSxpREFBOEQsb0RBQStELFNBRzdILHdCQUdBLDZDQUNBLEVBRUEsRUFFQSxrQkFLQSxhQXdCQSxnQ0FDQSx3Q0FDQSxpREFDQSxtREFDQSw2Q0FDQSxRQUNBLElBOENBLDJCQUNBLGVBQ0EsMkJBQ0EsSUFDQSxTQUFlLGNBQXNCLE9BQ3JDLDRCQUVBLFVBQ0EsRUFvQkEsNkJBQ0EsSUFDQSxrQ0FDQSw2QkFDQSxNQUNBLGFBRUEsZ0NBQ0EsTUFFQSxzQkFDQSxJQUNBLDhDQUNHLFVBQ0gsc0NBRUEsSUFDQSxHQUlBLENBRUEsNkJBQ0Esb0JBQ0Esb0NBRUEsMkJBQ0EsNkJBRUEsNENBQ0Esa0NBQ0EsTUF2SUEsb0JBUUEsR0FPQSxlQUVBLE9BUkEsb0NBQ0Esd0JBQ0EseUdBRUEsc0NBQ0EsMkJBSUEscUNBQ0Esd0JBQ0Esb0VBQ0EscUNBQ0EsbUJBUUEscURBT0EsZUFJQSxZQVRBLHlCQUNBLGVBQ0EsZ0JBRUEsTUFxQ0EsK0JBL0JBLDBCQUNBLG1CQUdBLFVBRkEsV0FDQSxFQUdBLGtDQUNBLEtBQWEsa0JBQTBCLE9BQ3ZDLG9DQUNBLGdCQUVBLHlEQUNBLHVEQUVBLHFGQUdBLHlEQU1BLDZCQUNBLHlEQUNBLDhFQUlBLG9CQUNBLGlCQVlBLGdDQUVBLG1GQUNBLCtCQWNBLGdDQWJBLDhDQUNBLElBQ0EsR0FDQSw0QkFDQSxzQkFBYSxXQUFtQixPQUNoQywwR0FDQSxnQkFDQSxtQkFFQSwwQ0FDQSxJQUVBLEdBeUJBLG1CQVdBLDJCQVNBLGVBRUEsVUFUQSw0QkFDQSxJQUNBLG1CQUNBLElBQWEsUUFBZ0IsT0FDN0IsZ0JBRUEsR0FLQSwrQ0FFQSxhQUdBLHFGQUFvRyxjQUFtQixJQUFFLGVBQW1CLHdHQUE4SCxNQUUxUSxvQkFDQSxnQ0FDQSwyQkFDQSxvQ0FHQSxnQkFDQSxjQUNBLHNCQUNBLFlBQ0EsdUNBQXlDLENBR3pDLGVBRUEsK0JBRUEseUNBQ0EsMkJBQ0EsYUFFQSw4QkFDQSxxQkFDQSxXQUVBLEtBRUEsMkJBQ0Esb0JBQ0EsYUFDQSx1Q0FDQSxpQ0FDQSxRQUdBLHlCQUNBLHFEQUNBLHlCQUNBLHFCQUNBLGdDQUlBLDhDQUVBLHdCQUNBLGdCQUNBLHFCQUdBLG1EQUNBLElBRUEsc0NBRUEsWUFBaUIsd0JBQWdDLE9BQ2pELCtDQUVBLE1BQ0EsRUFLQSxnREFFQSxJQUNBLEdBSUEscURBR0Esa0RBR0EsY0FDQSxzQkFFQSx3REFFQSw0Q0FDQSxJQUFlLGdCQUF3QixPQUN2QywrQkFDQSwyQ0FLQSxVQUFlLHVCQUErQixXQUM5QyxJQUVBLDhGQUNBLFFBR0Esc0ZBQ0EsYUFJQSwrQkFDQSxlQUdBLGlCQUNBLHFEQUNBLHdCQUtBLCtDQUdBLCtCQUNBLG9DQUNBLHFCQXhHQSxtQkF5R0EsWUFLQSwyREFHQSxlQUVBLHdCQUtBLDBGQUNBLHdCQUVBLHlDQUNBLE1BQ0EsUUFFQSxxQ0FDQSxTQUNBLFFBR0Esc0JBRUEsS0FFQSx5Q0FDQSx5QkFDQSxVQUVBLDZDQUNBLGlFQUNBLEVBS0Esa0VBQ0EsV0FBbUIsZ0JBQXdCLE9BQzNDLCtCQUNBLHdDQUdBLFNBQ0EsUUFNQSxnREFDQSxzQ0FpQkEsWUFFQSxzREFDQSxnQ0FDQSxPQUNBLEVBQ0EsdUJBckJBLFFBRUEsS0FIQSxvRUFNQSxZQUVBLFVBR0EsbUVBQ0EsNkJBR0EsWUFZQSwyQkFFQSxpQkFFQSxxRUFDQSxJQUNBLE9BRUEsV0FHQSxTQUNBLGlDQUNBLHFJQUtBLFlBQ0EsVUFJQSxvREFDQSxJQUNBLENBRUEsZUFTQSxTQUNBLGdDQUNBLFFBQ0EsU0FDQSw4QkFFQSxJQUNBLE1BQ0EsRUFDQSxXQUdBLDRCQUNBLGFBS0EsV0FDQSw2QkFJQSxnQkFDQSw4QkFDQSxPQUFpQixlQUF1QixPQUN4Qyx3Q0FDQSwyQkFFQSxhQUNBLEtBR0EsR0FFQSxnQ0FDQSxlQUlBLEtBSEEsNkJBSUEsOENBQ0EsMENBR0EsV0FDQSx5Q0FFQSx5SUFFQSxzQkFDQSxrQkFHQSx5QkFFQSxpREFDQSxLQUVBLDBCQUNBLGVBQ0EsS0FJQSwrQkFDQSxFQUNBLDREQUVBLHFCQUNBLGlEQUlBLFdBQ0EsZUFLQSx3Q0FFQSxJQUNBLG9CQUNBLEdBQ0EsYUFDQSxjQUVBLE1BRUEsWUFHQSxvQkFDQSx1Q0FHQSw2QkFHQSx1Q0FDQSxJQUNBLDZCQUNBLEtBQU8sU0FDUCx5SUFDQSxLQUVBLG1JQUlBLGtFQUNBLDBCQUVBLE9BRUEsK0JBRUEsdUNBQ0EsVUFDQSx3QkFDQSxjQUFPLFNBQ1AsbUJBQ0EseUlBQ0EsS0FFQSw0SkFLQSw2Q0FDQSxlQUtBLCtCQUpBLG1CQU1BLDhDQUVBLCtEQUdBLG1DQUNBLE1BR0EscUJBR0Esa0NBQ0Esc0NBRUEsV0FFQSwwQkFDQSx5QkFDQSxLQU9BLElBQ0EsdUNBQ0EsUUFBVyxNQUVYLFVBRUEsZ0NBQ0EscUNBQ0EsdUJBQ0EsOENBR0EsNEJBRUEsV0FDQSxlQUVBLDBCQUNBLHlCQUNBLDZDQUNBLEtBS0Esd0NBQ0EsYUFDQSxHQUNBLE1BRUEsd0JBRUEsU0FDQSw2QkFDQSxLQUFLLFNBQ0wseUlBQ0EsS0FFQSxDQUNBLDhCQUVBLDRCQUVBLEdBRUEsMEJBQ0EseUJBQ0EsS0FDQyxJQUVELGVBQ0Esc0JBQ0EscUNBQ0EsMkJBR0EsT0FFQSwrQ0FLQSx5Q0FFQSxXQUNBLHNCQUNBLHlCQUlBLGFBQ0Esb0NBQ0EsUUFDQSxPQUFZLFNBQ1osT0FBVSx1QkFDVixXQUFTLE1BQ1QsY0FBVSxNQUNWLGVBQVcsU0FDWCxZQUFlLE1BQ2Ysd0JBQW9CLENBR3BCLGlDQUVBLHFDQUNBLGlEQUVBLHVCQUNBLHFCQUNBLHlCQUVBLHlDQUNBLHVFQUVBLDREQUdBLGlCQUFtQixjQUFvQixLQUN2Qyx1REFFQSxHQUVBLDBCQUNBLGlEQUNBLFFBQ0EsZUFNQSwrQkFDQSxnQkFFQSxvQkFFQSxlQUNBLGFBQ0EsR0FJQSxRQUNBLHdDQUNBLEdBQU8sU0FDUCxrSUFDQSxLQUVBLG1CQUNBLFlBQXFCLGNBQWlCLE9BQ3RDLGNBRUEsMkRBSUEsb0VBQ0EsaUJBQXNCLGlCQUF5QixPQUMvQyx3REFHQSxVQUNBLHlDQUVBLEVBQ0EsQ0FLQSx1REFDQSxXQUVBLGVBQ0EsYUFDQSxhQUlBLG9EQUVBLFdBTEEsV0FPQSw4RUFDQSxrQkFDQSwrQkFDSyxjQUVMLDhDQUVBLHVEQUNBLHNFQUNBLDhDQUNBLEVBQU8sS0FDUCx3Q0FDQSw2REFDQSxLQUNBLDZCQUNBLFFBRUEsUUFJQSxlQUNBLDJCQUNBLHFDQUNBLEVBQU8sWUFFUCwwQ0FFQSxHQU1BLGlDQUNBLGdCQUVBLG9CQUNBLGVBQ0EsYUFDQSxHQUVBLEtBRUEsWUFDQSx3Q0FDQSxHQUFPLFNBQ1AsbUJBQ0EsOEhBQ0EsS0FHQSxtQkFDQSxZQUFxQixjQUFpQixPQUN0QyxjQUNBLG9EQUNBLDJCQUlBLGtFQUNBLGtCQUF1QixrQkFBMEIsT0FDakQsZ0NBQ0EsZ0VBQ0EsMENBQ0Esc0RBQ0EsaUVBQ0EsMEJBR0EsYUFDQSxnREFFQSxFQUNBLENBS0EscUVBQ0EsWUFFQSxlQUNBLGFBQ0EsYUFHQSxzQ0FDQSxvREFHQSxXQUxBLG1EQU1BLGlFQUVBLDRDQUNBLCtDQUNBLHFDQUNBLFFBQ0Esa0JBQ0EsUUFFQSw4QkFDQSwwRUFDQSxzREFDQSwwQkFDQSxrQkFDQSxrREFDQSwyQ0FFQSxnQ0FDQSxTQUFLLE1BRUwsc0VBRUEsa0VBQ0EsOENBRUEsOERBRUEseUNBR0EsaUJBSUEsZUFDQSwyQkFDQSw2Q0FDQSxFQUFPLFlBRVAsaURBRUEsR0FLQSw0REFDQSxlQUVBLGtFQUNBLDBEQUdBLE9BQ0EsbURBQ0EsOENBQ0EsU0FHQSw2Q0FDQSxpREFDQSxpQkFDQSw4Q0FJQSxnREFDQSxRQUNBLEtBUUEsMkJBQ0EsY0FFQSwyQ0FDQSxlQUNBLGFBRUEsbUJBQ0EsWUFBcUIsZ0JBQXdCLE9BQzdDLE9BR0EsbUlBQ0Esc0RBQ0EsMERBQ0Esa0RBR0EsVUFDQSxTQUNBLENBT0EsZ0RBQ0EsdURBQ0EsVUFLQSx3Q0FDQSxXQUNBLG1CQUVBLDRCQUVBLG9CQUtBLElBQ0EscUNBQ0EsUUFDQSxNQUdBLFVBRUEsZ0NBQ0EsZUFDQSxzQkFDQSxtQkFHQSwwQ0FDQSwyQkFDQSx1QkFFQSxnSkFDQSx3RUFFQSwrQ0FDQSxLQUVBLDBCQUNBLE1BQ0EsZUFLQSwyQ0FDQSxzQkFFQSxlQUlBLDhFQUNBLHlCQUdBLG9CQUVBLGlEQUdBLG1DQUtBLHNFQUVBLGlDQUNBLE1BQ0EsQ0FFQSx3Q0FDQSxNQUNBLGVBRUEsMkNBQ0EsZ0VBQ0EsU0FFQSxrQ0FDQSxpQkFDQSxFQUVBLHdDQUNBLGtDQUNBLDJCQUVBLDRDQUdBLHlGQUNBLCtDQUNBLE9BQXFCLG9DQUE4QixPQUNuRCxpREFDQSx1RUFDQSw4REFFQSxXQUNBLE1BRUEsMkJBQ0EsZ0RBQ0EsUUFHQSxHQUVBLG1CQWFBLGFBQ0EseUJBQ0EsVUFFQSwrQ0FDQSxJQUNBLE1BQ0EsS0FDQSxLQUNBLEtBQ0EsSUFDQSxFQUVBLGlEQUdBLGVBQ0EsRUFDQSxZQUdBLFNBQ0EsUUFJQSxpQkFDQSxJQUNBLGtDQUlBLFlBQWUsU0FBaUIsT0FDaEMsY0FHQSxrQkFJQSx1Q0FDQSxZQUNBLGtGQUNBLDZGQUNBLGtCQUdBLGFBQ0EsS0FDQSxDQUVBLEdBRUEsbUJBRUEsYUFpQkEsOEJBQ0Esb0JBQ0Esc0JBQ0Esc0JBQ0EsZUFDQSxVQUNBLENBRUEsQ0F0QkEsa0RBWUEseUJBVkEsdUJBQ0EsSUFDQSxXQUdBLGlCQUFhLFFBQWdCLE9BQzdCLDBCQUVBLFFBQ0EsY0FhQSxHQUFDLGNDenJDRCxjQUNBLGlCQUVBLGVBV0EsQ0FWQSxFQUNBLEdBQ0EsSUFFQSxnQkFRQSxDQVBBLFFBQ0EsS0FDQSxPQUVBLGdCQUdjLE1BQU8sb0NBQ3JCLDhCQUNBLG1CQUNBLDZDQUNBLGdEQUNBLEtBRUEsR0FDQSxTQWNBLElBQ0EsMENBQ0EsZUFFQSwyQkFDQSxpQkFBcUIsUUFDckIsb0JBQW1CLFFBQ25CLHNCQUFxQixRQUdyQixzQkFDQSxhQUNBLGdEQUNBLCtDQUVBLDBCQUNBLDBCQUdBLGFBQ0EscURBQ0EsS0FDQSwyQ0FDQSwyREFHQSwyQkFHQSx1REFDQSxJQUVBLGlCQUNBLGFBQ0EsMkNBQ0Esc0RBQ0EsYUFFQSxrQkFDQSxhQUNBLDhDQUNBLHlEQUNBLGFBR0EsMkJBQ0EsYUFHQSxHQUZBLHVDQUdBLDhCQUNBLGVBQ0EsbUNBQ0Esb0NBQ0Esc0RBQ0EsVUFHQSx5QkFDQSxhQUNBLFFBQ0EsNENBQ0Esb0RBQ0EsZ0NBQ0EsR0FHQSxpQkFDQSxhQUdBLEdBRkEsNkJBS0EsbUVBQ0EsK0JBQ0EsZ0JBQ0EsdUNBQ0Esb0NBQ0Esd0RBS0EsaUVBQ0EseUNBQ0EsaURBQ0EsNkJBRUEsSUFLQSx3QkFDQSxlQUNBLG1EQUNBLEdBS0EseUJBQ0EsSUFDQSxPQUNBLGdCQUNBLEVBQ0EsVUFDQSw0QkFDQSw4Q0FDQSxJQUFlLFdBQW1CLFdBQ2xDLDJCQUNBLFVBQStCLGlDQUUvQiwrQkFDQSxVQUNBLGdEQUNBLDZCQUNBLGdDQUlBLHFDQUNBLCtCQUVBLEVBQ0EsQ0FLQSxxQkFDQSxlQUVBLEtBREEsTUFFQSw2Q0FDQSxzQ0FDQSxJQUFvQiwwQkFDcEIsMkJBQ0EsTUFDQyxJQUVELGdEQUNBLGdDQUVBLDJCQUNBLGlCQUFxQixLQUNyQixnQkFBVyxLQUNYLG1CQUdBLDRCQUNBLGFBS0EsYUFFQSxLQU5BLFNBQ0EsS0FDQSxvQkFDQSxtREFJQSwrQ0FHQSxrRkFFQSxZQUNBLHdCQUEyQixLQUMzQiw2Q0FDQSwwQ0FFQSxpQkFFQSxtREFDQSxDQUNBLDJDQUNBLGlCQUVBLHNCQUdBLGdCQUNBLG1CQUNBLFVBQ0EscUJBR0EsbUNBQ0EsUUFFQSw0Q0FDQSxJQUNBLE1BQ0EsdUJBQ0EsaUVBQ0EsMENBQ0EscUJBQ0Esd0JBRUEsNENBQ0EsQ0FDQSxtQkFDQSxVQUNBLHFCQUNBLHdCQUNBLEdBRUEseUJBQ0EsSUFDQSxRQUNBLHlDQUNBLCtCQUNBLDRCQUNBLGtCQUNBLHlCQUNBLDRCQUNBLDZCQUNBLDBCQUNBLDRCQUNBLFVBQ0EsMENBRUEscUJBRUEsd0JBQ0Esb0JBQ0EsNkJBQ0EsZ0NBQ0EsUUFDQSxNQUNDLGtEQzFRRCxnQ0FFQSwyREFFQSxtQkFLZSxRQUFmLFVBRUEsNEJBQ0EsUUFFQSxtREFFQSxpREEyQkEseURDOEJBLDRCQUNBLGtEQUNBLE1BQ0EsbUNBQ0EsWUFDQSxhQUNBLCtDQUNBLGFBQ0EsSUFsRkEsUUFDQSxxQkFDQSx3QkFDQSxnQkFDQSx5QkFDQSxzQkFDQSxlQUNBLDRCQUNBLHVCQUNBLHVCQUNBLHNCQUNBLDRCQUNBLDJCQUNBLHVCQUNBLDBCQUNBLHNCQUNBLG9CQUNBLHVCQUNBLG1CQUNBLHdCQUNBLGVBQ0EsdUJBQ0Esd0JBQ0EsdUJBQ0Esa0JBQ0EscUJBQ0EsK0JBQ0Esc0JBQ0EscUJBQ0Esc0JBQ0Esb0JBQ0Esd0JBQ0EsaUNBQ0Esd0NBQ0EsK0JBQ0EsZ0NBQ0EsMEJBQ0EseUJBQ0EsZ0JBQ0EsaUJBQ0EscUJBQ0EsMkJBQ0EsbUJBQ0EsMEJBQ0EsMkJBQ0Esc0JBQ0EsdUJBQ0Esa0NBQ0Esa0JBQ0Esd0JBQ0EsOEJBQ0EsZ0JBQ0Esd0JBQ0Esd0JBQ0Esd0JBQ0EsdUJBQ0Esb0JBQ0Esc0JBQ0EsMEJBQ0EsNkJBQ0Esc0JBQ0Esd0JBQ0EsMEJBQ0EsNkJBQ0EsaUJBQ0EsdUJBQ0EsbUJBQ0EsZ0NBQ0EsaUNBQ0Esd0JBQ0EsK0JBQ0EsdUJBQ0EsZ0JBQ0EsS0FVQSxpREFDQSxvQkFDQSxNQUNBLDZDQUNBLDhCQUNBLGtCLGlEQ3JGQSw0QkFDQSxrREFDQSxNQUNBLG1DQUNBLFlBQ0EsYUFDQSwrQ0FDQSxhQUNBLElBWEEsUUFDQSxjQUNBLEtBVUEsaURBQ0Esb0JBQ0EsTUFDQSw2Q0FDQSw4QkFDQSxrQiw4SUNqQkEsQ0FvREEsc0JBQ0EsNkNBQ0EsZUFFQSwyQ0FDQSxnQkFHQSxnQkFFQSxNQUNBLDhCQUlBLENBQ0Esb0JBQ0EseUNBRUEsMEJBQ0EseUNBRUEsMEJBQ0EsMENBR0EsaURBRUEsNENBQ0EsdUJBQ0EsYUFDQSxNQUFvQixlQUF1QixPQUMzQyx5QkFFQSxpREFDQSxrQkFDQSxvR0FDQSxNQUNBLEVBQ0EsbUJBQ0EsYUFDQSxNQUFvQixlQUF1QixPQUMzQyx5QkFFQSxpREFDQSxrQkFDQSwwRkFDQSxNQUNBLENBR0EsQ0FDQSx5QkFDQSxJQUNBLDJCQUdBLGtDQUNBLGlCQUNBLDRCQUNBLElBQ0EsU0FFQSxPQUNBLElBRUEsQ0F1QkEsQ0FDQSxzQkFHQSx1RUFDQSxvQkFJQSxtQkFDQSxRQUlBLENBQ0Esa0NBQ0EsQ0FDQSxnQkFFQSxRQXNCQSxDQXFCQSwwQkFDQSxzQ0FDQSxlQW1CQSxDQWdLQSxvREFDQSw2QkFDQSxXQUNBLG9DQUNBLDBCQUNBLFdBRUEsMERBQ0EsTUFHQSwyREFFQSxVQUNBLHVCQUNBLHdEQUdBLHVCQUNBLGtCQWdCQSxDQUNBLDBCQUNBLGlEQUNBLElBQ0EsQ0FDQSxzQ0FDQSx1QkFDQSxtQkFDQSw4QkFDQSxlQUNBLHNEQUNBLFVBQ0EsVUFDQSxpQkFFQSxLQUVBLEVBQ0Esb0JBQ0EsUUFDQSxtQ0FBa0MsZ0JBQW1CLEVBQ3JELEdBQ0EsR0FDQSx3QkFDQSxlQUNBLDhDQUNBLGlCQUdBLE1BQ0EscUJBQ0EsdURBQ0EsdUNBQ0EsZ0RBQ0EsS0FHQSxTQUNBLFNBQ0EseUJBQ0Esa0NBQ0Esc0RBQ0EsaUJBQ0EsOENBQ0EsdUJBR0EsWUFDQSxPQXVCQSxDQUNBLGtFQUNBLGtCQUNBLHFGQUNBLHlDQUNBLFlBQ0Esa0RBQ0EsWUFFQSxJQVFBLENBQ0EsdUVBQ0EsZ0JBQ0Esd0ZBQ0EscURBQ0EsWUFDQSxrREFDQSxZQUVBLElBUUEsQ0FDQSx1RkFDQSw2Q0FDQSwrSEFDQSx5QkFDQSw2REFDQSxZQUVBLElBSUEsQ0FDQSwrRkFDQSw0Q0FDQSxvSEFDQSxzQkFDQSxvRUFFQSxLQUlBLENBQ0EsNkRBQ0EsOERBQ0EsU0FJQSxDQUNBLHFFQUNBLENBQ0EsOERBRUEsU0FJQSxDQUNBLGlFQUNBLHFEQUNBLFNBSUEsQ0FDQSx5RUFDQSxDQUNBLGtFQUVBLFVBQ0EsMEZBQ0EseUJBQ0EsOEdBQ0EsNERBRUEsc0JBQW1CLGFBQXFCLFNBQ3hDLHlCQUNBLDBHQUNBLHFFQUNBLHdDQUdBLE1BQ0Esa0dBQ0EsQ0FDQSwwRkFFQSxVQUdBLENBQ0Esc0ZBQ0EsNkJBQ0EsbUJBQTJDLDJCQUF3QixZQUNuRSxtQkFDQSxVQUNBLE1BRUEsaURBQ0EsS0FDQSx3Q0FDQSwrSEFDQSxtRkFDQSxPQUlBLENBQ0EsOEZBQ0EsQ0FDQSxvRkFFQSxTQUNBLENBQ0Esd0RBQ0EsSUFDQSxtQkFDQSw4QkFFQSxPQUNBLGtEQUdBLHlCQUVBLFlBQ0Esa0NBQ0EsNEdBQ0EsNENBQ0EsYUFDQSxDQUlBLENBQ0EsNkJBQ0EsT0FDQSx3QkFDQSxxREFDQSxXQUNBLG9DQUNBLENBQ0EsZ0NBQ0EsSUFDQSxxQkFFQSxlQUNBLG1CQUVBLFVBQ0EsNkJBQ0EsK0NBRUEsc0JBRUEsa0NBQ0EsaUNBRUEsZ0NBQ0Esb0JBQ0EsYUFHQSx1REFDQSxhQUNBLCtDQUdBLFVBR0EsV0FDQSxPQUNBLHlCQUdBLCtDQUVBLE9BQ0EsQ0FDQSxzQ0FDQSxzQkFDQSxtQkFDQSx5RUFDQSx3QkFDQSxnQ0FFQSxFQUNBLE9BQ0EsS0FDQSxDQUNBLHdEQUNBLElBQ0EsbUlBQ0EsSUFFQSxrQ0FJQSxDQUNBLDhEQUNBLDhCQUNBLElBQ0Esd0lBQ0EsT0FDQSx1Q0FFQSxNQUNBLEVBSUEsQ0FDQSwrREFDQSxrQ0FDQSx3SEFDQSwrQ0FDQSxhQUNBLENBQ0EscUJBQ0EsT0FFQSxLQURBLElBRUEsUUFDQSxRQUNBLFNBQ0EsUUFFQSxZQUVBLElBR0EsQ0FDQSw4QkFDQSxnQ0FDQSxJQWtCQSxDQWVBLHdDQUNBLGFBQ0EsT0FDQSxPQUNBLE1BQ0EsRUFDQSxDQUNBLENBQ0EsMkJBQ0EscUJBQ0EscUNBS0EsZUFFQSxLQUNBLENBQ0EsZ0NBQ0Esd0JBQ0EsT0FFQSxtQkFBbUIsU0FBaUIsT0FDcEMsOEJBQ0EsSUFHQSxTQUNBLFFBSUEsQ0FDQSw4QkFFQSxVQUNBLElBaUJBLENBQ0Esb0NBQ0EsSUFDQSwyRUFFQSxxREFDQSxDQUNBLGdDQUNBLG1DQUNBLDREQUVBLDBEQVFBLENBMnpDQSxzQ0FDQSxhQUNBLE9BRUEsT0FDQSxNQUVBLFNBQ0EsTUFJQSxRQUNBLHNCQUdBLEVBR0EsQ0FJQSxDQUNBLGtDQUdBLGVBRUEsMEJBSUEsMkJBRUEsS0FDQSxDQWliQSxpQ0FDQSxzQkFDQSxjQUlBLENBQ0EsNkJBQ0Esa0JBQ0EsZUFDQSx5QkFDQSxnQkFpQkEsQ0ErMENBLHVDQUNBLHdCQUNBLGdDQUlBLFFBRUEsRUFpQkEsQ0F3REEsK0JBQ0EsT0FDQSxhQUNBLFFBQ0EsMENBQ0EsdUJBQ0EscUJBQ0EsK0JBQ0EsZ0NBQ0Esc0JBR0EseUJBRUEsK0JBQ0EsOEJBQ0EsdUJBQ0EsNEJBQ0EsK0JBSUEsaUNBQ0EscUJBQ0EsMEJBQ0EsMkJBR0Esd0NBRUEsS0FNQSxDQUNBLHFDQUVBLGtCQUNBLGNBR0EseUNBQ0EsS0FPQSxDQUNBLGlDQUNBLElBR0EsMkJBQ0EsZ0NBRUEsY0FDQSxnQkFDQSxRQUNBLGtCQUNBLGVBQ0EseUJBQ0EsYUFDQSx1QkFDQSx1QkFDQSxpQ0FDQSx3QkFDQSxrQ0FDQSxjQUNBLHdCQUNBLGlCQUNBLDJCQUNBLHFCQUNBLCtCQUNBLHNCQUNBLGdDQUNBLGVBQ0EseUJBQ0Esb0JBQ0EsOEJBQ0EsdUJBQ0EsaUNBQ0EseUJBQ0EsbUNBQ0EsYUFDQSx1QkFDQSxrQkFDQSw0QkFDQSxtQkFDQSw2QkFDQSxlQUVBLHVDQUVBLEtBSUEsQ0FDQSxpQ0FDQSxJQUNBLDZCQUVBLFNBQ0EsYUFDQSxXQUNBLGVBQ0Esa0JBQ0Esc0JBQ0EsZ0JBQ0Esb0JBQ0EsMEJBQ0EsOEJBQ0EsMkJBQ0EsK0JBQ0EsaUJBQ0EscUJBQ0Esb0JBQ0Esd0JBQ0Esd0JBQ0EsNEJBQ0EseUJBQ0EsNkJBQ0Esa0JBQ0Esc0JBQ0EsdUJBQ0EsMkJBQ0EsMEJBQ0EsOEJBQ0EsNEJBQ0EsZ0NBQ0EsZ0JBQ0Esb0JBQ0EscUJBQ0EseUJBQ0Esc0JBQ0EsMEJBQ0Esa0JBRUEsdUNBRUEsS0FPQSxDQUNBLHNDQU9BLE9BRUEsT0FEQSxZQUVBLEdBQ0Esa0JBSUEsaUJBQ0Esa0JBQ0EsZ0JBQ0Esa0JBQ0Esa0JBQ0Esa0JBQ0EsVUFDQSxrQkFHQSxRQUNBLGtCQUNBLGFBQ0Esa0JBQ0EsbUJBQ0Esa0JBQ0EsVUFDQSxrQkFJQSxRQUNBLGtCQUNBLGNBQ0Esa0JBQ0EsWUFDQSxrQkFFQSwrQkFDQSxnQkFDQSxnQkFDQSxnQkFDQSxpQ0FDQSxnQkFDQSxjQUVBLE9Bd0JBLENBa0pBLDJCQUNBLE9BQ0EseUJBQ0EsQ0FDQSxzQkFDQSxPQUNBLG1CQUNBLENBQ0EsNkJBQ0EsT0FDQSwyQkFDQSxDQUNBLHlCQUNBLE9BQ0EsdUJBQ0EsQ0FDQSxzQkFDQSxPQUNBLG9CQXVCQSxDQSs1QkEsNEJBQ0Esa0NBQ0EsWUFDQSw2QkFDQSxrQ0FDQSxXQWlCQSxDQWtCQSx5Q0FDQSw4Q0FDQSxlQUNBLDBCQUVBLE9BQ0EsdUJBRUEsTUFDQSx3QkFHQSwyQkFFQSxNQU9BLENBdWtDQSw2QkFDQSxpQ0FDQSxJQU9BLENBa3JDQSxxQkFDQSxnQkFDQSxLQUFtQixTQUFpQixPQUNwQyxJQUNBLHlDQUVBLDBDQUVBLCtCQUNBLE9BQ0EsQ0FDQSx5Q0FDQSxnQkFDQSx5QkFDQSxTQUFtQixNQUFZLE9BQy9CLHFCQUNBLFdBRUEsT0FEQSxhQUdBLGVBQ0Esc0JBR0EsY0FHQSxRQUNBLE9BQ0EsQ0FDQSxnQ0FDQSwwQkFDQSxvQkFNQSxDQUNBLHVCQUdBLGlCQUNBLDJDQUNBLE1BQ0EsbUhBQ0EsOEJBSUEsNEJBRUEsa0JBQ0EsU0FBdUIsWUFBZ0IsUUFHdkMsNkJBQ0EsZUFDQSxXQVBBLGlEQVNBLDhCQUNBLFVBQ0EsVUFDQSw0REFDQSxpQkFDQSxHQUdBLGtDQUdBLDhCQUNBLHFCQUNBLDhCQUVBLGtCQUNBLFNBQ0EsVUFDQSxpREFDQSxxQkFDQSxLQUNBLFVBRUEsd0RBQ0EsR0FDQSxNQUNBLHFEQUVBLGdCQUNBLENBQ0EseUJBQ0EsU0FpQkEsQ0E0N0JBLDZCQUNBLHVEQUNBLGtDQUNBLHlCQUNBLGVBQ0EsT0FDQSxpQ0FDQSxxQkFDQSxNQUNBLENBQ0EsRUFpQkEsQ0F3TkEsaUNBQ0EsaUVBQ0EsTUFJQSxDQTZCQSwwQ0FDQSx3QkFDQSx5QkFDQSxzQ0FHQSxDQUNBLGtDQUNBLDJEQUNBLE1BSUEsQ0FDQSxrQ0FDQSxrRUFDQSxPQUNBLHNCQUNBLG9CQUNBLFNBR0EsQ0FDQSw0QkFDQSxJQUNBLGNBQ0EsbUJBRUEscUJBQ0EsMEJBRUEsNEJBQ0EscUJBR0EsMkJBRUEsNkRBQ0EsTUE2QkEsQ0EySUEscUNBQ0Esc0NBQ0EsTUFPQSxDQTRFQSxnQ0FDQSw0Q0FDQSx5QkFFQSw4RUFDQSx5QkFDQSxRQUVBLDRIQUFnSCxDQUNoSCxvREFDQSxNQUlBLENBQ0EseURBQ0EsZ0RBQ0EseUVBQ0Esc0NBQ0EscUVBQ0EseUJBQ0EsUUFFQSxzSEFBOEcsQ0FDOUcsMkRBQ0Esd0RBQ0EsNkJBQ0EsU0FDQSxxQ0FDQSxTQUNBLEVBUUEsQ0FrQ0Esc0NBQ0EsdUNBQ0EsTUFLQSxDQStFQSxzQ0FDQSw2Q0FDQSxNQVVBLENBMktBLDZCQUNBLHNFQUNBLDBCQUVBLHlIQUFzSCxDQUN0SCxnRUFDQSxrQkFHQSw4RkFBMkYsQ0FDM0YsZ0RBQ0EsT0FDQSwyQkFDQSx1Q0FDQSxxQ0FDQSwyQ0FDQSxNQUtBLENBQ0EseUNBQ0EsMENBQ0EsbUJBQ0EsZ0JBQ0Esd0JBQ0EsY0FDQSw2Q0FDQSxTQVFBLENBWUEsNkNBQ0Esb0RBQ0EsU0FDQSxLQUVBLGtCQU9BLENBMkJBLHNDQUNBLDZDQUNBLDBCQUVBLFNBRUEsQ0FrWUEsaURBQ0EsMERBQ0EsMkJBQ0EscUNBQ0EsVUFDQSw2Q0FDQSxhQUFrQixrQkFBb0Msd0NBQ3RELHdDQUNBLDhCQUNBLGNBRUEsd0JBQ0EsTUFDQSxrQkFBMkIsT0FBb0IsWUFDL0MsRUFDQSxDQUNBLDZDQUNBLElBQ0EscUNBQ0EsbUNBQ0EsOEVBQ0EsT0FDQSxlQUVBLHNDQUNBLFlBQ0EsRUFDQSxrQkFBMkIsT0FBYyxNQUN6QyxFQUlBLENBQ0EsOENBQ0EsNkNBQ0EsNkNBQ0EsZ0JBQ0EsZ0NBQ0Esb0JBQ0Esc0NBQStDLE9BQWUsa0NBQzlELE9BQ0Esc0JBQ0EsUUFDQSw4Q0FDQSxzQkFDQSxtRUFDQSxRQUNBLDZCQUNBLGlCQUEwQyxnQkFBZ0IsWUFDMUQsaUJBQ0EsbUVBQ0EsdUNBQ0EsMENBQ0EsSUFDQSw0REFBa0UsT0FBeUIsaUJBQzNGLEdBQ0Esa0NBQ0Esd0JBRUEsNkRBQ0Esc0ZBR0EsWUFFQSxLQUdBLENBQ0EsNEJBQ0EsMERBQ0EsTUFHQSxDQUNBLG9DQUNBLDZEQUNBLE1BR0EsQ0FDQSxpQ0FDQSwwREFDQSxNQWlCQSxDQXdUQSwwQkFDQSxtREFDQSxNQUdBLENBQ0EsK0JBQ0EseURBQ0EsT0FDQSw4QkFDQSxzREFDQSx5RUFDQSwrQkFDQSx5QkFDQSxRQUNBLEdBQ0EsNENBQ0EseURBQStELHFCQUFpRCwyQkFDaEgsRUFHQSxDQUNBLGlDQUNBLDJEQUNBLE1Ba0JBLENBNklBLGlDQUNBLGdCQUNBLGtCQWdCQSxDQUNBLHFDQUNBLCtCQUNBLDZCQUNBLHdDQUNBLGlCQUdBLHVDQUdBLFFBRUEsTUFNQSxDQWl6QkEscUNBQ0Esd0JBQ0EsbUNBQ0EsNEJBR0EsQ0FDQSxnQ0FDQSxrQ0FDQSxNQUdBLENBQ0EsaUNBQ0EsbUNBQ0EsTUFFQSxDQWdKQSx5QkFDQSxxQkFDQSxNQUlBLENBQ0Esd0NBQ0EsZ0RBQ0EsZ0JBQ0Esa0NBQ0EseURBQ0EsdUJBdUJBLENBbXZDQSwwQkFDQSxrQ0FDQSxXQUNBLENBbXpGQSxpQ0FDQSwyQkFDQSxPQUNBLHFCQUNBLE1BQ0Esc0JBQ0EsU0FDQSxzQkFJQSxTQUNBLHNCQUNBLFFBRUEsOEJBRUEsT0FDQSx5QkFDQSxHQWlCQSxDQW9xREEsZ0RBQ0EsbUNBQ0EsV0FDQSxtQkFDQSx1QkFDQSwwQ0FDQSxvREFDQSxNQUNBLFNBQ0EsbUVBQ0EsRUFFQSxPQUNBLGVBTUEsQ0F5a0JBLHFDQUNBLHVCQUNBLGFBQ0Esb0ZBQ0EsNkJBRUEsMkNBQ0EsMEVBQ0EsT0FDQSxTQUNBLDRFQUNBLCtCQUNBLHNEQUNBLENBaUJBLENBNktBLDZDQUNBLEtBQ0Esc0JBRUEsNkNBQ0EsVUFDQSw2RkFDQSxTQUNBLDhCQUNBLE9BQ0EsdURBRUEsa0VBZ0JBLENBQ0EsK0JBQ0EsbURBQ0EsWUFJQSxDQUNBLDRDQUNBLDBCQUNBLFdBRUEsd0JBQ0EsbUJBQXlDLDRCQUF1QixPQUNoRSx5QkFDQSxzQkFDQSxrQ0FHQSxTQUNBLFFBc0JBLENBeUpBLDRCQUNBLFFBQ0EsZ0NBQ0Esd0JBQ0EsNkJBQ0EsT0FDQSw2QkFDQSxTQUNBLFNBQ0EsMERBRUEsYUFFQSxDQTBhQSxtQ0FDQSxPQUNBLHdCQUNBLGdDQUNBLDJCQUNBLDBCQUNBLCtCQUNBLDhCQUNBLDBCQUNBLDBDQUNBLGlCQUNBLG1EQUNBLHVEQUNBLGtDQUNBLFVBRUEsNERBR0EsK0RBRUEsWUFDQSxDQUdBLENBQ0EsK0NBQ0EsbUJBQ0EseUJBRUEsaUJBQ0Esd0VBR0EsNEVBR0EsZ0NBRkEsNERBU0EsQ0FDQSx5REFDQSxJQUNBLHFDQUNBLGFBQ0EsU0FDQSwwQkFDQSx5R0FDQSxRQUNBLENBSUEsQ0FDQSw0QkFDQSxtREFDQSxVQXNCQSxDQXlxQ0EscUNBQ0EsZ0RBQ0Esb0VBQ0EsbUVBQ0EsK0JBQ0EsQ0FnRkEsK0NBQ0EsSUFDQSx1QkFDQSxDQUdBLDZEQUNBLCtFQUNBLDZIQUNBLG1EQUNBLFlBQ0Esa0RBQ0Esc0dBQ0EsdUNBRUEsNEJBQ0EsU0FDQSxvREFDQSxPQUNBLGtCQUVBLDRDQUNBLGlKQUNBLFNBQ0EsU0FDQSwrQ0FDQSwrQ0FDQSxTQUNBLGtEQUNBLGdIQUVBLFdBQ0EsNERBQ0EsNEJBQ0EsNkVBRUEsNkNBQ0EseURBR0Esa0ZBRUEsWUFLQSxDQUNBLHVFQUNBLCtCQUdBLGFBRUEsRUFEQSx5REFFQSw4SEFDQSxtREFDQSxpSEFDQSxvREFDQSxJQUNBLE1BQ0EsWUFDQSxjQUNBLFdBRUEsVUFDQSxFQUlBLDZCQUNBLHdCQUNBLGtDQUF1Qyx5REFBc0UsUUFDN0csdUJBQ0EsOEhBQ0EsZ0JBQ0EsWUFDQSxrQ0FDQSxtREFDQSx3QkFDQSxnRkFFQSwrQkFDQSxtREFDQSxnREFFQSxNQUFvQix1RUFDcEIsU0FFQSxHQUNBLCtCQUNBLE9BQ0EsbUJBQ0EsTUFDQSwwQkFDQSw0QkFDQSxTQUNBLDZCQUNBLFFBRUEsdUNBRUEsS0FNQSxDQThDQSwwQ0FDQSwrREFBc0Usc0JBQTJCLElBQUUsY0FDbkcsb0JBZ0JBLENBQ0Esb0NBQ0Esc0JBQ0EsOENBeGtWQSxvRUEvdlRBLDJDQUE4QyxDQUFjLHdCQUU1RCw0QkFBK0IsOERBQWlGLEVBRWhILHNCQUNBLGdDQUNBLGdDQUNBLDBDQWtCQSx5QkFpQkEsd0NBQ0EsZ0NBQ0EsbUJBQ0EsNEJBQ0EsbUNBQ0Esb0NBQ0EsUUFBQyx1QkFDRCxtQ0FvSUEsMkJBQ0EsQ0FDQSxzREFDQSxpQkFDQSxlQUVBLHFEQUNBLFFBQ0Esd0NBQ0Esd0JBQ0EsZUFFQSxvQ0FDQSxRQUNBLEVBQ0EsZUFJQSxTQTBCQSxJQUVBLGVBRUEsb0JBT0EsMkJBUUEscUNBRUEsOEJBS0EsMkJBUUEsbUNBS0Esb0NBS0EscUNBcUJBLHlDQVFBLDhCQWdCQSx1QkFFQSw2QkFLQSx5QkFRQSx1QkFFQSx3QkFRQSw0Q0FDQSxzQ0FFQSxzQ0FDQSx1QkFDQSxtQkFDQSxtQkFJQSx5Q0FBc0MscURBQXFFLE9BQzNHLEVBQ0EsS0FDQSx5Q0FYQSxRQVlBLGNBQUMsRUEyQkQsd0JBMlhBLGtCQUNBLENBQ0EsK0JBRUEsZUFDQSx3RUFDQSxLQUF1QixFQUFRLEtBQy9CLHdEQUVBLDhEQUNBLFFBQ0EsTUFDQSxFQUNBLE1BQUMsbUJBMkVELDRCQUNBLENBQ0EsMkNBQ0EsWUFDQSw4Q0FDQSw2REFDQSxzREFDQSxRQUNBLDJCQUNBLHFEQUNBLHdCQUNBLGFBQ0EsU0FDQSxnR0FDQSxFQUNBLENBQ0EscUNBQ0EsOERBQ0EsR0FDQSw4Q0FDQSwwRUFLQSx3Q0FDQSw2QkFDQSw0QkFDQSxLQUNBLFFBQ0Esb0JBQ0EsYUFDQSxvQ0FDQSw0REFDQSxHQUNBLGdFQUNBLGNBQ0Esd0NBQ0EseURBQ0EsR0FDQSw2RUFDQSxVQUF1Qix1QkFBK0IsT0FDdEQsNENBRUEsU0FDQSxPQUNBLG9DQUNBLHVDQUNBLEdBQ0Esd0NBQ0EsbUNBQ0EsYUFLQSwyQ0FDQSxxREFDQSxjQUNBLEVBQ0EsSUFTQSwyQ0FxQkEsb0ZBQ0Esc0NBQ0EsbURBQ0EseUNBQ0EsZ0RBQ0EsOENBQ0EscUhBRUEsbURBQ0EsMEhBRUEscUJBQ0Esb0JBQ0EsU0FDQSw0REFJQSxlQUNBLGFBQ0EsSUFDQSxFQUNBLGNBRUEsdUVBSUEsZUFDQSxhQUNBLEtBQ0EsRUFDQSxjQUVBLDREQUNBLG1EQUNBLEtBS0EsK0NBQ0EsNENBQ0EsNENBQ0EsTUFDQSxFQUNBLFFBaUJBLHdCQUNBLHdDQUNBLGlCQUNBLHlCQUNBLFlBQ0Esb0dBRUEsZ0JBQ0EsdUdBR0EsaUJBQ0Esc0dBR0EsWUFDQSx3R0FFQSxRQUNBLGdDQUNBLGtDQUNBLE1BQ0EsbUNBQ0Esa0NBQ0EsVUFDQSw2Q0FDQSx3QkFDQSx1Q0FFQSxRQURBLCtCQUVBLHVDQUNBLHNCQUNBLFdBQ0EseUNBQ0EsMENBQ0EsR0FDQSxnREFDQSw2QkFDQSxtREFFQSxvREFDQSxRQUNBLDZDQUNBLCtEQUNBLFdBQ0EseUNBQ0EsT0FDQSwwQkFDQSxRQUNBLHNCQUNBLFlBQ0EsR0FDQSxFQUNBLFNBaUJBLDJCQVdBLENBT0EsZ0VBTkEsaUJBQ0EsK0JBQ0EseUJBQ0EsY0FDQSxHQUNBLENBR0EsMEJBRUEsaUNBQ0Esd0NBQ0EsZ0JBQ0EsMENBQ0EscUJBQ0EsdUVBQ0EsZUFDQSx3QkFDQSxxQkFDQSxFQUNBLGNBRUEsOERBQ0Esd0JBQ0Esb0NBQ0EsaUNBQ0EsUUFDQSxnREFDQSxpREFDQSxvREFDQSxTQUNBLEVBQ0EsVUFpQkEsc0JBSUEsMEJBQ0Esc0NBQ0EsMkJBQ0EsT0FNQSw0REFDQSxDQUNBLHVCQUVBLGtCQUNBLHdEQUVBLFFBQ0EsdUNBRUEsOEJBQ0EsZ0VBRUEsdUJBQ0EscUJBQ0EsZ0JBQ0EsTUFNQSwyREFDQSw4Q0FDQSx3Q0FDQSxRQUNBLElBQ0EsZ0RBQ0EsZUFDQSxhQUNBLEdBQ0EsRUFDQSxjQUVBLHdEQUNBLE9BQ0EsZ0NBQ0EsMkNBQ0EsbURBQ0EscUNBQ0EsMENBQ0EsZUFDQSxRQUVBLEdBQ0EsMENBR0EsNkRBRUEsMkJBQ0EsU0FFQSxpQ0FDQSx5QkFDQSxNQUNBLHdDQUNBLDZCQUNBLDhCQUNBLHVHQUNBLEtBQ0EsbUNBQ0EsK0JBQ0EsNEZBQ0EsRUFDQSx3Q0FDQSwrQkFDQSwrREFDQSxPQUNBLHVDQUNBLCtCQUNBLHNFQUNBLEVBQ0Esb0NBQ0EsaUNBQ0EsZ0RBQ0EsTUFDQSxtQ0FDQSxPQUNBLGdCQUNBLDJDQUNBLHNCQUNBLE9BRUEsbUJBQXVCLFNBQWlCLE9BQ3hDLCtCQUNBLEdBR0EsU0FDQSxRQUNBLDZEQUNBLG1DQUNBLE9BRUEsbUJBQXVCLFNBQWlCLE9BQ3hDLHdDQUNBLEdBR0EsU0FDQSxRQUNBLHFDQUNBLGdDQUFxRCxVQUFTLElBQzlELHFCQUVBLEdBQ0EsbUNBQ0EsNkNBQ0EsUUFDQSxpQ0FDQSxtQ0FDQSxVQUF1QixJQUFTLFFBQ2hDLGlCQUNBLGdCQUNBLFdBQ0EsYUFDQSxVQUNBLFlBQ0EsRUFDQSxxQkFDQSxRQUNBLGVBQ0EsT0FDQSxFQUNBLENBQ0EsRUFDQSxJQUtBLGlDQUNBLHdCQUVBLHFEQUNBLElBQ0EsdUNBSEEseURBT0EsNEJBQ0EsSUFDQSw0Q0FDQSxhQUNBLGlCQUlBLHdDQUlBLElBQ0EsMkZBSUEsOEZBQWtFLE9BQTJCLGlCQUM3RiwyQkFDQSxTQUNBLDJDQUNBLElBQ0EsWUFBQyxFQUNELHVCQUVBLHFEQUNBLHFCQUVBLHFEQUNBLElBS0Esb0NBUEEscURBUUEsOEJBQ0EsUUFDQSxnREFDQSxhQUNBLDJCQUNBLGlEQUNBLG1DQUNBLG1CQUVBLEtBQ0EsR0FDQSxRQUNBLElBQ0EseUNBQ0EsYUFDQSxpQkFJQSwyQ0FDQSx1Q0FDQSxpQkFJQSwrQkFDQSx1QkFDQSxtQkFXQSwyQ0FDQSxrQkFDQSxXQUNBLEtBQ0EsOEJBQ0EsSUFDQSw4RkFDQSxxQ0FFQSwrREFDQSxpQkFDQSxFQUNBLEVBQ0Esd0JBQ0Esa0JBQ0EsWUFDQSxlQUNBLDZGQUVBLHNCQUNBLCtCQUNBLCtGQUVBLGVBQ0EsUUFDQSxDQUNBLEtBQ0Esc0JBQ0EsWUFFQSxjQUNBLHNCQUtBLEVBR0EsTUFQQSxvQkFHQSxRQUtBLG9CQUNBLHNGQUVBLDJCQUNBLFNBQ0EscUNBQ0EsSUFDQSxTQUFDLEVBaUJELDRCQUNBLDJCQUNBLFdBQ0EsNENBQ0EsMkVBQ0EsS0FDQSxxREFDQSxzQkFDQSxpREFDQSwyQ0FDQSxrQkFDQSxVQUNBLHdDQUNBLDJDQUNBLEtBQ0EsMENBQ0EsT0FDQSxpQkFPQSw2Q0FDQSxrREFDQSxTQVFBLDJDQUNBLGdEQUNBLE1BQ0EscURBQ0EsS0FDQSxXQXFCQSw0QkFDQSxvQ0FDQSxVQUNBLGlCQUNBLE9BQ0Esa0RBQ0EseUNBQ0EsSUFDQSxFQUNBLGFBS0EsNkJBQ0EsNENBRUEsMENBQ0EsdUJBQ0EsdUNBQ0Esd0RBQ0Esc0JBQ0EsS0FDQSxtQ0FQQSwrQ0FRQSx3QkFDQSxLQUNBLDhDQUNBLHNCQUNBLHlCQUNBLGNBQ0EscUNBQ0Esa0JBQ0EsT0FDQSw0Q0FDQSx3QkFDQSxrQ0FDQSxpQ0FDQSxrQ0FDQSxzQ0FDQSxzREFDQSxxQkFDQSx3Q0FDQSx3RUFDQSxNQUFlLDhDQUNmLFNBQWUsc0RBQ2YsS0FDQSw4REFDQSxlQUNBLHFDQUNBLHFCQUNBLEVBQ0EsY0FFQSwrREFDQSxpQkFDQSxtQkFDQSwyQkFDQSx5QkFHQSxTQUVBLDBEQUNBLEVBQ0EsUUFBQyxFQU1ELDBDQUNBLHlDQUVBLDBDQUNBLDREQUNBLHVCQUNBLEtBQ0EscUNBTEEsZ0RBTUEsZ0RBQ0EsR0FDQSxnRUFDQSxlQUNBLGFBQ0EscUJBQ0EsRUFDQSxjQUVBLDhEQUNBLHdCQUNBLGdEQUNBLGtEQUNBLGlDQUNBLElBQ0EsRUFDQSxVQUFDLEVBS0QsK0NBQ0Esc0NBRUEsdUNBQ0EsSUFDQSwwQ0FIQSxxREFJQSxxREFDQSxHQUNBLHFFQUNBLGVBQ0EsQ0FDQSxRQUNBLEVBQ0EsY0FFQSxtRUFDQSx3QkFDQSw2Q0FDQSxpQ0FDQSxJQUNBLEVBQ0EsZUFBQyxFQW1CRCxtQ0FDQSxvQ0FDQSxpQkFDQSx3Q0FDQSxLQUVBLHNEQUNBLDJDQUNBLDJCQUNBLCtDQUNBLE1BRUEsMENBQ0EsMkNBQ0EscUJBQ0EsK0NBQ0EsTUFFQSx1Q0FDQSxtQkFDQSwwQkFDQSxpQ0FDQSxLQUNBLG9CQUVBLE1BQ0EsZ0JBRUEsS0FDQSxrQkFFQSxNQUNBLE9BQ0EsS0FHQSwyQ0FFQSxxQkFDQSxZQUNBLDBCQUNBLGlDQUNBLEtBQ0EscUNBRUEsS0FDQSxnQkFJQSxrQ0FDQSxZQUVBLE1BRUEsUUFDQSxDQUNBLHdDQUNBLGtCQUNBLFNBQ0EsbURBRUEsZUFDQSxrQkFDQSxJQUNBLEVBQ0EsY0FHQSx1REFDQSxrQkFDQSxRQUVBLHVDQUNBLGtCQUNBLFFBS0EsdURBQ0EsbUNBQ0EsT0FDQSwwQ0FDQSxvQ0FDQSxDQUVBLFlBREEsS0FFQSxFQU1BLHVEQUNBLG1DQUNBLE9BRUEsNENBQ0Esa0RBQ0EsY0FDQSxtREFDQSxpREFDQSxjQUNBLG1EQUNBLGtEQUNBLGNBQ0EsMERBQ0EsaURBQ0EsY0FDQSxFQUNBLFNBRUEsZ0NBQ0EsK0RBQ0EsZ0JBQ0EseUJBQ0EsZUFDQSxRQUNBLHlEQUVBLEVBQ0Esa0JBQ0EsR0FFQSxnQkFDQSxlQUdBLFVBR0Esc0JBR0EscUJBQ0EsTUFDQSxLQUlBLDBCQUNBLGdCQUNBLGVBR0EsV0FJQSxJQUNBLHNEQUNBLGdDQUNBLGlGQUNBLGFBQXNCLHlCQUN0QixlQUNBLHdCQUNBLFdBQ0EsK0JBQ0EsZ0JBSUEseUJBQ0EsWUFDQSwrQkFDQSxnQkFHQSxXQUNBLE9BQ0EsZ0RBQ0EsT0FDQSx3QkFDQSw2Q0FDQSxJQUNBLGdDQUNBLG9EQUNBLFNBQWdCLHlCQUNoQixNQUNBLEVBQ0EsaUJBRUEsdUJBQ0EsOENBQ0EsVUFDQSxlQUNBLHNDQUNBLHdDQUNBLDJDQUNBLGtEQUNBLElBRUEsb0VBQ0EsaUpBQ0EsWUFDQSx1Q0FDQSxDQUNBLFFBS0Esc0RBQ0EsbUNBQ0EsOEJBQ0Esb0NBQ0EsT0FLQSxzREFDQSxvQ0FDQSw4QkFDQSxtQ0FDQSxPQUVBLG1DQUNBLGtCQUNBLFVBR0EsZUFFQSxLQUVBLHNDQUNBLG1CQUNBLEdBRUEsc0NBQ0EsbUJBQ0EsZUFHQSxlQUVBLFFBRUEsMERBQ0EsT0FDQSwwQkFDQSxjQUNBLGdFQUVBLE1BQ0Esb0NBR0EsMERBRUEsZUFDQSxPQUNBLHlDQUNBLGNBQ0EsMEJBRUEsWUFDQSx3Q0FDQSxjQUNBLDBEQUNBLFFBQ0EsT0FFQSxvREFDQSxPQUVBLEtBREEsWUFFQSxzRUFDQSxjQUVBLHFFQUVBLFVBQ0EsV0FDQSxjQUNBLGdFQUNBLGNBRUEsMENBQ0EsWUFDQSwwQkFHQSx1QkFDQSw2REFFQSxZQUNBLGlEQUNBLFlBQ0EsVUFDQSxPQUNBLHFDQUNBLGFBQ0EsS0FFQSxxQ0FDQSxPQUNBLHFDQUNBLGNBQ0EsMENBQ0EsY0FDQSx1Q0FDQSxjQUNBLGFBQ0EsQ0FDQSwyQ0FDQSxZQUNBLGdDQUNBLCtDQUNBLG1CQUNBLGlCQUVBLGFBQ0EsQ0FDQSw0Q0FDQSxZQUNBLCtCQUNBLGNBQ0Esa0JBRUEsYUFDQSxDQUNBLDBDQUNBLHlEQUNBLHFEQUNBLEtBQ0EsMkNBQ0EseURBQ0Esc0RBQ0EsR0FDQSx5Q0FDQSx5REFDQSw2REFDQSxrREFDQSxNQUVBLDZDQUNBLHFCQUNBLG1EQU1BLEVBR0EscUNBQ0EsNEJBQ0EscUVBRUEsbUJBQ0EsOERBRUEscUNBQ0EsbUNBQ0EsbUJBR0EsOERBRUEsRUFFQSxpQkFDQSxjQUNBLGdCQUNBLFNBQ0EsUUFFQSw0QkFDQSx5QkFDQSxXQUNBLENBRUEsK0NBQ0EsT0FDQSxLQUVBLG9EQUNBLHlCQUNBLE1BRUEsMkNBQ0EsT0FDQSxLQUNBLDRDQUNBLENBQ0EsUUFDQSxxREFDQSxDQUNBLFFBQ0EscURBQ0EsQ0FDQSxRQUNBLDJDQUNBLE9BQ0EsS0FDQSwyQ0FDQSxPQUNBLEtBQ0EsMENBQ0EsQ0FDQSxRQUVBLGtEQUNBLENBQ0EsUUFDQSwwQ0FDQSxPQUNBLEVBQ0EsRUFDQSxhQUFLLElBQ0wsa0JBZ0JBLGVBQ0EsY0FDQSxvQkFFQSxrQ0FDQSxnREFDQSxrREFDQSxvREFDQSxvREFDQSwrQ0FDQSw0Q0FDQSxnREFDQSxrREFDQSxnREFDQSxhQUFDLHlCQUNELEtBQ0EsNEJBQ0Esa0NBQ0EsNERBQ0Esc0VBQ0EsdUVBQ0EsVUFBQyxxREFFRCxxQ0FDQSwwRUFDQSw4QkFDQSxtREFDQSxxQkFDQSxxRkFDQSxnQkFDQSxzQkFDQSx5RUFDQSwyQkFDQSx5RUFDQSwyQkFDQSxPQUNBLHlFQUNBLHVCQUNBLG9CQUVBLHVEQUNBLEVBQ0EsaUJBSUEseUJBQ0Esc0JBQ0EsQ0FDQSxnREFDQSxjQUNBLHFDQUNBLFVBQ0EsdURBQ0EseUNBQ0Esa0hBQ0EsaUJBQ0EsSUFDQSxFQUNBLFVBQ0EsOEJBQ0EscUJBRUEsOEJBQ0Esc0NBR0EsOEJBQ0EsS0FDQSxLQUNBLG9DQVJBLDRDQVNBLE9BQ0EsS0FDQSw2Q0FDQSx3QkFDQSxVQUNBLCtDQUNBLHdCQUNBLFdBRUEsd0JBQ0EsTUFDQSx3QkFDQSxXQUNBLFNBQUMsRUFDRCx5Q0FDQSxxQ0FFQSw4QkFDQSxnQ0FDQSx3Q0FDQSxhQUNBLEtBQ0EsdUNBTkEsK0NBT0EsYUFDQSxhQUNBLGdEQUNBLHdCQUNBLDBDQUNBLGFBQ0Esa0RBQ0Esd0JBQ0EsdUNBRUEsNkJBQ0EsTUFDQSxpQ0FDQSw2Q0FDQSxLQUNBLHVCQUNBLHdDQUNBLGtCQUNBLFlBQUMsRUFFRCx3Q0FDQSxvQ0FFQSw4QkFDQSxnQ0FDQSx3Q0FDQSxZQUNBLEtBQ0Esc0NBTkEsOENBT0EsYUFDQSxhQUNBLGlEQUNBLHdCQUNBLHdEQUVBLHFDQUNBLE1BQ0EsRUFDQSxXQUFDLEVBQ0QseUNBc0NBLHFDQUVBLHlDQUNBLElBQ0EsdUNBSEEsc0RBTUEsMEJBQ0EsdURBS0EsY0FDQSxFQUNBLFlBQUMsRUFDRCx5Q0FDQSxvQ0FFQSw0Q0FDQSxnQ0FDQSxjQUNBLEtBQ0Esc0NBTEEscURBUUEsMEJBQ0Esc0RBS0EsY0FDQSxrQ0FDQSxtREFDQSx5REFDQSxVQUNBLFdBQUMsRUFFRCx5Q0FDQSxvQ0FFQSw4QkFDQSxnQ0FDQSx3Q0FDQSxZQUNBLEtBQ0Esc0NBTkEsOENBT0EsYUFDQSxhQUNBLCtDQUNBLGlFQUNBLGFBQ0EsaURBQ0Esd0JBQ0EsMERBRUEscUNBQ0EsTUFDQSxFQUNBLFdBQUMsRUFDRCwyQ0FDQSx1Q0FFQSw4QkFDQSxnQ0FDQSx3Q0FDQSxlQUNBLEtBQ0EseUNBTkEsd0RBT0EseUJBQ0EsMkJBR0EsaUNBRUEsUUFDQSxrREFDQSx3QkFDQSxrREFDQSxjQUNBLG9EQUNBLHdCQUNBLG9EQUVBLCtCQUVBLHVCQUdBLHdCQUVBLE1BQ0EsRUFDQSxjQUFDLEVBZUQsaURBQ0EsNERBRUEsOEJBQ0EsaUNBQ0EsbUNBQ0Esd0NBQ0EsZUFDQSxLQUNBLCtDQVBBLDhEQVFBLE9BQ0Esb0VBQ0EsdURBRUEsU0FDQSxtRUFDQSw4REFHQSxLQUVBLElBQ0Esd0RBQ0Esd0JBQ0EseURBQ0EsZUFDQSwwREFDQSx3QkFDQSwyREFFQSxnQ0FFQSxnQkFHQSx3QkFFQSxNQUNBLG9EQUNBLG9FQUNBLEdBQ0EsRUFDQSxvQkFBQyxFQUNELHNDQUNBLGtDQUVBLDhCQUNBLGdDQUNBLHdDQUNBLFVBQ0EsS0FDQSxvQ0FOQSw0Q0FPQSxhQUNBLGFBQ0EsNkNBQ0Esd0JBQ0EsNkNBQ0EsY0FDQSwrQ0FDQSx3QkFDQSwrQ0FFQSxxQ0FDQSxNQUNBLEVBQ0EsU0FBQyxFQUNELHFDQUNBLGtDQUVBLDhCQUNBLDZCQUNBLHFCQUNBLDhCQUNBLFNBQ0EsS0FDQSxtQ0FQQSwyQ0FRQSxhQUNBLEdBQ0EsNENBQ0EsMEJBQ0EsdUVBS0EsV0FDQSw4Q0FDQSw4QkFDQSx5Q0FDQSxpRUFDQSxRQUNBLDhCQUNBLE1BQ0EsRUFDQSxRQUFDLEVBQ0QsMENBQ0Esc0NBRUEsOEJBQ0EsZ0NBQ0Esd0NBQ0EsY0FDQSxLQUNBLHdDQU5BLGdEQU9BLGFBQ0EsYUFDQSxpREFDQSx3QkFDQSxpREFDQSxjQUNBLG1EQUNBLHdCQUNBLG1EQUVBLHFDQUNBLE1BQ0EsRUFDQSxhQUFDLEVBQ0Qsd0NBQ0Esb0NBRUEsOEJBQ0EsZ0NBQ0Esd0NBQ0EsWUFDQSxLQUNBLHNDQU5BLHFEQU9BLFlBQ0EsK0RBQ0EsdUJBQ0EsUUFDQSxHQUNBLE1BQ0EsZ0RBQ0EscUNBQ0EsT0FDQSwrQ0FDQSxpQ0FDQSxnQ0FDQSxzQ0FDQSw0Q0FDQSxlQUNBLG9CQUNBLCtEQUNBLE9BRUEsUUFDQSw0QkFDQSxTQUNBLENBQ0EsUUFDQSxpREFDQSxpQ0FDQSxnQ0FDQSxzQ0FDQSw0Q0FDQSxlQUNBLG9CQUNBLGtEQUNBLGtDQUNBLFVBQ0EsVUFFQSxJQUVBLDhDQUNBLFVBRUEsOEJBRUEsTUFDQSw2Q0FDQSwyQkFDQSxrREFDQSx5REFHQSw4QkFDQSxnQ0FDQSxpQ0FFQSw4Q0FDQSw2Q0FFQSxTQUNBLDZDQUNBLDJCQUNBLHFEQUNBLHNFQUlBLDJDQUNBLGdEQUNBLGdDQUNBLGlGQUNBLFVBR0EsT0FHQSxLQUNBLCtDQUNBLDRCQUNBLEtBQ0EsNENBQ0Esd0JBQ0EsNENBQ0EsOENBQ0EsdUJBQ0EscUNBS0EsMkJBQ0EsR0FDQSxLQUNBLDJDQUNBLDRCQUNBLFFBQ0EsaURBQ0EsK0JBQ0Esa0JBQ0EsMERBQ0EsNERBQ0EsT0FDQSxrREFDQSxzQkFDQSxXQUFDLEVBQ0QsdUNBQ0EsbUNBRUEsOEJBQ0EsZ0NBQ0Esd0NBQ0EsV0FDQSxLQUNBLHFDQU5BLG9EQU9BLDBDQUFvRCxnQkFBeUIsUUFDN0UsRUFDQSwrQ0FDQSw0QkFDQSxPQUNBLDhDQUNBLGdDQUNBLG9EQUNBLE9BRUEsbUJBQTJCLHVCQUErQixPQUMxRCwwREFDQSxJQUdBLFNBQ0EsUUFDQSxDQUNBLFFBQ0EsZ0RBQ0EsZ0NBQ0EsMEVBQ0EsVUFBMkIsUUFBZSxVQUMxQywrREFDQSxJQUNBLFVBR0EsOEVBQ0EsT0FFQSw4QkFFQSxNQUNBLDBDQUNBLDRCQUNBLFFBQ0EsRUFDQSxVQUFDLEVBbUJELHdCQUtBLHlFQUtBLG1FQU9BLHdCQUNBLDBCQUNBLE9BQ0EsaUNBQ0EsNEJBQ0EsS0FHQSxrQkE4QkEsaUVBQ0EsS0FBeUMsdUNBQ3pDLFFBQWlDLHVCQUNqQyxRQUErQixtQkFDL0IsVUFBaUMsdUJBQ2pDLFVBQStCLG1CQUMvQixnQkFDQSwwQkFDQSw2QkFDQSxtQkFDQSxtQkFDQSxtQkFDQSwrQkFDQSwwQkFDQSxVQUNBLG9DQUVBLGNBQ0Esa0NBRUEsTUFDQSxtQ0FDQSxrQkFDQSxLQUNBLGtEQUNBLGVBQ0EsZ0NBQ0EsMEJBQ0Esa0RBQ0Esa0RBSUEsOERBQ0EsY0FHQSxrQkFDQSxhQUNBLGlCQUlBLHNCQUNBLFFBQ0Esd0JBQ0EscUVBQ0EscUVBQ0EsVUFDQSxrQ0FBK0QsOEJBQWdCLE9BQy9FLGdCQUNBLDhCQUNBLHVCQUNBLGVBR0EsMENBR0EsbUJBQ0Esa0ZBQ0EsY0FDQSw4REFDQSxVQUNBLGlCQUNBLGtCQUNBLENBQ0EsQ0FDQSxhQUNBLGVBQ0EsRUFDQSxjQUVBLDREQUNBLFFBQ0EsMERBQ0EsMEJBQ0Esc0VBQ0EsMkZBQ0EsK0VBQ0EseUdBQ0EsTUFDQSw4Q0FDQSw4Q0FDQSw0RUFFQSxnRkFDQSxrR0FDQSxNQUNBLDJDQUNBLHNHQUNBLE1BQ0EsNkNBQ0Esb0dBQ0EsTUFDQSwyQ0FDQSxzR0FDQSxNQUlBLHdDQUNBLG9DQUNBLDJCQUNBLCtCQUNBLDJCQUErQyxxQkFBZ0IsT0FDL0QsZUFDQSx3QkFDQSwyQkFFQSxpQkFFQSw0QkFBK0Msc0JBQWdCLE9BQy9ELGdCQUNBLHlCQUNBLDJCQUVBLDJCQUNBLHNCQUNBLHdCQUVBLFlBQ0EsdUJBQ0EsaUNBRUEsb0JBQ0EscUJBQ0EsK0JBRUEsd0NBQ0EsV0FDQSxhQUNBLG1CQUNBLHFDQUNBLDRCQUNBLHdCQUNBLHFFQUVBLDRCQUNBLCtCQUVBLE9BQ0Esb0ZBRUEsVUFDQSwwQ0FFQSxvQkFDQSxvQ0FFQSxtQkFDQSxHQUNBLHlDQUNBLHVCQUNBLE1BRUEsZ0RBQ0EsT0FFQSxtQkFBdUIsaUJBQXlCLE9BQ2hELDhDQUNBLElBR0EsZ0RBQ0EsT0FFQSxtQkFBdUIsaUJBQXlCLE9BQ2hELDhDQUNBLElBR0EseUNBR0EsUUFDQSxvQkFJQSxrREFIQSxZQUlBLGtCQUVBLDRDQURBLE9BRUEsK0NBQ0EsUUFDQSxvQ0FBMkMsY0FBZ0IsWUFDM0QsZ0JBQ0EsNEJBQ0EsT0FDQSxlQUNBLDJEQUNBLFlBRUEsa0NBQ0EsbURBQ0EsQ0FDQSx1Q0FDQSw2QkFDQSwwQkFDQSwwQkFDQSx5QkFDQSxJQUNBLHFDQUNBLCtCQUNBLE1BQ0EsaURBQ0EsT0FDQSx1REFDQSxNQUNBLElBQ0EscURBQ0Esc0JBQTJDLHFCQUFnQixPQUMzRCxrQkFDQSw2Q0FDQSw2QkFHQSxZQUNBLEtBQ0EsbURBQ0EsbURBQ0EseUJBQ0Esd0NBQ0EsY0FDQSxFQUNBLDRDQUNBLDhDQUNBLHVCQUNBLCtDQUNBLHFCQUNBLDJDQUVBLHdCQUlBLDBFQUVBLENBS0EsOENBQ0Esc0JBQW1ELDhCQUFnQixPQUNuRSxtQkFFQSxtQkFDQSx5Q0FDQSxPQUdBLFNBQ0EsUUFDQSw4Q0FDQSxzQkFBMkMscUJBQWdCLE9BQzNELGtCQUNBLG9CQUNBLEtBR0EsU0FDQSxRQUlBLDZDQUNBLHFFQUdBLGdFQUlBLFVBQ0Esa0RBQ0EsbURBQ0EsK0JBQ0EsRUFDQSxLQUNBLHFCQUNBLGtCQUNBLENBSUEsOENBQ0Esc0NBQ0Esb0JBQ0EscURBRUEseUZBQ0EsTUFDQSxtQ0FDQSxvQkFDQSxxREFFQSx1RkFDQSxNQUVBLG9DQUVBLE1BQ0EsRUFDQSxNQUNBLHlCQUNBLDBCQUNBLFdBQ0EsSUFDQSwwQ0FDQSxPQUVBLE1BREEsY0FFQSxVQUNBLHFCQUNBLG1CQUNBLHFCQUNBLE1BQ0EscUJBQ0Esc0JBQ0Esb0JBQ0EsYUFDQSxpQ0FFQSx5Q0FFQSxHQUNBLDBDQUNBLGFBQ0EsSUFDQSw4Q0FDQSwwQkFDQSxJQUNBLHNDQUNBLGtEQUNBLHNDQUNBLDZDQUNBLHFEQUNBLCtDQUNBLGtCQUNBLFVBQ0EsbUNBQ0Esd0NBRUEsOEJBQ0Esd0JBQ0EsZUFDQSxlQUNBLE1BQ0EsS0FDQSx5Q0FQQSxzREFRQSw0QkFDQSx1Q0FDQSxnR0FDQSxnRkFDQSx5REFDQSxtQ0FDQSxXQUVBLHdCQUNBLDhDQUVBLElBQ0EsdURBQ0EsV0FDQSxpQ0FDQSwrQkFDQSxnRUFBNkQsOEJBQXFDLE1BS2xHLGdDQUNBLHVEQUVBLE9BQ0EsaUVBQ0EsYUFDQSxvQkFDQSxnQkFDQSw4QkFDQSx5QkFDQSwrQkFDQSxZQUNBLGdDQUNBLG1CQUNBLDhCQUNBLDRCQUNBLGVBQ0EsK0NBRUEsS0FDQSxrREFDQSx5REFDQSxjQUNBLGlEQUlBLG1FQUNBLFVBQ0Esa0RBQ0EsMEJBQ0Esd0NBQ0EsOEJBQ0EsaUNBS0EsTUFDQSw4Q0FDQSxnRUFDQSxPQUNBLEVBQ0EsY0FBQyxFQUlELG1DQUNBLDJCQUVBLDhCQUNBLHdCQUNBLE1BQ0EsS0FDQSxxQ0FMQSxrREFNQSx3QkFDQSw0QkFDQSxrQkFDQSw2Q0FDQSxxQ0FDQSxVQUNBLDBDQUNBLHFDQUNBLFVBQ0EsOENBQ0EsMEJBQ0EsdUNBS0EsTUFDQSxFQUNBLFVBQUMsRUFJRCxrQ0FDQSwwQkFFQSw4QkFDQSx3QkFDQSxNQUNBLEtBQ0Esb0NBTEEsaURBTUEsMEJBQ0Esd0JBQ0EsMENBQ0EsSUFDQSw0Q0FDQSxxQ0FDQSxTQUNBLHlDQUNBLHFDQUNBLFNBQ0EsNkNBQ0EsMEJBQ0Esc0NBS0EsTUFDQSxFQUNBLFNBQUMsRUFJRCw0QkFDQSx5QkFDQSxXQUNBLElBQ0EsK0NBQ0EsYUFDQSxJQUNBLG9DQUNBLDBDQUNBLFFBQ0EsU0FlQSxvQkFDQSxnQ0FDQSxlQUNBLHFCQUNBLE1BQ0EsOENBRUEsc0NBQ0Esa0JBQTRDLHlCQUFnQixPQUM1RCxrQkFDQSwyQkFFQSxpQkFDQSxZQUtBLDJEQUNBLDZDQUNBLHNFQUNBLElBQXVCLGtCQUEwQixXQUNqRCw4QkFDQSwyQkFDQSw2QkFDQSxrREFDQSxtSEFFQSxTQUNBLHlDQUNBLGdDQUNBLGlHQUNBLFNBQ0EscUNBQ0EsMEJBRUEsR0FDQSxlQUVBLEtBQ0Esa0NBQ0EsWUFDQSx5Q0FDQSxJQUNBLGFBRUEsZ0NBQ0EsOENBQ0EsT0FFQSxtQkFBdUIsa0JBQTBCLFdBQ2pELGdDQUNBLGdDQUNBLCtCQUNBLGNBQ0EsQ0FDQSxRQUNBLEVBQ0EsS0FJQSxzQkFDQSw0QkFDQSxZQUNBLE1BQ0EsNkJBRUEsb0JBQ0EsNEJBQ0EsWUFDQSxpREFDQSxxQkFDQSxzQ0FDQSwwQ0FDQSxnQkFDQSxvQkFDQSxnQkFDQSwyQkFDQSxvQkFDQSxXQUNBLCtDQUVBLE1BQ0EsMENBRUEsOENBQ0EsVUFDQSx1Q0FDQSxtREFDQSxHQUNBLDJDQUNBLHVEQUNBLE1BQ0EsRUFDQSxPQUNBLGdFQUNBLHdFQXFCQSxzQ0FDQSxvQ0FDQSxnQkFDQSxTQUdBLHdEQUNBLDhCQUNBLDhDQUVBLFFBREEsaUJBRUEsK0NBQ0EsNEJBQ0EsTUFDQSwwQ0FDQSx3QkFDQSxHQUNBLHFEQUNBLHdDQUNBLFVBQ0EsbURBQ0EscUNBQ0EsVUFFQSxxREFFQSxrREFDQSxlQUNBLCtDQUNBLG9EQUNBLEdBQ0Esa0RBQ0EsYUFDQSxTQUNBLDBEQUNBLElBQ0EsZUFrQkEsaUJBQ0EsdUJBRUEscUNBSUEsOERBRUEsdUVBQ0EsaUJBQUMsK0JBSUQsNkJBQ0EsU0FFQSxXQUtBLE1BRUEsU0FFQSxRQUVBLGVBT0EsNEJBQ0EsS0FBeUMsdURBQ3pDLFNBQXFDLCtCQUNyQyw4QkFDQSxvQkFDQSxzQkFDQSw0QkFDQSxvQ0FDQSxpQ0FDQSxXQUtBLG9EQUNBLCtFQUNBLG9CQUNBLDJEQUNBLHFCQUNBLDZEQUNBLGlCQUNBLHNCQUNBLFlBQ0EsNkNBQ0EsOEJBQ0EsK0JBQ0EscUNBQ0EsbURBQ0EsMkNBQ0Esc0NBQ0EsTUFDQSxFQUNBLFNBMkJBLHdCQUNBLDJCQUNBLGFBRUEsTUFPQSxzREFDQSxzQkFBMEMsMkJBQWdCLE9BQzFELHlCQUNBLDZCQUNBLFdBR0EsU0FDQSxRQUNBLDZDQUNBLHNDQUNBLE9BQ0EsRUFDQSxTQUVBLDZCQUNBLHlDQUNBLFlBQ0EscUJBQ0EsU0FDQSx3REFDQSxzRUFDQSxVQUNBLEVBQ0EsY0FFQSw2QkFDQSxDQXdCQSxlQWJBLGdCQVFBLHlCQUNBLGNBQ0EsOEJBQ0EsZ0JBQ0EsQ0FFQSxpQkFDQSx1QkFDQSxrQ0FDQSx5Q0FDQSwrQ0FDQSxnREFDQSxRQUFDLCtCQU1ELGdDQUNBLHlDQUNBLGlCQUNBLHVCQUNBLG1EQUNBLGlFQUVBLDRDQUNBLGdDQUNBLE9BRUEsMkNBQ0EseUJBQ0EsUUFDQSx3REFFQSxlQUNBLGdEQUNBLE1BQ0EsRUFDQSxjQU1BLHNFQUNBLHNCQUNBLHlCQUlBLDJCQU1BLHFFQUhBLDZCQU5BLHlDQUVBLFdBUUEsZ0RBQ0EscUNBQ0EsaUNBQ0EsTUFDQSx1QkFDQSxjQUNBLFlBa0RBLHVCQUNBLG9CQUNBLENBQ0EsOERBQ0EsQ0FDQSxzREFFQSw0REFPQSxvREFDQSwyQkFDQSxtQkFHQSx3QkFFQSxHQUNBLEVBQ0EsUUFLQSxnQ0FDQSw2Q0FFQSw4QkFDQSxzQkFDQSxnQkFDQSx5QkFDQSxxQ0FDQSxJQUNBLEtBQ0Esc0NBUkEscUZBU0EsdUJBQ0EsdURBSUEseUVBQ0Esd0RBQ0EsQ0FFQSwwQkFDQSwyREFDQSwwQkFDQSx3Q0FDQSxnQkFFQSxzREFDQSwwREFDQSxDQUVBLHNCQUNBLCtDQUNBLHdCQUNBLHFDQUNBLCtCQUNBLHdDQUNBLGFBQ0EsRUFDQSxXQUFDLEVBY0Qsd0NBQ0Esd0RBRUEsOEJBQ0Esc0JBQ0EsZUFDQSxxQkFDQSw2QkFDQSxxQ0FDQSxNQUNBLEtBQ0Esd0NBVEEsdUZBVUEsMEJBQ0EsdURBQ0EsOEVBS0EsNkRBRUEsd0NBQ0Esc0VBQ0EsQ0FFQSwwQkFDQSw2REFDQSwwQkFDQSx3Q0FDQSxnQkFFQSxzREFDQSxxQ0FDQSx1REFDQSxDQUVBLHNCQUNBLGlEQUNBLHdCQUNBLHVDQUNBLG1DQUNBLDRDQUNBLGFBTUEsMERBQ0EsSUFDQSxxQ0FDQSxtQkFHQSxpQkFFQSx1QkFDQSxLQUNBLG9EQUNBLGdDQUFvRCx1QkFBZ0IsT0FDcEUscUJBQ0EseUJBQ0EsOEJBQ0EsZ0JBQ0EsOEJBS0EsOEJBRkEsU0FJQSxPQUNBLEtBQ0EsRUFDQSxhQUFDLEVBVUQsNENBQ0EsZ0RBRUEsOEJBQ0Esc0JBQ0EsMEJBQ0Esd0NBSUEsMENBQ0EsV0FDQSxLQUNBLDRDQVhBLDJGQVlBLDBCQUNBLHVEQUNBLGtGQUtBLDZEQUVBLHNDQUNBLCtFQUNBLHlDQUNBLDhDQUNBLCtEQUNBLENBRUEsMEJBQ0Esd0ZBQ0EsMEJBQ0Esd0NBQ0EsZ0JBRUEsdUNBQ0EscUVBQ0EsK0NBQ0EsbUVBQ0EsQ0FFQSxzQkFDQSxxREFDQSx3QkFDQSwyQ0FDQSw2Q0FDQSxrREFDQSxhQU9BLGdFQUNBLG1FQUNBLGtCQUNBLGlEQUNBLG1EQUNBLEdBVUEsNkZBQ0Esc0JBQ0Esc0lBQ0EseUVBQ0EsZ0JBQXVCLDJCQUFtQyxXQUMxRCx5Q0FDQSw0QkFDQSx3QkFDQSx1QkFDQSwrREFFQSxpR0FDQSxJQUNBLE9BQ0EsaUJBV0Esb0ZBQ0EsMEJBQ0EsZ0JBQW1ELHNCQUFnQixZQUNuRSx1QkFDQSw2QkFDQSx3QkFDQSx1QkFDQSwrREFFQSxxRUFDQSxnQkFDQSxPQUNBLGlCQUNBLDZFQUNBLDhEQUNBLCtDQUF1Qix5QkFBaUMsV0FDeEQseUNBQ0EsNEJBQ0EsK0NBQ0EsR0FDQSxPQUNBLEtBQ0EsRUFDQSxpQkFBQyxFQUVELHlDQUNBLDBDQUVBLDhCQUNBLHNCQUNBLHVCQUNBLHFDQUNBLE9BQ0EsS0FDQSx5Q0FQQSx3RkFRQSw4QkFDQSx1REFJQSxnR0FDQSxDQUVBLDBCQUNBLDhEQUNBLDhCQUNBLHdDQUNBLFdBRUEsVUFDQSxnREFFQSw2RkFDQSxpQkFDQSxrREFDQSx3QkFDQSx3Q0FDQSxzQ0FDQSxhQUNBLEVBQ0EsY0FBQyxFQWtCRCw2Q0FDQSxvQ0FDQSxDQUNBLGtHQUNBLGdEQUNBLGNBQ0Esa0dBQ0EsT0FDQSxnQkFDQSw0REFDQSx3QkFDQSx5QkFDQSx1Q0FDQSwwQkFDQSx3QkFFQSwyQ0FDQSxnREFDQSxlQUNBLFFBQ0EsdUZBQ0EsbUJBQ0EsY0FDQSxzRkFJQSxtQkFDQSxjQUNBLHNFQUNBLHdDQUNBLHdDQUNBLDhCQUFpRCx3QkFBaUMsUUFDbEYsZ0JBRUEsUUFDQSxlQUE0Qyx1QkFBZ0IsT0FDNUQsZ0JBQ0EsWUFFQSwrQkFDQSxPQUNBLGdFQUNBLHdCQUNBLCtEQUNBLFNBQ0EsRUFDQSw0QkFFQSw0Q0FDQSxpREFDQSxlQUNBLFFBQ0Esd0ZBQ0EsbUJBQ0EsY0FDQSx1RkFJQSxtQkFDQSxjQUNBLHVFQUNBLHdDQUNBLHlDQUNBLHVDQUF1RCx3QkFBbUMsU0FDMUYsRUFDQSxlQUE0Qyx3QkFBZ0IsT0FDNUQsaUJBQ0EsWUFFQSxnQ0FDQSxPQUNBLGlFQUNBLHdCQUNBLGdFQUNBLFNBQ0EsRUFDQSw2QkFBQyw4QkE0QkQsZ0NBQ0EsWUFDQSxLQUNBLHlEQUNBLGtDQUNBLEtBQ0EsRUFDQSxlQTJCQSxZQUNBLGtCQUNBLHVCQUNBLGtDQUNBLHVDQUNBLDhDQUNBLHdEQUNBLGlEQUNBLDhDQUNBLHNEQUNBLHdEQUNBLHdEQUNBLDREQUNBLGtEQUNBLDJDQUNBLGlEQUNBLDZDQUNBLDJDQUNBLDRDQUNBLFdBQUMscUJBQTBCLDZCQXFPM0IsK0JBQ0EsaUJBQ0Esd0NBQ0EsV0FLQSwyQ0FDQSw0QkFDQSw0Q0FDQSxlQUNBLElBQ0EsR0FDQSxJQUNBLHdDQUNBLE9BQ0EsMkJBQ0Esc0NBQ0Esa0JBQ0EsUUFDQSxxQ0FDQSxrQkFDQSxRQUNBLG1EQUNBLGVBQ0Esa0JBQ0EsSUFDQSxFQUNBLGNBRUEsNERBQ0EsMEJBQ0EsS0FFQSwwQ0FDQSx1Q0FDQSxDQUVBLFVBREEsS0FFQSxFQUVBLHVEQUNBLDhDQUNBLHlCQUNBLGNBQ0EsVUFDQSxzQ0FDQSxlQUNBLElBQ0EsQ0FJQSxxREFDQSxJQUNBLGVBQ0EseUJBS0Esd0NBRkEsdUJBR0EsZUFDQSx5QkFDQSxTQUNBLE9BQ0EsTUFDQSxDQUVBLHNEQUNBLG9DQUNBLCtDQUNBLElBRUEsd0NBQ0EsZ0RBQ0EsU0FFQSwyQ0FDQSxpQkFDQSxpQ0FFQSxPQURBLElBRUEsd0NBQ0Esa0JBQ0EsU0FDQSwrQ0FDQSxZQUNBLHdDQUNBLG1CQUNBLEtBQ0EsR0FDQSxNQUNBLDZDQUNBLHNCQUNBLFlBQ0EsOEJBQ0EsS0FDQSxrQ0FDQSxpQ0FDQSxnQ0FDQSwrQkFDQSxnQ0FDQSxPQUNBLHdDQUNBLFFBQ0EsQ0FDQSxRQUNBLHdDQUNBLFNBQ0EseUNBQ0EsVUFDQSxTQUNBLEdBQ0EsR0FDQSx5Q0FDQSxZQUNBLHFDQUFzQyxvQkFBMEIsS0FDaEUsa0NBQ0EsR0FDQSx5Q0FDQSwrQkFDQSwrQkFDQSxLQUNBLE1BQ0EsRUFDQSxTQWlCQSx1VUE0Q0EsMkJBR0EsaUJBQ0Esb0JBQ0Esc0RBQ0EsSUFHQSxpQkFDQSx5Q0FDQSxJQUVBLGdCQUNBLGdEQUNBLFdBS0EsNkNBQ0EsK0JBQ0EsV0FDQSx5Q0FDQSxPQUNBLDZCQUNBLHlDQUNBLDBCQUNBLElBQ0Esd0NBQ0EsdUJBQ0EsUUFDQSx1Q0FDQSx1QkFDQSxRQUNBLDBDQUNBLHVCQUNBLFNBS0EsNkNBQ0EsMkJBQ0EsNkNBQ0EsQ0FDQSxxREFDQSxlQUNBLHVCQUNBLElBQ0EsRUFDQSxjQUdBLDREQUNBLDRDQUNBLENBRUEsVUFEQSxLQUVBLEVBRUEseUNBRUEseUJBQ0EsK0VBQ0EsTUFFQSw0Q0FDQSxrQkFDQSxXQUNBLCtEQUdBLE1BREEsSUFFQSwrQ0FDQSxzQkFDQSxjQUNBLDhCQUNBLEtBQ0EsdUNBQ0Esc0NBQ0EsZ0NBQ0EsOEJBQ0EsK0JBQ0Esd0JBQ0EsVUFDQSxRQUNBLENBQ0EsUUFDQSwyQ0FDQSxnQkFDQSxvQ0FDQSxxQkFDQSxXQUNBLEdBQ0Esc0JBR0EsNkRBRUEsS0FDQSx5REFDQSxlQUNBLDJDQUNBLDJCQUNBLDBCQUNBLFVBQ0EsTUFDQSxFQUNBLFdBaUJBLGVBQ0EscUJBQ0EsZ0NBQ0EseUNBQ0EsNENBQ0EsNkNBQ0EsVUFBQywyQkFBZ0MsS0FDakMsY0FDQSxvQkFDQSw4QkFDQSxzQ0FDQSxRQUFDLHlCQUtELHFDQUNBLDZCQUNBLDBDQUNBLFdBQ0EsMERBQ0Esb0JBQ0EsaUNBQ0EsV0FDQSx5Q0FLQSxtQ0FDQSxrREFFQSxpQ0FDQSxzQ0FDQSxpREFDQSxnQkFDQSxnQkFHQSwrQkFDQSxzQ0FDQSxrREFDQSxpQkFDQSxvQkFHQSwrQkFDQSxzQ0FDQSwrQ0FDQSxpQkFDQSxpQkFHQSwrQkFDQSxxQ0FDQSwyQ0FFQSw4QkFDQSxxQ0FDQSxrREFDQSxpQkFDQSxzQkFHQSwrQkFDQSxtQ0FDQSxpREFDQSxpQkFDQSxvQkFXQSxXQUNBLHNEQUNBLFFBQ0EseUJBRUEsMkRBeERBLFFBeURBLG1EQUNBLGFBQ0EsOERBQ0EsY0FDQSxPQUNBLEdBQ0EsT0FDQSxFQUNBLGlCQUNBLDJCQUNBLG9IQUNBLFlBQ0EsZ0JBQ0Esa0JBQ0Esd0JBQ0EsNEJBQ0EsMkJBQ0EsZ0NBQ0EsOENBQ0EsdUJBRUEseUZBQ0EsYUFDQSx5Q0FDQSxjQUEwQiwyQkFDMUIsS0FDQSx3RkFDQSxnQkFDQSxrRUFDQSxlQUNBLHlCQUNBLFNBQ0EsRUFDQSxjQUVBLGdFQUNBLDJCQUNBLHlDQUNBLGtEQUNBLHdDQUNBLGlDQUNBLG1DQUNBLFNBRUEsMEJBQ0EsOEJBQ0EsNENBQ0EsT0FFQSxtQkFBdUIsWUFBb0IsT0FDM0MseUNBQ0EsOENBQ0EsS0FHQSxTQUNBLFFBQ0EsRUFDQSxZQXNCQSwwQkFDQSxTQUlBLGFBSUEsZ0JBS0EsY0FLQSxpQkFJQSx1Q0FDQSxzQkFDQSxtQ0FDQSxvQ0FDQSxzQ0FDQSw0Q0FDQSxzQkFRQSwyRkFDQSx1QkFBb0MsNkZBQ3BDLDhGQUNBLHFCQUNBLEdBQ0EsRUFDQSxXQVNBLDJCQUNBLFNBT0EsY0FNQSxZQUtBLFFBS0EsZUFLQSxtQ0FDQSxrQkFDQSx5QkFDQSw0QkFDQSxzQ0FDQSx3Q0FDQSxnQkFRQSw2RkFDQSxxRkFDQSxpQkFDQSxFQUNBLFlBdUJBLGtDQUNBLENBa0JBLGVBaEJBLHFCQUVBLGlCQUVBLGlCQUtBLFdBQ0EsdUJBQ0EsdUNBQ0EsMEJBQ0EsZ0JBQ0EsTUFDQSxDQUVBLG9DQUNBLENBS0EsK0RBSkEsZUFDQSw4QkFDQSxlQUNBLENBRUEsMkJBQ0EsaUNBQ0EsMkRBQ0Esa0VBQ0EsaUVBQ0EsbUVBQ0EsaUVBQ0EsT0FBQyxtREFDRCxxQ0FDQSxDQXNCQSxlQXBCQSxtQkFFQSxNQU9BLFVBRUEsa0JBQ0EsS0FBcUMsK0JBQ3JDLHVCQUErQixtQkFDL0IsaUJBQ0EscUJBQ0EsMkJBQ0EsdUJBQ0EsS0FDQSxDQUdBLDBCQUNBLHVCQUtBLHVCQU9BLHVCQUVBLHVDQUNBLHVCQU1BLGlCQUNBLHFCQUNBLDhEQVNBLGVBQ0EsYUFDQSxRQUNBLEVBQ0EsY0FFQSw0RUFFQSxlQUNBLGFBQ0EsWUFDQSxFQUNBLGNBRUEsMEVBRUEsZUFDQSxPQUNBLDBCQUNBLEVBQ0EsY0FFQSxrRkFFQSxlQUNBLGFBQ0Esa0JBQ0EsRUFDQSxjQU1BLCtFQUNBLENBQ0EsNEJBQ0Esd0NBRUEsWUFPQSxpREFDQSxvQkFDQSxtQ0FDQSxrQ0FDQSw2RUFDQSxDQUNBLHdCQUNBLHdDQUVBLDZCQUNBLGlEQUVBLDZCQUNBLDhDQUdBLDhDQUVBLFdBQ0EscUZBQ0EsaUJBSUEsc0RBQ0EsTUFDQSwyQ0FDQSxvQkFDQSxrRUFDQSxNQUNBLDJFQUNBLFdBQ0EsMERBQ0EsTUFDQSx1RUFDQSxJQUNBLDZEQUNBLHdCQUNBLENBQ0EsdURBQ0Esd0JBQ0EsQ0FDQSw4Q0FDQSxNQUNBLDJCQUNBLFdBQ0EsRUFDQSxXQUlBLG9DQUNBLGlEQUNBLHVCQUVBLG1DQUVBLCtCQUVBLHFEQU1BLDJEQUNBLG9CQUlBLGdGQUNBLDJCQUF5RCxnQ0FBZ0IsT0FDekUsaUJBQ0EsK0JBQ0Esc0RBRUEsbUNBQ0EsNEVBR0Esa0NBQXlELGdDQUFnQixPQUN6RSxpQkFDQSxtRUFFQSxPQUVBLDJFQUNBLFdBQ0EsdURBQ0EseUNBQ0EsOEJBQ0EsbUNBQ0EsOEJBQ0Esc0RBRUEsYUFDQSxrQ0FHQSxrQkFDQSxtQ0FJQSx1QkFFQSxpRUFDQSxhQUNBLGtDQUtBLG9CQUNBLG1DQUNBLDhCQUVBLHFDQUNBLHlEQUNBLGtDQUNBLDZCQUNBLHdCQUNBLHlEQUVBLGNBQ0Esa0NBQ0EsMkJBSUEsOEJBQ0EscURBRUEsY0FDQSxNQUNBLGdFQUVBLFFBQ0EsRUFNQSx5RUFDQSxDQUNBLCtEQUdBLG9DQUVBLEdBTUEsNkVBQ0EsMEJBQ0EsbURBQ0EsOENBQ0EsdUJBQ0EscUJBQ0EsZ0JBQ0Esa0JBZUEsdURBQ0Esd0JBR0EsaUNBQ0EsZ0VBRUEsVUFDQSwyQkFoQkEsK0JBQ0Esb0ZBQ0EsaUJBRUEsK0VBR0EsY0FVQSxDQUtBLDZFQUNBLFdBQ0EsbUJBQ0EsaUVBQ0EsOENBQ0EsdUJBQ0EsMkRBVUEseUNBQ0EsTUFDQSxvRkFDQSxxRUFFQSxpQkFDQSxhQUNBLHdEQUNBLDZCQUVBLHNCQUNBLENBQ0EsOEJBTUEsZ0ZBQ0EsSUFDQSw2REFDQSw4Q0FDQSw2REFDQSxpQkFJQSwyQkFDQSxHQUNBLHNFQUVBLEtBQ0Esc0hBQ0EsMkRBQ0EscURBQ0EsMkRBQ0EscUJBQ0EsV0FNQSxpRkFDQSx3QkFHQSx3RUFDQSxnQkFDQSxvQkFDQSx5Q0FDQSxxREFDQSx3RkFDQSxxSkFDQSxXQVNBLGlHQUNBLHdCQUdBLGtEQUNBLCtDQUNBLGtEQUtBLDBDQUVBLGlJQUNBLFdBQ0EscUZBRUEsa0JBQ0EsaUVBQ0EsMEJBQ0EsU0FNQSxxRkFDQSx3Q0FDQSxtQ0FDQSwrRUFDQSxpQ0FDQSxtQ0FDQSxJQUtBLCtFQUVBLHdDQUNBLHNCQUNBLDRCQUNBLHNFQUNBLDBCQUNBLDJDQUVBLGdDQUNBLFNBQ0EsMkVBQ0EseURBQ0EsV0FDQSw2Q0FDQSxvR0FFQSxnQkFDQSxhQU1BLG1FQUNBLE9BQ0EsK0NBS0EsNkVBQ0EsbUNBQ0EsMENBQ0EsVUFDQSxpREFDQSxTQU1BLGdFQUNBLFdBQ0EsbURBQ0EsbUVBSUEsMkVBQ0EsNENBQ0EsNkNBQ0EsS0FDQSxFQUtBLCtFQUNBLCtEQUNBLGtDQUNBLElBQ0EsRUFDQSxxQkFBQyx5QkF3QkQsVUFDQSx5Q0FDQSw0Q0FDQSxhQUNBLElBQ0Esd0JBQ0EsU0FDQSx5Q0FDQSxvREFDQSx1REFDQSwwREFDQSxtREFDQSw0Q0FDQSxpQkFDQSxHQUVBLDJCQUFvQywrRUF1QnBDLGlEQUNBLGlCQUNBLHdCQUNBLE9BQ0EsZ0VBQ0EscUJBQ0EsY0FHQSxrQkFFQSxFQUNBLDhFQUdBLE9BQ0EsV0FDQSw4REFDQSwwQkFDQSxVQUNBLGtDQUNBLHFEQUNBLEdBU0EsMERBQ0EsMEJBRUEsWUFBb0IsT0FLcEIsSUFRQSw0REFDQSxJQUNBLHNCQUVBLHlCQUtBLE1BRUEsbUNBQ0EsTUFRQSwrREFDQSxPQUNBLG1CQUNBLHdCQUdBLFlBQ0EsNERBSUEsSUFJQSxvREFHQSxvQkFJQSx3RkFDQSx1QkFDQSwrQkFFQSxNQUNBLCtEQUlBLFdBQ0EsNEJBQ0EsZ0RBQ0EsaUJBRUEsc0JBQ0EsMENBQ0EsVUFDQSxPQUVBLG1CQUNBLDZCQUNBLDRDQUNBLE1BUUEsdURBQ0EscUJBQ0Esb0JBSUEsZ0RBRUEsZUFNQSx1REFDQSxPQUNBLHlEQUNBLGlHQUdBLDJDQUNBLGlHQUVBLE1BQ0EsMkRBQ0EsaUNBQ0EsY0FDQSw2REFDQSx5QkFDQSxrR0FDQSxTQUNBLHdFQUNBLHNDQUNBLGtCQUNBLG1CQUNBLE1BQ0EsaUJBQ0EsK0RBQ0Esc0NBQ0Esb0dBQ0EsWUFDQSxRQUNBLG9EQUNBLGdEQUNBLEtBQ0EsdURBQ0Esb0NBQ0EsZ0VBQ0EsaUVBQ0EsR0FDQSx1QkFDQSxxREFDQSxxREFDQSxrRUFDQSxHQUNBLHVCQUNBLGdFQUNBLFVBQ0EsMERBQ0EsT0FHQSxzQkFFQSxzREFDQSxLQUNBLDREQUNBLHdDQUNBLFlBQ0Esc0NBRUEsaURBQ0EsYUFDQSwwRUFDQSxlQUNBLDJCQUNBLENBQ0EsMkJBQ0EsVUFDQSw0QkFFQSx1QkFDQSxpQkFDQSxFQUNBLGNBRUEsNkZBQ0EseUJBQ0EsQ0FDQSxzQkFDQSxVQUNBLHVCQUVBLFVBQ0EsdUZBQ0EseUhBQ0Esa0NBQ0EsRUFDQSxrRUFFQSxPQUNBLGlCQUNBLDBCQUNBLHlCQUNBLHFEQUNBLGtCQUNBLGlCQUFvQixXQUVwQiwrQkFDQSxvQkFBb0Isa0JBRXBCLDBCQUNBLG9CQUFvQixxQkFFcEIsdUNBQ0EscUJBQ0Esc0NBSUEsVUFDQSxtQkFBNEIsYUFFNUIsd0JBQ0EsZUFBNEIsYUFFNUIsOEJBQ0EsZUFBNEIsYUFFNUIsWUFDQSxPQUFvQixpQkFDcEIsUUFDQSxzQkFDQSxhQUFvQixpQkFFcEIsdUJBQ0EsYUFBb0IsMEJBRXBCLG9CQUNBLFlBQW9CLDhCQUVwQixvQkFDQSxnQkFDQSxxQ0FHQSw4QkFDQSxlQUNBLGVBQ0Esc0JBQ0EsK0JBSUEsMEJBQ0EsV0FDQSw2QkFHQSx3QkFDQSxVQUNBLDJEQUlBLGlEQUVBLEtBQ0EsdURBQ0EsV0FFQSxVQUNBLGtDQUNBLDhCQUVBLDRCQUNBLDJDQUVBLGlDQUNBLHVEQUVBLGlEQUNBLCtCQUVBLElBQ0EsMkNBRUEsT0FDQSxnREFFQSxxQkFDQSxpREFFQSxpQkFDQSw0QkFDQSxZQUNBLG9CQUNBLDBDQUVBLGdDQUNBLHdEQUVBLHFDQUVBLDhCQUNBLG1EQUNBLGtEQUE4RCx3QkFBMkIsRUFDekYsR0FDQSxvQkFDQSwwREFDQSw0REFFQSxxREFDQSxpQ0FDQSwwREFDQSx5Q0FDQSxpREFDQSxXQUNBLGtDQUNBLDhCQUNBLHlDQUNBLGlDQUNBLEtBQ0Esc0NBQ0Esa0NBQ0EsNkRBQ0EseUVBQ0EsOERBQ0Esd0NBQ0EsSUFFQSxtREFFQSxLQUVBLHVFQUNBLE9BQ0Esa0JBQ0EsMEJBRUEsUUFDQSw2REFDQSwyQ0FDQSw4Q0FDQSwyQkFDQSxtQ0FDQSxtREFFQSxlQUNBLHFGQUNBLHlIQUFzSSxJQUFJLHlCQUMxSSx1QkFDQSx5REFDQSxXQUNBLFlBQ0EsNENBQ0EsMkJBQ0EsTUFDQSxHQUNBLE1BQ0EsMkRBQ0EsV0FFQSx3QkFFQSxxQkFEQSwwQkFFQSx3REFDQSxPQUNBLEdBQ0EsTUFDQSx3REFDQSxPQUNBLHNCQUVBLEtBQ0EsNERBQ0EsV0FDQSxZQUNBLHVDQUNBLDJCQUNBLE9BQ0EsR0FBZ0IsUUFDaEIsT0FDQSx1REFDQSxvQkFDQSwrRkFDQSxxREFDQSx3REFDQSx5Q0FDQSxxREFDQSwyQ0FDQSxHQUNBLDREQUNBLHlCQUNBLDJGQUNBLDZGQUNBLHlDQUNBLG9DQUNBLFFBQ0Esa0VBRUEsVUFDQSx3Q0FDQSx3QkFFQSwyQkFDQSw0QkFFQSwyREFDQSxRQUNBLHdFQUNBLE9BQ0EsZ0NBQ0EsTUFDQSxxQ0FDQSxRQUNBLHlDQUNBLFNBQ0EsMkNBQ0EsUUFDQSx3Q0FDQSxNQUVBLGdEQUVBLE1BQ0EsdUVBQ0EsMEJBQ0EsNkJBQ0EsUUFDQSxtQ0FDQSwyQkFJQSx5REFDQSwyQ0FDQSxxQkFDQSxhQUNBLGdCQUNBLFVBQ0Esc0JBQ0EsOEJBQ0Esb0NBRUEsZ0NBQ0EsOENBR0Esa0JBQ0EsNkNBQ0EscUJBQ0EsYUFDQSxnQkFDQSwwQkFDQSxpQ0FDQSxzQ0FHQSxrQkFDQSxJQUNBLGdDQUNBLGdCQUNBLGtDQUNBLGtDQUlBLGtCQUNBLDZDQUNBLElBQ0EsMEJBQ0EsY0FDQSwyQ0FDQSxnQ0FHQSxVQUNBLGNBQ0EsNERBQ0EsNkJBQ0EsaUVBQ0EsbUJBR0EsT0FDQSwwREFDQSxhQUNBLGdFQUVBLFVBQ0EscUJBQ0Esa0RBQ0EsbUNBR0EsZ0dBQ0Esc0RBQ0EscURBQ0EsaURBQ0EsMkNBQ0EsaUZBQ0EsS0FDQSw4Q0FDQSxxQ0FDQSwrREFDQSx5RUFDQSx3RkFDQSw4REFDQSx1REFDQSxxREFDQSxpRUFDQSx3Q0FDQSw2Q0FDQSxtREFDQSxpRkFDQSxJQUNBLDhDQUNBLHFDQUNBLCtEQUNBLGdEQUNBLDJDQUNBLDRCQUNBLG9DQUNBLDBCQUNBLHVDQUNBLHNEQUNBLG1FQUNBLElBQ0EsOENBQ0EscUNBQ0EsK0RBQ0EsdUNBQ0EsMkNBQ0EsdURBQ0EsK0RBQ0EsS0FDQSxzQ0FFQSw2QkFDQSwrQ0FDQSxxQ0FDQSwyQkFDQSxzQ0FDQSx1QkFDQSx3REFDQSxnQkFFQSx3REFFQSxlQUNBLFlBQ0EsMEVBQ0EsT0FDQSwyQ0FFQSxTQUNBLHFDQUVBLE1BQ0Esd0NBRUEsUUFDQSx5Q0FFQSxRQUNBLHVDQUdBLGlEQUVBLE1BQ0EsMEVBS0EsVUFDQSw0Q0FDQSx1Q0FFQSw0QkFDQSxtRUFDQSx1QkFFQSxpQkFDQSx1Q0FHQSwwQkFEQSxHQUVBLDZEQUNBLFdBQ0EsS0FDQSw2QkFDQSxvQkFDQSxzREFHQSxtQ0FDQSx1QkFBc0IsNkJBRXRCLGlDQUNBLHNCQUNBLHNEQUNBLDhDQUdBLHVDQUNBLDBCQUNBLFdBQ0EsK0JBQ0EscUVBQ0EsK0JBQ0EsVUFLQSx3REFFQSxtQ0FDQSw2REFFQSxlQUNBLE1BQ0EsNERBQ0EsV0FDQSx3QkFDQSw0Q0FDQSw4QkFDQSxxQkFDQSxpQ0FDQSwyQ0FDQSxpREFDQSx3QkFDQSwyQ0FDQSx5REFDQSxhQUVBLGtDQUVBLGFBQ0EsaUJBQ0EsNkJBQ0Esc0NBQ0EsYUFDQSxvQkFDQSx1Q0FDQSxpRkFDQSxpQ0FDQSxVQUNBLDBDQUNBLG1GQUNBLGdCQUVBLHVEQUVBLE9BQ0EscUVBQ0Esb0NBQ0EsZ0VBQ0EsaUNBS0EsWUFLQSx3QkFMb0IscUJBR3BCLFFBUEEsd0NBR0EsWUFPQSx1RUFDQSw4QkFDQSxpQ0FHQSxvQkFLQSxzQ0FGQSw4REFKQSxZQU9BLDBFQUNBLFdBRUEsbUJBQ0Esa0NBQ0EsNkJBQ0EsNkJBQ0Esb0NBQ0EsOEZBQ0Esd0JBQ0EsT0FFQSwrQkFDQSxpQkFDQSw0RUFDQSxXQUNBLG9CQUNBLDRDQUNBLDJFQUFnRCxvQ0FBaUQsV0FHakcsSUFFQSxFQUNBLHlFQUNBLFdBQ0EsOEJBQ0EsaUNBQ0EsZ0NBQ0EsZ0NBQ0EsbUNBR0EsdUNBQ0Esb0NBQ0EsZ0NBQ0Esd0NBQ0EsMENBQWlFLHNCQUF5QixFQUkxRiw0QkFDQSxxQ0FDQSxnQ0FDQSxxQ0FDQSwwQ0FBaUUsc0JBQXlCLEVBSzFGLHFEQUVBLFVBQ0Esa0VBQ0EsV0FFQSxVQUNBLCtCQUNBLDBCQUNBLDJIQUNBLDJDQUVBLDREQUNBLG1EQUNBLHVFQUFxRix3QkFBMkIsRUFDaEgsR0FDQSxpREFDQSxnREFDQSx3RUFBc0Ysd0JBQTJCLEVBQ2pILEdBRUEsc0RBRUEsdURBQ0EsK0NBQ0EsVUFDQSxpRUFDQSxPQUFnQixtQ0FDaEIsT0FDQSw2RUFDQSxxQ0FDQSw0RUFDQSwwQ0FDQSwwQ0FDQSxNQUNBLDZEQUVBLFlBQXNCLGlCQUN0QixrQkFDQSxzREFFQSxnQkFDQSxnQkFDQSw2QkFDQSx3RkFDQSx3Q0FBNEMsbUJBQzVDLGVBQ0EsK0JBQ0EsU0FDQSxxQ0FFQSxzQ0FDQSxTQUNBLHlDQUVBLDJDQUNBLGFBQ0EsK0NBRUEsYUFDQSw2REFFQSxnQkFDQSx5REFFQSxRQUNBLE1BQ0EsZ0VBQ0Esb0NBQ0EscUJBQ0EsdURBQ0EsaUJBQ0Esc0JBQ0EsNEZBQ0Esd0JBQ0EsYUFDQSxjQUNBLFNBQ0EsdUNBRUEsb0JBQ0EsU0FDQSx1Q0FFQSxvQkFDQSxXQUNBLHdDQUVBLG9CQUNBLFdBQ0Esd0NBRUEsb0JBQ0Esa0JBQ0Esb0NBRUEsc0RBQ0EsTUFDQSx5RUFDQSxrQ0FDQSxlQUNBLGFBR0EsS0FDQSxvQkFHQSxNQUNBLHlEQUNBLE9BQ0Esd0JBQ0EsT0FDQSw0QkFDQSx3QkFDQSxtREFDQSxnQkFFQSxxREFFQSxRQUNBLDREQUNBLHFCQUVBLE1BREEsMkJBRUEsa0JBQXNCLGtDQUd0QixRQUFzQiwwQkFFdEIsa0NBQ0EsU0FDQSw2RkFFQSxjQUNBLE1BQ0EsMERBQ0EsV0FDQSxRQUVBLDJEQUNBLHlCQUNBLHVDQUNBLDRCQUNBLE9BQ0EsU0FDQSwwQkFFQSxHQUFnQixpQkFBbUIsa0JBQ25DLFNBQ0EsMkRBQ0EsV0FDQSxXQUNBLHdCQUdBLDRCQUdBLDRCQUdBLHVEQU9BLGdCQU5BLHVDQUEyQyx5QkFBNEIsRUFDdkUsaUNBQW1ELHFCQUE4QixRQUdqRiw0QkFOQSwrQkFIQSxTQUhBLEVBZUEsMERBQ0EsV0FDQSxXQUVBLHdEQUE4Qyw4QkFBcUMsTUFDbkYsRUFDQSw0REFDQSxXQUNBLHdDQUE4QyxnQ0FBdUMsTUFDckYsRUFDQSx5REFDQSxXQUNBLFdBQ0EsZUFDQSxxREFBOEQsc0JBQWlDLFVBRS9GLEdBQ0EsMkRBQ0EsV0FDQSxxQkFDQSxxREFBK0Qsd0JBQW1DLFVBQ2xHLDZCQUNBLE9BRUEseURBQ0EsdUJBQ0EsS0FFQSwyREFDQSxPQUVBLGNBREEsY0FFQSxVQUNBLDZCQUlBLGlCQUVBLDJEQUNBLHFCQUNBLEtBQ0EsNkRBQ0EsT0FFQSxVQURBLGNBRUEsTUFDQSwrQkFDQSxhQUNBLHdDQUNBLHNCQUNBLDRCQUNBLFVBQ0EscUNBQ0EsbUJBQ0EsaUNBQ0EsZUFDQSxpQ0FFQSw2QkFFQSxtQkFDQSxtRUFDQSxPQUFnQixnQkFDaEIsa0JBQ0EsK0VBQ0Esa0RBQ0EsVUFFQSxpRUFDQSxPQUNBLHlDQUNBLDBDQUVBLEtBQ0EsbUVBQ0EsMEZBQ0EsV0FFQSxpRUFDQSx5QkFDQSxnQkFDQSxhQUNBLHdDQUNBLHFDQUNBLDhCQUtBLHFEQUVBLFFBQ0EsbUVBQ0EsZ0tBQ0EsT0FFQSw4REFDQSx5QkFDQSxXQUNBLGFBQ0Esd0NBQ0EsVUFJQSw0QkFDQSxZQUNBLGFBQ0Esd0NBQ0EsVUFLQSx3REFFQSxRQUNBLGdFQUNBLDJCQUNBLFFBQ0EscUVBQ0EsNEJBQ0EsY0FDQSx1RUFDQSw2QkFDQSxlQUNBLG1DQUNBLHNCQUNBLG9CQUVBLG1CQUNBLGtFQUNBLE9BQ0EsZ0RBQStELGNBQWdDLGlCQUUvRixHQUNBLGdFQUNBLDZCQUNBLGtDQUFnRCxtQ0FBeUMsS0FDekYsd0JBQ0EsT0FDQSxFQUNBLG1CQTRCQSw0QkFXQSxtQ0FDQSxpQ0FFQSxhQUNBLGtDQUNBLE1BQ0EsMENBQ0EsQ0EwQkEsMkNBekJBLGNBQ0Esa0JBRUEsUUFFQSxnRUFHQSxnQkFHQSx3QkFDQSxVQUNBLFdBQ0EsV0FFQSw4Q0FDQSxlQUNBLFlBQ0EsS0FFQSxHQUVBLENBQ0EsQ0FFQSxJQUNBLHVEQUNBLGtEQUNBLDZCQUNBLHNDQUNBLGtEQUNBLGNBQ0EseUJBQ0Esd0JBRUEsb0JBRUEsZUFDQSx5REFDQSxDQUNBLHFCQUVBLDZCQUNBLGdDQUNBLEtBQ0EsZ0JBQ0Esa0JBR0EseURBQ0EsZ0JBQ0EsbUNBQ0EscUJBR0EsdURBQ0Esd0NBR0Esd0JBQ0EsaUNBR0Esc0NBRUEsYUFDQSxJQUNBLEVBQ0EsWUEwQ0EsbUJBQ0EsQ0FRQSxzQkFIQSxpQkFDQSxDQUNBLENBMENBLHlCQUNBLGdCQUVBLDhCQU9BLGtCQU1BLGNBT0EsWUFNQSxjQUlBLGdCQUlBLGVBQ0Esc0JBQ0EsZ0JBQ0EsY0FBdUIsVUFBcUIsWUFDNUMsZ0JBRUEsZUFDQSxRQUNBLEtBQ0EsK0JBNUNBLHVDQTZDQSxnQkFDQSwwQkFDQSwwQkFDQSwwQkFDQSx5QkFDQSx1QkFDQSxjQUNBLENBT0EsbURBQ0EsQ0FDQSx3QkFFQSxjQUVBLE1BQ0EsK0JBQTJCLEVBQVEsS0FTbkMsTUFDQSwrQkFDQSxpQ0FDQSxpQ0FDQSw0QkFDQSxlQUlBLGlCQUEyQixFQUFRLEtBQ25DLE1BQ0Esb0JBQ0Esc0JBQ0Esc0JBQ0EsaUJBQ0EsZUFJQSxZQUF3QixLQUFRLEtBQ2hDLGdDQUNBLFNBRUEsK0NBQ0EsaUJBQ0EsaUJBQ0EsaUJBQ0EsaUJBQ0EsS0FFdUIsSUFBdkIsRUFBK0IsU0FDL0IsQ0FDQSxLQUNBLGVBQ0EsS0FHQSxtQkFDQSxJQUlBLFlBQ0EsaUJBQ0EsS0FHQSxtQkFDQSxJQUdBLGtCQUNBLHNDQUNBLElBQ0EsSUFDQSwyQkFDQSxJQUNBLENBQ0EsZ0JBQ0EsMkNBQ0EsMkNBQ0EsMkNBQ0EsMkNBQ0EsMkJBQ0Esa0RBRUEsSUFHQSxhQUNBLHVDQUVBLGlEQUNBLFlBRUEsV0FDQSxnQkFFQSxxQkFLQSxJQUNBLGlCQUNBLHVDQUNBLFdBR0EsYUFDQSwrQkFDQSwyQ0FDQSxLQUNBLFFBQ0Esd0JBQ0EsZ0JBQ0EsV0FFQSxFQUNBLEtBSUEsY0FDQSxnQ0FDQSxLQUNBLFFBQ0Esd0JBQ0EsZ0JBQ0EsV0FFQSxFQUNBLEtBR0EsQ0FDQSxhQUNBLG1CQUNBLFdBRUEsa0NBQ0EsWUFDQSxhQUVBLGNBQ0EsNkNBR0EsMERBR0EsOEJBQXdDLEVBQVMsTUFDakQsaUJBQ0EseUJBRUEsd0JBQ0EsZ0JBQ0EsSUFBdUIsRUFBTyxJQUM5QixjQUE0QixHQUFRLFFBQ3BDLFlBQ0Esd0JBR0EsUUFDQSxPQUNBLEVBQ0EsSUFBQyxFQXNCRCw2QkFDQSw0QkFDQSxrQkFDQSx5QkFDQSxPQUNBLHdEQUNBLDRCQUNBLHFEQUNBLFFBQ0EsbURBQ0EsNkJBQ0EsdURBQ0EsUUFDQSxxREFDQSwrQkFDQSwyREFDQSxRQUNBLHlDQUNBLE1BQ0EsU0FDQSwyQ0FDQSxhQUNBLElBQ0EsOENBQ0Esb0NBQ0EsdURBQ0EsZUFDQSxrREFDQSxxQ0FDQSx1RUFDQSxJQUNBLG9EQUNBLHVDQUNBLDJFQUNBLElBQ0EsRUFDQSxZQWlCQSxZQUNBLG1DQUlBLG1CQUNBLGtCQUtBLHlDQUdBLG9DQUNBLHNCQUNBLDJDQUNBLHFDQUNBLHFDQUNBLElBS0Esc0ZBQ0EsSUFDQSw4QkFDQSw2Q0FDQSw0Q0FJQSxpQkFDQSxvQ0FyQkEsV0FzQkEsMEVBQ0EsV0FDQSxzQkFDQSxvREFFQSxtQ0FDQSwrREFDQSxJQUNBLFlBQ0EscURBQ0Esc0JBQ0EsK0RBQ0EsZUFDQSxNQUNBLHVDQUNBLHNDQUNBLGdFQUNBLHFCQUNBLHVDQUNBLDRCQUNBLGdHQUNBLG1CQUNBLHlHQUtBLGlEQUNBLHVEQUVBLHdCQUNBLE1BQ0EsYUFDQSxRQUNBLFFBQ0EsK0JBQ0Esd0JBQ0EsbUJBQ0EsU0FDQSxlQUVBLGlCQUNBLFFBQ0EsK0JBQ0EseUNBQ0EsSUFDQSxDQUNBLG9DQUNBLCtDQU1BLDJCQUErQixnQkFDL0Isb0RBQ0EseUNBQ0EsUUE5RUEsR0ErRUEsRUFDQSxFQUNBLG1GQUdBLHVDQUNBLE1BQ0EsbUVBQ0EsY0FDQSxNQUNBLFFBRUEsSUF0R0EscUNBdUdBLElBQ0EsUUFFQSxrREFDQSxvQ0FLQSxDQUdBLDRDQUNBLGdDQUNBLG9CQUdBLDhFQUVBLFVBQ0EsZUFFQSxtRkFrQkEsT0FDQSxvREFFQSxzQ0FDQSxrREFFQSw4REFNQSxTQUlBLFVBQ0Esd0NBQ0EscUJBQ0EsQ0FDQSxpRUFXQSxPQVZBLHVCQUNBLHlDQUNBLE9BRUEsK0NBQ0Esa0JBR0EsS0FHQSxvQkFBa0MsZ0JBQXdCLE9BTTFELDBDQUdBLG9DQUNBLElBQ0EsSUFDQSxNQUNBLFNBQ0Esc0JBQ0EsTUFDQSxFQUFxQixFQUNyQixFQUNBLENBQ0EsRUFDQSxvRkFDQSxDQUNBLHNCQUVBLCtCQUNBLCtFQUNBLENBQ0EsU0FDQSx3QkFDQSw0Q0FFQSxjQUNBLGtGQUNBLENBQ0EsU0FDQSx3REFDQSxrRUFFQSx5Q0FDQSxvRkFDQSxZQUNBLHNCQUNBLG9CQUtBLDZDQUVBLGdEQUNBLGtCQUNBLDRDQUVBLGdDQUNBLGlDQUNBLDJCQUNBLFFBQ0EsMEJBQ0EsU0FDQSxRQUNBLHlCQUNBLFNBQ0EsMEJBR0EsU0FDQSwyREFDQSxrQkFDQSxPQUVBLDJDQUNBLG9DQUVBLFFBQ0EsQ0FDQSx3QkFLQSxjQUNBLFlBQVMsRUFDVCxHQUNBLFlBRUEsMERBQ0Esc0NBQ0EsaUVBQ0EsK0JBQ0EsSUF0UUEsVUF1UUEsNkJBQ0EsVUFDQSw4QkFDQSxTQUNBLGFBQ0EsSUFDQSw0QkFDQSxHQUNBLEVBQ0Esb0JBaUJBLDhCQUNBLDJCQUNBLHNCQUNBLHdCQUNBLHdCQUNBLG1FQUNBLGVBQ0Esb0NBQ0EsYUFDQSxFQUNBLGNBRUEsMkVBQ0EsZUFDQSxrQ0FDQSxXQUNBLEVBQ0EsY0FFQSxpRkFDQSxpREFDQSxjQUNBLDhEQUNBLDJDQUFvRCxDQUNwRCxrQkFDQSxzREFDQSx1QkFDQSxNQUNBLGtEQUNBLGFBQ0EsUUFDQSw4Q0FDQSxhQUNBLElBQ0EsRUFDQSxlQXVCQSxJQUNBLCtCQXVCQSwrQ0FDQSw0REFDQSxXQUNBLHdCQUNBLGNBQ0EsMEZBQ0EsK0JBQ0EsZUFDQSxzREFDQSxpREFDQSxlQUVBLEVBQ0EsaUZBQ0EsK0RBQ0Esb0JBQ0EsYUFDQSwwQ0FDQSxzQkFDQSwwQkFDQSxvREFFQSxXQUNBLFNBQ0EsMEJBQ0EsRUFDQSxjQWlCQSx5QkFDQSxDQVFBLDBCQVBBLFdBQ0Esc0RBQ0EsZUFDQSxxQkFDQSxNQUNBLEVBQ0EsQ0F5QkEsWUFDQSxrQkFFQSxhQU9BLCtCQUNBLDJEQUNBLDJEQUNBLHlEQU1BLDZEQUtBLHFEQUNBLHlCQUFDLHFCQVFELG9DQUNBLDhFQUNBLGlCQUNBLHdCQUNBLDBCQUNBLHFCQUNBLHdCQUNBLGlDQUNBLG9FQUNBLG1FQUlBLCtDQUFvRCxDQUNwRCxFQWVBLGtHQUNBLDJCQUNBLHdFQUNBLHdDQUNBLFNBQ0EsU0FLQSxvREFDQSxXQUNBLDJDQUFtRCxjQUFtQyxvQkFBRSxFQUN4RixRQUtBLGlEQUNBLGFBQ0Esb0JBUUEsb0RBQ0EsQ0FDQSwrQkFDQSxnSEFFQSxNQUNBLDBEQUNBLFdBQ0EsZ0RBQ0EsT0FDQSxrQ0FRQSxpQkFQQSwrQ0FDQSwrQkFDQSxPQUdBLEdBR0EsRUFDQSxvREFDQSxDQUNBLCtDQUNBLHdCQUNBLDhCQUVBLEtBQ0EsRUFDQSxnQkFDQSx5QkFDQSxzQkFFQSxtQkFHQSxpQ0FHQSxRQUNBLHNCQUtBLDBEQUVBLGNBQ0EsR0FLQSwyQ0FDQSxXQUNBLFVBQ0EsdURBQ0EsY0FDQSx1QkFDQSw2QkFDQSxlQUNBLGVBQ0EscUVBQ0EsNENBSUEsU0FDQSwwRUFDQSxNQUNBLFNBQXFCLEVBS3JCLEdBQ0EsUUFDQSx3QkFDQSxjQUNBLHVCQUNBLE1BQ0EsRUFDQSxvQkFDQSxRQUNBLE9BTUEscUVBQ0EsV0FDQSxVQUNBLG1HQUdBLDJIQUNBLDBGQUFzRyxxQ0FBeUMsR0FDL0ksc0NBQ0EsV0FDQSxTQUNBLGlEQUNBLE1BQ0EsY0FDQSxtRUFFQSxTQU9BLDJEQUNBLGlDQUNBLG9FQUtBLHVDQUNBLCtCQUF5QyxnQkFBMEIsU0FDbkUsRUFLQSxpRUFDQSxzQkFBcUQsMkJBQWdCLE9BQ3JFLGNBQ0EsaUJBQ0EsUUFHQSxTQUNBLFFBU0Esc0VBQ0EsV0FFQSx3Q0FDQSw4QkFDQSw0RkFFQSx1REFBMEQseUJBQXdDLFlBQ2xHLHlCQUEwRCwyQkFBZ0IsZUFFMUUsT0FDQSxvREFJQSxhQU5BLG1CQU9BLE9BQ0EsRUFFQSwwREFFQSwwQ0FDQSxvQkFDQSxvRUFDQSxFQUNBLEVBQ0EsVUFpQkEsZUFDQSw0QkFDQSxrQkFDQSxxQkFHQSx3QkFpSEEsMEJBQ0EseURBQ0EsY0FDQSw0QkFDQSw4QkFDQSxvQ0FDQSx3Q0FVQSwyRkFDQSxDQUNBLG1JQUVBLHFDQUNBLHlNQUNBLGdCQUF1Qiw0QkFBMkIsT0FDbEQsK0JBQ0EsZ0NBQ0Esb0NBQ0Esb0RBQ0EsZUFFQSxPQUNBLFNBUUEsb0VBQ0EsQ0FDQSxrSUFFQSxxQkFDQSxXQUF1Qiw0QkFBMkIsT0FDbEQsNEJBQ0Esd0JBQ0EsbUVBR0EsdUJBQ0EsU0FDQSx5Q0FDQSxnQkFDQSw4QkFBNkMseUJBQWdCLE9BQzdELGlCQUNBLCtCQUVBLFdBQ0EsT0FDQSxpREFDQSw2QkFDQSwwQ0FDQSxVQUNBLEVBQ0EsYUFFQSxrQ0FDQSxrRUFLQSx3QkFDQSxZQUNBLHlCQUNBLG1DQUNBLGlDQUNBLDZCQUNBLFdBTUEsa0ZBQ0EsZ0RBQ0Esa0NBQ0EsT0FDQSx3Q0FDQSwyQkFDQSxxQ0FDQSxZQUF1QixjQUFzQixPQUM3Qyw2REFFQSxnRkFDQSxXQUNBLEVBQ0EsbUJBOEJBLGlDQUNBLHNDQUNBLFdBSUEsdUJBRUEsd0JBRUEsVUFDQSxtQkFDQSxrQkFHQSxlQUNBLDRDQUNBLE9BQ0EsdUJBQ0EsWUFHQSxpQ0FFQSxNQUFTLGlCQUNULE9BQ0Esc0JBQ0EsWUFDQSxtQ0FFQSxNQUNBLEVBQ0EsdURBQ0EseUJBQ0EsR0FDQSw0REFDQSxXQUNBLGlCQUNBLHVCQUVBLDhEQUNBLHlCQUNBLFlBQ0Esb0NBT0Esb0NBSkEsdURBS0EsbUNBQ0EsOENBQ0EsT0FDQSxxQ0FDQSwrQ0FDQSxPQUNBLENBRUEsRUFDQSxtREFDQSxXQUNBLGdEQUNBLG9CQUNBLE9BQ0EsRUFDQSw0REFDQSxJQUNBLFlBQ0EsNkJBQ0Esb0JBR0Esa0NBRUEsT0FDQSxTQUNBLGtDQUNBLEVBQ0EsQ0FDQSxpRUFDQSxPQUNBLHdDQUFzRCxlQUFzQixNQU01RSw4QkFFQSxNQUNBLGtFQUNBLE9BQ0EseUNBQXNELGdCQUF1QixNQUc3RSw2QkFFQSxNQUNBLDZDQUNBLGdEQUNBLFNBQ0EsT0FDQSxFQUNBLDJDQUNBLHVEQUNBLFFBQ0EsTUFDQSxFQUNBLDZCQUVBLGFBQ0EsdURBQ0EsbUJBQ0EsZ0JBQ0EsRUFDQSxxQ0FDQSxHQUNBLHFDQUNBLEdBQ0EsbUNBQ0EsZUFFQSxTQUFpQixlQUFrQixlQUFvQixJQUN2RCxFQUNBLEdBQ0EsdUJBQ0EsZUFFQSxTQUNBLEVBT0EsNENBQ0EsOEJBQ0EsdUNBQ0EsMEJBQ0EsT0FDQSxtQ0FHQSxRQUVBLFdBQ0EsRUFDQSxvQkFBbUQscUNBQTBCLE9BQzdFLDRCQUNBLFlBRUEsaUJBQ0EsRUFNQSxtREFDQSxXQUNBLGNBQ0EsMENBQ0EsOEJBQ0EsR0FDQSxnQkFDQSxTQUNBLEVBQ0Esa0JBdUJBLHdCQUNBLDZCQUNBLGVBT0Esb0JBQ0EsRUFFQSw2Q0FDQSxzQkFDQSx3QkFDQSxPQUdBLHdDQUE2QyxxQkFBdUIsWUFDcEUsOENBQ0EsdUJBQ0EsV0FFQSxNQUVBLENBQ0EsdUNBQ0EsMEJBQ0EsSUFFQSw2Q0FDQSxzQkFDQSx3QkFDQSxPQUNBLGlCQUdBLGlDQUZBLG1CQUV1QixZQUFvQixPQUMzQyw2QkFDQSxLQUlBLDRCQUhBLDBCQUlBLE9BSUEsMENBQ0Esc0JBQ0Esd0JBQ0EsT0FDQSxpQkFFQSxtQkFBdUIsWUFBb0IsT0FDM0MsNkJBQ0EsS0FTQSxNQVJBLHNDQUdBLHFCQUVBLE1BSUEsUUFDQSwwQ0FDQSx1Q0FDQSx3QkFBaUQscUJBQXVCLFlBQ3hFLG1DQUNBLFFBQ0EsRUFDQSxDQUNBLEVBQ0Esd0NBQ0EscUJBQ0EsTUFDQSxFQUNBLFNBK0JBLHlDQUNBLHNDQUNBLGNBQ0EsaUVBQ0EsWUFDQSxVQUNBLEVBRUEsNkVBQ0Esa0JBQ0EsOERBQ0EsY0FjQSxpRkFDQSxXQUNBLGtCQUNBLDBDQUNBLG1CQUNBLDBDQUlBLGtGQUNBLE9BQ0EsdURBQ0EsR0FHQSxxREFDQSxnQkFFQSxjQUVBLEVBS0Esa0VBQ0EsOEJBRUEsaUNBQ0EsS0FDQSxNQUVBLCtEQUNBLG1DQUNBLDJDQUNBLE9BQ0EsRUFDQSwwQkFpQkEsY0FRQSw4QkFDQSxzQkFDQSxTQUNBLEVBRUEsb0VBQ0Esc0NBQ0EsdUZBQ0EscURBTUEsd0NBQ0EsMENBQ0EscUJBQ0EsNEJBQ0EsSUFDQSw4QkFDQSxvREFDQSw4REFDQSx5RUFDQSxpQ0FDQSxxQkFDQSxNQUNBLHlDQUNBLDRFQUNBLGdDQUlBLDJDQUNBLGFBQ0Esd0RBQ0EsK0JBQ0EsK0RBQ0EsWUFDQSxFQUNBLENBQVMsR0FDVCxXQUVBLGdDQUNBLDZDQUNBLHlEQUNBLFdBRUEsaUNBQ0EsZ0NBQ0EsdUJBV0EsNEJBQ0EsZ0JBSUEsaUVBUUEsZ0JBQ0Esd0JBQ0EsMEJBTUEsMkJBRUEsdUNBQ0Esa0JBQ0EsTUFDQSw2RUFDQSx1REFDQSxnREFDQSxxQ0FFQSxtQkFDQSxTQUNBLEdBSUEsZ0VBQStELE9BQTRCLG9CQUMzRixFQUNBLHFDQUNBLFNBQ0EsT0FDQSxFQUNBLFFBTUEsa0NBQ0EsdUNBQ0EsZUFDQSxjQUNBLDJCQUNBLElBQ0EscUVBQ0EsZUFDQSxhQUNBLFVBQ0EsRUFDQSxjQUVBLGtGQUNBLGVBQ0EsYUFDQSxPQUNBLEVBQ0EsY0FFQSwrRUFDQSxvQkFDQSxlQUNBLEtBQ0EsRUFDQSxjQUtBLCtEQUNBLE1BQ0EsYUFLQSxrREFDQSxjQUNBLEdBTUEsaURBQ0Esa0NBQ0EsU0FDQSxFQUNBLG1CQUtBLGtDQUNBLDBDQUNBLFdBQ0Esc0JBQ0EsaUJBSUEsc0NBQ0Esa0RBQ0EsMEJBQ0EsU0FDQSxxQ0FDQSxhQUNBLGtEQUdBLGdDQUVBLFNBQ0EsMENBQ0EsOENBQ0EsTUFDQSxDQUNBLG1FQUNBLGdFQUNBLE1BQ0EsMEVBQ0EsZUFDQSxnQ0FDQSxPQUNBLEVBQ0EsY0FFQSx3RUFDQSxDQUNBLHlDQUVBLGVBQ0EsNEVBQ0EsK0JBQ0EsNEJBRUEsUUFVQSx5REFDQSx3Q0FDQSwwRUFDQSw2QkFDQSxNQUNBLEVBQ0EsbUJBV0EsNEJBQ0EsOEJBQ0EsWUFDQSxLQUNBLDhEQUNBLElBQ0EsZUFDQSxvRUFLQSxtQ0FFQSwrREFOQSxvQ0FHQSx5QkFJQSxRQVFBLDZDQUNBLDZDQUNBLGtDQUNBLDBCQUNBLFFBUUEsMkNBQ0EsV0FDQSw0QkFFQSxzREFFQSxPQUNBLDBCQUVBLGlEQUNBLFFBQ0EsTUFDQSxFQUNBLDhDQUNBLDBDQUNBLG1DQUNBLHdCQUNBLFFBT0EsMENBQ0Esb0NBQ0EsNkJBQ0EsMkJBQ0EsUUFDQSw4REFDQSxrREFDQSxnQkFDQSx1REFDQSxjQUNBLE1BQVMsa0JBQ1QsT0FDQSxRQUNBLEVBQ0EsZ0VBQ0EseUNBQ0EsNENBQ0EsZUFDQSxtQ0FDQSxxRUFPQSxnQkFDQSxRQUNBLEVBQ0Esc0VBQ0EsSUFDQSxTQUNBLGlCQU1BLDJCQUxBLFlBR0EsMENBR0EsMENBQ0EsU0FTQSwwREFDQSwrQkFDQSwwREFDQSxzQ0FDQSxxQkFDQSxNQUNBLHlDQUNBLHlCQUNBLGFBQ0EsbUZBSUEsQ0FDQSxzQkFHQSxXQUVBLFNBQ0EsT0FSQSxVQVNBLENBQ0EsRUFDQSxrRUFDQSxhQUNBLHlEQUNBLHNDQUNBLHFCQUNBLE1BQ0EseUNBQ0EseUJBQ0EsV0FDQSxPQUdBLFdBRkEsa0RBR0EscURBQ0Esd0RBQ0EsK0NBQ0EsbUJBQ0EsaUNBQ0EsSUFDQSxnQkFDQSxZQUNBLFlBQ0EsT0FFQSxVQUNBLG1DQUdBLHNDQUVBLFVBQ0EsQ0FBUyxrQkFDVCxtQ0FDQSxRQUNBLEVBQ0EsOERBQ0EsSUFDQSxpQkFDQSx5QkFDQSx3Q0FHQSxvQ0FDQSw2REFHQSxlQUFnQix1QkFDaEIsTUFDQSxrREFDQSxlQUNBLGtCQUNBLG9CQUVBLHNCQUNBLG9DQUNBLHNCQUNBLDJDQUdBLDBDQUVBLFVBRUEsNENBRUEsVUFDQSxFQUNBLGFBSUEsMkNBNkJBLHdFQUNBLHdHQVFBLHdFQUNBLGlCQUNBLHNDQUVBLDBEQUNBLENBQ0EscUdBQ0EsZUFDQSxhQUNBLDhCQUNBLEVBQ0EsY0FVQSxvRkFDQSxpRUFDQSxtREFDQSxNQUlBLDJGQUNBLGNBQ0EsdUJBQ0EsNENBQ0EseUJBQ0EsZ0NBQWlELHFCQUF1QixZQUN4RSx3Q0FDQSwrQ0FDQSxrQ0FDQSxJQUNBLE1BQ0EsMkVBQ0EsMkNBR0EsMERBQ0EsV0FDQSxtQ0FDQSxTQVNBLHNGQUdBLGdDQUNBLHVCQUNBLDBEQUNBLE9BQ0EsMkNBQTJELHVCQUFpQyxTQUc1Riw4QkFFQSxFQUNBLEVBQ0EsbUZBQ0EsV0FDQSxpQ0FDQSx1QkFDQSx3Q0FDQSxPQUNBLG1EQUNBLGFBQ0EsSUFDQSxFQU9BLHdGQUNBLFdBQ0EsaUNBQ0EsdUJBQ0Esd0NBQ0EsT0FDQSxhQUNBLHFEQUNBLGlDQUVBLGNBQ0EsSUFDQSxFQUNBLDhGQUNBLFdBQ0EsYUFHQSxrQ0FDQSx1Q0FDQSxzQ0FDQSxxQkFBc0IsT0FBZSx3Q0FDckMsb0RBQ0EsZ0RBQ0Esa0RBR0EsZ0RBRUEsbUJBSEEsTUFJQSxrQkFBK0IsT0FBZ0IsUUFDL0MsRUFDQSxvRkFDQSxXQUNBLHVDQUNBLDZGQUNBLDZCQUNBLG9GQUNBLEdBQ0Esb0RBQ0EsbUJBQ0Esc0JBQXNCLE9BQWUsaUNBQ3JDLE9BQ0Esa0JBR0EsMEVBSUEsdUVBQ0Esb0VBQ0Esd0NBR0EsOEZBQ0EsOERBQ0EsR0FDQSxrQkFDQSxzQkFDQSwyQ0FDQSxtRkFDQSxTQUNBLGtEQUNBLG9EQUNBLElBQ0EsR0FDQSw4QkFDQSxpQkFDQSxrQkFBK0IsT0FBb0IsWUFDbkQsRUFLQSw0R0FDQSxrQ0FDQSwwREFDQSxNQUNBLHVHQUNBLFdBR0EsZ0RBQ0EsK0JBQTZDLGFBQWdDLHVDQUM3RSxzQ0FDQSxZQUNBLE1BQ0EsRUFDQSxtRUFDQSxnREFDQSxLQUNBLDhEQUNBLHFEQUErRCxpQkFBMEIsUUFDekYsRUFDQSxrRUFDQSw0QkFDQSxnQ0FDQSw0QkFDQSwwQkFDQSxtQ0FDQSxRQUNBLEVBQ0EsMkVBQ0EsZ0VBQ0EsU0FPQSwyRUFDQSxXQUNBLHlEQUNBLDJCQUNBLGdDQUNBLFNBQ0EsRUFDQSxFQUNBLDRCQUFDLHdEQVFELDREQUVBLDhCQUNBLGdDQUNBLGNBQ0EsS0FDQSw4REFMQSx3RkFNQSxXQUNBLGtCQUNBLHNCQUNBLFVBQ0EscURBQ0EsMkRBQ0Esb0RBR0Esa0ZBQ0EseURBQ0EsaUJBQ0EsMEJBQTBCLGFBQzFCLEtBQ0EscURBQ0EsTUFDQSw4RkFDQSxxREFDQSxZQUNBLEVBQ0EsbUNBQUMsNkNBc0VELDRCQUNBLHFDQUNBLGlCQUNBLFVBUUEsd0ZBQ0EsV0FDQSx3QkFDQSxXQUNBLHlGQUNBLG9DQUNBLHdDQUNBLHdCQUNBLHFCQUNBLDhCQUlBLDhCQUNBLGdDQUdBLGVBQ0EsaUNBQ0EscUJBRUEsd0JBQW9DLG9DQUF5QyxJQUU3RSxtQkFDQSxlQU9BLHFDQUF3QyxvREFBMEQsSUFFbEcsdUJBQ0EsMkJBQ0EscUNBQ0EsR0FFQSxtQkFDQSxrQ0FBb0MsMENBQStDLElBRW5GLG1CQUNBLGtDQUNBLGtDQUNBLDRCQUNBLElBRUEsSUFDQSxDQUNBLDJEQUNBLGVBQ0EsUUFDQSw0QkFDQSw4QkFDQSwyQkFDQSxJQUNBLGtCQUNBLHlDQUNBLGlCQUNBLGtDQUNBLHNDQUNBLFNBQ0EsRUFDQSxxRUFDQSxXQUNBLDJDQUNBLGdEQUNBLHlEQUNBLHlEQUNBLGdGQUNBLGdDQUNBLDJEQUNBLCtCQUNBLDhEQUNBLDhFQUNBLHdFQUNBLDJFQUErRixDQUMvRixFQUNBLEVBQ0EsRUFDQSxFQUNBLEVBQ0EsRUFDQSxlQUlBLDBCQUNBLENBS0EsZ0RBSkEsY0FDQSx5QkFDQSxXQUNBLENBV0EsOEJBQ0EsMEJBRUEsaURBQ0EsY0FDQSxxQ0FDQSw4Q0FDQSxnQkFRQSw4QkFLQSw0QkFDQSxRQUNBLGVBQUMsOEJBV0QsU0FJQSxpQkFPQSxPQVVBLHdDQUNBLGFBQ0Esb0NBQ0EsNkNBQ0EsZUFFQSw4QkFFQSx5Q0FDQSxTQUNBLGVBUUEsOEJBQ0EsU0FJQSxpQkFJQSxPQUtBLFFBTUEsMkJBQ0EsYUFDQSxvQkFDQSw4QkFDQSxnQ0FDQSxTQUVBLDhCQUVBLG9DQUVBLDZDQUVBLG9FQUNBLFdBQ0EsZUFBQyxpQ0F3Q0QsOEJBQ0EsQ0FLQSx5REFDQSxRQUNBLE9BS0Esd0RBQ0Esc0JBQ0EsTUFLQSxzREFDQSw0QkFDQSxRQUNBLDJCQU9BLHNEQUNBLG9CQUNBLGtCQUFDLDJCQVNELENBS0EsMkNBSkEsV0FDQSxtQkFDQSxRQUNBLENBTUEsZ0NBQ0EsQ0FLQSwrQ0FKQSxXQUNBLGtCQUNBLE9BQ0EsQ0FlQSwrQkFDQSxTQU1BLGtCQUtBLGdCQUtBLFdBT0EsK0JBQ0Esc0JBQ0EsZ0NBQ0EseUJBQ0Esb0NBQ0EscUJBQ0EsK0JBQ0Esa0JBQ0EsZ0JBSUEscUNBS0EsMENBQ0EsZUFDQSxRQUNBLHFDQUNBLGtEQUNBLDBCQUNBLHNCQUFDLHVCQWNELFNBU0EsVUFJQSxTQU1BLFlBa0JBLFNBZUEsWUFRQSwrQkFDQSxlQUNBLDBCQUNBLDBCQUNBLDBCQUNBLDBDQUNBLG9DQUNBLEtBQ0EsdUJBRUEsMkJBRUEsMENBTUEsZ0VBQ0EsWUFDQSxRQVdBLCtCQUNBLFNBSUEsa0JBSUEsU0FNQSxvQkFDQSxlQUNBLG1CQUNBLHlCQUNBLHFDQUVBLHlCQUNBLG9JQUVBLCtCQUVBLHVEQUVBLDhDQUVBLHVFQUNBLFlBQ0EsZ0JBT0EsNkJBQ0EsU0FNQSxnQkFNQSxnQkFTQSw0QkFJQSxzQ0FDQSxzQkFDQSxpREFDQSwyREFDQSwyQ0FDQSxXQUtBLDJCQUNBLHVDQUNBLGVBQ0EsY0FBQyxzQ0F1Q0QsU0FFQSxpQ0FDQSxjQUNBLE9BRUEsc0NBRUEsd0RBQ0EsS0FDQSx1QkFBQywrQkFjRCxTQUVBLGtCQUVBLFNBRUEsYUFFQSxlQUtBLDJDQUNBLGVBQ0EsMkJBQ0EsaUNBQ0EsaUNBQ0EsZ0RBQ0EsNkJBRUEsK0JBRUEsMENBQ0EsV0FDQSxnQkFBQyxjQVFELGlCQUNBLHNCQUNBLHlCQUNBLHVCQUNBLGVBQ0Esc0JBQ0EscUJBQ0EsdUJBSUEsaUJBRUEsaUJBQ0Esa0JBQ0EsOEJBR0EsMkRBTUEsbUJBa0JBLDJDQUNBLFNBS0EsNERBQ0EsYUFDQSx1QkFDQSxrQ0FhQSw2Q0FDQSxFQU1BLGtGQUtBLHNCQUNBLGtGQUNBLHVEQUNBLGtCQUNBLG1FQUNBLElBQ0EsdUlBRUEscUJBQXNCLGdEQUEwRCxrQ0FDaEYsQ0FDQSxpQkFDQSxNQUNBLGtCQUErQixPQUFjLE1BQzdDLEVBQ0EsMkZBQ0EsMEVBQ0EsbUJBQ0EsK0RBQ0Esb0ZBQ0Esb0RBQ0Esa0RBQ0EsU0FDQSxFQUNBLDJFQUNBLDBFQUFvRixpQkFBaUMsZUFDckgsRUFDQSx1RkFDQSwwRUFDQSxvREFDQSxrREFDQSxTQUNBLEVBQ0Esa0dBQ0EsV0FDQSwwQ0FDQSwwQ0FTQSxzQ0FBbUMsMEJBQ25DLGlDQUNBLHlGQUNBLG1FQUNBLGtEQUNBLHdCQUNBLG9CQUFxRCx5QkFBeUIsWUFDOUUsMEJBQ0EsbUVBQ0EseUNBQ0Esc0VBQ0EsYUFDQSw0REFBMEUsT0FBYyxNQUN4RixFQUNBLEVBQ0Esb0ZBQ0EsV0FDQSwyQkFDQSxpQkFDQSwrQkFDQSxPQUNBLDRHQUNBLDhDQUVBLFVBQ0EsSUFDQSxFQUNBLG1GQUNBLFdBQ0EsdUNBQ0EsK0RBR0EsNEVBQ0EsVUFDQSxnQkFDQSxtREFDQSxLQUNBLElBRUEsT0FFQSxLQUVBLEVBQ0EsaUdBQ0EsV0FDQSw4RUFJQSxvRUFDQSw2Q0FDQSx5QkFDQSwyQkFDQSxxQkFBMEIsZ0RBQTBELG9DQUNwRix3QkFDQSxpRkFDQSw2REFFQSxrQkFDQSxNQUNBLGtCQUFtQyxPQUFtQixXQUN0RCxFQUNBLEVBQ0EsOEVBQ0EsV0FDQSxpRUFDQSx3REFDQSx3REFDQSwrQkFDQSx1Q0FBcUQsNkNBQXNELFFBQzNHLEVBQ0EsRUFDQSw4R0FDQSxXQUdBLDBFQUNBLHdDQUNBLHFCQUNBLGlDQUNBLHFCQUFzQixPQUFvQix3Q0FDMUMsaUVBUUEsaUJBQ0Esb0VBQ0EscUJBS0EsaUJBQ0EsZ0NBQ0EsS0FDQSxvQkFDQSwrQ0FDQSxTQUNBLG9CQUVBLDZHQUNBLDJEQUNBLFVBQ0EsZ0JBWkEsTUFhQSxrQkFBK0IsT0FBZ0IsUUFDL0MsRUFDQSxnSEFDQSxXQUNBLGtDQUNBLDhCQUNBLG9EQUNBLDBFQUNBLG1DQUNBLGdFQUF1RSxPQUFlLG1DQUN0RixpRUFRQSxpQkFDQSxvRUFDQSw2Q0FJQSx1QkFEQSxNQUVBLGlCQUNBLFFBQ0EsdURBQ0EsZ0RBQ0EsZUFDQSxFQUNBLGtHQUNBLFdBQ0EscUNBQ0EscUVBQ0EsOENBWUEsMkRBQ0EsNkNBSUEsMENBQ0EsbURBQ0EscUJBQXNCLE9BQW9CLHdDQUMxQyxpRUFDQSxpQkFDQSxnRUFDQSx5QkFXQSw0REFDQSx3QkFKQSxNQUtBLGtCQUErQixnREFBaUUsZUFDaEcsRUFDQSx1RkFDQSxXQUNBLGFBQ0EsWUFFQSw0Q0FDQSw4QkFDQSxpQkFDQSxnQ0FDQSxJQUNBLDJCQUNBLCtDQUNBLG1CQUVBLDZHQUNBLDJEQUNBLFVBQ0EsR0FDQSx1REFBc0UsT0FBZ0IsUUFDdEYsRUFDQSxrRkFDQSxXQUNBLGtIQUNBLDZDQUNBLGtFQUNBLG9FQUNBLElBQ0EsRUFDQSxFQUNBLDZFQUNBLG1DQUNBLFFBQ0Esd0VBQ0EsV0FDQSxxREFDQSxLQUNBLGdDQUlBLHVGQUNBLG9DQUNBLGlDQUNBLGFBQTBCLE9BQW9CLG1DQUM5QyxnQkFDQSxxQkFDQSxPQUlBLG9CQUhBLDZCQUlBLG9DQUVBLEtBQ0Esa0JBQ0EsOENBQ0EsK0VBQ0EsNERBQWlFLFVBQTRCLGlCQUM3RixHQUNBLEVBQ0EsRUFDQSxnRUFDQSxpREFDQSxJQUdBLGlGQUNBLFdBQ0EsZ0NBQ0Esc0JBQ0EsK0JBQ0EsT0FDQSw0Q0FDQSxnQkFDQSxHQUNBLEVBQ0EsRUFDQSxzQkFJQSxrQkFzR0EsZUFDQSx1QkFDQSx5Q0FDQSxxREFDQSxZQUFDLCtCQWlCRCxxQ0FLQSw2Q0FDQSxrQkFDQSw4SEFDQSwrQ0FDQSxpQkFDQSxtREFDQSxpQkFDQSw4QkFDQSxjQUNBLE1BTUEsc0RBQ0EsK0JBQ0EscUJBQ0EsTUFDQSxxREFDQSxvREFDQSxtRUFDQSxRQUNBLDRDQUtBLHFFQUNBLFNBQ0Esa0JBQ0EsNENBRUEsMkNBQ0EsV0FDQSxFQUNBLGlCQWlCQSxrQ0FDQSwyREFDQSx3QkFDQSxrQ0FPQSxvREFDQSxlQUNBLDRFQUNBLFdBQ0Esc0VBQ0Esd0VBQ0EseUVBQStFLGlCQUFpQyxlQUNoSCxFQUNBLEVBQ0Esa0ZBQ0Esa0VBQ0Esa0lBQ0EsYUFDQSxFQUNBLDhFQUNBLG1EQUNBLG9CQUNBLDhIQUNBLFdBQ0Esc0VBQ0EsNkNBQ0EsNEJBQ0EseUZBRUEsb0RBQ0EsbUVBRUEsNERBQ0EsU0FDQSxFQUNBLDRFQUNBLFdBQ0EscUVBQ0EsbUVBQ0EsOEJBQ0EsOENBQ0EseUNBQ0EsU0FDQSxFQUNBLEVBQ0EsK0VBQ0EsdUNBQ0EsVUFDQSwrRUFDQSxXQUNBLHFFQUNBLHlCQUErQixtREFBNkQsU0FDNUYsa0JBQStCLCtCQUE0QyxZQUMzRSwwQkFDQSxzQ0FDQSw0REFDQSxpQ0FDQSxTQUNBLEVBTUEsc0ZBQ0EsV0FDQSxXQUNBLFdBQ0EsdUJBQ0EsZ0NBQ0EsNkNBQ0EsaUNBQ0EsK0NBQ0EsWUFDQSxnREFFQSxZQUNBLGtCQUErQixtQ0FBNkMsU0FDNUUsa0JBQStCLE9BQWMsTUFDN0MsRUFJQSw2REFDQSxXQUNBLHlEQUNBLDZDQUNBLFNBQ0EsVUFDQSxFQUNBLHNFQUNBLHFDQUNBLG9CQUNBLDJFQUNBLDhEQUNBLFNBQ0EsNkVBQ0EsaUVBQ0EsV0FNQSx3RkFDQSxJQUNBLCtDQUNBLHFEQUNBLFNBRUEsOENBQ0EsNkVBQ0EsZUFFQSxZQUNBLE9BQ0EsbUVBQ0Esa0VBQTRFLGlCQUE2QixXQUN6RyxFQUNBLHdFQUNBLFdBSUEsdUJBQ0EsOEVBQ0EsOENBQ0EseUJBQ0EscUJBQXNCLDRCQUFzRCxrREFDNUUseUNBR0EsMkJBQ0EsZ0JBQ0EsY0FFQSxPQUNBLGtCQUErQixPQUFlLE9BQzlDLEVBQ0EsMkVBQ0EsV0FHQSxjQUNBLDZCQUNBLHNDQUNBLHFCQUNBLDREQUNBLCtEQUNBLEtBQ0EsOEJBQ0EsU0FDQSw4RUFDQSxXQUdBLCtCQUNBLHlEQUNBLHFCQUNBLHdDQUNBLHdCQUNBLG1EQUVBLE1BQ0EsRUFDQSxvRkFDQSwrQkFDQSxrREFHQSw4QkFDQSxNQUNBLGlGQUNBLGtEQUdBLG9DQUNBLFlBQ0EsdUJBQ0EsZUFBc0IsYUFBK0IsMEJBQ3JELHVCQUNBLDJCQUNBLHdCQUNBLE9BQ0Esa0JBQStCLE9BQWUsT0FDOUMsRUFDQSw2REFDQSxxQkFDQSx5REFHQSxvQkFDQSw2QkFDQSxhQUNBLHdCQUNBLHFCQUNBLGtCQUNTLDZCQUNULDRCQUlBLEdBQ0EsZUFDQSxnQkFFQSxPQUNBLGtCQUErQixPQUFrQixRQUNqRCxFQUNBLG9GQUNBLFdBQ0EseUJBQ0EsaUJBQ0EsOEJBQ0EsT0FDQSxxQ0FHQSxPQUVBLElBQ0EsRUFDQSxFQUNBLG1CQUdBLDhCQTRDQSwyQ0FDQSx1QkFDQSxnQkFFQSwwRUFDQSxjQUNBLGtGQUVBLCtDQUNBLHVEQUNBLHdEQUNBLDRDQUNBLG1DQUVBLHVCQUNBLDhCQUNBLDREQUNBLDZEQUNBLHdDQUNBLFFBRUEsYUFFQSw4QkFFQSxpRUFDQSxpQ0FDQSwwQ0FDQSx5Q0FDQSxnQ0FDQSxrQkFDQSxjQUNBLHNCQUNBLG1DQUNBLDRCQUNBLCtDQUNBLHdDQUNBLGdDQUNBLDZDQUNBLGVBQ0Esc0JBQ0Esd0NBQ0EsNEJBQ0EsK0NBQ0EsZ0VBQ0EsVUFDQSxLQUVBLFFBRUEsYUFFQSw0QkFDQSxtRUFDQSwrQkFDQSxpRUFDQSxZQUNBLGlFQUNBLDZEQUNBLGtEQUNBLFVBRUEsb0VBQ0EsV0FDQSx3REFDQSwwQ0FDQSxFQUNBLG1GQUNBLG9CQUVBLGlFQUNBLFdBQ0EsZ0RBQ0EsNENBQ0EsRUFDQSwwQ0FDQSxxRUFDQSxVQUlBLDREQUNBLGlCQUNBLG9DQUNBLDZCQUNBLE1BQ0EsR0FDQSxXQUVBLHNFQUNBLGNBQ0EscUNBQXVELDJDQUE0QixPQUNuRixnQ0FDQSwyQ0FFQSxxQkFDQSxLQUVBLDJEQUNBLDJDQUNBLFVBQ0EsNENBQ0EsMERBR0Esc0RBRUEsb0hBQ0EsWUFFQSwwREFDQSxnREFDQSwwQ0FDQSxPQUNBLGlDQUNBLHNEQUNBLGlCQUNBLHNDQUNBLG9FQUdBLHFEQUVBLFVBQ0Esb0RBRUEsNkRBQ0EsbUhBR0Esa0NBR0EsMkhBQ0EsV0FDQSxFQUNBLGVBR0EsMENBdUNBLGtEQUNBLGtCQUNBLHNDQUNBLDBDQUNBLENBQ0Esa0VBQ0EsY0FDQSxhQUNBLDJFQUNBLGdDQUNBLHNDQUNBLHdDQUVBLFdBQ0EsOEJBQ0EsT0FDQSwrRkFFQSxPQUNBLENBQ0EseUVBQ0EsZUFPQSwyQkFDQSxFQUNBLEVBQ0EsY0FFQSxrQkFDQSwyQkFFQSxrQ0FDQSx1Q0FDQSxlQUNBLFFBRUEsbUZBQ0Esb0VBQ0Esa0NBQ0EsWUFDQSxFQUVBLGlFQUNBLFdBQ0EsUUFDQSx1REFFQSxvREFDQSxlQUNBLDJDQUFtRCxpQ0FBaUQsZUFDcEcsa0JBQ0EseUZBQXdHLDBCQUEwQyxlQUNsSixFQUNBLGtCQUErQixlQUF3QixRQUN2RCxFQUtBLHNGQUNBLG1EQUNBLGdCQUtBLGdGQUNBLGtEQUNBLFdBQ0EsRUFDQSxtQkF3QkEscUNBQ0EsQ0FHQSx3Q0FGQSxDQUNBLENBa0JBLGNBTUEsOENBTUEsT0FXQSw2REFDQSwyRUFDQSxzRkFDQSw4REFDQSwrQ0FDQSxxSEFPQSx5RUFFQSw4QkFDQSxzQ0FDQSxnREFDQSxzQkFDQSxLQUNBLCtDQU5BLFFBT0Esb0JBQUMsRUFDRCx1REFJQSxtR0FDQSx3QkFDQSw2QkFDQSxvQkFDQSw2QkFDQSx1QkFDQSxpQkFDQSxrQkFDQSx1QkFFQSxxQkFFQSx1RkFBa0QsZ0JBQTBCLFNBQzVFLHdCQUNBLDRDQUVBLGNBbkNBLGtDQUNBLHVFQUdBLHNGQWdDQSxzREFDQSxrREFDQSxtQ0FDQSxzQ0FDQSwrRkFDQSwyRUFDQSxnQkFDQSwwREFDQSxrQ0FDQSxtQ0FHQSw4REFFQSxrRkFDQSx5REFDQSxrQkFDQSx1RUFHQSxrQkFFQSxrRUFDQSw2R0FDQSx1REFDQSxJQUNBLHlEQUNBLFdBQ0EsV0FDQSxzRkFDQSwyQkFDQSxhQUNBLGFBQ0EsVUFFQSxjQUNBLEVBQ0EsRUFDQSwwSUFDQSx1REFDQSxJQUNBLHlEQUNBLFdBQ0EsV0FDQSxpR0FDQSxrQ0FDQSxhQUNBLGFBQ0EsVUFFQSxjQUNBLEVBQ0EsRUFNQSxpREFDQSxXQUNBLGlDQUNBLGtFQUNBLCtHQUNBLDhCQUNBLGdCQUNBLEVBQ0Esa0JBQStCLGNBQXlDLDBCQUN4RSxrQkFDQSxjQUNBLGdDQUNBLHdGQUNBLGNBQ0EsZ0RBQ0EsRUFDQSxrQkFDQSxxRkFDQSxzRkFDQSxnQ0FDQSwwQ0FFQSxnR0FDQSxxQkFDQSxFQUNBLEVBQ0Esa0JBQ0EsT0FDQSxXQUNBLHlCQUNBLHVDQUNBLHVCQUNBLE9BQ0EsRUFDQSxvRUFDQSxXQUNBLDRFQUNBLHdDQUNBLElBQ0EsRUFDQSx1RkFDQSxXQUNBLDREQUE2RCx3REFDN0QsMkNBQ0EsYUFDQSxnQ0FFQSxnQkFDQSxFQUNBLEVBQVcsRUFDWCw0QkFDQSxVQUNBLDJFQUNBLFdBQ0EsMkJBQ0EscUNBR0EscURBQXFELHdEQUNyRCw2Q0FDQSxXQUNBLFdBQ0EsK0JBRUEsOENBREEsT0FFQSxNQUNBLGdCQUNBLGdCQUVBLElBQ0EsRUFBZSxFQUVmLEdBT0EsbUZBQ0EsV0FDQSw2RUFDQSx1Q0FDQSxXQUNBLG9JQUNBLCtDQUNBLFVBQ0EscUVBQ0EsQ0FDQSxnQkFDQSxvREFDQSxjQUNBLHdCQUVBLEdBRUEsRUFDQSxrQkFBbUMsOEJBQW1DLElBQ3RFLGlDQUNBLHNCQUNBLGlDQUNBLG1DQUNBLGtEQUNBLHlDQUNBLFVBRUEsc0JBQ0EsMkNBRUEsV0FDQSw0Q0FFQSxXQUNBLEVBQ0EsRUFDQSxpRUFDQSxXQUNBLDhCQUNBLHVFQUNBLHVEQUNBLGVBQ0EsRUFDQSxtRUFDQSx1Q0FDQSxzQ0FDQSxTQU1BLCtFQUNBLHVEQUNBLFdBQ0EscUJBQ0EsOERBQ0EsV0FDQSxXQUNBLGVBQ0EsaUZBQ0Esd0NBQ0Esd0JBQ0EsaUdBQ0Esc0VBQ0EsYUFDQSxlQUNBLHdDQUNBLDJEQUNBLDRFQUFrRyxRQUErQyxtQ0FDakosRUFDQSxrQkFFQSw2RUFDQSw0Q0FDQSxTQUNBLEVBQ0Esa0JBS0EsMkRBQWdHLGdDQUEyQyxRQUMzSSw0QkFDQSw0REFBd0csOENBQWtELENBQzFKLHNDQUNBLDhGQUNBLGVBQ0EsQ0FDQSxFQUNBLFNBQ0EsTUFNQSx5REFDQSx3RkFDQSxVQUNBLFlBQ0EsZ0JBRUEsSUFDQSxFQUNBLEVBS0EsMEZBQ0EsV0FDQSwyR0FDQSxjQUNBLHlEQUFtQyxjQUFvRCxxQ0FDdkYsa0JBQW1DLGNBQStELGdEQUNsRyxFQUNBLEVBRUEsK0RBQ0EsdUNBQ0EsUUFRQSw4REFDQSxXQUNBLDhCQUNBLFdBQ0EsMkJBQ0Esa0NBQ0EseUJBQ0EseUVBQ0Esb0VBU0EsZ0NBQ0EsK0NBQ0EsZUFFQSxpREFDQSxvQkFhQSwwRUFFQSxtQ0FDQSxRQUNBLENBQ0Esb0NBR0Esa0NBQ0EsS0FDQSx3Q0FHQSx5SEFDQSwwQ0FDQSx5RUFDQSwrRUFDQSwrRUFDQSxrQkFDQSxrQ0FDQSxnQ0FDQSwrQkFFQSxRQUNBLENBQ0EsUUFDQSxTQUNBLDRCQUNBLEVBQ0EsaUNBQ0EsMEJBQ0EsMkVBRUEsa0NBQ0EsZUFDQSxFQUNBLDhEQUNBLHVEQUNBLFdBQ0EsaURBQ0EsV0FDQSxXQUdBLGVBQ0EsaUJBQ0EseUJBQ0Esc0RBRUEsY0FDQSwrQkFDQSxpSUFDQSw0REFDQSxtQ0FDQSxJQUNBLEVBQ0EsUUFDQSxhQUNBLHFCQUdBLGFBQ0EsOERBRUEsWUFEQSxPQUVBLE1BQ0EsZ0JBQ0EsZ0JBRUEsSUFDQSxFQUNBLEVBS0EsMEZBQ0EsV0FDQSwyQ0FDQSw4Q0FDQSxvREFDQSxTQUNBLEVBQ0EsNERBQ0EsV0FDQSwwRkFDQSw0QkFDQSxLQUNBLGdDQUNBLHlGQUE0Ryx1QkFBZ0MsUUFDNUksRUFDQSxFQUNBLEVBQ0EsaUVBQ0EsZUFDQSxhQUNBLFFBQ0EsRUFDQSxjQUVBLGdGQUNBLDRCQUNBLDJIQUNBLGtCQUNBLHlEQUNBLDRCQUNBLG9FQUNBLFVBQ0Esa0VBQ0EsNEJBQ0EsNkVBQ0EsbUJBQ0EsMEZBQ0EsV0FDQSxvREFHQSw4R0FDQSxPQU1BLG9EQUNBLG1DQUNBLEtBQ0EsMEVBQ0EsYUFDQSxvREFDQSxjQUNBLHdCQUNBLCtDQUVBLG9IQUNBLFFBQ0Esd0JBQ0Esc0VBQTRGLE9BQWUsT0FDM0csRUFHQSxtRUFDQSx1RkFDQSxRQUVBLEVBQ0EsRUFPQSw0RUFDQSxXQUNBLDhCQUNBLHdFQUNBLHlCQUNBLHlFQUNBLG9FQUNBLHNEQUNBLGlDQUNBLDBFQUdBLGtDQUNBLEVBS0EsMEVBQ0Esb0ZBQ0EsOERBQ0EsV0FDQSw2Q0FDQSxpQkFDQSxhQUtBLGdFQVFBLHNDQUNBLHlDQUNBLDBEQUVBLGdFQUNBLEdBRUEsd0VBQ0EsV0FDQSw4QkFDQSx1RUFDQSw0QkFDQSxnQ0FDQSx5REFHQSx5QkFFQSxTQUNBLEVBRUEsNEVBQ0EsY0FDQSxvQkFFQSxZQUdBLGlCQUpBLDJCQUtBLDRGQUlBLG1CQUNBLG1FQUNBLFdBQ0EsS0FDQSxzQkFDQSw2RkFDQSx3Q0FDQSwyQkFDQSxpREFDQSx5Q0FDQSxFQUNBLHlEQUNBLDZDQUVBLDBDQUNBLG1FQUNBLE1BQ0EsbUNBQ0Esd0VBQ0EscUhBQ0EsMERBRUEsS0FXQSxrRUFDQSxXQUNBLEtBQ0EscUZBSUEsT0FDQSwyREFHQSxjQUNBLFVBQ0EsRUFDQSw2Q0FFQSxxQkFDQSxrRUFDQSxNQUNBLGdGQUNBLDBHQUNBLDhDQUVBLEtBTUEsbUVBQ0EsSUFDQSxlQUVBLGlFQURBLHVGQUVBLDRCQUNBLFNBQ0EsU0FFQSxDQUVBLDBEQURBLEtBRUEsQ0FLQSw2REFDQSxJQUNBLCtFQUNBLFNBQ0EsU0FFQSx5Q0FDQSxFQUNBLENBRUEsb0VBQ0EsSUFDQSxtRUFDQSxVQUNBLFNBRUEsQ0FDQSxDQUNBLGdGQUNBLE9BN29CQSwrQ0E4b0JBLFFBS0EscUNBQ0EsT0FDQSxvQkFBQyxtQ0FtQkQsa0NBQ0EsU0FDQSxpREFDQSxLQUNBLG1FQUNBLDhDQUNBLElBQ0EsOERBQ0Esa0RBQ0EsRUFDQSxzRkFDQSx3RUFDQSxVQUNBLGVBQ0EsRUFDQSx1RUFDQSxtQkFDQSxZQUNBLCtEQUNBLDZCQUNBLElBQ0Esa0VBQ0EsNkJBQ0EsSUFDQSx1RkFDQSxhQUNBLEdBQ0EsNkNBQ0EsZ0JBQ0EsMEVBQ0EsNkJBQ0EsSUFPQSw4REFDQSxzQ0FDQSwyQkFHQSx5Q0FFQSxPQUNBLGlGQUNBLFdBQ0EsV0FDQSxlQUNBLFdBQ0EsNkVBQ0EsK0JBQ0EseURBQ0EsS0FDQSxlQUNBLDhFQUNBLGVBQ0EsYUFFQSxFQUNBLGlCQUNBLEVBQ0EsQ0FHQSxTQUNBLDBCQUErQixtQ0FBNkMsU0FDNUUsa0JBQ0EsMERBQ0EsYUFDQSxrQkFBK0IsT0FBYyxNQUM3QyxFQU1BLDRFQUNBLHVCQUNBLHdCQUNBLDJEQUNBLDZDQUNBLDBFQUNBLG9CQUNBLFlBQ0Esb0JBQTZCLE9BQTBCLGtCQUN2RCxFQUNBLHFFQUNBLDRCQUNBLG9CQUVBLDJFQUNBLFFBQ0Esc0VBQ0EsNkJBQ0EsSUFPQSx3RUFDQSwrQkFDQSxpQ0FDQSxRQUNBLGVBQ0EsZUFDQSx3QkFDUyxxQ0FDVCw4QkFDQSxrQ0FDQSxlQUdBLDRDQUNBLCtDQU1BLDJCQUNBLHdCQUtBLGtDQUVBLE9BQ0Esa0JBSUEsK0JBQ0EsK0NBRUEsYUFDQSxFQUNBLEVBQ0Esb0JBQUMsaUNBcUNELCtEQUNBLDBCQUNBLHVDQUNBLGFBT0EsMEVBQ0EsV0FDQSxpQkFDQSxvRUFDQSwyQkFBc0Msa0RBQTZELFFBQ25HLEVBRUEsc0ZBQ0EsNkVBQ0EsMEJBQXFELCtCQUF5QixPQUM5RSx1QkFDQSxtQ0FFQSxXQUNBLElBQ0EsRUFPQSxzRUFDQSxXQUNBLGlCQUNBLHFFQUNBLDRCQUNBLGNBQ0EsV0FDQSxvREFDQSx5RkFFQSxDQUNBLHVEQUVBLDZDQUNBLFNBQ0EsR0FDQSx1REFBMEUsT0FBZ0IsUUFDMUYsRUFDQSxFQUVBLG9GQUNBLHdDQUNBLCtEQUdBLDJEQUVBLE1BQ0EsOEZBRUEsc0ZBQ0EsWUFDQSx3Q0FDQSw4Q0FFQSxXQUNBLE1BQ0EsRUFDQSw4RkFDQSxXQUVBLEtBQ0Esb0JBQ0EsMERBQ0Esa0NBQ0EsZ0JBQ0EsaUZBQ0EsTUFDQSx5Q0FDQSx3Q0FBaUYsMkRBQXVDLFlBQ3hILGlDQUNBLDBCQUFzRCxnQkFBZ0IsWUFDdEUsaUJBQ0EsaUJBRUEsMENBR0EsK0JBQ0EsZ0VBQ0EsNkNBQ0EsNkJBR0EsMkJBRUEsS0FDQSxDQUNBLENBQ0Esa0JBR0EseUNBQ0EsZUFDQSw4QkFFQSxLQUNBLEdBQ0EsT0FDQSxFQUNBLEVBQ0Esa0JBZ0NBLDJCQUNBLHdCQUVBLDJDQUVBLDJEQUNBLGtCQUVBLGlEQUNBLHVCQUNBLFNBRUEsc0RBQ0EsOEJBQ0Esc0NBQ0EsNkNBQ0EsSUFFQSx3REFDQSxXQUNBLCtCQUFxQywrQkFBb0MsR0FDekUsRUFLQSx5REFDQSxxQ0FDQSxJQUNBLDJEQUNBLFdBQ0EsK0JBQXFDLGtDQUF1QyxHQUM1RSxFQUtBLDJEQUNBLFdBQ0EsMEJBQ0EseUNBQ0Esd0NBQ0EsUUFDQSwwRUFDQSxpQkFDQSxtQkFDQSxJQUNBLEdBQ0EsSUFDQSx1REFDQSxXQUNBLHlDQUErQyx3QkFBNkIsSUFDNUUsRUFDQSxnREFDQSxzQ0FDQSxnREFDQSxJQUNBLHFEQUNBLDBCQUNBLHlDQUNBLHdDQUNBLFFBQ0Esd0ZBQ0EsbUJBQ0EsSUFDQSxHQUNBLElBQ0Esa0RBQ0EsOEJBQ0EsNkNBQ0Esa0RBQ0EsSUFDQSxFQUNBLFlBQ0EsMkJBQ0EsMkNBQ0EsVUFDQSx5QkFDQSxlQUVBLHNEQUNBLDhDQUNBLHFEQUNBLGdCQUVBLHFEQUNBLHVEQUNBLHdEQUNBLElBQ0EsRUFDQSxZQWlCQSx5QkFxREEsU0FFQSxvQ0FDQSxrQkFJQSx3Q0FFQSxxQ0FDQSw4QkFDQSx5SEFDQSxxRUFDQSw4Q0FDQSxxREFDQSxxRkFDQSxjQVNBLDREQUNBLFdBQ0EseUZBR0EsSUFDQSx5QkFDQSxvQ0FDQSxzQ0FDQSxtQkFDQSwwRUFHQSw4RUFDQSx5REFDQSxJQUNBLDRCQUNBLHlCQUNBLGlCQUVBLGVBQ0EsbUNBQTJELGlDQUEwQixZQUNyRixvQkFDQSwrQkFDQSwrQkFBMEQseUJBQWdCLE9BQzFFLGlCQUNBLHlDQUVBLElBQ0EsMkJBQTJELGlDQUEwQixZQUNyRixvQkFDQSw2QkFDQSwrQkFBMEQseUJBQWdCLE9BQzFFLGlCQUNBLHlDQUVBLElBR0EsY0FDQSxnQ0FDQSw2Q0FDQSxPQUNBLG1CQUNBLGtDQUNBLDhCQUVBLGNBQ0EsRUFDQSxFQUNBLEVBRUEscURBQ0EsV0FDQSwrRkFDQSw4QkFFQSxNQURBLG1CQUVBLGtEQUNBLHVDQUNBLE9BSUEsNkJBQ0Esb0RBQ0EsS0FDQSxrQ0FDQSxPQUF3QiwrQkFDeEIsaUJBQ0EsRUFDQSxFQUdBLGdFQUNBLFdBQ0EsZ0dBQ0EsY0FDQSxxQ0FDQSw0QkFDQSxPQUNBLDRDQUdBLGlDQUVBLEtBQ0EsRUFDQSxFQWVBLDZEQUNBLFdBQ0EsaUdBQ0EsZ0NBQ0EsNENBQ0EsK0JBQ0EsaUVBQ0EsNEJBQ0EsMERBQ0EsZUFDQSxrQkFBbUMsNkJBQWtDLElBQ3JFLGtCQUFtQyxvREFBeUQsSUFDNUYsa0JBQW1DLDhDQUF5RCxTQUM1RixFQUNBLEVBT0Esb0RBQ0EsV0FDQSw0RkFDQSxJQUNBLDJCQUNBLHNDQUNBLDZCQUNBLDRCQUNBLDJEQUNBLG1EQUNBLE1BQ0Esa0JBQ0Esb0RBQ0EsSUFDQSxrQkFDQSw4Q0FDQSxhQUNBLEVBQ0EsRUFFQSxvREFDQSxXQUNBLDRGQUNBLCtDQUNBLElBQ0EsRUFNQSwrREFDQSxXQUNBLHFHQUNBLG1EQUNBLFlBQ0EsRUFLQSw4REFDQSxXQUNBLHVHQUErRyxzREFBMkQsSUFDMUssRUFTQSw2REFDQSxXQUNBLHlDQUNBLCtHQUNBLGNBQ0Esd0JBQ0Esa0ZBRUEsdUNBQ0EsYUFXQSxzREFDQSwrQ0FDQSxJQUNBLGlEQUNBLCtDQUNBLElBQ0EsdUJBQ0EsMERBQ0EseUJBQ0EsbUVBQ0EsU0FHQSwyQkFDQSxvQ0FDQSxrQkFDQSxtQ0FDQSxhQUNBLHdDQUVBLG9EQUNBLG1FQUNBLDREQUVBLFdBQ0EsRUFDQSxzQkFDQSxzRUFDQSxtQ0FDQSw4RUFNQSxDQUNBLHVEQUNBLG1DQUNBLG1CQUNBLGtCQUNBLHNFQUdBLFdBMVFBLHNIQTRRQSxRQUNBLDJDQUNBLGdGQUVBLEtBS0EsaUNBQ0EsK0RBQ0EsK0JBQ0Esd0NBQ0EscUNBQ0EsNkRBQ0EsZ0RBQ0EsY0FDQSxNQUNBLHFGQUNBLGNBQ0EsaUJBQ0Esb0JBQ0EsbUNBQ0EseUJBQW1DLDZCQUFrQyxJQUNyRSxrQkFDQSw4Q0FDQSxlQUNBLEVBQ0EsRUFZQSw4RUFFQSxJQUNBLG9DQUVBLFlBQ0Esb0NBTUEsb0RBQ0EsOENBQ0Esb0NBQ0EsNEJBTUEsMkNBQ0EsOEJBQ0EsNkJBQ0EsV0FDQSxVQUlBLG1FQUNBLFdBQ0EsOEZBQ0EsbUVBQ0EsZ0ZBQ0EsdUZBQ0EseUVBQ0EsZ0VBQ0EsSUFDQSxFQUNBLEVBQ0EsRUFPQSwrREFDQSxXQUNBLDhGQUNBLE9BQ0Esc0NBRUEsMEVBQ0EsYUFDQSxFQUtBLGlEQUNBLFdBQ0Esb0ZBQ0EsNkNBQ0EsSUFDQSxFQU1BLG9EQUNBLFdBQ0Esc0ZBQ0EsSUFDQSx3QkFDQSw0QkFDQSw0QkFDQSxPQUlBLG1CQUNBLDBCQUdBLHlFQUNBLHVFQUNBLHlEQUNBLFVBRUEsRUFDQSxrQkFDQSw2R0FDQSxtREFDQSxVQUNBLFNBQ0EsRUFDQSxFQU9BLDBFQUNBLFdBQ0EsNkNBQ0EsNkZBQ0EsY0FDQSw0QkFDQSwrQkFDQSwrREFDQSw4QkFDQSxpREFLQSxrRUFDQSxnREFDQSxVQUNBLDBDQVNBLDBEQVJBLGdFQUNBLElBQXFCLGtCQUNyQiw2REFDQSxnQkFHQSxFQUdBLEVBQ0EsRUFLQSxtREFDQSxXQUNBLG9GQUNBLDJEQUNBLE1BQ0EsRUFLQSw0REFDQSxXQUNBLDJGQUNBLHdEQUNBLFNBQ0EsRUFFQSxrREFDQSx5QkFDQSxrQkFFQSwwRUFDQSw2Q0FDQSxRQUVBLGlFQUNBLG9DQUNBLGVBQ0EsMkZBQ0EsV0FDQSx1QkFDQSxvQkFDQSx1Q0FDQSxpREFDQSxjQUNBLDRCQUNBLG9DQUNBLE9BQ0EsMkJBQ0EsU0FDQSxpREFDQSxpQ0FDQSw2REFDQSxrRkFDQSxhQUNBLDRCQVVBLHVCQVRBLGtCQUNBLE1BQ0Esd0JBQ0EsVUFHQSxxQkFJQSxFQUNBLCtCQUNBLG9EQUNBLE1BQ0EsRUFFQSwyREFDQSxXQUNBLG1DQUNBLDJEQUdBLGdGQUNBLGNBQ0EscUNBQ0Esa0NBQWdELGtDQUE2QyxJQUM3RixFQUVBLEVBRUEsdURBQ0EsV0FDQSwrRkFDQSxvREFDQSxJQUNBLEVBUUEseUNBQ0EsV0FDQSxVQWlCQSxrQ0FDQSxnREFDQSx3QkFLQSxxQ0FFQSxvQkFFQSxrQ0FLQSxxQ0FFQSx1RUFDQSxhQUNBLDJEQUNBLG1DQUNBLDhCQUNBLHdGQUNBLG1CQUNBLHVEQUNBLHNHQUNBLHNDQUVBLDJGQUNBLGtEQUNBLDBDQUNBLFFBQ0EscUJBQ0EseUNBQ0EsNkJBQ0EsK0JBQ0EsU0FDQSw2REFDQSx3Q0FDQSxnQkFDQSxvRkFDQSw2QkFDQSwrQkFDQSxTQUNBLCtGQUNBLDZCQUNBLHlEQUNBLG9CQUNBLDBDQUNBLHdEQUNBLGdDQUNBLDJEQUNBLG9EQUNBLG1DQUVBLGdDQUFpRCxrQ0FBeUIsT0FDMUUsMEJBQ0EsMEZBRUEsNENBQ0EsTUFDQSxpRkFDQSwwREFDQSxTQUNBLGdGQUNBLDBDQUNBLDJDQUNBLGlGQUNBLE9BQ0EsOEZBSUEsbUVBR0EsK0JBQ0EsZ0NBQ0EscUdBQ0EsS0FDQSxnRUFDQSxzREFDQSxRQUNBLDJHQUNBLFdBQ0Esd0NBQ0Esd0JBQ0EsNkNBQ0EsNEVBQ0EscUNBQ0EsMEZBQ0EscUNBQ0EsaUVBQ0EsTUFDQSw4QkFDQSxPQUNBLDZHQUNBLFdBQ0Esa0NBQ0Esc0VBQ0Esd0NBQ0Esd0JBQ0EseUdBQ0EscUNBQ0Esd0dBQ0EsZ0JBQ0EsRUFDQSx1REFDQSxnQkFDQSwrRkFHQSxrQkFDQSwrQ0FLQSxZQUNBLGlDQUNBLHVDQUVBLDJEQUdBLGdDQUNBLGdGQUNBLHdCQUNBLCtCQVNBLGtDQUNBLG9FQUlBLHFCQUFTLEVBQ1QsMkRBQ0EsZ0JBQ0Esc0VBQ0EsV0FHQSxZQUNBLDRDQUNBLG1DQUNBLFNBQ0EsMEJBRUEsTUFDQSxHQUNBLE1BQ0EsK0VBQ0EsV0FHQSwwREFDQSxpQ0FDQSw0RUFDQSw0QkFDQSx5RkFDQSw2Q0FDQSw2Q0FDQSwwRUFDQSxJQUFTLGtCQUNULDRCQUNBLFVBQ0EsRUFDQSxtRUFFQSxDQUNBLDZEQUNBLDhCQUNBLHdEQUNBLHNFQUNBLEtBQ0Esa0VBQ0EsT0FDQSwyRUFFQSxrR0FDQSxTQVNBLCtFQUNBLCtCQUNBLDZGQUNBLFFBQ0EsS0FVQSxnRUFDQSxJQUVBLG9DQU1BLDBDQUNBLHVCQUNBLFlBS0EsbUVBQ0EsK0JBQ0EsK0NBQ0EsYUFFQSxtQ0FDQSw2Q0FDQSw2QkFDQSxLQUNBLEVBQ0EsbUJBaUJBLCtCQUNBLHVDQUNBLGtCQUlBLGtEQUFtRCxVQUF3QixhQUUzRSxrREFFQSx5QkFFQSw2QkFLQSxxQkFDQSwrQkFDQSwyQ0FDQSxlQUNBLDREQUNBLHdDQUNBLFlBQ0EsMERBQ0Esa0RBQXNELFVBQXFCLFVBQzNFLHNCQUNBLFNBQ0Esb0VBQ0Esd0NBQ0EsMEJBQ0EsZ0VBQ0Esd0NBQ0Esc0JBQ0Esd0RBQ0Esb0RBQ0EsNkNBQ0Esd0NBQ0EsYUFDQSwySEFDQSxPQUNBLDREQUVBLDREQUNBLG1EQUVBLGdEQUNBLFNBQ0EsOERBQ0Esa0NBQ0Esa0NBQ0EsdUJBQ0EsdUNBRUEsd0NBQ0EsNkRBRUEsZUFDQSx5RUFDQSxrREFDQSx5REFDQSw2QkFDQSxxQkFDQSxTQUNBLDRFQUNBLGlEQUNBLG9EQUNBLDhCQUNBLFNBQ0EsNEVBQ0Esa0NBQ0Esa0ZBQ0EsK0VBQ0EsdURBQ0EsNEJBQ0EscUJBQ0EsU0FDQSwyRkFDQSxXQUNBLFdBQ0EsV0FDQSxzREFDQSwyQkFDQSx1Q0FDQSxpQ0FDQSw2RUFDQSxXQUVBLFFBQ0EsdURBQXNFLE9BQWMsTUFDcEYsRUFDQSxxREFDQSx3Q0FDQSxZQUNBLHFFQUNBLHdDQUNBLHVDQUNBLFVBQ0EsNkRBR0EsYUFDQSx1QkFDQSx3RUFDQSxvQ0FDQSxpREFDQSwyQkFDQSxTQUNBLDhDQUNBLGtEQUNBLEtBRUEsOEJBQ0EsU0FDQSwyRUFDQSx1Q0FDQSxpREFDQSwyQkFDQSxTQUNBLDhDQUNBLHFEQUNBLEtBRUEsOEJBQ0EsU0FDQSxpRkFDQSw4Q0FDQSw2QkFDQSxTQUNBLDhFQUNBLGtEQUNBLDRDQUNBLGFBQ0EsMERBQ0EsK0RBQ0EsS0FDQSxFQUNBLGdCQWdCQSx3Q0FTQSwwQ0FDQSxZQUNBLGdCQUNBLDBDQUNBLDJCQUNBLENBSUEsOEZBQ0Esd0JBQTZDLHFCQUF1QixZQUNwRSxxQkFDQSw0QkFDQSxtQ0FDQSwyREFDQSxJQUNBLG1CQUNBLDZCQUNBLFNBSUEsbUZBQ0EseUJBQ0EsbUJBQ0EsbUNBQ0EsOEJBQ0Esc0NBR0Esa0NBRUEsRUFDQSxnRkFDQSx5QkFDQSx5RUFDQSxLQU9BLHFGQUNBLGlEQUNBLGFBQ0EsMkZBQ0EsaUJBR0Esc0RBQ0Esd0NBQ0EsNEJBQ0EsNkRBQ0EsNENBQ0EsTUFFQSx1REFDQSwwREFFQSxlQUNBLG1DQUNBLFFBQ0EsZ0ZBQ0EsMERBQXFFLFVBQWUsSUFDcEYsRUFDQSxzRUFDQSxXQUNBLGlCQUNBLHVFQUNBLDBCQUNBLGdCQUNBLFlBQ0EsaURBQ0Esb0RBQ0EsV0FDQSwyQkFDQSw0Q0FDQSxZQUNBLGdFQUNBLHdEQUNBLEtBQ0Esd0RBQ0Esd0NBQ0EsS0FDQSxFQUNBLHlCQUlBLHFEQUNBLCtEQUVBLDhCQUNBLHdCQUNBLDBCQUNBLGNBQ0EsS0FDQSwyREFOQSxxRkFPQSxXQUNBLGtCQUNBLHNCQUNBLE9BQ0EscURBQ0EsMENBQ0Esa0ZBQ0Esc0RBQ0EsMkJBQ0EsdUJBQXVCLGtDQUN2QixNQUNBLGtEQUNBLE1BQ0EsMkZBQ0EscURBQ0EsWUFDQSxFQUNBLGdDQUFDLEVBaUJELHdEQU1BLHdEQUNBLFdBQ0EsbUJBUUEsNkJBQ0EsMENBQ0EsUUFDQSxpQkFDQSxtQ0FDQSxnQ0FHQSxxREFFQSxrREFDQSxrQ0FJQSx3Q0FIQSw2Q0FDQSxJQUNBLEVBRUEsNEVBQ0EsMENBQ0EsV0FDQSx3RUFDQSwwQ0FDQSxXQUNBLGlEQUVBLGFBQ0Esb0JBQ0EsU0FDQSw4REFDQSxlQUNBLGFBQ0EsUUFDQSxFQUNBLGNBRUEseUVBQ0EsdURBQ0EsMkNBQ0EsZ0JBQ0EsVUFDQSxFQUNBLEVBQ0Esb0ZBRUEsT0FDQSx5QkFDQSwwREFFQSxDQUNBLDZEQUNBLG9DQUNBLGVBQ0EsNENBQ0EscURBRUEsT0FDQSxLQUNBLHNEQUNBLGFBQ0EsVUFDQSwrREFDQSxhQUNBLG1CQUNBLHVGQUNBLFdBQ0EsV0EzRUEsNENBNEVBLDBEQUNBLHNDQUNBLDRDQUNBLDBCQUNBLGNBQ0EseUNBQ0Esb0JBQW1DLE9BQWUsT0FDbEQsRUFDQSxHQUNBLFdBQ0EsZ0ZBQ0EsMENBQ0EsbUNBQW1DLGtCQUFxQixzQ0FBNEMsSUFBRyxDQUN2RyxHQUNBLEVBQ0EsaUJBS0EsZ0NBQ0EsQ0FJQSx3REFIQSw0QkFDQSxxQkFDQSxDQUVBLGtDQUNBLDBDQUNBLGtCQUNBLFdBQ0EsNEVBQ0EsbUJBQ0EsWUFDQSw4REFDQSxzQ0FDQSx3QkFDQSxTQUNBLGlFQUNBLG1DQUNBLHdCQUNBLFNBQ0EseUVBQ0EsbUNBQ0Esd0JBQ0EsU0FDQSxvRUFDQSxXQUNBLDRCQUNBLHNCQUNBLGdEQUNBLDZCQUNBLDJCQUF5QyxvQ0FBeUMsSUFDbEYsRUFDQSxrQkFBK0Isa0NBQThDLFVBQzdFLEVBQ0EsK0RBQ0EsMkJBQ0EsSUFDQSxvRUFDQSxXQUNBLDRCQUNBLCtGQUNBLCtEQUNBLE9BSUEsaUNBR0Esb0RBSHlFLENBRXpFLEVBRUEsRUFDQSxFQUNBLHFFQUNBLFdBQ0Esa0VBQ0EsQ0FDQSw0Q0FHQSxpQ0FFQSxJQUNBLEVBQ0EsdURBRUEsT0FDQSxFQUNBLDhEQUNBLFdBQ0Esa0NBQ0EsV0FBeUIsMERBQWdFLElBQ3pGLFlBQXlCLHVEQUE2RCxJQUN0RixZQUF5QixrRUFBd0UsS0FFakcsR0FDQSxFQUNBLG1CQUNBLGdDQUNBLG1EQUNBLGtCQUNBLDRCQUNBLGlFQUFtRSxpQkFBdUIsS0FDMUYsaURBQ0EsS0FHQSxtRUFBb0UsQ0FDcEUsK0RBQ0EsMkJBQ0EsU0FDQSwyREFDQSwyREFDQSxFQUNBLDBEQUNBLHdEQUNBLElBQ0EsbUZBQ0EsV0FDQSxnR0FHQSxzRUFDQSxPQUNBLDZCQUtBLFlBRkEsZUFHQSxFQUNBLEVBQ0Esb0VBQ0EsbUJBQ0EsWUFDQSxvRkFDQSxhQUNBLFlBQ0EsNkNBQ0EsZ0JBQ0EsOEVBQ0EsV0FDQSxXQUNBLHlCQUNBLHFFQUNBLGtFQUNBLE9BQ0EsNkJBR0EsV0FJQSxtQ0FFQSxPQUNBLEVBQ0EsMkJBQW1DLE9BQWMsTUFDakQsRUFDQSx1RUFDQSxpREFDQSwwQ0FDQSxTQUNBLGtFQUNBLDRCQUNBLG9CQUVBLG9GQUNBLFFBQ0EsNERBQ0EsaURBQ0EsMENBQ0EsU0FDQSwrREFDQSxpREFDQSwwQ0FDQSxTQUNBLG1FQUNBLGlEQUNBLDBDQUNBLFNBQ0EsNkRBQ0EsdURBQ0EsVUFDQSx3QkFDQSw4QkFFQSxnQ0FDQSxxQ0FFQSx1Q0FDQSxnQ0FHQSwyQkFFQSw2REFDQSxNQUNBLG1FQUNBLFdBQ0Esa0NBQ0EsV0FBeUIsdURBQTZELElBQ3RGLFlBQXlCLGtFQUF3RSxLQUNqRyxZQUF5QiwwREFBZ0UsSUFDekYsWUFDQSxrREFDQSx1RUFDQSxXQUVBLEdBQ0EsRUFDQSxpQkFpQkEsaUNBV0EsU0FJQSxvQkFJQSxNQU1BLFFBS0EsZUFNQSx5QkFDQSxZQUNBLG1CQUNBLDRCQUNBLGtDQUNBLDhCQUNBLDZCQUVBLCtCQUNBLFdBQ0EsT0FRQSxxREFDQSxvQkFDQSxDQUtBLG9EQUNBLHlCQUNBLFVBTUEseURBQ0EsV0FFQSxVQUdBLHlFQUVBLHlEQUVBLHNFQUNBLGNBQ0EsNEJBdkVBLHlEQXdFQSwyQ0FDQSx5REFDQSx3Q0FFQSxvR0FDQSxtQ0FDQSxNQUNBLElBR0EsNEJBQ0Esc0NBQ0EseUNBRUEsd0NBQ0EscUNBRUEsV0FDQSxnREFDQSxDQUNBLDZDQUNBLDJCQUVBLEtBRUEsdURBQ0EsZ0NBQ0EsYUFDQSxFQUNBLGtCQWlCQSxjQW1CQSx5Q0FDQSxnQ0FNQSx3REFNQSxrRUFLQSwrREFLQSw0REFPQSwrREFDQSxTQUFDLGlEQU9ELG9DQXFDQSx1R0FDQSxZQUNBLHVCQUNBLDRCQUNBLG9DQUNBLGtDQUNBLDBDQU1BLHdCQUNBLGlCQUNBLGlCQUNBLCtDQUNBLHNCQWxEQSxJQUZBLE9BNERBLHVEQUNBLDJDQUNBLDZDQUNBLHlDQUNBLE9BS0EsOENBQ0EsMkNBQ0EsSUFRQSw2Q0FDQSwyQ0FDQSxnQkFHQSx3RUFDQSx3QkFDQSxPQU9BLDRDQUNBLHVEQUNBLDZDQUNBLFdBQ0EsV0FDQSwrREFFQSxhQURBLE9BRUEsTUFDQSxnQkFDQSxnQkFFQSxJQUNBLEVBQ0EsRUFTQSxzREFDQSwwQkFDQSxnRkFDQSxxQkFDQSxPQVdBLGdEQUNBLFdBR0Esb0JBQ0EscUZBckdBLGlCQXFHMEcsY0FBcUMsc0JBRS9JLEdBRUEsc0RBQ0EsTUFDQSxtQ0FDQSxJQUVBLDREQUNBLHVEQUNBLDJDQUNBLGFBR0EsNkNBRUEsV0FDQSxFQUNBLEVBQ0EsRUFFQSx1REFDQSxNQUNBLDJCQUNBLHdCQUVBLEtBY0EsZ0VBQ0EsdURBQ0EsNkNBQ0EsV0FDQSxXQUNBLGtDQUNBLHVIQUVBLDREQUNBLCtCQUdBLGNBQ0EsZ0RBRUEscUNBSUEsbUNBQ0Esa0JBQ0EsZ0ZBRUEsNkNBR0EsMENBR0EsK0JBWkEsUUFhQSwwQkFDQSx1QkFDQSxvQkFJQSxpQkFFQSxvQ0FDQSxlQUVBLGFBQ0EsUUFFQSxJQUNBLEVBQ0EsRUFLQSxnREFBdUQsQ0FDdkQsNENBQ0EsV0FDQSx1REFDQSxxRUFDQSxxRUFFQSw0QkFDQSxtRUFLQSxvQkFJQSw4QkFFQSxNQUFTLG9CQUNULCtCQUNBLHNGQUNBLHdDQUNBLFNBQ0EsRUFDQSxFQUNBLHdEQUNBLFdBQ0Esd0RBQ0EsOEdBQ0Esc0NBQ0Esb0NBQ0EsK0JBQ0Esc0hBQ0EseUNBQ0Esb0JBQ0EsUUFDQSxFQUNBLHlDQUNBLCtCQUNBLGdDQUNBLFNBQ0EsRUFDQSxzQ0FDQSwrQkFDQSx3QkFDQSxJQUNBLEVBQ0EsRUFDQSxzREFDQSxXQUNBLHFEQUNBLG9GQUNBLDZDQUFnRCx3REFDaEQsMkNBQ0Esb0dBQ0Esd0NBQ0EsYUFDQSxnQ0FDQSx5Q0FDQSxFQUNBLEVBQVcsRUFDWCxFQUVBLGlFQUNBLGdDQUNBLHlGQUNBLHNCQUtBLDRDQUNBLFNBT0EsZ0ZBQ0EsV0FDQSx3QkFDQSx3Q0FDQSwyQkFDQSxnQkFHQSxzQkFDQSxpRUFFQSxVQUNBLEVBQ0EsQ0FDQSxFQUNBLGdCQVFBLDJDQUNBLGtGQUVBLG1JQUNBLDZCQUNBLFdBQ0EsS0FDQSxpREFMQSxpRUFNQSw0Q0FDQSxNQUNBLHVFQUVBLGNBQ0Esd0RBQ0EscUVBQ0EsaUVBQ0EsU0FPQSw0REFDQSxhQUNBLDBCQUNBLHFEQUNBLHlEQUNBLFdBQ0Esd0JBRUEseUJBQ0EsUUFLQSw2REFDQSxhQUNBLG9DQUNBLHVDQUNBLDBCQUNBLFFBQ0EsRUFDQSxzQkFBQyxFQWtCRCx3REFDQSxpRkFFQSxpSUFDQSw2QkFDQSxpQkFDQSxzQkFDQSxLQUNBLGdEQU5BLGtGQVdBLGVBQ0EsYUFDQSxrQkFDQSxFQUNBLGNBR0Esa0VBQ0EsTUFDQSxrREFDQSxLQUNBLHFEQUNBLE1BQ0Esd0NBRUEsR0FDQSwwREFDQSwyQ0FDQSxNQUNBLG1FQUVBLHVDQUNBLGtGQUNBLGtCQUVBLG9HQUNBLDJDQUNBLG9DQU1BLG1DQUNBLDhGQUNBLG9FQUNBLGdFQUVBLFFBTUEsMkRBQ0Esc0JBQ0EsK0VBR0EsMkNBQ0Esb0NBQ0EsbUNBQ0EsUUFFQSxvRUFDQSxXQUNBLDBCQUNBLDhFQUNBLDRGQUNBLHdEQUdBLGtCQUNBLHVEQUF1RCxvQ0FBOEMsU0FFckcscUJBQ0EsUUFDQSxFQUNBLHFCQUFDLEVBc0JELHNDQUNBLDREQUNBLFlBQ0Esc0JBQ0EsNEJBQ0EsNEJBQ0EsVUFDQSx1RUFDQSw4RkFDQSxTQUNBLGlFQUNBLCtGQUNBLFNBQ0EsZ0RBQ0EsV0FDQSxZQUNBLDBCQUNBLGtEQUFnRCxvQ0FBdUMsRUFFdkYsa0VBQ0EseUVBQ0EsV0FDQSxFQUNBLDJDQUNBLFdBQ0EsWUFDQSwwQkFDQSxnREFBOEMsZ0NBQW1DLEVBRWpGLHNGQUNBLFVBQ0EsbURBQ0EsNENBQ0EsZ0NBQ0EsSUFDQSxjQUNBLG9DQUNBLGtCQUNBLDBEQUNBLGlCQUNBLElBQ0EsR0FDQSxNQUNBLEVBRUEseURBQ0EsV0FDQSxpQkFDQSxZQUNBLCtCQUNBLG1EQUNBLE1BQ0Esd0JBQ0EseUJBQ0EsbUNBRUEsa0JBQ0EsS0FDQSxFQUVBLGtFQUNBLFdBQ0EsaUJBQ0EsWUFDQSwrQkFDQSw0REFDQSxNQUNBLHdCQUNBLHlCQUNBLG1DQUVBLGtCQUNBLEtBQ0EsRUFDQSxFQUNBLFNBcUJBLDBCQUNBLGdDQUNBLGdCQUVBLDRCQUNBLG9DQUNBLFFBQ0EsWUFDQSx5REFDQSxJQUNBLDZCQUNBLHlCQUVBLDhCQUVBLHVDQUdBLG1GQUVBLG9EQUNBLFFBQ0EsMEVBUUEsd0NBTkEsdURBSUEsOENBR0EsNkNBQ0EsV0FDQSxpQkFDQSx5QkFFQSxzQ0FDQSx1Q0FFQSxpR0FDQSxrQ0FDQSwwQ0FDQSw4QkFHQSw2REFFQSxLQUNBLEdBQ0EsSUFDQSxFQUNBLGlEQUNBLFNBQ0EsNERBRUEsMkVBQ0EsVUFLQSxrREFDQSxtQ0FDQSxXQUNBLGlDQUdBLHNCQUVBLElBSUEsMkRBQ0EsbUNBQ0EsaURBRUEsbUVBRUEsNERBRUEsaUNBS0Esc0JBRUEsVUFDQSw4Q0FDQSxtREFDQSxNQUNBLGlEQUNBLDREQUNBLE1BQ0EsNENBQ0Esc0RBR0EsdUVBQ0EsZ0JBQ0EseUNBQ0EsV0FDQSxvQkFFQSw2REFDQSxxQ0FDQSxJQUNBLGFBQ0EsK0RBR0EsT0FDQSxZQUNBLHdCQUhBLDhEQUlBLEVBQ0EsV0F3QkEsZ0JBQ0Esc0JBT0Esb0NBTUEsNENBTUEsNENBQ0EsU0FBQyw2QkFDRCxLQUNBLHNCQUNBLDRCQUNBLG9EQUNBLHVFQUNBLG1CQUFDLHlDQWlCRCxtQ0FXQSwwQkFZQSxvQ0FDQSwyREFDQSxpQkFDQSxtQ0FFQSwwQ0FNQSxpQ0FNQSx3QkFNQSxVQUNBLDRCQVFBLHNFQUNBLFdBQ0EsS0FDQSxnRUFDQSw2Q0FDQSxtS0FDQSwrQkFDQSw4Q0FDQSw0S0FDQSxJQUNBLDhDQUlBLGlCQUNBLFNBRUEsR0FPQSwwRUFDQSwwQkFDQSx5Q0FHQSw2Q0FDQSxxRUFHQSx3Q0FDQSxnREFDQSxpQ0FDQSwrR0FDQSwyQ0FDQSw4Q0FHQSxVQVFBLHFEQUNBLE1BQ0EsaURBQ0EseUJBR0EsY0FFQSxtREFDQSxTQUNBLGlFQUNBLGlCQUNBLG1CQUNBLGlDQUVBLFVBQ0EsbUZBQ0EsaUVBQ0EsS0FDQSxxRUFDQSx5RUFDQSxxRUFDQSxpQ0FDQSxjQUdBLG9DQTVIQSxxQkE4SEEsUUFDQSwrREFDQSxDQUNBLHFEQUNBLCtCQUVBLEtBQ0EsRUFDQSxrQkFpQkEsY0FFQSxvQ0FxQkEsU0FJQSxhQUVBLG1EQUNBLGlCQUNBLDBCQWtCQSw2QkFVQSxzQkFDQSw4QkFLQSxVQUNBLHVCQUNBLHVFQUVBLDZFQUNBLG9DQUNBLDJDQUNBLGtEQUVBLGlFQUNBLG9DQUNBLDJDQUNBLDZEQUNBLGtEQUVBLE9BS0EsOENBQ0EsYUFDQSxlQUVBLGdEQUNBLHVEQUNBLElBQ0EsZ0RBQ0EsV0FDQSxXQUNBLGVBQ0EsNENBQ0EsWUFDQSwrQkFDQSwyQkFDQSxnQ0FDQSxZQUNBLDhCQUdBLDJEQUdBLGlCQUNBLHlCQUVBLE1BQ0EsZ0JBQ0EsZ0JBRUEsSUFDQSxFQUNBLEVBS0EsaURBQ0EsdURBQ0EsNkNBQ0EsV0FDQSxXQUNBLGVBQ0EsMEJBQ0EsOEJBQ0EsYUFFQSwrQ0FDQSxVQUVBLElBQ0EsRUFDQSxFQUNBLHlEQUNBLHVEQUNBLDZDQUNBLFdBQ0Esd0NBQ0EsWUFDQSxhQUNBLDJCQUNBLFlBQ0EsYUFDQSxPQUNBLHNHQUNBLHNDQUVBLFNBQ0EsMkJBRUEsSUFDQSxFQUNBLEVBQ0EsMkNBQ0EsdURBQ0EsNkNBQ0EsV0FDQSxXQUNBLDBCQUNBLG1DQUNBLDBCQUNBLDhCQUNBLGFBR0EsK0NBQ0EsVUFFQSxJQUNBLEVBQ0EsRUFFQSxrREFDQSx5REFFQSxpRkFDQSxlQUVBLDhCQUVBLG9DQUNBLGdDQUVBLFVBRUEsbURBQ0EsOENBQ0EseUVBQ0EsMkJBQ0Esa0NBRUEsdUJBQ0Esa0NBQ0EsMEJBRUEsZ0JBSUEseURBR0EsU0FFQSxnRUFDQSxzQ0FDQSxJQUVBLGlFQUNBLCtDQUNBLFNBS0EsNERBQ0EsaUVBQ0EsaUNBQ0EsVUFNQSw2REFDQSx1REFDQSxtQ0FDQSxTQUNBLG1EQUNBLHNDQUNBLDBIQUNBLHVCQUNBLGdDQUNBLHdCQUtBLHlEQUNBLGFBQ0EsbUNBQ0EsMkJBQ0EsY0FDQSxnREFDQSw2QkFDQSxjQUNBLDBEQUNBLDRCQUNBLElBQ0Esb0RBQ0EsdURBQ0EsV0FDQSwrQ0FDQSxxRUFDQSx3QkFDQSxVQUNBLElBQ0EsRUFDQSxFQUNBLEVBQ0EsNkRBQ0EsdURBQ0EsMkNBQ0EsT0FHQSwwREFFQSxnRUFFQSwrQkFDQSwyRUFDQSxlQU1BLDREQUVBLFVBQ0EsRUFDQSxFQUNBLEVBQ0EsaUZBQ0EsdURBQ0EsSUFDQSx1RUFDQSxXQUNBLFdBRUEsa0RBQ0EsOEJBQ0EsK0RBQ0EscUJBR0EsaUNBRUEscUNBQ0EscUVBRUEsbUNBQ0Esd0VBR0EsOERBQ0EsNkdBRUEsOERBQ0Esc0JBQ0EscUNBQ0EsdUNBQ0EsMEZBSUEscUJBREEsT0FJQSxNQUNBLGdCQUNBLGdCQUVBLElBQ0EsRUFDQSxFQU1BLG9FQUNBLFdBQ0EsMERBQ0EsK0dBR0EseUZBQ0EsZ0NBQ0EsbUNBRUEsVUFDQSx5REFDQSxvQkFDQSw0QkFHQSxrQkFDQSxDQUdBLDBEQUNBLG1DQUNBLGFBTUEsd0RBQ0EsYUFJQSw2Q0FLQSxxSEFDQSx1Q0FDQSxrQkFFQSxvQ0FDQSxZQUVBLCtEQUNBLFdBQ0EsZ0NBQ0Esa0VBQ0EsMkJBQ0EsaUVBQ0EsMENBQTBELHdEQUMxRCwyQ0FFQSxvQ0FDQSxxQ0FDQSxrREFDQSxtREFFQSxhQUNBLEVBQ0EsRUFBZSxFQUNmLEVBQ0EsR0FDQSxZQVNBLG9EQUNBLHVEQUNBLDBCQUNBLGtEQUNBLFdBQ0EsV0FDQSw2REFFQSw0RUFDQSxRQUNBLHFEQUNBLDJCQUpBLE9BS0EsbUJBQ0Esd0JBQ0EsSUFDQSxnREFFQSxjQUNBLFFBQ0Esa0NBQ0EsZUFDQSx5QkFDQSxNQUNBLGdCQUNBLE1BQ0EsZUFDQSwrQkFFQSxvQkFFQSxJQUNBLEVBQ0EsRUFLQSx3REFDQSxpREFDQSxPQTNhQSxFQTZhQSxvREFDQSwyQkFDQSxNQUtBLDBEQUNBLHFDQUNBLDJFQUNBLG1EQUNBLHlEQUVBLFVBQ0EseURBQ0EsYUFDQSxtQ0FDQSxhQUNBLDJCQUNBLG1EQUNBLHNDQUNBLHNGQUNBLE9BQ0Esb0RBQ0EsdURBQ0EsMkNBQ0EseUJBQ0Esa0JBQ0EsRUFDQSxFQUNBLEVBQ0EsMkRBQ0EsV0FFQSxpQkFDQSwrQ0FDQSxnQ0FFQSx1QkFBc0QsMEJBQWdCLE9BQ3RFLGNBQ0EsMkNBRUEsVUFDQSxzQkFBbUMsdUNBQTRDLElBQy9FLEVBU0EsOERBQ0EsNEJBQ0EscUJBR0EsNkNBRUEsSUFDQSx3RUFDQSxXQUdBLHdDQUNBLG9FQUNBLHNGQUNBLHFGQUdBLGNBQ0EsbUJBQ0EsRUFDQSw2REFDQSx1REFDQSxXQUNBLEtBQ0Esd0RBQ0EsT0FHQSwwREFJQSxxRUFDQSwrQ0FDQSxrQ0FFQSx3Q0FNQSxvQ0FFQSwwQ0FHQSxPQUNBLGdDQUVBLGtCQUVBLE1BQ0EsRUFDQSxFQUNBLEVBQ0EsK0RBQ0EsdURBQ0EsV0FDQSwrQ0FHQSw4REFDQSx5QkFBbUYsMEZBQ25GLGtEQUNBLDBCQUNBLDhCQUNBLHNDQUFtRCx1Q0FBNEMsSUFNL0YsTUFDQSxFQUNBLEVBQ0EsRUFDQSwyREFDQSx1REFDQSxXQUNBLEtBQ0EsZ0RBQ0Esa0NBQ0EsZ0NBSUEseUJBQ0EseUJBQ0EsMkNBQ0EseUJBR0EsY0FDQSxtQkFLQSxNQUNBLEVBQ0EsRUFDQSxFQUNBLG9EQUNBLDZCQUNBLFVBQ0EseURBQ0EsdURBQ0EsNkNBQ0EsV0FDQSxXQUNBLGdEQUtBLDBEQUNBLDBCQUNBLDhCQUhBLE9BSUEsYUFDQSwrQ0FDQSxpQkFDQSxxQkFDQSxNQUNBLGdCQUNBLGdCQUVBLElBQ0EsRUFDQSxFQUlBLDZEQUNBLHVEQUNBLDZDQUNBLFdBQ0EsV0FDQSx5QkFDQSxpREFFQSxvQkFEQSxPQUVBLGFBQ0EsVUFDQSxPQUNBLHVCQUNBLFdBQ0EsOEJBQ0EsTUFDQSwrQ0FDQSxrQkFDQSxnQkFFQSxJQUNBLEVBQ0EsRUFDQSxFQUNBLFdBcUJBLGlDQUNBLENBSUEsb0NBSEEsZ0JBQ0EsRUFDQSxDQU9BLDJCQUNBLGtDQUNBLGlCQUNBLGlEQUNBLFVBQ0EsYUFDQSxnQ0FDQSxrQ0FDQSxLQUNBLHdEQUNBLG9CQUNBLE1BQ0EsMENBQ0EsYUFDQSxhQUNBLDRCQUNBLDJDQUVBLHFDQUNBLCtDQUNBLHVCQUNBLDRDQUNBLFVBQ0EsaUVBQ0EsMkJBQ0EsU0FDQSxRQUdBLDZCQUVBLFNBQ0Esb0RBQ0EsdURBQ0EsZ0NBQ0EsNENBQ0EsdUJBQ0EsTUFDQSx5Q0FDQSxPQUNBLDBDQUNBLFVBQ0Esb0NBQ0EsY0FHQSxpQ0FDQSxnQ0FDQSxtQ0FFQSxVQUNBLEVBQ0EsRUFDQSxFQUNBLDBEQUNBLDBCQUFpRCx5QkFBeUIsWUFDMUUsMEJBQ0EsbUJBQ0EsaUNBQ0Esb0JBQ0EsMkJBQTBELHlCQUFnQixPQUMxRSxpQkFDQSw0QkFFQSw2QkFDQSxRQUNBLENBQ0EsQ0FDQSwyREFDQSxnQ0FDQSxVQUNBLG9DQUFzRCx5QkFBZ0IsT0FDdEUsaUJBQ0EscUJBS0EsMkJBQ0EsTUFDQSxrRUFDQSxrQkFDQSxzREFDQSwyQkFBc0QseUJBQWdCLE9BQ3RFLGlCQUNBLG9DQUVBLFlBQ0EsRUFDQSxFQUNBLFlBT0EsNEJBQ0Esb0RBQ0EsWUFDQSx5QkFLQSxtQkFDQSxtREFDQSw4QkFDQSxFQUNBLDZEQUNBLDJEQUNBLCtFQUVBLG9CQUNBLGdCQUFrRCwyQkFBZ0IsT0FDbEUsa0JBQ0EsZ0NBQ0EsMEJBR0EsbUhBRUEsb0JBQ0EsTUFDQSx5Q0FLQSwrQkFFQSw2Q0FOQSxxQ0FHQSxnQkFJQSxJQUNBLGlEQUNBLDBCQUNBLE1BQ0Esc0VBQ0Esa0JBQ0EsaUJBQ0EsWUFDQSwyREFDQSwwQ0FFQSxLQUNBLDRFQUNBLG9DQUVBLDhFQUNBLFVBSUEsbURBR0EsbURBQ0EsbUNBSUEsd0dBQ0EsT0FDQSx5REFLQSxJQUNBLHlCQUVBLGtGQUNBLCtDQUNBLDRDQU1BLHNCQUNBLDBEQUNBLGlDQUNBLG9JQUNBLGdCQUNBLDhDQUNBLEtBQ0EsRUFDQSxhQXNCQSwrQkFDQSwwREFDQSxlQUNBLHdCQUNBLDJCQUNBLFdBQ0EscUVBQ0EsbUJBQ0EsNkJBQ0Esc0NBQXNELDJCQUFnQixPQUN0RSx5QkFDQSxjQUNBLHNCQUNBLDRDQUNBLEtBQ0Esc0JBQ0Esa0RBQ0EsS0FDQSxNQUlBLHdEQUNBLFlBQ0EsRUFDQSxnQkFpQkEsaUNBQ0EsQ0FJQSx1Q0FIQSxVQUNBLEdBQ0EsQ0FFQSxtQ0FDQSxDQUlBLHlDQUhBLFVBQ0EsR0FDQSxDQU9BLG1CQUNBLGVBRUEsdUJBQ0EsWUFDQSw0QkFDQSxnQ0FPQSxVQUVBLCtCQUVBLGtDQUNBLDJFQUNBLE9BQ0EsK0RBS0EsZUFDQSxhQUNBLGdCQUNBLEVBQ0EsY0FZQSx1RkFDQSxXQUNBLGVBQ0EsZ0NBQ0EsYUFDQSxrQ0FDQSxnQ0FDQSxpQkFDQSwyQkFDQSxnQ0FDQSxpQkFDQSwyQkFDQSxlQVVBLHNGQUNBLHFCQUNBLE9BQ0EsNkRBQ0EsK0JBQ0Esd0RBQ0EsS0FDQSx3Q0FDQSwrQ0FDQSxJQUNBLGNBQ0EsK0NBRUEsc0NBQ0EscUNBRUEsaUNBQ0EsZ0JBR0EsNkRBRUEsdUJBRUEsbUNBQ0EsMENBQ0EsTUFDQSxzQ0FnQkEsNENBQXFDLDhCQUNyQyxTQUVBLDREQWxCQSwwQkFDQSxpQkFDQSxhQUVBLFNBQ0EsaUJBQ0EsZ0JBSUEscURBSUEsZ0JBS0EsY0FDQSx3QkFBaUMsMkJBQ2pDLFNBRUEsMkJBQ0EseUJBQWlDLDZCQUNqQyxTQUNBLGlCQUlBLGlCQUdBLGlCQUNBLGdCQUNBLDBDQUNBLHVCQUNBLDZDQUdBLDJCQUlBLDRDQUNBLDBDQUdBLE1BQ0EsY0FDQSxzREFDQSwyQkFDQSxtREFDQSxpREFDQSxxQkFBaUMsNkJBQ2pDLFFBRUEsOENBQ0Esa0VBQ0EsYUFDQSx5QkFDQSxzQkFDQSx3QkFFQSxlQUNBLG9FQVFBLGVBQ0EsMEJBQ0EsK0JBQ0EsaUJBWUEsb0ZBQ0EsV0FDQSxvQ0FDQSw0REFDQSx3Q0FDQSx3Q0FFQSw2Q0FDQSx5Q0FDQSxxQ0FDQSwyQ0FDQSxJQUNBLDBCQUNBLCtCQUNBLDBCQUNBLHVCQUNBLDZDQUNBLHVEQUNBLDJDQUNBLDRCQUNBLGtDQUVBLHVCQUFvQixjQUdwQixnSkFFQSwyQkFDQSxVQUNBLGtCQUdBLGFBS0EsNkRBQ0EsZ0RBS0EsY0FDQSw2QkFDQSxrQkFDQSx5QkFDQSxvQ0FDQSxZQU1BLHFCQUFvQixjQUVwQixHQUlBLDhDQUVBLGtDQUlBLDZCQU9BLGlDQUtBLGlCQUtBLHlEQUNBLFdBQ0EsS0FDQSxnRUFBZ0UsMERBQW1FLElBQ25JLHVEQUNBLHdFQUNBLHNCQUNBLHNEQUFrRSw2REFBc0UsSUFDeEksNkJBRUEsUUFDQSxnREFDQSxXQUVBLGNBQ0EsY0FJQSw4QkFDQSxtQ0FDQSx1REFDQSwyQkFDQSx5REFFQSxLQUVBLGVBQ0EsaURBQ0EsMEJBQ0EsNENBRUEsS0FDQSw0Q0FDQSx1QkFDQSwwQ0FFQSxLQUNBLEdBQ0EsT0FxQkEsNkVBQ0EsdUJBQ0EsK0JBQ0EsdURBQ0Esb0NBQ0EsY0FPQSxrREFDQSxrSEFDQSxNQUNBLEVBQ0EsSUFBQyxjQTBDRCxpQ0FDQSxDQXNCQSxlQWxCQSxXQUtBLE1BT0EsY0FDQSxZQUNBLG9CQUNBLG1CQUNBLElBQ0EsQ0FHQSw4QkFDQSxDQUlBLG9DQUhBLFVBQ0EsR0FDQSxDQWdCQSx5QkFDQSxnQ0FFQSwwQ0FDQSxpQkFDQSw0QkFDQSxtQ0FDQSxtQ0FDQSxvQ0FDQSxxREFDQSxVQUNBLGFBQ0EsMkJBQ0Esb0RBQ0EsMENBQ0EsNkJBRUEseUNBQ0EsaURBSUEscUJBQ0EsOENBQ0EsT0FDQSxxRUFFQSxlQUNBLGlCQUNBLFNBQ0EsRUFDQSxjQUdBLDZFQUNBLGtDQUNBLDRFQUNBLGdFQUNBLGtCQU1BLDZDQUNBLHVEQUNBLCtDQUNBLHFEQUNBLFdBQ0EsV0FDQSxnQ0FDQSxpREFDQSxzQkFPQSx1QkFDQSxvREFDQSxzQ0FDQSw0QkFDQSxrREFDQSxZQUNBLHVCQUNBLHFFQUNBLDZCQUNBLDREQUNBLDJCQUNBLG1CQUNBLFlBQ0EsbUNBRUEsb0JBQ0EsTUFDQSxpREFDQSxrQkFFQSxXQUNBLEVBQ0EsRUFLQSxtRkFDQSxXQUNBLHFCQUNBLG9FQUNBLGNBQ0Esd0NBQ0EsbUNBQ0EseUJBQ0Esa0RBRUEscUpBQ0Esc0NBQ0Esb0NBQ0EsbUVBQ0EsNEZBQ0EsNkdBQ0EsK0NBQ0EsbURBQ0EsZ0JBQ0EsUUFDQSxFQUNBLEVBTUEsNEVBQ0EsV0FDQSw2RUFDQSxjQUNBLHdDQUNBLG1DQUE2Qyx3REFDN0MsSUFDQSx3REFDQSx1RUFDQSxpQkFDQSxvRUFFQSxpQkFDQSxhQUNBLEVBQWUsRUFDZixFQUNBLEVBRUEsK0NBQ0EsdURBQ0EsV0FDQSxlQUNBLGdFQUNBLFdBQ0EsV0FDQSxnQ0FDQSxtREFDQSxtRUFDQSwyQkFHQSw0REFDQSxtRkFDQSxpQ0FDQSxXQUNBLHdCQUNBLHlCQUNBLG1EQUNBLCtDQUNBLHNDQUNBLFVBQ0Esc0JBQXVELHVDQUE0QyxJQUNuRyxTQUNBLE1BQ0EsZ0JBQ0Esa0JBQ0EsT0FDQSxxQ0FDQSwyQ0FFQSxlQUNBLE1BQ0EsZ0JBQ0EsZ0JBRUEsSUFDQSxFQUNBLEVBV0EseURBQ0EsV0FDQSxrQ0FDQSxnQkFDQSxzQkFDQSw0QkFDQSwwREFDQSxrREFDQSwyREFDQSxRQUNBLGtCQUNBLDBCQUNBLG1CQUNBLEVBRUEsaUVBQ0EsT0FDQSxTQWtCQSxzRUFDQSxXQUNBLFNBQWlDLHVCQUNqQyxxQkFDQSxvRkFDQSxxQ0FDQSxJQUNBLGdDQUNBLHNDQUNBLDBCQUNBLG1CQUNBLGtDQUdBLHFEQUNBLEdBQ0Esd0JBSEEsOENBSUEsU0FDQSxxREFDQSxHQUNBLENBQ0EseUJBQ0EsT0FDQSxhQUNBLHdCQUNBLE9BQ0EsT0FDQSwyQkFDQSxPQUNBLDRCQUdBLHNEQUNBLEVBQ0EsRUFDQSxFQUNBLDZEQUNBLFdBQ0Esa0NBQ0EsMkJBQ0EsNEJBQ0EsbUNBRUEseUVBQ0Esb0RBQ0EsVUFHQSx3REFDQSxvQ0FDQSxtQ0FDQSxLQUNBLG1FQUNBLG1EQUVBLG9CQUNBLDhFQUVBLDBEQUNBLCtFQUNBLDBFQU1BLHFCQUNBLGlEQUNBLFlBQ0Esc0JBQW1DLHVDQUE0QyxJQUMvRSxFQUtBLDBFQUtBLCtDQUNBLDJFQUNBLHdCQUNBLDJEQUNBLHNEQUNBLHVEQUNBLDZEQUNBLDZDQUVBLFNBQ0EsK0NBQ0EsbURBQ0EscUNBQ0EsaUJBQ0EsaURBRUEsWUFDQSxDQUNBLDBEQUNBLHVEQUNBLFdBQ0EsNkVBQ0Esd0RBQ0EsV0FDQSxXQUNBLGdDQUVBLCtFQUNBLG1EQUNBLG9EQUNBLGtCQUdBLHlEQUNBLCtDQUNBLG9EQUNBLG9HQUNBLDhEQUNBLGtEQUNBLElBQ0Esc0RBQ0EsaURBQ0EsZUFDQSw4Q0FDQSxvREFDQSxrQkFDQSxvQ0FDQSx5QkFBbUQsb0NBQWlELFlBQ3BHLHNCQUF1RCx1Q0FBNEMsSUFDbkcsUUFDQSxNQUNBLDhEQUNBLGNBQ0EsZ0JBRUEsSUFDQSxFQUNBLEVBRUEsNEVBQ0EsdURBQ0EsSUFDQSx1REFDQSxXQUNBLFdBQ0EsZ0NBQ0EsZ0VBQ0EsY0FDQSx1QkFDQSxPQVFBLDBFQUNBLFVBRUEsK0NBS0Esd0JBREEsT0FLQSxhQUNBLFVBQ0EsT0FDQSxnQ0FHQSw0RUFDQSx3REFHQSxzQ0FFQSxxQkFDQSx1REFDQSxnQkFDQSxhQUNBLFFBRUEsSUFDQSxFQUNBLEVBQ0EseUVBQ0EsV0FDQSwyQkFDQSxnRUFLQSxnREFDQSxXQUNBLDRCQUNBLDJDQUNBLDREQUNBLHNEQUNBLFFBQ0Esc0JBQW1DLHVDQUE0QyxJQUMvRSxFQUNBLG1FQUNBLFdBQ0Esa0NBS0Esd0RBQ0EsZUFDQSx1QkFDQSwrQkFDQSx1RUFDQSxnREFDQSxRQUNBLHNCQUFtQyx1Q0FBNEMsSUFDL0UsRUFDQSxxRUFDQSw4REFDQSxTQUNBLDBDQUVBLCtEQUNBLCtEQUNBLFlBS0EscUVBQ0EsOERBR0EseUJBQ0EsK0JBQ0EsU0FDQSxrREFDQSw4Q0FDQSx5QkFHQSxtQkFFQSwyQ0FFQSwrREFDQSxZQUNBLENBQ0EsZ0VBQ0EsV0FDQSxnRUFDQSxrREFDQSxnREFDQSx5QkFDQSxnRUFDQSxpRUFDQSw4Q0FDQSxzREFDQSxVQUVBLHNDQUVBLFNBQ0EsRUFDQSxDQUNBLHNEQUdBLDhDQUNBLEtBSUEsaURBQ0Esb0VBQ0EsMENBQ0EsZUFDQSwwRUFDQSw2QkFBdUQsMkNBQTRCLE9BQ25GLG1DQUNBLDBCQUNBLHdFQUNBLGdDQUVBLGlFQUNBLDZEQUNBLDREQUNBLDBFQUNBLEtBRUEsaURBRUEsSUFFQSxtREFHQSxhQUNBLDZEQUNBLHFCQUNBLHdDQUNBLDJDQUNBLG1EQUNBLDhCQUNBLHVFQUNBLDJHQUNBLG1FQUNBLGNBQ0EsQ0FFQSxrREFDQSxhQUNBLGlCQUNBLG9GQUNBLHVEQUNBLFdBQ0EsbUNBQ0EsNkRBQ0EsV0FDQSxXQUNBLG1CQUNBLHdCQUNBLG9CQUNBLHVEQUNBLCtCQUNBLHlCQUNBLHFEQUNBLCtCQUNBLDhFQU1BLDhDQUNBLGVBQ0EsR0FIQSxjQUlBLGdDQUNBLG1FQUNBLGlEQUNBLG9DQUNBLHlFQUNBLGtDQUNBLE9BQ0EsbUhBRUEsb0NBQ0EscUZBQ0Esb0NBQ0EsV0FDQSxDQUNBLEdBQ0Esa0JBQ0EsdUJBQ0EsYUFDQSw2Q0FDQSxvREFDQSwyQkFDQSxhQUNBLFFBRUEsSUFDQSxFQUNBLEVBV0EsNkRBQ0EsdURBQ0EsMkNBQ0EsNEJBQ0EscUJBR0EsNkNBRUEsWUFDQSxFQUNBLEVBQ0EsRUFDQSx3REFDQSxnRUFDQSwrQkFDQSw0REFDQSx1REFDQSxpQkFDQSxtREFDQSxXQUNBLFdBQ0EsZ0RBQ0EsdUJBQ0EscURBRUEsVUFEQSxPQUVBLG9CQUVBLGtGQUNBLDhEQUNBLHdCQUNBLE1BQ0EsZ0JBQ0EsbUNBQ0EsOEJBQ0EsYUFDQSxRQUVBLElBQ0EsRUFDQSxFQUVBLDREQUNBLHVEQUNBLFdBQ0EsOEVBQ0EsZ0RBQ0EsV0FDQSxXQUNBLGdEQUNBLFNBQ0EsaUNBQ0EsNEJBQ0EsYUFDQSw0Q0FDQSx3RkFDQSxnQkFDQSx3QkFDQSw0QkFBcUUsaUNBQTZCLE9BQ2xHLCtCQUNBLDRCQUVBLG9CQUNBLE9BQ0EsZ0RBQ0EsU0FDQSw2QkFDQSxlQUNBLDRFQUNBLDRDQUNBLCtCQUdBLGlDQUE0RCxpQ0FBd0MsTUFFcEcsd0NBQ0EsU0FDQSxNQUNBLFVBQ0EsYUFDQSxzREFDQSxzQkFDQSxhQUNBLFlBQ0EsMENBQ0EsMkJBQ0EsTUFDQSxnQkFDQSxnQkFFQSxJQUNBLEVBQ0EsRUFFQSxxREFDQSxXQUNBLG1FQUNBLDRCQUNBLFNBQ0EsMEJBQ0Esb0RBQ0Esb0RBQ0EsV0FPQSwrRUFDQSxlQUNBLGVBQ0Esd0JBQ0Esb0JBQ0EsNkJBQ0Esb0JBQW9DLHdEQUNwQyxvQ0FDQSxrREFDQSxXQUNBLFdBQ0EsNENBQ0EsOERBT0EsY0FGQSxPQU9BLGFBQ0Esa0RBQ0EsWUFDQSx1QkFDQSxpREFDQSxnQkFDQSx3QkFDQSxrQkFDQSwyQ0FFQSxhQUNBLE9BQ0EscUNBQ0Esa0hBQ0EsZUFDQSxtQkFDQSx3REFDQSwrQ0FDQSxZQUNBLHVCQUNBLGdEQUVBLG1CQUNBLE1BQ0EsZ0JBQ0EsTUFDQSw2QkFDQSxZQUVBLElBQ0EsRUFBZSxFQUNmLEVBQ0EsaUJBQTZDLDhCQUF1QixPQUNwRSx3QkFDQSxZQUVBLGtDQUNBLCtDQUNBLGtCQUNBLGFBQ0EsRUFFQSxrREFDQSx3QkFDQSxrQkFFQSx5RUFDQSx1REFDQSxXQUNBLFFBQ0Esc0RBQ0EsV0FDQSxXQUNBLGVBR0EsMkJBQ0Esa0RBRUEsMENBRUEsa0JBQ0EsTUFDQSx5QkFDQSxzQkFFQSxNQUNBLE9BUEEsT0FTQSwwRUFBbUgsd0RBQ25ILElBQ0Esb0VBQ0EsV0FDQSxXQUNBLG1HQUNBLG1FQUNBLDZCQUNBLGFBQ0EsUUFFQSxJQUNBLEVBQW1DLEVBQUUsZUFBa0Isd0RBQ3ZELElBQ0EsNkRBQ0EsV0FDQSxXQUNBLDZEQUVBLHlEQUNBLDZCQUNBLE9BQ0Esa0RBQ0Esc0JBTEEsT0FNQSxhQUNBLFVBQ0EsZUFDQSxtQkFFQSxJQUNBLEVBQW1DLEVBRW5DLGFBQ0EsTUFDQSw0Q0FDQSxxQ0FDQSxxREFFQSxlQUNBLGFBQ0EsNERBQ0EsYUFDQSxPQUNBLG9DQUNBLGdCQUNBLGdCQUVBLElBQ0EsRUFDQSxFQUVBLHVFQUNBLHVEQUNBLFdBQ0EscUVBQ0EscURBQ0EsV0FDQSxXQUNBLFlBQ0EsaUJBRUEsZ0JBQ0EsZUFDQSxNQUNBLDhDQUVBLDhDQUNBLCtFQUNBLGVBSEEsT0FJQSxtQkFDQSwrREFDQSwrQ0FDQSxZQUNBLHVCQUNBLGdEQUVBLG1CQUNBLE1BQ0EsK0JBQ0Esb0JBQ0EsTUFDQSxTQUNBLFNBQ0EsT0FDQSw2QkFDQSxJQUNBLHVEQUNBLFdBQ0EsV0FDQSw4Q0FDQSw4QkFFQSxrQ0FDQSx5QkFDQSw0QkFDQSxzQ0FDQSxVQUNBLHNCQUF1RSx1Q0FBNEMsSUFDbkgsT0FQQSxPQVFBLE1BQ0EsZ0JBQ0EsZ0JBRUEsSUFDQSxFQUNBLFNBQ0Esb0JBQ0EsaUJBQ0EsTUFDQSxrREFFQSxlQUNBLGVBRkEsUUFHQSxNQUNBLGdCQUNBLE1BQ0EsU0FDQSxTQUNBLGtCQUVBLElBQ0EsRUFDQSxFQUdBLCtDQUNBLHdCQUNBLHVDQUNBLGVBR0EsZ0RBQ0Esd0JBQ0EsdUNBQ0EsZ0JBQ0EsZ0VBQ0EsbURBQ0Esa0RBQ0Esc0RBR0EsNkJBQ0EsaURBQ0EsZ0JBRUEsZ0JBQ0EsRUFDQSxVQXFCQSxtQkFDQSxtQkFDQSxVQUNBLEdBQ0EsaURBQ0EsT0FDQSxlQUtBLGlDQUNBLGFBQ0EsOEJBR0EsSUFFQSxnQkFDQSw0Q0FDQSw2QkFDQSxHQUVBLGdDQUdBLHVDQUNBLG9EQUNBLG1CQUNBLElBaUJBLGVBR0EsNENBUUEsOENBR0EsOENBSUEsK0NBVUEsdURBQ0EsV0FDQSxrQkFDQSxtQkFDQSxpQkFDQSx3REFDQSxtRUFLQSx5RUFDQSw4QkFDQSxpQkFDQSxpQ0FFQSxnRUFEQSxnQ0FFQSxPQUNBLHNDQUNBLHNEQUNBLFFBQ0EsVUFDQSw4Q0FDQSwwQ0FDQSwyRkFHQSxXQUNBLGdFQUdBLDRGQUNBLE9BRUEsS0FDQSx3REFDQSxtQkFDQSxZQUNBLHdCQUVBLG1CQUNBLDRCQUNBLGlCQUNBLHdCQUdBLHlCQUNBLGNBQ0EsRUFDQSxnQkFNQSxrQ0FDQSxzREFDQSxlQUNBLG9CQUNBLGlCQUNBLHdEQUNBLHNFQUtBLHdFQUNBLDRCQUNBLGlCQUNBLCtCQUVBLDZEQURBLDhCQUVBLE9BQ0Esb0NBQ0Esb0RBQ0EsUUFDQSxVQUNBLDRDQUNBLHdDQUNBLHVGQUdBLFdBQ0EsNkRBR0EsMkZBQ0EsT0FFQSxLQUNBLDJEQUNBLGlCQUNBLFlBQ0Esd0JBRUEsbUJBQ0EsMEJBQ0EsaUJBQ0Esd0JBR0EseUJBQ0EsWUFDQSxFQUNBLG1CQUtBLGdDQUNBLHFEQUNBLGVBQ0EsOEJBQ0EsZUFLQSxzRUFDQSxnQ0FDQSxpQkFDQSxvRUFDQSwwQkFDQSxnQkFBdUIsMkNBQXFELFNBQzVFLHNEQUNBLDBFQUVBLFVBQ0EsMENBR0Esb0dBQ0EsT0FFQSxLQUNBLEVBQ0EsaUJBTUEsZ0NBQ0EsaURBQ0EsZUFDQSwwQkFDQSxXQUtBLDZEQUNBLDRCQUNBLGlCQUNBLCtEQUNBLGNBQ0EsNENBQ0EsOEVBR0EsaUVBQ0EsT0FFQSxLQUNBLEVBQ0EsaUJBWUEsK0JBQ0EsNEJBQ0Esc0JBQ0EsYUFDQSxvRUFDQSx5RUFDQSxvRUFDQSxTQUNBLGlFQUNBLGtEQUNBLFNBS0Esd0RBQ0EsVUFDQSxzQ0FDQSw0QkFFQSw2QkFDQSxLQUNBLEVBQ0EsZ0JBTUEsMENBQ0EsOEZBQ0EsZUFDQSxvQkFDQSw2QkFDQSxrQ0FDQSw4QkFDQSw2QkFDQSxnQ0FDQSx3QkFDQSx3REFDQSxXQUtBLDRCQUNBLGlEQUNBLHNEQUlBLG9HQUFxRSxzQkFDckUsMENBQ0EsOEJBQ0EsNEVBQ0Esc0NBek9BLGdDQTBPQSx5REFDQSx5R0FDQSx3R0FDQSw2R0FDQSxnQ0FwUEEsNkJBMlBBLG9FQUNBLGdCQUVBLGtFQUNBLDJCQUNBLG1DQUNBLHdEQUNBLHVEQUNBLFdBQ0EsNkdBQ0Esb0RBQ0EsV0FDQSxXQUNBLCtCQUNBLDZFQUNBLGdHQUNBLHFGQUNBLHdCQUNBLDBCQUNBLDhCQUF5RSxxQ0FBK0IsT0FDeEcsaUNBQ0Esb0JBR0EsMEVBQ0EsV0FDQSx5RUFDQSxhQUNBLHVEQUlBLHdCQUNBLCtEQUNBLGdCQUNBLDZEQUNBLGlCQUNBLHlDQUdBLDRCQUEyRCxtQkFBZ0IsT0FDM0UsZ0JBQ0EsK0JBRUEsaUNBR0EsNERBQXFGLGNBQXlCLFVBQzlHLFFBQ0EsWUFFQSxJQUNBLEVBQ0EsRUFDQSxvRkFDQSxvREFDQSxnQkFDQSwyRUFDQSxtQkFDQSxtRUFDQSw2Q0FDQSxnQkFDQSxHQUNBLGFBQ0EsOEVBR0EsMEJBQ0EsbURBQ0EsNERBQ0EsVUFJQSxTQUNBLFFBQ0EsNEVBQ0EsbUNBQ0EsVUFDQSw0RkFDQSx5Q0FJQSxtQ0FDQSxRQUNBLDhFQUNBLGdCQUdBLG9EQUNBLDhFQUNBLDBCQUNBLCtEQUNBLGFBQ0EsK0JBRUEsTUFDQSxDQUNBLDZDQUNBLGVBQ0EscUJBQ0EsVUFDQSxpRkFDQSx5Q0FDQSxlQUNBLG9CQUNBLDZFQUNBLGtEQUNBLFNBQ0EsMEVBQ0EseURBQ0EsVUFDQSwwRkFDQSw2Q0FDQSxTQUNBLHFHQUNBLFdBQ0EsOENBQ0EsMkJBQ0EsUUFDQSxvQkFDQSw0Q0FDQSwwQkFDQSxRQUNBLEVBQ0EsNEVBQ0EseUJBQ0EsWUFDQSwyREFDQSxNQUNBLGtFQUNBLHNDQUNBLDRCQUVBLFdBQ0EsNkRBQ0EsZ0NBQ0Esd0NBQ0EsT0FDQSxLQUNBLG1FQUNBLDRCQUNBLGdDQUNBLE1BQ0EsZ0VBQ0EsMkJBQ0EsNkJBQ0EsSUFDQSw2RUFDQSxXQUNBLHlDQUNBLDZDQUNBLDJCQUNBLHNCQUlBLGtCQUhBLGdGQUNBLHFFQUVxRCx3REFDckQsMkVBQ0EseURBQ0EsVUFDQSxxQ0FDQSxRQUVBLE1BQ0Esd0JBRUEsNENBQ0EsSUFDQSw2RUFPQSw2Q0FFQSxxRUFSQSxVQUNBLHNFQUlBLGFBSUEsNENBQ0EsU0FDQSw2RkFDQSxVQUNBLHlEQUlBLDZEQUNBLFNBQ0EsbUdBQ0EsVUFDQSwwREFJQSxnREFDQSxnQ0FRQSx3REFDQSxtRkFDQSwwQ0FDQSxvQ0FHQSx5QkFiQSx5RUFDQSxVQUNBLGtEQUlBLHFCQVFBLEVBQ0EsRUFBZSxFQUNmLEVBQ0EsQ0FDQSxpRkFDQSxlQUNBLGdDQUNBLGNBQ0EsRUFDQSxjQUVBLHFGQUNBLCtEQUNBLG1CQUNBLDZGQUNBLHVFQUNBLHdEQUNBLGdEQUNBLG1CQUNBLDZFQUNBLG1EQUNBLHlCQUNBLFlBQ0EsZ0ZBQ0EsV0FDQSxlQUNBLHNDQUVBLHNFQUNBLE9BQ0EsaUdBQ0EsdURBQ0EsZ0VBQ0EsZ0RBQ0EsbUJBRUEscUZBQ0EsaUdBQ0EsMERBQ0EsUUFFQSw2RkFDQSw0REFDQSxRQUVBLHNGQUNBLHVFQUNBLGdDQUNBLHNEQUVBLEtBQ0EsV0FLQSxrRkFDQSxzQ0FDQSwyQkFDQSxJQUtBLHFGQUNBLGdEQUNBLDBFQUNBLHFEQUNBLE1BS0EsMEZBQ0Esd0NBQ0Esa0VBQ0EseUJBQ0EsNEJBQ0EsbUZBQ0EsTUFLQSw2RkFDQSxzQ0FDQSxnRUFDQSwwQkFDQSwyREFDQSxNQUtBLGlGQUNBLDhDQUNBLE1BQ0Esd0ZBQ0EsdURBQ0EsMkNBQ0Esa0RBQ0EsK0ZBSUEsc0ZBSEEsTUFFQSxHQUVBLEVBQ0EsRUFDQSx1RkFDQSxxR0FDQSxNQUNBLDZGQUNBLFdBQ0EsMEJBQ0EsMkJBQ0EseUNBR0Esc0NBRUEsOEJBQ0Esd0NBQ0Esa0JBQ0EsK0NBQWdELHdEQUNoRCwyQ0FDQSw0QkFDQSw2QkFFQSxXQUNBLEVBQ0EsRUFBVyxFQUNYLDZDQUFxRCx3REFDckQsMkNBQ0EsdUJBQ0EsK0JBRUEsV0FDQSxFQUNBLEVBQVcsRUFDWCx5REFDQSxlQUNBLG9GQU1BLGdDQUNBLCtDQUVBLFlBQ0EsRUFDQSwyQkFBQyxzQ0FxQkQsbUNBQ0Esb0JBQ0Esa0NBQ0EsbUJBQ0EsNkJBQ0EsZ0NBQ0EsSUFDQSx1RUFFQSxDQUNBLGtFQUVBLENBQ0EsMEVBQ0EsdUNBQ0EscUNBQ0EsYUFDQSw2RUFDQSwyQkFDQSxLQUNBLDZFQUNBLG1DQUNBLFNBQ0EseUVBQ0EsNENBQ0EsU0FDQSxzRUFDQSx3QkFDQSxTQUNBLHVFQUNBLHdCQUNBLGVBQ0EsMEVBQ0EsNENBQ0EsU0FDQSxvREFDQSwyQkFDQSwwQkFDQSxTQUNBLCtEQUVBLENBQ0EsNkRBRUEsQ0FDQSx1REFBOEQsQ0FDOUQsa0VBQXVGLENBQ3ZGLEVBQ0EsdUJBaUJBLGVBRUEsNENBU0EsZ0RBU0EsdUJBQ0EsZUFDQSwyQkFDQSw4QkFDQSw0QkFDQSxnQ0FDQSxPQW9DQSxxRUFDQSxXQVFBLDJCQU9BLGlDQUNBLFlBQ0EsdUVBQ0EsQ0FDQSx3REFPQSxxQ0FDQSxLQUVBLElBVEEsaUZBQ0EscUJBQXVDLDZCQUFtQyxLQUMxRSxzREFHQSxRQU1BLDhDQUNBLDJCQUNBLE9BSUEscUJBQ0EsT0FFQSxvREFDQSxXQUNBLDhDQUNBLHlCQUNBLGVBQ0EsRUFrQkEsc0dBQ0EsV0FDQSxnQ0FDQSw0Q0FDQSw0Q0FDQSxpQ0FHQSxpQ0FFQSw2QkFDQSwwQkFFQSx3QkFDQSxrREFDQSxzQkFDQSxnQkFDQSx5QkFPQSxzQkFDQSxlQUVBLHlCQUtBLDBEQUNBLDJCQUNBLHFDQUNBLDBDQUVBLGNBQ0EscURBT0EsdUJBQ0EsT0FsS0EsYUFxS0EsT0EzS0EsS0FpTEEsNkVBQ0EsV0FDQSw2QkFHQSwySUFFQSw4RUFDQSxDQUVBLDJEQUFtRCx3REFDbkQsUUFDQSwrQ0FDQSxXQUNBLFdBQ0EsZUFDQSw4RUFDQSxzREFFQSxvUEFFQSxTQUNBLHdJQUFtTCwyQkFDbkwseUJBSEEsT0FJQSw0QkFDQSxVQUNBLE9BQ0Esb0NBQ0EsNEJBQ0Esa0hBQ0EsaUJBQ0EscUJBQ0EsZ0JBQ0EsZ0JBRUEsSUFDQSxFQUFXLEVBQ1gsRUFNQSw2REFFQSxxRUFDQSxDQUVBLGtHQUNBLHNDQUNBLGlDQUNBLFNBTUEseURBQ0EsV0FDQSx3REFDQSxVQUNBLDZCQUNBLHVDQUF5Qyx3REFDekMsV0FDQSwrREFDQSx1RkFDQSxXQUNBLFdBQ0EsMERBQ0EsK0RBQ0EsZ0ZBQ0Esc0VBQ0EsOEVBQ0EsWUFDQSxrRUFDQSw4RUFDQSxrQkFDQSw2RUFDQSw2SEFDQSxnREFFQSw0RUFDQSxrREFDQSwrQ0FFQSxzQ0FDQSxhQUVBLGFBQ0EsMkJBQ0EsYUFDQSxhQUdBLHNFQUNBLDJDQUNBLFVBQ0EsUUFHQSxhQUNBLFFBRUEsSUFDQSxFQUFXLEVBQ1gsRUFDQSxpRUFDQSx3QkFDQSx1RkFDQSw0Q0FDQSxLQUVBLHFEQUNBLFdBQ0EsOENBQ0EseUJBQ0EsZ0JBQ0EsRUFDQSxzREFDQSxXQUNBLDhDQUFvRCx3REFDcEQsNkNBQ0EsV0FDQSxXQUVBLDZCQUNBLGdCQUVBLGFBQ0EsaUNBQ0EsZ0JBQ0EsYUFDQSxxREFDQSxtQ0FDQSxhQUlBLHdCQUNBLHdCQUVBLElBQ0EsRUFBVyxFQUNYLEVBQ0EsbUVBQ0EsV0FDQSwrQ0FDQSwyREFDQSw4QkFDQSxTQUNBLEdBQ0EsUUFDQSx1REFDQSxXQUNBLGdEQUNBLGdDQUNBLFNBQ0EsRUFDQSxzRUFDQSxXQUNBLGlCQUNBLDZCQUNBLHNDQUNBLE9BQ0EsMEJBQ0EsdUJBQ0EsZ0JBRUEsZ0NBQ0Esa0JBR0EsZ0RBQ0Esa0VBQ0EsZ0VBQ0EsK0RBRUEsV0FDQSxFQUNBLHNFQUNBLFdBQ0EsaUJBQ0EsNkJBQ0Esc0NBQ0EsTUFDQSxzQkFDQSxnQkFDQSxxQ0FDQSxrREFDQSwrQkFDQSxtQkFDQSxRQUNBLEVBQ0EscURBQ0EsV0FDQSxpQkFDQSw4REFDQSx5Q0FDQSxTQUNBLFlBQ0EsT0FDQSxpREFDQSwwQkFDQSxVQUNBLGdFQUNBLFdBRUEsaUJBQ0EsNkJBQWtDLHdEQUE4RCwyQ0FDaEcsUUFDQSxFQUFXLEVBQUksRUFDZixrQkFBK0Isd0NBQXdELGVBQ3ZGLEVBQ0EsRUFDQSxlQXNCQSw0QkFDQSxpQ0FDQSxlQUtBLGNBQ0EsUUFDQSxvREFDQSx1Q0FDQSxNQUNBLCtDQUNBLHdDQUNBLE1BQ0EseUNBQ0EsTUFDQSxRQUNBLG9FQUNBLFdBQ0EsVUFDQSw0QkFDQSxPQUNBLG9CQUVBLE1BQWEsRUFFYixFQUNBLEVBQ0EsYUEwQkEsMEJBT0Esd0JBQ0Esb0JBQ0EsTUFBd0IsZUFBdUIsT0FDL0MsOEJBRUEsa0ZBQ0EsYUFBdUIsZUFBdUIsU0FDOUMsdURBQ0EsSUFDQSx3RUFDQSw0Q0FHQSxtRUFDQSxXQUNBLDBDQUNBLHFCQUNBLFlBQ0EsZ0RBQ0Esc0JBQ0EsK0RBRUEsK0NBQ0EsY0FPQSxrRUFDQSxtQkFDQSxZQUlBLElBR0EsNENBZ0NBLENBTUEsc0NBTEEsV0FDQSxlQUNBLHlCQUE0Qix5QkFDNUIsTUFDQSxDQUdBLHVDQUNBLG9DQU1BLHFCQUNBLElBQ0EsOERBQ0Esd0JBQ0EsS0FDQSwrREFBc0UsQ0FDdEUsK0VBQ0EsNkJBQ0EsK0RBRUEsbUNBQ0EsZ0JBQ0Esb0VBQ0EsbUNBQ0EsMEVBQ0EsSUFDQSxFQUNBLHdCQUNBLDBDQUNBLDBDQUNBLFdBQ0EsY0FLQSx1QkFLQSx1QkFFQSxzQkFDQSxVQUNBLDZDQUNBLE9BQ0EsdUNBQ0EsZ0JBQ0EsMkNBRUEsWUFDQSxvQkFFQSw4Q0FDQSxjQUNBLGlFQUNBLFdBQ0EscUNBSUEsa0ZBQ0EsK0JBQ0EseUJBQ0EsaUZBSUEseUJBQ0EsMERBR0Esb0RBQ0Esd0dBQ0Esc0RBR0EsY0FHQSxJQUNBLEVBQ0Esa0VBQ0EsTUFDQSxlQUNBLGtGQUNBLDZCQUNBLCtEQUVBLG9CQUNBLGlDQUVBLFlBQ0EsdUVBQ0EsaUNBQ0EseUVBQ0EsNEdBQ0Esa0NBQ0EseUJBQ0EsSUFDQSwwREFDQSxrQ0FDQSwrRkFDQSxxQkFDQSxXQUNBLEVBQ0EsMkJBUUEsOEJBQ0EsNENBQ0EsV0FDQSx1QkFDQSx1QkFDQSw0QkFDQSx3QkFDQSxXQUNBLDBEQUNBLDRCQUNBLHNFQUNBLGVBQ0EsT0FDQSw4REFDQSwyQkFFQSxhQUNBLEVBQ0EsY0FFQSxrQkFDQSxlQU1BLDRDQUNBLDBEQUNBLFdBQ0EsdUJBQ0EseUJBQ0EsV0FDQSwwREFDQSw0QkFDQSxtRUFDQSwyREFDQSxjQUdBLG9GQUVBLHFCQUNBLFlBQ0EseUVBQWdGLENBQ2hGLG9FQUEyRSxDQUMzRSxFQUNBLDZCQUlBLDZCQXdFQSxxQ0FDQSxrQkFDQSxXQUNBLHdDQUNBLDZCQUNBLFFBQ0EsMkNBQ0Esc0NBQ0EsUUFDQSxzQ0FDQSxrQkFDQSxNQUF3QixlQUF1QixPQUMvQyw0QkFFQSx5RUFHQSxnQ0FDQSxTQUNBLHVDQUNBLGtCQUNBLE1BQXdCLGVBQXVCLE9BQy9DLDRCQUVBLDBFQUdBLGlDQUNBLFNBQ0Esa0RBQ0EsZUFDQSxLQUNBLEVBQ0EsY0FDQSx5Q0FDQSxnQ0FFQSwrQ0FDQSxJQUVBLCtDQUpBLHlDQUtBLHNCQUNBLG9CQUFDLEVBQ0QsOERBQ0EseUNBRUEsd0RBQ0EsSUFFQSx3REFKQSxrREFLQSwrQkFDQSw2QkFBQyxFQUNELHlEQUNBLDZDQUVBLHNEQUNBLDRCQUNBLFVBQ0EsS0FDQSxtREFMQSxRQU1BLHdCQUFDLEVBQ0QsMERBQ0EsOENBRUEsdURBQ0EsNEJBQ0EsVUFDQSxLQUNBLG9EQUxBLFFBTUEseUJBQUMsRUFTRCx1RUFpQkEsMERBRUEsbUNBQ0EsdURBQ0EsV0FDQSxvQkFDQSwrQkFDQSxlQUNBLHNFQUNBLGVBQ0EsU0FDQSxvRUFLQSw2RUFGQSxlQUdBLDZFQUVBLGtCQUNBLFNBQ0EsRUFDQSxhQUVBLCtCQUNBLDBEQUNBLFdBQ0Esb0JBQ0EsK0JBQ0EsZUFDQSx5RUFDQSxlQUNBLGdEQUVBLHFCQUNBLDhFQUVBLGtCQUNBLFNBQ0EsRUFDQSxnQkFNQSxtQkFDQSx5QkFDQSxzQ0FDQSw4Q0FDQSxtREFLQSxxREFDQSxVQUFDLG1DQUF3QyxnQ0FxQ3pDLHlGQUNBLGlCQUNBLDJCQUNBLHFCQUNBLHVCQUdBLGFBQ0EsK0JBRUEsd0RBQ0EsbURBQ0EsNkJBQ0EsRUFDQSxtRUFDQSxvREFDQSxnRUFDQSx1Q0FDQSw4Q0FDQSxPQUNBLE9BQ0EsaUVBQ0Esb0RBQ0EsZ0VBQ0EsdUNBQ0EsMEJBQ0EsZUFDQSxPQUNBLHdEQUdBLDhDQUNBLFdBQ0Esa0NBQ0EsVUFDQSxxREFDQSxrREFDQSxVQUNBLDRDQUNBLGdGQUNBLGdDQUNBLE9BQ0EsaUJBRUEscURBQ0Esb0RBQXNELDZCQUFvQyxNQUMxRiwwREFDQSx1Q0FDQSxNQUNBLEVBQ0EsZ0RBR0EsSUFHQSwyQkFBdUIsY0FBc0IsT0FDN0MsMkNBRUEsR0FDQSw4REFDQSx3REFDQSxnQ0FFQSwrQ0FDQSxFQUNBLFlBTUEsbUNBQ0EsQ0FLQSxvREFKQSxpQkFDQSxvQkFDQSxHQUNBLENBTUEsZ0NBQ0EseUNBQ0EsbUJBQ0EsWUFFQSwyRUFDQSxzRUFDQSw4RUFDQSwyQ0FDQSxrQ0FDQSx3QkFDQSxnQkFFQSxrRkFDQSwyRUFDQSw4RUFDQSwyQ0FDQSxTQUNBLFVBQ0Esb0JBQ0EsMkNBQ0EsbUNBRUEsb0JBQ0EsNkJBQ0EscUJBQXVELDJCQUEwQixZQUNqRixvQ0FDQSxrQkFDQSxrQ0FDQSx5Q0FFQSxzQkFDQSx3RkFHQSxtQ0FFQSxpRkFDQSwrRUFFQSxpR0FDQSxVQUNBLHlCQUNBLHVGQUNBLG1DQUNBLE1BQ0EsRUFDQSwrQ0FDQSxnQkFFQSx3RUFDQSxXQUNBLHlFQUNBLDhFQUNBLDBCQUNBLDBCQUNBLHVDQUNBLHFEQUNBLG1EQUNBLDJDQUNBLDhCQUVBLDBDQUVBLFVBQ0EsdUNBQ0EsY0FDQSx3Q0FDQSxxQ0FFQSxhQUNBLENBQ0EsMEJBQ0Esb0VBQ0EsZ0JBRUEscUdBQ0EseUVBQ0EsbURBQ0EsbUJBQ0EsVUFDQSxzR0FDQSw2Q0FFQSx5RUFBdUIsd0JBQWdDLFVBQ3ZELGlFQUNBLDBDQUVBLDJCQUNBLDBCQUNBLFFBQXVCLFNBQWlCLFdBQ3hDLGVBQ0EsaURBQ0EsZ0RBQ0EsbUNBRUEsMENBRUEsVUFDQSx3Q0FDQSxjQUNBLHdDQUNBLHFDQUVBLGFBQ0EsQ0FDQSx3QkFDQSxvRUFDQSxnQkFLQSx3RUFDQSwyRUFDQSx3Q0FDQSxvQ0FDQSw2RUFDQSxpREFDQSxNQUVBLHFFQUNBLElBQ0EsMEJBQ0EsTUFDQSxTQUNBLDBCQUNBLDZCQUNBLFFBQ0EsQ0FVQSwrREFDQSxxQ0FDQSw2QkFDQSxxRUFDQSw4QkFFQSw0QkFNQSwwREFDQSxTQUtBLGdCQUNBLHFDQUVBLDZCQUdBLFlBQ0EsdUNBRUEsZ0VBQ0EsUUFFQSxvQ0FHQSxRQUNBLCtEQUNBLFdBQ0EsMEJBQ0Esb0NBR0EsbUJBQ0Esc0RBSUEsbUNBQ0Esa0VBQ0EsTUFDQSw2Q0FFQSxhQUVBLG1CQUNBLE9BQ0EsZ0VBQ0EsZ0JBQ0EsY0FDQSxlQUF5QyxpQkFBcUIsWUFDOUQsbUJBQ0Esa0VBQ0EsYUFHQSwwQ0FFQSxzQkFDQSxhQUNBLFlBQ0EsdUJBQ0EsT0FLQSw2RUFFQSxxQkFDQSx3REFFQSxrREFDQSxnRUFFQSxrRUFDQSw4REFHQSx3Q0FFQSxrREFDQSwwQ0FDQSwyREFDQSxzQ0FDQSx3REFJQSxzREFDQSxpRUFHQSx5Q0FDQSxxSEFFQSw2REFDQSw2RUFDQSx1REFDQSw2RUFDQSxZQUNBLG9EQUNBLDZFQUNBLHlEQUNBLDZFQUNBLGFBRUEsdUNBRUEsTUFNQSxzRUFDQSxJQUNBLDhCQUVBLFlBQ0EsNENBQ0Esd0JBR0EsdUJBR0EsVUFDQSwrQ0FFQSxVQUNBLDhDQUVBLDBCQUNBLG1EQUVBLDJCQUlBLHNGQUVBLHNDQUNBLG1DQUVBLDBCQUNBLDJCQUVBLDBCQUNBLGlFQUdBLDRFQUVBLE9BQ0EsdUZBQ0EsV0FDQSw0Q0FJQSwyRUFDQSx3RUFDQSxHQUNBLEVBQ0EsRUFDQSxpQkFPQSxJQTZGQSwyQ0FDQSxxQ0FDQSwyQkFDQSxzQkFDQSxtREFFQSw0REFDQSxLQWhCQSxvQ0FpQkEsV0FFQSxzRUFDQSx5QkFDQSxtRUFDQSxxQ0FFQSxxREFDQSxDQUNBLE9BQ0EsTUFDQSxjQUVBLCtGQUNBLHVDQUNBLDRGQUNBLHFFQUNBLHlCQUNBLDJEQUNBLDBCQUNBLHVCQUNBLHdDQUNBLGdEQUNBLFdBQ0EsRUFDQSxpQkFDQSw4QkFDQSxDQUdBLGlDQUZBLENBQ0EsQ0FNQSxrQ0FDQSwrQ0FDQSxjQUNBLGtDQUNBLG9GQUNBLDBEQUNBLGtDQUNBLDZEQUNBLDZCQUNBLGNBQ0EsdUNBQ0EsOEJBQ0EsRUFDQSxtQkFJQSx3QkFDQSxvQ0FDQSxXQUdBLG9CQUNBLDBCQUNBLHlCQUF3Qyx3REFDeEMsMkNBQ0EsYUFDQSxtREFFQSxXQUNBLEVBQ0EsRUFBZSxFQUVmLGlCQUNBLDZEQUdBLFNBQ0EsbUNBQ0Esa0RBQ0EsOENBQ0Esd0RBQ0EsSUFDQSxLQUNBLGdCQUNBLCtCQUNBLHlEQUVBLDJGQUVBLGdDQUNBLGtDQUNBLHlCQUNBLHVDQUNBLGlCQUNBLCtCQUNBLFVBQ0EsOERBQ0EsNkRBQ0EsbURBQ0EsMENBQ0EsOERBQ0EsMERBRUEsd0VBQ0EsMEVBQ0EsK0RBQ0EscUVBQ0EscUVBRUEsd0RBQ0EsaUNBQ0EsMkVBRUEsYUFDQSw4Q0FDQSxhQUNBLCtDQUNBLGVBQ0EsK0NBQ0EsYUFDQSwrQ0FDQSxnQkFDQSwwREFDQSxTQUNBLG1FQUNBLG9FQUNBLG9FQUVBLG1HQUNBLFVBQ0EsdURBQ0EsYUFHQSwwQ0FFQSwrQkFDQSxnQkFDQSxtRUFDQSxXQUNBLHlDQUNBLGlFQUNBLDZCQUVBLCtnQ0FDQSxrTEFDQSxtQ0FnQkEsa0NBZkEsdUNBQ0EsMEJBQ0EsMkNBQ0EsK0JBQ0EsdURBQ0EsOEVBQ0EsZ0VBRUEsMEVBQ0EsS0FFQSxPQUVBLE1BQ0Esc0hBRUEsb0NBQ0Esb0JBQ0EsMkNBQ0EsaUJBQ0EsNkJBQ0EsNERBRUEscUVBQ0EsaUNBQ0EsMEVBRUEsMkVBQ0EsVUFDQSxrREFDQSxlQUNBLGtCQUNBLDhEQUNBLG9FQUVBLHFDQUNBLFdBQ0EsRUFDQSxjQUVBLHFFQUNBLCtEQUNBLCtEQUNBLGFBQ0EsMERBRUEsd0VBQ0EscUZBQ0EsS0FDQSw4Q0FDQSx3REFDQSx3REFDQSxhQUNBLDBEQUVBLCtEQUNBLHVGQUNBLEtBQ0EsNkRBQ0EsV0FDQSwyRUFDQSwyREFDQSwrRUFDQSwrQ0FDQSxhQUNBLEVBQ0Esc0NBQ0EsYUFDQSx3Q0FDQSxLQUNBLDZDQUNBLGVBQ0EsUUFDQSw2QkFDQSxZQUNBLHNCQUNBLFlBQ0Esc0JBQ0EsYUFDQSxTQUNBLDBDQUVBLGdCQUNBLEVBQ0EsY0FFQSx1REFDQSxvRUFDQSxnRUFDQSxPQUNBLFdBQ0EsNkJBQ0EsT0FDQSxVQUNBLDZCQUNBLE9BQ0EsVUFDQSw4QkFDQSxRQUNBLE1BQ0EsNkVBRUEsUUFHQSxpRUFDQSw4QkFDQSxxQkFDQSxFQUNBLFNBSUEsNEJBQ0EsOENBQ0EsaUJBQ0EsNkJBQ0EsWUFDQSx1REFDQSxXQUNBLDJEQUNBLGdFQUNBLHdCQUNBLHlCQUNBLDBCQUNBLFdBQ0EsNEJBRUEsZ0VBQ0Esb0JBQ0Esa0VBSUEsNkJBQ0EsZ0VBS0EscUdBRUEsS0FDQSxFQUNBLCtEQUNBLDJEQUNBLGdFQUNBLHlEQUNBLDJDQUNBLDBGQUNBLDJFQUNBLDZDQUNBLFFBQ0EsSUFDQSw0RUFDQSw2QkFDQSxNQUF3QixlQUF1QixPQUMvQyx5Q0FFQSxPQUNBLEtBQ0EsYUFDQSxnRUFDQSx5RUFDQSwrREFDQSxrSEFHQSxnRkFDQSwrREFDQSx1RkFFQSxzREFDQSxRQUNBLElBQ0Esb0RBQ0EsMERBQ0EsbUVBQ0EsZ0RBQ0EsTUFDQSxJQUNBLEVBQ0EsV0FDQSx5QkFDQSxnQ0FDQSxpQkFDQSwyQkFDQSxRQUNBLGFBQ0Esb0VBQ0EsMERBQ0EsUUFDQSxpRkFDQSx3REFDQSwyQ0FDQSx5RkFDQSwwRUFDQSw4RkFDQSxPQUNBLElBQ0EsMkVBQ0EsNkJBQ0EsTUFBd0IsZUFBdUIsT0FDL0MseUNBRUEsU0FDQSx3QkFDQSxLQUNBLGFBQ0EsZ0VBQ0Esd0VBQ0EsOERBQ0EsaUhBR0EsK0VBQ0EsOERBQ0Esc0ZBRUEsb0dBQ0EsYUFDQSxJQUNBLG1EQUNBLHlEQUNBLFFBQ0Esb0ZBQ0EsbUdBQ0EsT0FDQSxJQUNBLHdDQUNBLHVEQUNBLDJDQUNBLGFBQ0EsMEJBQ0EsY0FDQSxnRkFFQSxjQUNBLEVBQ0EsRUFDQSxFQUNBLG9EQUNBLFNBQ0EsNkRBQ0Esc0RBRUEsbUJBQ0EsRUFDQSxVQUlBLGdDQUNBLDJDQUNBLFdBQ0Esb0JBQ0EsK0NBQ0Esd0JBQ0EsMERBQ0EsSUFDQSxnRUFDQSx3Q0FDQSw2RkFFQSw0REFDQSxVQUNBLHlEQUNBLGVBQ0EsdUJBQ0EsYUFDQSxFQUNBLGNBRUEsNkVBQ0EsZUFDQSw4REFDQSxVQUNBLEVBQ0EsY0FFQSwyRUFDQSxlQUNBLHVCQUNBLGlCQUNBLEVBQ0EsY0FFQSw2RUFDQSx1RUFDQSx1RUFDQSxhQUNBLDBEQUVBLDZGQUNBLDJFQUNBLFVBQ0EscURBQ0Esc0JBQ0EsNEVBRUEsd0VBQ0EsS0FDQSx5REFDQSxpRUFDQSxzREFDQSwyQ0FDQSwrRkFDQSxnRkFDQSxvRkFDQSxNQUNBLHNFQUNBLDZCQUNBLE1BQXdCLGVBQXVCLE9BQy9DLHlDQUVBLE9BQ0EsY0FDQSxnRUFDQSwrRUFDQSw4R0FHQSxzRkFDQSxtRkFFQSwwRkFDQSxZQUNBLCtDQUNBLHVFQUNBLCtCQUNBLDJDQUVBLE9BQ0EsbURBQ0EsY0FDQSxNQUF3QixlQUF1QixPQUMvQyx3QkFFQSwyRUFDQSxlQUNBLENBRUEsbUNBRUEsRUFEQSxTQUVBLHVEQUNBLHlCQUNBLG9FQUNBLENBRUEsK0hBQ0Esd0JBRUEsK0JBQ0EsZ0NBRUEsc0RBQ0Esd0JBR0EsaUZBQ0EsbUdBQ0EsNkZBQ0EsYUFDQSxXQUNBLDRCQUNBLHlCQUdBLDZDQUNBLFNBQ0EsMkVBQ0EsV0FDQSw2QkFDQSwrQ0FDQSxJQUNBLFdBQ0EsdUNBRUEsK0NBQ0Esd0JBQ0Esa0JBQ0EsOEJBQ0EsbUZBQ0Esb0dBQ0Esa0JBQ0EsQ0FDQSxRQUVBLHNHQUNBLDBCQUNBLGVBQ0EsdUNBQ0EsaUJBQ0EsQ0FDQSxtREFDQSxXQUNBLDRFQUNBLDhDQUNBLDZDQUNBLFVBQ0EsK0JBQ0EsVUFDQSx5REFDQSx3QkFDQSx5REFDQSx3Q0FDQSxtQkFBaUIsRUFHakIsb0RBRUEsUUFDQSxFQUNBLHFGQUNBLHNDQUNBLENBQ0EsMEJBQ1MsMEJBQ1Qsb0JBR0EsQ0FDQSx1Q0FRQSxxR0FFQSxrQkFDQSxzQkFDQSxXQUNBLFNBQ0EscUVBQ0Esc0RBQ0EscURBQ0EseUNBR0EsMkNBRUEsS0FDQSxRQUVBLFFBQ0EsRUFDQSxpQkFDQSwrQkFDQSxzREFDQSx1QkFDQSxnQ0FDQSxTQUNBLDBEQUNBLHNDQUNBLHlDQUNBLFNBQ0EsRUFDQSxnQkFDQSwrQkFDQSxrRkFDQSxpQkFDQSxxQkFDQSxvQkFDQSwwQkFDQSxrQ0FDQSxpQkFDQSx5REFDQSx3RUFDQSwyREFDQSxjQUVBLCtHQUNBLDJDQUNBLDREQUNBLG1FQUNBLDBEQUNBLHdCQUNBLGtGQUNBLGVBQ0EsNEdBRUEsb0NBRUEsQ0FDQSx3REFDQSxlQUNBLHVCQUNBLGFBQ0EsRUFDQSxjQUVBLHlFQUNBLGVBQ0EsNkNBQ0EsV0FDQSxFQUNBLGNBRUEsNEVBQ0EsZUFDQSxPQUNBLHNCQUNBLEVBQ0EsY0FFQSw4RUFDQSxlQUNBLHlEQUNBLFdBQ0EsRUFDQSxjQUVBLG9FQUNBLHNCQUNBLDBFQUVBLHNDQUNBLG9DQUNBLG9DQUNBLFFBQ0Esc0JBQ0Esb0RBQ0EsV0FDQSxpRUFDQSxXQUNBLFlBQ0EsMENBQ0Esc0NBQ0EsUUFDQSxHQUNBLE1BQ0EsaUVBQ0Esb0JBQ0EsNkNBRUEsNEJBQ0EsMkNBRUEsc0NBQ0EscUJBQ0EsMkRBQ0EsNkNBRUEsNENBQ0Esd0JBQ0Esb0dBQ0EsbUJBQ0Esc0hBQ0EsTUFFQSwyQ0FDQSxXQUVBLG9CQUVBLFFBQ0EsZ0VBQ0EsV0FDQSxrREFDQSxpQ0FDQSxRQUNBLEVBQ0EsRUFDQSxnQkFDQSwwQ0FDQSxrRkFFQSw2RUFDQSxJQUNBLGdEQUhBLDhEQUlBLDBDQUNBLDZDQUNBLG9EQUNBLElBQ0EsRUFDQSxxQkFBQyxFQUNELG9DQUNBLG9DQUNBLGFBQ0Esc0JBQ0EsU0FDQSw0REFDQSxtREFDQSxzREFDQSx1Q0FDQSx5REFFQSx3Q0FDQSxPQUZBLHFDQUdBLDRCQUNBLDhEQUNBLCtEQUVBLHVGQUNBLEtBRUEsc0VBQ0EsK0RBQ0EsK0NBRUEsdURBQ0EsMERBQ0EsK0RBQ0EsK0NBRUEseUdBQ0EsaUNBQ0Esb0dBQ0EsTUFDQSw0Q0FDQSxvREFDQSxNQUNBLEtBRUEscURBQ0EsK0RBQ0EsMkRBQ0EsZ0VBRUEsS0FFQSw2RUFFQSxxREFDQSwwQ0FDQSx3REFDQSxVQUNBLHlEQUNBLHlEQUNBLGdFQUNBLGlCQUNBLHFDQUNBLHlDQUVBLGtCQUNBLDBDQUdBLGdJQUNBLE9BRUEsb0NBQ0EsMEVBQ0EsdURBRUEseURBQ0Esd0VBQ0EscURBRUEseUdBQ0EscUNBQ0EsMENBQ0EsMkRBQ0EsVUFDQSxzQ0FDQSxzREFDQSw0Q0FDQSxHQUNBLHFGQUNBLCtCQUVBLCtEQUNBLFVBQ0EsaURBQ0EsZ0JBQ0EsTUFBd0IsZUFBdUIsT0FDL0MsNEJBRUEsMERBQ0Esa0VBRUEsbUVBQ0EsVUFDQSxvREFDQSxnQkFDQSxNQUF3QixlQUF1QixPQUMvQyw0QkFFQSw2REFDQSxxRUFFQSxtRUFDQSxVQUNBLG1EQUNBLGdCQUNBLE1BQXdCLGVBQXVCLE9BQy9DLDRCQUVBLDREQUNBLG9FQUVBLGlFQUNBLFVBQ0EsK0NBQ0EsZ0JBQ0EsTUFBd0IsZUFBdUIsT0FDL0MsNEJBRUEsd0RBQ0EsZ0VBRUEsaUVBQ0EsVUFDQSw0Q0FDQSxzQkFDQSx1REFFQSwwRUFDQSxPQUVBLHVGQUNBLGlDQUNBLG1EQUNBLElBQ0EsNEdBRUEsZ0JBQ0Esb0JBQ0EsK0NBQ0EscUVBRUEsZ0VBQ0EsT0FFQSxtQ0FDQSx5REFFQSxPQVdBLHNFQUNBLG9CQVFBLHVCQUFrRCxzQkFBZ0IsT0FDbEUsbUJBQ0Esa0JBQ0EseUVBRUEsVUFDQSw2QkFDQSxVQUNBLCtCQUVBLFdBQ0EseUJBQ0EsaUVBQ0EsMEdBQ0Esb0JBQ0EsMkJBQ0EsQ0FFQSw2QkFDQSxPQUlBLDBFQUVBLHlCQUNBLDRDQUNBLG1HQUNBLE9BQ0EsNkRBRUEsd0RBQ0EsS0FBdUIsY0FBc0IsV0FDN0Msd0JBQ0EsNEJBQ0EsMENBQ0EsSUFDQSx5RUFDQSwwRkFFQSxnQkFDQSxrSEFDQSxzQ0FFQSxzREFDQSxtRUFDQSxLQUNBLEtBQ0Esc0VBQ0EsMEJBQ0EsUUFDQSxDQUNBLDZCQUNBLE9BQ0EsMENBQ0EsY0FDQSxNQUF3QixlQUF1QixPQUMvQyx3QkFFQSwrREFDQSxlQUNBLFdBRUEsRUFEQSxlQUVBLHVEQUNBLHlCQUNBLHdEQUNBLENBRUEsbUhBQ0Esd0JBRUEsa0NBQ0Esd0JBR0EscUVBQ0EsdUZBQ0EsaUZBQ0EsYUFDQSxXQUNBLDRCQUNBLHlCQUdBLHFDQUNBLFNBQ0Esa0VBQ0EsV0FDQSw2QkFDQSwrQ0FDQSxJQUNBLFdBQ0EsdUNBRUEsK0NBQ0Esc0JBQ0EsVUFDQSxtRUFFQSxRQUNBLFFBRUEsNENBQ0EsMkZBQ0EsMEJBQ0EsZUFDQSxnQ0FDQSxpQkFDQSxDQUNBLDBDQUNBLFdBQ0EsZ0VBQ0Esa0NBQ0EsNkNBQ0EsVUFDQSwrQkFDQSxVQUNBLDBEQUNBLCtCQUNBLHdEQUNBLFVBQWlCLEVBR2pCLG9EQUVBLFFBQ0EsRUFDQSw0RUFDQSxzQ0FDQSxDQUNBLDBCQUNTLDBCQUNULHNCQUdBLENBQ0EsMkJBQ0EsV0FDQSxTQUNBLHFFQUNBLHdEQUNBLHFEQUNBLHlDQUdBLDRDQUVBLE9BQ0EsUUFFQSxRQUNBLHVEQUNBLHFCQUNBLHlDQUNBLCtCQUNBLGtGQUNBLHNEQUNBLHNEQUNBLG1IQUNBLHlDQUVBLHlDQUNBLHVCQUNBLDhFQUVBLGtCQUNBLGdDQUNBLDRCQUNBLHdFQUNBLCtEQUlBLFVBQ0EseURBQ0EsOENBRUEsaUNBQ0EsMkJBQ0EsdUZBRUEsTUFDQSxDQUNBLG1GQUNBLHFCQUNBLDJEQUNBLG9IQUNBLDREQUNBLE9BQ0Esc0dBRUEsZUFDQSxFQUNBLFFBQ0EsNEJBQ0EsNERBQ0EsaUJBQ0EsK0JBQ0EsOEJBQ0EsOEJBQ0EsK0NBQ0EsNkVBQ0EsVUFDQSw2REFDQSxlQUNBLFlBQ0Esb0NBQXlDLG9CQUF5QixJQUNsRSxHQUNBLE1BQ0EsRUFDQSxjQUVBLHdFQUNBLGVBQ0EsNEJBQ0EsU0FDQSxFQUNBLGNBRUEsdUVBQ0EsZUFDQSw0QkFDQSxJQUNBLEVBQ0EsY0FFQSw0RUFDQSxXQUNBLHFFQUNBLHdEQUNBLG1EQUNBLG1EQUNBLEtBQ0EsRUFDQSx3REFDQSxlQUNBLDZDQUNBLFdBQ0EsRUFDQSxjQUVBLHNFQUNBLENBQ0EsaUVBQ0EsQ0FFQSwySEFFQSx3RUFDQSxrRUFDQSx1RUFDQSxvRUFFQSwwRUFDQSw0REFDQSw2R0FDQSxxREFFQSw2QkFDQSxjQUVBLGlEQUNBLHNCQUNBLG9FQUVBLHNDQUNBLDhDQUNBLDhDQUNBLFVBQ0EsNkRBQ0EseUhBQ0EsS0FDQSxFQUNBLGFBTUEsbUNBT0EsQ0FDQSxTQUNBLFVBQ0EsK0RBQ0EseURBUUEsSUFDQSxtRUFDQSxlQUE4QixPQUFxQyw2QkFFbkUsR0FDQSxXQUFpQixDQUNqQixDQUNBLDJDQUNBLDZDQUVBLDJEQUNBLFFBQ0EsZ0VBQ0EsNENBQ0EsNEZBRUEsZUFDQSxNQUNBLDhDQVRBLGlFQVVBLGVBQ0EseUJBQ0EsYUFDQSxFQUNBLGNBRUEsK0VBQ0EsZUFDQSxpQ0FDQSw0QkFDQSxVQUdBLDREQUVBLFVBQ0EsRUFDQSxjQUVBLDZFQUNBLGVBQ0EseUJBQ0EsaUJBQ0EsRUFDQSxjQUVBLHdFQUNBLHNFQUdBLEdBQ0EseUNBRUEsd0VBQ0EsWUFDQSwrREFFQSw2RUFDQSwrRUFDQSxVQUNBLG1EQUNBLCtEQUNBLHdEQUNBLHVCQUNBLDhDQUFtRCxPQUFlLE9BQ2xFLEVBQ0EsRUFDQSxtQkFBQyw0REE4R0QsNEZBQ0EseUdBQ0EsOEdBQ0EseUZBQ0EscUVBQ0EsMERBQ0Esb0RBQ0Esb0ZBa0JBLHFFQUNBLFdBQ0EseUJBQ0EsbUJBQ0EsZUFDQSx1QkFDQSw2QkFDQSxtQ0FDQSx5Q0FDQSw2QkFDQSxrQ0FDQSwwQ0FDQSx3Q0FDQSxvQ0FDQSx1QkFDQSx1Q0FJQSxhQXVCQSw0QkFFQSwwSkNscG9CQSwyQkFDQSxpQ0FDQSxlQUNBLEtBQ0EsRUFFUSx1T0FoTVIsa0ZBa0JBLGlCQVlBLFlBQ0EsbUJBQ0EsNEJBQ0EscUNBQ0Esb0NBQ0EsaUNBQ0Esa0NBQ0Esb0NBQ0EsUUFBQyx1QkFJRCxrQ0FNQSxpREFDQSxjQUNBLE1BQW9CLGVBQXVCLE9BQzNDLDBCQUVBLDBCQUVBLDhCQUNBLHFCQU9BLHVCQUNBLHlFQUNBLE9BQ0Esb0JBQ0EsMkVBQ0EsT0FDQSxvQkFDQSx5RUFDQSxPQUNBLG9CQUNBLHlFQUNBLE9BQ0Esb0JBQ0EsMkVBQ0EsT0FDQSxNQUNBLDhGQUVBLE9BQ0EsbUJBT0Esc0JBQ0EsV0FJQSxvQkFJQSxpQ0FJQSxpQ0FDQSxLQUNBLDBEQUNBLGVBQ0EsYUFDQSxTQUNBLG1CQUNBLFlBQ0EsK0JBRUEsdURBQ0EsR0FDQSxFQUNBLGNBRUEsc0VBQ0EsZUFDQSxhQUNBLFdBQ0EsbUJBQ0EsSUFDQSwyQ0FFQSxzRUFDQSxHQUNBLEVBQ0EsY0FLQSxtREFDQSxjQUNBLE1BQXdCLGVBQXVCLE9BQy9DLHdCQUVBLDZEQUNBLE1BQ0EsaUNBQ0EsY0FDQSxNQUF3QixlQUF1QixPQUMvQyx3QkFFQSwrREFDQSxNQUNBLGtDQUNBLGNBQ0EsTUFBd0IsZUFBdUIsT0FDL0Msd0JBRUEsNERBQ0EsTUFDQSxrQ0FDQSxjQUNBLE1BQXdCLGVBQXVCLE9BQy9DLHdCQUVBLDREQUNBLE1BQ0EsbUNBQ0EsY0FDQSxNQUF3QixlQUF1QixPQUMvQyx3QkFFQSw2REFDQSxNQUNBLEVBQ0EsTUFnQkEsOEZDNlRBLG1DQWhmQSxnQkFFQSxDQUNBLHlCQUNBLGtCQUNBLGtCQUNBLFVBQ0EsRUFFQSxvQkFDQSxxQkFDQSw4QkFDQSxxRkFDQSw4QkFDQSxPQUNBLGlCQUNBLDhCQUVBLGdCQUNBLE1BRUEsOEJBQ0EsTUFDQSwyQkFFQSxhQUNBLDJDQUdBLG9CQUNBLDJDQUNBLHNEQUNBLGNBQ0EsVUFHQSxrRUFGQSxXQUdBLFFBQ0EsYUFDQSxPQUFLLFNBQ0wsQ0FFQSxvQ0FEQSxFQUVBLDBCQUNBLElBQ0EsSUFFQSwrQkFDQSxJQUVBLGVBQ0EseUJBQ0EsNkNBQ0EsR0FDQSxzQ0FDQSw2QkFDQSxtQkFDQSwyQkFDQSxTQUlPLG1CQUhQLGNBQ0EscUJBQ0EsU0FFQSx3QkFHQSwwQ0FGQSxLQUdBLGFBQ0EsY0FDQSxnQkFDQSxLQUFHLFNBQ0gsYUFDQSxFQUNBLEVBRUEsOEJBQ0EsYUFDQSxjQUNBLGdCQUNBLE1BRUEscUJBQ0Esa0JBQ0EsMkRBQ0EsTUFDQSw2Q0FFQSxPQUdBLG1DQUErQyxTQUFTLElBQ3hELGdDQUVBLG9CQUNBLEtBRUEsZ0RBQ0EsNkRBQ0EsOERBQ0Esa0JBQ0EsT0FPQSxDQUNBLDJCQUNBLElBQ0EsWUFDQSxDQUNBLGtCQUNBLENBQ0EsT0FDQSxxQkFDQSxPQUNBLGtCQUNBLENBQ0EsT0FDQSxvQkFDQSxRQUVBLEVBQUcsVUFDSCxTQUNBLE9BQ0Esb0JBQ0EsR0FDQSxFQStIQSx3Q0FDQSxlQUFrQixTQUFjLHFDQUNoQyxPQUVBLHVJQXJRQSwrQkFvSUEsK0NBQ0EsdUJBQ0EsYUFFQSx1REFDQSwrQkFFQSw0REFDQSxPQUNBLE1BRUEsK0NBQ0Esc0JBQ0Esd0JBQ0Esb0JBQ0EsdURBQ0EsT0FDQSxNQUNBLEVBQ0Esa0JBQ0EsdURBQ0EsMkJBQ0EsT0FDQSxFQUVBLElBRUEseUJBQ0EsNENBQ0Esb0JBT0EsSUFDQSx3REFDQSxjQUNBLFFBQ0Esd0JBU0EsaUJBUkEsS0FDQSxpQkFDQSxPQUNBLElBQ0EsRUFFQSxPQUdBLFNBQ0EsSUFDQSx3QkFFQSxLQUFPLFVBQ1AsUUFDQSxHQUNBLENBRUEsVUE3QkEsbURBQ0Esb0VBQ0EsdUNBQ0EsMkJBRUEsU0F3Qm1CLFNBQWlCLE9BQ3BDLGVBRUEsR0FDQSxJQUVBLCtCQUNBLDJEQUNBLFFBR0EsbUNBQ0EsU0FDQSxNQUNBLElBRUEsOEJBQ0EsNENBQ0EsUUFDQSxNQUNBLElBRUEsNkJBQ0EsNENBQ0Esd0JBQXdDLFNBQVMsSUFDakQsMkJBRUEsT0FDQSxFQUVBLEVBQ0EsUUFDQSxhQUNBLDZDQUNBLGNBQ0EsR0FDQSxlQUNBLG1CQUNBLElBRUEsaUVBQ0EsOEJBQ0EsOERBRUEsTUFFQSx1QkFJQSxJQUNBLCtCQUVBLFNBQ0EsaUNBRUEsV0FDQSxpQ0FFQSx3QkFDQSxpQ0FFQSxhQUNBLDJCQUNBLDBEQU9BLENBQ0EsbUVBQ0Esc0RBRUEsY0FDQSw0Q0FDQSxPQUVBLCtDQUNBLHdCQUE2QixTQUM3QixvQ0FDQSxLQUNBLGlCQUVBLDhCQUNBLHFDQUNBLHFCQUVBLHdCQUNBLHNDQUNBLDRCQUNBLEdBRUEsdUJBQ0EsSUFDQSxTQUNBLE1BQUcsU0FDSCxDQUNBLFFBQ0EsQ0FHQSxpQ0FDQSxPQUNBLDBCQURpQyxPQUFRLGVBQW1CLE9BQVUsRUFBSSxLQUcxRSxvQkFFQSxvREFDQSxzQ0FDQSxzQ0FDQSxFQUVBLGlEQUNBLE9BQ0EsZ0RBRHdELGVBQW1CLE9BQVUsRUFBSSxLQU96Riw4QkFDQSx5QkFDQSxXQUNBLGdGQUNBLDZFQUNBLGtGQUNBLHFCQUNBLDJDQUVBLFlBRUEsMkZBQ0EsY0FDQSxrQkFDQSxnQkFDQSw2QkFDQSxlQUNBLFdBQUcsU0FBWSxDQUNmLDJEQUNBLHlFQUNBLE9BQ0EsQ0FFQSxZQUNBLEdBR0EsdUNBQ0EsT0FDQSxjQUNBLHlCQUNBLHFCQUNBLGdCQUVBLE1BRUEsK0NBQ0EsK0NBQ0EsT0FBQyw0QkFDRCxvQkFDQSxNQUNBLE1BRUEsaUJBQXVCLEdBQ3ZCLG9DQUNBLCtCQUNBLElBRUEsS0FDQSxVQUNBLDJCQUNBLG9FQUNBLElBRUEsaURBQ0EsY0FDQSxpQkFDQSw4QkFDQSwrQ0FFQSxnQ0FDQSx1QkFDQSxLQUVBLHdDQUNBLGdCQUNBLHVFQUNBLGVBQ0EsMEVBQ0EsY0FDQSxlQUNHLElBQ0gsT0FHQSxZQUVBLGdCQUdBLGVBUEEsaUJBQ0csTUFNRixtREFDRCwwREFDQSxLQUNBLEVBRUEsMEJBQ0EsNkNBQ0EsNkJBQ0EsR0FJQSwrQkFDQSxtQkFDQSxtQkFDQSxPQUNBLGtCQUNBLHFCQUNBLEVBQ0EsMEJBQ0EsdUJBQ0EsRUFDQSw0QkFDQSx5QkFDQSxFQUVBLFlBQ0Esc0JBQ0EsVUFDQSxDQUVBLFlBRUEsOENBQ0EsNEJBQ0EseUJBQ0EseUJBQ0Esd0JBQ0EsdUJBQ0EsbUVBQXFGLG9CQUF3QixJQUM3Ryw2REFDQSxxREFDQSxnQkFDQSxrQ0FDQSxNQUVBLCtDQUVBLDZCQUVBLGlHQUVBLGtEQUVBLHdDQUNBLGtEQUVBLE1BQ0EsYUFDQSxNQUNBLFVBQWMsRUFDZCxVQUFjLEVBQ2QsVUFBYyxFQUNkLFVBQWMsRUFDZCxVQUFlLEdBQ2YsVUFBZSxHQUNmLFVBQWUsR0FDZixVQUNBLGdCQUVBLGlCQUFpQixHQUVqQiwwQkFDQSxtQ0FDQSxFQUtBLGtFQUNBLDhDQUNBLEdBR0EsdUJBQ0EseURBQ0EsVUFDQSxHQUlBLHdCQUNBLHdCQUNBLElBR0EsWUFDQSxnQkFDQSw2QkFDQSwwQ0FDQSxHQUlBLHdCQUVBLHdEQUNBLENBSUEsK0NBQ0EsT0FDQSxrQkFFQSxTQUNBLDZEQUNBLHlCQUNBLGdDQUNBLEdBRUEsNENBQ0EsbUJBRUEsc0JBQ0Esa0JBRUEsZ0VBQ0EsNEJBQ0EsbUVBQ0EsUUFFQSxlQUNBLEtBRUEsZ0JBRUEsc0RBQ0EsSUFDQSxtQkFDQSx1QkFFQSx1RUFDQSxvQkFDQSxTQUNBLG9CQUVHLDZCQUNILENBS0EsK0NBQ0EsZ0RBQ0EsT0FjQSxzQ0FDQSxZQUNBLGlCQUdBLHNCQUNBLHdCQUVBLDBEQUNBLHFCQUNBLHFCQUNBLDBCQUNBLHlCQUNBLGNBQ0EscUNBWEEscUJBWUEsY0FDQSxJQUFVLE9BQWUsMkJBVHpCLHVCQVVBLGtCQUNBLHVCQUNBLEdBQ0EsOEJBQ0EsdUJBQ0EsYUFDQSxzQkFDQSxrQkFDQSwwQkFDUyx1QkFHVCxpQ0F6QkEsMkJBMEJBLE1BQ0EsQ0FHQSxtQkFDQSxnQ0FDQSx3RUFDQSx1Q0FDQSx5QkFDQSxPQUlBLHNCQUNBLE9BQ0EsT0FFQSx1Q0FBMEMsQ0FBZ0IsU0FBRSxHQUM1RCwyQ0FDQSwrQkFDQSwyREFDQSxVQUNDLElBQ0Qsa0JBRUEsMEJBSUEsMkJBQ0EsU0FDQSxZQUVBLDZDQUE4QyxDQUFrQixXQUFFLEdBQ2xFLDZDQUNBLHlDQUNBLDZEQUNBLFVBQ0MsSUFDRCxrQkFFQSxpQ0FLQSxpQ0FDQSwwQkFDQSxJQUVBLFdBRUEsMkNBQ0EseUJBQ0EsbURBQ0EsT0FPQSxpQkFxQkEsZ0NBQ0EsdUNBQ0EsS0FFQSxvQ0F4QkEsb0NBQ0Esa0JBQ0EsMEJBQ0EseUNBQ0EsUUFHQSwwQ0FDQSxrQkFFQSxzQkFFSyxvQkFBWSxPQUFlLHVDQUNoQyw4Q0FDSyx1QkFDTCxDQUNBLENBRUEsQ0FPQSx5QkFFQSxzREFDQSxrQkFDQSxVQUNBLFNBQ0EsR0FDQSx5REFFQSwyQ0FDQSwrQ0FFQSxZQUNBLE9BR0EsZUFFQSwrRkFEQSxPQU9BLDhDQUNBLDhCQUNBLGFBRUEsYUFFQSxrQ0FDQSxHQUdBLFNBQVksR0FFWixnQ0FDQSxHQVNBLG9CQUdBLGdEQUNBLE9BQ0EsS0FFQSxLQUNBLFdBQ0EsbUNBQ0EsaUNBQW9DLE1BQVUsQ0FDOUMsY0FBbUIsOEJBQXNDLGlCQUN6RCxDQUFDLDBCQUNELHFCQUNBLHVCQUNBLGFBQ0EseUJBQ0Esb0JBQ0EsT0FDQSxvQ0FDQSwyRUFDQSxlQUNBLFNBQ0EsRUFDQSxzREFDRyxZQUNILEVBQUMsRUFFRCxRQUdBLHFDQUEwQyxRQUUxQyx3Q0FLQSxrQkFDQSwrQkFDQSxJQUNBLCtEQUNBLDhCQU1BLGlEQUNBLDJEQUNBLDJDQUNBLFFBRUEsZUFDQSxxQkFhQSx5Q0FFQSx5Q0FkQSxRQUNBLE9BQ0EsWUFDQSxHQUFHLFNBQ0gsSUFDQSxXQUNBLHdCQUNBLEdBQUssU0FBWSxDQUNqQixDQUFHLENBQ0gsUUFFQSx3QkFJQSw2Q0FDQSwyQ0FDQSxtRkFDQSxnQkFDQSxnQkFFQSwrQ0FDQSxNQUdBLGdDQUVBLFdBU0EsMkJBRUEsQ0FHQSw2QkFiQSxrQkFDQSxhQUNBLGdCQUNBLDRDQUNBLGlDQUFjLENBQU4sbUNBQ1IsV0FDQSxnQ0FTQSxrREFDQSxlQUdBLDBCQUNBLEtBQ0EsOENBQ0EsQ0FDQSxRQUNBLDJCQUNBLDhDQUNBLElBQ0EsdUJBQ0EsaUJBQXFCLE9BQ3JCLFVBQ0EsS0FFQSxLQUNBLHNCQThCQSxLQUNBLEtBQ0EsUUFDQSwyQkEvQkEsOEVBQ0EscUJBRUEsNEJBRUEscUJBRUEsWUFFQSxHQUFHLGlCQUNILENBQ0EsRUFxQkEsMkJBcEJBLG1CQUVBLHNCQUVBLG9CQUVBLGlCQUVBLEdBQUcsaUJBQ0gsQ0FFQSxFQVdBLHFCQVZBLHFFQUNBLElBQ0EsRUFDQSxFQVFBLGlCQUNBLGtCQUNBLG1CQUNBLHNCQUNBLHNCQUVBLHVCQUVBLFdBRUEsb0RBQ0Esb0RBQXFFLHVCQUNyRSxLQUVBLFVBR0EsQ0FHQSxFQUpBLE1BTUEscUNBQ0EsMkJBQ0Esa0NBQTZELHVCQUM3RCxzRUFBa0YsaUJBQ2xGLE9BTUEsd0JBQ0Esd0JBQ0EsMkJBQ0EsS0FDQSxzQ0FDQSxzQkFDQSxJQUNBLEVBQ0Esb0VBQ0csV0FDSCxPQUVBLHlGQUNBLFdBQ0EsNEJBQ0Esd0JBQ0EsU0FDQSxFQUNBLGlEQUNBLFVBQ0EsRUFFQSxxQkFDQSxzQ0FNQSxzQ0FDQSw0QkFBeUIsQ0FDekIsY0FHQSxpQ0FFQSx1QkFDQSx5QkFDQSxVQUNBLE9BQ0EsSUFDQSx3Q0FDQSx5QkFDQSxtQkFHQSxrREFDQSx3QkFDQSw0RUFDQSxtQkFDQSxrQ0FDQSxtREFDQSxVQUNBLGFBRUEsNERBQ0EsSUFDQSxjQUNBLGlCQU1BLDJDQUxBLGFBQ0EsMEJBRUEsd0JBQ0csZ0RBRUgsV0FJQSwwQ0FFQSw0RUFDQSw4QkFDQSxXQUVBLGNBQ0EsR0FLQSxzQkFDQSxhQUFtQixHQUVuQiw2REFDQSx1REFFQSw4QkFDQSxJQUNBLGFBQ0EsR0FBRyxTQUNILG9CQUNBLE9BQ0EsQ0FFQSxpQkFLQSxDQUdBLGtDQVBBLCtGQUNBLElBRUEsZUFNQSxxRkFDQSxpQkFDQSxrQkFDQSx1QkFDQSxlQUNBLEVBQUcsU0FBWSxDQUNmLDBEQUNBLFVBRUEsY0FDQSxHQVNBLGdCQW9CQSx1QkFDQSxpQkFDQSx3QkFDQSxrQkFDQSxxQkFDQSw2QkFDQSxzQkFDQSx3QkFDQSw2QkFDQSxzQkFBZSxHQUNmLDRDQUNBLHNDQUNBLDZCQUNBLGlDQUNBLHdCQUNBLDJDQUVBLHNFQUdBLHVEQUNBLE9BR0EsdUJBSDhCLE9BQzlCLGVBQXNCLHNCQUF5QixPQUFXLElBQUksQ0FDM0QsTUFDRixxQkFDRCxrQ0FDQSxtQ0FDQSxpQkFDQSxxREFDQSxVQUFDLEVBRUQsdUJBQ0EsK0NBQ0EsNEJBQ0EsSUFDQSxHQUVBLHFFQUNBLE9BQ0EsbUJBQUMsY0FDRCxxQkFDQSxRQUVBLG1EQUNBLHdEQUNBLGFBQ0EscUJBQ0Esa0JBQ0EsbUJBQ0EsUUFDQSwwREFJQSwyQkFBNEIsMEJBQ3ZCLDJEQUpMLGdCQUVBLDhCQUdHLGdCQUNILEVBQ0EsbURBQ0EsV0FDQSx3Q0FDQSxNQUNBLFNBQ0EsT0FDQSw0Q0FDQSxZQUNBLEdBQ0EsMERBSUEseUNBQ0EsMEVBQ0Esd0ZBQ0EsSUFDQSxxRUFDQSxrQkFDQSxxQkFDQSxnRUFDQSxzQkFDQSw2RUFDQSxlQUNBLEVBQ0EsdURBQ0EsaUNBQ0EsWUFDQSxLQUNBLEVBQ0EsaUJBQ0Esd0VBQ0csV0FDSCxPQUNBLDJEQUNBLG9CQUNBLG9EQUNBLFlBQ0EsS0FDQSxFQUNBLGlCQUNBLDRGQUNHLFlBQ0gsT0FHQSxFQUNBLHNDQUNBLDRDQUNBLDBFQUNBLCtCQUNBLHlDQUNBLGdFQUNBLGdEQUNBLE9BQ0EsNkRBQWlFLHFCQUNqRSxZQUNBLElBQ0EsK0RBQ0EsYUFDQSxFQUVBLGlCQUNBLHNDQUNBLCtDQUNBLGtDQUNBLG9DQUVBLHNDQUNBLHVEQUdBLGtEQUNBLGtCQUNBLE1BQ0EsR0FFQSxrREFBMEQsUUFBa0IsVUFFNUUsbUJBR0EsZ0hBREEsY0FDb0Isb0JBQXVCLHlCQUUzQyxtREFBMkQsMEJBQTZCLHFDQUV4RixpREFFQSxrQkFDQSxpQ0FDQSxtQkFDQSxpQ0FDQSxJQUVBLDZCQUNBLHVDQUNBLHNGQUNBLElBQ0Esc0JBQTBCLENBQWUsU0FDekMsc0JBQTBCLENBQWdCLFNBQ3pDLElBRUQsaURBRUEsQ0FFQSw0QkFoR0EseUVBQ0EsRUFDQSxpQkFnR0EsaUNBRUEsMkNBRUEsOENBRUEsMkNBR0EseUJBQ0Esa0VBQ0EsT0FJQSwyQ0FBbUUsaUJBQWYsR0FBTyxLQUMzRCwyQkFBQyxXQUNELGlDQUNBLGVBQ0EsTUFDQSxXQUNBLGtEQUNBLGlDQUNBLGlEQUNBLDREQUNBLGlFQUNBLCtCQUNBLE1BQ0EsV0FDQSxnQ0FDQSxLQUdBLElBQ0EsaUdBQ0EsU0FDQSx3QkFDQSxVQUNBLHFCQUNBLFdBQ0EsNkJBSUEsMEJBRUEsbUJBR0EsNEJBSDRCLE9BQWtCLFVBQUUsNEJBSWhELElBQ0EsV0FDQSxJQUFHLFNBQVksQ0FDZixDQUVBLHVCQUNBLFNBQ0EsMkNBRUEsc0RBRUEsV0FFQSxrRUFDQSxDQUlBLEVBQ0EsMEJBRUEsNkRBQ0EsaUNBQ0EsR0FDQSxNQUVBLDRCQUVBLFdBRUEsK0JBSUEsa0JBZ0JBLHFCQUVBLEdBQ0EsbURBQXdELE9BQWEsS0FFckUsa0RBQ0EsdURBQTRELHNCQUM1RCx5Q0FDQSxZQUtBLHdCQUNBLGlDQUVBLHVEQUNBLG9CQUNBLHdCQUNBLDZEQUNBLDBCQUNHLDRDQUNILElBRUEsZ0JBQ0Esd0NBQ0EsYUFFQSxjQUVBLDhCQUE4QixPQUFhLEtBRTNDLHdFQUNBLDhCQUNBLGtDQUNBLG1DQUNBLE1BQ0EsMkJBQXlDLDZCQUFvQyxLQUM3RSxpQ0FBNkMsNkJBQW9DLEtBQzVFLG9CQUE0Qiw2QkFBb0MsS0FDckUsQ0FDQSxXQUNBLGdDQUNBLE9BQ0EseUJBQ0EseUNBbEJBLDhCQW1CQSxxQ0FDQSwrQ0FDQSwyRUFDQSxvQkFFQSxxQkFDQSw2REFDQSxnRUFFQSx5Q0FFQSx5RkFJQSxrREFDQSxTQUNBLHdDQUFrQyxxQkFBMkIsS0FHN0QsOEJBQ0EsaUNBR0EsMkJBQ0EseUJBQ0EsV0FDQSxtQkFDQSxzQ0FDQSx1Q0FDQSxjQUVBLDJCQUNBLG1EQUNLLGdFQUVMLGVBQ0EsUUFFQSx5QkFwR0EsMEJBQ0EsZ0JBQ0Esc0JBQ0EsU0FDQSxTQUNBLDZCQUNBLDBCQUNBLDJEQUNBLDhCQUNBLG1EQUNBLE1BQ0EsQ0FFQSxDQXlGQSxLQUNBLDhDQUNBLFNBQ0Esb0JBRUEsQ0FBQyxZQUNELFlBQ0EsY0FDQSxHQUNBLDZCQUFpQyxjQUNqQyxzQkFDQSxzQkFDQSxPQUFVLGFBQ1YsU0FFQSxxQ0FDQSxPQUFVLG9CQUNWLEtBTUEsc0VBQ0Esb0JBQ0Esa0JBQ0EsVUFFQSxJQUFDLFlBQ0QsWUFDQSxhQUNBLGNBQ0Esd0JBQ0EsYUFDQSxvQkFFQSw2QkFDQSxvQ0FDQSw2QkFDQSxRQUFDLEVBRUQsVUFDQSxzQ0FFQSwwQkFDQSw0QkFDQSxrQkFFQSxXQXNDQSx3QkFyQ0EsK0JBQ0Esc0NBRUEsbUJBQ0EsQ0FDQSxlQUNBLHVCQUNBLGdCQUNBLGtCQUNBLGVBQ0EsaUJBQ0EsZ0JBQ0Esd0JBQ0EsWUFDQSxxQkFDQSxrQkFDQSxtQkFDQSxxQkFDQSxhQUNBLGlCQUNBLGdCQUNBLFlBQ0Esb0JBQ0EsVUFDQSxlQUNBLGlCQUNBLGlCQUNBLGtCQUNBLGdCQUNBLGlCQUNBLG9CQUNBLG9CQUNBLGtCQUNBLG9CQUNBLGlCQUNBLHNEQUV3RCxnQkFBd0IsV0FDaEYsc0JBQ0EseUJBQ0EseUJBQ0EsbUNBQ0EsVUFDQSxPQUNBLGtEQUNBLDZEQUNBLHVCQUNBLHVHQUVBLFFBRUEsV0FnQkEsbUpDeC9DQSxhQWlhQSxrQ0FDQSx1QkFDQSxlQUVBLHNCQUNBLGlCQUdBLHNCQUNBLE9BQ0EsZUFDQSxRQUNBLHlCQUVBLElBQ0EsVUFFQSxjQUNBLEdBQ0EsTUFFQSxjQUVBLHdCQUNBLDhCQUdBLG9EQUVBLGNBQ0EsT0FDQSxDQStOQSxzQkFDQSxtQkFDQSxJQUtBLENBeXpCQSwwQ0FDQSwwQkFDQSxXQUVBLGdDQUF5Qyw0QkFBdUIsT0FDaEUseUJBQ0EsbUJBQ0EsK0JBR0EsU0FDQSxTQUNBLGVBRUEsQ0EwQkEsQ0EyQkEsb0RBQ0EsYUFDQSxVQUNBLG9CQUNBLDRCQUNBLFFBQ0EsVUFDQSw2QkFDQSxTQUNBLFVBQ0EsNEJBQ0EsUUFDQSxVQUNBLDZCQUNBLFNBQ0EsTUFDQSx3QkFFQSxxRkFDQSxrQ0FDQSxhQUNBLEtBTUEsNkNBM2pEQSwyQ0FBOEMsQ0FFOUMsMkNBb0JBLGNBSUEsQ0FJQSxlQUlBLDBCQXVCQSx1REFDQSxLQUNBLCtCQUVBLFFBTUEsa0NBQ0Esa0JBQ0EsZ0NBQ0EsWUFDQSw2QkFDQSxRQWlCQSxpQ0FFQSxrQkFDQSxJQUFtQixVQUFnQixPQUNuQyxxQkFDQSxHQUNBLGVBRUEsRUFDQSxpQkFDQSxrQkFFQSxVQUNBLDBCQUNBLFFBRUEsNERBQ0EsbUNBQ0EsbUJBQ0Esc0JBQ0EscUJBR0Esb0JBQ0EsbUJBQ0EscUJBR0EsZ0JBQ0EsSUFPQSxtQ0FFQSx3QkFDQSxvQkFDQSxjQUNBLFVBQ0Esb0NBRUEsMkJBQ0EsY0FDQSwrQ0FDQSxNQUNBLHdCQUVBLGNBQ0EsZ0JBQ0EsZ0JBQ0EsNENBQ0EsT0FDQSw2Q0FDQSx5Q0FDQSxRQUNBLEtBQ0EsY0FDQSxnQkFDQSwyREFDQSxNQUNBLENBQ0EsaUJBQ0EsR0FFQSxTQU1BLGdCQU1BLG9CQU1BLDJCQU1BLDJCQU1BLGlGQUtBLCtCQUNBLCtCQUNBLEtBS0EsNEJBQ0EsK0JBQ0EsS0FTQSxxQkFVQSxtRUFDQSxtQkFDQSxtQkFFQSxzREFDQSw4QkFDQSxpQkFDQSwyQkFDQSxzQkFDQSxLQUF1QixVQUFrQixZQUN6QyxpQkFDQSx1QkFDQSxrQ0FDQSxzQkFDQSxrQ0FDQSxnQ0FHQSxXQUNBLFNBQ0EscUJBQ0EsSUFDQSxxQkFHQSxzQ0FUQSxxQ0FDQSx5Q0FTQSxVQUNBLG9CQUNBLEdBU0EsMENBR0Esa0NBQ0EsaUJBRUEscURBQ0EsWUFTQSwwQ0FHQSxrQ0FDQSxpQkFFQSw0REFDQSxhQWdCQSxxREFDQSxNQUNBLDhCQUNBLGlCQUNBLDJCQUNBLHNCQUNBLEtBQXVCLFVBQWtCLFFBQ3pDLHNDQUNBLHdCQUNBLHNEQUNBLElBQ0Esd0JBQ0Esc0RBQ0EsS0FDQSx3QkFDQSxzREFDQSxRQUNBLHlDQUNBLGlCQUVBLG1CQUVBLHFCQURBLGFBRUEsV0FFQSx5QkFEQSxhQUVBLFFBRUEsa0JBREEsTUFFQSxDQUNBLENBQ0EsT0FDQSxPQU1BLGtCQUNBLHlCQUNBLHFCQUNBLHVCQUNBLDhCQUNBLDhCQUVBLGFBQTJCLHNCQUE4QixPQUN6RCxvREFDQSwrQ0FDQSxpRUFDQSw2REFFQSw0QkFDQSxrRUFDQSwwREFHQSxFQUNBLENBT0EsNkJBY0EsSUFDQSw0QkFDQSxPQUNBLFNBQ0EsdUNBQ0EsRUFDQSxPQUNBLEtBbUJBLHFCQW9FQSxvQkFDQSxXQUNBLHNEQUNBLGVBQ0EscUJBQ0EsTUFDQSxFQVFBLDBEQUNBLFdBQ0EsaUNBQ0EsQ0FDQSxtQkFHQSxxQkFFQSxPQUdBLDREQUFpRCxDQUdqRCxHQUNBLDZCQUdBLHNCQUdBLE9BQ0EsQ0FDQSxFQUNBLFFBcUJBLG9CQUNBLE9BQ0EsK0JBQ0EscUNBR0Esb0JBRUEsRUFTQSxhQXVCQSxrQ0FDQSxNQUNBLDBDQU9BLENBMEJBLDJDQXpCQSxjQUNBLGtCQUVBLFFBRUEsZ0VBR0EsZ0JBR0Esd0JBQ0EsVUFDQSxXQUNBLFdBRUEsOENBQ0EsZUFDQSxZQUNBLEtBRUEsR0FFQSxDQUNBLENBRUEsSUFDQSx1REFDQSxrREFDQSw2QkFDQSxzQ0FDQSxrREFDQSxjQUNBLHlCQUNBLHdCQUVBLG9CQUVBLGVBQ0EseURBQ0EsQ0FDQSxxQkFFQSw2QkFDQSxnQ0FDQSxLQUNBLGdCQUNBLGtCQUdBLHlEQUNBLGdCQUNBLG1DQUNBLHFCQUdBLHVEQUNBLHdDQUdBLHdCQUNBLGlDQUdBLHNDQUVBLGFBQ0EsSUFDQSxFQUNBLFlBc0JBLDBCQXVDQSxZQUFtQixVQUFhLFFBQVcsYUFDM0MsTUFDQSx1QkFDQSw2Q0FDQSw0Q0FDQSxvQkFDQSxrQkFDQSxTQUNBLFNBQ0EsU0FBZSxDQUNmLE9BQ0EsUUFDQSxjQUNBLFlBQ0EsZUFFQSxVQVlBLDBCQWlHQSxlQUNBLDhDQUNBLGlCQUdBLEtBT0EsZ0NBQ0EsMkNBQ0EsWUFDQSxLQUNBLEdBQ0EsS0FNQSxtQ0FrQ0EsZUFDQSxzQ0FDQSxXQUlBLElBQ0EsaUJBb0lBLENBUUEsc0JBSEEsaUJBQ0EsQ0FDQSxDQTBDQSx5QkFDQSxnQkFFQSw4QkFPQSxrQkFNQSxjQU9BLFlBTUEsY0FJQSxnQkFJQSxlQUNBLHNCQUNBLGdCQUNBLGNBQXVCLFVBQXFCLFlBQzVDLGdCQUVBLGVBQ0EsUUFDQSxLQUNBLCtCQTVDQSx1Q0E2Q0EsZ0JBQ0EsMEJBQ0EsMEJBQ0EsMEJBQ0EseUJBQ0EsdUJBQ0EsY0FDQSxDQU9BLG1EQUNBLENBQ0Esd0JBRUEsY0FFQSxNQUNBLCtCQUEyQixFQUFRLEtBU25DLE1BQ0EsK0JBQ0EsaUNBQ0EsaUNBQ0EsNEJBQ0EsZUFJQSxpQkFBMkIsRUFBUSxLQUNuQyxNQUNBLG9CQUNBLHNCQUNBLHNCQUNBLGlCQUNBLGVBSUEsWUFBd0IsS0FBUSxLQUNoQyxnQ0FDQSxTQUVBLCtDQUNBLGlCQUNBLGlCQUNBLGlCQUNBLGlCQUNBLEtBRXVCLElBQXZCLEVBQStCLFNBQy9CLENBQ0EsS0FDQSxlQUNBLEtBR0EsbUJBQ0EsSUFJQSxZQUNBLGlCQUNBLEtBR0EsbUJBQ0EsSUFHQSxrQkFDQSxzQ0FDQSxJQUNBLElBQ0EsMkJBQ0EsSUFDQSxDQUNBLGdCQUNBLDJDQUNBLDJDQUNBLDJDQUNBLDJDQUNBLDJCQUNBLGtEQUVBLElBR0EsYUFDQSx1Q0FFQSxpREFDQSxZQUVBLFdBQ0EsZ0JBRUEscUJBS0EsSUFDQSxpQkFDQSx1Q0FDQSxXQUdBLGFBQ0EsK0JBQ0EsMkNBQ0EsS0FDQSxRQUNBLHdCQUNBLGdCQUNBLFdBRUEsRUFDQSxLQUlBLGNBQ0EsZ0NBQ0EsS0FDQSxRQUNBLHdCQUNBLGdCQUNBLFdBRUEsRUFDQSxLQUdBLENBQ0EsYUFDQSxtQkFDQSxXQUVBLGtDQUNBLFlBQ0EsYUFFQSxjQUNBLDZDQUdBLDBEQUdBLDhCQUF3QyxFQUFTLE1BQ2pELGlCQUNBLHlCQUVBLHdCQUNBLGdCQUNBLElBQXVCLEVBQU8sSUFDOUIsY0FBNEIsR0FBUSxRQUNwQyxZQUNBLHdCQUdBLFFBQ0EsT0FDQSxFQUNBLElBQUMsRUFTRCw4QkFlQSwrQ0FDQSxXQUNBLG9CQUNBLHFCQUNBLHNCQUVBLG9CQUNBLGVBQ0EsZ0NBSUEsbUJBQ0Esb0JBQ0EsVUFDQSxNQUNBLG9CQUNBLGFBQ0EsRUFDQSxFQUNBLG9EQUNBLHdDQUNBLGVBQ0EsTUFDQSxFQUNBLCtDQUNBLHdDQUNBLGdCQUNBLE1BQ0EsY0FDQSxNQUNBLDZDQUNBLHdDQUNBLFVBQ0EsVUFDQSxRQUNBLE9BT0EsMkVBQ0EsV0FDQSxLQUNBLFlBQ0EseUJBQ0EsZ0JBQ0Esa0NBR0Esa0ZBQ0EsYUFHQSxlQUNBLE1BQ0EscUJBQ0EsZUFHQSw0QkFDQSxxQkFFQSx3QkFDQSx1QkFFQSx3QkFDQSw2QkFFQSw2REFJQSxvQkFDQSxvQ0FDQSxJQUNBLE9BQ0EsZ0NBR0EscUJBRUEsVUFDQSxTQUVBLENBRUEsQ0FFQSx1QkFDQSxVQUNBLEtBR0Esb0RBQ0Esa0RBR0EsMkJBQ0EsdUJBQ0Esd0NBQ0Esa0NBRUEsTUFDQSxzREFDQSxVQU1BLG9CQUF1QixtQkFBMkIsT0FDbEQsbUJBRUEsR0FJQSxnREFDQSxXQUVBLDhCQUNBLHVEQUNBLE1BQ0Esb0JBQ0EsR0FDQSxTQUlBLHNDQUNBLHFCQUVBLEVBRUEsQ0FDQSxFQUNBLDZDQUNBLFdBQ0EsVUFHQSxpQkFDQSxhQUNBLCtCQUdBLDhCQUNBLE9BQ0EsdUJBQ0Esb0JBQ0EsR0FDQSxFQUNBLGFBQ0EsSUFvUEEsc0JBQ0Esc0NBQ0Esc0JBQ0Esa0NBQ0Esa0NBeDFDQSxpQ0FDQSxtQ0FDQSxhQVVBLEVBNjBDQSw0QkFDQSxpQkFsekNBLHdCQUNBLDBCQUNBLE1BWUEsRUFxeUNBLDhCQUNBLHNCQXJ3Q0Esc0NBQ0EsV0FDQSxLQWlCQSxFQW12Q0EsMEJBQ0Esb0JBQ0Esa0NBdHFDQSxPQUNBLGdFQUNBLDJFQUNBLFFBTUEsRUE4cENBLDRCQXJwQ0Esa0RBQ0EsVUFFQSxFQW1wQ0EsZ0NBOXBDQSxtQ0FDQSxpQ0FNQSxFQXdwQ0Esa0NBQ0Esb0NBQ0EscUJBbHBDQSxrQ0FDQSxZQUNBLDJDQUNBLFlBQ0EsTUFDQSxFQThvQ0EsMEJBQ0Esa0JBemlDQSx3QkFDQSx1QkFDQSxLQTJCQSxFQTZnQ0Esc0JBQ0EsK0JBcDdCQSwwQkFDQSxzQ0FDQSxpQkFrQkEsRUFpNkJBLG9DQXA5QkEsMEJBQ0EsNERBQ0EsT0FFQSxXQUNBLElBV0EsRUFxOEJBLHFDQXA4QkEsMENBQ0Esc0VBQ0EsTUFXQSxFQXc3QkEsd0NBbi9CQSxxRkFDQSxpQkFDQSxnREFDQSxrQkFFQSxpQ0FDQSxvQkFFQSw2Q0FDQSxPQUlBLHNCQUdBLDBEQUNBLFVBV0EsRUF3OUJBLDJCQTUzQkEsZUFBb0IsR0FDcEIsSUFRQSxFQW8zQkEsa0NBcDZCQSxpREFDQSxJQUNBLEVBbTZCQSw4QkE1ekJBLGVBQ0EsaURBQ0Esa0JBQ0EsTUFJQSxTQUNBLFFBeUJBLEVBNHhCQSxzQkFDQSx3QkFDQSwyQ0F4MUJBLHdCQUNBLDBCQUNBLElBQ0EsRUFzMUJBLHdCQUNBLCtCQXQxQkEsZUFDQSxXQUVBLElBQ0EsRUFtMUJBLDhCQWozQkEsUUFDQSxnQkFDQSxLQUVBLFdBQ0EsR0FDQSxFQTQyQkEsK0JBbjFCQSxTQUNBLEtBQ0EsZ0JBQ0Esa0JBRUEsV0FDQSxJQVNBLEVBcTBCQSw2QkF6M0JBLGVBQ0EsS0FFQSxTQUNBLFFBQ0EsRUFxM0JBLHFDQTczQkEsNkJBQ0EsVUFDQSxFQTQzQkEsbUNBOTJCQSxTQUNBLGlCQUNBLDBDQUVBLFdBQ0EsSUFDQSxFQXkyQkEsaUNBNzZCQSw2Q0FDQSxnQkFFQSxJQVFBLEVBbTZCQSwrQ0F0eUJBLFlBQ0EsdURBQ0EsZUFDQSx1Q0FDQSw0REFDQSxVQUdBLDhEQUVBLE9BQ0Esc0NBQ0EsRUFPQSxFQW94QkEsK0NBbnhCQSxTQUNBLDhDQUNBLDBDQUNBLFVBQ0EscUJBQ0EscUJBQ0EsRUFDQSxDQUNBLEdBQ0EsR0EwQ0EsRUFpdUJBLGtCQUNBLGNBNVJBLDBCQUNBLGtCQUNBLGNBQ0EsTUFBd0IsZUFBdUIsT0FDL0Msd0JBRUEsWUFDQSwyQkFDQSxpQkFDQSxLQUNBLHdCQUNBLENBQ0EsaUJBRUEsTUFDQSxFQUNBLENBR0EsRUEwUUEsd0JBeGNBLGdEQUNBLHNDQUNBLDJDQUNBLE1BS0EsRUFpY0EsZ0NBQ0Esb0VBbE9BLElBQ0Esc0JBQ0EsOEJBRUEsa0JBQ0Esd0RBRUEsbUJBQ0EsV0FDQSxPQUNBLDRCQUNBLG9DQUNBLGVBQ0EsWUFDQSxTQUNBLG9CQUNBLE1BQ0EsQ0FRQSxFQTBNQSx5QkFwS0Esa0VBQ0EsZ0JBRUEsV0FDQSw4RUFDQSxVQUNBLDhCQStKQSw4QkE5SkEsc0VBQ0EsZ0JBRUEscUNBQ0Esa0VBQ0EsVUFDQSxrQ0E4QkEsRUEySEEsMEJBL0tBLG9FQUNBLGdCQUVBLFlBRUEsNkVBQ0EsVUFFQSx3Q0F3S0Esa0NBckZBLFdBQ0EsSUFBbUIsVUFBZ0IsT0FDbkMscUJBQ0EsR0FDQSxNQUVBLElBQ0EsVUFFQSxZQUVBLGFBQ0EsRUFHQSxRQUdBLFFBQ0EsRUFnQkEsRUFtREEsdUNBNUhBLGtCQUNBLElBQW1CLFVBQWdCLFdBQ25DLHFCQUVBLHNCQUNBLFlBQ0EsTUFDQSx3QkFDQSxxRUFDQSx5QkFDQSxHQUNBLENBQ0EsZUFFQSxFQUNBLGlCQUNBLGtCQUVBLFVBQ0Esa0JBQ0EsbUJBQ0EscUJBR0Esb0JBQ0EsbUJBQ0Esc0JBQ0EscUJBRUEsU0FDQSxPQUNBLElBTUEsK0pDdHBEcUMsY0FBYyx3QkFBeUIsaUJBQWdCLGVBQWUsT0FBTyxZQUFZLFdBQVcscUNBQXNDLFFBQVMsZ0JBQ3hMLGVBQWUsZUFBZSxzQkFBcUIsb0NBQW9DLGdDQUFnQyx3Q0FBd0MsdUNBQXVDLDZLQUE2SyxtSkFBb0osWUFDdmdCLHlFQUFpRSxRQUFTLGVBQWMsb0JBQXFCLGdCQUFlLFlBQVksd0RBQXlELGVBQWMsdUJBQXdCLGVBQWMsZUFBZSx5Q0FBMEMsQ0FBa0QsZUFBbUIsc0NBQ25YLGlCQUFtQixvQkFBb0IsdUJBQXVCLDhDQUE4QyxrQkFBa0IsNENBQStFLE1BQW5DLGlEQUF3RCxtQkFBa0IsNEJBQTZCLGNBQWlILE1BQS9GLHdIQUNuUyxjQUFnQiw4Q0FBOEMsa0JBQWtCLGdCQUEwQyxNQUExQiwyQ0FBa0QsQ0FBNEMsZ0JBQWdCLGFBQWMseUJBQXdCLGdCQUFnQixrQkFBa0IsMEJBQTBCLG1CQUFxQix3Q0FBd0MsbUJBQW1CLHdCQUF3QixpQ0FBbUMsZUFBYyx3REFBMkQsUUFBSyxvQkFBb0IsaUJBQW1CLHVCQUE2QixDQUEwQyxpQkFBaUIsZ0JBQWdCLDhCQUE4QixJQUFJLG1DQUFtQyxtQkFBcUIsQ0FBMkMsZUFBaUIsNkVBQStFLGNBQWEsMENBQTBDLGdCQUFnQixlQUFpQixDQUVyOUIsZUFBZSxFQUFHLENBQVMsaURBQTRDLElBQUksd0NBQXdDLElBQUksT0FBUSxLQUFNLHNDQUFzQyxnQkFBZSw4QkFBOEIsS0FBSyxnQkFBZ0IsVUFBWSxrQkFBaUIsVUFBVSxNQUFtRCxNQUE3Qyw4Q0FBc0QsZUFBZSxpREFBa0QsZ0JBQWUsZUFBZSxRQUFRLHVCQUF1QixJQUFJLGNBQWMsUUFBUyxTQUFTLGdCQUFlLDRCQUE0QixDQUF5SCxpQkFBaUIscUJBQXNCLENBQWtGLGNBQWMsc0JBQXVCLG9CQUFtQixpQ0FBbUMsZ0JBQWUsZUFBZSx1QkFBdUIsUUFBUyxnQkFBZSxlQUFlLG9CQUFvQixRQUFTLGdCQUFlLE1BQVEsS0FBRyxxQkFBcUIsUUFBUyxDQUMzaEMsZUFBaUIsZ0JBQWdCLG1CQUFtQixLQUFvQixRQUFmLDRCQUFvQyxZQUFZLFlBQVksbUVBQXNFLGdCQUEwQixNQUFYLGFBQW9CLENBQVcsaUJBQWlCLFNBQVMsK0RBQWdFLENBQW1PLGNBQWMsaUJBQWlCLDhCQUErQixDQUVwbUIsZUFBZSx1QkFBdUIsNEZBQXFHLFVBQVUsS0FBSywwQkFBMEIsR0FBdUYsR0FBcEYsMENBQTBDLCtFQUFrRiw4SEFBOEgsT0FBTyxNQUFRLFlBQVksWUFBWSxFQUFFLENBQ3BGLGdCQUFnQixZQUFZLGlDQUFpQyxpQ0FBaUMsVUFBWSxDQUFnSSxnQkFBZ0IseUJBQXlCLHVEQUF1RCw0RkFBNEYsWUFBWSw2QkFBNkIsdURBQXVELGdCQUFnQixpQkFBaUIsb0JBQW9CLGFBQWEsZUFBaUIsQ0FFM2IsY0FBYyxlQUFvQixDQUFTLHVCQUF1QixnQkFBZ0IsZ0JBQWdCLFdBQVcsWUFBWSxpQkFBaUIsVUFBVSxjQUFjLGtCQUFvQixDQUF1RixlQUFlLFdBQVcsVUFBVSxTQUFXLENBQ2hmLHFCQUFxQixjQUFZLFdBQVcsRUFBSyxFQUFXLGlFQUEwRCxRQUFTLENBQWlELHVCQUF1QixrQ0FBa0MsU0FBUyxZQUFZLFdBQVcscUJBQXFCLFdBQVksQ0FBUSxzRUFDbHFCLHlCQUF5Qix3Q0FBd0Msa0NBQTRFLEdBQTFDLHVCQUF1QixvQ0FBNkUsR0FBdEMsT0FBTyxVQUFVLFFBQVEsK0ZBQXVHLHdEQUF3RCx5REFBeUQseUVBQXNFLFNBQ3hkLGNBQWMsMEJBQTBCLGlDQUFrQyxjQUEwQyxHQUE3QiwwQ0FBNkMsUUFBUyx3QkFBdUIsU0FBUyxZQUFZLFdBQVcscUJBQXFCLFdBQVksQ0FBUSxxRUFBOEQsd0JBQXVCLG9CQUFvQixXQUFXLGtCQUFxQixnR0FDdFgsZUFBZSxpQ0FBaUMsWUFBWSxhQUFnQixRQUFLLHVCQUF1QixxSkFBcUosNERBQWdFLGdCQUFlLGtDQUM1VSxxQkFBcUIsU0FBUyx3REFBdUQsV0FBVyxLQUFLLFdBQVcsK0NBQWtELFNBQVMsa0JBQWlCLCtCQUEyQyxNQUFaLHlCQUMzTixpQkFBaUIsaUJBQWlCLFFBQVEsMkJBQTJCLGdCQUFnQixTQUFTLDBDQUEwQyxHQUFHLFNBQVMsb0JBQW9CLGFBQWEsT0FBUSxVQUFTLElBQU0sK0NBQThDLENBQUssMkJBQXNCLEVBQUUseUJBQWtDLElBQVQsc0JBQTBCLFlBQVksS0FBSyxxQkFBcUIsc0JBQXNCLE1BQVEsU0FBUSxrQkFBa0IsaURBQXFELFNBQVMsNEJBQ3RlLGNBQXNCLE1BQVIsK0JBQXNDLENBQXNELGNBQWUsZ0JBQWlCLDBCQUEwQix1QkFBMEIsU0FBYSxjQUFhLGFBQWEscUJBQXFCLGFBQWEsWUFBYyxDQUd3QyxpQkFBaUIsWUFBWSxVQUFVLFVBQVUsVUFBVSxZQUFjLENBQTJOLGFBQWEsb0JBQXNCLENBQTZYLGNBQWMsa0NBQ3Q0QixlQUFlLHdCQUF3QixPQUFTLElBQUssQ0FDOUwsY0FBYyx1QkFDZ0ksR0FEekcsNEhBQThILHVDQUF1Qyx1QkFBdUIsU0FBUyx3Q0FBd0Msc0JBQXNCLGFBQWEsU0FBUyxZQUFZLFVBQVUsZ0hBQWdILGVBQWdCLGdDQUNwZCx5QkFBMEIsUUFBTyxtQ0FBbUMsY0FBYyxZQUFZLHVCQUF1QixvQkFBdUIscURBQXdELGNBQWdCLE9BQTJGLE1BQXRGLDhCQUE2QixvQkFBb0IsU0FBUyxXQUFXLFVBQVUsa0JBQTBCLFFBQVEsTUFBTSxTQUFTLHVCQUF5Qix5R0FBeUcsdUNBQzNkLGdDQUFnQywwQkFBMEIsNEJBQTRCLE9BQU8sSUFBSSxRQUFTLHVDQUF5QyxjQUFhLGtCQUFvQixDQUFPLGNBQWMsaUNBQWlDLGdDQUFnQyxjQUFjLFdBQWMsb0JBQW1CLFNBQVMsc0pBQTBKLENBQW1CLGNBQWMsVUFBVSxLQUFjLFdBQUUsSUFBSSxrQkFBb0IsVUFBUyxLQUFPLFNBQVUsTUFBTyxrQkFBaUIsYUFBYSxhQUFhLGFBQWEsd0JBQXdCLFdBQWEsQ0FDaGIsbUJBQW1CLGtCQUFzQixrRUFBaUUsaURBQThDLDRDQUFvRCxvQkFBbUIsYUFBYSx5QkFBeUIsVUFBVSx3QkFBd0IsVUFBWSxDQUM5WixlQUFlLGFBQWEsU0FBUyxTQUFXLENBRTBCLGtCQUFrQiwrQkFBaUMsQ0FBbUssZUFBZSxVQUFVLG9DQUFzQyxpQkFBZ0IsWUFBWSxZQUFjLENBRXhVLGVBQWUsd0NBQTBDLE1BQU0sZUFBZSxZQUFZLHlDQUF5QyxvQkFBb0IsVUFBVSxRQUFRLE9BQVMsU0FBUyxrQkFBaUIsbUJBQXFCLGlCQUFnQixVQUFZLGVBQWMsc0RBQXNELFVBQVksQ0FHblIsZUFBZSxtQ0FBcUMsQ0FBUSxjQUFjLDRCQUE4QixrQkFBaUIsMkJBQTJCLFdBQWEsQ0FBUSxjQUFjLDRCQUE4QixvQkFBbUIsNkJBQTZCLFlBQVksVUFBWSxDQUFRLG1CQUFtQixnQ0FBa0MsaUJBQWdCLG1FQUFtRSwrQkFBK0IsR0FBSyxJQUFJLENBQWdRLGNBQWUsQ0FBcUYsY0FBZSxDQUFzQyxjQUFjLGdCQUFrQixDQUFRLGNBQWMsZ0JBQWtCLENBQWUsY0FBZSxDQUM3ekIsc0JBQXNCLFNBQVMsU0FBUyxVQUFVLFNBQVMsYUFBYSxxQkFBcUIsV0FBVyxnQkFBZ0Isa0JBQWtCLFlBQVksVUFBVSw2REFBNkQsV0FBVyxZQUFZLFVBQVUsb0JBQW9CLFVBQVUsV0FBVyxVQUFVLGFBQWEsMEJBQTRCLENBQzl2QixnQkFBaUIsWUFBVSw0QkFBMkMsVUFBeUMsa0NBQXNDLHdDQUErQixDQVdtTCxlQUFlLDRDQUE0QywyQkFBMkIsVUFBVSw0QkFBNEIsSUFBSSxpQkFBaUIsUUFBUyxjQUNqZ0IsbUJBQW1CLHVEQUEwRCw4QkFBOEIsUUFBSyx1Q0FBMkMsOENBQTZDLHdCQUFxQixLQUFLLHVCQUF1QixJQUFJLGFBQWUsY0FBYSxRQUFRLFdBQVcsWUFBWSxJQUFJLDZCQUErQixlQUFnQixVQUFVLFVBQVUsU0FBUyx1QkFBdUIsUUFBUSxpREFBaUQsWUFBWSxJQUFJLDBDQUE0Qyx1QkFBd0IsQ0FFck0sZ0JBQWdCLGdEQUFpRCxDQUE4SCxpQkFBaUIsTUFBTSxlQUFlLFlBQVksV0FBVyxLQUFLLCtCQUErQixTQUFTLDBCQUEwQixxQkFBdUIsYUFBWSxvREFBc0QsaUJBQWdCLDJCQUEyQixhQUFhLGtCQUFrQixrQkFBa0IsTUFBTSx5V0FBNlgsQ0FNanJDLGVBQWUsK0NBQWdELHNCQUFxQix5QkFBcUUsTUFBNUMsWUFBVyxXQUFXLFdBQVcsWUFBb0Isa0JBQWlCLHdFQUF5RSxvQkFBbUIsMERBQThFLHVDQUM5WSxlQUFpQyxNQUFsQixpRUFBdUUsQ0FBaUUsaUJBQWlCLG1CQUFtQixnQkFBZ0IsVUFBWSxDQUs2RixpQkFBaUIsU0FBUyxTQUFTLG1CQUFtQixXQUFXLFlBQVksVUFBVSxvQkFBc0IsQ0FJNmIsY0FBYyxvQkFBc0IsZ0JBQWUsYUFBYSxpQkFBbUIsZ0JBQWUsZUFBZSwyRUFBNEUsQ0FDajZCLGlCQUFpQixVQUFVLFdBQVcsaUJBQW1CLGdCQUFlLGNBQWMsbU1BQW9NLG9CQUFvQixZQUFZLDJCQUEyQixZQUFZLFVBQVksQ0FFM04sY0FBYyxzQkFBd0IsQ0FBc0ksY0FBYyxjQUFnQixDQUNqYSxpQkFBaUIsYUFBYSxxQ0FBcUMsZ0JBQWdCLGdEQUFnRCxnREFBZ0QsZ0RBQWdELG9EQUFvRCx1QkFBd0IsMkJBQThCLE9BQU0sT0FBUyx3QkFBdUIsSUFBSSw0RUFBbUYsVUFBUyxRQUFVLENBQW9CLGNBQWMsYUFBYSxtQkFBbUIsZ0JBQWdCLFdBQVcsb0JBQW9CLG1CQUFtQixVQUFVLFVBQVUsbUNBQW1DLFVBQVUsYUFBYSxXQUFXLDBCQUE0QixDQUd6WSxlQUFlLGtFQUNqWixlQUFlLHFDQUFzQyxDQUdxRSxpQkFBaUIsT0FBTyx5RUFBMEUsQ0FJRyxlQUFlLFNBQTBELE1BQWpELG9CQUFtQixLQUFLLE9BQU8sS0FBSyxTQUFXLElBQVcsb0JBQW1CLEdBQUcsWUFBWSxTQUFTLE9BQVEsS0FBTSxlQUFzQixHQUFSLGNBQWdHLEdBQS9FLDJCQUFnQyxnREFBNEcsR0FBcEQsaUJBQWlCLGtCQUFrQiwyQkFBOEIsSUFBSSxRQUFVLDJCQUEwQixnQ0FBZ0MsT0FBTyxxQkFBcUIsOEJBQWdDLFNBQVMsQ0FBUyxpQkFBUyxnQkFBZSxXQUFXLFVBQVUsVUFBVSxjQUFjLGVBQWUseUZBQXlGLFdBQVcsa0JBQWtCLGdEQUFnRCxvREFBb0QsV0FBVywwQkFBMEIsMEJBQTBCLDJEQUEyRCwyREFBMkQsMkRBQzNwQyxNQUFNLHlFQUF5RSx3QkFBd0IsZUFBZSxVQUFVLHdDQUF3QyxXQUFXLDJDQUEyQyxlQUFlLHVFQUF1RSxnSUFBaUksb0JBQXNCLENBc0JrQyxjQUFlLENBQXdLLGNBQWUsNkJBQTJCLG1CQUF3QixJQUFtQiw0Q0FBK0IsT0FBSyxNQUFNLHNEQUF1RCxrQkFBb0IsUUFBUyxlQUFjLDRFQUFxRixDQUMxOUIsZ0JBQWdCLGFBQWEsaUJBQWlCLFVBQVUsa0RBQWtELDhEQUE4RCxvQ0FBb0MsNEJBQTRCLDZFQUE2RSxvQkFBaUMsZUFBRSxhQUFhLGdDQUFnQyxtRkFBbUYsOEJBQWlELHFCQUN6Z0IscURBQXFELGdDQUFtQyxLQUFFLGFBQWEseURBQXlELHdDQUF3Qyw2QkFBNkIsNk1BQWlOLG1CQUFxQixDQUV4VyxlQUFlLGNBQWMsZUFBZSxNQUFNLEdBQUcsZ0JBQWdCLElBQUksT0FBUSxTQUFVLHlEQUF1RCxXQUFhLGlCQUFrQixDQUFTLGVBQWUsY0FBYyxjQUFjLGdCQUFrQixDQUFTLGNBQWMsUUFBVSxDQUNILGNBQWMsVUFBVSxTQUFXLENBQ3JKLGlCQUF5RCxHQUF4QyxhQUFhLGFBQWEsOENBQWlELGVBQWUsZUFBZSxVQUFVLGFBQWEsU0FBVyxDQUV5RCxpQkFBaUIsVUFBVSxTQUFXLENBQTZHLGVBQWUsVUFBVSxhQUFlLENBRS9WLGNBQWMsYUFBZSxDQUE0RyxnQkFBZ0IsZUFBZSxlQUFlLGlCQUFtQixDQUMxYSxvQkFBb0IsVUFBVSxZQUFZLGdCQUFrQixrWkF0SG5KLHFMQUVBLGlDQUFtQix5RkFJMEosOEJBQTJhLHVDQUFrSyxrREFBME8sa0JBQWtCLDBCQUEwQiwwQ0FBNEMsOEJBQThCLGtMQUE0TSxlQUFnQix5QkFBeUIsZ0JBQWdCLFFBQWUseUJBQXFCLCtDQUE2QywrQ0FBZ0QsZ0JBQWUsbURBQW1ELFlBQVksV0FBVyxpQ0FBaUMsUUFBUywrQ0FBOEMsdURBQXdELGdCQUFlLGlCQUFpRCxHQUFoQyxxRkFBdUYsS0FBSyxLQUFLLGlDQUFpQyxRQUFTLEtBQ3AzRCx3Q0FBd0MsbUNBQXFDLGtCQUFpQiw0Q0FBNEMsSUFBSSw4QkFBZ0Msd0NBQXVDLDRDQUE2QyxnQkFBZSw0Q0FBNEMsSUFBSSxnREFBZ0QsK0NBQ3FOLGVBQWdCLGNBQWEsc0RBQWdHLEdBQUcsbUJBQW1CLE9BQU8sb0JBQW9CLE9BQU8sS0FBSyxRQUFTLHVXQUV6d0IsR0FBRyx3QkFBd0IsTUFBUSxZQUE4QiwwQkFBVyw2QkFBc0MsS0FBMkMsd0NBQVcsMkJBQW9DLDZDQUE2QyxJQUF3QixHQUFyQix3QkFBMkIsWUFBWSxnQ0FBZ0MsU0FBYyxRQUFTLE1BQU8seUJBQ2dJLEdBQ2plLG1FQUFzRSxxQ0FBa0MsUUFBVSw2Q0FBc0Qsd0RBQXdELGlDQUFtQyxjQUFZLGVBQWUsSUFBTyxJQUFFLElBQUksa0VBQXFFLFVBQVUsU0FBUywyQ0FBb0osWUFBYSxzQ0FBc0MseUJBQXlCLG1CQUFtWSxXQUFXLG9CQUE0QixVQUM3Z0MsNkJBQTZCLG1FQUEySCxHQUF4RCxtQ0FBbUMsNEdBQTJDLFFBQU8sR0FBRyxJQUFJLGVBQWUsU0FBUyxPQUFRLFVBQVUsS0FBTSxZQUFjLENBQWtFLHFCQUFxQiwyYUFBbWIscUJBQXFCLDBCQUEwQixtQkFBbUIsc0RBQXNELHVCQUF1QixxQkFBcUIseUJBQXlCLHVCQUF1Qiw4QkFBOEIsaUJBQ3QvQixxREFBcUQsbUJBQW1CLFVBQVUsMkNBQTRDLHVDQUF1QywrQkFBK0IsMkVBQTRFLHNDQUFzQyw4QkFBOEIsY0FBYyxzQkFBdUMsZ0RBQWlDLDREQUEyRCxXQUFZLHFGQUFvUSxXQUFXLCtEQUErRywwQkFBMEIsbUJBQW1CLFlBQVksOEJBQStCLGtCQUFnRyxNQUE5RSw4RUFBd0YsMkJBQTBDLEdBQWYsdUNBQTBDLGdCQUE4QixNQUFkLHNIQUN0b0MsaUJBQWlCLGFBQWEsMEZBQTZGLGlCQUFpQixPQUFrQixXQUFNLGlDQUE2Qix3QkFBd0IsV0FBVyxjQUFjLGlCQUFpQixZQUFhLHVCQUF1Qix1QkFBdUIsU0FBNEIsTUFBbkIsOElBTTNDLG1CQUFtQixjQUFjLHFDQUFxQyxrQkFBbUIsd0NBQXdDLGtCQUM3Wiw0QkFBNEIsZ0JBQWdCLGNBQWMsRUFBRSxpQkFBaUIsVUFBVSxnQkFBZ0Isa0JBQXFCLDZDQUE0QyxPQUFLLFFBQVEsYUFBYSxPQUFTLENBQUssaUNBQTBCLFlBQWlCLDJCQUEyQixrQkFBNkYsR0FBMUUsa0ZBQXVGLGtCQUFrQiw2Q0FBOEMsVUFDaGMsZUFBZSxpQkFBaUIsVUFBVSxjQUFlLHVCQUF1QixtQ0FBd0MsdUJBQXVCLG1DQUF3Qyx1QkFBdUIsNEJBQWtDLGlCQUFpQixlQUFnQixnQkFBZ0IsNkJBQ2pTLHFCQUE0QyxHQUF2Qiw4QkFBc0MsYUFBYSxtQkFBaUIsV0FBVyxFQUFLLEVBQVcsa0NBQTJCLCtCQUErQixpQkFBaUIsc0JBQXdCLG1CQUFtQix1QkFBdUIsK0JBQW9DLG9EQUE2SCxjQUFjLFVBQVUsY0FBYyxlQUFlLFdBQWEsa0JBQWlCLFVBQVUsNkJBQTZCLFdBQVcsZ0ZBQXNILGFBQWMsY0FBYSxTQUFXLEdBQUUsOEJBQThCLGdCQUFnQixXQUFXLGlDQUFpQyxXQUFZLDhCQUE4QixXQUE0RixNQUFqRixrRkFBMkYsMkJBQTJCLFdBQVksMEJBQTBCLGlCQUNoL0IsK0JBQStCLFVBQVUsYUFBYSxnQkFBaUIsOEJBQThCLG9FQUdnbEIsZUFBZSxhQUFhLFNBQVMsMEJBQTBCLFVBQVUscUVBQXVFLGdCQUFnQixpQkFBaUIsa0JBQWtCLHlLQUE4SyxnQkFBZ0IsNEJBQ3RqQyxtQkFBbUIsZ0JBQWdCLGtFQUFvRSxrQkFBa0IsZ0JBQWdCLG9EQUFzRCxlQUFlLGtCQUFrQixZQUFZLHdCQUE0VSxlQUFlLFFBQVEsT0FBTyxTQUFTLGdCQUFpQixrQkFBa0Isc0NBQXVDLGtCQUFrQixvRUFBd0UsbUJBQW1CLFdBQVksb0JBQW9CLFVBQVUsbURBQXFELGVBQWUsa0JBQWtCLGFBQ3Q1QixnQkFBZ0IsWUFBWSwyQ0FBNkMsZ0JBQWdCLDJCQUEyQixxQ0FBc0YsVUFBVSxlQUFlLHVCQUF1Qix5QkFBeUIsdUJBQXVCLHFDQUFzQyxjQUFZLDJEQUF3RSxXQUF4RCxJQUFvRSxnQkFBaUIsYUFBYSx1QkFBdUIseUJBQ3JlLHlCQUF5QixvQkFBb0IsV0FBVyx1QkFBMEIsUUFBcUQsR0FBaEQsK0RBQWtFLGVBQWlCLGNBQWEseUJBQXlCLG9CQUFvQixXQUFXLHVCQUEwQiw4S0FDelEsZ0JBQWdCLHdCQUF3QiwrQkFBaUMsUUFBTyxXQUFZLGVBQWUsa0JBQWtCLFdBQVkseUJBQXlCLDZFQUFpSSw4QkFBc0MsVUFBVSxnQkFBaUIsMkJBQTJCLFdBQVksMkJBQTJCLDJDQUFxSixrQkFBa0Isb0hBQW9ILGVBQWUscUJBQXFCLGdCQUFnQix1QkFBdUIsZ0JBQWdCLGdCQUFzQyxNQUF0QixtQkFBb0IsYUFBa0IsaUJBQWlCLFdBQ24yQixlQUFnQixxQkFBMEIseUJBQStCLEdBQW9DLHdDQUFhLGlCQUFpQixpQ0FBaUMsc0JBQXNCLHFEQUF1RCxxQkFBNkQsTUFBeEMseUJBQTZCLGNBQXFCLG1CQUFtQixrQkFBbUIsa0JBQWtCLGtCQUFtQixxQkFBcUIsa0JBQW1CLGlCQUFpQix1QkFDcGMsaUJBQWlCLGVBQWlCLDRCQUE0QixpQkFBaUIseUJBQXlCLGFBQWEsVUFBVyxpQkFBaUIsV0FBWSxtQkFBbUIsZ0JBQWlCLE9BQVMsMEJBQXFXLGdCQUFnQixZQUFhLHlCQUF5QixXQUFXLHFCQUFxQixtRUFBb0UsSUFBSSwyQkFBMkIscUJBQXFCLHFFQUFzRSxJQUFJLHFCQUFxQixXQUFXLHFCQUFxQixtREFBb0QsSUFDaDdCLGlCQUFpQixxQkFBcUIsbUJBQW9CLElBQUksb0JBQW9CLGFBQWMsbUJBQW1CLGFBQWEsMkJBQTRCLG1CQUFtQixjQUFlLGdCQUFnQixhQUFhLGtCQUFtQixpQkFBaUIsYUFBYSxtQkFDNVEsaUJBQWlCLHFCQUFxQixrQkFBa0IsSUFBSSxvQkFBb0IsaUJBQWlCLFdBQVcsMkJBQTJCLFlBQWEsVUFBUyxtRkFBb0YsaUJBQWlCLDhDQUErQyxXQUFXLDRDQUE0QyxXQUFXLGNBQ25YLGlCQUFpQixxQkFBcUIsa0JBQWtCLFNBQVMsZUFBZSxjQUFZLFdBQWdCLElBQXNCLGlDQUFlLFdBQVcsT0FBTyxtQkFBbUIsK0RBQWlFLFVBQVUsNENBQXllLDJEQUE4RCxPQUFRLHVNQUFzTiwyQkFBMkIsNENBQTJELCtDQUErRyxnQkFBK0IsMkJBQTJCLGdCQUFnQixrREFBa0QsMkJBQTJCLFNBQXVDLE1BQTlCLGlDQUMzMkMsMkJBQTJCLG9GQUFvRixpR0FBK0YsV0FBVyxJQUFLLFFBQVcsSUFBSSxxQ0FBdUMsV0FBVywwR0FBMkcsaUJBQWdCLHlCQUM3TixTQUFPLGNBQWMsaUJBQWlCLFVBQVcseUJBQXlCLFdBQVksaUJBQWlCLFdBQVksaUJBQWlCLFdBQVksZ0JBQWdCLGdCQUFnQixtQkFBbUIsVUFBVSx1QkFBdUIsVUFBVSxXQUFXLGVBQ3RiLHFCQUFxQixVQUFVLHVCQUF1QixhQUFhLFVBQVUsWUFDN0UsaUJBQWlCLFlBQVksVUFBVSx3QkFBd0Isd0JBQXdCLFVBQVUscUNBQXFDLDREQUE0RCw4Q0FBOEMsdUJBQXVCLHFMQUF3TCxLQUFLLG1EQUNwYyxpQkFBaUIsV0FBVyxjQUFjLCtFQUFpRixpQkFBaUIsSUFBSSxzRUFBd0UsVUFBUyxtRkFBb0YsV0FBVyx1QkFBdUIsK0JBQWdDLEVBQUcscUNBQXNDLFlBQ2hhLGdCQUFnQiw4Q0FBOEMsb0NBQW9DLDRDQUE0QyxVQUFVLGtCQUF5QyxHQUF2QixTQUFTLGtCQUFxQixXQUFXLHdCQUF3QixtREFBb0QsRUFBRyxDQUE0RCxpQkFBOUMsc0RBQXlELDRIQUFpSSxPQUN0WSxPQUQyWSxXQUMvZSxTQUFTLE1BQU0saUVBQWlFLGNBQVUsV0FBaUIseUZBQTJGLGdCQUFnQiw4REFBaUUsZ01BQXNNLGdCQUFnQiwwQkFDN2UsZ0JBQWdCLFdBQVcsMkNBQTJDLHFCQUFzQixjQUFhLGdCQUFnQixZQUN6SCxtQkFBbUIsZUFBYSxvQkFBNkIsUUFBaUIsdUJBQVUsNEJBQThCLCtDQUErQyxLQUFNLGdCQUFlLFNBQVMsTUFBTSxzQ0FBc0MsS0FBSyxLQUFNLDBDQUEyQyx5Q0FBMkMsaUJBQWlCLDJFQUNqVyxnQkFBZ0IsV0FBVyxnQ0FBZ0MscUVBQXdFLGdCQUFnQixtQ0FBbUMsaUJBQWtCLGlCQUFpQiwrQkFBa0MsbUJBQW1CLGlCQUEyQixpQkFBc0IsR0FBSyxvQkFBMEIsZ0JBQWdCLFVBQVksTUFDMVgsaUJBQWlCLFVBQVUsdUJBQXVCLEtBQUssdUZBQXVGLDRDQUE2QyxpREFBa0QsWUFBWSxXQUFZLG9CQUFvQixXQUFXLFdBQVksaUJBQWlCLHNCQUFzQixnQ0FBa0MsZ0JBQWdCLG9CQUFvQixrQkFDN1osaUJBQWlCLHdEQUF3RCw4QkFBK0IsZ0JBQWdCLGlEQUFtRCxnQkFBZ0IsYUFBYSxVQUFVLHlGQUEyRixnQkFBZ0IsdUZBQXVGLG1CQUFtQix5QkFBMEIsVUFBVSxTQUFTLFdBQ3BkLGdCQUFnQix1Q0FBd0MsZ0JBQWdCLFVBQVUsY0FBYyxtQ0FBbUMsYUFBYSxlQUFlLGFBQWEsaURBQXFELGdCQUFnQixlQUFlLGlCQUFpQixJQUFJLHNCQUF5QixVQUFTLDZEQUNtUSxlQUFlLGVBQWUsZUFBZSxVQUFVLGlCQUFpQixnQkFBZ0IsOEJBQThCLFVBQVUsZUFBeUIsTUFBViw0QkFBa0MsaUJBQWlCLG9CQUFvQixlQUFlLGtCQUMveEIsbUJBQW1CLFVBQVUsd0JBQXlCLHFCQUFxQix1RkFBMkYsZ0JBQWdCLDBCQUEwQixrQkFBZ0IsU0FBa0Isb0JBQWdCLDZCQUE2QixJQUFLLGVBQWlCLDJCQUEwQixTQUFTLFVBQVUsU0FBZ0IsdURBQW1ELGtCQUFtQixvQkFBb0IsZ0NBQzVjLG9CQUFvQix1Q0FBd0MsYUFBYyxxQkFBcUIsc0NBQXNDLFdBQVcsMEJBQStCLHVDQUFtQyx3QkFBd0IsdUJBQXVCLFdBQVcsS0FBSyx5QkFBeUIscUJBQXNCLG1CQUFtQixnS0FDblYsc0JBQXNCLG1CQUFtQiwyQkFBMkIsV0FBYyxHQUF3VixpSEFBcE4sNkRBQXVELHNHQUE4Riw2QkFBNkIsOENBQ3hZLHNCQUFzQiw0QkFBNEIsc0JBQXNCLHNCQUFzQixzQkFBc0IsVUFBVSxZQUFnQixzQkFBa0IsbURBQXFELE9BQUssMkJBQTJCLDhCQUFnQyxDQUFJLHlCQUF3QixxREFBa0QsMEJBQTBCLGVBQWUsbUJBQWlCLElBQWEsaUJBQWEscUVBQ3ZiLGdFQUFtRSxhQUFlLFNBQVUsQ0FBOEQsMEJBQTNDLDZCQUE2QixpQkFBd0IsbUJBQW1CLG9CQUFvQixtQkFBbUIsS0FBUyxnRUFBMkQsZ0JBQWdCLGlCQUFpQixtQkFBbUIsU0FBUyxtQkFBb0IsZ0JBQWdCLGlCQUFpQixtQkFBbUIsU0FBUyxzQkFBdUIsZ0JBQWdCLGlCQUN2ZCxpQkFBMEIsR0FBVCxZQUEyQixHQUFaLHFEQUErRCxTQUFXLG9CQUFvQixnQkFBZ0Isc0JBQXNCLG1CQUFtQixTQUFTLHFCQUFzQixnQkFBZ0IsZ0JBQWdCLGdCQUFnQiw4QkFBOEIsbUJBQW1CLFNBQVMsd0ZBQTJGLGdCQUFnQiwwQkFBMEIsc0JBQXNCLGtCQUMzZCxrQkFBa0IsU0FBUyxpQkFBa0IsbUJBQW1CLFNBQVMsaUJBQXNCLGdCQUFpQixtQkFBbUIsU0FBUyxtQkFBb0IsZ0JBQWdCLGlCQUFpQixnQkFBd0osTUFBeEksVUFBUyx1SUFBNEksOEJBQXdELE1BQTFCLFVBQVMsdUJBQThCLGVBQWUsMkRBQzFiLGlCQUFpQixTQUFTLHNHQUM0TSxlQUFlLDZDQUErQyxXQUFXLHlCQUF5QixpREFBbUQsS0FBSyxlQUF3QixNQUFULGtCQUMvWSxvQkFBb0IsU0FBUyxVQUFVLGFBQWEsb0JBQThELE1BQTFDLHVCQUFzQixVQUFVLGdCQUF1QixxQkFBMkMsTUFBdEIsVUFBUyx3RkFBaUcsbUJBQW1CLFVBQVUsWUFBWSxVQUFXLGVBQXdCLE1BQVQscUJBQTJCLGlCQUF1QyxNQUF0QixVQUFTLDJCQUN0WCx3QkFBd0IsU0FBUyw2QkFBNkIsaUJBQWlCLGtCQUFvQixPQUFRLFNBQVMsZUFBZSxTQUFTLDJDQUEyQyxXQUFXLHVCQUF1QixXQUFXLGlCQUFpQixVQUFVLGdCQUFnQixTQUFTLFNBQVMsK0NBQXFELFdBQUssYUFBYSxZQUFZLFdBQVcsZ0JBQWtCLFdBQ2paLG9CQUEySCxNQUF2RyxVQUFTLFVBQVUsYUFBYSwyQ0FBMkMsa0JBQWtCLGdCQUF1QixtQkFBb0IsV0FBZSxTQUFZLDRCQUFrQyxtQkFBbUIsZUFBZSx1RUFDM1Asc0JBQXNCLDBCQUEwQixvQkFBb0IsOEJBQThCLFdBQVcsS0FBSyxzQ0FBMkMsWUFBWSxjQUFZLFdBQWdCLFFBQVEsZ0RBQXFELFNBQVksNkJBQTRCLGdCQUFnQixjQUFlLG1CQUFtQixhQUFtRSxNQUF0RCxjQUFhLDJDQUFtRCxpQkFBeUQsTUFBeEMsT0FBWSwrQkFDdGMsaUJBQWlCLDZEQUErRCxzQkFBc0IsbUNBQXNDLFNBQVEsVUFBVyxvQkFBcUIsWUFBWSxtQkFBbUIsa0NBQWtDLGFBQWUsU0FBdUMsRUFBZixnQkFBZixnQ0FBbUssU0FBUyxpQkFBaUIsVUFBVyxzQkFBc0IsU0FBUyxvQkFBb0IsS0FBSyxtQkFBbUIsc09BQ2hpQixnQkFBZ0IsaURBQWlELG1CQUFtQixtQ0FBbUMsZ0JBQTJGLDREQUFtRSxTQUFLLCtDQUErQyxrQkFBa0IsZ0NBQWdDLEtBQUssdUJBQXVCLDRCQUE0QixlQUFlLDBCQUEyQixpQkFBaUIscUJBQzllLG1CQUFtQixzQ0FBdUMsV0FBWSxnQkFBZ0IsVUFDdEYsbUJBQThCLEdBQVgsOEhBQXNaLGtMQUF0VCxJQUFJLHFCQUF1QixVQUFzQyxNQUE3QixrQkFBYSxnQkFBdUIsd0JBQXlCLGtFQUF3RSxPQUM1UixnQkFBZ0IsZ0JBQWdCLDBNQUF3TyxpR0FBZ0csNkxBQTBLLGlCQUFpQix3QkFBd0IscUNBQXFDLGlCQUFpQiwwSEFBMkgsZ0JBQWdCLG9CQUFvQixnQkFBZ0Isb0JBQW9CLGdCQUFnQixrQ0FBc08sZUFBZSxtQkFBbUIsa0JBQWtCLHFCQUFzQixxQkFBcUIsUUFBUSx1QkFBdUIsSUFBSSxvQkFBcUIsaUJBQWlCLFFBQVEsdUJBQXVCLElBQUksdUJBQXdCLHFCQUFxQiw2QkFBNkIsbUJBQW1CLGdCQUFpQixlQUFlLG1CQUNsM0MsdUJBQXVCLHlCQUF5QixlQUFlLG1CQUFtQixtQkFBbUIsK0JBQTRZLGVBQWUsaUJBQWlCLGtKQUNqaEIsZ0JBQWdCLCtDQUFnRCxnQkFBZ0IscUNBQXFDLGlCQUFpQixzREFBc0QsaUJBQWlCLCtCQUFnQyxpQkFBaUIsNEVBQTZFLG9CQUFvQixrQkFBa0IscUZBQXNGLFVBQVksb0JBQ25kLGdCQUFnQixtREFBbUQsOEJBQThCLGNBQThELE1BQWhELDJCQUEwQixrQkFBb0IsSUFBVyxxQkFBb0IsaUJBQWlCLDJCQUE0QixnQkFBZ0IscURBQTRGLG9DQUFvQywrQkFBK0IsZ0VBQThGLFlBQVksSUFBSSxtQkFBbUIsUUFBUSxnQkFBZ0IscUNBQXVDLEVBQUcsVUFBUywwREFBNEQsZ0NBQWdDLFdBQWMsTUFBRSxnQkFBbUIsNERBQTZELGlCQUFpQixJQUFJLEtBQUssMEJBQStCLEdBQUwsdUNBQTRDLFdBQVMseUJBQTJCLFdBQVUsU0FBVywyQkFDejdCLDRCQUE0QixvREFBc3ZCLFVBQVUsbUNBQW1DLHFDQUFxQyxjQUFjLGlCQUFpQixXQUNuNEIseUJBQXlCLHdGQUEwRixlQUFhLDBCQUEwQixVQUFVLFVBQVUsVUFBVSxVQUFVLFdBQVcsV0FBVyxpQkFBaUIscUNBQXFDLDBDQUEwQyxpRUFBaUUsYUFBZSxtRUFBbUUsSUFBSSx5Q0FDL2Msb0NBQTZDLFVBQXVFLE1BQTlELHdEQUFtRCxXQUFrQixTQUFRLDJCQUEyQixzQkFBc0IsVUFBWSxHQUFFLFlBQVksc0NBQXNDLDJDQUE4RSxtREFBZ0Isd0JBQXdCLDRCQUE4QixRQUFPLHVDQUF1QyxzRkFDdGIsU0FBUyxJQUFJLHVTQUFpVCxVQUFTLHlFQUNsUSxxQ0FBcUMsZ0JBQWdCLHNLQUEySyxpQkFBaUIsV0FBVywrQ0FBaUQsU0FBUyxVQUFVLFVBQVUsV0FBWSxnQkFBZ0Isa0ZBQzNhLG9CQUFvQixvTEFBNkwsZUFBZSxpRkFBcUYsa0JBQW1CLGdCQUFnQiwwREFBMkQsZ0JBQWdCLFdBQ25hLGdCQUFnQixnR0FBNkksd0ZBQWlELGdFQUEyRCxzQ0FBc0MsV0FBVyxJQUFJLGtJQUF1SSxTQUFRLGFBQzdjLG1CQUFtQixxQ0FBcUMsa0ZBQXFMLFdBQVcsVUFBVSxrQ0FBa0Msb0JBQW9CLCtCQUErQixJQUFJLHNCQUF3QixVQUFTLDJGQUM1WCxnQkFBZ0IseUNBQXlDLGlEQUFtRCxnQkFBZ0IsZ0JBQWdCLGdCQUFnQixxQkFBcUIsZ0JBQWdCLGdCQUFnQixZQUFZLHlFQUF5RSxRQUFRLGNBQWMsNkJBQzVULGdCQUFnQixzQ0FBNkgsTUFBcEYsa0hBQTBILGdCQUFnQixtQ0FBbUMsZ0JBQWdCLElBQUksbUNBQW9DLFVBQVMsV0FBVyxnQkFBZ0IsSUFBSSx1Q0FBd0MsVUFBUyx1REFDdlgsZ0JBQWdCLElBQUksb0NBQXFDLFVBQVMsNkRBQThELGlCQUFpQixXQUFXLDBCQUF3RSxNQUE5Qyx1REFBNkQsZ0NBQWdDLDZFQUE4RSxtQ0FBbUMsZ0VBQ3BZLGlCQUFpQixnREFBZ0QsZ0JBQWdCLGdCQUFnQixnQkFBZ0IsbUNBQXdDLGlCQUFpQixvRUFDZ1QsT0FBTyxNQUNqZSw4QkFBOEIsMEJBQTBCLEtBQUssU0FBUyxjQUFjLCtDQUFnRCx3RkFBMEYsWUFBYSx3QkFBK0QsR0FBdkMsNkJBQTZCLHFCQUF3QixrQ0FBa0MsbUJBQW1CLGFBQWEsd0JBQXdCLDhDQUFXLE1BQTZDLFlBQzFjLGlCQUFpQiwrQkFBK0IsNEJBQTRCLGtDQUFrQyxRQUFRLHdDQUF3QyxvQkFBcUIsZ0JBQWdCLGtDQUFrQyx3QkFBd0IsV0FBWSxnQkFBZ0Isd0NBQXlDLHNDQUF1QyxnREFBaUQsVUFBVSxnQkFBZ0IsaURBQ3BiLGlCQUFpQixVQUFXLGlCQUFpQixXQUFZLGlCQUFpQixVQUFXLGlCQUFpQixXQUFZLGlCQUFpQixXQUFZLGlCQUFpQixXQUFZLGdCQUFnQixZQUFhLGlCQUFpQixVQUFXLGdCQUFnQixnQkFBZ0IsaUJBQWlCLHlDQUF5QywwREFBMkQsR0FBRSxpQ0FBaUMsc0JBQXVCLGdCQUFnQiwwQkFBMEIsZ0JBQWdCLGtCQUM5ZSxzQkFBc0IsZUFBZSxnQkFBZ0IsZ0VBQWtFLGdCQUFpQixtR0FBdUcsMkdBQXFILGdEQUFxRCxvQ0FBb0MsOENBQThDLEtBQVUsVUFDcmYsaUJBQWlCLGFBQWEsWUFBYSxpQkFBaUIscUNBQXFDLHVWQUNqRyxnQkFBZ0Isd0JBQXdCLHVDQUFzQywwREFBMEQsK0NBQWdELHVCQUF1QixtQ0FBbUMsYUFBYSwrQkFBK0IsbURBQW1ELFdBQVcsMEJBQTBCLGFBQWEseUVBQ25ZLGdCQUFpQixrQkFBc0IsdUJBQXNCLG1CQUFtQixhQUFhLG1CQUFtQixXQUFXLG9DQUFvQyx5Q0FBeUMsNEJBQTRCLGNBQWMsYUFBYSwwRUFBMEUsYUFBYSxXQUFZLGlCQUFpQixXQUFhLGlCQUFlLFFBQVUsSUFDelosaUJBQWlCLHlFQUEySCxNQUFsRCwwQkFBeUIsNEJBQW1DLGlCQUFpQiw4QkFBK0IsZ0JBQWdCLHNCQUFzQixVQUFVLGNBQWMsU0FBUyxpQkFBa0IsZUFBZSxZQUM5UyxlQUFnQixtRUFBdUUsbUJBQXVCLG1DQUFtQyxVQUFVLDRDQUE0QyxLQUFVLFVBQVUsZ0JBQWdCLGFBQWEsV0FDeFAsZ0JBQWdCLHlDQUF5QyxnREFBZ0QsaUNBQWlDLG1CQUFtQixzQkFBc0IsaUJBQWlCLG1CQUFtQiwwQkFBMEIsbUJBQW1CLFdBQVcsc0JBQXNCLG9DQUFvQyxvQ0FBb0Msd0JBQXdCLHFDQUNyWSxtQkFBbUIseUNBQXlDLFdBQVcsZ0JBQWdCLG1CQUFtQixXQUFXLFdBQVksaUJBQWlCLHVDQUF1QyxXQUFXLFlBQ3BNLG1CQUFtQixzRkFBdUYsSUFBSSxtQkFBcUIsVUFBUyxNQUFRLDZGQUErRix5RUFDblAsbUJBQW1CLHdNQUNuQixpQkFBMkUsR0FBMUQsK0VBQWdJLG1EQUFLLDRIQUF3RSxTQUFZLFFBQTBELFVBQVUsUUFBUyxpQkFBaUIsd0NBQXdDLGlCQUFpQiwyQ0FDalksZ0JBQWdCLDJFQUFnRixnQkFBZ0IsdURBQ2hILGlCQUFpQixpQ0FBaUMsV0FBVyxjQUFjLFVBQVUsWUFBWSxPQUFTLDhDQUFpRCxjQUF1QixHQUFYLDBGQUFtRyxVQUFLLGFBQWEscUNBQXVFLHVDQUFLLFdBQW9GLEdBQXpFLHdCQUF3Qiw4Q0FBK0MsNENBQThDLDhDQUFnRCxJQUN4aEIseUJBQXlCLGFBQTJDLGtDQUFVLFVBQXdCLGlCQUF5QixrQkFBd0IsZ0JBQXVCLGlCQUFpQixpREFBb0csTUFBcEQseURBQWdFLGlCQUFpQixxQkFBcUIscUNBQXFDLGdCQUFnQiw2SUFDMVksbUJBQW1CLDBDQUF3QyxXQUFnQixJQUErQixVQUFwQixhQUFhLHlCQUNuRywwTUFEcUksYUFBYSxzQkFBc0IsV0FBVyxpREFBa0QsT0FBTyxrREFBbUQsT0FBTyxrR0FBbUcsV0FBVyxTQUFTLG9CQUFvQixVQUFZLDBDQUE0QyxHQUNqVCxtQ0FBb0MsaUJBQWlCLGdDQUFnQyxzSEFDN1EsaUJBQThDLEdBQTdCLG1DQUFzQyxXQUFXLGlCQUFpQixzQkFBc0IsbUhBQXFILGtCQUFvQixXQUFVLFlBQWEsaUJBQWlCLHdHQUEyRyxpQkFBaUIsd0NBQXdDLFNBQVMscUJBQXFCLFVBQVUsV0FDdGUsZ0JBQW1DLEdBQW5CLFNBQVMsa0JBQXFCLGtCQUFrQixrQ0FBa0MsV0FBVyx3QkFBd0IsZ0ZBQWlGLEdBQUUsWUFBWSxXQUFXLGVBQWlCLGVBQWUsaUJBQTRFLE1BQTNELG1CQUFrQiw0Q0FBbUQsbUJBQXVGLE1BQXBFLCtCQUE4Qix5Q0FDdFosbUJBQW1CLFlBQVksdUNBQTRDLFNBQUssaUJBQWlCLHdEQUEwRCxDQUErRyx5Q0FBN0UsUUFBVSxHQUFFLFVBQVUsVUFBVSxlQUFlLG1CQUFtQixjQUFxQixpQkFBaUIsbUZBQWlILE1BQS9CLGtCQUFpQixpQkFBd0IsZ0JBQWdCLDZCQUE2QixnQkFBZ0IsK0JBQThDLFVBQVUsa0JBQWtCLGtCQUFrQixrQkFBa0Isa0JBQWtCLGdCQUFnQixVQUFVLGtCQUFrQixpQkFBaUIsd0NBQThWLDBCQUV0aUIsY0FDbGQscUNBQXFDLHlDQUEwQyx3Q0FBd0MsNENBQTZDLGtCQUFrQixtQkFBbUIscUJBQXFCLGlEQUFrRCxtQkFBbUIscUJBQXNCLG1CQUFtQixTQUFTLFNBQVMsYUFBYSxZQUFjLGlCQUFrQixnREFDM1ksZUFBZSxnQkFBZ0IsZUFBZSxvQkFBb0IsY0FBYyw0Q0FBbVQsMEJBQTBCLCtDQUErQywyQkFBNEIsMkJBQTJCLGlDQUNuZ0IsMkJBQTJCLDRFQUE0RSxpQ0FBa0MsMEJBQTBCLCtDQUErQywyQkFBNEIscUJBQXVCLGFBQWMseUJBQXdCLFlBQStELE1BQW5ELHFEQUE0RCxxQkFBdUQsZ0JBQWdCLDhEQUFpRSxzQkFBc0IsZ0JBQWlCLGdCQUEwQixNQUFWLHlCQUErQixlQUFlLG9DQUFvQyxlQUFlLDJDQUEyQyxtQkFBbUIsVUFBVSxXQUFZLHVCQUF1Qix5Q0FDOXZCLG9CQUFxQixZQUFhLFlBQW1FLE1BQXJELHNFQUE2RSxlQUFlLCtCQUErQixLQUFLLHNCQUFzQixvQkFBb0IsUUFBUSxJQUFJLHNCQUFzQixrQkFBOEssNkRBQTZELGVBQWUsZ0JBQWdCLFVBQVUsd0NBQXdDLGdCQUErQyxNQUEvQixtQ0FBMEMsaUJBQWlCLDRDQUNub0IsZ0JBQWdCLFVBQVUsc0NBQTJDLGVBQStDLE1BQXBDLHVDQUE4QyxpQkFBaUIsa0JBQWtCLDREQUE2RCxnQkFBZ0Isa0JBQWtCLGNBQWlCLHlCQUFzQixLQUFLLHlCQUE4Qix1QkFBbUIsZ0JBQWdCLFVBQVUsaUJBQWlCLDZCQUFrQyxvQ0FDMWEsaUJBQWlCLHVDQUF5Qyx1QkFBdUIsaURBQWlELGVBQWUsZ0NBQWdDLGdCQUFnQixvQkFBb0IsZ0JBQWdCLG9CQUFvQixlQUFlLGlDQUFpQyxlQUFpQyxHQUFsQixzRkFBeUYsZUFBZSxrQkFBa0IsR0FBTyxxQkFBaUIsK0NBQXNGLGdCQUFnQiw4QkFBOEIsK0NBQXVGLG1CQUFtQixhQUFhLG9CQUFvQixxQkFBc0IsaUJBQWlCLG9CQUFvQixZQUFvQixHQUFSLHFCQUF3QixxQkFBcUIsV0FBVyw4QkFBOEIsT0FBUSxzQkFBc0IsUUFBUSxXQUFXLHdCQUF5QixvQkFBb0IsK0JBQStCLDREQUNuL0IsZ0JBQWdCLHVDQUF1QyxLQUFPLElBQUUsOEJBQXFFLEdBQXZDLHNFQUF5RSxVQUFVLEdBQUssU0FBUyxpQkFBaUIsMEJBQXdCLEVBQU0sY0FBaUIsMENBQTJDLEVBQVcsUUFBUyxpQkFBaUIsY0FBYyxpQkFBaUIsY0FBYyxpQkFBaUIsZUFBZSxlQUFlLHFDQUFxQyxJQUFJLG9CQUFvQixVQUN4ZSxlQUFlLHFDQUFxQyxJQUFJLDBCQUEwQixVQUFVLGlCQUFpQiw2QkFBNkIsb0JBQXFCLElBQUcsbUJBQW1CLHFCQUFxQixlQUFlLHNCQUFzQixlQUFlLHlCQUF5QixtQkFBbUIscUJBQW1ELG1DQUFtQyxjQUFlLDJCQUEyQiw4QkFBK0YsY0FBYyxrQkFBbUIsZUFBK0Ysb0NBQW9DLGdHQUFZLGdCQUFnQixvQkFBa0IsSUFBVSxhQUFnQiw0QkFBNEIsS0FBYSxpQkFBaUIsb0JBQW9CLFdBQVksZ0JBQWdCLGtCQUFrQixXQUNqM0IsZUFBZSxpQkFBaUIsd0JBQXdCLGdCQUFnQixxQkFBa0YsMEJBQTBCLHNCQUF5RixNQUFuRSw0QkFBMkIsa0JBQW9CLEdBQUUscUJBQTRCLDJCQUEyQixzQkFBc0IsOENBQThDLGtDQUFrQyxrQ0FBa0Msb0NBQW9DLGNBQWMsYUFBYSxnQkFBZ0IsdUJBQXVCLGVBQWUsV0FBVyxZQUFZLFlBQVksY0FBYyxrQ0FBa0MscUNBQXFDLHlDQUF5QyxzQ0FBc0Msd0NBQXdDLDRDQUM5eEIscUNBQXFDLHlDQUF5QywyQ0FBMkMsMkNBQTJDLDJDQUEyQyw2QkFBa0MsY0FBUywrRUFDMVAsYUFDQSxvQ0FDQSxvQkFDQSxvQkFDQSxxQkFFQSx5Q0FDUSxvR0M3RlIsQ0FNQSxpRUFDQSxtQ0FDQSxhQUNBLG1CQUNBLG1EQUNBLHFCQUNBLE9BSUEsK0ZBSEEsUUFDQSx3RUFHQSwyQkFFQSx5QkFDQSwwQkFDQSw4QkFFQSxzQ0FDQSxDQUNBLDRDQUVBLHlDQUNBLFVBRUEsMkJBQ0EsQ0FDQSw0Q0FFQSw0Q0FDQSxVQUVBLEVBQ0EsSUFDQSxDQVVBLENBL0NBLHVDQUdBLFNBb0VBLHlCQXZCQSx5QkFDQSxJQUNBLHlDQUNHLGdEQUNILGdHQUVBLDJCQUVBLDZEQUlBLEVBWUEsZSxtQkFYQSxrQ0FDQSxJQUNBLG1GQUNHLGtDQUNILHdGQUVBLDBCQUVBLG1GQ3ZHQSxDQUVBLDBCQUVBLG1DQUVBLCtCQXFEQSx3QkFDQSw0QkFDQSw0QkFFQSx1QkFDQSx1QkFDQSx1QkFFQSxvQkFDQSxhQUVBLGFBQ0EsYUFFQSxhQUNBLGFBRUEsZUFDQSxlQUVBLGVBQ0EsZUFFQSxnQkFFQSxTQUNBLGtCQUNBLGdCQUNBLGdCQUdBLFFBQ0Esa0JBQ0EsZ0JBQ0EsZ0JBR0EsZUFDQSxrQkFDQSxrQkFFQSxrQkFDQSxrQkFDQSxrQkFFQSxLQUVBLHlCQW9DQSxxQkFDQSxhQUVBLFVBSUEsWUFDQSx1Q0FJQSxpQ0FDQSxzQkFDQSxhQUVBLHVCQUNBLHNCQUNBLHNCQUNBLGtCQUVBLENBRUEsb0JBOUpBLDBCQUtBLGNBQ0Esa0NBQ0EsOEJBQ0EsNEJBRUEsR0FLQSx5QkFKQSwySUFLQSxvQ0FDQSxnQ0FDQSx3QkFFQSxpQ0FFQSxhQUVBLDBHQUlBLHdDQUVBLG1CQUVBLEtBQWtCLElBQWUsVUFFakMsc0JBQ0EsMEJBSUEseUJBQ0EscUJBQ0EscUJBRUEsc0JBQ0Esc0JBQ0Esc0JBRUEsdUJBQ0EsdUJBRUEsd0JBbURBLE9BRUEsNEJBQ0EsT0FDQSxnQkFLQSxnQ0FBc0MsU0FBUSxLQUU5Qyx1QkFFQSxlQUNBLGtCQUVBLHVCQUEyQyxRQUFRLE1BRW5ELEVBQ0EseUJBQ0EsYUFDQSxhQU9BLGlEQUNBLHlDQUNBLHNCQTJCc0MsV0F6QnRDLE9BeUI4QyxLQUU5Qyx1QkFFQSxlQUNBLGtCQUVBLHVCQUEyQyxRQUFRLE1BRW5ELHlCQUNBLDJCQUNBLDJCQU1BLEdBTUEsc0RBRUEsbUJBRUEsNEVBQ0EsbUVBRUEsNkJBQ0EsbUJBRUEsNEJBRUEsc0JBRUEsSUFBa0Isd0JBQXVCLFdBRXpDLHdCQUlBLDRDQUlBLDBDQUVBLG9DQUVBLG1EQUVBLDhDQUVBLE1BSUEsMENBRUEseUNBRUEsNkRBRUEsd0RBRUEsTUFJQSxtQkFFQSwwRkFDQSx3REFJQSxxQkFFQSxJQUVBLFVBRUEsK0JBRUssMkNBRUwsNENBSUEsaUJBSUEsMkNBRUEsV0FFQSxLQUVBLENBSUEsY0FFQSxxQkFDQSxjQUVBLEtBQW1CLHFCQUF1QixXQUUxQyxxQkFFQSxnQkFBb0IsVUFBaUIsUUFFckMsaUNBSUEsNERBRUEsS0FFQSx5QkFFQSxZQUlBLDRCQUVBLDJEQUVBLGlDQUVBLHVDQUVBLGdCQUlBLGlDQUVBLDhDQUVBLDhCQUVBLHFFQUNBLHdDQUVBLGFBQW1CLDJCQUFxQixvQkFFeEMsd0JBRUEsYUFBb0IsMEJBQW9DLFNBRXhELHVEQUlBLHdEQUVBLHVEQUVBLGdEQUVBLHFCQUVBLENBRUEsT0FFQSxlQU1BLDRDQUVBLHFCQUtBLElBQWtCLEVBSmxCLFdBQ0EsU0FDQSxrQ0FFeUMsV0FFekMseUJBRUEsZ0RBRUEseURBQ0EsNERBRUEsK0NBQ0EsOENBRUEsbURBQ0Esb0RBRUEsbUNBRUEsTUFFQSw4QkFDQSxvQkFFQSxJQUFrQixlQUF1QixTQUV6QyxnQ0FFQSxvQ0FJQSx1REFFQSxXQUVBLGNDdlhBLHlEQTZCQSxzQkEzQkEsK0NBRUEsZ0NBa1FBLDhCQUVBLGVBRUEsd0JBRUEsNEJBRUEsVUFFQSwyQkFFQSx1QkFFQSxLQUVBLHlCQUVBLHFCQUVBLEtBRUEsNkJBeUVBLGNBRUEsMkJBRUcsd0JBRUgsMEdBQ0EsMEJBQ0EseUJBSUEsOEJBQ0EsNkZBSUEsY0FFQSw4QkFFQSxjQUVBLDJCQUVHLHdCQUVILDBHQUNBLDBCQUNBLHlCQUlBLDhCQUNBLDZGQUlBLGNBTUEsc0NBSUEscUNBRUEsUUFFQSxxQ0FJQSxvQ0FFQSxRQUVBLG1DQUlBLGtDQUVBLFFBRUEsc0NBSUEsbUNBQ0EsMENBRUEsaUZBR0Esd0VBR0EseUVBRUEsOEJBRUEsaUJBRUEsUUFFQSxxQ0FJQSxrQ0FFQSx3Q0FFQSxZQUVBLHVCQUVHLGdCQUVILHlCQUlBLGdDQUVBLGdCQUVBLFFBRUEsbUNBSUEsZ0NBRUEsb0NBRUEsa0NBRUEsaUJBRUEsY0FFQSxRQUVBLHlCQUlBLENBRUEsaUNBSUEsQ0FFQSx3QkFFRyxnQkFFSCx3QkFJQSxzQkFFQSxRQUVBLDhCQUlBLGNBRUEseUJBQ0EsZUFDQSxtQkFDQSxTQUVBLHNCQUNBLG9CQUNBLG1CQUNBLFNBRUEsc0JBQ0EsMkJBQ0EsU0FDQSxTQUVBLHNCQUNBLDZCQUNBLFNBS0EsVUFFQSx1Q0FJQSx5REFFQSxNQUVBLHNDQUlBLGdEQUNBLGlEQUVBLGtDQUVBLHFCQUVBLFNBRUEsb0NBSUEsc0RBRUEsTUFFQSxzQ0FJQSx1REFDQSx3Q0FFQSxpRkFHQSx3RUFHQSx5RUFFQSw4QkFFQSxpQkFFQSxRQUVBLHFDQUlBLGdEQUNBLGlEQUVBLGtDQUVBLG1CQUVBLHlDQUVBLFlBRUEsd0JBRUcsZ0JBRUgsd0JBSUEsZ0NBRUEsZ0JBRUEsUUFFQSxtQ0FJQSxvREFFQSxrQ0FFQSxrQ0FFQSxpQkFFQSxjQUVBLFFBRUEsMEJBSUEsQ0FNQSw0QkFFQSxlQUVBLHNCQUVBLHVCQUVBLGdDQUVBLGlDQUVBLDZCQUVBLG1CQUVBLE9BRUEsOEJBRUEsOEJBRUEsNEJBRUEsbUJBRUEsTUFFQSw4QkFFQSw0QkFFQSwwQkFFQSxtQkFNQSxtQkFFQSw2Q0FDQSxvREFFQSxrQ0FJQSxhQUVBLDRCQUVBLGVBRUEscUJBRUEsaUJBRUEsa0JBRUEsa0NBRUEsNkJBRUEsT0FFQSxpQkFFQSwrQkFFQSw0QkFFQSxPQUVBLGlCQUVBLDRCQUVBLDBCQU1BLFFBRUEsMEJBRUEsWUFFQSx3QkFFQSxnREFDQSx1REFFQSxrQ0FFQSxzQkFFQSxLQUVBLDZCQUVBLDhFQUVBLGVBQ0EsdUJBRUEsc0NBRUEsNkJBRUEsMkJBRUEsVUFFQSwwQkFFQSx1REFFQSx5QkFFQSxNQUVBLDZCQUVBLGVBRUEsOEJBRUEsWUFFQSw4QkFFQSw4QkFFQSxtQkFFQSxhQUVBLFVBRUEsNEJBRUEsNkJBRUEsbUJBRUEsWUFFQSxVQUVBLDJCQUVBLDJCQUVBLG1CQUVBLFVBRUEsTUFFQSxvQkFJQSxvQkFFQSwwQkFJQSxZQUVBLDRCQUVBLGVBRUEscUJBQ0EsdUJBRUEsZ0NBRUEsWUFFQSw4QkFDQSxxQ0FFQSw2QkFFQSxPQUVBLFVBRUEsNEJBQ0Esb0NBRUEsNEJBRUEsT0FFQSxVQUVBLDJCQUNBLGtDQUVBLDBCQUVBLE9BRUEsTUFFQSxvQkFJQSxNQUVBLDJCQUVBLFlBRUEseUJBRUEsMkJBRUEsc0JBRUEsS0FFQSw4QkFFQSxZQUVBLGVBRUEsZ0JBSUEsYUFoM0JBLDJDQUdBLHlCQUdBLGlDQUdBLHlCQUNBLG1CQUdBLHNCQUNBLGVBSUEsNEJBQ0EsbURBS0EsOEJBSUEsY0FDQSxvQ0FJQSxVQUNBLG1CQUdBLGlCQUNBLHFCQUdBLG1CQUNBLGtCQUlBLG1CQUNBLG1CQUdBLHVCQUdBLHdCQUFjLCtCQUdkLHNCQUFzQixnRUFHdEIsZ0NBQ0EsNENBQ0EsK0JBTUEsa0NBRUEsa0JBRUEsR0FFQSxtQ0FFQSxrQkFFQSxLQUVBLDJCQUVBLDBCQUNBLDBDQUNBLG1DQUVBLElBRUEsdUJBRUEseUJBQ0EsMENBQ0EsbUNBRUEsbUJBQ0EsNkNBRUEsbUJBRUEscUJBRUEsSUFHQSx3QkFFQSxzQkFHQSx1RkFDQSw2QkFFQSxpQ0FDQSxpQ0FFQSxtQ0FFQSwyQkFFQSxnREFHQSwrQkFHQSwrQkFFQSx3Q0FFQSxpQkFJQSx3REFDQSxvQ0FHQSw4RkFHQSw0RkFFQSxnQkFHQSw2QkFHQSx5RkFHQSwwQkFFQSxtQ0FHQSxrQ0FFQSw2Q0FFQSxrQ0FFQSxtQkFFQSw2Q0FDQSwwQ0FJQSxzQ0FJQSxTQUNBLG9CQU1BLElBQ0EsbUVBQ0EsdURBRUEsMkJBRUEsNENBQ0EsMkNBQ0EsWUFRQSxrQkFFQSxDQUVBLDJCQUVBLG9EQUNBLG1FQUNBLDZEQUVBLG1FQUNBLGlFQUNBLGdFQUVBLHlEQUNBLHVEQUVBLG1EQUlBLGFBTUEsWUFFQSxpQkFBb0IsTUFDcEIscUJBQW1CLE1BQ25CLGtCQUFpQixNQUVqQixhQUFjLHVFQUVkLGVBRUEsS0FHQSw2QkFDQSxtQ0FFQSxnQkFDQSxzQkFDQSxRQUVBLHFDQUNBLDRCQUNBLDhCQUVBLDJCQUNBLHlCQUNBLDJCQUVBLDZCQUNBLDJCQUNBLDZCQUVBLDBCQTBCQSxpQkFFQSxzREFFQSxvQ0FDQSxxQkFFQSx3QkFFQSxFQUVBLENBRUEsb0JBRUEsaUJBRUEsb0RBRUEsb0NBQ0Esb0JBRUEsd0JBRUEsRUFFQSxDQUdBLGtCQUVBLHNCQUVBLDBDQUVBLHFFQUVBLCtDQUdBLDJCQUNBLHlDQUNBLGtDQUdBLDZEQUdBLHVFQUNBLHdFQUVBLE9BQUksbUJBR0osK0hBQ0EsZ0hBS0EsdUJBQ0Esc0ZBSUEsYUFFQSxDQUVBLG9EQXFoQkEsZ0VBQ0EsMERBRUEsZ0VBQ0EsOERBQ0EsNkRBRUEsa0RBSUEsbUJBRUEsVUFFQSw2RUFDQSw4REFFQSxzREFFQSxRQUVBLGVBRUEscUJBQ0EsaUVBRUEsTUFNQSxVQUVBLGVBRUEscUJBQ0Esb0ZBRUEsVUFFQSxxQkFFQSxjQUNBLCtGQUVBLEtBSUEsWUFFQSxlQUVBLHFCQUNBLHdGQUVBLFlBRUEscUJBRUEsY0FDQSxxR0FFQSxLQUlBLFNBRUEsZUFFQSxxQkFDQSxrRkFFQSxTQUVBLHFCQUVBLGNBQ0EsNEZBRUEsS0FJQSxVQUVBLGVBRUEscUJBQ0Esb0ZBRUEsVUFFQSxxQkFFQSxjQUNBLCtGQUVBLEtBSUEsZ0JBRUEsZUFFQSxxQkFDQSw2RkFFQSxhQUVBLHFCQUVBLGNBQ0EsMkdBRUEsS0FJQSx3QkFFQSxlQUVBLHFCQUNBLGlHQUVBLGFBRUEscUJBRUEsY0FDQSwrR0FFQSxLQUlDLGtEQ2xoQ0QsK0NBdUNBLHFEQUNBLGtDQUVBLDJDQUNBLCtCQUNBLDJCQUVBLFNBRUEsMEZBQ0EsdUZBR0EsNkNBQ0EseUVBR0EsMEJBQ0EsMEJBRUEsa0JBQ0EsTUFDQSxTQUdBLGVBRUEsaUNBQ0EsU0FDQSxXQUNBLFlBSUEsYUFDQSwrRUFHQSxxQ0FHQSxzQkFDQSxzQkFHQSx5QkFDQSxvSEFHQSxjQUVBLDhCQUNBLDhEQUNBLHFDQUNBLGlCQUdBLHdDQUNBLHNFQUNBLDBFQUNBLGFBQUcsbUJBR0gsbUNBQ0EsbUNBRUEsMENBQ0Esd0NBSUEsd0RBQ0EsNkRBRUEsNkJBR0EsMkJBRUEsaUJBQ0EsOERBQ0EscURBQ0EsbUVBRUEsa0NBRUEsa0NBQ0EsS0FPQSxDQTh2QkEsOEJBQ0EsOEJBQ0EsMkJBQ0EsYUFDQSxDQVFBLENBQ0EsK0JBR0EsNkJBQ0EsNkJBR0EsZ0NBQ0EsOEJBQ0EsOEJBQ0EsbUNBRUEsT0FDQSxJQUVBLHVCQUNBLDRCQUNBLE9BQ0EsZUFHQSxZQUVBLHdEQUNBLDRCQUdBLHVCQUNBLHdDQUNBLGdDQUdBLHFCQUNBLE9BRUEsbUNBQ0EsZ0JBRUEsd0JBQ0EscUVBQ0EsSUFFQSw4Q0FDQSx1Q0FFQSwyQ0FHQSxtQ0FDQSxLQUdBLE9BQ0EsMkJBbjhCQSxpREFDQSxtQ0FDQSxrQ0FDQSw4QkFLQSxJQUVBLGlHQUNBLFVBeUJBLE1BZ0dBLHlEQUNBLDJCQUNBLFVBT0EsRUFDQSwrREFDQSx1Q0FDQSxLQU1BLEVBQ0EseURBQ0EsK0JBQ0EsY0FNQSxFQUNBLDJEQUNBLCtCQUNBLGNBT0EsRUFDQSxrRUFDQSxFQUNBLHFCQUR5Qiw4QkFDUCxJQUVsQixhQUlBLEVBQ0EsOERBQ0Esc0NBMkNBLHdCQXVOQSxxQkFDQSwyREFDQSw4QkFDQSxRQUVBLHlDQUNBLHFCQUNBLCtFQUNBLGlCQUNBLHdGQUNBLDhCQUNBLFFBQ0EsUUFqT0EsbUNBRUEsbUNBQ0EsdUNBS0EsaURBQ0EsaUNBSUEsd0VBQ0EsY0FFQSxzREFHQSx3Q0FDQSxpQkFDQSwyQkFFQSxjQUdBLDhDQUNBLDJCQUNBLDRCQUVBLGdFQUNBLG1CQUNBLDJDQUNBLHVIQUEyRCxVQUkzRCw0QkFHQSwrQkFHQSxzQ0FDQSx3Q0FDQSwwQ0FDQSxhQUNBLGtEQUdBLGlEQUNBLGNBQ0EsaUNBR0EscUVBQ0EsbURBQ0EsVUFDQSxvREFHQSw0REFFQSxrQ0FDQSxZQUNBLGNBQ0Esc0JBQ0Esd0JBQ0EsZUFDQSx5QkFDQSxlQUNBLHNDQUdBLHNDQUNBLDRGQUVBLHNDQUNBLHVCQUtBLHFEQUVBLG1DQVNBLDBGQUtBLHFCQUtBLDZDQUVBLGlCQUNBLHNIQUVBLDRCQUVBLHVDQUNBLHdCQUNBLGFBQ0Esc0NBQ0EsdUJBQ0EsaUNBQ0EsZ0NBQ0Esd0JBQ0EscUJBQ0EsY0FDQSxrQkFDQSx5QkFDQSxxQkFHQSxTQUNBLGtFQUNBLG9DQUdBLGNBQ0EsMkJBQ0EsK0JBSUEsc0JBRUEsK0JBQ0EsMEJBQ0EsRUFHQSw0QkFHQSx5REFDQSxpRUFBeUQsK0JBR3pELHVDQUNBLG1CQUVBLDJCQVdBLHFEQUVBLHNCQUNBLDRCQUNBLGFBQ0Esc0NBQ0EsdUJBQ0EsaUNBQ0EsZ0NBQ0Esd0JBQ0EscUJBQ0EsY0FDQSxrQkFDQSx5QkFHQSxrQ0FDQSw2REFHQSxhQU1BLHdCQUdBLCtCQUdBLDBEQUNBLHlCQUVBLDRCQUNBLGlDQUlBLDRCQUNBLGVBR0EsZ0NBQ0EsY0FFQSxFQWVBLFNBQ0EsMkJBQ0EsZ0JBQ0EsYUFDQSxlQUNBLENBQ0EsY0FDQSxXQUNBLGlCQUNBLG9DQUVBLGVBR0EsaURBQ0EsZ0VBQ0Esa0NBRUEsY0FDQSxRQUdBLEdBRUEsZ0ZBQ0EsdUJBQ0Esb0NBQ0EsU0FBUyxzQkFDVCxXQUFPLHNCQUNQLHVCQUNBLHNCQUNBLElBQVMsc0JBQ1QsV0FHQSxnQkFFQSxTQUVBLE1BclRBLHVGQUdBLDRDQUdBLHFCQUNBLGFBQ0EsV0FDQSxFQUNBLHdGQUNBLFNBUEEsS0FDQSxRQVNBLG9CQUNBLE9BNUxBLDBCQTZMQSxpQ0FDQSxrQ0FFQSx3Q0FDQSwyQ0FDQSxjQUNBLGFBQ0Esa0NBR0EsK0NBQ0EsY0FDQSxpQ0FJQSwrQkFDQSwwQ0FHQSxvQkFDQSwrQkFHQSwrQkE4UUEsdUNBS0EsZ0RBQ0EseUJBR0EsdUVBQ0EsY0FFQSw2REFHQSx5QkFDQSw2Q0FHQSw4Q0FIaUMsYUFDakMscUZBSUEsMkJBQ0EsYUFDQSxFQUVBLGFBQ0EsMEJBQ0EsaUJBQ0EsdUJBQ0EsWUFDQSwwQkFDQSx3REFDQSx1Q0FJQSxxRUFDQSx1QkFHQSx3REFFQSxnQkFDQSxJQUNBLEVBT0EsRUFDQSxrRUFDQSxtQkFDQSxrQkFFQSxzQkFDQSwwREFDQSw4QkFDQSxzSUFHQSxhQUNBLE9BUUEsRUFDQSxvRUFDQSxpQ0FFQSxjQUNBLHNCQUFpQixZQUNqQixrQkFFQSxtQkFDQSxtQkFDQSxtQ0FPQSxrQ0FDQSxzREFHQSxhQUNBLHVEQUdBLGdCQUNBLDJEQUdBLCtFQUNBLHFCQUNBLEtBRUEsV0FDQSx3RUFDQSxxQkFDQSxLQUdBLEdBQ0EsY0FVQSxFQUNBLGtFQUNBLGlDQUNBLDJCQUVBLGVBR0Esa0JBR0EsT0FKQSxvREFLQSxrQ0FDQSxVQUNHLElBQ0gscUJBR0EsZUFFQSxhQUNBLG9EQUNBLFlBS0EseUJBQ0Esa0RBR0EsUUFDQSxpQkFDQSxzREFFQSxRQUdBLG1GQUNBLGtCQUNBLElBQ0EsdUVBQ0EsWUFFQSxPQUFHLFFBRUgsU0FFQSw0Q0FDQSxrQ0FHQSw0QkFDQSxZQUNBLGFBQ0EsV0FDQSxTQUNBLGlCQUNBLGdCQUNBLFFBQ0EsVUFDQSxvQkFDQSxRQUdBLHVCQUVBLFVBZ0JBLEVBQ0Esa0VBQ0EsaUNBQ0EsMkJBRUEsU0FFQSx3SEFDQSx5QkFHQSxrQkFFQSx3RUFDQSxDQUNBLElBQ0EsYUFDQSxpQ0FDQSxpQ0FFQSxvQ0FHQSxxQ0FDQSw0QkFFQSxvQkFDQSx1QkFFQSx3QkFDQSw2REFDQSxPQUNBLHFCQUNBLDJEQUVBLCtCQUNBLGNBQ0EsYUFDQSxPQUNBLElBQ0EsaUNBQ0EsV0FDQSw4QkFDQSxXQUNBLGtCQUNBLGFBQWEsT0FFYixtQkFDQSxHQUtBLEVBQ0EsMERBQ0EsNERBQ0EsaUJBQ0EsS0FBbUIsU0FBaUIsU0FDcEMsZ0VBQ0Esa0JBQ0EsS0FBdUIsWUFBb0IsU0FDM0Msd0JBRUEsd0NBQ0EsSUFDQSx3QkFHQSxzQkFDQSxJQUVBLG1CQUNBLElBS0EsRUFDQSw0REFDQSxnQkFDQSxTQUtBLEVBQ0EsaURBQ0EsWUFDQSxFQU1BLEVBQ0Esb0VBQ0EsQ0FDQSwrRUFFQSxhQUtBLEVBQ0EsMERBQ0EsZ0JBQ0EsUUFLQSxFQUNBLGtEQUNBLGFBQ0EsV0FFQSxvREFDQSx5QkFDQSx3REFDQSxNQUNBLE1BRUEsd0RBQ0EsbUNBQ0EsK0JBQ0EsbUNBQ0EsT0FFQSxzREFDQSxlQUNBLCtCQUNBLGtEQUNBLGlEQUdBLE1BQ0EsTUFFQSxpRUFDQSxtQkFDQSwrQkFBeUIsYUFDekIsNkJBQ0EsNERBQ0EsdUJBQ0EsVUFFQSwwREFDQSx3QkFDQSx5Q0FDQSwyQ0FDQSxlQUVBLHFFQUNBLGlDQUNBLG9CQUNBLDBEQUNBLGtCQUNBLEtBRUEsc0JBQ0EsY0FFQSw2REFDQSxzREFDQSxZQUVBLDREQUNBLGFBQ0Esb0JBRUEsa0VBQ0EsMEJBQ0EsV0FFQSw0RUFDQSwrQkFDQSw2QkFDQSw4Q0FDQSx3Q0FBZ0MsWUFDaEMsaUJBQ0EsV0FFQSxrRUFDQSxhQUNBLHVGQUVBLFdBRUEsaUVBQ0EsMERBQ0Esd0NBQXVDLGtCQUN2QyxxQkFFQSxxRUFDQSxPQUNBLHFDQUNBLDBEQUVBLHlHQ2o0QkEsQ0FVQSwyQ0FDQSxnQkFDQSxrQkFDQSxpQ0FDQSwrQkFHQSxnQkFDQSxFQUlBLDJDQXJCQSxrQ0FDQSw4Q0FFQSxlQUtBLFVBY0EseUNBQ0EsWUFDQSxFQWdHQSxFQUNBLDZDQVdBLFNBQ0Esb0RBa0JBLGdCQUNBLG1FQUNBLCtCQUVBLGFBRUEsS0FDQSxLQUtBLHdEQUNBLHNDQUNBLHFCQUNBLEdBQ0csY0FFSCw4Q0FDQSxHQUNBLG9EQUNLLEdBQ0wscURBQ0EsR0FFQSxvQkFDQSxhQUNHLHdCQUVILCtCQUNBLHFEQUVBLDhCQUNBLEdBQ0csNkNBRUgscURBQ0EsR0FPQSw4Q0FBNEIsb0JBQXVCLEdBQ25ELE1BQ0EsaUJBQ0Esa0JBR0EsNERBRUEsZ0NBQ0EsUUFDQSxnRUFDQSxnQkFBVyxPQUNYLGlCQUNBLGdCQUVBLFVBY0EsRUFDQSx3REFDQSw2QkFDQSxRQUNBLDREQUNBLGdCQUFXLE9BQ1gsaUJBQ0EsZ0JBRUEsVUFhQSxFQUNBLGtFQUNBLCtCQUNBLDRCQUNBLHlDQUdBLDZCQUdBLE9BSkEsMEdBS0EsNkRBQ0EsT0FDQSxxQkFDQSw0REFFQSxnQ0FDQSxRQUNBLFdBQ0EsMEZBQ0Esa0JBQ0EsYUFBVyxPQUNYLDJCQUVBLFlBRUEsbUVBQ0EseUNBQ0EsU0FBQyxFQUNELGtCQUNBLHdDQUNBLG1EQUVBLHNFQUNBLDZCQUNBLFlBQ0EsYUFDQSxpRUFDQSxlQUFXLE9BQ1gsaUJBQ0EsZ0JBQ0EsUUFDQSxnREFDQSxpQkFBYSxPQUViLGtCQUNBLHNCQUVBLGNBVUEsRUFDQSwrREFDQSxjQUVBLDRCQUNBLHFDQUNBLE1BR0EseUJBQ0EscUJBQ0EsUUFDQSx5QkFBbUIsVUFBa0IsU0FDckMsRUFDQSxnQkFFQSxtQkFFQSxFQUVBLDZCQUNBLFFBQ0EsZ0dBQ0EsZ0JBQ0EsZ0JBRUEsVUFNQSxFQUNBLGdGQUNBLGlDQUNBLDJCQUVBLGVBR0Esb0JBR0EsT0FKQSxzRUFNQSw0QkFDQSxvREFDQSxxQkFHQSxzQ0FDQSx5REFDQSxhQUNBLG9CQUNBLG1CQUdBLGdCQUNBLCtFQUdBLE1BQ0EsT0FHQSxnQ0FDQSxRQUNBLFdBQ0EsZ0NBQ0EsWUFDQSxjQUVBLFlBRUEsNEJBQ0EsbUNBQ0EsdUNBQ0EsNEZDNVhBLHVEQUNBLGdEQUVBLDhHQ0hBLDRDQUNBLHNEQUlBLFFBQ0EsbUVBQ0Esa0RBWUEsbUNBRUEsK0JBRUEscUNBRUEsaURBQ0EsS0FFQSxnQ0FzQkEsMEJBQ0EsVUFFQSxrQ0E3Q0EsK0JBQ0EscUNBQ0EscUNBQ0EsK0JBQ0EsdUJBTUEsZ0RBV0EsOEVBQ0Esd0NBSUEsZ0NBQ0EsMkJBQ0EsaUJBR0EsMkJBQ0EscUNBQ0EsNENBR0Esd0JBQ0Esd0RBR0EsK0NBT0EsaUZBQ0Esd0RBRUEscUJBcUhBLENBQ0EsZ0JBRUEsMEJBQ0EsZUFFQSxxQkFDQSxDQUNBLDBCQUNBLDBEQUNBLFNBRUEsNEJBL0hBLGtCQUlBLHNDQUhBLGtEQUtBLHVCQUNBLDRDQUNBLGdCQUlBLGFBSEEsV0FDQSx1REFRQSxhQUNBLGdDQTZHQSxZQUNBLFdBRUEsbUNBL0dBLGdEQWdIQSwrQkFDQSxXQUNBLE9BakhBLHdCQStDQSxLQUlBLHVCQUVBLGVBRUEsUUFDQSxLQUNBLHFCQUNBLCtCQUNBLDRCQUVBLHVFQUVBLEdBQVMsU0FDVCwrQkFDQSxVQUVBLGNBRUEsdUJBQ0Esc0JBRUEsYUFFQSxLQUVBLE1BeEVBLCtCQXlFQSxDQUlBLHdCQUtBLFlBQ0EsMEJBQ0EsTUFHQSxTQUVBLGdCQXhGQSxzQ0FJQSxhQUNBLHVCQUNBLGlCQUNBLHdDQUVBLGlDQUNBLGlCQUNBLGlDQUlBLDZDQUlBLGFBQ0EsT0FDQSxPQUVBLHlEQUVBLHlFQUdBLG1EQUdBLHFCQUNBLGNBRUEsVUFLQSxNQXNFQSxFQUVBLHFGQUNBLG1DQUVBLDhEQUNBLDZEQUNBLE9BQ0EsaUJBSUEsa0JBQ0EsUUFDQSxFQUNBLEVBRUEsMENBQ0EsbUNBQ0EsdUJBQ0EsSUFDQSxzQ0FDQSx3QkFDQSxJQUNBLGlDQUNBLHNEQUNBLG9CQUNBLEdBQ0EsRUFDQSw0QkFDQSxvQkFDQSxTQUdBLEdBQ0EsNkRDeE9BLGFBRUEsZUFJQSxtQ0FDQSx1QkFDQSxLQUVBLElBR0EsZUFDQSxVQVZBLGtGQ0pBLGFBRUEsT0FFQSxRQUlBLGtDQUNBLG1CQTREQSxZQUVBLHdCQUlBLFdBR0EsU0FDQSxzQkFDQSw0REFDQSxzQkFFQSxrQkFFQSxpQkFPQSxjQUNBLHlCQUNBLCtCQUNBLG9CQUNBLHNCQUNBLE9BRUEseUJBQ0EsSUFDQSxlQUNBLDZCQUNBLFVBQUssU0FDTCw4QkFDQSxpQkFDQSxDQUVBLElBbEdBLG9CQUlBLHVEQUhBLDJDQUtBLG1CQUNBLGFBRUEsMEJBQ0EsaURBQ0EsaUNBQ0EsaUNBQ0EsYUFFQSxxQ0FDQSxPQUVBLGlCQUNBLHlCQUlBLHFDQUVBLFlBRUEsZ0JBQ0EsTUFDQSxpQ0FLQSxRQUdBLG9CQUdBLG9DQUNBLGdDQUdBLG1EQXVEQSxZQUNBLHlCQUNBLFlBQ0Esc0JBQ0EsZUFFQSxnQkF4REEsaUJBQ0EsOENBMEJBLDhCQUNBLCtCQUVBLFNBRUEsZ0JBOUJBLGVBRUEsd0JBcURBLFlBRUEsNkJBSUEsV0FDQSxzQkFDQSxrQkFDQSxTQTdEQSxnQkFDQSxvQkFDQSxxQkFFQSx3Q0E5REEsb0NDTkEsNkNBQ0EsSUFFQSxXQVdBLDRCQVZBLE9BRUEsdUJBQ0EsU0FHQSx5QkFDQSxVQUVBLHFCQ2JBLGlFQUNBLG9DQUNBLGtDQUVBLGlFQUNBLHFHQUNBLG1DQ0hBLENBQ0EsbURBQ0EsZ0JBQ0Esa0RDTkEsbUNBRUEsMENBQ0Esd0NBRUEsa0RBQ0EsbUJBQ0EsOEJBQ0Esa0RBQ0EsNERBQXlDLCtCQUNoQywwQkFDVCx1Q0FJQSxVQUVBLEdBQ0EsMkRDbEJBLGVBSUEsMENBQ0EsMENBQ0EsbUNBRUEsK0JBQ0EsMEJBQ0EsQ0FDQSx5QkFDQSwwQkFDQSwwQkFJQSwwRUFDQSx3QkFDQSxVQUNBLFFBR0EsaUVBQ0EsNkJBQ0Esd0RBQ0EsOERBQ0EsNkJBQ0EsUUFDQSwwQ0FDQSxtQkFDQSxnQkFFQSxVQUNBLEVBQ0EsS0FDQSxHQWxDQSwyRkNGQSxtQkFxQ0EsbUNBQ0EseUNBQ0EsR0FDQSxnQkFDQSxzQkFDQSxLQVVBLDJCQUNBLE9BQ0EsZ0NBR0EsbUJBQ0EsTUFFQSwrQkFDQSxJQUNBLHVCQUNBLFNBQ0EsaURBRUEseUZBTUEsUUFBRyxTQUNILENBQ0EsUUFDQSxDQUdBLENBQ0Esa0JBQ0EsSUFDQSxnQ0FDQSxzQkFBRyxTQUVILENBQ0EsbUNBcEZBLDZEQUVBLHNDQUVBLE9BQ0EseUJBQ0Esd0JBQ0EsZ0JBQ0EsSUFDQSxtQkFDQSx5QkFDQSxJQUdBLEdBWEEsTUF3Q0EsNkJBNUJBLHVCQUNBLHFCQUVBLFNBQ0EsOENBQ0EsOENBQ0EsK0RBQ0EscUJBQ0EsSUFBSyxTQUNMLGdDQUNBLEVBQ0EsQ0FDQSxtQkFDQSxJQUNBLHFFQUNBLElBQUssU0FDTCxnQ0FDQSxFQUNBLENBQ0EsZUFXQSxlQUNBLEtBQ0EsYUFDQSw4QkFDQSwrRUNsREEsYUFFQSwwQ0NGQSxPQUFPLFNBQ1csYUFRaEI7Ozs7OztJQUFpQixlQVRGOzs7Ozs7O0NBQ2Ysb0JDREYsT0FBTyxTQUNXLGFBV2hCOzs7Ozs7Ozs7R0FYQSxDQVdpQixlQVpGOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7dUJDQWpCLE9BQU8sU0FDVyxhQVdoQjs7Ozs7Ozs7O0dBWEEsQ0FXaUIsZUFaRjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztnQkNBakIsQ0FHQSxPQUFPLGtCQUFrQixlQUN2QixjQUFjLENBRWQsbUJBQ0UsUUFBUSxDQUNSLGtCQUFPLENBQUMsUUFHVixpQkFBTSxVQUNKLE1BQUssYUFBZSxLQUFLLEdBQUcsYUFBYSxZQUN6QyxXQUFLLFlBQWMsQ0FBQyxNQUFPLEtBQUssS0FBSyxNQUFPLFFBQzdDLEVBRUQsU0FBUSxVQUNOLElBQUksSUFBSyxLQUVULEdBQUksS0FBSyxLQUNQLFdBQUcsYUFBYSxXQUFZLEtBQzVCLGdCQUFHLFNBRUgsZ0JBQUcsYUFBYSxXQUFZLFFBQVMsS0FDckMsY0FBSSxHQUFHLFdBQ0wsa0NBQVcsSUFBUSxJQUFHLEtBQUssYUFBNkIsUUFHN0QsR0F6QnNDLElBNEJ6QyxPQUFPLGtCQUFrQixvQkFDdkIsY0FBYyxDQUVkLGVBQ0UsUUFBUSxDQUNSLGtCQUFPLENBQUMsUUFHVixjQUFNLFVBQ0osTUFBSyxhQUFlLEtBQUssR0FBRyxhQUFhLFFBQzFDLEtBRUQsU0FBUSxVQUNOLElBQUksSUFBSyxLQUNULEdBQUksS0FBSyxLQUNQLFVBQUcsYUFBYSxPQUFRLFFBQVMsS0FBSyxLQUV0QyxVQUFHLGFBQWEsT0FBUSxRQUFTLEtBRXBDLGFBbkIyQyxnQkM5QjlDLEtBQU0sb0JBRU4sR0FHQSxPQUFPLGtCQUFrQixnQkFDdkIsUUFDRSxVQUFVLENBQUMsS0FBTSxXQUFZLFFBQzdCLHlCQUFRLENBQ1Isa0JBQVEsQ0FBQyxRQUNULFNBQU8sQ0FDUCxzQkFBWSxDQUFDLFFBQ2IsZUFBVyxDQUFDLFFBR2QsV0FBTSxVQUNKLElBQUksU0FBVSxTQUFTLGVBQWUsa0JBQ3RDLEtBQUksT0FBUyxHQUFJLE9BQ2pCLFVBQUksZUFBaUIsT0FBTyxNQUFNLFNBQVMsU0FBUyxHQUVwRCxjQUFLLFNBQVcsS0FBSyxLQUFLLFNBQVMsV0FHbkMsbUJBQUssa0JBQW9CLEtBQUssU0FBUyxLQUFLLFFBRzVDLE9BQU0sWUFDTixNQUFJLFdBQ0osTUFBSyxHQUFJLEdBQUksRUFBRyxFQUFJLEtBQUssa0JBQ3ZCLFFBQUssR0FBSSxNQUFPLEVBQVUsQ0FBUCxNQUFVLE9BQzNCLE1BQU0sS0FBTSxlQUNaLGFBQUssUUFBUSxJQUFjLENBQVQsUUFBYSxFQUFJLENBQUMsRUFDcEMsc0JBQVcsS0FFWCxnQkFBYSxLQUFLLEtBQ25CLFVBR0gsTUFBSyxTQUFXLE1BQU0sb0JBQW9CLHNCQUMxQyxpQkFBTSxNQUFPLEdBQUksT0FBTSxLQUFLLEtBQUssU0FBVSxLQUFLLEdBQUcsUUFBUSxRQUFRLFVBQ25FLGtCQUFLLEdBQUcsWUFBWSxPQUNyQixLQUVELE9BQU0sVUFFSixLQUFLLEdBQUksR0FBSSxFQUNQLE9BRFUsRUFBNkIsQ0FBekIsTUFBSyxrQkFBdUIsR0FBSyxFQUNuRCxXQUFjLEtBQUssS0FBSyxPQUFTLEVBQUssS0FBSyxTQUFTLE9BQU8sS0FBSyxNQUFNLEVBQUksSUFBTSxJQUNuRSxLQUFLLEtBQ2xCLE1BQUksTUFBaUIsUUFDckIsWUFBSyxhQUFzQyxDQUF6QixNQUFLLGtCQUF3QixFQUFJLEVBQ25ELGFBQUssYUFBc0MsQ0FBekIsTUFBSyxrQkFBd0IsRUFBSSxFQUNuRCxhQUFLLFNBQVMsV0FBVyxTQUMxQixjQUNGLENBS0QsVUFBUyxTQUFVLElBQUssS0FBTSxVQUM1QixNQUFNLE1BQU8sS0FHYixTQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksSUFBSSxXQUFXLFNBQVMsTUFBTSxPQUFRLEdBS3hELE1BQUksV0FBVyxTQUFTLE1BQU0sRUFBSSxJQUdsQyxjQUFJLFdBQVcsU0FBUyxNQUFNLEVBQUksSUFBTSxLQUFLLE9BRzdDLE1BQUksV0FBVyxTQUFTLE1BQU0sSUFBTSxLQUFPLEtBRTlDLE1BS0QsZUFBYyxTQUFVLFVBQVcsT0FDakMsTUFBTSxVQUFXLFVBQ2pCLHVCQUFLLEdBQUksR0FBSSxTQUVQLE9BRmlCLEVBQUksU0FBVyxtQkFBb0IsR0FFeEQsU0FBYSxLQUFLLFNBQVMsV0FBVyxTQUFTLE1BQU0sRUFDckQsUUFBSyxTQUFTLFdBQVcsU0FBUyxNQUFNLEVBQUksR0FBZSxDQUFWLFNBQzdDLE9BQ0EsQ0FBQyxFQUVSLE1BcEZ1QyxnQkNOMUMsS0FBTSxPQUFRLE9BQU8sT0FBUyxPQUFPLE1BRXJDLE9BQU8sa0JBQWtCLFFBQ3ZCLFFBQ0UsV0FBVyxDQUNYLHFCQUFVLENBQUMsUUFHYixTQUFNLFVBQ0osTUFBSyxNQUNMLFFBQUssV0FDTCxPQUFLLFlBQ0wsT0FBSyxXQUFhLEtBQUssV0FBVyxLQUNsQyxXQUFLLEdBQUcsUUFBUSxpQkFBaUIsWUFBYSxLQUMvQyxXQUVELFNBQVEsVUFDTixLQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksS0FBSyxNQUFNLE9BQzdCLElBQUksS0FBSyxNQUFNLEdBQ2IsWUFBSyxNQUFNLEdBQUcsUUFBVSxLQUFLLEtBR2xDLFVBRUQsT0FBTSxVQUlKLElBSUksUUFBUyxHQUFJLE9BQ2pCLFVBSkEsUUFDQSxPQUFJLFlBRUoscUJBQ1UsU0FBUyxlQUFlLGNBQ2xDLGlCQUFjLE9BQU8sTUFBTSxTQUFTLFNBQVMsR0FFN0MsaUJBQVUsU0FBUyxlQUFlLGVBQ2xDLGtCQUFlLE9BQU8sTUFBTSxTQUFTLFNBQVMsR0FFOUMsY0FBSyxTQUFXLEtBQUssZUFBZSxZQUFhLEtBQUssR0FBRyxRQUFRLFFBQVEsVUFDekUsb0JBQUssVUFBWSxLQUFLLGVBQWUsYUFBYyxLQUFLLEdBQUcsUUFBUSxRQUFRLFVBQzVFLGNBS0QsT0FBTSxTQUFVLEVBQUcsR0FDakIsQ0FBSSxHQUFDLEtBQUssS0FDVixjQUFLLEdBQUksR0FBSSxFQUNQLEtBRFUsRUFBSSxLQUFLLE1BQU0sT0FDN0IsVUFBVyxLQUFLLE1BRWhCLElBQUksQ0FBQyxLQUNMLGdCQUFLLE1BQ0wsUUFBSyxVQUFVLEtBQUssS0FFdkIsTUFFRCxpQkFBZ0IsU0FBVSxTQUFVLFNBQ2xDLE1BQU0sT0FDTixPQUFLLEdBQUksR0FBSSxFQUNQLEtBRFUsRUFBSSxLQUFLLEtBQUssU0FDNUIsU0FBVyxHQUFJLE9BQU0sS0FBSyxTQUMxQixlQUNBLGdCQUFLLFVBQVksTUFDZixDQUNBLG9CQUFTLEtBQ1QsTUFDQSxnQkFDQSxXQUNBLHVCQUFVLElBQVEsTUFBdUIsVUFFM0MsU0FBSyxHQUFHLFNBQVMsSUFDakIsWUFBTSxLQUNOLFdBQUssTUFBTSxLQUViLFlBQ0QsTUFFRCxVQUFTLFNBQVUsTUFBTyxTQUN4QixJQUNBLE1BQ0UsS0FERSxlQUNLLEtBQUssU0FBUyxLQUNyQixpQkFBSyxXQUFhLENBQUMsS0FBSyxXQUFhLEdBQUssS0FBSyxTQUUvQyxZQUFLLFNBQVMsSUFBSSxTQUFTLEVBQUcsU0FBUyxFQUFHLFNBQVMsRUFBSSxLQUV2RCxzQkFBTyxLQUFLLFVBQVUsS0FDdEIsa0JBQUssWUFBYyxDQUFDLEtBQUssWUFBYyxHQUFLLEtBQUssVUFDakQsWUFBSyxTQUFTLElBQUksU0FBUyxFQUFHLFNBQVMsRUFBRyxTQUFTLEVBQUksS0FHekQsc0JBQ0EsZ0JBQUssTUFBTSxFQUNYLE9BQUssS0FDTixDQUVELGFBQVksVUFDVixLQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksS0FBSyxNQUFNLE9BQzdCLFNBQUssTUFBTSxHQUNYLGdCQUFLLE1BQU0sR0FBRyxLQUNkLE9BQUssTUFBTSxHQUFHLE1BQU0sRUFFdkIsQ0FuRytCLGVDRmxDLElBQUksY0FBZSxHQUFJLFFBQ3ZCLGFBRUEsMkJBQU0sY0FDQSxTQUNBLFVBQ04sTUFBTSxPQUVOLEtBQ0EsTUFBTSxNQUFNLFVBQVUsS0FBTyxVQUMzQixJQUFJLFVBQ0YsVUFJRixvQkFKVSxLQUNSLDZDQUdFLFVBQ0YsbUJBSUYsb0JBSlUsS0FDUix1REFHRSxRQUFTLEtBQUssUUFDbEIsbUNBQU8sT0FBUyxLQUNoQixjQUFPLE9BQU8sTUFBUSxLQUN0QixjQUFPLEtBQU8sS0FDZCxZQUFPLFFBQVUsS0FBSyxRQUFRLEtBQzlCLGFBQU8sYUFBYSxlQUFlLEtBQUssYUFBYyxLQUN0RCxnQkFBSyxVQUFZLEtBQUssUUFDdEIsWUFBNkIsNkNBQzdCLGVBQU8sTUFBTSxLQUFLLFVBQVcsS0FFN0IsYUFFQSxrQkFBSyxPQUNMLE9BQU8sS0FDUixTQUVELEVBR0EsT0FBTyxrQkFBa0IsaUJBQ3ZCLG9CQUNFLElBQ0EsUUFDQSxVQUNBLGVBQ0EsaUJBQ0EsaUJBQ0EsYUFDQSxhQUdGLGNBQU0sVUFDSixNQUFLLGNBQ0wsVUFBSyxvQkFDTCxRQUFLLGFBQWUsS0FBSyxhQUFhLEtBQ3RDLDRCQUF3QixLQUFLLHNCQUFzQixLQUduRCxVQUFLLEdBQUksR0FBSSxFQUFRLEVBQUwsSUFDZCxTQUFLLEdBQWlCLDhCQUFrQixDQUF4QyxHQUNFLFVBQ0EsRUFBTSxnQkFBYSxDQUNuQixVQUVGLGNBQUssR0FBaUIsOEJBQWtCLENBQXhDLE9BQ0UsVUFDQSxFQUFNLGdCQUFhLENBQ25CLGNBRUYsY0FBSyxHQUFpQiw4QkFBa0IsQ0FBeEMsUUFDRSxVQUNBLEVBQU0sZ0JBQWEsQ0FDbkIsZUFHTCxRQUVELE9BQU0sVUFFSixLQUFLLEdBQUksR0FBSSxFQUFRLEVBQUwsSUFDVixJQUFDLEtBQUssR0FBZSw0QkFBa0IsQ0FBdEMsSUFDSCxjQUFLLEdBQWlCLDhCQUFrQixDQUF4QyxHQUEyQyxNQUMzQyxTQUFLLEdBQWlCLDhCQUFrQixDQUF4QyxHQUFtRCxrQkFBYSxDQUU5RCxLQUFDLEtBQUssR0FBZSw0QkFBa0IsQ0FBdEMsUUFDSCxjQUFLLEdBQWlCLDhCQUFrQixDQUF4QyxPQUErQyxNQUMvQyxTQUFLLEdBQWlCLDhCQUFrQixDQUF4QyxPQUF1RCxrQkFBYSxDQUVsRSxTQUFDLEtBQUssR0FBZSw0QkFBa0IsQ0FBdEMsU0FDSCxjQUFLLEdBQWlCLDhCQUFrQixDQUF4QyxRQUFnRCxNQUNoRCxTQUFLLEdBQWlCLDhCQUFrQixDQUF4QyxRQUF3RCxrQkFBYSxDQUcxRSxTQUVELFlBQVcsU0FBVSxPQUFRLGFBQzNCLE1BQU0sTUFBTyxFQUFJLEtBQUssTUFDdEIsRUFENEIsTUFBSyxVQUMzQixJQUFNLEtBQUssbUJBQW1CLGNBQ3BDLE1BQU0sVUFBWSxLQUFLLEdBQWUsNEJBQXFCLE9BQU0sR0FDakUsU0FBSyxjQUNMLGlCQUFVLFVBQVUsS0FDckIsYUFLRCxlQUFjLFNBQVUsTUFDdEIsT0FBTSxPQUNOLE9BQUssY0FBYyxTQUFTLGlCQUFpQixNQUM5QyxTQU1ELHdCQUF1QixTQUFVLE9BRS9CLE1BQU0sT0FBUSxLQUFLLFNBQVMsS0FBSyxjQUFjLFNBQVMsU0FDeEQsR0FBSSxRQUNGLG9CQUFPLE9BQU8sZUFBZSxDQUFDLElBQ3pCLEdBQUksUUFDVCxrQkFBTyxPQUFPLGVBQWUsSUFJL0IsR0FDRSxNQURFLFFBQUssNEJBQ0EsT0FBTyx3QkFBd0IsQ0FBQyxJQUV6QyxHQUNFLElBREUsUUFBSyw0QkFDQSxPQUFPLHdCQUF3QixJQUUxQyxFQUtBLFdBQVUsU0FBVSxFQUNsQixPQUFlLEVBQVgsS0FDSixhQUFrQixRQUVuQixVQXZJSCxRQWtDMkMsMkVDZ1QzQyxRQUFTLFVBQVUsRUFBRyxFQUFLLE9BQU8sR0FBRSxNQUFRLEVBQVUsSyw2UUF0VnRELHNDQUVBLEdBQUksV0FBWSxPQUFPLE1BQU0sZ0JBQWdCLFNBQVcsRUFDeEQsVUFBWSxTQUFTLFVBRXJCLElBR0EsT0FBTyxrQkFBa0IsY0FDdkIsY0FBYyxDQUVkLHVCQUNFLHNCQUFzQixDQUFDLFFBQ3ZCLGVBQVcsQ0FDWCwwQkFBZ0IsQ0FBQyxRQUNqQixxRUFBaUIsQ0FBQyxRQUNsQiw2REFBYSxDQUFDLEtBQ2QscUJBQVksQ0FBQyxLQUNiLG9CQUFXLENBQ1gsb0NBQXlCLENBQUMsS0FHNUIsaUNBQXVCLENBQ3JCLEtBQ0EsT0FDQSxPQUNBLFFBQ0EsU0FDQSxVQUNBLFdBSUYsaUNBQXFCLENBQUMsQ0FBQyxLQUFNLENBQUMsS0FBTSxLQUVwQyxtQ0FDRSxHQUNBLFNBQ0EsZUFDQSxnQkFHRiwyQkFDRSxTQUFTLENBQUMsTUFBTyxFQUFHLE1BQ3BCLGlCQUFlLENBQUMsTUFBTyxFQUFHLE1BQzFCLGtCQUFnQixDQUFDLE1BQU8sRUFBRyxNQUMzQixZQUFVLENBQUMsTUFBTyxFQUFHLE1BRXJCLGNBQVksQ0FBQyxNQUFPLEVBQUcsTUFDdkIsb0JBQWtCLENBQUMsTUFBTyxFQUFHLE1BQzdCLHFCQUFtQixDQUFDLE1BQU8sRUFBRyxNQUM5QixlQUFhLENBQUMsTUFBTyxFQUFHLE1BRXhCLGNBQVksQ0FBQyxNQUFPLEVBQUcsTUFDdkIsb0JBQWtCLENBQUMsTUFBTyxFQUFHLE1BQzdCLHFCQUFtQixDQUFDLE1BQU8sRUFBRyxNQUM5QixlQUFhLENBQUMsTUFBTyxFQUFHLE1BRzFCLCtCQUNFLEdBQ0EsV0FDQSxXQUdGLFlBQU0sVUFDSixNQUFLLGdCQUFrQixTQUFTLGVBQ2hDLHNCQUFLLFNBQ0wsVUFDQSwwQkFBSyxjQUFnQixTQUFTLGVBQzlCLHNCQUNBLHNCQUFLLGlCQUNMLE9BQUssc0JBQ0gsS0FBQyxLQUFLLEtBQUsscUJBQXVCLEtBQUssS0FDekMscUJBQ0EsZ0JBQUssSUFDTCxVQUFLLFlBQWMsS0FBSyxHQUFHLFdBRTNCLHFCQUFLLFlBQ0wsU0FBSyxRQUFVLFNBQVMsZUFDeEIsZ0JBQUssZ0JBQWtCLFNBQVMsZUFDaEMsd0JBQUssaUJBQW1CLFNBQVMsZUFFakMseUJBQUssR0FBRyxpQkFBaUIsWUFBYSxLQUFLLFdBQVcsS0FDdkQsTUFFRCxTQUFRLFNBQVUsUUFDaEIsTUFBTSxNQUFPLEtBR2IsV0FBSSxDQUFDLFFBQVEsYUFBZSxLQUFLLGFBQWUsS0FDOUMsbUJBSUYsb0JBQUksQ0FBQyxLQUFLLHlCQUEyQixDQUFDLEtBR3RDLGFBQUksS0FBSywwQkFBNEIsUUFBUSx5QkFDekMsS0FBSyxhQUFlLFFBQ3RCLGtCQUVILGFBTUQsYUFBWSxVQUNWLElBQUksSUFBSyxLQUVULEdBQUksS0FBWSxVQUFLLElBR3JCLFdBQUksS0FBTSwrQ0FBTSxhQUFhLEtBQUssS0FDSiwyQkFBRSxLQUFLLEtBQWdCLFVBQ3JELGNBQU0sS0FBTSxLQUFLLElBQU0sR0FDdkIsbUJBQUcsS0FDSCwyQkFBYSw4QkFBNkIsR0FDMUMsV0FBSSxLQUFLLE1BQ1QsU0FBSSxpQkFBaUIsT0FBUSxJQUMzQixNQUFLLFNBQVcsS0FBSyxNQUFNLElBQzNCLG1CQUNBLDBCQUFLLElBQ0wsVUFBSyxHQUFHLFFBQVEsS0FBSyxtQkFDdEIsUUFDRCxPQUNELE1BS0QsZUFBYyxVQUdaLE1BQUssVUFDTCxPQUFLLGlCQUNMLE9BQUssU0FBUyxRQUFRLEtBQ3RCLGVBQUssU0FBUyxXQUFXLEtBQ3pCLGVBQUssU0FBUyxPQUFPLEtBQ3JCLGVBQUssSUFBTSxLQUFLLFNBR2hCLHFCQUFNLFFBQVMsS0FBSyxTQUNwQixXQUFJLE9BQU8sUUFDVCxDQURtQixRQUFPLEdBQUcsVUFDeEIsR0FBSSxHQUFJLEVBQXFCLENBQWxCLFFBQU8sR0FBRyxNQUN4QixTQUFLLGNBQWMsT0FJdkIsU0FDQSw2QkFBUSxJQUNULCtDQUtELE9BQU0sU0FBVSxLQUFNLE1BQ3BCLElBQUssS0FBSyxLQUFrQixTQUF4QixFQUF5QixLQUFLLEtBQW9CLGFBQUMsS0FFdkQsZUFBTSxlQUFnQixLQUFLLFVBQzNCLGFBQUksY0FBMEIsaUJBRTVCLE1BQU0sTUFBTyxLQUFLLEdBQUcsV0FDckIsUUFBSSxDQUFDLEtBQWtCLFVBQ3ZCLFlBQUssVUFBWSxLQUFDLEtBQUssaUJBQW1CLEtBQUssS0FBSyxxQkFDbEMsS0FBSyxLQUN4QixlQUVDLFdBQUssVUFBWSxLQUtuQixzQkFBTSxXQUFZLEtBQUssVUFDdkIsVUFBTSxJQUFNLEtBQUssU0FDakIsZ0JBQU0sVUFBWSxJQUFPLEdBQUssS0FBSyxTQUNuQyxnQkFBTSxNQUFRLEtBQUssU0FDbkIsV0FBSyxHQUFJLEdBQUksRUFDUCxTQURVLEVBQUksTUFBTSxPQUFRLEVBQ2hDLFdBQWUsTUFBTSxHQUFHLE1BQ3hCLFVBQUksU0FBVyxlQUFpQixVQUM5QixrQkFBTSxHQUFHLEtBQ1QsY0FBSyxhQUFhLE1BS3RCLFVBQU0sV0FBWSxLQUFLLFNBQ3ZCLGVBQUssR0FBSSxHQUFJLEVBQ1AsU0FEVSxFQUFJLFVBQVUsT0FBUSxFQUNwQyxXQUFlLFVBQVUsR0FBRyxNQUM1QixVQUFJLFNBQVcsZUFBaUIsVUFDOUIsZ0JBQUssYUFBYSxVQUt0QixTQUFNLFFBQVMsS0FBSyxTQUNwQixZQUFLLEdBQUksR0FBSSxFQUNQLFNBRFUsRUFBSSxPQUFPLE9BQVEsRUFDakMsV0FBZSxPQUFPLEdBQUcsTUFDekIsVUFBSSxTQUFXLGVBQWlCLFVBQzlCLGdCQUFLLGNBQWMsT0FJdkIsSUFBSSxjQUVKLG1CQUFJLEtBQUssa0JBQW9CLEtBRTNCLDRCQUFLLEdBQUcsUUFBUSxLQUFLLDBCQUNyQixjQUdBLDhCQUFLLGtCQUVSLE9BRUQsZUFBZSxVQUNiLE1BQU0sU0FFTixTQUFPLFVBQVUsU0FDZixNQUFNLE1BQU8sS0FHYixRQUNJLE1BQWtDLENBQTNCLFlBQVMsY0FBc0IsTUFDMUMsUUFEQSxNQUVFLENBREUsWUFBUyxZQUVOLE1BQ0wsQ0FEUyxZQUFTLFlBR2xCLGFBQ0EsT0FHRixtQkFBTSxRQUFTLEtBQUssWUFBWSxLQUM1QixPQUdKLGlCQUFRLHFCQUF1QixDQUFDLEtBQUsscUJBQXVCLEtBQUssVUFBWSxLQUM3RSxvQkFBUSxNQUNSLGNBQVEsYUFBZSxLQUFLLHNCQUFzQixTQUNsRCx1QkFBUSxtQkFBcUIsS0FBSyw2QkFBNkIsU0FDL0Qsb0JBQVEsTUFBUSxLQUFLLEtBQ3JCLGtCQUFRLEtBQ1IsYUFBUSxpQkFBbUIsS0FBSywyQkFBMkIsU0FBUyxZQUNwRSxRQUFRLGVBQWlCLENBQUMsS0FBSyxlQUFpQixLQUNoRCx1QkFBTyxhQUFhLE9BQ3BCLGdCQUFPLFdBQVcsS0FFbEIsd0JBQ0EsY0FBTyxXQUFXLEtBQ25CLGFBQ0YsQ0FFRCxpQkFBZSxVQUNiLE1BQU0sU0FFTixTQUFPLFVBQVUsU0FDZixNQUFNLElBQUssS0FBSyxHQUFHLFFBQVEsV0FBVyxXQUV0QyxnQkFBSSxHQUVKLFNBQU0sTUFBTyxLQUNiLEtBQU0sTUFBUSxLQUFLLEtBRW5CLFVBQU0sZ0JBQWtCLElBQU0sU0FBUyxVQUFZLEtBQ25ELGFBQVEscUJBQ04sQ0FBQyxLQUFLLHFCQUF1QixLQUFLLFVBQVksS0FDaEQsb0JBQVEsZ0JBQ1Isd0JBQVEsbUJBQXFCLEtBQUssNkJBQTZCLFNBQy9ELG9CQUFRLFVBQ1IsQ0FEb0IsWUFBUyxjQUNyQixNQUNSLGNBQVEsZUFBaUIsQ0FBQyxLQUFLLGVBQWlCLEtBQ2hELHdCQUFRLE1BQVEsU0FDaEIsVUFBRyxhQUFhLE9BQ2hCLFlBQ0QsT0FDRixDQUVELGtCQUFlLFNBQVUsTUFDdkIsUUFBTyxNQUNMLFdBQ0UsUUFBSyxZQUFZLFNBQVMsS0FBTSxNQUNoQyxRQUNGLFVBQ0UsUUFBSyxZQUFZLFNBQVMsU0FBVSxNQUNwQyxRQUNGLFVBQ0UsUUFBSyxZQUFZLFNBQVMsWUFBYSxNQUN2QyxRQUNGLFVBQ0UsUUFBSyxZQUFZLFNBQVMsYUFBYyxNQUN4QyxRQUNGLFVBQ0UsUUFBSyxZQUFZLFNBQVMsUUFBUyxNQUNuQyxRQUNGLFVBQ0UsUUFBSyxRQUFRLFdBQVcsUUFBUSxNQUFNLE1BQ3RDLFFBQ0YsVUFFRSxRQUFLLFFBQVEsV0FBVyxRQUFRLE1BQU0sTUFDdEMsUUFDRixVQUNFLFNBQUssZ0JBQWdCLFdBQVcsZ0JBQWdCLE1BQU0sTUFDdEQsUUFDRixVQUNFLFNBQUssaUJBQWlCLFdBQVcsZ0JBQWdCLE1BQU0sTUFHNUQsU0FFRCxjQUFhLFNBQVUsS0FBTSxNQUMzQixJQUFJLGNBQWUsY0FDbkIsS0FDQSxXQUFhLHVCQUFnQixJQUM3QixZQUFPLEtBQUssR0FBRyxRQUFRLFdBQ25CLGNBQ0YsS0FHSyxLQUNSLDZCQUpXLEtBQUssUUFBVSxhQUd6QixlQU1GLGFBQVksVUFDVixNQUFLLGlCQUNMLE9BQUssVUFDTCxNQUFLLEdBQUksR0FBSSxFQUNQLE1BRFUsRUFBSSxLQUFLLGNBQWMsU0FBUyxPQUM5QyxVQUFZLEtBQUssY0FBYyxTQUMvQixHQUFJLE1BQU0sV0FDUixZQUFNLFdBQVcsS0FFbkIsaUJBQUksTUFBTSxXQUNSLFlBQU0sV0FBVyxLQUd0QixnQkEzVXFDLDJFQ2t5QnhDLFFBQVMsb0JBQW9CLFNBQVUsVUFDL0IsT0FDQyxVQURTLENBQ2hCLEdBQW1CLEVBQ3BCLGMsY0F6eUJtQyxLQUFLLGFBd3BCbEIsS0FBSyw2SUE1cEI1QixTQUFNLFFBQVMsb0JBRWYsR0FBTSxTQUFXLEdBQUksT0FDZixTQUdBLDBCQUNOLElBQ0Esa0JBQU0sS0FBTyxDQUViLFNBQU0sV0FDSixJQUNBLHlCQUNBLDRCQUNBLDZCQUdGLHdCQUlBLE9BQU8sa0JBQWtCLE9BQ3ZCLFFBQ0Usc0JBQXNCLENBQUMsUUFDdkIsU0FBTyxDQUFDLFFBQVMsTUFBTyxNQUFPLENBQUMsTUFDaEMsc0JBQWMsQ0FBQyxRQUNmLGNBQU8sQ0FDUCwrQkFBb0IsQ0FBQyxRQUFTLGFBQWMsTUFBTyxDQUFDLE9BQVEsYUFBYyxjQUMxRSxlQUFNLENBQUMsUUFDUCxXQUFPLENBQ1AsZ0JBQU0sQ0FBQyxRQUFTLFFBQVMsTUFBTyxDQUFDLFFBQVMsTUFDMUMsMEJBQWtCLENBQUMsUUFBUyxTQUFVLE1BQU8sQ0FBQyxTQUFVLFNBQ3hELHVCQUFnQixDQUFDLFFBR25CLGtCQUNFLE1BQU0sT0FDTixjQUFLLE9BR1AsbUJBQ0UsTUFDQSxXQUdGLGVBQ0UsT0FDQSxzQkFDQSx1QkFHRiw4QkFDRSxVQUNBLGdDQUNBLDhCQUNBLDRCQUdGLG1DQUFjLENBQUMsSUFBSyxFQUFHLElBQUssR0FBSSxJQUFLLElBQUssSUFBSyxHQUUvQyxhQUNFLElBQ0EsU0FDQSxPQUNBLFVBQ0EsVUFDQSxZQUNBLGFBQ0EsY0FHRix3QkFDRSxNQUFNLENBQ04sZ0JBQVksQ0FDWixpQkFDQSxXQUdGLHdCQUNFLFFBQ0EsSUFDQSxXQUdGLGNBQU0sVUFDSixNQUNBLG1CQUFLLE1BQVEsU0FBUyxlQUFlLFNBQVMsV0FDOUMsV0FBSyxnQkFBa0IsR0FBSSxPQUMzQixVQUFLLDBCQUNMLE9BQUssYUFBZSxHQUFJLE9BQ3hCLGFBQ0Esa0JBQUssZ0JBQ0wsT0FBSyxlQUNMLFFBQUssZUFBaUIsR0FBSSxPQUMxQixVQUNBLHFCQUFLLGtCQUNMLFNBQUssYUFBZSxHQUFJLE9BQ3hCLGFBQUssU0FBVyxLQUFLLEdBQUcsUUFBUSxpQkFDaEMseUJBQUssUUFDTCxVQUNBLHdCQUNBLDJCQUFLLG9CQUFzQixDQUN6QixHQUFJLE9BQU0sUUFDVixHQUFJLE9BQU0sUUFDVixHQUFJLE9BRU4sY0FBSyxtQkFBcUIsQ0FDeEIsR0FBSSxPQUFNLFFBQ1YsR0FBSSxPQUFNLFFBQ1YsR0FBSSxPQUdOLGNBQUssY0FBZ0IsU0FBUyxlQUM5QixzQkFBSyxZQUFjLFNBQVMsZUFDNUIsa0JBQUssYUFBZSxTQUFTLGVBQzdCLG1CQUFLLFdBQWEsU0FBUyxlQUMzQixpQkFBSyxZQUFjLFNBQVMsZUFDNUIsa0JBQUssVUFBWSxTQUFTLGVBQzFCLHVCQUFLLGNBQWdCLFNBQVMsZUFFOUIsc0JBQUssVUFBWSxTQUFTLGlCQUMxQixvQkFBSyxZQUVMLE9BQUssbUJBQXFCLENBQUMsU0FBVSxLQUFNLFNBQzNDLFdBQUssWUFBYyxDQUFDLE1BQU8sT0FBUSxLQUVuQyxZQUFLLFlBQWMsS0FBSyxZQUFZLEtBRXBDLFdBQ0EsWUFDRSxNQURFLFFBQUssS0FBSyxVQUdaLHlCQUVILGVBRUQsaUJBQWdCLFVBQ2QsTUFBTSxJQUFLLEtBQ1gsR0FBTSxLQUFPLEtBRWIsUUFBRyxTQUFTLFNBQVMsSUFDbkIsS0FBSyxvQkFBb0IsS0FBSyxvQkFDOUIsS0FBSyxrQkFBa0IsS0FBSyxrQkFDNUIsS0FBSyxxQkFBdUIsS0FHOUIsbUJBQUcsU0FBUyxTQUFTLEVBQUksTUFBTSxLQUFLLFNBQVMsS0FBSyxVQUFVLEtBQzdELGNBRUQsU0FBUSxVQUNOLE1BQ0Esc0JBQ0EsbUJBRUEsdUJBQ21CLFNBQWpCLE1BREUsUUFBSyxLQUFLLEtBR0ssZ0NBQWEsS0FBSyxLQUFVLFFBQUcsS0FBSyxLQUFXLEtBRW5FLEVBRUQsUUFBTyxVQUNMLE1BQUssR0FBRyxTQUNSLFdBQ0UsTUFERSxRQUFLLEtBQUssWUFDUCxXQUFXLFNBQ2hCLGdCQUFLLFlBQVksU0FFcEIsV0FFRCxPQUFNLFVBQ0osTUFBSyxRQUFRLFNBQ2IsZ0JBQ0Esa0JBQUssR0FBRyxTQUNULFVBRUQsT0FBTSxTQUFVLEtBQU0sVUFDcEIsTUFBTSxJQUFLLEtBQ1gsR0FBTSxLQUFPLEtBQ2IsS0FBTSxTQUFXLEdBQUcsU0FDcEIsU0FBTSxTQUFXLEdBQUcsU0FFcEIsWUFBSSxLQUNGLGVBQUssY0FFTixlQUVDLElBQUksU0FBb0MsRUF2TGxCLENBQ3RCLFdBeUxBLGtCQUFJLFNBQVMsRUFBSSxLQUFLLHFCQUNwQixJQUFJLGNBQWUsU0FBUyxFQUFJLGlEQUVoQyxlQUFJLGFBQWUsS0FDakIsOEJBQVMsRUFFVCx1QkFBUyxFQUFJLEtBQ2IsMEJBQUssTUFBTSxRQUFRLEtBQUssS0FBSyxNQUVoQyxVQUVDLGVBQVMsR0FBSyxLQUFLLEtBQUssT0FDeEIsd0JBQVMsRUFBSSxLQUdmLGtCQUFJLFNBQVMsRUFBSyxLQUE0QixxQkF0TXBELEtBdU1VLEtBQUssMEJBQTRCLDBCQUNuQyxNQUFNLFVBQVcsT0FBTyxNQUFNLFFBQVEsWUFDcEMsS0FBSywwQkFDUCw4QkFBRyxTQUFTLFNBQVMsRUFBSSxLQUFLLGVBQWtCLFNBQVcsS0FDM0QscUJBQUssMkJBQ04sU0FHRCxNQUFLLFdBQ0wsQ0FEa0IsV0FBUyxFQUN2QixLQUFtQixpQkFDeEIsU0FDRCxNQUNELGNBS0QsYUFBWSxVQUNWLE1BQUssZUFBaUIsS0FBSyxHQUFHLFNBQVMsU0FHdkMsT0FBSywwQkFDTCxPQUNBLHlCQS9ORSxFQStOdUIsR0FBckIsTUFBSyxjQUFxQixpQkFBbUIsQ0FDakQsUUFBSyxHQUFHLFNBQVMsU0FBUyxHQUFLLEtBQy9CLHFCQUFLLGVBQWlCLEtBQUssR0FBRyxTQUFTLFNBRXZDLEVBQWdDLE1BQTVCLE9BQUssS0FBSyxXQUNmLG9CQUVELFlBQVcsVUFDVCxJQUFJLElBQUssS0FDVCxHQUFJLFFBQVUsS0FBSyxRQUFVLFNBQVMsY0FDdEMsWUFBSSxPQUFTLEtBQUssT0FBUyxTQUFTLGNBRXBDLG9CQUFRLGFBQWEsUUFDckIscUJBQVEsYUFBYSxRQUdyQixtQkFBTyxTQUFTLFNBQVMsR0FDekIsYUFBUSxZQUNSLFdBQUcsWUFDSixRQUVELGNBQWEsVUFDWCxNQUFNLFNBQVUsS0FDaEIsUUFBTSxPQUFTLEtBQ2YsT0FBSSxHQUVKLG1CQUFRLGFBQWEsV0FDbkIsV0FDQSxjQUNBLG9CQUNBLDBCQUFVLEtBQUssY0FBYyxLQUFLLEtBQ2xDLHlCQUNBLFdBQU8sS0FBSyxjQUFjLEtBQUssS0FFakMsY0FBSyx3QkFBd0IsUUFBUyxLQUFLLE9BQU8sS0FBSyxLQUd2RCxlQUFRLFNBQVMsTUFBTSxJQUFJLEVBQUcsRUFDOUIsV0FBUSxTQUFTLE1BQU0sZUFBZSxNQUFNLGVBQWUsS0FBSyxLQUVoRSxNQUF1QixNQUFuQixRQUFLLEtBQUssS0FDWixNQUFNLE9BQVEsUUFBUSxZQUN0QixRQUNFLFlBQU0sU0FBVyxLQUFLLEdBQUcsUUFBUSxRQUFRLFVBQVUsZUFBaUIsS0FBSyxLQUV6RSxlQUFRLGlCQUFpQixlQUFnQixJQUN2QyxPQUFNLFNBQVcsS0FBSyxHQUFHLFFBQVEsUUFBUSxVQUFVLGVBQWlCLEtBQUssS0FDMUUsTUFGRCxFQUlILEtBQ0MsYUFBTyxhQUFhLFlBQWEsQ0FBQyxLQUNsQyx1QkFBSyx3QkFBd0IsT0FBUSxLQUFLLFdBQVcsS0FBSyxLQUFLLEtBQU8sS0FBSyxLQUU5RSxPQUVELGdCQUFlLFVBQ2IsSUFDQSxPQUVBLGNBQVMsS0FBSyxXQUFhLFNBQVMsY0FDcEMsa0JBQVEsS0FBSyxVQUFZLFNBQVMsY0FFbEMsbUJBQU8sWUFDUCxZQUFLLEdBQUcsWUFFUixlQUFTLEtBQUssWUFBYyxTQUFTLGNBQ3JDLGtCQUFRLEtBQUssV0FBYSxTQUFTLGNBRW5DLG1CQUFPLFlBQ1AsWUFBSyxHQUFHLFlBRVIsYUFDRCwyQkFFRCxvQkFBbUIsVUFDakIsSUFDSSxXQUFZLEtBQUssR0FBRyxRQUFRLFFBQVEseUJBQXlCLFVBQ2pFLFNBQUksU0FBVyxLQUFLLEdBQUcsUUFBUSxRQUFRLFVBQVUsZUFBaUIsS0FBSyxLQUV2RSxPQUhBLGNBR0ssUUFBVSxHQUFJLE9BQU0sUUFDdkIsS0FBcUIsa0JBQ3JCLEtBQXFCLGtCQUNyQixLQUVGLHdCQUFLLGNBQ0wsUUFBSyxXQUFhLFNBQVMsY0FDM0IsaUJBQUssR0FBRyxZQUFZLEtBRXBCLGdCQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksVUFBVSxPQUM1QixhQUFXLEdBQUksT0FBTSxLQUFLLFVBQVUsR0FBRyxTQUN2QyxtQkFBUyxNQUFRLEdBQUksT0FDckIsaUJBQVMsTUFBTSxJQUFJLEtBQUssU0FBVyxJQUFLLEtBQUssU0FBVyxJQUFLLEtBQUssU0FDbEUsVUFBSyxjQUFjLEtBQ25CLGVBQUssV0FBVyxTQUFTLElBRTVCLFNBRUQsa0JBQWlCLFVBQ2YsSUFBSSxXQUFZLEtBQ2hCLFVBQUksV0FBYSxLQUNqQixXQUFJLFdBQWEsS0FDakIsV0FBSSxZQUFjLEtBRWQsa0JBQ0osWUFDRSxNQURFLFFBQUssS0FBSyxlQUtkLHFDQUFXLGFBQWEsV0FDdEIsV0FDQSxjQUNBLG9CQUNBLDBCQUFVLEtBQUssY0FBYyxLQUFLLEtBQ2xDLHlCQUNBLFdBQU8sS0FBSyxjQUFjLEtBQUssS0FDL0IsWUFFRixnQkFBSyx3QkFBd0IsV0FBWSxLQUFLLE9BQzlDLGdCQUFXLFNBRVgscUJBQVUsYUFBYSxXQUNyQixRQUNBLGFBQU8sS0FBSyxLQUNaLGNBRUYsZ0JBQUssd0JBQXdCLFVBQVcsS0FBSyxPQUU3QyxpQkFBWSxhQUFhLFdBQ3ZCLFdBQ0EsY0FDQSxvQkFDQSwwQkFBVSxLQUFLLGNBQWMsS0FBSyxLQUNsQyx5QkFDQSxXQUFPLEtBQUssY0FBYyxLQUFLLEtBQy9CLFlBRUYsZ0JBQUssd0JBQXdCLFlBQWEsS0FBSyxPQUMvQyxpQkFBWSxTQUVaLHNCQUFXLGFBQWEsV0FDdEIsUUFDQSxhQUFPLEtBQUssS0FDWixjQUVGLGdCQUFLLHdCQUF3QixXQUFZLEtBQUssT0FDL0MsWUFFRCxxQkFBb0IsVUFDbEIsSUFDQSxNQURJLFFBQUssS0FBSyxTQUNULEdBQUksR0FBSSxFQUNQLFNBRFUsRUFBSSxLQUFLLGNBQWMsT0FDckMsYUFBZSxLQUFLLGNBQ3BCLFlBQ0Esb0JBQVMsU0FBUyxJQUFJLEVBQUcsRUFDekIsWUFBUyxNQUFNLElBQUksRUFBRyxFQUN0QixZQUFTLE1BQU0sSUFDRyxDQUFoQixNQUFLLFNBQWUsSUFDSixDQUFoQixNQUFLLFNBQWUsSUFDSixDQUFoQixNQUFLLFNBRVYsSUFFRCxXQUFVLFNBQVUsS0FDbEIsSUFBSSxTQUFtQixNQUFULFFBQWtCLEtBQUssWUFBYyxLQUMvQyxhQUNKLGtCQUFRLFNBQVMsU0FBUyxLQUFLLEtBQUssR0FBRyxTQUN2QyxrQkFBUSxTQUFTLFNBQVMsR0FDMUIsWUFBUSxTQUFTLFNBQVMsR0FDMUIsWUFBUSxTQUNSLG1CQUFRLEtBQUssWUFDYixjQUNELGFBRUQsVUFBUyxTQUFVLEtBQ2pCLElBQUksUUFBa0IsTUFBVCxRQUFrQixLQUFLLFdBQWEsS0FDakQsWUFBSyxNQUFELEVBQ0osTUFEZSxRQUFLLEtBQUssY0FDbEIsU0FBUyxTQUFTLEtBQUssS0FBSyxHQUFHLFNBQ3RDLGlCQUFPLFNBQVMsU0FBUyxHQUN6QixXQUFPLFNBQVMsU0FBUyxHQUN6QixXQUFPLFNBQ1Asa0JBQU8sS0FBSyxXQUNaLFNBQUksT0FBTyxNQUFNLGdCQUNmLHFCQUFRLElBQUksS0FBSyxHQUFHLFFBQVEsV0FBVyxLQUUxQyxrQkFFRCxjQUFjLFVBQ1osSUFBSSx1QkFBd0IsR0FBSSxPQUFNLGtCQUNwQyxPQUNBLGVBQU0sTUFFUixhQUFJLGNBQWdCLEdBQUksT0FBTSxrQkFBa0IsQ0FBQyxNQUFPLE9BQVEsS0FBTSxNQUN0RSxhQUFJLE9BQVMsR0FBSSxPQUNqQixRQUFJLE9BQVMsR0FBSSxPQUNqQixRQUFJLE9BQVMsR0FBSSxPQUVqQixjQUFPLFVBQVUsUUFDZixJQUNJLGNBQWUsS0FBSyxhQUN4QixLQUFJLFVBQVksS0FDaEIsYUFBSSxxQkFBdUIsS0FDM0IscUJBQUkscUJBQXVCLEtBQzNCLHFCQUFJLGFBQWUsS0FDbkIsYUFFSSxzQkFBd0IsS0FDNUIsc0JBQUksc0JBQXdCLEtBQzVCLHNCQUFJLGNBQWdCLEtBQ3BCLGNBQUksWUFBYyxRQUFRLFdBQVcsTUFFckMsZ0JBWkEsY0FNQSxjQUNBLG9CQUtPLEtBQUssWUFBWSxHQUN4QixZQUFPLEtBQUssWUFBWSxHQUN4QixlQUFPLEtBQUssWUFBWSxZQUFZLE9BQVMsR0FDN0MsZUFBVSxLQUFLLFFBQVEsSUFFdkIsYUFBSyxZQUFZLFNBQVMsU0FBUyxJQUFJLEVBQUcsRUFDMUMsUUFBSyxZQUFZLFNBQVMsU0FBUyxJQUFJLEVBQUcsRUFDMUMsUUFBSyxZQUFZLFNBRWpCLHlCQUFLLFlBQVksU0FBUyxhQUFhLEtBQUssb0JBQW9CLEdBQUcsS0FDbkUsY0FBSyxZQUFZLFNBQVMsYUFBYSxLQUFLLG9CQUFvQixHQUFHLEtBQ25FLGNBQUssWUFBWSxTQUFTLGFBQWEsS0FBSyxvQkFBb0IsR0FBRyxLQUVuRSxjQUFLLFdBQVcsU0FBUyxTQUFTLElBQUksRUFBRyxFQUN6QyxRQUFLLFdBQVcsU0FBUyxTQUFTLElBQUksRUFBRyxFQUN6QyxRQUFLLFdBQVcsU0FFaEIseUJBQUssV0FBVyxTQUFTLGFBQWEsS0FBSyxtQkFBbUIsR0FBRyxLQUNqRSxjQUFLLFdBQVcsU0FBUyxhQUFhLEtBQUssbUJBQW1CLEdBQUcsS0FDakUsY0FBSyxXQUFXLFNBQVMsYUFBYSxLQUFLLG1CQUFtQixHQUFHLEtBRWpFLGNBRUEsNEJBQUksS0FBSyxLQUFLLE1BQ1osZUFBZ0IsR0FBSSxPQUNwQixzQkFBZ0IsR0FBSSxPQUVwQixxQ0FBYyxjQUNkLDZCQUFjLE9BQU8sY0FDckIsc0JBQWMsVUFBVSxjQUFjLEVBQUcsY0FBYyxFQUFHLGNBRTFELGFBQVksR0FBSSxPQUFNLEtBQUssY0FDM0Isb0JBQUssR0FBRyxRQUFRLFlBQVksZ0JBRTVCLHlCQUFnQixHQUFJLE9BRXBCLDZDQUFzQixjQUN0Qiw2QkFBYyxPQUFPLHNCQUNyQixzQkFBYyxVQUFVLGNBQWMsRUFBRyxjQUFjLEVBQUcsY0FFMUQsUUFBTSxtQkFBb0IsR0FBSSxPQUFNLEtBQUssY0FDekMsNEJBQUssR0FBRyxRQUFRLFlBQVksZ0JBQzdCLGtCQUVELE1BQUssUUFBUSxTQUViLGdCQUFNLG1CQUFvQixLQUFLLFlBQVksWUFBWSxRQUN2RCwyQkFBa0IsZUFBaUIsa0JBQWtCLGdCQUNyRCxxQkFBa0IsZUFBZSxPQUNqQyxvQkFBa0IsZUFBZSxLQUVqQyxvQkFBTSxrQkFBbUIsS0FBSyxXQUFXLFlBQVksUUFDckQsMEJBQWlCLGVBQWlCLGlCQUFpQixnQkFDbkQsb0JBQWlCLGVBQWUsT0FDaEMsbUJBQWlCLGVBQWUsS0FDaEMsd0NBQWlCLGVBQWUsS0FFaEMsNEJBQU0sa0JBQW1CLEtBQUssV0FBVyxZQUFZLFFBQ3JELDBCQUFpQixlQUFpQixpQkFBaUIsZ0JBQ25ELG9CQUFpQixlQUFlLE9BQ2hDLG1CQUFpQixlQUFlLEtBRWhDLG1CQUFNLGlCQUFrQixLQUFLLFVBQVUsWUFBWSxRQUNuRCx5QkFBZ0IsZUFBaUIsZ0JBQWdCLGdCQUNqRCxtQkFBZ0IsZUFBZSxPQUMvQixrQkFBZ0IsZUFBZSxLQUMvQixzQ0FBZ0IsZUFBZSxLQUUvQiwyQkFBSyxXQUFXLFNBQ2hCLGdCQUFLLFlBQVksU0FFakIsZ0JBQUssR0FBRyxRQUFRLFNBQ2hCLDZCQUNBLGtCQUFLLGdCQUVMLFNBQUssYUFBYSxLQUFLLEtBQUssb0JBQW9CLElBQUksSUFBSSxLQUFLLG9CQUU3RCxTQUFLLGtCQUVMLGFBQVMsR0FBRyxLQUFLLGNBQ2pCLGlCQUFTLE9BQ1QsZ0JBQUssbUJBQW1CLFNBQVcsS0FBSyxHQUFHLFNBQzNDLGNBQUssbUJBQW1CLFNBQVcsU0FDbkMsY0FBSyxVQUFVLEtBQUssVUFBVyxLQUNoQyxzQkFDRixDQUVELGdCQUFhLFVBQ1gsS0FBSyxHQUFJLEdBQUksRUFBRyxFQUFJLEtBQUssY0FBYyxPQUNyQyxTQUFLLGNBQWMsR0FHckIsZ0JBQUssUUFBUSxTQUNiLGdCQUNBLGtCQUFLLGdCQUNMLFNBQUssa0JBRUwsU0FBSyxtQkFBbUIsU0FBVyxLQUFLLEdBQUcsU0FDM0MsY0FBSyxtQkFBbUIsU0FBVyxLQUNuQyxhQUFLLGNBQWMsS0FBSyxVQUFXLEtBQ3BDLHNCQUVELDRCQUEyQixVQUN6QixNQUFLLHdCQUEwQixDQUM3QixHQUFJLE9BQU0sUUFDVixHQUFJLE9BQU0sUUFDVixHQUFJLE9BRU4sY0FBSyx5QkFBMkIsQ0FDOUIsR0FBSSxPQUFNLFFBQ1YsR0FBSSxPQUFNLFFBQ1YsR0FBSSxPQUdOLGNBQUssY0FBZ0IsR0FBSSxPQUN6QixXQUFLLHNCQUF3QixHQUFJLE9BQ2pDLFdBQUssc0JBQXdCLEdBQUksT0FFakMsV0FBSyxhQUFlLEdBQUksT0FDeEIsV0FBSyxxQkFBdUIsR0FBSSxPQUNoQyxXQUFLLHFCQUF1QixHQUFJLE9BQ2pDLEtBRUQsNEJBQTJCLFVBQ3pCLElBQUksc0JBQXVCLEtBQzNCLHFCQUFJLHFCQUF1QixLQUMzQixxQkFBSSxhQUFlLEtBQ25CLGFBQUksd0JBQTBCLEtBQzlCLHdCQUFJLFdBQWEsS0FDakIsV0FBSSxZQUFjLEtBQ2xCLFlBQUksc0JBQXdCLEtBQzVCLHNCQUFJLHNCQUF3QixLQUM1QixzQkFBSSxjQUFnQixLQUNwQixjQUFJLHlCQUEyQixLQUUvQixxQ0FBWSxTQUNaLGdDQUFZLFNBQVMsYUFDbkIseUJBQXlCLEdBQUcsS0FBSyxLQUFLLG9CQUN4QyxpQkFBWSxTQUFTLGFBQ25CLHlCQUF5QixHQUFHLEtBQUssS0FBSyxvQkFDeEMsaUJBQVksU0FBUyxhQUNuQix5QkFBeUIsR0FBRyxLQUFLLEtBQUssb0JBRXhDLGdCQUFXLFNBQ1gsK0JBQVcsU0FBUyxhQUNsQix3QkFBd0IsR0FBRyxLQUFLLEtBQUssbUJBQ3ZDLGdCQUFXLFNBQVMsYUFDbEIsd0JBQXdCLEdBQUcsS0FBSyxLQUFLLG1CQUN2QyxnQkFBVyxTQUFTLGFBQ2xCLHdCQUF3QixHQUFHLEtBQUssS0FBSyxtQkFFdkMsbUJBQWMsc0JBQ1oseUJBQXlCLEdBQUkseUJBQXlCLEdBQUkseUJBQzVELDBCQUFzQixJQUFJLGNBQWMsT0FDZCxjQUFjLFNBQVcsS0FFbkQsMkJBQWEsc0JBQ1gsd0JBQXdCLEdBQUksd0JBQXdCLEdBQUksd0JBQzFELHlCQUFxQixJQUFJLGFBQWEsT0FBUSxhQUFhLFNBQVcsS0FFdEUsb0NBQXNCLHNCQUNwQix5QkFBeUIsR0FBSSx5QkFBeUIsR0FBSSx5QkFDNUQseUJBQXFCLHNCQUNuQix3QkFBd0IsR0FBSSx3QkFBd0IsR0FBSSx3QkFDM0QsR0FFRCxlQUFjLFNBQVUsTUFDdEIsRUFBSyxLQUFtQixVQUFwQixFQUNKLGFBQUssR0FBRyxRQUFRLFdBQVcsS0FBSyxVQUFVLGFBQWEsS0FDeEQsR0FFRCxrQkFBaUIsVUFDZixNQUFNLGNBQWUsS0FBSyxLQUMxQixhQUFNLFlBQWMsS0FDcEIsWUFBTSxTQUFXLEtBQ2pCLFNBQU0sZUFBaUIsS0FBSyxlQUFpQixLQUFLLGVBQWUsY0FDL0QsS0FBSyxjQUFjLFlBQ3JCLFNBQU0sZ0JBQWtCLEtBQUssZ0JBQWdCLGNBQzNDLEtBQUssUUFBUSxZQUNmLFlBRUEsa0JBQUssR0FBSSxHQUFJLEVBQUcsRUFBSSxTQUFTLE9BQVEsSUFDbkMsSUFBSSxrQkFBbUIsU0FBUyxHQUFHLFdBQVcsa0JBQzlDLFlBQ0EsY0FFQSxZQUFJLENBQXFCLGlCQUV6QixXQUFNLE1BQU8sU0FBUyxHQUFHLGFBQWEsa0JBRXRDLFFBQUksaUJBQWlCLGNBQWMsaUJBRWpDLFNBQUssR0FBUyxtQkFBa0IsSUFBaEMsR0FHQSxjQUFLLEdBQUcsV0FBVyxXQUFXLGtCQUFrQixVQUFVLEtBRTFELElBQXVCLE1BQW5CLFFBQUssS0FBSyxLQUNaLE1BQUssR0FBRyxLQUFLLFVBQ2IsY0FDQSxjQUNELEtBRUQsU0FBSyxZQUFZLFNBRWpCLElBQUksU0FBUyxHQUFHLFdBQVcsa0JBQWtCLFVBQ3pDLEtBQUssS0FBSyxRQUFVLFlBQVksTUFDbEMsU0FBSyxXQUFhLFNBQ2xCLFFBQUssV0FBVyxpQkFBaUIsWUFBYSxLQUFLLFlBQ25ELG9CQUFnQixTQUFTLEdBQUcsV0FDNUIsdUJBQUssUUFDTCxtQkFBYyxlQUNkLGdCQUFjLGVBQ2QsZ0JBQWMsZ0JBRWQsRUFBdUIsT0FBbkIsUUFBSyxLQUFLLEtBQ1osa0JBQ0Esd0JBQUksQ0FBQyxjQUFjLGdCQUFnQixLQUFLLEtBQUssY0FDM0MsTUFBSyxTQUNMLE1BQ0QsS0FFRCxVQUFxQixJQUFqQixpQkFDRixNQUQyQixnQkFDaEIsY0FDTixlQUFxQixNQUFqQixpQkFDWCxPQURzQyxnQkFDM0IsY0FFVCxlQUFXLGNBRWQsZUFDQyx5QkFBb0IsY0FBYyxlQUFnQixjQUFjLGVBQzVDLGNBRXRCLGlCQUNBLHlCQUFLLGVBRU4sUUFDQyxtQkFFRixLQUNELEtBQ0QsQ0FBb0IsbUJBQUssU0FDMUIsYUFDRixDQUVELGNBQWEsVUFDWCxJQUFJLGNBQWUsS0FBSyxLQUN4QixhQUFJLGVBQWlCLEtBQ3JCLGVBQ0ksY0FBZ0IsS0FBSyxXQUFXLFdBSXBDLGtCQUpBLGNBSU0sZUFBZ0IsS0FFdEIsWUFBcUIsSUFBakIsaUJBQ0YsTUFEMkIsZ0JBQ2hCLGNBQ04sZUFBcUIsTUFBakIsaUJBQ1QsT0FEb0MsZ0JBQ3pCLGNBRVgsZUFBVyxjQUdiLHFCQUFNLGdCQUFzQixVQUFJLEVBQ2hDLEdBRG1DLEVBQUMsS0FBSyxlQUFpQix5QkFDcEQsY0FBcUIsVUFBSSxFQUUvQixHQUZrQyxFQUFDLFNBQVcsNEJBRTFDLE9BQ0osU0FBMkIsRUFBbEIsaUJBQXVCLEdBQ2hDLEVBRHNDLGlCQUFpQixXQUM3QixFQUFqQixnQkFBc0IsR0FFL0IsRUFGcUMsZ0JBQWdCLG1CQUV0QyxNQUNmLFdBQUssR0FBRyxLQUFLLFVBQ2Isd0JBQUssR0FBRyxRQUFRLEtBQUssZUFFckIsWUFDQSxlQUFrQixFQUFkLHFCQUE4QixXQUM3QixHQUFrQixFQUFkLHFCQUE4QixXQUNsQyxLQUFtQixHQUFmLHFCQUErQixXQUV0QyxxQkFBZ0IsV0FFaEIsV0FBSyxVQUFVLEtBQUssYUFBYSxXQUFXLFdBQVcsZUFBZSxLQUFLLEdBQUcsU0FDOUUsZUFBSyxZQUFjLENBQUMsS0FBSyxZQUFjLEdBQUssS0FBSyxVQUduRCxhQUFNLFNBQVUsS0FBSyxHQUFHLFFBQVEsV0FBVyxlQUMzQyxnQkFDRSxrQkFBUSxTQUFTLFNBQVMsS0FBSyxLQUFLLEdBQUcsU0FDdkMsa0JBQ0EsZUFBUSxLQUFLLGlCQUVoQixTQUtELGdCQUFnQixVQUNkLElBQUksZUFBZ0IsR0FBSSxPQUN4QixRQUFJLGFBQ0osRUFBSSxlQUFpQixHQUFJLE9BQ3pCLFFBQUksY0FDSixFQUFJLGFBQXdCLFdBQzVCLElBRUEsZUFBTyxVQUFVLFVBRWYsU0FBSyxnQkFBa0IsbUJBQW1CLEtBQUssZ0JBQy9DLGdCQUFLLEdBQUcsU0FBUyxTQUFTLEdBQUssS0FBSyxpQkFFcEMsZUFBc0IsTUFBbEIsT0FBSyxLQUFLLEtBQ1osS0FBSyxHQUFJLEdBQUksRUFBRyxFQUFJLEtBQUssY0FBYyxPQUNyQyxjQUFXLEtBQUssY0FDaEIsSUFBSSxDQUFDLFNBQ0wsb0JBQVMsU0FBUyxnQkFBZ0IsU0FBUyxNQUMzQyx3QkFBUyxNQUFNLGVBQ2YsTUFDRSxHQURFLFVBQVMsTUFBTSxhQUlyQixhQUNELE1BRUQsZ0JBQWUsS0FBSyxLQUFLLGNBQWMsUUFDeEIsZUFBZSxpQkFBbUIsVUFDakQscUJBQWUsRUFDZixPQUFLLFlBQVksU0FBUyxTQUFTLElBQ25DLHFCQUFLLFlBQVksU0FBUyx5QkFBeUIsS0FBSyxhQUN4RCw2QkFBZ0IsZUFBMEIsV0FBSyxFQUFJLGNBRW5ELDJCQUFjLEtBQUssS0FBSyxhQUFhLFFBQ3ZCLGVBQWUsaUJBQW1CLFVBQ2hELG9CQUFjLEVBQ2QsT0FBSyxXQUFXLFNBQVMsU0FBUyxJQUNsQyxvQkFBSyxXQUFXLFNBQVMseUJBQXlCLEtBQUssYUFDdkQsMkJBQWUsY0FBeUIsV0FBSyxFQUFJLGFBRWpELGtCQUVBLGlDQUFLLG1CQUNMLGVBQUssV0FDTixDQURtQixPQUFLLGlCQUUxQixDQUtELDRCQUEwQixVQUN4QixNQUFNLFlBRU4sU0FBTyxVQUFVLEdBQUksV0FDbkIsSUFBSSxDQUFDLFdBQVcsWUFDZCxNQUFNLFlBQWEsU0FBUyxlQUM1QixlQUFJLFdBQVcsWUFDYixtQkFBVyxZQUFjLFdBQVcsWUFBWSxRQUFRLFNBQVMsR0FFakUsYUFNSCx3QkFOYyxpQkFBaUIsZUFBZ0IsSUFDMUMsWUFBVyxZQUFjLFdBQVcsWUFBWSxRQUFRLFNBQVMsR0FDakUsY0FBSyx3QkFBd0IsR0FDOUIsV0FDRCxFQUlBLENBQUMsR0FBRyxZQUF1QixZQUFHLFlBQVksT0FBUSxHQUFJLE9BQzFELFNBQUcsWUFBWSxRQUFRLFNBQVcsV0FDbkMsV0FDRixDQUdILGtCQ3h5QkEsT0FBTyxrQkFBa0Isb0JBQ3ZCLE1BQU0sVUFDSixRQUFPLEVBQUksS0FBTyxTQUFTLGNBQzNCLFlBQU8sR0FBSyxLQUFPLFNBQVMsaUJBQzVCLFlBQU8sSUFBTSxLQUFPLFNBQXdCLGtCQUFPLEdBQS9CLEtBQW1DLGFBQ3ZELFlBQU8sS0FBTyxLQUFPLFNBQXdCLGtCQUFPLEdBQS9CLEtBQW1DLFdBQ3hELFlBQU8sTUFBUSxLQUNmLFVBQU8sTUFBUSxLQUFLLEdBQUcsUUFBUSxNQUNoQyxLQVIyQyxnQkNBOUMsT0FBTyxrQkFBa0IsZUFDdkIsY0FBYyxDQUFDLFdBRWYsbUJBQ0UsTUFBTSxDQUFDLEtBR1Qsa0JBQU0sVUFDSixNQUFNLE1BQU8sS0FFYixVQUFLLEtBQUssaUJBQWlCLHdCQUF5QixJQUFRLE1BQXFCLGFBQ2pGLFFBQ0QsYUFFRCxjQUFhLFVBQ1gsTUFBTSxJQUFLLEtBQ1gsR0FBTSxPQUFTLEtBQUssS0FDcEIsS0FBTSxTQUFXLEdBQUcsWUFBWSxRQUU1QixTQUFDLE9BQU8sWUFFWixtQkFBUyxJQUFNLE9BQU8sWUFBWSxRQUFRLFNBRXRDLElBQUMsU0FFTCxlQUFTLElBQ1Qsd0JBQ0QsZ0JBM0JzQyxlQ0F6QyxDQUlBLE9BQU8sa0JBQWtCLGVBQ3ZCLGNBQWMsQ0FFZCxtQkFDRSxTQUFTLENBR1gsa0JBQU0sVUFDSixNQUFNLElBQUssS0FDWCxRQUFLLFFBQVUsS0FBSyxHQUFHLFFBR3ZCLGVBQU0sVUFBVyxLQUFLLEdBQUcsYUFDekIsZUFBRyxTQUFTLFNBQVMsRUFBSSxDQUFDLEVBQUksU0FBUyxPQUN2QyxPQUFLLGFBQWUsU0FDcEIsWUFBSyxjQUFnQixTQUN0QixNQUVELFNBQVEsVUFDTixNQUFLLEdBQUcsU0FBUyxRQUFVLEtBQUssS0FDakMsT0FFRCxPQUFNLFVBQ0osTUFBTSxJQUFLLEtBRVgsR0FBSSxHQUFDLEtBQUssS0FFVixjQUFNLFFBQVMsS0FBSyxRQUFRLFdBQzVCLE9BQUksR0FHSixhQUFNLGVBQWdCLE9BRXRCLGlCQUFJLENBRUYsY0FRRixVQVJLLFNBQVMsU0FBUyxFQUFJLENBQ3pCLE1BQUcsU0FBUyxNQUFNLEVBQ2xCLFFBQUcsWUFBWSxRQUFRLE1BQU0sRUFDN0IsYUFBSyxjQUNMLFFBSUksY0FBZSxLQUFLLFFBQVEsV0FBVyxVQUFVLGNBQ25ELEdBQ0osa0JBQUcsU0FBUyxNQUFNLEVBQ2xCLEtBQUcsU0FBUyxTQUFTLEVBQUssQ0FBQyxhQUFhLFNBQ3hDLEtBQUcsWUFBWSxRQUFRLE1BQU0sRUFBSSxLQUFLLGNBQWdCLGFBQ3ZELFdBaERzQyxlQ0p6QyxDQUdBLE9BQU8sa0JBQWtCLGNBQ3ZCLFFBQ0UsUUFBUSxDQUNSLHFCQUFVLENBQUMsS0FHYixrQkFBTSxVQUNKLE1BQUssYUFBZSxTQUFTLGVBQzlCLGFBRUQsU0FBUSxVQUNOLE1BQUssR0FBRyxTQUFTLFFBQVUsS0FBSyxLQUNqQyxNQUVELE9BQU0sVUFDSixJQUNJLFVBQVcsS0FBSyxLQUNwQixTQUFJLEdBQUssS0FDVCxHQUVJLGFBQWUsS0FFbkIsYUFOQSxPQUdBLGFBQ0EsY0FFSSxHQUFDLEtBQUssS0FFVixnQkFBUyxTQUFTLFdBQ2xCLFFBQUksQ0FHSiwwQkFBZ0IsU0FBUyxXQUFXLE9BQ3BDLGNBQ0UsaUJBQUcsU0FFSCxlQUtGLGdCQUxLLFNBQ0gseUJBSWEsU0FBUyxXQUFXLFVBQVUsZ0JBQ3pDLGVBRUosa0JBQUcsU0FBUyxTQUFTLEtBQUssYUFFMUIsT0FDRSxpQkFBRyxTQUFTLFNBQVMsS0FBSyxhQUFhLFNBRTFDLFdBN0NxQyxnQkNIeEMsT0FBTyxrQkFBa0Isb0JBQ3ZCLGNBQWMsQ0FFZCxzQkFDRSxhQUFhLENBQ2IseUJBQWMsQ0FHaEIsa0JBQU0sVUFDSixNQUFLLFdBQWEsS0FBSyxHQUFHLFdBQzFCLG9CQUFLLGFBQ0gsT0FDQSxlQUNBLHdCQUNBLG9CQUdGLFdBQUssTUFFTCxRQUFLLFVBQVksS0FBSyxVQUFVLEtBRWhDLE9BQUksS0FBSyxLQUFLLGNBQWdCLE9BQU8sTUFBTSxnQkFDekMscUJBR0YseUJBQUksS0FBSyxLQUFLLGFBRVosVUFERSxVQUFPLE1BQU0sZ0JBQWdCLGNBQWMsaUJBQ3RDLGlCQUFpQixVQUFXLEtBQ25DLGdCQUVILHVCQUVELFFBQU8sVUFDTCxJQUFJLE1BQ0osWUFBTyxLQUFLLEtBQUssT0FBTyxRQUFRLFNBQVUsSUFDeEMsTUFBSyxhQUFhLEtBQUssTUFDeEIsS0FDRixFQUVELGVBQWMsU0FBVSxTQUN0QixJQUNBLFlBQ0UsTUFERSxZQUFTLGVBQ04sYUFHUCxvQkFDRSxNQURFLFlBQVMsS0FHWCxFQUEwQixLQUFuQixZQUFTLE1BQWtCLEVBRXBDLE9BQUssV0FBVyxhQUNkLFlBQVksS0FBSyxXQUFXLGtCQUFrQixTQUFTLFVBQ3ZELGlCQUFZLEtBQUssV0FBVyxrQkFBa0IsU0FBUyxVQUN2RCxvQkFBaUMsS0FBbEIsWUFBUyxLQUNwQixFQUNBLEtBQUssV0FBVyxzQkFBc0IsUUFBUSxTQUNsRCxtQkFFSCxPQUdELGVBQWMsU0FBVSxTQUN0QixNQUFLLFdBQVcsSUFDaEIsUUFBSyxXQUFXLGFBQ2QsWUFBWSxLQUFLLFdBQVcsa0JBQWtCLFNBQVMsVUFDdkQsYUFDQSxZQUVILEdBS0QsWUFBVyxTQUFVLE1BQ25CLE1BQU0sU0FBVSxNQUNoQixlQUNFLGFBQVMsSUFDUCxNQUNBLFFBQ0QsS0FFSixFQUVELHVCQUFzQixVQUNwQixTQStEUyxTQUFTLEtBQ2hCLE1BQU0sU0FBVSxTQUFTLGNBQ3pCLHNCQUFRLEdBQ1IsYUFBUSxNQUFNLGFBQ2QsZUFBUSxNQUFNLE1BQ2QsZ0JBQVEsTUFBTSxRQUNkLHlCQUFVLFlBQ1YsU0FDRCxPQUVELFNBQVMsV0FBVyxLQUFNLFlBQWEsYUFDckMsTUFBTSxLQUFNLFNBQVMsY0FDZixrQkFPRixVQUFVLElBQ2QsY0FBSSxHQUNKLFNBQUksTUFBTSxNQUNWLFlBQUksTUFBTSxPQUNWLFdBQUksTUFBTSxXQUNWLFdBQUksTUFBTSxNQUNWLFdBQUksTUFBTSxPQUNWLGNBQUksTUFBTSxRQUNWLFVBQUksTUFBTSxPQUNWLFVBQUksTUFBTSxLQUNWLHNCQUFJLE1BQU0sVUFDVixhQUFJLE1BQU0sV0FDVixXQUFJLE1BQU0sT0FDVixjQUFJLE1BQU0sUUFDVixtQkFBSSxVQUNKLGlCQUFZLFlBQ1osU0FBSSxpQkFDSixRQXhCZ0IsY0FBZ0IsUUFBUyxVQUN2QyxNQUFNLFNBQVUsSUFBSSxjQUFjLGlCQUNsQyxlQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksUUFBUSxPQUFlLFlBQVEsR0FBRyxNQUFNLFdBQzVELFdBQUksTUFBTSxXQUNWLFlBQUssYUFBYSxJQUFJLGNBQWMsSUFBTSxLQUMxQyxRQUFLLFdBQWEsSUFBSSxjQUFjLEdBQUcsT0FBTyxHQUFHLGNBQWdCLElBQUksY0FBYyxHQUFHLE1BQU0sR0FBSyxNQUNsRyxJQUNELEdBa0JELEdBRUQsTUF0R00sV0FBWSxTQUFTLGNBQzNCLE9BQU0sS0FFTixlQUFVLE1BQU0sU0FDaEIscUJBQVUsTUFBTSxNQUNoQixjQUFVLE1BQU0sSUFDaEIsY0FBVSxNQUFNLFFBQ2hCLGlCQUFVLE1BQU0sTUFDaEIsa0JBQVUsTUFBTSxPQUNoQixpQkFBUyxLQUFLLFlBRWQsbUJBeUJTLGtCQUNQLE1BQU0sU0FBVSxRQUNoQixrQkFBVSxRQUNWLG1CQUFVLE1BQ1YsbUJBQVUsT0FDVixtQkFBVSxPQUNWLG1CQUFVLFlBQ1gsUUFFRCxDQWpDQSxXQWlCUyxtQkFDUCxNQUFNLFNBQVUsUUFDaEIsbUJBQVUsT0FDVixtQkFBVSxNQUNWLG1CQUFVLFlBQ1gsUUFFRCxDQXZCQSxXQU9TLHFCQUNQLE1BQU0sU0FBVSxRQUNoQix5QkFBVSxNQUNWLG1CQUFVLE9BQ1YsbUJBQVUsUUFDVixtQkFBVSxPQUNWLG1CQUFVLFlBQ1gsUUFFRCxDQWRBLFdBNkY2QixnQkFDM0IsSUFBSSxVQUFXLFVBQVUsV0FBWSxVQUFXLFVBQzlDLElBQUksT0FBbUMsTUFBM0IsUUFBSyxhQUFhLEtBQzlCLEdBRGdELElBQU0sS0FBSyxhQUFhLE1BQ3BFLFlBQXlDLE9BQTNCLFFBQUssYUFBYSxLQUF3QixJQUFNLEtBQUssYUFDdkUsWUFEdUQsUUFDbEQsYUFDSCxVQUFVLEtBQUssYUFDZixjQUFNLEtBQUssYUFDWCxpQkFBYSxLQUFLLGFBQ2xCLGtCQUFPLEtBQUssYUFFVixPQUFDLEtBQ0wsMEJBQUssbUJBQW1CLFVBQVksS0FBSyxhQUFhLEtBQU8sTUFDN0QsaUJBQUssTUFBTSxLQUFLLG1CQUFtQixJQUNqQyxVQUFVLEtBQUssYUFDZixjQUFNLEtBQUssYUFDWCxpQkFBYSxLQUFLLGFBQ2xCLGtCQUFPLEtBQUssYUFFZixPQUNELFlBQVMsTUFBTSxNQUNmLGlCQUFTLE1BQU0sYUFDaEIsTUFDRixDQWxIQyxXQTZCUyxzQkFDUCxNQUFNLFNBQVUsUUFDaEIsc0JBQVUsVUFDVixtQkFBVSxnQkFDVixtQkFBVSxpQkFDVixtQkFBVSxXQUVWLG1CQUFVLGFBQ1YsbUJBQVUsbUJBQ1YsbUJBQVUsb0JBQ1YsbUJBQVUsY0FFVixtQkFBVSxhQUNWLG1CQUFVLG1CQUNWLG1CQUFVLG9CQUNWLG1CQUFVLGNBQ1gsUUFFRCxDQTdDQSxXQW9Ga0Msb0JBQ2hDLE1BQU0sVUFBVyxVQUFVLG9CQUFxQixVQUFXLElBQVEsTUFBZSxPQUNsRixZQUFTLE1BQU0sTUFDZixpQkFBUyxNQUFNLGFBQ2hCLE1BRUQsQ0F4RkEsRUFnSEYsd0JBQXVCLFVBQ3JCLElBQUksYUFFSixPQUFNLFlBQWEsQ0FBQyxFQUFHLEtBQU0sT0FDM0IsTUFBTSxLQUFNLFNBQVMsY0FDckIsV0FBSSxNQUFNLFNBQ1YsZUFBSSxHQUFLLGVBQ1QsTUFBSSxNQUFNLE1BQ1YsWUFBSSxNQUFNLE9BQ1YsV0FBSSxNQUFNLElBQWUsU0FBVCxRQUFxQixPQUNyQyxXQUFJLE1BQU0sV0FDVixXQUFJLE1BQU0sTUFDVixXQUFJLE1BQU0sT0FDVixjQUFJLE1BQU0sUUFDVixVQUFJLE1BQU0sS0FDVixzQkFBSSxNQUFNLFVBQ1YsYUFBSSxNQUFNLE9BQ1YsY0FBSSxNQUFNLEtBQVEsR0FBUyxHQUFKLEdBQ3ZCLFNBQUksVUFDSixLQUNFLFNBREUsWUFDRSxpQkFBaUIsUUFBUyxJQUM1QixVQUFTLGVBQWUsZUFBaUIsYUFBYSxNQUFNLFdBQzVELFdBQUksTUFBTSxXQUNWLG1CQUNELENBRUQsT0FBSSxpQkFBaUIsUUFBUyxJQUM1QixNQUFLLFdBQVcsY0FBYyxDQUFDLE1BQU8sWUFBYSxPQUNwRCxHQUVILFlBQVMsS0FBSyxZQUNmLElBRUQsR0FDRSxNQUNBLGFBQ0Esa0JBQ0EsbUJBQ0EsU0FDQSxRQUFRLENBQUMsR0FBSSxJQUFRLFlBQVcsRUFBRyxHQUFpQixVQUV0RCxJQUNFLE1BQ0EsT0FDQSxPQUNBLFdBQ0EsR0FDQSxNQUNBLE1BQ0EsV0FDQSxRQUFRLENBQUMsR0FBSSxJQUFRLFlBQVcsRUFBRyxHQUFlLFFBQ3JELEVBM1EyQyxlQ0E5QyxDQUlBLE9BQU8sa0JBQWtCLG1CQUN2QixNQUFNLFVBQ0osSUFDQSxhQUVJLGNBQUMsT0FBTyxNQUFNLGdCQUVsQixtQkFBUSxJQUFJLCtCQUVaLHFDQUNBLGtCQUNBLG1CQUVBLHdCQUFPLGlCQUFpQixZQUFhLEtBQUssWUFBWSxLQUV0RCxtQkFBYyxTQUFTLGVBQ3ZCLDJCQUFnQixTQUFTLGVBRXpCLG1CQUFPLGlCQUFpQixRQUFTLEtBQzNCLENBQUMsSUFDTCx3QkFBWSxLQUNaLDJCQUFZLEtBQ2IsYUFFRCxHQUNFLFFBREUsVUFBTyxNQUFNLGdCQUFnQixzQkFDbkIsS0FBSyxzQkFBdUIsQ0FBQyxLQUN6Qyx3Q0FBYyxLQUFLLHNCQUF1QixDQUFDLEtBQzNDLHNDQUFZLGFBQWEsYUFBYyxpQkFDdkMsdUNBQWMsYUFBYSxhQUFjLGlCQUV6Qyx1Q0FBWSxLQUFLLHNCQUF1QixDQUFDLEtBQ3pDLGdDQUFjLEtBQUssc0JBQXVCLENBQUMsS0FDM0MsOEJBQVksYUFBYSxhQUFjLGlCQUN2QywrQkFBYyxhQUFhLGFBQWMsaUJBSTNDLHVCQUFLLEdBQUcsS0FBSyxXQUViLGtCQUFTLGlCQUFpQixVQUFXLEtBQ25DLElBQ0EsaUJBQ0EsZ0JBQ0Esa0JBRUksd0JBQUMsS0FHTCxTQUNFLEVBREUsT0FBSSxhQUNGLEtBQ0YsMkJBQVksS0FDWixrQkFFQSwrQkFBWSxLQUNaLG9CQU1KLG1CQUNFLEVBREUsT0FBSSxhQUNGLEtBQ0Ysc0NBQWMsS0FDZCxrQkFFQSwwQ0FBYyxLQUNkLG9CQU1KLGlDQUNFLEVBREUsT0FBSSxVQUNGLEtBQ0YsaUNBQWMsS0FDZCxlQUVBLHFDQUFjLEtBQ2QsaUJBS0osdUJBQ0UsRUFERSxPQUFJLFVBQ0YsS0FDRiw2QkFBWSxLQUNaLGVBRUEsaUNBQVksS0FDWixpQkFLSixxQkFDRSxFQURFLE9BQUksdUJBQ1EsS0FJaEIsWUFBSSxJQUNGLDJCQUFvQixjQUFjLGFBQ2xDLFlBQTBCLEVBQXRCLE9BQUksNEJBQW9DLEdBQzVDLE1BQTBCLEVBQXRCLE9BQUksNEJBQW9DLEdBQzVDLE1BQTBCLEVBQXRCLE9BQUksNEJBQW9DLEdBQzVDLE1BQTBCLEVBQXRCLE9BQUksNEJBQW9DLEdBQzVDLE9BQW9CLEVBQWhCLE9BQUksU0FBeUMsR0FBdkIsT0FBSSw2QkFBcUMsR0FDbkUsTUFBMkIsR0FBdkIsT0FBSSw0QkFBcUMsR0FDN0Msb0JBQWMsYUFBYSxXQUFZLE9BQU8sTUFBTSxNQUVwRCxzQ0FBa0IsWUFBWSxhQUM5QixZQUEwQixFQUF0QixPQUFJLDBCQUFrQyxHQUMxQyxNQUEwQixFQUF0QixPQUFJLDBCQUFrQyxHQUMxQyxNQUEwQixFQUF0QixPQUFJLDBCQUFrQyxHQUMxQyxNQUEwQixFQUF0QixPQUFJLDBCQUFrQyxHQUMxQyxPQUFvQixFQUFoQixPQUFJLFNBQXlDLEdBQXZCLE9BQUksMkJBQW1DLEdBQ2pFLE1BQTJCLEdBQXZCLE9BQUksMEJBQW1DLEdBQzNDLGtCQUFZLGFBQWEsV0FBWSxPQUFPLE1BQU0sTUFJcEQsbUJBQUksSUFDRiwyQkFBb0IsY0FBYyxhQUNsQyxZQUEwQixFQUF0QixPQUFJLDRCQUFvQyxHQUM1QyxJQUEwQixFQUF0QixPQUFJLDRCQUFvQyxHQUM1QyxJQUEwQixFQUF0QixPQUFJLDRCQUFvQyxHQUM1QyxJQUEwQixFQUF0QixPQUFJLDRCQUFvQyxHQUM1QyxrQkFBYyxhQUFhLFdBQVksT0FBTyxNQUFNLE1BRXBELHNDQUFrQixZQUFZLGFBQzlCLFlBQTBCLEVBQXRCLE9BQUksMEJBQWtDLEdBQzFDLElBQTBCLEVBQXRCLE9BQUksMEJBQWtDLEdBQzFDLElBQTBCLEVBQXRCLE9BQUksMEJBQWtDLEdBQzFDLElBQTBCLEVBQXRCLE9BQUksMEJBQWtDLEdBQzFDLGdCQUFZLGFBQWEsV0FBWSxPQUFPLE1BQU0sTUFFckQsMEJBQ0YsR0FFRCxPQUFNLFVBQ0osSUFDQSxhQUVBLG1CQUFLLE9BQVMsU0FBUyxLQUVuQix3QkFBQyxPQUFPLE1BQU0sZ0JBRWxCLHVCQUFjLFNBQVMsZUFDdkIsMkJBQWdCLFNBQVMsZUFFekIsMEJBQWMsU0FBUyxTQUFTLElBQUksQ0FBQyxJQUFLLElBQUssQ0FDL0MsaUJBQVksU0FBUyxTQUFTLElBQUksSUFBSyxJQUFLLENBQzVDLG1CQUFjLGFBQWEsV0FBWSxDQUFDLEVBQUcsR0FBSSxFQUFHLEVBQUcsRUFDdEQsSUFFRCxjQUFjLFVBQ1osTUFBTSxXQUFZLEdBQUksT0FDdEIsUUFBTSxNQUFRLEdBQUksT0FDbEIsUUFBTSxVQUFZLEdBQUksT0FFdEIsY0FBTyxVQUFVLElBQ2YsTUFBTSxRQUFTLEtBQ2YsT0FBTSxPQUFTLEtBQUssR0FBRyxRQUN2QixPQUFNLEtBQU8sSUFBSSxRQUFVLE9BQzNCLEtBQU0sSUFBTSxJQUFJLFFBQVUsT0FDMUIsVUFBTSxFQUE0QixDQUF2QixPQUFPLE9BQU8sT0FDekIsUUFBTSxFQUE2QixDQUF4QixHQUFDLElBQU0sT0FBTyxRQUV6QixXQUFTLGVBQWUsVUFBVSxTQUFTLGlCQUMzQyxxQkFBVSxJQUFJLE1BQU0sRUFBRyxNQUFNLEVBQUcsS0FBSyxVQUFVLFFBQVEsSUFBSSxXQUUzRCxpQkFBTSxTQUFVLFNBQVMsZUFBZSxhQUFhLFNBQ3JELFNBQU0sU0FBVyxDQUFDLFVBQVUsRUFBSSxVQUNoQyxTQUFPLGlCQUFpQixTQUFTLElBQUksVUFBVSxlQUMvQyxtQkFBUSxHQUNULEdBQ0YsQ0FyQlksaUJDOUpmLENBR0EsT0FBTyxrQkFBa0IsZUFDdkIsTUFBTSxVQWdCTCxDQUVELE1BQUssU0FBVSxNQUFPLGNBQWUsTUFDbkMsQ0FBSSxjQUNGLFdBQWEsVUFBVyxVQUFJLGNBQWlCLEVBQUksYUFBZSxLQUVoRSxhQUFhLFVBQVcsS0FBSyxjQUFlLEtBQzVDLFlBQVEsSUFFWCxlQTFCc0MsZUNIekMsQ0FHQSxPQUFPLGtCQUFrQixrQkFDdkIsY0FBYyxDQUVkLGFBQU0sVUFDQSxDQUFDLE9BQU8sTUFBTSxnQkFDbEIsZ0NBQVksSUFDVixTQUFRLElBQUksS0FBSyxHQUFHLFdBQVcsS0FDaEMsaUJBRkQsRUFHRCxJQVJ5QyxlQ0g1QyxDQUdBLE9BQU8sa0JBQWtCLGNBQ3ZCLE1BQU0sVUFDSixNQUFNLE9BQVEsT0FBTyxNQUFNLGdCQUFnQixjQUN2QyxPQUVKLGtCQUFXLElBQ1QsT0FBTSxNQUFNLEtBQUssUUFBUSxNQUN2QixNQUFLLEdBQUcsUUFBYyxhQUFPLEtBQVksTUFBekMsR0FDRCxRQUNGLEVBSkQsRUFLRCxJQVZxQywyRUNrRHhDLFFBQVMsZ0JBQWdCLE1BQ3ZCLGFBQVksSUFFTixZQU9BLFlBUFksQ0FDaEIsQ0FBQyxPQUFRLE9BQVEsT0FBUSxRQUN6QixDQUFDLE9BQVEsT0FBUSxPQUFRLFFBQ3pCLENBQUMsT0FBUSxPQUFRLE9BQVEsUUFDekIsQ0FBQyxPQUFRLE9BQVEsT0FHbkIsUUFBbUIsQ0FBVSxJQUFJLENBQUMsYUFBYyxJQUM5QyxNQUFNLFVBQVcsR0FBSSxPQUFNLHVCQUN6QixhQUFhLE9BQ2IsYUFBYSxPQUNiLGFBR0YsUUFBTSxXQUNOLE9BQUssR0FBSSxHQUFJLEVBQUcsRUFBSSxTQUFTLFdBQVcsU0FBUyxNQUFNLE9BQVEsR0FDN0QsYUFBVyxHQUFLLFlBQ2hCLGFBQVcsRUFBSSxHQUFLLFlBQ3BCLGFBQVcsRUFBSSxHQUFLLFlBRXRCLFdBQVMsYUFBYSxRQUFTLEdBQUksT0FBTSx1QkFBdUIsV0FFaEUsU0FBTSxVQUFXLDJGQUFXLEVBQUcsRUFBRyxFQUNsQyxHQUFNLElBQU0sU0FBUyxXQUFXLEdBQ2hDLFVBQUssR0FBSSxHQUFJLEVBQUcsRUFBSSxJQUFJLE9BQVEsR0FDOUIsTUFBSSxHQUFLLFNBQVMsR0FDbEIsTUFBSSxFQUFJLEdBQUssU0FBUyxHQUV0QixNQUFJLEVBQUksR0FBSyxTQUFTLEdBQ3RCLE1BQUksRUFBSSxHQUFLLFNBQVMsR0FFdEIsTUFBSSxFQUFJLEdBQUssU0FBUyxHQUN0QixNQUFJLEVBQUksR0FBSyxTQUFTLEdBRXhCLGtCQUFTLFdBQVcsR0FFcEIsZUFDRCxRQUVELEdBQU0sU0FBVyxNQUFNLG9CQUFvQixzQkFDM0Msa0JBQ0QsUyxnUEFqR0QsMERBQ0Esb0JBRUEsU0FBTSxhQUFjLEdBQUksT0FFeEIsTUFBTSxTQUNOLGlCQUFNLFNBQVcsR0FBSSxPQUFNLGtCQUN6QixVQW1CRixRQUFTLGlCQUNQLE1BQU0sYUFBYyxTQUFTLGNBQzdCLHNCQUFZLE9BQ1osY0FBWSxNQUVaLE9BQU0sS0FBTSxZQUFZLFdBR3hCLGlCQUFJLFVBQ0osc0JBQUksU0FBUyxFQUFHLEVBQUcsRUFDbkIsT0FBSSxVQUNKLHNCQUFJLFNBQVMsRUFBRyxFQUFHLEVBQ25CLE9BQUksVUFDSixzQkFBSSxTQUFTLEVBQUcsRUFBRyxFQUNuQixPQUFJLFVBQ0osc0JBQUksU0FBUyxFQUFHLEVBQUcsRUFFbkIsY0FBVyxJQUNULGFBQVksTUFBTSxTQUNsQixvQkFBWSxNQUFNLE9BQ2xCLHlCQUFZLE1BQU0sS0FDbEIsY0FBWSxNQUFNLElBQ2xCLFdBQVMsS0FBSyxZQUNmLFlBQ0QsT0FBTyxHQUFJLE9BQU0sY0FDbEIsYUEzQ0MsR0FDQSw0QkFBYyxNQUdoQixlQUlBLE9BQU8sa0JBQWtCLFlBQ3ZCLFFBQ0UsT0FBTyxDQUFDLFFBR1YsY0FBTSxVQUNKLE1BQUssR0FBRyxZQUFZLE9BQVEsR0FBSSxPQUFNLEtBQUssZUFBZSxLQUFLLEtBQUssT0FDckUsVUFQbUMsaURDZnRDLE1BQU0sUUFBUyxvQkFDZixHQUFNLFVBQVksR0FBSSxPQUFNLE1BQU0sT0FDbEMsVUFBTSxhQUFlLEdBQUksT0FBTSxNQUFNLE9BQU8sa0JBRXJDLGVBQWUsc0JBRWxCLFdBQVcsQ0FBQyxLQUFNLE1BQU8sR0FDekIsa0JBQVEsQ0FBQyxLQUFNLE1BQU8sR0FDdEIsb0JBQVUsQ0FBQyxLQUFNLE9BQVEsR0FBSSxVQUFXLFFBQVMsQ0FBQyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQzlELFlBQVMsQ0FBQyxLQUFNLE9BQVEsR0FBSSxVQUFXLFFBQVMsQ0FBQyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBRy9ELEtBQWUsYUFXZjs7Ozs7Ozs7O0dBbEJBLENBa0JpQjs7Ozs7Ozs7OzZCQVNVLFVBQVksTUFBSSxVQUFZLE1BQUksVUFBWTtnQ0FDekMsYUFBZSxNQUFJLGFBQWUsTUFBSSxhQUFlLENBN0JoRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBQXJDLGNDTEEsT0FBTyxrQkFBa0IsV0FDdkIsUUFDRSxZQUFZLENBR2Qsa0JBQU0sVUFDSixNQUFLLGNBQWdCLFNBQVMsZUFDOUIsc0JBQUssWUFBYyxTQUFTLGlCQUM3Qix3QkFFRCxTQUFRLFNBQVUsUUFDWixDQUFPLEtBQ1gsS0FBSSxDQUFDLFFBQVEsWUFBYyxLQUFLLEtBQzlCLGtCQUNBLHlCQUFLLFVBRVAsR0FBSSxRQUFRLFlBQWMsQ0FBQyxLQUFLLEtBQzlCLGlCQUVILE9BRUQsT0FBTSxTQUFVLEtBQU0sTUFDcEIsQ0FBSSxDQUFDLEtBQUssS0FDVixZQUNFLENBREUsT0FBSyxpQkFDRixjQUFjLFNBQVMsU0FBUyxFQUNyQyxHQUR5QyxFQUFDLEtBQUssSUFBSSxFQUFJLEtBQUssVUFBVyxRQUNsRSxXQUVSLFVBRUQsUUFBTyxVQUNMLE1BQUssY0FBYyxTQUFTLFNBQVMsRUFDckMsT0FBSyxHQUFHLFFBQVEsYUFBYSxlQUFnQixRQUM5QyxPQUVELG9CQUFtQixVQUNqQixLQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksS0FBSyxZQUFZLE9BQ25DLFNBQUssWUFBWSxHQUFHLEtBQUssV0FFM0IsY0FBSyxHQUFHLEtBQUssY0FDYixjQUFLLEdBQUcsS0FBSyxrQkFDZCxRQXhDa0MsZ0JDQXJDLEdBQUksR0FFSixFQUlBLE9BQU8sa0JBQWtCLGdCQUN2QixjQUFjLENBRWQsa0JBQU0sVUFDSixNQUVBLGdDQUFXLElBQ1QsTUFDQSxvQkFFQSxtQkFDQSx5QkFDQSwyQkFFQSx1QkFDQSx5QkFHQSw2QkFDRCxlQUNGLE1BRUQsZUFBYyxVQUNaLE1BQU0sT0FBUSxTQUFTLGNBQ3ZCLGtCQUFLLGVBQWUsTUFBTSxZQUFZLFFBQVEsU0FBUyxHQUFHLFNBQVMsU0FBUyxJQUM3RSxNQUVELGNBQWEsVUFDWCxNQUFNLE1BQU8sU0FBUyxjQUN0QixrQkFBSyxlQUFlLEtBQUssWUFBWSxRQUFRLFNBQVMsR0FBRyxTQUFTLFNBQVMsSUFDNUUsTUFFRCxpQkFBZ0IsVUFDZCxNQUFNLE9BQVEsU0FBUyxjQUN2QixnQkFBSyxlQUFlLE1BQU0sV0FBVyxNQUN0QyxRQUVELG9CQUFtQixVQUNqQixNQUFNLE1BQU8sU0FBUyxjQUN0Qix1Q0FBSyxTQUFTLFNBQVMsTUFDakIsQ0FBQyxLQUNMLFdBQUksS0FBSyxTQUNQLGFBQUssZUFBZSxLQUFLLFNBRTNCLFFBQUksS0FBSyxTQUNQLFVBQUssZUFBZSxLQUFLLFNBRTVCLEtBQ0YsRUFFRCxzQkFBcUIsVUFDbkIsTUFBTSxXQUFZLFNBQVMsY0FDM0Isd0JBQUssZUFBZSxVQUFVLFdBQVcsZUFBZSxTQUN6RCxJQUVELGtCQUFpQixVQUNmLE1BQU0sVUFBVyxTQUFTLGVBQWUsWUFBWSxXQUNyRCx1QkFBSyxlQUFlLFNBQVMsTUFBTSxZQUFZLFFBQVEsU0FDdkQsVUFBSyxlQUFlLFNBQVMsY0FBYyxZQUFZLFFBQVEsU0FDaEUsSUFFRCxxQkFBb0IsVUFDbEIsTUFBTSxhQUFjLEtBQUssR0FBRyxRQUFRLFdBQ3BDLHFCQUFLLEdBQUcsUUFBUSxpQkFBaUIsc0JBQXVCLElBQ3RELE1BQUssZUFBZSxZQUFZLFdBQ2pDLElBQ0QsUUFBSyxHQUFHLFFBQVEsaUJBQWlCLHVCQUF3QixJQUN2RCxNQUFLLGVBQWUsWUFBWSxXQUNqQyxLQUNGLEVBRUQsaUJBQWdCLFVBQ2QsTUFBTSxNQUFPLFNBQVMsY0FDdEIsa0JBQUssZUFBZSxLQUFLLFlBQVksUUFBUSxTQUM5QyxJQUVELG9CQUFtQixVQUNqQixNQUFNLFlBQWEsU0FBUyxjQUM1QixvQkFBSyxlQUFlLFdBQVcsWUFBWSxRQUFRLFNBQ3BELElBRUQsd0JBQXdCLFVBQ3RCLE1BQU0sVUFBVyxTQUFTLGNBQzFCLHdCQUFLLGVBQWUsU0FBUyxTQUFTLEdBQUcsWUFBWSxRQUFRLFNBQzlELElBRUQsaUJBQWdCLFVBQ2QsTUFBTSxNQUFPLFNBQVMsY0FDdEIsdUJBQUssZUFBZSxLQUFLLFlBQVksUUFBUSxTQUFTLFNBQVMsSUFDL0QsWUFBSyxlQUFlLEtBQUssWUFBWSxRQUFRLFNBQVMsU0FBUyxJQUNoRSxNQUVELGtCQUFpQixVQUNmLE1BQU0sT0FBUSxTQUFTLGNBQ3ZCLG1CQUFLLGVBQWUsTUFBTSxZQUFZLFFBQVEsU0FDL0MsSUFFRCxnQkFBZSxVQUNiLE1BQU0sUUFBUyxTQUFTLGNBQ3hCLG1CQUFLLGVBQWUsT0FBTyxZQUFZLFFBQVEsU0FDaEQsSUFFRCxpQkFBZ0IsU0FBVSxRQUN4QixPQUFnQixRQUFaLEVBQWEsUUFDZixNQUdHLFFBQVEsTUFDWCxtQkFHRyxHQUFHLFNBQVMsYUFBYSxRQUFTLElBQ3hDLGdCQUpXLEtBQUsscURBR2Ysc0JBUFUsS0FBSywyQ0FHWCxRQTNHa0MsZ0JDTjFDLE9BQU8sa0JBQWtCLE9BQ3ZCLE1BQU0sVUFDSixZQUFXLElBQ1QsTUFBSyxHQUFHLFFBQ1QsU0FDRixNQUw4QixnQkNBakMsS0FBTSxRQUFTLENBQ2IsY0FDQSxXQUNBLGNBQ0EsY0FDQSxjQUNBLGNBSUYsZ0JBR0EsT0FBTyxrQkFBa0IsZUFDdkIsUUFDRSxTQUFTLENBR1gsa0JBQU0sVUFDSixNQUFLLFNBQVcsS0FBSyxTQUFTLEtBQzlCLGFBQU8sUUFBUSxPQUNiLE1BQUssR0FBRyxpQkFBaUIsTUFBTyxLQUNqQyxTQUNGLEVBRUQsV0FBVSxVQUNKLENBQUMsS0FBSyxLQUdWLGNBQUssR0FBRyxRQUFRLEtBQUssaUJBQ3RCLFFBakJzQyxlQ2J6QyxDQUdBLE9BQU8sa0JBQWtCLGdCQUN2QixNQUFNLFVBQ0osTUFBTSxJQUFLLEtBRVgsUUFDQSxvQkFBSyxLQUFPLE9BQU8sTUFBTSxhQUFhLEtBQUssS0FBSyxLQUFLLE1BRXJELFFBQUcsYUFBYSxpQkFBa0IsQ0FBQyxJQUFLLElBQUssTUFFN0MsV0FBRyxpQkFBaUIsYUFBYyxLQUNoQyxJQUFLLElBQWMsTUFBZixFQUFnQixJQUFJLE9BRXhCLG9CQUFNLGVBQWdCLElBQUksT0FDMUIsb0JBQUssZUFBYyxVQUFVLFNBQVMsUUFBbEMsRUFBOEMsZ0JBQ2hELGFBS0Ysb0JBQUssR0FBRyxXQUFXLGVBQ3BCLG1CQUZDLGdCQUlGLE1BQUcsaUJBQWlCLGFBQWMsSUFDaEMsTUFDRCxjQUNGLEVBRUQsT0FBTSxVQUNBLENBQUMsS0FDTCxrQkFBSyxHQUFHLFdBQVcsZUFDcEIsT0E5QnVDLGVDSDFDLENBR0EsT0FBTyxrQkFBa0IsZUFDdkIsTUFBTSxVQUNKLE1BQU0sSUFBSyxLQUNYLFFBQ0Esb0JBQUcsYUFBYSxnQkFBaUIsQ0FBQyxJQUFLLEdBQUksTUFFM0MsYUFBSyxtQkFBcUIsS0FBSyxtQkFBbUIsS0FDbEQsU0FBRyxpQkFBaUIsYUFBYyxLQUNsQyx1QkFBRyxpQkFBaUIsYUFBYyxLQUVsQyx5QkFBSyxLQUFPLE9BQU8sTUFBTSxhQUFhLEtBQUssS0FBSyxLQUFLLE1BQ3RELEdBS0QscUJBQW9CLFVBQ2xCLE1BQU0sZ0JBQWlCLEtBQUssR0FBRyxXQUFXLGdCQUMxQyxvQkFDQSxxQkFBSyxHQUFJLEdBQUksRUFBRyxFQUFJLGVBQWUsT0FDakMsT0FBSSxlQUFlLEdBQUcsV0FDcEIsS0FJTCxpQkFISyxpQkFLTixPQUFNLFVBQ0EsQ0FBQyxLQUNMLG9CQUFLLEdBQUcsV0FBVyxjQUNwQixPQTlCc0MsZUNIekMsQ0FHQSxPQUFPLGtCQUFrQixVQUN2QixRQUNFLGFBQWEsQ0FBQyxLQUNkLG1CQUFVLENBQUMsS0FDWCxzQkFBYSxDQUFDLEtBR2hCLGtCQUFRLFVBQ04sTUFBTSxNQUFPLEtBQ2IsYUFBUSxVQUNOLEdBQ0EsS0FBSyxTQUNMLGlCQUFpQixPQUFPLFNBQVMsS0FBTSxZQUFhLEtBRXRELHVCQUFrQix1QkFBZ0IsS0FBYyxRQUNqRCxFQWZpQyxnQkNIcEMsT0FBTyxrQkFBa0IsYUFDdkIsUUFDRSxXQUFXLENBQ1gsd0JBQWEsQ0FHZixrQkFBTSxVQUNKLE1BQUssV0FBYSxTQUFTLGVBQzNCLHNCQUFLLE1BQVEsU0FBUyxlQUN0QixrQkFBSyxRQUNOLElBRUQsU0FBUSxTQUFVLFFBQ2hCLE1BQU0sT0FBUSxLQUVWLE1BQUMsS0FBSyxHQUFHLFFBRWIsWUFBSyxRQUFRLFdBQVQsR0FBd0IsS0FBSyxLQUdqQyxlQUFJLENBQUMsUUFBUSxXQUFhLEtBQUssS0FDN0IsaUJBQUssV0FBVyxXQUFXLGNBQzNCLHFCQUFLLFdBQVcsYUFBYSxnQkFBaUIsTUFDOUMsWUFJRixlQUFJLFFBQVEsV0FBYSxDQUFDLEtBQUssS0FBa0IsaUJBQ2xELFFBRUQsUUFBTyxVQUNMLE1BQUssTUFDTixPQUVELE9BQU0sVUFDSixNQUNELGFBRUQsY0FBYSxVQUNYLEtBQUksT0FBTyxNQUFNLGdCQUNqQixjQUFNLFNBQVUsS0FBSyxXQUFXLFdBQVcsY0FDM0MsUUFBTSxTQUFXLEtBQUssV0FBVyxXQUFXLGNBQzVDLGtCQUFTLEtBQUssZUFBZSxFQUFHLFFBQ2hDLGtCQUFLLE1BQ0wsZ0JBQVMsS0FBSyx3QkFBd0IsSUFBSyxRQUFRLFlBQ3BELEtBN0NvQyxnQkNBdkMsT0FBTyxrQkFBa0IsdUJBQ3ZCLGNBQWMsQ0FFZCx5QkFDRSxXQUFXLENBQUMsUUFHZCxVQUFNLFVBQ0osTUFBSyxHQUFHLFdBQVcsa0JBQWtCLE1BQU0sYUFBYSwyQkFDQSxLQUFLLEtBQzlELFVBVjhDLGtEQ0FqRCxLQUFNLFVBQVcsb0JBQVEsS0FDekIsb0JBRU0sS0FNTixPQUFPLGtCQUFrQixjQUN2QixRQUNFLFFBQVEsQ0FBQyxLQUNULHFCQUFZLENBQUMsS0FDYixzQkFBYSxDQUFDLEtBQ2Qsb0JBQVcsQ0FBQyxLQUNaLHdCQUFlLENBQUMsS0FDaEIsNEJBQW1CLENBQUMsS0FFcEIsc0JBQWEsQ0FBQyxRQUNkLDRCQUF5QixDQUFDLFFBQzFCLGNBQVcsQ0FHYixrQkFBTSxVQUNKLE1BQ0EsNEJBQUssT0FDTCxRQUFLLFlBQWMsQ0FBQyxPQUFRLEtBQzVCLGFBQUssZUFBaUIsQ0FBWSxpQkFFbEMsbUJBQUssU0FBVyxhQUFhLFFBQVEsdUJBQ3JDLG9CQUFLLEdBQUcsaUJBQWlCLHNCQUF1QixLQUM5QyxNQUFLLFNBQVcsSUFBSSxPQUNwQixtQkFBYSxRQUFRLHFCQUFzQixLQUM1QyxTQUNELFFBQUssR0FBRyxpQkFBaUIsb0JBQXFCLEtBQUssU0FBUyxLQUM3RCxNQUVELFNBQVEsU0FBVSxRQUVoQixDQUFJLENBQUMsU0FBUyxLQUFLLFFBQVUsS0FBSyxLQUNoQyxrQkFBUyxjQUNQLFFBQVEsS0FBSyxLQUNiLGtCQUFZLEtBQUssS0FDakIsdUJBQWEsS0FBSyxLQUNsQixzQkFBVyxLQUFLLEtBQ2hCLHdCQUFlLEtBQUssS0FDcEIsZ0NBQW1CLEtBQUssS0FFMUIseUJBQUssVUFBWSxTQUNqQixpQkFBSyxVQUFVLFNBQVMsQ0FDeEIsZ0NBQUssR0FBSyxLQUFLLFVBQVUsV0FHM0IsV0FBSSxDQUFDLFFBQVEsV0FBYSxLQUFLLEtBQzdCLGdCQUdGLDBCQUFJLEtBQUssS0FBSyx5QkFDVixRQUFRLDBCQUE0QixLQUFLLEtBQzNDLDhCQUFLLFlBQVksS0FBSyxLQUd4Qix5QkFBSSxLQUFLLEtBQUssYUFBZSxRQUFRLGNBQWdCLEtBQUssS0FDeEQsa0JBQUssWUFBWSxLQUFLLEtBRXpCLFlBRUQsV0FBVSxVQUNSLE1BQU0sT0FBUSxLQUFLLEdBQUcsUUFBUSxRQUFRLE1BQ3RDLE1BQUksR0FBQyxNQUNMLGdCQUFNLFdBQ0osVUFBVSxNQUFNLE1BQ2hCLHFCQUFhLE1BQU0sVUFDbkIsU0FBTyxNQUFNLE1BQ2IsZUFBVSxLQUNWLG9CQUFZLE1BQU0sVUFDbEIsZ0JBQU0sR0FFUixZQUFLLEdBQUcsSUFDUixnQkFBSyxlQUFlLFVBQ3BCLGVBQUssR0FBRyxLQUFLLHdCQUF5QixLQUN2QyxtQkFFRCxjQUFhLFNBQVUsWUFDckIsTUFBTSxPQUFRLEtBQUssR0FBRyxRQUFRLFFBQVEsTUFDdEMsTUFBTSxNQUFRLEtBQUssR0FDaEIsTUFBTSxjQUFlLEtBQU0sYUFDM0IsTUFDQyxhQUFjLEtBQ2QsTUFBTSxzQkFBc0IsR0FDeEIsTUFBTSxzQkFBc0IsV0FDNUIsTUFBTSxVQUFVLFlBQ3JCLFFBQVEsUUFBUyxRQUNqQixRQUFRLE9BQVEsT0FDaEIsTUFDSCxVQUFNLE1BQU0sS0FBSyxVQUNmLE1BQUssWUFBWSxZQUNqQixpQkFBSyxPQUFPLE9BQ1IsRUFBQyxTQUNILGdCQUFTLFFBQVEsT0FBUyxLQUFLLE9BQU8sS0FBSyxNQUU3QyxjQUFLLEdBQUcsUUFBUSxLQUFLLGNBQWUsS0FDckMsZUFQRCxHQU9HLE1BQU0sR0FDUCxTQUFRLE1BQU0sY0FDZixFQUNGLEVBS0QsMEJBQXlCLFVBQ3ZCLE1BQU0sT0FBUSxLQUFLLEdBQUcsUUFBUSxRQUFRLE1BQ3RDLE1BQU0sTUFBUSxNQUFNLE1BR3BCLFNBQUksS0FBSyxPQUNQLE9BL0dOLEdBcUhJLFlBTk8sZ0JBQWtCLEtBQUssT0FDNUIsaUJBQUssR0FBRyxRQUFRLEtBQUsscUJBQXNCLEtBQUssT0FDaEQsZUFJRyxHQUFJLEdBQUksRUFBRyxFQUFJLEtBQUssT0FBTyxPQUM5QixPQUFJLE1BQVEsS0FBSyxPQUFPLEdBQ3RCLE1BS0wsWUFMVSxnQkFDTCxZQUFLLEdBQUcsUUFBUSxLQUFLLHFCQUNyQixLQXJIZ0MsZ0JDVHhDLEdBQUksTUFBTyxDQUVYLFNBR0EsT0FBTyxrQkFBa0IsYUFDdkIsTUFBTSxVQUNKLE1BQUssU0FBVyxTQUFTLGVBQ3pCLGlCQUFLLFVBQVksU0FBUyxlQUMxQixrQkFBSyxXQUFhLFNBQVMsZUFDNUIsYUFFRCxPQUFNLFVBQ0osWUFBVyxJQUNULE1BQUssR0FBRyxhQUFhLFFBQ25CLE1BQ0EsZ0JBQ0EsWUFDQSxRQUVGLFVBQUssY0FBYyxLQUNuQixlQUFLLGNBQWMsS0FDbkIsZ0JBQUssY0FBYyxLQUNwQixXQUNGLE1BRUQsZ0JBQWUsU0FBVSxHQUN2QixDQUFJLEdBQUcsWUFDTCxXQUFHLFNBQVMsU0FBUyxLQUVyQixvQkFBRyxpQkFBaUIsZUFBZ0IsSUFDbEMsSUFBRyxTQUFTLFNBQVMsS0FDdEIsZ0JBRkQsRUFJSCxLQUVELGtCQUFpQixTQUFVLEtBQ3pCLENBQUksS0FDRixnQkFBSyxTQUVSLGVBbkNvQyxnQ0MyQmIsS0FBSyxNQWhDL0IsT0FBTyxrQkFBa0IsY0FDdkIsUUFDRSxPQUFPLENBQ1Asb0JBQVEsQ0FHVixrQkFBTSxVQUNKLE1BQUssT0FBUyxLQUFLLE9BQU8sS0FDMUIsV0FBSyxNQUFRLEtBQUssTUFBTSxLQUN4QixXQUFLLFFBRUwsT0FBSyxPQUFTLFNBQVMsZUFDdkIsbUJBQUssZUFBaUIsQ0FDcEIsQ0FBQyxTQUFVLEdBQUksT0FBTSxRQUFRLEVBQUcsSUFBTSxJQUN0QyxDQUFDLFNBQVUsR0FBSSxPQUFNLFFBQVEsSUFBSyxJQUFLLElBQ3ZDLENBQUMsU0FBVSxHQUFJLE9BQU0sUUFBUSxDQUFDLElBQUssSUFFdEMsSUFFRCxTQUFRLFNBQVUsUUFDaEIsQ0FBSSxLQUFLLEtBQUssU0FBVyxRQUN2QixTQUFJLEtBQUssS0FDUCxZQUVBLHFCQUFhLEtBR2xCLFNBRUQsU0FBUSxVQUNOLE1BQUssR0FBRyxTQUNSLGdCQUFLLE9BQU8sS0FBSyxjQUNmLEtBQUssMkJBQTBCLEtBQUssU0FBVyxLQUFLLGVBR3RELGtCQUFLLFFBQVUsV0FBVyxLQUFLLE1BQ2hDLEdBRUQsUUFBTyxVQUNMLE1BQUssR0FBRyxTQUNSLGdCQUFLLFFBQVUsV0FBVyxLQUFLLE9BQ2YsWUFBeUIsQ0FBbEIsTUFBSyxLQUFLLE1BQVksR0FBTSxLQUFLLFNBQVcsS0FBSyxLQUN6RSxPQTFDcUMsaURDQXhDLE1BQU0sUUFBUyxvQkFDZixHQUFNLFlBQWMsb0JBQ3BCLElBQU0scUJBQXVCLG9CQUM3QixJQUFNLG1CQUFxQixvQkFBUSxJQUVuQyxPQUFPLGVBQWUsWUFDcEIsTUFBTSxVQUNKLENBQ0UsU0FERSxZQUFTLG9CQUNGLGlCQUFpQixtQkFBb0IsS0FBSyxnQkFBZ0IsS0FFbkUsWUFFSCxpQkFFRCxrQkFBaUIsVUFDZixNQUFLLFlBQWMsR0FBSSxPQUFNLGVBQzNCLFVBQ0UsVUFBVSxDQUFDLE1BQU8sR0FBSSxPQUFNLE1BQU0sT0FDbEMseUJBQWUsQ0FBQyxNQUFPLEdBQUksT0FBTSxNQUFNLE9BQ3ZDLGNBQ0UsT0FBTyxHQUFJLE9BQU0sZ0JBQWdCLEtBQUssU0FBUyxlQUFlLFlBR2xFLG9CQUFjLG1CQUNkLDRCQUFnQixtQkFDaEIsZUFDQSxPQUdGLHNCQUFLLGNBQWdCLEdBQUksT0FBTSxlQUM3QixVQUNFLFlBQVksQ0FBQyxNQUFPLEdBQUksT0FBTSxNQUFNLE9BQ3BDLHFCQUFXLENBQUMsTUFBTyxHQUFJLE9BQU0sTUFBTSxPQUNuQyxxQkFBVyxDQUFDLE1BQU8sR0FBSSxPQUFNLE1BQU0sT0FDbkMsdUJBQVksQ0FBQyxNQUFPLEdBQUksT0FBTSxNQUFNLE9BQ3BDLHFCQUFVLENBQUMsTUFBTyxHQUFJLE9BQU0sTUFBTSxPQUNsQyxlQUNFLE9BQU8sR0FBSSxPQUFNLGdCQUFnQixLQUFLLFNBQVMsZUFBZSxZQUdsRSxvQkFBYyxxQkFDZCw0QkFBZ0IscUJBQ2hCLHdCQUFVLE1BQ1YsaUJBQ0EsT0FHRixzQkFBSyxLQUFPLEdBQUksT0FBTSxlQUNwQixVQUNFLEtBQ0UsT0FBTyxHQUFJLE9BQU0sZ0JBQWdCLEtBQUssU0FBUyxlQUFlLGNBR2xFLG9CQUFjLFlBQ2QsNEJBQWdCLFlBQ2hCLGVBQ0EsYUFDQSxPQUdGLHNCQUFLLGFBQWUsR0FBSSxPQUFNLGVBQzVCLFVBQ0UsS0FDRSxPQUFPLEdBQUksT0FBTSxnQkFBZ0IsS0FBSyxTQUFTLGVBQWUsY0FHbEUsb0JBQWMsWUFDZCw0QkFBZ0IsWUFDaEIsZUFDQSxzQkFBVSxNQUNWLGlCQUNBLE9BR0Ysc0JBQUssZ0JBQWtCLEdBQUksT0FBTSxxQkFDL0IsV0FDQSxlQUNBLFdBQU8sR0FBSSxPQUFNLE1BQU0sT0FDdkIsbUJBQVUsR0FBSSxPQUFNLE1BQU0sT0FDMUIsMEJBQVEsR0FBSSxPQUFNLGdCQUFnQixLQUdwQyx3Q0FBSyxpQkFBbUIsR0FBSSxPQUFNLHFCQUNoQyxXQUNBLGVBQ0EsV0FBTyxHQUFJLE9BQU0sTUFBTSxPQUN2QixvQkFBVSxHQUFJLE9BQU0sTUFBTSxPQUMxQiwyQkFBUSxHQUFJLE9BQU0sZ0JBQWdCLEtBR3JDLG1DQXJGZ0MsSUF3Rm5DLE9BQU8sa0JBQWtCLFlBQ3ZCLFFBQ0UsTUFBTSxDQUFFLFFBQ1IsY0FBVyxDQUdiLG9CQUFRLFVBQ04sSUFFQSxFQUZJLFFBQUssS0FBSyxXQUVSLFVBQVcsS0FBSyxPQUFPLEtBQUssS0FDbEMsU0FBSSxDQUNGLFNBSUYsb0JBSmdCLDRCQUFzQixLQUFLLE9BQU8sS0FBSyxLQUFXLEtBQ2hFLFVBR0ksTUFBTyxLQUFLLEdBQUcsWUFDakIsUUFDRixVQUVLLGNBRVIsV0FKUSxHQUFHLGlCQUFpQixlQUFnQixLQUFLLGNBQWMsS0FFNUQsT0FJSixnQkFBZSxTQUFVLElBQ3ZCLE1BQU0sVUFBVyxLQUFLLE9BQU8sS0FBSyxLQUNsQyxNQUFxQixpQkFBTSxJQUFJLE9BQy9CLE9BQUksS0FBSyxLQUNQLGNBQUksU0FBUyxHQUNYLENBQ0UsTUFERSxLQUFFLFNBQ0YsU0FFTCxTQUVELE9BQUksU0FFUCxRQW5DbUMsZUM3RnRDLElBRUEsd0JBQUksUUFBVSxLQURkLGFBR0EsS0FBTSxVQUVOLEVBR0EsT0FBTyxrQkFBa0IsZ0JBQ3ZCLFFBQ0UsU0FBUyxDQUNULGlCQUFNLENBQUMsUUFDUCx1QkFBcUIsQ0FBQyxRQUd4QixVQUFNLFVBQ0osTUFBTSxJQUFLLEtBRVgsV0FBVSxTQUFTLGVBQWUsb0JBRWxDLGNBQUssYUFBZSxLQUFLLGFBQWEsS0FDdEMsV0FBSyxhQUFlLEtBQUssYUFBYSxLQUN0QyxXQUFLLE9BQVMsS0FBSyxPQUFPLEtBQzFCLFdBQUssU0FBVyxLQUFLLFNBQVMsS0FFOUIsU0FBRyxpQkFBaUIsZUFBZ0IsS0FDcEMsaUJBQUcsaUJBQWlCLGlCQUFrQixLQUN0QyxpQkFBRyxpQkFBaUIsaUJBQWtCLEtBQ3RDLGFBQUcsaUJBQWlCLGtCQUFtQixLQUd2QyxXQUFHLGlCQUFpQixhQUFjLElBQ2hDLENBQUksQ0FBQyxHQUFHLFdBQVcsT0FDbkIsZUFBSSxHQUFHLFdBQVcsT0FBTyxjQUFjLFFBQ3JDLDJCQUVILG9CQUVELEdBQUksT0FBTyxNQUFNLGdCQUFnQixVQUFZLENBQzNDLDZCQUFPLGlCQUFpQixVQUFXLEtBQ2pDLENBQTBCLEVBQXRCLE9BQUksY0FDUixXQUEwQixFQUF0QixPQUFJLGNBQ1IsZUFBMEIsRUFBdEIsT0FBSSxjQUNSLFNBQTBCLEVBQXRCLE9BQUksY0FDVCxjQUNELEdBRUgsdUJBRUQsZUFBYyxVQUNSLE9BQUMsTUFBSyxLQUVWLFFBQ0UsK0JBQUssWUFHUCxRQUNFLENBREUsY0FDRSxRQUFRLGFBQWUsR0FBRyxRQUFRLEtBQU8sS0FBSyxLQUNoRCxvQkFDRSxDQURFLGNBQWUsT0FHakIsa0JBQUssWUFBWSxhQUduQixRQUFLLFlBQVksYUFHbkIsUUFFSCxvQkFFRCxhQUFZLFVBQ1YsTUFBSyxZQUFZLFNBQ2pCLFFBQUssR0FBRyxRQUFRLEtBQUssaUJBQ3RCLFFBRUQsZUFBYyxVQUNSLE9BQUMsTUFBSyxLQUVWLFFBQ0UsK0JBQUssWUFHUCxRQUFJLGFBQWUsU0FDakIsRUFBSSxRQUFRLGFBQWUsR0FBRyxRQUFRLEtBQU8sS0FBSyxLQUNoRCxvQkFBSSxhQUFlLEVBQUksU0FDckIsT0FFQSxrQkFBSyxZQUFZLGFBR25CLFFBQUssWUFBWSxhQUduQixRQUVILG9CQUVELGFBQVksVUFDVixNQUFLLFlBQ0wsUUFBSyxHQUFHLFFBQVEsS0FBSyxpQkFDdEIsUUFFRCxTQUFRLFVBQ0YsQ0FBQyxLQUFLLEtBQ1YsU0FDQSwyQkFBSyxHQUFHLFFBQVEsS0FBSyxzQkFBdUIsUUFBUSxjQUFjLFFBQ25FLE1BRUQsV0FBVSxVQUNSLENBQUksQ0FBQyxLQUFLLEtBQ1YsU0FBSSxLQUFLLEtBQ1AsMEJBQUssR0FBRyxRQUFRLEtBQUssd0JBRXhCLFFBRUQsY0FBYSxTQUFVLEVBQ3JCLENBQ0UsOEJBQVEsY0FBYyxjQUFjLDJCQUNkLEtBQUssYUFFN0Isc0JBQ0EsVUFBUSxHQUFHLGNBQWMsMkJBQ2QsS0FBSyxhQUNqQixRQUVELHFCQUFvQixVQUNsQixDQUNBLGdDQUFRLGNBQWMsY0FBYywyQkFDZCxLQUFLLGFBQzNCLFNBQ0Qsb0JBM0h1QyxrRENUMUMsR0FBSSxXQUFZLG9CQUFRLElBRXhCLFVBR0EsT0FBTyxrQkFBa0IseUJBQ3ZCLE1BQU0sVUFDSixNQUFLLEdBQUcsUUFBUSxpQkFBaUIsc0JBQXVCLElBQ3RELE1BQUssR0FBRyxTQUNSLHNCQUFXLElBQ1QsTUFBSyxHQUFHLFdBQVcsT0FDbkIsY0FBSyxHQUFHLFNBQ1QsVUFIRCxFQUlELElBQ0YsRUFFRCxRQUFPLFVBQVUsU0FBVSxJQUN6QixNQUFLLEdBQUcsUUFBUSxLQUNkLHVCQUNBLElBQUksT0FBTyxRQUFRLHFCQUFxQixRQUUzQyxjQUxNLGtSQ2hCVCxzQ0FFQSxPQUFPLGtCQUFrQixnQ0FDdkIsUUFDRSxxQkFBcUIsQ0FBQyxLQUd4QixrQkFBUSxVQUNOLE1BQU0sSUFBSyxLQUNQLEdBQUMsS0FBSyxLQUNWLHdCQUFHLGFBQ0QsV0FBWSxNQUNaLCtDQUFNLGFBQWEsS0FBSyxLQUFLLG9CQUNoQyxhQVh1RCxnQkNGMUQsT0FBTyxrQkFBa0IsdUJBQ3ZCLFFBQ0UsYUFBYSxDQUNiLG9DQUF5QixDQUFDLEtBRzVCLGdCQUFNLFVBQ0osTUFDRCxTQUVELFNBQVEsU0FBVSxRQUNoQixNQUFNLE1BQU8sS0FFYixXQUFJLE1BRUYsUUFBSSxTQUFtQyx5QkFBQyxLQUNwQyx5QkFBQyxLQUFvQixrQkFFekIsaUJBQUksU0FBdUIsYUFBQyxLQUFvQixhQUFDLEtBQy9DLDhCQUtKLG1CQUFJLENBQUMsS0FFSCxTQUFJLENBQUMsUUFBUSx5QkFBMkIsS0FBZ0MsOEJBRXhFLFdBQUksQ0FBQyxRQUFRLGFBQWUsS0FBb0Isa0JBRW5ELFlBRUQsWUFBVyxVQUNMLENBQUMsS0FDTCxjQUFLLEdBQUcsV0FBVyxxQkFDbkIsc0JBQ0QsVUFFRCxXQUFVLFVBQ1IsQ0FBSSxLQUNKLGNBQUssR0FBRyxXQUFXLG9CQUNuQixzQkFDRCxVQTFDOEMsZ0JDQWpELEtBQU0sV0FBWSxHQUFJLE9BQU0sVUFFNUIsT0FBTyxlQUFlLHdCQUNwQixNQUFNLFVBQ0osTUFBSyxVQUNMLFVBQU0sU0FBVSxTQUFTLGVBQ3pCLHlCQUFRLGlCQUFpQixTQUFVLEtBQ2pDLE1BQUssVUFBWSxVQUFVLE1BQU0sSUFBSSxPQUN0QyxLQUNGLEVBUDRDLGdCQ0YvQyxLQUFNLG9CQUNKLEdBQ0EsSUFDQSxNQUNBLElBQ0EsT0FDQSxNQUNBLE9BQ0EsSUFDQSxRQUNBLE9BQ0EsU0FDQSxPQUNBLFNBQ0EsUUFHRixPQVFBLE9BQU8sa0JBQWtCLGtCQUN2QixjQUFjLENBQUMsV0FFZixtQkFDRSxPQUFPLENBQUMsUUFDUixjQUFZLENBQUMsUUFHZixTQUFNLFVBQ0osTUFBSyxhQUFlLENBQU8sWUFDM0IsZ0JBQUssU0FBVyxLQUFLLEdBQUcsWUFBWSxRQUFRLFNBQVMsU0FHckQsY0FBSyxHQUFHLGFBQWEsWUFDbkIsVUFDQSwyREFDQSxJQUVILGFBRUQsU0FBUSxVQUNOLE1BQ0QsWUFFRCxhQUFZLFVBQ1YsTUFBTSxNQUFPLEtBQ2IsS0FBTSxHQUFLLEtBQ1gsR0FBTSxTQUFXLEtBRWpCLFlBQ0UsQ0FERSxRQUFLLFdBS1QscUJBSlcsTUFDVCxRQUdJLGNBQWUsS0FDckIsMEJBQWEsS0FBTyxTQUNwQixtQkFBYSxHQUFLLG1CQUFtQixLQUNyQyxVQUFHLGFBQWEsWUFDaEIsaUJBQUcsV0FBVyxVQUNmLGdCQXZDeUMscUJDekI1QyxDQTZoQkEsUUFBUyxnQkFDUCxjQUNBLFNBQ0EsY0FDQSxTQUNBLFNBQ0EsTUFFQSxNQUFNLE9BQVEsU0FBUyxXQUFXLFNBQ2xDLE1BQU0sTUFBUSxjQUdkLHdCQUFJLFNBQVMsR0FBRyxJQUNkLGNBQWMsTUFBUSxHQUN0QixjQUFjLE1BQVEsR0FDdEIsY0FBYyxNQUVoQixRQUFJLFNBQVMsR0FBRyxJQUNkLGNBQWMsTUFBUSxHQUN0QixjQUFjLE1BQVEsR0FDdEIsY0FBYyxNQUVoQixRQUFJLFNBQVMsR0FBRyxJQUNkLGNBQWMsTUFBUSxHQUN0QixjQUFjLE1BQVEsR0FDdEIsY0FBYyxNQUVoQixJQUNFLElBREUsY0FDRSxNQUFNLE1BQU0sRUFBRyxNQUFNLEVBQUcsTUFFOUIsR0FDRSxlQUFJLFFBQVEsU0FDWixPQUFJLFFBQVEsU0FDWixPQUFJLFFBQVEsU0FFZCxRQUFJLFNBQVMsR0FBRyxJQUNoQixjQUFJLFNBQVMsR0FBRyxJQUNoQixjQUFJLFNBQVMsR0FBRyxJQUNoQixnQkFBTSxNQUFRLEdBQUssSUFBSSxTQUFTLEdBQ2hDLFFBQU0sTUFBUSxHQUFLLElBQUksU0FBUyxHQUNoQyxRQUFNLE1BQVEsR0FBSyxJQUFJLFNBQVMsR0FDaEMsUUFBTSxNQUFRLEdBQUssSUFBSSxTQUFTLEdBQ2hDLFFBQU0sTUFBUSxHQUFLLElBQUksU0FBUyxHQUNoQyxRQUFNLE1BQVEsR0FBSyxJQUFJLFNBQVMsR0FDaEMsUUFBTSxNQUFRLEdBQUssSUFBSSxTQUFTLEdBQ2hDLFFBQU0sTUFBUSxHQUFLLElBQUksU0FBUyxHQUNoQyxRQUFNLE1BQVEsR0FBSyxJQUFJLFNBQVMsR0FHaEMsTUFBSSxTQUFTLEdBQUcsSUFDZCxjQUFjLE1BQVEsR0FDdEIsY0FBYyxNQUFRLEdBQ3RCLGNBQWMsTUFFaEIsUUFBSSxTQUFTLEdBQUcsSUFDZCxjQUFjLE1BQVEsR0FDdEIsY0FBYyxNQUFRLEdBQ3RCLGNBQWMsTUFFaEIsUUFBSSxTQUFTLEdBQUcsSUFDZCxjQUFjLE1BQVEsR0FDdEIsY0FBYyxNQUFRLElBQ3RCLGNBQWMsTUFFaEIsS0FDRSxJQURFLGNBQ0UsTUFBTSxNQUFNLEVBQUcsTUFBTSxFQUFHLE1BRTlCLEdBQ0UsZUFBSSxRQUFRLFNBQ1osT0FBSSxRQUFRLFNBQ1osT0FBSSxRQUFRLFNBRWQsUUFBSSxTQUFTLEdBQUcsSUFDaEIsY0FBSSxTQUFTLEdBQUcsSUFDaEIsY0FBSSxTQUFTLEdBQUcsSUFDaEIsZ0JBQU0sTUFBUSxHQUFLLElBQUksU0FBUyxHQUNoQyxRQUFNLE1BQVEsSUFBTSxJQUFJLFNBQVMsR0FDakMsUUFBTSxNQUFRLElBQU0sSUFBSSxTQUFTLEdBRWpDLFdBQVMsV0FBVyxTQUNyQixlQUdELFFBQVMsV0FBVyxLQUFNLElBQ3hCLE1BQUssT0FDTCxNQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksSUFBSSxPQUN0QixTQUFLLEdBQUssSUFFYixFLGlCQW5oQjBCLEtBQUssZUFnSnNCLEtBQUssUUFsUHJELHFCQUVOLEdBQU0sVUFDSixRQUFRLE1BQ1Isd0JBQVUsTUFDViw4QkFBYyxNQUNkLDhCQUFVLE1BR1osa0JBQU0sUUFDSixNQUFNLE1BQ04sMEJBQVMsTUFDVCwwQkFBTyxNQUNQLDJCQUFVLE1BR1osc0JBQU0sZUFBaUIsR0FBSSxPQUFNLFFBQVEsQ0FBQyxNQUFPLENBQUMsTUFBTyxDQUV6RCxPQUdBLE9BQU8sa0JBQWtCLGlCQUN2QixRQUNFLFVBQ0UsU0FDQSxpQkFBTyxDQUFDLFNBQVUsV0FBWSxXQUVoQyx1QkFBTyxDQUFDLFFBQVMsT0FBUSxLQUN6QixlQUFPLENBQUMsUUFDUixjQUFPLENBQUMsUUFBUyxFQUFHLEtBQ3BCLFdBQUssQ0FBVSxZQUFNLEtBQ3JCLFdBQUssQ0FBQyxLQUNOLHdCQUFhLENBQ2IsaUJBQU0sQ0FBQyxRQUNQLFlBQUksQ0FBQyxRQUNMLGlCQUFVLENBQUMsUUFBUyxFQUFHLEtBQ3ZCLGlCQUFXLENBQUMsS0FDWixlQUFRLENBQVUsVUFBSyxLQUN2QixlQUFPLENBQVUsVUFBSyxLQUN0QixzQkFBYyxDQUFDLEtBQ2YsbUJBQVksQ0FBQyxLQUNiLHFCQUFjLENBQ2QsbUJBQ0UsU0FDQSxhQUFPLENBQUMsT0FBUSxVQUFXLFFBRTdCLGlCQUFLLENBQUMsS0FHUixhQUVBLGlCQUFNLFVBQ0osTUFBSyxNQUNMLE9BQUssVUFDTCxVQUFLLFVBQ0wsVUFBSyxVQUNMLE9BQUssU0FDTCxVQUFLLFdBQ0wsT0FBSyxVQUNMLE9BQUssYUFDTCxPQUFLLHdCQUNMLFFBQUssY0FDTCxPQUFLLGdCQUNMLFFBQ0Esa0JBQUssY0FDTCxRQUFLLGNBQ0wsUUFDQSx3QkFBSyxRQUNMLFVBQ0Esb0JBQ0EsZUFBSyxVQUFZLEdBQUksT0FDckIsYUFBSyxVQUFZLEdBQUksT0FDdEIsY0FFRCxTQUFRLFNBQVUsUUFDaEIsTUFBTSxNQUFPLEtBRWIsS0FBSSxHQUFDLEtBSUwsS0FBSSxRQUFRLEtBQU8sS0FDakIsS0FBSSxRQUNGLFNBQUssR0FBRyxvQkFBb0IsUUFBUSxHQUFJLEtBRTFDLE9BQ0UsTUFERSxRQUFLLFNBQ0YsR0FBRyxpQkFBaUIsS0FBSyxHQUFJLEtBQUssTUFBTSxLQUlqRCxhQUFLLFVBRUwsZ0JBQUssa0JBQWtCLEtBQUssSUFBSyxLQUVqQyxZQUFLLFVBQVksS0FBSyxVQUN0QixZQUFLLGFBQWdDLENBQWpCLE1BQUssVUFBZ0IsS0FBSyxVQUFVLEdBQUcsT0FFM0QsT0FDTyxjQUFMLEdBREUsUUFBSyxNQUFNLEtBQUssTUFBTSxPQUFTLGVBRTlCLFNBQVMsS0FBSyxPQUFTLEtBR3JCLGtCQUFnQixTQUFTLEtBRWhDLFlBQUssY0FBZ0IsS0FBSyxJQUN4QixLQUFLLGFBQ0wsS0FBSyxJQUFJLEVBQUcsS0FHZCxxQkFBSyxXQUFhLEtBQUssSUFBTSxLQUU3QixlQUFpQixVQUFJLE1BQU0sS0FFM0IsbUJBQU0sZ0JBQ0osT0FBTyxHQUFJLE9BQU0sTUFBTSxLQUN2QixZQUFNLE1BQ04sb0JBQVUsVUFBVSxLQUNwQixjQUFLLEtBQUssSUFBTSxHQUFJLE9BQU0sZ0JBQWdCLEtBQUssS0FBSyxJQUFJLEtBQ3hELEtBQ0Esc0JBQVMsS0FDVCxvQkFBYSxDQUFDLENBQUMsS0FBSyxLQUF5QixRQUFsQixRQUFLLFVBRWxDLENBRjJELE1BQUssY0FLekQsU0FISCxpQkFBUSxLQUNMLFFBRVcsR0FBWSxjQUc5QixnQkFMa0IsR0FBSSxTQUFRLEtBQUssUUFFakMscUJBR0csZ0JBQWdCLEtBRXJCLFVBQ0UsTUFERSxRQUFLLFNBR1YsUUFFRCxvQkFBbUIsU0FBVSxLQUFNLE1BQ2pDLElBRUEsWUFBSyxjQUFjLE9BQ25CLE9BQUssY0FBYyxPQUVuQixPQUFNLFVBQVcsS0FBSyxNQUFNLEtBQzVCLE1BQU0sT0FBUyxTQUNmLE9BQU0sVUFBWSxTQUVsQixlQUFLLFlBQWMsU0FDbkIsY0FBSyxPQUE2Qix1QkFBWSxTQUU5QyxTQVVBLGdCQVZJLGNBQ0csaUJBQ0gsR0FBRyxTQUFTLGdCQUFnQixHQUM1QixZQUFHLFNBQVMsZ0JBQWdCLEdBQzVCLFlBQUcsU0FBUyxnQkFBZ0IsR0FHOUIsZ0JBR2UsVUFBSSxNQUFNLE9BQzNCLFlBQUssR0FBSSxZQUFhLEVBQUcsV0FBYSxPQUFPLE9BQVEsYUFDbkQsTUFBSyxVQUF3QixZQUFJLE1BQU0sT0FBTyxZQUM5QyxZQUNFLEdBQUksZUFBZ0IsRUFJaEIsS0FISixjQUFnQixPQUFPLFlBQVksT0FDbkMsZ0JBRUEsTUFBVyxPQUFPLFlBQ2xCLHFCQUVBLENBRlEsV0FFSixHQUFLLEtBQUssVUFBVSxZQUFZLGVBQ2xDLFVBQVUsTUFFTixHQUFJLEtBQUssR0FBSyxVQUNkLFFBQUksS0FBSyxHQUFLLFVBQ2QsUUFBSSxLQUFLLEdBQUssVUFBYSxPQUcvQixXQUdGLE9BQUksS0FDRixnQkFBRSxTQUFXLE1BRVQsR0FBRyxLQUFLLEdBQ1IsWUFBRyxLQUFLLEdBQ1IsWUFBRyxLQUFLLEdBQUssV0FLbkIsTUFBSSxLQUNGLFdBQUUsSUFBTSxNQUFRLEtBQUssR0FBSyxVQUc1QixHQUFJLE9BQ0YsQ0FEVyxxQkFDTixjQUFjLGVBQWlCLEVBQUUsU0FDbEMsQ0FBQyxFQUFHLEVBQUUsU0FBUyxFQUFHLEVBQUcsRUFBRSxTQUFTLEVBQUcsRUFBRyxFQUFFLFNBQVMsR0FFckQsVUFBSyxjQUFjLGVBQWlCLEVBQUUsU0FDbEMsQ0FBQyxFQUFHLEVBQUUsU0FBUyxFQUFHLEVBQUcsRUFBRSxTQUFTLEVBQUcsRUFBRyxFQUFFLFNBQVMsR0FHeEQsS0FDRixDQUNGLENBRUQsa0JBQWtCLFVBQ2hCLE1BQU0sZ0JBRU4sU0FBTyxVQUFVLG1CQUNmLE1BQU0sTUFBTyxLQUNiLFFBQUksTUFBTyxTQUFTLEtBQUssS0FFekIsV0FBSyxnQkFBZ0IsT0FFckIsRUFBSSxNQUNGLGFBQTBCLE1BQW5CLFFBQUssS0FBSyxLQUFrQixPQUFPLFVBRzVDLE9BQUssR0FBSSxHQUFJLEVBQ1AsZUFEVSxFQUFJLG1CQUFvQixJQUN0QyxnQkFDRSxDQUNBLFVBQXVCLHNCQUFJLE1BQU0sS0FDakMseUJBQ0EsWUFDQSxVQUNBLFVBSUYsUUFBTSxPQUFRLEtBQUssSUFBTSxLQUFLLElBQUksTUFBUSxLQUFLLElBQUksT0FDbkQsaUJBQWUsT0FDZixNQUFLLEdBQUksR0FBSSxFQUNQLFNBRFUsRUFBSSxLQUFLLGFBQ3ZCLGFBQWUsR0FBSSxPQUFNLG9CQUN2QixJQUFNLE1BQVEsS0FBSyxPQUNuQixJQUFNLEtBRVIsUUFBSSxVQUNGLDBCQUlTLFFBQVMsS0FBSyxLQUFLLFVBQVUsV0FDdEMsY0FBUyxRQUFTLEtBQUssS0FBSyxVQUFtQixXQUMvQyxjQUFTLFFBQVMsS0FBSyxLQUFLLFVBQW1CLFdBRWpELGdCQVJXLFFBQVEsS0FBSyxnQkFDdEIsWUFBUyxRQUFRLEtBQUssZ0JBQ3RCLFlBQVMsUUFBUSxLQUFLLGdCQUV0QixtQkFJYSxLQUlqQixhQUFJLHNCQUF1QixNQUFNLG9CQUFvQixzQkFJckQsK0JBQWUsS0FBTyxHQUFJLE9BQU0sS0FDOUIscUJBQ0EsS0FFRix5QkFBZSxLQUNmLGdCQUFLLEdBQWdCLDZCQUFrQixDQUF2QyxHQUEwQyxlQUMxQyxnQkFDRSxLQUFLLHdCQUNMLHFCQUFxQixXQUFXLFNBSWxDLFdBQ0UsR0FBSSxHQUFJLEVBQ1IsRUFBSSxxQkFBcUIsV0FBVyxTQUFTLE1BQU0sT0FHbkQseUJBQXFCLFdBQVcsU0FBUyxNQUFNLEdBQUssQ0FHdEQsVUFBSyxHQUFJLEdBQUksRUFBRyxFQUFJLGVBQWUsc0JBQXNCLE9BQ3ZELG1CQUFlLHNCQUFzQixHQUd2QyxPQUFLLGdCQUFnQixLQUN0QixlQUNGLENBQ0YsQ0FFRCxVQUFPLFNBQVUsSUFDZixDQUNFLENBREUsTUFBSyxLQUFLLGlCQUNELElBQU0sS0FBSyxnQkFBZ0IsS0FBTSxLQUFLLEtBRWpELFlBQUssZ0JBRVIsSUFFRCxrQkFBaUIsU0FBVSxJQUV6QixJQUFJLE9BQVEsQ0FDWixFQUNJLFdBQ0osRUFBSSxTQUFXLElBQU0sSUFBSSxPQUFPLFNBQ2hDLEtBQUksU0FBVyxJQUFNLElBQUksT0FBTyxTQUU1QixLQUpKLGVBSU0sbUJBQW9CLE9BQ3hCLG1CQUFXLEdBQUksT0FFYixTQUFFLG1CQUFvQixPQUN4QixpQkFBVyxHQUFJLE9BSWpCLFdBQUssR0FBSSxHQUFJLEVBQUcsRUFBSSxLQUFLLGdCQUFnQixPQUFRLElBQy9DLElBQUksVUFBSyxnQkFBZ0IsR0FBYyxPQUNyQyxPQUNBLEVBQ0QsS0FDRCxDQUFJLEtBQUssZ0JBQWdCLEdBQUcsS0FDMUIsbUJBQ0EsYUFBYSxLQUFLLGdCQUFnQixHQUVyQyxLQUVELElBQWMsQ0FFZCxDQUZJLCtCQUVhLEtBQUssZ0JBQ3RCLHNCQUNBLHlCQUFlLFVBQ2YsaUJBQWUsS0FDZiwwQkFBZSxLQUFLLFNBQVMsS0FDN0IseUJBQWUsS0FBSyxTQUFTLEtBQzdCLHlCQUFlLEtBQ2YsT0FBSyxlQUNMLGdCQUNELGNBRUQsU0FBUSxTQUFVLGVBQ2hCLGdCQUNBLDJCQUFlLE1BQVEsQ0FDdkIsaUJBQWUsS0FDZixPQUFLLGVBQ04sZUFFRCxnQkFBZSxTQUFVLGVBQWdCLGNBQ3ZDLE1BQU0sVUFBVyxlQUFlLEtBRWhDLFNBQUksS0FBSyxjQUNQLDhCQUNFLGNBQ0EsU0FDQSxLQUFLLHdCQUNMLEtBQUssY0FBYyxlQUNuQixLQUFLLGFBQWUsS0FBSyxjQUFjLGVBS3pDLHFCQUNFLGNBQ0EsU0FDQSxLQUFLLHdCQUVMLHNCQVFMLEtBT0QsaUJBQWdCLFNBQVUsZUFDeEIsSUFDQSxHQUdBLFFBQUksS0FBSyxnQkFBa0IsS0FBSyxhQUM5QixLQUFLLEVBQUksRUFBRyxFQUFJLEtBQUssYUFDbkIsU0FBSyxjQUFjLGVBRXJCLEdBQ0QsTUFHRCxNQUFNLFVBQVcsZUFBZSxLQUNoQyxhQUFLLEVBQUksRUFBRyxFQUFJLEtBQUssYUFDbkIsSUFBSSxFQUFJLEtBQ04sOEJBQ0UsZUFBZSxzQkFBc0IsR0FDckMsU0FDQSxLQUFLLHdCQUVMLHNCQUlKLFdBQUssVUFBVSxHQUlqQixNQUFLLEVBQUksRUFBRyxFQUFJLEtBQUssY0FDbkIsU0FBTyxFQUFTLFlBQU0sS0FBSyxVQUFZLEtBQUssYUFDNUMsbUJBQWUsc0JBQXNCLEdBQUssS0FBSyxVQUMvQyxXQUFLLFVBQVUsTUFBUSxLQUFLLFVBQzVCLFFBQUssY0FDSCxlQUNBLGVBQWUsc0JBR3BCLEdBRUQsT0FBTyxVQUNMLE1BQU0sb0JBQXFCLEdBQUksT0FFL0IsY0FBTyxVQUFVLEtBQU0sTUFDckIsSUFHSSxhQUFjLEtBQ2xCLFlBSEEsTUFDQSxNQUNBLFVBRUEsVUFDQSxRQUNBLGlCQUFNLGFBQWMsS0FBSyxLQUFLLGNBQWdCLENBQUMsS0FDL0MsT0FBTSxjQUFnQixLQUFLLEtBQUssY0FBZ0IsS0FFaEQsV0FDRSxHQUFJLHFCQUFzQixFQUl0QixlQUhKLG9CQUFzQixLQUFLLGdCQUFnQixPQUczQyx3Q0FBcUIsS0FBSyxnQkFDMUIsc0JBQUksQ0FBQyxlQU1MLG9CQUNFLEtBQUssS0FBSyxhQUFlLEtBQUssS0FBSyxJQUFNLEtBQUssVUFDaEQsY0FBVSxlQUFlLEtBQU8sS0FBSyxLQUNyQyxVQUFRLFFBQVUsS0FDbEIsZ0JBQVEsS0FBSyxVQUFlLFlBQzVCLFFBQ0Usd0JBQVksTUFBYSxZQUN6QixpQkFDRSxNQUFRLEtBQUssVUFBWSxFQUNyQixLQUFLLFVBQWUsWUFBTSxPQUFTLEdBSTNDLE1BQ0Usa0JBQUssVUFBVSxZQUFZLEtBQUssS0FBSyxhQUFjLEtBQUssS0FBSyxXQUcvRCxhQUNFLEdBQUkscUJBQXNCLEVBQzFCLG9CQUFzQixlQUFlLHNCQUFzQixPQUMzRCxzQkFFQSxJQUFJLGVBQ0YsZUFBZSxzQkFDakIscUJBQUksU0FBVyxhQUFlLE1BQU0sZUFFcEMsWUFDRSxvQkFBSyxVQUFVLFlBQVksS0FBSyxLQUFLLGFBQWMsS0FBSyxLQUFLLFdBQVksTUFBTSxlQUlqRixLQUFJLENBQUMsTUFBTSxlQUFlLE1BRXhCLGdCQUNFLGNBQ0EsZUFBZSxLQUFLLFNBQ3BCLEtBQUssd0JBRUwsc0JBR0YsTUFDRCxRQUVELENBQUksYUFBZSxXQUFhLFVBQVUsZUFDeEMsMEJBQW1CLFlBQ2pCLE1BQU0sZUFBZSxTQUNyQixVQUFVLGVBQWUsU0FHM0IsMEJBQ0UsY0FDQSxlQUFlLEtBQUssU0FDcEIsS0FBSyx3QkFDTCxtQkFDQSxTQUNBLEtBR0YsMkJBQ0UsY0FDQSxlQUFlLEtBQUssU0FDcEIsS0FBSyx3QkFDTCxNQUFNLGVBQWUsU0FDckIsU0FDQSxLQUdMLFVBRUQsbUJBQWUsTUFDZixNQUFJLGVBQWUsTUFBUSxLQUFLLEtBQUssSUFDbkMsQ0FBSSxlQUFlLFVBQVksZUFDN0IsZ0JBQUssR0FBRyxLQUFLLHFCQUNiLGNBQUssT0FFTCx1QkFBSyxHQUFHLEtBQUsseUJBQ2Isd0JBQ0EseUJBQWUsS0FFakIsWUFDRCxRQUVKLEVBQ0YsQ0FFRCxvQkFHRixpQkFDQSxLQUFNLEtBQU8sVUFDWCxNQUFNLEtBQU0sR0FBSSxPQUNoQixvQkFBSSxTQUFTLEtBQUssR0FBSSxPQUN0QixhQUFJLFNBQVMsS0FBSyxHQUFJLE9BQ3RCLGFBQUksU0FBUyxLQUFLLEdBQUksT0FDdEIsYUFBSSxNQUFNLEtBQUssR0FBSSxPQUFNLE1BQU0sRUFBRyxFQUNsQyxJQUNELEdBRUQsSUFxRkEsT0FBTyxRQUFRLGVBQWlCLDJCQzltQmhDLE9BQU8sa0JBQWtCLFFBQ3ZCLFFBQ0UsVUFBVSxDQUdaLG9CQUFRLFVBQ04sQ0FBSSxLQUFLLEtBQUssVUFBWSxLQUFLLEdBQzdCLGVBQUssR0FDQSxRQUFJLENBQUMsS0FBSyxLQUFLLFVBQVksQ0FBQyxLQUFLLEdBQUcsV0FBYSxLQUFLLEdBQUcsUUFDOUQsZ0JBQUssR0FFUixNQVgrQixlQ0FsQyxDQUdBLE9BQU8sa0JBQWtCLFNBQ3ZCLFFBQ0UsU0FBUyxDQUdYLGtCQUFNLFVBQ0osTUFBSyxVQUFZLEtBQUssVUFBVSxLQUVoQyxXQUFLLEdBQUcsUUFBUSxpQkFBaUIsc0JBQXVCLEtBQ3RELENBQ0UsZUFERSxPQUFJLE9BQU8sVUFDUixHQUFHLGlCQUFpQixXQUFZLEtBRXJDLGdCQUFLLEdBQUcsaUJBQWlCLGlCQUFrQixLQUU5QyxVQUVELFlBQVMsaUJBQWlCLG1CQUFvQixJQUM1QyxDQUE2QyxRQUF6QyxZQUFTLHNCQUNkLFdBQ0YsRUFFRCxZQUFXLFVBQ0wsQ0FBQyxLQUFLLEtBQ1YsY0FBSyxHQUFHLFFBQVEsS0FBSyxZQUN0QixRQXhCZ0Msa0RDSG5DLEdBQUksV0FBWSxvQkFBUSxLQUV4QixPQUFPLGVBQWUsYUFDcEIsTUFBTSxVQUNKLE1BQUssZ0JBQ0wsUUFBSyxvQkFDTCxPQUFLLE1BQ04sRUFFRCxhQUFZLFNBQVUsTUFBTyxPQUMzQixDQUFJLEtBQUssTUFDVCxjQUFLLE1BQU0sT0FBUyxHQUFJLFdBQVUsTUFDbkMsUUFFRCxZQUFXLFNBQVUsTUFBTyxPQUN0QixDQUFDLEtBQUssTUFDUixhQUFLLFdBQVcsTUFFbEIsYUFBSyxNQUFNLE9BRVgsWUFBSyxnQkFDTCxXQUFLLGNBQWdCLEtBQUssR0FDM0IsSUFHSCxJQUdBLE9BQU8sa0JBQWtCLGFBQ3ZCLFFBQ0UsU0FBUyxDQUNULGtCQUFPLENBQUMsS0FDUixnQkFBTyxDQUFDLEtBQ1IsaUJBQVEsQ0FBQyxLQUFNLFNBQVUsUUFHM0IsSUFFQSxpQkFBTSxVQUNKLE1BQUssR0FBRyxpQkFBaUIsS0FBSyxLQUFLLE1BQU8sSUFDcEMsQ0FBQyxLQUFLLEtBQ1YsY0FBSyxPQUFPLFVBQVUsS0FBSyxJQUFLLEtBQUssS0FDdEMsT0FDRixFQUVELFNBQVEsVUFDTixNQUFLLElBQU0sS0FBSyxLQUNoQixNQUFJLEtBQUssS0FBSyxNQUFNLFdBQ2xCLFlBQUssSUFBTSxTQUFTLGNBQWMsS0FBSyxLQUFLLE9BQU8sYUFFdEQsT0F0Qm9DLGVDNUJ2QyxDQUlBLE9BQU8sa0JBQWtCLG1CQUN2QixRQUNFLFlBQVksQ0FBQyxRQUNiLFVBQU8sQ0FBQyxLQUNSLGlCQUFRLENBQUMsS0FDVCxtQkFBVSxDQUFDLEtBQU0sT0FBUSxRQUFTLENBQUMsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUMvQyxhQUFVLENBQUMsS0FBTSxPQUFRLFFBQVMsQ0FBQyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQy9DLGlCQUFjLENBQ2Qsa0JBQU8sQ0FBQyxLQUdWLGdCQUFPLFVBQ0wsSUFBSSxhQUFjLENBQUMsVUFDbkIsT0FBSSxjQUFnQixDQUFDLFVBRXJCLGVBQU8sV0FDTCxJQUFJLE1BQU8sS0FDWCxLQUFJLEdBQUssS0FDVCxHQUNBLFNBRUEsNEJBQWdCLFNBQVMsY0FDekIsMEJBQWMsVUFBVSxJQUV4QixtQkFBSSxLQUNGLHlCQUFjLGFBQWEsMkJBQTRCLEtBRXZELDBCQUFjLGFBQWEsbUJBRzdCLElBQUksS0FFRix1QkFDQSxxQkFBUyxNQUFRLEtBQ2pCLGVBQVMsT0FBUyxLQUNsQixnQkFBUyxNQUFRLEtBR2pCLGlCQUNBLHVCQUFTLE9BQVMsS0FDbEIsZ0JBQVMsTUFBUSxLQUVuQixxQkFBYyxhQUFhLFdBRTNCLHdCQUFjLFNBQ2QseUJBQWMsU0FBUyxTQUFTLEtBQUssS0FDckMsd0JBQWMsU0FBUyxTQUFTLEVBQUksTUFBTSxLQUFLLFNBQVMsS0FBSyxTQUM3RCxpQkFBYyxTQUFTLFNBQVMsRUFBSSxNQUFNLEtBQUssU0FBUyxLQUFLLFNBQzdELGlCQUFjLFNBQVMsU0FBUyxFQUFJLE1BQU0sS0FBSyxTQUFTLEtBQUssU0FFN0QsTUFBRyxZQUNKLGNBQ0YsQ0F6Q0ssaUJDZlIsQ0FHQSxPQUFPLGtCQUFrQixXQUN2QixRQUNFLFNBQVMsQ0FHWCxrQkFBTSxVQUNBLENBQVUsS0FBSyxHQUNuQixhQUFLLFNBQVcsS0FBSyxTQUFTLEtBRTlCLGVBQVMsaUJBQWlCLHNCQUFzQixRQUFRLFdBQ3RELFdBQVUsaUJBQWlCLFdBQVksS0FDdkMsb0JBQVUsaUJBQWlCLGlCQUFrQixLQUM5QyxTQUVELFFBQUssR0FBRyxpQkFBaUIsV0FBWSxLQUN0QyxTQUVELFdBQVcsVUFDVCxJQUFJLE9BQVEsR0FBSSxPQUNoQixNQUFJLE9BQVMsR0FBSSxPQUNqQixRQUFJLGVBQWlCLEdBQUksT0FDekIsUUFBSSxrQkFBb0IsR0FBSSxPQUU1QixjQUFPLFdBQ0wsTUFBTSxJQUFLLEtBRVgsR0FBSSxHQUFDLEtBQUssS0FFVixjQUFNLFFBQVMsR0FBRyxRQUFRLE9BQU8sR0FHakMsZ0JBR0EsaUJBQU0sSUFBSSxFQUFHLENBQUMsRUFBSSxPQUFPLFNBQVMsRUFDbEMsa0JBQWUsc0JBR2YseUJBQWtCLGdCQUFnQixDQUFDLEVBQUksT0FBTyxTQUFTLEVBQUcsRUFBRyxDQUFDLEVBQUksT0FBTyxTQUd6RSxVQUFPLFNBQVMsZ0JBQWdCLFNBQ2hDLDBCQUFPLFVBQVUsR0FBRyxTQUFTLFNBQVUsR0FBRyxTQUFTLFdBQVksR0FBRyxTQUNsRSxVQUFHLFNBQ0gseUJBQUcsS0FBSyxhQUNULFNBQ0YsQ0E3QlMsaUJDcEJaLENBR0EsT0FBTyxrQkFBa0IsaUJBQ3ZCLFFBQ0UsY0FBYyxDQUNkLGlCQUFNLENBQUMsUUFBUyxRQUFTLE1BQU8sQ0FBQyxPQUNqQyxtQkFBVSxDQUNWLDJCQUFnQixDQUNoQixnQ0FBbUIsQ0FBQyxRQUd0QixVQUFNLFVBQ0osSUFBSSxJQUFLLEtBQ1QsR0FBSSxLQUFPLEtBRVgsVUFBSyxZQUFjLEdBQUksT0FDdkIsVUFBSyxlQUNMLFFBQUssYUFBZSxHQUFJLE9BQU0sUUFBUSxFQUFHLEVBQ3pDLFFBQUssYUFBZSxHQUFJLE9BQU0sUUFBUSxFQUFHLEVBQ3pDLFFBQUssY0FBZ0IsR0FBSSxPQUFNLFFBQVEsRUFBRyxFQUMxQyxRQUFLLGlCQUFtQixHQUFJLE9BQzVCLGFBQUssY0FBZ0IsR0FBSSxPQUN6QixhQUFLLFlBQWMsR0FBSSxPQUN2QixhQUFLLHlCQUEyQixHQUFJLE9BQ3BDLGFBQUsscUJBQXVCLEdBQUksT0FDaEMsYUFBSyxjQUFnQixHQUFJLE9BQ3pCLGFBQ0EsaUJBQUssWUFDTCxPQUFLLGdCQUNMLFFBQUssYUFDTCxRQUFLLG9CQUFzQixHQUFJLE9BQy9CLGFBQUssc0JBQXdCLEdBQUksT0FDakMsYUFBSyxnQkFDSCxDQUNBLFFBQ0EsUUFDQSxTQUVGLFlBQUssb0JBQ0wsT0FBSyxpQkFFTCxLQUFHLGlCQUFpQixzQkFBdUIsS0FBSyxVQUFVLEtBRTFELFlBQU0sTUFBTyxDQUFDLEtBQU0sS0FBSyxLQUN6QixhQUFHLGFBQWEsd0JBQ2hCLFNBQUcsYUFBYSxnQkFDaEIsU0FBRyxhQUFhLDBCQUVoQixXQUFLLFFBQVUsS0FBSyxHQUFHLGNBQ3hCLFNBRUQsU0FBUSxTQUFVLFFBQ2hCLENBQUksQ0FBQyxRQUFRLGNBQWdCLEtBQUssS0FDaEMsbUJBQUssUUFBUSxLQUVoQixZQUVELE9BQU0sU0FBVSxLQUFNLE1BQ2hCLENBQUMsS0FBSyxLQUNWLG9CQUFLLFlBQVksY0FBYyxLQUFLLFFBQVEsWUFDNUMsY0FBSyxhQUNOLE9BRUQsZUFBYyxTQUFVLE1BQ3RCLElBQ0ksaUJBQWtCLEtBQ3RCLGdCQUFJLEtBQU8sS0FJWCxLQUxBLGNBS0ssaUJBQWlCLElBQUksRUFBRyxFQUFHLENBQ2hDLFVBQUssY0FBYyxJQUFJLEVBQUcsRUFFMUIsUUFBTSxVQUFXLEtBQUssR0FDdEIsa0JBQVMsT0FDVCw2QkFBUyxhQUFhLEtBQ3RCLDJCQUFTLGFBQWEsS0FHdEIsb0JBQUssWUFBWSxLQUFLLEtBQUssa0JBQWtCLElBQUksS0FBSyxlQUN0RCxlQUFJLGFBQWMsS0FBSyxxQkFBcUIsS0FBSyxLQUFLLGtCQUFrQixlQUFlLEtBQUssY0FBYyxRQUFRLEtBQ2xILGFBQUksWUFBYyxLQUFLLHFCQUFxQixLQUFLLEtBQUssa0JBQWtCLGVBQWUsS0FBSyxjQUFjLFFBQVEsS0FDbEgsYUFBSSxhQUFlLEtBQUsscUJBQXFCLEtBQUssS0FBSyxrQkFBa0IsZUFBZSxLQUFLLGVBQWUsUUFBUSxLQUdwSCx5QkFBVyxLQUFLLHlCQUF5QixJQUFJLEtBQUssa0JBR2xELFNBQ0UsQ0FERSxRQUFLLGdCQUFnQixjQUNsQixxQkFBdUIsS0FBSyxnQkFDakMsYUFBSyxrQkFBb0IsS0FBSyxhQUVoQyxjQUFLLGdCQUFnQixLQUNyQixlQUFLLHFCQUVMLGNBQUssYUFBYSxLQUNsQixZQUFLLGtCQUdMLE1BQUksS0FBSyxvQkFBc0IsS0FBSyxpQkFBbUIsS0FBSyxLQUFLLGVBRTNELENBQUMsS0FDSCxnQkFBSyxvQkFBb0IsS0FBSyxLQUM5Qix1QkFDQSxpQkFBSyxlQUNMLE9BQUssZUFDTCxPQUFLLGVBQ0wsT0FBSyxnQkFFUCxRQUNBLDZCQUFLLGdCQUNMLFdBQU0sc0JBQXVCLFlBQWMsS0FDM0MsZUFBTSxxQkFBdUIsWUFBYyxLQUMzQyxlQUFNLHNCQUF3QixhQUFlLEtBQzdDLHFCQUFLLGVBQWlCLHFCQUF1QixZQUFjLEtBQzNELG9CQUFLLGVBQWlCLHFCQUF1QixZQUFjLEtBQzNELG9CQUFLLGdCQUFrQixzQkFBd0IsYUFBZSxLQUM5RCxnQkFBNkIsb0JBQXpCLEVBQWtELDJCQUN2RCxXQUNDLFdBR0YsaUJBQUsseUJBQXlCLEtBQUssS0FDcEMsaUJBRUQsWUFBVyxVQUNULElBQUssS0FBSyxRQUFOLElBQWtCLEtBQUssZUFBaUIsS0FBSyxLQUVqRCx5QkFBSyxHQUFHLEtBQ1Isa0JBRUEsaUJBQUssb0JBQ0wsT0FBSyxpQkFDTCxPQUFLLGVBQ0wsT0FBSyxlQUNMLE9BQUssZ0JBQ0wsTUFBSyxHQUFJLEdBQUksRUFBRyxFQUFJLEtBQUssZ0JBQWdCLE9BQWUsU0FBSyxnQkFBZ0IsR0FDN0UsTUFBSyxHQUFJLEdBQUksRUFBRyxFQUFJLEtBQUssYUFBYSxPQUFlLFNBQUssYUFBYSxHQUV2RSxLQUFJLFdBQ0osd0JBQUksS0FBSyxnQkFDUCxNQUVBLFFBR0Ysa0JBQUksS0FBSyxnQkFDUCxHQUVBLE9BRUYsa0JBQVEsSUFDUixnQkFBSyxHQUFHLEtBQ1QsYUFFRCx3QkFBdUIsVUFDckIsTUFBSyxzQkFBc0IsS0FBSyxLQUFLLGtCQUFrQixJQUFJLEtBQzNELHFCQUFxQyxDQUFqQyxRQUFLLHNCQUFzQixHQUMvQixDQUQwQyxRQUFLLHNCQUFzQixTQUNoRSxnQkFBZ0IsTUFDckIsQ0FENkIsTUFBSyxzQkFBc0IsT0FDbkQsZ0JBQWdCLEtBQ3JCLENBRDRCLE1BQUssc0JBQXNCLE9BQ2xELGdCQUFnQixHQUNyQixDQUQwQixNQUFLLHNCQUFzQixPQUNoRCxnQkFBZ0IsS0FDdEIsQ0FENkIsTUFBSyxzQkFBc0IsRUFHekQsWUFBVyxTQUFVLElBQ25CLE1BQUssZUFBaUIsSUFBSSxPQUMxQixVQUFLLEdBQUcsYUFBYSxTQUFVLEtBQUssT0FBTyxLQUFLLGdCQUFnQixRQUNqRSxHQUVELFNBQ0UseUJBQ0UsUUFDRSxZQUFZLENBQ1YsY0FDQSxXQUNBLGNBQ0EsY0FDQSxjQUdGLHdCQUFVLENBQ1IsWUFDQSxTQUNBLFlBQ0EsWUFDQSxZQU1OLCtCQUNFLFFBQ0UsWUFBWSxDQUFDLGVBQWdCLGNBQzdCLHFCQUFVLENBQUMsYUFBYyxZQUk3QixzQ0FDRSxRQUNFLFlBQVksQ0FBQyxlQUFnQixjQUM3QixxQkFBVSxDQUFDLGFBQWMsWUFBYSwwQkMxTXhDLENBUU4sT0FBTyxrQkFBa0Isa0JBQ3ZCLFFBQ0UsU0FBUyxDQUNULGlCQUFNLENBQUMsS0FHVCxnQkFBTSxVQUNKLE1BQUssbUJBQXFCLENBQUMsRUFBRyxJQUFLLEVBQUcsRUFBRyxFQUN6QyxRQUFLLGNBRUwsVUFBSyxVQUFZLFNBQVMsZUFDMUIsdUJBQUssb0JBQXNCLENBQUMsU0FBVSxHQUFJLE9BQU0sUUFBVyxTQUFVLEdBQUksT0FDekUsWUFBSyxjQUFnQixDQUFDLE9BQVEsS0FDOUIsMEJBQUssZUFFTCxVQUFLLFdBQWEsS0FBSyxXQUFXLEtBQ2xDLFdBQUssV0FBYSxLQUFLLFdBQVcsS0FFbkMsS0FFRCxRQUFPLFVBQ0wsTUFBSyxHQUFHLG9CQUFvQixhQUFjLEtBQzFDLGlCQUFLLEdBQUcsb0JBQW9CLGFBQWMsS0FDM0MsV0FFRCxPQUFNLFVBQ0osTUFBSyxHQUFHLGlCQUFpQixhQUFjLEtBQ3ZDLGlCQUFLLEdBQUcsaUJBQWlCLGFBQWMsS0FDdkMsaUJBQUssYUFBZSxLQUFLLFVBQVUsYUFBYSxrQkFDakQsR0FFRCxhQUFZLFNBQVUsSUFDaEIsQ0FBQyxLQUFLLEtBQ1YsU0FBSSxJQUFJLFNBQVcsS0FDZixJQUFDLElBQUksT0FBTyxjQUFjLGFBQzlCLCtCQUFLLGNBQWdCLElBQUksT0FDMUIsY0FFRCxhQUFZLFNBQVUsSUFDcEIsSUFBSSxJQUFJLE9BQU8sU0FBVyxLQUcxQixPQUFJLEtBQUssY0FBYyxXQUFXLE1BQWtDLE9BQTFCLFFBQUssY0FBYyxHQUMzRCxNQUFNLFNBQVUsS0FBSyxLQUNyQixPQS9DTixRQUZNLFdBRkEsVUFtRE0sU0FBVyxLQUFLLGNBQWMsWUFBWSxRQUNoRCxrQkFBUyxTQUFTLFNBQVMsTUFBUSxLQUNwQyxrQkFDRCxNQUFLLGNBQ0wsVUFBSyxlQUNOLEtBRUQsT0FBc0IsVUFDcEIsSUFBSyxLQUFLLEtBQWdCLE9BQXRCLEVBQXVCLEtBRTNCLG9CQUFNLFdBQVksS0FBSyxHQUFHLFdBQzFCLGdCQUFNLGFBQWUsVUFBVSxnQkFBZ0IsS0FFM0MsZUFXSixlQUFJLEtBQUssZ0JBQWtCLEtBQUssZUFFOUIsWUFBSyxlQUFlLEtBQUssU0FBUyxLQUFLLGFBR3ZDLGFBQUssb0JBQW9CLFNBQVMsS0FBSyxhQUN2QyxZQUFLLGVBQWlCLEtBQUssVUFBVSxXQUFXLGVBQWUsZ0JBQzdELEtBRUwsaUJBN0V5QyxlQ1I1QyxDQUdBLE9BQU8sa0JBQWtCLGFBQ3ZCLFFBQ0UsTUFBTSxDQUFFLEtBR1YsZ0JBQU0sVUFDSixNQUFzQixnQ0FBaUIsS0FBSyxLQUFVLElBQ3RELFFBQUssVUFBWSxLQUFLLEdBQUcsUUFDMUIsSUFFRCxPQUFNLFNBQVUsS0FDZCxDQUFJLEtBQU8sS0FBSyxVQUNkLFdBQUssR0FBRyxRQUFRLFdBQVcsS0FBSyxlQUFlLGFBQWEsS0FFL0QsR0Fkb0MsZUNIdkMsQ0FHQSxPQUFPLGtCQUFrQixjQUN2QixRQUNFLGVBQWUsQ0FHakIsa0JBQU0sVUFDSixNQUFLLFFBQVUsS0FBSyxHQUFHLGlCQUV2QixjQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksS0FBSyxRQUFRLE9BQy9CLFNBQUssUUFBUSxHQUFHLGFBQWEsb0JBQzNCLENBQ0EscUJBQ0Esd0RBQ0EsUUFDQSxXQUNBLHNCQUNBLEtBR0wsR0FFRCxTQUFRLFNBQVUsUUFFaEIsSUFBSSxRQUFRLGVBQWlCLENBQUMsS0FBSyxLQUFLLGNBQ3RDLEtBQUssR0FBSSxHQUFJLEVBQUcsRUFBSSxLQUFLLFFBQVEsT0FDL0IsU0FBSyxRQUFRLEdBQWMsNkJBRTdCLHNCQUFLLEdBQUcsUUFBUSxLQUFLLGlCQUN0QixRQUdELElBQUksQ0FBQyxRQUFRLGVBQWlCLEtBQUssS0FBSyxjQUN0QyxLQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksS0FBSyxRQUFRLE9BQy9CLFNBQUssUUFBUSxHQUFHLFdBQVcsS0FBSyxTQUFTLFNBQVMsUUFBUSxNQUU1RCxPQUFLLEdBQUcsUUFBUSxLQUFLLGNBQ3RCLFFBQ0YsQ0FyQ3FDLGlSQ0R4QyxzQ0FBSSxjQUNKLElBQUksT0FDSixHQUFJLGFBQ0osRUFBSSxNQUdBLEdBQ0Esb0JBRUosUUFIb0IsZUFBaUIsT0FDckMsZUFLQSxPQUFPLGtCQUFrQix5QkFDdkIsY0FBYyxDQUFDLFdBRWYsbUJBQ0UsY0FBYyxDQUFDLEtBR2pCLGdCQUFNLFVBRUosTUFBTSxRQUFTLEtBQUssT0FBUyxTQUFTLGNBQ3RDLGlCQUFPLGFBQWEsS0FDcEIsNEJBQU8sT0FDUCxxQkFBTyxNQUNQLFdBQUssSUFBTSxPQUFPLFdBQ2xCLFdBQ0EsdUJBQVMsS0FBSyxZQUdkLGFBQU0sYUFBYyxLQUFLLFlBQWMsU0FBUyxjQUNoRCxzQkFBWSxhQUFhLEtBQ3pCLGlDQUFZLE9BQ1osMEJBQVksTUFDWixXQUFLLFNBQVcsWUFBWSxXQUM1QixlQUFTLEtBQUssWUFFZCxrQkFBSyxHQUFHLFdBQVcsU0FBUyxTQUFTLFNBQVcsR0FBSSxPQUFNLGNBQzFELGtCQUFLLEdBQUcsYUFBYSxXQUFZLE1BQ2pDLGFBQUssT0FFTCxRQUFLLGVBQ04sWUFFRCxTQUFRLFVBQ04sSUFBSSxJQUFLLEtBRVQsUUFBTSxTQUFVLEdBQUcsUUFBUSxRQUFRLE1BQU0sTUFDekMsc0JBQUssR0FBSSxHQUFJLEVBQ1AsSUFEVSxFQUFJLFFBQVEsT0FDMUIsUUFBVSxLQUFLLE9BQU8sR0FBSyxLQUFLLE9BQU8sSUFBTSxTQUFTLGNBQ3RELFdBQUksWUFDSixnQkFBSSxJQUFNLCtDQUFNLGFBQWEsUUFBUSxHQUFHLEdBQ3hDLGFBQUksSUFDRixjQUFLLEtBQUssSUFFVixPQUFJLE9BQVMsSUFDWCxNQUFLLEtBQUssSUFDWCxFQUtMLEVBQUksUUFBUSxTQUFXLEtBQXVCLHFCQUFLLGVBQWUsUUFDbEUsYUFBSyxlQUFpQixRQUN2QixNQUtELE9BQU0sU0FBVSxJQUFLLEVBQ25CLE1BQUssSUFBSSxVQUNQLElBQ0EsRUFDQSxFQUFJLG9CQUNKLE1BRUYsMEJBQUssR0FBRyxZQUFZLFFBQVEsU0FBUyxJQUN0QyxjQUVELGNBQWEsVUFDWCxNQUFNLFFBQVMsS0FDZixZQUFLLElBQUksVUFDVCxZQUFLLElBQUksU0FBUyxFQUFHLEVBQUcsT0FBTyxNQUFPLE9BQ3ZDLE9BRUQsaUJBQWdCLFNBQVUsV0FDeEIsTUFBTSxRQUFTLEtBQ2YsWUFBTSxJQUFNLEtBQ1osYUFBSSxVQUNKLFdBQUksU0FBUyxFQUFHLEVBQUcsT0FBTyxNQUFPLE9BQ2pDLFlBQUksVUFDSixXQUFJLFNBQ0YsRUFDQSxXQUFhLG9CQUNiLE9BQU8sTUFDUCxPQUFPLE9BQVMsV0FDbEIsMEJBQUssR0FBRyxZQUFZLFFBQVEsU0FBUyxTQUNyQyxvQkFBSyxHQUFHLFlBQVksUUFBUSxTQUM3QixjQXRGZ0QsaURDZG5ELElBQUksZUFBZ0Isb0JBQ3BCLElBQUksVUFBWSxvQkFBUSxJQUV4QixVQUFJLE9BQVMsY0FBYyxhQUMzQixvQ0FBSSxRQUFVLE9BQU8sVUFFckIsY0FJQSxPQUFPLGtCQUFrQixTQUN2QixNQUFNLFVBQ0osTUFBSyxZQUFjLENBQUMsTUFBTyxHQUFJLFFBQy9CLFNBQUssWUFDTCxVQUFLLFlBQWMsQ0FBQyxZQUFhLElBQUssTUFHdEMsU0FBSyxPQUdMLFNBQUssWUFBWSxZQUVqQixRQUFLLEdBQUcsUUFBUSxpQkFBaUIsY0FBZSxJQUFRLE1BQUssT0FBYSxHQUMzRSxFQUVELHNCQUFxQixVQUFVLFNBQVUsSUFDdkMsQ0FBSSxJQUFJLFNBQVcsS0FDbkIsU0FBSyxPQUFPLElBQUksT0FDakIsTUFFRCxVQUFRLFNBQVUsTUFFaEIsT0FBSSxDQUFDLE9BQVMsS0FDWixrQkFBSyxZQUFZLFFBQVUsS0FDM0IsaUJBQUssWUFBWSxNQUNqQixhQUFLLEdBQUcsUUFBUSxLQUFLLGdCQUFpQixLQUl4Qyx3QkFBSyxZQUFZLE1BQ2pCLFdBQUssWUFBWSxNQUNqQixjQUFRLE9BQU8sS0FBSyxZQUFhLENBQUMsSUFFaEMsVUFDRSxVQUFLLEdBQUcsUUFBUSxLQUFLLGNBQ3JCLHNCQUFRLE1BSVYsV0FBSSxDQUFVLGFBQUssWUFBYyxRQUNqQyxXQUFLLFlBQVksUUFBVSxRQUMzQixVQUFLLEdBQUcsUUFBUSxLQUFLLGdCQUFpQixLQUV6QyxlQUdILElBR0EsT0FBTyxrQkFBa0IsZUFDdkIsTUFBTSxVQUNKLE1BQUssWUFBYyxDQUFnQixpQkFBTSxNQUFPLEdBQUksUUFDcEQsU0FBSyxZQUNILFNBQ0EsZUFHRixVQUFLLEdBQUcsaUJBQWlCLFFBQVMsS0FDaEMsTUFBSyxPQUFPLElBQUksT0FBTyxRQUFRLFVBQVUsUUFDMUMsV0FDRixFQUVELFNBQVEsU0FBVSxNQUNoQixNQUNPLFlBQXVCLFFBQTVCLGFBREUsU0FHMEIsc0RBQWUsS0FFN0MsWUFBUSxPQUFPLEtBQUssWUFBYSxDQUFDLElBQ2hDLFVBQ0UsVUFBSyxHQUFHLFFBQVEsS0FBSyxjQUNyQixzQkFBUSxNQUlWLGdCQUFLLFlBQVksTUFDakIsV0FBSyxZQUFZLFFBQVUsUUFDM0IsVUFBSyxHQUFHLFFBQVEsS0FBSyxnQkFBaUIsS0FFekMsY0FHSCxJQUdBLE9BQU8sa0JBQWtCLHFCQUN2QixNQUFNLFVBQ0osTUFBTSxLQUFNLEdBQUksa0JBQWlCLFdBQy9CLEtBQUssR0FBSSxHQUFJLEVBQUcsRUFBSSxVQUFVLE9BQzVCLElBQ0UsWUFERSxhQUFVLEdBQUcsb0JBSXBCLGVBQ0QsT0FBSSxRQUFRLEtBQUssR0FBSSxDQUFhLGNBQWlCLGFBQ3BELFlBRUQsZ0JBQWUsVUFDYixNQUFLLEdBQUcsS0FBSyxnQkFDZCxRQUVELFFBQU8sVUFBVSxTQUFVLElBQ3pCLE1BQUssR0FBRyxRQUFRLEtBQUssc0JBQ0EsSUFBSSxPQUFPLFFBQVEsaUJBQWlCLFFBRTFELE1BSk0sS0FPVCxPQUFPLGtCQUFrQiw0QkFDdkIsUUFDRSxRQUFRLENBQUMsUUFDVCxTQUFPLENBQUMsUUFDUixVQUFRLENBQUMsUUFDVCx1QkFBcUIsQ0FBQyxRQUd4QixZQUFRLFVBQ04sTUFBTSxNQUFPLEtBQ2IsS0FBTSxHQUFLLEtBQ1gsTUFBRyxTQUFTLFFBQVUsQ0FBQyxDQUFDLEtBQUsscUJBQXNDLENBQ25FLENBRG9ELFFBQUssU0FDdEQsU0FBUyxTQUFTLEVBQUksS0FBSyxNQUFRLEtBQUssT0FBUyxLQUNyRCxNQWJtRCxrREN0SHRELEdBQUksT0FBUSxvQkFFTixHQUtOLE9BQU8sa0JBQWtCLHNCQUN2QixRQUNFLGFBQWEsQ0FBQyxRQUNkLFVBQU8sQ0FDUCx3QkFBYSxDQUNiLDBCQUFlLENBQ2YsZ0NBQXFCLENBQUMsS0FHeEIsZ0JBQU0sVUFDSixNQUFLLFdBQWEsU0FBUyxlQUMzQixzQkFBSyxNQUFRLFNBQVMsY0FDdEIsY0FBSyxXQUNMLFFBQUssa0JBQ0wsUUFBSyxhQUNOLEVBRUQsU0FBUSxTQUFVLFFBQ2hCLE1BQU0sTUFBTyxLQUliLFdBQUksQ0FBQyxRQUFRLGFBQWUsS0FDMUIsa0JBQXdELENBQXBELFFBQUssV0FBVyxXQUFXLGNBQWMsUUFFM0MsQ0FERSxNQUFLLE1BQU0sbUJBU2pCLGFBQUksU0FBK0IscUJBQUMsS0FBNEIscUJBQUMsS0FDL0Qsa0JBS0YsV0FBSSxRQUFRLGVBQWlCLENBQUMsS0FDNUIsd0JBS0YsZ0JBQUksS0FBSyxxQkFBdUIsUUFBUSxzQkFBd0IsS0FDOUQsc0JBQUksS0FBYyxZQUdsQixXQUFJLENBQUMsS0FBSyxrQkFBa0IsU0FBUyxLQUFLLHNCQUN0QyxLQUFLLHNCQUF3QixLQUMvQix1QkFHRiw2QkFBSyxTQUFTLEtBRWpCLHVCQUVELE1BQUssU0FBVSxJQUNULENBQUMsS0FBSyxLQUNWLGVBQVEsSUFDVCxJQUtELHdCQUF1QixVQUNyQixNQUFNLE1BQU8sS0FDYixLQUFNLGFBQWUsS0FFckIsa0JBQVUsOENBQXlDLEtBQXlCLG1CQUM1RSxTQUFLLDJCQUE2QixLQUVsQyx5QkFBSyxXQUFXLEtBQUsscUJBQXFCLGlCQUFpQixhQUFjLElBQ3ZFLE1BQVUsZ0RBQTJDLEtBQXlCLG1CQUM5RSxTQUFLLGtCQUFrQixLQUFLLEtBQzVCLDBCQUFLLDJCQUVMLEdBQUksYUFDRixjQUFVLDBDQUFxQyxhQUFhLEdBQWUsV0FDM0UsU0FBSyxnQkFBZ0IsYUFFeEIsSUFHRCxRQUFLLFdBQVcsS0FBSyxxQkFBcUIsSUFDeEMsTUFBTSxhQUFhLEtBQUssb0JBRzFCLGdCQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksYUFBYSxPQUMvQixPQUFJLGFBQWEsR0FBRyxjQUFnQixLQUFLLG9CQUN2QyxjQUFhLE9BQU8sRUFDcEIsR0FDRCxLQUVKLENBTUQsbUJBQWtCLFNBQVUsWUFBYSxpQkFDdkMsS0FBSSxLQUFLLFdBRVQsbUJBQU0sT0FBUSxTQUFTLGNBQ3ZCLGVBQU0sWUFDTixrQkFBTSxRQUFRLGlCQUNkLHNCQUFLLFdBQVcsYUFFaEIsU0FBSSxLQUFNLE1BQU0sYUFBYSxZQUM3QixZQUFJLEtBRUYsc0JBQUssYUFBYSxLQUNoQixPQUNBLGtCQUNBLGdCQUlGLFdBQUssZ0JBQ0gsT0FDQSxrQkFDQSxnQkFHTCxNQVNELGtCQUFpQixTQUFVLFlBQ3pCLE1BQU0sT0FBUSxZQUNkLFdBQVUsOENBQXlDLFlBQXdCLFdBRTNFLFVBQU0saUJBQWlCLGlCQUFrQixJQUV2QyxNQUFVLHVEQUFrRCxZQUF3QixXQUNwRixTQUFLLGtCQUFrQixLQUFLLFlBQzVCLGtCQUFLLGlCQUdMLFFBQVUsc0JBQWlCLEtBQUssYUFBb0IsTUFDcEQsYUFBSSxLQUFLLGFBQWEsUUFBVSxDQUFDLEtBQy9CLGlDQUFLLGdCQUFnQixLQUFLLGFBRTdCLFFBRUQsU0FBTSxRQUNOLGlCQUFNLElBQU0sWUFDWixTQUFLLGlCQUFtQixZQUN6QixXQUVELFdBQVUsVUFDSixDQUFDLEtBQ0QsUUFBQyxLQUFLLE1BQWdCLGFBQUssTUFDaEMsUUFFRCxXQUFVLFNBQVUsWUFDbEIsQ0FBSSxHQUVKLGtCQUFLLE1BQVEsS0FBSyxXQUNsQixrQkFBSyxNQUNMLFlBQUssTUFDTCxPQTFLSixTQTBLUyxNQUFNLFlBQWMsS0FBSyxNQUFNLFFBQ3BDLHNCQUFLLFdBQVcsYUFBYSxnQkFBaUIsTUFBTyxLQUVyRCxZQUFNLGVBQWdCLEtBQUssV0FBVyxXQUN0Qyw0QkFFQSxxQkFBSyxNQUlMLE9BQUksY0FBcUIsbUJBQWMsSUFDdkMsc0JBQWMsaUJBQWlCLE1BQU0sYUFBYSxZQUNuRCxhQUtELFlBQVcsU0FBVSxZQUNuQixJQUFJLE9BQVEsS0FBSyxXQUNqQixtQkFBTSxRQUdOLFVBQ0EsV0FBSyxHQUFJLEdBQUksRUFBRyxFQUFJLEtBQUssYUFBYSxPQUNwQyxPQUFJLEtBQUssYUFBYSxHQUFHLEtBQU8sWUFDOUIsT0FDQSxFQUNELEtBRUMsQ0FDSixZQUFLLGFBQWEsT0FBTyxNQUMxQixFQUdILElBR0EsT0FBTyxrQkFBa0IsZUFDdkIsUUFDRSxhQUFhLENBQUMsS0FDZCwyQkFBa0IsQ0FBQyxLQUdyQixrQkFBUSxTQUFVLFFBQ2hCLENBQUksUUFBUSxhQUFlLEtBQUssS0FBSyxjQUFnQixRQUNuRCxrQkFBSyxHQUFHLFFBQVEsV0FBVyx1QkFBdUIsVUFBVSxRQUc5RCxrQkFBSyxHQUFHLFFBQVEsV0FBVyx1QkFBdUIsaUJBQ2hELEtBQUssS0FBSyxZQUFhLEtBQUssS0FFL0IsaUJBZHNDLGdCQ25OekMsT0FBTyxrQkFBa0IscUJBQ3ZCLGNBQWMsQ0FBQyxXQUVmLG1CQUNFLFNBQVMsQ0FHWCxrQkFBTSxVQUNKLE1BQUssS0FBTyxPQUFPLE1BQU0sYUFBYSxLQUFLLEtBQUssS0FFaEQsZ0JBQUssU0FBVyxLQUFLLEdBQUcsWUFBWSxRQUFRLFNBQVMsU0FDckQsY0FBSyxHQUFHLFFBQVEsaUJBQWlCLFlBQWEsSUFDNUMsTUFBSyxTQUFTLE1BQ2YsQ0FDRixFQUVELFNBQWtCLFVBQ2hCLE1BQUssU0FBUyxNQUNmLENBRUQsYUFBWSxVQUNWLE1BQU0sUUFBUyxLQUFLLEdBQUcsUUFBUSxXQUFXLEtBQzFDLE9BQUksR0FFSixhQUFNLFVBQ0osS0FBSyxHQUFHLFFBQVEsV0FBVyxLQUFLLGlCQUNoQyxPQUFPLE9BQ1QsY0FBSyxTQUFTLE1BQ2YsU0FFRCxPQUFNLFVBQ0EsQ0FBQyxLQUFLLEtBQ1YsY0FDRCxZQWpDNEMsaURDQS9DLE1BQU0sT0FBUSxvQkFFZCxHQUFNLGlCQUNOLElBQU0sS0FBTyxDQUNiLFNBQU0sWUFBYyxLQUVwQixHQUFJLFdBQVksT0FBTyxNQUFNLGdCQUN6QixRQUFDLENBQWMsc0JBQVksU0FFL0IsZ0JBYUEsT0FBTyxrQkFBa0IsT0FDdkIsUUFDRSxZQUFZLENBQUMsS0FBTSxXQUFZLFFBQy9CLDhCQUFhLENBQUMsUUFDZCxxQkFBa0IsQ0FDbEIsdUJBQVksQ0FDWixzQkFBVyxDQUNYLHNCQUFXLENBR2Isa0JBQU0sVUFDSixNQUFLLGVBQWlCLENBQ3RCLGdCQUFLLGNBQWdCLEtBQUssS0FBSyxXQUFXLFdBQzFDLG1CQUFLLFFBQVUsS0FBSyxjQUNwQixhQUNBLGtCQUFLLHFCQUF1QixTQUFTLGVBQ3JDLDZCQUFLLGNBRUwsT0FBSyxRQUFVLEtBQUssUUFBUSxLQUc1QixXQUFLLGNBQWMsU0FBUyxLQUFLLE1BRWpDLGlCQUFLLEdBQUcsaUJBQWlCLGtCQUFtQixLQUFLLFVBQVUsS0FDM0QsWUFBSyxHQUFHLGlCQUFpQixlQUFnQixLQUFLLGVBQWUsS0FDN0QsWUFBSyxHQUFHLGlCQUFpQixhQUFjLEtBQUssYUFBYSxLQVMxRCxTQUVELFNBQVEsU0FBVSxRQUNoQixJQUFJLE1BQU8sS0FHWCxXQUFJLENBQUMsUUFBUSxZQUFjLEtBQ3pCLHFCQUlGLGNBQUksUUFBUSxZQUFjLENBQUMsS0FDekIsa0JBQUssY0FBYyxTQUFTLE1BSTlCLGFBQUksQ0FBQyxRQUFRLFdBQWEsS0FDeEIsaUJBQUssS0FBSyxXQUFXLGlCQUFpQiw0QkFBNkIsS0FDakUsTUFBSyxjQUNMLHFCQUFNLE1BQU8sS0FBSyxjQUFjLFNBQ2hDLFVBQUssc0JBQ0wsUUFBSyxlQUFlLEtBQ3BCLFFBQUssT0FBUyxJQUNkLFlBQUssT0FDTixPQVBELEVBUUEsZ0JBQUssY0FLUCxrQkFBSSxDQUFDLFFBQVEsa0JBQW9CLEtBQUssS0FBSyxrQkFBb0IsS0FDN0QsYUFHRixhQUFJLFFBQVEsYUFBZSxDQUFDLEtBQzFCLHNCQUtGLGlCQUFJLFFBQVEsY0FBZ0IsS0FBSyxhQUFlLEtBQzlDLG1CQUFLLEdBQUcsUUFBUSxLQUFLLGdCQUNyQixjQUFLLFdBQVcsS0FBSyxJQUNuQixNQUFLLEdBQUcsUUFBUSxLQUFLLGlCQUN0QixRQUZELEdBRUcsTUFBTSxRQUlYLFFBQUksUUFBUSxXQUFhLENBQUMsS0FDeEIsZ0JBQUssY0FJUCxpQkFBSSxDQUFDLFFBQVEsV0FBYSxLQUFLLFdBQWEsS0FDMUMsYUFBSyxjQUVSLGlCQUVELFdBQVUsVUFDUixNQUFNLE1BQU8sS0FFYixpQkFDQSxhQUFPLEdBQUksU0FDVCxlQUFLLFdBQVcsaUJBQWlCLDRCQUE2QixLQUU1RCxNQUFLLE9BQVMsSUFDZCxlQUFRLEtBQ1QsT0FKRCxFQUtBLFdBQUssZUFBZSxJQUFNLE1BQU0sYUFBYSxLQUFLLFlBQ2xELGlCQUFLLFdBQVcsYUFBYSxnQkFBaUIsS0FHOUMsZ0JBQUksS0FBSyxjQUFjLElBQ3JCLGVBQUsscUJBQXFCLGFBQWEsV0FBWSxXQUNuRCxhQUFLLEdBQUcsUUFBUSxLQUFLLGtCQUl2QixvQkFBSyxjQUFjLElBQUksaUJBQWlCLFdBQVksS0FDbEQsTUFBSyxnQkFDTixJQUVKLElBRUQsWUFBVyxVQUNMLE9BQUMsTUFDSCxpQkFHRyxPQUNMLFlBQUssT0FDTCxrQkFBSyxPQUNMLFVBQ0QsMkJBUFcsS0FHViw4Q0FNRixVQUFTLFVBQ0gsQ0FBQyxLQUFLLEtBQ1YsZ0JBQUssR0FBRyxRQUFRLEtBQUssVUFDdEIsUUFFRCxrQkFBaUIsU0FBVSxJQUN6QixNQUFNLFVBQVcsSUFBSSxPQUFTLElBQzlCLFdBQUsscUJBQXFCLGFBQWEsV0FBWSxXQUNuRCxVQUNFLENBREUsaUJBQ0csR0FBRyxRQUFRLEtBQUssa0JBRXhCLFFBRUQsYUFBWSxVQUNWLE1BR0Esa0JBQU0sY0FBZSxLQUFLLE9BQzFCLDBCQUFhLGVBQWUsYUFBYSxNQUFPLEtBQUssUUFDckQsMEJBQWEsd0JBQXdCLEVBQUcsS0FBSyxRQUFRLFlBR3JELHVCQUFNLE1BQU8sS0FBSyxjQUFjLFNBQ2hDLFVBQUssZUFBZSxLQUFLLE1BQU8sS0FBSyxRQUNyQyxrQkFBSyx3QkFBd0IsRUFBRyxLQUFLLFFBQVEsWUFFN0MsNkJBQVcsSUFDTCxDQUFDLEtBQUssS0FDVixpQkFDRCxXQUhELEVBSUQsS0FFRCxZQUFXLFVBQ1QsTUFHQSxhQUFJLEtBQWUsYUFBSyxPQUd4QixrQkFBTSxNQUFPLEtBQUssY0FBYyxTQUNoQyxVQUFLLHNCQUVMLFFBQUssS0FBSyxXQUFXLGlCQUFpQiw0QkFBNkIsS0FDakUsTUFBSyxPQUFTLElBQ2QsWUFBSyxHQUFHLFFBQVEsS0FBSyxpQkFDdEIsUUFIRCxFQUlBLFdBQUssY0FDTixlQUVELGlCQUFnQixVQUNkLE1BQU0sTUFBTyxLQUFLLGNBQWMsU0FDaEMsVUFBSyx3QkFBd0IsSUFBSyxLQUFLLFFBQVEsWUFDaEQsSUFFRCxlQUFjLFVBQ1osTUFBTSxNQUFPLEtBQUssY0FBYyxTQUNoQyxVQUFLLHdCQUF3QixZQUFhLEtBQUssUUFBUSxZQUN4RCxJQUVELGFBQVksVUFDVixNQUFNLE1BQU8sS0FBSyxjQUFjLFNBQ2hDLFVBQUssZUFBZSxZQUFhLEtBQUssUUFDdEMsa0JBQUssY0FBZ0IsS0FBSyxRQUMxQixpQkFBSyxPQUFPLFFBQVUsS0FDdEIsYUFBSyxPQUFPLE1BQU0sRUFDbEIsZ0JBQ0QsWUFFRCxpQkFBZ0IsVUFDZCxPQUFPLE1BQUssUUFBUSxZQUFjLEtBQ25DLGFBdk04QixlQ3RCc0IsQ0FFdkQsT0FBTyxrQkFBa0IsZUFDdkIsY0FBYyxDQUVkLHFCQUNFLE9BQU8sQ0FBQyxRQUFTLE9BQVEsTUFBTyxDQUFDLE9BR25DLGNBQU0sVUFDSixNQUFLLFdBQWEsQ0FBQyxNQUFPLE9BQVEsT0FBUSxXQUFZLEdBQUksTUFBTyxNQUNqRSxnQkFBSyxHQUFHLGlCQUFpQixZQUFhLEtBQUssWUFBWSxLQUN4RCxNQUVELFNBQWtCLFVBQ2hCLE1BQUssYUFBYSxLQUFLLEtBQ3hCLE1BRUQsV0FBVSxTQUFVLE9BQVEsS0FDMUIsTUFBSyxHQUFTLFFBQVMsY0FBTyxLQUFLLFdBQWlCLEtBQXBELEdBQ0QsUUFFRCxjQUFhLFVBQ1gsTUFBSyxhQUNMLGFBQUssR0FBRyxLQUFLLGNBQ2IsY0FBSyxHQUFHLEtBQUssaUJBQ2IsY0FBSyxHQUFHLEtBQUssZ0JBQ2IsY0FBSyxHQUFHLEtBQUsscUJBQ2IsY0FBSyxHQUFHLEtBQUssc0JBQ2QsUUFFRCxlQUF3QixVQUN2QixDQUVILGdCQ2xDQSxPQUFPLGtCQUFrQixlQUN2QixRQUNFLFNBQVMsQ0FHWCxrQkFBTSxVQUNKLE1BQUssTUFDTCxPQUFLLE9BQVMsQ0FDWixLQUFLLEdBQUcsU0FBUyxHQUFHLFNBQ3BCLEtBQUssR0FBRyxTQUFTLEdBQUcsU0FDcEIsS0FBSyxHQUFHLFNBQVMsR0FFcEIsU0FFRCxRQUFPLFNBQVUsTUFDZixNQUFLLE1BQVEsTUFDZCxDQUVELE9BQU0sU0FBVSxLQUFNLE1BQ3BCLElBQ0EsQ0FESSxRQUFLLFlBRVQsWUFBSSxDQUFDLEtBQUssS0FDUixlQUFLLE9BQ0wsS0FDRSxJQURFLE1BQUssSUFBSSxLQUFLLGtCQUNYLE1BSVQsYUFBSyxPQUFPLEdBQUcsU0FBUyxHQUFLLEtBQUssTUFDbEMsV0FBSyxPQUFPLEdBQUcsU0FBUyxHQUN4QixJQUQ2QixPQUFLLE1BQVEsWUFDckMsT0FBTyxHQUFHLFNBQVMsR0FDekIsSUFEOEIsT0FBSyxNQUFRLE9BOUJMLHVCQ0FsQyxlQUFlLHNCQUVsQixPQUFPLENBQUMsS0FBTSxPQUFRLEdBQUksVUFBVyxRQUFTLENBQUMsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUMzRCxhQUFVLENBQUMsS0FBTSxPQUFRLEdBQUksVUFBVyxRQUFTLENBQUMsRUFBRyxFQUFHLEVBQUcsS0FBTSxFQUNqRSxXQUFLLENBQUMsS0FBTSxNQUFPLEdBSXJCLFlBQWUsYUFXZjs7Ozs7Ozs7O0dBbEJBLENBa0JpQixlQW5Ca0I7Ozs7Ozs7Ozs7Ozs7O0lBQXJDLGNDQUEsT0FBTyxrQkFBa0IsY0FDdkIsTUFBTSxVQUNKLENBQ0UsTUFERSxVQUFPLE1BQU0sZ0JBQWdCLGVBQzFCLEdBQUcsYUFBYSxRQUV4QixHQUxxQyxnQkNBeEMsT0FBTyxrQkFBa0IsV0FDdkIsTUFBTSxVQUNKLE1BQUssUUFBVSxTQUFTLGVBQ3hCLGlCQUFLLE9BQVMsU0FBUyxlQUN2QixlQUFLLFNBQ0wsT0FBSyxNQUFTLEVBQUcsS0FBSyxHQUFHLGFBQWEsWUFBWSxPQUFTLEVBQzNELFVBQUssV0FDTixHQUVELE9BQU0sU0FBZ0IsS0FDcEIsTUFBSSxLQUFPLEtBQUssU0FBVyxLQUUzQixnQkFBSSxRQUFTLEtBQUssT0FBTyxTQUN6QixTQUFJLE9BQVMsS0FBSyxRQUFRLFNBRTFCLFNBQUksT0FBTyxFQUFJLEtBQ2IsWUFBSyxXQUNMLFFBQUssUUFBUSxTQUNiLGdCQUFLLFFBQVEsWUFBWSxRQUFRLFNBQVMsUUFBVSxFQUFJLEtBQUssSUFBSSxPQUFPLEVBQUksT0FDNUUsVUFBTyxFQUFJLE9BQ1gsU0FBTyxFQUFJLE9BR1gsU0FBSyxRQUFRLFNBQ2IsZ0JBQUssV0FHUCxVQUFLLFNBQ04sS0E1QmtDLGVDQXJDLENBR0EsT0FBTyxrQkFBa0IsYUFDdkIsUUFDRSxNQUFNLENBQUMsS0FDUCxpQkFBTSxDQUFDLEtBR1QsZ0JBQU0sVUFDSixJQUFJLElBQUssS0FDVCxHQUFJLEtBQU8sS0FFWCxVQUFLLEtBQUssaUJBQWlCLGVBQWdCLEtBQ3pDLE1BQU0sT0FBUSxJQUFJLE9BQ2xCLE1BQU0sT0FBUyxNQUFNLGdCQUFnQixLQUNyQyxTQUFHLFlBQVksT0FBUSxPQUN2QixZQUFHLGFBQWEsV0FBWSxTQUM1QixXQUFHLEtBQUssa0JBQ1QsUUFDRixFQWpCb0MsZUNGdkMsQ0F1a0JBLFFBQVMsY0FBYyxNQUFPLEtBQzVCLEtBQUssR0FBSSxHQUFJLEVBQUcsRUFBSSxNQUFNLE9BQ3hCLE9BQUksTUFBTSxHQUFHLEtBQWUsV0FBTyxPQUVyQyxTQUNELEssaUJBMWRlLEtBQUssTUFsSGpCLFVBQ0YsWUFBWSxDQUFDLFVBQVcsR0FBa0Isa0JBQU8sYUFBYyxLQUFNLElBQUssZUFBZ0IsU0FBVSxxQkFBc0IsT0FBUSxDQUFDLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksT0FBUSxDQUFDLElBQU0sSUFBSyxFQUFJLE1BQU8sRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE9BQVEsQ0FBQyxJQUFNLElBQUssRUFBSSxNQUFPLEVBQUksTUFBTyxFQUFJLE1BQU8sRUFBSSxPQUFRLENBQUMsSUFBTSxJQUFLLEVBQUksTUFBTyxFQUFJ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QUVBLDBDQUNBLDhDQUNBLFFBRUEsb0RBQ0Esc0JBQ0EsNEJBQ0EsaURBR0EsT0FFQSxpQ0FDQSxXQUNBLDJDQUNBLFlBQ0EsS0FDQSxlQUNBLFFBRUEsbUNBQ0EsV0FDQSxzQ0FDQSxZQUNBLE1BQ0EsZUFDQSxRQUVBLG9DQUNBLFdBQ0EsMkNBQ0Esa0JBQ0EsT0FDQSxlQUNBLE1BRUEsVUFDQSxnRUFDQSxTQW9KQSwyREE4Q0Esa0NBQ0EsMEJBQTRCLFVBQzVCLGFBa0NBLDZCQWdCQSw4QkFFQSxtQ0FDQSxvQ0FDQSxhQUNBLHVCQUNBLG9DQUNBLGtCQUVBLE9BRUEseUJBQ0EsaUNBQXFDLG9CQUNyQywwQkFDQSxRQUNBLFVBRUEsMkNBRUEsc0NBQ0EsS0FDQSwwREFHQSxpREFBNkIsdUJBQTBCLFNBQ3ZELFFBRUEsbUNBQ0EsR0FDQSxJQUNBLGFBQUMsV0FDRCxvQ0FDQSxjQUNBLGtCQUNBLHFCQUNBLDBCQUNBLEtBQ0EsNkNBQ0EsOENBQ0EsYUFzRUEsTUFFQSxpQkFDQSxtQkFDQSxtQkFDQSxxQkFDQSxzQkFDQSIsImZpbGUiOiJidWlsZC9idWlsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEzMik7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgNDRiNzdiNTg4ZDRhYmFmMzYzMTYiLCJ2YXIgZztcclxuXHJcbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXHJcbmcgPSAoZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHRoaXM7XHJcbn0pKCk7XHJcblxyXG50cnkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxyXG5cdGcgPSBnIHx8IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKSB8fCAoMSxldmFsKShcInRoaXNcIik7XHJcbn0gY2F0Y2goZSkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXHJcblx0aWYodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIilcclxuXHRcdGcgPSB3aW5kb3c7XHJcbn1cclxuXHJcbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cclxuLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3NcclxuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBnO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAod2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjbG9uZShvYmopIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Nsb25lLmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImNvbnN0IEJBU0VfVVJMID0gJ2h0dHBzOi8vc2FiZXIuc3VwZXJtZWRpdW0uY29tJztcblxuZnVuY3Rpb24gZ2V0UzNGaWxlVXJsIChpZCwgbmFtZSkge1xuICByZXR1cm4gYCR7QkFTRV9VUkx9LyR7aWR9LSR7bmFtZX0/dj0xYDtcbn1cbm1vZHVsZS5leHBvcnRzLmdldFMzRmlsZVVybCA9IGdldFMzRmlsZVVybDtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlscy5qcyIsIlxudmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG52YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGZvckVhY2ggKG9iaiwgZm4sIGN0eCkge1xuICAgIGlmICh0b1N0cmluZy5jYWxsKGZuKSAhPT0gJ1tvYmplY3QgRnVuY3Rpb25dJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpdGVyYXRvciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgdmFyIGwgPSBvYmoubGVuZ3RoO1xuICAgIGlmIChsID09PSArbCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgZm4uY2FsbChjdHgsIG9ialtpXSwgaSwgb2JqKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGsgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAoaGFzT3duLmNhbGwob2JqLCBrKSkge1xuICAgICAgICAgICAgICAgIGZuLmNhbGwoY3R4LCBvYmpba10sIGssIG9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vZm9yZWFjaC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbi8vIFRoaXMgZmlsZSBob3N0cyBvdXIgZXJyb3IgZGVmaW5pdGlvbnNcbi8vIFdlIHVzZSBjdXN0b20gZXJyb3IgXCJ0eXBlc1wiIHNvIHRoYXQgd2UgY2FuIGFjdCBvbiB0aGVtIHdoZW4gd2UgbmVlZCBpdFxuLy8gZS5nLjogaWYgZXJyb3IgaW5zdGFuY2VvZiBlcnJvcnMuVW5wYXJzYWJsZUpTT04gdGhlbi4uXG5cbnZhciBpbmhlcml0cyA9IHJlcXVpcmUoJ2luaGVyaXRzJyk7XG5cbmZ1bmN0aW9uIEFsZ29saWFTZWFyY2hFcnJvcihtZXNzYWdlLCBleHRyYVByb3BlcnRpZXMpIHtcbiAgdmFyIGZvckVhY2ggPSByZXF1aXJlKCdmb3JlYWNoJyk7XG5cbiAgdmFyIGVycm9yID0gdGhpcztcblxuICAvLyB0cnkgdG8gZ2V0IGEgc3RhY2t0cmFjZVxuICBpZiAodHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH0gZWxzZSB7XG4gICAgZXJyb3Iuc3RhY2sgPSAobmV3IEVycm9yKCkpLnN0YWNrIHx8ICdDYW5ub3QgZ2V0IGEgc3RhY2t0cmFjZSwgYnJvd3NlciBpcyB0b28gb2xkJztcbiAgfVxuXG4gIHRoaXMubmFtZSA9ICdBbGdvbGlhU2VhcmNoRXJyb3InO1xuICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJztcblxuICBpZiAoZXh0cmFQcm9wZXJ0aWVzKSB7XG4gICAgZm9yRWFjaChleHRyYVByb3BlcnRpZXMsIGZ1bmN0aW9uIGFkZFRvRXJyb3JPYmplY3QodmFsdWUsIGtleSkge1xuICAgICAgZXJyb3Jba2V5XSA9IHZhbHVlO1xuICAgIH0pO1xuICB9XG59XG5cbmluaGVyaXRzKEFsZ29saWFTZWFyY2hFcnJvciwgRXJyb3IpO1xuXG5mdW5jdGlvbiBjcmVhdGVDdXN0b21FcnJvcihuYW1lLCBtZXNzYWdlKSB7XG4gIGZ1bmN0aW9uIEFsZ29saWFTZWFyY2hDdXN0b21FcnJvcigpIHtcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG5cbiAgICAvLyBjdXN0b20gbWVzc2FnZSBub3Qgc2V0LCB1c2UgZGVmYXVsdFxuICAgIGlmICh0eXBlb2YgYXJnc1swXSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGFyZ3MudW5zaGlmdChtZXNzYWdlKTtcbiAgICB9XG5cbiAgICBBbGdvbGlhU2VhcmNoRXJyb3IuYXBwbHkodGhpcywgYXJncyk7XG4gICAgdGhpcy5uYW1lID0gJ0FsZ29saWFTZWFyY2gnICsgbmFtZSArICdFcnJvcic7XG4gIH1cblxuICBpbmhlcml0cyhBbGdvbGlhU2VhcmNoQ3VzdG9tRXJyb3IsIEFsZ29saWFTZWFyY2hFcnJvcik7XG5cbiAgcmV0dXJuIEFsZ29saWFTZWFyY2hDdXN0b21FcnJvcjtcbn1cblxuLy8gbGF0ZSBleHBvcnRzIHRvIGxldCB2YXJpb3VzIGZuIGRlZnMgYW5kIGluaGVyaXRzIHRha2UgcGxhY2Vcbm1vZHVsZS5leHBvcnRzID0ge1xuICBBbGdvbGlhU2VhcmNoRXJyb3I6IEFsZ29saWFTZWFyY2hFcnJvcixcbiAgVW5wYXJzYWJsZUpTT046IGNyZWF0ZUN1c3RvbUVycm9yKFxuICAgICdVbnBhcnNhYmxlSlNPTicsXG4gICAgJ0NvdWxkIG5vdCBwYXJzZSB0aGUgaW5jb21pbmcgcmVzcG9uc2UgYXMgSlNPTiwgc2VlIGVyci5tb3JlIGZvciBkZXRhaWxzJ1xuICApLFxuICBSZXF1ZXN0VGltZW91dDogY3JlYXRlQ3VzdG9tRXJyb3IoXG4gICAgJ1JlcXVlc3RUaW1lb3V0JyxcbiAgICAnUmVxdWVzdCB0aW1lZG91dCBiZWZvcmUgZ2V0dGluZyBhIHJlc3BvbnNlJ1xuICApLFxuICBOZXR3b3JrOiBjcmVhdGVDdXN0b21FcnJvcihcbiAgICAnTmV0d29yaycsXG4gICAgJ05ldHdvcmsgaXNzdWUsIHNlZSBlcnIubW9yZSBmb3IgZGV0YWlscydcbiAgKSxcbiAgSlNPTlBTY3JpcHRGYWlsOiBjcmVhdGVDdXN0b21FcnJvcihcbiAgICAnSlNPTlBTY3JpcHRGYWlsJyxcbiAgICAnPHNjcmlwdD4gd2FzIGxvYWRlZCBidXQgZGlkIG5vdCBjYWxsIG91ciBwcm92aWRlZCBjYWxsYmFjaydcbiAgKSxcbiAgSlNPTlBTY3JpcHRFcnJvcjogY3JlYXRlQ3VzdG9tRXJyb3IoXG4gICAgJ0pTT05QU2NyaXB0RXJyb3InLFxuICAgICc8c2NyaXB0PiB1bmFibGUgdG8gbG9hZCBkdWUgdG8gYW4gYGVycm9yYCBldmVudCBvbiBpdCdcbiAgKSxcbiAgVW5rbm93bjogY3JlYXRlQ3VzdG9tRXJyb3IoXG4gICAgJ1Vua25vd24nLFxuICAgICdVbmtub3duIGVycm9yIG9jY3VyZWQnXG4gIClcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvZXJyb3JzLmpzXG4vLyBtb2R1bGUgaWQgPSA0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBmb3JlYWNoID0gcmVxdWlyZSgnZm9yZWFjaCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG1hcChhcnIsIGZuKSB7XG4gIHZhciBuZXdBcnIgPSBbXTtcbiAgZm9yZWFjaChhcnIsIGZ1bmN0aW9uKGl0ZW0sIGl0ZW1JbmRleCkge1xuICAgIG5ld0Fyci5wdXNoKGZuKGl0ZW0sIGl0ZW1JbmRleCwgYXJyKSk7XG4gIH0pO1xuICByZXR1cm4gbmV3QXJyO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9tYXAuanNcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIE9GRjogJyMxMTEnLFxuICBSRUQ6ICcjZmYzYTdiJyxcbiAgQkxVRTogJyMwOGJmYTInLFxuXG4gIFVJX0FDQ0VOVDogJyMwOGJmYTInLFxuICBVSV9BQ0NFTlQyOiAnI2YwMTk3OCcsXG5cbiAgU0tZX09GRjogJyMyOTc1NDcnLFxuICBTS1lfQkxVRTogJyM4NDBkNDInLFxuICBTS1lfUkVEOiAnIzE1NDEzNicsXG5cbiAgQkdfT0ZGOiAnIzA4MWEwZicsXG4gIEJHX0JMVUU6ICcjMzc5ZjVlJyxcbiAgQkdfQlJJR0hUQkxVRTogJyM0ZmQ5ODMnLFxuICBCR19SRUQ6ICcjZmYxZjgxJyxcbiAgQkdfQlJJR0hUUkVEOiAnI2ZmNmJiMCcsXG5cbiAgTkVPTl9PRkY6ICcjMDAwJyxcbiAgTkVPTl9CTFVFOiAnIzAwOGE3MCcsXG4gIE5FT05fQlJJR0hUQkxVRTogJyM4N2MyZmYnLFxuICBORU9OX1JFRDogJyNmMDE5NzgnLFxuICBORU9OX0JSSUdIVFJFRDogJyNmZjcwYjUnLFxuXG4gIFRFWFRfT0ZGOiAnIzAwMCcsXG4gIFRFWFRfTk9STUFMOiAnIzQ0NCcsXG4gIFRFWFRfQk9MRDogJyM4ODgnLFxuXG4gIEJFQVRfUkVEOiAnIzY2MDMzOCcsXG4gIEJFQVRfQkxVRTogJyMwMzY2NTcnLFxuXG4gIE1JTkVfUkVEOiAnIzFjMDYwZScsXG4gIE1JTkVfUkVEX0VNSVNTSU9OOiAnIzJhMGQxYicsXG4gIE1JTkVfQkxVRTogJyMwMTExMTQnLFxuICBNSU5FX0JMVUVfRU1JU1NJT046ICcjMDcyMDIwJyxcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29uc3RhbnRzL2NvbG9ycy5qcyIsIlxuLyoqXG4gKiBUaGlzIGlzIHRoZSB3ZWIgYnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBgZGVidWcoKWAuXG4gKlxuICogRXhwb3NlIGBkZWJ1ZygpYCBhcyB0aGUgbW9kdWxlLlxuICovXG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vZGVidWcnKTtcbmV4cG9ydHMubG9nID0gbG9nO1xuZXhwb3J0cy5mb3JtYXRBcmdzID0gZm9ybWF0QXJncztcbmV4cG9ydHMuc2F2ZSA9IHNhdmU7XG5leHBvcnRzLmxvYWQgPSBsb2FkO1xuZXhwb3J0cy51c2VDb2xvcnMgPSB1c2VDb2xvcnM7XG5leHBvcnRzLnN0b3JhZ2UgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2YgY2hyb21lXG4gICAgICAgICAgICAgICAmJiAndW5kZWZpbmVkJyAhPSB0eXBlb2YgY2hyb21lLnN0b3JhZ2VcbiAgICAgICAgICAgICAgICAgID8gY2hyb21lLnN0b3JhZ2UubG9jYWxcbiAgICAgICAgICAgICAgICAgIDogbG9jYWxzdG9yYWdlKCk7XG5cbi8qKlxuICogQ29sb3JzLlxuICovXG5cbmV4cG9ydHMuY29sb3JzID0gW1xuICAnbGlnaHRzZWFncmVlbicsXG4gICdmb3Jlc3RncmVlbicsXG4gICdnb2xkZW5yb2QnLFxuICAnZG9kZ2VyYmx1ZScsXG4gICdkYXJrb3JjaGlkJyxcbiAgJ2NyaW1zb24nXG5dO1xuXG4vKipcbiAqIEN1cnJlbnRseSBvbmx5IFdlYktpdC1iYXNlZCBXZWIgSW5zcGVjdG9ycywgRmlyZWZveCA+PSB2MzEsXG4gKiBhbmQgdGhlIEZpcmVidWcgZXh0ZW5zaW9uIChhbnkgRmlyZWZveCB2ZXJzaW9uKSBhcmUga25vd25cbiAqIHRvIHN1cHBvcnQgXCIlY1wiIENTUyBjdXN0b21pemF0aW9ucy5cbiAqXG4gKiBUT0RPOiBhZGQgYSBgbG9jYWxTdG9yYWdlYCB2YXJpYWJsZSB0byBleHBsaWNpdGx5IGVuYWJsZS9kaXNhYmxlIGNvbG9yc1xuICovXG5cbmZ1bmN0aW9uIHVzZUNvbG9ycygpIHtcbiAgLy8gaXMgd2Via2l0PyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjQ1OTYwNi8zNzY3NzNcbiAgcmV0dXJuICgnV2Via2l0QXBwZWFyYW5jZScgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlKSB8fFxuICAgIC8vIGlzIGZpcmVidWc/IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM5ODEyMC8zNzY3NzNcbiAgICAod2luZG93LmNvbnNvbGUgJiYgKGNvbnNvbGUuZmlyZWJ1ZyB8fCAoY29uc29sZS5leGNlcHRpb24gJiYgY29uc29sZS50YWJsZSkpKSB8fFxuICAgIC8vIGlzIGZpcmVmb3ggPj0gdjMxP1xuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvVG9vbHMvV2ViX0NvbnNvbGUjU3R5bGluZ19tZXNzYWdlc1xuICAgIChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2ZpcmVmb3hcXC8oXFxkKykvKSAmJiBwYXJzZUludChSZWdFeHAuJDEsIDEwKSA+PSAzMSk7XG59XG5cbi8qKlxuICogTWFwICVqIHRvIGBKU09OLnN0cmluZ2lmeSgpYCwgc2luY2Ugbm8gV2ViIEluc3BlY3RvcnMgZG8gdGhhdCBieSBkZWZhdWx0LlxuICovXG5cbmV4cG9ydHMuZm9ybWF0dGVycy5qID0gZnVuY3Rpb24odikge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodik7XG59O1xuXG5cbi8qKlxuICogQ29sb3JpemUgbG9nIGFyZ3VtZW50cyBpZiBlbmFibGVkLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gZm9ybWF0QXJncygpIHtcbiAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gIHZhciB1c2VDb2xvcnMgPSB0aGlzLnVzZUNvbG9ycztcblxuICBhcmdzWzBdID0gKHVzZUNvbG9ycyA/ICclYycgOiAnJylcbiAgICArIHRoaXMubmFtZXNwYWNlXG4gICAgKyAodXNlQ29sb3JzID8gJyAlYycgOiAnICcpXG4gICAgKyBhcmdzWzBdXG4gICAgKyAodXNlQ29sb3JzID8gJyVjICcgOiAnICcpO1xuXG4gIGlmICghdXNlQ29sb3JzKSByZXR1cm4gYXJncztcblxuICB2YXIgYyA9ICdjb2xvcjogJyArIHRoaXMuY29sb3I7XG4gIGFyZ3MgPSBbYXJnc1swXSwgYywgJ2NvbG9yOiBpbmhlcml0J10uY29uY2F0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3MsIDEpKTtcblxuICAvLyB0aGUgZmluYWwgXCIlY1wiIGlzIHNvbWV3aGF0IHRyaWNreSwgYmVjYXVzZSB0aGVyZSBjb3VsZCBiZSBvdGhlclxuICAvLyBhcmd1bWVudHMgcGFzc2VkIGVpdGhlciBiZWZvcmUgb3IgYWZ0ZXIgdGhlICVjLCBzbyB3ZSBuZWVkIHRvXG4gIC8vIGZpZ3VyZSBvdXQgdGhlIGNvcnJlY3QgaW5kZXggdG8gaW5zZXJ0IHRoZSBDU1MgaW50b1xuICB2YXIgaW5kZXggPSAwO1xuICB2YXIgbGFzdEMgPSAwO1xuICBhcmdzWzBdLnJlcGxhY2UoLyVbYS16JV0vZywgZnVuY3Rpb24obWF0Y2gpIHtcbiAgICBpZiAoJyUlJyA9PT0gbWF0Y2gpIHJldHVybjtcbiAgICBpbmRleCsrO1xuICAgIGlmICgnJWMnID09PSBtYXRjaCkge1xuICAgICAgLy8gd2Ugb25seSBhcmUgaW50ZXJlc3RlZCBpbiB0aGUgKmxhc3QqICVjXG4gICAgICAvLyAodGhlIHVzZXIgbWF5IGhhdmUgcHJvdmlkZWQgdGhlaXIgb3duKVxuICAgICAgbGFzdEMgPSBpbmRleDtcbiAgICB9XG4gIH0pO1xuXG4gIGFyZ3Muc3BsaWNlKGxhc3RDLCAwLCBjKTtcbiAgcmV0dXJuIGFyZ3M7XG59XG5cbi8qKlxuICogSW52b2tlcyBgY29uc29sZS5sb2coKWAgd2hlbiBhdmFpbGFibGUuXG4gKiBOby1vcCB3aGVuIGBjb25zb2xlLmxvZ2AgaXMgbm90IGEgXCJmdW5jdGlvblwiLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gbG9nKCkge1xuICAvLyB0aGlzIGhhY2tlcnkgaXMgcmVxdWlyZWQgZm9yIElFOC85LCB3aGVyZVxuICAvLyB0aGUgYGNvbnNvbGUubG9nYCBmdW5jdGlvbiBkb2Vzbid0IGhhdmUgJ2FwcGx5J1xuICByZXR1cm4gJ29iamVjdCcgPT09IHR5cGVvZiBjb25zb2xlXG4gICAgJiYgY29uc29sZS5sb2dcbiAgICAmJiBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkuY2FsbChjb25zb2xlLmxvZywgY29uc29sZSwgYXJndW1lbnRzKTtcbn1cblxuLyoqXG4gKiBTYXZlIGBuYW1lc3BhY2VzYC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlc1xuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gc2F2ZShuYW1lc3BhY2VzKSB7XG4gIHRyeSB7XG4gICAgaWYgKG51bGwgPT0gbmFtZXNwYWNlcykge1xuICAgICAgZXhwb3J0cy5zdG9yYWdlLnJlbW92ZUl0ZW0oJ2RlYnVnJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4cG9ydHMuc3RvcmFnZS5kZWJ1ZyA9IG5hbWVzcGFjZXM7XG4gICAgfVxuICB9IGNhdGNoKGUpIHt9XG59XG5cbi8qKlxuICogTG9hZCBgbmFtZXNwYWNlc2AuXG4gKlxuICogQHJldHVybiB7U3RyaW5nfSByZXR1cm5zIHRoZSBwcmV2aW91c2x5IHBlcnNpc3RlZCBkZWJ1ZyBtb2Rlc1xuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gbG9hZCgpIHtcbiAgdmFyIHI7XG4gIHRyeSB7XG4gICAgciA9IGV4cG9ydHMuc3RvcmFnZS5kZWJ1ZztcbiAgfSBjYXRjaChlKSB7fVxuICByZXR1cm4gcjtcbn1cblxuLyoqXG4gKiBFbmFibGUgbmFtZXNwYWNlcyBsaXN0ZWQgaW4gYGxvY2FsU3RvcmFnZS5kZWJ1Z2AgaW5pdGlhbGx5LlxuICovXG5cbmV4cG9ydHMuZW5hYmxlKGxvYWQoKSk7XG5cbi8qKlxuICogTG9jYWxzdG9yYWdlIGF0dGVtcHRzIHRvIHJldHVybiB0aGUgbG9jYWxzdG9yYWdlLlxuICpcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugc2FmYXJpIHRocm93c1xuICogd2hlbiBhIHVzZXIgZGlzYWJsZXMgY29va2llcy9sb2NhbHN0b3JhZ2VcbiAqIGFuZCB5b3UgYXR0ZW1wdCB0byBhY2Nlc3MgaXQuXG4gKlxuICogQHJldHVybiB7TG9jYWxTdG9yYWdlfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gbG9jYWxzdG9yYWdlKCl7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2U7XG4gIH0gY2F0Y2ggKGUpIHt9XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vZGVidWcvYnJvd3Nlci5qc1xuLy8gbW9kdWxlIGlkID0gN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKGFycikge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFycikgPT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vaXNhcnJheS9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gOFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L25vZGUtbGlicy1icm93c2VyL34vcHJvY2Vzcy9icm93c2VyLmpzXG4vLyBtb2R1bGUgaWQgPSA5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImV4cG9ydCBjb25zdCBCRUFUX1dBUk1VUF9PRkZTRVQgPSAyNTtcbmV4cG9ydCBjb25zdCBCRUFUX1dBUk1VUF9TUEVFRCA9IDE1NTtcbmV4cG9ydCBjb25zdCBCRUFUX1dBUk1VUF9USU1FID0gKEJFQVRfV0FSTVVQX09GRlNFVCAvIEJFQVRfV0FSTVVQX1NQRUVEKSAqIDEwMDA7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29uc3RhbnRzL2JlYXQuanMiLCIvLyBGb3IgYXV4IHVzZS5cbnZhciB1dnMgPSBbXG4gIG5ldyBUSFJFRS5WZWN0b3IyKCksXG4gIG5ldyBUSFJFRS5WZWN0b3IyKCksXG4gIG5ldyBUSFJFRS5WZWN0b3IyKCksXG4gIG5ldyBUSFJFRS5WZWN0b3IyKClcbl07XG5cbi8qKlxuICogMS1pbmRleGVkLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2F0bGFzLXV2cycsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2dlb21ldHJ5J10sXG5cbiAgc2NoZW1hOiB7XG4gICAgdG90YWxDb2x1bW5zOiB7dHlwZTogJ2ludCcsIGRlZmF1bHQ6IDF9LFxuICAgIHRvdGFsUm93czoge3R5cGU6ICdpbnQnLCBkZWZhdWx0OiAxfSxcbiAgICBjb2x1bW46IHt0eXBlOiAnaW50JywgZGVmYXVsdDogMX0sXG4gICAgcm93OiB7dHlwZTogJ2ludCcsIGRlZmF1bHQ6IDF9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBjb25zdCB1dnMgPSBnZXRHcmlkVXZzKGRhdGEucm93IC0gMSwgZGF0YS5jb2x1bW4gLSAxLCBkYXRhLnRvdGFsUm93cywgZGF0YS50b3RhbENvbHVtbnMpO1xuXG4gICAgY29uc3QgZ2VvbWV0cnkgPSB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJykuZ2VvbWV0cnk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVswXVswXS5jb3B5KHV2c1swXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVswXVsxXS5jb3B5KHV2c1sxXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVswXVsyXS5jb3B5KHV2c1szXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVsxXVswXS5jb3B5KHV2c1sxXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVsxXVsxXS5jb3B5KHV2c1syXSk7XG4gICAgZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXVsxXVsyXS5jb3B5KHV2c1szXSk7XG4gICAgZ2VvbWV0cnkudXZzTmVlZFVwZGF0ZSA9IHRydWU7XG4gIH1cbn0pO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2R5bmFtaWMtdGV4dHVyZS1hdGxhcycsIHtcbiAgc2NoZW1hOiB7XG4gICAgY2FudmFzSWQ6IHtkZWZhdWx0OiAnZHluYW1pY0F0bGFzJ30sXG4gICAgY2FudmFzSGVpZ2h0OiB7ZGVmYXVsdDogMTAyNH0sXG4gICAgY2FudmFzV2lkdGg6IHtkZWZhdWx0OiAxMDI0fSxcbiAgICBkZWJ1Zzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBudW1Db2x1bW5zOiB7ZGVmYXVsdDogOH0sXG4gICAgbnVtUm93czoge2RlZmF1bHQ6IDh9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgY2FudmFzLmlkID0gdGhpcy5kYXRhLmNhbnZhc0lkO1xuICAgIGNhbnZhcy5oZWlnaHQgPSB0aGlzLmRhdGEuY2FudmFzSGVpZ2h0O1xuICAgIGNhbnZhcy53aWR0aCA9IHRoaXMuZGF0YS5jYW52YXNXaWR0aDtcbiAgICB0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FudmFzKTtcblxuICAgIGlmICh0aGlzLmRhdGEuZGVidWcpIHtcbiAgICAgIGNhbnZhcy5zdHlsZS5sZWZ0ID0gMDtcbiAgICAgIGNhbnZhcy5zdHlsZS50b3AgPSAwO1xuICAgICAgY2FudmFzLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICAgIGNhbnZhcy5zdHlsZS56SW5kZXggPSA5OTk5OTk5OTk5O1xuICAgIH1cbiAgfSxcblxuICBkcmF3VGV4dHVyZTogZnVuY3Rpb24gKGltYWdlLCByb3csIGNvbHVtbiwgd2lkdGgsIGhlaWdodCkge1xuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY2FudmFzO1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICBpZiAoIWltYWdlLmNvbXBsZXRlKSB7XG4gICAgICBpbWFnZS5vbmxvYWQgPSAoKSA9PiB7IHRoaXMuZHJhd1RleHR1cmUoaW1hZ2UsIHJvdywgY29sdW1uKTsgfVxuICAgIH1cblxuICAgIGNvbnN0IGdyaWRIZWlnaHQgPSBoZWlnaHQgfHwgKGNhbnZhcy5oZWlnaHQgLyBkYXRhLm51bVJvd3MpO1xuICAgIGNvbnN0IGdyaWRXaWR0aCA9IHdpZHRoIHx8IChjYW52YXMud2lkdGggLyBkYXRhLm51bUNvbHVtbnMpO1xuXG4gICAgLy8gaW1hZ2UsIGR4LCBkeSwgZHdpZHRoLCBkaGVpZ2h0XG4gICAgdGhpcy5jdHguZHJhd0ltYWdlKGltYWdlLCBncmlkV2lkdGggKiByb3csIGdyaWRXaWR0aCAqIGNvbHVtbiwgZ3JpZFdpZHRoLCBncmlkSGVpZ2h0KTtcblxuICAgIC8vIFJldHVybiBVVnMuXG4gICAgcmV0dXJuIGdldEdyaWRVdnMocm93LCBjb2x1bW4sIGRhdGEubnVtUm93cywgZGF0YS5udW1Db2x1bW5zKTtcbiAgfVxufSk7XG5cbi8qKlxuICogUmV0dXJuIFVWcyBmb3IgYW4gdGV4dHVyZSB3aXRoaW4gYW4gYXRsYXMsIGdpdmVuIHRoZSByb3cgYW5kIGNvbHVtbiBpbmZvLlxuICovXG5mdW5jdGlvbiBnZXRHcmlkVXZzIChyb3csIGNvbHVtbiwgdG90YWxSb3dzLCB0b3RhbENvbHVtbnMpIHtcbiAgY29uc3QgY29sdW1uV2lkdGggPSAxIC8gdG90YWxDb2x1bW5zO1xuICBjb25zdCByb3dIZWlnaHQgPSAxIC8gdG90YWxSb3dzO1xuXG4gIHV2c1swXS5zZXQoY29sdW1uV2lkdGggKiBjb2x1bW4sXG4gICAgICAgICAgICAgcm93SGVpZ2h0ICogcm93ICsgcm93SGVpZ2h0KTtcbiAgdXZzWzFdLnNldChjb2x1bW5XaWR0aCAqIGNvbHVtbixcbiAgICAgICAgICAgICByb3dIZWlnaHQgKiByb3cpO1xuICB1dnNbMl0uc2V0KGNvbHVtbldpZHRoICogY29sdW1uICsgY29sdW1uV2lkdGgsXG4gICAgICAgICAgICAgcm93SGVpZ2h0ICogcm93KTtcbiAgdXZzWzNdLnNldChjb2x1bW5XaWR0aCAqIGNvbHVtbiArIGNvbHVtbldpZHRoLFxuICAgICAgICAgICAgIHJvd0hlaWdodCAqIHJvdyArIHJvd0hlaWdodCk7XG4gIHJldHVybiB1dnM7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXRHcmlkVXZzID0gZ2V0R3JpZFV2cztcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtYXRsYXMtdXZzLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tL1xuICovXG5cblRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMgPSB7XG5cblx0Y29tcHV0ZVRhbmdlbnRzOiBmdW5jdGlvbiAoIGdlb21ldHJ5ICkge1xuXG5cdFx0dmFyIGluZGV4ID0gZ2VvbWV0cnkuaW5kZXg7XG5cdFx0dmFyIGF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuXG5cdFx0Ly8gYmFzZWQgb24gaHR0cDovL3d3dy50ZXJhdGhvbi5jb20vY29kZS90YW5nZW50Lmh0bWxcblx0XHQvLyAocGVyIHZlcnRleCB0YW5nZW50cylcblxuXHRcdGlmICggaW5kZXggPT09IG51bGwgfHxcblx0XHRcdCBhdHRyaWJ1dGVzLnBvc2l0aW9uID09PSB1bmRlZmluZWQgfHxcblx0XHRcdCBhdHRyaWJ1dGVzLm5vcm1hbCA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHQgYXR0cmlidXRlcy51diA9PT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5CdWZmZXJHZW9tZXRyeTogTWlzc2luZyByZXF1aXJlZCBhdHRyaWJ1dGVzIChpbmRleCwgcG9zaXRpb24sIG5vcm1hbCBvciB1dikgaW4gQnVmZmVyR2VvbWV0cnkuY29tcHV0ZVRhbmdlbnRzKCknICk7XG5cdFx0XHRyZXR1cm47XG5cblx0XHR9XG5cblx0XHR2YXIgaW5kaWNlcyA9IGluZGV4LmFycmF5O1xuXHRcdHZhciBwb3NpdGlvbnMgPSBhdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5O1xuXHRcdHZhciBub3JtYWxzID0gYXR0cmlidXRlcy5ub3JtYWwuYXJyYXk7XG5cdFx0dmFyIHV2cyA9IGF0dHJpYnV0ZXMudXYuYXJyYXk7XG5cblx0XHR2YXIgblZlcnRpY2VzID0gcG9zaXRpb25zLmxlbmd0aCAvIDM7XG5cblx0XHRpZiAoIGF0dHJpYnV0ZXMudGFuZ2VudCA9PT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICd0YW5nZW50JywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggbmV3IEZsb2F0MzJBcnJheSggNCAqIG5WZXJ0aWNlcyApLCA0ICkgKTtcblxuXHRcdH1cblxuXHRcdHZhciB0YW5nZW50cyA9IGF0dHJpYnV0ZXMudGFuZ2VudC5hcnJheTtcblxuXHRcdHZhciB0YW4xID0gW10sIHRhbjIgPSBbXTtcblxuXHRcdGZvciAoIHZhciBrID0gMDsgayA8IG5WZXJ0aWNlczsgayArKyApIHtcblxuXHRcdFx0dGFuMVsgayBdID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0XHRcdHRhbjJbIGsgXSA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHR9XG5cblx0XHR2YXIgdkEgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dkIgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dkMgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXG5cdFx0XHR1dkEgPSBuZXcgVEhSRUUuVmVjdG9yMigpLFxuXHRcdFx0dXZCID0gbmV3IFRIUkVFLlZlY3RvcjIoKSxcblx0XHRcdHV2QyA9IG5ldyBUSFJFRS5WZWN0b3IyKCksXG5cblx0XHRcdHNkaXIgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRcdFx0dGRpciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0XHRmdW5jdGlvbiBoYW5kbGVUcmlhbmdsZSggYSwgYiwgYyApIHtcblxuXHRcdFx0dkEuZnJvbUFycmF5KCBwb3NpdGlvbnMsIGEgKiAzICk7XG5cdFx0XHR2Qi5mcm9tQXJyYXkoIHBvc2l0aW9ucywgYiAqIDMgKTtcblx0XHRcdHZDLmZyb21BcnJheSggcG9zaXRpb25zLCBjICogMyApO1xuXG5cdFx0XHR1dkEuZnJvbUFycmF5KCB1dnMsIGEgKiAyICk7XG5cdFx0XHR1dkIuZnJvbUFycmF5KCB1dnMsIGIgKiAyICk7XG5cdFx0XHR1dkMuZnJvbUFycmF5KCB1dnMsIGMgKiAyICk7XG5cblx0XHRcdHZhciB4MSA9IHZCLnggLSB2QS54O1xuXHRcdFx0dmFyIHgyID0gdkMueCAtIHZBLng7XG5cblx0XHRcdHZhciB5MSA9IHZCLnkgLSB2QS55O1xuXHRcdFx0dmFyIHkyID0gdkMueSAtIHZBLnk7XG5cblx0XHRcdHZhciB6MSA9IHZCLnogLSB2QS56O1xuXHRcdFx0dmFyIHoyID0gdkMueiAtIHZBLno7XG5cblx0XHRcdHZhciBzMSA9IHV2Qi54IC0gdXZBLng7XG5cdFx0XHR2YXIgczIgPSB1dkMueCAtIHV2QS54O1xuXG5cdFx0XHR2YXIgdDEgPSB1dkIueSAtIHV2QS55O1xuXHRcdFx0dmFyIHQyID0gdXZDLnkgLSB1dkEueTtcblxuXHRcdFx0dmFyIHIgPSAxLjAgLyAoIHMxICogdDIgLSBzMiAqIHQxICk7XG5cblx0XHRcdHNkaXIuc2V0KFxuXHRcdFx0XHQoIHQyICogeDEgLSB0MSAqIHgyICkgKiByLFxuXHRcdFx0XHQoIHQyICogeTEgLSB0MSAqIHkyICkgKiByLFxuXHRcdFx0XHQoIHQyICogejEgLSB0MSAqIHoyICkgKiByXG5cdFx0XHQpO1xuXG5cdFx0XHR0ZGlyLnNldChcblx0XHRcdFx0KCBzMSAqIHgyIC0gczIgKiB4MSApICogcixcblx0XHRcdFx0KCBzMSAqIHkyIC0gczIgKiB5MSApICogcixcblx0XHRcdFx0KCBzMSAqIHoyIC0gczIgKiB6MSApICogclxuXHRcdFx0KTtcblxuXHRcdFx0dGFuMVsgYSBdLmFkZCggc2RpciApO1xuXHRcdFx0dGFuMVsgYiBdLmFkZCggc2RpciApO1xuXHRcdFx0dGFuMVsgYyBdLmFkZCggc2RpciApO1xuXG5cdFx0XHR0YW4yWyBhIF0uYWRkKCB0ZGlyICk7XG5cdFx0XHR0YW4yWyBiIF0uYWRkKCB0ZGlyICk7XG5cdFx0XHR0YW4yWyBjIF0uYWRkKCB0ZGlyICk7XG5cblx0XHR9XG5cblx0XHR2YXIgZ3JvdXBzID0gZ2VvbWV0cnkuZ3JvdXBzO1xuXG5cdFx0aWYgKCBncm91cHMubGVuZ3RoID09PSAwICkge1xuXG5cdFx0XHRncm91cHMgPSBbIHtcblx0XHRcdFx0c3RhcnQ6IDAsXG5cdFx0XHRcdGNvdW50OiBpbmRpY2VzLmxlbmd0aFxuXHRcdFx0fSBdO1xuXG5cdFx0fVxuXG5cdFx0Zm9yICggdmFyIGogPSAwLCBqbCA9IGdyb3Vwcy5sZW5ndGg7IGogPCBqbDsgKysgaiApIHtcblxuXHRcdFx0dmFyIGdyb3VwID0gZ3JvdXBzWyBqIF07XG5cblx0XHRcdHZhciBzdGFydCA9IGdyb3VwLnN0YXJ0O1xuXHRcdFx0dmFyIGNvdW50ID0gZ3JvdXAuY291bnQ7XG5cblx0XHRcdGZvciAoIHZhciBpID0gc3RhcnQsIGlsID0gc3RhcnQgKyBjb3VudDsgaSA8IGlsOyBpICs9IDMgKSB7XG5cblx0XHRcdFx0aGFuZGxlVHJpYW5nbGUoXG5cdFx0XHRcdFx0aW5kaWNlc1sgaSArIDAgXSxcblx0XHRcdFx0XHRpbmRpY2VzWyBpICsgMSBdLFxuXHRcdFx0XHRcdGluZGljZXNbIGkgKyAyIF1cblx0XHRcdFx0KTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0dmFyIHRtcCA9IG5ldyBUSFJFRS5WZWN0b3IzKCksIHRtcDIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdHZhciBuID0gbmV3IFRIUkVFLlZlY3RvcjMoKSwgbjIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdHZhciB3LCB0LCB0ZXN0O1xuXG5cdFx0ZnVuY3Rpb24gaGFuZGxlVmVydGV4KCB2ICkge1xuXG5cdFx0XHRuLmZyb21BcnJheSggbm9ybWFscywgdiAqIDMgKTtcblx0XHRcdG4yLmNvcHkoIG4gKTtcblxuXHRcdFx0dCA9IHRhbjFbIHYgXTtcblxuXHRcdFx0Ly8gR3JhbS1TY2htaWR0IG9ydGhvZ29uYWxpemVcblxuXHRcdFx0dG1wLmNvcHkoIHQgKTtcblx0XHRcdHRtcC5zdWIoIG4ubXVsdGlwbHlTY2FsYXIoIG4uZG90KCB0ICkgKSApLm5vcm1hbGl6ZSgpO1xuXG5cdFx0XHQvLyBDYWxjdWxhdGUgaGFuZGVkbmVzc1xuXG5cdFx0XHR0bXAyLmNyb3NzVmVjdG9ycyggbjIsIHQgKTtcblx0XHRcdHRlc3QgPSB0bXAyLmRvdCggdGFuMlsgdiBdICk7XG5cdFx0XHR3ID0gKCB0ZXN0IDwgMC4wICkgPyAtIDEuMCA6IDEuMDtcblxuXHRcdFx0dGFuZ2VudHNbIHYgKiA0IF0gPSB0bXAueDtcblx0XHRcdHRhbmdlbnRzWyB2ICogNCArIDEgXSA9IHRtcC55O1xuXHRcdFx0dGFuZ2VudHNbIHYgKiA0ICsgMiBdID0gdG1wLno7XG5cdFx0XHR0YW5nZW50c1sgdiAqIDQgKyAzIF0gPSB3O1xuXG5cdFx0fVxuXG5cdFx0Zm9yICggdmFyIGogPSAwLCBqbCA9IGdyb3Vwcy5sZW5ndGg7IGogPCBqbDsgKysgaiApIHtcblxuXHRcdFx0dmFyIGdyb3VwID0gZ3JvdXBzWyBqIF07XG5cblx0XHRcdHZhciBzdGFydCA9IGdyb3VwLnN0YXJ0O1xuXHRcdFx0dmFyIGNvdW50ID0gZ3JvdXAuY291bnQ7XG5cblx0XHRcdGZvciAoIHZhciBpID0gc3RhcnQsIGlsID0gc3RhcnQgKyBjb3VudDsgaSA8IGlsOyBpICs9IDMgKSB7XG5cblx0XHRcdFx0aGFuZGxlVmVydGV4KCBpbmRpY2VzWyBpICsgMCBdICk7XG5cdFx0XHRcdGhhbmRsZVZlcnRleCggaW5kaWNlc1sgaSArIDEgXSApO1xuXHRcdFx0XHRoYW5kbGVWZXJ0ZXgoIGluZGljZXNbIGkgKyAyIF0gKTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdH0sXG5cblx0LyoqXG5cdCAqIEBwYXJhbSAge0FycmF5PFRIUkVFLkJ1ZmZlckdlb21ldHJ5Pn0gZ2VvbWV0cmllc1xuXHQgKiBAcmV0dXJuIHtUSFJFRS5CdWZmZXJHZW9tZXRyeX1cblx0ICovXG5cdG1lcmdlQnVmZmVyR2VvbWV0cmllczogZnVuY3Rpb24gKCBnZW9tZXRyaWVzLCB1c2VHcm91cHMgKSB7XG5cblx0XHR2YXIgaXNJbmRleGVkID0gZ2VvbWV0cmllc1sgMCBdLmluZGV4ICE9PSBudWxsO1xuXG5cdFx0dmFyIGF0dHJpYnV0ZXNVc2VkID0gbmV3IFNldCggT2JqZWN0LmtleXMoIGdlb21ldHJpZXNbIDAgXS5hdHRyaWJ1dGVzICkgKTtcblx0XHR2YXIgbW9ycGhBdHRyaWJ1dGVzVXNlZCA9IG5ldyBTZXQoIE9iamVjdC5rZXlzKCBnZW9tZXRyaWVzWyAwIF0ubW9ycGhBdHRyaWJ1dGVzICkgKTtcblxuXHRcdHZhciBhdHRyaWJ1dGVzID0ge307XG5cdFx0dmFyIG1vcnBoQXR0cmlidXRlcyA9IHt9O1xuXG5cdFx0dmFyIG1lcmdlZEdlb21ldHJ5ID0gbmV3IFRIUkVFLkJ1ZmZlckdlb21ldHJ5KCk7XG5cblx0XHR2YXIgb2Zmc2V0ID0gMDtcblxuXHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGdlb21ldHJpZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHR2YXIgZ2VvbWV0cnkgPSBnZW9tZXRyaWVzWyBpIF07XG5cblx0XHRcdC8vIGVuc3VyZSB0aGF0IGFsbCBnZW9tZXRyaWVzIGFyZSBpbmRleGVkLCBvciBub25lXG5cblx0XHRcdGlmICggaXNJbmRleGVkICE9PSAoIGdlb21ldHJ5LmluZGV4ICE9PSBudWxsICkgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0Ly8gZ2F0aGVyIGF0dHJpYnV0ZXMsIGV4aXQgZWFybHkgaWYgdGhleSdyZSBkaWZmZXJlbnRcblxuXHRcdFx0Zm9yICggdmFyIG5hbWUgaW4gZ2VvbWV0cnkuYXR0cmlidXRlcyApIHtcblxuXHRcdFx0XHRpZiAoICFhdHRyaWJ1dGVzVXNlZC5oYXMoIG5hbWUgKSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRcdGlmICggYXR0cmlidXRlc1sgbmFtZSBdID09PSB1bmRlZmluZWQgKSBhdHRyaWJ1dGVzWyBuYW1lIF0gPSBbXTtcblxuXHRcdFx0XHRhdHRyaWJ1dGVzWyBuYW1lIF0ucHVzaCggZ2VvbWV0cnkuYXR0cmlidXRlc1sgbmFtZSBdICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gZ2F0aGVyIG1vcnBoIGF0dHJpYnV0ZXMsIGV4aXQgZWFybHkgaWYgdGhleSdyZSBkaWZmZXJlbnRcblxuXHRcdFx0Zm9yICggdmFyIG5hbWUgaW4gZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzICkge1xuXG5cdFx0XHRcdGlmICggIW1vcnBoQXR0cmlidXRlc1VzZWQuaGFzKCBuYW1lICkgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0XHRpZiAoIG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdID09PSB1bmRlZmluZWQgKSBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXSA9IFtdO1xuXG5cdFx0XHRcdG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdLnB1c2goIGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1sgbmFtZSBdICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gZ2F0aGVyIC51c2VyRGF0YVxuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS51c2VyRGF0YS5tZXJnZWRVc2VyRGF0YSA9IG1lcmdlZEdlb21ldHJ5LnVzZXJEYXRhLm1lcmdlZFVzZXJEYXRhIHx8IFtdO1xuXHRcdFx0bWVyZ2VkR2VvbWV0cnkudXNlckRhdGEubWVyZ2VkVXNlckRhdGEucHVzaCggZ2VvbWV0cnkudXNlckRhdGEgKTtcblxuXHRcdFx0aWYgKCB1c2VHcm91cHMgKSB7XG5cblx0XHRcdFx0dmFyIGNvdW50O1xuXG5cdFx0XHRcdGlmICggaXNJbmRleGVkICkge1xuXG5cdFx0XHRcdFx0Y291bnQgPSBnZW9tZXRyeS5pbmRleC5jb3VudDtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKCBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uICE9PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdFx0XHRjb3VudCA9IGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uY291bnQ7XG5cblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRtZXJnZWRHZW9tZXRyeS5hZGRHcm91cCggb2Zmc2V0LCBjb3VudCwgaSApO1xuXG5cdFx0XHRcdG9mZnNldCArPSBjb3VudDtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgaW5kaWNlc1xuXG5cdFx0aWYgKCBpc0luZGV4ZWQgKSB7XG5cblx0XHRcdHZhciBpbmRleE9mZnNldCA9IDA7XG5cdFx0XHR2YXIgaW5kZXhMaXN0ID0gW107XG5cblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGdlb21ldHJpZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHRcdHZhciBpbmRleCA9IGdlb21ldHJpZXNbIGkgXS5pbmRleDtcblxuXHRcdFx0XHRpZiAoIGluZGV4T2Zmc2V0ID4gMCApIHtcblxuXHRcdFx0XHRcdGluZGV4ID0gaW5kZXguY2xvbmUoKTtcblxuXHRcdFx0XHRcdGZvciAoIHZhciBqID0gMDsgaiA8IGluZGV4LmNvdW50OyArKyBqICkge1xuXG5cdFx0XHRcdFx0XHRpbmRleC5zZXRYKCBqLCBpbmRleC5nZXRYKCBqICkgKyBpbmRleE9mZnNldCApO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpbmRleExpc3QucHVzaCggaW5kZXggKTtcblx0XHRcdFx0aW5kZXhPZmZzZXQgKz0gZ2VvbWV0cmllc1sgaSBdLmF0dHJpYnV0ZXMucG9zaXRpb24uY291bnQ7XG5cblx0XHRcdH1cblxuXHRcdFx0dmFyIG1lcmdlZEluZGV4ID0gdGhpcy5tZXJnZUJ1ZmZlckF0dHJpYnV0ZXMoIGluZGV4TGlzdCApO1xuXG5cdFx0XHRpZiAoICFtZXJnZWRJbmRleCApIHJldHVybiBudWxsO1xuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS5pbmRleCA9IG1lcmdlZEluZGV4O1xuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgYXR0cmlidXRlc1xuXG5cdFx0Zm9yICggdmFyIG5hbWUgaW4gYXR0cmlidXRlcyApIHtcblxuXHRcdFx0dmFyIG1lcmdlZEF0dHJpYnV0ZSA9IHRoaXMubWVyZ2VCdWZmZXJBdHRyaWJ1dGVzKCBhdHRyaWJ1dGVzWyBuYW1lIF0gKTtcblxuXHRcdFx0aWYgKCAhIG1lcmdlZEF0dHJpYnV0ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS5hZGRBdHRyaWJ1dGUoIG5hbWUsIG1lcmdlZEF0dHJpYnV0ZSApO1xuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgbW9ycGggYXR0cmlidXRlc1xuXG5cdFx0Zm9yICggdmFyIG5hbWUgaW4gbW9ycGhBdHRyaWJ1dGVzICkge1xuXG5cdFx0XHR2YXIgbnVtTW9ycGhUYXJnZXRzID0gbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF1bIDAgXS5sZW5ndGg7XG5cblx0XHRcdGlmICggbnVtTW9ycGhUYXJnZXRzID09PSAwICkgYnJlYWs7XG5cblx0XHRcdG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcyA9IG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcyB8fCB7fTtcblx0XHRcdG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1sgbmFtZSBdID0gW107XG5cblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IG51bU1vcnBoVGFyZ2V0czsgKysgaSApIHtcblxuXHRcdFx0XHR2YXIgbW9ycGhBdHRyaWJ1dGVzVG9NZXJnZSA9IFtdO1xuXG5cdFx0XHRcdGZvciAoIHZhciBqID0gMDsgaiA8IG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdLmxlbmd0aDsgKysgaiApIHtcblxuXHRcdFx0XHRcdG1vcnBoQXR0cmlidXRlc1RvTWVyZ2UucHVzaCggbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF1bIGogXVsgaSBdICk7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBtZXJnZWRNb3JwaEF0dHJpYnV0ZSA9IHRoaXMubWVyZ2VCdWZmZXJBdHRyaWJ1dGVzKCBtb3JwaEF0dHJpYnV0ZXNUb01lcmdlICk7XG5cblx0XHRcdFx0aWYgKCAhbWVyZ2VkTW9ycGhBdHRyaWJ1dGUgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0XHRtZXJnZWRHZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXS5wdXNoKCBtZXJnZWRNb3JwaEF0dHJpYnV0ZSApO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gbWVyZ2VkR2VvbWV0cnk7XG5cblx0fSxcblxuXHQvKipcblx0ICogQHBhcmFtIHtBcnJheTxUSFJFRS5CdWZmZXJBdHRyaWJ1dGU+fSBhdHRyaWJ1dGVzXG5cdCAqIEByZXR1cm4ge1RIUkVFLkJ1ZmZlckF0dHJpYnV0ZX1cblx0ICovXG5cdG1lcmdlQnVmZmVyQXR0cmlidXRlczogZnVuY3Rpb24gKCBhdHRyaWJ1dGVzICkge1xuXG5cdFx0dmFyIFR5cGVkQXJyYXk7XG5cdFx0dmFyIGl0ZW1TaXplO1xuXHRcdHZhciBub3JtYWxpemVkO1xuXHRcdHZhciBhcnJheUxlbmd0aCA9IDA7XG5cblx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgKysgaSApIHtcblxuXHRcdFx0dmFyIGF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbIGkgXTtcblxuXHRcdFx0aWYgKCBhdHRyaWJ1dGUuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIFR5cGVkQXJyYXkgPT09IHVuZGVmaW5lZCApIFR5cGVkQXJyYXkgPSBhdHRyaWJ1dGUuYXJyYXkuY29uc3RydWN0b3I7XG5cdFx0XHRpZiAoIFR5cGVkQXJyYXkgIT09IGF0dHJpYnV0ZS5hcnJheS5jb25zdHJ1Y3RvciApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIGl0ZW1TaXplID09PSB1bmRlZmluZWQgKSBpdGVtU2l6ZSA9IGF0dHJpYnV0ZS5pdGVtU2l6ZTtcblx0XHRcdGlmICggaXRlbVNpemUgIT09IGF0dHJpYnV0ZS5pdGVtU2l6ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRpZiAoIG5vcm1hbGl6ZWQgPT09IHVuZGVmaW5lZCApIG5vcm1hbGl6ZWQgPSBhdHRyaWJ1dGUubm9ybWFsaXplZDtcblx0XHRcdGlmICggbm9ybWFsaXplZCAhPT0gYXR0cmlidXRlLm5vcm1hbGl6ZWQgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0YXJyYXlMZW5ndGggKz0gYXR0cmlidXRlLmFycmF5Lmxlbmd0aDtcblxuXHRcdH1cblxuXHRcdHZhciBhcnJheSA9IG5ldyBUeXBlZEFycmF5KCBhcnJheUxlbmd0aCApO1xuXHRcdHZhciBvZmZzZXQgPSAwO1xuXG5cdFx0Zm9yICggdmFyIGogPSAwOyBqIDwgYXR0cmlidXRlcy5sZW5ndGg7ICsrIGogKSB7XG5cblx0XHRcdGFycmF5LnNldCggYXR0cmlidXRlc1sgaiBdLmFycmF5LCBvZmZzZXQgKTtcblxuXHRcdFx0b2Zmc2V0ICs9IGF0dHJpYnV0ZXNbIGogXS5hcnJheS5sZW5ndGg7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYXJyYXksIGl0ZW1TaXplLCBub3JtYWxpemVkICk7XG5cblx0fVxuXG59O1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vdmVuZG9yL0J1ZmZlckdlb21ldHJ5VXRpbHMuanMiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgnQGZpcmViYXNlL3V0aWwnKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBjb250YWlucyA9IGZ1bmN0aW9uIChvYmosIGtleSkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7XHJcbn07XHJcbnZhciBERUZBVUxUX0VOVFJZX05BTUUgPSAnW0RFRkFVTFRdJztcclxuLy8gQW4gYXJyYXkgdG8gY2FwdHVyZSBsaXN0ZW5lcnMgYmVmb3JlIHRoZSB0cnVlIGF1dGggZnVuY3Rpb25zXHJcbi8vIGV4aXN0XHJcbnZhciB0b2tlbkxpc3RlbmVycyA9IFtdO1xyXG4vKipcclxuICogR2xvYmFsIGNvbnRleHQgb2JqZWN0IGZvciBhIGNvbGxlY3Rpb24gb2Ygc2VydmljZXMgdXNpbmdcclxuICogYSBzaGFyZWQgYXV0aGVudGljYXRpb24gc3RhdGUuXHJcbiAqL1xyXG52YXIgRmlyZWJhc2VBcHBJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZWJhc2VBcHBJbXBsKG9wdGlvbnMsIGNvbmZpZywgZmlyZWJhc2VfKSB7XHJcbiAgICAgICAgdGhpcy5maXJlYmFzZV8gPSBmaXJlYmFzZV87XHJcbiAgICAgICAgdGhpcy5pc0RlbGV0ZWRfID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlc18gPSB7fTtcclxuICAgICAgICB0aGlzLm5hbWVfID0gY29uZmlnLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID1cclxuICAgICAgICAgICAgY29uZmlnLmF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLm9wdGlvbnNfID0gdXRpbC5kZWVwQ29weShvcHRpb25zKTtcclxuICAgICAgICB0aGlzLklOVEVSTkFMID0ge1xyXG4gICAgICAgICAgICBnZXRVaWQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG51bGw7IH0sXHJcbiAgICAgICAgICAgIGdldFRva2VuOiBmdW5jdGlvbiAoKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7IH0sXHJcbiAgICAgICAgICAgIGFkZEF1dGhUb2tlbkxpc3RlbmVyOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRva2VuTGlzdGVuZXJzLnB1c2goY2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIGNhbGxiYWNrIGlzIGNhbGxlZCwgYXN5bmNocm9ub3VzbHksIGluIHRoZSBhYnNlbmNlIG9mIHRoZSBhdXRoIG1vZHVsZVxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBjYWxsYmFjayhudWxsKTsgfSwgMCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRva2VuTGlzdGVuZXJzID0gdG9rZW5MaXN0ZW5lcnMuZmlsdGVyKGZ1bmN0aW9uIChsaXN0ZW5lcikgeyByZXR1cm4gbGlzdGVuZXIgIT09IGNhbGxiYWNrOyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZSwgXCJhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkXygpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9IHZhbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLCBcIm5hbWVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkXygpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYW1lXztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLCBcIm9wdGlvbnNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkXygpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zXztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmNoZWNrRGVzdHJveWVkXygpO1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5maXJlYmFzZV8uSU5URVJOQUwucmVtb3ZlQXBwKF90aGlzLm5hbWVfKTtcclxuICAgICAgICAgICAgdmFyIHNlcnZpY2VzID0gW107XHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKF90aGlzLnNlcnZpY2VzXykuZm9yRWFjaChmdW5jdGlvbiAoc2VydmljZUtleSkge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoX3RoaXMuc2VydmljZXNfW3NlcnZpY2VLZXldKS5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0YW5jZUtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlcnZpY2VzLnB1c2goX3RoaXMuc2VydmljZXNfW3NlcnZpY2VLZXldW2luc3RhbmNlS2V5XSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChzZXJ2aWNlcy5tYXAoZnVuY3Rpb24gKHNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLklOVEVSTkFMLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5pc0RlbGV0ZWRfID0gdHJ1ZTtcclxuICAgICAgICAgICAgX3RoaXMuc2VydmljZXNfID0ge307XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYSBzZXJ2aWNlIGluc3RhbmNlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGFwcCAoY3JlYXRpbmcgaXRcclxuICAgICAqIG9uIGRlbWFuZCksIGlkZW50aWZpZWQgYnkgdGhlIHBhc3NlZCBpbnN0YW5jZUlkZW50aWZpZXIuXHJcbiAgICAgKlxyXG4gICAgICogTk9URTogQ3VycmVudGx5IHN0b3JhZ2UgaXMgdGhlIG9ubHkgb25lIHRoYXQgaXMgbGV2ZXJhZ2luZyB0aGlzXHJcbiAgICAgKiBmdW5jdGlvbmFsaXR5LiBUaGV5IGludm9rZSBpdCBieSBjYWxsaW5nOlxyXG4gICAgICpcclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIGZpcmViYXNlLmFwcCgpLnN0b3JhZ2UoJ1NUT1JBR0UgQlVDS0VUIElEJylcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIFRoZSBzZXJ2aWNlIG5hbWUgaXMgcGFzc2VkIHRvIHRoaXMgYWxyZWFkeVxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUuX2dldFNlcnZpY2UgPSBmdW5jdGlvbiAobmFtZSwgaW5zdGFuY2VJZGVudGlmaWVyKSB7XHJcbiAgICAgICAgaWYgKGluc3RhbmNlSWRlbnRpZmllciA9PT0gdm9pZCAwKSB7IGluc3RhbmNlSWRlbnRpZmllciA9IERFRkFVTFRfRU5UUllfTkFNRTsgfVxyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWRfKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNlcnZpY2VzX1tuYW1lXSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VzX1tuYW1lXSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuc2VydmljZXNfW25hbWVdW2luc3RhbmNlSWRlbnRpZmllcl0pIHtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIElmIGEgY3VzdG9tIGluc3RhbmNlIGhhcyBiZWVuIGRlZmluZWQgKGkuZS4gbm90ICdbREVGQVVMVF0nKVxyXG4gICAgICAgICAgICAgKiB0aGVuIHdlIHdpbGwgcGFzcyB0aGF0IGluc3RhbmNlIG9uLCBvdGhlcndpc2Ugd2UgcGFzcyBgbnVsbGBcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHZhciBpbnN0YW5jZVNwZWNpZmllciA9IGluc3RhbmNlSWRlbnRpZmllciAhPT0gREVGQVVMVF9FTlRSWV9OQU1FXHJcbiAgICAgICAgICAgICAgICA/IGluc3RhbmNlSWRlbnRpZmllclxyXG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlID0gdGhpcy5maXJlYmFzZV8uSU5URVJOQUwuZmFjdG9yaWVzW25hbWVdKHRoaXMsIHRoaXMuZXh0ZW5kQXBwLmJpbmQodGhpcyksIGluc3RhbmNlU3BlY2lmaWVyKTtcclxuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlc19bbmFtZV1baW5zdGFuY2VJZGVudGlmaWVyXSA9IHNlcnZpY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnNlcnZpY2VzX1tuYW1lXVtpbnN0YW5jZUlkZW50aWZpZXJdO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gdXNlZCB0byBleHRlbmQgYW4gQXBwIGluc3RhbmNlIGF0IHRoZSB0aW1lXHJcbiAgICAgKiBvZiBzZXJ2aWNlIGluc3RhbmNlIGNyZWF0aW9uLlxyXG4gICAgICovXHJcbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLmV4dGVuZEFwcCA9IGZ1bmN0aW9uIChwcm9wcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gQ29weSB0aGUgb2JqZWN0IG9udG8gdGhlIEZpcmViYXNlQXBwSW1wbCBwcm90b3R5cGVcclxuICAgICAgICB1dGlsLmRlZXBFeHRlbmQodGhpcywgcHJvcHMpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIElmIHRoZSBhcHAgaGFzIG92ZXJ3cml0dGVuIHRoZSBhZGRBdXRoVG9rZW5MaXN0ZW5lciBzdHViLCBmb3J3YXJkXHJcbiAgICAgICAgICogdGhlIGFjdGl2ZSB0b2tlbiBsaXN0ZW5lcnMgb24gdG8gdGhlIHRydWUgZnhuLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogVE9ETzogVGhpcyBmdW5jdGlvbiBpcyByZXF1aXJlZCBkdWUgdG8gb3VyIGN1cnJlbnQgbW9kdWxlXHJcbiAgICAgICAgICogc3RydWN0dXJlLiBPbmNlIHdlIGFyZSBhYmxlIHRvIHJlbHkgc3RyaWN0bHkgdXBvbiBhIHNpbmdsZSBtb2R1bGVcclxuICAgICAgICAgKiBpbXBsZW1lbnRhdGlvbiwgdGhpcyBjb2RlIHNob3VsZCBiZSByZWZhY3RvcmVkIGFuZCBBdXRoIHNob3VsZFxyXG4gICAgICAgICAqIHByb3ZpZGUgdGhlc2Ugc3R1YnMgYW5kIHRoZSB1cGdyYWRlIGxvZ2ljXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaWYgKHByb3BzLklOVEVSTkFMICYmIHByb3BzLklOVEVSTkFMLmFkZEF1dGhUb2tlbkxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgIHRva2VuTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5JTlRFUk5BTC5hZGRBdXRoVG9rZW5MaXN0ZW5lcihsaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0b2tlbkxpc3RlbmVycyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgZnVuY3Rpb24gd2lsbCB0aHJvdyBhbiBFcnJvciBpZiB0aGUgQXBwIGhhcyBhbHJlYWR5IGJlZW4gZGVsZXRlZCAtXHJcbiAgICAgKiB1c2UgYmVmb3JlIHBlcmZvcm1pbmcgQVBJIGFjdGlvbnMgb24gdGhlIEFwcC5cclxuICAgICAqL1xyXG4gICAgRmlyZWJhc2VBcHBJbXBsLnByb3RvdHlwZS5jaGVja0Rlc3Ryb3llZF8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEZWxldGVkXykge1xyXG4gICAgICAgICAgICBlcnJvcignYXBwLWRlbGV0ZWQnLCB7IG5hbWU6IHRoaXMubmFtZV8gfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBGaXJlYmFzZUFwcEltcGw7XHJcbn0oKSk7XHJcbi8vIFByZXZlbnQgZGVhZC1jb2RlIGVsaW1pbmF0aW9uIG9mIHRoZXNlIG1ldGhvZHMgdy9vIGludmFsaWQgcHJvcGVydHlcclxuLy8gY29weWluZy5cclxuKEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGUubmFtZSAmJiBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLm9wdGlvbnMpIHx8XHJcbiAgICBGaXJlYmFzZUFwcEltcGwucHJvdG90eXBlLmRlbGV0ZSB8fFxyXG4gICAgY29uc29sZS5sb2coJ2RjJyk7XHJcbi8qKlxyXG4gKiBSZXR1cm4gYSBmaXJlYmFzZSBuYW1lc3BhY2Ugb2JqZWN0LlxyXG4gKlxyXG4gKiBJbiBwcm9kdWN0aW9uLCB0aGlzIHdpbGwgYmUgY2FsbGVkIGV4YWN0bHkgb25jZSBhbmQgdGhlIHJlc3VsdFxyXG4gKiBhc3NpZ25lZCB0byB0aGUgJ2ZpcmViYXNlJyBnbG9iYWwuICBJdCBtYXkgYmUgY2FsbGVkIG11bHRpcGxlIHRpbWVzXHJcbiAqIGluIHVuaXQgdGVzdHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVGaXJlYmFzZU5hbWVzcGFjZSgpIHtcclxuICAgIHZhciBhcHBzXyA9IHt9O1xyXG4gICAgdmFyIGZhY3RvcmllcyA9IHt9O1xyXG4gICAgdmFyIGFwcEhvb2tzID0ge307XHJcbiAgICAvLyBBIG5hbWVzcGFjZSBpcyBhIHBsYWluIEphdmFTY3JpcHQgT2JqZWN0LlxyXG4gICAgdmFyIG5hbWVzcGFjZSA9IHtcclxuICAgICAgICAvLyBIYWNrIHRvIHByZXZlbnQgQmFiZWwgZnJvbSBtb2RpZnlpbmcgdGhlIG9iamVjdCByZXR1cm5lZFxyXG4gICAgICAgIC8vIGFzIHRoZSBmaXJlYmFzZSBuYW1lc3BhY2UuXHJcbiAgICAgICAgX19lc01vZHVsZTogdHJ1ZSxcclxuICAgICAgICBpbml0aWFsaXplQXBwOiBpbml0aWFsaXplQXBwLFxyXG4gICAgICAgIGFwcDogYXBwLFxyXG4gICAgICAgIGFwcHM6IG51bGwsXHJcbiAgICAgICAgUHJvbWlzZTogUHJvbWlzZSxcclxuICAgICAgICBTREtfVkVSU0lPTjogJzUuNS4wJyxcclxuICAgICAgICBJTlRFUk5BTDoge1xyXG4gICAgICAgICAgICByZWdpc3RlclNlcnZpY2U6IHJlZ2lzdGVyU2VydmljZSxcclxuICAgICAgICAgICAgY3JlYXRlRmlyZWJhc2VOYW1lc3BhY2U6IGNyZWF0ZUZpcmViYXNlTmFtZXNwYWNlLFxyXG4gICAgICAgICAgICBleHRlbmROYW1lc3BhY2U6IGV4dGVuZE5hbWVzcGFjZSxcclxuICAgICAgICAgICAgY3JlYXRlU3Vic2NyaWJlOiB1dGlsLmNyZWF0ZVN1YnNjcmliZSxcclxuICAgICAgICAgICAgRXJyb3JGYWN0b3J5OiB1dGlsLkVycm9yRmFjdG9yeSxcclxuICAgICAgICAgICAgcmVtb3ZlQXBwOiByZW1vdmVBcHAsXHJcbiAgICAgICAgICAgIGZhY3RvcmllczogZmFjdG9yaWVzLFxyXG4gICAgICAgICAgICB1c2VBc1NlcnZpY2U6IHVzZUFzU2VydmljZSxcclxuICAgICAgICAgICAgUHJvbWlzZTogUHJvbWlzZSxcclxuICAgICAgICAgICAgZGVlcEV4dGVuZDogdXRpbC5kZWVwRXh0ZW5kXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIEluamVjdCBhIGNpcmN1bGFyIGRlZmF1bHQgZXhwb3J0IHRvIGFsbG93IEJhYmVsIHVzZXJzIHdobyB3ZXJlIHByZXZpb3VzbHlcclxuICAgIC8vIHVzaW5nOlxyXG4gICAgLy9cclxuICAgIC8vICAgaW1wb3J0IGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlJztcclxuICAgIC8vICAgd2hpY2ggYmVjb21lczogdmFyIGZpcmViYXNlID0gcmVxdWlyZSgnZmlyZWJhc2UnKS5kZWZhdWx0O1xyXG4gICAgLy9cclxuICAgIC8vIGluc3RlYWQgb2ZcclxuICAgIC8vXHJcbiAgICAvLyAgIGltcG9ydCAqIGFzIGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlJztcclxuICAgIC8vICAgd2hpY2ggYmVjb21lczogdmFyIGZpcmViYXNlID0gcmVxdWlyZSgnZmlyZWJhc2UnKTtcclxuICAgIHV0aWwucGF0Y2hQcm9wZXJ0eShuYW1lc3BhY2UsICdkZWZhdWx0JywgbmFtZXNwYWNlKTtcclxuICAgIC8vIGZpcmViYXNlLmFwcHMgaXMgYSByZWFkLW9ubHkgZ2V0dGVyLlxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5hbWVzcGFjZSwgJ2FwcHMnLCB7XHJcbiAgICAgICAgZ2V0OiBnZXRBcHBzXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIGJ5IEFwcC5kZWxldGUoKSAtIGJ1dCBiZWZvcmUgYW55IHNlcnZpY2VzIGFzc29jaWF0ZWQgd2l0aCB0aGUgQXBwXHJcbiAgICAgKiBhcmUgZGVsZXRlZC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gcmVtb3ZlQXBwKG5hbWUpIHtcclxuICAgICAgICB2YXIgYXBwID0gYXBwc19bbmFtZV07XHJcbiAgICAgICAgY2FsbEFwcEhvb2tzKGFwcCwgJ2RlbGV0ZScpO1xyXG4gICAgICAgIGRlbGV0ZSBhcHBzX1tuYW1lXTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBBcHAgb2JqZWN0IGZvciBhIGdpdmVuIG5hbWUgKG9yIERFRkFVTFQpLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBhcHAobmFtZSkge1xyXG4gICAgICAgIG5hbWUgPSBuYW1lIHx8IERFRkFVTFRfRU5UUllfTkFNRTtcclxuICAgICAgICBpZiAoIWNvbnRhaW5zKGFwcHNfLCBuYW1lKSkge1xyXG4gICAgICAgICAgICBlcnJvcignbm8tYXBwJywgeyBuYW1lOiBuYW1lIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXBwc19bbmFtZV07XHJcbiAgICB9XHJcbiAgICB1dGlsLnBhdGNoUHJvcGVydHkoYXBwLCAnQXBwJywgRmlyZWJhc2VBcHBJbXBsKTtcclxuICAgIGZ1bmN0aW9uIGluaXRpYWxpemVBcHAob3B0aW9ucywgcmF3Q29uZmlnKSB7XHJcbiAgICAgICAgaWYgKHJhd0NvbmZpZyA9PT0gdm9pZCAwKSB7IHJhd0NvbmZpZyA9IHt9OyB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiByYXdDb25maWcgIT09ICdvYmplY3QnIHx8IHJhd0NvbmZpZyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZV8xID0gcmF3Q29uZmlnO1xyXG4gICAgICAgICAgICByYXdDb25maWcgPSB7IG5hbWU6IG5hbWVfMSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY29uZmlnID0gcmF3Q29uZmlnO1xyXG4gICAgICAgIGlmIChjb25maWcubmFtZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGNvbmZpZy5uYW1lID0gREVGQVVMVF9FTlRSWV9OQU1FO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycgfHwgIW5hbWUpIHtcclxuICAgICAgICAgICAgZXJyb3IoJ2JhZC1hcHAtbmFtZScsIHsgbmFtZTogbmFtZSArICcnIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29udGFpbnMoYXBwc18sIG5hbWUpKSB7XHJcbiAgICAgICAgICAgIGVycm9yKCdkdXBsaWNhdGUtYXBwJywgeyBuYW1lOiBuYW1lIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYXBwID0gbmV3IEZpcmViYXNlQXBwSW1wbChvcHRpb25zLCBjb25maWcsIG5hbWVzcGFjZSk7XHJcbiAgICAgICAgYXBwc19bbmFtZV0gPSBhcHA7XHJcbiAgICAgICAgY2FsbEFwcEhvb2tzKGFwcCwgJ2NyZWF0ZScpO1xyXG4gICAgICAgIHJldHVybiBhcHA7XHJcbiAgICB9XHJcbiAgICAvKlxyXG4gICAgICogUmV0dXJuIGFuIGFycmF5IG9mIGFsbCB0aGUgbm9uLWRlbGV0ZWQgRmlyZWJhc2VBcHBzLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBnZXRBcHBzKCkge1xyXG4gICAgICAgIC8vIE1ha2UgYSBjb3B5IHNvIGNhbGxlciBjYW5ub3QgbXV0YXRlIHRoZSBhcHBzIGxpc3QuXHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGFwcHNfKS5tYXAoZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIGFwcHNfW25hbWVdOyB9KTtcclxuICAgIH1cclxuICAgIC8qXHJcbiAgICAgKiBSZWdpc3RlciBhIEZpcmViYXNlIFNlcnZpY2UuXHJcbiAgICAgKlxyXG4gICAgICogZmlyZWJhc2UuSU5URVJOQUwucmVnaXN0ZXJTZXJ2aWNlKClcclxuICAgICAqXHJcbiAgICAgKiBUT0RPOiBJbXBsZW1lbnQgc2VydmljZVByb3BlcnRpZXMuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyU2VydmljZShuYW1lLCBjcmVhdGVTZXJ2aWNlLCBzZXJ2aWNlUHJvcGVydGllcywgYXBwSG9vaywgYWxsb3dNdWx0aXBsZUluc3RhbmNlcykge1xyXG4gICAgICAgIC8vIENhbm5vdCByZS1yZWdpc3RlciBhIHNlcnZpY2UgdGhhdCBhbHJlYWR5IGV4aXN0c1xyXG4gICAgICAgIGlmIChmYWN0b3JpZXNbbmFtZV0pIHtcclxuICAgICAgICAgICAgZXJyb3IoJ2R1cGxpY2F0ZS1zZXJ2aWNlJywgeyBuYW1lOiBuYW1lIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDYXB0dXJlIHRoZSBzZXJ2aWNlIGZhY3RvcnkgZm9yIGxhdGVyIHNlcnZpY2UgaW5zdGFudGlhdGlvblxyXG4gICAgICAgIGZhY3Rvcmllc1tuYW1lXSA9IGNyZWF0ZVNlcnZpY2U7XHJcbiAgICAgICAgLy8gQ2FwdHVyZSB0aGUgYXBwSG9vaywgaWYgcGFzc2VkXHJcbiAgICAgICAgaWYgKGFwcEhvb2spIHtcclxuICAgICAgICAgICAgYXBwSG9va3NbbmFtZV0gPSBhcHBIb29rO1xyXG4gICAgICAgICAgICAvLyBSdW4gdGhlICoqbmV3KiogYXBwIGhvb2sgb24gYWxsIGV4aXN0aW5nIGFwcHNcclxuICAgICAgICAgICAgZ2V0QXBwcygpLmZvckVhY2goZnVuY3Rpb24gKGFwcCkge1xyXG4gICAgICAgICAgICAgICAgYXBwSG9vaygnY3JlYXRlJywgYXBwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRoZSBTZXJ2aWNlIG5hbWVzcGFjZSBpcyBhbiBhY2Nlc3NvciBmdW5jdGlvbiAuLi5cclxuICAgICAgICB2YXIgc2VydmljZU5hbWVzcGFjZSA9IGZ1bmN0aW9uIChhcHBBcmcpIHtcclxuICAgICAgICAgICAgaWYgKGFwcEFyZyA9PT0gdm9pZCAwKSB7IGFwcEFyZyA9IGFwcCgpOyB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXBwQXJnW25hbWVdICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbnZhbGlkIGFyZ3VtZW50LlxyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBoYXBwZW5zIGluIHRoZSBmb2xsb3dpbmcgY2FzZTogZmlyZWJhc2Uuc3RvcmFnZSgnZ3M6LycpXHJcbiAgICAgICAgICAgICAgICBlcnJvcignaW52YWxpZC1hcHAtYXJndW1lbnQnLCB7IG5hbWU6IG5hbWUgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gRm9yd2FyZCBzZXJ2aWNlIGluc3RhbmNlIGxvb2t1cCB0byB0aGUgRmlyZWJhc2VBcHAuXHJcbiAgICAgICAgICAgIHJldHVybiBhcHBBcmdbbmFtZV0oKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIC4uLiBhbmQgYSBjb250YWluZXIgZm9yIHNlcnZpY2UtbGV2ZWwgcHJvcGVydGllcy5cclxuICAgICAgICBpZiAoc2VydmljZVByb3BlcnRpZXMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB1dGlsLmRlZXBFeHRlbmQoc2VydmljZU5hbWVzcGFjZSwgc2VydmljZVByb3BlcnRpZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBNb25rZXktcGF0Y2ggdGhlIHNlcnZpY2VOYW1lc3BhY2Ugb250byB0aGUgZmlyZWJhc2UgbmFtZXNwYWNlXHJcbiAgICAgICAgbmFtZXNwYWNlW25hbWVdID0gc2VydmljZU5hbWVzcGFjZTtcclxuICAgICAgICAvLyBQYXRjaCB0aGUgRmlyZWJhc2VBcHBJbXBsIHByb3RvdHlwZVxyXG4gICAgICAgIEZpcmViYXNlQXBwSW1wbC5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHNlcnZpY2VGeG4gPSB0aGlzLl9nZXRTZXJ2aWNlLmJpbmQodGhpcywgbmFtZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlRnhuLmFwcGx5KHRoaXMsIGFsbG93TXVsdGlwbGVJbnN0YW5jZXMgPyBhcmdzIDogW10pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2VOYW1lc3BhY2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFBhdGNoIHRoZSB0b3AtbGV2ZWwgZmlyZWJhc2UgbmFtZXNwYWNlIHdpdGggYWRkaXRpb25hbCBwcm9wZXJ0aWVzLlxyXG4gICAgICpcclxuICAgICAqIGZpcmViYXNlLklOVEVSTkFMLmV4dGVuZE5hbWVzcGFjZSgpXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGV4dGVuZE5hbWVzcGFjZShwcm9wcykge1xyXG4gICAgICAgIHV0aWwuZGVlcEV4dGVuZChuYW1lc3BhY2UsIHByb3BzKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGNhbGxBcHBIb29rcyhhcHAsIGV2ZW50TmFtZSkge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKGZhY3RvcmllcykuZm9yRWFjaChmdW5jdGlvbiAoc2VydmljZU5hbWUpIHtcclxuICAgICAgICAgICAgLy8gSWdub3JlIHZpcnR1YWwgc2VydmljZXNcclxuICAgICAgICAgICAgdmFyIGZhY3RvcnlOYW1lID0gdXNlQXNTZXJ2aWNlKGFwcCwgc2VydmljZU5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoZmFjdG9yeU5hbWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoYXBwSG9va3NbZmFjdG9yeU5hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICBhcHBIb29rc1tmYWN0b3J5TmFtZV0oZXZlbnROYW1lLCBhcHApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvLyBNYXAgdGhlIHJlcXVlc3RlZCBzZXJ2aWNlIHRvIGEgcmVnaXN0ZXJlZCBzZXJ2aWNlIG5hbWVcclxuICAgIC8vICh1c2VkIHRvIG1hcCBhdXRoIHRvIHNlcnZlckF1dGggc2VydmljZSB3aGVuIG5lZWRlZCkuXHJcbiAgICBmdW5jdGlvbiB1c2VBc1NlcnZpY2UoYXBwLCBuYW1lKSB7XHJcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzZXJ2ZXJBdXRoJykge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHVzZVNlcnZpY2UgPSBuYW1lO1xyXG4gICAgICAgIHZhciBvcHRpb25zID0gYXBwLm9wdGlvbnM7XHJcbiAgICAgICAgcmV0dXJuIHVzZVNlcnZpY2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmFtZXNwYWNlO1xyXG59XHJcbmZ1bmN0aW9uIGVycm9yKGNvZGUsIGFyZ3MpIHtcclxuICAgIHRocm93IGFwcEVycm9ycy5jcmVhdGUoY29kZSwgYXJncyk7XHJcbn1cclxuLy8gVHlwZVNjcmlwdCBkb2VzIG5vdCBzdXBwb3J0IG5vbi1zdHJpbmcgaW5kZXhlcyFcclxuLy8gbGV0IGVycm9yczoge1tjb2RlOiBBcHBFcnJvcjogc3RyaW5nfSA9IHtcclxudmFyIGVycm9ycyA9IHtcclxuICAgICduby1hcHAnOiBcIk5vIEZpcmViYXNlIEFwcCAneyRuYW1lfScgaGFzIGJlZW4gY3JlYXRlZCAtIFwiICtcclxuICAgICAgICAnY2FsbCBGaXJlYmFzZSBBcHAuaW5pdGlhbGl6ZUFwcCgpJyxcclxuICAgICdiYWQtYXBwLW5hbWUnOiBcIklsbGVnYWwgQXBwIG5hbWU6ICd7JG5hbWV9XCIsXHJcbiAgICAnZHVwbGljYXRlLWFwcCc6IFwiRmlyZWJhc2UgQXBwIG5hbWVkICd7JG5hbWV9JyBhbHJlYWR5IGV4aXN0c1wiLFxyXG4gICAgJ2FwcC1kZWxldGVkJzogXCJGaXJlYmFzZSBBcHAgbmFtZWQgJ3skbmFtZX0nIGFscmVhZHkgZGVsZXRlZFwiLFxyXG4gICAgJ2R1cGxpY2F0ZS1zZXJ2aWNlJzogXCJGaXJlYmFzZSBzZXJ2aWNlIG5hbWVkICd7JG5hbWV9JyBhbHJlYWR5IHJlZ2lzdGVyZWRcIixcclxuICAgICdzYS1ub3Qtc3VwcG9ydGVkJzogJ0luaXRpYWxpemluZyB0aGUgRmlyZWJhc2UgU0RLIHdpdGggYSBzZXJ2aWNlICcgK1xyXG4gICAgICAgICdhY2NvdW50IGlzIG9ubHkgYWxsb3dlZCBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQuIE9uIGNsaWVudCAnICtcclxuICAgICAgICAnZGV2aWNlcywgeW91IHNob3VsZCBpbnN0ZWFkIGluaXRpYWxpemUgdGhlIFNESyB3aXRoIGFuIGFwaSBrZXkgYW5kICcgK1xyXG4gICAgICAgICdhdXRoIGRvbWFpbicsXHJcbiAgICAnaW52YWxpZC1hcHAtYXJndW1lbnQnOiAnZmlyZWJhc2UueyRuYW1lfSgpIHRha2VzIGVpdGhlciBubyBhcmd1bWVudCBvciBhICcgK1xyXG4gICAgICAgICdGaXJlYmFzZSBBcHAgaW5zdGFuY2UuJ1xyXG59O1xyXG52YXIgYXBwRXJyb3JzID0gbmV3IHV0aWwuRXJyb3JGYWN0b3J5KCdhcHAnLCAnRmlyZWJhc2UnLCBlcnJvcnMpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIGZpcmViYXNlID0gY3JlYXRlRmlyZWJhc2VOYW1lc3BhY2UoKTtcblxuZXhwb3J0cy5maXJlYmFzZSA9IGZpcmViYXNlO1xuZXhwb3J0cy5kZWZhdWx0ID0gZmlyZWJhc2U7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vQGZpcmViYXNlL2FwcC9kaXN0L2luZGV4LmNqcy5qc1xuLy8gbW9kdWxlIGlkID0gMTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyogZ2xvYmFsIEFGUkFNRSAqL1xyXG5cclxuLypcclxuICogUHJvdmlkZXMgYSBzaW1wbGUgQVBJIGZvciBjcmVhdGluZyBkZWNvcmF0b3IgZnVuY3Rpb25zIHdoaWNoIHlvdSBjYW4gYXBwbHkgdG8geW91ciBDb21wb25lbnQgZGVmaW5pdGlvbnMuXHJcbiAqIFRoZXNlIGRlY29yYXRlZCBmdW5jdGlvbnMgYXJlIGV4ZWN1dGVkIHdoZW4gdGhlaXIgQ29tcG9uZW50IGlzIGluc3RhbnRpYXRlZCwgYW5kIGhhdmUgdGhlaXIgJ3RoaXMnIGF0dHJpYnV0ZSBzZXRcclxuICogdG8gdGhlIG5ldyBDb21wb25lbnQuXHJcbiAqXHJcbiAqIERlY29yYXRvcnMgc2hvdWxkIG9ubHkgYmUgdXNlZCBvbiBmdW5jdGlvbnMgdGhhdCBhcmUgb3duZWQgYnkgQ29tcG9uZW50IGRlc2NyaXB0b3JzIHJlZ2lzdGVyZWQgd2l0aFxyXG4gKiBBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQuIERlY29yYXRpbmcgYW55IG90aGVyIGZ1bmN0aW9uIHdpbGwgaGF2ZSBubyBlZmZlY3QsIGFzIHRoZSBkZWNvcmF0b3JcclxuICogZnVuY3RvciB3aWxsIG5ldmVyIGJlIGV4ZWN1dGVkLlxyXG4gKi9cclxuXHJcbi8qXHJcbiAqIERlY29yYXRlcyBhIGZ1bmN0aW9uIHdpdGggYSBmdW5jdG9yIHRoYXQgaXMgZXhlY3V0ZWQgaW4gdGhlIGNvbnRleHQgb2YgZWFjaCBpbnN0YW50aWF0ZWQgQ29tcG9uZW50IHdoaWNoIG93bnMgaXQuXHJcbiAqXHJcbiAqIEBwYXJhbSBmdW5jIC0gRnVuY3Rpb24gdG8gZGVjb3JhdGUuXHJcbiAqIEBwYXJhbSBkZWNvcmF0b3JGdW5jIC0gRnVuY3RvciB3aGljaCBkZWNvcmF0ZXMgZnVuYy4gSXQncyBkZWZpbml0aW9uIHNob3VsZCBhcHBlYXIgbGlrZSB0aGlzOlxyXG4gKiAgICBmdW5jdGlvbiBkZWNvcmF0b3JGdW5jdG9yKGZ1bmNQcm9wZXJ0eU5hbWUpIHtcclxuICogICAgICBjb25zdCBmdW5jID0gdGhpc1tmdW5jUHJvcGVydHlOYW1lXTsgLy8gJ3RoaXMnIGlzIGFzc2lnbmVkIHRvIHRoZSBpbnN0YW50aWF0ZWQgQ29tcG9uZW50LlxyXG4gKiAgICAgIC8vIERlY29yYXRvciBzaG91bGQgcmV0dXJuIGEgZnVuY3Rpb25cclxuICogICAgICByZXR1cm4gKCkgPT4ge1xyXG4gKiAgICAgICAgY29uc29sZS5sb2codGhpcy5lbC5pZCArIFwiIGhhcyBhIGRlY29yYXRlZCBmdW5jdGlvbiFcIik7XHJcbiAqICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gKiAgICAgIH1cclxuICogICAgfVxyXG4gKlxyXG4gKiBAcmV0dXJucyBBIHBlbmRpbmcgZGVjb3JhdGVkIGZ1bmN0b3Igd2hpY2ggd2lsbCBiZSBleGVjdXRlZCB3aGVuIGEgY29tcG9uZW50IHRoYXQgb3ducyBpdCBpcyBpbnN0YW50aWF0ZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWNvcmF0ZShmdW5jLCBkZWNvcmF0b3JGdW5jKSB7XHJcbiAgcmV0dXJuIGRlY29yYXRpb25zLmFkZChmdW5jLCBkZWNvcmF0b3JGdW5jKTtcclxufVxyXG5cclxuLy8gSGVscGVyIGZvciBzdG9yaW5nIGFuZCByZXRyaWV2aW5nIGRlY29yYXRvciBmdW5jdG9ycyBmb3IgYSBnaXZlbiBmdW5jdGlvbi5cclxuY29uc3QgZGVjb3JhdGlvbnMgPSAoZnVuY3Rpb24oKSB7XHJcbiAgY29uc3QgZnVuY01hcCA9IG5ldyBXZWFrTWFwKCk7XHJcblxyXG4gIGZ1bmN0aW9uIGFkZChmdW5jLCBkZWNvcmF0b3IpIHtcclxuICAgIGNvbnN0IHBhcmVudCA9IGZ1bmNNYXAuaGFzKGZ1bmMpID8gZnVuYyA6IHVuZGVmaW5lZDsgLy8gSW4gY2FzZSBkZWNvcmF0b3JzIGFyZSBuZXN0ZWQuXHJcbiAgICBjb25zdCBkZWNvcmF0ZWRGdW5jID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgIH1cclxuICAgIGZ1bmNNYXAuc2V0KGRlY29yYXRlZEZ1bmMsIHtwYXJlbnQ6IHBhcmVudCwgZGVjb3JhdG9yOiBkZWNvcmF0b3J9KTtcclxuICAgIHJldHVybiBkZWNvcmF0ZWRGdW5jO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0QWxsKGZ1bmMpIHtcclxuICAgIHZhciBpdGVyID0gZnVuY01hcC5nZXQoZnVuYyk7XHJcbiAgICB2YXIgZGVjb3JhdG9ycyA9IFtdO1xyXG4gICAgd2hpbGUgKGl0ZXIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBkZWNvcmF0b3JzLnB1c2goaXRlci5kZWNvcmF0b3IpO1xyXG4gICAgICBpdGVyID0gaXRlci5wYXJlbnQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVjb3JhdG9ycztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGlzRnVuY3Rpb25EZWNvcmF0ZWQoZnVuYykge1xyXG4gICAgcmV0dXJuIGZ1bmNNYXAuaGFzKGZ1bmMpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGFkZDogYWRkLFxyXG4gICAgZ2V0QWxsOiBnZXRBbGwsXHJcbiAgICBpc0Z1bmN0aW9uRGVjb3JhdGVkOiBpc0Z1bmN0aW9uRGVjb3JhdGVkXHJcbiAgfVxyXG59KSgpO1xyXG5cclxuLy8gSGVyZSBJJ20gd3JhcHBpbmcgdGhlIEFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCBmdW5jdGlvbiBhbmQgYWxzbyBlYWNoIENvbXBvbmVudCBjb25zdHJ1Y3Rvci4gV2hlbmV2ZXIgYSBuZXcgY29tcG9uZW50XHJcbi8vIGlzIGluc3RhbnRpYXRlZCBJJ20gc2Nhbm5pbmcgaXRzIGxpc3Qgb2YgcHJvcGVydGllcyBmb3IgYW55IGZ1bmN0aW9ucyB3aGljaCBoYXZlIGJlZW4gZGVjb3JhdGVkLiBFYWNoIGRlY29yYXRpb25cclxuLy8gZnVuY3RvciB3aWxsIHRoZW4gYmUgZXhlY3V0ZWQgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGNvbXBvbmVudCB3aGljaCBvd25zIHRoZSBmdW5jdGlvbi5cclxuKGZ1bmN0aW9uKCkge1xyXG4gIE9iamVjdC5rZXlzKEFGUkFNRS5jb21wb25lbnRzKS5mb3JFYWNoKCBmdW5jdGlvbihjKSB7XHJcbiAgICB3cmFwQ29tcG9uZW50KGMpXHJcbiAgfSk7XHJcbiAgd3JhcFJlZ2lzdGVyKCk7XHJcblxyXG4gIGZ1bmN0aW9uIGV4ZWN1dGVEZWNvcmF0b3JzT25OZXdDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICBjb25zdCBwcm90ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGNvbXBvbmVudCk7XHJcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhwcm90KS5mb3JFYWNoKCBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgIGNvbnN0IHByb3AgPSBwcm90W25hbWVdO1xyXG4gICAgICBpZiAodHlwZW9mIHByb3AgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWNvcmF0aW9ucy5pc0Z1bmN0aW9uRGVjb3JhdGVkKHByb3ApKSB7XHJcbiAgICAgICAgZGVjb3JhdGlvbnMuZ2V0QWxsKHByb3ApLmZvckVhY2goZnVuY3Rpb24oZGVjb3JhdG9yKSB7XHJcbiAgICAgICAgICBjb21wb25lbnRbbmFtZV0gPSBkZWNvcmF0b3IuY2FsbChjb21wb25lbnQsIG5hbWUsIHByb3ApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHdyYXBDb21wb25lbnQobmFtZSkge1xyXG4gICAgY29uc3Qgb3JpZyA9IEFGUkFNRS5jb21wb25lbnRzW25hbWVdLkNvbXBvbmVudDtcclxuXHJcbiAgICBBRlJBTUUuY29tcG9uZW50c1tuYW1lXS5Db21wb25lbnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgLy8gT3ZlcnJpZGUgaW5pdCBvbiB0aGUgaW5zdGFuY2UgdG8gZXhlY3V0ZSB0aGUgZGVjb3JhdG9yIGZ1bmN0b3JzIGJlZm9yZSBpbml0aWFsaXppbmcuXHJcbiAgICAgIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmluaXQ7XHJcbiAgICAgICAgZXhlY3V0ZURlY29yYXRvcnNPbk5ld0NvbXBvbmVudCh0aGlzKTtcclxuICAgICAgICB0aGlzLmluaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgfVxyXG4gICAgICBvcmlnLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICB9XHJcbiAgICBBRlJBTUUuY29tcG9uZW50c1tuYW1lXS5Db21wb25lbnQucHJvdG90eXBlID0gb3JpZy5wcm90b3R5cGU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB3cmFwUmVnaXN0ZXIoKSB7XHJcbiAgICBjb25zdCBvcmlnUmVnaXN0ZXIgPSBBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQ7XHJcbiAgICBBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgIG9yaWdSZWdpc3Rlci5hcHBseShBRlJBTUUsIGFyZ3VtZW50cyk7XHJcbiAgICAgIHJldHVybiB3cmFwQ29tcG9uZW50KG5hbWUpO1xyXG4gICAgfVxyXG4gIH1cclxufSkoKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzLmRlY29yYXRlID0gZGVjb3JhdGU7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzL2NvbXBvbmVudC1kZWNvcmF0b3JzLmpzXG4vLyBtb2R1bGUgaWQgPSAxNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiBnbG9iYWwgQUZSQU1FICovXG5cbmlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ2FmcmFtZS1ldmVudC1kZWNvcmF0b3JzIHdhcyBsb2FkZWQgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlJyk7XG59XG5cbmNvbnN0IGV2ZW50QmluZGVyID0gcmVxdWlyZShcIi4vZXZlbnQtYmluZGVyXCIpO1xuY29uc3QgZGVjb3JhdGUgPSByZXF1aXJlKFwiLi9jb21wb25lbnQtZGVjb3JhdG9yc1wiKS5kZWNvcmF0ZTtcblxubW9kdWxlLmV4cG9ydHMuYmluZEV2ZW50ID0gZXZlbnRCaW5kZXIuYmluZEV2ZW50O1xubW9kdWxlLmV4cG9ydHMuYmluZEV2ZW50UGxheVBhdXNlID0gZXZlbnRCaW5kZXIuYmluZEV2ZW50UGxheVBhdXNlO1xubW9kdWxlLmV4cG9ydHMuZGVjb3JhdGUgPSBkZWNvcmF0ZTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDE1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gYnVpbGRTZWFyY2hNZXRob2Q7XG5cbnZhciBlcnJvcnMgPSByZXF1aXJlKCcuL2Vycm9ycy5qcycpO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBzZWFyY2ggbWV0aG9kIHRvIGJlIHVzZWQgaW4gY2xpZW50c1xuICogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5UGFyYW0gdGhlIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZSB1c2VkIGZvciB0aGUgcXVlcnlcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgdGhlIHVybFxuICogQHJldHVybiB7ZnVuY3Rpb259IHRoZSBzZWFyY2ggbWV0aG9kXG4gKi9cbmZ1bmN0aW9uIGJ1aWxkU2VhcmNoTWV0aG9kKHF1ZXJ5UGFyYW0sIHVybCkge1xuICAvKipcbiAgICogVGhlIHNlYXJjaCBtZXRob2QuIFByZXBhcmVzIHRoZSBkYXRhIGFuZCBzZW5kIHRoZSBxdWVyeSB0byBBbGdvbGlhLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcXVlcnkgdGhlIHN0cmluZyB1c2VkIGZvciBxdWVyeSBzZWFyY2hcbiAgICogQHBhcmFtIHtvYmplY3R9IGFyZ3MgYWRkaXRpb25hbCBwYXJhbWV0ZXJzIHRvIHNlbmQgd2l0aCB0aGUgc2VhcmNoXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IFtjYWxsYmFja10gdGhlIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCB3aXRoIHRoZSBjbGllbnQgZ2V0cyB0aGUgYW5zd2VyXG4gICAqIEByZXR1cm4ge3VuZGVmaW5lZHxQcm9taXNlfSBJZiB0aGUgY2FsbGJhY2sgaXMgbm90IHByb3ZpZGVkIHRoZW4gdGhpcyBtZXRob2RzIHJldHVybnMgYSBQcm9taXNlXG4gICAqL1xuICByZXR1cm4gZnVuY3Rpb24gc2VhcmNoKHF1ZXJ5LCBhcmdzLCBjYWxsYmFjaykge1xuICAgIC8vIHdhcm4gVjIgdXNlcnMgb24gaG93IHRvIHNlYXJjaFxuICAgIGlmICh0eXBlb2YgcXVlcnkgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGFyZ3MgPT09ICdvYmplY3QnIHx8XG4gICAgICB0eXBlb2YgY2FsbGJhY2sgPT09ICdvYmplY3QnKSB7XG4gICAgICAvLyAuc2VhcmNoKHF1ZXJ5LCBwYXJhbXMsIGNiKVxuICAgICAgLy8gLnNlYXJjaChjYiwgcGFyYW1zKVxuICAgICAgdGhyb3cgbmV3IGVycm9ycy5BbGdvbGlhU2VhcmNoRXJyb3IoJ2luZGV4LnNlYXJjaCB1c2FnZSBpcyBpbmRleC5zZWFyY2gocXVlcnksIHBhcmFtcywgY2IpJyk7XG4gICAgfVxuXG4gICAgLy8gTm9ybWFsaXppbmcgdGhlIGZ1bmN0aW9uIHNpZ25hdHVyZVxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwIHx8IHR5cGVvZiBxdWVyeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gVXNhZ2UgOiAuc2VhcmNoKCksIC5zZWFyY2goY2IpXG4gICAgICBjYWxsYmFjayA9IHF1ZXJ5O1xuICAgICAgcXVlcnkgPSAnJztcbiAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgfHwgdHlwZW9mIGFyZ3MgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIC8vIFVzYWdlIDogLnNlYXJjaChxdWVyeS9hcmdzKSwgLnNlYXJjaChxdWVyeSwgY2IpXG4gICAgICBjYWxsYmFjayA9IGFyZ3M7XG4gICAgICBhcmdzID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLyBBdCB0aGlzIHBvaW50IHdlIGhhdmUgMyBhcmd1bWVudHMgd2l0aCB2YWx1ZXNcblxuICAgIC8vIFVzYWdlIDogLnNlYXJjaChhcmdzKSAvLyBjYXJlZnVsOiB0eXBlb2YgbnVsbCA9PT0gJ29iamVjdCdcbiAgICBpZiAodHlwZW9mIHF1ZXJ5ID09PSAnb2JqZWN0JyAmJiBxdWVyeSAhPT0gbnVsbCkge1xuICAgICAgYXJncyA9IHF1ZXJ5O1xuICAgICAgcXVlcnkgPSB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIGlmIChxdWVyeSA9PT0gdW5kZWZpbmVkIHx8IHF1ZXJ5ID09PSBudWxsKSB7IC8vIC5zZWFyY2godW5kZWZpbmVkL251bGwpXG4gICAgICBxdWVyeSA9ICcnO1xuICAgIH1cblxuICAgIHZhciBwYXJhbXMgPSAnJztcblxuICAgIGlmIChxdWVyeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBwYXJhbXMgKz0gcXVlcnlQYXJhbSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChxdWVyeSk7XG4gICAgfVxuXG4gICAgdmFyIGFkZGl0aW9uYWxVQTtcbiAgICBpZiAoYXJncyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoYXJncy5hZGRpdGlvbmFsVUEpIHtcbiAgICAgICAgYWRkaXRpb25hbFVBID0gYXJncy5hZGRpdGlvbmFsVUE7XG4gICAgICAgIGRlbGV0ZSBhcmdzLmFkZGl0aW9uYWxVQTtcbiAgICAgIH1cbiAgICAgIC8vIGBfZ2V0U2VhcmNoUGFyYW1zYCB3aWxsIGF1Z21lbnQgcGFyYW1zLCBkbyBub3QgYmUgZm9vbGVkIGJ5IHRoZSA9IHZlcnN1cyArPSBmcm9tIHByZXZpb3VzIGlmXG4gICAgICBwYXJhbXMgPSB0aGlzLmFzLl9nZXRTZWFyY2hQYXJhbXMoYXJncywgcGFyYW1zKTtcbiAgICB9XG5cblxuICAgIHJldHVybiB0aGlzLl9zZWFyY2gocGFyYW1zLCB1cmwsIGNhbGxiYWNrLCBhZGRpdGlvbmFsVUEpO1xuICB9O1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2J1aWxkU2VhcmNoTWV0aG9kLmpzXG4vLyBtb2R1bGUgaWQgPSAxNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG9taXQob2JqLCB0ZXN0KSB7XG4gIHZhciBrZXlzID0gcmVxdWlyZSgnb2JqZWN0LWtleXMnKTtcbiAgdmFyIGZvcmVhY2ggPSByZXF1aXJlKCdmb3JlYWNoJyk7XG5cbiAgdmFyIGZpbHRlcmVkID0ge307XG5cbiAgZm9yZWFjaChrZXlzKG9iaiksIGZ1bmN0aW9uIGRvRmlsdGVyKGtleU5hbWUpIHtcbiAgICBpZiAodGVzdChrZXlOYW1lKSAhPT0gdHJ1ZSkge1xuICAgICAgZmlsdGVyZWRba2V5TmFtZV0gPSBvYmpba2V5TmFtZV07XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gZmlsdGVyZWQ7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL29taXQuanNcbi8vIG1vZHVsZSBpZCA9IDE3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImlmICh0eXBlb2YgT2JqZWN0LmNyZWF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAvLyBpbXBsZW1lbnRhdGlvbiBmcm9tIHN0YW5kYXJkIG5vZGUuanMgJ3V0aWwnIG1vZHVsZVxuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGluaGVyaXRzKGN0b3IsIHN1cGVyQ3Rvcikge1xuICAgIGN0b3Iuc3VwZXJfID0gc3VwZXJDdG9yXG4gICAgY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ3Rvci5wcm90b3R5cGUsIHtcbiAgICAgIGNvbnN0cnVjdG9yOiB7XG4gICAgICAgIHZhbHVlOiBjdG9yLFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xufSBlbHNlIHtcbiAgLy8gb2xkIHNjaG9vbCBzaGltIGZvciBvbGQgYnJvd3NlcnNcbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpbmhlcml0cyhjdG9yLCBzdXBlckN0b3IpIHtcbiAgICBjdG9yLnN1cGVyXyA9IHN1cGVyQ3RvclxuICAgIHZhciBUZW1wQ3RvciA9IGZ1bmN0aW9uICgpIHt9XG4gICAgVGVtcEN0b3IucHJvdG90eXBlID0gc3VwZXJDdG9yLnByb3RvdHlwZVxuICAgIGN0b3IucHJvdG90eXBlID0gbmV3IFRlbXBDdG9yKClcbiAgICBjdG9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGN0b3JcbiAgfVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2luaGVyaXRzL2luaGVyaXRzX2Jyb3dzZXIuanNcbi8vIG1vZHVsZSBpZCA9IDE4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0geVtvcFswXSAmIDIgPyBcInJldHVyblwiIDogb3BbMF0gPyBcInRocm93XCIgOiBcIm5leHRcIl0pICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gWzAsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7ICB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpZiAob1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vdHNsaWIvdHNsaWIuZXM2LmpzXG4vLyBtb2R1bGUgaWQgPSAxOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKiBnbG9iYWwgQUZSQU1FLCBUSFJFRSAqL1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuLy8gQ29uZmlndXJhdGlvbiBmb3IgdGhlIE11dGF0aW9uT2JzZXJ2ZXIgdXNlZCB0byByZWZyZXNoIHRoZSB3aGl0ZWxpc3QuXG4vLyBMaXN0ZW5zIGZvciBhZGRpdGlvbi9yZW1vdmFsIG9mIGVsZW1lbnRzIGFuZCBhdHRyaWJ1dGVzIHdpdGhpbiB0aGUgc2NlbmUuXG52YXIgT0JTRVJWRVJfQ09ORklHID0ge1xuICBjaGlsZExpc3Q6IHRydWUsXG4gIGF0dHJpYnV0ZXM6IHRydWUsXG4gIHN1YnRyZWU6IHRydWVcbn07XG5cbi8qKlxuICogSW1wbGVtZW50IEFBQkIgY29sbGlzaW9uIGRldGVjdGlvbiBmb3IgZW50aXRpZXMgd2l0aCBhIG1lc2guXG4gKiBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9NaW5pbXVtX2JvdW5kaW5nX2JveCNBeGlzLWFsaWduZWRfbWluaW11bV9ib3VuZGluZ19ib3hcbiAqXG4gKiBAcHJvcGVydHkge3N0cmluZ30gb2JqZWN0cyAtIFNlbGVjdG9yIG9mIGVudGl0aWVzIHRvIHRlc3QgZm9yIGNvbGxpc2lvbi5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdhYWJiLWNvbGxpZGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBjb2xsaWRlTm9uVmlzaWJsZToge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBkZWJ1Zzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgaW50ZXJ2YWw6IHtkZWZhdWx0OiA4MH0sXG4gICAgb2JqZWN0czoge2RlZmF1bHQ6ICcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmNlbnRlckRpZmZlcmVuY2VWZWMzID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLmNsZWFyZWRJbnRlcnNlY3RlZEVscyA9IFtdO1xuICAgIHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwgPSBudWxsO1xuICAgIHRoaXMuYm91bmRpbmdCb3ggPSBuZXcgVEhSRUUuQm94MygpO1xuICAgIHRoaXMuYm94Q2VudGVyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLmJveEhlbHBlciA9IG5ldyBUSFJFRS5Cb3hIZWxwZXIoKTtcbiAgICB0aGlzLmJveE1heCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5ib3hNaW4gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuaGl0Q2xvc2VzdENsZWFyRXZlbnREZXRhaWwgPSB7fTtcbiAgICB0aGlzLmhpdENsb3Nlc3RFdmVudERldGFpbCA9IHt9O1xuICAgIHRoaXMuaW50ZXJzZWN0ZWRFbHMgPSBbXTtcbiAgICB0aGlzLm9iamVjdEVscyA9IFtdO1xuICAgIHRoaXMubmV3SW50ZXJzZWN0ZWRFbHMgPSBbXTtcbiAgICB0aGlzLnByZXZDaGVja1RpbWUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5wcmV2aW91c0ludGVyc2VjdGVkRWxzID0gW107XG5cbiAgICB0aGlzLnNldERpcnR5ID0gdGhpcy5zZXREaXJ0eS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcih0aGlzLnNldERpcnR5KTtcbiAgICB0aGlzLmRpcnR5ID0gdHJ1ZTtcblxuICAgIHRoaXMuaGl0U3RhcnRFdmVudERldGFpbCA9IHtpbnRlcnNlY3RlZEVsczogdGhpcy5uZXdJbnRlcnNlY3RlZEVsc307XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLmVsLnNjZW5lRWwsIE9CU0VSVkVSX0NPTkZJRyk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ29iamVjdDNkc2V0JywgdGhpcy5zZXREaXJ0eSk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ29iamVjdDNkcmVtb3ZlJywgdGhpcy5zZXREaXJ0eSk7XG4gIH0sXG5cbiAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29iamVjdDNkc2V0JywgdGhpcy5zZXREaXJ0eSk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29iamVjdDNkcmVtb3ZlJywgdGhpcy5zZXREaXJ0eSk7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUpIHtcbiAgICB2YXIgYm94SGVscGVyO1xuICAgIHZhciBib3VuZGluZ0JveCA9IHRoaXMuYm91bmRpbmdCb3g7XG4gICAgdmFyIGNlbnRlckRpZmZlcmVuY2VWZWMzID0gdGhpcy5jZW50ZXJEaWZmZXJlbmNlVmVjMztcbiAgICB2YXIgY2xlYXJlZEludGVyc2VjdGVkRWxzID0gdGhpcy5jbGVhcmVkSW50ZXJzZWN0ZWRFbHM7XG4gICAgdmFyIGNsb3Nlc3RDZW50ZXJEaWZmZXJlbmNlO1xuICAgIHZhciBuZXdDbG9zZXN0RWw7XG4gICAgdmFyIGludGVyc2VjdGVkRWxzID0gdGhpcy5pbnRlcnNlY3RlZEVscztcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpO1xuICAgIHZhciBuZXdJbnRlcnNlY3RlZEVscyA9IHRoaXMubmV3SW50ZXJzZWN0ZWRFbHM7XG4gICAgdmFyIG9iamVjdEVscyA9IHRoaXMub2JqZWN0RWxzO1xuICAgIHZhciBwcmV2Q2hlY2tUaW1lID0gdGhpcy5wcmV2Q2hlY2tUaW1lO1xuICAgIHZhciBwcmV2aW91c0ludGVyc2VjdGVkRWxzID0gdGhpcy5wcmV2aW91c0ludGVyc2VjdGVkRWxzO1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBPbmx5IGNoZWNrIGZvciBpbnRlcnNlY3Rpb24gaWYgaW50ZXJ2YWwgdGltZSBoYXMgcGFzc2VkLlxuICAgIGlmIChwcmV2Q2hlY2tUaW1lICYmICh0aW1lIC0gcHJldkNoZWNrVGltZSA8IHRoaXMuZGF0YS5pbnRlcnZhbCkpIHsgcmV0dXJuOyB9XG4gICAgLy8gVXBkYXRlIGNoZWNrIHRpbWUuXG4gICAgdGhpcy5wcmV2Q2hlY2tUaW1lID0gdGltZTtcblxuICAgIGlmICh0aGlzLmRpcnR5KSB7IHRoaXMucmVmcmVzaE9iamVjdHMoKTsgfVxuXG4gICAgLy8gVXBkYXRlIHRoZSBib3VuZGluZyBib3ggdG8gYWNjb3VudCBmb3Igcm90YXRpb25zIGFuZCBwb3NpdGlvbiBjaGFuZ2VzLlxuICAgIGJvdW5kaW5nQm94LnNldEZyb21PYmplY3QoZWwub2JqZWN0M0QpO1xuICAgIHRoaXMuYm94TWluLmNvcHkoYm91bmRpbmdCb3gubWluKTtcbiAgICB0aGlzLmJveE1heC5jb3B5KGJvdW5kaW5nQm94Lm1heCk7XG4gICAgYm91bmRpbmdCb3guZ2V0Q2VudGVyKHRoaXMuYm94Q2VudGVyKTtcblxuICAgIGlmICh0aGlzLmRhdGEuZGVidWcpIHtcbiAgICAgIHRoaXMuYm94SGVscGVyLnNldEZyb21PYmplY3QoZWwub2JqZWN0M0QpO1xuICAgICAgaWYgKCF0aGlzLmJveEhlbHBlci5wYXJlbnQpIHsgZWwuc2NlbmVFbC5vYmplY3QzRC5hZGQodGhpcy5ib3hIZWxwZXIpOyB9XG4gICAgfVxuXG4gICAgY29weUFycmF5KHByZXZpb3VzSW50ZXJzZWN0ZWRFbHMsIGludGVyc2VjdGVkRWxzKTtcblxuICAgIC8vIFBvcHVsYXRlIGludGVyc2VjdGVkRWxzIGFycmF5LlxuICAgIGludGVyc2VjdGVkRWxzLmxlbmd0aCA9IDA7XG4gICAgZm9yIChpID0gMDsgaSA8IG9iamVjdEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKG9iamVjdEVsc1tpXSA9PT0gdGhpcy5lbCkgeyBjb250aW51ZTsgfVxuXG4gICAgICAvLyBEb24ndCBjb2xsaWRlIHdpdGggbm9uLXZpc2libGUgaWYgZmxhZyBzZXQuXG4gICAgICBpZiAoIXRoaXMuZGF0YS5jb2xsaWRlTm9uVmlzaWJsZSAmJiAhb2JqZWN0RWxzW2ldLmdldEF0dHJpYnV0ZSgndmlzaWJsZScpKSB7XG4gICAgICAgIC8vIFJlbW92ZSBib3ggaGVscGVyIGlmIGRlYnVnIGZsYWcgc2V0IGFuZCBoYXMgYm94IGhlbHBlci5cbiAgICAgICAgaWYgKHRoaXMuZGF0YS5kZWJ1Zykge1xuICAgICAgICAgIGJveEhlbHBlciA9IG9iamVjdEVsc1tpXS5vYmplY3QzRC5ib3hIZWxwZXI7XG4gICAgICAgICAgaWYgKGJveEhlbHBlcikge1xuICAgICAgICAgICAgZWwuc2NlbmVFbC5vYmplY3QzRC5yZW1vdmUoYm94SGVscGVyKTtcbiAgICAgICAgICAgIG9iamVjdEVsc1tpXS5vYmplY3QzRC5ib3hIZWxwZXIgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgZm9yIGludGVyZWN0aW9uLlxuICAgICAgaWYgKHRoaXMuaXNJbnRlcnNlY3Rpbmcob2JqZWN0RWxzW2ldKSkgeyBpbnRlcnNlY3RlZEVscy5wdXNoKG9iamVjdEVsc1tpXSk7IH1cbiAgICB9XG5cbiAgICAvLyBHZXQgbmV3bHkgaW50ZXJzZWN0ZWQgZW50aXRpZXMuXG4gICAgbmV3SW50ZXJzZWN0ZWRFbHMubGVuZ3RoID0gMDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgaW50ZXJzZWN0ZWRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChwcmV2aW91c0ludGVyc2VjdGVkRWxzLmluZGV4T2YoaW50ZXJzZWN0ZWRFbHNbaV0pID09PSAtMSkge1xuICAgICAgICBuZXdJbnRlcnNlY3RlZEVscy5wdXNoKGludGVyc2VjdGVkRWxzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbWl0IGNsZWFyZWQgZXZlbnRzIG9uIG5vIGxvbmdlciBpbnRlcnNlY3RlZCBlbnRpdGllcy5cbiAgICBjbGVhcmVkSW50ZXJzZWN0ZWRFbHMubGVuZ3RoID0gMDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgcHJldmlvdXNJbnRlcnNlY3RlZEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGludGVyc2VjdGVkRWxzLmluZGV4T2YocHJldmlvdXNJbnRlcnNlY3RlZEVsc1tpXSkgIT09IC0xKSB7IGNvbnRpbnVlOyB9XG4gICAgICBpZiAoIXByZXZpb3VzSW50ZXJzZWN0ZWRFbHNbaV0uaGFzQXR0cmlidXRlKCdhYWJiLWNvbGxpZGVyJykpIHtcbiAgICAgICAgcHJldmlvdXNJbnRlcnNlY3RlZEVsc1tpXS5lbWl0KCdoaXRlbmQnKTtcbiAgICAgIH1cbiAgICAgIGNsZWFyZWRJbnRlcnNlY3RlZEVscy5wdXNoKHByZXZpb3VzSW50ZXJzZWN0ZWRFbHNbaV0pO1xuICAgIH1cblxuICAgIC8vIEVtaXQgZXZlbnRzIG9uIGludGVyc2VjdGVkIGVudGl0aWVzLiBEbyB0aGlzIGFmdGVyIHRoZSBjbGVhcmVkIGV2ZW50cy5cbiAgICBmb3IgKGkgPSAwOyBpIDwgbmV3SW50ZXJzZWN0ZWRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChuZXdJbnRlcnNlY3RlZEVsc1tpXSA9PT0gdGhpcy5lbCkgeyBjb250aW51ZTsgfVxuICAgICAgaWYgKG5ld0ludGVyc2VjdGVkRWxzW2ldLmhhc0F0dHJpYnV0ZSgnYWFiYi1jb2xsaWRlcicpKSB7IGNvbnRpbnVlOyB9XG4gICAgICBuZXdJbnRlcnNlY3RlZEVsc1tpXS5lbWl0KCdoaXRzdGFydCcpO1xuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSBjbG9zZXN0IGludGVyc2VjdGVkIGVudGl0eSBiYXNlZCBvbiBjZW50ZXJzLlxuICAgIGZvciAoaSA9IDA7IGkgPCBpbnRlcnNlY3RlZEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGludGVyc2VjdGVkRWxzW2ldID09PSB0aGlzLmVsKSB7IGNvbnRpbnVlOyB9XG4gICAgICBjZW50ZXJEaWZmZXJlbmNlVmVjM1xuICAgICAgICAuY29weShpbnRlcnNlY3RlZEVsc1tpXS5vYmplY3QzRC5ib3VuZGluZ0JveENlbnRlcilcbiAgICAgICAgLnN1Yih0aGlzLmJveENlbnRlcik7XG4gICAgICBpZiAoY2xvc2VzdENlbnRlckRpZmZlcmVuY2UgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgIGNlbnRlckRpZmZlcmVuY2VWZWMzLmxlbmd0aCgpIDwgY2xvc2VzdENlbnRlckRpZmZlcmVuY2UpIHtcbiAgICAgICAgY2xvc2VzdENlbnRlckRpZmZlcmVuY2UgPSBjZW50ZXJEaWZmZXJlbmNlVmVjMy5sZW5ndGgoKTtcbiAgICAgICAgbmV3Q2xvc2VzdEVsID0gaW50ZXJzZWN0ZWRFbHNbaV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW1pdCBldmVudHMgZm9yIHRoZSBuZXcgY2xvc2VzdCBlbnRpdHkgYW5kIHRoZSBvbGQgY2xvc2VzdCBlbnRpdHkuXG4gICAgaWYgKCFpbnRlcnNlY3RlZEVscy5sZW5ndGggJiYgdGhpcy5jbG9zZXN0SW50ZXJzZWN0ZWRFbCkge1xuICAgICAgLy8gTm8gaW50ZXJzZWN0ZWQgZW50aXRpZXMsIGNsZWFyIGFueSBjbG9zZXN0IGVudGl0eS5cbiAgICAgIHRoaXMuaGl0Q2xvc2VzdENsZWFyRXZlbnREZXRhaWwuZWwgPSB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsO1xuICAgICAgdGhpcy5jbG9zZXN0SW50ZXJzZWN0ZWRFbC5lbWl0KCdoaXRjbG9zZXN0Y2xlYXInKTtcbiAgICAgIHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwgPSBudWxsO1xuICAgICAgZWwuZW1pdCgnaGl0Y2xvc2VzdGNsZWFyJywgdGhpcy5oaXRDbG9zZXN0Q2xlYXJFdmVudERldGFpbCk7XG4gICAgfSBlbHNlIGlmIChuZXdDbG9zZXN0RWwgIT09IHRoaXMuY2xvc2VzdEludGVyc2VjdGVkRWwpIHtcbiAgICAgIC8vIENsZWFyIHRoZSBwcmV2aW91cyBjbG9zZXN0IGVudGl0eS5cbiAgICAgIGlmICh0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsKSB7XG4gICAgICAgIHRoaXMuaGl0Q2xvc2VzdENsZWFyRXZlbnREZXRhaWwuZWwgPSB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsO1xuICAgICAgICB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsLmVtaXQoJ2hpdGNsb3Nlc3RjbGVhcicsIHRoaXMuaGl0Q2xvc2VzdENsZWFyRXZlbnREZXRhaWwpO1xuICAgICAgfVxuICAgICAgaWYgKG5ld0Nsb3Nlc3RFbCkge1xuICAgICAgICAvLyBFbWl0IGZvciB0aGUgbmV3IGNsb3Nlc3QgZW50aXR5LlxuICAgICAgICBuZXdDbG9zZXN0RWwuZW1pdCgnaGl0Y2xvc2VzdCcpO1xuICAgICAgICB0aGlzLmNsb3Nlc3RJbnRlcnNlY3RlZEVsID0gbmV3Q2xvc2VzdEVsO1xuICAgICAgICB0aGlzLmhpdENsb3Nlc3RFdmVudERldGFpbC5lbCA9IG5ld0Nsb3Nlc3RFbDtcbiAgICAgICAgZWwuZW1pdCgnaGl0Y2xvc2VzdCcsIHRoaXMuaGl0Q2xvc2VzdEV2ZW50RGV0YWlsKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2xlYXJlZEludGVyc2VjdGVkRWxzLmxlbmd0aCkge1xuICAgICAgZWwuZW1pdCgnaGl0ZW5kJyk7XG4gICAgfVxuXG4gICAgaWYgKG5ld0ludGVyc2VjdGVkRWxzLmxlbmd0aCkge1xuICAgICAgZWwuZW1pdCgnaGl0c3RhcnQnLCB0aGlzLmhpdFN0YXJ0RXZlbnREZXRhaWwpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQUFCQiBjb2xsaXNpb24gZGV0ZWN0aW9uLlxuICAgKiAzRCB2ZXJzaW9uIG9mIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9Z2hxRDNlMzdSN0VcbiAgICovXG4gIGlzSW50ZXJzZWN0aW5nOiAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBib3VuZGluZ0JveCA9IG5ldyBUSFJFRS5Cb3gzKCk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKGVsKSB7XG4gICAgICB2YXIgaXNJbnRlcnNlY3Rpbmc7XG4gICAgICB2YXIgYm94SGVscGVyO1xuICAgICAgdmFyIGJveE1pbjtcbiAgICAgIHZhciBib3hNYXg7XG5cbiAgICAgIGJvdW5kaW5nQm94LnNldEZyb21PYmplY3QoZWwub2JqZWN0M0QpO1xuXG4gICAgICBpZiAodGhpcy5kYXRhLmRlYnVnKSB7XG4gICAgICAgIGlmICghZWwub2JqZWN0M0QuYm94SGVscGVyKSB7XG4gICAgICAgICAgZWwub2JqZWN0M0QuYm94SGVscGVyID0gbmV3IFRIUkVFLkJveEhlbHBlcihcbiAgICAgICAgICAgIGVsLm9iamVjdDNELCBuZXcgVEhSRUUuQ29sb3IoTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKSwgTWF0aC5yYW5kb20oKSkpO1xuICAgICAgICAgIGVsLnNjZW5lRWwub2JqZWN0M0QuYWRkKGVsLm9iamVjdDNELmJveEhlbHBlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWwub2JqZWN0M0QuYm94SGVscGVyLnNldEZyb21PYmplY3QoZWwub2JqZWN0M0QpO1xuICAgICAgfVxuXG4gICAgICBib3hNaW4gPSBib3VuZGluZ0JveC5taW47XG4gICAgICBib3hNYXggPSBib3VuZGluZ0JveC5tYXg7XG4gICAgICBlbC5vYmplY3QzRC5ib3VuZGluZ0JveENlbnRlciA9IGVsLm9iamVjdDNELmJvdW5kaW5nQm94Q2VudGVyIHx8IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgICBib3VuZGluZ0JveC5nZXRDZW50ZXIoZWwub2JqZWN0M0QuYm91bmRpbmdCb3hDZW50ZXIpO1xuICAgICAgcmV0dXJuICh0aGlzLmJveE1pbi54IDw9IGJveE1heC54ICYmIHRoaXMuYm94TWF4LnggPj0gYm94TWluLngpICYmXG4gICAgICAgICAgICAgKHRoaXMuYm94TWluLnkgPD0gYm94TWF4LnkgJiYgdGhpcy5ib3hNYXgueSA+PSBib3hNaW4ueSkgJiZcbiAgICAgICAgICAgICAodGhpcy5ib3hNaW4ueiA8PSBib3hNYXgueiAmJiB0aGlzLmJveE1heC56ID49IGJveE1pbi56KTtcbiAgICB9O1xuICB9KSgpLFxuXG4gIC8qKlxuICAgKiBNYXJrIHRoZSBvYmplY3QgbGlzdCBhcyBkaXJ0eSwgdG8gYmUgcmVmcmVzaGVkIGJlZm9yZSBuZXh0IHJheWNhc3QuXG4gICAqL1xuICBzZXREaXJ0eTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZGlydHkgPSB0cnVlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBVcGRhdGUgbGlzdCBvZiBvYmplY3RzIHRvIHRlc3QgZm9yIGludGVyc2VjdGlvbi5cbiAgICovXG4gIHJlZnJlc2hPYmplY3RzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgLy8gSWYgb2JqZWN0cyBub3QgZGVmaW5lZCwgaW50ZXJzZWN0IHdpdGggZXZlcnl0aGluZy5cbiAgICB0aGlzLm9iamVjdEVscyA9IGRhdGEub2JqZWN0c1xuICAgICAgPyB0aGlzLmVsLnNjZW5lRWwucXVlcnlTZWxlY3RvckFsbChkYXRhLm9iamVjdHMpXG4gICAgICA6IHRoaXMuZWwuc2NlbmVFbC5jaGlsZHJlbjtcbiAgICB0aGlzLmRpcnR5ID0gZmFsc2U7XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBjb3B5QXJyYXkgKGRlc3QsIHNvdXJjZSkge1xuICB2YXIgaTtcbiAgZGVzdC5sZW5ndGggPSAwO1xuICBmb3IgKGkgPSAwOyBpIDwgc291cmNlLmxlbmd0aDsgaSsrKSB7IGRlc3RbaV0gPSBzb3VyY2VbaV07IH1cbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtYWFiYi1jb2xsaWRlci1jb21wb25lbnQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDIwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImlmICh0eXBlb2YgQUZSQU1FID09PSAndW5kZWZpbmVkJykge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0NvbXBvbmVudCBhdHRlbXB0ZWQgdG8gcmVnaXN0ZXIgYmVmb3JlIEFGUkFNRSB3YXMgYXZhaWxhYmxlLicpO1xufVxuXG52YXIgYXVkaW9CdWZmZXJDYWNoZSA9IHt9O1xuXG4vKipcbiAqIEF1ZGlvIHZpc3VhbGl6ZXIgY29tcG9uZW50IGZvciBBLUZyYW1lIHVzaW5nIEFuYWx5c2VyTm9kZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdhdWRpb2FuYWx5c2VyJywge1xuICBzY2hlbWE6IHtcbiAgICBidWZmZXI6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgYmVhdERldGVjdGlvbkRlY2F5OiB7ZGVmYXVsdDogMC45OX0sXG4gICAgYmVhdERldGVjdGlvbk1pblZvbHVtZToge2RlZmF1bHQ6IDE1fSxcbiAgICBiZWF0RGV0ZWN0aW9uVGhyb3R0bGU6IHtkZWZhdWx0OiAyNTB9LFxuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVCZWF0RGV0ZWN0aW9uOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlTGV2ZWxzOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlV2F2ZWZvcm06IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVWb2x1bWU6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBmZnRTaXplOiB7ZGVmYXVsdDogMjA0OH0sXG4gICAgc21vb3RoaW5nVGltZUNvbnN0YW50OiB7ZGVmYXVsdDogMC44fSxcbiAgICBzcmM6IHtcbiAgICAgIHBhcnNlOiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgIGlmICh2YWwuY29uc3RydWN0b3IgIT09IFN0cmluZykgeyByZXR1cm4gdmFsOyB9XG4gICAgICAgIGlmICh2YWwuc3RhcnRzV2l0aCgnIycpIHx8IHZhbC5zdGFydHNXaXRoKCcuJykpIHtcbiAgICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih2YWwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgICB9XG4gICAgfSxcbiAgICB1bmlxdWU6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFuYWx5c2VyO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBnYWluTm9kZVxuXG4gICAgdGhpcy5hdWRpb0VsID0gbnVsbDtcbiAgICB0aGlzLmNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCk7XG4gICAgdGhpcy5sZXZlbHMgPSBudWxsO1xuICAgIHRoaXMud2F2ZWZvcm0gPSBudWxsO1xuICAgIHRoaXMudm9sdW1lID0gMDtcbiAgICB0aGlzLnhociA9IG51bGw7XG5cbiAgICBhbmFseXNlciA9IHRoaXMuYW5hbHlzZXIgPSB0aGlzLmNvbnRleHQuY3JlYXRlQW5hbHlzZXIoKTtcbiAgICBnYWluTm9kZSA9IHRoaXMuZ2Fpbk5vZGUgPSB0aGlzLmNvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgIGdhaW5Ob2RlLmNvbm5lY3QoYW5hbHlzZXIpO1xuICAgIGFuYWx5c2VyLmNvbm5lY3QodGhpcy5jb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICBhbmFseXNlci5mZnRTaXplID0gZGF0YS5mZnRTaXplO1xuICAgIGFuYWx5c2VyLnNtb290aGluZ1RpbWVDb25zdGFudCA9IGRhdGEuc21vb3RoaW5nVGltZUNvbnN0YW50O1xuICAgIHRoaXMubGV2ZWxzID0gbmV3IFVpbnQ4QXJyYXkoYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnQpO1xuICAgIHRoaXMud2F2ZWZvcm0gPSBuZXcgVWludDhBcnJheShhbmFseXNlci5mZnRTaXplKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGFuYWx5c2VyID0gdGhpcy5hbmFseXNlcjtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIC8vIFVwZGF0ZSBhbmFseXNlciBzdHVmZi5cbiAgICBpZiAob2xkRGF0YS5mZnRTaXplICE9PSBkYXRhLmZmdFNpemUgfHxcbiAgICAgICAgb2xkRGF0YS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQgIT09IGRhdGEuc21vb3RoaW5nVGltZUNvbnN0YW50KSB7XG4gICAgICBhbmFseXNlci5mZnRTaXplID0gZGF0YS5mZnRTaXplO1xuICAgICAgYW5hbHlzZXIuc21vb3RoaW5nVGltZUNvbnN0YW50ID0gZGF0YS5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ7XG4gICAgICB0aGlzLmxldmVscyA9IG5ldyBVaW50OEFycmF5KGFuYWx5c2VyLmZyZXF1ZW5jeUJpbkNvdW50KTtcbiAgICAgIHRoaXMud2F2ZWZvcm0gPSBuZXcgVWludDhBcnJheShhbmFseXNlci5mZnRTaXplKTtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGEuc3JjKSB7IHJldHVybjsgfVxuICAgIHRoaXMucmVmcmVzaFNvdXJjZSgpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBVcGRhdGUgc3BlY3RydW0gb24gZWFjaCBmcmFtZS5cbiAgICovXG4gIHRpY2s6IGZ1bmN0aW9uICh0LCBkdCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciB2b2x1bWU7XG5cbiAgICBpZiAoIWRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgIC8vIExldmVscyAoZnJlcXVlbmN5KS5cbiAgICBpZiAoZGF0YS5lbmFibGVMZXZlbHMgfHwgZGF0YS5lbmFibGVWb2x1bWUpIHtcbiAgICAgIHRoaXMuYW5hbHlzZXIuZ2V0Qnl0ZUZyZXF1ZW5jeURhdGEodGhpcy5sZXZlbHMpO1xuICAgIH1cblxuICAgIC8vIFdhdmVmb3JtLlxuICAgIGlmIChkYXRhLmVuYWJsZVdhdmVmb3JtKSB7XG4gICAgICB0aGlzLmFuYWx5c2VyLmdldEJ5dGVUaW1lRG9tYWluRGF0YSh0aGlzLndhdmVmb3JtKTtcbiAgICB9XG5cbiAgICAvLyBBdmVyYWdlIHZvbHVtZS5cbiAgICBpZiAoZGF0YS5lbmFibGVWb2x1bWUgfHwgZGF0YS5lbmFibGVCZWF0RGV0ZWN0aW9uKSB7XG4gICAgICB2YXIgc3VtID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZXZlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc3VtICs9IHRoaXMubGV2ZWxzW2ldOztcbiAgICAgIH1cbiAgICAgIHRoaXMudm9sdW1lID0gc3VtIC8gdGhpcy5sZXZlbHMubGVuZ3RoO1xuICAgIH1cblxuICAgIC8vIEJlYXQgZGV0ZWN0aW9uLlxuICAgIGlmIChkYXRhLmVuYWJsZUJlYXREZXRlY3Rpb24pIHtcbiAgICAgIHZvbHVtZSA9IHRoaXMudm9sdW1lO1xuICAgICAgaWYgKCF0aGlzLmJlYXRDdXRPZmYpIHsgdGhpcy5iZWF0Q3V0T2ZmID0gdm9sdW1lOyB9XG4gICAgICBpZiAodm9sdW1lID4gdGhpcy5iZWF0Q3V0T2ZmICYmIHZvbHVtZSA+IHRoaXMuZGF0YS5iZWF0RGV0ZWN0aW9uTWluVm9sdW1lKSB7XG4gICAgICAgIHRoaXMuZWwuZW1pdCgnYXVkaW9hbmFseXNlcmJlYXQnLCBudWxsLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuYmVhdEN1dE9mZiA9IHZvbHVtZSAqIDEuNTtcbiAgICAgICAgdGhpcy5iZWF0VGltZSA9IDA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5iZWF0VGltZSA8PSB0aGlzLmRhdGEuYmVhdERldGVjdGlvblRocm90dGxlKSB7XG4gICAgICAgICAgdGhpcy5iZWF0VGltZSArPSBkdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmJlYXRDdXRPZmYgKj0gdGhpcy5kYXRhLmJlYXREZXRlY3Rpb25EZWNheTtcbiAgICAgICAgICB0aGlzLmJlYXRDdXRPZmYgPSBNYXRoLm1heCh0aGlzLmJlYXRDdXRPZmYsIHRoaXMuZGF0YS5iZWF0RGV0ZWN0aW9uTWluVm9sdW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICByZWZyZXNoU291cmNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFuYWx5c2VyID0gdGhpcy5hbmFseXNlcjtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGlmIChkYXRhLmJ1ZmZlciAmJiBkYXRhLnNyYy5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XG4gICAgICB0aGlzLmdldEJ1ZmZlclNvdXJjZSgpLnRoZW4oc291cmNlID0+IHtcbiAgICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIHRoaXMuc291cmNlLmNvbm5lY3QodGhpcy5nYWluTm9kZSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zb3VyY2UgPSB0aGlzLmdldE1lZGlhU291cmNlKCk7XG4gICAgICB0aGlzLnNvdXJjZS5jb25uZWN0KHRoaXMuZ2Fpbk5vZGUpO1xuICAgIH1cbiAgfSxcblxuICBzdXNwZW5kQ29udGV4dDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY29udGV4dC5zdXNwZW5kKCk7XG4gIH0sXG5cbiAgcmVzdW1lQ29udGV4dDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY29udGV4dC5yZXN1bWUoKTtcbiAgfSxcblxuICAvKipcbiAgICogRmV0Y2ggYW5kIHBhcnNlIGJ1ZmZlciB0byBhdWRpbyBidWZmZXIuIFJlc29sdmUgYSBzb3VyY2UuXG4gICAqL1xuICBmZXRjaEF1ZGlvQnVmZmVyOiBmdW5jdGlvbiAoc3JjKSB7XG4gICAgLy8gRnJvbSBjYWNoZS5cbiAgICBpZiAoYXVkaW9CdWZmZXJDYWNoZVtzcmNdKSB7XG4gICAgICBpZiAoYXVkaW9CdWZmZXJDYWNoZVtzcmNdLmNvbnN0cnVjdG9yID09PSBQcm9taXNlKSB7XG4gICAgICAgIHJldHVybiBhdWRpb0J1ZmZlckNhY2hlW3NyY107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGF1ZGlvQnVmZmVyQ2FjaGVbc3JjXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXVkaW9CdWZmZXJDYWNoZVtzcmNdID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAvLyBGZXRjaCBpZiBkb2VzIG5vdCBleGlzdC5cbiAgICAgIGNvbnN0IHhociA9IHRoaXMueGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICB4aHIub3BlbignR0VUJywgc3JjKTtcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY29udGV4dC5kZWNvZGVBdWRpb0RhdGEoeGhyLnJlc3BvbnNlKS50aGVuKGF1ZGlvQnVmZmVyID0+IHtcbiAgICAgICAgICBhdWRpb0J1ZmZlckNhY2hlW3NyY10gPSBhdWRpb0J1ZmZlcjtcbiAgICAgICAgICByZXNvbHZlKGF1ZGlvQnVmZmVyKTtcbiAgICAgICAgfSkuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gICAgICB9KTtcbiAgICAgIHhoci5zZW5kKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGF1ZGlvQnVmZmVyQ2FjaGVbc3JjXTtcbiAgfSxcblxuICBnZXRCdWZmZXJTb3VyY2U6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICByZXR1cm4gdGhpcy5mZXRjaEF1ZGlvQnVmZmVyKGRhdGEuc3JjKS50aGVuKCgpID0+IHtcbiAgICAgIHZhciBzb3VyY2U7XG4gICAgICBzb3VyY2UgPSB0aGlzLmNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICBzb3VyY2UuYnVmZmVyID0gYXVkaW9CdWZmZXJDYWNoZVtkYXRhLnNyY107XG4gICAgICB0aGlzLmVsLmVtaXQoJ2F1ZGlvYW5hbHlzZXJidWZmZXJzb3VyY2UnLCBzb3VyY2UsIGZhbHNlKTtcbiAgICAgIHJldHVybiBzb3VyY2U7XG4gICAgfSkuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gIH0sXG5cbiAgZ2V0TWVkaWFTb3VyY2U6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kYXRhLnNyYy5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XG4gICAgICBpZiAoIXRoaXMuYXVkaW8pIHtcbiAgICAgICAgdGhpcy5hdWRpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2F1ZGlvJyk7XG4gICAgICAgIHRoaXMuYXVkaW8uY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJztcbiAgICAgIH1cbiAgICAgIHRoaXMuYXVkaW8uc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLmRhdGEuc3JjKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hdWRpbyA9IHRoaXMuZGF0YS5zcmM7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmNvbnRleHQuY3JlYXRlTWVkaWFFbGVtZW50U291cmNlKHRoaXMuYXVkaW8pXG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1hdWRpb2FuYWx5c2VyLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyogZ2xvYmFsIEFGUkFNRSAqL1xudmFyIHN0eWxlUGFyc2VyID0gQUZSQU1FLnV0aWxzLnN0eWxlUGFyc2VyO1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdldmVudC1zZXQnLCB7XG4gIHNjaGVtYToge1xuICAgIGRlZmF1bHQ6ICcnLFxuICAgIHBhcnNlOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiBzdHlsZVBhcnNlci5wYXJzZSh2YWx1ZSk7XG4gICAgfVxuICB9LFxuXG4gIG11bHRpcGxlOiB0cnVlLFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmV2ZW50SGFuZGxlciA9IG51bGw7XG4gICAgdGhpcy5ldmVudE5hbWUgPSBudWxsO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICB0aGlzLnVwZGF0ZUV2ZW50TGlzdGVuZXIoKTtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoKTtcbiAgfSxcblxuICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoKTtcbiAgfSxcblxuICBwYXVzZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigpO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoKTtcbiAgfSxcblxuICAvKipcbiAgICogVXBkYXRlIHNvdXJjZS1vZi10cnV0aCBldmVudCBsaXN0ZW5lciByZWdpc3RyeS5cbiAgICogRG9lcyBub3QgYWN0dWFsbHkgYXR0YWNoIGV2ZW50IGxpc3RlbmVycyB5ZXQuXG4gICAqL1xuICB1cGRhdGVFdmVudExpc3RlbmVyOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgZXZlbnQ7XG4gICAgdmFyIHRhcmdldDtcbiAgICB2YXIgdGFyZ2V0RWw7XG5cbiAgICAvLyBTZXQgZXZlbnQgbGlzdGVuZXIgdXNpbmcgYF9ldmVudGAuXG4gICAgZXZlbnQgPSBkYXRhLl9ldmVudCB8fCB0aGlzLmlkO1xuICAgIHRhcmdldCA9IGRhdGEuX3RhcmdldDtcblxuICAgIC8vIERlY2lkZSB0aGUgdGFyZ2V0IHRvIGBzZXRBdHRyaWJ1dGVgIG9uLlxuICAgIHRhcmdldEVsID0gdGFyZ2V0ID8gZWwuc2NlbmVFbC5xdWVyeVNlbGVjdG9yKHRhcmdldCkgOiBlbDtcblxuICAgIHRoaXMuZXZlbnROYW1lID0gZXZlbnQ7XG4gICAgdGhpcy5ldmVudEhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyICgpIHtcbiAgICAgIHZhciBwcm9wTmFtZTtcbiAgICAgIC8vIFNldCBhdHRyaWJ1dGVzLlxuICAgICAgZm9yIChwcm9wTmFtZSBpbiBkYXRhKSB7XG4gICAgICAgIGlmIChwcm9wTmFtZSA9PT0gJ19ldmVudCcgfHwgcHJvcE5hbWUgPT09ICdfdGFyZ2V0JykgeyBjb250aW51ZTsgfVxuICAgICAgICBBRlJBTUUudXRpbHMuZW50aXR5LnNldENvbXBvbmVudFByb3BlcnR5LmNhbGwodGhpcywgdGFyZ2V0RWwsIHByb3BOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVtwcm9wTmFtZV0pO1xuICAgICAgfVxuICAgIH07XG4gIH0sXG5cbiAgYWRkRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmV2ZW50TmFtZSwgdGhpcy5ldmVudEhhbmRsZXIpO1xuICB9LFxuXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5ldmVudE5hbWUsIHRoaXMuZXZlbnRIYW5kbGVyKTtcbiAgfVxufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLWV2ZW50LXNldC1jb21wb25lbnQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDIyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImlmICghVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscykge1xuICByZXF1aXJlKCcuL2xpYi9CdWZmZXJHZW9tZXRyeVV0aWxzJyk7XG59XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZ2VvbWV0cnktbWVyZ2VyJywge1xuICBzY2hlbWE6IHtcbiAgICBwcmVzZXJ2ZU9yaWdpbmFsOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBmYWNlSW5kZXhFbmQ7XG4gICAgdmFyIGZhY2VJbmRleFN0YXJ0O1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIHRoaXMuZ2VvbWV0cnkgPSBuZXcgVEhSRUUuR2VvbWV0cnkoKTtcbiAgICB0aGlzLm1lc2ggPSBuZXcgVEhSRUUuTWVzaCh0aGlzLmdlb21ldHJ5KTtcbiAgICB0aGlzLmVsLnNldE9iamVjdDNEKCdtZXNoJywgdGhpcy5tZXNoKTtcblxuICAgIHRoaXMuZmFjZUluZGV4ID0ge307ICAvLyBLZWVwIGluZGV4IG9mIG9yaWdpbmFsIGVudGl0eSBVVUlEIHRvIG5ldyBmYWNlIGFycmF5LlxuICAgIHRoaXMudmVydGV4SW5kZXggPSB7fTsgIC8vIEtlZXAgaW5kZXggb2Ygb3JpZ2luYWwgZW50aXR5IFVVSUQgdG8gdmVydGV4IGFycmF5LlxuXG4gICAgdGhpcy5lbC5vYmplY3QzRC50cmF2ZXJzZShmdW5jdGlvbiAobWVzaCkge1xuICAgICAgaWYgKG1lc2gudHlwZSAhPT0gJ01lc2gnKSB7IHJldHVybjsgfVxuICAgICAgaWYgKG1lc2ggPT09IHNlbGYubWVzaCkgeyByZXR1cm47IH1cblxuICAgICAgc2VsZi5mYWNlSW5kZXhbbWVzaC5wYXJlbnQudXVpZF0gPSBbXG4gICAgICAgIHNlbGYuZ2VvbWV0cnkuZmFjZXMubGVuZ3RoLFxuICAgICAgICBzZWxmLmdlb21ldHJ5LmZhY2VzLmxlbmd0aCArIG1lc2guZ2VvbWV0cnkuZmFjZXMubGVuZ3RoIC0gMVxuICAgICAgXTtcblxuICAgICAgc2VsZi52ZXJ0ZXhJbmRleFttZXNoLnBhcmVudC51dWlkXSA9IFtcbiAgICAgICAgc2VsZi5nZW9tZXRyeS52ZXJ0aWNlcy5sZW5ndGgsXG4gICAgICAgIHNlbGYuZ2VvbWV0cnkudmVydGljZXMubGVuZ3RoICsgbWVzaC5nZW9tZXRyeS52ZXJ0aWNlcy5sZW5ndGggLSAxXG4gICAgICBdO1xuXG4gICAgICAvLyBNZXJnZS4gVXNlIHBhcmVudCdzIG1hdHJpeCBkdWUgdG8gQS1GcmFtZSdzIDxhLWVudGl0eT4oR3JvdXAtTWVzaCkgaGllcmFyY2h5LlxuICAgICAgbWVzaC5wYXJlbnQudXBkYXRlTWF0cml4KCk7XG4gICAgICBzZWxmLmdlb21ldHJ5Lm1lcmdlKG1lc2guZ2VvbWV0cnksIG1lc2gucGFyZW50Lm1hdHJpeCk7XG5cbiAgICAgIC8vIFJlbW92ZSBtZXNoIGlmIG5vdCBwcmVzZXJ2aW5nLlxuICAgICAgaWYgKCFzZWxmLmRhdGEucHJlc2VydmVPcmlnaW5hbCkgeyBtZXNoLnBhcmVudC5yZW1vdmUobWVzaCk7IH1cbiAgICB9KTtcbiAgfVxufSk7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYnVmZmVyLWdlb21ldHJ5LW1lcmdlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgcHJlc2VydmVPcmlnaW5hbDoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZ2VvbWV0cmllcyA9IFtdO1xuXG4gICAgdGhpcy5lbC5zY2VuZUVsLm9iamVjdDNELnVwZGF0ZU1hdHJpeFdvcmxkKClcbiAgICB0aGlzLmVsLm9iamVjdDNELnRyYXZlcnNlKGZ1bmN0aW9uIChtZXNoKSB7XG4gICAgICBpZiAobWVzaC50eXBlICE9PSAnTWVzaCcgfHwgbWVzaC5lbCA9PT0gc2VsZi5lbCkgeyByZXR1cm47IH1cbiAgICAgIG1lc2guZ2VvbWV0cnkuYXBwbHlNYXRyaXgobWVzaC5tYXRyaXhXb3JsZCk7XG4gICAgICBnZW9tZXRyaWVzLnB1c2gobWVzaC5nZW9tZXRyeS5jbG9uZSgpKTtcbiAgICAgIG1lc2gucGFyZW50LnJlbW92ZShtZXNoKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGdlb21ldHJ5ID0gVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscy5tZXJnZUJ1ZmZlckdlb21ldHJpZXMoZ2VvbWV0cmllcyk7XG4gICAgdGhpcy5tZXNoID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnkpO1xuICAgIHRoaXMuZWwuc2V0T2JqZWN0M0QoJ21lc2gnLCB0aGlzLm1lc2gpO1xuICB9XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtZ2VvbWV0cnktbWVyZ2VyLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyogZ2xvYmFsIEFGUkFNRSAqL1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuLyoqXG4gKiBIYXB0aWNzIGNvbXBvbmVudCBmb3IgQS1GcmFtZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdoYXB0aWNzJywge1xuICBkZXBlbmRlbmNpZXM6IFsndHJhY2tlZC1jb250cm9scyddLFxuXG4gIHNjaGVtYToge1xuICAgIGFjdHVhdG9ySW5kZXg6IHtkZWZhdWx0OiAwfSxcbiAgICBkdXI6IHtkZWZhdWx0OiAxMDB9LFxuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBldmVudHM6IHt0eXBlOiAnYXJyYXknfSxcbiAgICBldmVudHNGcm9tOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGZvcmNlOiB7ZGVmYXVsdDogMX1cbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGk7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgdGhpcy5jYWxsUHVsc2UgPSBmdW5jdGlvbiAoKSB7IHNlbGYucHVsc2UoKTsgfTtcblxuICAgIGlmICh0aGlzLmVsLmNvbXBvbmVudHNbJ3RyYWNrZWQtY29udHJvbHMnXS5jb250cm9sbGVyKSB7XG4gICAgICB0aGlzLmdhbWVwYWQgPSB0aGlzLmVsLmNvbXBvbmVudHNbJ3RyYWNrZWQtY29udHJvbHMnXS5jb250cm9sbGVyO1xuICAgICAgaWYgKCF0aGlzLmdhbWVwYWQgfHwgIXRoaXMuZ2FtZXBhZC5oYXB0aWNBY3R1YXRvcnMubGVuZ3RoKSB7IHJldHVybjsgfVxuICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCBmdW5jdGlvbiBpbml0ICgpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2VsZi5nYW1lcGFkID0gc2VsZi5lbC5jb21wb25lbnRzWyd0cmFja2VkLWNvbnRyb2xzJ10uY29udHJvbGxlcjtcbiAgICAgICAgICBpZiAoIXNlbGYuZ2FtZXBhZCB8fCAhc2VsZi5nYW1lcGFkLmhhcHRpY0FjdHVhdG9ycy5sZW5ndGgpIHsgcmV0dXJuOyB9XG4gICAgICAgICAgc2VsZi5hZGRFdmVudExpc3RlbmVycygpO1xuICAgICAgICB9LCAxNTApO1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIHJlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgfSxcblxuICBwdWxzZTogZnVuY3Rpb24gKGZvcmNlLCBkdXIpIHtcbiAgICB2YXIgYWN0dWF0b3I7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgaWYgKCFkYXRhLmVuYWJsZWQgfHwgIXRoaXMuZ2FtZXBhZCB8fCAhdGhpcy5nYW1lcGFkLmhhcHRpY0FjdHVhdG9ycykgeyByZXR1cm47IH1cbiAgICBhY3R1YXRvciA9IHRoaXMuZ2FtZXBhZC5oYXB0aWNBY3R1YXRvcnNbZGF0YS5hY3R1YXRvckluZGV4XTtcbiAgICBhY3R1YXRvci5wdWxzZShmb3JjZSB8fCBkYXRhLmZvcmNlLCBkdXIgfHwgZGF0YS5kdXIpO1xuICB9LFxuXG4gIGFkZEV2ZW50TGlzdGVuZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGk7XG4gICAgdmFyIGxpc3RlblRhcmdldDtcblxuICAgIGxpc3RlblRhcmdldCA9IGRhdGEuZXZlbnRzRnJvbSA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5ldmVudHNGcm9tKSA6IHRoaXMuZWw7XG4gICAgZm9yIChpID0gMDsgaSA8IGRhdGEuZXZlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsaXN0ZW5UYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihkYXRhLmV2ZW50c1tpXSwgdGhpcy5jYWxsUHVsc2UpO1xuICAgIH1cbiAgfSxcblxuICByZW1vdmVFdmVudExpc3RlbmVyczogZnVuY3Rpb24gKCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBpO1xuICAgIHZhciBsaXN0ZW5UYXJnZXQ7XG5cbiAgICBsaXN0ZW5UYXJnZXQgPSBkYXRhLmV2ZW50c0Zyb20gPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRhdGEuZXZlbnRzRnJvbSkgOiB0aGlzLmVsO1xuICAgIGZvciAoaSA9IDA7IGkgPCBkYXRhLmV2ZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgbGlzdGVuVGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZGF0YS5ldmVudHNbaV0sIHRoaXMuY2FsbFB1bHNlKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1oYXB0aWNzLWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIHBvc2l0aW9ucyA9IFtdO1xudmFyIHBvc2l0aW9uSGVscGVyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuLyoqXG4gKiBMYXlvdXQgY29tcG9uZW50IGZvciBBLUZyYW1lLlxuICogU29tZSBsYXlvdXRzIGFkYXB0ZWQgZnJvbSBodHRwOi8vd3d3LnZiLWhlbHBlci5jb20vdHV0b3JpYWxfcGxhdG9uaWNfc29saWRzLmh0bWxcbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdsYXlvdXQnLCB7XG4gIHNjaGVtYToge1xuICAgIGFuZ2xlOiB7dHlwZTogJ251bWJlcicsIGRlZmF1bHQ6IGZhbHNlLCBtaW46IDAsIG1heDogMzYwLCBpZjoge3R5cGU6IFsnY2lyY2xlJ119fSxcbiAgICBjb2x1bW5zOiB7ZGVmYXVsdDogMSwgbWluOiAwLCBpZjoge3R5cGU6IFsnYm94J119fSxcbiAgICBtYXJnaW46IHtkZWZhdWx0OiAxLCBtaW46IDAsIGlmOiB7dHlwZTogWydib3gnLCAnbGluZSddfX0sXG4gICAgbWFyZ2luQ29sdW1uOiB7ZGVmYXVsdDogMSwgbWluOiAwLCBpZjoge3R5cGU6IFsnYm94J119fSxcbiAgICBtYXJnaW5Sb3c6IHtkZWZhdWx0OiAxLCBtaW46IDAsIGlmOiB7dHlwZTogWydib3gnXX19LFxuICAgIG9yZGVyQXR0cmlidXRlOiB7ZGVmYXVsdDogJyd9LFxuICAgIHBsYW5lOiB7ZGVmYXVsdDogJ3h5J30sXG4gICAgcmFkaXVzOiB7ZGVmYXVsdDogMSwgbWluOiAwLCBpZjoge3R5cGU6IFsnY2lyY2xlJywgJ2N1YmUnLCAnZG9kZWNhaGVkcm9uJywgJ3B5cmFtaWQnXX19LFxuICAgIHJldmVyc2U6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgdHlwZToge2RlZmF1bHQ6ICdsaW5lJywgb25lT2Y6IFsnYm94JywgJ2NpcmNsZScsICdjdWJlJywgJ2RvZGVjYWhlZHJvbicsICdsaW5lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdweXJhbWlkJ119LFxuICAgIGZpbGw6IHtkZWZhdWx0OiB0cnVlLCBpZjoge3R5cGU6IFsnY2lyY2xlJ119fSxcbiAgICBhbGlnbjoge2RlZmF1bHQ6ICdlbmQnLCBvbmVPZjogWydzdGFydCcsICdjZW50ZXInLCAnZW5kJ119XG4gIH0sXG5cbiAgLyoqXG4gICAqIFN0b3JlIGluaXRpYWwgcG9zaXRpb25zIGluIGNhc2UgbmVlZCB0byByZXNldCBvbiBjb21wb25lbnQgcmVtb3ZhbC5cbiAgICovXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcblxuICAgIHRoaXMuY2hpbGRyZW4gPSBlbC5nZXRDaGlsZEVudGl0aWVzKCk7XG4gICAgdGhpcy5pbml0aWFsUG9zaXRpb25zID0gW107XG5cbiAgICB0aGlzLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gZ2V0SW5pdGlhbFBvc2l0aW9ucyAoY2hpbGRFbCkge1xuICAgICAgaWYgKGNoaWxkRWwuaGFzTG9hZGVkKSB7IHJldHVybiBfZ2V0UG9zaXRpb25zKCk7IH1cbiAgICAgIGNoaWxkRWwuYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkJywgX2dldFBvc2l0aW9ucyk7XG4gICAgICBmdW5jdGlvbiBfZ2V0UG9zaXRpb25zICgpIHtcbiAgICAgICAgc2VsZi5pbml0aWFsUG9zaXRpb25zLnB1c2goY2hpbGRFbC5vYmplY3QzRC5wb3NpdGlvbi54KTtcbiAgICAgICAgc2VsZi5pbml0aWFsUG9zaXRpb25zLnB1c2goY2hpbGRFbC5vYmplY3QzRC5wb3NpdGlvbi55KTtcbiAgICAgICAgc2VsZi5pbml0aWFsUG9zaXRpb25zLnB1c2goY2hpbGRFbC5vYmplY3QzRC5wb3NpdGlvbi56KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuaGFuZGxlQ2hpbGRBdHRhY2hlZCA9IHRoaXMuaGFuZGxlQ2hpbGRBdHRhY2hlZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlQ2hpbGREZXRhY2hlZCA9IHRoaXMuaGFuZGxlQ2hpbGREZXRhY2hlZC5iaW5kKHRoaXMpO1xuXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hpbGQtYXR0YWNoZWQnLCB0aGlzLmhhbmRsZUNoaWxkQXR0YWNoZWQpO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoaWxkLWRldGFjaGVkJywgdGhpcy5oYW5kbGVDaGlsZERldGFjaGVkKTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdsYXlvdXRyZWZyZXNoJywgdGhpcy51cGRhdGUuYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBjaGlsZCBlbnRpdHkgcG9zaXRpb25zLlxuICAgKi9cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHZhciBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW47XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGRlZmluZWREYXRhO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIG51bUNoaWxkcmVuO1xuICAgIHZhciBwb3NpdGlvbkZuO1xuXG4gICAgbnVtQ2hpbGRyZW4gPSBjaGlsZHJlbi5sZW5ndGg7XG5cbiAgICAvLyBDYWxjdWxhdGUgZGlmZmVyZW50IHBvc2l0aW9ucyBiYXNlZCBvbiBsYXlvdXQgc2hhcGUuXG4gICAgc3dpdGNoIChkYXRhLnR5cGUpIHtcbiAgICAgIGNhc2UgJ2JveCc6IHtcbiAgICAgICAgcG9zaXRpb25GbiA9IGdldEJveFBvc2l0aW9ucztcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdjaXJjbGUnOiB7XG4gICAgICAgIHBvc2l0aW9uRm4gPSBnZXRDaXJjbGVQb3NpdGlvbnM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnY3ViZSc6IHtcbiAgICAgICAgcG9zaXRpb25GbiA9IGdldEN1YmVQb3NpdGlvbnM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnZG9kZWNhaGVkcm9uJzoge1xuICAgICAgICBwb3NpdGlvbkZuID0gZ2V0RG9kZWNhaGVkcm9uUG9zaXRpb25zO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ3B5cmFtaWQnOiB7XG4gICAgICAgIHBvc2l0aW9uRm4gPSBnZXRQeXJhbWlkUG9zaXRpb25zO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgLy8gTGluZS5cbiAgICAgICAgcG9zaXRpb25GbiA9IGdldExpbmVQb3NpdGlvbnM7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZGVmaW5lZERhdGEgPSBlbC5nZXRET01BdHRyaWJ1dGUoJ2xheW91dCcpO1xuICAgIHBvc2l0aW9ucy5sZW5ndGggPSAwO1xuICAgIHBvc2l0aW9ucyA9IHBvc2l0aW9uRm4oXG4gICAgICBkYXRhLCBudW1DaGlsZHJlbixcbiAgICAgIHR5cGVvZiBkZWZpbmVkRGF0YSA9PT0gJ3N0cmluZydcbiAgICAgICAgPyBkZWZpbmVkRGF0YS5pbmRleE9mKCdtYXJnaW4nKSAhPT0gLTFcbiAgICAgICAgOiAnbWFyZ2luJyBpbiBkZWZpbmVkRGF0YVxuICAgICk7XG4gICAgaWYgKGRhdGEucmV2ZXJzZSkgeyBwb3NpdGlvbnMucmV2ZXJzZSgpOyB9XG4gICAgc2V0UG9zaXRpb25zKGNoaWxkcmVuLCBwb3NpdGlvbnMsIGRhdGEub3JkZXJBdHRyaWJ1dGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZXNldCBwb3NpdGlvbnMuXG4gICAqL1xuICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoaWxkLWF0dGFjaGVkJywgdGhpcy5oYW5kbGVDaGlsZEF0dGFjaGVkKTtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoaWxkLWRldGFjaGVkJywgdGhpcy5oYW5kbGVDaGlsZERldGFjaGVkKTtcbiAgICBzZXRQb3NpdGlvbnModGhpcy5jaGlsZHJlbiwgdGhpcy5pbml0aWFsUG9zaXRpb25zKTtcbiAgfSxcblxuICBoYW5kbGVDaGlsZEF0dGFjaGVkOiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgLy8gT25seSB1cGRhdGUgaWYgZGlyZWN0IGNoaWxkIGF0dGFjaGVkLlxuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgaWYgKGV2dC5kZXRhaWwuZWwucGFyZW50Tm9kZSAhPT0gZWwpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5jaGlsZHJlbi5wdXNoKGV2dC5kZXRhaWwuZWwpO1xuICAgIHRoaXMudXBkYXRlKCk7XG4gIH0sXG5cbiAgaGFuZGxlQ2hpbGREZXRhY2hlZDogZnVuY3Rpb24gKGV2dCkge1xuICAgIC8vIE9ubHkgdXBkYXRlIGlmIGRpcmVjdCBjaGlsZCBkZXRhY2hlZC5cbiAgICBpZiAodGhpcy5jaGlsZHJlbi5pbmRleE9mKGV2dC5kZXRhaWwuZWwpID09PSAtMSkgeyByZXR1cm47IH1cbiAgICB0aGlzLmNoaWxkcmVuLnNwbGljZSh0aGlzLmNoaWxkcmVuLmluZGV4T2YoZXZ0LmRldGFpbC5lbCksIDEpO1xuICAgIHRoaXMuaW5pdGlhbFBvc2l0aW9ucy5zcGxpY2UodGhpcy5jaGlsZHJlbi5pbmRleE9mKGV2dC5kZXRhaWwuZWwpLCAxKTtcbiAgICB0aGlzLnVwZGF0ZSgpO1xuICB9XG59KTtcblxuLyoqXG4gKiBHZXQgcG9zaXRpb25zIGZvciBgYm94YCBsYXlvdXQuXG4gKi9cbmZ1bmN0aW9uIGdldEJveFBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4sIG1hcmdpbkRlZmluZWQpIHtcbiAgdmFyIGNvbHVtbjtcbiAgdmFyIG1hcmdpbkNvbHVtbjtcbiAgdmFyIG1hcmdpblJvdztcbiAgdmFyIG9mZnNldENvbHVtbjtcbiAgdmFyIG9mZnNldFJvdztcbiAgdmFyIHJvdztcbiAgdmFyIHJvd3MgPSBNYXRoLmNlaWwobnVtQ2hpbGRyZW4gLyBkYXRhLmNvbHVtbnMpO1xuXG4gIG1hcmdpbkNvbHVtbiA9IGRhdGEubWFyZ2luQ29sdW1uO1xuICBtYXJnaW5Sb3cgPSBkYXRhLm1hcmdpblJvdztcbiAgaWYgKG1hcmdpbkRlZmluZWQpIHtcbiAgICBtYXJnaW5Db2x1bW4gPSBkYXRhLm1hcmdpbjtcbiAgICBtYXJnaW5Sb3cgPSBkYXRhLm1hcmdpbjtcbiAgfVxuXG4gIG9mZnNldFJvdyA9IGdldE9mZnNldEl0ZW1JbmRleChkYXRhLmFsaWduLCByb3dzKTtcbiAgb2Zmc2V0Q29sdW1uID0gZ2V0T2Zmc2V0SXRlbUluZGV4KGRhdGEuYWxpZ24sIGRhdGEuY29sdW1ucyk7XG5cbiAgZm9yIChyb3cgPSAwOyByb3cgPCByb3dzOyByb3crKykge1xuICAgIGZvciAoY29sdW1uID0gMDsgY29sdW1uIDwgZGF0YS5jb2x1bW5zOyBjb2x1bW4rKykge1xuICAgICAgcG9zaXRpb25IZWxwZXIuc2V0KDAsIDAsIDApO1xuICAgICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneCcpID09PSAwKSB7XG4gICAgICAgIHBvc2l0aW9uSGVscGVyLnggPSAoY29sdW1uIC0gb2Zmc2V0Q29sdW1uKSAqIG1hcmdpbkNvbHVtbjtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRhLnBsYW5lLmluZGV4T2YoJ3knKSA9PT0gMCkge1xuICAgICAgICBwb3NpdGlvbkhlbHBlci55ID0gKGNvbHVtbiAtIG9mZnNldENvbHVtbikgKiBtYXJnaW5Db2x1bW47XG4gICAgICB9XG4gICAgICBpZiAoZGF0YS5wbGFuZS5pbmRleE9mKCd5JykgPT09IDEpIHtcbiAgICAgICAgcG9zaXRpb25IZWxwZXIueSA9IChyb3cgLSBvZmZzZXRSb3cpICogbWFyZ2luUm93O1xuICAgICAgfVxuICAgICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneicpID09PSAxKSB7XG4gICAgICAgIHBvc2l0aW9uSGVscGVyLnogPSAocm93IC0gb2Zmc2V0Um93KSAqIG1hcmdpblJvdztcbiAgICAgIH1cbiAgICAgIHB1c2hQb3NpdGlvblZlYzMocG9zaXRpb25IZWxwZXIpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwb3NpdGlvbnM7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXRCb3hQb3NpdGlvbnMgPSBnZXRCb3hQb3NpdGlvbnM7XG5cbi8qKlxuICogR2V0IHBvc2l0aW9ucyBmb3IgYGNpcmNsZWAgbGF5b3V0LlxuICovXG5mdW5jdGlvbiBnZXRDaXJjbGVQb3NpdGlvbnMgKGRhdGEsIG51bUNoaWxkcmVuKSB7XG4gIHZhciBpO1xuICB2YXIgcmFkO1xuXG4gIGZvciAoaSA9IDA7IGkgPCBudW1DaGlsZHJlbjsgaSsrKSB7XG4gICAgcmFkO1xuXG4gICAgaWYgKGlzTmFOKGRhdGEuYW5nbGUpKSB7XG4gICAgICByYWQgPSBpICogKDIgKiBNYXRoLlBJKSAvIG51bUNoaWxkcmVuO1xuICAgIH0gZWxzZSB7XG4gICAgICByYWQgPSBpICogZGF0YS5hbmdsZSAqIDAuMDE3NDUzMjkyNTI7ICAvLyBBbmdsZSB0byByYWRpYW4uXG4gICAgfVxuXG4gICAgcG9zaXRpb25IZWxwZXIuc2V0KDAsIDAsIDApO1xuICAgIGlmIChkYXRhLnBsYW5lLmluZGV4T2YoJ3gnKSA9PT0gMCkge1xuICAgICAgcG9zaXRpb25IZWxwZXIueCA9IGRhdGEucmFkaXVzICogTWF0aC5jb3MocmFkKTtcbiAgICB9XG4gICAgaWYgKGRhdGEucGxhbmUuaW5kZXhPZigneScpID09PSAwKSB7XG4gICAgICBwb3NpdGlvbkhlbHBlci55ID0gZGF0YS5yYWRpdXMgKiBNYXRoLmNvcyhyYWQpO1xuICAgIH1cbiAgICBpZiAoZGF0YS5wbGFuZS5pbmRleE9mKCd5JykgPT09IDEpIHtcbiAgICAgIHBvc2l0aW9uSGVscGVyLnkgPSBkYXRhLnJhZGl1cyAqIE1hdGguc2luKHJhZCk7XG4gICAgfVxuICAgIGlmIChkYXRhLnBsYW5lLmluZGV4T2YoJ3onKSA9PT0gMSkge1xuICAgICAgcG9zaXRpb25IZWxwZXIueiA9IGRhdGEucmFkaXVzICogTWF0aC5zaW4ocmFkKTtcbiAgICB9XG4gICAgcHVzaFBvc2l0aW9uVmVjMyhwb3NpdGlvbkhlbHBlcik7XG4gIH1cbiAgcmV0dXJuIHBvc2l0aW9ucztcbn1cbm1vZHVsZS5leHBvcnRzLmdldENpcmNsZVBvc2l0aW9ucyA9IGdldENpcmNsZVBvc2l0aW9ucztcblxuLyoqXG4gKiBHZXQgcG9zaXRpb25zIGZvciBgbGluZWAgbGF5b3V0LlxuICogVE9ETzogM0QgbWFyZ2lucy5cbiAqL1xuZnVuY3Rpb24gZ2V0TGluZVBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4pIHtcbiAgZGF0YS5jb2x1bW5zID0gbnVtQ2hpbGRyZW47XG4gIHJldHVybiBnZXRCb3hQb3NpdGlvbnMoZGF0YSwgbnVtQ2hpbGRyZW4sIHRydWUpO1xufVxubW9kdWxlLmV4cG9ydHMuZ2V0TGluZVBvc2l0aW9ucyA9IGdldExpbmVQb3NpdGlvbnM7XG5cbi8qKlxuICogR2V0IHBvc2l0aW9ucyBmb3IgYGN1YmVgIGxheW91dC5cbiAqL1xuZnVuY3Rpb24gZ2V0Q3ViZVBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4pIHtcbiAgcHVzaFBvc2l0aW9ucyhcbiAgICAxLCAwLCAwLFxuICAgIDAsIDEsIDAsXG4gICAgMCwgMCwgMSxcbiAgICAtMSwgMCwgMCxcbiAgICAwLCAtMSwgMCxcbiAgICAwLCAwLCAtMVxuICApO1xuICBzY2FsZVBvc2l0aW9ucyhkYXRhLnJhZGl1cyAvIDIpO1xuICByZXR1cm4gcG9zaXRpb25zO1xufVxubW9kdWxlLmV4cG9ydHMuZ2V0Q3ViZVBvc2l0aW9ucyA9IGdldEN1YmVQb3NpdGlvbnM7XG5cbi8qKlxuICogR2V0IHBvc2l0aW9ucyBmb3IgYGRvZGVjYWhlZHJvbmAgbGF5b3V0LlxuICovXG5mdW5jdGlvbiBnZXREb2RlY2FoZWRyb25Qb3NpdGlvbnMgKGRhdGEsIG51bUNoaWxkcmVuKSB7XG4gIHZhciBQSEkgPSAoMSArIE1hdGguc3FydCg1KSkgLyAyO1xuICB2YXIgQiA9IDEgLyBQSEk7XG4gIHZhciBDID0gMiAtIFBISTtcbiAgdmFyIE5CID0gLTEgKiBCO1xuICB2YXIgTkMgPSAtMSAqIEM7XG4gIHB1c2hQb3NpdGlvbnMoXG4gICAgLTEsIEMsIDAsXG4gICAgLTEsIE5DLCAwLFxuICAgIDAsIC0xLCBDLFxuICAgIDAsIC0xLCBOQyxcbiAgICAwLCAxLCBDLFxuICAgIDAsIDEsIE5DLFxuICAgIDEsIEMsIDAsXG4gICAgMSwgTkMsIDAsXG4gICAgQiwgQiwgQixcbiAgICBCLCBCLCBOQixcbiAgICBCLCBOQiwgQixcbiAgICBCLCBOQiwgTkIsXG4gICAgQywgMCwgMSxcbiAgICBDLCAwLCAtMSxcbiAgICBOQiwgQiwgQixcbiAgICBOQiwgQiwgTkIsXG4gICAgTkIsIE5CLCBCLFxuICAgIE5CLCBOQiwgTkIsXG4gICAgTkMsIDAsIDEsXG4gICAgTkMsIDAsIC0xXG4gICk7XG4gIHNjYWxlUG9zaXRpb25zKGRhdGEucmFkaXVzIC8gMik7XG4gIHJldHVybiBwb3NpdGlvbnM7XG59XG5tb2R1bGUuZXhwb3J0cy5nZXREb2RlY2FoZWRyb25Qb3NpdGlvbnMgPSBnZXREb2RlY2FoZWRyb25Qb3NpdGlvbnM7XG5cbi8qKlxuICogR2V0IHBvc2l0aW9ucyBmb3IgYHB5cmFtaWRgIGxheW91dC5cbiAqL1xuZnVuY3Rpb24gZ2V0UHlyYW1pZFBvc2l0aW9ucyAoZGF0YSwgbnVtQ2hpbGRyZW4pIHtcbiAgdmFyIFNRUlRfMyA9IE1hdGguc3FydCgzKTtcbiAgdmFyIE5FR19TUVJUXzFfMyA9IC0xIC8gTWF0aC5zcXJ0KDMpO1xuICB2YXIgREJMX1NRUlRfMl8zID0gMiAqIE1hdGguc3FydCgyIC8gMyk7XG4gIHB1c2hQb3NpdGlvbnMoXG4gICAgMCwgMCwgU1FSVF8zICsgTkVHX1NRUlRfMV8zLFxuICAgIC0xLCAwLCBORUdfU1FSVF8xXzMsXG4gICAgMSwgMCwgTkVHX1NRUlRfMV8zLFxuICAgIDAsIERCTF9TUVJUXzJfMywgMFxuICApO1xuICBzY2FsZVBvc2l0aW9ucyhkYXRhLnJhZGl1cyAvIDIpO1xuICByZXR1cm4gcG9zaXRpb25zO1xufVxubW9kdWxlLmV4cG9ydHMuZ2V0UHlyYW1pZFBvc2l0aW9ucyA9IGdldFB5cmFtaWRQb3NpdGlvbnM7XG5cbi8qKlxuICogUmV0dXJuIHRoZSBpdGVtIGluZGV4IGluIGEgZ2l2ZW4gbGlzdCB0byBjYWxjdWxhdGUgb2Zmc2V0cyBmcm9tXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFsaWduIC0gT25lIG9mIGAnc3RhcnQnYCwgYCdjZW50ZXInYCwgYCdlbmQnYFxuICogQHBhcmFtIHtpbnRlZ2VyfSBudW1JdGVtcyAtIFRvdGFsIG51bWJlciBvZiBpdGVtc1xuICovXG5mdW5jdGlvbiBnZXRPZmZzZXRJdGVtSW5kZXggKGFsaWduLCBudW1JdGVtcykge1xuICBzd2l0Y2ggKGFsaWduKSB7XG4gICAgY2FzZSAnc3RhcnQnOlxuICAgICAgcmV0dXJuIG51bUl0ZW1zIC0gMTtcbiAgICBjYXNlICdjZW50ZXInOlxuICAgICAgcmV0dXJuIChudW1JdGVtcyAtIDEpIC8gMjtcbiAgICBjYXNlICdlbmQnOlxuICAgICAgcmV0dXJuIDA7XG4gIH1cbn1cblxuLyoqXG4gKiBNdWx0aXBseSBhbGwgY29vcmRpbmF0ZXMgYnkgYSBzY2FsZSBmYWN0b3IgYW5kIGFkZCB0cmFuc2xhdGUuXG4gKlxuICogQHBhcmFtcyB7YXJyYXl9IHBvc2l0aW9ucyAtIEFycmF5IG9mIGNvb3JkaW5hdGVzIGluIGFycmF5IGZvcm0uXG4gKiBAcmV0dXJucyB7YXJyYXl9IHBvc2l0aW9uc1xuICovXG5mdW5jdGlvbiBzY2FsZVBvc2l0aW9ucyAoc2NhbGUpIHtcbiAgdmFyIGk7XG4gIGZvciAoaSA9IDA7IGkgPCBwb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICBwb3NpdGlvbnNbaV0gPSBwb3NpdGlvbnNbaV0gKiBzY2FsZTtcbiAgfVxufTtcblxuLyoqXG4gKiBTZXQgcG9zaXRpb24gb24gY2hpbGQgZW50aXRpZXMuXG4gKlxuICogQHBhcmFtIHthcnJheX0gZWxzIC0gQ2hpbGQgZW50aXRpZXMgdG8gc2V0LlxuICogQHBhcmFtIHthcnJheX0gcG9zaXRpb25zIC0gQXJyYXkgb2YgY29vcmRpbmF0ZXMuXG4gKi9cbmZ1bmN0aW9uIHNldFBvc2l0aW9ucyAoZWxzLCBwb3NpdGlvbnMsIG9yZGVyQXR0cmlidXRlKSB7XG4gIHZhciB2YWx1ZTtcbiAgdmFyIGk7XG4gIHZhciBvcmRlckluZGV4O1xuXG4gIC8vIEFsbG93IGZvciBjb250cm9sbGluZyBvcmRlciBleHBsaWNpdGx5IHNpbmNlIERPTSBvcmRlciBkb2VzIG5vdCBoYXZlIGFzIG11Y2hcbiAgLy8gbWVhbmluZyBpbiBBLUZyYW1lLlxuICBpZiAob3JkZXJBdHRyaWJ1dGUpIHtcbiAgICBmb3IgKGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZSA9IGVsc1tpXS5nZXRBdHRyaWJ1dGUob3JkZXJBdHRyaWJ1dGUpO1xuICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHsgY29udGludWU7IH1cbiAgICAgIG9yZGVySW5kZXggPSBwYXJzZUludCh2YWx1ZSwgMTApICogMztcbiAgICAgIGVsc1tpXS5vYmplY3QzRC5wb3NpdGlvbi5zZXQocG9zaXRpb25zW29yZGVySW5kZXhdLCBwb3NpdGlvbnNbb3JkZXJJbmRleCArIDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbnNbb3JkZXJJbmRleCArIDJdKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZm9yIChpID0gMDsgaSA8IHBvc2l0aW9ucy5sZW5ndGg7IGkgKz0gMykge1xuICAgIGlmICghZWxzW2kgLyAzXSkgeyByZXR1cm47IH1cbiAgICBlbHNbaSAvIDNdLm9iamVjdDNELnBvc2l0aW9uLnNldChwb3NpdGlvbnNbaV0sIHBvc2l0aW9uc1tpICsgMV0sIHBvc2l0aW9uc1tpICsgMl0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1c2hQb3NpdGlvbnMgKCkge1xuICB2YXIgaTtcbiAgZm9yIChpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIHBvc2l0aW9ucy5wdXNoKGkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1c2hQb3NpdGlvblZlYzMgKHZlYzMpIHtcbiAgcG9zaXRpb25zLnB1c2godmVjMy54KTtcbiAgcG9zaXRpb25zLnB1c2godmVjMy55KTtcbiAgcG9zaXRpb25zLnB1c2godmVjMy56KTtcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtbGF5b3V0LWNvbXBvbmVudC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMjVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwicmVxdWlyZSgnLi9saWIvT3JiaXRDb250cm9scycpO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ29yYml0LWNvbnRyb2xzJywge1xuICBkZXBlbmRlbmNpZXM6IFsnY2FtZXJhJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYXV0b1JvdGF0ZToge3R5cGU6ICdib29sZWFuJ30sXG4gICAgYXV0b1JvdGF0ZVNwZWVkOiB7ZGVmYXVsdDogMn0sXG4gICAgZGFtcGluZ0ZhY3Rvcjoge2RlZmF1bHQ6IDAuMX0sXG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGVuYWJsZURhbXBpbmc6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBlbmFibGVLZXlzOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlUGFuOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlUm90YXRlOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZW5hYmxlWm9vbToge2RlZmF1bHQ6IHRydWV9LFxuICAgIGluaXRpYWxQb3NpdGlvbjoge3R5cGU6ICd2ZWMzJ30sXG4gICAga2V5UGFuU3BlZWQ6IHtkZWZhdWx0OiA3fSxcbiAgICBtaW5BemltdXRoQW5nbGU6IHt0eXBlOiAnbnVtYmVyJywgZGVmYXVsdDogSW5maW5pdHl9LFxuICAgIG1heEF6aW11dGhBbmdsZToge3R5cGU6ICdudW1iZXInLCBkZWZhdWx0OiBJbmZpbml0eX0sXG4gICAgbWF4RGlzdGFuY2U6IHtkZWZhdWx0OiAxMDAwfSxcbiAgICBtYXhQb2xhckFuZ2xlOiB7ZGVmYXVsdDogQUZSQU1FLnV0aWxzLmRldmljZS5pc01vYmlsZSgpID8gOTAgOiAxMjB9LFxuICAgIG1pbkRpc3RhbmNlOiB7ZGVmYXVsdDogMX0sXG4gICAgbWluUG9sYXJBbmdsZToge2RlZmF1bHQ6IDB9LFxuICAgIG1pblpvb206IHtkZWZhdWx0OiAwfSxcbiAgICBwYW5TcGVlZDoge2RlZmF1bHQ6IDF9LFxuICAgIHJvdGF0ZVNwZWVkOiB7ZGVmYXVsdDogMC4wNX0sXG4gICAgc2NyZWVuU3BhY2VQYW5uaW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHRhcmdldDoge3R5cGU6ICd2ZWMzJ30sXG4gICAgem9vbVNwZWVkOiB7ZGVmYXVsdDogMC41fVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBvbGRQb3NpdGlvbjtcblxuICAgIHRoaXMuY29udHJvbHMgPSBuZXcgVEhSRUUuT3JiaXRDb250cm9scyhlbC5nZXRPYmplY3QzRCgnY2FtZXJhJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsLnNjZW5lRWwucmVuZGVyZXIuZG9tRWxlbWVudCk7XG5cbiAgICBvbGRQb3NpdGlvbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cbiAgICBlbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2VudGVyLXZyJywgKCkgPT4ge1xuICAgICAgaWYgKCFBRlJBTUUudXRpbHMuZGV2aWNlLmNoZWNrSGVhZHNldENvbm5lY3RlZCgpICYmXG4gICAgICAgICAgIUFGUkFNRS51dGlscy5kZXZpY2UuaXNNb2JpbGUoKSkgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuY29udHJvbHMuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnbG9vay1jb250cm9scycpKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbG9vay1jb250cm9scycsICdlbmFibGVkJywgdHJ1ZSk7XG4gICAgICAgIG9sZFBvc2l0aW9uLmNvcHkoZWwuZ2V0T2JqZWN0M0QoJ2NhbWVyYScpLnBvc2l0aW9uKTtcbiAgICAgICAgZWwuZ2V0T2JqZWN0M0QoJ2NhbWVyYScpLnBvc2l0aW9uLnNldCgwLCAwLCAwKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignZXhpdC12cicsICgpID0+IHtcbiAgICAgIGlmICghQUZSQU1FLnV0aWxzLmRldmljZS5jaGVja0hlYWRzZXRDb25uZWN0ZWQoKSAmJlxuICAgICAgICAgICFBRlJBTUUudXRpbHMuZGV2aWNlLmlzTW9iaWxlKCkpIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLmNvbnRyb2xzLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgZWwuZ2V0T2JqZWN0M0QoJ2NhbWVyYScpLnBvc2l0aW9uLmNvcHkob2xkUG9zaXRpb24pO1xuICAgICAgaWYgKGVsLmhhc0F0dHJpYnV0ZSgnbG9vay1jb250cm9scycpKSB7XG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbG9vay1jb250cm9scycsICdlbmFibGVkJywgZmFsc2UpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSAnZ3JhYic7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKCkgPT4ge1xuICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSAnZ3JhYmJpbmcnO1xuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoKSA9PiB7XG4gICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdncmFiJztcbiAgICB9KTtcblxuICAgIHRoaXMudGFyZ2V0ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICBlbC5nZXRPYmplY3QzRCgnY2FtZXJhJykucG9zaXRpb24uY29weSh0aGlzLmRhdGEuaW5pdGlhbFBvc2l0aW9uKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGNvbnRyb2xzID0gdGhpcy5jb250cm9scztcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGNvbnRyb2xzLnRhcmdldCA9IHRoaXMudGFyZ2V0LmNvcHkoZGF0YS50YXJnZXQpO1xuICAgIGNvbnRyb2xzLmF1dG9Sb3RhdGUgPSBkYXRhLmF1dG9Sb3RhdGU7XG4gICAgY29udHJvbHMuYXV0b1JvdGF0ZVNwZWVkID0gZGF0YS5hdXRvUm90YXRlU3BlZWQ7XG4gICAgY29udHJvbHMuZGFtcGluZ0ZhY3RvciA9IGRhdGEuZGFtcGluZ0ZhY3RvcjtcbiAgICBjb250cm9scy5lbmFibGVkID0gZGF0YS5lbmFibGVkO1xuICAgIGNvbnRyb2xzLmVuYWJsZURhbXBpbmcgPSBkYXRhLmVuYWJsZURhbXBpbmc7XG4gICAgY29udHJvbHMuZW5hYmxlS2V5cyA9IGRhdGEuZW5hYmxlS2V5cztcbiAgICBjb250cm9scy5lbmFibGVQYW4gPSBkYXRhLmVuYWJsZVBhbjtcbiAgICBjb250cm9scy5lbmFibGVSb3RhdGUgPSBkYXRhLmVuYWJsZVJvdGF0ZTtcbiAgICBjb250cm9scy5lbmFibGVab29tID0gZGF0YS5lbmFibGVab29tO1xuICAgIGNvbnRyb2xzLmtleVBhblNwZWVkID0gZGF0YS5rZXlQYW5TcGVlZDtcbiAgICBjb250cm9scy5tYXhQb2xhckFuZ2xlID0gVEhSRUUuTWF0aC5kZWdUb1JhZChkYXRhLm1heFBvbGFyQW5nbGUpO1xuICAgIGNvbnRyb2xzLm1heERpc3RhbmNlID0gZGF0YS5tYXhEaXN0YW5jZTtcbiAgICBjb250cm9scy5taW5EaXN0YW5jZSA9IGRhdGEubWluRGlzdGFuY2U7XG4gICAgY29udHJvbHMubWluUG9sYXJBbmdsZSA9IFRIUkVFLk1hdGguZGVnVG9SYWQoZGF0YS5taW5Qb2xhckFuZ2xlKTtcbiAgICBjb250cm9scy5taW5ab29tID0gZGF0YS5taW5ab29tO1xuICAgIGNvbnRyb2xzLnBhblNwZWVkID0gZGF0YS5wYW5TcGVlZDtcbiAgICBjb250cm9scy5yb3RhdGVTcGVlZCA9IGRhdGEucm90YXRlU3BlZWQ7XG4gICAgY29udHJvbHMuc2NyZWVuU3BhY2VQYW5uaW5nID0gZGF0YS5zY3JlZW5TcGFjZVBhbm5pbmc7XG4gICAgY29udHJvbHMuem9vbVNwZWVkID0gZGF0YS56b29tU3BlZWQ7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjb250cm9scyA9IHRoaXMuY29udHJvbHM7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgaWYgKCFkYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgaWYgKGNvbnRyb2xzLmVuYWJsZWQgJiYgKGNvbnRyb2xzLmVuYWJsZURhbXBpbmcgfHwgY29udHJvbHMuYXV0b1JvdGF0ZSkpIHtcbiAgICAgIHRoaXMuY29udHJvbHMudXBkYXRlKCk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtb3JiaXQtY29udHJvbHMvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDI2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogTGlzdGVuIHRvIGV2ZW50IGFuZCBmb3J3YXJkIHRvIGFub3RoZXIgZW50aXR5IG9yIGVudGl0aWVzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3Byb3h5LWV2ZW50Jywge1xuICBzY2hlbWE6IHtcbiAgICBjYXB0dXJlQnViYmxlczoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgZXZlbnQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgZnJvbToge3R5cGU6ICdzdHJpbmcnfSxcbiAgICB0bzoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBhczoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBidWJibGVzOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgbXVsdGlwbGU6IHRydWUsXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGZyb207XG4gICAgdmFyIGk7XG4gICAgdmFyIHRvO1xuICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgIGlmIChkYXRhLmZyb20pIHtcbiAgICAgIGlmIChkYXRhLmZyb20gPT09ICdQQVJFTlQnKSB7XG4gICAgICAgIGZyb20gPSBbZWwucGFyZW50Tm9kZV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmcm9tID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChkYXRhLmZyb20pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZGF0YS50byA9PT0gJ0NISUxEUkVOJykge1xuICAgICAgICB0byA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJyonKTtcbiAgICAgIH0gZWxzZSBpZiAoZGF0YS50byA9PT0gJ1NFTEYnKSB7XG4gICAgICAgIHRvID0gW2VsXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChkYXRhLnRvKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZGF0YS5mcm9tKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgZnJvbS5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJGcm9tKGZyb21baV0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKGRhdGEuZXZlbnQsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBzZWxmLmRhdGE7XG4gICAgICAgIGlmICghZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgICAgICBpZiAoIWRhdGEuY2FwdHVyZUJ1YmJsZXMgJiYgZXZ0LnRhcmdldCAhPT0gZWwpIHsgcmV0dXJuOyB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB0by5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRvW2ldLmVtaXQoZGF0YS5hcyB8fCBkYXRhLmV2ZW50LCBldnRbJ2RldGFpbCddID8gZXZ0LmRldGFpbCA6IG51bGwsIGRhdGEuYnViYmxlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICBhZGRFdmVudExpc3RlbmVyRnJvbTogZnVuY3Rpb24gKGZyb21FbCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBmcm9tRWwuYWRkRXZlbnRMaXN0ZW5lcihkYXRhLmV2ZW50LCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICB2YXIgZGF0YSA9IHNlbGYuZGF0YTtcbiAgICAgIGlmICghZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgICAgaWYgKCFkYXRhLmNhcHR1cmVCdWJibGVzICYmIGV2dC50YXJnZXQgIT09IGZyb21FbCkgeyByZXR1cm47IH1cbiAgICAgIHNlbGYuZWwuZW1pdChkYXRhLmFzIHx8IGRhdGEuZXZlbnQsIGV2dFsnZGV0YWlsJ10gPyBldnQuZGV0YWlsIDogbnVsbCwgZmFsc2UpO1xuICAgIH0pO1xuICB9XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtcHJveHktZXZlbnQtY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAyN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuLyogZ2xvYmFsIEFGUkFNRSAqL1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0dGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxuQUZSQU1FLnJlZ2lzdGVyU2hhZGVyKCdyaW5nJywge1xuXHRzY2hlbWE6IHtcblx0XHRibHVyOiB7IGRlZmF1bHQ6IDAuMDEsIGlzOiAndW5pZm9ybScgfSxcblx0XHRjb2xvcjogeyB0eXBlOiAnY29sb3InLCBpczogJ3VuaWZvcm0nIH0sXG5cdFx0cHJvZ3Jlc3M6IHsgZGVmYXVsdDogMCwgaXM6ICd1bmlmb3JtJyB9LFxuXHRcdHJhZGl1c0lubmVyOiB7IGRlZmF1bHQ6IDAuODUsIGlzOiAndW5pZm9ybScgfSxcblx0XHRyYWRpdXNPdXRlcjogeyBkZWZhdWx0OiAxLCBpczogJ3VuaWZvcm0nIH1cblx0fSxcblxuXHR2ZXJ0ZXhTaGFkZXI6IF9fd2VicGFja19yZXF1aXJlX18oMSksXG5cblx0ZnJhZ21lbnRTaGFkZXI6IF9fd2VicGFja19yZXF1aXJlX18oMilcbn0pO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBcInZhcnlpbmcgdmVjMiB2VXY7XFxuXFxudm9pZCBtYWluICgpIHtcXG4gIHZVdiA9IHV2O1xcbiAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNChwb3NpdGlvbiwgMS4wKTtcXG59XFxuXCJcblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gXCIjZGVmaW5lIFBJIDMuMTQxNTkyNjUzNTg5NzlcXG51bmlmb3JtIGZsb2F0IGJsdXI7XFxudW5pZm9ybSBmbG9hdCBwcm9ncmVzcztcXG51bmlmb3JtIGZsb2F0IHJhZGl1c0lubmVyO1xcbnVuaWZvcm0gZmxvYXQgcmFkaXVzT3V0ZXI7XFxudW5pZm9ybSB2ZWMzIGNvbG9yO1xcblxcbnZhcnlpbmcgdmVjMiB2VXY7XFxuXFxudm9pZCBtYWluICgpIHtcXG4gIHZlYzIgdXYgPSB2ZWMyKHZVdi54ICogMi4gLSAxLiwgdlV2LnkgKiAyLiAtIDEuKTtcXG4gIGZsb2F0IHIgPSB1di54ICogdXYueCArIHV2LnkgKiB1di55O1xcbiAgZmxvYXQgY29sID0gKDEuMCAtIHNtb290aHN0ZXAocmFkaXVzT3V0ZXIsIHJhZGl1c091dGVyICsgYmx1ciwgcikpICogc21vb3Roc3RlcChyYWRpdXNJbm5lciwgcmFkaXVzSW5uZXIgKyBibHVyLCByKTtcXG4gIGZsb2F0IGEgPSBzbW9vdGhzdGVwKC1QSSwgUEksIGF0YW4odXYueSwgdXYueCkpO1xcbiAgZmxvYXQgcCA9IDEuMCAtIHByb2dyZXNzIC0gYmx1cjtcXG4gIGNvbCAqPSBzbW9vdGhzdGVwKHAsIHAgKyBibHVyLCBhKTtcXG4gIGdsX0ZyYWdDb2xvciA9IHZlYzQoY29sb3IgKiBjb2wsIGNvbCk7XFxufVxcblwiXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcbn0pO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtcmluZy1zaGFkZXIvZGlzdC9hZnJhbWUtcmluZy1zaGFkZXIuanNcbi8vIG1vZHVsZSBpZCA9IDI4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qIGdsb2JhbCBBRlJBTUUgKi9cblxuaWYgKHR5cGVvZiBBRlJBTUUgPT09ICd1bmRlZmluZWQnKSB7XG4gIHRocm93IG5ldyBFcnJvcignQ29tcG9uZW50IGF0dGVtcHRlZCB0byByZWdpc3RlciBiZWZvcmUgQUZSQU1FIHdhcyBhdmFpbGFibGUuJyk7XG59XG5cbi8qKlxuICogU2xpY2U5IGNvbXBvbmVudCBmb3IgQS1GcmFtZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzbGljZTknLCB7XG4gIHNjaGVtYToge1xuICAgIHdpZHRoOiB7ZGVmYXVsdDogMSwgbWluOiAwfSxcbiAgICBoZWlnaHQ6IHtkZWZhdWx0OiAxLCBtaW46IDB9LFxuICAgIGxlZnQ6IHtkZWZhdWx0OiAwLCBtaW46IDB9LFxuICAgIHJpZ2h0OiB7ZGVmYXVsdDogMCwgbWluOiAwfSxcbiAgICBib3R0b206IHtkZWZhdWx0OiAwLCBtaW46IDB9LFxuICAgIHRvcDoge2RlZmF1bHQ6IDAsIG1pbjogMH0sXG4gICAgc2lkZToge2RlZmF1bHQ6ICdmcm9udCcsIG9uZU9mOiBbJ2Zyb250JywgJ2JhY2snLCAnZG91YmxlJ119LFxuICAgIHBhZGRpbmc6IHtkZWZhdWx0OiAwLjEsIG1pbjogMC4wMX0sXG4gICAgY29sb3I6IHt0eXBlOiAnY29sb3InLCBkZWZhdWx0OiAnI2ZmZid9LFxuICAgIG9wYWNpdHk6IHtkZWZhdWx0OiAxLjAsIG1pbjogMCwgbWF4OiAxfSxcbiAgICB0cmFuc3BhcmVudDoge2RlZmF1bHQ6IHRydWV9LFxuICAgIGRlYnVnOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHNyYzoge3R5cGU6ICdtYXAnfVxuICB9LFxuXG4gIC8qKlxuICAgKiBTZXQgaWYgY29tcG9uZW50IG5lZWRzIG11bHRpcGxlIGluc3RhbmNpbmcuXG4gICAqL1xuICBtdWx0aXBsZTogZmFsc2UsXG5cbiAgLyoqXG4gICAqIENhbGxlZCBvbmNlIHdoZW4gY29tcG9uZW50IGlzIGF0dGFjaGVkLiBHZW5lcmFsbHkgZm9yIGluaXRpYWwgc2V0dXAuXG4gICAqL1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIG1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7Y29sb3I6IGRhdGEuY29sb3IsIG9wYWNpdHk6IGRhdGEub3BhY2l0eSwgdHJhbnNwYXJlbnQ6IGRhdGEudHJhbnNwYXJlbnQsIHdpcmVmcmFtZTogZGF0YS5kZWJ1Z30pO1xuICAgIHZhciBnZW9tZXRyeSA9IHRoaXMuZ2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVCdWZmZXJHZW9tZXRyeShkYXRhLndpZHRoLCBkYXRhLmhlaWdodCwgMywgMyk7XG5cbiAgICB2YXIgdGV4dHVyZUxvYWRlciA9IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCk7XG4gICAgdGhpcy5wbGFuZSA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7XG4gICAgdGhpcy5lbC5zZXRPYmplY3QzRCgnbWVzaCcsIHRoaXMucGxhbmUpO1xuICAgIHRoaXMudGV4dHVyZVNyYyA9IG51bGw7XG4gIH0sXG5cbiAgdXBkYXRlTWFwOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNyYyA9IHRoaXMuZGF0YS5zcmM7XG5cbiAgICBpZiAoc3JjKSB7XG4gICAgICBpZiAoc3JjID09PSB0aGlzLnRleHR1cmVTcmMpIHsgcmV0dXJuOyB9XG4gICAgICAvLyBUZXh0dXJlIGFkZGVkIG9yIGNoYW5nZWQuXG4gICAgICB0aGlzLnRleHR1cmVTcmMgPSBzcmM7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbC5sb2FkVGV4dHVyZShzcmMsIHtzcmM6IHNyY30sIHNldE1hcC5iaW5kKHRoaXMpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBUZXh0dXJlIHJlbW92ZWQuXG4gICAgaWYgKCF0aGlzLm1hdGVyaWFsLm1hcCkgeyByZXR1cm47IH1cbiAgICBzZXRNYXAobnVsbCk7XG5cblxuICAgIGZ1bmN0aW9uIHNldE1hcCAodGV4dHVyZSkge1xuICAgICAgdGhpcy5tYXRlcmlhbC5tYXAgPSB0ZXh0dXJlO1xuICAgICAgdGhpcy5tYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgICB0aGlzLnJlZ2VuZXJhdGVNZXNoKCk7XG4gICAgfVxuICB9LFxuXG4gIHJlZ2VuZXJhdGVNZXNoOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIHBvcyA9IHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTtcbiAgICB2YXIgdXZzID0gdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnV2LmFycmF5O1xuICAgIHZhciBpbWFnZSA9IHRoaXMubWF0ZXJpYWwubWFwLmltYWdlO1xuXG4gICAgaWYgKCFpbWFnZSkge3JldHVybjt9XG5cbiAgICAvKlxuICAgICAgMC0tMS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTItLTNcbiAgICAgIHwgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICB8XG4gICAgICA0LS01LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tNi0tN1xuICAgICAgfCAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIHxcbiAgICAgIHwgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICB8XG4gICAgICB8ICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgfFxuICAgICAgOC0tOS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTAtLTExXG4gICAgICB8ICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgfFxuICAgICAgMTItMTMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTQtLTE1XG4gICAgKi9cbiAgICBmdW5jdGlvbiBzZXRQb3MoaWQsIHgsIHkpIHtcbiAgICAgIHBvc1szICogaWRdID0geDtcbiAgICAgIHBvc1szICogaWQgKyAxXSA9IHk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0VVYoaWQsIHUsIHYpIHtcbiAgICAgIHV2c1syICogaWRdID0gdTtcbiAgICAgIHV2c1syICogaWQgKyAxXSA9IHY7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIFVWU1xuICAgIHZhciB1diA9IHtcbiAgICAgIGxlZnQ6IGRhdGEubGVmdCAvIGltYWdlLndpZHRoLFxuICAgICAgcmlnaHQ6IGRhdGEucmlnaHQgLyBpbWFnZS53aWR0aCxcbiAgICAgIHRvcDogZGF0YS50b3AgLyBpbWFnZS5oZWlnaHQsXG4gICAgICBib3R0b206IGRhdGEuYm90dG9tIC8gaW1hZ2UuaGVpZ2h0XG4gICAgfTtcblxuICAgIHNldFVWKDEsICB1di5sZWZ0LCAgMSk7XG4gICAgc2V0VVYoMiwgIHV2LnJpZ2h0LCAxKTtcblxuICAgIHNldFVWKDQsICAwLCAgICAgICAgdXYuYm90dG9tKTtcbiAgICBzZXRVVig1LCAgdXYubGVmdCwgIHV2LmJvdHRvbSk7XG4gICAgc2V0VVYoNiwgIHV2LnJpZ2h0LCB1di5ib3R0b20pO1xuICAgIHNldFVWKDcsICAxLCAgICAgICAgdXYuYm90dG9tKTtcblxuICAgIHNldFVWKDgsICAwLCAgICAgICAgdXYudG9wKTtcbiAgICBzZXRVVig5LCAgdXYubGVmdCwgIHV2LnRvcCk7XG4gICAgc2V0VVYoMTAsIHV2LnJpZ2h0LCB1di50b3ApO1xuICAgIHNldFVWKDExLCAxLCAgICAgICAgdXYudG9wKTtcblxuICAgIHNldFVWKDEzLCB1di5sZWZ0LCAgMCk7XG4gICAgc2V0VVYoMTQsIHV2LnJpZ2h0LCAwKTtcblxuICAgIC8vIFVwZGF0ZSB2ZXJ0ZXggcG9zaXRpb25zXG4gICAgdmFyIHcyID0gZGF0YS53aWR0aCAvIDI7XG4gICAgdmFyIGgyID0gZGF0YS5oZWlnaHQgLyAyO1xuICAgIHZhciBsZWZ0ID0gLXcyICsgZGF0YS5wYWRkaW5nO1xuICAgIHZhciByaWdodCA9IHcyIC0gZGF0YS5wYWRkaW5nO1xuICAgIHZhciB0b3AgPSBoMiAtIGRhdGEucGFkZGluZztcbiAgICB2YXIgYm90dG9tID0gLWgyICsgZGF0YS5wYWRkaW5nO1xuXG4gICAgc2V0UG9zKDAsIC13MiwgICAgaDIpO1xuICAgIHNldFBvcygxLCBsZWZ0LCAgIGgyKTtcbiAgICBzZXRQb3MoMiwgcmlnaHQsICBoMik7XG4gICAgc2V0UG9zKDMsIHcyLCAgICAgaDIpO1xuXG4gICAgc2V0UG9zKDQsIC13MiwgICAgdG9wKTtcbiAgICBzZXRQb3MoNSwgbGVmdCwgICB0b3ApO1xuICAgIHNldFBvcyg2LCByaWdodCwgIHRvcCk7XG4gICAgc2V0UG9zKDcsIHcyLCAgICAgdG9wKTtcblxuICAgIHNldFBvcyg4LCAtdzIsICAgIGJvdHRvbSk7XG4gICAgc2V0UG9zKDksIGxlZnQsICAgYm90dG9tKTtcbiAgICBzZXRQb3MoMTAsIHJpZ2h0LCBib3R0b20pO1xuICAgIHNldFBvcygxMSwgdzIsICAgIGJvdHRvbSk7XG5cbiAgICBzZXRQb3MoMTMsIGxlZnQsICAtaDIpO1xuICAgIHNldFBvcygxNCwgcmlnaHQsIC1oMik7XG4gICAgc2V0UG9zKDEyLCAtdzIsICAgLWgyKTtcbiAgICBzZXRQb3MoMTUsIHcyLCAgICAtaDIpO1xuXG4gICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMudXYubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBjb21wb25lbnQgaXMgYXR0YWNoZWQgYW5kIHdoZW4gY29tcG9uZW50IGRhdGEgY2hhbmdlcy5cbiAgICogR2VuZXJhbGx5IG1vZGlmaWVzIHRoZSBlbnRpdHkgYmFzZWQgb24gdGhlIGRhdGEuXG4gICAqL1xuICAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgICB0aGlzLm1hdGVyaWFsLmNvbG9yLnNldFN0eWxlKGRhdGEuY29sb3IpO1xuICAgICB0aGlzLm1hdGVyaWFsLm9wYWNpdHkgPSBkYXRhLm9wYWNpdHk7XG4gICAgIHRoaXMubWF0ZXJpYWwudHJhbnNwYXJlbnQgPSBkYXRhLnRyYW5zcGFyZW50O1xuICAgICB0aGlzLm1hdGVyaWFsLndpcmVmcmFtZSA9IGRhdGEuZGVidWc7XG4gICAgIHRoaXMubWF0ZXJpYWwuc2lkZSA9IHBhcnNlU2lkZShkYXRhLnNpZGUpO1xuXG4gICAgIHZhciBkaWZmID0gQUZSQU1FLnV0aWxzLmRpZmYoZGF0YSwgb2xkRGF0YSk7XG4gICAgIGlmICgnc3JjJyBpbiBkaWZmKSB7XG4gICAgICAgdGhpcy51cGRhdGVNYXAoKTtcbiAgICAgfVxuICAgICBlbHNlIGlmICgnd2lkdGgnIGluIGRpZmYgfHwgJ2hlaWdodCcgaW4gZGlmZiB8fCAncGFkZGluZycgaW4gZGlmZiB8fCAnbGVmdCcgaW4gZGlmZiB8fMKgJ3RvcCcgaW4gZGlmZiB8fMKgJ2JvdHRvbScgaW4gZGlmZiB8fMKgJ3JpZ2h0JyBpbiBkaWZmKSB7XG4gICAgICAgdGhpcy5yZWdlbmVyYXRlTWVzaCgpO1xuICAgICB9XG4gICB9LFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIGNvbXBvbmVudCBpcyByZW1vdmVkIChlLmcuLCB2aWEgcmVtb3ZlQXR0cmlidXRlKS5cbiAgICogR2VuZXJhbGx5IHVuZG9lcyBhbGwgbW9kaWZpY2F0aW9ucyB0byB0aGUgZW50aXR5LlxuICAgKi9cbiAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7IH0sXG5cbiAgLyoqXG4gICAqIENhbGxlZCBvbiBlYWNoIHNjZW5lIHRpY2suXG4gICAqL1xuICAvLyB0aWNrOiBmdW5jdGlvbiAodCkgeyB9LFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBlbnRpdHkgcGF1c2VzLlxuICAgKiBVc2UgdG8gc3RvcCBvciByZW1vdmUgYW55IGR5bmFtaWMgb3IgYmFja2dyb3VuZCBiZWhhdmlvciBzdWNoIGFzIGV2ZW50cy5cbiAgICovXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7IH0sXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGVudGl0eSByZXN1bWVzLlxuICAgKiBVc2UgdG8gY29udGludWUgb3IgYWRkIGFueSBkeW5hbWljIG9yIGJhY2tncm91bmQgYmVoYXZpb3Igc3VjaCBhcyBldmVudHMuXG4gICAqL1xuICBwbGF5OiBmdW5jdGlvbiAoKSB7IH1cbn0pO1xuXG5mdW5jdGlvbiBwYXJzZVNpZGUgKHNpZGUpIHtcbiAgc3dpdGNoIChzaWRlKSB7XG4gICAgY2FzZSAnYmFjayc6IHtcbiAgICAgIHJldHVybiBUSFJFRS5CYWNrU2lkZTtcbiAgICB9XG4gICAgY2FzZSAnZG91YmxlJzoge1xuICAgICAgcmV0dXJuIFRIUkVFLkRvdWJsZVNpZGU7XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIC8vIEluY2x1ZGluZyBjYXNlIGBmcm9udGAuXG4gICAgICByZXR1cm4gVEhSRUUuRnJvbnRTaWRlO1xuICAgIH1cbiAgfVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1zbGljZTktY29tcG9uZW50L2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAyOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2Uge1xuXHRcdHZhciBhID0gZmFjdG9yeSgpO1xuXHRcdGZvcih2YXIgaSBpbiBhKSAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnID8gZXhwb3J0cyA6IHJvb3QpW2ldID0gYVtpXTtcblx0fVxufSkodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuLy8gUHJlLWNvbXBpbGVkIGZ1bmN0aW9ucy5cbnZhciBzZWxlY3RGdW5jdGlvbnMgPSB7fTtcblxuLyoqXG4gKiBTZWxlY3QgdmFsdWUgZnJvbSBzdG9yZS4gSGFuZGxlcyBib29sZWFuIG9wZXJhdGlvbnMsIGNhbGxzIGBzZWxlY3RQcm9wZXJ0eWAuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHN0YXRlIC0gU3RhdGUgb2JqZWN0LlxuICogQHBhcmFtIHtzdHJpbmd9IHNlbGVjdG9yIC0gRG90LWRlbGltaXRlZCBzdG9yZSBrZXlzIChlLmcuLCBnYW1lLnBsYXllci5oZWFsdGgpLlxuICogQHBhcmFtIHtvYmplY3R9IGl0ZW0gLSBGcm9tIGJpbmQtaXRlbS5cbiAqL1xuZnVuY3Rpb24gc2VsZWN0KHN0YXRlLCBzZWxlY3RvciwgaXRlbSkge1xuICBpZiAoIXNlbGVjdEZ1bmN0aW9uc1tzZWxlY3Rvcl0pIHtcbiAgICBzZWxlY3RGdW5jdGlvbnNbc2VsZWN0b3JdID0gbmV3IEZ1bmN0aW9uKCdzdGF0ZScsICdpdGVtJywgJ3JldHVybiAnICsgZ2VuZXJhdGVFeHByZXNzaW9uKHNlbGVjdG9yKSArICc7Jyk7XG4gIH1cbiAgcmV0dXJuIHNlbGVjdEZ1bmN0aW9uc1tzZWxlY3Rvcl0oc3RhdGUsIGl0ZW0pO1xufVxubW9kdWxlLmV4cG9ydHMuc2VsZWN0ID0gc2VsZWN0O1xuXG52YXIgRE9UX05PVEFUSU9OX1JFID0gL1xcLihbQS1aYS16XVtcXHdfLV0qKS9nO1xudmFyIFdISVRFU1BBQ0VfUkUgPSAvXFxzL2c7XG52YXIgU1RBVEVfU0VMRUNUT1JfUkUgPSAvKFs9JnwhPzorLV0pKFxccyopKFtcXChdPykoW0EtWmEtel1bXFx3Xy1dKikvZztcbnZhciBST09UX1NUQVRFX1NFTEVDVE9SX1JFID0gL14oW1xcKF0/KShbQS1aYS16XVtcXHdfLV0qKS9nO1xudmFyIElURU1fUkUgPSAvc3RhdGVcXFtcIml0ZW1cIlxcXS9nO1xudmFyIFNUQVRFX1NUUiA9ICdzdGF0ZSc7XG5mdW5jdGlvbiBnZW5lcmF0ZUV4cHJlc3Npb24oc3RyKSB7XG4gIHN0ciA9IHN0ci5yZXBsYWNlKERPVF9OT1RBVElPTl9SRSwgJ1tcIiQxXCJdJyk7XG4gIHN0ciA9IHN0ci5yZXBsYWNlKFJPT1RfU1RBVEVfU0VMRUNUT1JfUkUsICckMXN0YXRlW1wiJDJcIl0nKTtcbiAgc3RyID0gc3RyLnJlcGxhY2UoU1RBVEVfU0VMRUNUT1JfUkUsICckMSQyJDNzdGF0ZVtcIiQ0XCJdJyk7XG4gIHN0ciA9IHN0ci5yZXBsYWNlKElURU1fUkUsICdpdGVtJyk7XG4gIHJldHVybiBzdHI7XG59XG5tb2R1bGUuZXhwb3J0cy5nZW5lcmF0ZUV4cHJlc3Npb24gPSBnZW5lcmF0ZUV4cHJlc3Npb247XG5cbmZ1bmN0aW9uIGNsZWFyT2JqZWN0KG9iaikge1xuICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgZGVsZXRlIG9ialtrZXldO1xuICB9XG59XG5tb2R1bGUuZXhwb3J0cy5jbGVhck9iamVjdCA9IGNsZWFyT2JqZWN0O1xuXG4vKipcbiAqIEhlbHBlciB0byBjb21wb3NlIG9iamVjdCBvZiBoYW5kbGVycywgbWVyZ2luZyBmdW5jdGlvbnMgaGFuZGxpbmcgc2FtZSBhY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIGNvbXBvc2VIYW5kbGVycygpIHtcbiAgdmFyIGFjdGlvbk5hbWU7XG4gIHZhciBpO1xuICB2YXIgaW5wdXRIYW5kbGVycyA9IGFyZ3VtZW50cztcbiAgdmFyIG91dHB1dEhhbmRsZXJzO1xuXG4gIG91dHB1dEhhbmRsZXJzID0ge307XG4gIGZvciAoaSA9IDA7IGkgPCBpbnB1dEhhbmRsZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChhY3Rpb25OYW1lIGluIGlucHV0SGFuZGxlcnNbaV0pIHtcbiAgICAgIGlmIChhY3Rpb25OYW1lIGluIG91dHB1dEhhbmRsZXJzKSB7XG4gICAgICAgIC8vIEluaXRpYWwgY29tcG9zZS9tZXJnZSBmdW5jdGlvbnMgaW50byBhcnJheXMuXG4gICAgICAgIGlmIChvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHtcbiAgICAgICAgICBvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXS5wdXNoKGlucHV0SGFuZGxlcnNbaV1bYWN0aW9uTmFtZV0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG91dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdID0gW291dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdLCBpbnB1dEhhbmRsZXJzW2ldW2FjdGlvbk5hbWVdXTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3V0cHV0SGFuZGxlcnNbYWN0aW9uTmFtZV0gPSBpbnB1dEhhbmRsZXJzW2ldW2FjdGlvbk5hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIENvbXBvc2UgZnVuY3Rpb25zIHNwZWNpZmllZCB2aWEgYXJyYXkuXG4gIGZvciAoYWN0aW9uTmFtZSBpbiBvdXRwdXRIYW5kbGVycykge1xuICAgIGlmIChvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkpIHtcbiAgICAgIG91dHB1dEhhbmRsZXJzW2FjdGlvbk5hbWVdID0gY29tcG9zZUZ1bmN0aW9ucy5hcHBseSh0aGlzLCBvdXRwdXRIYW5kbGVyc1thY3Rpb25OYW1lXSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG91dHB1dEhhbmRsZXJzO1xufVxubW9kdWxlLmV4cG9ydHMuY29tcG9zZUhhbmRsZXJzID0gY29tcG9zZUhhbmRsZXJzO1xuXG5mdW5jdGlvbiBjb21wb3NlRnVuY3Rpb25zKCkge1xuICB2YXIgZnVuY3Rpb25zID0gYXJndW1lbnRzO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBmdW5jdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGZ1bmN0aW9uc1tpXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfTtcbn1cbm1vZHVsZS5leHBvcnRzLmNvbXBvc2VGdW5jdGlvbnMgPSBjb21wb3NlRnVuY3Rpb25zO1xuXG52YXIgTk9fV0FUQ0hfVE9LRU5TID0gWyd8fCcsICcmJicsICchPScsICchPT0nLCAnPT0nLCAnPT09JywgJz4nLCAnPCcsICc8PScsICc+PSddO1xudmFyIFdISVRFU1BBQ0VfUExVU19SRSA9IC9cXHMrLztcbmZ1bmN0aW9uIHBhcnNlS2V5c1RvV2F0Y2goa2V5cywgc3RyLCBpc0JpbmRJdGVtKSB7XG4gIHZhciBpO1xuICB2YXIgdG9rZW5zO1xuICB0b2tlbnMgPSBzcGxpdChzdHIsIFdISVRFU1BBQ0VfUExVU19SRSk7XG4gIGZvciAoaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoTk9fV0FUQ0hfVE9LRU5TLmluZGV4T2YodG9rZW5zW2ldKSA9PT0gLTEgJiYgIXRva2Vuc1tpXS5zdGFydHNXaXRoKFwiJ1wiKSAmJiBrZXlzLmluZGV4T2YodG9rZW5zW2ldKSA9PT0gLTEpIHtcbiAgICAgIGlmIChpc0JpbmRJdGVtICYmIHRva2Vuc1tpXSA9PT0gJ2l0ZW0nKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAga2V5cy5wdXNoKHBhcnNlS2V5VG9XYXRjaCh0b2tlbnNbaV0pKTtcbiAgICB9XG4gIH1cbn1cbm1vZHVsZS5leHBvcnRzLnBhcnNlS2V5c1RvV2F0Y2ggPSBwYXJzZUtleXNUb1dhdGNoO1xuXG5mdW5jdGlvbiBwYXJzZUtleVRvV2F0Y2goc3RyKSB7XG4gIHZhciBkb3RJbmRleDtcbiAgc3RyID0gc3RyaXBOb3Qoc3RyLnRyaW0oKSk7XG4gIGRvdEluZGV4ID0gc3RyLmluZGV4T2YoJy4nKTtcbiAgaWYgKGRvdEluZGV4ID09PSAtMSkge1xuICAgIHJldHVybiBzdHI7XG4gIH1cbiAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCwgc3RyLmluZGV4T2YoJy4nKSk7XG59XG5cbmZ1bmN0aW9uIHN0cmlwTm90KHN0cikge1xuICBpZiAoc3RyLmluZGV4T2YoJyEhJykgPT09IDApIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoJyEhJywgJycpO1xuICB9IGVsc2UgaWYgKHN0ci5pbmRleE9mKCchJykgPT09IDApIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoJyEnLCAnJyk7XG4gIH1cbiAgcmV0dXJuIHN0cjtcbn1cblxuLyoqXG4gKiBDYWNoZWQgc3BsaXQuXG4gKi9cbnZhciBTUExJVF9DQUNIRSA9IHt9O1xuZnVuY3Rpb24gc3BsaXQoc3RyLCBkZWxpbWl0ZXIpIHtcbiAgaWYgKCFTUExJVF9DQUNIRVtkZWxpbWl0ZXJdKSB7XG4gICAgU1BMSVRfQ0FDSEVbZGVsaW1pdGVyXSA9IHt9O1xuICB9XG4gIGlmIChTUExJVF9DQUNIRVtkZWxpbWl0ZXJdW3N0cl0pIHtcbiAgICByZXR1cm4gU1BMSVRfQ0FDSEVbZGVsaW1pdGVyXVtzdHJdO1xuICB9XG4gIFNQTElUX0NBQ0hFW2RlbGltaXRlcl1bc3RyXSA9IHN0ci5zcGxpdChkZWxpbWl0ZXIpO1xuICByZXR1cm4gU1BMSVRfQ0FDSEVbZGVsaW1pdGVyXVtzdHJdO1xufVxubW9kdWxlLmV4cG9ydHMuc3BsaXQgPSBzcGxpdDtcblxuZnVuY3Rpb24gY29weUFycmF5KGRlc3QsIHNyYykge1xuICB2YXIgaTtcbiAgZGVzdC5sZW5ndGggPSAwO1xuICBmb3IgKGkgPSAwOyBpIDwgc3JjLmxlbmd0aDsgaSsrKSB7XG4gICAgZGVzdFtpXSA9IHNyY1tpXTtcbiAgfVxufVxubW9kdWxlLmV4cG9ydHMuY29weUFycmF5ID0gY29weUFycmF5O1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xudmFyIGRpZmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xudmFyIGxpYiA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG52YXIgd3JhcEFycmF5ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KS53cmFwQXJyYXk7XG5cbi8vIFNpbmdsZXRvbiBzdGF0ZSBkZWZpbml0aW9uLlxudmFyIFN0YXRlID0ge1xuICBpbml0aWFsU3RhdGU6IHt9LFxuICBub25CaW5kZWRTdGF0ZUtleXM6IFtdLFxuICBoYW5kbGVyczoge30sXG4gIGNvbXB1dGVTdGF0ZTogZnVuY3Rpb24gY29tcHV0ZVN0YXRlKCkgey8qIG5vLW9wICovfVxufTtcblxudmFyIFNUQVRFX1VQREFURV9FVkVOVCA9ICdzdGF0ZXVwZGF0ZSc7XG52YXIgVFlQRV9PQkpFQ1QgPSAnb2JqZWN0JztcbnZhciBXSElURVNQQUNFX1JFR0VYID0gL3MrLztcblxuQUZSQU1FLnJlZ2lzdGVyU3RhdGUgPSBmdW5jdGlvbiAoZGVmaW5pdGlvbikge1xuICBBRlJBTUUudXRpbHMuZXh0ZW5kKFN0YXRlLCBkZWZpbml0aW9uKTtcbn07XG5cbkFGUkFNRS5yZWdpc3RlclN5c3RlbSgnc3RhdGUnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHZhciBrZXk7XG5cbiAgICB0aGlzLmFycmF5cyA9IFtdO1xuICAgIHRoaXMuZGlydHlBcnJheXMgPSBbXTtcbiAgICB0aGlzLmRpZmYgPSB7fTtcbiAgICB0aGlzLnN0YXRlID0gQUZSQU1FLnV0aWxzLmNsb25lKFN0YXRlLmluaXRpYWxTdGF0ZSk7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zID0gW107XG4gICAgdGhpcy5pbml0RXZlbnRIYW5kbGVycygpO1xuXG4gICAgLy8gV3JhcCBhcnJheSB0byBkZXRlY3QgZGlydHkuXG4gICAgZm9yIChrZXkgaW4gdGhpcy5zdGF0ZSkge1xuICAgICAgaWYgKHRoaXMuc3RhdGVba2V5XSAmJiB0aGlzLnN0YXRlW2tleV0uY29uc3RydWN0b3IgPT09IEFycmF5KSB7XG4gICAgICAgIHRoaXMuYXJyYXlzLnB1c2goa2V5KTtcbiAgICAgICAgdGhpcy5zdGF0ZVtrZXldLl9fZGlydHkgPSB0cnVlO1xuICAgICAgICB3cmFwQXJyYXkodGhpcy5zdGF0ZVtrZXldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmxhc3RTdGF0ZSA9IEFGUkFNRS51dGlscy5jbG9uZSh0aGlzLnN0YXRlKTtcblxuICAgIHRoaXMuZXZlbnREZXRhaWwgPSB7XG4gICAgICBsYXN0U3RhdGU6IHRoaXMubGFzdFN0YXRlLFxuICAgICAgc3RhdGU6IHRoaXMuc3RhdGVcbiAgICB9O1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaTtcbiAgICAgIC8vIEluaXRpYWwgY29tcHV0ZS5cbiAgICAgIFN0YXRlLmNvbXB1dGVTdGF0ZShfdGhpcy5zdGF0ZSwgJ0BASU5JVCcpO1xuICAgICAgLy8gSW5pdGlhbCBkaXNwYXRjaC5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBfdGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIF90aGlzLnN1YnNjcmlwdGlvbnNbaV0ub25TdGF0ZVVwZGF0ZShfdGhpcy5zdGF0ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERpc3BhdGNoIGFjdGlvbi5cbiAgICovXG4gIGRpc3BhdGNoOiBmdW5jdGlvbiBkaXNwYXRjaChhY3Rpb25OYW1lLCBwYXlsb2FkKSB7XG4gICAgdmFyIGRpcnR5QXJyYXlzO1xuICAgIHZhciBpO1xuICAgIHZhciBrZXk7XG4gICAgdmFyIHN1YnNjcmlwdGlvbjtcblxuICAgIC8vIE1vZGlmeSBzdGF0ZS5cbiAgICBTdGF0ZS5oYW5kbGVyc1thY3Rpb25OYW1lXSh0aGlzLnN0YXRlLCBwYXlsb2FkKTtcblxuICAgIC8vIFBvc3QtY29tcHV0ZS5cbiAgICBTdGF0ZS5jb21wdXRlU3RhdGUodGhpcy5zdGF0ZSwgYWN0aW9uTmFtZSwgcGF5bG9hZCk7XG5cbiAgICAvLyBHZXQgYSBkaWZmIHRvIG9wdGltaXplIGJpbmQgdXBkYXRlcy5cbiAgICBmb3IgKGtleSBpbiB0aGlzLmRpZmYpIHtcbiAgICAgIGRlbGV0ZSB0aGlzLmRpZmZba2V5XTtcbiAgICB9XG4gICAgZGlmZih0aGlzLmxhc3RTdGF0ZSwgdGhpcy5zdGF0ZSwgdGhpcy5kaWZmLCBTdGF0ZS5ub25CaW5kZWRTdGF0ZUtleXMpO1xuXG4gICAgdGhpcy5kaXJ0eUFycmF5cy5sZW5ndGggPSAwO1xuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLmFycmF5cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMuc3RhdGVbdGhpcy5hcnJheXNbaV1dLl9fZGlydHkpIHtcbiAgICAgICAgdGhpcy5kaXJ0eUFycmF5cy5wdXNoKHRoaXMuYXJyYXlzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBOb3RpZnkgc3Vic2NyaXB0aW9ucyAvIGJpbmRlcnMuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMuc3Vic2NyaXB0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uc1tpXS5uYW1lID09PSAnYmluZC1mb3InKSB7XG4gICAgICAgIC8vIEZvciBhcnJheXMgYW5kIGJpbmQtZm9yLCBjaGVjayBfX2RpcnR5IGZsYWcgb24gYXJyYXkgcmF0aGVyIHRoYW4gdGhlIGRpZmYuXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZVt0aGlzLnN1YnNjcmlwdGlvbnNbaV0ua2V5c1RvV2F0Y2hbMF1dLl9fZGlydHkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCF0aGlzLnNob3VsZFVwZGF0ZSh0aGlzLnN1YnNjcmlwdGlvbnNbaV0ua2V5c1RvV2F0Y2gsIHRoaXMuZGlmZiwgdGhpcy5kaXJ0eUFycmF5cykpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbnNbaV0ub25TdGF0ZVVwZGF0ZSgpO1xuICAgIH1cblxuICAgIC8vIFVuc2V0IGFycmF5IGRpcnR5LlxuICAgIGZvciAoa2V5IGluIHRoaXMuc3RhdGUpIHtcbiAgICAgIGlmICh0aGlzLnN0YXRlW2tleV0gJiYgdGhpcy5zdGF0ZVtrZXldLmNvbnN0cnVjdG9yID09PSBBcnJheSkge1xuICAgICAgICB0aGlzLnN0YXRlW2tleV0uX19kaXJ0eSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFN0b3JlIGxhc3Qgc3RhdGUuXG4gICAgdGhpcy5jb3B5U3RhdGUodGhpcy5sYXN0U3RhdGUsIHRoaXMuc3RhdGUpO1xuXG4gICAgLy8gRW1pdC5cbiAgICB0aGlzLmV2ZW50RGV0YWlsLmFjdGlvbiA9IGFjdGlvbk5hbWU7XG4gICAgdGhpcy5ldmVudERldGFpbC5wYXlsb2FkID0gcGF5bG9hZDtcbiAgICB0aGlzLmVsLmVtaXQoU1RBVEVfVVBEQVRFX0VWRU5ULCB0aGlzLmV2ZW50RGV0YWlsKTtcbiAgfSxcblxuICAvKipcbiAgICogU3RvcmUgbGFzdCBzdGF0ZSB0aHJvdWdoIGEgZGVlcCBleHRlbmQsIGJ1dCBub3QgZm9yIGFycmF5cy5cbiAgICovXG4gIGNvcHlTdGF0ZTogZnVuY3Rpb24gY29weVN0YXRlKGxhc3RTdGF0ZSwgc3RhdGUsIGlzUmVjdXJzaXZlKSB7XG4gICAgdmFyIGtleTtcblxuICAgIGZvciAoa2V5IGluIHN0YXRlKSB7XG4gICAgICAvLyBEb24ndCBjb3B5IHBpZWNlcyBvZiBzdGF0ZSBrZXlzIHRoYXQgYXJlIG5vbi1iaW5kZWQgb3IgdW50cmFja2VkLlxuICAgICAgaWYgKCFpc1JlY3Vyc2l2ZSAmJiBTdGF0ZS5ub25CaW5kZWRTdGF0ZUtleXMuaW5kZXhPZihrZXkpICE9PSAtMSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gTmVzdGVkIHN0YXRlLlxuICAgICAgaWYgKHN0YXRlW2tleV0gJiYgc3RhdGVba2V5XS5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0KSB7XG4gICAgICAgIGlmICghKGtleSBpbiBsYXN0U3RhdGUpKSB7XG4gICAgICAgICAgLy8gQ2xvbmUgb2JqZWN0IGlmIGRlc3RpbmF0aW9uIGRvZXMgbm90IGV4aXN0LlxuICAgICAgICAgIGxhc3RTdGF0ZVtrZXldID0gQUZSQU1FLnV0aWxzLmNsb25lKHN0YXRlW2tleV0pO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlY3Vyc2l2ZWx5IGNvcHkgc3RhdGUuXG4gICAgICAgIHRoaXMuY29weVN0YXRlKGxhc3RTdGF0ZVtrZXldLCBzdGF0ZVtrZXldLCB0cnVlKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIENvcHkgYnkgdmFsdWUuXG4gICAgICBsYXN0U3RhdGVba2V5XSA9IHN0YXRlW2tleV07XG4gICAgfVxuICB9LFxuXG4gIHN1YnNjcmliZTogZnVuY3Rpb24gc3Vic2NyaWJlKGNvbXBvbmVudCkge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKGNvbXBvbmVudCk7XG4gIH0sXG5cbiAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKGNvbXBvbmVudCkge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5zcGxpY2UodGhpcy5zdWJzY3JpcHRpb25zLmluZGV4T2YoY29tcG9uZW50KSwgMSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHN0YXRlIGNoYW5nZXMgd2VyZSByZWxldmFudCB0byB0aGlzIGJpbmRpbmcuIElmIG5vdCwgZG9uJ3QgY2FsbC5cbiAgICovXG4gIHNob3VsZFVwZGF0ZTogZnVuY3Rpb24gc2hvdWxkVXBkYXRlKGtleXNUb1dhdGNoLCBkaWZmLCBkaXJ0eUFycmF5cykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5c1RvV2F0Y2gubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChrZXlzVG9XYXRjaFtpXSBpbiBkaWZmIHx8IGRpcnR5QXJyYXlzLmluZGV4T2Yoa2V5c1RvV2F0Y2hbaV0pICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuXG4gIC8qKlxuICAgKiBQcm94eSBldmVudHMgdG8gYWN0aW9uIGRpc3BhdGNoZXMgc28gY29tcG9uZW50cyBjYW4ganVzdCBidWJibGUgYWN0aW9ucyB1cCBhcyBldmVudHMuXG4gICAqIEhhbmRsZXJzIGRlZmluZSB3aGljaCBhY3Rpb25zIHRoZXkgaGFuZGxlLiBHbyB0aHJvdWdoIGFsbCBhbmQgYWRkIGV2ZW50IGxpc3RlbmVycy5cbiAgICovXG4gIGluaXRFdmVudEhhbmRsZXJzOiBmdW5jdGlvbiBpbml0RXZlbnRIYW5kbGVycygpIHtcbiAgICB2YXIgYWN0aW9uTmFtZTtcbiAgICB2YXIgcmVnaXN0ZXJlZEFjdGlvbnMgPSBbXTtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICByZWdpc3Rlckxpc3RlbmVyID0gcmVnaXN0ZXJMaXN0ZW5lci5iaW5kKHRoaXMpO1xuXG4gICAgLy8gVXNlIGRlY2xhcmVkIGhhbmRsZXJzIHRvIGtub3cgd2hhdCBldmVudHMgdG8gbGlzdGVuIHRvLlxuICAgIGZvciAoYWN0aW9uTmFtZSBpbiBTdGF0ZS5oYW5kbGVycykge1xuICAgICAgLy8gT25seSBuZWVkIHRvIHJlZ2lzdGVyIG9uZSBoYW5kbGVyIGZvciBlYWNoIGV2ZW50LlxuICAgICAgaWYgKHJlZ2lzdGVyZWRBY3Rpb25zLmluZGV4T2YoYWN0aW9uTmFtZSkgIT09IC0xKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgcmVnaXN0ZXJlZEFjdGlvbnMucHVzaChhY3Rpb25OYW1lKTtcbiAgICAgIHJlZ2lzdGVyTGlzdGVuZXIoYWN0aW9uTmFtZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJMaXN0ZW5lcihhY3Rpb25OYW1lKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGFjdGlvbk5hbWUsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgX3RoaXMyLmRpc3BhdGNoKGFjdGlvbk5hbWUsIGV2dC5kZXRhaWwpO1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBSZW5kZXIgdGVtcGxhdGUgdG8gc3RyaW5nIHdpdGggaXRlbSBkYXRhLlxuICAgKi9cbiAgcmVuZGVyVGVtcGxhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBCcmFjZXMsIHdoaXRlc3BhY2UsIG9wdGlvbmFsIGl0ZW0gbmFtZSwgaXRlbSBrZXksIHdoaXRlc3BhY2UsIGJyYWNlcy5cbiAgICB2YXIgaW50ZXJwUmVnZXggPSAve3tcXHMqKFxcdypcXC4pPyhbXFx3Ll0rKVxccyp9fS9nO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZW1wbGF0ZSwgZGF0YSwgYXNTdHJpbmcpIHtcbiAgICAgIHZhciBtYXRjaDtcbiAgICAgIHZhciBzdHI7XG5cbiAgICAgIHN0ciA9IHRlbXBsYXRlO1xuXG4gICAgICAvLyBEYXRhIHdpbGwgYmUgbnVsbCBpZiBpbml0aWFsaXplIHBvb2wgZm9yIGJpbmQtZm9yLnVwZGF0ZUluUGxhY2UuXG4gICAgICBpZiAoZGF0YSkge1xuICAgICAgICB3aGlsZSAobWF0Y2ggPSBpbnRlcnBSZWdleC5leGVjKHRlbXBsYXRlKSkge1xuICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKG1hdGNoWzBdLCAodHlwZW9mIGRhdGEgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGRhdGEpKSA9PT0gVFlQRV9PQkpFQ1QgPyBsaWIuc2VsZWN0KGRhdGEsIG1hdGNoWzJdKSB8fCAnJyA6IGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFJldHVybiBhcyBzdHJpbmcuXG4gICAgICBpZiAoYXNTdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICAgIH1cblxuICAgICAgLy8gUmV0dXJuIGFzIERPTS5cbiAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVSYW5nZSgpLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudChzdHIpO1xuICAgIH07XG4gIH0oKSxcblxuICBzZWxlY3Q6IGxpYi5zZWxlY3Rcbn0pO1xuXG4vKipcbiAqIEJpbmQgY29tcG9uZW50IHByb3BlcnR5IHRvIGEgdmFsdWUgaW4gc3RhdGUuXG4gKlxuICogYmluZD1cImdlb21ldHJ5LndpZHRoOiBjYXIud2lkdGhcIlwiXG4gKiBiaW5kX19tYXRlcmlhbD1cImNvbG9yOiBlbmVteS5jb2xvcjsgb3BhY2l0eTogZW5lbXkub3BhY2l0eVwiXG4gKiBiaW5kX192aXNpYmxlPVwicGxheWVyLnZpc2libGVcIlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2JpbmQnLCB7XG4gIHNjaGVtYToge1xuICAgIGRlZmF1bHQ6IHt9LFxuICAgIHBhcnNlOiBmdW5jdGlvbiBwYXJzZSh2YWx1ZSkge1xuICAgICAgLy8gUGFyc2Ugc3R5bGUtbGlrZSBvYmplY3QuXG4gICAgICB2YXIgZGF0YTtcbiAgICAgIHZhciBpO1xuICAgICAgdmFyIHByb3BlcnRpZXM7XG4gICAgICB2YXIgcGFpcjtcblxuICAgICAgLy8gVXNpbmcgc2V0QXR0cmlidXRlIHdpdGggb2JqZWN0LCBubyBuZWVkIHRvIHBhcnNlLlxuICAgICAgaWYgKHZhbHVlLmNvbnN0cnVjdG9yID09PSBPYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuXG4gICAgICAvLyBVc2luZyBpbnN0YW5jZWQgSUQgYXMgY29tcG9uZW50IG5hbWVzcGFjZSBmb3Igc2luZ2xlLXByb3BlcnR5IGNvbXBvbmVudCxcbiAgICAgIC8vIG5vdGhpbmcgdG8gc2VwYXJhdGUuXG4gICAgICBpZiAodmFsdWUuaW5kZXhPZignOicpID09PSAtMSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFBhcnNlIHN0eWxlLWxpa2Ugb2JqZWN0IGFzIGtleXMgdG8gdmFsdWVzLlxuICAgICAgZGF0YSA9IHt9O1xuICAgICAgcHJvcGVydGllcyA9IGxpYi5zcGxpdCh2YWx1ZSwgJzsnKTtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBhaXIgPSBsaWIuc3BsaXQocHJvcGVydGllc1tpXS50cmltKCksICc6Jyk7XG4gICAgICAgIGRhdGFbcGFpclswXV0gPSBwYWlyWzFdLnRyaW0oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgIHZhciBjb21wb25lbnRJZDtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIga2V5O1xuXG4gICAgdGhpcy5rZXlzVG9XYXRjaCA9IFtdO1xuICAgIHRoaXMub25TdGF0ZVVwZGF0ZSA9IHRoaXMub25TdGF0ZVVwZGF0ZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3lzdGVtID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMuc3RhdGU7XG5cbiAgICAvLyBXaGV0aGVyIHdlIGFyZSBiaW5kaW5nIGJ5IG5hbWVzcGFjZSAoZS5nLiwgYmluZF9fZm9vPVwicHJvcDE6IHRydWVcIikuXG4gICAgaWYgKHRoaXMuaWQpIHtcbiAgICAgIGNvbXBvbmVudElkID0gbGliLnNwbGl0KHRoaXMuaWQsICdfXycpWzBdO1xuICAgIH1cbiAgICB0aGlzLmlzTmFtZXNwYWNlZEJpbmQgPSB0aGlzLmlkICYmIGNvbXBvbmVudElkIGluIEFGUkFNRS5jb21wb25lbnRzICYmICFBRlJBTUUuY29tcG9uZW50c1tjb21wb25lbnRJZF0uaXNTaW5nbGVQcm9wIHx8IGNvbXBvbmVudElkIGluIEFGUkFNRS5zeXN0ZW1zO1xuXG4gICAgdGhpcy5sYXN0RGF0YSA9IHt9O1xuICAgIHRoaXMudXBkYXRlT2JqID0ge307XG5cbiAgICAvLyBTdWJzY3JpYmUgdG8gc3RvcmUgYW5kIHJlZ2lzdGVyIGhhbmRsZXIgdG8gZG8gZGF0YS1iaW5kaW5nIHRvIGNvbXBvbmVudHMuXG4gICAgdGhpcy5zeXN0ZW0uc3Vic2NyaWJlKHRoaXMpO1xuXG4gICAgdGhpcy5vblN0YXRlVXBkYXRlID0gdGhpcy5vblN0YXRlVXBkYXRlLmJpbmQodGhpcyk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGtleTtcbiAgICB2YXIgcHJvcGVydHk7XG5cbiAgICAvLyBJbmRleCBga2V5c1RvV2F0Y2hgIHRvIG9ubHkgdXBkYXRlIHN0YXRlIG9uIHJlbGV2YW50IGNoYW5nZXMuXG4gICAgdGhpcy5rZXlzVG9XYXRjaC5sZW5ndGggPSAwO1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGxpYi5wYXJzZUtleXNUb1dhdGNoKHRoaXMua2V5c1RvV2F0Y2gsIGRhdGEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGtleSBpbiBkYXRhKSB7XG4gICAgICAgIGxpYi5wYXJzZUtleXNUb1dhdGNoKHRoaXMua2V5c1RvV2F0Y2gsIGRhdGFba2V5XSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5vblN0YXRlVXBkYXRlKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEhhbmRsZSBzdGF0ZSB1cGRhdGUuXG4gICAqL1xuICBvblN0YXRlVXBkYXRlOiBmdW5jdGlvbiBvblN0YXRlVXBkYXRlKCkge1xuICAgIC8vIFVwZGF0ZSBjb21wb25lbnQgd2l0aCB0aGUgc3RhdGUuXG4gICAgdmFyIGhhc0tleXMgPSBmYWxzZTtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBwcm9wZXJ0eU5hbWU7XG4gICAgdmFyIHN0YXRlU2VsZWN0b3I7XG4gICAgdmFyIHN0YXRlO1xuICAgIHZhciB0ZW1wTm9kZTtcbiAgICB2YXIgdmFsdWU7XG5cbiAgICBpZiAoIWVsLnBhcmVudE5vZGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNOYW1lc3BhY2VkQmluZCkge1xuICAgICAgbGliLmNsZWFyT2JqZWN0KHRoaXMudXBkYXRlT2JqKTtcbiAgICB9XG5cbiAgICBzdGF0ZSA9IHRoaXMuc3lzdGVtLnN0YXRlO1xuXG4gICAgLy8gU2luZ2xlLXByb3BlcnR5IGJpbmQuXG4gICAgaWYgKF90eXBlb2YodGhpcy5kYXRhKSAhPT0gVFlQRV9PQkpFQ1QpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHZhbHVlID0gbGliLnNlbGVjdChzdGF0ZSwgdGhpcy5kYXRhKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbYWZyYW1lLXN0YXRlLWNvbXBvbmVudF0gS2V5IFxcJycgKyB0aGlzLmRhdGEgKyAnXFwnIG5vdCBmb3VuZCBpbiBzdGF0ZS4nICsgKCcgIycgKyB0aGlzLmVsLmdldEF0dHJpYnV0ZSgnaWQnKSArICdbJyArIHRoaXMuYXR0ck5hbWUgKyAnXScpKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHZhbHVlKSkgIT09IFRZUEVfT0JKRUNUICYmIF90eXBlb2YodGhpcy5sYXN0RGF0YSkgIT09IFRZUEVfT0JKRUNUICYmIHRoaXMubGFzdERhdGEgPT09IHZhbHVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgQUZSQU1FLnV0aWxzLmVudGl0eS5zZXRDb21wb25lbnRQcm9wZXJ0eShlbCwgdGhpcy5pZCwgdmFsdWUpO1xuICAgICAgdGhpcy5sYXN0RGF0YSA9IHZhbHVlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAocHJvcGVydHlOYW1lIGluIHRoaXMuZGF0YSkge1xuICAgICAgLy8gUG9pbnRlciB0byBhIHZhbHVlIGluIHRoZSBzdGF0ZSAoZS5nLiwgYHBsYXllci5oZWFsdGhgKS5cbiAgICAgIHN0YXRlU2VsZWN0b3IgPSB0aGlzLmRhdGFbcHJvcGVydHlOYW1lXS50cmltKCk7XG4gICAgICB0cnkge1xuICAgICAgICB2YWx1ZSA9IGxpYi5zZWxlY3Qoc3RhdGUsIHN0YXRlU2VsZWN0b3IpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbYWZyYW1lLXN0YXRlLWNvbXBvbmVudF0gS2V5IFxcJycgKyBzdGF0ZVNlbGVjdG9yICsgJ1xcJyBub3QgZm91bmQgaW4gc3RhdGUuJyArICgnICMnICsgdGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ2lkJykgKyAnWycgKyB0aGlzLmF0dHJOYW1lICsgJ10nKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICgodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZih2YWx1ZSkpICE9PSBUWVBFX09CSkVDVCAmJiBfdHlwZW9mKHRoaXMubGFzdERhdGFbcHJvcGVydHlOYW1lXSkgIT09IFRZUEVfT0JKRUNUICYmIHRoaXMubGFzdERhdGFbcHJvcGVydHlOYW1lXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBjb21wb25lbnQgaWYgdmFsdWUgaXMgYHVuZGVmaW5lZGAuXG4gICAgICBpZiAocHJvcGVydHlOYW1lIGluIEFGUkFNRS5jb21wb25lbnRzICYmIHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKHByb3BlcnR5TmFtZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gU2V0IHVzaW5nIGRvdC1kZWxpbWl0ZWQgcHJvcGVydHkgbmFtZS5cbiAgICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlZEJpbmQpIHtcbiAgICAgICAgLy8gQmF0Y2ggaWYgZG9pbmcgbmFtZXNwYWNlZCBiaW5kLlxuICAgICAgICB0aGlzLnVwZGF0ZU9ialtwcm9wZXJ0eU5hbWVdID0gdmFsdWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBBRlJBTUUudXRpbHMuZW50aXR5LnNldENvbXBvbmVudFByb3BlcnR5KGVsLCBwcm9wZXJ0eU5hbWUsIHZhbHVlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5sYXN0RGF0YVtwcm9wZXJ0eU5hbWVdID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gQmF0Y2ggaWYgZG9pbmcgbmFtZXNwYWNlZCBiaW5kLlxuICAgIGZvciAoaGFzS2V5cyBpbiB0aGlzLnVwZGF0ZU9iaikge1xuICAgICAgLy8gU2VlIGlmIG9iamVjdCBpcyBlbXB0eS5cbiAgICB9XG4gICAgaWYgKHRoaXMuaXNOYW1lc3BhY2VkQmluZCAmJiBoYXNLZXlzKSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUodGhpcy5pZCwgdGhpcy51cGRhdGVPYmopO1xuICAgIH1cbiAgfSxcblxuICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICB0aGlzLnN5c3RlbS51bnN1YnNjcmliZSh0aGlzKTtcbiAgfVxufSk7XG5cbi8qKlxuICogVG9nZ2xlIGNvbXBvbmVudCBhdHRhY2ggYW5kIGRldGFjaCBiYXNlZCBvbiBib29sZWFuIHZhbHVlLlxuICpcbiAqIGJpbmQtdG9nZ2xlX19yYXljYXN0YWJsZT1cImlzUmF5Y2FzdGFibGVcIlwiXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmluZC10b2dnbGUnLCB7XG4gIHNjaGVtYTogeyB0eXBlOiAnc3RyaW5nJyB9LFxuXG4gIG11bHRpcGxlOiB0cnVlLFxuXG4gIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdGhpcy5zeXN0ZW0gPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZTtcbiAgICB0aGlzLmtleXNUb1dhdGNoID0gW107XG4gICAgdGhpcy5vblN0YXRlVXBkYXRlID0gdGhpcy5vblN0YXRlVXBkYXRlLmJpbmQodGhpcyk7XG5cbiAgICAvLyBTdWJzY3JpYmUgdG8gc3RvcmUgYW5kIHJlZ2lzdGVyIGhhbmRsZXIgdG8gZG8gZGF0YS1iaW5kaW5nIHRvIGNvbXBvbmVudHMuXG4gICAgdGhpcy5zeXN0ZW0uc3Vic2NyaWJlKHRoaXMpO1xuXG4gICAgdGhpcy5vblN0YXRlVXBkYXRlKCk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgdGhpcy5rZXlzVG9XYXRjaC5sZW5ndGggPSAwO1xuICAgIGxpYi5wYXJzZUtleXNUb1dhdGNoKHRoaXMua2V5c1RvV2F0Y2gsIHRoaXMuZGF0YSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEhhbmRsZSBzdGF0ZSB1cGRhdGUuXG4gICAqL1xuICBvblN0YXRlVXBkYXRlOiBmdW5jdGlvbiBvblN0YXRlVXBkYXRlKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIHN0YXRlO1xuICAgIHZhciB2YWx1ZTtcblxuICAgIHN0YXRlID0gdGhpcy5zeXN0ZW0uc3RhdGU7XG5cbiAgICB0cnkge1xuICAgICAgdmFsdWUgPSBsaWIuc2VsZWN0KHN0YXRlLCB0aGlzLmRhdGEpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignW2FmcmFtZS1zdGF0ZS1jb21wb25lbnRdIEtleSBcXCcnICsgdGhpcy5kYXRhICsgJ1xcJyBub3QgZm91bmQgaW4gc3RhdGUuJyArICgnICMnICsgdGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ2lkJykgKyAnWycgKyB0aGlzLmF0dHJOYW1lICsgJ10nKSk7XG4gICAgfVxuXG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUodGhpcy5pZCwgJycpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUodGhpcy5pZCk7XG4gICAgfVxuICB9LFxuXG4gIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgIHRoaXMuc3lzdGVtLnVuc3Vic2NyaWJlKHRoaXMpO1xuICB9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNvbXBvc2VGdW5jdGlvbnM6IGxpYi5jb21wb3NlRnVuY3Rpb25zLFxuICBjb21wb3NlSGFuZGxlcnM6IGxpYi5jb21wb3NlSGFuZGxlcnMsXG4gIHNlbGVjdDogbGliLnNlbGVjdFxufTtcblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBsaWIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG52YXIgSVRFTV9SRSA9IC9pdGVtLztcbnZhciBJVEVNX1BSRUZJWF9SRSA9IC9pdGVtLi87XG52YXIgSVRFTV9TRUxFQ1RPUl9SRSA9IC9pdGVtLihcXHcrKS87XG5cbi8qKlxuICogUmVuZGVyIGFycmF5IGZyb20gc3RhdGUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmluZC1mb3InLCB7XG4gIHNjaGVtYToge1xuICAgIGRlbGF5OiB7IGRlZmF1bHQ6IDAgfSxcbiAgICBmb3I6IHsgdHlwZTogJ3N0cmluZycsIGRlZmF1bHQ6ICdpdGVtJyB9LFxuICAgIGluOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAga2V5OiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgcG9vbDogeyBkZWZhdWx0OiAwIH0sXG4gICAgdGVtcGxhdGU6IHsgdHlwZTogJ3N0cmluZycgfSxcbiAgICB1cGRhdGVJblBsYWNlOiB7IGRlZmF1bHQ6IGZhbHNlIH1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgIC8vIFN1YnNjcmliZSB0byBzdG9yZSBhbmQgcmVnaXN0ZXIgaGFuZGxlciB0byBkbyBkYXRhLWJpbmRpbmcgdG8gY29tcG9uZW50cy5cbiAgICB0aGlzLnN5c3RlbSA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlO1xuICAgIHRoaXMub25TdGF0ZVVwZGF0ZSA9IHRoaXMub25TdGF0ZVVwZGF0ZS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5rZXlzVG9XYXRjaCA9IFtdO1xuICAgIHRoaXMucmVuZGVyZWRLZXlzID0gW107IC8vIEtleXMgdGhhdCBhcmUgY3VycmVudGx5IHJlbmRlcmVkLlxuICAgIHRoaXMuc3lzdGVtLnN1YnNjcmliZSh0aGlzKTtcblxuICAgIGlmICh0aGlzLmVsLmNoaWxkcmVuWzBdICYmIHRoaXMuZWwuY2hpbGRyZW5bMF0udGFnTmFtZSA9PT0gJ1RFTVBMQVRFJykge1xuICAgICAgdGhpcy50ZW1wbGF0ZSA9IHRoaXMuZWwuY2hpbGRyZW5bMF0uaW5uZXJIVE1MLnRyaW0oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5kYXRhLnRlbXBsYXRlKS5pbm5lckhUTUwudHJpbSgpO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kYXRhLnBvb2w7IGkrKykge1xuICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmdlbmVyYXRlRnJvbVRlbXBsYXRlKG51bGwsIGkpKTtcbiAgICB9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgdGhpcy5rZXlzVG9XYXRjaFswXSA9IGxpYi5zcGxpdCh0aGlzLmRhdGEuaW4sICcuJylbMF07XG4gICAgdGhpcy5vblN0YXRlVXBkYXRlKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gaXRlbXMgYXJlIHN3YXBwZWQgb3V0LCB0aGUgb2xkIG9uZXMgYXJlIHJlbW92ZWQsIGFuZCBuZXcgb25lcyBhcmUgYWRkZWQuIEFsbFxuICAgKiBlbnRpdGllcyB3aWxsIGJlIHJlaW5pdGlhbGl6ZWQuXG4gICAqL1xuICBvblN0YXRlVXBkYXRlTmFpdmU6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYWN0aXZlS2V5cyA9IFtdO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjaGlsZDtcbiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICAgIHZhciBsaXN0O1xuICAgICAgdmFyIGtleTtcbiAgICAgIHZhciBrZXlWYWx1ZTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgbGlzdCA9IGxpYi5zZWxlY3QodGhpcy5zeXN0ZW0uc3RhdGUsIGRhdGEuaW4pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1thZnJhbWUtc3RhdGUtY29tcG9uZW50XSBLZXkgXFwnJyArIGRhdGEuaW4gKyAnXFwnIG5vdCBmb3VuZCBpbiBzdGF0ZS4nICsgKCcgIycgKyBlbC5nZXRBdHRyaWJ1dGUoJ2lkJykgKyAnWycgKyB0aGlzLmF0dHJOYW1lICsgJ10nKSk7XG4gICAgICB9XG5cbiAgICAgIGFjdGl2ZUtleXMubGVuZ3RoID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgaXRlbSA9IGxpc3RbaV07XG4gICAgICAgIC8vIElmIGtleSBub3QgZGVmaW5lZCwgdXNlIGluZGV4IChlLmcuLCBhcnJheSBvZiBzdHJpbmdzKS5cbiAgICAgICAgYWN0aXZlS2V5cy5wdXNoKGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBpdGVtcyBieSByZW1vdmluZyBlbnRpdGllcy5cbiAgICAgIHZhciB0b1JlbW92ZUVscyA9IHRoaXMuZ2V0RWxzVG9SZW1vdmUoYWN0aXZlS2V5cywgdGhpcy5yZW5kZXJlZEtleXMpO1xuICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHRvUmVtb3ZlRWxzLmxlbmd0aDsgX2krKykge1xuICAgICAgICB0b1JlbW92ZUVsc1tfaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0b1JlbW92ZUVsc1tfaV0pO1xuICAgICAgfVxuXG4gICAgICBpZiAobGlzdC5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJJdGVtcyhsaXN0LCBhY3RpdmVLZXlzLCAwKTtcbiAgICAgIH1cbiAgICB9O1xuICB9KCksXG5cbiAgLyoqXG4gICAqIEFkZCBvciB1cGRhdGUgaXRlbSB3aXRoIGRlbGF5IHN1cHBvcnQuXG4gICAqL1xuICByZW5kZXJJdGVtczogZnVuY3Rpb24gcmVuZGVySXRlbXMobGlzdCwgYWN0aXZlS2V5cywgaSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpdGVtRWw7XG4gICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuXG4gICAgLy8gSWYga2V5IG5vdCBkZWZpbmVkLCB1c2UgaW5kZXggKGUuZy4sIGFycmF5IG9mIHN0cmluZ3MpLlxuICAgIHZhciBrZXlWYWx1ZSA9IGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKTtcblxuICAgIGlmICh0aGlzLnJlbmRlcmVkS2V5cy5pbmRleE9mKGtleVZhbHVlKSA9PT0gLTEpIHtcbiAgICAgIC8vIEFkZC5cbiAgICAgIGl0ZW1FbCA9IHRoaXMuZ2VuZXJhdGVGcm9tVGVtcGxhdGUoaXRlbSwgaSk7XG4gICAgICBlbC5hcHBlbmRDaGlsZChpdGVtRWwpO1xuICAgICAgdGhpcy5yZW5kZXJlZEtleXMucHVzaChrZXlWYWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVwZGF0ZS5cbiAgICAgIGlmIChsaXN0Lmxlbmd0aCAmJiBsaXN0WzBdLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcbiAgICAgICAgLy8gVXBkYXRlIGluZGV4IGZvciBzaW1wbGUgbGlzdC5cbiAgICAgICAgdmFyIF9rZXlWYWx1ZSA9IGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKTtcbiAgICAgICAgaXRlbUVsID0gZWwucXVlcnlTZWxlY3RvcignW2RhdGEtYmluZC1mb3ItdmFsdWU9XCInICsgX2tleVZhbHVlICsgJ1wiXScpO1xuICAgICAgICBpdGVtRWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWtleScsIGkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGJpbmRGb3JLZXkgPSB0aGlzLmdldEJpbmRGb3JLZXkoaXRlbSwgaSk7XG4gICAgICAgIGl0ZW1FbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJpbmQtZm9yLWtleT1cIicgKyBiaW5kRm9yS2V5ICsgJ1wiXScpO1xuICAgICAgfVxuICAgICAgaXRlbUVsLmVtaXQoJ2JpbmRmb3J1cGRhdGUnLCBpdGVtLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgaWYgKCFsaXN0W2kgKyAxXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEuZGVsYXkpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5yZW5kZXJJdGVtcyhsaXN0LCBhY3RpdmVLZXlzLCBpICsgMSk7XG4gICAgICB9LCB0aGlzLmRhdGEuZGVsYXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbmRlckl0ZW1zKGxpc3QsIGFjdGl2ZUtleXMsIGkgKyAxKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFdoZW4gaXRlbXMgYXJlIHN3YXBwZWQgb3V0LCB0aGlzIGFsZ29yaXRobSB3aWxsIHVwZGF0ZSBjb21wb25lbnQgdmFsdWVzIGluLXBsYWNlIHVzaW5nXG4gICAqIGJpbmQtaXRlbS5cbiAgICovXG4gIG9uU3RhdGVVcGRhdGVJblBsYWNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFjdGl2ZUtleXMgPSBbXTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgICB2YXIgbGlzdDtcbiAgICAgIHZhciBrZXk7XG4gICAgICB2YXIga2V5VmFsdWU7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGxpc3QgPSBsaWIuc2VsZWN0KHRoaXMuc3lzdGVtLnN0YXRlLCBkYXRhLmluKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignW2FmcmFtZS1zdGF0ZS1jb21wb25lbnRdIEtleSBcXCcnICsgZGF0YS5pbiArICdcXCcgbm90IGZvdW5kIGluIHN0YXRlLicgKyAoJyAjJyArIGVsLmdldEF0dHJpYnV0ZSgnaWQnKSArICdbJyArIHRoaXMuYXR0ck5hbWUgKyAnXScpKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2FsY3VsYXRlIGtleXMgdGhhdCBzaG91bGQgYmUgYWN0aXZlLlxuICAgICAgYWN0aXZlS2V5cy5sZW5ndGggPSAwO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBpdGVtID0gbGlzdFtpXTtcbiAgICAgICAga2V5VmFsdWUgPSBkYXRhLmtleSA/IGl0ZW1bZGF0YS5rZXldLnRvU3RyaW5nKCkgOiBpdGVtLnRvU3RyaW5nKCk7XG4gICAgICAgIGFjdGl2ZUtleXMucHVzaChrZXlWYWx1ZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBpdGVtcyBieSBwb29saW5nLiBEbyBiZWZvcmUgYWRkaW5nLlxuICAgICAgdmFyIHRvUmVtb3ZlRWxzID0gdGhpcy5nZXRFbHNUb1JlbW92ZShhY3RpdmVLZXlzLCB0aGlzLnJlbmRlcmVkS2V5cyk7XG4gICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCB0b1JlbW92ZUVscy5sZW5ndGg7IF9pMisrKSB7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0ub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0b1JlbW92ZUVsc1tfaTJdLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1hY3RpdmUnLCAnZmFsc2UnKTtcbiAgICAgICAgdG9SZW1vdmVFbHNbX2kyXS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3Ita2V5Jyk7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0ucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLXZhbHVlJyk7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0uZW1pdCgnYmluZGZvcmRlYWN0aXZhdGUnLCBudWxsLCBmYWxzZSk7XG4gICAgICAgIHRvUmVtb3ZlRWxzW19pMl0ucGF1c2UoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGxpc3QubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMucmVuZGVySXRlbXNJblBsYWNlKGxpc3QsIGFjdGl2ZUtleXMsIDApO1xuICAgICAgfVxuICAgIH07XG4gIH0oKSxcblxuICAvKipcbiAgICogQWRkLCB0YWtlb3Zlciwgb3IgdXBkYXRlIGl0ZW0gd2l0aCBkZWxheSBzdXBwb3J0LlxuICAgKi9cbiAgcmVuZGVySXRlbXNJblBsYWNlOiBmdW5jdGlvbiByZW5kZXJJdGVtc0luUGxhY2UobGlzdCwgYWN0aXZlS2V5cywgaSkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgaXRlbUVsO1xuXG4gICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuICAgIHZhciBiaW5kRm9yS2V5ID0gdGhpcy5nZXRCaW5kRm9yS2V5KGl0ZW0sIGkpO1xuICAgIHZhciBrZXlWYWx1ZSA9IGRhdGEua2V5ID8gaXRlbVtkYXRhLmtleV0udG9TdHJpbmcoKSA6IGl0ZW0udG9TdHJpbmcoKTtcblxuICAgIC8vIEFkZCBpdGVtLlxuICAgIGlmICh0aGlzLnJlbmRlcmVkS2V5cy5pbmRleE9mKGtleVZhbHVlKSA9PT0gLTEpIHtcbiAgICAgIGlmICghZWwucXVlcnlTZWxlY3RvcignOnNjb3BlID4gW2RhdGEtYmluZC1mb3ItYWN0aXZlPVwiZmFsc2VcIl0nKSkge1xuICAgICAgICAvLyBObyBpdGVtcyBhdmFpbGFibGUgaW4gcG9vbC4gR2VuZXJhdGUgbmV3IGVudGl0eS5cbiAgICAgICAgdmFyIF9pdGVtRWwgPSB0aGlzLmdlbmVyYXRlRnJvbVRlbXBsYXRlKGl0ZW0sIGkpO1xuICAgICAgICBfaXRlbUVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfaXRlbUVsLmVtaXQoJ2JpbmRmb3J1cGRhdGVpbnBsYWNlJywgaXRlbSwgZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoX2l0ZW1FbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUYWtlIG92ZXIgaW5hY3RpdmUgaXRlbS5cbiAgICAgICAgaXRlbUVsID0gZWwucXVlcnlTZWxlY3RvcignW2RhdGEtYmluZC1mb3ItYWN0aXZlPVwiZmFsc2VcIl0nKTtcbiAgICAgICAgaXRlbUVsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1rZXknLCBiaW5kRm9yS2V5KTtcbiAgICAgICAgaXRlbUVsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci12YWx1ZScsIGtleVZhbHVlKTtcbiAgICAgICAgaXRlbUVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgICAgICBpdGVtRWwucGxheSgpO1xuICAgICAgICBpdGVtRWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWFjdGl2ZScsICd0cnVlJyk7XG4gICAgICAgIGl0ZW1FbC5lbWl0KCdiaW5kZm9ydXBkYXRlaW5wbGFjZScsIGl0ZW0sIGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMucmVuZGVyZWRLZXlzLnB1c2goa2V5VmFsdWUpO1xuICAgIH0gZWxzZSBpZiAoYWN0aXZlS2V5cy5pbmRleE9mKGtleVZhbHVlKSAhPT0gLTEpIHtcbiAgICAgIC8vIFVwZGF0ZSBpdGVtLlxuICAgICAgaWYgKGxpc3QubGVuZ3RoICYmIGxpc3RbMF0uY29uc3RydWN0b3IgPT09IFN0cmluZykge1xuICAgICAgICAvLyBVcGRhdGUgaW5kZXggZm9yIHNpbXBsZSBsaXN0LlxuICAgICAgICBpdGVtRWwgPSBlbC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1iaW5kLWZvci12YWx1ZT1cIicgKyBrZXlWYWx1ZSArICdcIl0nKTtcbiAgICAgICAgaXRlbUVsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1rZXknLCBpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGl0ZW1FbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJpbmQtZm9yLWtleT1cIicgKyBiaW5kRm9yS2V5ICsgJ1wiXScpO1xuICAgICAgfVxuICAgICAgaXRlbUVsLmVtaXQoJ2JpbmRmb3J1cGRhdGVpbnBsYWNlJywgaXRlbSwgZmFsc2UpO1xuICAgIH1cblxuICAgIGlmICghbGlzdFtpICsgMV0pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kYXRhLmRlbGF5KSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMyLnJlbmRlckl0ZW1zSW5QbGFjZShsaXN0LCBhY3RpdmVLZXlzLCBpICsgMSk7XG4gICAgICB9LCB0aGlzLmRhdGEuZGVsYXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlbmRlckl0ZW1zSW5QbGFjZShsaXN0LCBhY3RpdmVLZXlzLCBpICsgMSk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBlbnRpdHkgZnJvbSB0ZW1wbGF0ZS5cbiAgICovXG4gIGdlbmVyYXRlRnJvbVRlbXBsYXRlOiBmdW5jdGlvbiBnZW5lcmF0ZUZyb21UZW1wbGF0ZShpdGVtLCBpKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMuc3lzdGVtLnJlbmRlclRlbXBsYXRlKHRoaXMudGVtcGxhdGUsIGl0ZW0pKTtcbiAgICB2YXIgbmV3RWwgPSB0aGlzLmVsLmNoaWxkcmVuW3RoaXMuZWwuY2hpbGRyZW4ubGVuZ3RoIC0gMV07O1xuXG4gICAgLy8gRnJvbSBwb29sLnRydWVcbiAgICBpZiAoIWl0ZW0pIHtcbiAgICAgIG5ld0VsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1rZXknLCAnJyk7XG4gICAgICBuZXdFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3ItYWN0aXZlJywgJ2ZhbHNlJyk7XG4gICAgICByZXR1cm4gbmV3RWw7XG4gICAgfVxuXG4gICAgdmFyIGJpbmRGb3JLZXkgPSB0aGlzLmdldEJpbmRGb3JLZXkoaXRlbSwgaSk7XG4gICAgbmV3RWwuc2V0QXR0cmlidXRlKCdkYXRhLWJpbmQtZm9yLWtleScsIGJpbmRGb3JLZXkpO1xuICAgIGlmICghZGF0YS5rZXkpIHtcbiAgICAgIG5ld0VsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci12YWx1ZScsIGl0ZW0pO1xuICAgIH1cblxuICAgIC8vIEtlZXAgdHJhY2sgb2YgcG9vbGVkIGFuZCBub24tcG9vbGVkIGVudGl0aWVzIGlmIHVwZGF0aW5nIGluIHBsYWNlLlxuICAgIG5ld0VsLnNldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1hY3RpdmUnLCAndHJ1ZScpO1xuICAgIHJldHVybiBuZXdFbDtcbiAgfSxcblxuICAvKipcbiAgICogR2V0IGVudGl0aWVzIG1hcmtlZCBmb3IgcmVtb3ZhbC5cbiAgICpcbiAgICogQHBhcmFtIHthcnJheX0gYWN0aXZlS2V5cyAtIExpc3Qgb2Yga2V5IHZhbHVlcyB0aGF0IHNob3VsZCBiZSBhY3RpdmUuXG4gICAqIEBwYXJhbSB7YXJyYXl9IHJlbmRlcmVkS2V5cyAtIExpc3Qgb2Yga2V5IHZhbHVlcyBjdXJyZW50bHkgcmVuZGVyZWQuXG4gICAqL1xuICBnZXRFbHNUb1JlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciB0b1JlbW92ZSA9IFtdO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhY3RpdmVLZXlzLCByZW5kZXJlZEtleXMpIHtcbiAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuICAgICAgdmFyIGVsID0gdGhpcy5lbDtcblxuICAgICAgdG9SZW1vdmUubGVuZ3RoID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWwuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGVsLmNoaWxkcmVuW2ldLnRhZ05hbWUgPT09ICdURU1QTEFURScpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIga2V5ID0gZGF0YS5rZXkgPyBlbC5jaGlsZHJlbltpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3Ita2V5JykgOiBlbC5jaGlsZHJlbltpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYmluZC1mb3ItdmFsdWUnKTtcbiAgICAgICAgaWYgKGFjdGl2ZUtleXMuaW5kZXhPZihrZXkpID09PSAtMSAmJiByZW5kZXJlZEtleXMuaW5kZXhPZihrZXkpICE9PSAtMSkge1xuICAgICAgICAgIHRvUmVtb3ZlLnB1c2goZWwuY2hpbGRyZW5baV0pO1xuICAgICAgICAgIHJlbmRlcmVkS2V5cy5zcGxpY2UocmVuZGVyZWRLZXlzLmluZGV4T2Yoa2V5KSwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0b1JlbW92ZTtcbiAgICB9O1xuICB9KCksXG5cbiAgLyoqXG4gICAqIEdldCB2YWx1ZSB0byB1c2UgYXMgdGhlIGRhdGEtYmluZC1mb3Ita2V5LlxuICAgKiBGb3IgaXRlbXMsIHdpbGwgYmUgdmFsdWUgc3BlY2lmaWVkIGJ5IGBiaW5kLWZvci5rZXlgLlxuICAgKiBGb3Igc2ltcGxlIGxpc3QsIHdpbGwgYmUgdGhlIGluZGV4LlxuICAgKi9cbiAgZ2V0QmluZEZvcktleTogZnVuY3Rpb24gZ2V0QmluZEZvcktleShpdGVtLCBpKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS5rZXkgPyBpdGVtW3RoaXMuZGF0YS5rZXldLnRvU3RyaW5nKCkgOiBpLnRvU3RyaW5nKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEhhbmRsZSBzdGF0ZSB1cGRhdGUuXG4gICAqL1xuICBvblN0YXRlVXBkYXRlOiBmdW5jdGlvbiBvblN0YXRlVXBkYXRlKCkge1xuICAgIGlmICh0aGlzLmRhdGEudXBkYXRlSW5QbGFjZSkge1xuICAgICAgdGhpcy5vblN0YXRlVXBkYXRlSW5QbGFjZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9uU3RhdGVVcGRhdGVOYWl2ZSgpO1xuICAgIH1cbiAgfVxufSk7XG5cbi8qKlxuICogSGFuZGxlIHBhcnNpbmcgYW5kIHVwZGF0ZSBpbi1wbGFjZSB1cGRhdGVzIHVuZGVyIGJpbmQtZm9yLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2JpbmQtaXRlbScsIHtcbiAgc2NoZW1hOiB7XG4gICAgdHlwZTogJ3N0cmluZydcbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiBpbml0KCkge1xuICAgIHRoaXMuaXRlbURhdGEgPSBudWxsO1xuICAgIHRoaXMua2V5c1RvV2F0Y2ggPSBbXTtcbiAgICB0aGlzLnByZXZWYWx1ZXMgPSB7fTtcblxuICAgIC8vIExpc3RlbiB0byByb290IGl0ZW0gZm9yIGV2ZW50cy5cbiAgICB2YXIgcm9vdEVsID0gdGhpcy5yb290RWwgPSB0aGlzLmVsLmNsb3Nlc3QoJ1tkYXRhLWJpbmQtZm9yLWtleV0nKTtcbiAgICBpZiAoIXJvb3RFbCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdiaW5kLWl0ZW0gY29tcG9uZW50IG11c3QgYmUgYXR0YWNoZWQgdG8gZW50aXR5IHVuZGVyIGEgYmluZC1mb3IgaXRlbS4nKTtcbiAgICB9XG4gICAgcm9vdEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2JpbmRmb3J1cGRhdGVpbnBsYWNlJywgdGhpcy51cGRhdGVJblBsYWNlLmJpbmQodGhpcykpO1xuICAgIHJvb3RFbC5hZGRFdmVudExpc3RlbmVyKCdiaW5kZm9yZGVhY3RpdmF0ZScsIHRoaXMuZGVhY3RpdmF0ZS5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlLnN1YnNjcmliZSh0aGlzKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICB0aGlzLnBhcnNlU2VsZWN0b3IoKTtcbiAgfSxcblxuICAvKipcbiAgICogUnVuIHdpdGggYmluZC1mb3IgdGVsbHMgdG8gdmlhIGV2ZW50IGBiaW5kZm9ydXBkYXRlaW5wbGFjZWAsIHBhc3NpbmcgaXRlbSBkYXRhLlxuICAgKi9cbiAgdXBkYXRlSW5QbGFjZTogZnVuY3Rpb24gdXBkYXRlSW5QbGFjZShldnQpIHtcbiAgICB2YXIgcHJvcGVydHlNYXAgPSB0aGlzLnByb3BlcnR5TWFwO1xuXG4gICAgaWYgKHRoaXMucm9vdEVsLmdldEF0dHJpYnV0ZSgnZGF0YS1iaW5kLWZvci1hY3RpdmUnKSA9PT0gJ2ZhbHNlJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChldnQpIHtcbiAgICAgIHRoaXMuaXRlbURhdGEgPSBldnQuZGV0YWlsO1xuICAgIH1cblxuICAgIGZvciAodmFyIHByb3BlcnR5IGluIHByb3BlcnR5TWFwKSB7XG4gICAgICAvLyBHZXQgdmFsdWUgZnJvbSBpdGVtLlxuICAgICAgdmFyIHZhbHVlID0gdGhpcy5zZWxlY3QodGhpcy5pdGVtRGF0YSwgcHJvcGVydHlNYXBbcHJvcGVydHldKTtcblxuICAgICAgLy8gRGlmZiBhZ2FpbnN0IHByZXZpb3VzIHZhbHVlLlxuICAgICAgaWYgKHZhbHVlID09PSB0aGlzLnByZXZWYWx1ZXNbcHJvcGVydHldKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBVcGRhdGUuXG4gICAgICBBRlJBTUUudXRpbHMuZW50aXR5LnNldENvbXBvbmVudFByb3BlcnR5KHRoaXMuZWwsIHByb3BlcnR5LCB2YWx1ZSk7XG5cbiAgICAgIHRoaXMucHJldlZhbHVlc1twcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICB9XG4gIH0sXG5cbiAgb25TdGF0ZVVwZGF0ZTogZnVuY3Rpb24gb25TdGF0ZVVwZGF0ZSgpIHtcbiAgICB0aGlzLnVwZGF0ZUluUGxhY2UoKTtcbiAgfSxcblxuICBzZWxlY3Q6IGZ1bmN0aW9uIHNlbGVjdChpdGVtRGF0YSwgc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbGliLnNlbGVjdCh0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZSwgc2VsZWN0b3IsIGl0ZW1EYXRhKTtcbiAgfSxcblxuICBkZWFjdGl2YXRlOiBmdW5jdGlvbiBkZWFjdGl2YXRlKCkge1xuICAgIHRoaXMucHJldlZhbHVlcyA9IHt9O1xuICB9LFxuXG4gIHBhcnNlU2VsZWN0b3I6IGZ1bmN0aW9uIHBhcnNlU2VsZWN0b3IoKSB7XG4gICAgdmFyIHByb3BlcnR5TWFwID0gdGhpcy5wcm9wZXJ0eU1hcCA9IHt9O1xuICAgIHRoaXMua2V5c1RvV2F0Y2gubGVuZ3RoID0gMDtcblxuICAgIHZhciBjb21wb25lbnROYW1lID0gbGliLnNwbGl0KHRoaXMuaWQsICdfXycpWzBdO1xuXG4gICAgLy8gRGlmZmVyZW50IHBhcnNpbmcgZm9yIG11bHRpLXByb3AgY29tcG9uZW50cy5cbiAgICBpZiAoY29tcG9uZW50TmFtZSBpbiBBRlJBTUUuY29tcG9uZW50cyAmJiAhQUZSQU1FLmNvbXBvbmVudHNbY29tcG9uZW50TmFtZV0uaXNTaW5nbGVQcm9wKSB7XG4gICAgICB2YXIgcHJvcGVydHlTcGxpdExpc3QgPSBsaWIuc3BsaXQodGhpcy5kYXRhLCAnOycpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0eVNwbGl0TGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcHJvcGVydHlTcGxpdCA9IGxpYi5zcGxpdChwcm9wZXJ0eVNwbGl0TGlzdFtpXSwgJzonKTtcbiAgICAgICAgcHJvcGVydHlNYXBbdGhpcy5pZCArICcuJyArIHByb3BlcnR5U3BsaXRbMF0udHJpbSgpXSA9IHByb3BlcnR5U3BsaXRbMV0udHJpbSgpO1xuICAgICAgICBsaWIucGFyc2VLZXlzVG9XYXRjaCh0aGlzLmtleXNUb1dhdGNoLCBwcm9wZXJ0eVNwbGl0WzFdLnRyaW0oKSwgdHJ1ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcHJvcGVydHlNYXBbdGhpcy5pZF0gPSB0aGlzLmRhdGE7XG4gICAgbGliLnBhcnNlS2V5c1RvV2F0Y2godGhpcy5rZXlzVG9XYXRjaCwgdGhpcy5kYXRhLCB0cnVlKTtcbiAgfVxufSk7XG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdHdvIG9iamVjdHMgd2l0aCBhYmlsaXR5IHRvIGlnbm9yZSBrZXlzLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhIC0gRmlyc3Qgb2JqZWN0IHRvIGNvbXBhcmUgKGUuZy4sIG9sZERhdGEpLlxuICogQHBhcmFtIHtvYmplY3R9IGIgLSBTZWNvbmQgb2JqZWN0IHRvIGNvbXBhcmUgKGUuZy4sIG5ld0RhdGEpLlxuICogQHJldHVybnMge29iamVjdH1cbiAqICAgRGlmZmVyZW5jZSBvYmplY3Qgd2hlcmUgc2V0IG9mIGtleXMgbm90ZSB3aGljaCB2YWx1ZXMgd2VyZSBub3QgZXF1YWwsIGFuZCB2YWx1ZXMgYXJlXG4gKiAgIGBiYCdzIHZhbHVlcy5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBrZXlzID0gW107XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChhLCBiLCB0YXJnZXRPYmplY3QsIGlnbm9yZUtleXMpIHtcbiAgICB2YXIgYVZhbDtcbiAgICB2YXIgYlZhbDtcbiAgICB2YXIgYktleTtcbiAgICB2YXIgZGlmZjtcbiAgICB2YXIga2V5O1xuICAgIHZhciBpO1xuICAgIHZhciBpc0NvbXBhcmluZ09iamVjdHM7XG5cbiAgICBkaWZmID0gdGFyZ2V0T2JqZWN0IHx8IHt9O1xuXG4gICAgLy8gQ29sbGVjdCBBIGtleXMuXG4gICAga2V5cy5sZW5ndGggPSAwO1xuICAgIGZvciAoa2V5IGluIGEpIHtcbiAgICAgIGtleXMucHVzaChrZXkpO1xuICAgIH1cblxuICAgIGlmICghYikge1xuICAgICAgcmV0dXJuIGRpZmY7XG4gICAgfVxuXG4gICAgLy8gQ29sbGVjdCBCIGtleXMuXG4gICAgZm9yIChiS2V5IGluIGIpIHtcbiAgICAgIGlmIChrZXlzLmluZGV4T2YoYktleSkgPT09IC0xKSB7XG4gICAgICAgIGtleXMucHVzaChiS2V5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAga2V5ID0ga2V5c1tpXTtcblxuICAgICAgLy8gSWdub3JlIHNwZWNpZmllZCBrZXlzLlxuICAgICAgaWYgKGlnbm9yZUtleXMgJiYgaWdub3JlS2V5cy5pbmRleE9mKGtleSkgIT09IC0xKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBhVmFsID0gYVtrZXldO1xuICAgICAgYlZhbCA9IGJba2V5XTtcbiAgICAgIGlzQ29tcGFyaW5nT2JqZWN0cyA9IGFWYWwgJiYgYlZhbCAmJiBhVmFsLmNvbnN0cnVjdG9yID09PSBPYmplY3QgJiYgYlZhbC5jb25zdHJ1Y3RvciA9PT0gT2JqZWN0O1xuICAgICAgaWYgKGlzQ29tcGFyaW5nT2JqZWN0cyAmJiAhQUZSQU1FLnV0aWxzLmRlZXBFcXVhbChhVmFsLCBiVmFsKSB8fCAhaXNDb21wYXJpbmdPYmplY3RzICYmIGFWYWwgIT09IGJWYWwpIHtcbiAgICAgICAgZGlmZltrZXldID0gYlZhbDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRpZmY7XG4gIH07XG59KCk7XG5cbi8qKiovIH0pLFxuLyogNCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgZm5zID0gWydwdXNoJywgJ3BvcCcsICdzaGlmdCcsICd1bnNoaWZ0JywgJ3NwbGljZSddO1xuXG5mdW5jdGlvbiB3cmFwQXJyYXkoYXJyKSB7XG4gIHZhciBpO1xuICBpZiAoYXJyLl9fd3JhcHBlZCkge1xuICAgIHJldHVybjtcbiAgfVxuICBmb3IgKGkgPSAwOyBpIDwgZm5zLmxlbmd0aDsgaSsrKSB7XG4gICAgbWFrZUNhbGxEaXJ0eShhcnIsIGZuc1tpXSk7XG4gIH1cbiAgYXJyLl9fd3JhcHBlZCA9IHRydWU7XG59XG5tb2R1bGUuZXhwb3J0cy53cmFwQXJyYXkgPSB3cmFwQXJyYXk7XG5cbmZ1bmN0aW9uIG1ha2VDYWxsRGlydHkoYXJyLCBmbikge1xuICB2YXIgb3JpZ2luYWxGbiA9IGFycltmbl07XG4gIGFycltmbl0gPSBmdW5jdGlvbiAoKSB7XG4gICAgb3JpZ2luYWxGbi5hcHBseShhcnIsIGFyZ3VtZW50cyk7XG4gICAgYXJyLl9fZGlydHkgPSB0cnVlO1xuICB9O1xufVxuXG4vKioqLyB9KVxuLyoqKioqKi8gXSk7XG59KTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWZyYW1lLXN0YXRlLWNvbXBvbmVudC9kaXN0L2FmcmFtZS1zdGF0ZS1jb21wb25lbnQuanNcbi8vIG1vZHVsZSBpZCA9IDMwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBUWVBFX1BBRCA9ICdQQUQnO1xudmFyIFRZUEVfU1RJQ0sgPSAnU1RJQ0snO1xuXG52YXIgQU5HTEVfUklHSFQgPSAwO1xudmFyIEFOR0xFX1VQID0gOTA7XG52YXIgQU5HTEVfTEVGVCA9IDE4MDtcbnZhciBBTkdMRV9ET1dOID0gMjcwO1xuXG52YXIgUklHSFQgPSAncmlnaHQnO1xudmFyIFVQID0gJ3VwJztcbnZhciBMRUZUID0gJ2xlZnQnO1xudmFyIERPV04gPSAnZG93bic7XG5cbnZhciBBTkdMRVMgPSBbQU5HTEVfUklHSFQsIEFOR0xFX1VQLCBBTkdMRV9MRUZULCBBTkdMRV9ET1dOXTtcbnZhciBESVJFQ1RJT05TID0gW1JJR0hULCBVUCwgTEVGVCwgRE9XTl07XG5cbnZhciBFVkVOVFMgPSB7TlVMTDoge1NUQVJUOiAndGh1bWJzdGFydCcsIEVORDogJ3RodW1iZW5kJ319O1xuRElSRUNUSU9OUy5mb3JFYWNoKGRpcmVjdGlvbiA9PiB7XG4gIEVWRU5UU1tkaXJlY3Rpb25dID0ge307XG4gIEVWRU5UU1tkaXJlY3Rpb25dLlNUQVJUID0gJ3RodW1iJyArIGRpcmVjdGlvbiArICdzdGFydCc7XG4gIEVWRU5UU1tkaXJlY3Rpb25dLkVORCAgPSAndGh1bWInICsgZGlyZWN0aW9uICsgJ2VuZCc7XG59KTtcblxuLy8gRm9yIGRlYnVnLlxudmFyIFNJWkUgPSAyNDA7XG5cbi8qKlxuICogTm9ybWFsaXplIHRyYWNrcGFkIHZzIHRodW1ic3RpY2sgY29udHJvbHMuXG4gKiBgdGh1bWJzdGFydGBcbiAqIGB0aHVtYmVuZGBcbiAqIGB0aHVtYmxlZnRzdGFydGBcbiAqIGB0aHVtYmxlZnRlbmRgXG4gKiBgdGh1bWJyaWdodHN0YXJ0YFxuICogYHRodW1icmlnaHRlbmRgXG4gKiBgdGh1bWJ1cHN0YXJ0YFxuICogYHRodW1idXBlbmRgXG4gKiBgdGh1bWJkb3duc3RhcnRgXG4gKiBgdGh1bWJkb3duZW5kYFxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3RodW1iLWNvbnRyb2xzJywge1xuICBkZXBlbmRlbmNpZXM6IFsndHJhY2tlZC1jb250cm9scyddLFxuXG4gIHNjaGVtYToge1xuICAgIHRocmVzaG9sZEFuZ2xlOiB7ZGVmYXVsdDogODkuNX0sXG4gICAgdGhyZXNob2xkUGFkOiB7ZGVmYXVsdDogMC4wNX0sXG4gICAgdGhyZXNob2xkU3RpY2s6IHtkZWZhdWx0OiAwLjc1fVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHRoaXMub25UcmFja3BhZERvd24gPSB0aGlzLm9uVHJhY2twYWREb3duLmJpbmQodGhpcylcbiAgICB0aGlzLm9uVHJhY2twYWRVcCA9IHRoaXMub25UcmFja3BhZFVwLmJpbmQodGhpcylcblxuICAgIHRoaXMuZGlyZWN0aW9uU3RpY2sgPSAnJztcbiAgICB0aGlzLmRpcmVjdGlvblRyYWNrcGFkID0gJyc7XG5cbiAgICAvLyBHZXQgdGh1bWIgdHlwZSAoc3RpY2sgdnMgcGFkKS5cbiAgICB0aGlzLnR5cGUgPSBUWVBFX1NUSUNLO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCBldnQgPT4ge1xuICAgICAgaWYgKGV2dC5kZXRhaWwubmFtZSA9PT0gJ29jdWx1cy10b3VjaC1jb250cm9scycgfHxcbiAgICAgICAgICBldnQuZGV0YWlsLm5hbWUgPT09ICd3aW5kb3dzLW1vdGlvbi1jb250cm9scycpIHtcbiAgICAgICAgdGhpcy50eXBlID0gVFlQRV9TVElDSztcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy50eXBlID0gVFlQRV9QQUQ7XG4gICAgfSk7XG5cbiAgICB0aGlzLmF4aXMgPSBlbC5jb21wb25lbnRzWyd0cmFja2VkLWNvbnRyb2xzJ10uYXhpcztcbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0cmFja3BhZGRvd24nLCB0aGlzLm9uVHJhY2twYWREb3duKTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0cmFja3BhZHVwJywgdGhpcy5vblRyYWNrcGFkVXApO1xuICB9LFxuXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFja3BhZGRvd24nLCB0aGlzLm9uVHJhY2twYWREb3duKTtcbiAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFja3BhZHVwJywgdGhpcy5vblRyYWNrcGFkVXApO1xuICB9LFxuXG4gIC8vIEZvciBwYWQuXG4gIG9uVHJhY2twYWREb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRpcmVjdGlvbjtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpO1xuICAgIGlmICh0aGlzLmdldERpc3RhbmNlKCkgPCB0aGlzLmRhdGEudGhyZXNob2xkUGFkKSB7IHJldHVybjsgfVxuICAgIGRpcmVjdGlvbiA9IHRoaXMuZ2V0RGlyZWN0aW9uKCk7XG4gICAgaWYgKCFkaXJlY3Rpb24pIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5kaXJlY3Rpb25UcmFja3BhZCA9IGRpcmVjdGlvbjtcbiAgICBlbC5lbWl0KEVWRU5UUy5OVUxMLlNUQVJULCBudWxsLCBmYWxzZSk7XG4gICAgZWwuZW1pdChFVkVOVFNbdGhpcy5kaXJlY3Rpb25UcmFja3BhZF0uU1RBUlQsIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICAvLyBGb3IgcGFkLlxuICBvblRyYWNrcGFkVXA6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIGlmICghdGhpcy5kaXJlY3Rpb25UcmFja3BhZCkgeyByZXR1cm47IH1cbiAgICBlbC5lbWl0KEVWRU5UUy5OVUxMLkVORCwgbnVsbCwgZmFsc2UpO1xuICAgIGVsLmVtaXQoRVZFTlRTW3RoaXMuZGlyZWN0aW9uVHJhY2twYWRdLkVORCwgbnVsbCwgZmFsc2UpO1xuICAgIHRoaXMuZGlyZWN0aW9uVHJhY2twYWQgPSAnJztcbiAgfSxcblxuICAvLyBBeGlzLlxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRpcmVjdGlvbjtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gVFlQRV9QQUQpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBTdGljayBwdWxsZWQuIFN0b3JlIGRpcmVjdGlvbiBhbmQgZW1pdCBzdGFydCBldmVudC5cbiAgICBpZiAoIXRoaXMuZGlyZWN0aW9uU3RpY2sgJiYgdGhpcy5nZXREaXN0YW5jZSgpID4gdGhpcy5kYXRhLnRocmVzaG9sZFN0aWNrKSB7XG4gICAgICBkaXJlY3Rpb24gPSB0aGlzLmdldERpcmVjdGlvbigpO1xuICAgICAgaWYgKCFkaXJlY3Rpb24pIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLmRpcmVjdGlvblN0aWNrID0gZGlyZWN0aW9uO1xuICAgICAgZWwuZW1pdChFVkVOVFMuTlVMTC5TVEFSVCwgbnVsbCwgZmFsc2UpO1xuICAgICAgZWwuZW1pdChFVkVOVFNbdGhpcy5kaXJlY3Rpb25TdGlja10uU1RBUlQsIG51bGwsIGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTdGljayBwdWxsZWQgYmFjay4gUmVzZXQgZGlyZWNpdG9uIGFuZCBlbWl0IGVuZCBldmVudC5cbiAgICBpZiAodGhpcy5kaXJlY3Rpb25TdGljayAmJiB0aGlzLmdldERpc3RhbmNlKCkgPCB0aGlzLmRhdGEudGhyZXNob2xkU3RpY2spIHtcbiAgICAgIGVsLmVtaXQoRVZFTlRTLk5VTEwuRU5ELCBudWxsLCBmYWxzZSk7XG4gICAgICBlbC5lbWl0KEVWRU5UU1t0aGlzLmRpcmVjdGlvblN0aWNrXS5FTkQsIG51bGwsIGZhbHNlKTtcbiAgICAgIHRoaXMuZGlyZWN0aW9uU3RpY2sgPSAnJztcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIERpc3RhbmNlIGZyb20gY2VudGVyIG9mIHRodW1iLlxuICAgKi9cbiAgZ2V0RGlzdGFuY2U6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXhpcyA9IHRoaXMuYXhpcztcbiAgICByZXR1cm4gTWF0aC5zcXJ0KGF4aXNbMV0gKiBheGlzWzFdICsgYXhpc1swXSAqIGF4aXNbMF0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBUcmFuc2xhdGUgYW5nbGUgaW50byBkaXJlY3Rpb24uXG4gICAqL1xuICBnZXREaXJlY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYW5nbGU7XG4gICAgdmFyIGJvdHRvbVRocmVzaG9sZDtcbiAgICB2YXIgaTtcbiAgICB2YXIgdGhyZXNob2xkO1xuICAgIHZhciB0b3BUaHJlc2hvbGQ7XG4gICAgYW5nbGUgPSB0aGlzLmdldEFuZ2xlKCk7XG4gICAgdGhyZXNob2xkID0gdGhpcy5kYXRhLnRocmVzaG9sZEFuZ2xlIC8gMjtcbiAgICBmb3IgKGkgPSAwOyBpIDwgQU5HTEVTLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0b3BUaHJlc2hvbGQgPSBBTkdMRVNbaV0gKyB0aHJlc2hvbGQ7XG4gICAgICBpZiAodG9wVGhyZXNob2xkID4gMzYwKSB7IHRvcFRocmVzaG9sZCA9IHRvcFRocmVzaG9sZCAtIDM2MDsgfVxuXG4gICAgICBib3R0b21UaHJlc2hvbGQgPSBBTkdMRVNbaV0gLSB0aHJlc2hvbGQ7XG4gICAgICBpZiAoYm90dG9tVGhyZXNob2xkIDwgMCkge1xuICAgICAgICBpZiAoKGFuZ2xlID49IDM2MCArIGJvdHRvbVRocmVzaG9sZCAmJiBhbmdsZSA8PSAzNjApIHx8XG4gICAgICAgICAgICAoYW5nbGUgPj0gMCAmJiBhbmdsZSA8PSB0b3BUaHJlc2hvbGQpKSB7XG4gICAgICAgICAgcmV0dXJuIERJUkVDVElPTlNbaV07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGFuZ2xlID49IGJvdHRvbVRocmVzaG9sZCAmJiBhbmdsZSA8PSB0b3BUaHJlc2hvbGQpIHtcbiAgICAgICAgcmV0dXJuIERJUkVDVElPTlNbaV07XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgYW5nbGUgaW4gZGVncmVlcywgd2l0aCAwIHN0YXJ0aW5nIG9uIHRoZSByaWdodCBnb2luZyB0byAzNjAuIExpa2UgdW5pdCBjaXJjbGUuXG4gICAqL1xuICBnZXRBbmdsZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBhbmdsZTtcbiAgICB2YXIgYXhpcyA9IHRoaXMuYXhpcztcbiAgICB2YXIgZmxpcFk7XG4gICAgZmxpcFkgPSB0aGlzLnR5cGUgPT09IFRZUEVfU1RJQ0sgPyAtMSA6IDE7XG4gICAgYW5nbGUgPSBNYXRoLmF0YW4yKGF4aXNbMV0gKiBmbGlwWSwgYXhpc1swXSk7XG4gICAgaWYgKGFuZ2xlIDwgMCkgeyBhbmdsZSA9IDIgKiBNYXRoLlBJICsgYW5nbGU7IH1cbiAgICByZXR1cm4gVEhSRUUuTWF0aC5yYWRUb0RlZyhhbmdsZSk7XG4gIH1cbn0pO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3RodW1iLWNvbnRyb2xzLWRlYnVnJywge1xuICBkZXBlbmRlbmNpZXM6IFsndGh1bWItY29udHJvbHMnLCAndHJhY2tlZC1jb250cm9scyddLFxuXG4gIHNjaGVtYToge1xuICAgIGNvbnRyb2xsZXJUeXBlOiB7dHlwZTogJ3N0cmluZyd9LFxuICAgIGhhbmQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaXNBY3RpdmU7XG4gICAgdmFyIGF4aXM7XG4gICAgdmFyIGF4aXNNb3ZlRXZlbnREZXRhaWw7XG4gICAgdmFyIGNhbnZhcztcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgaWYgKCFkYXRhLmVuYWJsZWQgJiYgIUFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnLXRodW1iJykpIHsgcmV0dXJuOyB9XG4gICAgY29uc29sZS5sb2coJyVjIGRlYnVnLXRodW1iJywgJ2JhY2tncm91bmQ6ICMxMTE7IGNvbG9yOiByZWQnKTtcblxuICAgIC8vIFN0dWIuXG4gICAgZWwuY29tcG9uZW50c1sndHJhY2tlZC1jb250cm9scyddLmhhbmRsZUF4ZXMgPSAoKSA9PiB7fTtcblxuICAgIGF4aXMgPSBbMCwgMCwgMF07XG4gICAgYXhpc01vdmVFdmVudERldGFpbCA9IHtheGlzOiBheGlzfTtcbiAgICBlbC5jb21wb25lbnRzWyd0cmFja2VkLWNvbnRyb2xzJ10uYXhpcyA9IGF4aXM7XG4gICAgZWwuY29tcG9uZW50c1sndGh1bWItY29udHJvbHMnXS5heGlzID0gYXhpcztcblxuICAgIGNhbnZhcyA9IHRoaXMuY3JlYXRlQ2FudmFzKCk7XG5cbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldnQgPT4ge1xuICAgICAgaWYgKHRoaXMuZGF0YS5jb250cm9sbGVyVHlwZSA9PT0gJ3ZpdmUtY29udHJvbHMnKSB7XG4gICAgICAgIGlmIChpc0FjdGl2ZSkge1xuICAgICAgICAgIGVsLmVtaXQoJ3RyYWNrcGFkdXAnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbC5lbWl0KCd0cmFja3BhZGRvd24nKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGlzQWN0aXZlKSB7XG4gICAgICAgICAgYXhpc1swXSA9IDA7XG4gICAgICAgICAgYXhpc1sxXSA9IDA7XG4gICAgICAgICAgZWwuZW1pdCgnYXhpc21vdmUnLCBheGlzTW92ZUV2ZW50RGV0YWlsLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlzQWN0aXZlID0gIWlzQWN0aXZlO1xuICAgIH0pO1xuXG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGV2dCA9PiB7XG4gICAgICB2YXIgcmVjdDtcbiAgICAgIGlmICghaXNBY3RpdmUpIHsgcmV0dXJuOyB9XG4gICAgICByZWN0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgYXhpc1swXSA9IChldnQuY2xpZW50WCAtIHJlY3QubGVmdCkgLyBTSVpFICogMiAtIDE7XG4gICAgICBheGlzWzFdID0gKGV2dC5jbGllbnRZIC0gcmVjdC50b3ApIC8gU0laRSAqIDIgLSAxO1xuICAgICAgZWwuZW1pdCgnYXhpc21vdmUnLCBheGlzTW92ZUV2ZW50RGV0YWlsLCBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGV2dCA9PiB7XG4gICAgICBpZiAoIWlzQWN0aXZlKSB7IHJldHVybjsgfVxuICAgICAgYXhpc1swXSA9IDA7XG4gICAgICBheGlzWzFdID0gMDtcbiAgICAgIGVsLmVtaXQoJ2F4aXNtb3ZlJywgYXhpc01vdmVFdmVudERldGFpbCwgZmFsc2UpO1xuICAgIH0pO1xuICB9LFxuXG4gIGNyZWF0ZUNhbnZhczogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjYW52YXM7XG4gICAgdmFyIGN0eDtcbiAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICBjYW52YXMuY2xhc3NMaXN0LmFkZCgnZGVidWdUaHVtYicpO1xuICAgIGNhbnZhcy5oZWlnaHQgPSBTSVpFO1xuICAgIGNhbnZhcy53aWR0aCA9IFNJWkU7XG4gICAgY2FudmFzLnN0eWxlLmJvdHRvbSA9IDA7XG4gICAgY2FudmFzLnN0eWxlLmJvcmRlclJhZGl1cyA9ICcyNTBweCc7XG4gICAgY2FudmFzLnN0eWxlLm9wYWNpdHkgPSAwLjU7XG4gICAgY2FudmFzLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICBjYW52YXMuc3R5bGUuekluZGV4ID0gOTk5OTk5OTk5O1xuICAgIGlmICh0aGlzLmRhdGEuaGFuZCA9PT0gJ2xlZnQnKSB7XG4gICAgICBjYW52YXMuc3R5bGUubGVmdCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhbnZhcy5zdHlsZS5yaWdodCA9IDA7XG4gICAgfVxuICAgIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGN0eC5maWxsU3R5bGUgPSBcIiMzMzNcIjtcbiAgICBjdHguZmlsbFJlY3QoMCwgMCwgU0laRSwgU0laRSk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjYW52YXMpO1xuICAgIHJldHVybiBjYW52YXM7XG4gIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS10aHVtYi1jb250cm9scy1jb21wb25lbnQvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDMxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIlxudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuL2luZGV4LmNzc1wiKTtcblxuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5cbnZhciB0cmFuc2Zvcm07XG52YXIgaW5zZXJ0SW50bztcblxuXG5cbnZhciBvcHRpb25zID0ge1wiaG1yXCI6dHJ1ZX1cblxub3B0aW9ucy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm1cbm9wdGlvbnMuaW5zZXJ0SW50byA9IHVuZGVmaW5lZDtcblxudmFyIHVwZGF0ZSA9IHJlcXVpcmUoXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9saWIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG5pZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2FscztcblxuaWYobW9kdWxlLmhvdCkge1xuXHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhLi9pbmRleC5jc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuL2luZGV4LmNzc1wiKTtcblxuXHRcdGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuXG5cdFx0dmFyIGxvY2FscyA9IChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHR2YXIga2V5LCBpZHggPSAwO1xuXG5cdFx0XHRmb3Ioa2V5IGluIGEpIHtcblx0XHRcdFx0aWYoIWIgfHwgYVtrZXldICE9PSBiW2tleV0pIHJldHVybiBmYWxzZTtcblx0XHRcdFx0aWR4Kys7XG5cdFx0XHR9XG5cblx0XHRcdGZvcihrZXkgaW4gYikgaWR4LS07XG5cblx0XHRcdHJldHVybiBpZHggPT09IDA7XG5cdFx0fShjb250ZW50LmxvY2FscywgbmV3Q29udGVudC5sb2NhbHMpKTtcblxuXHRcdGlmKCFsb2NhbHMpIHRocm93IG5ldyBFcnJvcignQWJvcnRpbmcgQ1NTIEhNUiBkdWUgdG8gY2hhbmdlZCBjc3MtbW9kdWxlcyBsb2NhbHMuJyk7XG5cblx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdH0pO1xuXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2luZGV4LmNzc1xuLy8gbW9kdWxlIGlkID0gMzJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIG1hcCA9IHtcblx0XCIuL2FjdGl2ZS1jb2xvci5qc1wiOiA1OSxcblx0XCIuL2F1ZGlvLWNvbHVtbnMuanNcIjogNjAsXG5cdFwiLi9iZWFtcy5qc1wiOiA2MSxcblx0XCIuL2JlYXQtaGl0LXNvdW5kLmpzXCI6IDYyLFxuXHRcIi4vYmVhdC1sb2FkZXIuanNcIjogNjMsXG5cdFwiLi9iZWF0LmpzXCI6IDY0LFxuXHRcIi4vY29uc29sZS1zaG9ydGN1dHMuanNcIjogNjUsXG5cdFwiLi9jb3B5LXRleHR1cmUuanNcIjogNjYsXG5cdFwiLi9jdXJzb3ItbGFzZXIuanNcIjogNjcsXG5cdFwiLi9jdXJzb3ItbWVzaC5qc1wiOiA2OCxcblx0XCIuL2RlYnVnLWJlYXQtbG9hZGVyLmpzXCI6IDY5LFxuXHRcIi4vZGVidWctY29udHJvbGxlci5qc1wiOiA3MCxcblx0XCIuL2RlYnVnLWN1cnNvci5qc1wiOiA3MSxcblx0XCIuL2RlYnVnLXNvbmctdGltZS5qc1wiOiA3Mixcblx0XCIuL2RlYnVnLXN0YXRlLmpzXCI6IDczLFxuXHRcIi4vZmFrZS1nbG93LmpzXCI6IDc0LFxuXHRcIi4vZmxvb3Itc2hhZGVyLmpzXCI6IDc1LFxuXHRcIi4vZ2FtZW92ZXIuanNcIjogNzYsXG5cdFwiLi9ncHUtcHJlbG9hZGVyLmpzXCI6IDc3LFxuXHRcIi4vaGFjay5qc1wiOiA3OCxcblx0XCIuL2hhbmQtc3dhcHBlci5qc1wiOiA3OSxcblx0XCIuL2hhcHRpY3Mtc2FiZXIuanNcIjogODAsXG5cdFwiLi9oYXB0aWNzLXdhbGwuanNcIjogODEsXG5cdFwiLi9oaXN0b3J5LmpzXCI6IDgyLFxuXHRcIi4vaW50cm8tc29uZy5qc1wiOiA4Myxcblx0XCIuL2tleWJvYXJkLXJheWNhc3RhYmxlLmpzXCI6IDg0LFxuXHRcIi4vbGVhZGVyYm9hcmQuanNcIjogODUsXG5cdFwiLi9sb2dvLWxpZ2h0LmpzXCI6IDg2LFxuXHRcIi4vbG9nb2ZsaWNrZXIuanNcIjogODcsXG5cdFwiLi9tYXRlcmlhbHMuanNcIjogODgsXG5cdFwiLi9tZW51LWNvbnRyb2xzLmpzXCI6IDg5LFxuXHRcIi4vbWVudS1kaWZmaWN1bHR5LXNlbGVjdC5qc1wiOiA5MCxcblx0XCIuL21lbnUtc2VsZWN0ZWQtY2hhbGxlbmdlLWltYWdlLmpzXCI6IDkxLFxuXHRcIi4vbWVudS1zbGlkZS1hbmltYXRpb24uanNcIjogOTIsXG5cdFwiLi9taW5lLWZyYWdtZW50cy1sb2FkZXIuanNcIjogOTMsXG5cdFwiLi9tdWx0aXBsaWVyLXJpbmcuanNcIjogOTQsXG5cdFwiLi9wYXJ0aWNsZXBsYXllci5qc1wiOiA5NSxcblx0XCIuL3BhdXNlLmpzXCI6IDk2LFxuXHRcIi4vcGF1c2VyLmpzXCI6IDk3LFxuXHRcIi4vcGxheS1zb3VuZC5qc1wiOiA5OCxcblx0XCIuL3JheWNhc3Rlci10YXJnZXQuanNcIjogOTksXG5cdFwiLi9yZWNlbnRlci5qc1wiOiAxMDAsXG5cdFwiLi9zYWJlci1jb250cm9scy5qc1wiOiAxMDEsXG5cdFwiLi9zYWJlci1wYXJ0aWNsZXMuanNcIjogMTAyLFxuXHRcIi4vc2NvcmUtYmVhdC5qc1wiOiAxMDMsXG5cdFwiLi9zY29yZS10ZXh0cy5qc1wiOiAxMDQsXG5cdFwiLi9zZWFyY2gtdGh1bWJuYWlsLWF0bGFzLmpzXCI6IDEwNSxcblx0XCIuL3NlYXJjaC5qc1wiOiAxMDYsXG5cdFwiLi9zb25nLXByZXZpZXcuanNcIjogMTA3LFxuXHRcIi4vc29uZy1wcm9ncmVzcy1yaW5nLmpzXCI6IDEwOCxcblx0XCIuL3NvbmcuanNcIjogMTA5LFxuXHRcIi4vc3RhZ2UtY29sb3JzLmpzXCI6IDExMCxcblx0XCIuL3N0YWdlLWxhc2Vycy5qc1wiOiAxMTEsXG5cdFwiLi9zdGFnZS1zaGFkZXIuanNcIjogMTEyLFxuXHRcIi4vc3RhdHMtcGFyYW0uanNcIjogMTEzLFxuXHRcIi4vc3RlcGJhY2suanNcIjogMTE0LFxuXHRcIi4vc3ViLW9iamVjdC5qc1wiOiAxMTUsXG5cdFwiLi9zdXBlci1rZXlib2FyZC5qc1wiOiAxMTYsXG5cdFwiLi9zdXBlcmN1dGZ4LXNoYWRlci5qc1wiOiAxMTcsXG5cdFwiLi9zdXBlcmN1dGZ4LmpzXCI6IDExOCxcblx0XCIuL3RleHQtY291bnRlci5qc1wiOiAxMTksXG5cdFwiLi90ZXh0LXVwcGVyY2FzZS5qc1wiOiAxMjAsXG5cdFwiLi90b2dnbGUtcGF1c2UtcGxheS5qc1wiOiAxMjEsXG5cdFwiLi90cmFpbC5qc1wiOiAxMjIsXG5cdFwiLi90dXRvcmlhbC0yZC5qc1wiOiAxMjMsXG5cdFwiLi90d2lzdGVyLmpzXCI6IDEyNCxcblx0XCIuL3ZlcnRleC1jb2xvcnMtYnVmZmVyLmpzXCI6IDEyNSxcblx0XCIuL3ZpY3RvcnktYWNjdXJhY3ktcmluZy5qc1wiOiAxMjYsXG5cdFwiLi92aWN0b3J5LXJhbmsuanNcIjogMTI3LFxuXHRcIi4vdmlzaWJsZS1yYXljYXN0YWJsZS5qc1wiOiAxMjgsXG5cdFwiLi93YWxsLXNoYWRlci5qc1wiOiAxMjksXG5cdFwiLi93YWxsLmpzXCI6IDEzMFxufTtcbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyh3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSk7XG59O1xuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHR2YXIgaWQgPSBtYXBbcmVxXTtcblx0aWYoIShpZCArIDEpKSAvLyBjaGVjayBmb3IgbnVtYmVyIG9yIHN0cmluZ1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIgKyByZXEgKyBcIicuXCIpO1xuXHRyZXR1cm4gaWQ7XG59O1xud2VicGFja0NvbnRleHQua2V5cyA9IGZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0S2V5cygpIHtcblx0cmV0dXJuIE9iamVjdC5rZXlzKG1hcCk7XG59O1xud2VicGFja0NvbnRleHQucmVzb2x2ZSA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZTtcbm1vZHVsZS5leHBvcnRzID0gd2VicGFja0NvbnRleHQ7XG53ZWJwYWNrQ29udGV4dC5pZCA9IDMzO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2NvbXBvbmVudHMgXFwuanMkXG4vLyBtb2R1bGUgaWQgPSAzM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgbWFwID0ge1xuXHRcIi4vaW5kZXguanNcIjogMTM0XG59O1xuZnVuY3Rpb24gd2VicGFja0NvbnRleHQocmVxKSB7XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpKTtcbn07XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSB7XG5cdHZhciBpZCA9IG1hcFtyZXFdO1xuXHRpZighKGlkICsgMSkpIC8vIGNoZWNrIGZvciBudW1iZXIgb3Igc3RyaW5nXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIHJlcSArIFwiJy5cIik7XG5cdHJldHVybiBpZDtcbn07XG53ZWJwYWNrQ29udGV4dC5rZXlzID0gZnVuY3Rpb24gd2VicGFja0NvbnRleHRLZXlzKCkge1xuXHRyZXR1cm4gT2JqZWN0LmtleXMobWFwKTtcbn07XG53ZWJwYWNrQ29udGV4dC5yZXNvbHZlID0gd2VicGFja0NvbnRleHRSZXNvbHZlO1xubW9kdWxlLmV4cG9ydHMgPSB3ZWJwYWNrQ29udGV4dDtcbndlYnBhY2tDb250ZXh0LmlkID0gMzQ7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvc3RhdGUgXFwuanMkXG4vLyBtb2R1bGUgaWQgPSAzNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wRGVmYXVsdCAoZXgpIHsgcmV0dXJuIChleCAmJiAodHlwZW9mIGV4ID09PSAnb2JqZWN0JykgJiYgJ2RlZmF1bHQnIGluIGV4KSA/IGV4WydkZWZhdWx0J10gOiBleDsgfVxuXG52YXIgZmlyZWJhc2UgPSBfaW50ZXJvcERlZmF1bHQocmVxdWlyZSgnQGZpcmViYXNlL2FwcCcpKTtcbnZhciBsb2dnZXIgPSByZXF1aXJlKCdAZmlyZWJhc2UvbG9nZ2VyJyk7XG52YXIgdHNsaWJfMSA9IHJlcXVpcmUoJ3RzbGliJyk7XG52YXIgd2ViY2hhbm5lbFdyYXBwZXIgPSByZXF1aXJlKCdAZmlyZWJhc2Uvd2ViY2hhbm5lbC13cmFwcGVyJyk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKiogVGhlIHNlbXZlciAod3d3LnNlbXZlci5vcmcpIHZlcnNpb24gb2YgdGhlIFNESy4gKi9cclxudmFyIFNES19WRVJTSU9OID0gZmlyZWJhc2UuU0RLX1ZFUlNJT047XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgbG9nQ2xpZW50ID0gbmV3IGxvZ2dlci5Mb2dnZXIoJ0BmaXJlYmFzZS9maXJlc3RvcmUnKTtcclxudmFyIExvZ0xldmVsO1xyXG4oZnVuY3Rpb24gKExvZ0xldmVsKSB7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIkRFQlVHXCJdID0gMF0gPSBcIkRFQlVHXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIkVSUk9SXCJdID0gMV0gPSBcIkVSUk9SXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIlNJTEVOVFwiXSA9IDJdID0gXCJTSUxFTlRcIjtcclxufSkoTG9nTGV2ZWwgfHwgKExvZ0xldmVsID0ge30pKTtcclxuLy8gSGVscGVyIG1ldGhvZHMgYXJlIG5lZWRlZCBiZWNhdXNlIHZhcmlhYmxlcyBjYW4ndCBiZSBleHBvcnRlZCBhcyByZWFkL3dyaXRlXHJcbmZ1bmN0aW9uIGdldExvZ0xldmVsKCkge1xyXG4gICAgaWYgKGxvZ0NsaWVudC5sb2dMZXZlbCA9PT0gbG9nZ2VyLkxvZ0xldmVsLkRFQlVHKSB7XHJcbiAgICAgICAgcmV0dXJuIExvZ0xldmVsLkRFQlVHO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobG9nQ2xpZW50LmxvZ0xldmVsID09PSBsb2dnZXIuTG9nTGV2ZWwuU0lMRU5UKSB7XHJcbiAgICAgICAgcmV0dXJuIExvZ0xldmVsLlNJTEVOVDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBMb2dMZXZlbC5FUlJPUjtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBzZXRMb2dMZXZlbChuZXdMZXZlbCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBNYXAgdGhlIG5ldyBsb2cgbGV2ZWwgdG8gdGhlIGFzc29jaWF0ZWQgRmlyZWJhc2UgTG9nIExldmVsXHJcbiAgICAgKi9cclxuICAgIHN3aXRjaCAobmV3TGV2ZWwpIHtcclxuICAgICAgICBjYXNlIExvZ0xldmVsLkRFQlVHOlxyXG4gICAgICAgICAgICBsb2dDbGllbnQubG9nTGV2ZWwgPSBsb2dnZXIuTG9nTGV2ZWwuREVCVUc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgTG9nTGV2ZWwuRVJST1I6XHJcbiAgICAgICAgICAgIGxvZ0NsaWVudC5sb2dMZXZlbCA9IGxvZ2dlci5Mb2dMZXZlbC5FUlJPUjtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5TSUxFTlQ6XHJcbiAgICAgICAgICAgIGxvZ0NsaWVudC5sb2dMZXZlbCA9IGxvZ2dlci5Mb2dMZXZlbC5TSUxFTlQ7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGxvZ0NsaWVudC5lcnJvcihcIkZpcmVzdG9yZSAoXCIgKyBTREtfVkVSU0lPTiArIFwiKTogSW52YWxpZCB2YWx1ZSBwYXNzZWQgdG8gYHNldExvZ0xldmVsYFwiKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBkZWJ1Zyh0YWcsIG1zZykge1xyXG4gICAgdmFyIG9iaiA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBvYmpbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICBpZiAobG9nQ2xpZW50LmxvZ0xldmVsIDw9IGxvZ2dlci5Mb2dMZXZlbC5ERUJVRykge1xyXG4gICAgICAgIHZhciBhcmdzID0gb2JqLm1hcChhcmdUb1N0cmluZyk7XHJcbiAgICAgICAgbG9nQ2xpZW50LmRlYnVnLmFwcGx5KGxvZ0NsaWVudCwgW1wiRmlyZXN0b3JlIChcIiArIFNES19WRVJTSU9OICsgXCIpIFtcIiArIHRhZyArIFwiXTogXCIgKyBtc2ddLmNvbmNhdChhcmdzKSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZXJyb3IobXNnKSB7XHJcbiAgICB2YXIgb2JqID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIG9ialtfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPD0gbG9nZ2VyLkxvZ0xldmVsLkVSUk9SKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBvYmoubWFwKGFyZ1RvU3RyaW5nKTtcclxuICAgICAgICBsb2dDbGllbnQuZXJyb3IuYXBwbHkobG9nQ2xpZW50LCBbXCJGaXJlc3RvcmUgKFwiICsgU0RLX1ZFUlNJT04gKyBcIik6IFwiICsgbXNnXS5jb25jYXQoYXJncykpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBDb252ZXJ0cyBhbiBhZGRpdGlvbmFsIGxvZyBwYXJhbWV0ZXIgdG8gYSBzdHJpbmcgcmVwcmVzZW50YXRpb24uXHJcbiAqL1xyXG5mdW5jdGlvbiBhcmdUb1N0cmluZyhvYmopIHtcclxuICAgIGlmICh0eXBlb2Ygb2JqID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBvYmo7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YXIgcGxhdGZvcm0gPSBQbGF0Zm9ybVN1cHBvcnQuZ2V0UGxhdGZvcm0oKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGxhdGZvcm0uZm9ybWF0SlNPTihvYmopO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvLyBDb252ZXJ0aW5nIHRvIEpTT04gZmFpbGVkLCBqdXN0IGxvZyB0aGUgb2JqZWN0IGRpcmVjdGx5XHJcbiAgICAgICAgICAgIHJldHVybiBvYmo7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVW5jb25kaXRpb25hbGx5IGZhaWxzLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZSBnaXZlbiBtZXNzYWdlLlxyXG4gKlxyXG4gKiBSZXR1cm5zIGFueSBzbyBpdCBjYW4gYmUgdXNlZCBpbiBleHByZXNzaW9uczpcclxuICogQGV4YW1wbGVcclxuICogbGV0IGZ1dHVyZVZhciA9IGZhaWwoJ25vdCBpbXBsZW1lbnRlZCB5ZXQnKTtcclxuICovXHJcbmZ1bmN0aW9uIGZhaWwoZmFpbHVyZSkge1xyXG4gICAgLy8gTG9nIHRoZSBmYWlsdXJlIGluIGFkZGl0aW9uIHRvIHRocm93IGFuIGV4Y2VwdGlvbiwganVzdCBpbiBjYXNlIHRoZVxyXG4gICAgLy8gZXhjZXB0aW9uIGlzIHN3YWxsb3dlZC5cclxuICAgIHZhciBtZXNzYWdlID0gXCJGSVJFU1RPUkUgKFwiICsgU0RLX1ZFUlNJT04gKyBcIikgSU5URVJOQUwgQVNTRVJUSU9OIEZBSUxFRDogXCIgKyBmYWlsdXJlO1xyXG4gICAgZXJyb3IobWVzc2FnZSk7XHJcbiAgICAvLyBOT1RFOiBXZSBkb24ndCB1c2UgRmlyZXN0b3JlRXJyb3IgaGVyZSBiZWNhdXNlIHRoZXNlIGFyZSBpbnRlcm5hbCBmYWlsdXJlc1xyXG4gICAgLy8gdGhhdCBjYW5ub3QgYmUgaGFuZGxlZCBieSB0aGUgdXNlci4gKEFsc28gaXQgd291bGQgY3JlYXRlIGEgY2lyY3VsYXJcclxuICAgIC8vIGRlcGVuZGVuY3kgYmV0d2VlbiB0aGUgZXJyb3IgYW5kIGFzc2VydCBtb2R1bGVzIHdoaWNoIGRvZXNuJ3Qgd29yay4pXHJcbiAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSk7XHJcbn1cclxuLyoqXHJcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxyXG4gKiBnaXZlbiBtZXNzYWdlIGlmIGl0IGRpZC5cclxuICovXHJcbmZ1bmN0aW9uIGFzc2VydChhc3NlcnRpb24sIG1lc3NhZ2UpIHtcclxuICAgIGlmICghYXNzZXJ0aW9uKSB7XHJcbiAgICAgICAgZmFpbChtZXNzYWdlKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVzIHNpbmdsZXRvbiBoZWxwZXJzIHdoZXJlIHNldHVwIGNvZGUgY2FuIGluamVjdCBhIHBsYXRmb3JtIGF0IHJ1bnRpbWUuXHJcbiAqIHNldFBsYXRmb3JtIG5lZWRzIHRvIGJlIHNldCBiZWZvcmUgRmlyZXN0b3JlIGlzIHVzZWQgYW5kIG11c3QgYmUgc2V0IGV4YWN0bHlcclxuICogb25jZS5cclxuICovXHJcbnZhciBQbGF0Zm9ybVN1cHBvcnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQbGF0Zm9ybVN1cHBvcnQoKSB7XHJcbiAgICB9XHJcbiAgICBQbGF0Zm9ybVN1cHBvcnQuc2V0UGxhdGZvcm0gPSBmdW5jdGlvbiAocGxhdGZvcm0pIHtcclxuICAgICAgICBpZiAoUGxhdGZvcm1TdXBwb3J0LnBsYXRmb3JtKSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ1BsYXRmb3JtIGFscmVhZHkgZGVmaW5lZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQbGF0Zm9ybVN1cHBvcnQucGxhdGZvcm0gPSBwbGF0Zm9ybTtcclxuICAgIH07XHJcbiAgICBQbGF0Zm9ybVN1cHBvcnQuZ2V0UGxhdGZvcm0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCFQbGF0Zm9ybVN1cHBvcnQucGxhdGZvcm0pIHtcclxuICAgICAgICAgICAgZmFpbCgnUGxhdGZvcm0gbm90IHNldCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGxhdGZvcm1TdXBwb3J0LnBsYXRmb3JtO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQbGF0Zm9ybVN1cHBvcnQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSByZXByZXNlbnRhdGlvbiBvZiBhbiBlbXB0eSBcInByb3RvXCIgYnl0ZSBzdHJpbmcgZm9yIHRoZVxyXG4gKiBwbGF0Zm9ybS5cclxuICovXHJcbmZ1bmN0aW9uIGVtcHR5Qnl0ZVN0cmluZygpIHtcclxuICAgIHJldHVybiBQbGF0Zm9ybVN1cHBvcnQuZ2V0UGxhdGZvcm0oKS5lbXB0eUJ5dGVTdHJpbmc7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIFRPRE8obWNnKTogQ2hhbmdlIHRvIGEgc3RyaW5nIGVudW0gb25jZSB3ZSd2ZSB1cGdyYWRlZCB0byB0eXBlc2NyaXB0IDIuNC5cclxuLy8gIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTp2YXJpYWJsZS1uYW1lIEludGVuZGVkIHRvIGxvb2sgbGlrZSBhIFRTIDIuNCBlbnVtXHJcbnZhciBDb2RlID0ge1xyXG4gICAgLy8gQ2F1c2VzIGFyZSBjb3BpZWQgZnJvbTpcclxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ncnBjL2dycGMvYmxvYi9iY2VlYzk0ZWE0ZmM1ZjAwODVkODEyMzVkOGUxYzA2Nzk4ZGMzNDFhL2luY2x1ZGUvZ3JwYyUyQiUyQi9pbXBsL2NvZGVnZW4vc3RhdHVzX2NvZGVfZW51bS5oXHJcbiAgICAvKiogTm90IGFuIGVycm9yOyByZXR1cm5lZCBvbiBzdWNjZXNzLiAqL1xyXG4gICAgT0s6ICdvaycsXHJcbiAgICAvKiogVGhlIG9wZXJhdGlvbiB3YXMgY2FuY2VsbGVkICh0eXBpY2FsbHkgYnkgdGhlIGNhbGxlcikuICovXHJcbiAgICBDQU5DRUxMRUQ6ICdjYW5jZWxsZWQnLFxyXG4gICAgLyoqIFVua25vd24gZXJyb3Igb3IgYW4gZXJyb3IgZnJvbSBhIGRpZmZlcmVudCBlcnJvciBkb21haW4uICovXHJcbiAgICBVTktOT1dOOiAndW5rbm93bicsXHJcbiAgICAvKipcclxuICAgICAqIENsaWVudCBzcGVjaWZpZWQgYW4gaW52YWxpZCBhcmd1bWVudC4gTm90ZSB0aGF0IHRoaXMgZGlmZmVycyBmcm9tXHJcbiAgICAgKiBGQUlMRURfUFJFQ09ORElUSU9OLiBJTlZBTElEX0FSR1VNRU5UIGluZGljYXRlcyBhcmd1bWVudHMgdGhhdCBhcmVcclxuICAgICAqIHByb2JsZW1hdGljIHJlZ2FyZGxlc3Mgb2YgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0gKGUuZy4sIGEgbWFsZm9ybWVkIGZpbGVcclxuICAgICAqIG5hbWUpLlxyXG4gICAgICovXHJcbiAgICBJTlZBTElEX0FSR1VNRU5UOiAnaW52YWxpZC1hcmd1bWVudCcsXHJcbiAgICAvKipcclxuICAgICAqIERlYWRsaW5lIGV4cGlyZWQgYmVmb3JlIG9wZXJhdGlvbiBjb3VsZCBjb21wbGV0ZS4gRm9yIG9wZXJhdGlvbnMgdGhhdFxyXG4gICAgICogY2hhbmdlIHRoZSBzdGF0ZSBvZiB0aGUgc3lzdGVtLCB0aGlzIGVycm9yIG1heSBiZSByZXR1cm5lZCBldmVuIGlmIHRoZVxyXG4gICAgICogb3BlcmF0aW9uIGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiBGb3IgZXhhbXBsZSwgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXHJcbiAgICAgKiBmcm9tIGEgc2VydmVyIGNvdWxkIGhhdmUgYmVlbiBkZWxheWVkIGxvbmcgZW5vdWdoIGZvciB0aGUgZGVhZGxpbmUgdG9cclxuICAgICAqIGV4cGlyZS5cclxuICAgICAqL1xyXG4gICAgREVBRExJTkVfRVhDRUVERUQ6ICdkZWFkbGluZS1leGNlZWRlZCcsXHJcbiAgICAvKiogU29tZSByZXF1ZXN0ZWQgZW50aXR5IChlLmcuLCBmaWxlIG9yIGRpcmVjdG9yeSkgd2FzIG5vdCBmb3VuZC4gKi9cclxuICAgIE5PVF9GT1VORDogJ25vdC1mb3VuZCcsXHJcbiAgICAvKipcclxuICAgICAqIFNvbWUgZW50aXR5IHRoYXQgd2UgYXR0ZW1wdGVkIHRvIGNyZWF0ZSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIGFscmVhZHlcclxuICAgICAqIGV4aXN0cy5cclxuICAgICAqL1xyXG4gICAgQUxSRUFEWV9FWElTVFM6ICdhbHJlYWR5LWV4aXN0cycsXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBjYWxsZXIgZG9lcyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGV4ZWN1dGUgdGhlIHNwZWNpZmllZCBvcGVyYXRpb24uXHJcbiAgICAgKiBQRVJNSVNTSU9OX0RFTklFRCBtdXN0IG5vdCBiZSB1c2VkIGZvciByZWplY3Rpb25zIGNhdXNlZCBieSBleGhhdXN0aW5nXHJcbiAgICAgKiBzb21lIHJlc291cmNlICh1c2UgUkVTT1VSQ0VfRVhIQVVTVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXHJcbiAgICAgKiBQRVJNSVNTSU9OX0RFTklFRCBtdXN0IG5vdCBiZSB1c2VkIGlmIHRoZSBjYWxsZXIgY2FuIG5vdCBiZSBpZGVudGlmaWVkXHJcbiAgICAgKiAodXNlIFVOQVVUSEVOVElDQVRFRCBpbnN0ZWFkIGZvciB0aG9zZSBlcnJvcnMpLlxyXG4gICAgICovXHJcbiAgICBQRVJNSVNTSU9OX0RFTklFRDogJ3Blcm1pc3Npb24tZGVuaWVkJyxcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHJlcXVlc3QgZG9lcyBub3QgaGF2ZSB2YWxpZCBhdXRoZW50aWNhdGlvbiBjcmVkZW50aWFscyBmb3IgdGhlXHJcbiAgICAgKiBvcGVyYXRpb24uXHJcbiAgICAgKi9cclxuICAgIFVOQVVUSEVOVElDQVRFRDogJ3VuYXV0aGVudGljYXRlZCcsXHJcbiAgICAvKipcclxuICAgICAqIFNvbWUgcmVzb3VyY2UgaGFzIGJlZW4gZXhoYXVzdGVkLCBwZXJoYXBzIGEgcGVyLXVzZXIgcXVvdGEsIG9yIHBlcmhhcHMgdGhlXHJcbiAgICAgKiBlbnRpcmUgZmlsZSBzeXN0ZW0gaXMgb3V0IG9mIHNwYWNlLlxyXG4gICAgICovXHJcbiAgICBSRVNPVVJDRV9FWEhBVVNURUQ6ICdyZXNvdXJjZS1leGhhdXN0ZWQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPcGVyYXRpb24gd2FzIHJlamVjdGVkIGJlY2F1c2UgdGhlIHN5c3RlbSBpcyBub3QgaW4gYSBzdGF0ZSByZXF1aXJlZCBmb3JcclxuICAgICAqIHRoZSBvcGVyYXRpb24ncyBleGVjdXRpb24uIEZvciBleGFtcGxlLCBkaXJlY3RvcnkgdG8gYmUgZGVsZXRlZCBtYXkgYmVcclxuICAgICAqIG5vbi1lbXB0eSwgYW4gcm1kaXIgb3BlcmF0aW9uIGlzIGFwcGxpZWQgdG8gYSBub24tZGlyZWN0b3J5LCBldGMuXHJcbiAgICAgKlxyXG4gICAgICogQSBsaXRtdXMgdGVzdCB0aGF0IG1heSBoZWxwIGEgc2VydmljZSBpbXBsZW1lbnRvciBpbiBkZWNpZGluZ1xyXG4gICAgICogYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OLCBBQk9SVEVELCBhbmQgVU5BVkFJTEFCTEU6XHJcbiAgICAgKiAgKGEpIFVzZSBVTkFWQUlMQUJMRSBpZiB0aGUgY2xpZW50IGNhbiByZXRyeSBqdXN0IHRoZSBmYWlsaW5nIGNhbGwuXHJcbiAgICAgKiAgKGIpIFVzZSBBQk9SVEVEIGlmIHRoZSBjbGllbnQgc2hvdWxkIHJldHJ5IGF0IGEgaGlnaGVyLWxldmVsXHJcbiAgICAgKiAgICAgIChlLmcuLCByZXN0YXJ0aW5nIGEgcmVhZC1tb2RpZnktd3JpdGUgc2VxdWVuY2UpLlxyXG4gICAgICogIChjKSBVc2UgRkFJTEVEX1BSRUNPTkRJVElPTiBpZiB0aGUgY2xpZW50IHNob3VsZCBub3QgcmV0cnkgdW50aWxcclxuICAgICAqICAgICAgdGhlIHN5c3RlbSBzdGF0ZSBoYXMgYmVlbiBleHBsaWNpdGx5IGZpeGVkLiBFLmcuLCBpZiBhbiBcInJtZGlyXCJcclxuICAgICAqICAgICAgZmFpbHMgYmVjYXVzZSB0aGUgZGlyZWN0b3J5IGlzIG5vbi1lbXB0eSwgRkFJTEVEX1BSRUNPTkRJVElPTlxyXG4gICAgICogICAgICBzaG91bGQgYmUgcmV0dXJuZWQgc2luY2UgdGhlIGNsaWVudCBzaG91bGQgbm90IHJldHJ5IHVubGVzc1xyXG4gICAgICogICAgICB0aGV5IGhhdmUgZmlyc3QgZml4ZWQgdXAgdGhlIGRpcmVjdG9yeSBieSBkZWxldGluZyBmaWxlcyBmcm9tIGl0LlxyXG4gICAgICogIChkKSBVc2UgRkFJTEVEX1BSRUNPTkRJVElPTiBpZiB0aGUgY2xpZW50IHBlcmZvcm1zIGNvbmRpdGlvbmFsXHJcbiAgICAgKiAgICAgIFJFU1QgR2V0L1VwZGF0ZS9EZWxldGUgb24gYSByZXNvdXJjZSBhbmQgdGhlIHJlc291cmNlIG9uIHRoZVxyXG4gICAgICogICAgICBzZXJ2ZXIgZG9lcyBub3QgbWF0Y2ggdGhlIGNvbmRpdGlvbi4gRS5nLiwgY29uZmxpY3RpbmdcclxuICAgICAqICAgICAgcmVhZC1tb2RpZnktd3JpdGUgb24gdGhlIHNhbWUgcmVzb3VyY2UuXHJcbiAgICAgKi9cclxuICAgIEZBSUxFRF9QUkVDT05ESVRJT046ICdmYWlsZWQtcHJlY29uZGl0aW9uJyxcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG9wZXJhdGlvbiB3YXMgYWJvcnRlZCwgdHlwaWNhbGx5IGR1ZSB0byBhIGNvbmN1cnJlbmN5IGlzc3VlIGxpa2VcclxuICAgICAqIHNlcXVlbmNlciBjaGVjayBmYWlsdXJlcywgdHJhbnNhY3Rpb24gYWJvcnRzLCBldGMuXHJcbiAgICAgKlxyXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXHJcbiAgICAgKiBhbmQgVU5BVkFJTEFCTEUuXHJcbiAgICAgKi9cclxuICAgIEFCT1JURUQ6ICdhYm9ydGVkJyxcclxuICAgIC8qKlxyXG4gICAgICogT3BlcmF0aW9uIHdhcyBhdHRlbXB0ZWQgcGFzdCB0aGUgdmFsaWQgcmFuZ2UuIEUuZy4sIHNlZWtpbmcgb3IgcmVhZGluZ1xyXG4gICAgICogcGFzdCBlbmQgb2YgZmlsZS5cclxuICAgICAqXHJcbiAgICAgKiBVbmxpa2UgSU5WQUxJRF9BUkdVTUVOVCwgdGhpcyBlcnJvciBpbmRpY2F0ZXMgYSBwcm9ibGVtIHRoYXQgbWF5IGJlIGZpeGVkXHJcbiAgICAgKiBpZiB0aGUgc3lzdGVtIHN0YXRlIGNoYW5nZXMuIEZvciBleGFtcGxlLCBhIDMyLWJpdCBmaWxlIHN5c3RlbSB3aWxsXHJcbiAgICAgKiBnZW5lcmF0ZSBJTlZBTElEX0FSR1VNRU5UIGlmIGFza2VkIHRvIHJlYWQgYXQgYW4gb2Zmc2V0IHRoYXQgaXMgbm90IGluIHRoZVxyXG4gICAgICogcmFuZ2UgWzAsMl4zMi0xXSwgYnV0IGl0IHdpbGwgZ2VuZXJhdGUgT1VUX09GX1JBTkdFIGlmIGFza2VkIHRvIHJlYWQgZnJvbVxyXG4gICAgICogYW4gb2Zmc2V0IHBhc3QgdGhlIGN1cnJlbnQgZmlsZSBzaXplLlxyXG4gICAgICpcclxuICAgICAqIFRoZXJlIGlzIGEgZmFpciBiaXQgb2Ygb3ZlcmxhcCBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04gYW5kXHJcbiAgICAgKiBPVVRfT0ZfUkFOR0UuIFdlIHJlY29tbWVuZCB1c2luZyBPVVRfT0ZfUkFOR0UgKHRoZSBtb3JlIHNwZWNpZmljIGVycm9yKVxyXG4gICAgICogd2hlbiBpdCBhcHBsaWVzIHNvIHRoYXQgY2FsbGVycyB3aG8gYXJlIGl0ZXJhdGluZyB0aHJvdWdoIGEgc3BhY2UgY2FuXHJcbiAgICAgKiBlYXNpbHkgbG9vayBmb3IgYW4gT1VUX09GX1JBTkdFIGVycm9yIHRvIGRldGVjdCB3aGVuIHRoZXkgYXJlIGRvbmUuXHJcbiAgICAgKi9cclxuICAgIE9VVF9PRl9SQU5HRTogJ291dC1vZi1yYW5nZScsXHJcbiAgICAvKiogT3BlcmF0aW9uIGlzIG5vdCBpbXBsZW1lbnRlZCBvciBub3Qgc3VwcG9ydGVkL2VuYWJsZWQgaW4gdGhpcyBzZXJ2aWNlLiAqL1xyXG4gICAgVU5JTVBMRU1FTlRFRDogJ3VuaW1wbGVtZW50ZWQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBJbnRlcm5hbCBlcnJvcnMuIE1lYW5zIHNvbWUgaW52YXJpYW50cyBleHBlY3RlZCBieSB1bmRlcmx5aW5nIFN5c3RlbSBoYXNcclxuICAgICAqIGJlZW4gYnJva2VuLiBJZiB5b3Ugc2VlIG9uZSBvZiB0aGVzZSBlcnJvcnMsIFNvbWV0aGluZyBpcyB2ZXJ5IGJyb2tlbi5cclxuICAgICAqL1xyXG4gICAgSU5URVJOQUw6ICdpbnRlcm5hbCcsXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzZXJ2aWNlIGlzIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gVGhpcyBpcyBhIG1vc3QgbGlrZWx5IGEgdHJhbnNpZW50XHJcbiAgICAgKiBjb25kaXRpb24gYW5kIG1heSBiZSBjb3JyZWN0ZWQgYnkgcmV0cnlpbmcgd2l0aCBhIGJhY2tvZmYuXHJcbiAgICAgKlxyXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXHJcbiAgICAgKiBhbmQgVU5BVkFJTEFCTEUuXHJcbiAgICAgKi9cclxuICAgIFVOQVZBSUxBQkxFOiAndW5hdmFpbGFibGUnLFxyXG4gICAgLyoqIFVucmVjb3ZlcmFibGUgZGF0YSBsb3NzIG9yIGNvcnJ1cHRpb24uICovXHJcbiAgICBEQVRBX0xPU1M6ICdkYXRhLWxvc3MnXHJcbn07XHJcbi8qKlxyXG4gKiBBbiBlcnJvciBjbGFzcyB1c2VkIGZvciBGaXJlc3RvcmUtZ2VuZXJhdGVkIGVycm9ycy4gSWRlYWxseSB3ZSBzaG91bGQgYmVcclxuICogdXNpbmcgRmlyZWJhc2VFcnJvciwgYnV0IGludGVncmF0aW5nIHdpdGggaXQgaXMgb3Zlcmx5IGFyZHVvdXMgYXQgdGhlIG1vbWVudCxcclxuICogc28gd2UgZGVmaW5lIG91ciBvd24gY29tcGF0aWJsZSBlcnJvciBjbGFzcyAod2l0aCBhIGBuYW1lYCBvZiAnRmlyZWJhc2VFcnJvcidcclxuICogYW5kIGNvbXBhdGlibGUgYGNvZGVgIGFuZCBgbWVzc2FnZWAgZmllbGRzLilcclxuICovXHJcbnZhciBGaXJlc3RvcmVFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEZpcmVzdG9yZUVycm9yLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gRmlyZXN0b3JlRXJyb3IoY29kZSwgbWVzc2FnZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuY29kZSA9IGNvZGU7XHJcbiAgICAgICAgX3RoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XHJcbiAgICAgICAgX3RoaXMubmFtZSA9ICdGaXJlYmFzZUVycm9yJztcclxuICAgICAgICAvLyBIQUNLOiBXZSB3cml0ZSBhIHRvU3RyaW5nIHByb3BlcnR5IGRpcmVjdGx5IGJlY2F1c2UgRXJyb3IgaXMgbm90IGEgcmVhbFxyXG4gICAgICAgIC8vIGNsYXNzIGFuZCBzbyBpbmhlcml0YW5jZSBkb2VzIG5vdCB3b3JrIGNvcnJlY3RseS4gV2UgY291bGQgYWx0ZXJuYXRpdmVseVxyXG4gICAgICAgIC8vIGRvIHRoZSBzYW1lIFwiYmFjay1kb29yIGluaGVyaXRhbmNlXCIgdHJpY2sgdGhhdCBGaXJlYmFzZUVycm9yIGRvZXMuXHJcbiAgICAgICAgX3RoaXMudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5uYW1lICsgXCI6IFtjb2RlPVwiICsgX3RoaXMuY29kZSArIFwiXTogXCIgKyBfdGhpcy5tZXNzYWdlOyB9O1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIHJldHVybiBGaXJlc3RvcmVFcnJvcjtcclxufShFcnJvcikpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBwcmV2ZW50IGluc3RhbnRpYXRpb24gdGhyb3VnaCB0aGUgY29uc3RydWN0b3IuXHJcbiAqXHJcbiAqIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgY29uc3RydWN0b3IgdGhhdCB0aHJvd3Mgd2hlbiBpdCdzIGludm9rZWQuXHJcbiAqIFRoZSBwcm90b3R5cGUgb2YgdGhhdCBjb25zdHJ1Y3RvciBpcyB0aGVuIHNldCB0byB0aGUgcHJvdG90eXBlIG9mIHRoZSBoaWRkZW5cclxuICogXCJjbGFzc1wiIHRvIGV4cG9zZSBhbGwgdGhlIHByb3RvdHlwZSBtZXRob2RzIGFuZCBhbGxvdyBmb3IgaW5zdGFuY2VvZlxyXG4gKiBjaGVja3MuXHJcbiAqXHJcbiAqIFRvIGFsc28gbWFrZSBhbGwgdGhlIHN0YXRpYyBtZXRob2RzIGF2YWlsYWJsZSwgYWxsIHByb3BlcnRpZXMgb2YgdGhlXHJcbiAqIG9yaWdpbmFsIGNvbnN0cnVjdG9yIGFyZSBjb3BpZWQgdG8gdGhlIG5ldyBjb25zdHJ1Y3Rvci5cclxuICovXHJcbmZ1bmN0aW9uIG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoY2xzLCBvcHRpb25hbE1lc3NhZ2UpIHtcclxuICAgIGZ1bmN0aW9uIFB1YmxpY0NvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHZhciBlcnJvciA9ICdUaGlzIGNvbnN0cnVjdG9yIGlzIHByaXZhdGUuJztcclxuICAgICAgICBpZiAob3B0aW9uYWxNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgIGVycm9yICs9ICcgJztcclxuICAgICAgICAgICAgZXJyb3IgKz0gb3B0aW9uYWxNZXNzYWdlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBlcnJvcik7XHJcbiAgICB9XHJcbiAgICAvLyBNYWtlIHN1cmUgaW5zdGFuY2VvZiBjaGVja3Mgd29yayBhbmQgYWxsIG1ldGhvZHMgYXJlIGV4cG9zZWQgb24gdGhlIHB1YmxpY1xyXG4gICAgLy8gY29uc3RydWN0b3JcclxuICAgIFB1YmxpY0NvbnN0cnVjdG9yLnByb3RvdHlwZSA9IGNscy5wcm90b3R5cGU7XHJcbiAgICAvLyBDb3B5IGFueSBzdGF0aWMgbWV0aG9kcy9tZW1iZXJzXHJcbiAgICBmb3IgKHZhciBzdGF0aWNQcm9wZXJ0eSBpbiBjbHMpIHtcclxuICAgICAgICBpZiAoY2xzLmhhc093blByb3BlcnR5KHN0YXRpY1Byb3BlcnR5KSkge1xyXG4gICAgICAgICAgICBQdWJsaWNDb25zdHJ1Y3RvcltzdGF0aWNQcm9wZXJ0eV0gPSBjbHNbc3RhdGljUHJvcGVydHldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBQdWJsaWNDb25zdHJ1Y3RvcjtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gY29udGFpbnMob2JqLCBrZXkpIHtcclxuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpO1xyXG59XHJcbi8qKiBSZXR1cm5zIHRoZSBnaXZlbiB2YWx1ZSBpZiBpdCdzIGRlZmluZWQgb3IgdGhlIGRlZmF1bHRWYWx1ZSBvdGhlcndpc2UuICovXHJcbmZ1bmN0aW9uIGRlZmF1bHRlZCh2YWx1ZSwgZGVmYXVsdFZhbHVlKSB7XHJcbiAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDogZGVmYXVsdFZhbHVlO1xyXG59XHJcbmZ1bmN0aW9uIGZvckVhY2hOdW1iZXIob2JqLCBmbikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHZhciBudW0gPSBOdW1iZXIoa2V5KTtcclxuICAgICAgICAgICAgaWYgKCFpc05hTihudW0pKSB7XHJcbiAgICAgICAgICAgICAgICBmbihudW0sIG9ialtrZXldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWx1ZXMob2JqKSB7XHJcbiAgICB2YXIgdnMgPSBbXTtcclxuICAgIGZvckVhY2gob2JqLCBmdW5jdGlvbiAoXywgdikgeyByZXR1cm4gdnMucHVzaCh2KTsgfSk7XHJcbiAgICByZXR1cm4gdnM7XHJcbn1cclxuZnVuY3Rpb24gZm9yRWFjaChvYmosIGZuKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcclxuICAgICAgICAgICAgZm4oa2V5LCBvYmpba2V5XSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGlzRW1wdHkob2JqKSB7XHJcbiAgICBhc3NlcnQob2JqICE9IG51bGwgJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcsICdpc0VtcHR5KCkgZXhwZWN0cyBvYmplY3QgcGFyYW1ldGVyLicpO1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiBzaGFsbG93Q29weShvYmopIHtcclxuICAgIGFzc2VydChvYmogJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcsICdzaGFsbG93Q29weSgpIGV4cGVjdHMgb2JqZWN0IHBhcmFtZXRlci4nKTtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IG9ialtrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIGludm9jYXRpb24gb2YgZnVuY3Rpb25OYW1lIGhhcyB0aGUgZXhhY3QgbnVtYmVyIG9mIGFyZ3VtZW50cy5cclxuICpcclxuICogRm9yd2FyZCB0aGUgbWFnaWMgXCJhcmd1bWVudHNcIiB2YXJpYWJsZSBhcyBzZWNvbmQgcGFyYW1ldGVyIG9uIHdoaWNoIHRoZVxyXG4gKiBwYXJhbWV0ZXIgdmFsaWRhdGlvbiBpcyBwZXJmb3JtZWQ6XHJcbiAqIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ215RnVuY3Rpb24nLCBhcmd1bWVudHMsIDIpO1xyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncyhmdW5jdGlvbk5hbWUsIGFyZ3MsIG51bWJlck9mQXJncykge1xyXG4gICAgaWYgKGFyZ3MubGVuZ3RoICE9PSBudW1iZXJPZkFyZ3MpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBcIiArXHJcbiAgICAgICAgICAgIGZvcm1hdFBsdXJhbChudW1iZXJPZkFyZ3MsICdhcmd1bWVudCcpICtcclxuICAgICAgICAgICAgJywgYnV0IHdhcyBjYWxsZWQgd2l0aCAnICtcclxuICAgICAgICAgICAgZm9ybWF0UGx1cmFsKGFyZ3MubGVuZ3RoLCAnYXJndW1lbnQnKSArXHJcbiAgICAgICAgICAgICcuJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGUgaW52b2NhdGlvbiBvZiBmdW5jdGlvbk5hbWUgaGFzIGF0IGxlYXN0IHRoZSBwcm92aWRlZCBudW1iZXIgb2ZcclxuICogYXJndW1lbnRzIChidXQgY2FuIGhhdmUgbWFueSBtb3JlKS5cclxuICpcclxuICogRm9yd2FyZCB0aGUgbWFnaWMgXCJhcmd1bWVudHNcIiB2YXJpYWJsZSBhcyBzZWNvbmQgcGFyYW1ldGVyIG9uIHdoaWNoIHRoZVxyXG4gKiBwYXJhbWV0ZXIgdmFsaWRhdGlvbiBpcyBwZXJmb3JtZWQ6XHJcbiAqIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnbXlGdW5jdGlvbicsIGFyZ3VtZW50cywgMik7XHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoZnVuY3Rpb25OYW1lLCBhcmdzLCBtaW5OdW1iZXJPZkFyZ3MpIHtcclxuICAgIGlmIChhcmdzLmxlbmd0aCA8IG1pbk51bWJlck9mQXJncykge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIGF0IGxlYXN0IFwiICtcclxuICAgICAgICAgICAgZm9ybWF0UGx1cmFsKG1pbk51bWJlck9mQXJncywgJ2FyZ3VtZW50JykgK1xyXG4gICAgICAgICAgICAnLCBidXQgd2FzIGNhbGxlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICBmb3JtYXRQbHVyYWwoYXJncy5sZW5ndGgsICdhcmd1bWVudCcpICtcclxuICAgICAgICAgICAgJy4nKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBpbnZvY2F0aW9uIG9mIGZ1bmN0aW9uTmFtZSBoYXMgbnVtYmVyIG9mIGFyZ3VtZW50cyBiZXR3ZWVuXHJcbiAqIHRoZSB2YWx1ZXMgcHJvdmlkZWQuXHJcbiAqXHJcbiAqIEZvcndhcmQgdGhlIG1hZ2ljIFwiYXJndW1lbnRzXCIgdmFyaWFibGUgYXMgc2Vjb25kIHBhcmFtZXRlciBvbiB3aGljaCB0aGVcclxuICogcGFyYW1ldGVyIHZhbGlkYXRpb24gaXMgcGVyZm9ybWVkOlxyXG4gKiB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ215RnVuY3Rpb24nLCBhcmd1bWVudHMsIDIsIDMpO1xyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKGZ1bmN0aW9uTmFtZSwgYXJncywgbWluTnVtYmVyT2ZBcmdzLCBtYXhOdW1iZXJPZkFyZ3MpIHtcclxuICAgIGlmIChhcmdzLmxlbmd0aCA8IG1pbk51bWJlck9mQXJncyB8fCBhcmdzLmxlbmd0aCA+IG1heE51bWJlck9mQXJncykge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIGJldHdlZW4gXCIgKyBtaW5OdW1iZXJPZkFyZ3MgKyBcIiBhbmQgXCIgK1xyXG4gICAgICAgICAgICAobWF4TnVtYmVyT2ZBcmdzICsgXCIgYXJndW1lbnRzLCBidXQgd2FzIGNhbGxlZCB3aXRoIFwiKSArXHJcbiAgICAgICAgICAgIGZvcm1hdFBsdXJhbChhcmdzLmxlbmd0aCwgJ2FyZ3VtZW50JykgK1xyXG4gICAgICAgICAgICAnLicpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIHByb3ZpZGVkIGFyZ3VtZW50IGlzIGFuIGFycmF5IGFuZCBoYXMgYXMgbGVhc3QgdGhlIGV4cGVjdGVkXHJcbiAqIG51bWJlciBvZiBlbGVtZW50cy5cclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTmFtZWRBcnJheUF0TGVhc3ROdW1iZXJPZkVsZW1lbnRzKGZ1bmN0aW9uTmFtZSwgdmFsdWUsIG5hbWUsIG1pbk51bWJlck9mRWxlbWVudHMpIHtcclxuICAgIGlmICghKHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHx8IHZhbHVlLmxlbmd0aCA8IG1pbk51bWJlck9mRWxlbWVudHMpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBpdHMgXCIgKyBuYW1lICsgXCIgYXJndW1lbnQgdG8gYmUgYW4gXCIgK1xyXG4gICAgICAgICAgICAnYXJyYXkgd2l0aCBhdCBsZWFzdCAnICtcclxuICAgICAgICAgICAgKGZvcm1hdFBsdXJhbChtaW5OdW1iZXJPZkVsZW1lbnRzLCAnZWxlbWVudCcpICsgXCIuXCIpKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBwcm92aWRlZCBwb3NpdGlvbmFsIGFyZ3VtZW50IGhhcyB0aGUgbmF0aXZlIEphdmFTY3JpcHQgdHlwZVxyXG4gKiB1c2luZyB0eXBlb2YgY2hlY2tzLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVBcmdUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgcG9zaXRpb24sIGFyZ3VtZW50KSB7XHJcbiAgICB2YWxpZGF0ZVR5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBvcmRpbmFsKHBvc2l0aW9uKSArIFwiIGFyZ3VtZW50XCIsIGFyZ3VtZW50KTtcclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBwcm92aWRlZCBhcmd1bWVudCBoYXMgdGhlIG5hdGl2ZSBKYXZhU2NyaXB0IHR5cGUgdXNpbmdcclxuICogdHlwZW9mIGNoZWNrcyBvciBpcyB1bmRlZmluZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU9wdGlvbmFsQXJnVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIHBvc2l0aW9uLCBhcmd1bWVudCkge1xyXG4gICAgaWYgKGFyZ3VtZW50ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBwb3NpdGlvbiwgYXJndW1lbnQpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIHByb3ZpZGVkIG5hbWVkIG9wdGlvbiBoYXMgdGhlIG5hdGl2ZSBKYXZhU2NyaXB0IHR5cGUgdXNpbmdcclxuICogdHlwZW9mIGNoZWNrcy5cclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTmFtZWRUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgb3B0aW9uTmFtZSwgYXJndW1lbnQpIHtcclxuICAgIHZhbGlkYXRlVHlwZShmdW5jdGlvbk5hbWUsIHR5cGUsIG9wdGlvbk5hbWUgKyBcIiBvcHRpb25cIiwgYXJndW1lbnQpO1xyXG59XHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgdGhlIHByb3ZpZGVkIG5hbWVkIG9wdGlvbiBoYXMgdGhlIG5hdGl2ZSBKYXZhU2NyaXB0IHR5cGUgdXNpbmdcclxuICogdHlwZW9mIGNoZWNrcyBvciBpcyB1bmRlZmluZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxUeXBlKGZ1bmN0aW9uTmFtZSwgdHlwZSwgb3B0aW9uTmFtZSwgYXJndW1lbnQpIHtcclxuICAgIGlmIChhcmd1bWVudCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdmFsaWRhdGVOYW1lZFR5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBvcHRpb25OYW1lLCBhcmd1bWVudCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVBcnJheUVsZW1lbnRzKGZ1bmN0aW9uTmFtZSwgb3B0aW9uTmFtZSwgdHlwZURlc2NyaXB0aW9uLCBhcmd1bWVudCwgdmFsaWRhdG9yKSB7XHJcbiAgICBpZiAoIShhcmd1bWVudCBpbnN0YW5jZW9mIEFycmF5KSkge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiRnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpIHJlcXVpcmVzIGl0cyBcIiArIG9wdGlvbk5hbWUgKyBcIiBcIiArXHJcbiAgICAgICAgICAgIChcIm9wdGlvbiB0byBiZSBhbiBhcnJheSwgYnV0IGl0IHdhczogXCIgKyB2YWx1ZURlc2NyaXB0aW9uKGFyZ3VtZW50KSkpO1xyXG4gICAgfVxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudC5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGlmICghdmFsaWRhdG9yKGFyZ3VtZW50W2ldKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBhbGwgXCIgKyBvcHRpb25OYW1lICsgXCIgXCIgK1xyXG4gICAgICAgICAgICAgICAgKFwiZWxlbWVudHMgdG8gYmUgXCIgKyB0eXBlRGVzY3JpcHRpb24gKyBcIiwgYnV0IHRoZSB2YWx1ZSBhdCBpbmRleCBcIiArIGkgKyBcIiBcIikgK1xyXG4gICAgICAgICAgICAgICAgKFwid2FzOiBcIiArIHZhbHVlRGVzY3JpcHRpb24oYXJndW1lbnRbaV0pKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlT3B0aW9uYWxBcnJheUVsZW1lbnRzKGZ1bmN0aW9uTmFtZSwgb3B0aW9uTmFtZSwgdHlwZURlc2NyaXB0aW9uLCBhcmd1bWVudCwgdmFsaWRhdG9yKSB7XHJcbiAgICBpZiAoYXJndW1lbnQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhbGlkYXRlQXJyYXlFbGVtZW50cyhmdW5jdGlvbk5hbWUsIG9wdGlvbk5hbWUsIHR5cGVEZXNjcmlwdGlvbiwgYXJndW1lbnQsIHZhbGlkYXRvcik7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFZhbGlkYXRlcyB0aGF0IHRoZSBwcm92aWRlZCBuYW1lZCBvcHRpb24gZXF1YWxzIG9uZSBvZiB0aGUgZXhwZWN0ZWQgdmFsdWVzLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lZFByb3BlcnR5RXF1YWxzKGZ1bmN0aW9uTmFtZSwgaW5wdXROYW1lLCBvcHRpb25OYW1lLCBpbnB1dCwgZXhwZWN0ZWQpIHtcclxuICAgIHZhciBleHBlY3RlZERlc2NyaXB0aW9uID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIGV4cGVjdGVkXzEgPSBleHBlY3RlZDsgX2kgPCBleHBlY3RlZF8xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciB2YWwgPSBleHBlY3RlZF8xW19pXTtcclxuICAgICAgICBpZiAodmFsID09PSBpbnB1dCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV4cGVjdGVkRGVzY3JpcHRpb24ucHVzaCh2YWx1ZURlc2NyaXB0aW9uKHZhbCkpO1xyXG4gICAgfVxyXG4gICAgdmFyIGFjdHVhbERlc2NyaXB0aW9uID0gdmFsdWVEZXNjcmlwdGlvbihpbnB1dCk7XHJcbiAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgdmFsdWUgXCIgKyBhY3R1YWxEZXNjcmlwdGlvbiArIFwiIHByb3ZpZGVkIHRvIGZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSBmb3Igb3B0aW9uIFwiICtcclxuICAgICAgICAoXCJcXFwiXCIgKyBvcHRpb25OYW1lICsgXCJcXFwiLiBBY2NlcHRhYmxlIHZhbHVlczogXCIgKyBleHBlY3RlZERlc2NyaXB0aW9uLmpvaW4oJywgJykpKTtcclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoYXQgdGhlIHByb3ZpZGVkIG5hbWVkIG9wdGlvbiBlcXVhbHMgb25lIG9mIHRoZSBleHBlY3RlZCB2YWx1ZXMgb3JcclxuICogaXMgdW5kZWZpbmVkLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lZE9wdGlvbmFsUHJvcGVydHlFcXVhbHMoZnVuY3Rpb25OYW1lLCBpbnB1dE5hbWUsIG9wdGlvbk5hbWUsIGlucHV0LCBleHBlY3RlZCkge1xyXG4gICAgaWYgKGlucHV0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB2YWxpZGF0ZU5hbWVkUHJvcGVydHlFcXVhbHMoZnVuY3Rpb25OYW1lLCBpbnB1dE5hbWUsIG9wdGlvbk5hbWUsIGlucHV0LCBleHBlY3RlZCk7XHJcbiAgICB9XHJcbn1cclxuLyoqIEhlbHBlciB0byB2YWxpZGF0ZSB0aGUgdHlwZSBvZiBhIHByb3ZpZGVkIGlucHV0LiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZVR5cGUoZnVuY3Rpb25OYW1lLCB0eXBlLCBpbnB1dE5hbWUsIGlucHV0KSB7XHJcbiAgICB2YXIgdmFsaWQgPSBmYWxzZTtcclxuICAgIGlmICh0eXBlID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIHZhbGlkID0gaXNQbGFpbk9iamVjdChpbnB1dCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlID09PSAnbm9uLWVtcHR5IHN0cmluZycpIHtcclxuICAgICAgICB2YWxpZCA9IHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycgJiYgaW5wdXQgIT09ICcnO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdmFsaWQgPSB0eXBlb2YgaW5wdXQgPT09IHR5cGU7XHJcbiAgICB9XHJcbiAgICBpZiAoIXZhbGlkKSB7XHJcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gdmFsdWVEZXNjcmlwdGlvbihpbnB1dCk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgaXRzIFwiICsgaW5wdXROYW1lICsgXCIgXCIgK1xyXG4gICAgICAgICAgICAoXCJ0byBiZSBvZiB0eXBlIFwiICsgdHlwZSArIFwiLCBidXQgaXQgd2FzOiBcIiArIGRlc2NyaXB0aW9uKSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgdHJ1ZSBpZiBpdCdzIGEgbm9uLW51bGwgb2JqZWN0IHdpdGhvdXQgYSBjdXN0b20gcHJvdG90eXBlXHJcbiAqIChpLmUuIGV4Y2x1ZGVzIEFycmF5LCBEYXRlLCBldGMuKS5cclxuICovXHJcbmZ1bmN0aW9uIGlzUGxhaW5PYmplY3QoaW5wdXQpIHtcclxuICAgIHJldHVybiAodHlwZW9mIGlucHV0ID09PSAnb2JqZWN0JyAmJlxyXG4gICAgICAgIGlucHV0ICE9PSBudWxsICYmXHJcbiAgICAgICAgKE9iamVjdC5nZXRQcm90b3R5cGVPZihpbnB1dCkgPT09IE9iamVjdC5wcm90b3R5cGUgfHxcclxuICAgICAgICAgICAgT2JqZWN0LmdldFByb3RvdHlwZU9mKGlucHV0KSA9PT0gbnVsbCkpO1xyXG59XHJcbi8qKiBSZXR1cm5zIGEgc3RyaW5nIGRlc2NyaWJpbmcgdGhlIHR5cGUgLyB2YWx1ZSBvZiB0aGUgcHJvdmlkZWQgaW5wdXQuICovXHJcbmZ1bmN0aW9uIHZhbHVlRGVzY3JpcHRpb24oaW5wdXQpIHtcclxuICAgIGlmIChpbnB1dCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuICd1bmRlZmluZWQnO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoaW5wdXQgPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gJ251bGwnO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGlmIChpbnB1dC5sZW5ndGggPiAyMCkge1xyXG4gICAgICAgICAgICBpbnB1dCA9IGlucHV0LnN1YnN0cmluZygwLCAyMCkgKyBcIi4uLlwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoaW5wdXQpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGlucHV0ID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgaW5wdXQgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgIHJldHVybiAnJyArIGlucHV0O1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGlucHV0ID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnYW4gYXJyYXknO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGN1c3RvbU9iamVjdE5hbWUgPSB0cnlHZXRDdXN0b21PYmplY3RUeXBlKGlucHV0KTtcclxuICAgICAgICAgICAgaWYgKGN1c3RvbU9iamVjdE5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImEgY3VzdG9tIFwiICsgY3VzdG9tT2JqZWN0TmFtZSArIFwiIG9iamVjdFwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdhbiBvYmplY3QnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGlucHV0ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgcmV0dXJuICdhIGZ1bmN0aW9uJztcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIHdyb25nIHR5cGU6ICcgKyB0eXBlb2YgaW5wdXQpO1xyXG4gICAgfVxyXG59XHJcbi8qKiBIYWNreSBtZXRob2QgdG8gdHJ5IHRvIGdldCB0aGUgY29uc3RydWN0b3IgbmFtZSBmb3IgYW4gb2JqZWN0LiAqL1xyXG5mdW5jdGlvbiB0cnlHZXRDdXN0b21PYmplY3RUeXBlKGlucHV0KSB7XHJcbiAgICBpZiAoaW5wdXQuY29uc3RydWN0b3IpIHtcclxuICAgICAgICB2YXIgZnVuY05hbWVSZWdleCA9IC9mdW5jdGlvblxccysoW15cXHMoXSspXFxzKlxcKC87XHJcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBmdW5jTmFtZVJlZ2V4LmV4ZWMoaW5wdXQuY29uc3RydWN0b3IudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgaWYgKHJlc3VsdHMgJiYgcmVzdWx0cy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzWzFdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbi8qKiBWYWxpZGF0ZXMgdGhlIHByb3ZpZGVkIGFyZ3VtZW50IGlzIGRlZmluZWQuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRGVmaW5lZChmdW5jdGlvbk5hbWUsIHBvc2l0aW9uLCBhcmd1bWVudCkge1xyXG4gICAgaWYgKGFyZ3VtZW50ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFwiICsgZnVuY3Rpb25OYW1lICsgXCIoKSByZXF1aXJlcyBhIHZhbGlkIFwiICsgb3JkaW5hbChwb3NpdGlvbikgKyBcIiBcIiArXHJcbiAgICAgICAgICAgIFwiYXJndW1lbnQsIGJ1dCBpdCB3YXMgdW5kZWZpbmVkLlwiKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVmFsaWRhdGVzIHRoZSBwcm92aWRlZCBwb3NpdGlvbmFsIGFyZ3VtZW50IGlzIGFuIG9iamVjdCwgYW5kIGl0cyBrZXlzIGFuZFxyXG4gKiB2YWx1ZXMgbWF0Y2ggdGhlIGV4cGVjdGVkIGtleXMgYW5kIHR5cGVzIHByb3ZpZGVkIGluIG9wdGlvblR5cGVzLlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVPcHRpb25OYW1lcyhmdW5jdGlvbk5hbWUsIG9wdGlvbnMsIG9wdGlvbk5hbWVzKSB7XHJcbiAgICBmb3JFYWNoKG9wdGlvbnMsIGZ1bmN0aW9uIChrZXksIF8pIHtcclxuICAgICAgICBpZiAob3B0aW9uTmFtZXMuaW5kZXhPZihrZXkpIDwgMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIlVua25vd24gb3B0aW9uICdcIiArIGtleSArIFwiJyBwYXNzZWQgdG8gZnVuY3Rpb24gXCIgKyBmdW5jdGlvbk5hbWUgKyBcIigpLiBcIiArXHJcbiAgICAgICAgICAgICAgICAnQXZhaWxhYmxlIG9wdGlvbnM6ICcgK1xyXG4gICAgICAgICAgICAgICAgb3B0aW9uTmFtZXMuam9pbignLCAnKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciBtZXRob2QgdG8gdGhyb3cgYW4gZXJyb3IgdGhhdCB0aGUgcHJvdmlkZWQgYXJndW1lbnQgZGlkIG5vdCBwYXNzXHJcbiAqIGFuIGluc3RhbmNlb2YgY2hlY2suXHJcbiAqL1xyXG5mdW5jdGlvbiBpbnZhbGlkQ2xhc3NFcnJvcihmdW5jdGlvbk5hbWUsIHR5cGUsIHBvc2l0aW9uLCBhcmd1bWVudCkge1xyXG4gICAgdmFyIGRlc2NyaXB0aW9uID0gdmFsdWVEZXNjcmlwdGlvbihhcmd1bWVudCk7XHJcbiAgICByZXR1cm4gbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIGZ1bmN0aW9uTmFtZSArIFwiKCkgcmVxdWlyZXMgaXRzIFwiICsgb3JkaW5hbChwb3NpdGlvbikgKyBcIiBcIiArXHJcbiAgICAgICAgKFwiYXJndW1lbnQgdG8gYmUgYSBcIiArIHR5cGUgKyBcIiwgYnV0IGl0IHdhczogXCIgKyBkZXNjcmlwdGlvbikpO1xyXG59XHJcbi8qKiBDb252ZXJ0cyBhIG51bWJlciB0byBpdHMgZW5nbGlzaCB3b3JkIHJlcHJlc2VudGF0aW9uICovXHJcbmZ1bmN0aW9uIG9yZGluYWwobnVtKSB7XHJcbiAgICBzd2l0Y2ggKG51bSkge1xyXG4gICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgcmV0dXJuICdmaXJzdCc7XHJcbiAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICByZXR1cm4gJ3NlY29uZCc7XHJcbiAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICByZXR1cm4gJ3RoaXJkJztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gbnVtICsgJ3RoJztcclxuICAgIH1cclxufVxyXG4vKipcclxuICogRm9ybWF0cyB0aGUgZ2l2ZW4gd29yZCBhcyBwbHVyYWwgY29uZGl0aW9uYWxseSBnaXZlbiB0aGUgcHJlY2VkaW5nIG51bWJlci5cclxuICovXHJcbmZ1bmN0aW9uIGZvcm1hdFBsdXJhbChudW0sIHN0cikge1xyXG4gICAgcmV0dXJuIG51bSArIFwiIFwiICsgc3RyICsgKG51bSA9PT0gMSA/ICcnIDogJ3MnKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNsYXNzLWFzLW5hbWVzcGFjZVxyXG52YXIgQXV0b0lkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXV0b0lkKCkge1xyXG4gICAgfVxyXG4gICAgQXV0b0lkLm5ld0lkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIEFscGhhbnVtZXJpYyBjaGFyYWN0ZXJzXHJcbiAgICAgICAgdmFyIGNoYXJzID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5JztcclxuICAgICAgICB2YXIgYXV0b0lkID0gJyc7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGF1dG9JZCArPSBjaGFycy5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2hhcnMubGVuZ3RoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFzc2VydChhdXRvSWQubGVuZ3RoID09PSAyMCwgJ0ludmFsaWQgYXV0byBJRDogJyArIGF1dG9JZCk7XHJcbiAgICAgICAgcmV0dXJuIGF1dG9JZDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQXV0b0lkO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBwcmltaXRpdmVDb21wYXJhdG9yKGxlZnQsIHJpZ2h0KSB7XHJcbiAgICBpZiAobGVmdCA8IHJpZ2h0KVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIGlmIChsZWZ0ID4gcmlnaHQpXHJcbiAgICAgICAgcmV0dXJuIDE7XHJcbiAgICByZXR1cm4gMDtcclxufVxyXG4vKiogSGVscGVyIHRvIGNvbXBhcmUgbnVsbGFibGUgKG9yIHVuZGVmaW5lZC1hYmxlKSBvYmplY3RzIHVzaW5nIGlzRXF1YWwoKS4gKi9cclxuZnVuY3Rpb24gZXF1YWxzKGxlZnQsIHJpZ2h0KSB7XHJcbiAgICBpZiAobGVmdCAhPT0gbnVsbCAmJiBsZWZ0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4gISEocmlnaHQgJiYgbGVmdC5pc0VxdWFsKHJpZ2h0KSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBIQUNLOiBFeHBsaWNpdGx5IGNhc3Qgc2luY2UgVHlwZVNjcmlwdCdzIHR5cGUgbmFycm93aW5nIGFwcGFyZW50bHkgaXNuJ3RcclxuICAgICAgICAvLyBzbWFydCBlbm91Z2guXHJcbiAgICAgICAgcmV0dXJuIGxlZnQgPT09IHJpZ2h0O1xyXG4gICAgfVxyXG59XHJcbi8qKiBIZWxwZXIgdG8gY29tcGFyZSBhcnJheXMgdXNpbmcgaXNFcXVhbCgpLiAqL1xyXG5mdW5jdGlvbiBhcnJheUVxdWFscyhsZWZ0LCByaWdodCkge1xyXG4gICAgaWYgKGxlZnQubGVuZ3RoICE9PSByaWdodC5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlZnQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoIWxlZnRbaV0uaXNFcXVhbChyaWdodFtpXSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBpbW1lZGlhdGUgbGV4aWNvZ3JhcGhpY2FsbHktZm9sbG93aW5nIHN0cmluZy4gVGhpcyBpcyB1c2VmdWwgdG9cclxuICogY29uc3RydWN0IGFuIGluY2x1c2l2ZSByYW5nZSBmb3IgaW5kZXhlZGRiIGl0ZXJhdG9ycy5cclxuICovXHJcbmZ1bmN0aW9uIGltbWVkaWF0ZVN1Y2Nlc3NvcihzKSB7XHJcbiAgICAvLyBSZXR1cm4gdGhlIGlucHV0IHN0cmluZywgd2l0aCBhbiBhZGRpdGlvbmFsIE5VTCBieXRlIGFwcGVuZGVkLlxyXG4gICAgcmV0dXJuIHMgKyAnXFwwJztcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqIEhlbHBlciBmdW5jdGlvbiB0byBhc3NlcnQgVWludDhBcnJheSBpcyBhdmFpbGFibGUgYXQgcnVudGltZS4gKi9cclxuZnVuY3Rpb24gYXNzZXJ0VWludDhBcnJheUF2YWlsYWJsZSgpIHtcclxuICAgIGlmICh0eXBlb2YgVWludDhBcnJheSA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTklNUExFTUVOVEVELCAnVWludDhBcnJheXMgYXJlIG5vdCBhdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudC4nKTtcclxuICAgIH1cclxufVxyXG4vKiogSGVscGVyIGZ1bmN0aW9uIHRvIGFzc2VydCBCYXNlNjQgZnVuY3Rpb25zIGFyZSBhdmFpbGFibGUgYXQgcnVudGltZS4gKi9cclxuZnVuY3Rpb24gYXNzZXJ0QmFzZTY0QXZhaWxhYmxlKCkge1xyXG4gICAgaWYgKCFQbGF0Zm9ybVN1cHBvcnQuZ2V0UGxhdGZvcm0oKS5iYXNlNjRBdmFpbGFibGUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTklNUExFTUVOVEVELCAnQmxvYnMgYXJlIHVuYXZhaWxhYmxlIGluIEZpcmVzdG9yZSBpbiB0aGlzIGVudmlyb25tZW50LicpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBJbW11dGFibGUgY2xhc3MgaG9sZGluZyBhIGJsb2IgKGJpbmFyeSBkYXRhKS5cclxuICogVGhpcyBjbGFzcyBpcyBkaXJlY3RseSBleHBvc2VkIGluIHRoZSBwdWJsaWMgQVBJLlxyXG4gKlxyXG4gKiBOb3RlIHRoYXQgd2hpbGUgeW91IGNhbid0IGhpZGUgdGhlIGNvbnN0cnVjdG9yIGluIEphdmFTY3JpcHQgY29kZSwgd2UgYXJlXHJcbiAqIHVzaW5nIHRoZSBoYWNrIGFib3ZlIHRvIG1ha2Ugc3VyZSBuby1vbmUgb3V0c2lkZSB0aGlzIG1vZHVsZSBjYW4gY2FsbCBpdC5cclxuICovXHJcbnZhciBCbG9iID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQmxvYihiaW5hcnlTdHJpbmcpIHtcclxuICAgICAgICBhc3NlcnRCYXNlNjRBdmFpbGFibGUoKTtcclxuICAgICAgICB0aGlzLl9iaW5hcnlTdHJpbmcgPSBiaW5hcnlTdHJpbmc7XHJcbiAgICB9XHJcbiAgICBCbG9iLmZyb21CYXNlNjRTdHJpbmcgPSBmdW5jdGlvbiAoYmFzZTY0KSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnQmxvYi5mcm9tQmFzZTY0U3RyaW5nJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0Jsb2IuZnJvbUJhc2U2NFN0cmluZycsICdzdHJpbmcnLCAxLCBiYXNlNjQpO1xyXG4gICAgICAgIGFzc2VydEJhc2U2NEF2YWlsYWJsZSgpO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHZhciBiaW5hcnlTdHJpbmcgPSBQbGF0Zm9ybVN1cHBvcnQuZ2V0UGxhdGZvcm0oKS5hdG9iKGJhc2U2NCk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYihiaW5hcnlTdHJpbmcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnRmFpbGVkIHRvIGNvbnN0cnVjdCBCbG9iIGZyb20gQmFzZTY0IHN0cmluZzogJyArIGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBCbG9iLmZyb21VaW50OEFycmF5ID0gZnVuY3Rpb24gKGFycmF5KSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnQmxvYi5mcm9tVWludDhBcnJheScsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgYXNzZXJ0VWludDhBcnJheUF2YWlsYWJsZSgpO1xyXG4gICAgICAgIGlmICghKGFycmF5IGluc3RhbmNlb2YgVWludDhBcnJheSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZENsYXNzRXJyb3IoJ0Jsb2IuZnJvbVVpbnQ4QXJyYXknLCAnVWludDhBcnJheScsIDEsIGFycmF5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gV2UgY2FuJ3QgY2FsbCBhcnJheS5tYXAgZGlyZWN0bHkgYmVjYXVzZSBpdCBleHBlY3RzIHRoZSByZXR1cm4gdHlwZSB0b1xyXG4gICAgICAgIC8vIGJlIGEgVWludDhBcnJheSwgd2hlcmVhcyB3ZSBjYW4gY29udmVydCBpdCB0byBhIHJlZ3VsYXIgYXJyYXkgYnkgaW52b2tpbmdcclxuICAgICAgICAvLyBtYXAgb24gdGhlIEFycmF5IHByb3RvdHlwZS5cclxuICAgICAgICB2YXIgYmluYXJ5U3RyaW5nID0gQXJyYXkucHJvdG90eXBlLm1hcFxyXG4gICAgICAgICAgICAuY2FsbChhcnJheSwgZnVuY3Rpb24gKGNoYXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhcik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmpvaW4oJycpO1xyXG4gICAgICAgIHJldHVybiBuZXcgQmxvYihiaW5hcnlTdHJpbmcpO1xyXG4gICAgfTtcclxuICAgIEJsb2IucHJvdG90eXBlLnRvQmFzZTY0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0Jsb2IudG9CYXNlNjQnLCBhcmd1bWVudHMsIDApO1xyXG4gICAgICAgIGFzc2VydEJhc2U2NEF2YWlsYWJsZSgpO1xyXG4gICAgICAgIHJldHVybiBQbGF0Zm9ybVN1cHBvcnQuZ2V0UGxhdGZvcm0oKS5idG9hKHRoaXMuX2JpbmFyeVN0cmluZyk7XHJcbiAgICB9O1xyXG4gICAgQmxvYi5wcm90b3R5cGUudG9VaW50OEFycmF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0Jsb2IudG9VaW50OEFycmF5JywgYXJndW1lbnRzLCAwKTtcclxuICAgICAgICBhc3NlcnRVaW50OEFycmF5QXZhaWxhYmxlKCk7XHJcbiAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KHRoaXMuX2JpbmFyeVN0cmluZy5sZW5ndGgpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fYmluYXJ5U3RyaW5nLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGJ1ZmZlcltpXSA9IHRoaXMuX2JpbmFyeVN0cmluZy5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYnVmZmVyO1xyXG4gICAgfTtcclxuICAgIEJsb2IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAnQmxvYihiYXNlNjQ6ICcgKyB0aGlzLnRvQmFzZTY0KCkgKyAnKSc7XHJcbiAgICB9O1xyXG4gICAgQmxvYi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9iaW5hcnlTdHJpbmcgPT09IG90aGVyLl9iaW5hcnlTdHJpbmc7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBY3R1YWxseSBwcml2YXRlIHRvIEpTIGNvbnN1bWVycyBvZiBvdXIgQVBJLCBzbyB0aGlzIGZ1bmN0aW9uIGlzIHByZWZpeGVkXHJcbiAgICAgKiB3aXRoIGFuIHVuZGVyc2NvcmUuXHJcbiAgICAgKi9cclxuICAgIEJsb2IucHJvdG90eXBlLl9jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLl9iaW5hcnlTdHJpbmcsIG90aGVyLl9iaW5hcnlTdHJpbmcpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBCbG9iO1xyXG59KCkpO1xyXG4vLyBQdWJsaWMgaW5zdGFuY2UgdGhhdCBkaXNhbGxvd3MgY29uc3RydWN0aW9uIGF0IHJ1bnRpbWUuIFRoaXMgY29uc3RydWN0b3IgaXNcclxuLy8gdXNlZCB3aGVuIGV4cG9ydGluZyBCbG9iIG9uIGZpcmViYXNlLmZpcmVzdG9yZS5CbG9iIGFuZCB3aWxsIGJlIGNhbGxlZCBCbG9iXHJcbi8vIHB1YmxpY2x5LiBJbnRlcm5hbGx5IHdlIHN0aWxsIHVzZSBCbG9iIHdoaWNoIGhhcyBhIHR5cGUgY2hlY2tlZCBwcml2YXRlXHJcbi8vIGNvbnN0cnVjdG9yLiBOb3RlIHRoYXQgQmxvYiBhbmQgUHVibGljQmxvYiBjYW4gYmUgdXNlZCBpbnRlcmNoYW5nZWFibHkgaW5cclxuLy8gaW5zdGFuY2VvZiBjaGVja3MuXHJcbi8vIEZvciBvdXIgaW50ZXJuYWwgVHlwZVNjcmlwdCBjb2RlIFB1YmxpY0Jsb2IgZG9lc24ndCBleGlzdCBhcyBhIHR5cGUsIGFuZCBzb1xyXG4vLyB3ZSBuZWVkIHRvIHVzZSBCbG9iIGFzIHR5cGUgYW5kIGV4cG9ydCBpdCB0b28uXHJcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTp2YXJpYWJsZS1uYW1lIFdlJ3JlIHRyZWF0aW5nIHRoaXMgYXMgYSBjbGFzcyBuYW1lLlxyXG52YXIgUHVibGljQmxvYiA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoQmxvYiwgJ1VzZSBCbG9iLmZyb21VaW50OEFycmF5KCkgb3IgQmxvYi5mcm9tQmFzZTY0U3RyaW5nKCkgaW5zdGVhZC4nKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBJbW11dGFibGUgY2xhc3MgcmVwcmVzZW50aW5nIGEgZ2VvIHBvaW50IGFzIGxhdGl0dWRlLWxvbmdpdHVkZSBwYWlyLlxyXG4gKiBUaGlzIGNsYXNzIGlzIGRpcmVjdGx5IGV4cG9zZWQgaW4gdGhlIHB1YmxpYyBBUEksIGluY2x1ZGluZyBpdHMgY29uc3RydWN0b3IuXHJcbiAqL1xyXG52YXIgR2VvUG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBHZW9Qb2ludChsYXRpdHVkZSwgbG9uZ2l0dWRlKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnR2VvUG9pbnQnLCBhcmd1bWVudHMsIDIpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnR2VvUG9pbnQnLCAnbnVtYmVyJywgMSwgbGF0aXR1ZGUpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnR2VvUG9pbnQnLCAnbnVtYmVyJywgMiwgbG9uZ2l0dWRlKTtcclxuICAgICAgICBpZiAoIWlzRmluaXRlKGxhdGl0dWRlKSB8fCBsYXRpdHVkZSA8IC05MCB8fCBsYXRpdHVkZSA+IDkwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdMYXRpdHVkZSBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MCwgYnV0IHdhczogJyArIGxhdGl0dWRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFpc0Zpbml0ZShsb25naXR1ZGUpIHx8IGxvbmdpdHVkZSA8IC0xODAgfHwgbG9uZ2l0dWRlID4gMTgwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdMb25naXR1ZGUgbXVzdCBiZSBhIG51bWJlciBiZXR3ZWVuIC0xODAgYW5kIDE4MCwgYnV0IHdhczogJyArIGxvbmdpdHVkZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xhdCA9IGxhdGl0dWRlO1xyXG4gICAgICAgIHRoaXMuX2xvbmcgPSBsb25naXR1ZGU7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VvUG9pbnQucHJvdG90eXBlLCBcImxhdGl0dWRlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZXR1cm5zIHRoZSBsYXRpdHVkZSBvZiB0aGlzIGdlbyBwb2ludCwgYSBudW1iZXIgYmV0d2VlbiAtOTAgYW5kIDkwLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGF0O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdlb1BvaW50LnByb3RvdHlwZSwgXCJsb25naXR1ZGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJldHVybnMgdGhlIGxvbmdpdHVkZSBvZiB0aGlzIGdlbyBwb2ludCwgYSBudW1iZXIgYmV0d2VlbiAtMTgwIGFuZCAxODAuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb25nO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgR2VvUG9pbnQucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbGF0ID09PSBvdGhlci5fbGF0ICYmIHRoaXMuX2xvbmcgPT09IG90aGVyLl9sb25nO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWN0dWFsbHkgcHJpdmF0ZSB0byBKUyBjb25zdW1lcnMgb2Ygb3VyIEFQSSwgc28gdGhpcyBmdW5jdGlvbiBpcyBwcmVmaXhlZFxyXG4gICAgICogd2l0aCBhbiB1bmRlcnNjb3JlLlxyXG4gICAgICovXHJcbiAgICBHZW9Qb2ludC5wcm90b3R5cGUuX2NvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAocHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLl9sYXQsIG90aGVyLl9sYXQpIHx8XHJcbiAgICAgICAgICAgIHByaW1pdGl2ZUNvbXBhcmF0b3IodGhpcy5fbG9uZywgb3RoZXIuX2xvbmcpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gR2VvUG9pbnQ7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgVGltZXN0YW1wID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVGltZXN0YW1wKHNlY29uZHMsIG5hbm9zZWNvbmRzKSB7XHJcbiAgICAgICAgdGhpcy5zZWNvbmRzID0gc2Vjb25kcztcclxuICAgICAgICB0aGlzLm5hbm9zZWNvbmRzID0gbmFub3NlY29uZHM7XHJcbiAgICAgICAgaWYgKG5hbm9zZWNvbmRzIDwgMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnVGltZXN0YW1wIG5hbm9zZWNvbmRzIG91dCBvZiByYW5nZTogJyArIG5hbm9zZWNvbmRzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG5hbm9zZWNvbmRzID49IDFlOSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnVGltZXN0YW1wIG5hbm9zZWNvbmRzIG91dCBvZiByYW5nZTogJyArIG5hbm9zZWNvbmRzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gTWlkbmlnaHQgYXQgdGhlIGJlZ2lubmluZyBvZiAxLzEvMSBpcyB0aGUgZWFybGllc3QgRmlyZXN0b3JlIHN1cHBvcnRzLlxyXG4gICAgICAgIGlmIChzZWNvbmRzIDwgLTYyMTM1NTk2ODAwKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdUaW1lc3RhbXAgc2Vjb25kcyBvdXQgb2YgcmFuZ2U6ICcgKyBzZWNvbmRzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVGhpcyB3aWxsIGJyZWFrIGluIHRoZSB5ZWFyIDEwLDAwMC5cclxuICAgICAgICBpZiAoc2Vjb25kcyA+PSAyNTM0MDIzMDA4MDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1RpbWVzdGFtcCBzZWNvbmRzIG91dCBvZiByYW5nZTogJyArIHNlY29uZHMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFRpbWVzdGFtcC5ub3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFRpbWVzdGFtcC5mcm9tTWlsbGlzKERhdGUubm93KCkpO1xyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcC5mcm9tRGF0ZSA9IGZ1bmN0aW9uIChkYXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIFRpbWVzdGFtcC5mcm9tTWlsbGlzKGRhdGUuZ2V0VGltZSgpKTtcclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXAuZnJvbU1pbGxpcyA9IGZ1bmN0aW9uIChtaWxsaXNlY29uZHMpIHtcclxuICAgICAgICB2YXIgc2Vjb25kcyA9IE1hdGguZmxvb3IobWlsbGlzZWNvbmRzIC8gMTAwMCk7XHJcbiAgICAgICAgdmFyIG5hbm9zID0gKG1pbGxpc2Vjb25kcyAtIHNlY29uZHMgKiAxMDAwKSAqIDFlNjtcclxuICAgICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcChzZWNvbmRzLCBuYW5vcyk7XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wLnByb3RvdHlwZS50b0RhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHRoaXMudG9NaWxsaXMoKSk7XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wLnByb3RvdHlwZS50b01pbGxpcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWNvbmRzICogMTAwMCArIHRoaXMubmFub3NlY29uZHMgLyAxZTY7XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wLnByb3RvdHlwZS5fY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kcyA9PT0gb3RoZXIuc2Vjb25kcykge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLm5hbm9zZWNvbmRzLCBvdGhlci5uYW5vc2Vjb25kcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuc2Vjb25kcywgb3RoZXIuc2Vjb25kcyk7XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlci5zZWNvbmRzID09PSB0aGlzLnNlY29uZHMgJiYgb3RoZXIubmFub3NlY29uZHMgPT09IHRoaXMubmFub3NlY29uZHMpO1xyXG4gICAgfTtcclxuICAgIFRpbWVzdGFtcC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICgnVGltZXN0YW1wKHNlY29uZHM9JyArXHJcbiAgICAgICAgICAgIHRoaXMuc2Vjb25kcyArXHJcbiAgICAgICAgICAgICcsIG5hbm9zZWNvbmRzPScgK1xyXG4gICAgICAgICAgICB0aGlzLm5hbm9zZWNvbmRzICtcclxuICAgICAgICAgICAgJyknKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVGltZXN0YW1wO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERhdGFiYXNlSW5mbyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQ29uc3RydWN0cyBhIERhdGFiYXNlSW5mbyB1c2luZyB0aGUgcHJvdmlkZWQgaG9zdCwgZGF0YWJhc2VJZCBhbmRcclxuICAgICAqIHBlcnNpc3RlbmNlS2V5LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkYXRhYmFzZUlkIFRoZSBkYXRhYmFzZSB0byB1c2UuXHJcbiAgICAgKiBAcGFyYW0gcGVyc2lzdGVuY2VLZXkgQSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhpcyBGaXJlc3RvcmUncyBsb2NhbFxyXG4gICAgICogc3RvcmFnZSAodXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIHRoZSBkYXRhYmFzZUlkKS5cclxuICAgICAqIEBwYXJhbSBob3N0IFRoZSBGaXJlc3RvcmUgYmFja2VuZCBob3N0IHRvIGNvbm5lY3QgdG8uXHJcbiAgICAgKiBAcGFyYW0gc3NsIFdoZXRoZXIgdG8gdXNlIFNTTCB3aGVuIGNvbm5lY3RpbmcuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIERhdGFiYXNlSW5mbyhkYXRhYmFzZUlkLCBwZXJzaXN0ZW5jZUtleSwgaG9zdCwgc3NsKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gZGF0YWJhc2VJZDtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlS2V5ID0gcGVyc2lzdGVuY2VLZXk7XHJcbiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDtcclxuICAgICAgICB0aGlzLnNzbCA9IHNzbDtcclxuICAgIH1cclxuICAgIHJldHVybiBEYXRhYmFzZUluZm87XHJcbn0oKSk7XHJcbi8qKiBUaGUgZGVmYXVsdCBkYXRhYmFzZSBuYW1lIGZvciBhIHByb2plY3QuICovXHJcbnZhciBERUZBVUxUX0RBVEFCQVNFX05BTUUgPSAnKGRlZmF1bHQpJztcclxuLyoqIFJlcHJlc2VudHMgdGhlIGRhdGFiYXNlIElEIGEgRmlyZXN0b3JlIGNsaWVudCBpcyBhc3NvY2lhdGVkIHdpdGguICovXHJcbnZhciBEYXRhYmFzZUlkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGF0YWJhc2VJZChwcm9qZWN0SWQsIGRhdGFiYXNlKSB7XHJcbiAgICAgICAgdGhpcy5wcm9qZWN0SWQgPSBwcm9qZWN0SWQ7XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZSA9IGRhdGFiYXNlID8gZGF0YWJhc2UgOiBERUZBVUxUX0RBVEFCQVNFX05BTUU7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YWJhc2VJZC5wcm90b3R5cGUsIFwiaXNEZWZhdWx0RGF0YWJhc2VcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhYmFzZSA9PT0gREVGQVVMVF9EQVRBQkFTRV9OQU1FO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgRGF0YWJhc2VJZC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBEYXRhYmFzZUlkICYmXHJcbiAgICAgICAgICAgIG90aGVyLnByb2plY3RJZCA9PT0gdGhpcy5wcm9qZWN0SWQgJiZcclxuICAgICAgICAgICAgb3RoZXIuZGF0YWJhc2UgPT09IHRoaXMuZGF0YWJhc2UpO1xyXG4gICAgfTtcclxuICAgIERhdGFiYXNlSWQucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAocHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLnByb2plY3RJZCwgb3RoZXIucHJvamVjdElkKSB8fFxyXG4gICAgICAgICAgICBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMuZGF0YWJhc2UsIG90aGVyLmRhdGFiYXNlKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERhdGFiYXNlSWQ7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRE9DVU1FTlRfS0VZX05BTUUgPSAnX19uYW1lX18nO1xyXG4vKipcclxuICogUGF0aCByZXByZXNlbnRzIGFuIG9yZGVyZWQgc2VxdWVuY2Ugb2Ygc3RyaW5nIHNlZ21lbnRzLlxyXG4gKi9cclxudmFyIFBhdGggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQYXRoKHNlZ21lbnRzLCBvZmZzZXQsIGxlbmd0aCkge1xyXG4gICAgICAgIHRoaXMuaW5pdChzZWdtZW50cywgb2Zmc2V0LCBsZW5ndGgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBpbml0aWFsaXphdGlvbiBtZXRob2QgdGhhdCBjYW4gYmUgY2FsbGVkIGZyb20gb3V0c2lkZSB0aGUgY29uc3RydWN0b3IuXHJcbiAgICAgKiBXZSBuZWVkIHRoaXMgc28gdGhhdCB3ZSBjYW4gaGF2ZSBhIG5vbi1zdGF0aWMgY29uc3RydWN0IG1ldGhvZCB0aGF0IHJldHVybnNcclxuICAgICAqIHRoZSBwb2x5bW9ycGhpYyBgdGhpc2AgdHlwZS5cclxuICAgICAqL1xyXG4gICAgUGF0aC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChzZWdtZW50cywgb2Zmc2V0LCBsZW5ndGgpIHtcclxuICAgICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgb2Zmc2V0ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAob2Zmc2V0ID4gc2VnbWVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ29mZnNldCAnICsgb2Zmc2V0ICsgJyBvdXQgb2YgcmFuZ2UgJyArIHNlZ21lbnRzLmxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBsZW5ndGggPSBzZWdtZW50cy5sZW5ndGggLSBvZmZzZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGxlbmd0aCA+IHNlZ21lbnRzLmxlbmd0aCAtIG9mZnNldCkge1xyXG4gICAgICAgICAgICBmYWlsKCdsZW5ndGggJyArIGxlbmd0aCArICcgb3V0IG9mIHJhbmdlICcgKyAoc2VnbWVudHMubGVuZ3RoIC0gb2Zmc2V0KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VnbWVudHMgPSBzZWdtZW50cztcclxuICAgICAgICB0aGlzLm9mZnNldCA9IG9mZnNldDtcclxuICAgICAgICB0aGlzLmxlbiA9IGxlbmd0aDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgYSBuZXcgaW5zdGFuY2Ugb2YgUGF0aCB1c2luZyB0aGUgc2FtZSBjb25jcmV0ZSB0eXBlIGFzIGB0aGlzYC5cclxuICAgICAqIFdlIG5lZWQgdGhpcyBpbnN0ZWFkIG9mIHVzaW5nIHRoZSBub3JtYWwgY29uc3RydWN0b3IsIGJlY2F1c2UgcG9seW1vcnBoaWNcclxuICAgICAqIGB0aGlzYCBkb2Vzbid0IHdvcmsgb24gc3RhdGljIG1ldGhvZHMuXHJcbiAgICAgKi9cclxuICAgIFBhdGgucHJvdG90eXBlLmNvbnN0cnVjdCA9IGZ1bmN0aW9uIChzZWdtZW50cywgb2Zmc2V0LCBsZW5ndGgpIHtcclxuICAgICAgICB2YXIgcGF0aCA9IE9iamVjdC5jcmVhdGUoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpKTtcclxuICAgICAgICBwYXRoLmluaXQoc2VnbWVudHMsIG9mZnNldCwgbGVuZ3RoKTtcclxuICAgICAgICByZXR1cm4gcGF0aDtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGF0aC5wcm90b3R5cGUsIFwibGVuZ3RoXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVuO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgUGF0aC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiBQYXRoLmNvbXBhcmF0b3IodGhpcywgb3RoZXIpID09PSAwO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLmNoaWxkID0gZnVuY3Rpb24gKG5hbWVPclBhdGgpIHtcclxuICAgICAgICB2YXIgc2VnbWVudHMgPSB0aGlzLnNlZ21lbnRzLnNsaWNlKHRoaXMub2Zmc2V0LCB0aGlzLmxpbWl0KCkpO1xyXG4gICAgICAgIGlmIChuYW1lT3JQYXRoIGluc3RhbmNlb2YgUGF0aCkge1xyXG4gICAgICAgICAgICBuYW1lT3JQYXRoLmZvckVhY2goZnVuY3Rpb24gKHNlZ21lbnQpIHtcclxuICAgICAgICAgICAgICAgIHNlZ21lbnRzLnB1c2goc2VnbWVudCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgbmFtZU9yUGF0aCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgc2VnbWVudHMucHVzaChuYW1lT3JQYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ1Vua25vd24gcGFyYW1ldGVyIHR5cGUgZm9yIFBhdGguY2hpbGQoKTogJyArIG5hbWVPclBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Qoc2VnbWVudHMpO1xyXG4gICAgfTtcclxuICAgIC8qKiBUaGUgaW5kZXggb2Ygb25lIHBhc3QgdGhlIGxhc3Qgc2VnbWVudCBvZiB0aGUgcGF0aC4gKi9cclxuICAgIFBhdGgucHJvdG90eXBlLmxpbWl0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9mZnNldCArIHRoaXMubGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLnBvcEZpcnN0ID0gZnVuY3Rpb24gKHNpemUpIHtcclxuICAgICAgICBzaXplID0gc2l6ZSA9PT0gdW5kZWZpbmVkID8gMSA6IHNpemU7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMubGVuZ3RoID49IHNpemUsIFwiQ2FuJ3QgY2FsbCBwb3BGaXJzdCgpIHdpdGggbGVzcyBzZWdtZW50c1wiKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3QodGhpcy5zZWdtZW50cywgdGhpcy5vZmZzZXQgKyBzaXplLCB0aGlzLmxlbmd0aCAtIHNpemUpO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLnBvcExhc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmlzRW1wdHkoKSwgXCJDYW4ndCBjYWxsIHBvcExhc3QoKSBvbiBlbXB0eSBwYXRoXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCwgdGhpcy5sZW5ndGggLSAxKTtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5maXJzdFNlZ21lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmlzRW1wdHkoKSwgXCJDYW4ndCBjYWxsIGZpcnN0U2VnbWVudCgpIG9uIGVtcHR5IHBhdGhcIik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5vZmZzZXRdO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLmxhc3RTZWdtZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5pc0VtcHR5KCksIFwiQ2FuJ3QgY2FsbCBsYXN0U2VnbWVudCgpIG9uIGVtcHR5IHBhdGhcIik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5saW1pdCgpIC0gMV07XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgICAgICAgYXNzZXJ0KGluZGV4IDwgdGhpcy5sZW5ndGgsICdJbmRleCBvdXQgb2YgcmFuZ2UnKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50c1t0aGlzLm9mZnNldCArIGluZGV4XTtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxlbmd0aCA9PT0gMDtcclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS5pc1ByZWZpeE9mID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyLmxlbmd0aCA8IHRoaXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmdldChpKSAhPT0gb3RoZXIuZ2V0KGkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgUGF0aC5wcm90b3R5cGUuaXNJbW1lZGlhdGVQYXJlbnRPZiA9IGZ1bmN0aW9uIChwb3RlbnRpYWxDaGlsZCkge1xyXG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCArIDEgIT09IHBvdGVudGlhbENoaWxkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nZXQoaSkgIT09IHBvdGVudGlhbENoaWxkLmdldChpKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFBhdGgucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5vZmZzZXQsIGVuZCA9IHRoaXMubGltaXQoKTsgaSA8IGVuZDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGZuKHRoaXMuc2VnbWVudHNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQYXRoLnByb3RvdHlwZS50b0FycmF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzLnNsaWNlKHRoaXMub2Zmc2V0LCB0aGlzLmxpbWl0KCkpO1xyXG4gICAgfTtcclxuICAgIFBhdGguY29tcGFyYXRvciA9IGZ1bmN0aW9uIChwMSwgcDIpIHtcclxuICAgICAgICB2YXIgbGVuID0gTWF0aC5taW4ocDEubGVuZ3RoLCBwMi5sZW5ndGgpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGxlZnQgPSBwMS5nZXQoaSk7XHJcbiAgICAgICAgICAgIHZhciByaWdodCA9IHAyLmdldChpKTtcclxuICAgICAgICAgICAgaWYgKGxlZnQgPCByaWdodClcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgaWYgKGxlZnQgPiByaWdodClcclxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocDEubGVuZ3RoIDwgcDIubGVuZ3RoKVxyXG4gICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgaWYgKHAxLmxlbmd0aCA+IHAyLmxlbmd0aClcclxuICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBhdGg7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIHNsYXNoLXNlcGFyYXRlZCBwYXRoIGZvciBuYXZpZ2F0aW5nIHJlc291cmNlcyAoZG9jdW1lbnRzIGFuZCBjb2xsZWN0aW9ucylcclxuICogd2l0aGluIEZpcmVzdG9yZS5cclxuICovXHJcbnZhciBSZXNvdXJjZVBhdGggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhSZXNvdXJjZVBhdGgsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBSZXNvdXJjZVBhdGgoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgUmVzb3VyY2VQYXRoLnByb3RvdHlwZS5jYW5vbmljYWxTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gTk9URTogVGhlIGNsaWVudCBpcyBpZ25vcmFudCBvZiBhbnkgcGF0aCBzZWdtZW50cyBjb250YWluaW5nIGVzY2FwZVxyXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XHJcbiAgICAgICAgLy8gZm9yIGxlZ2FjeSByZWFzb25zIGFuZCBzaG91bGQgbm90IGJlIHVzZWQgZnJlcXVlbnRseSkuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLmpvaW4oJy8nKTtcclxuICAgIH07XHJcbiAgICBSZXNvdXJjZVBhdGgucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIHJlc291cmNlIHBhdGggZnJvbSB0aGUgZ2l2ZW4gc2xhc2gtZGVsaW1pdGVkIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgUmVzb3VyY2VQYXRoLmZyb21TdHJpbmcgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIC8vIE5PVEU6IFRoZSBjbGllbnQgaXMgaWdub3JhbnQgb2YgYW55IHBhdGggc2VnbWVudHMgY29udGFpbmluZyBlc2NhcGVcclxuICAgICAgICAvLyBzZXF1ZW5jZXMgKGUuZy4gX19pZDEyM19fKSBhbmQganVzdCBwYXNzZXMgdGhlbSB0aHJvdWdoIHJhdyAodGhleSBleGlzdFxyXG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxyXG4gICAgICAgIGlmIChwYXRoLmluZGV4T2YoJy8vJykgPj0gMCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcGF0aCAoXCIgKyBwYXRoICsgXCIpLiBQYXRocyBtdXN0IG5vdCBjb250YWluIC8vIGluIHRoZW0uXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBXZSBtYXkgc3RpbGwgaGF2ZSBhbiBlbXB0eSBzZWdtZW50IGF0IHRoZSBiZWdpbm5pbmcgb3IgZW5kIGlmIHRoZXkgaGFkIGFcclxuICAgICAgICAvLyBsZWFkaW5nIG9yIHRyYWlsaW5nIHNsYXNoICh3aGljaCB3ZSBhbGxvdykuXHJcbiAgICAgICAgdmFyIHNlZ21lbnRzID0gcGF0aC5zcGxpdCgnLycpLmZpbHRlcihmdW5jdGlvbiAoc2VnbWVudCkgeyByZXR1cm4gc2VnbWVudC5sZW5ndGggPiAwOyB9KTtcclxuICAgICAgICByZXR1cm4gbmV3IFJlc291cmNlUGF0aChzZWdtZW50cyk7XHJcbiAgICB9O1xyXG4gICAgUmVzb3VyY2VQYXRoLkVNUFRZX1BBVEggPSBuZXcgUmVzb3VyY2VQYXRoKFtdKTtcclxuICAgIHJldHVybiBSZXNvdXJjZVBhdGg7XHJcbn0oUGF0aCkpO1xyXG52YXIgaWRlbnRpZmllclJlZ0V4cCA9IC9eW19hLXpBLVpdW19hLXpBLVowLTldKiQvO1xyXG4vKiogQSBkb3Qtc2VwYXJhdGVkIHBhdGggZm9yIG5hdmlnYXRpbmcgc3ViLW9iamVjdHMgd2l0aGluIGEgZG9jdW1lbnQuICovXHJcbnZhciBGaWVsZFBhdGggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhGaWVsZFBhdGgsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBGaWVsZFBhdGgoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHN0cmluZyBjb3VsZCBiZSB1c2VkIGFzIGEgc2VnbWVudCBpbiBhIGZpZWxkIHBhdGhcclxuICAgICAqIHdpdGhvdXQgZXNjYXBpbmcuXHJcbiAgICAgKi9cclxuICAgIEZpZWxkUGF0aC5pc1ZhbGlkSWRlbnRpZmllciA9IGZ1bmN0aW9uIChzZWdtZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIGlkZW50aWZpZXJSZWdFeHAudGVzdChzZWdtZW50KTtcclxuICAgIH07XHJcbiAgICBGaWVsZFBhdGgucHJvdG90eXBlLmNhbm9uaWNhbFN0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50b0FycmF5KClcclxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKCdcXFxcJywgJ1xcXFxcXFxcJykucmVwbGFjZSgnYCcsICdcXFxcYCcpO1xyXG4gICAgICAgICAgICBpZiAoIUZpZWxkUGF0aC5pc1ZhbGlkSWRlbnRpZmllcihzdHIpKSB7XHJcbiAgICAgICAgICAgICAgICBzdHIgPSAnYCcgKyBzdHIgKyAnYCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHN0cjtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuam9pbignLicpO1xyXG4gICAgfTtcclxuICAgIEZpZWxkUGF0aC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBmaWVsZCByZWZlcmVuY2VzIHRoZSBrZXkgb2YgYSBkb2N1bWVudC5cclxuICAgICAqL1xyXG4gICAgRmllbGRQYXRoLnByb3RvdHlwZS5pc0tleUZpZWxkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxlbmd0aCA9PT0gMSAmJiB0aGlzLmdldCgwKSA9PT0gRE9DVU1FTlRfS0VZX05BTUU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgZmllbGQgZGVzaWduYXRpbmcgdGhlIGtleSBvZiBhIGRvY3VtZW50LlxyXG4gICAgICovXHJcbiAgICBGaWVsZFBhdGgua2V5RmllbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFBhdGgoW0RPQ1VNRU5UX0tFWV9OQU1FXSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBmaWVsZCBzdHJpbmcgZnJvbSB0aGUgZ2l2ZW4gc2VydmVyLWZvcm1hdHRlZCBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogLSBTcGxpdHRpbmcgdGhlIGVtcHR5IHN0cmluZyBpcyBub3QgYWxsb3dlZCAoZm9yIG5vdyBhdCBsZWFzdCkuXHJcbiAgICAgKiAtIEVtcHR5IHNlZ21lbnRzIHdpdGhpbiB0aGUgc3RyaW5nIChlLmcuIGlmIHRoZXJlIGFyZSB0d28gY29uc2VjdXRpdmVcclxuICAgICAqICAgc2VwYXJhdG9ycykgYXJlIG5vdCBhbGxvd2VkLlxyXG4gICAgICpcclxuICAgICAqIFRPRE8oYi8zNzI0NDE1Nyk6IHdlIHNob3VsZCBtYWtlIHRoaXMgbW9yZSBzdHJpY3QuIFJpZ2h0IG5vdywgaXQgYWxsb3dzXHJcbiAgICAgKiBub24taWRlbnRpZmllciBwYXRoIGNvbXBvbmVudHMsIGV2ZW4gaWYgdGhleSBhcmVuJ3QgZXNjYXBlZC5cclxuICAgICAqL1xyXG4gICAgRmllbGRQYXRoLmZyb21TZXJ2ZXJGb3JtYXQgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIHZhciBzZWdtZW50cyA9IFtdO1xyXG4gICAgICAgIHZhciBjdXJyZW50ID0gJyc7XHJcbiAgICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICAgIHZhciBhZGRDdXJyZW50U2VnbWVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgZmllbGQgcGF0aCAoXCIgKyBwYXRoICsgXCIpLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwid2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNlZ21lbnRzLnB1c2goY3VycmVudCk7XHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSAnJztcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBpbkJhY2t0aWNrcyA9IGZhbHNlO1xyXG4gICAgICAgIHdoaWxlIChpIDwgcGF0aC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBwYXRoW2ldO1xyXG4gICAgICAgICAgICBpZiAoYyA9PT0gJ1xcXFwnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSArIDEgPT09IHBhdGgubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1BhdGggaGFzIHRyYWlsaW5nIGVzY2FwZSBjaGFyYWN0ZXI6ICcgKyBwYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBuZXh0ID0gcGF0aFtpICsgMV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIShuZXh0ID09PSAnXFxcXCcgfHwgbmV4dCA9PT0gJy4nIHx8IG5leHQgPT09ICdgJykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnUGF0aCBoYXMgaW52YWxpZCBlc2NhcGUgc2VxdWVuY2U6ICcgKyBwYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgKz0gbmV4dDtcclxuICAgICAgICAgICAgICAgIGkgKz0gMjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjID09PSAnYCcpIHtcclxuICAgICAgICAgICAgICAgIGluQmFja3RpY2tzID0gIWluQmFja3RpY2tzO1xyXG4gICAgICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGMgPT09ICcuJyAmJiAhaW5CYWNrdGlja3MpIHtcclxuICAgICAgICAgICAgICAgIGFkZEN1cnJlbnRTZWdtZW50KCk7XHJcbiAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ICs9IGM7XHJcbiAgICAgICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgYWRkQ3VycmVudFNlZ21lbnQoKTtcclxuICAgICAgICBpZiAoaW5CYWNrdGlja3MpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1VudGVybWluYXRlZCBgIGluIHBhdGg6ICcgKyBwYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZFBhdGgoc2VnbWVudHMpO1xyXG4gICAgfTtcclxuICAgIEZpZWxkUGF0aC5FTVBUWV9QQVRIID0gbmV3IEZpZWxkUGF0aChbXSk7XHJcbiAgICByZXR1cm4gRmllbGRQYXRoO1xyXG59KFBhdGgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBEb2N1bWVudEtleSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERvY3VtZW50S2V5KHBhdGgpIHtcclxuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xyXG4gICAgICAgIGFzc2VydChEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KHBhdGgpLCAnSW52YWxpZCBEb2N1bWVudEtleSB3aXRoIGFuIG9kZCBudW1iZXIgb2Ygc2VnbWVudHM6ICcgK1xyXG4gICAgICAgICAgICBwYXRoLnRvQXJyYXkoKS5qb2luKCcvJykpO1xyXG4gICAgfVxyXG4gICAgRG9jdW1lbnRLZXkucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyICE9PSBudWxsICYmIFJlc291cmNlUGF0aC5jb21wYXJhdG9yKHRoaXMucGF0aCwgb3RoZXIucGF0aCkgPT09IDApO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50S2V5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLnRvU3RyaW5nKCk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRLZXkuY29tcGFyYXRvciA9IGZ1bmN0aW9uIChrMSwgazIpIHtcclxuICAgICAgICByZXR1cm4gUmVzb3VyY2VQYXRoLmNvbXBhcmF0b3IoazEucGF0aCwgazIucGF0aCk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleSA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhdGgubGVuZ3RoICUgMiA9PT0gMDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgZG9jdW1lbnQga2V5IHdpdGggdGhlIGdpdmVuIHNlZ21lbnRzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXRoIFRoZSBzZWdtZW50cyBvZiB0aGUgcGF0aCB0byB0aGUgZG9jdW1lbnRcclxuICAgICAqIEByZXR1cm4gQSBuZXcgaW5zdGFuY2Ugb2YgRG9jdW1lbnRLZXlcclxuICAgICAqL1xyXG4gICAgRG9jdW1lbnRLZXkuZnJvbVNlZ21lbnRzID0gZnVuY3Rpb24gKHNlZ21lbnRzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEtleShuZXcgUmVzb3VyY2VQYXRoKHNlZ21lbnRzLnNsaWNlKCkpKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgZG9jdW1lbnQga2V5IHVzaW5nICcvJyB0byBzcGxpdCB0aGUgc3RyaW5nIGludG9cclxuICAgICAqIHNlZ21lbnRzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXRoIFRoZSBzbGFzaC1zZXBhcmF0ZWQgcGF0aCBzdHJpbmcgdG8gdGhlIGRvY3VtZW50XHJcbiAgICAgKiBAcmV0dXJuIEEgbmV3IGluc3RhbmNlIG9mIERvY3VtZW50S2V5XHJcbiAgICAgKi9cclxuICAgIERvY3VtZW50S2V5LmZyb21QYXRoU3RyaW5nID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50S2V5KFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHBhdGgpKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEtleS5FTVBUWSA9IG5ldyBEb2N1bWVudEtleShuZXcgUmVzb3VyY2VQYXRoKFtdKSk7XHJcbiAgICByZXR1cm4gRG9jdW1lbnRLZXk7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVGhlIHJlc3VsdCBvZiBhIGxvb2t1cCBmb3IgYSBnaXZlbiBwYXRoIG1heSBiZSBhbiBleGlzdGluZyBkb2N1bWVudCBvciBhXHJcbiAqIG1hcmtlciB0aGF0IHRoaXMgZG9jdW1lbnQgZG9lcyBub3QgZXhpc3QgYXQgYSBnaXZlbiB2ZXJzaW9uLlxyXG4gKi9cclxudmFyIE1heWJlRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNYXliZURvY3VtZW50KGtleSwgdmVyc2lvbikge1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb247XHJcbiAgICB9XHJcbiAgICBNYXliZURvY3VtZW50LmNvbXBhcmVCeUtleSA9IGZ1bmN0aW9uIChkMSwgZDIpIHtcclxuICAgICAgICByZXR1cm4gRG9jdW1lbnRLZXkuY29tcGFyYXRvcihkMS5rZXksIGQyLmtleSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1heWJlRG9jdW1lbnQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgZG9jdW1lbnQgaW4gRmlyZXN0b3JlIHdpdGggYSBrZXksIHZlcnNpb24sIGRhdGEgYW5kIHdoZXRoZXIgdGhlXHJcbiAqIGRhdGEgaGFzIGxvY2FsIG11dGF0aW9ucyBhcHBsaWVkIHRvIGl0LlxyXG4gKi9cclxudmFyIERvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRG9jdW1lbnQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBEb2N1bWVudChrZXksIHZlcnNpb24sIGRhdGEsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBrZXksIHZlcnNpb24pIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgX3RoaXMuaGFzTG9jYWxNdXRhdGlvbnMgPSAhIW9wdGlvbnMuaGFzTG9jYWxNdXRhdGlvbnM7XHJcbiAgICAgICAgX3RoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zID0gISFvcHRpb25zLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBEb2N1bWVudC5wcm90b3R5cGUuZmllbGQgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuZmllbGQocGF0aCk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnQucHJvdG90eXBlLmZpZWxkVmFsdWUgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQocGF0aCk7XHJcbiAgICAgICAgcmV0dXJuIGZpZWxkID8gZmllbGQudmFsdWUoKSA6IHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudC5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS52YWx1ZSgpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIERvY3VtZW50ICYmXHJcbiAgICAgICAgICAgIHRoaXMua2V5LmlzRXF1YWwob3RoZXIua2V5KSAmJlxyXG4gICAgICAgICAgICB0aGlzLnZlcnNpb24uaXNFcXVhbChvdGhlci52ZXJzaW9uKSAmJlxyXG4gICAgICAgICAgICB0aGlzLmRhdGEuaXNFcXVhbChvdGhlci5kYXRhKSAmJlxyXG4gICAgICAgICAgICB0aGlzLmhhc0xvY2FsTXV0YXRpb25zID09PSBvdGhlci5oYXNMb2NhbE11dGF0aW9ucyAmJlxyXG4gICAgICAgICAgICB0aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA9PT0gb3RoZXIuaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIChcIkRvY3VtZW50KFwiICsgdGhpcy5rZXkgKyBcIiwgXCIgKyB0aGlzLnZlcnNpb24gKyBcIiwgXCIgKyB0aGlzLmRhdGEudG9TdHJpbmcoKSArIFwiLCBcIiArXHJcbiAgICAgICAgICAgIChcIntoYXNMb2NhbE11dGF0aW9uczogXCIgKyB0aGlzLmhhc0xvY2FsTXV0YXRpb25zICsgXCJ9KSwgXCIpICtcclxuICAgICAgICAgICAgKFwie2hhc0NvbW1pdHRlZE11dGF0aW9uczogXCIgKyB0aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucyArIFwifSlcIikpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudC5wcm90b3R5cGUsIFwiaGFzUGVuZGluZ1dyaXRlc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhc0xvY2FsTXV0YXRpb25zIHx8IHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgRG9jdW1lbnQuY29tcGFyZUJ5RmllbGQgPSBmdW5jdGlvbiAoZmllbGQsIGQxLCBkMikge1xyXG4gICAgICAgIHZhciB2MSA9IGQxLmZpZWxkKGZpZWxkKTtcclxuICAgICAgICB2YXIgdjIgPSBkMi5maWVsZChmaWVsZCk7XHJcbiAgICAgICAgaWYgKHYxICE9PSB1bmRlZmluZWQgJiYgdjIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdjEuY29tcGFyZVRvKHYyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKFwiVHJ5aW5nIHRvIGNvbXBhcmUgZG9jdW1lbnRzIG9uIGZpZWxkcyB0aGF0IGRvbid0IGV4aXN0XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gRG9jdW1lbnQ7XHJcbn0oTWF5YmVEb2N1bWVudCkpO1xyXG4vKipcclxuICogQSBjbGFzcyByZXByZXNlbnRpbmcgYSBkZWxldGVkIGRvY3VtZW50LlxyXG4gKiBWZXJzaW9uIGlzIHNldCB0byAwIGlmIHdlIGRvbid0IHBvaW50IHRvIGFueSBzcGVjaWZpYyB0aW1lLCBvdGhlcndpc2UgaXRcclxuICogZGVub3RlcyB0aW1lIHdlIGtub3cgaXQgZGlkbid0IGV4aXN0IGF0LlxyXG4gKi9cclxudmFyIE5vRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhOb0RvY3VtZW50LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gTm9Eb2N1bWVudChrZXksIHZlcnNpb24sIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBrZXksIHZlcnNpb24pIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zID0gISEob3B0aW9ucyAmJiBvcHRpb25zLmhhc0NvbW1pdHRlZE11dGF0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgTm9Eb2N1bWVudC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiTm9Eb2N1bWVudChcIiArIHRoaXMua2V5ICsgXCIsIFwiICsgdGhpcy52ZXJzaW9uICsgXCIpXCI7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vRG9jdW1lbnQucHJvdG90eXBlLCBcImhhc1BlbmRpbmdXcml0ZXNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oYXNDb21taXR0ZWRNdXRhdGlvbnM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBOb0RvY3VtZW50LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIE5vRG9jdW1lbnQgJiZcclxuICAgICAgICAgICAgb3RoZXIuaGFzQ29tbWl0dGVkTXV0YXRpb25zID09PSB0aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucyAmJlxyXG4gICAgICAgICAgICBvdGhlci52ZXJzaW9uLmlzRXF1YWwodGhpcy52ZXJzaW9uKSAmJlxyXG4gICAgICAgICAgICBvdGhlci5rZXkuaXNFcXVhbCh0aGlzLmtleSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBOb0RvY3VtZW50O1xyXG59KE1heWJlRG9jdW1lbnQpKTtcclxuLyoqXHJcbiAqIEEgY2xhc3MgcmVwcmVzZW50aW5nIGFuIGV4aXN0aW5nIGRvY3VtZW50IHdob3NlIGRhdGEgaXMgdW5rbm93biAoZS5nLiBhXHJcbiAqIGRvY3VtZW50IHRoYXQgd2FzIHVwZGF0ZWQgd2l0aG91dCBhIGtub3duIGJhc2UgZG9jdW1lbnQpLlxyXG4gKi9cclxudmFyIFVua25vd25Eb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFVua25vd25Eb2N1bWVudCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFVua25vd25Eb2N1bWVudChrZXksIHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywga2V5LCB2ZXJzaW9uKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgVW5rbm93bkRvY3VtZW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gXCJVbmtub3duRG9jdW1lbnQoXCIgKyB0aGlzLmtleSArIFwiLCBcIiArIHRoaXMudmVyc2lvbiArIFwiKVwiO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbmtub3duRG9jdW1lbnQucHJvdG90eXBlLCBcImhhc1BlbmRpbmdXcml0ZXNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFVua25vd25Eb2N1bWVudC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBVbmtub3duRG9jdW1lbnQgJiZcclxuICAgICAgICAgICAgb3RoZXIudmVyc2lvbi5pc0VxdWFsKHRoaXMudmVyc2lvbikgJiZcclxuICAgICAgICAgICAgb3RoZXIua2V5LmlzRXF1YWwodGhpcy5rZXkpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVW5rbm93bkRvY3VtZW50O1xyXG59KE1heWJlRG9jdW1lbnQpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIEFuIGltbXV0YWJsZSBzb3J0ZWQgbWFwIGltcGxlbWVudGF0aW9uLCBiYXNlZCBvbiBhIExlZnQtbGVhbmluZyBSZWQtQmxhY2tcclxuLy8gdHJlZS5cclxudmFyIFNvcnRlZE1hcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNvcnRlZE1hcChjb21wYXJhdG9yLCByb290KSB7XHJcbiAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gY29tcGFyYXRvcjtcclxuICAgICAgICB0aGlzLnJvb3QgPSByb290ID8gcm9vdCA6IExMUkJOb2RlLkVNUFRZO1xyXG4gICAgfVxyXG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIG1hcCwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS92YWx1ZSBhZGRlZCBvciByZXBsYWNlZC5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuaW5zZXJ0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcCh0aGlzLmNvbXBhcmF0b3IsIHRoaXMucm9vdFxyXG4gICAgICAgICAgICAuaW5zZXJ0KGtleSwgdmFsdWUsIHRoaXMuY29tcGFyYXRvcilcclxuICAgICAgICAgICAgLmNvcHkobnVsbCwgbnVsbCwgTExSQk5vZGUuQkxBQ0ssIG51bGwsIG51bGwpKTtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgbWFwLCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IHJlbW92ZWQuXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcCh0aGlzLmNvbXBhcmF0b3IsIHRoaXMucm9vdFxyXG4gICAgICAgICAgICAucmVtb3ZlKGtleSwgdGhpcy5jb21wYXJhdG9yKVxyXG4gICAgICAgICAgICAuY29weShudWxsLCBudWxsLCBMTFJCTm9kZS5CTEFDSywgbnVsbCwgbnVsbCkpO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBub2RlIHdpdGggdGhlIGdpdmVuIGtleSwgb3IgbnVsbC5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBub2RlID0gdGhpcy5yb290O1xyXG4gICAgICAgIHdoaWxlICghbm9kZS5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgdmFyIGNtcCA9IHRoaXMuY29tcGFyYXRvcihrZXksIG5vZGUua2V5KTtcclxuICAgICAgICAgICAgaWYgKGNtcCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUudmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY21wIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUubGVmdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZWxlbWVudCBpbiB0aGlzIHNvcnRlZCBtYXAsIG9yIC0xIGlmIGl0IGRvZXNuJ3RcclxuICAgIC8vIGV4aXN0LlxyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIC8vIE51bWJlciBvZiBub2RlcyB0aGF0IHdlcmUgcHJ1bmVkIHdoZW4gZGVzY2VuZGluZyByaWdodFxyXG4gICAgICAgIHZhciBwcnVuZWROb2RlcyA9IDA7XHJcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLnJvb3Q7XHJcbiAgICAgICAgd2hpbGUgKCFub2RlLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICB2YXIgY21wID0gdGhpcy5jb21wYXJhdG9yKGtleSwgbm9kZS5rZXkpO1xyXG4gICAgICAgICAgICBpZiAoY21wID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJ1bmVkTm9kZXMgKyBub2RlLmxlZnQuc2l6ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjbXAgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gQ291bnQgYWxsIG5vZGVzIGxlZnQgb2YgdGhlIG5vZGUgcGx1cyB0aGUgbm9kZSBpdHNlbGZcclxuICAgICAgICAgICAgICAgIHBydW5lZE5vZGVzICs9IG5vZGUubGVmdC5zaXplICsgMTtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE5vZGUgbm90IGZvdW5kXHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yb290LmlzRW1wdHkoKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU29ydGVkTWFwLnByb3RvdHlwZSwgXCJzaXplXCIsIHtcclxuICAgICAgICAvLyBSZXR1cm5zIHRoZSB0b3RhbCBudW1iZXIgb2Ygbm9kZXMgaW4gdGhlIG1hcC5cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5zaXplO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLy8gUmV0dXJucyB0aGUgbWluaW11bSBrZXkgaW4gdGhlIG1hcC5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUubWluS2V5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QubWluS2V5KCk7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyB0aGUgbWF4aW11bSBrZXkgaW4gdGhlIG1hcC5cclxuICAgIFNvcnRlZE1hcC5wcm90b3R5cGUubWF4S2V5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QubWF4S2V5KCk7XHJcbiAgICB9O1xyXG4gICAgLy8gVHJhdmVyc2VzIHRoZSBtYXAgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxyXG4gICAgLy8gZm9yIGVhY2gga2V5L3ZhbHVlIHBhaXIuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxyXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XHJcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmlub3JkZXJUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5pbm9yZGVyVHJhdmVyc2FsKGFjdGlvbik7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkTWFwLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgdGhpcy5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgICAgIGZuKGssIHYpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gVHJhdmVyc2VzIHRoZSBtYXAgaW4gcmV2ZXJzZSBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uXHJcbiAgICAvLyBmdW5jdGlvbiBmb3IgZWFjaCBrZXkvdmFsdWUgcGFpci4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzXHJcbiAgICAvLyBhYm9ydGVkLlxyXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XHJcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLnJldmVyc2VUcmF2ZXJzYWwgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5yZXZlcnNlVHJhdmVyc2FsKGFjdGlvbik7XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyBhbiBpdGVyYXRvciBvdmVyIHRoZSBTb3J0ZWRNYXAuXHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmdldEl0ZXJhdG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU29ydGVkTWFwSXRlcmF0b3IodGhpcy5yb290LCBudWxsLCB0aGlzLmNvbXBhcmF0b3IsIGZhbHNlKTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmdldEl0ZXJhdG9yRnJvbSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcEl0ZXJhdG9yKHRoaXMucm9vdCwga2V5LCB0aGlzLmNvbXBhcmF0b3IsIGZhbHNlKTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmdldFJldmVyc2VJdGVyYXRvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNvcnRlZE1hcEl0ZXJhdG9yKHRoaXMucm9vdCwgbnVsbCwgdGhpcy5jb21wYXJhdG9yLCB0cnVlKTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRNYXAucHJvdG90eXBlLmdldFJldmVyc2VJdGVyYXRvckZyb20gPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXBJdGVyYXRvcih0aGlzLnJvb3QsIGtleSwgdGhpcy5jb21wYXJhdG9yLCB0cnVlKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU29ydGVkTWFwO1xyXG59KCkpOyAvLyBlbmQgU29ydGVkTWFwXHJcbi8vIEFuIGl0ZXJhdG9yIG92ZXIgYW4gTExSQk5vZGUuXHJcbnZhciBTb3J0ZWRNYXBJdGVyYXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNvcnRlZE1hcEl0ZXJhdG9yKG5vZGUsIHN0YXJ0S2V5LCBjb21wYXJhdG9yLCBpc1JldmVyc2UpIHtcclxuICAgICAgICB0aGlzLmlzUmV2ZXJzZSA9IGlzUmV2ZXJzZTtcclxuICAgICAgICB0aGlzLm5vZGVTdGFjayA9IFtdO1xyXG4gICAgICAgIHZhciBjbXAgPSAxO1xyXG4gICAgICAgIHdoaWxlICghbm9kZS5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgY21wID0gc3RhcnRLZXkgPyBjb21wYXJhdG9yKG5vZGUua2V5LCBzdGFydEtleSkgOiAxO1xyXG4gICAgICAgICAgICAvLyBmbGlwIHRoZSBjb21wYXJpc29uIGlmIHdlJ3JlIGdvaW5nIGluIHJldmVyc2VcclxuICAgICAgICAgICAgaWYgKGlzUmV2ZXJzZSlcclxuICAgICAgICAgICAgICAgIGNtcCAqPSAtMTtcclxuICAgICAgICAgICAgaWYgKGNtcCA8IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgbm9kZSBpcyBsZXNzIHRoYW4gb3VyIHN0YXJ0IGtleS4gaWdub3JlIGl0XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JldmVyc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY21wID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIG5vZGUgaXMgZXhhY3RseSBlcXVhbCB0byBvdXIgc3RhcnQga2V5LiBQdXNoIGl0IG9uIHRoZSBzdGFjayxcclxuICAgICAgICAgICAgICAgIC8vIGJ1dCBzdG9wIGl0ZXJhdGluZztcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrLnB1c2gobm9kZSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgbm9kZSBpcyBncmVhdGVyIHRoYW4gb3VyIHN0YXJ0IGtleSwgYWRkIGl0IHRvIHRoZSBzdGFjayBhbmQgbW92ZVxyXG4gICAgICAgICAgICAgICAgLy8gdG8gdGhlIG5leHQgb25lXHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNSZXZlcnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5vZGUucmlnaHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgU29ydGVkTWFwSXRlcmF0b3IucHJvdG90eXBlLmdldE5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMubm9kZVN0YWNrLmxlbmd0aCA+IDAsICdnZXROZXh0KCkgY2FsbGVkIG9uIGl0ZXJhdG9yIHdoZW4gaGFzTmV4dCgpIGlzIGZhbHNlLicpO1xyXG4gICAgICAgIHZhciBub2RlID0gdGhpcy5ub2RlU3RhY2sucG9wKCk7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHsga2V5OiBub2RlLmtleSwgdmFsdWU6IG5vZGUudmFsdWUgfTtcclxuICAgICAgICBpZiAodGhpcy5pc1JldmVyc2UpIHtcclxuICAgICAgICAgICAgbm9kZSA9IG5vZGUubGVmdDtcclxuICAgICAgICAgICAgd2hpbGUgKCFub2RlLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlU3RhY2sucHVzaChub2RlKTtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLnJpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBub2RlID0gbm9kZS5yaWdodDtcclxuICAgICAgICAgICAgd2hpbGUgKCFub2RlLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlU3RhY2sucHVzaChub2RlKTtcclxuICAgICAgICAgICAgICAgIG5vZGUgPSBub2RlLmxlZnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRNYXBJdGVyYXRvci5wcm90b3R5cGUuaGFzTmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ub2RlU3RhY2subGVuZ3RoID4gMDtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRNYXBJdGVyYXRvci5wcm90b3R5cGUucGVlayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5ub2RlU3RhY2subGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB2YXIgbm9kZSA9IHRoaXMubm9kZVN0YWNrW3RoaXMubm9kZVN0YWNrLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgIHJldHVybiB7IGtleTogbm9kZS5rZXksIHZhbHVlOiBub2RlLnZhbHVlIH07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNvcnRlZE1hcEl0ZXJhdG9yO1xyXG59KCkpOyAvLyBlbmQgU29ydGVkTWFwSXRlcmF0b3JcclxuLy8gUmVwcmVzZW50cyBhIG5vZGUgaW4gYSBMZWZ0LWxlYW5pbmcgUmVkLUJsYWNrIHRyZWUuXHJcbnZhciBMTFJCTm9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExMUkJOb2RlKGtleSwgdmFsdWUsIGNvbG9yLCBsZWZ0LCByaWdodCkge1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICB0aGlzLmNvbG9yID0gY29sb3IgIT0gbnVsbCA/IGNvbG9yIDogTExSQk5vZGUuUkVEO1xyXG4gICAgICAgIHRoaXMubGVmdCA9IGxlZnQgIT0gbnVsbCA/IGxlZnQgOiBMTFJCTm9kZS5FTVBUWTtcclxuICAgICAgICB0aGlzLnJpZ2h0ID0gcmlnaHQgIT0gbnVsbCA/IHJpZ2h0IDogTExSQk5vZGUuRU1QVFk7XHJcbiAgICAgICAgdGhpcy5zaXplID0gdGhpcy5sZWZ0LnNpemUgKyAxICsgdGhpcy5yaWdodC5zaXplO1xyXG4gICAgfVxyXG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIGN1cnJlbnQgbm9kZSwgb3B0aW9uYWxseSByZXBsYWNpbmcgcGllY2VzIG9mIGl0LlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29sb3IsIGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBMTFJCTm9kZShrZXkgIT0gbnVsbCA/IGtleSA6IHRoaXMua2V5LCB2YWx1ZSAhPSBudWxsID8gdmFsdWUgOiB0aGlzLnZhbHVlLCBjb2xvciAhPSBudWxsID8gY29sb3IgOiB0aGlzLmNvbG9yLCBsZWZ0ICE9IG51bGwgPyBsZWZ0IDogdGhpcy5sZWZ0LCByaWdodCAhPSBudWxsID8gcmlnaHQgOiB0aGlzLnJpZ2h0KTtcclxuICAgIH07XHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgLy8gVHJhdmVyc2VzIHRoZSB0cmVlIGluIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb24gZnVuY3Rpb25cclxuICAgIC8vIGZvciBlYWNoIG5vZGUuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxyXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XHJcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuaW5vcmRlclRyYXZlcnNhbCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMubGVmdC5pbm9yZGVyVHJhdmVyc2FsKGFjdGlvbikgfHxcclxuICAgICAgICAgICAgYWN0aW9uKHRoaXMua2V5LCB0aGlzLnZhbHVlKSB8fFxyXG4gICAgICAgICAgICB0aGlzLnJpZ2h0Lmlub3JkZXJUcmF2ZXJzYWwoYWN0aW9uKSk7XHJcbiAgICB9O1xyXG4gICAgLy8gVHJhdmVyc2VzIHRoZSB0cmVlIGluIHJldmVyc2Uga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvblxyXG4gICAgLy8gZnVuY3Rpb24gZm9yIGVhY2ggbm9kZS4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXHJcbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcclxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5yZXZlcnNlVHJhdmVyc2FsID0gZnVuY3Rpb24gKGFjdGlvbikge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5yaWdodC5yZXZlcnNlVHJhdmVyc2FsKGFjdGlvbikgfHxcclxuICAgICAgICAgICAgYWN0aW9uKHRoaXMua2V5LCB0aGlzLnZhbHVlKSB8fFxyXG4gICAgICAgICAgICB0aGlzLmxlZnQucmV2ZXJzZVRyYXZlcnNhbChhY3Rpb24pKTtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIHRoZSBtaW5pbXVtIG5vZGUgaW4gdGhlIHRyZWUuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUubWluID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmxlZnQuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVmdC5taW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gUmV0dXJucyB0aGUgbWF4aW11bSBrZXkgaW4gdGhlIHRyZWUuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUubWluS2V5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1pbigpLmtleTtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5tYXhLZXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucmlnaHQuaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmtleTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJpZ2h0Lm1heEtleSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIG5ldyB0cmVlLCB3aXRoIHRoZSBrZXkvdmFsdWUgYWRkZWQuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUuaW5zZXJ0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbXBhcmF0b3IpIHtcclxuICAgICAgICB2YXIgbiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNtcCA9IGNvbXBhcmF0b3Ioa2V5LCBuLmtleSk7XHJcbiAgICAgICAgaWYgKGNtcCA8IDApIHtcclxuICAgICAgICAgICAgbiA9IG4uY29weShudWxsLCBudWxsLCBudWxsLCBuLmxlZnQuaW5zZXJ0KGtleSwgdmFsdWUsIGNvbXBhcmF0b3IpLCBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY21wID09PSAwKSB7XHJcbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgdmFsdWUsIG51bGwsIG51bGwsIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbiA9IG4uY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBuLnJpZ2h0Lmluc2VydChrZXksIHZhbHVlLCBjb21wYXJhdG9yKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuLmZpeFVwKCk7XHJcbiAgICB9O1xyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLnJlbW92ZU1pbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5sZWZ0LmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gTExSQk5vZGUuRU1QVFk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICBpZiAoIW4ubGVmdC5pc1JlZCgpICYmICFuLmxlZnQubGVmdC5pc1JlZCgpKVxyXG4gICAgICAgICAgICBuID0gbi5tb3ZlUmVkTGVmdCgpO1xyXG4gICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbi5sZWZ0LnJlbW92ZU1pbigpLCBudWxsKTtcclxuICAgICAgICByZXR1cm4gbi5maXhVcCgpO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgbmV3IHRyZWUsIHdpdGggdGhlIHNwZWNpZmllZCBpdGVtIHJlbW92ZWQuXHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGtleSwgY29tcGFyYXRvcikge1xyXG4gICAgICAgIHZhciBzbWFsbGVzdDtcclxuICAgICAgICB2YXIgbiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNvbXBhcmF0b3Ioa2V5LCBuLmtleSkgPCAwKSB7XHJcbiAgICAgICAgICAgIGlmICghbi5sZWZ0LmlzRW1wdHkoKSAmJiAhbi5sZWZ0LmlzUmVkKCkgJiYgIW4ubGVmdC5sZWZ0LmlzUmVkKCkpIHtcclxuICAgICAgICAgICAgICAgIG4gPSBuLm1vdmVSZWRMZWZ0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbiA9IG4uY29weShudWxsLCBudWxsLCBudWxsLCBuLmxlZnQucmVtb3ZlKGtleSwgY29tcGFyYXRvciksIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKG4ubGVmdC5pc1JlZCgpKVxyXG4gICAgICAgICAgICAgICAgbiA9IG4ucm90YXRlUmlnaHQoKTtcclxuICAgICAgICAgICAgaWYgKCFuLnJpZ2h0LmlzRW1wdHkoKSAmJiAhbi5yaWdodC5pc1JlZCgpICYmICFuLnJpZ2h0LmxlZnQuaXNSZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgbiA9IG4ubW92ZVJlZFJpZ2h0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbXBhcmF0b3Ioa2V5LCBuLmtleSkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChuLnJpZ2h0LmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBMTFJCTm9kZS5FTVBUWTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNtYWxsZXN0ID0gbi5yaWdodC5taW4oKTtcclxuICAgICAgICAgICAgICAgICAgICBuID0gbi5jb3B5KHNtYWxsZXN0LmtleSwgc21hbGxlc3QudmFsdWUsIG51bGwsIG51bGwsIG4ucmlnaHQucmVtb3ZlTWluKCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG4gPSBuLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbi5yaWdodC5yZW1vdmUoa2V5LCBjb21wYXJhdG9yKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuLmZpeFVwKCk7XHJcbiAgICB9O1xyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmlzUmVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yO1xyXG4gICAgfTtcclxuICAgIC8vIFJldHVybnMgbmV3IHRyZWUgYWZ0ZXIgcGVyZm9ybWluZyBhbnkgbmVlZGVkIHJvdGF0aW9ucy5cclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5maXhVcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKG4ucmlnaHQuaXNSZWQoKSAmJiAhbi5sZWZ0LmlzUmVkKCkpXHJcbiAgICAgICAgICAgIG4gPSBuLnJvdGF0ZUxlZnQoKTtcclxuICAgICAgICBpZiAobi5sZWZ0LmlzUmVkKCkgJiYgbi5sZWZ0LmxlZnQuaXNSZWQoKSlcclxuICAgICAgICAgICAgbiA9IG4ucm90YXRlUmlnaHQoKTtcclxuICAgICAgICBpZiAobi5sZWZ0LmlzUmVkKCkgJiYgbi5yaWdodC5pc1JlZCgpKVxyXG4gICAgICAgICAgICBuID0gbi5jb2xvckZsaXAoKTtcclxuICAgICAgICByZXR1cm4gbjtcclxuICAgIH07XHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUubW92ZVJlZExlZnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG4gPSB0aGlzLmNvbG9yRmxpcCgpO1xyXG4gICAgICAgIGlmIChuLnJpZ2h0LmxlZnQuaXNSZWQoKSkge1xyXG4gICAgICAgICAgICBuID0gbi5jb3B5KG51bGwsIG51bGwsIG51bGwsIG51bGwsIG4ucmlnaHQucm90YXRlUmlnaHQoKSk7XHJcbiAgICAgICAgICAgIG4gPSBuLnJvdGF0ZUxlZnQoKTtcclxuICAgICAgICAgICAgbiA9IG4uY29sb3JGbGlwKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuO1xyXG4gICAgfTtcclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5tb3ZlUmVkUmlnaHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG4gPSB0aGlzLmNvbG9yRmxpcCgpO1xyXG4gICAgICAgIGlmIChuLmxlZnQubGVmdC5pc1JlZCgpKSB7XHJcbiAgICAgICAgICAgIG4gPSBuLnJvdGF0ZVJpZ2h0KCk7XHJcbiAgICAgICAgICAgIG4gPSBuLmNvbG9yRmxpcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbjtcclxuICAgIH07XHJcbiAgICBMTFJCTm9kZS5wcm90b3R5cGUucm90YXRlTGVmdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbmwgPSB0aGlzLmNvcHkobnVsbCwgbnVsbCwgTExSQk5vZGUuUkVELCBudWxsLCB0aGlzLnJpZ2h0LmxlZnQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgbmwsIG51bGwpO1xyXG4gICAgfTtcclxuICAgIExMUkJOb2RlLnByb3RvdHlwZS5yb3RhdGVSaWdodCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbnIgPSB0aGlzLmNvcHkobnVsbCwgbnVsbCwgTExSQk5vZGUuUkVELCB0aGlzLmxlZnQucmlnaHQsIG51bGwpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxlZnQuY29weShudWxsLCBudWxsLCB0aGlzLmNvbG9yLCBudWxsLCBucik7XHJcbiAgICB9O1xyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmNvbG9yRmxpcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbGVmdCA9IHRoaXMubGVmdC5jb3B5KG51bGwsIG51bGwsICF0aGlzLmxlZnQuY29sb3IsIG51bGwsIG51bGwpO1xyXG4gICAgICAgIHZhciByaWdodCA9IHRoaXMucmlnaHQuY29weShudWxsLCBudWxsLCAhdGhpcy5yaWdodC5jb2xvciwgbnVsbCwgbnVsbCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weShudWxsLCBudWxsLCAhdGhpcy5jb2xvciwgbGVmdCwgcmlnaHQpO1xyXG4gICAgfTtcclxuICAgIC8vIEZvciB0ZXN0aW5nLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmNoZWNrTWF4RGVwdGggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGJsYWNrRGVwdGggPSB0aGlzLmNoZWNrKCk7XHJcbiAgICAgICAgaWYgKE1hdGgucG93KDIuMCwgYmxhY2tEZXB0aCkgPD0gdGhpcy5zaXplICsgMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gSW4gYSBiYWxhbmNlZCBSQiB0cmVlLCB0aGUgYmxhY2stZGVwdGggKG51bWJlciBvZiBibGFjayBub2RlcykgZnJvbSByb290IHRvXHJcbiAgICAvLyBsZWF2ZXMgaXMgZXF1YWwgb24gYm90aCBzaWRlcy4gIFRoaXMgZnVuY3Rpb24gdmVyaWZpZXMgdGhhdCBvciBhc3NlcnRzLlxyXG4gICAgTExSQk5vZGUucHJvdG90eXBlLmNoZWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzUmVkKCkgJiYgdGhpcy5sZWZ0LmlzUmVkKCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgZmFpbCgnUmVkIG5vZGUgaGFzIHJlZCBjaGlsZCgnICsgdGhpcy5rZXkgKyAnLCcgKyB0aGlzLnZhbHVlICsgJyknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucmlnaHQuaXNSZWQoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBmYWlsKCdSaWdodCBjaGlsZCBvZiAoJyArIHRoaXMua2V5ICsgJywnICsgdGhpcy52YWx1ZSArICcpIGlzIHJlZCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYmxhY2tEZXB0aCA9IHRoaXMubGVmdC5jaGVjaygpO1xyXG4gICAgICAgIGlmIChibGFja0RlcHRoICE9PSB0aGlzLnJpZ2h0LmNoZWNrKCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgZmFpbCgnQmxhY2sgZGVwdGhzIGRpZmZlcicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGJsYWNrRGVwdGggKyAodGhpcy5pc1JlZCgpID8gMCA6IDEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IEVtcHR5IG5vZGUgaXMgc2hhcmVkIGJldHdlZW4gYWxsIExMUkIgdHJlZXMuXHJcbiAgICBMTFJCTm9kZS5FTVBUWSA9IG51bGw7XHJcbiAgICBMTFJCTm9kZS5SRUQgPSB0cnVlO1xyXG4gICAgTExSQk5vZGUuQkxBQ0sgPSBmYWxzZTtcclxuICAgIHJldHVybiBMTFJCTm9kZTtcclxufSgpKTsgLy8gZW5kIExMUkJOb2RlXHJcbi8vIFJlcHJlc2VudHMgYW4gZW1wdHkgbm9kZSAoYSBsZWFmIG5vZGUgaW4gdGhlIFJlZC1CbGFjayBUcmVlKS5cclxudmFyIExMUkJFbXB0eU5vZGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMTFJCRW1wdHlOb2RlKCkge1xyXG4gICAgICAgIHRoaXMuc2l6ZSA9IDA7XHJcbiAgICB9XHJcbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgY3VycmVudCBub2RlLlxyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb2xvciwgbGVmdCwgcmlnaHQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS92YWx1ZSBhZGRlZC5cclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb21wYXJhdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBMTFJCTm9kZShrZXksIHZhbHVlKTtcclxuICAgIH07XHJcbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGtleSwgY29tcGFyYXRvcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUuaW5vcmRlclRyYXZlcnNhbCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUucmV2ZXJzZVRyYXZlcnNhbCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgTExSQkVtcHR5Tm9kZS5wcm90b3R5cGUubWluS2V5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLm1heEtleSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5pc1JlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgLy8gRm9yIHRlc3RpbmcuXHJcbiAgICBMTFJCRW1wdHlOb2RlLnByb3RvdHlwZS5jaGVja01heERlcHRoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIExMUkJFbXB0eU5vZGUucHJvdG90eXBlLmNoZWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMTFJCRW1wdHlOb2RlO1xyXG59KCkpOyAvLyBlbmQgTExSQkVtcHR5Tm9kZVxyXG5MTFJCTm9kZS5FTVBUWSA9IG5ldyBMTFJCRW1wdHlOb2RlKCk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgVHlwZU9yZGVyO1xyXG4oZnVuY3Rpb24gKFR5cGVPcmRlcikge1xyXG4gICAgLy8gVGhpcyBvcmRlciBpcyBkZWZpbmVkIGJ5IHRoZSBiYWNrZW5kLlxyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIk51bGxWYWx1ZVwiXSA9IDBdID0gXCJOdWxsVmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJCb29sZWFuVmFsdWVcIl0gPSAxXSA9IFwiQm9vbGVhblZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiTnVtYmVyVmFsdWVcIl0gPSAyXSA9IFwiTnVtYmVyVmFsdWVcIjtcclxuICAgIFR5cGVPcmRlcltUeXBlT3JkZXJbXCJUaW1lc3RhbXBWYWx1ZVwiXSA9IDNdID0gXCJUaW1lc3RhbXBWYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIlN0cmluZ1ZhbHVlXCJdID0gNF0gPSBcIlN0cmluZ1ZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiQmxvYlZhbHVlXCJdID0gNV0gPSBcIkJsb2JWYWx1ZVwiO1xyXG4gICAgVHlwZU9yZGVyW1R5cGVPcmRlcltcIlJlZlZhbHVlXCJdID0gNl0gPSBcIlJlZlZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiR2VvUG9pbnRWYWx1ZVwiXSA9IDddID0gXCJHZW9Qb2ludFZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiQXJyYXlWYWx1ZVwiXSA9IDhdID0gXCJBcnJheVZhbHVlXCI7XHJcbiAgICBUeXBlT3JkZXJbVHlwZU9yZGVyW1wiT2JqZWN0VmFsdWVcIl0gPSA5XSA9IFwiT2JqZWN0VmFsdWVcIjtcclxufSkoVHlwZU9yZGVyIHx8IChUeXBlT3JkZXIgPSB7fSkpO1xyXG4vKiogRGVmaW5lcyB0aGUgcmV0dXJuIHZhbHVlIGZvciBwZW5kaW5nIHNlcnZlciB0aW1lc3RhbXBzLiAqL1xyXG52YXIgU2VydmVyVGltZXN0YW1wQmVoYXZpb3I7XHJcbihmdW5jdGlvbiAoU2VydmVyVGltZXN0YW1wQmVoYXZpb3IpIHtcclxuICAgIFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yW1NlcnZlclRpbWVzdGFtcEJlaGF2aW9yW1wiRGVmYXVsdFwiXSA9IDBdID0gXCJEZWZhdWx0XCI7XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcltTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcltcIkVzdGltYXRlXCJdID0gMV0gPSBcIkVzdGltYXRlXCI7XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcltTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvcltcIlByZXZpb3VzXCJdID0gMl0gPSBcIlByZXZpb3VzXCI7XHJcbn0pKFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yIHx8IChTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvciA9IHt9KSk7XHJcbi8qKiBIb2xkcyBwcm9wZXJ0aWVzIHRoYXQgZGVmaW5lIGZpZWxkIHZhbHVlIGRlc2VyaWFsaXphdGlvbiBvcHRpb25zLiAqL1xyXG52YXIgRmllbGRWYWx1ZU9wdGlvbnMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaWVsZFZhbHVlT3B0aW9ucyhzZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvciwgdGltZXN0YW1wc0luU25hcHNob3RzKSB7XHJcbiAgICAgICAgdGhpcy5zZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvciA9IHNlcnZlclRpbWVzdGFtcEJlaGF2aW9yO1xyXG4gICAgICAgIHRoaXMudGltZXN0YW1wc0luU25hcHNob3RzID0gdGltZXN0YW1wc0luU25hcHNob3RzO1xyXG4gICAgfVxyXG4gICAgRmllbGRWYWx1ZU9wdGlvbnMuZnJvbVNuYXBzaG90T3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zLCB0aW1lc3RhbXBzSW5TbmFwc2hvdHMpIHtcclxuICAgICAgICBzd2l0Y2ggKG9wdGlvbnMuc2VydmVyVGltZXN0YW1wcykge1xyXG4gICAgICAgICAgICBjYXNlICdlc3RpbWF0ZSc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZpZWxkVmFsdWVPcHRpb25zKFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yLkVzdGltYXRlLCB0aW1lc3RhbXBzSW5TbmFwc2hvdHMpO1xyXG4gICAgICAgICAgICBjYXNlICdwcmV2aW91cyc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZpZWxkVmFsdWVPcHRpb25zKFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yLlByZXZpb3VzLCB0aW1lc3RhbXBzSW5TbmFwc2hvdHMpO1xyXG4gICAgICAgICAgICBjYXNlICdub25lJzogLy8gRmFsbC10aHJvdWdoIGludGVuZGVkLlxyXG4gICAgICAgICAgICBjYXNlIHVuZGVmaW5lZDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmllbGRWYWx1ZU9wdGlvbnMoU2VydmVyVGltZXN0YW1wQmVoYXZpb3IuRGVmYXVsdCwgdGltZXN0YW1wc0luU25hcHNob3RzKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdmcm9tU25hcHNob3RPcHRpb25zKCkgY2FsbGVkIHdpdGggaW52YWxpZCBvcHRpb25zLicpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gRmllbGRWYWx1ZU9wdGlvbnM7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIGZpZWxkIHZhbHVlIHJlcHJlc2VudHMgYSBkYXRhdHlwZSBhcyBzdG9yZWQgYnkgRmlyZXN0b3JlLlxyXG4gKi9cclxudmFyIEZpZWxkVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaWVsZFZhbHVlKCkge1xyXG4gICAgfVxyXG4gICAgRmllbGRWYWx1ZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHZhbCA9IHRoaXMudmFsdWUoKTtcclxuICAgICAgICByZXR1cm4gdmFsID09PSBudWxsID8gJ251bGwnIDogdmFsLnRvU3RyaW5nKCk7XHJcbiAgICB9O1xyXG4gICAgRmllbGRWYWx1ZS5wcm90b3R5cGUuZGVmYXVsdENvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnR5cGVPcmRlciAhPT0gb3RoZXIudHlwZU9yZGVyLCAnRGVmYXVsdCBjb21wYXJlVG8gc2hvdWxkIG5vdCBiZSB1c2VkIGZvciB2YWx1ZXMgb2Ygc2FtZSB0eXBlLicpO1xyXG4gICAgICAgIHZhciBjbXAgPSBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMudHlwZU9yZGVyLCBvdGhlci50eXBlT3JkZXIpO1xyXG4gICAgICAgIHJldHVybiBjbXA7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpZWxkVmFsdWU7XHJcbn0oKSk7XHJcbnZhciBOdWxsVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhOdWxsVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBOdWxsVmFsdWUoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuTnVsbFZhbHVlO1xyXG4gICAgICAgIC8vIGludGVybmFsVmFsdWUgaXMgdW51c2VkIGJ1dCB3ZSBhZGQgaXQgdG8gd29yayBhcm91bmRcclxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L1R5cGVTY3JpcHQvaXNzdWVzLzE1NTg1XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgTnVsbFZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgTnVsbFZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG90aGVyIGluc3RhbmNlb2YgTnVsbFZhbHVlO1xyXG4gICAgfTtcclxuICAgIE51bGxWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgTnVsbFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgIH07XHJcbiAgICBOdWxsVmFsdWUuSU5TVEFOQ0UgPSBuZXcgTnVsbFZhbHVlKCk7XHJcbiAgICByZXR1cm4gTnVsbFZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxudmFyIEJvb2xlYW5WYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEJvb2xlYW5WYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEJvb2xlYW5WYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuQm9vbGVhblZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEJvb2xlYW5WYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWU7XHJcbiAgICB9O1xyXG4gICAgQm9vbGVhblZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIEJvb2xlYW5WYWx1ZSAmJlxyXG4gICAgICAgICAgICB0aGlzLmludGVybmFsVmFsdWUgPT09IG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIEJvb2xlYW5WYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgQm9vbGVhblZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcmltaXRpdmVDb21wYXJhdG9yKHRoaXMsIG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICB9O1xyXG4gICAgQm9vbGVhblZhbHVlLm9mID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlID8gQm9vbGVhblZhbHVlLlRSVUUgOiBCb29sZWFuVmFsdWUuRkFMU0U7XHJcbiAgICB9O1xyXG4gICAgQm9vbGVhblZhbHVlLlRSVUUgPSBuZXcgQm9vbGVhblZhbHVlKHRydWUpO1xyXG4gICAgQm9vbGVhblZhbHVlLkZBTFNFID0gbmV3IEJvb2xlYW5WYWx1ZShmYWxzZSk7XHJcbiAgICByZXR1cm4gQm9vbGVhblZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxuLyoqIEJhc2UgY2xhc3MgZm9yIEludGVnZXJWYWx1ZSBhbmQgRG91YmxlVmFsdWUuICovXHJcbnZhciBOdW1iZXJWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKE51bWJlclZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gTnVtYmVyVmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLk51bWJlclZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE51bWJlclZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZTtcclxuICAgIH07XHJcbiAgICBOdW1iZXJWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgTnVtYmVyVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bWVyaWNDb21wYXJhdG9yKHRoaXMuaW50ZXJuYWxWYWx1ZSwgb3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBOdW1iZXJWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbi8qKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGNvbXBhcmUgZG91YmxlcyAodXNpbmcgRmlyZXN0b3JlIHNlbWFudGljcyBmb3IgTmFOKS4gKi9cclxuZnVuY3Rpb24gbnVtZXJpY0NvbXBhcmF0b3IobGVmdCwgcmlnaHQpIHtcclxuICAgIGlmIChsZWZ0IDwgcmlnaHQpIHtcclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChsZWZ0ID4gcmlnaHQpIHtcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGxlZnQgPT09IHJpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBvbmUgb3IgYm90aCBhcmUgTmFOLlxyXG4gICAgICAgIGlmIChpc05hTihsZWZ0KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaXNOYU4ocmlnaHQpID8gMCA6IC0xO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIGNoZWNrIG51bWJlcnMgZm9yIGVxdWFsaXR5IHVzaW5nIEZpcmVzdG9yZSBzZW1hbnRpY3NcclxuICogKE5hTiA9PT0gTmFOLCAtMC4wICE9PSAwLjApLlxyXG4gKi9cclxuZnVuY3Rpb24gbnVtZXJpY0VxdWFscyhsZWZ0LCByaWdodCkge1xyXG4gICAgLy8gSW1wbGVtZW50ZWQgYmFzZWQgb24gT2JqZWN0LmlzKCkgcG9seWZpbGwgZnJvbVxyXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2lzXHJcbiAgICBpZiAobGVmdCA9PT0gcmlnaHQpIHtcclxuICAgICAgICAvLyArMCAhPSAtMFxyXG4gICAgICAgIHJldHVybiBsZWZ0ICE9PSAwIHx8IDEgLyBsZWZ0ID09PSAxIC8gcmlnaHQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBOYU4gPT0gTmFOXHJcbiAgICAgICAgcmV0dXJuIGxlZnQgIT09IGxlZnQgJiYgcmlnaHQgIT09IHJpZ2h0O1xyXG4gICAgfVxyXG59XHJcbnZhciBJbnRlZ2VyVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhJbnRlZ2VyVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBJbnRlZ2VyVmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBpbnRlcm5hbFZhbHVlKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgSW50ZWdlclZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgLy8gTk9URTogRG91YmxlVmFsdWUgYW5kIEludGVnZXJWYWx1ZSBpbnN0YW5jZXMgbWF5IGNvbXBhcmVUbygpIHRoZSBzYW1lLFxyXG4gICAgICAgIC8vIGJ1dCB0aGF0IGRvZXNuJ3QgbWFrZSB0aGVtIGVxdWFsIHZpYSBpc0VxdWFsKCkuXHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgSW50ZWdlclZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudW1lcmljRXF1YWxzKHRoaXMuaW50ZXJuYWxWYWx1ZSwgb3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBJbnRlZ2VyVmFsdWU7XHJcbn0oTnVtYmVyVmFsdWUpKTtcclxudmFyIERvdWJsZVZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRG91YmxlVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBEb3VibGVWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgaW50ZXJuYWxWYWx1ZSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBEb3VibGVWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIC8vIE5PVEU6IERvdWJsZVZhbHVlIGFuZCBJbnRlZ2VyVmFsdWUgaW5zdGFuY2VzIG1heSBjb21wYXJlVG8oKSB0aGUgc2FtZSxcclxuICAgICAgICAvLyBidXQgdGhhdCBkb2Vzbid0IG1ha2UgdGhlbSBlcXVhbCB2aWEgaXNFcXVhbCgpLlxyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIERvdWJsZVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudW1lcmljRXF1YWxzKHRoaXMuaW50ZXJuYWxWYWx1ZSwgb3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERvdWJsZVZhbHVlLk5BTiA9IG5ldyBEb3VibGVWYWx1ZShOYU4pO1xyXG4gICAgRG91YmxlVmFsdWUuUE9TSVRJVkVfSU5GSU5JVFkgPSBuZXcgRG91YmxlVmFsdWUoSW5maW5pdHkpO1xyXG4gICAgRG91YmxlVmFsdWUuTkVHQVRJVkVfSU5GSU5JVFkgPSBuZXcgRG91YmxlVmFsdWUoLUluZmluaXR5KTtcclxuICAgIHJldHVybiBEb3VibGVWYWx1ZTtcclxufShOdW1iZXJWYWx1ZSkpO1xyXG4vLyBUT0RPKGIvMzcyNjc4ODUpOiBBZGQgdHJ1bmNhdGlvbiBzdXBwb3J0XHJcbnZhciBTdHJpbmdWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFN0cmluZ1ZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU3RyaW5nVmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLlN0cmluZ1ZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFN0cmluZ1ZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZTtcclxuICAgIH07XHJcbiAgICBTdHJpbmdWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBTdHJpbmdWYWx1ZSAmJiB0aGlzLmludGVybmFsVmFsdWUgPT09IG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIFN0cmluZ1ZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBTdHJpbmdWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLmludGVybmFsVmFsdWUsIG90aGVyLmludGVybmFsVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU3RyaW5nVmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG52YXIgVGltZXN0YW1wVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhUaW1lc3RhbXBWYWx1ZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFRpbWVzdGFtcFZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5UaW1lc3RhbXBWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBUaW1lc3RhbXBWYWx1ZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMudGltZXN0YW1wc0luU25hcHNob3RzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlLnRvRGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBUaW1lc3RhbXBWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBUaW1lc3RhbXBWYWx1ZSAmJlxyXG4gICAgICAgICAgICB0aGlzLmludGVybmFsVmFsdWUuaXNFcXVhbChvdGhlci5pbnRlcm5hbFZhbHVlKSk7XHJcbiAgICB9O1xyXG4gICAgVGltZXN0YW1wVmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIFRpbWVzdGFtcFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWUuX2NvbXBhcmVUbyhvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAob3RoZXIgaW5zdGFuY2VvZiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSkge1xyXG4gICAgICAgICAgICAvLyBDb25jcmV0ZSB0aW1lc3RhbXBzIGNvbWUgYmVmb3JlIHNlcnZlciB0aW1lc3RhbXBzLlxyXG4gICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRpbWVzdGFtcFZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBsb2NhbGx5LWFwcGxpZWQgU2VydmVyVGltZXN0YW1wLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSBpbnN0YW5jZXMgYXJlIGNyZWF0ZWQgYXMgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhXHJcbiAqICAgVHJhbnNmb3JtTXV0YXRpb24gKHNlZSBUcmFuc2Zvcm1NdXRhdGlvbi5hcHBseVRvKCkpLiBUaGV5IGNhbiBvbmx5IGV4aXN0IGluXHJcbiAqICAgdGhlIGxvY2FsIHZpZXcgb2YgYSBkb2N1bWVudC4gVGhlcmVmb3JlIHRoZXkgZG8gbm90IG5lZWQgdG8gYmUgcGFyc2VkIG9yXHJcbiAqICAgc2VyaWFsaXplZC5cclxuICogLSBXaGVuIGV2YWx1YXRlZCBsb2NhbGx5IChlLmcuIGZvciBzbmFwc2hvdC5kYXRhKCkpLCB0aGV5IGJ5IGRlZmF1bHRcclxuICogICBldmFsdWF0ZSB0byBgbnVsbGAuIFRoaXMgYmVoYXZpb3IgY2FuIGJlIGNvbmZpZ3VyZWQgYnkgcGFzc2luZyBjdXN0b21cclxuICogICBGaWVsZFZhbHVlT3B0aW9ucyB0byB2YWx1ZSgpLlxyXG4gKiAtIFdpdGggcmVzcGVjdCB0byBvdGhlciBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZXMsIHRoZXkgc29ydCBieSB0aGVpclxyXG4gKiAgIGxvY2FsV3JpdGVUaW1lLlxyXG4gKi9cclxudmFyIFNlcnZlclRpbWVzdGFtcFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU2VydmVyVGltZXN0YW1wVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZShsb2NhbFdyaXRlVGltZSwgcHJldmlvdXNWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMubG9jYWxXcml0ZVRpbWUgPSBsb2NhbFdyaXRlVGltZTtcclxuICAgICAgICBfdGhpcy5wcmV2aW91c1ZhbHVlID0gcHJldmlvdXNWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuVGltZXN0YW1wVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgU2VydmVyVGltZXN0YW1wVmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAob3B0aW9ucyAmJlxyXG4gICAgICAgICAgICBvcHRpb25zLnNlcnZlclRpbWVzdGFtcEJlaGF2aW9yID09PSBTZXJ2ZXJUaW1lc3RhbXBCZWhhdmlvci5Fc3RpbWF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFRpbWVzdGFtcFZhbHVlKHRoaXMubG9jYWxXcml0ZVRpbWUpLnZhbHVlKG9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChvcHRpb25zICYmXHJcbiAgICAgICAgICAgIG9wdGlvbnMuc2VydmVyVGltZXN0YW1wQmVoYXZpb3IgPT09IFNlcnZlclRpbWVzdGFtcEJlaGF2aW9yLlByZXZpb3VzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByZXZpb3VzVmFsdWUgPyB0aGlzLnByZXZpb3VzVmFsdWUudmFsdWUob3B0aW9ucykgOiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFNlcnZlclRpbWVzdGFtcFZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIFNlcnZlclRpbWVzdGFtcFZhbHVlICYmXHJcbiAgICAgICAgICAgIHRoaXMubG9jYWxXcml0ZVRpbWUuaXNFcXVhbChvdGhlci5sb2NhbFdyaXRlVGltZSkpO1xyXG4gICAgfTtcclxuICAgIFNlcnZlclRpbWVzdGFtcFZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFdyaXRlVGltZS5fY29tcGFyZVRvKG90aGVyLmxvY2FsV3JpdGVUaW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAob3RoZXIgaW5zdGFuY2VvZiBUaW1lc3RhbXBWYWx1ZSkge1xyXG4gICAgICAgICAgICAvLyBTZXJ2ZXIgdGltZXN0YW1wcyBjb21lIGFmdGVyIGFsbCBjb25jcmV0ZSB0aW1lc3RhbXBzLlxyXG4gICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICc8U2VydmVyVGltZXN0YW1wIGxvY2FsVGltZT0nICsgdGhpcy5sb2NhbFdyaXRlVGltZS50b1N0cmluZygpICsgJz4nO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbnZhciBCbG9iVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhCbG9iVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBCbG9iVmFsdWUoaW50ZXJuYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuaW50ZXJuYWxWYWx1ZSA9IGludGVybmFsVmFsdWU7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLkJsb2JWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBCbG9iVmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlO1xyXG4gICAgfTtcclxuICAgIEJsb2JWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBCbG9iVmFsdWUgJiZcclxuICAgICAgICAgICAgdGhpcy5pbnRlcm5hbFZhbHVlLmlzRXF1YWwob3RoZXIuaW50ZXJuYWxWYWx1ZSkpO1xyXG4gICAgfTtcclxuICAgIEJsb2JWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgQmxvYlZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmludGVybmFsVmFsdWUuX2NvbXBhcmVUbyhvdGhlci5pbnRlcm5hbFZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENvbXBhcmVUbyhvdGhlcik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJsb2JWYWx1ZTtcclxufShGaWVsZFZhbHVlKSk7XHJcbnZhciBSZWZWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFJlZlZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUmVmVmFsdWUoZGF0YWJhc2VJZCwga2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5kYXRhYmFzZUlkID0gZGF0YWJhc2VJZDtcclxuICAgICAgICBfdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgX3RoaXMudHlwZU9yZGVyID0gVHlwZU9yZGVyLlJlZlZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFJlZlZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5O1xyXG4gICAgfTtcclxuICAgIFJlZlZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVmVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLmtleS5pc0VxdWFsKG90aGVyLmtleSkgJiYgdGhpcy5kYXRhYmFzZUlkLmlzRXF1YWwob3RoZXIuZGF0YWJhc2VJZCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZWZWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVmVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGNtcCA9IHRoaXMuZGF0YWJhc2VJZC5jb21wYXJlVG8ob3RoZXIuZGF0YWJhc2VJZCk7XHJcbiAgICAgICAgICAgIHJldHVybiBjbXAgIT09IDAgPyBjbXAgOiBEb2N1bWVudEtleS5jb21wYXJhdG9yKHRoaXMua2V5LCBvdGhlci5rZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVmVmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xyXG52YXIgR2VvUG9pbnRWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEdlb1BvaW50VmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBHZW9Qb2ludFZhbHVlKGludGVybmFsVmFsdWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmludGVybmFsVmFsdWUgPSBpbnRlcm5hbFZhbHVlO1xyXG4gICAgICAgIF90aGlzLnR5cGVPcmRlciA9IFR5cGVPcmRlci5HZW9Qb2ludFZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEdlb1BvaW50VmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlO1xyXG4gICAgfTtcclxuICAgIEdlb1BvaW50VmFsdWUucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgR2VvUG9pbnRWYWx1ZSAmJlxyXG4gICAgICAgICAgICB0aGlzLmludGVybmFsVmFsdWUuaXNFcXVhbChvdGhlci5pbnRlcm5hbFZhbHVlKSk7XHJcbiAgICB9O1xyXG4gICAgR2VvUG9pbnRWYWx1ZS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgR2VvUG9pbnRWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFZhbHVlLl9jb21wYXJlVG8ob3RoZXIuaW50ZXJuYWxWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBHZW9Qb2ludFZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxudmFyIE9iamVjdFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoT2JqZWN0VmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBPYmplY3RWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuT2JqZWN0VmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLnZhbHVlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgdGhpcy5pbnRlcm5hbFZhbHVlLmlub3JkZXJUcmF2ZXJzYWwoZnVuY3Rpb24gKGtleSwgdmFsKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gdmFsLnZhbHVlKG9wdGlvbnMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5pbnRlcm5hbFZhbHVlLmlub3JkZXJUcmF2ZXJzYWwoYWN0aW9uKTtcclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIE9iamVjdFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBpdDEgPSB0aGlzLmludGVybmFsVmFsdWUuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICAgICAgdmFyIGl0MiA9IG90aGVyLmludGVybmFsVmFsdWUuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICAgICAgd2hpbGUgKGl0MS5oYXNOZXh0KCkgJiYgaXQyLmhhc05leHQoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5leHQxID0gaXQxLmdldE5leHQoKTtcclxuICAgICAgICAgICAgICAgIHZhciBuZXh0MiA9IGl0Mi5nZXROZXh0KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV4dDEua2V5ICE9PSBuZXh0Mi5rZXkgfHwgIW5leHQxLnZhbHVlLmlzRXF1YWwobmV4dDIudmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAhaXQxLmhhc05leHQoKSAmJiAhaXQyLmhhc05leHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBPYmplY3RWYWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgaXQxID0gdGhpcy5pbnRlcm5hbFZhbHVlLmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgICAgIHZhciBpdDIgPSBvdGhlci5pbnRlcm5hbFZhbHVlLmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgICAgIHdoaWxlIChpdDEuaGFzTmV4dCgpICYmIGl0Mi5oYXNOZXh0KCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuZXh0MSA9IGl0MS5nZXROZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dDIgPSBpdDIuZ2V0TmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNtcCA9IHByaW1pdGl2ZUNvbXBhcmF0b3IobmV4dDEua2V5LCBuZXh0Mi5rZXkpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dDEudmFsdWUuY29tcGFyZVRvKG5leHQyLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGlmIChjbXApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY21wO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIE9ubHkgZXF1YWwgaWYgYm90aCBpdGVyYXRvcnMgYXJlIGV4aGF1c3RlZFxyXG4gICAgICAgICAgICByZXR1cm4gcHJpbWl0aXZlQ29tcGFyYXRvcihpdDEuaGFzTmV4dCgpLCBpdDIuaGFzTmV4dCgpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRDb21wYXJlVG8ob3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHBhdGgsIHRvKSB7XHJcbiAgICAgICAgYXNzZXJ0KCFwYXRoLmlzRW1wdHkoKSwgJ0Nhbm5vdCBzZXQgZmllbGQgZm9yIGVtcHR5IHBhdGggb24gT2JqZWN0VmFsdWUnKTtcclxuICAgICAgICBpZiAocGF0aC5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q2hpbGQocGF0aC5maXJzdFNlZ21lbnQoKSwgdG8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5jaGlsZChwYXRoLmZpcnN0U2VnbWVudCgpKTtcclxuICAgICAgICAgICAgaWYgKCEoY2hpbGQgaW5zdGFuY2VvZiBPYmplY3RWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIGNoaWxkID0gT2JqZWN0VmFsdWUuRU1QVFk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG5ld0NoaWxkID0gY2hpbGQuc2V0KHBhdGgucG9wRmlyc3QoKSwgdG8pO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRDaGlsZChwYXRoLmZpcnN0U2VnbWVudCgpLCBuZXdDaGlsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAocGF0aCkge1xyXG4gICAgICAgIGFzc2VydCghcGF0aC5pc0VtcHR5KCksICdDYW5ub3QgZGVsZXRlIGZpZWxkIGZvciBlbXB0eSBwYXRoIG9uIE9iamVjdFZhbHVlJyk7XHJcbiAgICAgICAgaWYgKHBhdGgubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgT2JqZWN0VmFsdWUodGhpcy5pbnRlcm5hbFZhbHVlLnJlbW92ZShwYXRoLmZpcnN0U2VnbWVudCgpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBuZXN0ZWQgZmllbGRcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5jaGlsZChwYXRoLmZpcnN0U2VnbWVudCgpKTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgT2JqZWN0VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuZXdDaGlsZCA9IGNoaWxkLmRlbGV0ZShwYXRoLnBvcEZpcnN0KCkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPYmplY3RWYWx1ZSh0aGlzLmludGVybmFsVmFsdWUuaW5zZXJ0KHBhdGguZmlyc3RTZWdtZW50KCksIG5ld0NoaWxkKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBEb24ndCBhY3R1YWxseSBjaGFuZ2UgYSBwcmltaXRpdmUgdmFsdWUgdG8gYW4gb2JqZWN0IGZvciBhIGRlbGV0ZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maWVsZChwYXRoKSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS5maWVsZCA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgYXNzZXJ0KCFwYXRoLmlzRW1wdHkoKSwgXCJDYW4ndCBnZXQgZmllbGQgb2YgZW1wdHkgcGF0aFwiKTtcclxuICAgICAgICB2YXIgZmllbGQgPSB0aGlzO1xyXG4gICAgICAgIHBhdGguZm9yRWFjaChmdW5jdGlvbiAocGF0aFNlZ21lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGZpZWxkIGluc3RhbmNlb2YgT2JqZWN0VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkID0gZmllbGQuaW50ZXJuYWxWYWx1ZS5nZXQocGF0aFNlZ21lbnQpIHx8IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGZpZWxkO1xyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy52YWx1ZSgpKTtcclxuICAgIH07XHJcbiAgICBPYmplY3RWYWx1ZS5wcm90b3R5cGUuY2hpbGQgPSBmdW5jdGlvbiAoY2hpbGROYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZS5nZXQoY2hpbGROYW1lKSB8fCB1bmRlZmluZWQ7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0VmFsdWUucHJvdG90eXBlLnNldENoaWxkID0gZnVuY3Rpb24gKGNoaWxkTmFtZSwgdmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IE9iamVjdFZhbHVlKHRoaXMuaW50ZXJuYWxWYWx1ZS5pbnNlcnQoY2hpbGROYW1lLCB2YWx1ZSkpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdFZhbHVlLkVNUFRZID0gbmV3IE9iamVjdFZhbHVlKG5ldyBTb3J0ZWRNYXAocHJpbWl0aXZlQ29tcGFyYXRvcikpO1xyXG4gICAgcmV0dXJuIE9iamVjdFZhbHVlO1xyXG59KEZpZWxkVmFsdWUpKTtcclxudmFyIEFycmF5VmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBcnJheVZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQXJyYXlWYWx1ZShpbnRlcm5hbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5pbnRlcm5hbFZhbHVlID0gaW50ZXJuYWxWYWx1ZTtcclxuICAgICAgICBfdGhpcy50eXBlT3JkZXIgPSBUeXBlT3JkZXIuQXJyYXlWYWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBBcnJheVZhbHVlLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxWYWx1ZS5tYXAoZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHYudmFsdWUob3B0aW9ucyk7IH0pO1xyXG4gICAgfTtcclxuICAgIEFycmF5VmFsdWUucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoYWN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5pbnRlcm5hbFZhbHVlLmZvckVhY2goYWN0aW9uKTtcclxuICAgIH07XHJcbiAgICBBcnJheVZhbHVlLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgQXJyYXlWYWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pbnRlcm5hbFZhbHVlLmxlbmd0aCAhPT0gb3RoZXIuaW50ZXJuYWxWYWx1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaW50ZXJuYWxWYWx1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmludGVybmFsVmFsdWVbaV0uaXNFcXVhbChvdGhlci5pbnRlcm5hbFZhbHVlW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIEFycmF5VmFsdWUucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEFycmF5VmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIG1pbkxlbmd0aCA9IE1hdGgubWluKHRoaXMuaW50ZXJuYWxWYWx1ZS5sZW5ndGgsIG90aGVyLmludGVybmFsVmFsdWUubGVuZ3RoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtaW5MZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNtcCA9IHRoaXMuaW50ZXJuYWxWYWx1ZVtpXS5jb21wYXJlVG8ob3RoZXIuaW50ZXJuYWxWYWx1ZVtpXSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY21wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNtcDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcHJpbWl0aXZlQ29tcGFyYXRvcih0aGlzLmludGVybmFsVmFsdWUubGVuZ3RoLCBvdGhlci5pbnRlcm5hbFZhbHVlLmxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0Q29tcGFyZVRvKG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWYWx1ZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMudmFsdWUoKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFycmF5VmFsdWU7XHJcbn0oRmllbGRWYWx1ZSkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gVW50eXBlZCBOdW1iZXIgYWxpYXMgd2UgY2FuIHVzZSB0byBjaGVjayBmb3IgRVM2IG1ldGhvZHMgLyBwcm9wZXJ0aWVzLlxyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IHZhcmlhYmxlLW5hbWVcclxudmFyIE51bWJlckFzQW55ID0gTnVtYmVyO1xyXG4vKipcclxuICogTWluaW11bSBzYWZlIGludGVnZXIgaW4gSmF2YXNjcmlwdCBiZWNhdXNlIG9mIGZsb2F0aW5nIHBvaW50IHByZWNpc2lvbi5cclxuICogQWRkZWQgdG8gbm90IHJlbHkgb24gRVM2IGZlYXR1cmVzLlxyXG4gKi9cclxudmFyIE1JTl9TQUZFX0lOVEVHRVIgPSBOdW1iZXJBc0FueS5NSU5fU0FGRV9JTlRFR0VSIHx8IC0oTWF0aC5wb3coMiwgNTMpIC0gMSk7XHJcbi8qKlxyXG4gKiBNYXhpbXVtIHNhZmUgaW50ZWdlciBpbiBKYXZhc2NyaXB0IGJlY2F1c2Ugb2YgZmxvYXRpbmcgcG9pbnQgcHJlY2lzaW9uLlxyXG4gKiBBZGRlZCB0byBub3QgcmVseSBvbiBFUzYgZmVhdHVyZXMuXHJcbiAqL1xyXG52YXIgTUFYX1NBRkVfSU5URUdFUiA9IE51bWJlckFzQW55Lk1BWF9TQUZFX0lOVEVHRVIgfHwgTWF0aC5wb3coMiwgNTMpIC0gMTtcclxuLyoqXHJcbiAqIFJldHVybnMgd2hldGhlciBhbiBudW1iZXIgaXMgYW4gaW50ZWdlciwgdXNlcyBuYXRpdmUgaW1wbGVtZW50YXRpb24gaWZcclxuICogYXZhaWxhYmxlLlxyXG4gKiBBZGRlZCB0byBub3QgcmVseSBvbiBFUzYgZmVhdHVyZXMuXHJcbiAqIEBwYXJhbSB2YWx1ZSBUaGUgdmFsdWUgdG8gdGVzdCBmb3IgYmVpbmcgYW4gaW50ZWdlclxyXG4gKi9cclxudmFyIGlzSW50ZWdlciA9IE51bWJlckFzQW55LmlzSW50ZWdlciB8fFxyXG4gICAgKGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmXHJcbiAgICAgICAgICAgIGlzRmluaXRlKHZhbHVlKSAmJlxyXG4gICAgICAgICAgICBNYXRoLmZsb29yKHZhbHVlKSA9PT0gdmFsdWU7XHJcbiAgICB9KTtcclxuLyoqXHJcbiAqIFJldHVybnMgd2hldGhlciBhIHZhcmlhYmxlIGlzIGVpdGhlciB1bmRlZmluZWQgb3IgbnVsbC5cclxuICovXHJcbmZ1bmN0aW9uIGlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSB7XHJcbiAgICByZXR1cm4gdmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZDtcclxufVxyXG4vKipcclxuICogUmV0dXJucyB3aGV0aGVyIGEgdmFsdWUgaXMgYW4gaW50ZWdlciBhbmQgaW4gdGhlIHNhZmUgaW50ZWdlciByYW5nZVxyXG4gKiBAcGFyYW0gdmFsdWUgVGhlIHZhbHVlIHRvIHRlc3QgZm9yIGJlaW5nIGFuIGludGVnZXIgYW5kIGluIHRoZSBzYWZlIHJhbmdlXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1NhZmVJbnRlZ2VyKHZhbHVlKSB7XHJcbiAgICByZXR1cm4gKGlzSW50ZWdlcih2YWx1ZSkgJiZcclxuICAgICAgICB2YWx1ZSA8PSBNQVhfU0FGRV9JTlRFR0VSICYmXHJcbiAgICAgICAgdmFsdWUgPj0gTUlOX1NBRkVfSU5URUdFUik7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBRdWVyeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5KHBhdGgsIGV4cGxpY2l0T3JkZXJCeSwgZmlsdGVycywgbGltaXQsIHN0YXJ0QXQsIGVuZEF0KSB7XHJcbiAgICAgICAgaWYgKGV4cGxpY2l0T3JkZXJCeSA9PT0gdm9pZCAwKSB7IGV4cGxpY2l0T3JkZXJCeSA9IFtdOyB9XHJcbiAgICAgICAgaWYgKGZpbHRlcnMgPT09IHZvaWQgMCkgeyBmaWx0ZXJzID0gW107IH1cclxuICAgICAgICBpZiAobGltaXQgPT09IHZvaWQgMCkgeyBsaW1pdCA9IG51bGw7IH1cclxuICAgICAgICBpZiAoc3RhcnRBdCA9PT0gdm9pZCAwKSB7IHN0YXJ0QXQgPSBudWxsOyB9XHJcbiAgICAgICAgaWYgKGVuZEF0ID09PSB2b2lkIDApIHsgZW5kQXQgPSBudWxsOyB9XHJcbiAgICAgICAgdGhpcy5wYXRoID0gcGF0aDtcclxuICAgICAgICB0aGlzLmV4cGxpY2l0T3JkZXJCeSA9IGV4cGxpY2l0T3JkZXJCeTtcclxuICAgICAgICB0aGlzLmZpbHRlcnMgPSBmaWx0ZXJzO1xyXG4gICAgICAgIHRoaXMubGltaXQgPSBsaW1pdDtcclxuICAgICAgICB0aGlzLnN0YXJ0QXQgPSBzdGFydEF0O1xyXG4gICAgICAgIHRoaXMuZW5kQXQgPSBlbmRBdDtcclxuICAgICAgICB0aGlzLm1lbW9pemVkQ2Fub25pY2FsSWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubWVtb2l6ZWRPcmRlckJ5ID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5zdGFydEF0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXNzZXJ0VmFsaWRCb3VuZCh0aGlzLnN0YXJ0QXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5lbmRBdCkge1xyXG4gICAgICAgICAgICB0aGlzLmFzc2VydFZhbGlkQm91bmQodGhpcy5lbmRBdCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgUXVlcnkuYXRQYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHBhdGgpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShRdWVyeS5wcm90b3R5cGUsIFwib3JkZXJCeVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1lbW9pemVkT3JkZXJCeSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZXF1YWxpdHlGaWVsZCA9IHRoaXMuZ2V0SW5lcXVhbGl0eUZpbHRlckZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3RPcmRlckJ5RmllbGQgPSB0aGlzLmdldEZpcnN0T3JkZXJCeUZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5lcXVhbGl0eUZpZWxkICE9PSBudWxsICYmIGZpcnN0T3JkZXJCeUZpZWxkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSW4gb3JkZXIgdG8gaW1wbGljaXRseSBhZGQga2V5IG9yZGVyaW5nLCB3ZSBtdXN0IGFsc28gYWRkIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGluZXF1YWxpdHkgZmlsdGVyIGZpZWxkIGZvciBpdCB0byBiZSBhIHZhbGlkIHF1ZXJ5LlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE5vdGUgdGhhdCB0aGUgZGVmYXVsdCBpbmVxdWFsaXR5IGZpZWxkIGFuZCBrZXkgb3JkZXJpbmcgaXMgYXNjZW5kaW5nLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmVxdWFsaXR5RmllbGQuaXNLZXlGaWVsZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWVtb2l6ZWRPcmRlckJ5ID0gW0tFWV9PUkRFUklOR19BU0NdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vaXplZE9yZGVyQnkgPSBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgT3JkZXJCeShpbmVxdWFsaXR5RmllbGQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgS0VZX09SREVSSU5HX0FTQ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChpbmVxdWFsaXR5RmllbGQgPT09IG51bGwgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGZpcnN0T3JkZXJCeUZpZWxkICE9PSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmVxdWFsaXR5RmllbGQuaXNFcXVhbChmaXJzdE9yZGVyQnlGaWVsZCkpLCAnRmlyc3Qgb3JkZXJCeSBzaG91bGQgbWF0Y2ggaW5lcXVhbGl0eSBmaWVsZC4nKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbW9pemVkT3JkZXJCeSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZEtleU9yZGVyaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZXhwbGljaXRPcmRlckJ5OyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3JkZXJCeSA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vaXplZE9yZGVyQnkucHVzaChvcmRlckJ5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9yZGVyQnkuZmllbGQuaXNLZXlGaWVsZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZEtleU9yZGVyaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kS2V5T3JkZXJpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIG9yZGVyIG9mIHRoZSBpbXBsaWNpdCBrZXkgb3JkZXJpbmcgYWx3YXlzIG1hdGNoZXMgdGhlIGxhc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwbGljaXQgb3JkZXIgYnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3REaXJlY3Rpb24gPSB0aGlzLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuZXhwbGljaXRPcmRlckJ5W3RoaXMuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCAtIDFdLmRpclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBEaXJlY3Rpb24uQVNDRU5ESU5HO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1lbW9pemVkT3JkZXJCeS5wdXNoKGxhc3REaXJlY3Rpb24gPT09IERpcmVjdGlvbi5BU0NFTkRJTkdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gS0VZX09SREVSSU5HX0FTQ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBLRVlfT1JERVJJTkdfREVTQyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1lbW9pemVkT3JkZXJCeTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5hZGRGaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuZ2V0SW5lcXVhbGl0eUZpbHRlckZpZWxkKCkgPT0gbnVsbCB8fFxyXG4gICAgICAgICAgICAhKGZpbHRlciBpbnN0YW5jZW9mIFJlbGF0aW9uRmlsdGVyKSB8fFxyXG4gICAgICAgICAgICAhZmlsdGVyLmlzSW5lcXVhbGl0eSgpIHx8XHJcbiAgICAgICAgICAgIGZpbHRlci5maWVsZC5pc0VxdWFsKHRoaXMuZ2V0SW5lcXVhbGl0eUZpbHRlckZpZWxkKCkpLCAnUXVlcnkgbXVzdCBvbmx5IGhhdmUgb25lIGluZXF1YWxpdHkgZmllbGQuJyk7XHJcbiAgICAgICAgYXNzZXJ0KCFEb2N1bWVudEtleS5pc0RvY3VtZW50S2V5KHRoaXMucGF0aCksICdObyBmaWx0ZXJpbmcgYWxsb3dlZCBmb3IgZG9jdW1lbnQgcXVlcnknKTtcclxuICAgICAgICB2YXIgbmV3RmlsdGVycyA9IHRoaXMuZmlsdGVycy5jb25jYXQoW2ZpbHRlcl0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkodGhpcy5wYXRoLCB0aGlzLmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCBuZXdGaWx0ZXJzLCB0aGlzLmxpbWl0LCB0aGlzLnN0YXJ0QXQsIHRoaXMuZW5kQXQpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5hZGRPcmRlckJ5ID0gZnVuY3Rpb24gKG9yZGVyQnkpIHtcclxuICAgICAgICBhc3NlcnQoIURvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkodGhpcy5wYXRoKSwgJ05vIG9yZGVyaW5nIGFsbG93ZWQgZm9yIGRvY3VtZW50IHF1ZXJ5Jyk7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLnN0YXJ0QXQgJiYgIXRoaXMuZW5kQXQsICdCb3VuZHMgbXVzdCBiZSBzZXQgYWZ0ZXIgb3JkZXJCeScpO1xyXG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogdmFsaWRhdGUgdGhhdCBvcmRlckJ5IGRvZXMgbm90IGxpc3QgdGhlIHNhbWUga2V5IHR3aWNlLlxyXG4gICAgICAgIHZhciBuZXdPcmRlckJ5ID0gdGhpcy5leHBsaWNpdE9yZGVyQnkuY29uY2F0KFtvcmRlckJ5XSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSh0aGlzLnBhdGgsIG5ld09yZGVyQnksIHRoaXMuZmlsdGVycy5zbGljZSgpLCB0aGlzLmxpbWl0LCB0aGlzLnN0YXJ0QXQsIHRoaXMuZW5kQXQpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS53aXRoTGltaXQgPSBmdW5jdGlvbiAobGltaXQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucGF0aCwgdGhpcy5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdGhpcy5maWx0ZXJzLnNsaWNlKCksIGxpbWl0LCB0aGlzLnN0YXJ0QXQsIHRoaXMuZW5kQXQpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS53aXRoU3RhcnRBdCA9IGZ1bmN0aW9uIChib3VuZCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkodGhpcy5wYXRoLCB0aGlzLmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0aGlzLmZpbHRlcnMuc2xpY2UoKSwgdGhpcy5saW1pdCwgYm91bmQsIHRoaXMuZW5kQXQpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS53aXRoRW5kQXQgPSBmdW5jdGlvbiAoYm91bmQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5KHRoaXMucGF0aCwgdGhpcy5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdGhpcy5maWx0ZXJzLnNsaWNlKCksIHRoaXMubGltaXQsIHRoaXMuc3RhcnRBdCwgYm91bmQpO1xyXG4gICAgfTtcclxuICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IFRoaXMgaXMgdXNlZCB0byBnZXQgYSB1bmlxdWUgc3RyaW5nIGZyb20gYSBxdWVyeSB0bywgZm9yXHJcbiAgICAvLyBleGFtcGxlLCB1c2UgYXMgYSBkaWN0aW9uYXJ5IGtleSwgYnV0IHRoZSBpbXBsZW1lbnRhdGlvbiBpcyBzdWJqZWN0IHRvXHJcbiAgICAvLyBjb2xsaXNpb25zLiBNYWtlIGl0IGNvbGxpc2lvbi1mcmVlLlxyXG4gICAgUXVlcnkucHJvdG90eXBlLmNhbm9uaWNhbElkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm1lbW9pemVkQ2Fub25pY2FsSWQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIGNhbm9uaWNhbElkID0gdGhpcy5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgICAgICAgICBjYW5vbmljYWxJZCArPSAnfGY6JztcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZmlsdGVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBmaWx0ZXIgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSBmaWx0ZXIuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9ICcsJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYW5vbmljYWxJZCArPSAnfG9iOic7XHJcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogbWFrZSB0aGlzIGNvbGxpc2lvbiByZXNpc3RhbnRcclxuICAgICAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IHRoaXMub3JkZXJCeTsgX2IgPCBfYy5sZW5ndGg7IF9iKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBvcmRlckJ5ID0gX2NbX2JdO1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gb3JkZXJCeS5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gJywnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodGhpcy5saW1pdCkpIHtcclxuICAgICAgICAgICAgICAgIGNhbm9uaWNhbElkICs9ICd8bDonO1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gdGhpcy5saW1pdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5zdGFydEF0KSB7XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSAnfGxiOic7XHJcbiAgICAgICAgICAgICAgICBjYW5vbmljYWxJZCArPSB0aGlzLnN0YXJ0QXQuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5lbmRBdCkge1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gJ3x1YjonO1xyXG4gICAgICAgICAgICAgICAgY2Fub25pY2FsSWQgKz0gdGhpcy5lbmRBdC5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubWVtb2l6ZWRDYW5vbmljYWxJZCA9IGNhbm9uaWNhbElkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5tZW1vaXplZENhbm9uaWNhbElkO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc3RyID0gJ1F1ZXJ5KCcgKyB0aGlzLnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHN0ciArPSBcIiwgZmlsdGVyczogW1wiICsgdGhpcy5maWx0ZXJzLmpvaW4oJywgJykgKyBcIl1cIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFpc051bGxPclVuZGVmaW5lZCh0aGlzLmxpbWl0KSkge1xyXG4gICAgICAgICAgICBzdHIgKz0gJywgbGltaXQ6ICcgKyB0aGlzLmxpbWl0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5leHBsaWNpdE9yZGVyQnkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBzdHIgKz0gXCIsIG9yZGVyQnk6IFtcIiArIHRoaXMuZXhwbGljaXRPcmRlckJ5LmpvaW4oJywgJykgKyBcIl1cIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRBdCkge1xyXG4gICAgICAgICAgICBzdHIgKz0gJywgc3RhcnRBdDogJyArIHRoaXMuc3RhcnRBdC5jYW5vbmljYWxJZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5lbmRBdCkge1xyXG4gICAgICAgICAgICBzdHIgKz0gJywgZW5kQXQ6ICcgKyB0aGlzLmVuZEF0LmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdHIgKyAnKSc7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5saW1pdCAhPT0gb3RoZXIubGltaXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5vcmRlckJ5Lmxlbmd0aCAhPT0gb3RoZXIub3JkZXJCeS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub3JkZXJCeS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMub3JkZXJCeVtpXS5pc0VxdWFsKG90aGVyLm9yZGVyQnlbaV0pKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVycy5sZW5ndGggIT09IG90aGVyLmZpbHRlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmZpbHRlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmZpbHRlcnNbaV0uaXNFcXVhbChvdGhlci5maWx0ZXJzW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5wYXRoLmlzRXF1YWwob3RoZXIucGF0aCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zdGFydEF0ICE9PSBudWxsXHJcbiAgICAgICAgICAgID8gIXRoaXMuc3RhcnRBdC5pc0VxdWFsKG90aGVyLnN0YXJ0QXQpXHJcbiAgICAgICAgICAgIDogb3RoZXIuc3RhcnRBdCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmVuZEF0ICE9PSBudWxsXHJcbiAgICAgICAgICAgID8gdGhpcy5lbmRBdC5pc0VxdWFsKG90aGVyLmVuZEF0KVxyXG4gICAgICAgICAgICA6IG90aGVyLmVuZEF0ID09PSBudWxsO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5kb2NDb21wYXJhdG9yID0gZnVuY3Rpb24gKGQxLCBkMikge1xyXG4gICAgICAgIHZhciBjb21wYXJlZE9uS2V5RmllbGQgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5vcmRlckJ5OyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgb3JkZXJCeSA9IF9hW19pXTtcclxuICAgICAgICAgICAgdmFyIGNvbXAgPSBvcmRlckJ5LmNvbXBhcmUoZDEsIGQyKTtcclxuICAgICAgICAgICAgaWYgKGNvbXAgIT09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcDtcclxuICAgICAgICAgICAgY29tcGFyZWRPbktleUZpZWxkID0gY29tcGFyZWRPbktleUZpZWxkIHx8IG9yZGVyQnkuZmllbGQuaXNLZXlGaWVsZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBc3NlcnQgdGhhdCB3ZSBhY3R1YWxseSBjb21wYXJlZCBieSBrZXlcclxuICAgICAgICBhc3NlcnQoY29tcGFyZWRPbktleUZpZWxkLCBcIm9yZGVyQnkgdXNlZCB0aGF0IGRvZXNuJ3QgY29tcGFyZSBvbiBrZXkgZmllbGRcIik7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLm1hdGNoZXMgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLm1hdGNoZXNBbmNlc3Rvcihkb2MpICYmXHJcbiAgICAgICAgICAgIHRoaXMubWF0Y2hlc09yZGVyQnkoZG9jKSAmJlxyXG4gICAgICAgICAgICB0aGlzLm1hdGNoZXNGaWx0ZXJzKGRvYykgJiZcclxuICAgICAgICAgICAgdGhpcy5tYXRjaGVzQm91bmRzKGRvYykpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5oYXNMaW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gIWlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGltaXQpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5nZXRGaXJzdE9yZGVyQnlGaWVsZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5leHBsaWNpdE9yZGVyQnkubGVuZ3RoID4gMFxyXG4gICAgICAgICAgICA/IHRoaXMuZXhwbGljaXRPcmRlckJ5WzBdLmZpZWxkXHJcbiAgICAgICAgICAgIDogbnVsbDtcclxuICAgIH07XHJcbiAgICBRdWVyeS5wcm90b3R5cGUuZ2V0SW5lcXVhbGl0eUZpbHRlckZpZWxkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmZpbHRlcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWx0ZXIgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmIChmaWx0ZXIgaW5zdGFuY2VvZiBSZWxhdGlvbkZpbHRlciAmJiBmaWx0ZXIuaXNJbmVxdWFsaXR5KCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXIuZmllbGQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLmhhc0FycmF5Q29udGFpbnNGaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmZpbHRlcnMuZmluZChmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXIgaW5zdGFuY2VvZiBSZWxhdGlvbkZpbHRlciAmJlxyXG4gICAgICAgICAgICAgICAgZmlsdGVyLm9wID09PSBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TO1xyXG4gICAgICAgIH0pICE9PSB1bmRlZmluZWQpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5pc0RvY3VtZW50UXVlcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIERvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkodGhpcy5wYXRoKSAmJiB0aGlzLmZpbHRlcnMubGVuZ3RoID09PSAwO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5tYXRjaGVzQW5jZXN0b3IgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgdmFyIGRvY1BhdGggPSBkb2Mua2V5LnBhdGg7XHJcbiAgICAgICAgaWYgKERvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkodGhpcy5wYXRoKSkge1xyXG4gICAgICAgICAgICAvLyBleGFjdCBtYXRjaCBmb3IgZG9jdW1lbnQgcXVlcmllc1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXRoLmlzRXF1YWwoZG9jUGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBzaGFsbG93IGFuY2VzdG9yIHF1ZXJpZXMgYnkgZGVmYXVsdFxyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMucGF0aC5pc1ByZWZpeE9mKGRvY1BhdGgpICYmIHRoaXMucGF0aC5sZW5ndGggPT09IGRvY1BhdGgubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQSBkb2N1bWVudCBtdXN0IGhhdmUgYSB2YWx1ZSBmb3IgZXZlcnkgb3JkZXJpbmcgY2xhdXNlIGluIG9yZGVyIHRvIHNob3cgdXBcclxuICAgICAqIGluIHRoZSByZXN1bHRzLlxyXG4gICAgICovXHJcbiAgICBRdWVyeS5wcm90b3R5cGUubWF0Y2hlc09yZGVyQnkgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZXhwbGljaXRPcmRlckJ5OyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgb3JkZXJCeSA9IF9hW19pXTtcclxuICAgICAgICAgICAgLy8gb3JkZXIgYnkga2V5IGFsd2F5cyBtYXRjaGVzXHJcbiAgICAgICAgICAgIGlmICghb3JkZXJCeS5maWVsZC5pc0tleUZpZWxkKCkgJiZcclxuICAgICAgICAgICAgICAgIGRvYy5maWVsZChvcmRlckJ5LmZpZWxkKSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkucHJvdG90eXBlLm1hdGNoZXNGaWx0ZXJzID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmZpbHRlcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmaWx0ZXIgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmICghZmlsdGVyLm1hdGNoZXMoZG9jKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogTWFrZXMgc3VyZSBhIGRvY3VtZW50IGlzIHdpdGhpbiB0aGUgYm91bmRzLCBpZiBwcm92aWRlZC5cclxuICAgICAqL1xyXG4gICAgUXVlcnkucHJvdG90eXBlLm1hdGNoZXNCb3VuZHMgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRBdCAmJiAhdGhpcy5zdGFydEF0LnNvcnRzQmVmb3JlRG9jdW1lbnQodGhpcy5vcmRlckJ5LCBkb2MpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuZW5kQXQgJiYgdGhpcy5lbmRBdC5zb3J0c0JlZm9yZURvY3VtZW50KHRoaXMub3JkZXJCeSwgZG9jKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5LnByb3RvdHlwZS5hc3NlcnRWYWxpZEJvdW5kID0gZnVuY3Rpb24gKGJvdW5kKSB7XHJcbiAgICAgICAgYXNzZXJ0KGJvdW5kLnBvc2l0aW9uLmxlbmd0aCA8PSB0aGlzLm9yZGVyQnkubGVuZ3RoLCAnQm91bmQgaXMgbG9uZ2VyIHRoYW4gb3JkZXJCeScpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeTtcclxufSgpKTtcclxudmFyIEZpbHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpbHRlcigpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIGZpbHRlciBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYXJndW1lbnRzLlxyXG4gICAgICovXHJcbiAgICBGaWx0ZXIuY3JlYXRlID0gZnVuY3Rpb24gKGZpZWxkLCBvcCwgdmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUuaXNFcXVhbChOdWxsVmFsdWUuSU5TVEFOQ0UpKSB7XHJcbiAgICAgICAgICAgIGlmIChvcCAhPT0gUmVsYXRpb25PcC5FUVVBTCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBjYW4gb25seSBwZXJmb3JtIGVxdWFscyBjb21wYXJpc29ucyBvbiBudWxsLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgTnVsbEZpbHRlcihmaWVsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlLmlzRXF1YWwoRG91YmxlVmFsdWUuTkFOKSkge1xyXG4gICAgICAgICAgICBpZiAob3AgIT09IFJlbGF0aW9uT3AuRVFVQUwpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIHF1ZXJ5LiBZb3UgY2FuIG9ubHkgcGVyZm9ybSBlcXVhbHMgY29tcGFyaXNvbnMgb24gTmFOLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgTmFuRmlsdGVyKGZpZWxkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVsYXRpb25GaWx0ZXIoZmllbGQsIG9wLCB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBGaWx0ZXI7XHJcbn0oKSk7XHJcbnZhciBSZWxhdGlvbk9wID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVsYXRpb25PcChuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIH1cclxuICAgIFJlbGF0aW9uT3AuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChvcCkge1xyXG4gICAgICAgIHN3aXRjaCAob3ApIHtcclxuICAgICAgICAgICAgY2FzZSAnPCc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5MRVNTX1RIQU47XHJcbiAgICAgICAgICAgIGNhc2UgJzw9JzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkxFU1NfVEhBTl9PUl9FUVVBTDtcclxuICAgICAgICAgICAgY2FzZSAnPT0nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuRVFVQUw7XHJcbiAgICAgICAgICAgIGNhc2UgJz49JzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkdSRUFURVJfVEhBTl9PUl9FUVVBTDtcclxuICAgICAgICAgICAgY2FzZSAnPic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5HUkVBVEVSX1RIQU47XHJcbiAgICAgICAgICAgIGNhc2UgJ2FycmF5LWNvbnRhaW5zJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gcmVsYXRpb246ICcgKyBvcCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uT3AucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5hbWU7XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25PcC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5hbWUgPT09IG90aGVyLm5hbWU7XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25PcC5MRVNTX1RIQU4gPSBuZXcgUmVsYXRpb25PcCgnPCcpO1xyXG4gICAgUmVsYXRpb25PcC5MRVNTX1RIQU5fT1JfRVFVQUwgPSBuZXcgUmVsYXRpb25PcCgnPD0nKTtcclxuICAgIFJlbGF0aW9uT3AuRVFVQUwgPSBuZXcgUmVsYXRpb25PcCgnPT0nKTtcclxuICAgIFJlbGF0aW9uT3AuR1JFQVRFUl9USEFOID0gbmV3IFJlbGF0aW9uT3AoJz4nKTtcclxuICAgIFJlbGF0aW9uT3AuR1JFQVRFUl9USEFOX09SX0VRVUFMID0gbmV3IFJlbGF0aW9uT3AoJz49Jyk7XHJcbiAgICBSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TID0gbmV3IFJlbGF0aW9uT3AoJ2FycmF5LWNvbnRhaW5zJyk7XHJcbiAgICByZXR1cm4gUmVsYXRpb25PcDtcclxufSgpKTtcclxudmFyIFJlbGF0aW9uRmlsdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUmVsYXRpb25GaWx0ZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBSZWxhdGlvbkZpbHRlcihmaWVsZCwgb3AsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5maWVsZCA9IGZpZWxkO1xyXG4gICAgICAgIF90aGlzLm9wID0gb3A7XHJcbiAgICAgICAgX3RoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBSZWxhdGlvbkZpbHRlci5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICBpZiAodGhpcy5maWVsZC5pc0tleUZpZWxkKCkpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMudmFsdWUgaW5zdGFuY2VvZiBSZWZWYWx1ZSwgJ0NvbXBhcmluZyBvbiBrZXksIGJ1dCBmaWx0ZXIgdmFsdWUgbm90IGEgUmVmVmFsdWUnKTtcclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMub3AgIT09IFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlMsIFwiYXJyYXktY29udGFpbnMgcXVlcmllcyBkb24ndCBtYWtlIHNlbnNlIG9uIGRvY3VtZW50IGtleXMuXCIpO1xyXG4gICAgICAgICAgICB2YXIgcmVmVmFsdWUgPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICB2YXIgY29tcGFyaXNvbiA9IERvY3VtZW50S2V5LmNvbXBhcmF0b3IoZG9jLmtleSwgcmVmVmFsdWUua2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0Y2hlc0NvbXBhcmlzb24oY29tcGFyaXNvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdmFsID0gZG9jLmZpZWxkKHRoaXMuZmllbGQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsICE9PSB1bmRlZmluZWQgJiYgdGhpcy5tYXRjaGVzVmFsdWUodmFsKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25GaWx0ZXIucHJvdG90eXBlLm1hdGNoZXNWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMub3AgPT09IFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlMpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5VmFsdWUgJiZcclxuICAgICAgICAgICAgICAgIHZhbHVlLmludGVybmFsVmFsdWUuZmluZChmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gZWxlbWVudC5pc0VxdWFsKF90aGlzLnZhbHVlKTsgfSkgIT09XHJcbiAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIE9ubHkgY29tcGFyZSB0eXBlcyB3aXRoIG1hdGNoaW5nIGJhY2tlbmQgb3JkZXIgKHN1Y2ggYXMgZG91YmxlIGFuZCBpbnQpLlxyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMudmFsdWUudHlwZU9yZGVyID09PSB2YWx1ZS50eXBlT3JkZXIgJiZcclxuICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hlc0NvbXBhcmlzb24odmFsdWUuY29tcGFyZVRvKHRoaXMudmFsdWUpKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uRmlsdGVyLnByb3RvdHlwZS5tYXRjaGVzQ29tcGFyaXNvbiA9IGZ1bmN0aW9uIChjb21wYXJpc29uKSB7XHJcbiAgICAgICAgc3dpdGNoICh0aGlzLm9wKSB7XHJcbiAgICAgICAgICAgIGNhc2UgUmVsYXRpb25PcC5MRVNTX1RIQU46XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyaXNvbiA8IDA7XHJcbiAgICAgICAgICAgIGNhc2UgUmVsYXRpb25PcC5MRVNTX1RIQU5fT1JfRVFVQUw6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyaXNvbiA8PSAwO1xyXG4gICAgICAgICAgICBjYXNlIFJlbGF0aW9uT3AuRVFVQUw6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyaXNvbiA9PT0gMDtcclxuICAgICAgICAgICAgY2FzZSBSZWxhdGlvbk9wLkdSRUFURVJfVEhBTjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uID4gMDtcclxuICAgICAgICAgICAgY2FzZSBSZWxhdGlvbk9wLkdSRUFURVJfVEhBTl9PUl9FUVVBTDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uID49IDA7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biByZWxhdGlvbiBvcCcgKyB0aGlzLm9wKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25GaWx0ZXIucHJvdG90eXBlLmlzSW5lcXVhbGl0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMub3AgIT09IFJlbGF0aW9uT3AuRVFVQUwgJiYgdGhpcy5vcCAhPT0gUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUyk7XHJcbiAgICB9O1xyXG4gICAgUmVsYXRpb25GaWx0ZXIucHJvdG90eXBlLmNhbm9uaWNhbElkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IFRlY2huaWNhbGx5LCB0aGlzIHdvbid0IGJlIHVuaXF1ZSBpZiB0d28gdmFsdWVzIGhhdmVcclxuICAgICAgICAvLyB0aGUgc2FtZSBkZXNjcmlwdGlvbiwgc3VjaCBhcyB0aGUgaW50IDMgYW5kIHRoZSBzdHJpbmcgXCIzXCIuIFNvIHdlIHNob3VsZFxyXG4gICAgICAgIC8vIGFkZCB0aGUgdHlwZXMgaW4gaGVyZSBzb21laG93LCB0b28uXHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgdGhpcy5vcC50b1N0cmluZygpICsgdGhpcy52YWx1ZS50b1N0cmluZygpKTtcclxuICAgIH07XHJcbiAgICBSZWxhdGlvbkZpbHRlci5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIFJlbGF0aW9uRmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5vcC5pc0VxdWFsKG90aGVyLm9wKSAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5pc0VxdWFsKG90aGVyLmZpZWxkKSAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZS5pc0VxdWFsKG90aGVyLnZhbHVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlbGF0aW9uRmlsdGVyLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIFwiIFwiICsgdGhpcy5vcCArIFwiIFwiICsgdGhpcy52YWx1ZS52YWx1ZSgpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSZWxhdGlvbkZpbHRlcjtcclxufShGaWx0ZXIpKTtcclxuLyoqXHJcbiAqIEZpbHRlciB0aGF0IG1hdGNoZXMgJ251bGwnIHZhbHVlcy5cclxuICovXHJcbnZhciBOdWxsRmlsdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoTnVsbEZpbHRlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIE51bGxGaWx0ZXIoZmllbGQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmZpZWxkID0gZmllbGQ7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgTnVsbEZpbHRlci5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICB2YXIgdmFsID0gZG9jLmZpZWxkKHRoaXMuZmllbGQpO1xyXG4gICAgICAgIHJldHVybiB2YWwgIT09IHVuZGVmaW5lZCAmJiB2YWwudmFsdWUoKSA9PT0gbnVsbDtcclxuICAgIH07XHJcbiAgICBOdWxsRmlsdGVyLnByb3RvdHlwZS5jYW5vbmljYWxJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArICcgSVMgbnVsbCc7XHJcbiAgICB9O1xyXG4gICAgTnVsbEZpbHRlci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyBcIiBJUyBudWxsXCI7XHJcbiAgICB9O1xyXG4gICAgTnVsbEZpbHRlci5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIE51bGxGaWx0ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuaXNFcXVhbChvdGhlci5maWVsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBOdWxsRmlsdGVyO1xyXG59KEZpbHRlcikpO1xyXG4vKipcclxuICogRmlsdGVyIHRoYXQgbWF0Y2hlcyAnTmFOJyB2YWx1ZXMuXHJcbiAqL1xyXG52YXIgTmFuRmlsdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoTmFuRmlsdGVyLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gTmFuRmlsdGVyKGZpZWxkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5maWVsZCA9IGZpZWxkO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE5hbkZpbHRlci5wcm90b3R5cGUubWF0Y2hlcyA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICB2YXIgZmllbGQgPSBkb2MuZmllbGQodGhpcy5maWVsZCk7XHJcbiAgICAgICAgdmFyIHZhbCA9IGZpZWxkICYmIGZpZWxkLnZhbHVlKCk7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWwgPT09ICdudW1iZXInICYmIGlzTmFOKHZhbCk7XHJcbiAgICB9O1xyXG4gICAgTmFuRmlsdGVyLnByb3RvdHlwZS5jYW5vbmljYWxJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArICcgSVMgTmFOJztcclxuICAgIH07XHJcbiAgICBOYW5GaWx0ZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgXCIgSVMgTmFOXCI7XHJcbiAgICB9O1xyXG4gICAgTmFuRmlsdGVyLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgTmFuRmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmlzRXF1YWwob3RoZXIuZmllbGQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gTmFuRmlsdGVyO1xyXG59KEZpbHRlcikpO1xyXG4vKipcclxuICogVGhlIGRpcmVjdGlvbiBvZiBzb3J0aW5nIGluIGFuIG9yZGVyIGJ5LlxyXG4gKi9cclxudmFyIERpcmVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERpcmVjdGlvbihuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIH1cclxuICAgIERpcmVjdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmFtZTtcclxuICAgIH07XHJcbiAgICBEaXJlY3Rpb24uQVNDRU5ESU5HID0gbmV3IERpcmVjdGlvbignYXNjJyk7XHJcbiAgICBEaXJlY3Rpb24uREVTQ0VORElORyA9IG5ldyBEaXJlY3Rpb24oJ2Rlc2MnKTtcclxuICAgIHJldHVybiBEaXJlY3Rpb247XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgYm91bmQgb2YgYSBxdWVyeS5cclxuICpcclxuICogVGhlIGJvdW5kIGlzIHNwZWNpZmllZCB3aXRoIHRoZSBnaXZlbiBjb21wb25lbnRzIHJlcHJlc2VudGluZyBhIHBvc2l0aW9uIGFuZFxyXG4gKiB3aGV0aGVyIGl0J3MganVzdCBiZWZvcmUgb3IganVzdCBhZnRlciB0aGUgcG9zaXRpb24gKHJlbGF0aXZlIHRvIHdoYXRldmVyIHRoZVxyXG4gKiBxdWVyeSBvcmRlciBpcykuXHJcbiAqXHJcbiAqIFRoZSBwb3NpdGlvbiByZXByZXNlbnRzIGEgbG9naWNhbCBpbmRleCBwb3NpdGlvbiBmb3IgYSBxdWVyeS4gSXQncyBhIHByZWZpeFxyXG4gKiBvZiB2YWx1ZXMgZm9yIHRoZSAocG90ZW50aWFsbHkgaW1wbGljaXQpIG9yZGVyIGJ5IGNsYXVzZXMgb2YgYSBxdWVyeS5cclxuICpcclxuICogQm91bmQgcHJvdmlkZXMgYSBmdW5jdGlvbiB0byBkZXRlcm1pbmUgd2hldGhlciBhIGRvY3VtZW50IGNvbWVzIGJlZm9yZSBvclxyXG4gKiBhZnRlciBhIGJvdW5kLiBUaGlzIGlzIGluZmx1ZW5jZWQgYnkgd2hldGhlciB0aGUgcG9zaXRpb24gaXMganVzdCBiZWZvcmUgb3JcclxuICoganVzdCBhZnRlciB0aGUgcHJvdmlkZWQgdmFsdWVzLlxyXG4gKi9cclxudmFyIEJvdW5kID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQm91bmQocG9zaXRpb24sIGJlZm9yZSkge1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcclxuICAgICAgICB0aGlzLmJlZm9yZSA9IGJlZm9yZTtcclxuICAgIH1cclxuICAgIEJvdW5kLnByb3RvdHlwZS5jYW5vbmljYWxJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBUT0RPKGIvMjkxODMxNjUpOiBNYWtlIHRoaXMgY29sbGlzaW9uIHJvYnVzdC5cclxuICAgICAgICB2YXIgY2Fub25pY2FsSWQgPSB0aGlzLmJlZm9yZSA/ICdiOicgOiAnYTonO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLnBvc2l0aW9uOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgY29tcG9uZW50ID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBjYW5vbmljYWxJZCArPSBjb21wb25lbnQudG9TdHJpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhbm9uaWNhbElkO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGEgZG9jdW1lbnQgc29ydHMgYmVmb3JlIGEgYm91bmQgdXNpbmcgdGhlIHByb3ZpZGVkIHNvcnRcclxuICAgICAqIG9yZGVyLlxyXG4gICAgICovXHJcbiAgICBCb3VuZC5wcm90b3R5cGUuc29ydHNCZWZvcmVEb2N1bWVudCA9IGZ1bmN0aW9uIChvcmRlckJ5LCBkb2MpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5wb3NpdGlvbi5sZW5ndGggPD0gb3JkZXJCeS5sZW5ndGgsIFwiQm91bmQgaGFzIG1vcmUgY29tcG9uZW50cyB0aGFuIHF1ZXJ5J3Mgb3JkZXJCeVwiKTtcclxuICAgICAgICB2YXIgY29tcGFyaXNvbiA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBvc2l0aW9uLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBvcmRlckJ5Q29tcG9uZW50ID0gb3JkZXJCeVtpXTtcclxuICAgICAgICAgICAgdmFyIGNvbXBvbmVudCA9IHRoaXMucG9zaXRpb25baV07XHJcbiAgICAgICAgICAgIGlmIChvcmRlckJ5Q29tcG9uZW50LmZpZWxkLmlzS2V5RmllbGQoKSkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGNvbXBvbmVudCBpbnN0YW5jZW9mIFJlZlZhbHVlLCAnQm91bmQgaGFzIGEgbm9uLWtleSB2YWx1ZSB3aGVyZSB0aGUga2V5IHBhdGggaXMgYmVpbmcgdXNlZC4nKTtcclxuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBEb2N1bWVudEtleS5jb21wYXJhdG9yKGNvbXBvbmVudC5rZXksIGRvYy5rZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRvY1ZhbHVlID0gZG9jLmZpZWxkKG9yZGVyQnlDb21wb25lbnQuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGRvY1ZhbHVlICE9PSB1bmRlZmluZWQsICdGaWVsZCBzaG91bGQgZXhpc3Qgc2luY2UgZG9jdW1lbnQgbWF0Y2hlZCB0aGUgb3JkZXJCeSBhbHJlYWR5LicpO1xyXG4gICAgICAgICAgICAgICAgY29tcGFyaXNvbiA9IGNvbXBvbmVudC5jb21wYXJlVG8oZG9jVmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvcmRlckJ5Q29tcG9uZW50LmRpciA9PT0gRGlyZWN0aW9uLkRFU0NFTkRJTkcpIHtcclxuICAgICAgICAgICAgICAgIGNvbXBhcmlzb24gPSBjb21wYXJpc29uICogLTE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNvbXBhcmlzb24gIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmJlZm9yZSA/IGNvbXBhcmlzb24gPD0gMCA6IGNvbXBhcmlzb24gPCAwO1xyXG4gICAgfTtcclxuICAgIEJvdW5kLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKG90aGVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuYmVmb3JlICE9PSBvdGhlci5iZWZvcmUgfHxcclxuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi5sZW5ndGggIT09IG90aGVyLnBvc2l0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wb3NpdGlvbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdGhpc1Bvc2l0aW9uID0gdGhpcy5wb3NpdGlvbltpXTtcclxuICAgICAgICAgICAgdmFyIG90aGVyUG9zaXRpb24gPSBvdGhlci5wb3NpdGlvbltpXTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNQb3NpdGlvbi5pc0VxdWFsKG90aGVyUG9zaXRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQm91bmQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBbiBvcmRlcmluZyBvbiBhIGZpZWxkLCBpbiBzb21lIERpcmVjdGlvbi4gRGlyZWN0aW9uIGRlZmF1bHRzIHRvIEFTQ0VORElORy5cclxuICovXHJcbnZhciBPcmRlckJ5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gT3JkZXJCeShmaWVsZCwgZGlyKSB7XHJcbiAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkO1xyXG4gICAgICAgIGlmIChkaXIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBkaXIgPSBEaXJlY3Rpb24uQVNDRU5ESU5HO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRpciA9IGRpcjtcclxuICAgICAgICB0aGlzLmlzS2V5T3JkZXJCeSA9IGZpZWxkLmlzS2V5RmllbGQoKTtcclxuICAgIH1cclxuICAgIE9yZGVyQnkucHJvdG90eXBlLmNvbXBhcmUgPSBmdW5jdGlvbiAoZDEsIGQyKSB7XHJcbiAgICAgICAgdmFyIGNvbXBhcmlzb24gPSB0aGlzLmlzS2V5T3JkZXJCeVxyXG4gICAgICAgICAgICA/IERvY3VtZW50LmNvbXBhcmVCeUtleShkMSwgZDIpXHJcbiAgICAgICAgICAgIDogRG9jdW1lbnQuY29tcGFyZUJ5RmllbGQodGhpcy5maWVsZCwgZDEsIGQyKTtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuZGlyKSB7XHJcbiAgICAgICAgICAgIGNhc2UgRGlyZWN0aW9uLkFTQ0VORElORzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wYXJpc29uO1xyXG4gICAgICAgICAgICBjYXNlIERpcmVjdGlvbi5ERVNDRU5ESU5HOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xICogY29tcGFyaXNvbjtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIGRpcmVjdGlvbjogJyArIHRoaXMuZGlyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT3JkZXJCeS5wcm90b3R5cGUuY2Fub25pY2FsSWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogTWFrZSB0aGlzIGNvbGxpc2lvbiByb2J1c3QuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyB0aGlzLmRpci50b1N0cmluZygpO1xyXG4gICAgfTtcclxuICAgIE9yZGVyQnkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpICsgXCIgKFwiICsgdGhpcy5kaXIgKyBcIilcIjtcclxuICAgIH07XHJcbiAgICBPcmRlckJ5LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlyID09PSBvdGhlci5kaXIgJiYgdGhpcy5maWVsZC5pc0VxdWFsKG90aGVyLmZpZWxkKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gT3JkZXJCeTtcclxufSgpKTtcclxudmFyIEtFWV9PUkRFUklOR19BU0MgPSBuZXcgT3JkZXJCeShGaWVsZFBhdGgua2V5RmllbGQoKSwgRGlyZWN0aW9uLkFTQ0VORElORyk7XHJcbnZhciBLRVlfT1JERVJJTkdfREVTQyA9IG5ldyBPcmRlckJ5KEZpZWxkUGF0aC5rZXlGaWVsZCgpLCBEaXJlY3Rpb24uREVTQ0VORElORyk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQSB2ZXJzaW9uIG9mIGEgZG9jdW1lbnQgaW4gRmlyZXN0b3JlLiBUaGlzIGNvcnJlc3BvbmRzIHRvIHRoZSB2ZXJzaW9uXHJcbiAqIHRpbWVzdGFtcCwgc3VjaCBhcyB1cGRhdGVfdGltZSBvciByZWFkX3RpbWUuXHJcbiAqL1xyXG52YXIgU25hcHNob3RWZXJzaW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU25hcHNob3RWZXJzaW9uKHRpbWVzdGFtcCkge1xyXG4gICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wO1xyXG4gICAgfVxyXG4gICAgLy8gVE9ETyhiLzM0MTc2MzQ0KTogT25jZSB3ZSBubyBsb25nZXIgbmVlZCB0byB1c2UgdGhlIG9sZCBhbHBoYSBwcm90b3MsXHJcbiAgICAvLyBkZWxldGUgdGhpcyBjb25zdHJ1Y3RvciBhbmQgdXNlIGEgdGltZXN0YW1wLWJhY2tlZCB2ZXJzaW9uIGV2ZXJ5d2hlcmUuXHJcbiAgICBTbmFwc2hvdFZlcnNpb24uZnJvbU1pY3Jvc2Vjb25kcyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcih2YWx1ZSAvIDFlNik7XHJcbiAgICAgICAgdmFyIG5hbm9zID0gKHZhbHVlICUgMWU2KSAqIDFlMztcclxuICAgICAgICByZXR1cm4gbmV3IFNuYXBzaG90VmVyc2lvbihuZXcgVGltZXN0YW1wKHNlY29uZHMsIG5hbm9zKSk7XHJcbiAgICB9O1xyXG4gICAgU25hcHNob3RWZXJzaW9uLmZyb21UaW1lc3RhbXAgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNuYXBzaG90VmVyc2lvbih2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5NSU47XHJcbiAgICB9O1xyXG4gICAgU25hcHNob3RWZXJzaW9uLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuX2NvbXBhcmVUbyhvdGhlci50aW1lc3RhbXApO1xyXG4gICAgfTtcclxuICAgIFNuYXBzaG90VmVyc2lvbi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVzdGFtcC5pc0VxdWFsKG90aGVyLnRpbWVzdGFtcCk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFJldHVybnMgYSBudW1iZXIgcmVwcmVzZW50YXRpb24gb2YgdGhlIHZlcnNpb24gZm9yIHVzZSBpbiBzcGVjIHRlc3RzLiAqL1xyXG4gICAgU25hcHNob3RWZXJzaW9uLnByb3RvdHlwZS50b01pY3Jvc2Vjb25kcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBDb252ZXJ0IHRvIG1pY3Jvc2Vjb25kcy5cclxuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuc2Vjb25kcyAqIDFlNiArIHRoaXMudGltZXN0YW1wLm5hbm9zZWNvbmRzIC8gMTAwMDtcclxuICAgIH07XHJcbiAgICBTbmFwc2hvdFZlcnNpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAnU25hcHNob3RWZXJzaW9uKCcgKyB0aGlzLnRpbWVzdGFtcC50b1N0cmluZygpICsgJyknO1xyXG4gICAgfTtcclxuICAgIFNuYXBzaG90VmVyc2lvbi5wcm90b3R5cGUudG9UaW1lc3RhbXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wO1xyXG4gICAgfTtcclxuICAgIFNuYXBzaG90VmVyc2lvbi5NSU4gPSBuZXcgU25hcHNob3RWZXJzaW9uKG5ldyBUaW1lc3RhbXAoMCwgMCkpO1xyXG4gICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKiBBbiBlbnVtZXJhdGlvbiBvZiB0aGUgZGlmZmVyZW50IHB1cnBvc2VzIHdlIGhhdmUgZm9yIHF1ZXJpZXMuICovXHJcbnZhciBRdWVyeVB1cnBvc2U7XHJcbihmdW5jdGlvbiAoUXVlcnlQdXJwb3NlKSB7XHJcbiAgICAvKiogQSByZWd1bGFyLCBub3JtYWwgcXVlcnkuICovXHJcbiAgICBRdWVyeVB1cnBvc2VbUXVlcnlQdXJwb3NlW1wiTGlzdGVuXCJdID0gMF0gPSBcIkxpc3RlblwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcXVlcnkgd2FzIHVzZWQgdG8gcmVmaWxsIGEgcXVlcnkgYWZ0ZXIgYW4gZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaC5cclxuICAgICAqL1xyXG4gICAgUXVlcnlQdXJwb3NlW1F1ZXJ5UHVycG9zZVtcIkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoXCJdID0gMV0gPSBcIkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoXCI7XHJcbiAgICAvKiogVGhlIHF1ZXJ5IHdhcyB1c2VkIHRvIHJlc29sdmUgYSBsaW1ibyBkb2N1bWVudC4gKi9cclxuICAgIFF1ZXJ5UHVycG9zZVtRdWVyeVB1cnBvc2VbXCJMaW1ib1Jlc29sdXRpb25cIl0gPSAyXSA9IFwiTGltYm9SZXNvbHV0aW9uXCI7XHJcbn0pKFF1ZXJ5UHVycG9zZSB8fCAoUXVlcnlQdXJwb3NlID0ge30pKTtcclxuLyoqXHJcbiAqIEFuIGltbXV0YWJsZSBzZXQgb2YgbWV0YWRhdGEgdGhhdCB0aGUgbG9jYWwgc3RvcmUgdHJhY2tzIGZvciBlYWNoIHF1ZXJ5LlxyXG4gKi9cclxudmFyIFF1ZXJ5RGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5RGF0YShcclxuICAgIC8qKiBUaGUgcXVlcnkgYmVpbmcgbGlzdGVuZWQgdG8uICovXHJcbiAgICBxdWVyeSwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSB0YXJnZXQgSUQgdG8gd2hpY2ggdGhlIHF1ZXJ5IGNvcnJlc3BvbmRzOyBBc3NpZ25lZCBieSB0aGVcclxuICAgICAqIExvY2FsU3RvcmUgZm9yIHVzZXIgbGlzdGVucyBhbmQgYnkgdGhlIFN5bmNFbmdpbmUgZm9yIGxpbWJvIHdhdGNoZXMuXHJcbiAgICAgKi9cclxuICAgIHRhcmdldElkLCBcclxuICAgIC8qKiBUaGUgcHVycG9zZSBvZiB0aGUgcXVlcnkuICovXHJcbiAgICBwdXJwb3NlLCBcclxuICAgIC8qKiBUaGUgc2VxdWVuY2UgbnVtYmVyIG9mIHRoZSBsYXN0IHRyYW5zYWN0aW9uIGR1cmluZyB3aGljaCB0aGlzIHF1ZXJ5IGRhdGEgd2FzIG1vZGlmaWVkICovXHJcbiAgICBzZXF1ZW5jZU51bWJlciwgXHJcbiAgICAvKiogVGhlIGxhdGVzdCBzbmFwc2hvdCB2ZXJzaW9uIHNlZW4gZm9yIHRoaXMgdGFyZ2V0LiAqL1xyXG4gICAgc25hcHNob3RWZXJzaW9uLCBcclxuICAgIC8qKlxyXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSBxdWVyeSB0byBiZVxyXG4gICAgICogcmVzdW1lZCBhZnRlciBkaXNjb25uZWN0aW5nIHdpdGhvdXQgcmV0cmFuc21pdHRpbmcgYWxsIHRoZSBkYXRhIHRoYXRcclxuICAgICAqIG1hdGNoZXMgdGhlIHF1ZXJ5LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpblxyXG4gICAgICogdGltZSBmcm9tIHdoaWNoIHRoZSBzZXJ2ZXIgc2hvdWxkIHJlc3VtZSBzZW5kaW5nIHJlc3VsdHMuXHJcbiAgICAgKi9cclxuICAgIHJlc3VtZVRva2VuKSB7XHJcbiAgICAgICAgaWYgKHNuYXBzaG90VmVyc2lvbiA9PT0gdm9pZCAwKSB7IHNuYXBzaG90VmVyc2lvbiA9IFNuYXBzaG90VmVyc2lvbi5NSU47IH1cclxuICAgICAgICBpZiAocmVzdW1lVG9rZW4gPT09IHZvaWQgMCkgeyByZXN1bWVUb2tlbiA9IGVtcHR5Qnl0ZVN0cmluZygpOyB9XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICB0aGlzLnB1cnBvc2UgPSBwdXJwb3NlO1xyXG4gICAgICAgIHRoaXMuc2VxdWVuY2VOdW1iZXIgPSBzZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICB0aGlzLnNuYXBzaG90VmVyc2lvbiA9IHNuYXBzaG90VmVyc2lvbjtcclxuICAgICAgICB0aGlzLnJlc3VtZVRva2VuID0gcmVzdW1lVG9rZW47XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBuZXcgcXVlcnkgZGF0YSBpbnN0YW5jZSB3aXRoIGFuIHVwZGF0ZWQgc25hcHNob3QgdmVyc2lvbiBhbmRcclxuICAgICAqIHJlc3VtZSB0b2tlbi5cclxuICAgICAqL1xyXG4gICAgUXVlcnlEYXRhLnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKG92ZXJ3cml0ZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnlEYXRhKHRoaXMucXVlcnksIHRoaXMudGFyZ2V0SWQsIHRoaXMucHVycG9zZSwgb3ZlcndyaXRlLnNlcXVlbmNlTnVtYmVyID09PSB1bmRlZmluZWRcclxuICAgICAgICAgICAgPyB0aGlzLnNlcXVlbmNlTnVtYmVyXHJcbiAgICAgICAgICAgIDogb3ZlcndyaXRlLnNlcXVlbmNlTnVtYmVyLCBvdmVyd3JpdGUuc25hcHNob3RWZXJzaW9uID09PSB1bmRlZmluZWRcclxuICAgICAgICAgICAgPyB0aGlzLnNuYXBzaG90VmVyc2lvblxyXG4gICAgICAgICAgICA6IG92ZXJ3cml0ZS5zbmFwc2hvdFZlcnNpb24sIG92ZXJ3cml0ZS5yZXN1bWVUb2tlbiA9PT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgID8gdGhpcy5yZXN1bWVUb2tlblxyXG4gICAgICAgICAgICA6IG92ZXJ3cml0ZS5yZXN1bWVUb2tlbik7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlEYXRhLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLnRhcmdldElkID09PSBvdGhlci50YXJnZXRJZCAmJlxyXG4gICAgICAgICAgICB0aGlzLnB1cnBvc2UgPT09IG90aGVyLnB1cnBvc2UgJiZcclxuICAgICAgICAgICAgdGhpcy5zZXF1ZW5jZU51bWJlciA9PT0gb3RoZXIuc2VxdWVuY2VOdW1iZXIgJiZcclxuICAgICAgICAgICAgdGhpcy5zbmFwc2hvdFZlcnNpb24uaXNFcXVhbChvdGhlci5zbmFwc2hvdFZlcnNpb24pICYmXHJcbiAgICAgICAgICAgIHRoaXMucmVzdW1lVG9rZW4gPT09IG90aGVyLnJlc3VtZVRva2VuICYmXHJcbiAgICAgICAgICAgIHRoaXMucXVlcnkuaXNFcXVhbChvdGhlci5xdWVyeSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeURhdGE7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZXMgYSBzZXQgb2YgZmllbGRzIHRoYXQgY2FuIGJlIHVzZWQgdG8gcGFydGlhbGx5IHBhdGNoIGEgZG9jdW1lbnQuXHJcbiAqIEZpZWxkTWFzayBpcyB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggT2JqZWN0VmFsdWUuXHJcbiAqIEV4YW1wbGVzOlxyXG4gKiAgIGZvbyAtIE92ZXJ3cml0ZXMgZm9vIGVudGlyZWx5IHdpdGggdGhlIHByb3ZpZGVkIHZhbHVlLiBJZiBmb28gaXMgbm90XHJcbiAqICAgICAgICAgcHJlc2VudCBpbiB0aGUgY29tcGFuaW9uIE9iamVjdFZhbHVlLCB0aGUgZmllbGQgaXMgZGVsZXRlZC5cclxuICogICBmb28uYmFyIC0gT3ZlcndyaXRlcyBvbmx5IHRoZSBmaWVsZCBiYXIgb2YgdGhlIG9iamVjdCBmb28uXHJcbiAqICAgICAgICAgICAgIElmIGZvbyBpcyBub3QgYW4gb2JqZWN0LCBmb28gaXMgcmVwbGFjZWQgd2l0aCBhbiBvYmplY3RcclxuICogICAgICAgICAgICAgY29udGFpbmluZyBmb29cclxuICovXHJcbnZhciBGaWVsZE1hc2sgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaWVsZE1hc2soZmllbGRzKSB7XHJcbiAgICAgICAgdGhpcy5maWVsZHMgPSBmaWVsZHM7XHJcbiAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiB2YWxpZGF0aW9uIG9mIEZpZWxkTWFza1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBWZXJpZmllcyB0aGF0IGBmaWVsZFBhdGhgIGlzIGluY2x1ZGVkIGJ5IGF0IGxlYXN0IG9uZSBmaWVsZCBpbiB0aGlzIGZpZWxkXHJcbiAgICAgKiBtYXNrLlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgaXMgYW4gTyhuKSBvcGVyYXRpb24sIHdoZXJlIGBuYCBpcyB0aGUgc2l6ZSBvZiB0aGUgZmllbGQgbWFzay5cclxuICAgICAqL1xyXG4gICAgRmllbGRNYXNrLnByb3RvdHlwZS5jb3ZlcnMgPSBmdW5jdGlvbiAoZmllbGRQYXRoKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZmllbGRzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZmllbGRNYXNrUGF0aCA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKGZpZWxkTWFza1BhdGguaXNQcmVmaXhPZihmaWVsZFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgRmllbGRNYXNrLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGFycmF5RXF1YWxzKHRoaXMuZmllbGRzLCBvdGhlci5maWVsZHMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBGaWVsZE1hc2s7XHJcbn0oKSk7XHJcbi8qKiBBIGZpZWxkIHBhdGggYW5kIHRoZSBUcmFuc2Zvcm1PcGVyYXRpb24gdG8gcGVyZm9ybSB1cG9uIGl0LiAqL1xyXG52YXIgRmllbGRUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGaWVsZFRyYW5zZm9ybShmaWVsZCwgdHJhbnNmb3JtKSB7XHJcbiAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkO1xyXG4gICAgICAgIHRoaXMudHJhbnNmb3JtID0gdHJhbnNmb3JtO1xyXG4gICAgfVxyXG4gICAgRmllbGRUcmFuc2Zvcm0ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuZmllbGQuaXNFcXVhbChvdGhlci5maWVsZCkgJiYgdGhpcy50cmFuc2Zvcm0uaXNFcXVhbChvdGhlci50cmFuc2Zvcm0pKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmllbGRUcmFuc2Zvcm07XHJcbn0oKSk7XHJcbi8qKiBUaGUgcmVzdWx0IG9mIHN1Y2Nlc3NmdWxseSBhcHBseWluZyBhIG11dGF0aW9uIHRvIHRoZSBiYWNrZW5kLiAqL1xyXG52YXIgTXV0YXRpb25SZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNdXRhdGlvblJlc3VsdChcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHZlcnNpb24gYXQgd2hpY2ggdGhlIG11dGF0aW9uIHdhcyBjb21taXR0ZWQ6XHJcbiAgICAgKlxyXG4gICAgICogLSBGb3IgbW9zdCBvcGVyYXRpb25zLCB0aGlzIGlzIHRoZSB1cGRhdGVUaW1lIGluIHRoZSBXcml0ZVJlc3VsdC5cclxuICAgICAqIC0gRm9yIGRlbGV0ZXMsIHRoZSBjb21taXRUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIChiZWNhdXNlIGRlbGV0ZXMgYXJlXHJcbiAgICAgKiAgIG5vdCBzdG9yZWQgYW5kIGhhdmUgbm8gdXBkYXRlVGltZSkuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IHRoZXNlIHZlcnNpb25zIGNhbiBiZSBkaWZmZXJlbnQ6IE5vLW9wIHdyaXRlcyB3aWxsIG5vdCBjaGFuZ2VcclxuICAgICAqIHRoZSB1cGRhdGVUaW1lIGV2ZW4gdGhvdWdoIHRoZSBjb21taXRUaW1lIGFkdmFuY2VzLlxyXG4gICAgICovXHJcbiAgICB2ZXJzaW9uLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHJlc3VsdGluZyBmaWVsZHMgcmV0dXJuZWQgZnJvbSB0aGUgYmFja2VuZCBhZnRlciBhXHJcbiAgICAgKiBUcmFuc2Zvcm1NdXRhdGlvbiBoYXMgYmVlbiBjb21taXR0ZWQuIENvbnRhaW5zIG9uZSBGaWVsZFZhbHVlIGZvciBlYWNoXHJcbiAgICAgKiBGaWVsZFRyYW5zZm9ybSB0aGF0IHdhcyBpbiB0aGUgbXV0YXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogV2lsbCBiZSBudWxsIGlmIHRoZSBtdXRhdGlvbiB3YXMgbm90IGEgVHJhbnNmb3JtTXV0YXRpb24uXHJcbiAgICAgKi9cclxuICAgIHRyYW5zZm9ybVJlc3VsdHMpIHtcclxuICAgICAgICB0aGlzLnZlcnNpb24gPSB2ZXJzaW9uO1xyXG4gICAgICAgIHRoaXMudHJhbnNmb3JtUmVzdWx0cyA9IHRyYW5zZm9ybVJlc3VsdHM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTXV0YXRpb25SZXN1bHQ7XHJcbn0oKSk7XHJcbnZhciBNdXRhdGlvblR5cGU7XHJcbihmdW5jdGlvbiAoTXV0YXRpb25UeXBlKSB7XHJcbiAgICBNdXRhdGlvblR5cGVbTXV0YXRpb25UeXBlW1wiU2V0XCJdID0gMF0gPSBcIlNldFwiO1xyXG4gICAgTXV0YXRpb25UeXBlW011dGF0aW9uVHlwZVtcIlBhdGNoXCJdID0gMV0gPSBcIlBhdGNoXCI7XHJcbiAgICBNdXRhdGlvblR5cGVbTXV0YXRpb25UeXBlW1wiVHJhbnNmb3JtXCJdID0gMl0gPSBcIlRyYW5zZm9ybVwiO1xyXG4gICAgTXV0YXRpb25UeXBlW011dGF0aW9uVHlwZVtcIkRlbGV0ZVwiXSA9IDNdID0gXCJEZWxldGVcIjtcclxufSkoTXV0YXRpb25UeXBlIHx8IChNdXRhdGlvblR5cGUgPSB7fSkpO1xyXG4vKipcclxuICogRW5jb2RlcyBhIHByZWNvbmRpdGlvbiBmb3IgYSBtdXRhdGlvbi4gVGhpcyBmb2xsb3dzIHRoZSBtb2RlbCB0aGF0IHRoZVxyXG4gKiBiYWNrZW5kIGFjY2VwdHMgd2l0aCB0aGUgc3BlY2lhbCBjYXNlIG9mIGFuIGV4cGxpY2l0IFwiZW1wdHlcIiBwcmVjb25kaXRpb25cclxuICogKG1lYW5pbmcgbm8gcHJlY29uZGl0aW9uKS5cclxuICovXHJcbnZhciBQcmVjb25kaXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQcmVjb25kaXRpb24odXBkYXRlVGltZSwgZXhpc3RzKSB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVUaW1lID0gdXBkYXRlVGltZTtcclxuICAgICAgICB0aGlzLmV4aXN0cyA9IGV4aXN0cztcclxuICAgICAgICBhc3NlcnQodXBkYXRlVGltZSA9PT0gdW5kZWZpbmVkIHx8IGV4aXN0cyA9PT0gdW5kZWZpbmVkLCAnUHJlY29uZGl0aW9uIGNhbiBzcGVjaWZ5IFwiZXhpc3RzXCIgb3IgXCJ1cGRhdGVUaW1lXCIgYnV0IG5vdCBib3RoJyk7XHJcbiAgICB9XHJcbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBQcmVjb25kaXRpb24gd2l0aCBhbiBleGlzdHMgZmxhZy4gKi9cclxuICAgIFByZWNvbmRpdGlvbi5leGlzdHMgPSBmdW5jdGlvbiAoZXhpc3RzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcmVjb25kaXRpb24odW5kZWZpbmVkLCBleGlzdHMpO1xyXG4gICAgfTtcclxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IFByZWNvbmRpdGlvbiBiYXNlZCBvbiBhIHZlcnNpb24gYSBkb2N1bWVudCBleGlzdHMgYXQuICovXHJcbiAgICBQcmVjb25kaXRpb24udXBkYXRlVGltZSA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcmVjb25kaXRpb24odmVyc2lvbik7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByZWNvbmRpdGlvbi5wcm90b3R5cGUsIFwiaXNOb25lXCIsIHtcclxuICAgICAgICAvKiogUmV0dXJucyB3aGV0aGVyIHRoaXMgUHJlY29uZGl0aW9uIGlzIGVtcHR5LiAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy51cGRhdGVUaW1lID09PSB1bmRlZmluZWQgJiYgdGhpcy5leGlzdHMgPT09IHVuZGVmaW5lZDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcmVjb25kaXRpb25zIGlzIHZhbGlkIGZvciB0aGUgZ2l2ZW4gZG9jdW1lbnRcclxuICAgICAqIChvciBudWxsIGlmIG5vIGRvY3VtZW50IGlzIGF2YWlsYWJsZSkuXHJcbiAgICAgKi9cclxuICAgIFByZWNvbmRpdGlvbi5wcm90b3R5cGUuaXNWYWxpZEZvciA9IGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgIGlmICh0aGlzLnVwZGF0ZVRpbWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQgJiZcclxuICAgICAgICAgICAgICAgIG1heWJlRG9jLnZlcnNpb24uaXNFcXVhbCh0aGlzLnVwZGF0ZVRpbWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5leGlzdHMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leGlzdHMgPT09IG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy5pc05vbmUsICdQcmVjb25kaXRpb24gc2hvdWxkIGJlIGVtcHR5Jyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQcmVjb25kaXRpb24ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKGVxdWFscyh0aGlzLnVwZGF0ZVRpbWUsIG90aGVyLnVwZGF0ZVRpbWUpICYmXHJcbiAgICAgICAgICAgIHRoaXMuZXhpc3RzID09PSBvdGhlci5leGlzdHMpO1xyXG4gICAgfTtcclxuICAgIFByZWNvbmRpdGlvbi5OT05FID0gbmV3IFByZWNvbmRpdGlvbigpO1xyXG4gICAgcmV0dXJuIFByZWNvbmRpdGlvbjtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgbXV0YXRpb24gZGVzY3JpYmVzIGEgc2VsZi1jb250YWluZWQgY2hhbmdlIHRvIGEgZG9jdW1lbnQuIE11dGF0aW9ucyBjYW5cclxuICogY3JlYXRlLCByZXBsYWNlLCBkZWxldGUsIGFuZCB1cGRhdGUgc3Vic2V0cyBvZiBkb2N1bWVudHMuXHJcbiAqXHJcbiAqIE11dGF0aW9ucyBub3Qgb25seSBhY3Qgb24gdGhlIHZhbHVlIG9mIHRoZSBkb2N1bWVudCBidXQgYWxzbyBpdCB2ZXJzaW9uLlxyXG4gKlxyXG4gKiBGb3IgbG9jYWwgbXV0YXRpb25zIChtdXRhdGlvbnMgdGhhdCBoYXZlbid0IGJlZW4gY29tbWl0dGVkIHlldCksIHdlIHByZXNlcnZlXHJcbiAqIHRoZSBleGlzdGluZyB2ZXJzaW9uIGZvciBTZXQsIFBhdGNoLCBhbmQgVHJhbnNmb3JtIG11dGF0aW9ucy4gRm9yIERlbGV0ZVxyXG4gKiBtdXRhdGlvbnMsIHdlIHJlc2V0IHRoZSB2ZXJzaW9uIHRvIDAuXHJcbiAqXHJcbiAqIEhlcmUncyB0aGUgZXhwZWN0ZWQgdHJhbnNpdGlvbiB0YWJsZS5cclxuICpcclxuICogTVVUQVRJT04gICAgICAgICAgIEFQUExJRUQgVE8gICAgICAgICAgICBSRVNVTFRTIElOXHJcbiAqXHJcbiAqIFNldE11dGF0aW9uICAgICAgICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXHJcbiAqIFNldE11dGF0aW9uICAgICAgICBOb0RvY3VtZW50KHYzKSAgICAgICAgRG9jdW1lbnQodjApXHJcbiAqIFNldE11dGF0aW9uICAgICAgICBudWxsICAgICAgICAgICAgICAgICAgRG9jdW1lbnQodjApXHJcbiAqIFBhdGNoTXV0YXRpb24gICAgICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXHJcbiAqIFBhdGNoTXV0YXRpb24gICAgICBOb0RvY3VtZW50KHYzKSAgICAgICAgTm9Eb2N1bWVudCh2MylcclxuICogUGF0Y2hNdXRhdGlvbiAgICAgIG51bGwgICAgICAgICAgICAgICAgICBudWxsXHJcbiAqIFRyYW5zZm9ybU11dGF0aW9uICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXHJcbiAqIFRyYW5zZm9ybU11dGF0aW9uICBOb0RvY3VtZW50KHYzKSAgICAgICAgTm9Eb2N1bWVudCh2MylcclxuICogVHJhbnNmb3JtTXV0YXRpb24gIG51bGwgICAgICAgICAgICAgICAgICBudWxsXHJcbiAqIERlbGV0ZU11dGF0aW9uICAgICBEb2N1bWVudCh2MykgICAgICAgICAgTm9Eb2N1bWVudCh2MClcclxuICogRGVsZXRlTXV0YXRpb24gICAgIE5vRG9jdW1lbnQodjMpICAgICAgICBOb0RvY3VtZW50KHYwKVxyXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgbnVsbCAgICAgICAgICAgICAgICAgIE5vRG9jdW1lbnQodjApXHJcbiAqXHJcbiAqIEZvciBhY2tub3dsZWRnZWQgbXV0YXRpb25zLCB3ZSB1c2UgdGhlIHVwZGF0ZVRpbWUgb2YgdGhlIFdyaXRlUmVzcG9uc2UgYXNcclxuICogdGhlIHJlc3VsdGluZyB2ZXJzaW9uIGZvciBTZXQsIFBhdGNoLCBhbmQgVHJhbnNmb3JtIG11dGF0aW9ucy4gQXMgZGVsZXRlc1xyXG4gKiBoYXZlIG5vIGV4cGxpY2l0IHVwZGF0ZSB0aW1lLCB3ZSB1c2UgdGhlIGNvbW1pdFRpbWUgb2YgdGhlIFdyaXRlUmVzcG9uc2UgZm9yXHJcbiAqIERlbGV0ZSBtdXRhdGlvbnMuXHJcbiAqXHJcbiAqIElmIGEgbXV0YXRpb24gaXMgYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kIGJ1dCBmYWlscyB0aGUgcHJlY29uZGl0aW9uIGNoZWNrXHJcbiAqIGxvY2FsbHksIHdlIHJldHVybiBhbiBgVW5rbm93bkRvY3VtZW50YCBhbmQgcmVseSBvbiBXYXRjaCB0byBzZW5kIHVzIHRoZVxyXG4gKiB1cGRhdGVkIHZlcnNpb24uXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCBUcmFuc2Zvcm1NdXRhdGlvbnMgZG9uJ3QgY3JlYXRlIERvY3VtZW50cyAoaW4gdGhlIGNhc2Ugb2YgYmVpbmdcclxuICogYXBwbGllZCB0byBhIE5vRG9jdW1lbnQpLCBldmVuIHRob3VnaCB0aGV5IHdvdWxkIG9uIHRoZSBiYWNrZW5kLiBUaGlzIGlzXHJcbiAqIGJlY2F1c2UgdGhlIGNsaWVudCBhbHdheXMgY29tYmluZXMgdGhlIFRyYW5zZm9ybU11dGF0aW9uIHdpdGggYSBTZXRNdXRhdGlvblxyXG4gKiBvciBQYXRjaE11dGF0aW9uIGFuZCB3ZSBvbmx5IHdhbnQgdG8gYXBwbHkgdGhlIHRyYW5zZm9ybSBpZiB0aGUgcHJpb3JcclxuICogbXV0YXRpb24gcmVzdWx0ZWQgaW4gYSBEb2N1bWVudCAoYWx3YXlzIHRydWUgZm9yIGEgU2V0TXV0YXRpb24sIGJ1dCBub3RcclxuICogbmVjZXNzYXJpbHkgZm9yIGEgUGF0Y2hNdXRhdGlvbikuXHJcbiAqXHJcbiAqICMjIFN1YmNsYXNzaW5nIE5vdGVzXHJcbiAqXHJcbiAqIFN1YmNsYXNzZXMgb2YgTXV0YXRpb24gbmVlZCB0byBpbXBsZW1lbnQgYXBwbHlUb1JlbW90ZURvY3VtZW50KCkgYW5kXHJcbiAqIGFwcGx5VG9Mb2NhbFZpZXcoKSB0byBpbXBsZW1lbnQgdGhlIGFjdHVhbCBiZWhhdmlvciBvZiBhcHBseWluZyB0aGUgbXV0YXRpb25cclxuICogdG8gc29tZSBzb3VyY2UgZG9jdW1lbnQuXHJcbiAqL1xyXG52YXIgTXV0YXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNdXRhdGlvbigpIHtcclxuICAgIH1cclxuICAgIE11dGF0aW9uLnByb3RvdHlwZS52ZXJpZnlLZXlNYXRjaGVzID0gZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgaWYgKG1heWJlRG9jICE9IG51bGwpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KG1heWJlRG9jLmtleS5pc0VxdWFsKHRoaXMua2V5KSwgJ0NhbiBvbmx5IGFwcGx5IGEgbXV0YXRpb24gdG8gYSBkb2N1bWVudCB3aXRoIHRoZSBzYW1lIGtleScpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHZlcnNpb24gZnJvbSB0aGUgZ2l2ZW4gZG9jdW1lbnQgZm9yIHVzZSBhcyB0aGUgcmVzdWx0IG9mIGFcclxuICAgICAqIG11dGF0aW9uLiBNdXRhdGlvbnMgYXJlIGRlZmluZWQgdG8gcmV0dXJuIHRoZSB2ZXJzaW9uIG9mIHRoZSBiYXNlIGRvY3VtZW50XHJcbiAgICAgKiBvbmx5IGlmIGl0IGlzIGFuIGV4aXN0aW5nIGRvY3VtZW50LiBEZWxldGVkIGFuZCB1bmtub3duIGRvY3VtZW50cyBoYXZlIGFcclxuICAgICAqIHBvc3QtbXV0YXRpb24gdmVyc2lvbiBvZiBTbmFwc2hvdFZlcnNpb24uTUlOLlxyXG4gICAgICovXHJcbiAgICBNdXRhdGlvbi5nZXRQb3N0TXV0YXRpb25WZXJzaW9uID0gZnVuY3Rpb24gKG1heWJlRG9jKSB7XHJcbiAgICAgICAgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1heWJlRG9jLnZlcnNpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLk1JTjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE11dGF0aW9uO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBtdXRhdGlvbiB0aGF0IGNyZWF0ZXMgb3IgcmVwbGFjZXMgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkgd2l0aCB0aGVcclxuICogb2JqZWN0IHZhbHVlIGNvbnRlbnRzLlxyXG4gKi9cclxudmFyIFNldE11dGF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU2V0TXV0YXRpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBTZXRNdXRhdGlvbihrZXksIHZhbHVlLCBwcmVjb25kaXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmtleSA9IGtleTtcclxuICAgICAgICBfdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIF90aGlzLnByZWNvbmRpdGlvbiA9IHByZWNvbmRpdGlvbjtcclxuICAgICAgICBfdGhpcy50eXBlID0gTXV0YXRpb25UeXBlLlNldDtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBTZXRNdXRhdGlvbi5wcm90b3R5cGUuYXBwbHlUb1JlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKG1heWJlRG9jLCBtdXRhdGlvblJlc3VsdCkge1xyXG4gICAgICAgIHRoaXMudmVyaWZ5S2V5TWF0Y2hlcyhtYXliZURvYyk7XHJcbiAgICAgICAgYXNzZXJ0KG11dGF0aW9uUmVzdWx0LnRyYW5zZm9ybVJlc3VsdHMgPT0gbnVsbCwgJ1RyYW5zZm9ybSByZXN1bHRzIHJlY2VpdmVkIGJ5IFNldE11dGF0aW9uLicpO1xyXG4gICAgICAgIC8vIFVubGlrZSBhcHBseVRvTG9jYWxWaWV3LCBpZiB3ZSdyZSBhcHBseWluZyBhIG11dGF0aW9uIHRvIGEgcmVtb3RlXHJcbiAgICAgICAgLy8gZG9jdW1lbnQgdGhlIHNlcnZlciBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uIHNvIHRoZSBwcmVjb25kaXRpb24gbXVzdFxyXG4gICAgICAgIC8vIGhhdmUgaGVsZC5cclxuICAgICAgICB2YXIgdmVyc2lvbiA9IG11dGF0aW9uUmVzdWx0LnZlcnNpb247XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudCh0aGlzLmtleSwgdmVyc2lvbiwgdGhpcy52YWx1ZSwge1xyXG4gICAgICAgICAgICBoYXNDb21taXR0ZWRNdXRhdGlvbnM6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTZXRNdXRhdGlvbi5wcm90b3R5cGUuYXBwbHlUb0xvY2FsVmlldyA9IGZ1bmN0aW9uIChtYXliZURvYywgYmFzZURvYywgbG9jYWxXcml0ZVRpbWUpIHtcclxuICAgICAgICB0aGlzLnZlcmlmeUtleU1hdGNoZXMobWF5YmVEb2MpO1xyXG4gICAgICAgIGlmICghdGhpcy5wcmVjb25kaXRpb24uaXNWYWxpZEZvcihtYXliZURvYykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1heWJlRG9jO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdmVyc2lvbiA9IE11dGF0aW9uLmdldFBvc3RNdXRhdGlvblZlcnNpb24obWF5YmVEb2MpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnQodGhpcy5rZXksIHZlcnNpb24sIHRoaXMudmFsdWUsIHtcclxuICAgICAgICAgICAgaGFzTG9jYWxNdXRhdGlvbnM6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTZXRNdXRhdGlvbi5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAob3RoZXIgaW5zdGFuY2VvZiBTZXRNdXRhdGlvbiAmJlxyXG4gICAgICAgICAgICB0aGlzLmtleS5pc0VxdWFsKG90aGVyLmtleSkgJiZcclxuICAgICAgICAgICAgdGhpcy52YWx1ZS5pc0VxdWFsKG90aGVyLnZhbHVlKSAmJlxyXG4gICAgICAgICAgICB0aGlzLnByZWNvbmRpdGlvbi5pc0VxdWFsKG90aGVyLnByZWNvbmRpdGlvbikpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTZXRNdXRhdGlvbjtcclxufShNdXRhdGlvbikpO1xyXG4vKipcclxuICogQSBtdXRhdGlvbiB0aGF0IG1vZGlmaWVzIGZpZWxkcyBvZiB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoIHRoZVxyXG4gKiBnaXZlbiB2YWx1ZXMuIFRoZSB2YWx1ZXMgYXJlIGFwcGxpZWQgdGhyb3VnaCBhIGZpZWxkIG1hc2s6XHJcbiAqXHJcbiAqICAqIFdoZW4gYSBmaWVsZCBpcyBpbiBib3RoIHRoZSBtYXNrIGFuZCB0aGUgdmFsdWVzLCB0aGUgY29ycmVzcG9uZGluZyBmaWVsZFxyXG4gKiAgICBpcyB1cGRhdGVkLlxyXG4gKiAgKiBXaGVuIGEgZmllbGQgaXMgaW4gbmVpdGhlciB0aGUgbWFzayBub3IgdGhlIHZhbHVlcywgdGhlIGNvcnJlc3BvbmRpbmdcclxuICogICAgZmllbGQgaXMgdW5tb2RpZmllZC5cclxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIHRoZSBtYXNrIGJ1dCBub3QgaW4gdGhlIHZhbHVlcywgdGhlIGNvcnJlc3BvbmRpbmcgZmllbGRcclxuICogICAgaXMgZGVsZXRlZC5cclxuICogICogV2hlbiBhIGZpZWxkIGlzIG5vdCBpbiB0aGUgbWFzayBidXQgaXMgaW4gdGhlIHZhbHVlcywgdGhlIHZhbHVlcyBtYXAgaXNcclxuICogICAgaWdub3JlZC5cclxuICovXHJcbnZhciBQYXRjaE11dGF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUGF0Y2hNdXRhdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFBhdGNoTXV0YXRpb24oa2V5LCBkYXRhLCBmaWVsZE1hc2ssIHByZWNvbmRpdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIF90aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIF90aGlzLmZpZWxkTWFzayA9IGZpZWxkTWFzaztcclxuICAgICAgICBfdGhpcy5wcmVjb25kaXRpb24gPSBwcmVjb25kaXRpb247XHJcbiAgICAgICAgX3RoaXMudHlwZSA9IE11dGF0aW9uVHlwZS5QYXRjaDtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBQYXRjaE11dGF0aW9uLnByb3RvdHlwZS5hcHBseVRvUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAobWF5YmVEb2MsIG11dGF0aW9uUmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlLZXlNYXRjaGVzKG1heWJlRG9jKTtcclxuICAgICAgICBhc3NlcnQobXV0YXRpb25SZXN1bHQudHJhbnNmb3JtUmVzdWx0cyA9PSBudWxsLCAnVHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgUGF0Y2hNdXRhdGlvbi4nKTtcclxuICAgICAgICBpZiAoIXRoaXMucHJlY29uZGl0aW9uLmlzVmFsaWRGb3IobWF5YmVEb2MpKSB7XHJcbiAgICAgICAgICAgIC8vIFNpbmNlIHRoZSBtdXRhdGlvbiB3YXMgbm90IHJlamVjdGVkLCB3ZSBrbm93IHRoYXQgdGhlICBwcmVjb25kaXRpb25cclxuICAgICAgICAgICAgLy8gbWF0Y2hlZCBvbiB0aGUgYmFja2VuZC4gV2UgdGhlcmVmb3JlIG11c3Qgbm90IGhhdmUgdGhlIGV4cGVjdGVkIHZlcnNpb25cclxuICAgICAgICAgICAgLy8gb2YgdGhlIGRvY3VtZW50IGluIG91ciBjYWNoZSBhbmQgcmV0dXJuIGFuIFVua25vd25Eb2N1bWVudCB3aXRoIHRoZVxyXG4gICAgICAgICAgICAvLyBrbm93biB1cGRhdGVUaW1lLlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFVua25vd25Eb2N1bWVudCh0aGlzLmtleSwgbXV0YXRpb25SZXN1bHQudmVyc2lvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuZXdEYXRhID0gdGhpcy5wYXRjaERvY3VtZW50KG1heWJlRG9jKTtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KHRoaXMua2V5LCBtdXRhdGlvblJlc3VsdC52ZXJzaW9uLCBuZXdEYXRhLCB7XHJcbiAgICAgICAgICAgIGhhc0NvbW1pdHRlZE11dGF0aW9uczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFBhdGNoTXV0YXRpb24ucHJvdG90eXBlLmFwcGx5VG9Mb2NhbFZpZXcgPSBmdW5jdGlvbiAobWF5YmVEb2MsIGJhc2VEb2MsIGxvY2FsV3JpdGVUaW1lKSB7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlLZXlNYXRjaGVzKG1heWJlRG9jKTtcclxuICAgICAgICBpZiAoIXRoaXMucHJlY29uZGl0aW9uLmlzVmFsaWRGb3IobWF5YmVEb2MpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYXliZURvYztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSBNdXRhdGlvbi5nZXRQb3N0TXV0YXRpb25WZXJzaW9uKG1heWJlRG9jKTtcclxuICAgICAgICB2YXIgbmV3RGF0YSA9IHRoaXMucGF0Y2hEb2N1bWVudChtYXliZURvYyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudCh0aGlzLmtleSwgdmVyc2lvbiwgbmV3RGF0YSwge1xyXG4gICAgICAgICAgICBoYXNMb2NhbE11dGF0aW9uczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFBhdGNoTXV0YXRpb24ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgUGF0Y2hNdXRhdGlvbiAmJlxyXG4gICAgICAgICAgICB0aGlzLmtleS5pc0VxdWFsKG90aGVyLmtleSkgJiZcclxuICAgICAgICAgICAgdGhpcy5maWVsZE1hc2suaXNFcXVhbChvdGhlci5maWVsZE1hc2spICYmXHJcbiAgICAgICAgICAgIHRoaXMucHJlY29uZGl0aW9uLmlzRXF1YWwob3RoZXIucHJlY29uZGl0aW9uKSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXRjaGVzIHRoZSBkYXRhIG9mIGRvY3VtZW50IGlmIGF2YWlsYWJsZSBvciBjcmVhdGVzIGEgbmV3IGRvY3VtZW50LiBOb3RlXHJcbiAgICAgKiB0aGF0IHRoaXMgZG9lcyBub3QgY2hlY2sgd2hldGhlciBvciBub3QgdGhlIHByZWNvbmRpdGlvbiBvZiB0aGlzIHBhdGNoXHJcbiAgICAgKiBob2xkcy5cclxuICAgICAqL1xyXG4gICAgUGF0Y2hNdXRhdGlvbi5wcm90b3R5cGUucGF0Y2hEb2N1bWVudCA9IGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgIHZhciBkYXRhO1xyXG4gICAgICAgIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIGRhdGEgPSBtYXliZURvYy5kYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZGF0YSA9IE9iamVjdFZhbHVlLkVNUFRZO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5wYXRjaE9iamVjdChkYXRhKTtcclxuICAgIH07XHJcbiAgICBQYXRjaE11dGF0aW9uLnByb3RvdHlwZS5wYXRjaE9iamVjdCA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZmllbGRNYXNrLmZpZWxkczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGZpZWxkUGF0aCA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKCFmaWVsZFBhdGguaXNFbXB0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSB0aGlzLmRhdGEuZmllbGQoZmllbGRQYXRoKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGRhdGEuc2V0KGZpZWxkUGF0aCwgbmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGRhdGEuZGVsZXRlKGZpZWxkUGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBhdGNoTXV0YXRpb247XHJcbn0oTXV0YXRpb24pKTtcclxuLyoqXHJcbiAqIEEgbXV0YXRpb24gdGhhdCBtb2RpZmllcyBzcGVjaWZpYyBmaWVsZHMgb2YgdGhlIGRvY3VtZW50IHdpdGggdHJhbnNmb3JtXHJcbiAqIG9wZXJhdGlvbnMuIEN1cnJlbnRseSB0aGUgb25seSBzdXBwb3J0ZWQgdHJhbnNmb3JtIGlzIGEgc2VydmVyIHRpbWVzdGFtcCwgYnV0XHJcbiAqIElQIEFkZHJlc3MsIGluY3JlbWVudChuKSwgZXRjLiBjb3VsZCBiZSBzdXBwb3J0ZWQgaW4gdGhlIGZ1dHVyZS5cclxuICpcclxuICogSXQgaXMgc29tZXdoYXQgc2ltaWxhciB0byBhIFBhdGNoTXV0YXRpb24gaW4gdGhhdCBpdCBwYXRjaGVzIHNwZWNpZmljIGZpZWxkc1xyXG4gKiBhbmQgaGFzIG5vIGVmZmVjdCB3aGVuIGFwcGxpZWQgdG8gYSBudWxsIG9yIE5vRG9jdW1lbnQgKHNlZSBjb21tZW50IG9uXHJcbiAqIE11dGF0aW9uIGZvciByYXRpb25hbGUpLlxyXG4gKi9cclxudmFyIFRyYW5zZm9ybU11dGF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoVHJhbnNmb3JtTXV0YXRpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBUcmFuc2Zvcm1NdXRhdGlvbihrZXksIGZpZWxkVHJhbnNmb3Jtcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIF90aGlzLmZpZWxkVHJhbnNmb3JtcyA9IGZpZWxkVHJhbnNmb3JtcztcclxuICAgICAgICBfdGhpcy50eXBlID0gTXV0YXRpb25UeXBlLlRyYW5zZm9ybTtcclxuICAgICAgICAvLyBOT1RFOiBXZSBzZXQgYSBwcmVjb25kaXRpb24gb2YgZXhpc3RzOiB0cnVlIGFzIGEgc2FmZXR5LWNoZWNrLCBzaW5jZSB3ZVxyXG4gICAgICAgIC8vIGFsd2F5cyBjb21iaW5lIFRyYW5zZm9ybU11dGF0aW9ucyB3aXRoIGEgU2V0TXV0YXRpb24gb3IgUGF0Y2hNdXRhdGlvbiB3aGljaFxyXG4gICAgICAgIC8vIChpZiBzdWNjZXNzZnVsKSBzaG91bGQgZW5kIHVwIHdpdGggYW4gZXhpc3RpbmcgZG9jdW1lbnQuXHJcbiAgICAgICAgX3RoaXMucHJlY29uZGl0aW9uID0gUHJlY29uZGl0aW9uLmV4aXN0cyh0cnVlKTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBUcmFuc2Zvcm1NdXRhdGlvbi5wcm90b3R5cGUuYXBwbHlUb1JlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKG1heWJlRG9jLCBtdXRhdGlvblJlc3VsdCkge1xyXG4gICAgICAgIHRoaXMudmVyaWZ5S2V5TWF0Y2hlcyhtYXliZURvYyk7XHJcbiAgICAgICAgYXNzZXJ0KG11dGF0aW9uUmVzdWx0LnRyYW5zZm9ybVJlc3VsdHMgIT0gbnVsbCwgJ1RyYW5zZm9ybSByZXN1bHRzIG1pc3NpbmcgZm9yIFRyYW5zZm9ybU11dGF0aW9uLicpO1xyXG4gICAgICAgIGlmICghdGhpcy5wcmVjb25kaXRpb24uaXNWYWxpZEZvcihtYXliZURvYykpIHtcclxuICAgICAgICAgICAgLy8gU2luY2UgdGhlIG11dGF0aW9uIHdhcyBub3QgcmVqZWN0ZWQsIHdlIGtub3cgdGhhdCB0aGUgIHByZWNvbmRpdGlvblxyXG4gICAgICAgICAgICAvLyBtYXRjaGVkIG9uIHRoZSBiYWNrZW5kLiBXZSB0aGVyZWZvcmUgbXVzdCBub3QgaGF2ZSB0aGUgZXhwZWN0ZWQgdmVyc2lvblxyXG4gICAgICAgICAgICAvLyBvZiB0aGUgZG9jdW1lbnQgaW4gb3VyIGNhY2hlIGFuZCByZXR1cm4gYW4gVW5rbm93bkRvY3VtZW50IHdpdGggdGhlXHJcbiAgICAgICAgICAgIC8vIGtub3duIHVwZGF0ZVRpbWUuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVW5rbm93bkRvY3VtZW50KHRoaXMua2V5LCBtdXRhdGlvblJlc3VsdC52ZXJzaW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRvYyA9IHRoaXMucmVxdWlyZURvY3VtZW50KG1heWJlRG9jKTtcclxuICAgICAgICB2YXIgdHJhbnNmb3JtUmVzdWx0cyA9IHRoaXMuc2VydmVyVHJhbnNmb3JtUmVzdWx0cyhtYXliZURvYywgbXV0YXRpb25SZXN1bHQudHJhbnNmb3JtUmVzdWx0cyk7XHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSBtdXRhdGlvblJlc3VsdC52ZXJzaW9uO1xyXG4gICAgICAgIHZhciBuZXdEYXRhID0gdGhpcy50cmFuc2Zvcm1PYmplY3QoZG9jLmRhdGEsIHRyYW5zZm9ybVJlc3VsdHMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnQodGhpcy5rZXksIHZlcnNpb24sIG5ld0RhdGEsIHtcclxuICAgICAgICAgICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNmb3JtTXV0YXRpb24ucHJvdG90eXBlLmFwcGx5VG9Mb2NhbFZpZXcgPSBmdW5jdGlvbiAobWF5YmVEb2MsIGJhc2VEb2MsIGxvY2FsV3JpdGVUaW1lKSB7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlLZXlNYXRjaGVzKG1heWJlRG9jKTtcclxuICAgICAgICBpZiAoIXRoaXMucHJlY29uZGl0aW9uLmlzVmFsaWRGb3IobWF5YmVEb2MpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYXliZURvYztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRvYyA9IHRoaXMucmVxdWlyZURvY3VtZW50KG1heWJlRG9jKTtcclxuICAgICAgICB2YXIgdHJhbnNmb3JtUmVzdWx0cyA9IHRoaXMubG9jYWxUcmFuc2Zvcm1SZXN1bHRzKGxvY2FsV3JpdGVUaW1lLCBiYXNlRG9jKTtcclxuICAgICAgICB2YXIgbmV3RGF0YSA9IHRoaXMudHJhbnNmb3JtT2JqZWN0KGRvYy5kYXRhLCB0cmFuc2Zvcm1SZXN1bHRzKTtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KHRoaXMua2V5LCBkb2MudmVyc2lvbiwgbmV3RGF0YSwge1xyXG4gICAgICAgICAgICBoYXNMb2NhbE11dGF0aW9uczogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRyYW5zZm9ybU11dGF0aW9uLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIFRyYW5zZm9ybU11dGF0aW9uICYmXHJcbiAgICAgICAgICAgIHRoaXMua2V5LmlzRXF1YWwob3RoZXIua2V5KSAmJlxyXG4gICAgICAgICAgICBhcnJheUVxdWFscyh0aGlzLmZpZWxkVHJhbnNmb3Jtcywgb3RoZXIuZmllbGRUcmFuc2Zvcm1zKSAmJlxyXG4gICAgICAgICAgICB0aGlzLnByZWNvbmRpdGlvbi5pc0VxdWFsKG90aGVyLnByZWNvbmRpdGlvbikpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQXNzZXJ0cyB0aGF0IHRoZSBnaXZlbiBNYXliZURvY3VtZW50IGlzIGFjdHVhbGx5IGEgRG9jdW1lbnQgYW5kIHZlcmlmaWVzXHJcbiAgICAgKiB0aGF0IGl0IG1hdGNoZXMgdGhlIGtleSBmb3IgdGhpcyBtdXRhdGlvbi4gU2luY2Ugd2Ugb25seSBzdXBwb3J0XHJcbiAgICAgKiB0cmFuc2Zvcm1hdGlvbnMgd2l0aCBwcmVjb25kaXRpb24gZXhpc3RzIHRoaXMgbWV0aG9kIGlzIGd1YXJhbnRlZWQgdG8gYmVcclxuICAgICAqIHNhZmUuXHJcbiAgICAgKi9cclxuICAgIFRyYW5zZm9ybU11dGF0aW9uLnByb3RvdHlwZS5yZXF1aXJlRG9jdW1lbnQgPSBmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICBhc3NlcnQobWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCwgJ1Vua25vd24gTWF5YmVEb2N1bWVudCB0eXBlICcgKyBtYXliZURvYyk7XHJcbiAgICAgICAgdmFyIGRvYyA9IG1heWJlRG9jO1xyXG4gICAgICAgIGFzc2VydChkb2Mua2V5LmlzRXF1YWwodGhpcy5rZXkpLCAnQ2FuIG9ubHkgdHJhbnNmb3JtIGEgZG9jdW1lbnQgd2l0aCB0aGUgc2FtZSBrZXknKTtcclxuICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIGxpc3Qgb2YgXCJ0cmFuc2Zvcm0gcmVzdWx0c1wiIChhIHRyYW5zZm9ybSByZXN1bHQgaXMgYSBmaWVsZCB2YWx1ZVxyXG4gICAgICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSB0cmFuc2Zvcm0pIGZvciB1c2UgYWZ0ZXIgYVxyXG4gICAgICogVHJhbnNmb3JtTXV0YXRpb24gaGFzIGJlZW4gYWNrbm93bGVkZ2VkIGJ5IHRoZSBzZXJ2ZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGJhc2VEb2MgVGhlIGRvY3VtZW50IHByaW9yIHRvIGFwcGx5aW5nIHRoaXMgbXV0YXRpb24gYmF0Y2guXHJcbiAgICAgKiBAcGFyYW0gc2VydmVyVHJhbnNmb3JtUmVzdWx0cyBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgdGhlIHNlcnZlci5cclxuICAgICAqIEByZXR1cm4gVGhlIHRyYW5zZm9ybSByZXN1bHRzIGxpc3QuXHJcbiAgICAgKi9cclxuICAgIFRyYW5zZm9ybU11dGF0aW9uLnByb3RvdHlwZS5zZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzID0gZnVuY3Rpb24gKGJhc2VEb2MsIHNlcnZlclRyYW5zZm9ybVJlc3VsdHMpIHtcclxuICAgICAgICB2YXIgdHJhbnNmb3JtUmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggPT09IHNlcnZlclRyYW5zZm9ybVJlc3VsdHMubGVuZ3RoLCBcInNlcnZlciB0cmFuc2Zvcm0gcmVzdWx0IGNvdW50IChcIiArIHNlcnZlclRyYW5zZm9ybVJlc3VsdHMubGVuZ3RoICsgXCIpIFwiICtcclxuICAgICAgICAgICAgKFwic2hvdWxkIG1hdGNoIGZpZWxkIHRyYW5zZm9ybSBjb3VudCAoXCIgKyB0aGlzLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggKyBcIilcIikpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VydmVyVHJhbnNmb3JtUmVzdWx0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZmllbGRUcmFuc2Zvcm0gPSB0aGlzLmZpZWxkVHJhbnNmb3Jtc1tpXTtcclxuICAgICAgICAgICAgdmFyIHRyYW5zZm9ybSA9IGZpZWxkVHJhbnNmb3JtLnRyYW5zZm9ybTtcclxuICAgICAgICAgICAgdmFyIHByZXZpb3VzVmFsdWUgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoYmFzZURvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBwcmV2aW91c1ZhbHVlID0gYmFzZURvYy5maWVsZChmaWVsZFRyYW5zZm9ybS5maWVsZCkgfHwgbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0cmFuc2Zvcm1SZXN1bHRzLnB1c2godHJhbnNmb3JtLmFwcGx5VG9SZW1vdGVEb2N1bWVudChwcmV2aW91c1ZhbHVlLCBzZXJ2ZXJUcmFuc2Zvcm1SZXN1bHRzW2ldKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cmFuc2Zvcm1SZXN1bHRzO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIGxpc3Qgb2YgXCJ0cmFuc2Zvcm0gcmVzdWx0c1wiIChhIHRyYW5zZm9ybSByZXN1bHQgaXMgYSBmaWVsZCB2YWx1ZVxyXG4gICAgICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSB0cmFuc2Zvcm0pIGZvciB1c2Ugd2hlbiBhcHBseWluZyBhXHJcbiAgICAgKiBUcmFuc2Zvcm1NdXRhdGlvbiBsb2NhbGx5LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBsb2NhbFdyaXRlVGltZSBUaGUgbG9jYWwgdGltZSBvZiB0aGUgdHJhbnNmb3JtIG11dGF0aW9uICh1c2VkIHRvXHJcbiAgICAgKiAgICAgZ2VuZXJhdGUgU2VydmVyVGltZXN0YW1wVmFsdWVzKS5cclxuICAgICAqIEBwYXJhbSBiYXNlRG9jIFRoZSBkb2N1bWVudCBwcmlvciB0byBhcHBseWluZyB0aGlzIG11dGF0aW9uIGJhdGNoLlxyXG4gICAgICogQHJldHVybiBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgbGlzdC5cclxuICAgICAqL1xyXG4gICAgVHJhbnNmb3JtTXV0YXRpb24ucHJvdG90eXBlLmxvY2FsVHJhbnNmb3JtUmVzdWx0cyA9IGZ1bmN0aW9uIChsb2NhbFdyaXRlVGltZSwgYmFzZURvYykge1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm1SZXN1bHRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZmllbGRUcmFuc2Zvcm1zOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZmllbGRUcmFuc2Zvcm0gPSBfYVtfaV07XHJcbiAgICAgICAgICAgIHZhciB0cmFuc2Zvcm0gPSBmaWVsZFRyYW5zZm9ybS50cmFuc2Zvcm07XHJcbiAgICAgICAgICAgIHZhciBwcmV2aW91c1ZhbHVlID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKGJhc2VEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgcHJldmlvdXNWYWx1ZSA9IGJhc2VEb2MuZmllbGQoZmllbGRUcmFuc2Zvcm0uZmllbGQpIHx8IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdHJhbnNmb3JtUmVzdWx0cy5wdXNoKHRyYW5zZm9ybS5hcHBseVRvTG9jYWxWaWV3KHByZXZpb3VzVmFsdWUsIGxvY2FsV3JpdGVUaW1lKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cmFuc2Zvcm1SZXN1bHRzO1xyXG4gICAgfTtcclxuICAgIFRyYW5zZm9ybU11dGF0aW9uLnByb3RvdHlwZS50cmFuc2Zvcm1PYmplY3QgPSBmdW5jdGlvbiAoZGF0YSwgdHJhbnNmb3JtUmVzdWx0cykge1xyXG4gICAgICAgIGFzc2VydCh0cmFuc2Zvcm1SZXN1bHRzLmxlbmd0aCA9PT0gdGhpcy5maWVsZFRyYW5zZm9ybXMubGVuZ3RoLCAnVHJhbnNmb3JtUmVzdWx0cyBsZW5ndGggbWlzbWF0Y2guJyk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZmllbGRUcmFuc2Zvcm0gPSB0aGlzLmZpZWxkVHJhbnNmb3Jtc1tpXTtcclxuICAgICAgICAgICAgdmFyIGZpZWxkUGF0aCA9IGZpZWxkVHJhbnNmb3JtLmZpZWxkO1xyXG4gICAgICAgICAgICBkYXRhID0gZGF0YS5zZXQoZmllbGRQYXRoLCB0cmFuc2Zvcm1SZXN1bHRzW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRyYW5zZm9ybU11dGF0aW9uO1xyXG59KE11dGF0aW9uKSk7XHJcbi8qKiBBIG11dGF0aW9uIHRoYXQgZGVsZXRlcyB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleS4gKi9cclxudmFyIERlbGV0ZU11dGF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRGVsZXRlTXV0YXRpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBEZWxldGVNdXRhdGlvbihrZXksIHByZWNvbmRpdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIF90aGlzLnByZWNvbmRpdGlvbiA9IHByZWNvbmRpdGlvbjtcclxuICAgICAgICBfdGhpcy50eXBlID0gTXV0YXRpb25UeXBlLkRlbGV0ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBEZWxldGVNdXRhdGlvbi5wcm90b3R5cGUuYXBwbHlUb1JlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKG1heWJlRG9jLCBtdXRhdGlvblJlc3VsdCkge1xyXG4gICAgICAgIHRoaXMudmVyaWZ5S2V5TWF0Y2hlcyhtYXliZURvYyk7XHJcbiAgICAgICAgYXNzZXJ0KG11dGF0aW9uUmVzdWx0LnRyYW5zZm9ybVJlc3VsdHMgPT0gbnVsbCwgJ1RyYW5zZm9ybSByZXN1bHRzIHJlY2VpdmVkIGJ5IERlbGV0ZU11dGF0aW9uLicpO1xyXG4gICAgICAgIC8vIFVubGlrZSBhcHBseVRvTG9jYWxWaWV3LCBpZiB3ZSdyZSBhcHBseWluZyBhIG11dGF0aW9uIHRvIGEgcmVtb3RlXHJcbiAgICAgICAgLy8gZG9jdW1lbnQgdGhlIHNlcnZlciBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uIHNvIHRoZSBwcmVjb25kaXRpb24gbXVzdFxyXG4gICAgICAgIC8vIGhhdmUgaGVsZC5cclxuICAgICAgICByZXR1cm4gbmV3IE5vRG9jdW1lbnQodGhpcy5rZXksIG11dGF0aW9uUmVzdWx0LnZlcnNpb24sIHtcclxuICAgICAgICAgICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRGVsZXRlTXV0YXRpb24ucHJvdG90eXBlLmFwcGx5VG9Mb2NhbFZpZXcgPSBmdW5jdGlvbiAobWF5YmVEb2MsIGJhc2VEb2MsIGxvY2FsV3JpdGVUaW1lKSB7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlLZXlNYXRjaGVzKG1heWJlRG9jKTtcclxuICAgICAgICBpZiAoIXRoaXMucHJlY29uZGl0aW9uLmlzVmFsaWRGb3IobWF5YmVEb2MpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYXliZURvYztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG1heWJlRG9jKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChtYXliZURvYy5rZXkuaXNFcXVhbCh0aGlzLmtleSksICdDYW4gb25seSBhcHBseSBtdXRhdGlvbiB0byBkb2N1bWVudCB3aXRoIHNhbWUga2V5Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgTm9Eb2N1bWVudCh0aGlzLmtleSwgU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKSk7XHJcbiAgICB9O1xyXG4gICAgRGVsZXRlTXV0YXRpb24ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgRGVsZXRlTXV0YXRpb24gJiZcclxuICAgICAgICAgICAgdGhpcy5rZXkuaXNFcXVhbChvdGhlci5rZXkpICYmXHJcbiAgICAgICAgICAgIHRoaXMucHJlY29uZGl0aW9uLmlzRXF1YWwob3RoZXIucHJlY29uZGl0aW9uKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlbGV0ZU11dGF0aW9uO1xyXG59KE11dGF0aW9uKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKiogVHJhbnNmb3JtcyBhIHZhbHVlIGludG8gYSBzZXJ2ZXItZ2VuZXJhdGVkIHRpbWVzdGFtcC4gKi9cclxudmFyIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybSgpIHtcclxuICAgIH1cclxuICAgIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybS5wcm90b3R5cGUuYXBwbHlUb0xvY2FsVmlldyA9IGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlLCBsb2NhbFdyaXRlVGltZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU2VydmVyVGltZXN0YW1wVmFsdWUobG9jYWxXcml0ZVRpbWUsIHByZXZpb3VzVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybS5wcm90b3R5cGUuYXBwbHlUb1JlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKHByZXZpb3VzVmFsdWUsIHRyYW5zZm9ybVJlc3VsdCkge1xyXG4gICAgICAgIHJldHVybiB0cmFuc2Zvcm1SZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG90aGVyIGluc3RhbmNlb2YgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtO1xyXG4gICAgfTtcclxuICAgIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybS5pbnN0YW5jZSA9IG5ldyBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm0oKTtcclxuICAgIHJldHVybiBTZXJ2ZXJUaW1lc3RhbXBUcmFuc2Zvcm07XHJcbn0oKSk7XHJcbi8qKiBUcmFuc2Zvcm1zIGFuIGFycmF5IHZhbHVlIHZpYSBhIHVuaW9uIG9wZXJhdGlvbi4gKi9cclxudmFyIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uKGVsZW1lbnRzKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50cyA9IGVsZW1lbnRzO1xyXG4gICAgfVxyXG4gICAgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbi5wcm90b3R5cGUuYXBwbHlUb0xvY2FsVmlldyA9IGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlLCBsb2NhbFdyaXRlVGltZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5KHByZXZpb3VzVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24ucHJvdG90eXBlLmFwcGx5VG9SZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlLCB0cmFuc2Zvcm1SZXN1bHQpIHtcclxuICAgICAgICAvLyBUaGUgc2VydmVyIGp1c3Qgc2VuZHMgbnVsbCBhcyB0aGUgdHJhbnNmb3JtIHJlc3VsdCBmb3IgYXJyYXkgb3BlcmF0aW9ucyxcclxuICAgICAgICAvLyBzbyB3ZSBoYXZlIHRvIGNhbGN1bGF0ZSBhIHJlc3VsdCB0aGUgc2FtZSBhcyB3ZSBkbyBmb3IgbG9jYWxcclxuICAgICAgICAvLyBhcHBsaWNhdGlvbnMuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHkocHJldmlvdXNWYWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbi5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbiAocHJldmlvdXNWYWx1ZSkge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBjb2VyY2VkRmllbGRWYWx1ZXNBcnJheShwcmV2aW91c1ZhbHVlKTtcclxuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uICh0b1VuaW9uKSB7XHJcbiAgICAgICAgICAgIGlmICghcmVzdWx0LmZpbmQoZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIGVsZW1lbnQuaXNFcXVhbCh0b1VuaW9uKTsgfSkpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRvVW5pb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5lbGVtZW50czsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHRvVW5pb24gPSBfYVtfaV07XHJcbiAgICAgICAgICAgIF9sb29wXzEodG9Vbmlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgQXJyYXlWYWx1ZShyZXN1bHQpO1xyXG4gICAgfTtcclxuICAgIEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24ucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKG90aGVyIGluc3RhbmNlb2YgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbiAmJlxyXG4gICAgICAgICAgICBhcnJheUVxdWFscyhvdGhlci5lbGVtZW50cywgdGhpcy5lbGVtZW50cykpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBcnJheVVuaW9uVHJhbnNmb3JtT3BlcmF0aW9uO1xyXG59KCkpO1xyXG4vKiogVHJhbnNmb3JtcyBhbiBhcnJheSB2YWx1ZSB2aWEgYSByZW1vdmUgb3BlcmF0aW9uLiAqL1xyXG52YXIgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbihlbGVtZW50cykge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudHMgPSBlbGVtZW50cztcclxuICAgIH1cclxuICAgIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uLnByb3RvdHlwZS5hcHBseVRvTG9jYWxWaWV3ID0gZnVuY3Rpb24gKHByZXZpb3VzVmFsdWUsIGxvY2FsV3JpdGVUaW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHkocHJldmlvdXNWYWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24ucHJvdG90eXBlLmFwcGx5VG9SZW1vdGVEb2N1bWVudCA9IGZ1bmN0aW9uIChwcmV2aW91c1ZhbHVlLCB0cmFuc2Zvcm1SZXN1bHQpIHtcclxuICAgICAgICAvLyBUaGUgc2VydmVyIGp1c3Qgc2VuZHMgbnVsbCBhcyB0aGUgdHJhbnNmb3JtIHJlc3VsdCBmb3IgYXJyYXkgb3BlcmF0aW9ucyxcclxuICAgICAgICAvLyBzbyB3ZSBoYXZlIHRvIGNhbGN1bGF0ZSBhIHJlc3VsdCB0aGUgc2FtZSBhcyB3ZSBkbyBmb3IgbG9jYWxcclxuICAgICAgICAvLyBhcHBsaWNhdGlvbnMuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHkocHJldmlvdXNWYWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24ucHJvdG90eXBlLmFwcGx5ID0gZnVuY3Rpb24gKHByZXZpb3VzVmFsdWUpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gY29lcmNlZEZpZWxkVmFsdWVzQXJyYXkocHJldmlvdXNWYWx1ZSk7XHJcbiAgICAgICAgdmFyIF9sb29wXzIgPSBmdW5jdGlvbiAodG9SZW1vdmUpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmZpbHRlcihmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gIWVsZW1lbnQuaXNFcXVhbCh0b1JlbW92ZSk7IH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZWxlbWVudHM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0b1JlbW92ZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgX2xvb3BfMih0b1JlbW92ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgQXJyYXlWYWx1ZShyZXN1bHQpO1xyXG4gICAgfTtcclxuICAgIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIChvdGhlciBpbnN0YW5jZW9mIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uICYmXHJcbiAgICAgICAgICAgIGFycmF5RXF1YWxzKG90aGVyLmVsZW1lbnRzLCB0aGlzLmVsZW1lbnRzKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFycmF5UmVtb3ZlVHJhbnNmb3JtT3BlcmF0aW9uO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjb2VyY2VkRmllbGRWYWx1ZXNBcnJheSh2YWx1ZSkge1xyXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgQXJyYXlWYWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB2YWx1ZS5pbnRlcm5hbFZhbHVlLnNsaWNlKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBjb2VyY2UgdG8gZW1wdHkgYXJyYXkuXHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRXhpc3RlbmNlRmlsdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gVE9ETyhiLzMzMDc4MTYzKToganVzdCB1c2Ugc2ltcGxlc3QgZm9ybSBvZiBleGlzdGVuY2UgZmlsdGVyIGZvciBub3dcclxuICAgIGZ1bmN0aW9uIEV4aXN0ZW5jZUZpbHRlcihjb3VudCkge1xyXG4gICAgICAgIHRoaXMuY291bnQgPSBjb3VudDtcclxuICAgIH1cclxuICAgIEV4aXN0ZW5jZUZpbHRlci5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiBvdGhlciAmJiBvdGhlci5jb3VudCA9PT0gdGhpcy5jb3VudDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRXhpc3RlbmNlRmlsdGVyO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEVycm9yIENvZGVzIGRlc2NyaWJpbmcgdGhlIGRpZmZlcmVudCB3YXlzIEdSUEMgY2FuIGZhaWwuIFRoZXNlIGFyZSBjb3BpZWRcclxuICogZGlyZWN0bHkgZnJvbSBHUlBDJ3Mgc291cmNlcyBoZXJlOlxyXG4gKlxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ3JwYy9ncnBjL2Jsb2IvYmNlZWM5NGVhNGZjNWYwMDg1ZDgxMjM1ZDhlMWMwNjc5OGRjMzQxYS9pbmNsdWRlL2dycGMlMkIlMkIvaW1wbC9jb2RlZ2VuL3N0YXR1c19jb2RlX2VudW0uaFxyXG4gKlxyXG4gKiBJbXBvcnRhbnQhIFRoZSBuYW1lcyBvZiB0aGVzZSBpZGVudGlmaWVycyBtYXR0ZXIgYmVjYXVzZSB0aGUgc3RyaW5nIGZvcm1zXHJcbiAqIGFyZSB1c2VkIGZvciByZXZlcnNlIGxvb2t1cHMgZnJvbSB0aGUgd2ViY2hhbm5lbCBzdHJlYW0uIERvIE5PVCBjaGFuZ2UgdGhlXHJcbiAqIG5hbWVzIG9mIHRoZXNlIGlkZW50aWZpZXJzLlxyXG4gKi9cclxudmFyIFJwY0NvZGU7XHJcbihmdW5jdGlvbiAoUnBjQ29kZSkge1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiT0tcIl0gPSAwXSA9IFwiT0tcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIkNBTkNFTExFRFwiXSA9IDFdID0gXCJDQU5DRUxMRURcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIlVOS05PV05cIl0gPSAyXSA9IFwiVU5LTk9XTlwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiSU5WQUxJRF9BUkdVTUVOVFwiXSA9IDNdID0gXCJJTlZBTElEX0FSR1VNRU5UXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJERUFETElORV9FWENFRURFRFwiXSA9IDRdID0gXCJERUFETElORV9FWENFRURFRFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiTk9UX0ZPVU5EXCJdID0gNV0gPSBcIk5PVF9GT1VORFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiQUxSRUFEWV9FWElTVFNcIl0gPSA2XSA9IFwiQUxSRUFEWV9FWElTVFNcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIlBFUk1JU1NJT05fREVOSUVEXCJdID0gN10gPSBcIlBFUk1JU1NJT05fREVOSUVEXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJVTkFVVEhFTlRJQ0FURURcIl0gPSAxNl0gPSBcIlVOQVVUSEVOVElDQVRFRFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiUkVTT1VSQ0VfRVhIQVVTVEVEXCJdID0gOF0gPSBcIlJFU09VUkNFX0VYSEFVU1RFRFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiRkFJTEVEX1BSRUNPTkRJVElPTlwiXSA9IDldID0gXCJGQUlMRURfUFJFQ09ORElUSU9OXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJBQk9SVEVEXCJdID0gMTBdID0gXCJBQk9SVEVEXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJPVVRfT0ZfUkFOR0VcIl0gPSAxMV0gPSBcIk9VVF9PRl9SQU5HRVwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiVU5JTVBMRU1FTlRFRFwiXSA9IDEyXSA9IFwiVU5JTVBMRU1FTlRFRFwiO1xyXG4gICAgUnBjQ29kZVtScGNDb2RlW1wiSU5URVJOQUxcIl0gPSAxM10gPSBcIklOVEVSTkFMXCI7XHJcbiAgICBScGNDb2RlW1JwY0NvZGVbXCJVTkFWQUlMQUJMRVwiXSA9IDE0XSA9IFwiVU5BVkFJTEFCTEVcIjtcclxuICAgIFJwY0NvZGVbUnBjQ29kZVtcIkRBVEFfTE9TU1wiXSA9IDE1XSA9IFwiREFUQV9MT1NTXCI7XHJcbn0pKFJwY0NvZGUgfHwgKFJwY0NvZGUgPSB7fSkpO1xyXG5mdW5jdGlvbiBpc1Blcm1hbmVudEVycm9yKGNvZGUpIHtcclxuICAgIHN3aXRjaCAoY29kZSkge1xyXG4gICAgICAgIGNhc2UgQ29kZS5PSzpcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1RyZWF0ZWQgc3RhdHVzIE9LIGFzIGVycm9yJyk7XHJcbiAgICAgICAgY2FzZSBDb2RlLkNBTkNFTExFRDpcclxuICAgICAgICBjYXNlIENvZGUuVU5LTk9XTjpcclxuICAgICAgICBjYXNlIENvZGUuREVBRExJTkVfRVhDRUVERUQ6XHJcbiAgICAgICAgY2FzZSBDb2RlLlJFU09VUkNFX0VYSEFVU1RFRDpcclxuICAgICAgICBjYXNlIENvZGUuSU5URVJOQUw6XHJcbiAgICAgICAgY2FzZSBDb2RlLlVOQVZBSUxBQkxFOlxyXG4gICAgICAgIC8vIFVuYXV0aGVudGljYXRlZCBtZWFucyBzb21ldGhpbmcgd2VudCB3cm9uZyB3aXRoIG91ciB0b2tlbiBhbmQgd2UgbmVlZFxyXG4gICAgICAgIC8vIHRvIHJldHJ5IHdpdGggbmV3IGNyZWRlbnRpYWxzIHdoaWNoIHdpbGwgaGFwcGVuIGF1dG9tYXRpY2FsbHkuXHJcbiAgICAgICAgY2FzZSBDb2RlLlVOQVVUSEVOVElDQVRFRDpcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGNhc2UgQ29kZS5JTlZBTElEX0FSR1VNRU5UOlxyXG4gICAgICAgIGNhc2UgQ29kZS5OT1RfRk9VTkQ6XHJcbiAgICAgICAgY2FzZSBDb2RlLkFMUkVBRFlfRVhJU1RTOlxyXG4gICAgICAgIGNhc2UgQ29kZS5QRVJNSVNTSU9OX0RFTklFRDpcclxuICAgICAgICBjYXNlIENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTjpcclxuICAgICAgICAvLyBBYm9ydGVkIG1pZ2h0IGJlIHJldHJpZWQgaW4gc29tZSBzY2VuYXJpb3MsIGJ1dCB0aGF0IGlzIGRlcGVuZGFudCBvblxyXG4gICAgICAgIC8vIHRoZSBjb250ZXh0IGFuZCBzaG91bGQgaGFuZGxlZCBpbmRpdmlkdWFsbHkgYnkgdGhlIGNhbGxpbmcgY29kZS5cclxuICAgICAgICAvLyBTZWUgaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2FwaXMvZGVzaWduL2Vycm9ycy5cclxuICAgICAgICBjYXNlIENvZGUuQUJPUlRFRDpcclxuICAgICAgICBjYXNlIENvZGUuT1VUX09GX1JBTkdFOlxyXG4gICAgICAgIGNhc2UgQ29kZS5VTklNUExFTUVOVEVEOlxyXG4gICAgICAgIGNhc2UgQ29kZS5EQVRBX0xPU1M6XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIHN0YXR1cyBjb2RlOiAnICsgY29kZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIE1hcHMgYW4gZXJyb3IgQ29kZSBmcm9tIGEgR1JQQyBzdGF0dXMgaWRlbnRpZmllciBsaWtlICdOT1RfRk9VTkQnLlxyXG4gKlxyXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBzdGF0dXMgc3RyaW5nIG9yIHVuZGVmaW5lZCBpZlxyXG4gKiAgICAgdGhlcmUgaXMgbm8gbWF0Y2guXHJcbiAqL1xyXG5mdW5jdGlvbiBtYXBDb2RlRnJvbVJwY1N0YXR1cyhzdGF0dXMpIHtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgbG9va3VwIGJ5IHN0cmluZ1xyXG4gICAgdmFyIGNvZGUgPSBScGNDb2RlW3N0YXR1c107XHJcbiAgICBpZiAoY29kZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIHJldHVybiBtYXBDb2RlRnJvbVJwY0NvZGUoY29kZSk7XHJcbn1cclxuLyoqXHJcbiAqIE1hcHMgYW4gZXJyb3IgQ29kZSBmcm9tIEdSUEMgc3RhdHVzIGNvZGUgbnVtYmVyLCBsaWtlIDAsIDEsIG9yIDE0LiBUaGVzZVxyXG4gKiBhcmUgbm90IHRoZSBzYW1lIGFzIEhUVFAgc3RhdHVzIGNvZGVzLlxyXG4gKlxyXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBHUlBDIHN0YXR1cyBjb2RlLiBGYWlscyBpZiB0aGVyZVxyXG4gKiAgICAgaXMgbm8gbWF0Y2guXHJcbiAqL1xyXG5mdW5jdGlvbiBtYXBDb2RlRnJvbVJwY0NvZGUoY29kZSkge1xyXG4gICAgaWYgKGNvZGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIC8vIFRoaXMgc2hvdWxkbid0IG5vcm1hbGx5IGhhcHBlbiwgYnV0IGluIGNlcnRhaW4gZXJyb3IgY2FzZXMgKGxpa2UgdHJ5aW5nXHJcbiAgICAgICAgLy8gdG8gc2VuZCBpbnZhbGlkIHByb3RvIG1lc3NhZ2VzKSB3ZSBtYXkgZ2V0IGFuIGVycm9yIHdpdGggbm8gR1JQQyBjb2RlLlxyXG4gICAgICAgIGVycm9yKCdHUlBDIGVycm9yIGhhcyBubyAuY29kZScpO1xyXG4gICAgICAgIHJldHVybiBDb2RlLlVOS05PV047XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKGNvZGUpIHtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuT0s6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLk9LO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5DQU5DRUxMRUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkNBTkNFTExFRDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuVU5LTk9XTjpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5LTk9XTjtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuREVBRExJTkVfRVhDRUVERUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkRFQURMSU5FX0VYQ0VFREVEO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5SRVNPVVJDRV9FWEhBVVNURUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlJFU09VUkNFX0VYSEFVU1RFRDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuSU5URVJOQUw6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLklOVEVSTkFMO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5VTkFWQUlMQUJMRTpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5BVkFJTEFCTEU7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLlVOQVVUSEVOVElDQVRFRDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5BVVRIRU5USUNBVEVEO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5JTlZBTElEX0FSR1VNRU5UOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5JTlZBTElEX0FSR1VNRU5UO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5OT1RfRk9VTkQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLk5PVF9GT1VORDtcclxuICAgICAgICBjYXNlIFJwY0NvZGUuQUxSRUFEWV9FWElTVFM6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkFMUkVBRFlfRVhJU1RTO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5QRVJNSVNTSU9OX0RFTklFRDpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuUEVSTUlTU0lPTl9ERU5JRUQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLkZBSUxFRF9QUkVDT05ESVRJT046XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkZBSUxFRF9QUkVDT05ESVRJT047XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLkFCT1JURUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkFCT1JURUQ7XHJcbiAgICAgICAgY2FzZSBScGNDb2RlLk9VVF9PRl9SQU5HRTpcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuT1VUX09GX1JBTkdFO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5VTklNUExFTUVOVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTklNUExFTUVOVEVEO1xyXG4gICAgICAgIGNhc2UgUnBjQ29kZS5EQVRBX0xPU1M6XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkRBVEFfTE9TUztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBzdGF0dXMgY29kZTogJyArIGNvZGUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBNYXBzIGFuIFJQQyBjb2RlIGZyb20gYSBDb2RlLiBUaGlzIGlzIHRoZSByZXZlcnNlIG9wZXJhdGlvbiBmcm9tXHJcbiAqIG1hcENvZGVGcm9tUnBjQ29kZSBhbmQgc2hvdWxkIHJlYWxseSBvbmx5IGJlIHVzZWQgaW4gdGVzdHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBtYXBScGNDb2RlRnJvbUNvZGUoY29kZSkge1xyXG4gICAgaWYgKGNvZGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBScGNDb2RlLk9LO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoIChjb2RlKSB7XHJcbiAgICAgICAgY2FzZSBDb2RlLk9LOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5PSztcclxuICAgICAgICBjYXNlIENvZGUuQ0FOQ0VMTEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5DQU5DRUxMRUQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLlVOS05PV046XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLlVOS05PV047XHJcbiAgICAgICAgY2FzZSBDb2RlLkRFQURMSU5FX0VYQ0VFREVEOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5ERUFETElORV9FWENFRURFRDtcclxuICAgICAgICBjYXNlIENvZGUuUkVTT1VSQ0VfRVhIQVVTVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5SRVNPVVJDRV9FWEhBVVNURUQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLklOVEVSTkFMOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5JTlRFUk5BTDtcclxuICAgICAgICBjYXNlIENvZGUuVU5BVkFJTEFCTEU6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLlVOQVZBSUxBQkxFO1xyXG4gICAgICAgIGNhc2UgQ29kZS5VTkFVVEhFTlRJQ0FURUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLlVOQVVUSEVOVElDQVRFRDtcclxuICAgICAgICBjYXNlIENvZGUuSU5WQUxJRF9BUkdVTUVOVDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuSU5WQUxJRF9BUkdVTUVOVDtcclxuICAgICAgICBjYXNlIENvZGUuTk9UX0ZPVU5EOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5OT1RfRk9VTkQ7XHJcbiAgICAgICAgY2FzZSBDb2RlLkFMUkVBRFlfRVhJU1RTOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5BTFJFQURZX0VYSVNUUztcclxuICAgICAgICBjYXNlIENvZGUuUEVSTUlTU0lPTl9ERU5JRUQ6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLlBFUk1JU1NJT05fREVOSUVEO1xyXG4gICAgICAgIGNhc2UgQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OO1xyXG4gICAgICAgIGNhc2UgQ29kZS5BQk9SVEVEOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5BQk9SVEVEO1xyXG4gICAgICAgIGNhc2UgQ29kZS5PVVRfT0ZfUkFOR0U6XHJcbiAgICAgICAgICAgIHJldHVybiBScGNDb2RlLk9VVF9PRl9SQU5HRTtcclxuICAgICAgICBjYXNlIENvZGUuVU5JTVBMRU1FTlRFRDpcclxuICAgICAgICAgICAgcmV0dXJuIFJwY0NvZGUuVU5JTVBMRU1FTlRFRDtcclxuICAgICAgICBjYXNlIENvZGUuREFUQV9MT1NTOlxyXG4gICAgICAgICAgICByZXR1cm4gUnBjQ29kZS5EQVRBX0xPU1M7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gc3RhdHVzIGNvZGU6ICcgKyBjb2RlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQ29udmVydHMgYW4gSFRUUCBTdGF0dXMgQ29kZSB0byB0aGUgZXF1aXZhbGVudCBlcnJvciBjb2RlLlxyXG4gKlxyXG4gKiBAcGFyYW0gc3RhdHVzIEFuIEhUVFAgU3RhdHVzIENvZGUsIGxpa2UgMjAwLCA0MDQsIDUwMywgZXRjLlxyXG4gKiBAcmV0dXJucyBUaGUgZXF1aXZhbGVudCBDb2RlLiBVbmtub3duIHN0YXR1cyBjb2RlcyBhcmUgbWFwcGVkIHRvXHJcbiAqICAgICBDb2RlLlVOS05PV04uXHJcbiAqL1xyXG5mdW5jdGlvbiBtYXBDb2RlRnJvbUh0dHBTdGF0dXMoc3RhdHVzKSB7XHJcbiAgICAvLyBUaGUgY2Fub25pY2FsIGVycm9yIGNvZGVzIGZvciBHb29nbGUgQVBJcyBbMV0gc3BlY2lmeSBtYXBwaW5nIG9udG8gSFRUUFxyXG4gICAgLy8gc3RhdHVzIGNvZGVzIGJ1dCB0aGUgbWFwcGluZyBpcyBub3QgYmlqZWN0aXZlLiBJbiBlYWNoIGNhc2Ugb2YgYW1iaWd1aXR5XHJcbiAgICAvLyB0aGlzIGZ1bmN0aW9uIGNob29zZXMgYSBwcmltYXJ5IGVycm9yLlxyXG4gICAgLy9cclxuICAgIC8vIFsxXVxyXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZWFwaXMvZ29vZ2xlYXBpcy9ibG9iL21hc3Rlci9nb29nbGUvcnBjL2NvZGUucHJvdG9cclxuICAgIHN3aXRjaCAoc3RhdHVzKSB7XHJcbiAgICAgICAgY2FzZSAyMDA6IC8vIE9LXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLk9LO1xyXG4gICAgICAgIGNhc2UgNDAwOiAvLyBCYWQgUmVxdWVzdFxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5JTlZBTElEX0FSR1VNRU5UO1xyXG4gICAgICAgIC8vIE90aGVyIHBvc3NpYmlsaXRpZXMgYmFzZWQgb24gdGhlIGZvcndhcmQgbWFwcGluZ1xyXG4gICAgICAgIC8vIHJldHVybiBDb2RlLkZBSUxFRF9QUkVDT05ESVRJT047XHJcbiAgICAgICAgLy8gcmV0dXJuIENvZGUuT1VUX09GX1JBTkdFO1xyXG4gICAgICAgIGNhc2UgNDAxOiAvLyBVbmF1dGhvcml6ZWRcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5BVVRIRU5USUNBVEVEO1xyXG4gICAgICAgIGNhc2UgNDAzOiAvLyBGb3JiaWRkZW5cclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuUEVSTUlTU0lPTl9ERU5JRUQ7XHJcbiAgICAgICAgY2FzZSA0MDQ6IC8vIE5vdCBGb3VuZFxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5OT1RfRk9VTkQ7XHJcbiAgICAgICAgY2FzZSA0MDk6IC8vIENvbmZsaWN0XHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLkFCT1JURUQ7XHJcbiAgICAgICAgLy8gT3RoZXIgcG9zc2liaWxpdGllczpcclxuICAgICAgICAvLyByZXR1cm4gQ29kZS5BTFJFQURZX0VYSVNUUztcclxuICAgICAgICBjYXNlIDQxNjogLy8gUmFuZ2UgTm90IFNhdGlzZmlhYmxlXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLk9VVF9PRl9SQU5HRTtcclxuICAgICAgICBjYXNlIDQyOTogLy8gVG9vIE1hbnkgUmVxdWVzdHNcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuUkVTT1VSQ0VfRVhIQVVTVEVEO1xyXG4gICAgICAgIGNhc2UgNDk5OiAvLyBDbGllbnQgQ2xvc2VkIFJlcXVlc3RcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuQ0FOQ0VMTEVEO1xyXG4gICAgICAgIGNhc2UgNTAwOiAvLyBJbnRlcm5hbCBTZXJ2ZXIgRXJyb3JcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuVU5LTk9XTjtcclxuICAgICAgICAvLyBPdGhlciBwb3NzaWJpbGl0aWVzOlxyXG4gICAgICAgIC8vIHJldHVybiBDb2RlLklOVEVSTkFMO1xyXG4gICAgICAgIC8vIHJldHVybiBDb2RlLkRBVEFfTE9TUztcclxuICAgICAgICBjYXNlIDUwMTogLy8gVW5pbXBsZW1lbnRlZFxyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTklNUExFTUVOVEVEO1xyXG4gICAgICAgIGNhc2UgNTAzOiAvLyBTZXJ2aWNlIFVuYXZhaWxhYmxlXHJcbiAgICAgICAgICAgIHJldHVybiBDb2RlLlVOQVZBSUxBQkxFO1xyXG4gICAgICAgIGNhc2UgNTA0OiAvLyBHYXRld2F5IFRpbWVvdXRcclxuICAgICAgICAgICAgcmV0dXJuIENvZGUuREVBRExJTkVfRVhDRUVERUQ7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgaWYgKHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgMzAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENvZGUuT0s7XHJcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPj0gNDAwICYmIHN0YXR1cyA8IDUwMClcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb2RlLkZBSUxFRF9QUkVDT05ESVRJT047XHJcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPj0gNTAwICYmIHN0YXR1cyA8IDYwMClcclxuICAgICAgICAgICAgICAgIHJldHVybiBDb2RlLklOVEVSTkFMO1xyXG4gICAgICAgICAgICByZXR1cm4gQ29kZS5VTktOT1dOO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogU29ydGVkU2V0IGlzIGFuIGltbXV0YWJsZSAoY29weS1vbi13cml0ZSkgY29sbGVjdGlvbiB0aGF0IGhvbGRzIGVsZW1lbnRzXHJcbiAqIGluIG9yZGVyIHNwZWNpZmllZCBieSB0aGUgcHJvdmlkZWQgY29tcGFyYXRvci5cclxuICpcclxuICogTk9URTogaWYgcHJvdmlkZWQgY29tcGFyYXRvciByZXR1cm5zIDAgZm9yIHR3byBlbGVtZW50cywgd2UgY29uc2lkZXIgdGhlbSB0b1xyXG4gKiBiZSBlcXVhbCFcclxuICovXHJcbnZhciBTb3J0ZWRTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTb3J0ZWRTZXQoY29tcGFyYXRvcikge1xyXG4gICAgICAgIHRoaXMuY29tcGFyYXRvciA9IGNvbXBhcmF0b3I7XHJcbiAgICAgICAgdGhpcy5kYXRhID0gbmV3IFNvcnRlZE1hcCh0aGlzLmNvbXBhcmF0b3IpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgU29ydGVkU2V0IGZyb20gdGhlIGtleXMgb2YgdGhlIG1hcC5cclxuICAgICAqIFRoaXMgaXMgY3VycmVudGx5IGltcGxlbWVudGVkIGFzIGFuIE8obikgY29weS5cclxuICAgICAqL1xyXG4gICAgU29ydGVkU2V0LmZyb21NYXBLZXlzID0gZnVuY3Rpb24gKG1hcCkge1xyXG4gICAgICAgIHZhciBrZXlzID0gbmV3IFNvcnRlZFNldChtYXAuY29tcGFyYXRvcik7XHJcbiAgICAgICAgbWFwLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICBrZXlzID0ga2V5cy5hZGQoa2V5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4ga2V5cztcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChlbGVtKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5nZXQoZWxlbSkgIT09IG51bGw7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5maXJzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLm1pbktleSgpO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUubGFzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLm1heEtleSgpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTb3J0ZWRTZXQucHJvdG90eXBlLCBcInNpemVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhLnNpemU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuaW5kZXhPZihlbGVtKTtcclxuICAgIH07XHJcbiAgICAvKiogSXRlcmF0ZXMgZWxlbWVudHMgaW4gb3JkZXIgZGVmaW5lZCBieSBcImNvbXBhcmF0b3JcIiAqL1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNiKSB7XHJcbiAgICAgICAgdGhpcy5kYXRhLmlub3JkZXJUcmF2ZXJzYWwoZnVuY3Rpb24gKGssIHYpIHtcclxuICAgICAgICAgICAgY2Ioayk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogSXRlcmF0ZXMgb3ZlciBgZWxlbWBzIHN1Y2ggdGhhdDogcmFuZ2VbMF0gPD0gZWxlbSA8IHJhbmdlWzFdLiAqL1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5mb3JFYWNoSW5SYW5nZSA9IGZ1bmN0aW9uIChyYW5nZSwgY2IpIHtcclxuICAgICAgICB2YXIgaXRlciA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20ocmFuZ2VbMF0pO1xyXG4gICAgICAgIHdoaWxlIChpdGVyLmhhc05leHQoKSkge1xyXG4gICAgICAgICAgICB2YXIgZWxlbSA9IGl0ZXIuZ2V0TmV4dCgpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb21wYXJhdG9yKGVsZW0ua2V5LCByYW5nZVsxXSkgPj0gMClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgY2IoZWxlbS5rZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYGVsZW1gcyBzdWNoIHRoYXQ6IHN0YXJ0IDw9IGVsZW0gdW50aWwgZmFsc2UgaXMgcmV0dXJuZWQuXHJcbiAgICAgKi9cclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuZm9yRWFjaFdoaWxlID0gZnVuY3Rpb24gKGNiLCBzdGFydCkge1xyXG4gICAgICAgIHZhciBpdGVyO1xyXG4gICAgICAgIGlmIChzdGFydCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGl0ZXIgPSB0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKHN0YXJ0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGl0ZXIgPSB0aGlzLmRhdGEuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2hpbGUgKGl0ZXIuaGFzTmV4dCgpKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGVtID0gaXRlci5nZXROZXh0KCk7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBjYihlbGVtLmtleSk7XHJcbiAgICAgICAgICAgIGlmICghcmVzdWx0KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogRmluZHMgdGhlIGxlYXN0IGVsZW1lbnQgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIGBlbGVtYC4gKi9cclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuZmlyc3RBZnRlck9yRXF1YWwgPSBmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgIHZhciBpdGVyID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbShlbGVtKTtcclxuICAgICAgICByZXR1cm4gaXRlci5oYXNOZXh0KCkgPyBpdGVyLmdldE5leHQoKS5rZXkgOiBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKiBJbnNlcnRzIG9yIHVwZGF0ZXMgYW4gZWxlbWVudCAqL1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoZWxlbSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkodGhpcy5kYXRhLnJlbW92ZShlbGVtKS5pbnNlcnQoZWxlbSwgdHJ1ZSkpO1xyXG4gICAgfTtcclxuICAgIC8qKiBEZWxldGVzIGFuIGVsZW1lbnQgKi9cclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGVsZW0pIHtcclxuICAgICAgICBpZiAoIXRoaXMuaGFzKGVsZW0pKVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5jb3B5KHRoaXMuZGF0YS5yZW1vdmUoZWxlbSkpO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmlzRW1wdHkoKTtcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLnVuaW9uV2l0aCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzO1xyXG4gICAgICAgIG90aGVyLmZvckVhY2goZnVuY3Rpb24gKGVsZW0pIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmFkZChlbGVtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgU29ydGVkU2V0KSlcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLnNpemUgIT09IG90aGVyLnNpemUpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB2YXIgdGhpc0l0ID0gdGhpcy5kYXRhLmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgdmFyIG90aGVySXQgPSBvdGhlci5kYXRhLmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgd2hpbGUgKHRoaXNJdC5oYXNOZXh0KCkpIHtcclxuICAgICAgICAgICAgdmFyIHRoaXNFbGVtID0gdGhpc0l0LmdldE5leHQoKS5rZXk7XHJcbiAgICAgICAgICAgIHZhciBvdGhlckVsZW0gPSBvdGhlckl0LmdldE5leHQoKS5rZXk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBhcmF0b3IodGhpc0VsZW0sIG90aGVyRWxlbSkgIT09IDApXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFNvcnRlZFNldC5wcm90b3R5cGUudG9BcnJheSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcmVzID0gW107XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICByZXMucHVzaCh0YXJnZXRJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHJlcztcclxuICAgIH07XHJcbiAgICBTb3J0ZWRTZXQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24gKGVsZW0pIHsgcmV0dXJuIHJlc3VsdC5wdXNoKGVsZW0pOyB9KTtcclxuICAgICAgICByZXR1cm4gJ1NvcnRlZFNldCgnICsgcmVzdWx0LnRvU3RyaW5nKCkgKyAnKSc7XHJcbiAgICB9O1xyXG4gICAgU29ydGVkU2V0LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFNvcnRlZFNldCh0aGlzLmNvbXBhcmF0b3IpO1xyXG4gICAgICAgIHJlc3VsdC5kYXRhID0gZGF0YTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTb3J0ZWRTZXQ7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRU1QVFlfTUFZQkVfRE9DVU1FTlRfTUFQID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxuZnVuY3Rpb24gbWF5YmVEb2N1bWVudE1hcCgpIHtcclxuICAgIHJldHVybiBFTVBUWV9NQVlCRV9ET0NVTUVOVF9NQVA7XHJcbn1cclxudmFyIEVNUFRZX0RPQ1VNRU5UX01BUCA9IG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbmZ1bmN0aW9uIGRvY3VtZW50TWFwKCkge1xyXG4gICAgcmV0dXJuIEVNUFRZX0RPQ1VNRU5UX01BUDtcclxufVxyXG52YXIgRU1QVFlfRE9DVU1FTlRfVkVSU0lPTl9NQVAgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG5mdW5jdGlvbiBkb2N1bWVudFZlcnNpb25NYXAoKSB7XHJcbiAgICByZXR1cm4gRU1QVFlfRE9DVU1FTlRfVkVSU0lPTl9NQVA7XHJcbn1cclxudmFyIEVNUFRZX0RPQ1VNRU5UX0tFWV9TRVQgPSBuZXcgU29ydGVkU2V0KERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG5mdW5jdGlvbiBkb2N1bWVudEtleVNldCgpIHtcclxuICAgIHJldHVybiBFTVBUWV9ET0NVTUVOVF9LRVlfU0VUO1xyXG59XHJcbnZhciBFTVBUWV9UQVJHRVRfSURfU0VUID0gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuZnVuY3Rpb24gdGFyZ2V0SWRTZXQoKSB7XHJcbiAgICByZXR1cm4gRU1QVFlfVEFSR0VUX0lEX1NFVDtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERvY3VtZW50U2V0IGlzIGFuIGltbXV0YWJsZSAoY29weS1vbi13cml0ZSkgY29sbGVjdGlvbiB0aGF0IGhvbGRzIGRvY3VtZW50c1xyXG4gKiBpbiBvcmRlciBzcGVjaWZpZWQgYnkgdGhlIHByb3ZpZGVkIGNvbXBhcmF0b3IuIFdlIGFsd2F5cyBhZGQgYSBkb2N1bWVudCBrZXlcclxuICogY29tcGFyYXRvciBvbiB0b3Agb2Ygd2hhdCBpcyBwcm92aWRlZCB0byBndWFyYW50ZWUgZG9jdW1lbnQgZXF1YWxpdHkgYmFzZWQgb25cclxuICogdGhlIGtleS5cclxuICovXHJcbnZhciBEb2N1bWVudFNldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKiBUaGUgZGVmYXVsdCBvcmRlcmluZyBpcyBieSBrZXkgaWYgdGhlIGNvbXBhcmF0b3IgaXMgb21pdHRlZCAqL1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRTZXQoY29tcCkge1xyXG4gICAgICAgIC8vIFdlIGFyZSBhZGRpbmcgZG9jdW1lbnQga2V5IGNvbXBhcmF0b3IgdG8gdGhlIGVuZCBhcyBpdCdzIHRoZSBvbmx5XHJcbiAgICAgICAgLy8gZ3VhcmFudGVlZCB1bmlxdWUgcHJvcGVydHkgb2YgYSBkb2N1bWVudC5cclxuICAgICAgICBpZiAoY29tcCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoZDEsIGQyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcChkMSwgZDIpIHx8IERvY3VtZW50S2V5LmNvbXBhcmF0b3IoZDEua2V5LCBkMi5rZXkpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gZnVuY3Rpb24gKGQxLCBkMikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERvY3VtZW50S2V5LmNvbXBhcmF0b3IoZDEua2V5LCBkMi5rZXkpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmtleWVkTWFwID0gZG9jdW1lbnRNYXAoKTtcclxuICAgICAgICB0aGlzLnNvcnRlZFNldCA9IG5ldyBTb3J0ZWRNYXAodGhpcy5jb21wYXJhdG9yKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhbiBlbXB0eSBjb3B5IG9mIHRoZSBleGlzdGluZyBEb2N1bWVudFNldCwgdXNpbmcgdGhlIHNhbWVcclxuICAgICAqIGNvbXBhcmF0b3IuXHJcbiAgICAgKi9cclxuICAgIERvY3VtZW50U2V0LmVtcHR5U2V0ID0gZnVuY3Rpb24gKG9sZFNldCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRTZXQob2xkU2V0LmNvbXBhcmF0b3IpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5ZWRNYXAuZ2V0KGtleSkgIT0gbnVsbDtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmtleWVkTWFwLmdldChrZXkpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5maXJzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQubWluS2V5KCk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmxhc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0Lm1heEtleSgpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5pc0VtcHR5KCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgcHJvdmlkZWQga2V5IGluIHRoZSBkb2N1bWVudCBzZXQsIG9yIC0xIGlmIHRoZVxyXG4gICAgICogZG9jdW1lbnQga2V5IGlzIG5vdCBwcmVzZW50IGluIHRoZSBzZXQ7XHJcbiAgICAgKi9cclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBkb2MgPSB0aGlzLmtleWVkTWFwLmdldChrZXkpO1xyXG4gICAgICAgIHJldHVybiBkb2MgPyB0aGlzLnNvcnRlZFNldC5pbmRleE9mKGRvYykgOiAtMTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnRTZXQucHJvdG90eXBlLCBcInNpemVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQuc2l6ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKiBJdGVyYXRlcyBkb2N1bWVudHMgaW4gb3JkZXIgZGVmaW5lZCBieSBcImNvbXBhcmF0b3JcIiAqL1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2IpIHtcclxuICAgICAgICB0aGlzLnNvcnRlZFNldC5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICAgICAgICAgIGNiKGspO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEluc2VydHMgb3IgdXBkYXRlcyBhIGRvY3VtZW50IHdpdGggdGhlIHNhbWUga2V5ICovXHJcbiAgICBEb2N1bWVudFNldC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIC8vIEZpcnN0IHJlbW92ZSB0aGUgZWxlbWVudCBpZiB3ZSBoYXZlIGl0LlxyXG4gICAgICAgIHZhciBzZXQgPSB0aGlzLmRlbGV0ZShkb2Mua2V5KTtcclxuICAgICAgICByZXR1cm4gc2V0LmNvcHkoc2V0LmtleWVkTWFwLmluc2VydChkb2Mua2V5LCBkb2MpLCBzZXQuc29ydGVkU2V0Lmluc2VydChkb2MsIG51bGwpKTtcclxuICAgIH07XHJcbiAgICAvKiogRGVsZXRlcyBhIGRvY3VtZW50IHdpdGggYSBnaXZlbiBrZXkgKi9cclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGRvYyA9IHRoaXMuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKCFkb2MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkodGhpcy5rZXllZE1hcC5yZW1vdmUoa2V5KSwgdGhpcy5zb3J0ZWRTZXQucmVtb3ZlKGRvYykpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBEb2N1bWVudFNldCkpXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5zaXplICE9PSBvdGhlci5zaXplKVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgdmFyIHRoaXNJdCA9IHRoaXMuc29ydGVkU2V0LmdldEl0ZXJhdG9yKCk7XHJcbiAgICAgICAgdmFyIG90aGVySXQgPSBvdGhlci5zb3J0ZWRTZXQuZ2V0SXRlcmF0b3IoKTtcclxuICAgICAgICB3aGlsZSAodGhpc0l0Lmhhc05leHQoKSkge1xyXG4gICAgICAgICAgICB2YXIgdGhpc0RvYyA9IHRoaXNJdC5nZXROZXh0KCkua2V5O1xyXG4gICAgICAgICAgICB2YXIgb3RoZXJEb2MgPSBvdGhlckl0LmdldE5leHQoKS5rZXk7XHJcbiAgICAgICAgICAgIGlmICghdGhpc0RvYy5pc0VxdWFsKG90aGVyRG9jKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTZXQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBkb2NTdHJpbmdzID0gW107XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgZG9jU3RyaW5ncy5wdXNoKGRvYy50b1N0cmluZygpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoZG9jU3RyaW5ncy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuICdEb2N1bWVudFNldCAoKSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gJ0RvY3VtZW50U2V0IChcXG4gICcgKyBkb2NTdHJpbmdzLmpvaW4oJyAgXFxuJykgKyAnXFxuKSc7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERvY3VtZW50U2V0LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24gKGtleWVkTWFwLCBzb3J0ZWRTZXQpIHtcclxuICAgICAgICB2YXIgbmV3U2V0ID0gbmV3IERvY3VtZW50U2V0KCk7XHJcbiAgICAgICAgbmV3U2V0LmNvbXBhcmF0b3IgPSB0aGlzLmNvbXBhcmF0b3I7XHJcbiAgICAgICAgbmV3U2V0LmtleWVkTWFwID0ga2V5ZWRNYXA7XHJcbiAgICAgICAgbmV3U2V0LnNvcnRlZFNldCA9IHNvcnRlZFNldDtcclxuICAgICAgICByZXR1cm4gbmV3U2V0O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEb2N1bWVudFNldDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBDaGFuZ2VUeXBlO1xyXG4oZnVuY3Rpb24gKENoYW5nZVR5cGUpIHtcclxuICAgIENoYW5nZVR5cGVbQ2hhbmdlVHlwZVtcIkFkZGVkXCJdID0gMF0gPSBcIkFkZGVkXCI7XHJcbiAgICBDaGFuZ2VUeXBlW0NoYW5nZVR5cGVbXCJSZW1vdmVkXCJdID0gMV0gPSBcIlJlbW92ZWRcIjtcclxuICAgIENoYW5nZVR5cGVbQ2hhbmdlVHlwZVtcIk1vZGlmaWVkXCJdID0gMl0gPSBcIk1vZGlmaWVkXCI7XHJcbiAgICBDaGFuZ2VUeXBlW0NoYW5nZVR5cGVbXCJNZXRhZGF0YVwiXSA9IDNdID0gXCJNZXRhZGF0YVwiO1xyXG59KShDaGFuZ2VUeXBlIHx8IChDaGFuZ2VUeXBlID0ge30pKTtcclxudmFyIFN5bmNTdGF0ZTtcclxuKGZ1bmN0aW9uIChTeW5jU3RhdGUpIHtcclxuICAgIFN5bmNTdGF0ZVtTeW5jU3RhdGVbXCJMb2NhbFwiXSA9IDBdID0gXCJMb2NhbFwiO1xyXG4gICAgU3luY1N0YXRlW1N5bmNTdGF0ZVtcIlN5bmNlZFwiXSA9IDFdID0gXCJTeW5jZWRcIjtcclxufSkoU3luY1N0YXRlIHx8IChTeW5jU3RhdGUgPSB7fSkpO1xyXG4vKipcclxuICogRG9jdW1lbnRDaGFuZ2VTZXQga2VlcHMgdHJhY2sgb2YgYSBzZXQgb2YgY2hhbmdlcyB0byBkb2NzIGluIGEgcXVlcnksIG1lcmdpbmdcclxuICogZHVwbGljYXRlIGV2ZW50cyBmb3IgdGhlIHNhbWUgZG9jLlxyXG4gKi9cclxudmFyIERvY3VtZW50Q2hhbmdlU2V0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRDaGFuZ2VTZXQoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG4gICAgfVxyXG4gICAgRG9jdW1lbnRDaGFuZ2VTZXQucHJvdG90eXBlLnRyYWNrID0gZnVuY3Rpb24gKGNoYW5nZSkge1xyXG4gICAgICAgIHZhciBrZXkgPSBjaGFuZ2UuZG9jLmtleTtcclxuICAgICAgICB2YXIgb2xkQ2hhbmdlID0gdGhpcy5jaGFuZ2VNYXAuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKCFvbGRDaGFuZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSB0aGlzLmNoYW5nZU1hcC5pbnNlcnQoa2V5LCBjaGFuZ2UpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE1lcmdlIHRoZSBuZXcgY2hhbmdlIHdpdGggdGhlIGV4aXN0aW5nIGNoYW5nZS5cclxuICAgICAgICBpZiAoY2hhbmdlLnR5cGUgIT09IENoYW5nZVR5cGUuQWRkZWQgJiZcclxuICAgICAgICAgICAgb2xkQ2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuTWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSB0aGlzLmNoYW5nZU1hcC5pbnNlcnQoa2V5LCBjaGFuZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5NZXRhZGF0YSAmJlxyXG4gICAgICAgICAgICBvbGRDaGFuZ2UudHlwZSAhPT0gQ2hhbmdlVHlwZS5SZW1vdmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwID0gdGhpcy5jaGFuZ2VNYXAuaW5zZXJ0KGtleSwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogb2xkQ2hhbmdlLnR5cGUsXHJcbiAgICAgICAgICAgICAgICBkb2M6IGNoYW5nZS5kb2NcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLk1vZGlmaWVkICYmXHJcbiAgICAgICAgICAgIG9sZENoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLk1vZGlmaWVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwID0gdGhpcy5jaGFuZ2VNYXAuaW5zZXJ0KGtleSwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQ2hhbmdlVHlwZS5Nb2RpZmllZCxcclxuICAgICAgICAgICAgICAgIGRvYzogY2hhbmdlLmRvY1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuTW9kaWZpZWQgJiZcclxuICAgICAgICAgICAgb2xkQ2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuQWRkZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSB0aGlzLmNoYW5nZU1hcC5pbnNlcnQoa2V5LCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBDaGFuZ2VUeXBlLkFkZGVkLFxyXG4gICAgICAgICAgICAgICAgZG9jOiBjaGFuZ2UuZG9jXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjaGFuZ2UudHlwZSA9PT0gQ2hhbmdlVHlwZS5SZW1vdmVkICYmXHJcbiAgICAgICAgICAgIG9sZENoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLkFkZGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlTWFwID0gdGhpcy5jaGFuZ2VNYXAucmVtb3ZlKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLlJlbW92ZWQgJiZcclxuICAgICAgICAgICAgb2xkQ2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuTW9kaWZpZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSB0aGlzLmNoYW5nZU1hcC5pbnNlcnQoa2V5LCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBDaGFuZ2VUeXBlLlJlbW92ZWQsXHJcbiAgICAgICAgICAgICAgICBkb2M6IG9sZENoYW5nZS5kb2NcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLkFkZGVkICYmXHJcbiAgICAgICAgICAgIG9sZENoYW5nZS50eXBlID09PSBDaGFuZ2VUeXBlLlJlbW92ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAgPSB0aGlzLmNoYW5nZU1hcC5pbnNlcnQoa2V5LCB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBDaGFuZ2VUeXBlLk1vZGlmaWVkLFxyXG4gICAgICAgICAgICAgICAgZG9jOiBjaGFuZ2UuZG9jXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpbmNsdWRlcyB0aGVzZSBjYXNlcywgd2hpY2ggZG9uJ3QgbWFrZSBzZW5zZTpcclxuICAgICAgICAgICAgLy8gQWRkZWQtPkFkZGVkXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZWQtPlJlbW92ZWRcclxuICAgICAgICAgICAgLy8gTW9kaWZpZWQtPkFkZGVkXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZWQtPk1vZGlmaWVkXHJcbiAgICAgICAgICAgIC8vIE1ldGFkYXRhLT5BZGRlZFxyXG4gICAgICAgICAgICAvLyBSZW1vdmVkLT5NZXRhZGF0YVxyXG4gICAgICAgICAgICBmYWlsKCd1bnN1cHBvcnRlZCBjb21iaW5hdGlvbiBvZiBjaGFuZ2VzOiAnICtcclxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KGNoYW5nZSkgK1xyXG4gICAgICAgICAgICAgICAgJyBhZnRlciAnICtcclxuICAgICAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KG9sZENoYW5nZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEb2N1bWVudENoYW5nZVNldC5wcm90b3R5cGUuZ2V0Q2hhbmdlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY2hhbmdlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlTWFwLmlub3JkZXJUcmF2ZXJzYWwoZnVuY3Rpb24gKGtleSwgY2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGNoYW5nZXMucHVzaChjaGFuZ2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBjaGFuZ2VzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEb2N1bWVudENoYW5nZVNldDtcclxufSgpKTtcclxudmFyIFZpZXdTbmFwc2hvdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFZpZXdTbmFwc2hvdChxdWVyeSwgZG9jcywgb2xkRG9jcywgZG9jQ2hhbmdlcywgbXV0YXRlZEtleXMsIGZyb21DYWNoZSwgc3luY1N0YXRlQ2hhbmdlZCwgZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICAgICAgdGhpcy5kb2NzID0gZG9jcztcclxuICAgICAgICB0aGlzLm9sZERvY3MgPSBvbGREb2NzO1xyXG4gICAgICAgIHRoaXMuZG9jQ2hhbmdlcyA9IGRvY0NoYW5nZXM7XHJcbiAgICAgICAgdGhpcy5tdXRhdGVkS2V5cyA9IG11dGF0ZWRLZXlzO1xyXG4gICAgICAgIHRoaXMuZnJvbUNhY2hlID0gZnJvbUNhY2hlO1xyXG4gICAgICAgIHRoaXMuc3luY1N0YXRlQ2hhbmdlZCA9IHN5bmNTdGF0ZUNoYW5nZWQ7XHJcbiAgICAgICAgdGhpcy5leGNsdWRlc01ldGFkYXRhQ2hhbmdlcyA9IGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzO1xyXG4gICAgfVxyXG4gICAgLyoqIFJldHVybnMgYSB2aWV3IHNuYXBzaG90IGFzIGlmIGFsbCBkb2N1bWVudHMgaW4gdGhlIHNuYXBzaG90IHdlcmUgYWRkZWQuICovXHJcbiAgICBWaWV3U25hcHNob3QuZnJvbUluaXRpYWxEb2N1bWVudHMgPSBmdW5jdGlvbiAocXVlcnksIGRvY3VtZW50cywgbXV0YXRlZEtleXMsIGZyb21DYWNoZSkge1xyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gW107XHJcbiAgICAgICAgZG9jdW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICBjaGFuZ2VzLnB1c2goeyB0eXBlOiBDaGFuZ2VUeXBlLkFkZGVkLCBkb2M6IGRvYyB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbmV3IFZpZXdTbmFwc2hvdChxdWVyeSwgZG9jdW1lbnRzLCBEb2N1bWVudFNldC5lbXB0eVNldChkb2N1bWVudHMpLCBjaGFuZ2VzLCBtdXRhdGVkS2V5cywgZnJvbUNhY2hlLCB0cnVlLCBmYWxzZSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdTbmFwc2hvdC5wcm90b3R5cGUsIFwiaGFzUGVuZGluZ1dyaXRlc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhdGhpcy5tdXRhdGVkS2V5cy5pc0VtcHR5KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBWaWV3U25hcHNob3QucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5mcm9tQ2FjaGUgIT09IG90aGVyLmZyb21DYWNoZSB8fFxyXG4gICAgICAgICAgICB0aGlzLnN5bmNTdGF0ZUNoYW5nZWQgIT09IG90aGVyLnN5bmNTdGF0ZUNoYW5nZWQgfHxcclxuICAgICAgICAgICAgIXRoaXMubXV0YXRlZEtleXMuaXNFcXVhbChvdGhlci5tdXRhdGVkS2V5cykgfHxcclxuICAgICAgICAgICAgIXRoaXMucXVlcnkuaXNFcXVhbChvdGhlci5xdWVyeSkgfHxcclxuICAgICAgICAgICAgIXRoaXMuZG9jcy5pc0VxdWFsKG90aGVyLmRvY3MpIHx8XHJcbiAgICAgICAgICAgICF0aGlzLm9sZERvY3MuaXNFcXVhbChvdGhlci5vbGREb2NzKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gdGhpcy5kb2NDaGFuZ2VzO1xyXG4gICAgICAgIHZhciBvdGhlckNoYW5nZXMgPSBvdGhlci5kb2NDaGFuZ2VzO1xyXG4gICAgICAgIGlmIChjaGFuZ2VzLmxlbmd0aCAhPT0gb3RoZXJDaGFuZ2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoY2hhbmdlc1tpXS50eXBlICE9PSBvdGhlckNoYW5nZXNbaV0udHlwZSB8fFxyXG4gICAgICAgICAgICAgICAgIWNoYW5nZXNbaV0uZG9jLmlzRXF1YWwob3RoZXJDaGFuZ2VzW2ldLmRvYykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVmlld1NuYXBzaG90O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEFuIGV2ZW50IGZyb20gdGhlIFJlbW90ZVN0b3JlLiBJdCBpcyBzcGxpdCBpbnRvIHRhcmdldENoYW5nZXMgKGNoYW5nZXMgdG8gdGhlXHJcbiAqIHN0YXRlIG9yIHRoZSBzZXQgb2YgZG9jdW1lbnRzIGluIG91ciB3YXRjaGVkIHRhcmdldHMpIGFuZCBkb2N1bWVudFVwZGF0ZXNcclxuICogKGNoYW5nZXMgdG8gdGhlIGFjdHVhbCBkb2N1bWVudHMpLlxyXG4gKi9cclxudmFyIFJlbW90ZUV2ZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVtb3RlRXZlbnQoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzbmFwc2hvdCB2ZXJzaW9uIHRoaXMgZXZlbnQgYnJpbmdzIHVzIHVwIHRvLCBvciBNSU4gaWYgbm90IHNldC5cclxuICAgICAqL1xyXG4gICAgc25hcHNob3RWZXJzaW9uLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBtYXAgZnJvbSB0YXJnZXQgdG8gY2hhbmdlcyB0byB0aGUgdGFyZ2V0LiBTZWUgVGFyZ2V0Q2hhbmdlLlxyXG4gICAgICovXHJcbiAgICB0YXJnZXRDaGFuZ2VzLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBzZXQgb2YgdGFyZ2V0cyB0aGF0IGlzIGtub3duIHRvIGJlIGluY29uc2lzdGVudC4gTGlzdGVucyBmb3IgdGhlc2VcclxuICAgICAqIHRhcmdldHMgc2hvdWxkIGJlIHJlLWVzdGFibGlzaGVkIHdpdGhvdXQgcmVzdW1lIHRva2Vucy5cclxuICAgICAqL1xyXG4gICAgdGFyZ2V0TWlzbWF0Y2hlcywgXHJcbiAgICAvKipcclxuICAgICAqIEEgc2V0IG9mIHdoaWNoIGRvY3VtZW50cyBoYXZlIGNoYW5nZWQgb3IgYmVlbiBkZWxldGVkLCBhbG9uZyB3aXRoIHRoZVxyXG4gICAgICogZG9jJ3MgbmV3IHZhbHVlcyAoaWYgbm90IGRlbGV0ZWQpLlxyXG4gICAgICovXHJcbiAgICBkb2N1bWVudFVwZGF0ZXMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHNldCBvZiB3aGljaCBkb2N1bWVudCB1cGRhdGVzIGFyZSBkdWUgb25seSB0byBsaW1ibyByZXNvbHV0aW9uIHRhcmdldHMuXHJcbiAgICAgKi9cclxuICAgIHJlc29sdmVkTGltYm9Eb2N1bWVudHMpIHtcclxuICAgICAgICB0aGlzLnNuYXBzaG90VmVyc2lvbiA9IHNuYXBzaG90VmVyc2lvbjtcclxuICAgICAgICB0aGlzLnRhcmdldENoYW5nZXMgPSB0YXJnZXRDaGFuZ2VzO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0TWlzbWF0Y2hlcyA9IHRhcmdldE1pc21hdGNoZXM7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudFVwZGF0ZXMgPSBkb2N1bWVudFVwZGF0ZXM7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlZExpbWJvRG9jdW1lbnRzID0gcmVzb2x2ZWRMaW1ib0RvY3VtZW50cztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogSEFDSzogVmlld3MgcmVxdWlyZSBSZW1vdGVFdmVudHMgaW4gb3JkZXIgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHZpZXcgaXNcclxuICAgICAqIENVUlJFTlQsIGJ1dCBzZWNvbmRhcnkgdGFicyBkb24ndCByZWNlaXZlIHJlbW90ZSBldmVudHMuIFNvIHRoaXMgbWV0aG9kIGlzXHJcbiAgICAgKiB1c2VkIHRvIGNyZWF0ZSBhIHN5bnRoZXNpemVkIFJlbW90ZUV2ZW50IHRoYXQgY2FuIGJlIHVzZWQgdG8gYXBwbHkgYVxyXG4gICAgICogQ1VSUkVOVCBzdGF0dXMgY2hhbmdlIHRvIGEgVmlldywgZm9yIHF1ZXJpZXMgZXhlY3V0ZWQgaW4gYSBkaWZmZXJlbnQgdGFiLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5XHJcbiAgICBSZW1vdGVFdmVudC5jcmVhdGVTeW50aGVzaXplZFJlbW90ZUV2ZW50Rm9yQ3VycmVudENoYW5nZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgY3VycmVudCkge1xyXG4gICAgICAgIHZhciB0YXJnZXRDaGFuZ2VzID0gKF9hID0ge30sIF9hW3RhcmdldElkXSA9IFRhcmdldENoYW5nZS5jcmVhdGVTeW50aGVzaXplZFRhcmdldENoYW5nZUZvckN1cnJlbnRDaGFuZ2UodGFyZ2V0SWQsIGN1cnJlbnQpLCBfYSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVFdmVudChTbmFwc2hvdFZlcnNpb24uTUlOLCB0YXJnZXRDaGFuZ2VzLCB0YXJnZXRJZFNldCgpLCBtYXliZURvY3VtZW50TWFwKCksIGRvY3VtZW50S2V5U2V0KCkpO1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVtb3RlRXZlbnQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIFRhcmdldENoYW5nZSBzcGVjaWZpZXMgdGhlIHNldCBvZiBjaGFuZ2VzIGZvciBhIHNwZWNpZmljIHRhcmdldCBhcyBwYXJ0IG9mXHJcbiAqIGEgUmVtb3RlRXZlbnQuIFRoZXNlIGNoYW5nZXMgdHJhY2sgd2hpY2ggZG9jdW1lbnRzIGFyZSBhZGRlZCwgbW9kaWZpZWQgb3JcclxuICogcmVtb3ZlZCwgYXMgd2VsbCBhcyB0aGUgdGFyZ2V0J3MgcmVzdW1lIHRva2VuIGFuZCB3aGV0aGVyIHRoZSB0YXJnZXQgaXNcclxuICogbWFya2VkIENVUlJFTlQuXHJcbiAqIFRoZSBhY3R1YWwgY2hhbmdlcyAqdG8qIGRvY3VtZW50cyBhcmUgbm90IHBhcnQgb2YgdGhlIFRhcmdldENoYW5nZSBzaW5jZVxyXG4gKiBkb2N1bWVudHMgbWF5IGJlIHBhcnQgb2YgbXVsdGlwbGUgdGFyZ2V0cy5cclxuICovXHJcbnZhciBUYXJnZXRDaGFuZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUYXJnZXRDaGFuZ2UoXHJcbiAgICAvKipcclxuICAgICAqIEFuIG9wYXF1ZSwgc2VydmVyLWFzc2lnbmVkIHRva2VuIHRoYXQgYWxsb3dzIHdhdGNoaW5nIGEgcXVlcnkgdG8gYmUgcmVzdW1lZFxyXG4gICAgICogYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0IG1hdGNoZXMgdGhlXHJcbiAgICAgKiBxdWVyeS4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW4gdGltZSBmcm9tIHdoaWNoXHJcbiAgICAgKiB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxyXG4gICAgICovXHJcbiAgICByZXN1bWVUb2tlbiwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBcImN1cnJlbnRcIiAoc3luY2VkKSBzdGF0dXMgb2YgdGhpcyB0YXJnZXQuIE5vdGUgdGhhdCBcImN1cnJlbnRcIlxyXG4gICAgICogaGFzIHNwZWNpYWwgbWVhbmluZyBpbiB0aGUgUlBDIHByb3RvY29sIHRoYXQgaW1wbGllcyB0aGF0IGEgdGFyZ2V0IGlzXHJcbiAgICAgKiBib3RoIHVwLXRvLWRhdGUgYW5kIGNvbnNpc3RlbnQgd2l0aCB0aGUgcmVzdCBvZiB0aGUgd2F0Y2ggc3RyZWFtLlxyXG4gICAgICovXHJcbiAgICBjdXJyZW50LCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIG5ld2x5IGFzc2lnbmVkIHRvIHRoaXMgdGFyZ2V0IGFzIHBhcnQgb2ZcclxuICAgICAqIHRoaXMgcmVtb3RlIGV2ZW50LlxyXG4gICAgICovXHJcbiAgICBhZGRlZERvY3VtZW50cywgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSBhbHJlYWR5IGFzc2lnbmVkIHRvIHRoaXMgdGFyZ2V0IGJ1dCByZWNlaXZlZFxyXG4gICAgICogYW4gdXBkYXRlIGR1cmluZyB0aGlzIHJlbW90ZSBldmVudC5cclxuICAgICAqL1xyXG4gICAgbW9kaWZpZWREb2N1bWVudHMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgcmVtb3ZlZCBmcm9tIHRoaXMgdGFyZ2V0IGFzIHBhcnQgb2YgdGhpc1xyXG4gICAgICogcmVtb3RlIGV2ZW50LlxyXG4gICAgICovXHJcbiAgICByZW1vdmVkRG9jdW1lbnRzKSB7XHJcbiAgICAgICAgdGhpcy5yZXN1bWVUb2tlbiA9IHJlc3VtZVRva2VuO1xyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IGN1cnJlbnQ7XHJcbiAgICAgICAgdGhpcy5hZGRlZERvY3VtZW50cyA9IGFkZGVkRG9jdW1lbnRzO1xyXG4gICAgICAgIHRoaXMubW9kaWZpZWREb2N1bWVudHMgPSBtb2RpZmllZERvY3VtZW50cztcclxuICAgICAgICB0aGlzLnJlbW92ZWREb2N1bWVudHMgPSByZW1vdmVkRG9jdW1lbnRzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBIQUNLOiBWaWV3cyByZXF1aXJlIFRhcmdldENoYW5nZXMgaW4gb3JkZXIgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHZpZXcgaXNcclxuICAgICAqIENVUlJFTlQsIGJ1dCBzZWNvbmRhcnkgdGFicyBkb24ndCByZWNlaXZlIHJlbW90ZSBldmVudHMuIFNvIHRoaXMgbWV0aG9kIGlzXHJcbiAgICAgKiB1c2VkIHRvIGNyZWF0ZSBhIHN5bnRoZXNpemVkIFRhcmdldENoYW5nZXMgdGhhdCBjYW4gYmUgdXNlZCB0byBhcHBseSBhXHJcbiAgICAgKiBDVVJSRU5UIHN0YXR1cyBjaGFuZ2UgdG8gYSBWaWV3LCBmb3IgcXVlcmllcyBleGVjdXRlZCBpbiBhIGRpZmZlcmVudCB0YWIuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcclxuICAgIFRhcmdldENoYW5nZS5jcmVhdGVTeW50aGVzaXplZFRhcmdldENoYW5nZUZvckN1cnJlbnRDaGFuZ2UgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIGN1cnJlbnQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFRhcmdldENoYW5nZShlbXB0eUJ5dGVTdHJpbmcoKSwgY3VycmVudCwgZG9jdW1lbnRLZXlTZXQoKSwgZG9jdW1lbnRLZXlTZXQoKSwgZG9jdW1lbnRLZXlTZXQoKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRhcmdldENoYW5nZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgY2hhbmdlZCBkb2N1bWVudCBhbmQgYSBsaXN0IG9mIHRhcmdldCBpZHMgdG8gd2hpY2ggdGhpcyBjaGFuZ2VcclxuICogYXBwbGllcy5cclxuICpcclxuICogSWYgZG9jdW1lbnQgaGFzIGJlZW4gZGVsZXRlZCBOb0RvY3VtZW50IHdpbGwgYmUgcHJvdmlkZWQuXHJcbiAqL1xyXG52YXIgRG9jdW1lbnRXYXRjaENoYW5nZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERvY3VtZW50V2F0Y2hDaGFuZ2UoXHJcbiAgICAvKiogVGhlIG5ldyBkb2N1bWVudCBhcHBsaWVzIHRvIGFsbCBvZiB0aGVzZSB0YXJnZXRzLiAqL1xyXG4gICAgdXBkYXRlZFRhcmdldElkcywgXHJcbiAgICAvKiogVGhlIG5ldyBkb2N1bWVudCBpcyByZW1vdmVkIGZyb20gYWxsIG9mIHRoZXNlIHRhcmdldHMuICovXHJcbiAgICByZW1vdmVkVGFyZ2V0SWRzLCBcclxuICAgIC8qKiBUaGUga2V5IG9mIHRoZSBkb2N1bWVudCBmb3IgdGhpcyBjaGFuZ2UuICovXHJcbiAgICBrZXksIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbmV3IGRvY3VtZW50IG9yIE5vRG9jdW1lbnQgaWYgaXQgd2FzIGRlbGV0ZWQuIElzIG51bGwgaWYgdGhlXHJcbiAgICAgKiBkb2N1bWVudCB3ZW50IG91dCBvZiB2aWV3IHdpdGhvdXQgdGhlIHNlcnZlciBzZW5kaW5nIGEgbmV3IGRvY3VtZW50LlxyXG4gICAgICovXHJcbiAgICBuZXdEb2MpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZWRUYXJnZXRJZHMgPSB1cGRhdGVkVGFyZ2V0SWRzO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlZFRhcmdldElkcyA9IHJlbW92ZWRUYXJnZXRJZHM7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgdGhpcy5uZXdEb2MgPSBuZXdEb2M7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRG9jdW1lbnRXYXRjaENoYW5nZTtcclxufSgpKTtcclxudmFyIEV4aXN0ZW5jZUZpbHRlckNoYW5nZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEV4aXN0ZW5jZUZpbHRlckNoYW5nZSh0YXJnZXRJZCwgZXhpc3RlbmNlRmlsdGVyKSB7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgIHRoaXMuZXhpc3RlbmNlRmlsdGVyID0gZXhpc3RlbmNlRmlsdGVyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEV4aXN0ZW5jZUZpbHRlckNoYW5nZTtcclxufSgpKTtcclxudmFyIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGU7XHJcbihmdW5jdGlvbiAoV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZSkge1xyXG4gICAgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtXYXRjaFRhcmdldENoYW5nZVN0YXRlW1wiTm9DaGFuZ2VcIl0gPSAwXSA9IFwiTm9DaGFuZ2VcIjtcclxuICAgIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtcIkFkZGVkXCJdID0gMV0gPSBcIkFkZGVkXCI7XHJcbiAgICBXYXRjaFRhcmdldENoYW5nZVN0YXRlW1dhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbXCJSZW1vdmVkXCJdID0gMl0gPSBcIlJlbW92ZWRcIjtcclxuICAgIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGVbV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtcIkN1cnJlbnRcIl0gPSAzXSA9IFwiQ3VycmVudFwiO1xyXG4gICAgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZVtXYXRjaFRhcmdldENoYW5nZVN0YXRlW1wiUmVzZXRcIl0gPSA0XSA9IFwiUmVzZXRcIjtcclxufSkoV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZSB8fCAoV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZSA9IHt9KSk7XHJcbnZhciBXYXRjaFRhcmdldENoYW5nZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdhdGNoVGFyZ2V0Q2hhbmdlKFxyXG4gICAgLyoqIFdoYXQga2luZCBvZiBjaGFuZ2Ugb2NjdXJyZWQgdG8gdGhlIHdhdGNoIHRhcmdldC4gKi9cclxuICAgIHN0YXRlLCBcclxuICAgIC8qKiBUaGUgdGFyZ2V0IElEcyB0aGF0IHdlcmUgYWRkZWQvcmVtb3ZlZC9zZXQuICovXHJcbiAgICB0YXJnZXRJZHMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHF1ZXJ5IHRvIGJlXHJcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxyXG4gICAgICogbWF0Y2hlcyB0aGUgcXVlcnkuIFRoZSByZXN1bWUgdG9rZW4gZXNzZW50aWFsbHkgaWRlbnRpZmllcyBhIHBvaW50IGluXHJcbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cclxuICAgICAqL1xyXG4gICAgcmVzdW1lVG9rZW4sIFxyXG4gICAgLyoqIEFuIFJQQyBlcnJvciBpbmRpY2F0aW5nIHdoeSB0aGUgd2F0Y2ggZmFpbGVkLiAqL1xyXG4gICAgY2F1c2UpIHtcclxuICAgICAgICBpZiAocmVzdW1lVG9rZW4gPT09IHZvaWQgMCkgeyByZXN1bWVUb2tlbiA9IGVtcHR5Qnl0ZVN0cmluZygpOyB9XHJcbiAgICAgICAgaWYgKGNhdXNlID09PSB2b2lkIDApIHsgY2F1c2UgPSBudWxsOyB9XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWRzID0gdGFyZ2V0SWRzO1xyXG4gICAgICAgIHRoaXMucmVzdW1lVG9rZW4gPSByZXN1bWVUb2tlbjtcclxuICAgICAgICB0aGlzLmNhdXNlID0gY2F1c2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gV2F0Y2hUYXJnZXRDaGFuZ2U7XHJcbn0oKSk7XHJcbi8qKiBUcmFja3MgdGhlIGludGVybmFsIHN0YXRlIG9mIGEgV2F0Y2ggdGFyZ2V0LiAqL1xyXG52YXIgVGFyZ2V0U3RhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUYXJnZXRTdGF0ZSgpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgbnVtYmVyIG9mIHBlbmRpbmcgcmVzcG9uc2VzIChhZGRzIG9yIHJlbW92ZXMpIHRoYXQgd2UgYXJlIHdhaXRpbmcgb24uXHJcbiAgICAgICAgICogV2Ugb25seSBjb25zaWRlciB0YXJnZXRzIGFjdGl2ZSB0aGF0IGhhdmUgbm8gcGVuZGluZyByZXNwb25zZXMuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wZW5kaW5nUmVzcG9uc2VzID0gMDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnQgY2hhbmdlcyBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBUaGVzZSBjaGFuZ2VzIGFyZSBjb250aW51b3VzbHkgdXBkYXRlZCBhcyB3ZSByZWNlaXZlIGRvY3VtZW50IHVwZGF0ZXMgYW5kXHJcbiAgICAgICAgICogYWx3YXlzIHJlZmxlY3QgdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMgYWdhaW5zdCB0aGUgbGFzdCBpc3N1ZWQgc25hcHNob3QuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5kb2N1bWVudENoYW5nZXMgPSBzbmFwc2hvdENoYW5nZXNNYXAoKTtcclxuICAgICAgICAvKiogU2VlIHB1YmxpYyBnZXR0ZXJzIGZvciBleHBsYW5hdGlvbnMgb2YgdGhlc2UgZmllbGRzLiAqL1xyXG4gICAgICAgIHRoaXMuX3Jlc3VtZVRva2VuID0gZW1wdHlCeXRlU3RyaW5nKCk7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudCA9IGZhbHNlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFdoZXRoZXIgdGhpcyB0YXJnZXQgc3RhdGUgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBuZXh0IHNuYXBzaG90LiBXZVxyXG4gICAgICAgICAqIGluaXRpYWxpemUgdG8gdHJ1ZSBzbyB0aGF0IG5ld2x5LWFkZGVkIHRhcmdldHMgYXJlIGluY2x1ZGVkIGluIHRoZSBuZXh0XHJcbiAgICAgICAgICogUmVtb3RlRXZlbnQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5faGFzUGVuZGluZ0NoYW5nZXMgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhcmdldFN0YXRlLnByb3RvdHlwZSwgXCJjdXJyZW50XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBXaGV0aGVyIHRoaXMgdGFyZ2V0IGhhcyBiZWVuIG1hcmtlZCAnY3VycmVudCcuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAnQ3VycmVudCcgaGFzIHNwZWNpYWwgbWVhbmluZyBpbiB0aGUgUlBDIHByb3RvY29sOiBJdCBpbXBsaWVzIHRoYXQgdGhlXHJcbiAgICAgICAgICogV2F0Y2ggYmFja2VuZCBoYXMgc2VudCB1cyBhbGwgY2hhbmdlcyB1cCB0byB0aGUgcG9pbnQgYXQgd2hpY2ggdGhlIHRhcmdldFxyXG4gICAgICAgICAqIHdhcyBhZGRlZCBhbmQgdGhhdCB0aGUgdGFyZ2V0IGlzIGNvbnNpc3RlbnQgd2l0aCB0aGUgcmVzdCBvZiB0aGUgd2F0Y2hcclxuICAgICAgICAgKiBzdHJlYW0uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhcmdldFN0YXRlLnByb3RvdHlwZSwgXCJyZXN1bWVUb2tlblwiLCB7XHJcbiAgICAgICAgLyoqIFRoZSBsYXN0IHJlc3VtZSB0b2tlbiBzZW50IHRvIHVzIGZvciB0aGlzIHRhcmdldC4gKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc3VtZVRva2VuO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhcmdldFN0YXRlLnByb3RvdHlwZSwgXCJpc1BlbmRpbmdcIiwge1xyXG4gICAgICAgIC8qKiBXaGV0aGVyIHRoaXMgdGFyZ2V0IGhhcyBwZW5kaW5nIHRhcmdldCBhZGRzIG9yIHRhcmdldCByZW1vdmVzLiAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wZW5kaW5nUmVzcG9uc2VzICE9PSAwO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhcmdldFN0YXRlLnByb3RvdHlwZSwgXCJoYXNQZW5kaW5nQ2hhbmdlc1wiLCB7XHJcbiAgICAgICAgLyoqIFdoZXRoZXIgd2UgaGF2ZSBtb2RpZmllZCBhbnkgc3RhdGUgdGhhdCBzaG91bGQgdHJpZ2dlciBhIHNuYXBzaG90LiAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faGFzUGVuZGluZ0NoYW5nZXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEFwcGxpZXMgdGhlIHJlc3VtZSB0b2tlbiB0byB0aGUgVGFyZ2V0Q2hhbmdlLCBidXQgb25seSB3aGVuIGl0IGhhcyBhIG5ld1xyXG4gICAgICogdmFsdWUuIEVtcHR5IHJlc3VtZVRva2VucyBhcmUgZGlzY2FyZGVkLlxyXG4gICAgICovXHJcbiAgICBUYXJnZXRTdGF0ZS5wcm90b3R5cGUudXBkYXRlUmVzdW1lVG9rZW4gPSBmdW5jdGlvbiAocmVzdW1lVG9rZW4pIHtcclxuICAgICAgICBpZiAocmVzdW1lVG9rZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLl9oYXNQZW5kaW5nQ2hhbmdlcyA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3Jlc3VtZVRva2VuID0gcmVzdW1lVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIHRhcmdldCBjaGFuZ2UgZnJvbSB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy5cclxuICAgICAqXHJcbiAgICAgKiBUbyByZXNldCB0aGUgZG9jdW1lbnQgY2hhbmdlcyBhZnRlciByYWlzaW5nIHRoaXMgc25hcHNob3QsIGNhbGxcclxuICAgICAqIGBjbGVhclBlbmRpbmdDaGFuZ2VzKClgLlxyXG4gICAgICovXHJcbiAgICBUYXJnZXRTdGF0ZS5wcm90b3R5cGUudG9UYXJnZXRDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFkZGVkRG9jdW1lbnRzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB2YXIgbW9kaWZpZWREb2N1bWVudHMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHZhciByZW1vdmVkRG9jdW1lbnRzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB0aGlzLmRvY3VtZW50Q2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIGNoYW5nZVR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChjaGFuZ2VUeXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuQWRkZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkZWREb2N1bWVudHMgPSBhZGRlZERvY3VtZW50cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5Nb2RpZmllZDpcclxuICAgICAgICAgICAgICAgICAgICBtb2RpZmllZERvY3VtZW50cyA9IG1vZGlmaWVkRG9jdW1lbnRzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLlJlbW92ZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZERvY3VtZW50cyA9IHJlbW92ZWREb2N1bWVudHMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGZhaWwoJ0VuY291bnRlcmVkIGludmFsaWQgY2hhbmdlIHR5cGU6ICcgKyBjaGFuZ2VUeXBlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBuZXcgVGFyZ2V0Q2hhbmdlKHRoaXMuX3Jlc3VtZVRva2VuLCB0aGlzLl9jdXJyZW50LCBhZGRlZERvY3VtZW50cywgbW9kaWZpZWREb2N1bWVudHMsIHJlbW92ZWREb2N1bWVudHMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVzZXRzIHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFuZCBzZXRzIGBoYXNQZW5kaW5nQ2hhbmdlc2AgdG8gZmFsc2UuXHJcbiAgICAgKi9cclxuICAgIFRhcmdldFN0YXRlLnByb3RvdHlwZS5jbGVhclBlbmRpbmdDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX2hhc1BlbmRpbmdDaGFuZ2VzID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudENoYW5nZXMgPSBzbmFwc2hvdENoYW5nZXNNYXAoKTtcclxuICAgIH07XHJcbiAgICBUYXJnZXRTdGF0ZS5wcm90b3R5cGUuYWRkRG9jdW1lbnRDaGFuZ2UgPSBmdW5jdGlvbiAoa2V5LCBjaGFuZ2VUeXBlKSB7XHJcbiAgICAgICAgdGhpcy5faGFzUGVuZGluZ0NoYW5nZXMgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRDaGFuZ2VzID0gdGhpcy5kb2N1bWVudENoYW5nZXMuaW5zZXJ0KGtleSwgY2hhbmdlVHlwZSk7XHJcbiAgICB9O1xyXG4gICAgVGFyZ2V0U3RhdGUucHJvdG90eXBlLnJlbW92ZURvY3VtZW50Q2hhbmdlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHRoaXMuX2hhc1BlbmRpbmdDaGFuZ2VzID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmRvY3VtZW50Q2hhbmdlcyA9IHRoaXMuZG9jdW1lbnRDaGFuZ2VzLnJlbW92ZShrZXkpO1xyXG4gICAgfTtcclxuICAgIFRhcmdldFN0YXRlLnByb3RvdHlwZS5yZWNvcmRQZW5kaW5nVGFyZ2V0UmVxdWVzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnBlbmRpbmdSZXNwb25zZXMgKz0gMTtcclxuICAgIH07XHJcbiAgICBUYXJnZXRTdGF0ZS5wcm90b3R5cGUucmVjb3JkVGFyZ2V0UmVzcG9uc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nUmVzcG9uc2VzIC09IDE7XHJcbiAgICB9O1xyXG4gICAgVGFyZ2V0U3RhdGUucHJvdG90eXBlLm1hcmtDdXJyZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX2hhc1BlbmRpbmdDaGFuZ2VzID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9jdXJyZW50ID0gdHJ1ZTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVGFyZ2V0U3RhdGU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIGhlbHBlciBjbGFzcyB0byBhY2N1bXVsYXRlIHdhdGNoIGNoYW5nZXMgaW50byBhIFJlbW90ZUV2ZW50LlxyXG4gKi9cclxudmFyIFdhdGNoQ2hhbmdlQWdncmVnYXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdhdGNoQ2hhbmdlQWdncmVnYXRvcihtZXRhZGF0YVByb3ZpZGVyKSB7XHJcbiAgICAgICAgdGhpcy5tZXRhZGF0YVByb3ZpZGVyID0gbWV0YWRhdGFQcm92aWRlcjtcclxuICAgICAgICAvKiogVGhlIGludGVybmFsIHN0YXRlIG9mIGFsbCB0cmFja2VkIHRhcmdldHMuICovXHJcbiAgICAgICAgdGhpcy50YXJnZXRTdGF0ZXMgPSB7fTtcclxuICAgICAgICAvKiogS2VlcHMgdHJhY2sgb2YgdGhlIGRvY3VtZW50cyB0byB1cGRhdGUgc2luY2UgdGhlIGxhc3QgcmFpc2VkIHNuYXBzaG90LiAqL1xyXG4gICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VXBkYXRlcyA9IG1heWJlRG9jdW1lbnRNYXAoKTtcclxuICAgICAgICAvKiogQSBtYXBwaW5nIG9mIGRvY3VtZW50IGtleXMgdG8gdGhlaXIgc2V0IG9mIHRhcmdldCBJRHMuICovXHJcbiAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nID0gZG9jdW1lbnRUYXJnZXRNYXAoKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hlcy4gVGhlc2UgdGFyZ2V0cyBhcmVcclxuICAgICAgICAgKiBrbm93biB0byBiZSBpbmNvbnNpc3RlbnQgYW5kIHRoZWlyIGxpc3RlbnMgbmVlZHMgdG8gYmUgcmUtZXN0YWJsaXNoZWQgYnlcclxuICAgICAgICAgKiBSZW1vdGVTdG9yZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnBlbmRpbmdUYXJnZXRSZXNldHMgPSBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9jZXNzZXMgYW5kIGFkZHMgdGhlIERvY3VtZW50V2F0Y2hDaGFuZ2UgdG8gdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuaGFuZGxlRG9jdW1lbnRDaGFuZ2UgPSBmdW5jdGlvbiAoZG9jQ2hhbmdlKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGRvY0NoYW5nZS51cGRhdGVkVGFyZ2V0SWRzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0SWQgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmIChkb2NDaGFuZ2UubmV3RG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkRG9jdW1lbnRUb1RhcmdldCh0YXJnZXRJZCwgZG9jQ2hhbmdlLm5ld0RvYyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZG9jQ2hhbmdlLm5ld0RvYyBpbnN0YW5jZW9mIE5vRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRG9jdW1lbnRGcm9tVGFyZ2V0KHRhcmdldElkLCBkb2NDaGFuZ2Uua2V5LCBkb2NDaGFuZ2UubmV3RG9jKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBfYiA9IDAsIF9jID0gZG9jQ2hhbmdlLnJlbW92ZWRUYXJnZXRJZHM7IF9iIDwgX2MubGVuZ3RoOyBfYisrKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IF9jW19iXTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVEb2N1bWVudEZyb21UYXJnZXQodGFyZ2V0SWQsIGRvY0NoYW5nZS5rZXksIGRvY0NoYW5nZS5uZXdEb2MpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogUHJvY2Vzc2VzIGFuZCBhZGRzIHRoZSBXYXRjaFRhcmdldENoYW5nZSB0byB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy4gKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuaGFuZGxlVGFyZ2V0Q2hhbmdlID0gZnVuY3Rpb24gKHRhcmdldENoYW5nZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoVGFyZ2V0KHRhcmdldENoYW5nZSwgZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRTdGF0ZSA9IF90aGlzLmVuc3VyZVRhcmdldFN0YXRlKHRhcmdldElkKTtcclxuICAgICAgICAgICAgc3dpdGNoICh0YXJnZXRDaGFuZ2Uuc3RhdGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5Ob0NoYW5nZTpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNBY3RpdmVUYXJnZXQodGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLnVwZGF0ZVJlc3VtZVRva2VuKHRhcmdldENoYW5nZS5yZXN1bWVUb2tlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLkFkZGVkOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gZGVjcmVtZW50IHRoZSBudW1iZXIgb2YgcGVuZGluZyBhY2tzIG5lZWRlZCBmcm9tIHdhdGNoXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9yIHRoaXMgdGFyZ2V0SWQuXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUucmVjb3JkVGFyZ2V0UmVzcG9uc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldFN0YXRlLmlzUGVuZGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIGEgZnJlc2hseSBhZGRlZCB0YXJnZXQsIHNvIHdlIG5lZWQgdG8gcmVzZXQgYW55IHN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoYXQgd2UgaGFkIHByZXZpb3VzbHkuIFRoaXMgY2FuIGhhcHBlbiBlLmcuIHdoZW4gcmVtb3ZlIGFuZCBhZGRcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFjayBhIHRhcmdldCBmb3IgZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS5jbGVhclBlbmRpbmdDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLnVwZGF0ZVJlc3VtZVRva2VuKHRhcmdldENoYW5nZS5yZXN1bWVUb2tlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVtb3ZlZDpcclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGtlZXAgdHJhY2sgb2YgcmVtb3ZlZCB0YXJnZXRzIHRvIHdlIGNhbiBwb3N0LWZpbHRlciBhbmRcclxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgYW55IHRhcmdldCBjaGFuZ2VzLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gZGVjcmVtZW50IHRoZSBudW1iZXIgb2YgcGVuZGluZyBhY2tzIG5lZWRlZCBmcm9tIHdhdGNoXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9yIHRoaXMgdGFyZ2V0SWQuXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUucmVjb3JkVGFyZ2V0UmVzcG9uc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldFN0YXRlLmlzUGVuZGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdmVUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIXRhcmdldENoYW5nZS5jYXVzZSwgJ1dhdGNoQ2hhbmdlQWdncmVnYXRvciBkb2VzIG5vdCBoYW5kbGUgZXJyb3JlZCB0YXJnZXRzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQ3VycmVudDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNBY3RpdmVUYXJnZXQodGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLm1hcmtDdXJyZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFN0YXRlLnVwZGF0ZVJlc3VtZVRva2VuKHRhcmdldENoYW5nZS5yZXN1bWVUb2tlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlc2V0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc0FjdGl2ZVRhcmdldCh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIHRhcmdldCBhbmQgc3ludGhlc2l6ZXMgcmVtb3ZlcyBmb3IgYWxsIGV4aXN0aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50cy4gVGhlIGJhY2tlbmQgd2lsbCByZS1hZGQgYW55IGRvY3VtZW50cyB0aGF0IHN0aWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1hdGNoIHRoZSB0YXJnZXQgYmVmb3JlIGl0IHNlbmRzIHRoZSBuZXh0IGdsb2JhbCBzbmFwc2hvdC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVzZXRUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdGF0ZS51cGRhdGVSZXN1bWVUb2tlbih0YXJnZXRDaGFuZ2UucmVzdW1lVG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgZmFpbCgnVW5rbm93biB0YXJnZXQgd2F0Y2ggY2hhbmdlIHN0YXRlOiAnICsgdGFyZ2V0Q2hhbmdlLnN0YXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhbGwgdGFyZ2V0SWRzIHRoYXQgdGhlIHdhdGNoIGNoYW5nZSBhcHBsaWVzIHRvOiBlaXRoZXIgdGhlXHJcbiAgICAgKiB0YXJnZXRJZHMgZXhwbGljaXRseSBsaXN0ZWQgaW4gdGhlIGNoYW5nZSBvciB0aGUgdGFyZ2V0SWRzIG9mIGFsbCBjdXJyZW50bHlcclxuICAgICAqIGFjdGl2ZSB0YXJnZXRzLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmZvckVhY2hUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0Q2hhbmdlLCBmbikge1xyXG4gICAgICAgIGlmICh0YXJnZXRDaGFuZ2UudGFyZ2V0SWRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlLnRhcmdldElkcy5mb3JFYWNoKGZuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvckVhY2hOdW1iZXIodGhpcy50YXJnZXRTdGF0ZXMsIGZuKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBIYW5kbGVzIGV4aXN0ZW5jZSBmaWx0ZXJzIGFuZCBzeW50aGVzaXplcyBkZWxldGVzIGZvciBmaWx0ZXIgbWlzbWF0Y2hlcy5cclxuICAgICAqIFRhcmdldHMgdGhhdCBhcmUgaW52YWxpZGF0ZWQgYnkgZmlsdGVyIG1pc21hdGNoZXMgYXJlIGFkZGVkIHRvXHJcbiAgICAgKiBgcGVuZGluZ1RhcmdldFJlc2V0c2AuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUuaGFuZGxlRXhpc3RlbmNlRmlsdGVyID0gZnVuY3Rpb24gKHdhdGNoQ2hhbmdlKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldElkID0gd2F0Y2hDaGFuZ2UudGFyZ2V0SWQ7XHJcbiAgICAgICAgdmFyIGV4cGVjdGVkQ291bnQgPSB3YXRjaENoYW5nZS5leGlzdGVuY2VGaWx0ZXIuY291bnQ7XHJcbiAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IHRoaXMucXVlcnlEYXRhRm9yQWN0aXZlVGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICBpZiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IHF1ZXJ5RGF0YS5xdWVyeTtcclxuICAgICAgICAgICAgaWYgKHF1ZXJ5LmlzRG9jdW1lbnRRdWVyeSgpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXhwZWN0ZWRDb3VudCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBleGlzdGVuY2UgZmlsdGVyIHRvbGQgdXMgdGhlIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0LiBXZSBkZWR1Y2VcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGF0IHRoaXMgZG9jdW1lbnQgZG9lcyBub3QgZXhpc3QgYW5kIGFwcGx5IGEgZGVsZXRlZCBkb2N1bWVudCB0b1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG91ciB1cGRhdGVzLiBXaXRob3V0IGFwcGx5aW5nIHRoaXMgZGVsZXRlZCBkb2N1bWVudCB0aGVyZSBtaWdodCBiZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFub3RoZXIgcXVlcnkgdGhhdCB3aWxsIHJhaXNlIHRoaXMgZG9jdW1lbnQgYXMgcGFydCBvZiBhIHNuYXBzaG90XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdW50aWwgaXQgaXMgcmVzb2x2ZWQsIGVzc2VudGlhbGx5IGV4cG9zaW5nIGluY29uc2lzdGVuY3kgYmV0d2VlblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHF1ZXJpZXMuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IG5ldyBEb2N1bWVudEtleShxdWVyeS5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZURvY3VtZW50RnJvbVRhcmdldCh0YXJnZXRJZCwga2V5LCBuZXcgTm9Eb2N1bWVudChrZXksIFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCkpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChleHBlY3RlZENvdW50ID09PSAxLCAnU2luZ2xlIGRvY3VtZW50IGV4aXN0ZW5jZSBmaWx0ZXIgd2l0aCBjb3VudDogJyArIGV4cGVjdGVkQ291bnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRTaXplID0gdGhpcy5nZXRDdXJyZW50RG9jdW1lbnRDb3VudEZvclRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFNpemUgIT09IGV4cGVjdGVkQ291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBFeGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoOiBXZSByZXNldCB0aGUgbWFwcGluZyBhbmQgcmFpc2UgYSBuZXdcclxuICAgICAgICAgICAgICAgICAgICAvLyBzbmFwc2hvdCB3aXRoIGBpc0Zyb21DYWNoZTp0cnVlYC5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0VGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBlbmRpbmdUYXJnZXRSZXNldHMgPSB0aGlzLnBlbmRpbmdUYXJnZXRSZXNldHMuYWRkKHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnRzIHRoZSBjdXJyZW50bHkgYWNjdW11bGF0ZWQgc3RhdGUgaW50byBhIHJlbW90ZSBldmVudCBhdCB0aGVcclxuICAgICAqIHByb3ZpZGVkIHNuYXBzaG90IHZlcnNpb24uIFJlc2V0cyB0aGUgYWNjdW11bGF0ZWQgY2hhbmdlcyBiZWZvcmUgcmV0dXJuaW5nLlxyXG4gICAgICovXHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmNyZWF0ZVJlbW90ZUV2ZW50ID0gZnVuY3Rpb24gKHNuYXBzaG90VmVyc2lvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRhcmdldENoYW5nZXMgPSB7fTtcclxuICAgICAgICBmb3JFYWNoTnVtYmVyKHRoaXMudGFyZ2V0U3RhdGVzLCBmdW5jdGlvbiAodGFyZ2V0SWQsIHRhcmdldFN0YXRlKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeURhdGEgPSBfdGhpcy5xdWVyeURhdGFGb3JBY3RpdmVUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICBpZiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0U3RhdGUuY3VycmVudCAmJiBxdWVyeURhdGEucXVlcnkuaXNEb2N1bWVudFF1ZXJ5KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBEb2N1bWVudCBxdWVyaWVzIGZvciBkb2N1bWVudCB0aGF0IGRvbid0IGV4aXN0IGNhbiBwcm9kdWNlIGFuIGVtcHR5XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzdWx0IHNldC4gVG8gdXBkYXRlIG91ciBsb2NhbCBjYWNoZSwgd2Ugc3ludGhlc2l6ZSBhIGRvY3VtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVsZXRlIGlmIHdlIGhhdmUgbm90IHByZXZpb3VzbHkgcmVjZWl2ZWQgdGhlIGRvY3VtZW50LiBUaGlzXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzb2x2ZXMgdGhlIGxpbWJvIHN0YXRlIG9mIHRoZSBkb2N1bWVudCwgcmVtb3ZpbmcgaXQgZnJvbVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGxpbWJvRG9jdW1lbnRSZWZzLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBJZGVhbGx5IHdlIHdvdWxkIGhhdmUgYW4gZXhwbGljaXQgbG9va3VwIHF1ZXJ5XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaW5zdGVhZCByZXN1bHRpbmcgaW4gYW4gZXhwbGljaXQgZGVsZXRlIG1lc3NhZ2UgYW5kIHdlIGNvdWxkXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoaXMgc3BlY2lhbCBsb2dpYy5cclxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gbmV3IERvY3VtZW50S2V5KHF1ZXJ5RGF0YS5xdWVyeS5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGVuZGluZ0RvY3VtZW50VXBkYXRlcy5nZXQoa2V5KSA9PT0gbnVsbCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAhX3RoaXMudGFyZ2V0Q29udGFpbnNEb2N1bWVudCh0YXJnZXRJZCwga2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdmVEb2N1bWVudEZyb21UYXJnZXQodGFyZ2V0SWQsIGtleSwgbmV3IE5vRG9jdW1lbnQoa2V5LCBzbmFwc2hvdFZlcnNpb24pKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0U3RhdGUuaGFzUGVuZGluZ0NoYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRDaGFuZ2VzW3RhcmdldElkXSA9IHRhcmdldFN0YXRlLnRvVGFyZ2V0Q2hhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0U3RhdGUuY2xlYXJQZW5kaW5nQ2hhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHJlc29sdmVkTGltYm9Eb2N1bWVudHMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIC8vIFdlIGV4dHJhY3QgdGhlIHNldCBvZiBsaW1iby1vbmx5IGRvY3VtZW50IHVwZGF0ZXMgYXMgdGhlIEdDIGxvZ2ljXHJcbiAgICAgICAgLy8gc3BlY2lhbC1jYXNlcyBkb2N1bWVudHMgdGhhdCBkbyBub3QgYXBwZWFyIGluIHRoZSBxdWVyeSBjYWNoZS5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIFRPRE8oZ3NvbHRpcyk6IEV4cGFuZCBvbiB0aGlzIGNvbW1lbnQgb25jZSBHQyBpcyBhdmFpbGFibGUgaW4gdGhlIEpTXHJcbiAgICAgICAgLy8gY2xpZW50LlxyXG4gICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VGFyZ2V0TWFwcGluZy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIHRhcmdldHMpIHtcclxuICAgICAgICAgICAgdmFyIGlzT25seUxpbWJvVGFyZ2V0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGFyZ2V0cy5mb3JFYWNoV2hpbGUoZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnlEYXRhID0gX3RoaXMucXVlcnlEYXRhRm9yQWN0aXZlVGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgIGlmIChxdWVyeURhdGEgJiYgcXVlcnlEYXRhLnB1cnBvc2UgIT09IFF1ZXJ5UHVycG9zZS5MaW1ib1Jlc29sdXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBpc09ubHlMaW1ib1RhcmdldCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGlzT25seUxpbWJvVGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlZExpbWJvRG9jdW1lbnRzID0gcmVzb2x2ZWRMaW1ib0RvY3VtZW50cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciByZW1vdGVFdmVudCA9IG5ldyBSZW1vdGVFdmVudChzbmFwc2hvdFZlcnNpb24sIHRhcmdldENoYW5nZXMsIHRoaXMucGVuZGluZ1RhcmdldFJlc2V0cywgdGhpcy5wZW5kaW5nRG9jdW1lbnRVcGRhdGVzLCByZXNvbHZlZExpbWJvRG9jdW1lbnRzKTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFVwZGF0ZXMgPSBtYXliZURvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRUYXJnZXRNYXBwaW5nID0gZG9jdW1lbnRUYXJnZXRNYXAoKTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdUYXJnZXRSZXNldHMgPSBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgICAgIHJldHVybiByZW1vdGVFdmVudDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgdGhlIHByb3ZpZGVkIGRvY3VtZW50IHRvIHRoZSBpbnRlcm5hbCBsaXN0IG9mIGRvY3VtZW50IHVwZGF0ZXMgYW5kXHJcbiAgICAgKiBpdHMgZG9jdW1lbnQga2V5IHRvIHRoZSBnaXZlbiB0YXJnZXQncyBtYXBwaW5nLlxyXG4gICAgICovXHJcbiAgICAvLyBWaXNpYmxlIGZvciB0ZXN0aW5nLlxyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5hZGREb2N1bWVudFRvVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkLCBkb2N1bWVudCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0FjdGl2ZVRhcmdldCh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY2hhbmdlVHlwZSA9IHRoaXMudGFyZ2V0Q29udGFpbnNEb2N1bWVudCh0YXJnZXRJZCwgZG9jdW1lbnQua2V5KVxyXG4gICAgICAgICAgICA/IENoYW5nZVR5cGUuTW9kaWZpZWRcclxuICAgICAgICAgICAgOiBDaGFuZ2VUeXBlLkFkZGVkO1xyXG4gICAgICAgIHZhciB0YXJnZXRTdGF0ZSA9IHRoaXMuZW5zdXJlVGFyZ2V0U3RhdGUodGFyZ2V0SWQpO1xyXG4gICAgICAgIHRhcmdldFN0YXRlLmFkZERvY3VtZW50Q2hhbmdlKGRvY3VtZW50LmtleSwgY2hhbmdlVHlwZSk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nRG9jdW1lbnRVcGRhdGVzID0gdGhpcy5wZW5kaW5nRG9jdW1lbnRVcGRhdGVzLmluc2VydChkb2N1bWVudC5rZXksIGRvY3VtZW50KTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcgPSB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcuaW5zZXJ0KGRvY3VtZW50LmtleSwgdGhpcy5lbnN1cmVEb2N1bWVudFRhcmdldE1hcHBpbmcoZG9jdW1lbnQua2V5KS5hZGQodGFyZ2V0SWQpKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgdGhlIHByb3ZpZGVkIGRvY3VtZW50IGZyb20gdGhlIHRhcmdldCBtYXBwaW5nLiBJZiB0aGVcclxuICAgICAqIGRvY3VtZW50IG5vIGxvbmdlciBtYXRjaGVzIHRoZSB0YXJnZXQsIGJ1dCB0aGUgZG9jdW1lbnQncyBzdGF0ZSBpcyBzdGlsbFxyXG4gICAgICoga25vd24gKGUuZy4gd2Uga25vdyB0aGF0IHRoZSBkb2N1bWVudCB3YXMgZGVsZXRlZCBvciB3ZSByZWNlaXZlZCB0aGUgY2hhbmdlXHJcbiAgICAgKiB0aGF0IGNhdXNlZCB0aGUgZmlsdGVyIG1pc21hdGNoKSwgdGhlIG5ldyBkb2N1bWVudCBjYW4gYmUgcHJvdmlkZWRcclxuICAgICAqIHRvIHVwZGF0ZSB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLlxyXG4gICAgICovXHJcbiAgICAvLyBWaXNpYmxlIGZvciB0ZXN0aW5nLlxyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5yZW1vdmVEb2N1bWVudEZyb21UYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIGtleSwgdXBkYXRlZERvY3VtZW50KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlVGFyZ2V0KHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0YXJnZXRTdGF0ZSA9IHRoaXMuZW5zdXJlVGFyZ2V0U3RhdGUodGFyZ2V0SWQpO1xyXG4gICAgICAgIGlmICh0aGlzLnRhcmdldENvbnRhaW5zRG9jdW1lbnQodGFyZ2V0SWQsIGtleSkpIHtcclxuICAgICAgICAgICAgdGFyZ2V0U3RhdGUuYWRkRG9jdW1lbnRDaGFuZ2Uoa2V5LCBDaGFuZ2VUeXBlLlJlbW92ZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVGhlIGRvY3VtZW50IG1heSBoYXZlIGVudGVyZWQgYW5kIGxlZnQgdGhlIHRhcmdldCBiZWZvcmUgd2UgcmFpc2VkIGFcclxuICAgICAgICAgICAgLy8gc25hcHNob3QsIHNvIHdlIGNhbiBqdXN0IGlnbm9yZSB0aGUgY2hhbmdlLlxyXG4gICAgICAgICAgICB0YXJnZXRTdGF0ZS5yZW1vdmVEb2N1bWVudENoYW5nZShrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcgPSB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcuaW5zZXJ0KGtleSwgdGhpcy5lbnN1cmVEb2N1bWVudFRhcmdldE1hcHBpbmcoa2V5KS5kZWxldGUodGFyZ2V0SWQpKTtcclxuICAgICAgICBpZiAodXBkYXRlZERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ0RvY3VtZW50VXBkYXRlcyA9IHRoaXMucGVuZGluZ0RvY3VtZW50VXBkYXRlcy5pbnNlcnQoa2V5LCB1cGRhdGVkRG9jdW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLnJlbW92ZVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLnRhcmdldFN0YXRlc1t0YXJnZXRJZF07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IGNvdW50IG9mIGRvY3VtZW50cyBpbiB0aGUgdGFyZ2V0LiBUaGlzIGluY2x1ZGVzIGJvdGhcclxuICAgICAqIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRoYXQgdGhlIExvY2FsU3RvcmUgY29uc2lkZXJzIHRvIGJlIHBhcnQgb2YgdGhlXHJcbiAgICAgKiB0YXJnZXQgYXMgd2VsbCBhcyBhbnkgYWNjdW11bGF0ZWQgY2hhbmdlcy5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5nZXRDdXJyZW50RG9jdW1lbnRDb3VudEZvclRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciB0YXJnZXRTdGF0ZSA9IHRoaXMuZW5zdXJlVGFyZ2V0U3RhdGUodGFyZ2V0SWQpO1xyXG4gICAgICAgIHZhciB0YXJnZXRDaGFuZ2UgPSB0YXJnZXRTdGF0ZS50b1RhcmdldENoYW5nZSgpO1xyXG4gICAgICAgIHJldHVybiAodGhpcy5tZXRhZGF0YVByb3ZpZGVyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQodGFyZ2V0SWQpLnNpemUgK1xyXG4gICAgICAgICAgICB0YXJnZXRDaGFuZ2UuYWRkZWREb2N1bWVudHMuc2l6ZSAtXHJcbiAgICAgICAgICAgIHRhcmdldENoYW5nZS5yZW1vdmVkRG9jdW1lbnRzLnNpemUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW5jcmVtZW50IHRoZSBudW1iZXIgb2YgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaCBiZWZvcmUgd2UgY2FuIGNvbnNpZGVyIHRoZVxyXG4gICAgICogc2VydmVyIHRvIGJlICdpbi1zeW5jJyB3aXRoIHRoZSBjbGllbnQncyBhY3RpdmUgdGFyZ2V0cy5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5yZWNvcmRQZW5kaW5nVGFyZ2V0UmVxdWVzdCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIC8vIEZvciBlYWNoIHJlcXVlc3Qgd2UgZ2V0IHdlIG5lZWQgdG8gcmVjb3JkIHdlIG5lZWQgYSByZXNwb25zZSBmb3IgaXQuXHJcbiAgICAgICAgdmFyIHRhcmdldFN0YXRlID0gdGhpcy5lbnN1cmVUYXJnZXRTdGF0ZSh0YXJnZXRJZCk7XHJcbiAgICAgICAgdGFyZ2V0U3RhdGUucmVjb3JkUGVuZGluZ1RhcmdldFJlcXVlc3QoKTtcclxuICAgIH07XHJcbiAgICBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IucHJvdG90eXBlLmVuc3VyZVRhcmdldFN0YXRlID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnRhcmdldFN0YXRlc1t0YXJnZXRJZF0pIHtcclxuICAgICAgICAgICAgdGhpcy50YXJnZXRTdGF0ZXNbdGFyZ2V0SWRdID0gbmV3IFRhcmdldFN0YXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnRhcmdldFN0YXRlc1t0YXJnZXRJZF07XHJcbiAgICB9O1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5lbnN1cmVEb2N1bWVudFRhcmdldE1hcHBpbmcgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIHRhcmdldE1hcHBpbmcgPSB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKCF0YXJnZXRNYXBwaW5nKSB7XHJcbiAgICAgICAgICAgIHRhcmdldE1hcHBpbmcgPSBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpO1xyXG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcgPSB0aGlzLnBlbmRpbmdEb2N1bWVudFRhcmdldE1hcHBpbmcuaW5zZXJ0KGtleSwgdGFyZ2V0TWFwcGluZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0YXJnZXRNYXBwaW5nO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVmVyaWZpZXMgdGhhdCB0aGUgdXNlciBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoaXMgdGFyZ2V0IChieSBjYWxsaW5nXHJcbiAgICAgKiBgZ2V0UXVlcnlEYXRhRm9yVGFyZ2V0KClgKSBhbmQgdGhhdCB3ZSBhcmUgbm90IHdhaXRpbmcgZm9yIHBlbmRpbmcgQUREc1xyXG4gICAgICogZnJvbSB3YXRjaC5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5pc0FjdGl2ZVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5RGF0YUZvckFjdGl2ZVRhcmdldCh0YXJnZXRJZCkgIT09IG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBRdWVyeURhdGEgZm9yIGFuIGFjdGl2ZSB0YXJnZXQgKGkuZS4gYSB0YXJnZXQgdGhhdCB0aGUgdXNlclxyXG4gICAgICogaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGF0IGhhcyBubyBvdXRzdGFuZGluZyB0YXJnZXQgY2hhbmdlIHJlcXVlc3RzKS5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnByb3RvdHlwZS5xdWVyeURhdGFGb3JBY3RpdmVUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0U3RhdGUgPSB0aGlzLnRhcmdldFN0YXRlc1t0YXJnZXRJZF07XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldFN0YXRlICYmIHRhcmdldFN0YXRlLmlzUGVuZGluZ1xyXG4gICAgICAgICAgICA/IG51bGxcclxuICAgICAgICAgICAgOiB0aGlzLm1ldGFkYXRhUHJvdmlkZXIuZ2V0UXVlcnlEYXRhRm9yVGFyZ2V0KHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0cyB0aGUgc3RhdGUgb2YgYSBXYXRjaCB0YXJnZXQgdG8gaXRzIGluaXRpYWwgc3RhdGUgKGUuZy4gc2V0c1xyXG4gICAgICogJ2N1cnJlbnQnIHRvIGZhbHNlLCBjbGVhcnMgdGhlIHJlc3VtZSB0b2tlbiBhbmQgcmVtb3ZlcyBpdHMgdGFyZ2V0IG1hcHBpbmdcclxuICAgICAqIGZyb20gYWxsIGRvY3VtZW50cykuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUucmVzZXRUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCghdGhpcy50YXJnZXRTdGF0ZXNbdGFyZ2V0SWRdLmlzUGVuZGluZywgJ1Nob3VsZCBvbmx5IHJlc2V0IGFjdGl2ZSB0YXJnZXRzJyk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRTdGF0ZXNbdGFyZ2V0SWRdID0gbmV3IFRhcmdldFN0YXRlKCk7XHJcbiAgICAgICAgLy8gVHJpZ2dlciByZW1vdmFsIGZvciBhbnkgZG9jdW1lbnRzIGN1cnJlbnRseSBtYXBwZWQgdG8gdGhpcyB0YXJnZXQuXHJcbiAgICAgICAgLy8gVGhlc2UgcmVtb3ZhbHMgd2lsbCBiZSBwYXJ0IG9mIHRoZSBpbml0aWFsIHNuYXBzaG90IGlmIFdhdGNoIGRvZXMgbm90XHJcbiAgICAgICAgLy8gcmVzZW5kIHRoZXNlIGRvY3VtZW50cy5cclxuICAgICAgICB2YXIgZXhpc3RpbmdLZXlzID0gdGhpcy5tZXRhZGF0YVByb3ZpZGVyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgIGV4aXN0aW5nS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgX3RoaXMucmVtb3ZlRG9jdW1lbnRGcm9tVGFyZ2V0KHRhcmdldElkLCBrZXksIC8qdXBkYXRlZERvY3VtZW50PSovIG51bGwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBMb2NhbFN0b3JlIGNvbnNpZGVycyB0aGUgZG9jdW1lbnQgdG8gYmUgcGFydCBvZiB0aGVcclxuICAgICAqIHNwZWNpZmllZCB0YXJnZXQuXHJcbiAgICAgKi9cclxuICAgIFdhdGNoQ2hhbmdlQWdncmVnYXRvci5wcm90b3R5cGUudGFyZ2V0Q29udGFpbnNEb2N1bWVudCA9IGZ1bmN0aW9uICh0YXJnZXRJZCwga2V5KSB7XHJcbiAgICAgICAgdmFyIGV4aXN0aW5nS2V5cyA9IHRoaXMubWV0YWRhdGFQcm92aWRlci5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICByZXR1cm4gZXhpc3RpbmdLZXlzLmhhcyhrZXkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBXYXRjaENoYW5nZUFnZ3JlZ2F0b3I7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGRvY3VtZW50VGFyZ2V0TWFwKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbn1cclxuZnVuY3Rpb24gc25hcHNob3RDaGFuZ2VzTWFwKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBESVJFQ1RJT05TID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBkaXJzID0ge307XHJcbiAgICBkaXJzW0RpcmVjdGlvbi5BU0NFTkRJTkcubmFtZV0gPSAnQVNDRU5ESU5HJztcclxuICAgIGRpcnNbRGlyZWN0aW9uLkRFU0NFTkRJTkcubmFtZV0gPSAnREVTQ0VORElORyc7XHJcbiAgICByZXR1cm4gZGlycztcclxufSkoKTtcclxudmFyIE9QRVJBVE9SUyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgb3BzID0ge307XHJcbiAgICBvcHNbUmVsYXRpb25PcC5MRVNTX1RIQU4ubmFtZV0gPSAnTEVTU19USEFOJztcclxuICAgIG9wc1tSZWxhdGlvbk9wLkxFU1NfVEhBTl9PUl9FUVVBTC5uYW1lXSA9ICdMRVNTX1RIQU5fT1JfRVFVQUwnO1xyXG4gICAgb3BzW1JlbGF0aW9uT3AuR1JFQVRFUl9USEFOLm5hbWVdID0gJ0dSRUFURVJfVEhBTic7XHJcbiAgICBvcHNbUmVsYXRpb25PcC5HUkVBVEVSX1RIQU5fT1JfRVFVQUwubmFtZV0gPSAnR1JFQVRFUl9USEFOX09SX0VRVUFMJztcclxuICAgIG9wc1tSZWxhdGlvbk9wLkVRVUFMLm5hbWVdID0gJ0VRVUFMJztcclxuICAgIG9wc1tSZWxhdGlvbk9wLkFSUkFZX0NPTlRBSU5TLm5hbWVdID0gJ0FSUkFZX0NPTlRBSU5TJztcclxuICAgIHJldHVybiBvcHM7XHJcbn0pKCk7XHJcbi8vIEEgUmVnRXhwIG1hdGNoaW5nIElTTyA4NjAxIFVUQyB0aW1lc3RhbXBzIHdpdGggb3B0aW9uYWwgZnJhY3Rpb24uXHJcbnZhciBJU09fUkVHX0VYUCA9IG5ldyBSZWdFeHAoL15cXGR7NH0tXFxkXFxkLVxcZFxcZFRcXGRcXGQ6XFxkXFxkOlxcZFxcZCg/OlxcLihcXGQrKSk/WiQvKTtcclxuZnVuY3Rpb24gYXNzZXJ0UHJlc2VudCh2YWx1ZSwgZGVzY3JpcHRpb24pIHtcclxuICAgIGFzc2VydCghaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpLCBkZXNjcmlwdGlvbiArICcgaXMgbWlzc2luZycpO1xyXG59XHJcbmZ1bmN0aW9uIHBhcnNlSW50NjQodmFsdWUpIHtcclxuICAgIC8vIFRPRE8oYmpvcm5pY2spOiBIYW5kbGUgaW50NjQgZ3JlYXRlciB0aGFuIDUzIGJpdHMuXHJcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICByZXR1cm4gTnVtYmVyKHZhbHVlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmYWlsKFwiY2FuJ3QgcGFyc2UgXCIgKyB2YWx1ZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEdlbmVyYXRlcyBKc29uT2JqZWN0IHZhbHVlcyBmb3IgdGhlIERhdGFzdG9yZSBBUEkgc3VpdGFibGUgZm9yIHNlbmRpbmcgdG9cclxuICogZWl0aGVyIEdSUEMgc3R1YiBtZXRob2RzIG9yIHZpYSB0aGUgSlNPTi9IVFRQIFJFU1QgQVBJLlxyXG4gKiBUT0RPKGtsaW10KTogV2UgY2FuIHJlbW92ZSB0aGUgZGF0YWJhc2VJZCBhcmd1bWVudCBpZiB3ZSBrZWVwIHRoZSBmdWxsXHJcbiAqIHJlc291cmNlIG5hbWUgaW4gZG9jdW1lbnRzLlxyXG4gKi9cclxudmFyIEpzb25Qcm90b1NlcmlhbGl6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBKc29uUHJvdG9TZXJpYWxpemVyKGRhdGFiYXNlSWQsIG9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLmRhdGFiYXNlSWQgPSBkYXRhYmFzZUlkO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgICB9XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5lbXB0eUJ5dGVTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy51c2VQcm90bzNKc29uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSgwKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudW5zYWZlQ2FzdFByb3RvQnl0ZVN0cmluZyA9IGZ1bmN0aW9uIChieXRlU3RyaW5nKSB7XHJcbiAgICAgICAgLy8gYnl0ZVN0cmluZ3MgY2FuIGJlIGVpdGhlciBzdHJpbmcgb3IgVUludDhBcnJheSwgYnV0IHRoZSB0eXBpbmdzIHNheVxyXG4gICAgICAgIC8vIGl0J3MgYWx3YXlzIGEgc3RyaW5nLiBDYXN0IGFzIHN0cmluZyB0byBhdm9pZCB0eXBlIGNoZWNrIGZhaWxpbmdcclxuICAgICAgICByZXR1cm4gYnl0ZVN0cmluZztcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tUnBjU3RhdHVzID0gZnVuY3Rpb24gKHN0YXR1cykge1xyXG4gICAgICAgIHZhciBjb2RlID0gc3RhdHVzLmNvZGUgPT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICA/IENvZGUuVU5LTk9XTlxyXG4gICAgICAgICAgICA6IG1hcENvZGVGcm9tUnBjQ29kZShzdGF0dXMuY29kZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGaXJlc3RvcmVFcnJvcihjb2RlLCBzdGF0dXMubWVzc2FnZSB8fCAnJyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGEgbnVtYmVyIChvciB1bmRlZmluZWQpIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50b1xyXG4gICAgICogYSBnb29nbGUucHJvdG9idWYuSW50MzJWYWx1ZSBwcm90by5cclxuICAgICAqIERPIE5PVCBVU0UgVEhJUyBGT1IgQU5ZVEhJTkcgRUxTRS5cclxuICAgICAqIFRoaXMgbWV0aG9kIGNoZWF0cy4gSXQncyB0eXBlZCBhcyByZXR1cm5pbmcgXCJudW1iZXJcIiBiZWNhdXNlIHRoYXQncyB3aGF0XHJcbiAgICAgKiBvdXIgZ2VuZXJhdGVkIHByb3RvIGludGVyZmFjZXMgc2F5IEludDMyVmFsdWUgbXVzdCBiZS4gQnV0IEdSUEMgYWN0dWFsbHlcclxuICAgICAqIGV4cGVjdHMgYSB7IHZhbHVlOiA8bnVtYmVyPiB9IHN0cnVjdC5cclxuICAgICAqL1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9JbnQzMlZhbHVlID0gZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgIGlmICghaXNOdWxsT3JVbmRlZmluZWQodmFsKSkge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IFdlIG5lZWQgdG8gbWF0Y2ggZ2VuZXJhdGVkIFByb3RvIHR5cGVzLlxyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogdmFsIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBudW1iZXIgKG9yIG51bGwpIGZyb20gYSBnb29nbGUucHJvdG9idWYuSW50MzJWYWx1ZSBwcm90by5cclxuICAgICAqIERPIE5PVCBVU0UgVEhJUyBGT1IgQU5ZVEhJTkcgRUxTRS5cclxuICAgICAqIFRoaXMgbWV0aG9kIGNoZWF0cy4gSXQncyB0eXBlZCBhcyBhY2NlcHRpbmcgXCJudW1iZXJcIiBiZWNhdXNlIHRoYXQncyB3aGF0XHJcbiAgICAgKiBvdXIgZ2VuZXJhdGVkIHByb3RvIGludGVyZmFjZXMgc2F5IEludDMyVmFsdWUgbXVzdCBiZSwgYnV0IGl0IGFjdHVhbGx5XHJcbiAgICAgKiBhY2NlcHRzIHsgdmFsdWU6IG51bWJlciB9IHRvIG1hdGNoIG91ciBzZXJpYWxpemF0aW9uIGluIHRvSW50MzJWYWx1ZSgpLlxyXG4gICAgICovXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tSW50MzJWYWx1ZSA9IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IFdlIG5lZWQgdG8gbWF0Y2ggZ2VuZXJhdGVkIFByb3RvIHR5cGVzLlxyXG4gICAgICAgICAgICByZXN1bHQgPSB2YWwudmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBXZSBhY2NlcHQgcmF3IG51bWJlcnMgKHdpdGhvdXQgdGhlIHt2YWx1ZTogLi4uIH0gd3JhcHBlcikgZm9yXHJcbiAgICAgICAgICAgIC8vIGNvbXBhdGliaWxpdHkgd2l0aCBsZWdhY3kgcGVyc2lzdGVkIGRhdGEuXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGlzTnVsbE9yVW5kZWZpbmVkKHJlc3VsdCkgPyBudWxsIDogcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIHZhbHVlIGZvciBhIERhdGUgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbnRvIGEgcHJvdG8uXHJcbiAgICAgKiBETyBOT1QgVVNFIFRISVMgRk9SIEFOWVRISU5HIEVMU0UuXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBjaGVhdHMuIEl0J3MgdHlwZWQgYXMgcmV0dXJuaW5nIFwic3RyaW5nXCIgYmVjYXVzZSB0aGF0J3Mgd2hhdFxyXG4gICAgICogb3VyIGdlbmVyYXRlZCBwcm90byBpbnRlcmZhY2VzIHNheSBkYXRlcyBtdXN0IGJlLiBCdXQgaXQncyBlYXNpZXIgYW5kIHNhZmVyXHJcbiAgICAgKiB0byBhY3R1YWxseSByZXR1cm4gYSBUaW1lc3RhbXAgcHJvdG8uXHJcbiAgICAgKi9cclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvVGltZXN0YW1wID0gZnVuY3Rpb24gKHRpbWVzdGFtcCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNlY29uZHM6IHRpbWVzdGFtcC5zZWNvbmRzLFxyXG4gICAgICAgICAgICBuYW5vczogdGltZXN0YW1wLm5hbm9zZWNvbmRzXHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21UaW1lc3RhbXAgPSBmdW5jdGlvbiAoZGF0ZSkge1xyXG4gICAgICAgIC8vIFRoZSBqc29uIGludGVyZmFjZSAoZm9yIHRoZSBicm93c2VyKSB3aWxsIHJldHVybiBhbiBpc28gdGltZXN0YW1wIHN0cmluZyxcclxuICAgICAgICAvLyB3aGlsZSB0aGUgcHJvdG8ganMgbGlicmFyeSAoZm9yIG5vZGUpIHdpbGwgcmV0dXJuIGFcclxuICAgICAgICAvLyBnb29nbGUucHJvdG9idWYuVGltZXN0YW1wIGluc3RhbmNlLlxyXG4gICAgICAgIGlmICh0eXBlb2YgZGF0ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgLy8gVE9ETyhiLzM3MjgyMjM3KTogVXNlIHN0cmluZ3MgZm9yIFByb3RvMyB0aW1lc3RhbXBzXHJcbiAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLm9wdGlvbnMudXNlUHJvdG8zSnNvbixcclxuICAgICAgICAgICAgLy8gICAnVGhlIHRpbWVzdGFtcCBzdHJpbmcgZm9ybWF0IHJlcXVpcmVzIFByb3RvMy4nKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnJvbUlzbzg2MDFTdHJpbmcoZGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhc3NlcnQoISFkYXRlLCAnQ2Fubm90IGRlc2VyaWFsaXplIG51bGwgb3IgdW5kZWZpbmVkIHRpbWVzdGFtcC4nKTtcclxuICAgICAgICAgICAgLy8gVE9ETyhiLzM3MjgyMjM3KTogVXNlIHN0cmluZ3MgZm9yIFByb3RvMyB0aW1lc3RhbXBzXHJcbiAgICAgICAgICAgIC8vIGFzc2VydCghdGhpcy5vcHRpb25zLnVzZVByb3RvM0pzb24sXHJcbiAgICAgICAgICAgIC8vICAgJ1RoZSB0aW1lc3RhbXAgaW5zdGFuY2UgZm9ybWF0IHJlcXVpcmVzIFByb3RvIEpTLicpO1xyXG4gICAgICAgICAgICB2YXIgc2Vjb25kcyA9IHBhcnNlSW50NjQoZGF0ZS5zZWNvbmRzIHx8ICcwJyk7XHJcbiAgICAgICAgICAgIHZhciBuYW5vcyA9IGRhdGUubmFub3MgfHwgMDtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaW1lc3RhbXAoc2Vjb25kcywgbmFub3MpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tSXNvODYwMVN0cmluZyA9IGZ1bmN0aW9uICh1dGMpIHtcclxuICAgICAgICAvLyBUaGUgZGF0ZSBzdHJpbmcgY2FuIGhhdmUgaGlnaGVyIHByZWNpc2lvbiAobmFub3MpIHRoYW4gdGhlIERhdGUgY2xhc3NcclxuICAgICAgICAvLyAobWlsbGlzKSwgc28gd2UgZG8gc29tZSBjdXN0b20gcGFyc2luZyBoZXJlLlxyXG4gICAgICAgIC8vIFBhcnNlIHRoZSBuYW5vcyByaWdodCBvdXQgb2YgdGhlIHN0cmluZy5cclxuICAgICAgICB2YXIgbmFub3MgPSAwO1xyXG4gICAgICAgIHZhciBmcmFjdGlvbiA9IElTT19SRUdfRVhQLmV4ZWModXRjKTtcclxuICAgICAgICBhc3NlcnQoISFmcmFjdGlvbiwgJ2ludmFsaWQgdGltZXN0YW1wOiAnICsgdXRjKTtcclxuICAgICAgICBpZiAoZnJhY3Rpb25bMV0pIHtcclxuICAgICAgICAgICAgLy8gUGFkIHRoZSBmcmFjdGlvbiBvdXQgdG8gOSBkaWdpdHMgKG5hbm9zKS5cclxuICAgICAgICAgICAgdmFyIG5hbm9TdHIgPSBmcmFjdGlvblsxXTtcclxuICAgICAgICAgICAgbmFub1N0ciA9IChuYW5vU3RyICsgJzAwMDAwMDAwMCcpLnN1YnN0cigwLCA5KTtcclxuICAgICAgICAgICAgbmFub3MgPSBOdW1iZXIobmFub1N0cik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFBhcnNlIHRoZSBkYXRlIHRvIGdldCB0aGUgc2Vjb25kcy5cclxuICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKHV0Yyk7XHJcbiAgICAgICAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKGRhdGUuZ2V0VGltZSgpIC8gMTAwMCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUaW1lc3RhbXAoc2Vjb25kcywgbmFub3MpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIHZhbHVlIGZvciBieXRlcyB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGluIGEgcHJvdG8uXHJcbiAgICAgKiBETyBOT1QgVVNFIFRISVMgRk9SIEFOWVRISU5HIEVMU0UuXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBjaGVhdHMuIEl0J3MgdHlwZWQgYXMgcmV0dXJuaW5nIFwic3RyaW5nXCIgYmVjYXVzZSB0aGF0J3Mgd2hhdFxyXG4gICAgICogb3VyIGdlbmVyYXRlZCBwcm90byBpbnRlcmZhY2VzIHNheSBieXRlcyBtdXN0IGJlLiBCdXQgaXQgc2hvdWxkIHJldHVyblxyXG4gICAgICogYW4gVWludDhBcnJheSBpbiBOb2RlLlxyXG4gICAgICovXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0J5dGVzID0gZnVuY3Rpb24gKGJ5dGVzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy51c2VQcm90bzNKc29uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBieXRlcy50b0Jhc2U2NCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVGhlIHR5cGluZ3Mgc2F5IGl0J3MgYSBzdHJpbmcsIGJ1dCBpdCBuZWVkcyB0byBiZSBhIFVpbnQ4QXJyYXkgaW4gTm9kZS5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudW5zYWZlQ2FzdFByb3RvQnl0ZVN0cmluZyhieXRlcy50b1VpbnQ4QXJyYXkoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGFyc2UgdGhlIGJsb2IgZnJvbSB0aGUgcHJvdG9zIGludG8gdGhlIGludGVybmFsIEJsb2IgY2xhc3MuIE5vdGUgdGhhdCB0aGVcclxuICAgICAqIHR5cGluZ3MgYXNzdW1lIGFsbCBibG9icyBhcmUgc3RyaW5ncywgYnV0IHRoZXkgYXJlIGFjdHVhbGx5IFVpbnQ4QXJyYXlzXHJcbiAgICAgKiBvbiBOb2RlLlxyXG4gICAgICovXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tQmxvYiA9IGZ1bmN0aW9uIChibG9iKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBibG9iID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBhc3NlcnQodGhpcy5vcHRpb25zLnVzZVByb3RvM0pzb24sICdFeHBlY3RlZCBieXRlcyB0byBiZSBwYXNzZWQgaW4gYXMgVWludDhBcnJheSwgYnV0IGdvdCBhIHN0cmluZyBpbnN0ZWFkLicpO1xyXG4gICAgICAgICAgICByZXR1cm4gQmxvYi5mcm9tQmFzZTY0U3RyaW5nKGJsb2IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYXNzZXJ0KCF0aGlzLm9wdGlvbnMudXNlUHJvdG8zSnNvbiwgJ0V4cGVjdGVkIGJ5dGVzIHRvIGJlIHBhc3NlZCBpbiBhcyBzdHJpbmcsIGJ1dCBnb3Qgc29tZXRoaW5nIGVsc2UgaW5zdGVhZC4nKTtcclxuICAgICAgICAgICAgcmV0dXJuIEJsb2IuZnJvbVVpbnQ4QXJyYXkoYmxvYik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvVmVyc2lvbiA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9UaW1lc3RhbXAodmVyc2lvbi50b1RpbWVzdGFtcCgpKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tVmVyc2lvbiA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgYXNzZXJ0KCEhdmVyc2lvbiwgXCJUcnlpbmcgdG8gZGVzZXJpYWxpemUgdmVyc2lvbiB0aGF0IGlzbid0IHNldFwiKTtcclxuICAgICAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLmZyb21UaW1lc3RhbXAodGhpcy5mcm9tVGltZXN0YW1wKHZlcnNpb24pKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1Jlc291cmNlTmFtZSA9IGZ1bmN0aW9uIChkYXRhYmFzZUlkLCBwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZnVsbHlRdWFsaWZpZWRQcmVmaXhQYXRoKGRhdGFiYXNlSWQpXHJcbiAgICAgICAgICAgIC5jaGlsZCgnZG9jdW1lbnRzJylcclxuICAgICAgICAgICAgLmNoaWxkKHBhdGgpXHJcbiAgICAgICAgICAgIC5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tUmVzb3VyY2VOYW1lID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICB2YXIgcmVzb3VyY2UgPSBSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhuYW1lKTtcclxuICAgICAgICBhc3NlcnQodGhpcy5pc1ZhbGlkUmVzb3VyY2VOYW1lKHJlc291cmNlKSwgJ1RyaWVkIHRvIGRlc2VyaWFsaXplIGludmFsaWQga2V5ICcgKyByZXNvdXJjZS50b1N0cmluZygpKTtcclxuICAgICAgICByZXR1cm4gcmVzb3VyY2U7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9OYW1lID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvUmVzb3VyY2VOYW1lKHRoaXMuZGF0YWJhc2VJZCwga2V5LnBhdGgpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21OYW1lID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICB2YXIgcmVzb3VyY2UgPSB0aGlzLmZyb21SZXNvdXJjZU5hbWUobmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0KHJlc291cmNlLmdldCgxKSA9PT0gdGhpcy5kYXRhYmFzZUlkLnByb2plY3RJZCwgJ1RyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBwcm9qZWN0OiAnICtcclxuICAgICAgICAgICAgcmVzb3VyY2UuZ2V0KDEpICtcclxuICAgICAgICAgICAgJyB2cyAnICtcclxuICAgICAgICAgICAgdGhpcy5kYXRhYmFzZUlkLnByb2plY3RJZCk7XHJcbiAgICAgICAgYXNzZXJ0KCghcmVzb3VyY2UuZ2V0KDMpICYmICF0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UpIHx8XHJcbiAgICAgICAgICAgIHJlc291cmNlLmdldCgzKSA9PT0gdGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlLCAnVHJpZWQgdG8gZGVzZXJpYWxpemUga2V5IGZyb20gZGlmZmVyZW50IGRhdGFiYXNlOiAnICtcclxuICAgICAgICAgICAgcmVzb3VyY2UuZ2V0KDMpICtcclxuICAgICAgICAgICAgJyB2cyAnICtcclxuICAgICAgICAgICAgdGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlKTtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50S2V5KHRoaXMuZXh0cmFjdExvY2FsUGF0aEZyb21SZXNvdXJjZU5hbWUocmVzb3VyY2UpKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1F1ZXJ5UGF0aCA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgaWYgKHBhdGgubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBwYXRoIGlzIGVtcHR5LCB0aGUgYmFja2VuZCByZXF1aXJlcyB3ZSBsZWF2ZSBvZmYgdGhlIC9kb2N1bWVudHNcclxuICAgICAgICAgICAgLy8gYXQgdGhlIGVuZC5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlZERhdGFiYXNlSWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnRvUmVzb3VyY2VOYW1lKHRoaXMuZGF0YWJhc2VJZCwgcGF0aCk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVF1ZXJ5UGF0aCA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgdmFyIHJlc291cmNlTmFtZSA9IHRoaXMuZnJvbVJlc291cmNlTmFtZShuYW1lKTtcclxuICAgICAgICBpZiAocmVzb3VyY2VOYW1lLmxlbmd0aCA9PT0gNCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUmVzb3VyY2VQYXRoLkVNUFRZX1BBVEg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmV4dHJhY3RMb2NhbFBhdGhGcm9tUmVzb3VyY2VOYW1lKHJlc291cmNlTmFtZSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLCBcImVuY29kZWREYXRhYmFzZUlkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBuZXcgUmVzb3VyY2VQYXRoKFtcclxuICAgICAgICAgICAgICAgICdwcm9qZWN0cycsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFiYXNlSWQucHJvamVjdElkLFxyXG4gICAgICAgICAgICAgICAgJ2RhdGFiYXNlcycsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2VcclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgICAgIHJldHVybiBwYXRoLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnVsbHlRdWFsaWZpZWRQcmVmaXhQYXRoID0gZnVuY3Rpb24gKGRhdGFiYXNlSWQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFJlc291cmNlUGF0aChbXHJcbiAgICAgICAgICAgICdwcm9qZWN0cycsXHJcbiAgICAgICAgICAgIGRhdGFiYXNlSWQucHJvamVjdElkLFxyXG4gICAgICAgICAgICAnZGF0YWJhc2VzJyxcclxuICAgICAgICAgICAgZGF0YWJhc2VJZC5kYXRhYmFzZVxyXG4gICAgICAgIF0pO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmV4dHJhY3RMb2NhbFBhdGhGcm9tUmVzb3VyY2VOYW1lID0gZnVuY3Rpb24gKHJlc291cmNlTmFtZSkge1xyXG4gICAgICAgIGFzc2VydChyZXNvdXJjZU5hbWUubGVuZ3RoID4gNCAmJiByZXNvdXJjZU5hbWUuZ2V0KDQpID09PSAnZG9jdW1lbnRzJywgJ3RyaWVkIHRvIGRlc2VyaWFsaXplIGludmFsaWQga2V5ICcgKyByZXNvdXJjZU5hbWUudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc291cmNlTmFtZS5wb3BGaXJzdCg1KTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5pc1ZhbGlkUmVzb3VyY2VOYW1lID0gZnVuY3Rpb24gKHBhdGgpIHtcclxuICAgICAgICAvLyBSZXNvdXJjZSBuYW1lcyBoYXZlIGF0IGxlYXN0IDQgY29tcG9uZW50cyAocHJvamVjdCBJRCwgZGF0YWJhc2UgSUQpXHJcbiAgICAgICAgcmV0dXJuIChwYXRoLmxlbmd0aCA+PSA0ICYmXHJcbiAgICAgICAgICAgIHBhdGguZ2V0KDApID09PSAncHJvamVjdHMnICYmXHJcbiAgICAgICAgICAgIHBhdGguZ2V0KDIpID09PSAnZGF0YWJhc2VzJyk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9WYWx1ZSA9IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgTnVsbFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IG51bGxWYWx1ZTogJ05VTExfVkFMVUUnIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEJvb2xlYW5WYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBib29sZWFuVmFsdWU6IHZhbC52YWx1ZSgpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEludGVnZXJWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBpbnRlZ2VyVmFsdWU6ICcnICsgdmFsLnZhbHVlKCkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgRG91YmxlVmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIGRvdWJsZVZhbHVlID0gdmFsLnZhbHVlKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMudXNlUHJvdG8zSnNvbikge1xyXG4gICAgICAgICAgICAgICAgLy8gUHJvdG8gMyBsZXQncyB1cyBlbmNvZGUgTmFOIGFuZCBJbmZpbml0eSBhcyBzdHJpbmcgdmFsdWVzIGFzXHJcbiAgICAgICAgICAgICAgICAvLyBleHBlY3RlZCBieSB0aGUgYmFja2VuZC4gVGhpcyBpcyBjdXJyZW50bHkgbm90IGNoZWNrZWQgYnkgb3VyIHVuaXRcclxuICAgICAgICAgICAgICAgIC8vIHRlc3RzIGJlY2F1c2UgdGhleSByZWx5IG9uIHByb3RvYnVmLmpzLlxyXG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKGRvdWJsZVZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGRvdWJsZVZhbHVlOiAnTmFOJyB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZG91YmxlVmFsdWUgPT09IEluZmluaXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgZG91YmxlVmFsdWU6ICdJbmZpbml0eScgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGRvdWJsZVZhbHVlID09PSAtSW5maW5pdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBkb3VibGVWYWx1ZTogJy1JbmZpbml0eScgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4geyBkb3VibGVWYWx1ZTogdmFsLnZhbHVlKCkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgU3RyaW5nVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgc3RyaW5nVmFsdWU6IHZhbC52YWx1ZSgpIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIE9iamVjdFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IG1hcFZhbHVlOiB0aGlzLnRvTWFwVmFsdWUodmFsKSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBBcnJheVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGFycmF5VmFsdWU6IHRoaXMudG9BcnJheVZhbHVlKHZhbCkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgVGltZXN0YW1wVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcFZhbHVlOiB0aGlzLnRvVGltZXN0YW1wKHZhbC5pbnRlcm5hbFZhbHVlKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBHZW9Qb2ludFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBnZW9Qb2ludFZhbHVlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF0aXR1ZGU6IHZhbC52YWx1ZSgpLmxhdGl0dWRlLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvbmdpdHVkZTogdmFsLnZhbHVlKCkubG9uZ2l0dWRlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEJsb2JWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgYnl0ZXNWYWx1ZTogdGhpcy50b0J5dGVzKHZhbC52YWx1ZSgpKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBSZWZWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlVmFsdWU6IHRoaXMudG9SZXNvdXJjZU5hbWUodmFsLmRhdGFiYXNlSWQsIHZhbC5rZXkucGF0aClcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIEZpZWxkVmFsdWUgJyArIEpTT04uc3RyaW5naWZ5KHZhbCkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tVmFsdWUgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XHJcbiAgICAgICAgdmFyIHR5cGUgPSBvYmpbJ3ZhbHVlX3R5cGUnXTtcclxuICAgICAgICBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ251bGxWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOdWxsVmFsdWUuSU5TVEFOQ0U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdib29sZWFuVmFsdWUnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gQm9vbGVhblZhbHVlLm9mKG9iai5ib29sZWFuVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcob2JqLCB0eXBlLCAnaW50ZWdlclZhbHVlJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnRlZ2VyVmFsdWUocGFyc2VJbnQ2NChvYmouaW50ZWdlclZhbHVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdkb3VibGVWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMudXNlUHJvdG8zSnNvbikge1xyXG4gICAgICAgICAgICAgICAgLy8gUHJvdG8gMyB1c2VzIHRoZSBzdHJpbmcgdmFsdWVzICdOYU4nIGFuZCAnSW5maW5pdHknLlxyXG4gICAgICAgICAgICAgICAgaWYgKG9iai5kb3VibGVWYWx1ZSA9PT0gJ05hTicpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gRG91YmxlVmFsdWUuTkFOO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob2JqLmRvdWJsZVZhbHVlID09PSAnSW5maW5pdHknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERvdWJsZVZhbHVlLlBPU0lUSVZFX0lORklOSVRZO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob2JqLmRvdWJsZVZhbHVlID09PSAnLUluZmluaXR5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBEb3VibGVWYWx1ZS5ORUdBVElWRV9JTkZJTklUWTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERvdWJsZVZhbHVlKG9iai5kb3VibGVWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdzdHJpbmdWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nVmFsdWUob2JqLnN0cmluZ1ZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ21hcFZhbHVlJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnJvbUZpZWxkcyhvYmoubWFwVmFsdWUuZmllbGRzIHx8IHt9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ2FycmF5VmFsdWUnKSkge1xyXG4gICAgICAgICAgICAvLyBcInZhbHVlc1wiIGlzIG5vdCBwcmVzZW50IGlmIHRoZSBhcnJheSBpcyBlbXB0eVxyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KG9iai5hcnJheVZhbHVlLCAnYXJyYXlWYWx1ZScpO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWVzJCQxID0gb2JqLmFycmF5VmFsdWUudmFsdWVzIHx8IFtdO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEFycmF5VmFsdWUodmFsdWVzJCQxLm1hcChmdW5jdGlvbiAodikgeyByZXR1cm4gX3RoaXMuZnJvbVZhbHVlKHYpOyB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICd0aW1lc3RhbXBWYWx1ZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQob2JqLnRpbWVzdGFtcFZhbHVlLCAndGltZXN0YW1wVmFsdWUnKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaW1lc3RhbXBWYWx1ZSh0aGlzLmZyb21UaW1lc3RhbXAob2JqLnRpbWVzdGFtcFZhbHVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhvYmosIHR5cGUsICdnZW9Qb2ludFZhbHVlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChvYmouZ2VvUG9pbnRWYWx1ZSwgJ2dlb1BvaW50VmFsdWUnKTtcclxuICAgICAgICAgICAgdmFyIGxhdGl0dWRlID0gb2JqLmdlb1BvaW50VmFsdWUubGF0aXR1ZGUgfHwgMDtcclxuICAgICAgICAgICAgdmFyIGxvbmdpdHVkZSA9IG9iai5nZW9Qb2ludFZhbHVlLmxvbmdpdHVkZSB8fCAwO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEdlb1BvaW50VmFsdWUobmV3IEdlb1BvaW50KGxhdGl0dWRlLCBsb25naXR1ZGUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ2J5dGVzVmFsdWUnKSkge1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KG9iai5ieXRlc1ZhbHVlLCAnYnl0ZXNWYWx1ZScpO1xyXG4gICAgICAgICAgICB2YXIgYmxvYiA9IHRoaXMuZnJvbUJsb2Iob2JqLmJ5dGVzVmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEJsb2JWYWx1ZShibG9iKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKG9iaiwgdHlwZSwgJ3JlZmVyZW5jZVZhbHVlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChvYmoucmVmZXJlbmNlVmFsdWUsICdyZWZlcmVuY2VWYWx1ZScpO1xyXG4gICAgICAgICAgICB2YXIgcmVzb3VyY2VOYW1lID0gdGhpcy5mcm9tUmVzb3VyY2VOYW1lKG9iai5yZWZlcmVuY2VWYWx1ZSk7XHJcbiAgICAgICAgICAgIHZhciBkYklkID0gbmV3IERhdGFiYXNlSWQocmVzb3VyY2VOYW1lLmdldCgxKSwgcmVzb3VyY2VOYW1lLmdldCgzKSk7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBuZXcgRG9jdW1lbnRLZXkodGhpcy5leHRyYWN0TG9jYWxQYXRoRnJvbVJlc291cmNlTmFtZShyZXNvdXJjZU5hbWUpKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWZWYWx1ZShkYklkLCBrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gVmFsdWUgcHJvdG8gJyArIEpTT04uc3RyaW5naWZ5KG9iaikpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogQ3JlYXRlcyBhbiBhcGkuRG9jdW1lbnQgZnJvbSBrZXkgYW5kIGZpZWxkcyAoYnV0IG5vIGNyZWF0ZS91cGRhdGUgdGltZSkgKi9cclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvTXV0YXRpb25Eb2N1bWVudCA9IGZ1bmN0aW9uIChrZXksIGZpZWxkcykge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMudG9OYW1lKGtleSksXHJcbiAgICAgICAgICAgIGZpZWxkczogdGhpcy50b0ZpZWxkcyhmaWVsZHMpXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0RvY3VtZW50ID0gZnVuY3Rpb24gKGRvY3VtZW50KSB7XHJcbiAgICAgICAgYXNzZXJ0KCFkb2N1bWVudC5oYXNMb2NhbE11dGF0aW9ucywgXCJDYW4ndCBzZXJpYWxpemUgZG9jdW1lbnRzIHdpdGggbXV0YXRpb25zLlwiKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLnRvTmFtZShkb2N1bWVudC5rZXkpLFxyXG4gICAgICAgICAgICBmaWVsZHM6IHRoaXMudG9GaWVsZHMoZG9jdW1lbnQuZGF0YSksXHJcbiAgICAgICAgICAgIHVwZGF0ZVRpbWU6IHRoaXMudG9UaW1lc3RhbXAoZG9jdW1lbnQudmVyc2lvbi50b1RpbWVzdGFtcCgpKVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURvY3VtZW50ID0gZnVuY3Rpb24gKGRvY3VtZW50LCBoYXNDb21taXR0ZWRNdXRhdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50KHRoaXMuZnJvbU5hbWUoZG9jdW1lbnQubmFtZSksIHRoaXMuZnJvbVZlcnNpb24oZG9jdW1lbnQudXBkYXRlVGltZSksIHRoaXMuZnJvbUZpZWxkcyhkb2N1bWVudC5maWVsZHMgfHwge30pLCB7IGhhc0NvbW1pdHRlZE11dGF0aW9uczogISFoYXNDb21taXR0ZWRNdXRhdGlvbnMgfSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9GaWVsZHMgPSBmdW5jdGlvbiAoZmllbGRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgZmllbGRzLmZvckVhY2goZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBfdGhpcy50b1ZhbHVlKHZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21GaWVsZHMgPSBmdW5jdGlvbiAob2JqZWN0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBQcm90byBtYXA8c3RyaW5nLCBWYWx1ZT4gZ2V0cyBtYXBwZWQgdG8gT2JqZWN0LCBzbyBjYXN0IGl0LlxyXG4gICAgICAgIHZhciBtYXAgPSBvYmplY3Q7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IE9iamVjdFZhbHVlLkVNUFRZO1xyXG4gICAgICAgIGZvckVhY2gobWFwLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuc2V0KG5ldyBGaWVsZFBhdGgoW2tleV0pLCBfdGhpcy5mcm9tVmFsdWUodmFsdWUpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvTWFwVmFsdWUgPSBmdW5jdGlvbiAobWFwKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZmllbGRzOiB0aGlzLnRvRmllbGRzKG1hcClcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvQXJyYXlWYWx1ZSA9IGZ1bmN0aW9uIChhcnJheSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGFycmF5LmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKF90aGlzLnRvVmFsdWUodmFsdWUpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4geyB2YWx1ZXM6IHJlc3VsdCB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21Gb3VuZCA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICBhc3NlcnQoISFkb2MuZm91bmQsICdUcmllZCB0byBkZXNlcmlhbGl6ZSBhIGZvdW5kIGRvY3VtZW50IGZyb20gYSBtaXNzaW5nIGRvY3VtZW50LicpO1xyXG4gICAgICAgIGFzc2VydFByZXNlbnQoZG9jLmZvdW5kLm5hbWUsICdkb2MuZm91bmQubmFtZScpO1xyXG4gICAgICAgIGFzc2VydFByZXNlbnQoZG9jLmZvdW5kLnVwZGF0ZVRpbWUsICdkb2MuZm91bmQudXBkYXRlVGltZScpO1xyXG4gICAgICAgIHZhciBrZXkgPSB0aGlzLmZyb21OYW1lKGRvYy5mb3VuZC5uYW1lKTtcclxuICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMuZnJvbVZlcnNpb24oZG9jLmZvdW5kLnVwZGF0ZVRpbWUpO1xyXG4gICAgICAgIHZhciBmaWVsZHMgPSB0aGlzLmZyb21GaWVsZHMoZG9jLmZvdW5kLmZpZWxkcyB8fCB7fSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudChrZXksIHZlcnNpb24sIGZpZWxkcywge30pO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21NaXNzaW5nID0gZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgIGFzc2VydCghIXJlc3VsdC5taXNzaW5nLCAnVHJpZWQgdG8gZGVzZXJpYWxpemUgYSBtaXNzaW5nIGRvY3VtZW50IGZyb20gYSBmb3VuZCBkb2N1bWVudC4nKTtcclxuICAgICAgICBhc3NlcnQoISFyZXN1bHQucmVhZFRpbWUsICdUcmllZCB0byBkZXNlcmlhbGl6ZSBhIG1pc3NpbmcgZG9jdW1lbnQgd2l0aG91dCBhIHJlYWQgdGltZS4nKTtcclxuICAgICAgICB2YXIga2V5ID0gdGhpcy5mcm9tTmFtZShyZXN1bHQubWlzc2luZyk7XHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLmZyb21WZXJzaW9uKHJlc3VsdC5yZWFkVGltZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBOb0RvY3VtZW50KGtleSwgdmVyc2lvbik7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbU1heWJlRG9jdW1lbnQgPSBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG4gICAgICAgIHZhciB0eXBlID0gcmVzdWx0WydyZXN1bHQnXTtcclxuICAgICAgICBpZiAoaGFzVGFnKHJlc3VsdCwgdHlwZSwgJ2ZvdW5kJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnJvbUZvdW5kKHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhyZXN1bHQsIHR5cGUsICdtaXNzaW5nJykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZnJvbU1pc3NpbmcocmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhaWwoJ2ludmFsaWQgYmF0Y2ggZ2V0IHJlc3BvbnNlOiAnICsgSlNPTi5zdHJpbmdpZnkocmVzdWx0KSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9XYXRjaFRhcmdldENoYW5nZVN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XHJcbiAgICAgICAgc3dpdGNoIChzdGF0ZSkge1xyXG4gICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQWRkZWQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0FERCc7XHJcbiAgICAgICAgICAgIGNhc2UgV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5DdXJyZW50OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdDVVJSRU5UJztcclxuICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLk5vQ2hhbmdlOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdOT19DSEFOR0UnO1xyXG4gICAgICAgICAgICBjYXNlIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVtb3ZlZDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAnUkVNT1ZFJztcclxuICAgICAgICAgICAgY2FzZSBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlc2V0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdSRVNFVCc7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBXYXRjaFRhcmdldENoYW5nZVN0YXRlOiAnICsgc3RhdGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1Rlc3RXYXRjaENoYW5nZSA9IGZ1bmN0aW9uICh3YXRjaENoYW5nZSkge1xyXG4gICAgICAgIGlmICh3YXRjaENoYW5nZSBpbnN0YW5jZW9mIEV4aXN0ZW5jZUZpbHRlckNoYW5nZSkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZmlsdGVyOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IHdhdGNoQ2hhbmdlLmV4aXN0ZW5jZUZpbHRlci5jb3VudCxcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogd2F0Y2hDaGFuZ2UudGFyZ2V0SWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHdhdGNoQ2hhbmdlIGluc3RhbmNlb2YgRG9jdW1lbnRXYXRjaENoYW5nZSkge1xyXG4gICAgICAgICAgICBpZiAod2F0Y2hDaGFuZ2UubmV3RG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2MgPSB3YXRjaENoYW5nZS5uZXdEb2M7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50Q2hhbmdlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLnRvTmFtZShkb2Mua2V5KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkczogdGhpcy50b0ZpZWxkcyhkb2MuZGF0YSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVUaW1lOiB0aGlzLnRvVmVyc2lvbihkb2MudmVyc2lvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWRzOiB3YXRjaENoYW5nZS51cGRhdGVkVGFyZ2V0SWRzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkVGFyZ2V0SWRzOiB3YXRjaENoYW5nZS5yZW1vdmVkVGFyZ2V0SWRzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh3YXRjaENoYW5nZS5uZXdEb2MgaW5zdGFuY2VvZiBOb0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jID0gd2F0Y2hDaGFuZ2UubmV3RG9jO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudERlbGV0ZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudDogdGhpcy50b05hbWUoZG9jLmtleSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRUaW1lOiB0aGlzLnRvVmVyc2lvbihkb2MudmVyc2lvbiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZWRUYXJnZXRJZHM6IHdhdGNoQ2hhbmdlLnJlbW92ZWRUYXJnZXRJZHNcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHdhdGNoQ2hhbmdlLm5ld0RvYyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudFJlbW92ZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudDogdGhpcy50b05hbWUod2F0Y2hDaGFuZ2Uua2V5KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZFRhcmdldElkczogd2F0Y2hDaGFuZ2UucmVtb3ZlZFRhcmdldElkc1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHdhdGNoQ2hhbmdlIGluc3RhbmNlb2YgV2F0Y2hUYXJnZXRDaGFuZ2UpIHtcclxuICAgICAgICAgICAgdmFyIGNhdXNlID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBpZiAod2F0Y2hDaGFuZ2UuY2F1c2UpIHtcclxuICAgICAgICAgICAgICAgIGNhdXNlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IG1hcFJwY0NvZGVGcm9tQ29kZSh3YXRjaENoYW5nZS5jYXVzZS5jb2RlKSxcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB3YXRjaENoYW5nZS5jYXVzZS5tZXNzYWdlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXRDaGFuZ2U6IHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRDaGFuZ2VUeXBlOiB0aGlzLnRvV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZSh3YXRjaENoYW5nZS5zdGF0ZSksXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWRzOiB3YXRjaENoYW5nZS50YXJnZXRJZHMsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdW1lVG9rZW46IHRoaXMudW5zYWZlQ2FzdFByb3RvQnl0ZVN0cmluZyh3YXRjaENoYW5nZS5yZXN1bWVUb2tlbiksXHJcbiAgICAgICAgICAgICAgICAgICAgY2F1c2U6IGNhdXNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWlsKCdVbnJlY29nbml6ZWQgd2F0Y2ggY2hhbmdlOiAnICsgSlNPTi5zdHJpbmdpZnkod2F0Y2hDaGFuZ2UpKTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tV2F0Y2hDaGFuZ2UgPSBmdW5jdGlvbiAoY2hhbmdlKSB7XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG4gICAgICAgIHZhciB0eXBlID0gY2hhbmdlWydyZXNwb25zZV90eXBlJ107XHJcbiAgICAgICAgdmFyIHdhdGNoQ2hhbmdlO1xyXG4gICAgICAgIGlmIChoYXNUYWcoY2hhbmdlLCB0eXBlLCAndGFyZ2V0Q2hhbmdlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UudGFyZ2V0Q2hhbmdlLCAndGFyZ2V0Q2hhbmdlJyk7XHJcbiAgICAgICAgICAgIC8vIHByb3RvMyBkZWZhdWx0IHZhbHVlIGlzIHVuc2V0IGluIEpTT04gKHVuZGVmaW5lZCksIHNvIHVzZSAnTk9fQ0hBTkdFJ1xyXG4gICAgICAgICAgICAvLyBpZiB1bnNldFxyXG4gICAgICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLmZyb21XYXRjaFRhcmdldENoYW5nZVN0YXRlKGNoYW5nZS50YXJnZXRDaGFuZ2UudGFyZ2V0Q2hhbmdlVHlwZSB8fCAnTk9fQ0hBTkdFJyk7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRJZHMgPSBjaGFuZ2UudGFyZ2V0Q2hhbmdlLnRhcmdldElkcyB8fCBbXTtcclxuICAgICAgICAgICAgdmFyIHJlc3VtZVRva2VuID0gY2hhbmdlLnRhcmdldENoYW5nZS5yZXN1bWVUb2tlbiB8fCB0aGlzLmVtcHR5Qnl0ZVN0cmluZygpO1xyXG4gICAgICAgICAgICB2YXIgY2F1c2VQcm90byA9IGNoYW5nZS50YXJnZXRDaGFuZ2UuY2F1c2U7XHJcbiAgICAgICAgICAgIHZhciBjYXVzZSA9IGNhdXNlUHJvdG8gJiYgdGhpcy5mcm9tUnBjU3RhdHVzKGNhdXNlUHJvdG8pO1xyXG4gICAgICAgICAgICB3YXRjaENoYW5nZSA9IG5ldyBXYXRjaFRhcmdldENoYW5nZShzdGF0ZSwgdGFyZ2V0SWRzLCByZXN1bWVUb2tlbiwgY2F1c2UgfHwgbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhjaGFuZ2UsIHR5cGUsICdkb2N1bWVudENoYW5nZScpKSB7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmRvY3VtZW50Q2hhbmdlLCAnZG9jdW1lbnRDaGFuZ2UnKTtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZG9jdW1lbnRDaGFuZ2UuZG9jdW1lbnQsICdkb2N1bWVudENoYW5nZS5uYW1lJyk7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmRvY3VtZW50Q2hhbmdlLmRvY3VtZW50Lm5hbWUsICdkb2N1bWVudENoYW5nZS5kb2N1bWVudC5uYW1lJyk7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmRvY3VtZW50Q2hhbmdlLmRvY3VtZW50LnVwZGF0ZVRpbWUsICdkb2N1bWVudENoYW5nZS5kb2N1bWVudC51cGRhdGVUaW1lJyk7XHJcbiAgICAgICAgICAgIHZhciBlbnRpdHlDaGFuZ2UgPSBjaGFuZ2UuZG9jdW1lbnRDaGFuZ2U7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmZyb21OYW1lKGVudGl0eUNoYW5nZS5kb2N1bWVudC5uYW1lKTtcclxuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLmZyb21WZXJzaW9uKGVudGl0eUNoYW5nZS5kb2N1bWVudC51cGRhdGVUaW1lKTtcclxuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IHRoaXMuZnJvbUZpZWxkcyhlbnRpdHlDaGFuZ2UuZG9jdW1lbnQuZmllbGRzIHx8IHt9KTtcclxuICAgICAgICAgICAgdmFyIGRvYyA9IG5ldyBEb2N1bWVudChrZXksIHZlcnNpb24sIGZpZWxkcywge30pO1xyXG4gICAgICAgICAgICB2YXIgdXBkYXRlZFRhcmdldElkcyA9IGVudGl0eUNoYW5nZS50YXJnZXRJZHMgfHwgW107XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVkVGFyZ2V0SWRzID0gZW50aXR5Q2hhbmdlLnJlbW92ZWRUYXJnZXRJZHMgfHwgW107XHJcbiAgICAgICAgICAgIHdhdGNoQ2hhbmdlID0gbmV3IERvY3VtZW50V2F0Y2hDaGFuZ2UodXBkYXRlZFRhcmdldElkcywgcmVtb3ZlZFRhcmdldElkcywgZG9jLmtleSwgZG9jKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKGNoYW5nZSwgdHlwZSwgJ2RvY3VtZW50RGVsZXRlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZG9jdW1lbnREZWxldGUsICdkb2N1bWVudERlbGV0ZScpO1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5kb2N1bWVudERlbGV0ZS5kb2N1bWVudCwgJ2RvY3VtZW50RGVsZXRlLmRvY3VtZW50Jyk7XHJcbiAgICAgICAgICAgIHZhciBkb2NEZWxldGUgPSBjaGFuZ2UuZG9jdW1lbnREZWxldGU7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmZyb21OYW1lKGRvY0RlbGV0ZS5kb2N1bWVudCk7XHJcbiAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gZG9jRGVsZXRlLnJlYWRUaW1lXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMuZnJvbVZlcnNpb24oZG9jRGVsZXRlLnJlYWRUaW1lKVxyXG4gICAgICAgICAgICAgICAgOiBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpO1xyXG4gICAgICAgICAgICB2YXIgZG9jID0gbmV3IE5vRG9jdW1lbnQoa2V5LCB2ZXJzaW9uKTtcclxuICAgICAgICAgICAgdmFyIHJlbW92ZWRUYXJnZXRJZHMgPSBkb2NEZWxldGUucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcclxuICAgICAgICAgICAgd2F0Y2hDaGFuZ2UgPSBuZXcgRG9jdW1lbnRXYXRjaENoYW5nZShbXSwgcmVtb3ZlZFRhcmdldElkcywgZG9jLmtleSwgZG9jKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoaGFzVGFnKGNoYW5nZSwgdHlwZSwgJ2RvY3VtZW50UmVtb3ZlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZG9jdW1lbnRSZW1vdmUsICdkb2N1bWVudFJlbW92ZScpO1xyXG4gICAgICAgICAgICBhc3NlcnRQcmVzZW50KGNoYW5nZS5kb2N1bWVudFJlbW92ZS5kb2N1bWVudCwgJ2RvY3VtZW50UmVtb3ZlJyk7XHJcbiAgICAgICAgICAgIHZhciBkb2NSZW1vdmUgPSBjaGFuZ2UuZG9jdW1lbnRSZW1vdmU7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmZyb21OYW1lKGRvY1JlbW92ZS5kb2N1bWVudCk7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVkVGFyZ2V0SWRzID0gZG9jUmVtb3ZlLnJlbW92ZWRUYXJnZXRJZHMgfHwgW107XHJcbiAgICAgICAgICAgIHdhdGNoQ2hhbmdlID0gbmV3IERvY3VtZW50V2F0Y2hDaGFuZ2UoW10sIHJlbW92ZWRUYXJnZXRJZHMsIGtleSwgbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhjaGFuZ2UsIHR5cGUsICdmaWx0ZXInKSkge1xyXG4gICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IGltcGxlbWVudCBleGlzdGVuY2UgZmlsdGVyIHBhcnNpbmcgd2l0aCBzdHJhdGVneS5cclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChjaGFuZ2UuZmlsdGVyLCAnZmlsdGVyJyk7XHJcbiAgICAgICAgICAgIGFzc2VydFByZXNlbnQoY2hhbmdlLmZpbHRlci50YXJnZXRJZCwgJ2ZpbHRlci50YXJnZXRJZCcpO1xyXG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gY2hhbmdlLmZpbHRlcjtcclxuICAgICAgICAgICAgdmFyIGNvdW50ID0gZmlsdGVyLmNvdW50IHx8IDA7XHJcbiAgICAgICAgICAgIHZhciBleGlzdGVuY2VGaWx0ZXIgPSBuZXcgRXhpc3RlbmNlRmlsdGVyKGNvdW50KTtcclxuICAgICAgICAgICAgdmFyIHRhcmdldElkID0gZmlsdGVyLnRhcmdldElkO1xyXG4gICAgICAgICAgICB3YXRjaENoYW5nZSA9IG5ldyBFeGlzdGVuY2VGaWx0ZXJDaGFuZ2UodGFyZ2V0SWQsIGV4aXN0ZW5jZUZpbHRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biBjaGFuZ2UgdHlwZSAnICsgSlNPTi5zdHJpbmdpZnkoY2hhbmdlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB3YXRjaENoYW5nZTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSkge1xyXG4gICAgICAgIGlmIChzdGF0ZSA9PT0gJ05PX0NIQU5HRScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuTm9DaGFuZ2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHN0YXRlID09PSAnQUREJykge1xyXG4gICAgICAgICAgICByZXR1cm4gV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5BZGRlZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhdGUgPT09ICdSRU1PVkUnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlbW92ZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHN0YXRlID09PSAnQ1VSUkVOVCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQ3VycmVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc3RhdGUgPT09ICdSRVNFVCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVzZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnR290IHVuZXhwZWN0ZWQgVGFyZ2V0Q2hhbmdlLnN0YXRlOiAnICsgc3RhdGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS52ZXJzaW9uRnJvbUxpc3RlblJlc3BvbnNlID0gZnVuY3Rpb24gKGNoYW5nZSkge1xyXG4gICAgICAgIC8vIFdlIGhhdmUgb25seSByZWFjaGVkIGEgY29uc2lzdGVudCBzbmFwc2hvdCBmb3IgdGhlIGVudGlyZSBzdHJlYW0gaWYgdGhlcmVcclxuICAgICAgICAvLyBpcyBhIHJlYWRfdGltZSBzZXQgYW5kIGl0IGFwcGxpZXMgdG8gYWxsIHRhcmdldHMgKGkuZS4gdGhlIGxpc3Qgb2ZcclxuICAgICAgICAvLyB0YXJnZXRzIGlzIGVtcHR5KS4gVGhlIGJhY2tlbmQgaXMgZ3VhcmFudGVlZCB0byBzZW5kIHN1Y2ggcmVzcG9uc2VzLlxyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcclxuICAgICAgICB2YXIgdHlwZSA9IGNoYW5nZVsncmVzcG9uc2VfdHlwZSddO1xyXG4gICAgICAgIGlmICghaGFzVGFnKGNoYW5nZSwgdHlwZSwgJ3RhcmdldENoYW5nZScpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTbmFwc2hvdFZlcnNpb24uTUlOO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdGFyZ2V0Q2hhbmdlID0gY2hhbmdlLnRhcmdldENoYW5nZTtcclxuICAgICAgICBpZiAodGFyZ2V0Q2hhbmdlLnRhcmdldElkcyAmJiB0YXJnZXRDaGFuZ2UudGFyZ2V0SWRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLk1JTjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0YXJnZXRDaGFuZ2UucmVhZFRpbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5NSU47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmZyb21WZXJzaW9uKHRhcmdldENoYW5nZS5yZWFkVGltZSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9NdXRhdGlvbiA9IGZ1bmN0aW9uIChtdXRhdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlc3VsdDtcclxuICAgICAgICBpZiAobXV0YXRpb24gaW5zdGFuY2VvZiBTZXRNdXRhdGlvbikge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGU6IHRoaXMudG9NdXRhdGlvbkRvY3VtZW50KG11dGF0aW9uLmtleSwgbXV0YXRpb24udmFsdWUpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG11dGF0aW9uIGluc3RhbmNlb2YgRGVsZXRlTXV0YXRpb24pIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0geyBkZWxldGU6IHRoaXMudG9OYW1lKG11dGF0aW9uLmtleSkgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobXV0YXRpb24gaW5zdGFuY2VvZiBQYXRjaE11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZTogdGhpcy50b011dGF0aW9uRG9jdW1lbnQobXV0YXRpb24ua2V5LCBtdXRhdGlvbi5kYXRhKSxcclxuICAgICAgICAgICAgICAgIHVwZGF0ZU1hc2s6IHRoaXMudG9Eb2N1bWVudE1hc2sobXV0YXRpb24uZmllbGRNYXNrKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtdXRhdGlvbiBpbnN0YW5jZW9mIFRyYW5zZm9ybU11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50OiB0aGlzLnRvTmFtZShtdXRhdGlvbi5rZXkpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkVHJhbnNmb3JtczogbXV0YXRpb24uZmllbGRUcmFuc2Zvcm1zLm1hcChmdW5jdGlvbiAodHJhbnNmb3JtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy50b0ZpZWxkVHJhbnNmb3JtKHRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIG11dGF0aW9uIHR5cGUgJyArIG11dGF0aW9uLnR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIW11dGF0aW9uLnByZWNvbmRpdGlvbi5pc05vbmUpIHtcclxuICAgICAgICAgICAgcmVzdWx0LmN1cnJlbnREb2N1bWVudCA9IHRoaXMudG9QcmVjb25kaXRpb24obXV0YXRpb24ucHJlY29uZGl0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tTXV0YXRpb24gPSBmdW5jdGlvbiAocHJvdG8pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBwcmVjb25kaXRpb24gPSBwcm90by5jdXJyZW50RG9jdW1lbnRcclxuICAgICAgICAgICAgPyB0aGlzLmZyb21QcmVjb25kaXRpb24ocHJvdG8uY3VycmVudERvY3VtZW50KVxyXG4gICAgICAgICAgICA6IFByZWNvbmRpdGlvbi5OT05FO1xyXG4gICAgICAgIGlmIChwcm90by51cGRhdGUpIHtcclxuICAgICAgICAgICAgYXNzZXJ0UHJlc2VudChwcm90by51cGRhdGUubmFtZSwgJ25hbWUnKTtcclxuICAgICAgICAgICAgdmFyIGtleSA9IHRoaXMuZnJvbU5hbWUocHJvdG8udXBkYXRlLm5hbWUpO1xyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmZyb21GaWVsZHMocHJvdG8udXBkYXRlLmZpZWxkcyB8fCB7fSk7XHJcbiAgICAgICAgICAgIGlmIChwcm90by51cGRhdGVNYXNrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZmllbGRNYXNrID0gdGhpcy5mcm9tRG9jdW1lbnRNYXNrKHByb3RvLnVwZGF0ZU1hc2spO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQYXRjaE11dGF0aW9uKGtleSwgdmFsdWUsIGZpZWxkTWFzaywgcHJlY29uZGl0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2V0TXV0YXRpb24oa2V5LCB2YWx1ZSwgcHJlY29uZGl0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwcm90by5kZWxldGUpIHtcclxuICAgICAgICAgICAgdmFyIGtleSA9IHRoaXMuZnJvbU5hbWUocHJvdG8uZGVsZXRlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEZWxldGVNdXRhdGlvbihrZXksIHByZWNvbmRpdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHByb3RvLnRyYW5zZm9ybSkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5mcm9tTmFtZShwcm90by50cmFuc2Zvcm0uZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICB2YXIgZmllbGRUcmFuc2Zvcm1zID0gcHJvdG8udHJhbnNmb3JtLmZpZWxkVHJhbnNmb3Jtcy5tYXAoZnVuY3Rpb24gKHRyYW5zZm9ybSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmZyb21GaWVsZFRyYW5zZm9ybSh0cmFuc2Zvcm0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYXNzZXJ0KHByZWNvbmRpdGlvbi5leGlzdHMgPT09IHRydWUsICdUcmFuc2Zvcm1zIG9ubHkgc3VwcG9ydCBwcmVjb25kaXRpb24gXCJleGlzdHMgPT0gdHJ1ZVwiJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVHJhbnNmb3JtTXV0YXRpb24oa2V5LCBmaWVsZFRyYW5zZm9ybXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ3Vua25vd24gbXV0YXRpb24gcHJvdG86ICcgKyBKU09OLnN0cmluZ2lmeShwcm90bykpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1ByZWNvbmRpdGlvbiA9IGZ1bmN0aW9uIChwcmVjb25kaXRpb24pIHtcclxuICAgICAgICBhc3NlcnQoIXByZWNvbmRpdGlvbi5pc05vbmUsIFwiQ2FuJ3Qgc2VyaWFsaXplIGFuIGVtcHR5IHByZWNvbmRpdGlvblwiKTtcclxuICAgICAgICBpZiAocHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVGltZTogdGhpcy50b1ZlcnNpb24ocHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHByZWNvbmRpdGlvbi5leGlzdHMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4geyBleGlzdHM6IHByZWNvbmRpdGlvbi5leGlzdHMgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIHByZWNvbmRpdGlvbicpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tUHJlY29uZGl0aW9uID0gZnVuY3Rpb24gKHByZWNvbmRpdGlvbikge1xyXG4gICAgICAgIGlmIChwcmVjb25kaXRpb24udXBkYXRlVGltZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcmVjb25kaXRpb24udXBkYXRlVGltZSh0aGlzLmZyb21WZXJzaW9uKHByZWNvbmRpdGlvbi51cGRhdGVUaW1lKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHByZWNvbmRpdGlvbi5leGlzdHMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJlY29uZGl0aW9uLmV4aXN0cyhwcmVjb25kaXRpb24uZXhpc3RzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcmVjb25kaXRpb24uTk9ORTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVdyaXRlUmVzdWx0ID0gZnVuY3Rpb24gKHByb3RvLCBjb21taXRUaW1lKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBOT1RFOiBEZWxldGVzIGRvbid0IGhhdmUgYW4gdXBkYXRlVGltZS5cclxuICAgICAgICB2YXIgdmVyc2lvbiA9IHByb3RvLnVwZGF0ZVRpbWVcclxuICAgICAgICAgICAgPyB0aGlzLmZyb21WZXJzaW9uKHByb3RvLnVwZGF0ZVRpbWUpXHJcbiAgICAgICAgICAgIDogdGhpcy5mcm9tVmVyc2lvbihjb21taXRUaW1lKTtcclxuICAgICAgICB2YXIgdHJhbnNmb3JtUmVzdWx0cyA9IG51bGw7XHJcbiAgICAgICAgaWYgKHByb3RvLnRyYW5zZm9ybVJlc3VsdHMgJiYgcHJvdG8udHJhbnNmb3JtUmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybVJlc3VsdHMgPSBwcm90by50cmFuc2Zvcm1SZXN1bHRzLm1hcChmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZnJvbVZhbHVlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IE11dGF0aW9uUmVzdWx0KHZlcnNpb24sIHRyYW5zZm9ybVJlc3VsdHMpO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21Xcml0ZVJlc3VsdHMgPSBmdW5jdGlvbiAocHJvdG9zLCBjb21taXRUaW1lKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAocHJvdG9zICYmIHByb3Rvcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChjb21taXRUaW1lICE9PSB1bmRlZmluZWQsICdSZWNlaXZlZCBhIHdyaXRlIHJlc3VsdCB3aXRob3V0IGEgY29tbWl0IHRpbWUnKTtcclxuICAgICAgICAgICAgcmV0dXJuIHByb3Rvcy5tYXAoZnVuY3Rpb24gKHByb3RvKSB7IHJldHVybiBfdGhpcy5mcm9tV3JpdGVSZXN1bHQocHJvdG8sIGNvbW1pdFRpbWUpOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9GaWVsZFRyYW5zZm9ybSA9IGZ1bmN0aW9uIChmaWVsZFRyYW5zZm9ybSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRyYW5zZm9ybSA9IGZpZWxkVHJhbnNmb3JtLnRyYW5zZm9ybTtcclxuICAgICAgICBpZiAodHJhbnNmb3JtIGluc3RhbmNlb2YgU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBmaWVsZFBhdGg6IGZpZWxkVHJhbnNmb3JtLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpLFxyXG4gICAgICAgICAgICAgICAgc2V0VG9TZXJ2ZXJWYWx1ZTogJ1JFUVVFU1RfVElNRSdcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHJhbnNmb3JtIGluc3RhbmNlb2YgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZmllbGRQYXRoOiBmaWVsZFRyYW5zZm9ybS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcclxuICAgICAgICAgICAgICAgIGFwcGVuZE1pc3NpbmdFbGVtZW50czoge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlczogdHJhbnNmb3JtLmVsZW1lbnRzLm1hcChmdW5jdGlvbiAodikgeyByZXR1cm4gX3RoaXMudG9WYWx1ZSh2KTsgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHJhbnNmb3JtIGluc3RhbmNlb2YgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkUGF0aDogZmllbGRUcmFuc2Zvcm0uZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICByZW1vdmVBbGxGcm9tQXJyYXk6IHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IHRyYW5zZm9ybS5lbGVtZW50cy5tYXAoZnVuY3Rpb24gKHYpIHsgcmV0dXJuIF90aGlzLnRvVmFsdWUodik7IH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBmYWlsKCdVbmtub3duIHRyYW5zZm9ybTogJyArIGZpZWxkVHJhbnNmb3JtLnRyYW5zZm9ybSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21GaWVsZFRyYW5zZm9ybSA9IGZ1bmN0aW9uIChwcm90bykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBXZSBuZWVkIHRvIG1hdGNoIGdlbmVyYXRlZCBQcm90byB0eXBlcy5cclxuICAgICAgICB2YXIgdHlwZSA9IHByb3RvWyd0cmFuc2Zvcm1fdHlwZSddO1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm0gPSBudWxsO1xyXG4gICAgICAgIGlmIChoYXNUYWcocHJvdG8sIHR5cGUsICdzZXRUb1NlcnZlclZhbHVlJykpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHByb3RvLnNldFRvU2VydmVyVmFsdWUgPT09ICdSRVFVRVNUX1RJTUUnLCAnVW5rbm93biBzZXJ2ZXIgdmFsdWUgdHJhbnNmb3JtIHByb3RvOiAnICsgSlNPTi5zdHJpbmdpZnkocHJvdG8pKTtcclxuICAgICAgICAgICAgdHJhbnNmb3JtID0gU2VydmVyVGltZXN0YW1wVHJhbnNmb3JtLmluc3RhbmNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChoYXNUYWcocHJvdG8sIHR5cGUsICdhcHBlbmRNaXNzaW5nRWxlbWVudHMnKSkge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWVzJCQxID0gcHJvdG8uYXBwZW5kTWlzc2luZ0VsZW1lbnRzLnZhbHVlcyB8fCBbXTtcclxuICAgICAgICAgICAgdHJhbnNmb3JtID0gbmV3IEFycmF5VW5pb25UcmFuc2Zvcm1PcGVyYXRpb24odmFsdWVzJCQxLm1hcChmdW5jdGlvbiAodikgeyByZXR1cm4gX3RoaXMuZnJvbVZhbHVlKHYpOyB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGhhc1RhZyhwcm90bywgdHlwZSwgJ3JlbW92ZUFsbEZyb21BcnJheScpKSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZXMkJDEgPSBwcm90by5yZW1vdmVBbGxGcm9tQXJyYXkudmFsdWVzIHx8IFtdO1xyXG4gICAgICAgICAgICB0cmFuc2Zvcm0gPSBuZXcgQXJyYXlSZW1vdmVUcmFuc2Zvcm1PcGVyYXRpb24odmFsdWVzJCQxLm1hcChmdW5jdGlvbiAodikgeyByZXR1cm4gX3RoaXMuZnJvbVZhbHVlKHYpOyB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmYWlsKCdVbmtub3duIHRyYW5zZm9ybSBwcm90bzogJyArIEpTT04uc3RyaW5naWZ5KHByb3RvKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBmaWVsZFBhdGggPSBGaWVsZFBhdGguZnJvbVNlcnZlckZvcm1hdChwcm90by5maWVsZFBhdGgpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRmllbGRUcmFuc2Zvcm0oZmllbGRQYXRoLCB0cmFuc2Zvcm0pO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvRG9jdW1lbnRzVGFyZ2V0ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgZG9jdW1lbnRzOiBbdGhpcy50b1F1ZXJ5UGF0aChxdWVyeS5wYXRoKV0gfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRG9jdW1lbnRzVGFyZ2V0ID0gZnVuY3Rpb24gKGRvY3VtZW50c1RhcmdldCkge1xyXG4gICAgICAgIHZhciBjb3VudCA9IGRvY3VtZW50c1RhcmdldC5kb2N1bWVudHMubGVuZ3RoO1xyXG4gICAgICAgIGFzc2VydChjb3VudCA9PT0gMSwgJ0RvY3VtZW50c1RhcmdldCBjb250YWluZWQgb3RoZXIgdGhhbiAxIGRvY3VtZW50OiAnICsgY291bnQpO1xyXG4gICAgICAgIHZhciBuYW1lID0gZG9jdW1lbnRzVGFyZ2V0LmRvY3VtZW50c1swXTtcclxuICAgICAgICByZXR1cm4gUXVlcnkuYXRQYXRoKHRoaXMuZnJvbVF1ZXJ5UGF0aChuYW1lKSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9RdWVyeVRhcmdldCA9IGZ1bmN0aW9uIChxdWVyeSkge1xyXG4gICAgICAgIC8vIERpc3NlY3QgdGhlIHBhdGggaW50byBwYXJlbnQsIGNvbGxlY3Rpb25JZCwgYW5kIG9wdGlvbmFsIGtleSBmaWx0ZXIuXHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHsgc3RydWN0dXJlZFF1ZXJ5OiB7fSB9O1xyXG4gICAgICAgIGlmIChxdWVyeS5wYXRoLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICByZXN1bHQucGFyZW50ID0gdGhpcy50b1F1ZXJ5UGF0aChSZXNvdXJjZVBhdGguRU1QVFlfUEFUSCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IHF1ZXJ5LnBhdGg7XHJcbiAgICAgICAgICAgIGFzc2VydChwYXRoLmxlbmd0aCAlIDIgIT09IDAsICdEb2N1bWVudCBxdWVyaWVzIHdpdGggZmlsdGVycyBhcmUgbm90IHN1cHBvcnRlZC4nKTtcclxuICAgICAgICAgICAgcmVzdWx0LnBhcmVudCA9IHRoaXMudG9RdWVyeVBhdGgocGF0aC5wb3BMYXN0KCkpO1xyXG4gICAgICAgICAgICByZXN1bHQuc3RydWN0dXJlZFF1ZXJ5LmZyb20gPSBbeyBjb2xsZWN0aW9uSWQ6IHBhdGgubGFzdFNlZ21lbnQoKSB9XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHdoZXJlID0gdGhpcy50b0ZpbHRlcihxdWVyeS5maWx0ZXJzKTtcclxuICAgICAgICBpZiAod2hlcmUpIHtcclxuICAgICAgICAgICAgcmVzdWx0LnN0cnVjdHVyZWRRdWVyeS53aGVyZSA9IHdoZXJlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgb3JkZXJCeSA9IHRoaXMudG9PcmRlcihxdWVyeS5vcmRlckJ5KTtcclxuICAgICAgICBpZiAob3JkZXJCeSkge1xyXG4gICAgICAgICAgICByZXN1bHQuc3RydWN0dXJlZFF1ZXJ5Lm9yZGVyQnkgPSBvcmRlckJ5O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbGltaXQgPSB0aGlzLnRvSW50MzJWYWx1ZShxdWVyeS5saW1pdCk7XHJcbiAgICAgICAgaWYgKGxpbWl0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmVzdWx0LnN0cnVjdHVyZWRRdWVyeS5saW1pdCA9IGxpbWl0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocXVlcnkuc3RhcnRBdCkge1xyXG4gICAgICAgICAgICByZXN1bHQuc3RydWN0dXJlZFF1ZXJ5LnN0YXJ0QXQgPSB0aGlzLnRvQ3Vyc29yKHF1ZXJ5LnN0YXJ0QXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocXVlcnkuZW5kQXQpIHtcclxuICAgICAgICAgICAgcmVzdWx0LnN0cnVjdHVyZWRRdWVyeS5lbmRBdCA9IHRoaXMudG9DdXJzb3IocXVlcnkuZW5kQXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21RdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICB2YXIgcGF0aCA9IHRoaXMuZnJvbVF1ZXJ5UGF0aCh0YXJnZXQucGFyZW50KTtcclxuICAgICAgICB2YXIgcXVlcnkgPSB0YXJnZXQuc3RydWN0dXJlZFF1ZXJ5O1xyXG4gICAgICAgIHZhciBmcm9tQ291bnQgPSBxdWVyeS5mcm9tID8gcXVlcnkuZnJvbS5sZW5ndGggOiAwO1xyXG4gICAgICAgIGlmIChmcm9tQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChmcm9tQ291bnQgPT09IDEsICdTdHJ1Y3R1cmVkUXVlcnkuZnJvbSB3aXRoIG1vcmUgdGhhbiBvbmUgY29sbGVjdGlvbiBpcyBub3Qgc3VwcG9ydGVkLicpO1xyXG4gICAgICAgICAgICB2YXIgZnJvbSA9IHF1ZXJ5LmZyb21bMF07XHJcbiAgICAgICAgICAgIHBhdGggPSBwYXRoLmNoaWxkKGZyb20uY29sbGVjdGlvbklkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGZpbHRlckJ5ID0gW107XHJcbiAgICAgICAgaWYgKHF1ZXJ5LndoZXJlKSB7XHJcbiAgICAgICAgICAgIGZpbHRlckJ5ID0gdGhpcy5mcm9tRmlsdGVyKHF1ZXJ5LndoZXJlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG9yZGVyQnkgPSBbXTtcclxuICAgICAgICBpZiAocXVlcnkub3JkZXJCeSkge1xyXG4gICAgICAgICAgICBvcmRlckJ5ID0gdGhpcy5mcm9tT3JkZXIocXVlcnkub3JkZXJCeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsaW1pdCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHF1ZXJ5LmxpbWl0KSB7XHJcbiAgICAgICAgICAgIGxpbWl0ID0gdGhpcy5mcm9tSW50MzJWYWx1ZShxdWVyeS5saW1pdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzdGFydEF0ID0gbnVsbDtcclxuICAgICAgICBpZiAocXVlcnkuc3RhcnRBdCkge1xyXG4gICAgICAgICAgICBzdGFydEF0ID0gdGhpcy5mcm9tQ3Vyc29yKHF1ZXJ5LnN0YXJ0QXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZW5kQXQgPSBudWxsO1xyXG4gICAgICAgIGlmIChxdWVyeS5lbmRBdCkge1xyXG4gICAgICAgICAgICBlbmRBdCA9IHRoaXMuZnJvbUN1cnNvcihxdWVyeS5lbmRBdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkocGF0aCwgb3JkZXJCeSwgZmlsdGVyQnksIGxpbWl0LCBzdGFydEF0LCBlbmRBdCk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9MaXN0ZW5SZXF1ZXN0TGFiZWxzID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMudG9MYWJlbChxdWVyeURhdGEucHVycG9zZSk7XHJcbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgJ2dvb2ctbGlzdGVuLXRhZ3MnOiB2YWx1ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0xhYmVsID0gZnVuY3Rpb24gKHB1cnBvc2UpIHtcclxuICAgICAgICBzd2l0Y2ggKHB1cnBvc2UpIHtcclxuICAgICAgICAgICAgY2FzZSBRdWVyeVB1cnBvc2UuTGlzdGVuOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIGNhc2UgUXVlcnlQdXJwb3NlLkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdleGlzdGVuY2UtZmlsdGVyLW1pc21hdGNoJztcclxuICAgICAgICAgICAgY2FzZSBRdWVyeVB1cnBvc2UuTGltYm9SZXNvbHV0aW9uOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdsaW1iby1kb2N1bWVudCc7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5yZWNvZ25pemVkIHF1ZXJ5IHB1cnBvc2U6ICcgKyBwdXJwb3NlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9UYXJnZXQgPSBmdW5jdGlvbiAocXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdDtcclxuICAgICAgICB2YXIgcXVlcnkgPSBxdWVyeURhdGEucXVlcnk7XHJcbiAgICAgICAgaWYgKHF1ZXJ5LmlzRG9jdW1lbnRRdWVyeSgpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHsgZG9jdW1lbnRzOiB0aGlzLnRvRG9jdW1lbnRzVGFyZ2V0KHF1ZXJ5KSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0geyBxdWVyeTogdGhpcy50b1F1ZXJ5VGFyZ2V0KHF1ZXJ5KSB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXN1bHQudGFyZ2V0SWQgPSBxdWVyeURhdGEudGFyZ2V0SWQ7XHJcbiAgICAgICAgaWYgKHF1ZXJ5RGF0YS5yZXN1bWVUb2tlbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5yZXN1bWVUb2tlbiA9IHRoaXMudW5zYWZlQ2FzdFByb3RvQnl0ZVN0cmluZyhxdWVyeURhdGEucmVzdW1lVG9rZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvRmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChmaWx0ZXJzLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHZhciBwcm90b3MgPSBmaWx0ZXJzLm1hcChmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXIgaW5zdGFuY2VvZiBSZWxhdGlvbkZpbHRlclxyXG4gICAgICAgICAgICAgICAgPyBfdGhpcy50b1JlbGF0aW9uRmlsdGVyKGZpbHRlcilcclxuICAgICAgICAgICAgICAgIDogX3RoaXMudG9VbmFyeUZpbHRlcihmaWx0ZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChwcm90b3MubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcm90b3NbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IGNvbXBvc2l0ZUZpbHRlcjogeyBvcDogJ0FORCcsIGZpbHRlcnM6IHByb3RvcyB9IH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICghZmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZmlsdGVyLnVuYXJ5RmlsdGVyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLmZyb21VbmFyeUZpbHRlcihmaWx0ZXIpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZmlsdGVyLmZpZWxkRmlsdGVyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFt0aGlzLmZyb21SZWxhdGlvbkZpbHRlcihmaWx0ZXIpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZmlsdGVyLmNvbXBvc2l0ZUZpbHRlciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXIuY29tcG9zaXRlRmlsdGVyXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVycy5tYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIF90aGlzLmZyb21GaWx0ZXIoZik7IH0pXHJcbiAgICAgICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChhY2N1bSwgY3VycmVudCkgeyByZXR1cm4gYWNjdW0uY29uY2F0KGN1cnJlbnQpOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmtub3duIGZpbHRlcjogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b09yZGVyID0gZnVuY3Rpb24gKG9yZGVyQnlzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAob3JkZXJCeXMubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgcmV0dXJuIG9yZGVyQnlzLm1hcChmdW5jdGlvbiAob3JkZXIpIHsgcmV0dXJuIF90aGlzLnRvUHJvcGVydHlPcmRlcihvcmRlcik7IH0pO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21PcmRlciA9IGZ1bmN0aW9uIChvcmRlckJ5cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG9yZGVyQnlzLm1hcChmdW5jdGlvbiAob3JkZXIpIHsgcmV0dXJuIF90aGlzLmZyb21Qcm9wZXJ0eU9yZGVyKG9yZGVyKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9DdXJzb3IgPSBmdW5jdGlvbiAoY3Vyc29yKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBiZWZvcmU6IGN1cnNvci5iZWZvcmUsXHJcbiAgICAgICAgICAgIHZhbHVlczogY3Vyc29yLnBvc2l0aW9uLm1hcChmdW5jdGlvbiAoY29tcG9uZW50KSB7IHJldHVybiBfdGhpcy50b1ZhbHVlKGNvbXBvbmVudCk7IH0pXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tQ3Vyc29yID0gZnVuY3Rpb24gKGN1cnNvcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGJlZm9yZSA9ICEhY3Vyc29yLmJlZm9yZTtcclxuICAgICAgICB2YXIgcG9zaXRpb24gPSBjdXJzb3IudmFsdWVzLm1hcChmdW5jdGlvbiAoY29tcG9uZW50KSB7IHJldHVybiBfdGhpcy5mcm9tVmFsdWUoY29tcG9uZW50KTsgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBCb3VuZChwb3NpdGlvbiwgYmVmb3JlKTtcclxuICAgIH07XHJcbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0RpcmVjdGlvbiA9IGZ1bmN0aW9uIChkaXIpIHtcclxuICAgICAgICByZXR1cm4gRElSRUNUSU9OU1tkaXIubmFtZV07XHJcbiAgICB9O1xyXG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURpcmVjdGlvbiA9IGZ1bmN0aW9uIChkaXIpIHtcclxuICAgICAgICBzd2l0Y2ggKGRpcikge1xyXG4gICAgICAgICAgICBjYXNlICdBU0NFTkRJTkcnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERpcmVjdGlvbi5BU0NFTkRJTkc7XHJcbiAgICAgICAgICAgIGNhc2UgJ0RFU0NFTkRJTkcnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERpcmVjdGlvbi5ERVNDRU5ESU5HO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUudG9PcGVyYXRvck5hbWUgPSBmdW5jdGlvbiAob3ApIHtcclxuICAgICAgICByZXR1cm4gT1BFUkFUT1JTW29wLm5hbWVdO1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21PcGVyYXRvck5hbWUgPSBmdW5jdGlvbiAob3ApIHtcclxuICAgICAgICBzd2l0Y2ggKG9wKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ0VRVUFMJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbk9wLkVRVUFMO1xyXG4gICAgICAgICAgICBjYXNlICdHUkVBVEVSX1RIQU4nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuR1JFQVRFUl9USEFOO1xyXG4gICAgICAgICAgICBjYXNlICdHUkVBVEVSX1RIQU5fT1JfRVFVQUwnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuR1JFQVRFUl9USEFOX09SX0VRVUFMO1xyXG4gICAgICAgICAgICBjYXNlICdMRVNTX1RIQU4nOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuTEVTU19USEFOO1xyXG4gICAgICAgICAgICBjYXNlICdMRVNTX1RIQU5fT1JfRVFVQUwnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFJlbGF0aW9uT3AuTEVTU19USEFOX09SX0VRVUFMO1xyXG4gICAgICAgICAgICBjYXNlICdBUlJBWV9DT05UQUlOUyc6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUztcclxuICAgICAgICAgICAgY2FzZSAnT1BFUkFUT1JfVU5TUEVDSUZJRUQnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vuc3BlY2lmaWVkIHJlbGF0aW9uJyk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5rbm93biByZWxhdGlvbicpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b0ZpZWxkUGF0aFJlZmVyZW5jZSA9IGZ1bmN0aW9uIChwYXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHsgZmllbGRQYXRoOiBwYXRoLmNhbm9uaWNhbFN0cmluZygpIH07XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbUZpZWxkUGF0aFJlZmVyZW5jZSA9IGZ1bmN0aW9uIChmaWVsZFJlZmVyZW5jZSkge1xyXG4gICAgICAgIHJldHVybiBGaWVsZFBhdGguZnJvbVNlcnZlckZvcm1hdChmaWVsZFJlZmVyZW5jZS5maWVsZFBhdGgpO1xyXG4gICAgfTtcclxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvUHJvcGVydHlPcmRlciA9IGZ1bmN0aW9uIChvcmRlckJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZmllbGQ6IHRoaXMudG9GaWVsZFBhdGhSZWZlcmVuY2Uob3JkZXJCeS5maWVsZCksXHJcbiAgICAgICAgICAgIGRpcmVjdGlvbjogdGhpcy50b0RpcmVjdGlvbihvcmRlckJ5LmRpcilcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21Qcm9wZXJ0eU9yZGVyID0gZnVuY3Rpb24gKG9yZGVyQnkpIHtcclxuICAgICAgICByZXR1cm4gbmV3IE9yZGVyQnkodGhpcy5mcm9tRmllbGRQYXRoUmVmZXJlbmNlKG9yZGVyQnkuZmllbGQpLCB0aGlzLmZyb21EaXJlY3Rpb24ob3JkZXJCeS5kaXJlY3Rpb24pKTtcclxuICAgIH07XHJcbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS50b1JlbGF0aW9uRmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgIGlmIChmaWx0ZXIgaW5zdGFuY2VvZiBSZWxhdGlvbkZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZmllbGRGaWx0ZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZDogdGhpcy50b0ZpZWxkUGF0aFJlZmVyZW5jZShmaWx0ZXIuZmllbGQpLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wOiB0aGlzLnRvT3BlcmF0b3JOYW1lKGZpbHRlci5vcCksXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudG9WYWx1ZShmaWx0ZXIudmFsdWUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5yZWNvZ25pemVkIGZpbHRlcjogJyArIEpTT04uc3RyaW5naWZ5KGZpbHRlcikpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tUmVsYXRpb25GaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZWxhdGlvbkZpbHRlcih0aGlzLmZyb21GaWVsZFBhdGhSZWZlcmVuY2UoZmlsdGVyLmZpZWxkRmlsdGVyLmZpZWxkKSwgdGhpcy5mcm9tT3BlcmF0b3JOYW1lKGZpbHRlci5maWVsZEZpbHRlci5vcCksIHRoaXMuZnJvbVZhbHVlKGZpbHRlci5maWVsZEZpbHRlci52YWx1ZSkpO1xyXG4gICAgfTtcclxuICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvVW5hcnlGaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XHJcbiAgICAgICAgaWYgKGZpbHRlciBpbnN0YW5jZW9mIE5hbkZpbHRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZDogdGhpcy50b0ZpZWxkUGF0aFJlZmVyZW5jZShmaWx0ZXIuZmllbGQpLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wOiAnSVNfTkFOJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChmaWx0ZXIgaW5zdGFuY2VvZiBOdWxsRmlsdGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB1bmFyeUZpbHRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiB0aGlzLnRvRmllbGRQYXRoUmVmZXJlbmNlKGZpbHRlci5maWVsZCksXHJcbiAgICAgICAgICAgICAgICAgICAgb3A6ICdJU19OVUxMJ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1VucmVjb2duaXplZCBmaWx0ZXI6ICcgKyBKU09OLnN0cmluZ2lmeShmaWx0ZXIpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSnNvblByb3RvU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbVVuYXJ5RmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgIHN3aXRjaCAoZmlsdGVyLnVuYXJ5RmlsdGVyLm9wKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ0lTX05BTic6XHJcbiAgICAgICAgICAgICAgICB2YXIgbmFuRmllbGQgPSB0aGlzLmZyb21GaWVsZFBhdGhSZWZlcmVuY2UoZmlsdGVyLnVuYXJ5RmlsdGVyLmZpZWxkKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTmFuRmlsdGVyKG5hbkZpZWxkKTtcclxuICAgICAgICAgICAgY2FzZSAnSVNfTlVMTCc6XHJcbiAgICAgICAgICAgICAgICB2YXIgbnVsbEZpZWxkID0gdGhpcy5mcm9tRmllbGRQYXRoUmVmZXJlbmNlKGZpbHRlci51bmFyeUZpbHRlci5maWVsZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IE51bGxGaWx0ZXIobnVsbEZpZWxkKTtcclxuICAgICAgICAgICAgY2FzZSAnT1BFUkFUT1JfVU5TUEVDSUZJRUQnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vuc3BlY2lmaWVkIGZpbHRlcicpO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gZmlsdGVyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEpzb25Qcm90b1NlcmlhbGl6ZXIucHJvdG90eXBlLnRvRG9jdW1lbnRNYXNrID0gZnVuY3Rpb24gKGZpZWxkTWFzaykge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGZpZWxkUGF0aHM6IGZpZWxkTWFzay5maWVsZHMubWFwKGZ1bmN0aW9uIChmaWVsZCkgeyByZXR1cm4gZmllbGQuY2Fub25pY2FsU3RyaW5nKCk7IH0pXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBKc29uUHJvdG9TZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRG9jdW1lbnRNYXNrID0gZnVuY3Rpb24gKHByb3RvKSB7XHJcbiAgICAgICAgdmFyIHBhdGhzID0gcHJvdG8uZmllbGRQYXRocyB8fCBbXTtcclxuICAgICAgICB2YXIgZmllbGRzID0gcGF0aHMubWFwKGZ1bmN0aW9uIChwYXRoKSB7IHJldHVybiBGaWVsZFBhdGguZnJvbVNlcnZlckZvcm1hdChwYXRoKTsgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZE1hc2soZmllbGRzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSnNvblByb3RvU2VyaWFsaXplcjtcclxufSgpKTtcclxuLyoqXHJcbiAqIENoZWNrcyBmb3IgYSBzcGVjaWZpYyBvbmVvZiB0YWcgaW4gYSBwcm90b2NvbCBidWZmZXIgbWVzc2FnZS5cclxuICpcclxuICogVGhpcyBpbnRlbnRpb25hbGx5IGFjY29tbW9kYXRlcyB0d28gZGlzdGluY3QgY2FzZXM6XHJcbiAqXHJcbiAqIDEpIE1lc3NhZ2VzIGNvbnRhaW5pbmcgYSB0eXBlIHRhZzogdGhlc2UgYXJlIHRoZSBmb3JtYXQgcHJvZHVjZWQgYnkgR1JQQyBpblxyXG4gKiByZXR1cm4gdmFsdWVzLiBUaGVzZSBtYXkgY29udGFpbiBkZWZhdWx0LXZhbHVlIG1hcHBpbmdzIGZvciBhbGwgdGFncyBpbiB0aGVcclxuICogb25lb2YgYnV0IHRoZSB0eXBlIHRhZyBzcGVjaWZpZXMgd2hpY2ggb25lIHdhcyBhY3R1YWxseSBzZXQuXHJcbiAqXHJcbiAqIDIpIE1lc3NhZ2VzIHRoYXQgZG9uJ3QgY29udGFpbiBhIHR5cGUgdGFnOiB0aGVzZSBhcmUgdGhlIGZvcm1hdCByZXF1aXJlZCBieVxyXG4gKiBHUlBDIGFzIGlucHV0cy4gSWYgd2UgZW1pdHRlZCBvYmplY3RzIHdpdGggdHlwZSB0YWdzLCBQcm90b0J1Zi5qcyB3b3VsZFxyXG4gKiBjaG9rZSBjbGFpbWluZyB0aGF0IHRoZSB0YWdzIGFyZW4ndCBmaWVsZHMgaW4gdGhlIE1lc3NhZ2UuXHJcbiAqXHJcbiAqIEFsbG93aW5nIGJvdGggZm9ybWF0cyBoZXJlIG1ha2VzIHRoZSBzZXJpYWxpemVyIGFibGUgdG8gY29uc3VtZSB0aGUgb3V0cHV0c1xyXG4gKiBpdCBwcm9kdWNlczogZm9yIGFsbCBtZXNzYWdlcyBpdCBzdXBwb3J0cywgZnJvbVgodG9YKHZhbHVlKSkgPT0gdmFsdWUuXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCBjYXNlIDIgc3VmZmVycyBmcm9tIGFtYmlndWl0eTogaWYgbXVsdGlwbGUgdGFncyBhcmUgcHJlc2VudFxyXG4gKiB3aXRob3V0IGEgdHlwZSB0YWcgdGhlbiB0aGUgY2FsbGVycyBhcmUgc3RydWN0dXJlZCBpbiBzdWNoIGEgd2F5IHRoYXQgdGhlXHJcbiAqIGZpcnN0IGludm9jYXRpb24gd2lsbCB3aW4uIFNpbmNlIHdlIG9ubHkgcGFyc2UgaW4gdGhpcyBtb2RlIHdoZW4gcGFyc2luZ1xyXG4gKiB0aGUgb3V0cHV0IG9mIGEgc2VyaWFsaXplIG1ldGhvZCB0aGlzIHdvcmtzLCBidXQgaXQncyBub3QgYSBnZW5lcmFsXHJcbiAqIHNvbHV0aW9uLlxyXG4gKlxyXG4gKiBVbmZvcnR1bmF0ZWx5IHRoZXJlIGlzIG5vIGdlbmVyYWwgc29sdXRpb24gaGVyZSBiZWNhdXNlIHByb3RvMyBtYWtlcyBpdFxyXG4gKiBpbXBvc3NpYmxlIHRvIGRpc3Rpbmd1aXNoIHVuc2V0IGZyb20gZXhwbGljaXRseSBzZXQgZmllbGRzOiBib3RoIGhhdmUgdGhlXHJcbiAqIGRlZmF1bHQgdmFsdWUgZm9yIHRoZSB0eXBlLiBXaXRob3V0IHRoZSB0eXBlIHRhZyBidXQgbXVsdGlwbGUgdmFsdWUgdGFnc1xyXG4gKiBpdCdzIHBvc3NpYmxlIHRvIGhhdmUgZGVmYXVsdCB2YWx1ZXMgZm9yIGVhY2ggdGFnIGluIHRoZSBvbmVvZiBhbmQgbm90IGJlXHJcbiAqIGFibGUgdG8ga25vdyB3aGljaCB3YXMgYWN0dWFsbHkgaW4gZWZmZWN0LlxyXG4gKi9cclxuZnVuY3Rpb24gaGFzVGFnKG9iaiwgdHlwZSwgdGFnKSB7XHJcbiAgICByZXR1cm4gdHlwZSA9PT0gdGFnIHx8ICghdHlwZSAmJiB0YWcgaW4gb2JqKTtcclxufVxuXG4vKipcclxuICogRGV0ZWN0IFJlYWN0IE5hdGl2ZS5cclxuICpcclxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiBSZWFjdE5hdGl2ZSBlbnZpcm9ubWVudCBpcyBkZXRlY3RlZC5cclxuICovXHJcbnZhciBpc1JlYWN0TmF0aXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuICh0eXBlb2YgbmF2aWdhdG9yID09PSAnb2JqZWN0JyAmJiBuYXZpZ2F0b3JbJ3Byb2R1Y3QnXSA9PT0gJ1JlYWN0TmF0aXZlJyk7XHJcbn07XHJcblxudmFyIEVSUk9SX05BTUUgPSAnRmlyZWJhc2VFcnJvcic7XHJcbnZhciBjYXB0dXJlU3RhY2tUcmFjZSA9IEVycm9yXHJcbiAgICAuY2FwdHVyZVN0YWNrVHJhY2U7XHJcbnZhciBGaXJlYmFzZUVycm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZWJhc2VFcnJvcihjb2RlLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgICAgIC8vIFdlIHdhbnQgdGhlIHN0YWNrIHZhbHVlLCBpZiBpbXBsZW1lbnRlZCBieSBFcnJvclxyXG4gICAgICAgIGlmIChjYXB0dXJlU3RhY2tUcmFjZSkge1xyXG4gICAgICAgICAgICAvLyBQYXRjaGVzIHRoaXMuc3RhY2ssIG9taXR0ZWQgY2FsbHMgYWJvdmUgRXJyb3JGYWN0b3J5I2NyZWF0ZVxyXG4gICAgICAgICAgICBjYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBFcnJvckZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8gSW4gY2FzZSBvZiBJRTExLCBzdGFjayB3aWxsIGJlIHNldCBvbmx5IGFmdGVyIGVycm9yIGlzIHJhaXNlZC5cclxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZG9jcy5taWNyb3NvZnQuY29tL2VuLXVzL3NjcmlwdGluZy9qYXZhc2NyaXB0L3JlZmVyZW5jZS9zdGFjay1wcm9wZXJ0eS1lcnJvci1qYXZhc2NyaXB0XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9IEVSUk9SX05BTUU7XHJcbiAgICAgICAgICAgICAgICAvLyBNYWtlIG5vbi1lbnVtZXJhYmxlIGdldHRlciBmb3IgdGhlIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdzdGFjaycsIHtcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVyci5zdGFjaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBGaXJlYmFzZUVycm9yO1xyXG59KCkpO1xyXG4vLyBCYWNrLWRvb3IgaW5oZXJpdGFuY2VcclxuRmlyZWJhc2VFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XHJcbkZpcmViYXNlRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRmlyZWJhc2VFcnJvcjtcclxuRmlyZWJhc2VFcnJvci5wcm90b3R5cGUubmFtZSA9IEVSUk9SX05BTUU7XHJcbnZhciBFcnJvckZhY3RvcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFcnJvckZhY3Rvcnkoc2VydmljZSwgc2VydmljZU5hbWUsIGVycm9ycykge1xyXG4gICAgICAgIHRoaXMuc2VydmljZSA9IHNlcnZpY2U7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlTmFtZSA9IHNlcnZpY2VOYW1lO1xyXG4gICAgICAgIHRoaXMuZXJyb3JzID0gZXJyb3JzO1xyXG4gICAgICAgIC8vIE1hdGNoZXMgeyRuYW1lfSwgYnkgZGVmYXVsdC5cclxuICAgICAgICB0aGlzLnBhdHRlcm4gPSAvXFx7XFwkKFtefV0rKX0vZztcclxuICAgICAgICAvLyBlbXB0eVxyXG4gICAgfVxyXG4gICAgRXJyb3JGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoY29kZSwgZGF0YSkge1xyXG4gICAgICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgZGF0YSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdGVtcGxhdGUgPSB0aGlzLmVycm9yc1tjb2RlXTtcclxuICAgICAgICB2YXIgZnVsbENvZGUgPSB0aGlzLnNlcnZpY2UgKyAnLycgKyBjb2RlO1xyXG4gICAgICAgIHZhciBtZXNzYWdlO1xyXG4gICAgICAgIGlmICh0ZW1wbGF0ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSAnRXJyb3InO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbWVzc2FnZSA9IHRlbXBsYXRlLnJlcGxhY2UodGhpcy5wYXR0ZXJuLCBmdW5jdGlvbiAobWF0Y2gsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtrZXldO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZS50b1N0cmluZygpIDogJzwnICsga2V5ICsgJz8+JztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFNlcnZpY2U6IEVycm9yIG1lc3NhZ2UgKHNlcnZpY2UvY29kZSkuXHJcbiAgICAgICAgbWVzc2FnZSA9IHRoaXMuc2VydmljZU5hbWUgKyAnOiAnICsgbWVzc2FnZSArICcgKCcgKyBmdWxsQ29kZSArICcpLic7XHJcbiAgICAgICAgdmFyIGVyciA9IG5ldyBGaXJlYmFzZUVycm9yKGZ1bGxDb2RlLCBtZXNzYWdlKTtcclxuICAgICAgICAvLyBQb3B1bGF0ZSB0aGUgRXJyb3Igb2JqZWN0IHdpdGggbWVzc2FnZSBwYXJ0cyBmb3IgcHJvZ3JhbW1hdGljXHJcbiAgICAgICAgLy8gYWNjZXNzZXMgKGUuZy4sIGUuZmlsZSkuXHJcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmICghZGF0YS5oYXNPd25Qcm9wZXJ0eShwcm9wKSB8fCBwcm9wLnNsaWNlKC0xKSA9PT0gJ18nKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlcnJbcHJvcF0gPSBkYXRhW3Byb3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZXJyO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBFcnJvckZhY3Rvcnk7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBDb3B5cmlnaHQgMjAxMSBUaGUgQ2xvc3VyZSBMaWJyYXJ5IEF1dGhvcnMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbi8vXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbi8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbi8vXHJcbi8vICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbi8vXHJcbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUy1JU1wiIEJBU0lTLFxyXG4vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgQWJzdHJhY3QgY3J5cHRvZ3JhcGhpYyBoYXNoIGludGVyZmFjZS5cclxuICpcclxuICogU2VlIFNoYTEgYW5kIE1kNSBmb3Igc2FtcGxlIGltcGxlbWVudGF0aW9ucy5cclxuICpcclxuICovXHJcbi8qKlxyXG4gKiBDcmVhdGUgYSBjcnlwdG9ncmFwaGljIGhhc2ggaW5zdGFuY2UuXHJcbiAqXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAc3RydWN0XHJcbiAqL1xyXG52YXIgSGFzaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEhhc2goKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGJsb2NrIHNpemUgZm9yIHRoZSBoYXNoZXIuXHJcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmJsb2NrU2l6ZSA9IC0xO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEhhc2g7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBTSEEtMSBjcnlwdG9ncmFwaGljIGhhc2guXHJcbiAqIFZhcmlhYmxlIG5hbWVzIGZvbGxvdyB0aGUgbm90YXRpb24gaW4gRklQUyBQVUIgMTgwLTM6XHJcbiAqIGh0dHA6Ly9jc3JjLm5pc3QuZ292L3B1YmxpY2F0aW9ucy9maXBzL2ZpcHMxODAtMy9maXBzMTgwLTNfZmluYWwucGRmLlxyXG4gKlxyXG4gKiBVc2FnZTpcclxuICogICB2YXIgc2hhMSA9IG5ldyBzaGExKCk7XHJcbiAqICAgc2hhMS51cGRhdGUoYnl0ZXMpO1xyXG4gKiAgIHZhciBoYXNoID0gc2hhMS5kaWdlc3QoKTtcclxuICpcclxuICogUGVyZm9ybWFuY2U6XHJcbiAqICAgQ2hyb21lIDIzOiAgIH40MDAgTWJpdC9zXHJcbiAqICAgRmlyZWZveCAxNjogIH4yNTAgTWJpdC9zXHJcbiAqXHJcbiAqL1xyXG4vKipcclxuICogU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoIGNvbnN0cnVjdG9yLlxyXG4gKlxyXG4gKiBUaGUgcHJvcGVydGllcyBkZWNsYXJlZCBoZXJlIGFyZSBkaXNjdXNzZWQgaW4gdGhlIGFib3ZlIGFsZ29yaXRobSBkb2N1bWVudC5cclxuICogQGNvbnN0cnVjdG9yXHJcbiAqIEBleHRlbmRzIHtIYXNofVxyXG4gKiBAZmluYWxcclxuICogQHN0cnVjdFxyXG4gKi9cclxudmFyIFNoYTEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTaGExLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2hhMSgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEhvbGRzIHRoZSBwcmV2aW91cyB2YWx1ZXMgb2YgYWNjdW11bGF0ZWQgdmFyaWFibGVzIGEtZSBpbiB0aGUgY29tcHJlc3NfXHJcbiAgICAgICAgICogZnVuY3Rpb24uXHJcbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMuY2hhaW5fID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBidWZmZXIgaG9sZGluZyB0aGUgcGFydGlhbGx5IGNvbXB1dGVkIGhhc2ggcmVzdWx0LlxyXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLmJ1Zl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbiBhcnJheSBvZiA4MCBieXRlcywgZWFjaCBhIHBhcnQgb2YgdGhlIG1lc3NhZ2UgdG8gYmUgaGFzaGVkLiAgUmVmZXJyZWQgdG9cclxuICAgICAgICAgKiBhcyB0aGUgbWVzc2FnZSBzY2hlZHVsZSBpbiB0aGUgZG9jcy5cclxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5XXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbnRhaW5zIGRhdGEgbmVlZGVkIHRvIHBhZCBtZXNzYWdlcyBsZXNzIHRoYW4gNjQgYnl0ZXMuXHJcbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMucGFkXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBwcml2YXRlIHtudW1iZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMuaW5idWZfID0gMDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLnRvdGFsXyA9IDA7XHJcbiAgICAgICAgX3RoaXMuYmxvY2tTaXplID0gNTEyIC8gODtcclxuICAgICAgICBfdGhpcy5wYWRfWzBdID0gMTI4O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgX3RoaXMuYmxvY2tTaXplOyArK2kpIHtcclxuICAgICAgICAgICAgX3RoaXMucGFkX1tpXSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF90aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgU2hhMS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAweDY3NDUyMzAxO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gMHhlZmNkYWI4OTtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9IDB4OThiYWRjZmU7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAweDEwMzI1NDc2O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gMHhjM2QyZTFmMDtcclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gPSAwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJuYWwgY29tcHJlc3MgaGVscGVyIGZ1bmN0aW9uLlxyXG4gICAgICogQHBhcmFtIHshQXJyYXk8bnVtYmVyPnwhVWludDhBcnJheXxzdHJpbmd9IGJ1ZiBCbG9jayB0byBjb21wcmVzcy5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyPX0gb3B0X29mZnNldCBPZmZzZXQgb2YgdGhlIGJsb2NrIGluIHRoZSBidWZmZXIuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBTaGExLnByb3RvdHlwZS5jb21wcmVzc18gPSBmdW5jdGlvbiAoYnVmLCBvcHRfb2Zmc2V0KSB7XHJcbiAgICAgICAgaWYgKCFvcHRfb2Zmc2V0KSB7XHJcbiAgICAgICAgICAgIG9wdF9vZmZzZXQgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgVyA9IHRoaXMuV187XHJcbiAgICAgICAgLy8gZ2V0IDE2IGJpZyBlbmRpYW4gd29yZHNcclxuICAgICAgICBpZiAodHlwZW9mIGJ1ZiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKHVzZXIpOiBbYnVnIDgxNDAxMjJdIFJlY2VudCB2ZXJzaW9ucyBvZiBTYWZhcmkgZm9yIE1hYyBPUyBhbmQgaU9TXHJcbiAgICAgICAgICAgICAgICAvLyBoYXZlIGEgYnVnIHRoYXQgdHVybnMgdGhlIHBvc3QtaW5jcmVtZW50ICsrIG9wZXJhdG9yIGludG8gcHJlLWluY3JlbWVudFxyXG4gICAgICAgICAgICAgICAgLy8gZHVyaW5nIEpJVCBjb21waWxhdGlvbi4gIFdlIGhhdmUgY29kZSB0aGF0IGRlcGVuZHMgaGVhdmlseSBvbiBTSEEtMSBmb3JcclxuICAgICAgICAgICAgICAgIC8vIGNvcnJlY3RuZXNzIGFuZCB3aGljaCBpcyBhZmZlY3RlZCBieSB0aGlzIGJ1Zywgc28gSSd2ZSByZW1vdmVkIGFsbCB1c2VzXHJcbiAgICAgICAgICAgICAgICAvLyBvZiBwb3N0LWluY3JlbWVudCArKyBpbiB3aGljaCB0aGUgcmVzdWx0IHZhbHVlIGlzIHVzZWQuICBXZSBjYW4gcmV2ZXJ0XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGNoYW5nZSBvbmNlIHRoZSBTYWZhcmkgYnVnXHJcbiAgICAgICAgICAgICAgICAvLyAoaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTEwOTAzNikgaGFzIGJlZW4gZml4ZWQgYW5kXHJcbiAgICAgICAgICAgICAgICAvLyBtb3N0IGNsaWVudHMgaGF2ZSBiZWVuIHVwZGF0ZWQuXHJcbiAgICAgICAgICAgICAgICBXW2ldID1cclxuICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCkgPDwgMjQpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQgKyAxKSA8PCAxNikgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCArIDIpIDw8IDgpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVmLmNoYXJDb2RlQXQob3B0X29mZnNldCArIDMpO1xyXG4gICAgICAgICAgICAgICAgb3B0X29mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIFdbaV0gPVxyXG4gICAgICAgICAgICAgICAgICAgIChidWZbb3B0X29mZnNldF0gPDwgMjQpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvcHRfb2Zmc2V0ICsgMV0gPDwgMTYpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvcHRfb2Zmc2V0ICsgMl0gPDwgOCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWZbb3B0X29mZnNldCArIDNdO1xyXG4gICAgICAgICAgICAgICAgb3B0X29mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGV4cGFuZCB0byA4MCB3b3Jkc1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAxNjsgaSA8IDgwOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHQgPSBXW2kgLSAzXSBeIFdbaSAtIDhdIF4gV1tpIC0gMTRdIF4gV1tpIC0gMTZdO1xyXG4gICAgICAgICAgICBXW2ldID0gKCh0IDw8IDEpIHwgKHQgPj4+IDMxKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYSA9IHRoaXMuY2hhaW5fWzBdO1xyXG4gICAgICAgIHZhciBiID0gdGhpcy5jaGFpbl9bMV07XHJcbiAgICAgICAgdmFyIGMgPSB0aGlzLmNoYWluX1syXTtcclxuICAgICAgICB2YXIgZCA9IHRoaXMuY2hhaW5fWzNdO1xyXG4gICAgICAgIHZhciBlID0gdGhpcy5jaGFpbl9bNF07XHJcbiAgICAgICAgdmFyIGYsIGs7XHJcbiAgICAgICAgLy8gVE9ETyh1c2VyKTogVHJ5IHRvIHVucm9sbCB0aGlzIGxvb3AgdG8gc3BlZWQgdXAgdGhlIGNvbXB1dGF0aW9uLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODA7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaSA8IDQwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGQgXiAoYiAmIChjIF4gZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDVhODI3OTk5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGIgXiBjIF4gZDtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg2ZWQ5ZWJhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gKGIgJiBjKSB8IChkICYgKGIgfCBjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4OGYxYmJjZGM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweGNhNjJjMWQ2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ID0gKCgoYSA8PCA1KSB8IChhID4+PiAyNykpICsgZiArIGUgKyBrICsgV1tpXSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgICAgICBlID0gZDtcclxuICAgICAgICAgICAgZCA9IGM7XHJcbiAgICAgICAgICAgIGMgPSAoKGIgPDwgMzApIHwgKGIgPj4+IDIpKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgICAgIGIgPSBhO1xyXG4gICAgICAgICAgICBhID0gdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAodGhpcy5jaGFpbl9bMF0gKyBhKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMV0gPSAodGhpcy5jaGFpbl9bMV0gKyBiKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMl0gPSAodGhpcy5jaGFpbl9bMl0gKyBjKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAodGhpcy5jaGFpbl9bM10gKyBkKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bNF0gPSAodGhpcy5jaGFpbl9bNF0gKyBlKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICB9O1xyXG4gICAgU2hhMS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGJ5dGVzLCBvcHRfbGVuZ3RoKSB7XHJcbiAgICAgICAgLy8gVE9ETyhqb2hubGVueik6IHRpZ2h0ZW4gdGhlIGZ1bmN0aW9uIHNpZ25hdHVyZSBhbmQgcmVtb3ZlIHRoaXMgY2hlY2tcclxuICAgICAgICBpZiAoYnl0ZXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvcHRfbGVuZ3RoID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgb3B0X2xlbmd0aCA9IGJ5dGVzLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGxlbmd0aE1pbnVzQmxvY2sgPSBvcHRfbGVuZ3RoIC0gdGhpcy5ibG9ja1NpemU7XHJcbiAgICAgICAgdmFyIG4gPSAwO1xyXG4gICAgICAgIC8vIFVzaW5nIGxvY2FsIGluc3RlYWQgb2YgbWVtYmVyIHZhcmlhYmxlcyBnaXZlcyB+NSUgc3BlZWR1cCBvbiBGaXJlZm94IDE2LlxyXG4gICAgICAgIHZhciBidWYgPSB0aGlzLmJ1Zl87XHJcbiAgICAgICAgdmFyIGluYnVmID0gdGhpcy5pbmJ1Zl87XHJcbiAgICAgICAgLy8gVGhlIG91dGVyIHdoaWxlIGxvb3Agc2hvdWxkIGV4ZWN1dGUgYXQgbW9zdCB0d2ljZS5cclxuICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcclxuICAgICAgICAgICAgLy8gV2hlbiB3ZSBoYXZlIG5vIGRhdGEgaW4gdGhlIGJsb2NrIHRvIHRvcCB1cCwgd2UgY2FuIGRpcmVjdGx5IHByb2Nlc3MgdGhlXHJcbiAgICAgICAgICAgIC8vIGlucHV0IGJ1ZmZlciAoYXNzdW1pbmcgaXQgY29udGFpbnMgc3VmZmljaWVudCBkYXRhKS4gVGhpcyBnaXZlcyB+MjUlXHJcbiAgICAgICAgICAgIC8vIHNwZWVkdXAgb24gQ2hyb21lIDIzIGFuZCB+MTUlIHNwZWVkdXAgb24gRmlyZWZveCAxNiwgYnV0IHJlcXVpcmVzIHRoYXRcclxuICAgICAgICAgICAgLy8gdGhlIGRhdGEgaXMgcHJvdmlkZWQgaW4gbGFyZ2UgY2h1bmtzIChvciBpbiBtdWx0aXBsZXMgb2YgNjQgYnl0ZXMpLlxyXG4gICAgICAgICAgICBpZiAoaW5idWYgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPD0gbGVuZ3RoTWludXNCbG9jaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ5dGVzLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBuICs9IHRoaXMuYmxvY2tTaXplO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYnl0ZXMgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXMuY2hhckNvZGVBdChuKTtcclxuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xyXG4gICAgICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT0gdGhpcy5ibG9ja1NpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5idWYgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBKdW1wIHRvIHRoZSBvdXRlciBsb29wIHNvIHdlIHVzZSB0aGUgZnVsbC1ibG9jayBvcHRpbWl6YXRpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgb3B0X2xlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlc1tuXTtcclxuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xyXG4gICAgICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT0gdGhpcy5ibG9ja1NpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5idWYgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBKdW1wIHRvIHRoZSBvdXRlciBsb29wIHNvIHdlIHVzZSB0aGUgZnVsbC1ibG9jayBvcHRpbWl6YXRpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluYnVmXyA9IGluYnVmO1xyXG4gICAgICAgIHRoaXMudG90YWxfICs9IG9wdF9sZW5ndGg7XHJcbiAgICB9O1xyXG4gICAgLyoqIEBvdmVycmlkZSAqL1xyXG4gICAgU2hhMS5wcm90b3R5cGUuZGlnZXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBkaWdlc3QgPSBbXTtcclxuICAgICAgICB2YXIgdG90YWxCaXRzID0gdGhpcy50b3RhbF8gKiA4O1xyXG4gICAgICAgIC8vIEFkZCBwYWQgMHg4MCAweDAwKi5cclxuICAgICAgICBpZiAodGhpcy5pbmJ1Zl8gPCA1Nikge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnBhZF8sIDU2IC0gdGhpcy5pbmJ1Zl8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCB0aGlzLmJsb2NrU2l6ZSAtICh0aGlzLmluYnVmXyAtIDU2KSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEFkZCAjIGJpdHMuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuYmxvY2tTaXplIC0gMTsgaSA+PSA1NjsgaS0tKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnVmX1tpXSA9IHRvdGFsQml0cyAmIDI1NTtcclxuICAgICAgICAgICAgdG90YWxCaXRzIC89IDI1NjsgLy8gRG9uJ3QgdXNlIGJpdC1zaGlmdGluZyBoZXJlIVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbXByZXNzXyh0aGlzLmJ1Zl8pO1xyXG4gICAgICAgIHZhciBuID0gMDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMjQ7IGogPj0gMDsgaiAtPSA4KSB7XHJcbiAgICAgICAgICAgICAgICBkaWdlc3Rbbl0gPSAodGhpcy5jaGFpbl9baV0gPj4gaikgJiAyNTU7XHJcbiAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGRpZ2VzdDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2hhMTtcclxufShIYXNoKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZXMgYSBzaW1wbGUgaGVscGVyIGNsYXNzIHRoYXQgaW1wbGVtZW50cyB0aGUgU3RyZWFtIGludGVyZmFjZSB0b1xyXG4gKiBicmlkZ2UgdG8gb3RoZXIgaW1wbGVtZW50YXRpb25zIHRoYXQgYXJlIHN0cmVhbXMgYnV0IGRvIG5vdCBpbXBsZW1lbnQgdGhlXHJcbiAqIGludGVyZmFjZS4gVGhlIHN0cmVhbSBjYWxsYmFja3MgYXJlIGludm9rZWQgd2l0aCB0aGUgY2FsbE9uLi4uIG1ldGhvZHMuXHJcbiAqL1xyXG52YXIgU3RyZWFtQnJpZGdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU3RyZWFtQnJpZGdlKGFyZ3MpIHtcclxuICAgICAgICB0aGlzLnNlbmRGbiA9IGFyZ3Muc2VuZEZuO1xyXG4gICAgICAgIHRoaXMuY2xvc2VGbiA9IGFyZ3MuY2xvc2VGbjtcclxuICAgIH1cclxuICAgIFN0cmVhbUJyaWRnZS5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLndyYXBwZWRPbk9wZW4sICdDYWxsZWQgb25PcGVuIG9uIHN0cmVhbSB0d2ljZSEnKTtcclxuICAgICAgICB0aGlzLndyYXBwZWRPbk9wZW4gPSBjYWxsYmFjaztcclxuICAgIH07XHJcbiAgICBTdHJlYW1CcmlkZ2UucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMud3JhcHBlZE9uQ2xvc2UsICdDYWxsZWQgb25DbG9zZSBvbiBzdHJlYW0gdHdpY2UhJyk7XHJcbiAgICAgICAgdGhpcy53cmFwcGVkT25DbG9zZSA9IGNhbGxiYWNrO1xyXG4gICAgfTtcclxuICAgIFN0cmVhbUJyaWRnZS5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLndyYXBwZWRPbk1lc3NhZ2UsICdDYWxsZWQgb25NZXNzYWdlIG9uIHN0cmVhbSB0d2ljZSEnKTtcclxuICAgICAgICB0aGlzLndyYXBwZWRPbk1lc3NhZ2UgPSBjYWxsYmFjaztcclxuICAgIH07XHJcbiAgICBTdHJlYW1CcmlkZ2UucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2VGbigpO1xyXG4gICAgfTtcclxuICAgIFN0cmVhbUJyaWRnZS5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICB0aGlzLnNlbmRGbihtc2cpO1xyXG4gICAgfTtcclxuICAgIFN0cmVhbUJyaWRnZS5wcm90b3R5cGUuY2FsbE9uT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy53cmFwcGVkT25PcGVuICE9PSB1bmRlZmluZWQsICdDYW5ub3QgY2FsbCBvbk9wZW4gYmVjYXVzZSBubyBjYWxsYmFjayB3YXMgc2V0Jyk7XHJcbiAgICAgICAgdGhpcy53cmFwcGVkT25PcGVuKCk7XHJcbiAgICB9O1xyXG4gICAgU3RyZWFtQnJpZGdlLnByb3RvdHlwZS5jYWxsT25DbG9zZSA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy53cmFwcGVkT25DbG9zZSAhPT0gdW5kZWZpbmVkLCAnQ2Fubm90IGNhbGwgb25DbG9zZSBiZWNhdXNlIG5vIGNhbGxiYWNrIHdhcyBzZXQnKTtcclxuICAgICAgICB0aGlzLndyYXBwZWRPbkNsb3NlKGVycik7XHJcbiAgICB9O1xyXG4gICAgU3RyZWFtQnJpZGdlLnByb3RvdHlwZS5jYWxsT25NZXNzYWdlID0gZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLndyYXBwZWRPbk1lc3NhZ2UgIT09IHVuZGVmaW5lZCwgJ0Nhbm5vdCBjYWxsIG9uTWVzc2FnZSBiZWNhdXNlIG5vIGNhbGxiYWNrIHdhcyBzZXQnKTtcclxuICAgICAgICB0aGlzLndyYXBwZWRPbk1lc3NhZ2UobXNnKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU3RyZWFtQnJpZGdlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUcgPSAnQ29ubmVjdGlvbic7XHJcbnZhciBSUENfU1RSRUFNX1NFUlZJQ0UgPSAnZ29vZ2xlLmZpcmVzdG9yZS52MWJldGExLkZpcmVzdG9yZSc7XHJcbnZhciBSUENfVVJMX1ZFUlNJT04gPSAndjFiZXRhMSc7XHJcbi8qKiBNYXBzIFJQQyBuYW1lcyB0byB0aGUgY29ycmVzcG9uZGluZyBSRVNUIGVuZHBvaW50IG5hbWUuICovXHJcbnZhciBSUENfTkFNRV9SRVNUX01BUFBJTkcgPSB7XHJcbiAgICBCYXRjaEdldERvY3VtZW50czogJ2JhdGNoR2V0JyxcclxuICAgIENvbW1pdDogJ2NvbW1pdCdcclxufTtcclxuLy8gVE9ETyhiLzM4MjAzMzQ0KTogVGhlIFNES19WRVJTSU9OIGlzIHNldCBpbmRlcGVuZGVudGx5IGZyb20gRmlyZWJhc2UgYmVjYXVzZVxyXG4vLyB3ZSBhcmUgZG9pbmcgb3V0LW9mLWJhbmQgcmVsZWFzZXMuIE9uY2Ugd2UgcmVsZWFzZSBhcyBwYXJ0IG9mIEZpcmViYXNlLCB3ZVxyXG4vLyBzaG91bGQgdXNlIHRoZSBGaXJlYmFzZSB2ZXJzaW9uIGluc3RlYWQuXHJcbnZhciBYX0dPT0dfQVBJX0NMSUVOVF9WQUxVRSA9ICdnbC1qcy8gZmlyZS8nICsgU0RLX1ZFUlNJT047XHJcbnZhciBYSFJfVElNRU9VVF9TRUNTID0gMTU7XHJcbnZhciBXZWJDaGFubmVsQ29ubmVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdlYkNoYW5uZWxDb25uZWN0aW9uKGluZm8pIHtcclxuICAgICAgICB0aGlzLmRhdGFiYXNlSWQgPSBpbmZvLmRhdGFiYXNlSWQ7XHJcbiAgICAgICAgdGhpcy5wb29sID0gbmV3IHdlYmNoYW5uZWxXcmFwcGVyLlhocklvUG9vbCgpO1xyXG4gICAgICAgIHZhciBwcm90byA9IGluZm8uc3NsID8gJ2h0dHBzJyA6ICdodHRwJztcclxuICAgICAgICB0aGlzLmJhc2VVcmwgPSBwcm90byArICc6Ly8nICsgaW5mby5ob3N0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBNb2RpZmllcyB0aGUgaGVhZGVycyBmb3IgYSByZXF1ZXN0LCBhZGRpbmcgYW55IGF1dGhvcml6YXRpb24gdG9rZW4gaWZcclxuICAgICAqIHByZXNlbnQgYW5kIGFueSBhZGRpdGlvbmFsIGhlYWRlcnMgZm9yIHRoZSByZXF1ZXN0LlxyXG4gICAgICovXHJcbiAgICBXZWJDaGFubmVsQ29ubmVjdGlvbi5wcm90b3R5cGUubW9kaWZ5SGVhZGVyc0ZvclJlcXVlc3QgPSBmdW5jdGlvbiAoaGVhZGVycywgdG9rZW4pIHtcclxuICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaGVhZGVyIGluIHRva2VuLmF1dGhIZWFkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodG9rZW4uYXV0aEhlYWRlcnMuaGFzT3duUHJvcGVydHkoaGVhZGVyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbaGVhZGVyXSA9IHRva2VuLmF1dGhIZWFkZXJzW2hlYWRlcl07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaGVhZGVyc1snWC1Hb29nLUFwaS1DbGllbnQnXSA9IFhfR09PR19BUElfQ0xJRU5UX1ZBTFVFO1xyXG4gICAgfTtcclxuICAgIFdlYkNoYW5uZWxDb25uZWN0aW9uLnByb3RvdHlwZS5pbnZva2VSUEMgPSBmdW5jdGlvbiAocnBjTmFtZSwgcmVxdWVzdCwgdG9rZW4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciB1cmwgPSB0aGlzLm1ha2VVcmwocnBjTmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBYaHJJb1Bvb2wgZG9lc24ndCBoYXZlIFRTIHR5cGluZ3MuXHJcbiAgICAgICAgICAgIF90aGlzLnBvb2wuZ2V0T2JqZWN0KGZ1bmN0aW9uICh4aHIpIHtcclxuICAgICAgICAgICAgICAgIHhoci5saXN0ZW5PbmNlKHdlYmNoYW5uZWxXcmFwcGVyLkV2ZW50VHlwZS5DT01QTEVURSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoeGhyLmdldExhc3RFcnJvckNvZGUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSB3ZWJjaGFubmVsV3JhcHBlci5FcnJvckNvZGUuTk9fRVJST1I6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGpzb24gPSB4aHIuZ2V0UmVzcG9uc2VKc29uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1hIUiByZWNlaXZlZDonLCBKU09OLnN0cmluZ2lmeShqc29uKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShqc29uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Ugd2ViY2hhbm5lbFdyYXBwZXIuRXJyb3JDb2RlLlRJTUVPVVQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1JQQyBcIicgKyBycGNOYW1lICsgJ1wiIHRpbWVkIG91dCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5ERUFETElORV9FWENFRURFRCwgJ1JlcXVlc3QgdGltZSBvdXQnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHdlYmNoYW5uZWxXcmFwcGVyLkVycm9yQ29kZS5IVFRQX0VSUk9SOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXNfMSA9IHhoci5nZXRTdGF0dXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnUlBDIFwiJyArIHJwY05hbWUgKyAnXCIgZmFpbGVkIHdpdGggc3RhdHVzOicsIHN0YXR1c18xLCAncmVzcG9uc2UgdGV4dDonLCB4aHIuZ2V0UmVzcG9uc2VUZXh0KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXNfMSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihtYXBDb2RlRnJvbUh0dHBTdGF0dXMoc3RhdHVzXzEpLCAnU2VydmVyIHJlc3BvbmRlZCB3aXRoIHN0YXR1cyAnICsgeGhyLmdldFN0YXR1c1RleHQoKSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgcmVjZWl2ZWQgYW4gSFRUUF9FUlJPUiBidXQgdGhlcmUncyBubyBzdGF0dXMgY29kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXQncyBtb3N0IHByb2JhYmx5IGEgY29ubmVjdGlvbiBpc3N1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnUlBDIFwiJyArIHJwY05hbWUgKyAnXCIgZmFpbGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTkFWQUlMQUJMRSwgJ0Nvbm5lY3Rpb24gZmFpbGVkLicpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWwoJ1JQQyBcIicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBycGNOYW1lICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1wiIGZhaWxlZCB3aXRoIHVuYW50aWNpcGF0ZWQgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3ZWJjaGFubmVsIGVycm9yICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4aHIuZ2V0TGFzdEVycm9yQ29kZSgpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzogJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhoci5nZXRMYXN0RXJyb3IoKSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcsIGdpdmluZyB1cC4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBmaW5hbGx5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1JQQyBcIicgKyBycGNOYW1lICsgJ1wiIGNvbXBsZXRlZC4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucG9vbC5yZWxlYXNlT2JqZWN0KHhocik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdFN0cmluZyA9IEpTT04uc3RyaW5naWZ5KHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1hIUiBzZW5kaW5nOiAnLCB1cmwgKyAnICcgKyByZXF1ZXN0U3RyaW5nKTtcclxuICAgICAgICAgICAgICAgIC8vIENvbnRlbnQtVHlwZTogdGV4dC9wbGFpbiB3aWxsIGF2b2lkIHByZWZsaWdodCByZXF1ZXN0cyB3aGljaCBtaWdodFxyXG4gICAgICAgICAgICAgICAgLy8gbWVzcyB3aXRoIENPUlMgYW5kIHJlZGlyZWN0cyBieSBwcm94aWVzLiBJZiB3ZSBhZGQgY3VzdG9tIGhlYWRlcnNcclxuICAgICAgICAgICAgICAgIC8vIHdlIHdpbGwgbmVlZCB0byBjaGFuZ2UgdGhpcyBjb2RlIHRvIHBvdGVudGlhbGx5IHVzZSB0aGVcclxuICAgICAgICAgICAgICAgIC8vICRodHRwT3ZlcndyaXRlIHBhcmFtZXRlciBzdXBwb3J0ZWQgYnkgRVNGIHRvIGF2b2lkXHJcbiAgICAgICAgICAgICAgICAvLyB0cmlnZ2VyaW5nIHByZWZsaWdodCByZXF1ZXN0cy5cclxuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0geyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH07XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5tb2RpZnlIZWFkZXJzRm9yUmVxdWVzdChoZWFkZXJzLCB0b2tlbik7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2VuZCh1cmwsICdQT1NUJywgcmVxdWVzdFN0cmluZywgaGVhZGVycywgWEhSX1RJTUVPVVRfU0VDUyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFdlYkNoYW5uZWxDb25uZWN0aW9uLnByb3RvdHlwZS5pbnZva2VTdHJlYW1pbmdSUEMgPSBmdW5jdGlvbiAocnBjTmFtZSwgcmVxdWVzdCwgdG9rZW4pIHtcclxuICAgICAgICAvLyBUaGUgUkVTVCBBUEkgYXV0b21hdGljYWxseSBhZ2dyZWdhdGVzIGFsbCBvZiB0aGUgc3RyZWFtZWQgcmVzdWx0cywgc28gd2VcclxuICAgICAgICAvLyBjYW4ganVzdCB1c2UgdGhlIG5vcm1hbCBpbnZva2UoKSBtZXRob2QuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW52b2tlUlBDKHJwY05hbWUsIHJlcXVlc3QsIHRva2VuKTtcclxuICAgIH07XHJcbiAgICBXZWJDaGFubmVsQ29ubmVjdGlvbi5wcm90b3R5cGUub3BlblN0cmVhbSA9IGZ1bmN0aW9uIChycGNOYW1lLCB0b2tlbikge1xyXG4gICAgICAgIHZhciB1cmxQYXJ0cyA9IFtcclxuICAgICAgICAgICAgdGhpcy5iYXNlVXJsLFxyXG4gICAgICAgICAgICAnLycsXHJcbiAgICAgICAgICAgIFJQQ19TVFJFQU1fU0VSVklDRSxcclxuICAgICAgICAgICAgJy8nLFxyXG4gICAgICAgICAgICBycGNOYW1lLFxyXG4gICAgICAgICAgICAnL2NoYW5uZWwnXHJcbiAgICAgICAgXTtcclxuICAgICAgICB2YXIgd2ViY2hhbm5lbFRyYW5zcG9ydCA9IHdlYmNoYW5uZWxXcmFwcGVyLmNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQoKTtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHtcclxuICAgICAgICAgICAgLy8gQmFja2dyb3VuZCBjaGFubmVsIHRlc3QgYXZvaWRzIHRoZSBpbml0aWFsIHR3byB0ZXN0IGNhbGxzIGFuZCBkZWNyZWFzZXNcclxuICAgICAgICAgICAgLy8gaW5pdGlhbCBjb2xkIHN0YXJ0IHRpbWUuXHJcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogd2VuYm96QCBtZW50aW9uZWQgdGhpcyBtaWdodCBhZmZlY3QgdXNlIHdpdGggcHJveGllcyBhbmRcclxuICAgICAgICAgICAgLy8gd2Ugc2hvdWxkIG1vbml0b3IgY2xvc2VseSBmb3IgYW55IHJlcG9ydHMuXHJcbiAgICAgICAgICAgIGJhY2tncm91bmRDaGFubmVsVGVzdDogdHJ1ZSxcclxuICAgICAgICAgICAgLy8gUmVxdWlyZWQgZm9yIGJhY2tlbmQgc3RpY2tpbmVzcywgcm91dGluZyBiZWhhdmlvciBpcyBiYXNlZCBvbiB0aGlzXHJcbiAgICAgICAgICAgIC8vIHBhcmFtZXRlci5cclxuICAgICAgICAgICAgaHR0cFNlc3Npb25JZFBhcmFtOiAnZ3Nlc3Npb25pZCcsXHJcbiAgICAgICAgICAgIGluaXRNZXNzYWdlSGVhZGVyczoge30sXHJcbiAgICAgICAgICAgIG1lc3NhZ2VVcmxQYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFyYW0gaXMgdXNlZCB0byBpbXByb3ZlIHJvdXRpbmcgYW5kIHByb2plY3QgaXNvbGF0aW9uIGJ5IHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gYmFja2VuZCBhbmQgbXVzdCBiZSBpbmNsdWRlZCBpbiBldmVyeSByZXF1ZXN0LlxyXG4gICAgICAgICAgICAgICAgZGF0YWJhc2U6IFwicHJvamVjdHMvXCIgKyB0aGlzLmRhdGFiYXNlSWQucHJvamVjdElkICsgXCIvZGF0YWJhc2VzL1wiICsgdGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNlbmRSYXdKc29uOiB0cnVlLFxyXG4gICAgICAgICAgICBzdXBwb3J0c0Nyb3NzRG9tYWluWGhyOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm1vZGlmeUhlYWRlcnNGb3JSZXF1ZXN0KHJlcXVlc3QuaW5pdE1lc3NhZ2VIZWFkZXJzLCB0b2tlbik7XHJcbiAgICAgICAgLy8gU2VuZGluZyB0aGUgY3VzdG9tIGhlYWRlcnMgd2UganVzdCBhZGRlZCB0byByZXF1ZXN0LmluaXRNZXNzYWdlSGVhZGVyc1xyXG4gICAgICAgIC8vIChBdXRob3JpemF0aW9uLCBldGMuKSB3aWxsIHRyaWdnZXIgdGhlIGJyb3dzZXIgdG8gbWFrZSBhIENPUlMgcHJlZmxpZ2h0XHJcbiAgICAgICAgLy8gcmVxdWVzdCBiZWNhdXNlIHRoZSBYSFIgd2lsbCBubyBsb25nZXIgbWVldCB0aGUgY3JpdGVyaWEgZm9yIGEgXCJzaW1wbGVcIlxyXG4gICAgICAgIC8vIENPUlMgcmVxdWVzdDpcclxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVFRQL0NPUlMjU2ltcGxlX3JlcXVlc3RzXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBUaGVyZWZvcmUgdG8gYXZvaWQgdGhlIENPUlMgcHJlZmxpZ2h0IHJlcXVlc3QgKGFuIGV4dHJhIG5ldHdvcmtcclxuICAgICAgICAvLyByb3VuZHRyaXApLCB3ZSB1c2UgdGhlIGh0dHBIZWFkZXJzT3ZlcndyaXRlUGFyYW0gb3B0aW9uIHRvIHNwZWNpZnkgdGhhdFxyXG4gICAgICAgIC8vIHRoZSBoZWFkZXJzIHNob3VsZCBpbnN0ZWFkIGJlIGVuY29kZWQgaW50byBhIHNwZWNpYWwgXCIkaHR0cEhlYWRlcnNcIiBxdWVyeVxyXG4gICAgICAgIC8vIHBhcmFtZXRlciwgd2hpY2ggaXMgcmVjb2duaXplZCBieSB0aGUgd2ViY2hhbm5lbCBiYWNrZW5kLiBUaGlzIGlzXHJcbiAgICAgICAgLy8gZm9ybWFsbHkgZGVmaW5lZCBoZXJlOlxyXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvY2xvc3VyZS1saWJyYXJ5L2Jsb2IvYjBlMTgxNWIxM2ZiOTJhNDZkN2M5YjNjMzBkZTVkNmEzOTZhMzI0NS9jbG9zdXJlL2dvb2cvbmV0L3JwYy9odHRwY29ycy5qcyNMMzJcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIEJ1dCBmb3Igc29tZSB1bmNsZWFyIHJlYXNvbiAoc2VlXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvNzAzKSwgdGhpcyBicmVha3NcclxuICAgICAgICAvLyBSZWFjdE5hdGl2ZSBhbmQgc28gd2UgZXhjbHVkZSBpdCwgd2hpY2gganVzdCBtZWFucyBSZWFjdE5hdGl2ZSBtYXkgYmVcclxuICAgICAgICAvLyBzdWJqZWN0IHRvIHRoZSBleHRyYSBuZXR3b3JrIHJvdW5kdHJpcCBmb3IgQ09SUyBwcmVmbGlnaHQuXHJcbiAgICAgICAgaWYgKCFpc1JlYWN0TmF0aXZlKCkpIHtcclxuICAgICAgICAgICAgcmVxdWVzdFsnaHR0cEhlYWRlcnNPdmVyd3JpdGVQYXJhbSddID0gJyRodHRwSGVhZGVycyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB1cmwgPSB1cmxQYXJ0cy5qb2luKCcnKTtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnQ3JlYXRpbmcgV2ViQ2hhbm5lbDogJyArIHVybCArICcgJyArIHJlcXVlc3QpO1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgQmVjYXVzZSBsaXN0ZW4gaXNuJ3QgZGVmaW5lZCBvbiBpdC5cclxuICAgICAgICB2YXIgY2hhbm5lbCA9IHdlYmNoYW5uZWxUcmFuc3BvcnQuY3JlYXRlV2ViQ2hhbm5lbCh1cmwsIHJlcXVlc3QpO1xyXG4gICAgICAgIC8vIFdlYkNoYW5uZWwgc3VwcG9ydHMgc2VuZGluZyB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBoYW5kc2hha2UgLSBzYXZpbmdcclxuICAgICAgICAvLyBhIG5ldHdvcmsgcm91bmQgdHJpcC4gSG93ZXZlciwgaXQgd2lsbCBoYXZlIHRvIGNhbGwgc2VuZCBpbiB0aGUgc2FtZVxyXG4gICAgICAgIC8vIEpTIGV2ZW50IGxvb3AgYXMgb3Blbi4gSW4gb3JkZXIgdG8gZW5mb3JjZSB0aGlzLCB3ZSBkZWxheSBhY3R1YWxseVxyXG4gICAgICAgIC8vIG9wZW5pbmcgdGhlIFdlYkNoYW5uZWwgdW50aWwgc2VuZCBpcyBjYWxsZWQuIFdoZXRoZXIgd2UgaGF2ZSBjYWxsZWRcclxuICAgICAgICAvLyBvcGVuIGlzIHRyYWNrZWQgd2l0aCB0aGlzIHZhcmlhYmxlLlxyXG4gICAgICAgIHZhciBvcGVuZWQgPSBmYWxzZTtcclxuICAgICAgICAvLyBBIGZsYWcgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHN0cmVhbSB3YXMgY2xvc2VkIChieSB1cyBvciB0aHJvdWdoIGFuXHJcbiAgICAgICAgLy8gZXJyb3IvY2xvc2UgZXZlbnQpIHRvIGF2b2lkIGRlbGl2ZXJpbmcgbXVsdGlwbGUgY2xvc2UgZXZlbnRzIG9yIHNlbmRpbmdcclxuICAgICAgICAvLyBvbiBhIGNsb3NlZCBzdHJlYW1cclxuICAgICAgICB2YXIgY2xvc2VkID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIHN0cmVhbUJyaWRnZSA9IG5ldyBTdHJlYW1CcmlkZ2Uoe1xyXG4gICAgICAgICAgICBzZW5kRm46IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICAgICAgICAgIGlmICghY2xvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvcGVuZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ09wZW5pbmcgV2ViQ2hhbm5lbCB0cmFuc3BvcnQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWwub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnV2ViQ2hhbm5lbCBzZW5kaW5nOicsIG1zZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbm5lbC5zZW5kKG1zZyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnTm90IHNlbmRpbmcgYmVjYXVzZSBXZWJDaGFubmVsIGlzIGNsb3NlZDonLCBtc2cpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjbG9zZUZuOiBmdW5jdGlvbiAoKSB7IHJldHVybiBjaGFubmVsLmNsb3NlKCk7IH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBDbG9zdXJlIGV2ZW50cyBhcmUgZ3VhcmRlZCBhbmQgZXhjZXB0aW9ucyBhcmUgc3dhbGxvd2VkLCBzbyBjYXRjaCBhbnlcclxuICAgICAgICAvLyBleGNlcHRpb24gYW5kIHJldGhyb3cgdXNpbmcgYSBzZXRUaW1lb3V0IHNvIHRoZXkgYmVjb21lIHZpc2libGUgYWdhaW4uXHJcbiAgICAgICAgLy8gTm90ZSB0aGF0IGV2ZW50dWFsbHkgdGhpcyBmdW5jdGlvbiBjb3VsZCBnbyBhd2F5IGlmIHdlIGFyZSBjb25maWRlbnRcclxuICAgICAgICAvLyBlbm91Z2ggdGhlIGNvZGUgaXMgZXhjZXB0aW9uIGZyZWUuXHJcbiAgICAgICAgdmFyIHVuZ3VhcmRlZEV2ZW50TGlzdGVuID0gZnVuY3Rpb24gKHR5cGUsIGZuKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogY2xvc3VyZSB0eXBpbmcgc2VlbXMgYnJva2VuIGJlY2F1c2UgV2ViQ2hhbm5lbCBkb2VzXHJcbiAgICAgICAgICAgIC8vIG5vdCBpbXBsZW1lbnQgZ29vZy5ldmVudHMuTGlzdGVuYWJsZVxyXG4gICAgICAgICAgICBjaGFubmVsLmxpc3Rlbih0eXBlLCBmdW5jdGlvbiAocGFyYW0pIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm4ocGFyYW0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB1bmd1YXJkZWRFdmVudExpc3Rlbih3ZWJjaGFubmVsV3JhcHBlci5XZWJDaGFubmVsLkV2ZW50VHlwZS5PUEVOLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghY2xvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnV2ViQ2hhbm5lbCB0cmFuc3BvcnQgb3BlbmVkLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdW5ndWFyZGVkRXZlbnRMaXN0ZW4od2ViY2hhbm5lbFdyYXBwZXIuV2ViQ2hhbm5lbC5FdmVudFR5cGUuQ0xPU0UsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCFjbG9zZWQpIHtcclxuICAgICAgICAgICAgICAgIGNsb3NlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHLCAnV2ViQ2hhbm5lbCB0cmFuc3BvcnQgY2xvc2VkJyk7XHJcbiAgICAgICAgICAgICAgICBzdHJlYW1CcmlkZ2UuY2FsbE9uQ2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHVuZ3VhcmRlZEV2ZW50TGlzdGVuKHdlYmNoYW5uZWxXcmFwcGVyLldlYkNoYW5uZWwuRXZlbnRUeXBlLkVSUk9SLCBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGlmICghY2xvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICBjbG9zZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1dlYkNoYW5uZWwgdHJhbnNwb3J0IGVycm9yZWQ6JywgZXJyKTtcclxuICAgICAgICAgICAgICAgIHN0cmVhbUJyaWRnZS5jYWxsT25DbG9zZShuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTkFWQUlMQUJMRSwgJ1RoZSBvcGVyYXRpb24gY291bGQgbm90IGJlIGNvbXBsZXRlZCcpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHVuZ3VhcmRlZEV2ZW50TGlzdGVuKHdlYmNoYW5uZWxXcmFwcGVyLldlYkNoYW5uZWwuRXZlbnRUeXBlLk1FU1NBR0UsIGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICAgICAgaWYgKCFjbG9zZWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtc2dEYXRhID0gbXNnLmRhdGFbMF07XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoISFtc2dEYXRhLCAnR290IGEgd2ViY2hhbm5lbCBtZXNzYWdlIHdpdGhvdXQgZGF0YS4nKTtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYi8zNTE0Mzg5MSk6IFRoZXJlIGlzIGEgYnVnIGluIE9uZSBQbGF0Zm9ybSB0aGF0IGNhdXNlZCBlcnJvcnNcclxuICAgICAgICAgICAgICAgIC8vIChhbmQgb25seSBlcnJvcnMpIHRvIGJlIHdyYXBwZWQgaW4gYW4gZXh0cmEgYXJyYXkuIFRvIGJlIGZvcndhcmRcclxuICAgICAgICAgICAgICAgIC8vIGNvbXBhdGlibGUgd2l0aCB0aGUgYnVnIHdlIG5lZWQgdG8gY2hlY2sgZWl0aGVyIGNvbmRpdGlvbi4gVGhlIGxhdHRlclxyXG4gICAgICAgICAgICAgICAgLy8gY2FuIGJlIHJlbW92ZWQgb25jZSB0aGUgZml4IGhhcyBiZWVuIHJvbGxlZCBvdXQuXHJcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IkJDEgPSBcclxuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgbXNnRGF0YS5lcnJvciBpcyBub3QgdHlwZWQuXHJcbiAgICAgICAgICAgICAgICBtc2dEYXRhLmVycm9yIHx8IChtc2dEYXRhWzBdICYmIG1zZ0RhdGFbMF0uZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRywgJ1dlYkNoYW5uZWwgcmVjZWl2ZWQgZXJyb3I6JywgZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGVycm9yLnN0YXR1cyB3aWxsIGJlIGEgc3RyaW5nIGxpa2UgJ09LJyBvciAnTk9UX0ZPVU5EJy5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdHVzXzIgPSBlcnJvciQkMS5zdGF0dXM7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSBtYXBDb2RlRnJvbVJwY1N0YXR1cyhzdGF0dXNfMik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBlcnJvciQkMS5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2RlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZSA9IENvZGUuSU5URVJOQUw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1Vua25vd24gZXJyb3Igc3RhdHVzOiAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNfMiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyB3aXRoIG1lc3NhZ2UgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IkJDEubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBjbG9zZWQgc28gbm8gZnVydGhlciBldmVudHMgYXJlIHByb3BhZ2F0ZWRcclxuICAgICAgICAgICAgICAgICAgICBjbG9zZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbUJyaWRnZS5jYWxsT25DbG9zZShuZXcgRmlyZXN0b3JlRXJyb3IoY29kZSwgbWVzc2FnZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5uZWwuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUcsICdXZWJDaGFubmVsIHJlY2VpdmVkOicsIG1zZ0RhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbUJyaWRnZS5jYWxsT25NZXNzYWdlKG1zZ0RhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIFRlY2huaWNhbGx5IHdlIGNvdWxkL3Nob3VsZCB3YWl0IGZvciB0aGUgV2ViQ2hhbm5lbCBvcGVuZWQgZXZlbnQsXHJcbiAgICAgICAgICAgIC8vIGJ1dCBiZWNhdXNlIHdlIHdhbnQgdG8gc2VuZCB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBXZWJDaGFubmVsXHJcbiAgICAgICAgICAgIC8vIGhhbmRzaGFrZSB3ZSBwcmV0ZW5kIHRoZSBjaGFubmVsIG9wZW5lZCBoZXJlIChhc3luY2hyb25vdXNseSksIGFuZFxyXG4gICAgICAgICAgICAvLyB0aGVuIGRlbGF5IHRoZSBhY3R1YWwgb3BlbiB1bnRpbCB0aGUgZmlyc3QgbWVzc2FnZSBpcyBzZW50LlxyXG4gICAgICAgICAgICBzdHJlYW1CcmlkZ2UuY2FsbE9uT3BlbigpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICAgIHJldHVybiBzdHJlYW1CcmlkZ2U7XHJcbiAgICB9O1xyXG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gICAgV2ViQ2hhbm5lbENvbm5lY3Rpb24ucHJvdG90eXBlLm1ha2VVcmwgPSBmdW5jdGlvbiAocnBjTmFtZSkge1xyXG4gICAgICAgIHZhciB1cmxScGNOYW1lID0gUlBDX05BTUVfUkVTVF9NQVBQSU5HW3JwY05hbWVdO1xyXG4gICAgICAgIGFzc2VydCh1cmxScGNOYW1lICE9PSB1bmRlZmluZWQsICdVbmtub3duIFJFU1QgbWFwcGluZyBmb3I6ICcgKyBycGNOYW1lKTtcclxuICAgICAgICB2YXIgdXJsID0gW3RoaXMuYmFzZVVybCwgJy8nLCBSUENfVVJMX1ZFUlNJT05dO1xyXG4gICAgICAgIHVybC5wdXNoKCcvcHJvamVjdHMvJyk7XHJcbiAgICAgICAgdXJsLnB1c2godGhpcy5kYXRhYmFzZUlkLnByb2plY3RJZCk7XHJcbiAgICAgICAgdXJsLnB1c2goJy9kYXRhYmFzZXMvJyk7XHJcbiAgICAgICAgdXJsLnB1c2godGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlKTtcclxuICAgICAgICB1cmwucHVzaCgnL2RvY3VtZW50cycpO1xyXG4gICAgICAgIHVybC5wdXNoKCc6Jyk7XHJcbiAgICAgICAgdXJsLnB1c2godXJsUnBjTmFtZSk7XHJcbiAgICAgICAgcmV0dXJuIHVybC5qb2luKCcnKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gV2ViQ2hhbm5lbENvbm5lY3Rpb247XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgQnJvd3NlclBsYXRmb3JtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQnJvd3NlclBsYXRmb3JtKCkge1xyXG4gICAgICAgIHRoaXMuZW1wdHlCeXRlU3RyaW5nID0gJyc7XHJcbiAgICAgICAgdGhpcy5iYXNlNjRBdmFpbGFibGUgPSB0eXBlb2YgYXRvYiAhPT0gJ3VuZGVmaW5lZCc7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnJvd3NlclBsYXRmb3JtLnByb3RvdHlwZSwgXCJkb2N1bWVudFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnID8gZG9jdW1lbnQgOiBudWxsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJyb3dzZXJQbGF0Zm9ybS5wcm90b3R5cGUsIFwid2luZG93XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogbnVsbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEJyb3dzZXJQbGF0Zm9ybS5wcm90b3R5cGUubG9hZENvbm5lY3Rpb24gPSBmdW5jdGlvbiAoZGF0YWJhc2VJbmZvKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgV2ViQ2hhbm5lbENvbm5lY3Rpb24oZGF0YWJhc2VJbmZvKSk7XHJcbiAgICB9O1xyXG4gICAgQnJvd3NlclBsYXRmb3JtLnByb3RvdHlwZS5uZXdTZXJpYWxpemVyID0gZnVuY3Rpb24gKGRhdGFiYXNlSWQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEpzb25Qcm90b1NlcmlhbGl6ZXIoZGF0YWJhc2VJZCwgeyB1c2VQcm90bzNKc29uOiB0cnVlIH0pO1xyXG4gICAgfTtcclxuICAgIEJyb3dzZXJQbGF0Zm9ybS5wcm90b3R5cGUuZm9ybWF0SlNPTiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgQnJvd3NlclBsYXRmb3JtLnByb3RvdHlwZS5hdG9iID0gZnVuY3Rpb24gKGVuY29kZWQpIHtcclxuICAgICAgICByZXR1cm4gYXRvYihlbmNvZGVkKTtcclxuICAgIH07XHJcbiAgICBCcm93c2VyUGxhdGZvcm0ucHJvdG90eXBlLmJ0b2EgPSBmdW5jdGlvbiAocmF3KSB7XHJcbiAgICAgICAgcmV0dXJuIGJ0b2EocmF3KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQnJvd3NlclBsYXRmb3JtO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoaXMgY29kZSBuZWVkcyB0byBydW4gYmVmb3JlIEZpcmVzdG9yZSBpcyB1c2VkLiBUaGlzIGNhbiBiZSBhY2hpZXZlZCBpblxyXG4gKiBzZXZlcmFsIHdheXM6XHJcbiAqICAgMSkgVGhyb3VnaCB0aGUgSlNDb21waWxlciBjb21waWxpbmcgdGhpcyBjb2RlIGFuZCB0aGVuIChhdXRvbWF0aWNhbGx5KVxyXG4gKiAgICAgIGV4ZWN1dGluZyBpdCBiZWZvcmUgZXhwb3J0aW5nIHRoZSBGaXJlc3RvcmUgc3ltYm9scy5cclxuICogICAyKSBUaHJvdWdoIGltcG9ydGluZyB0aGlzIG1vZHVsZSBmaXJzdCBpbiBhIEZpcmVzdG9yZSBtYWluIG1vZHVsZVxyXG4gKi9cclxuUGxhdGZvcm1TdXBwb3J0LnNldFBsYXRmb3JtKG5ldyBCcm93c2VyUGxhdGZvcm0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogYExpc3RlblNlcXVlbmNlYCBpcyBhIG1vbm90b25pYyBzZXF1ZW5jZS4gSXQgaXMgaW5pdGlhbGl6ZWQgd2l0aCBhIG1pbmltdW0gdmFsdWUgdG9cclxuICogZXhjZWVkLiBBbGwgc3Vic2VxdWVudCBjYWxscyB0byBuZXh0IHdpbGwgcmV0dXJuIGluY3JlYXNpbmcgdmFsdWVzLiBJZiBwcm92aWRlZCB3aXRoIGFcclxuICogYFNlcXVlbmNlTnVtYmVyU3luY2VyYCwgaXQgd2lsbCBhZGRpdGlvbmFsbHkgYnVtcCBpdHMgbmV4dCB2YWx1ZSB3aGVuIHRvbGQgb2YgYSBuZXcgdmFsdWUsIGFzXHJcbiAqIHdlbGwgYXMgd3JpdGUgb3V0IHNlcXVlbmNlIG51bWJlcnMgdGhhdCBpdCBwcm9kdWNlcyB2aWEgYG5leHQoKWAuXHJcbiAqL1xyXG52YXIgTGlzdGVuU2VxdWVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMaXN0ZW5TZXF1ZW5jZShwcmV2aW91c1ZhbHVlLCBzZXF1ZW5jZU51bWJlclN5bmNlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5wcmV2aW91c1ZhbHVlID0gcHJldmlvdXNWYWx1ZTtcclxuICAgICAgICBpZiAoc2VxdWVuY2VOdW1iZXJTeW5jZXIpIHtcclxuICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXJTeW5jZXIuc2VxdWVuY2VOdW1iZXJIYW5kbGVyID0gZnVuY3Rpb24gKHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc2V0UHJldmlvdXNWYWx1ZShzZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMud3JpdGVOZXdTZXF1ZW5jZU51bWJlciA9IGZ1bmN0aW9uIChzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlcXVlbmNlTnVtYmVyU3luY2VyLndyaXRlU2VxdWVuY2VOdW1iZXIoc2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIExpc3RlblNlcXVlbmNlLnByb3RvdHlwZS5zZXRQcmV2aW91c1ZhbHVlID0gZnVuY3Rpb24gKGV4dGVybmFsUHJldmlvdXNWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMucHJldmlvdXNWYWx1ZSA9IE1hdGgubWF4KGV4dGVybmFsUHJldmlvdXNWYWx1ZSwgdGhpcy5wcmV2aW91c1ZhbHVlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcmV2aW91c1ZhbHVlO1xyXG4gICAgfTtcclxuICAgIExpc3RlblNlcXVlbmNlLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBuZXh0VmFsdWUgPSArK3RoaXMucHJldmlvdXNWYWx1ZTtcclxuICAgICAgICBpZiAodGhpcy53cml0ZU5ld1NlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMud3JpdGVOZXdTZXF1ZW5jZU51bWJlcihuZXh0VmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV4dFZhbHVlO1xyXG4gICAgfTtcclxuICAgIExpc3RlblNlcXVlbmNlLklOVkFMSUQgPSAtMTtcclxuICAgIHJldHVybiBMaXN0ZW5TZXF1ZW5jZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBEZWZlcnJlZCQxID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVmZXJyZWQoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIF90aGlzLnJlc29sdmUgPSByZXNvbHZlO1xyXG4gICAgICAgICAgICBfdGhpcy5yZWplY3QgPSByZWplY3Q7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRGVmZXJyZWQ7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogV2VsbGtub3duIFwidGltZXJcIiBJRHMgdXNlZCB3aGVuIHNjaGVkdWxpbmcgZGVsYXllZCBvcGVyYXRpb25zIG9uIHRoZVxyXG4gKiBBc3luY1F1ZXVlLiBUaGVzZSBJRHMgY2FuIHRoZW4gYmUgdXNlZCBmcm9tIHRlc3RzIHRvIGNoZWNrIGZvciB0aGUgcHJlc2VuY2VcclxuICogb2Ygb3BlcmF0aW9ucyBvciB0byBydW4gdGhlbSBlYXJseS5cclxuICpcclxuICogVGhlIHN0cmluZyB2YWx1ZXMgYXJlIHVzZWQgd2hlbiBlbmNvZGluZyB0aGVzZSB0aW1lciBJRHMgaW4gSlNPTiBzcGVjIHRlc3RzLlxyXG4gKi9cclxudmFyIFRpbWVySWQ7XHJcbihmdW5jdGlvbiAoVGltZXJJZCkge1xyXG4gICAgLyoqIEFsbCBjYW4gYmUgdXNlZCB3aXRoIHJ1bkRlbGF5ZWRPcGVyYXRpb25zRWFybHkoKSB0byBydW4gYWxsIHRpbWVycy4gKi9cclxuICAgIFRpbWVySWRbXCJBbGxcIl0gPSBcImFsbFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgZm9sbG93aW5nIDQgdGltZXJzIGFyZSB1c2VkIGluIHBlcnNpc3RlbnRfc3RyZWFtLnRzIGZvciB0aGUgbGlzdGVuIGFuZFxyXG4gICAgICogd3JpdGUgc3RyZWFtcy4gVGhlIFwiSWRsZVwiIHRpbWVyIGlzIHVzZWQgdG8gY2xvc2UgdGhlIHN0cmVhbSBkdWUgdG9cclxuICAgICAqIGluYWN0aXZpdHkuIFRoZSBcIkNvbm5lY3Rpb25CYWNrb2ZmXCIgdGltZXIgaXMgdXNlZCB0byByZXN0YXJ0IGEgc3RyZWFtIG9uY2VcclxuICAgICAqIHRoZSBhcHByb3ByaWF0ZSBiYWNrb2ZmIGRlbGF5IGhhcyBlbGFwc2VkLlxyXG4gICAgICovXHJcbiAgICBUaW1lcklkW1wiTGlzdGVuU3RyZWFtSWRsZVwiXSA9IFwibGlzdGVuX3N0cmVhbV9pZGxlXCI7XHJcbiAgICBUaW1lcklkW1wiTGlzdGVuU3RyZWFtQ29ubmVjdGlvbkJhY2tvZmZcIl0gPSBcImxpc3Rlbl9zdHJlYW1fY29ubmVjdGlvbl9iYWNrb2ZmXCI7XHJcbiAgICBUaW1lcklkW1wiV3JpdGVTdHJlYW1JZGxlXCJdID0gXCJ3cml0ZV9zdHJlYW1faWRsZVwiO1xyXG4gICAgVGltZXJJZFtcIldyaXRlU3RyZWFtQ29ubmVjdGlvbkJhY2tvZmZcIl0gPSBcIndyaXRlX3N0cmVhbV9jb25uZWN0aW9uX2JhY2tvZmZcIjtcclxuICAgIC8qKlxyXG4gICAgICogQSB0aW1lciB1c2VkIGluIG9ubGluZV9zdGF0ZV90cmFja2VyLnRzIHRvIHRyYW5zaXRpb24gZnJvbVxyXG4gICAgICogT25saW5lU3RhdGUuVW5rbm93biB0byBPZmZsaW5lIGFmdGVyIGEgc2V0IHRpbWVvdXQsIHJhdGhlciB0aGFuIHdhaXRpbmdcclxuICAgICAqIGluZGVmaW5pdGVseSBmb3Igc3VjY2VzcyBvciBmYWlsdXJlLlxyXG4gICAgICovXHJcbiAgICBUaW1lcklkW1wiT25saW5lU3RhdGVUaW1lb3V0XCJdID0gXCJvbmxpbmVfc3RhdGVfdGltZW91dFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBBIHRpbWVyIHVzZWQgdG8gdXBkYXRlIHRoZSBjbGllbnQgbWV0YWRhdGEgaW4gSW5kZXhlZERiLCB3aGljaCBpcyB1c2VkXHJcbiAgICAgKiB0byBkZXRlcm1pbmUgdGhlIHByaW1hcnkgbGVhc2Vob2xkZXIuXHJcbiAgICAgKi9cclxuICAgIFRpbWVySWRbXCJDbGllbnRNZXRhZGF0YVJlZnJlc2hcIl0gPSBcImNsaWVudF9tZXRhZGF0YV9yZWZyZXNoXCI7XHJcbn0pKFRpbWVySWQgfHwgKFRpbWVySWQgPSB7fSkpO1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhbiBvcGVyYXRpb24gc2NoZWR1bGVkIHRvIGJlIHJ1biBpbiB0aGUgZnV0dXJlIG9uIGFuIEFzeW5jUXVldWUuXHJcbiAqXHJcbiAqIEl0IGlzIGNyZWF0ZWQgdmlhIERlbGF5ZWRPcGVyYXRpb24uY3JlYXRlQW5kU2NoZWR1bGUoKS5cclxuICpcclxuICogU3VwcG9ydHMgY2FuY2VsbGF0aW9uICh2aWEgY2FuY2VsKCkpIGFuZCBlYXJseSBleGVjdXRpb24gKHZpYSBza2lwRGVsYXkoKSkuXHJcbiAqL1xyXG52YXIgRGVsYXllZE9wZXJhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERlbGF5ZWRPcGVyYXRpb24oYXN5bmNRdWV1ZSwgdGltZXJJZCwgdGFyZ2V0VGltZU1zLCBvcCwgcmVtb3ZhbENhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gYXN5bmNRdWV1ZTtcclxuICAgICAgICB0aGlzLnRpbWVySWQgPSB0aW1lcklkO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0VGltZU1zID0gdGFyZ2V0VGltZU1zO1xyXG4gICAgICAgIHRoaXMub3AgPSBvcDtcclxuICAgICAgICB0aGlzLnJlbW92YWxDYWxsYmFjayA9IHJlbW92YWxDYWxsYmFjaztcclxuICAgICAgICB0aGlzLmRlZmVycmVkID0gbmV3IERlZmVycmVkJDEoKTtcclxuICAgICAgICB0aGlzLnRoZW4gPSB0aGlzLmRlZmVycmVkLnByb21pc2UudGhlbi5iaW5kKHRoaXMuZGVmZXJyZWQucHJvbWlzZSk7XHJcbiAgICAgICAgdGhpcy5jYXRjaCA9IHRoaXMuZGVmZXJyZWQucHJvbWlzZS5jYXRjaC5iaW5kKHRoaXMuZGVmZXJyZWQucHJvbWlzZSk7XHJcbiAgICAgICAgLy8gSXQncyBub3JtYWwgZm9yIHRoZSBkZWZlcnJlZCBwcm9taXNlIHRvIGJlIGNhbmNlbGVkIChkdWUgdG8gY2FuY2VsbGF0aW9uKVxyXG4gICAgICAgIC8vIGFuZCBzbyB3ZSBhdHRhY2ggYSBkdW1teSBjYXRjaCBjYWxsYmFjayB0byBhdm9pZFxyXG4gICAgICAgIC8vICdVbmhhbmRsZWRQcm9taXNlUmVqZWN0aW9uV2FybmluZycgbG9nIHNwYW0uXHJcbiAgICAgICAgdGhpcy5kZWZlcnJlZC5wcm9taXNlLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBEZWxheWVkT3BlcmF0aW9uIHRoYXQgaGFzIGJlZW4gc2NoZWR1bGVkIHRvIGJlXHJcbiAgICAgKiBleGVjdXRlZCBvbiB0aGUgcHJvdmlkZWQgYXN5bmNRdWV1ZSBhZnRlciB0aGUgcHJvdmlkZWQgZGVsYXlNcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXN5bmNRdWV1ZSBUaGUgcXVldWUgdG8gc2NoZWR1bGUgdGhlIG9wZXJhdGlvbiBvbi5cclxuICAgICAqIEBwYXJhbSBpZCBBIFRpbWVyIElEIGlkZW50aWZ5aW5nIHRoZSB0eXBlIG9mIG9wZXJhdGlvbiB0aGlzIGlzLlxyXG4gICAgICogQHBhcmFtIGRlbGF5TXMgVGhlIGRlbGF5IChtcykgYmVmb3JlIHRoZSBvcGVyYXRpb24gc2hvdWxkIGJlIHNjaGVkdWxlZC5cclxuICAgICAqIEBwYXJhbSBvcCBUaGUgb3BlcmF0aW9uIHRvIHJ1bi5cclxuICAgICAqIEBwYXJhbSByZW1vdmFsQ2FsbGJhY2sgQSBjYWxsYmFjayB0byBiZSBjYWxsZWQgc3luY2hyb25vdXNseSBvbmNlIHRoZVxyXG4gICAgICogICBvcGVyYXRpb24gaXMgZXhlY3V0ZWQgb3IgY2FuY2VsZWQsIG5vdGlmeWluZyB0aGUgQXN5bmNRdWV1ZSB0byByZW1vdmUgaXRcclxuICAgICAqICAgZnJvbSBpdHMgZGVsYXllZE9wZXJhdGlvbnMgbGlzdC5cclxuICAgICAqICAgUE9SVElORyBOT1RFOiBUaGlzIGV4aXN0cyB0byBwcmV2ZW50IG1ha2luZyByZW1vdmVEZWxheWVkT3BlcmF0aW9uKCkgYW5kXHJcbiAgICAgKiAgIHRoZSBEZWxheWVkT3BlcmF0aW9uIGNsYXNzIHB1YmxpYy5cclxuICAgICAqL1xyXG4gICAgRGVsYXllZE9wZXJhdGlvbi5jcmVhdGVBbmRTY2hlZHVsZSA9IGZ1bmN0aW9uIChhc3luY1F1ZXVlLCB0aW1lcklkLCBkZWxheU1zLCBvcCwgcmVtb3ZhbENhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldFRpbWUgPSBEYXRlLm5vdygpICsgZGVsYXlNcztcclxuICAgICAgICB2YXIgZGVsYXllZE9wID0gbmV3IERlbGF5ZWRPcGVyYXRpb24oYXN5bmNRdWV1ZSwgdGltZXJJZCwgdGFyZ2V0VGltZSwgb3AsIHJlbW92YWxDYWxsYmFjayk7XHJcbiAgICAgICAgZGVsYXllZE9wLnN0YXJ0KGRlbGF5TXMpO1xyXG4gICAgICAgIHJldHVybiBkZWxheWVkT3A7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdGFydHMgdGhlIHRpbWVyLiBUaGlzIGlzIGNhbGxlZCBpbW1lZGlhdGVseSBhZnRlciBjb25zdHJ1Y3Rpb24gYnlcclxuICAgICAqIGNyZWF0ZUFuZFNjaGVkdWxlKCkuXHJcbiAgICAgKi9cclxuICAgIERlbGF5ZWRPcGVyYXRpb24ucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKGRlbGF5TXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMudGltZXJIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmhhbmRsZURlbGF5RWxhcHNlZCgpOyB9LCBkZWxheU1zKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFF1ZXVlcyB0aGUgb3BlcmF0aW9uIHRvIHJ1biBpbW1lZGlhdGVseSAoaWYgaXQgaGFzbid0IGFscmVhZHkgYmVlbiBydW4gb3JcclxuICAgICAqIGNhbmNlbGVkKS5cclxuICAgICAqL1xyXG4gICAgRGVsYXllZE9wZXJhdGlvbi5wcm90b3R5cGUuc2tpcERlbGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhhbmRsZURlbGF5RWxhcHNlZCgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2FuY2VscyB0aGUgb3BlcmF0aW9uIGlmIGl0IGhhc24ndCBhbHJlYWR5IGJlZW4gZXhlY3V0ZWQgb3IgY2FuY2VsZWQuIFRoZVxyXG4gICAgICogcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkLlxyXG4gICAgICpcclxuICAgICAqIEFzIGxvbmcgYXMgdGhlIG9wZXJhdGlvbiBoYXMgbm90IHlldCBiZWVuIHJ1biwgY2FsbGluZyBjYW5jZWwoKSBwcm92aWRlcyBhXHJcbiAgICAgKiBndWFyYW50ZWUgdGhhdCB0aGUgb3BlcmF0aW9uIHdpbGwgbm90IGJlIHJ1bi5cclxuICAgICAqL1xyXG4gICAgRGVsYXllZE9wZXJhdGlvbi5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgIGlmICh0aGlzLnRpbWVySGFuZGxlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lb3V0KCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGVmZXJyZWQucmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkNBTkNFTExFRCwgJ09wZXJhdGlvbiBjYW5jZWxsZWQnICsgKHJlYXNvbiA/ICc6ICcgKyByZWFzb24gOiAnJykpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRGVsYXllZE9wZXJhdGlvbi5wcm90b3R5cGUuaGFuZGxlRGVsYXlFbGFwc2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMudGltZXJIYW5kbGUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNsZWFyVGltZW91dCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLm9wKCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmRlZmVycmVkLnJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRGVsYXllZE9wZXJhdGlvbi5wcm90b3R5cGUuY2xlYXJUaW1lb3V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnRpbWVySGFuZGxlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZhbENhbGxiYWNrKHRoaXMpO1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lckhhbmRsZSk7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXJIYW5kbGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gRGVsYXllZE9wZXJhdGlvbjtcclxufSgpKTtcclxudmFyIEFzeW5jUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBc3luY1F1ZXVlKCkge1xyXG4gICAgICAgIC8vIFRoZSBsYXN0IHByb21pc2UgaW4gdGhlIHF1ZXVlLlxyXG4gICAgICAgIHRoaXMudGFpbCA9IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIC8vIE9wZXJhdGlvbnMgc2NoZWR1bGVkIHRvIGJlIHF1ZXVlZCBpbiB0aGUgZnV0dXJlLiBPcGVyYXRpb25zIGFyZVxyXG4gICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZCBhZnRlciB0aGV5IGFyZSBydW4gb3IgY2FuY2VsZWQuXHJcbiAgICAgICAgdGhpcy5kZWxheWVkT3BlcmF0aW9ucyA9IFtdO1xyXG4gICAgICAgIC8vIEZsYWcgc2V0IHdoaWxlIHRoZXJlJ3MgYW4gb3V0c3RhbmRpbmcgQXN5bmNRdWV1ZSBvcGVyYXRpb24sIHVzZWQgZm9yXHJcbiAgICAgICAgLy8gYXNzZXJ0aW9uIHNhbml0eS1jaGVja3MuXHJcbiAgICAgICAgdGhpcy5vcGVyYXRpb25JblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgYSBuZXcgb3BlcmF0aW9uIHRvIHRoZSBxdWV1ZSB3aXRob3V0IHdhaXRpbmcgZm9yIGl0IHRvIGNvbXBsZXRlIChpLmUuXHJcbiAgICAgKiB3ZSBpZ25vcmUgdGhlIFByb21pc2UgcmVzdWx0KS5cclxuICAgICAqL1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUuZW5xdWV1ZUFuZEZvcmdldCA9IGZ1bmN0aW9uIChvcCkge1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgIHRoaXMuZW5xdWV1ZShvcCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgbmV3IG9wZXJhdGlvbiB0byB0aGUgcXVldWUuIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZFxyXG4gICAgICogd2hlbiB0aGUgcHJvbWlzZSByZXR1cm5lZCBieSB0aGUgbmV3IG9wZXJhdGlvbiBpcyAod2l0aCBpdHMgdmFsdWUpLlxyXG4gICAgICovXHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5lbnF1ZXVlID0gZnVuY3Rpb24gKG9wKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnZlcmlmeU5vdEZhaWxlZCgpO1xyXG4gICAgICAgIHZhciBuZXdUYWlsID0gdGhpcy50YWlsLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5vcGVyYXRpb25JblByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIG9wKClcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmZhaWx1cmUgPSBlcnJvciQkMTtcclxuICAgICAgICAgICAgICAgIF90aGlzLm9wZXJhdGlvbkluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gZXJyb3IkJDEuc3RhY2sgfHwgZXJyb3IkJDEubWVzc2FnZSB8fCAnJztcclxuICAgICAgICAgICAgICAgIGVycm9yKCdJTlRFUk5BTCBVTkhBTkRMRUQgRVJST1I6ICcsIG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgLy8gRXNjYXBlIHRoZSBwcm9taXNlIGNoYWluIGFuZCB0aHJvdyB0aGUgZXJyb3IgZ2xvYmFsbHkgc28gdGhhdFxyXG4gICAgICAgICAgICAgICAgLy8gZS5nLiBhbnkgZ2xvYmFsIGNyYXNoIHJlcG9ydGluZyBsaWJyYXJ5IGRldGVjdHMgYW5kIHJlcG9ydHMgaXQuXHJcbiAgICAgICAgICAgICAgICAvLyAoYnV0IG5vdCBmb3Igc2ltdWxhdGVkIGVycm9ycyBpbiBvdXIgdGVzdHMgc2luY2UgdGhpcyBicmVha3MgbW9jaGEpXHJcbiAgICAgICAgICAgICAgICBpZiAobWVzc2FnZS5pbmRleE9mKCdGaXJlc3RvcmUgVGVzdCBTaW11bGF0ZWQgRXJyb3InKSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3IkJDE7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBSZS10aHJvdyB0aGUgZXJyb3Igc28gdGhhdCB0aGlzLnRhaWwgYmVjb21lcyBhIHJlamVjdGVkIFByb21pc2UgYW5kXHJcbiAgICAgICAgICAgICAgICAvLyBhbGwgZnVydGhlciBhdHRlbXB0cyB0byBjaGFpbiAodmlhIC50aGVuKSB3aWxsIGp1c3Qgc2hvcnQtY2lyY3VpdFxyXG4gICAgICAgICAgICAgICAgLy8gYW5kIHJldHVybiB0aGUgcmVqZWN0ZWQgUHJvbWlzZS5cclxuICAgICAgICAgICAgICAgIHRocm93IGVycm9yJCQxO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub3BlcmF0aW9uSW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy50YWlsID0gbmV3VGFpbDtcclxuICAgICAgICByZXR1cm4gbmV3VGFpbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFNjaGVkdWxlcyBhbiBvcGVyYXRpb24gdG8gYmUgcXVldWVkIG9uIHRoZSBBc3luY1F1ZXVlIG9uY2UgdGhlIHNwZWNpZmllZFxyXG4gICAgICogYGRlbGF5TXNgIGhhcyBlbGFwc2VkLiBUaGUgcmV0dXJuZWQgQ2FuY2VsYWJsZVByb21pc2UgY2FuIGJlIHVzZWQgdG8gY2FuY2VsXHJcbiAgICAgKiB0aGUgb3BlcmF0aW9uIHByaW9yIHRvIGl0cyBydW5uaW5nLlxyXG4gICAgICovXHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS5lbnF1ZXVlQWZ0ZXJEZWxheSA9IGZ1bmN0aW9uICh0aW1lcklkLCBkZWxheU1zLCBvcCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlOb3RGYWlsZWQoKTtcclxuICAgICAgICBhc3NlcnQoZGVsYXlNcyA+PSAwLCBcIkF0dGVtcHRlZCB0byBzY2hlZHVsZSBhbiBvcGVyYXRpb24gd2l0aCBhIG5lZ2F0aXZlIGRlbGF5IG9mIFwiICsgZGVsYXlNcyk7XHJcbiAgICAgICAgLy8gV2hpbGUgbm90IG5lY2Vzc2FyaWx5IGhhcm1mdWwsIHdlIGN1cnJlbnRseSBkb24ndCBleHBlY3QgdG8gaGF2ZSBtdWx0aXBsZVxyXG4gICAgICAgIC8vIG9wcyB3aXRoIHRoZSBzYW1lIHRpbWVyIGlkIGluIHRoZSBxdWV1ZSwgc28gZGVmZW5zaXZlbHkgcmVqZWN0IHRoZW0uXHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLmNvbnRhaW5zRGVsYXllZE9wZXJhdGlvbih0aW1lcklkKSwgXCJBdHRlbXB0ZWQgdG8gc2NoZWR1bGUgbXVsdGlwbGUgb3BlcmF0aW9ucyB3aXRoIHRpbWVyIGlkIFwiICsgdGltZXJJZCArIFwiLlwiKTtcclxuICAgICAgICB2YXIgZGVsYXllZE9wID0gRGVsYXllZE9wZXJhdGlvbi5jcmVhdGVBbmRTY2hlZHVsZSh0aGlzLCB0aW1lcklkLCBkZWxheU1zLCBvcCwgZnVuY3Rpb24gKG9wKSB7IHJldHVybiBfdGhpcy5yZW1vdmVEZWxheWVkT3BlcmF0aW9uKG9wKTsgfSk7XHJcbiAgICAgICAgdGhpcy5kZWxheWVkT3BlcmF0aW9ucy5wdXNoKGRlbGF5ZWRPcCk7XHJcbiAgICAgICAgcmV0dXJuIGRlbGF5ZWRPcDtcclxuICAgIH07XHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS52ZXJpZnlOb3RGYWlsZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmFpbHVyZSkge1xyXG4gICAgICAgICAgICBmYWlsKCdBc3luY1F1ZXVlIGlzIGFscmVhZHkgZmFpbGVkOiAnICtcclxuICAgICAgICAgICAgICAgICh0aGlzLmZhaWx1cmUuc3RhY2sgfHwgdGhpcy5mYWlsdXJlLm1lc3NhZ2UpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBWZXJpZmllcyB0aGVyZSdzIGFuIG9wZXJhdGlvbiBjdXJyZW50bHkgaW4tcHJvZ3Jlc3Mgb24gdGhlIEFzeW5jUXVldWUuXHJcbiAgICAgKiBVbmZvcnR1bmF0ZWx5IHdlIGNhbid0IHZlcmlmeSB0aGF0IHRoZSBydW5uaW5nIGNvZGUgaXMgaW4gdGhlIHByb21pc2UgY2hhaW5cclxuICAgICAqIG9mIHRoYXQgb3BlcmF0aW9uLCBzbyB0aGlzIGlzbid0IGEgZm9vbHByb29mIGNoZWNrLCBidXQgaXQgc2hvdWxkIGJlIGVub3VnaFxyXG4gICAgICogdG8gY2F0Y2ggc29tZSBidWdzLlxyXG4gICAgICovXHJcbiAgICBBc3luY1F1ZXVlLnByb3RvdHlwZS52ZXJpZnlPcGVyYXRpb25JblByb2dyZXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLm9wZXJhdGlvbkluUHJvZ3Jlc3MsICd2ZXJpZnlPcEluUHJvZ3Jlc3MoKSBjYWxsZWQgd2hlbiBubyBvcCBpbiBwcm9ncmVzcyBvbiB0aGlzIHF1ZXVlLicpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBxdWV1ZWQgdGFza3MgYXJlIGZpbmlzaGVkIGV4ZWN1dGluZy4gRGVsYXllZFxyXG4gICAgICogb3BlcmF0aW9ucyBhcmUgbm90IHJ1bi5cclxuICAgICAqL1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUuZHJhaW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5xdWV1ZShmdW5jdGlvbiAoKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUoKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBGb3IgVGVzdHM6IERldGVybWluZSBpZiBhIGRlbGF5ZWQgb3BlcmF0aW9uIHdpdGggYSBwYXJ0aWN1bGFyIFRpbWVySWRcclxuICAgICAqIGV4aXN0cy5cclxuICAgICAqL1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUuY29udGFpbnNEZWxheWVkT3BlcmF0aW9uID0gZnVuY3Rpb24gKHRpbWVySWQpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5kZWxheWVkT3BlcmF0aW9uczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG9wID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBpZiAob3AudGltZXJJZCA9PT0gdGltZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogRm9yIFRlc3RzOiBSdW5zIHNvbWUgb3IgYWxsIGRlbGF5ZWQgb3BlcmF0aW9ucyBlYXJseS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbGFzdFRpbWVySWQgRGVsYXllZCBvcGVyYXRpb25zIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhpcyBUaW1lcklkIHdpbGxcclxuICAgICAqICBiZSBkcmFpbmVkLiBUaHJvd3MgaWYgbm8gc3VjaCBvcGVyYXRpb24gZXhpc3RzLiBQYXNzIFRpbWVySWQuQWxsIHRvIHJ1blxyXG4gICAgICogIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMuXHJcbiAgICAgKiBAcmV0dXJucyBhIFByb21pc2UgdGhhdCByZXNvbHZlcyBvbmNlIGFsbCBvcGVyYXRpb25zIGhhdmUgYmVlbiBydW4uXHJcbiAgICAgKi9cclxuICAgIEFzeW5jUXVldWUucHJvdG90eXBlLnJ1bkRlbGF5ZWRPcGVyYXRpb25zRWFybHkgPSBmdW5jdGlvbiAobGFzdFRpbWVySWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIE5vdGUgdGhhdCBkcmFpbmluZyBtYXkgZ2VuZXJhdGUgbW9yZSBkZWxheWVkIG9wcywgc28gd2UgZG8gdGhhdCBmaXJzdC5cclxuICAgICAgICByZXR1cm4gdGhpcy5kcmFpbigpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBhc3NlcnQobGFzdFRpbWVySWQgPT09IFRpbWVySWQuQWxsIHx8XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jb250YWluc0RlbGF5ZWRPcGVyYXRpb24obGFzdFRpbWVySWQpLCBcIkF0dGVtcHRlZCB0byBkcmFpbiB0byBtaXNzaW5nIG9wZXJhdGlvbiBcIiArIGxhc3RUaW1lcklkKTtcclxuICAgICAgICAgICAgLy8gUnVuIG9wcyBpbiB0aGUgc2FtZSBvcmRlciB0aGV5J2QgcnVuIGlmIHRoZXkgcmFuIG5hdHVyYWxseS5cclxuICAgICAgICAgICAgX3RoaXMuZGVsYXllZE9wZXJhdGlvbnMuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS50YXJnZXRUaW1lTXMgLSBiLnRhcmdldFRpbWVNczsgfSk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBfdGhpcy5kZWxheWVkT3BlcmF0aW9uczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBvcCA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIG9wLnNraXBEZWxheSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxhc3RUaW1lcklkICE9PSBUaW1lcklkLkFsbCAmJiBvcC50aW1lcklkID09PSBsYXN0VGltZXJJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5kcmFpbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBDYWxsZWQgb25jZSBhIERlbGF5ZWRPcGVyYXRpb24gaXMgcnVuIG9yIGNhbmNlbGVkLiAqL1xyXG4gICAgQXN5bmNRdWV1ZS5wcm90b3R5cGUucmVtb3ZlRGVsYXllZE9wZXJhdGlvbiA9IGZ1bmN0aW9uIChvcCkge1xyXG4gICAgICAgIC8vIE5PVEU6IGluZGV4T2YgLyBzbGljZSBhcmUgTyhuKSwgYnV0IGRlbGF5ZWRPcGVyYXRpb25zIGlzIGV4cGVjdGVkIHRvIGJlIHNtYWxsLlxyXG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuZGVsYXllZE9wZXJhdGlvbnMuaW5kZXhPZihvcCk7XHJcbiAgICAgICAgYXNzZXJ0KGluZGV4ID49IDAsICdEZWxheWVkIG9wZXJhdGlvbiBub3QgZm91bmQuJyk7XHJcbiAgICAgICAgdGhpcy5kZWxheWVkT3BlcmF0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBc3luY1F1ZXVlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIGVzY2FwZUNoYXIgPSAnXFx1MDAwMSc7XHJcbnZhciBlbmNvZGVkU2VwYXJhdG9yQ2hhciA9ICdcXHUwMDAxJztcclxudmFyIGVuY29kZWROdWwgPSAnXFx1MDAxMCc7XHJcbnZhciBlbmNvZGVkRXNjYXBlID0gJ1xcdTAwMTEnO1xyXG4vKipcclxuICogRW5jb2RlcyBhIHJlc291cmNlIHBhdGggaW50byBhIEluZGV4ZWREYi1jb21wYXRpYmxlIHN0cmluZyBmb3JtLlxyXG4gKi9cclxuZnVuY3Rpb24gZW5jb2RlKHBhdGgpIHtcclxuICAgIHZhciByZXN1bHQgPSAnJztcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGF0aC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBlbmNvZGVTZXBhcmF0b3IocmVzdWx0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmVzdWx0ID0gZW5jb2RlU2VnbWVudChwYXRoLmdldChpKSwgcmVzdWx0KTtcclxuICAgIH1cclxuICAgIHJldHVybiBlbmNvZGVTZXBhcmF0b3IocmVzdWx0KTtcclxufVxyXG4vKiogRW5jb2RlcyBhIHNpbmdsZSBzZWdtZW50IG9mIGEgcmVzb3VyY2UgcGF0aCBpbnRvIHRoZSBnaXZlbiByZXN1bHQgKi9cclxuZnVuY3Rpb24gZW5jb2RlU2VnbWVudChzZWdtZW50LCByZXN1bHRCdWYpIHtcclxuICAgIHZhciByZXN1bHQgPSByZXN1bHRCdWY7XHJcbiAgICB2YXIgbGVuZ3RoID0gc2VnbWVudC5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGMgPSBzZWdtZW50LmNoYXJBdChpKTtcclxuICAgICAgICBzd2l0Y2ggKGMpIHtcclxuICAgICAgICAgICAgY2FzZSAnXFwwJzpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBlc2NhcGVDaGFyICsgZW5jb2RlZE51bDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGVzY2FwZUNoYXI6XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgKz0gZXNjYXBlQ2hhciArIGVuY29kZWRFc2NhcGU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBjO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuLyoqIEVuY29kZXMgYSBwYXRoIHNlcGFyYXRvciBpbnRvIHRoZSBnaXZlbiByZXN1bHQgKi9cclxuZnVuY3Rpb24gZW5jb2RlU2VwYXJhdG9yKHJlc3VsdCkge1xyXG4gICAgcmV0dXJuIHJlc3VsdCArIGVzY2FwZUNoYXIgKyBlbmNvZGVkU2VwYXJhdG9yQ2hhcjtcclxufVxyXG4vKipcclxuICogRGVjb2RlcyB0aGUgZ2l2ZW4gSW5kZXhlZERiLWNvbXBhdGlibGUgc3RyaW5nIGZvcm0gb2YgYSByZXNvdXJjZSBwYXRoIGludG9cclxuICogYSBSZXNvdXJjZVBhdGggaW5zdGFuY2UuIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBpcyBub3Qgc3VpdGFibGUgZm9yIHVzZSB3aXRoXHJcbiAqIGRlY29kaW5nIHJlc291cmNlIG5hbWVzIGZyb20gdGhlIHNlcnZlcjsgdGhvc2UgYXJlIE9uZSBQbGF0Zm9ybSBmb3JtYXRcclxuICogc3RyaW5ncy5cclxuICovXHJcbmZ1bmN0aW9uIGRlY29kZSQxKHBhdGgpIHtcclxuICAgIC8vIEV2ZW50IHRoZSBlbXB0eSBwYXRoIG11c3QgZW5jb2RlIGFzIGEgcGF0aCBvZiBhdCBsZWFzdCBsZW5ndGggMi4gQSBwYXRoXHJcbiAgICAvLyB3aXRoIGV4YWN0bHkgMiBtdXN0IGJlIHRoZSBlbXB0eSBwYXRoLlxyXG4gICAgdmFyIGxlbmd0aCA9IHBhdGgubGVuZ3RoO1xyXG4gICAgYXNzZXJ0KGxlbmd0aCA+PSAyLCAnSW52YWxpZCBwYXRoICcgKyBwYXRoKTtcclxuICAgIGlmIChsZW5ndGggPT09IDIpIHtcclxuICAgICAgICBhc3NlcnQocGF0aC5jaGFyQXQoMCkgPT09IGVzY2FwZUNoYXIgJiYgcGF0aC5jaGFyQXQoMSkgPT09IGVuY29kZWRTZXBhcmF0b3JDaGFyLCAnTm9uLWVtcHR5IHBhdGggJyArIHBhdGggKyAnIGhhZCBsZW5ndGggMicpO1xyXG4gICAgICAgIHJldHVybiBSZXNvdXJjZVBhdGguRU1QVFlfUEFUSDtcclxuICAgIH1cclxuICAgIC8vIEVzY2FwZSBjaGFyYWN0ZXJzIGNhbm5vdCBleGlzdCBwYXN0IHRoZSBzZWNvbmQtdG8tbGFzdCBwb3NpdGlvbiBpbiB0aGVcclxuICAgIC8vIHNvdXJjZSB2YWx1ZS5cclxuICAgIHZhciBsYXN0UmVhc29uYWJsZUVzY2FwZUluZGV4ID0gbGVuZ3RoIC0gMjtcclxuICAgIHZhciBzZWdtZW50cyA9IFtdO1xyXG4gICAgdmFyIHNlZ21lbnRCdWlsZGVyID0gJyc7XHJcbiAgICBmb3IgKHZhciBzdGFydCA9IDA7IHN0YXJ0IDwgbGVuZ3RoOykge1xyXG4gICAgICAgIC8vIFRoZSBsYXN0IHR3byBjaGFyYWN0ZXJzIG9mIGEgdmFsaWQgZW5jb2RlZCBwYXRoIG11c3QgYmUgYSBzZXBhcmF0b3IsIHNvXHJcbiAgICAgICAgLy8gdGhlcmUgbXVzdCBiZSBhbiBlbmQgdG8gdGhpcyBzZWdtZW50LlxyXG4gICAgICAgIHZhciBlbmQgPSBwYXRoLmluZGV4T2YoZXNjYXBlQ2hhciwgc3RhcnQpO1xyXG4gICAgICAgIGlmIChlbmQgPCAwIHx8IGVuZCA+IGxhc3RSZWFzb25hYmxlRXNjYXBlSW5kZXgpIHtcclxuICAgICAgICAgICAgZmFpbCgnSW52YWxpZCBlbmNvZGVkIHJlc291cmNlIHBhdGg6IFwiJyArIHBhdGggKyAnXCInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG5leHQgPSBwYXRoLmNoYXJBdChlbmQgKyAxKTtcclxuICAgICAgICBzd2l0Y2ggKG5leHQpIHtcclxuICAgICAgICAgICAgY2FzZSBlbmNvZGVkU2VwYXJhdG9yQ2hhcjpcclxuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50UGllY2UgPSBwYXRoLnN1YnN0cmluZyhzdGFydCwgZW5kKTtcclxuICAgICAgICAgICAgICAgIHZhciBzZWdtZW50ID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlZ21lbnRCdWlsZGVyLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEF2b2lkIGNvcHlpbmcgZm9yIHRoZSBjb21tb24gY2FzZSBvZiBhIHNlZ21lbnQgdGhhdCBleGNsdWRlcyBcXDBcclxuICAgICAgICAgICAgICAgICAgICAvLyBhbmQgXFwwMDFcclxuICAgICAgICAgICAgICAgICAgICBzZWdtZW50ID0gY3VycmVudFBpZWNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudEJ1aWxkZXIgKz0gY3VycmVudFBpZWNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnQgPSBzZWdtZW50QnVpbGRlcjtcclxuICAgICAgICAgICAgICAgICAgICBzZWdtZW50QnVpbGRlciA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VnbWVudHMucHVzaChzZWdtZW50KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIGVuY29kZWROdWw6XHJcbiAgICAgICAgICAgICAgICBzZWdtZW50QnVpbGRlciArPSBwYXRoLnN1YnN0cmluZyhzdGFydCwgZW5kKTtcclxuICAgICAgICAgICAgICAgIHNlZ21lbnRCdWlsZGVyICs9ICdcXDAnO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgZW5jb2RlZEVzY2FwZTpcclxuICAgICAgICAgICAgICAgIC8vIFRoZSBlc2NhcGUgY2hhcmFjdGVyIGNhbiBiZSB1c2VkIGluIHRoZSBvdXRwdXQgdG8gZW5jb2RlIGl0c2VsZi5cclxuICAgICAgICAgICAgICAgIHNlZ21lbnRCdWlsZGVyICs9IHBhdGguc3Vic3RyaW5nKHN0YXJ0LCBlbmQgKyAxKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgZmFpbCgnSW52YWxpZCBlbmNvZGVkIHJlc291cmNlIHBhdGg6IFwiJyArIHBhdGggKyAnXCInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3RhcnQgPSBlbmQgKyAyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBSZXNvdXJjZVBhdGgoc2VnbWVudHMpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgQkFUQ0hJRF9VTktOT1dOID0gLTE7XHJcbi8qKlxyXG4gKiBBIGJhdGNoIG9mIG11dGF0aW9ucyB0aGF0IHdpbGwgYmUgc2VudCBhcyBvbmUgdW5pdCB0byB0aGUgYmFja2VuZC5cclxuICovXHJcbnZhciBNdXRhdGlvbkJhdGNoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTXV0YXRpb25CYXRjaChiYXRjaElkLCBsb2NhbFdyaXRlVGltZSwgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5iYXRjaElkID0gYmF0Y2hJZDtcclxuICAgICAgICB0aGlzLmxvY2FsV3JpdGVUaW1lID0gbG9jYWxXcml0ZVRpbWU7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvbnMgPSBtdXRhdGlvbnM7XHJcbiAgICAgICAgYXNzZXJ0KG11dGF0aW9ucy5sZW5ndGggPiAwLCAnQ2Fubm90IGNyZWF0ZSBhbiBlbXB0eSBtdXRhdGlvbiBiYXRjaCcpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBsaWVzIGFsbCB0aGUgbXV0YXRpb25zIGluIHRoaXMgTXV0YXRpb25CYXRjaCB0byB0aGUgc3BlY2lmaWVkIGRvY3VtZW50XHJcbiAgICAgKiB0byBjcmVhdGUgYSBuZXcgcmVtb3RlIGRvY3VtZW50XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRvY0tleSBUaGUga2V5IG9mIHRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXHJcbiAgICAgKiBAcGFyYW0gbWF5YmVEb2MgVGhlIGRvY3VtZW50IHRvIGFwcGx5IG11dGF0aW9ucyB0by5cclxuICAgICAqIEBwYXJhbSBiYXRjaFJlc3VsdCBUaGUgcmVzdWx0IG9mIGFwcGx5aW5nIHRoZSBNdXRhdGlvbkJhdGNoIHRvIHRoZVxyXG4gICAgICogYmFja2VuZC5cclxuICAgICAqL1xyXG4gICAgTXV0YXRpb25CYXRjaC5wcm90b3R5cGUuYXBwbHlUb1JlbW90ZURvY3VtZW50ID0gZnVuY3Rpb24gKGRvY0tleSwgbWF5YmVEb2MsIGJhdGNoUmVzdWx0KSB7XHJcbiAgICAgICAgaWYgKG1heWJlRG9jKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChtYXliZURvYy5rZXkuaXNFcXVhbChkb2NLZXkpLCBcImFwcGx5VG9SZW1vdGVEb2N1bWVudDoga2V5IFwiICsgZG9jS2V5ICsgXCIgc2hvdWxkIG1hdGNoIG1heWJlRG9jIGtleVxcbiAgICAgICAgXCIgKyBtYXliZURvYy5rZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbXV0YXRpb25SZXN1bHRzID0gYmF0Y2hSZXN1bHQubXV0YXRpb25SZXN1bHRzO1xyXG4gICAgICAgIGFzc2VydChtdXRhdGlvblJlc3VsdHMubGVuZ3RoID09PSB0aGlzLm11dGF0aW9ucy5sZW5ndGgsIFwiTWlzbWF0Y2ggYmV0d2VlbiBtdXRhdGlvbnMgbGVuZ3RoXFxuICAgICAgKFwiICsgdGhpcy5tdXRhdGlvbnMubGVuZ3RoICsgXCIpIGFuZCBtdXRhdGlvbiByZXN1bHRzIGxlbmd0aFxcbiAgICAgIChcIiArIG11dGF0aW9uUmVzdWx0cy5sZW5ndGggKyBcIikuXCIpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tdXRhdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gdGhpcy5tdXRhdGlvbnNbaV07XHJcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbi5rZXkuaXNFcXVhbChkb2NLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbXV0YXRpb25SZXN1bHQgPSBtdXRhdGlvblJlc3VsdHNbaV07XHJcbiAgICAgICAgICAgICAgICBtYXliZURvYyA9IG11dGF0aW9uLmFwcGx5VG9SZW1vdGVEb2N1bWVudChtYXliZURvYywgbXV0YXRpb25SZXN1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtYXliZURvYztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENvbXB1dGVzIHRoZSBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQgZ2l2ZW4gYWxsIHRoZSBtdXRhdGlvbnMgaW4gdGhpc1xyXG4gICAgICogYmF0Y2guXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRvY0tleSBUaGUga2V5IG9mIHRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXHJcbiAgICAgKiBAcGFyYW0gbWF5YmVEb2MgVGhlIGRvY3VtZW50IHRvIGFwcGx5IG11dGF0aW9ucyB0by5cclxuICAgICAqL1xyXG4gICAgTXV0YXRpb25CYXRjaC5wcm90b3R5cGUuYXBwbHlUb0xvY2FsVmlldyA9IGZ1bmN0aW9uIChkb2NLZXksIG1heWJlRG9jKSB7XHJcbiAgICAgICAgaWYgKG1heWJlRG9jKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChtYXliZURvYy5rZXkuaXNFcXVhbChkb2NLZXkpLCBcImFwcGx5VG9Mb2NhbERvY3VtZW50OiBrZXkgXCIgKyBkb2NLZXkgKyBcIiBzaG91bGQgbWF0Y2ggbWF5YmVEb2Mga2V5XFxuICAgICAgICBcIiArIG1heWJlRG9jLmtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBiYXNlRG9jID0gbWF5YmVEb2M7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm11dGF0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgbXV0YXRpb24gPSB0aGlzLm11dGF0aW9uc1tpXTtcclxuICAgICAgICAgICAgaWYgKG11dGF0aW9uLmtleS5pc0VxdWFsKGRvY0tleSkpIHtcclxuICAgICAgICAgICAgICAgIG1heWJlRG9jID0gbXV0YXRpb24uYXBwbHlUb0xvY2FsVmlldyhtYXliZURvYywgYmFzZURvYywgdGhpcy5sb2NhbFdyaXRlVGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1heWJlRG9jO1xyXG4gICAgfTtcclxuICAgIE11dGF0aW9uQmF0Y2gucHJvdG90eXBlLmtleXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGtleVNldCA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMubXV0YXRpb25zOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgbXV0YXRpb24gPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGtleVNldCA9IGtleVNldC5hZGQobXV0YXRpb24ua2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGtleVNldDtcclxuICAgIH07XHJcbiAgICBNdXRhdGlvbkJhdGNoLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmJhdGNoSWQgPT09IG90aGVyLmJhdGNoSWQgJiZcclxuICAgICAgICAgICAgYXJyYXlFcXVhbHModGhpcy5tdXRhdGlvbnMsIG90aGVyLm11dGF0aW9ucykpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNdXRhdGlvbkJhdGNoO1xyXG59KCkpO1xyXG4vKiogVGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIG11dGF0aW9uIGJhdGNoIHRvIHRoZSBiYWNrZW5kLiAqL1xyXG52YXIgTXV0YXRpb25CYXRjaFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE11dGF0aW9uQmF0Y2hSZXN1bHQoYmF0Y2gsIGNvbW1pdFZlcnNpb24sIG11dGF0aW9uUmVzdWx0cywgc3RyZWFtVG9rZW4sIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHByZS1jb21wdXRlZCBtYXBwaW5nIGZyb20gZWFjaCBtdXRhdGVkIGRvY3VtZW50IHRvIHRoZSByZXN1bHRpbmdcclxuICAgICAqIHZlcnNpb24uXHJcbiAgICAgKi9cclxuICAgIGRvY1ZlcnNpb25zKSB7XHJcbiAgICAgICAgdGhpcy5iYXRjaCA9IGJhdGNoO1xyXG4gICAgICAgIHRoaXMuY29tbWl0VmVyc2lvbiA9IGNvbW1pdFZlcnNpb247XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlc3VsdHMgPSBtdXRhdGlvblJlc3VsdHM7XHJcbiAgICAgICAgdGhpcy5zdHJlYW1Ub2tlbiA9IHN0cmVhbVRva2VuO1xyXG4gICAgICAgIHRoaXMuZG9jVmVyc2lvbnMgPSBkb2NWZXJzaW9ucztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIG5ldyBNdXRhdGlvbkJhdGNoUmVzdWx0IGZvciB0aGUgZ2l2ZW4gYmF0Y2ggYW5kIHJlc3VsdHMuIFRoZXJlXHJcbiAgICAgKiBtdXN0IGJlIG9uZSByZXN1bHQgZm9yIGVhY2ggbXV0YXRpb24gaW4gdGhlIGJhdGNoLiBUaGlzIHN0YXRpYyBmYWN0b3J5XHJcbiAgICAgKiBjYWNoZXMgYSBkb2N1bWVudD0+dmVyc2lvbiBtYXBwaW5nIChkb2NWZXJzaW9ucykuXHJcbiAgICAgKi9cclxuICAgIE11dGF0aW9uQmF0Y2hSZXN1bHQuZnJvbSA9IGZ1bmN0aW9uIChiYXRjaCwgY29tbWl0VmVyc2lvbiwgcmVzdWx0cywgc3RyZWFtVG9rZW4pIHtcclxuICAgICAgICBhc3NlcnQoYmF0Y2gubXV0YXRpb25zLmxlbmd0aCA9PT0gcmVzdWx0cy5sZW5ndGgsICdNdXRhdGlvbnMgc2VudCAnICtcclxuICAgICAgICAgICAgYmF0Y2gubXV0YXRpb25zLmxlbmd0aCArXHJcbiAgICAgICAgICAgICcgbXVzdCBlcXVhbCByZXN1bHRzIHJlY2VpdmVkICcgK1xyXG4gICAgICAgICAgICByZXN1bHRzLmxlbmd0aCk7XHJcbiAgICAgICAgdmFyIHZlcnNpb25NYXAgPSBkb2N1bWVudFZlcnNpb25NYXAoKTtcclxuICAgICAgICB2YXIgbXV0YXRpb25zID0gYmF0Y2gubXV0YXRpb25zO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbXV0YXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZlcnNpb25NYXAgPSB2ZXJzaW9uTWFwLmluc2VydChtdXRhdGlvbnNbaV0ua2V5LCByZXN1bHRzW2ldLnZlcnNpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IE11dGF0aW9uQmF0Y2hSZXN1bHQoYmF0Y2gsIGNvbW1pdFZlcnNpb24sIHJlc3VsdHMsIHN0cmVhbVRva2VuLCB2ZXJzaW9uTWFwKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTXV0YXRpb25CYXRjaFJlc3VsdDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQZXJzaXN0ZW5jZVByb21pc2U8PiBpcyBlc3NlbnRpYWxseSBhIHJlLWltcGxlbWVudGF0aW9uIG9mIFByb21pc2U8PiBleGNlcHRcclxuICogaXQgaGFzIGEgLm5leHQoKSBtZXRob2QgaW5zdGVhZCBvZiAudGhlbigpIGFuZCAubmV4dCgpIGFuZCAuY2F0Y2goKSBjYWxsYmFja3NcclxuICogYXJlIGV4ZWN1dGVkIHN5bmNocm9ub3VzbHkgd2hlbiBhIFBlcnNpc3RlbmNlUHJvbWlzZSByZXNvbHZlcyByYXRoZXIgdGhhblxyXG4gKiBhc3luY2hyb25vdXNseSAoUHJvbWlzZTw+IGltcGxlbWVudGF0aW9ucyB1c2Ugc2V0SW1tZWRpYXRlKCkgb3Igc2ltaWxhcikuXHJcbiAqXHJcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IHRvIGludGVyb3BlcmF0ZSB3aXRoIEluZGV4ZWREQiB3aGljaCB3aWxsIGF1dG9tYXRpY2FsbHlcclxuICogY29tbWl0IHRyYW5zYWN0aW9ucyBpZiBjb250cm9sIGlzIHJldHVybmVkIHRvIHRoZSBldmVudCBsb29wIHdpdGhvdXRcclxuICogc3luY2hyb25vdXNseSBpbml0aWF0aW5nIGFub3RoZXIgb3BlcmF0aW9uIG9uIHRoZSB0cmFuc2FjdGlvbi5cclxuICpcclxuICogTk9URTogLnRoZW4oKSBhbmQgLmNhdGNoKCkgb25seSBhbGxvdyBhIHNpbmdsZSBjb25zdW1lciwgdW5saWtlIG5vcm1hbFxyXG4gKiBQcm9taXNlcy5cclxuICovXHJcbnZhciBQZXJzaXN0ZW5jZVByb21pc2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQZXJzaXN0ZW5jZVByb21pc2UoY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIE5PVEU6IG5leHQvY2F0Y2hDYWxsYmFjayB3aWxsIGFsd2F5cyBwb2ludCB0byBvdXIgb3duIHdyYXBwZXIgZnVuY3Rpb25zLFxyXG4gICAgICAgIC8vIG5vdCB0aGUgdXNlcidzIHJhdyBuZXh0KCkgb3IgY2F0Y2goKSBjYWxsYmFja3MuXHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueSBBY2NlcHQgYW55IHJlc3VsdCB0eXBlIGZvciB0aGUgbmV4dCBjYWxsIGluIHRoZSBQcm9taXNlIGNoYWluLlxyXG4gICAgICAgIHRoaXMubmV4dENhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IEFjY2VwdCBhbnkgcmVzdWx0IHR5cGUgZm9yIHRoZSBlcnJvciBoYW5kbGVyLlxyXG4gICAgICAgIHRoaXMuY2F0Y2hDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgLy8gV2hlbiB0aGUgb3BlcmF0aW9uIHJlc29sdmVzLCB3ZSdsbCBzZXQgcmVzdWx0IG9yIGVycm9yIGFuZCBtYXJrIGlzRG9uZS5cclxuICAgICAgICB0aGlzLnJlc3VsdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLmVycm9yID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuaXNEb25lID0gZmFsc2U7XHJcbiAgICAgICAgLy8gU2V0IHRvIHRydWUgd2hlbiAudGhlbigpIG9yIC5jYXRjaCgpIGFyZSBjYWxsZWQgYW5kIHByZXZlbnRzIGFkZGl0aW9uYWxcclxuICAgICAgICAvLyBjaGFpbmluZy5cclxuICAgICAgICB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgPSBmYWxzZTtcclxuICAgICAgICBjYWxsYmFjayhmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgX3RoaXMuaXNEb25lID0gdHJ1ZTtcclxuICAgICAgICAgICAgX3RoaXMucmVzdWx0ID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5uZXh0Q2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIC8vIHZhbHVlIHNob3VsZCBiZSBkZWZpbmVkIHVubGVzcyBUIGlzIFZvaWQsIGJ1dCB3ZSBjYW4ndCBleHByZXNzXHJcbiAgICAgICAgICAgICAgICAvLyB0aGF0IGluIHRoZSB0eXBlIHN5c3RlbS5cclxuICAgICAgICAgICAgICAgIF90aGlzLm5leHRDYWxsYmFjayh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgX3RoaXMuaXNEb25lID0gdHJ1ZTtcclxuICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvcjtcclxuICAgICAgICAgICAgaWYgKF90aGlzLmNhdGNoQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNhdGNoQ2FsbGJhY2soZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmV4dCh1bmRlZmluZWQsIGZuKTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAobmV4dEZuLCBjYXRjaEZuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja0F0dGFjaGVkKSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ0NhbGxlZCBuZXh0KCkgb3IgY2F0Y2goKSB0d2ljZSBmb3IgUGVyc2lzdGVuY2VQcm9taXNlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tBdHRhY2hlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEb25lKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMud3JhcFN1Y2Nlc3MobmV4dEZuLCB0aGlzLnJlc3VsdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53cmFwRmFpbHVyZShjYXRjaEZuLCB0aGlzLmVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubmV4dENhbGxiYWNrID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMud3JhcFN1Y2Nlc3MobmV4dEZuLCB2YWx1ZSkubmV4dChyZXNvbHZlLCByZWplY3QpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNhdGNoQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy53cmFwRmFpbHVyZShjYXRjaEZuLCBlcnJvcikubmV4dChyZXNvbHZlLCByZWplY3QpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5wcm90b3R5cGUudG9Qcm9taXNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgX3RoaXMubmV4dChyZXNvbHZlLCByZWplY3QpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5wcm90b3R5cGUud3JhcFVzZXJGdW5jdGlvbiA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBmbigpO1xyXG4gICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgUGVyc2lzdGVuY2VQcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZWplY3QoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5wcm90b3R5cGUud3JhcFN1Y2Nlc3MgPSBmdW5jdGlvbiAobmV4dEZuLCB2YWx1ZSkge1xyXG4gICAgICAgIGlmIChuZXh0Rm4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMud3JhcFVzZXJGdW5jdGlvbihmdW5jdGlvbiAoKSB7IHJldHVybiBuZXh0Rm4odmFsdWUpOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gbmV4dEZuLCB0aGVuIFIgbXVzdCBiZSB0aGUgc2FtZSBhcyBUIGJ1dCB3ZVxyXG4gICAgICAgICAgICAvLyBjYW4ndCBleHByZXNzIHRoYXQgaW4gdGhlIHR5cGUgc3lzdGVtLlxyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbmNlUHJvbWlzZS5wcm90b3R5cGUud3JhcEZhaWx1cmUgPSBmdW5jdGlvbiAoY2F0Y2hGbiwgZXJyb3IpIHtcclxuICAgICAgICBpZiAoY2F0Y2hGbikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy53cmFwVXNlckZ1bmN0aW9uKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNhdGNoRm4oZXJyb3IpOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUgPSBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLnJlamVjdCA9IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvciA9IGZ1bmN0aW9uIChcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgQWNjZXB0IGFsbCBQcm9taXNlIHR5cGVzIGluIHdhaXRGb3IoKS5cclxuICAgIGFsbCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgdmFyIGV4cGVjdGVkQ291bnQgPSAwO1xyXG4gICAgICAgICAgICB2YXIgcmVzb2x2ZWRDb3VudCA9IDA7XHJcbiAgICAgICAgICAgIHZhciBkb25lID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGFsbC5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICArK2V4cGVjdGVkQ291bnQ7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50Lm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICsrcmVzb2x2ZWRDb3VudDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9uZSAmJiByZXNvbHZlZENvdW50ID09PSBleHBlY3RlZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7IHJldHVybiByZWplY3QoZXJyKTsgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBkb25lID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHJlc29sdmVkQ291bnQgPT09IGV4cGVjdGVkQ291bnQpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogR2l2ZW4gYW4gYXJyYXkgb2YgcHJlZGljYXRlIGZ1bmN0aW9ucyB0aGF0IGFzeW5jaHJvbm91c2x5IGV2YWx1YXRlIHRvIGFcclxuICAgICAqIGJvb2xlYW4sIGltcGxlbWVudHMgYSBzaG9ydC1jaXJjdWl0aW5nIGBvcmAgYmV0d2VlbiB0aGUgcmVzdWx0cy4gUHJlZGljYXRlc1xyXG4gICAgICogd2lsbCBiZSBldmFsdWF0ZWQgdW50aWwgb25lIG9mIHRoZW0gcmV0dXJucyBgdHJ1ZWAsIHRoZW4gc3RvcC4gVGhlIGZpbmFsXHJcbiAgICAgKiByZXN1bHQgd2lsbCBiZSB3aGV0aGVyIGFueSBvZiB0aGVtIHJldHVybmVkIGB0cnVlYC5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVuY2VQcm9taXNlLm9yID0gZnVuY3Rpb24gKHByZWRpY2F0ZXMpIHtcclxuICAgICAgICB2YXIgcCA9IFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcclxuICAgICAgICAgICAgcCA9IHAubmV4dChmdW5jdGlvbiAoaXNUcnVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNUcnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGlzVHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlZGljYXRlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBwcmVkaWNhdGVzXzEgPSBwcmVkaWNhdGVzOyBfaSA8IHByZWRpY2F0ZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHByZWRpY2F0ZSA9IHByZWRpY2F0ZXNfMVtfaV07XHJcbiAgICAgICAgICAgIF9sb29wXzEocHJlZGljYXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHA7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHaXZlbiBhbiBpdGVyYWJsZSwgY2FsbCB0aGUgZ2l2ZW4gZnVuY3Rpb24gb24gZWFjaCBlbGVtZW50IGluIHRoZVxyXG4gICAgICogY29sbGVjdGlvbiBhbmQgd2FpdCBmb3IgYWxsIG9mIHRoZSByZXN1bHRpbmcgY29uY3VycmVudCBQZXJzaXN0ZW5jZVByb21pc2VzXHJcbiAgICAgKiB0byByZXNvbHZlLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uLCBmKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICBjb2xsZWN0aW9uLmZvckVhY2goZnVuY3Rpb24gKHIsIHMpIHtcclxuICAgICAgICAgICAgcHJvbWlzZXMucHVzaChmLmNhbGwoX3RoaXMsIHIsIHMpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy53YWl0Rm9yKHByb21pc2VzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgbWFwIGltcGxlbWVudGF0aW9uIHRoYXQgdXNlcyBvYmplY3RzIGFzIGtleXMuIE9iamVjdHMgbXVzdCBpbXBsZW1lbnQgdGhlXHJcbiAqIEVxdWF0YWJsZSBpbnRlcmZhY2UgYW5kIG11c3QgYmUgaW1tdXRhYmxlLiBFbnRyaWVzIGluIHRoZSBtYXAgYXJlIHN0b3JlZFxyXG4gKiB0b2dldGhlciB3aXRoIHRoZSBrZXkgYmVpbmcgcHJvZHVjZWQgZnJvbSB0aGUgbWFwS2V5Rm4uIFRoaXMgbWFwXHJcbiAqIGF1dG9tYXRpY2FsbHkgaGFuZGxlcyBjb2xsaXNpb25zIG9mIGtleXMuXHJcbiAqL1xyXG52YXIgT2JqZWN0TWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gT2JqZWN0TWFwKG1hcEtleUZuKSB7XHJcbiAgICAgICAgdGhpcy5tYXBLZXlGbiA9IG1hcEtleUZuO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBpbm5lciBtYXAgZm9yIGEga2V5IC0+IHZhbHVlIHBhaXIuIER1ZSB0byB0aGUgcG9zc2liaWxpdHkgb2ZcclxuICAgICAgICAgKiBjb2xsaXNpb25zIHdlIGtlZXAgYSBsaXN0IG9mIGVudHJpZXMgdGhhdCB3ZSBkbyBhIGxpbmVhciBzZWFyY2ggdGhyb3VnaFxyXG4gICAgICAgICAqIHRvIGZpbmQgYW4gYWN0dWFsIG1hdGNoLiBOb3RlIHRoYXQgY29sbGlzaW9ucyBzaG91bGQgYmUgcmFyZSwgc28gd2Ugc3RpbGxcclxuICAgICAgICAgKiBleHBlY3QgbmVhciBjb25zdGFudCB0aW1lIGxvb2t1cHMgaW4gcHJhY3RpY2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5pbm5lciA9IHt9O1xyXG4gICAgfVxyXG4gICAgLyoqIEdldCBhIHZhbHVlIGZvciB0aGlzIGtleSwgb3IgdW5kZWZpbmVkIGlmIGl0IGRvZXMgbm90IGV4aXN0LiAqL1xyXG4gICAgT2JqZWN0TWFwLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGlkID0gdGhpcy5tYXBLZXlGbihrZXkpO1xyXG4gICAgICAgIHZhciBtYXRjaGVzID0gdGhpcy5pbm5lcltpZF07XHJcbiAgICAgICAgaWYgKG1hdGNoZXMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG1hdGNoZXNfMSA9IG1hdGNoZXM7IF9pIDwgbWF0Y2hlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgX2EgPSBtYXRjaGVzXzFbX2ldLCBvdGhlcktleSA9IF9hWzBdLCB2YWx1ZSA9IF9hWzFdO1xyXG4gICAgICAgICAgICBpZiAob3RoZXJLZXkuaXNFcXVhbChrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICBPYmplY3RNYXAucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXQoa2V5KSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIC8qKiBQdXQgdGhpcyBrZXkgYW5kIHZhbHVlIGluIHRoZSBtYXAuICovXHJcbiAgICBPYmplY3RNYXAucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIGlkID0gdGhpcy5tYXBLZXlGbihrZXkpO1xyXG4gICAgICAgIHZhciBtYXRjaGVzID0gdGhpcy5pbm5lcltpZF07XHJcbiAgICAgICAgaWYgKG1hdGNoZXMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLmlubmVyW2lkXSA9IFtba2V5LCB2YWx1ZV1dO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF0Y2hlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAobWF0Y2hlc1tpXVswXS5pc0VxdWFsKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIG1hdGNoZXNbaV0gPSBba2V5LCB2YWx1ZV07XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgbWF0Y2hlcy5wdXNoKFtrZXksIHZhbHVlXSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgdGhpcyBrZXkgZnJvbSB0aGUgbWFwLiBSZXR1cm5zIGEgYm9vbGVhbiBpZiBhbnl0aGluZyB3YXMgZGVsZXRlZC5cclxuICAgICAqL1xyXG4gICAgT2JqZWN0TWFwLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGlkID0gdGhpcy5tYXBLZXlGbihrZXkpO1xyXG4gICAgICAgIHZhciBtYXRjaGVzID0gdGhpcy5pbm5lcltpZF07XHJcbiAgICAgICAgaWYgKG1hdGNoZXMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF0Y2hlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAobWF0Y2hlc1tpXVswXS5pc0VxdWFsKGtleSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmlubmVyW2lkXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIE9iamVjdE1hcC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgIGZvckVhY2godGhpcy5pbm5lciwgZnVuY3Rpb24gKF8sIGVudHJpZXMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBlbnRyaWVzXzEgPSBlbnRyaWVzOyBfaSA8IGVudHJpZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBfYSA9IGVudHJpZXNfMVtfaV0sIGsgPSBfYVswXSwgdiA9IF9hWzFdO1xyXG4gICAgICAgICAgICAgICAgZm4oaywgdik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBPYmplY3RNYXAucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGlzRW1wdHkodGhpcy5pbm5lcik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE9iamVjdE1hcDtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBbiBpbi1tZW1vcnkgYnVmZmVyIG9mIGVudHJpZXMgdG8gYmUgd3JpdHRlbiB0byBhIFJlbW90ZURvY3VtZW50Q2FjaGUuXHJcbiAqIEl0IGNhbiBiZSB1c2VkIHRvIGJhdGNoIHVwIGEgc2V0IG9mIGNoYW5nZXMgdG8gYmUgd3JpdHRlbiB0byB0aGUgY2FjaGUsIGJ1dFxyXG4gKiBhZGRpdGlvbmFsbHkgc3VwcG9ydHMgcmVhZGluZyBlbnRyaWVzIGJhY2sgd2l0aCB0aGUgYGdldEVudHJ5KClgIG1ldGhvZCxcclxuICogZmFsbGluZyBiYWNrIHRvIHRoZSB1bmRlcmx5aW5nIFJlbW90ZURvY3VtZW50Q2FjaGUgaWYgbm8gZW50cnkgaXNcclxuICogYnVmZmVyZWQuXHJcbiAqXHJcbiAqIEVudHJpZXMgYWRkZWQgdG8gdGhlIGNhY2hlICptdXN0KiBiZSByZWFkIGZpcnN0LiBUaGlzIGlzIHRvIGZhY2lsaXRhdGVcclxuICogY2FsY3VsYXRpbmcgdGhlIHNpemUgZGVsdGEgb2YgdGhlIHBlbmRpbmcgY2hhbmdlcy5cclxuICpcclxuICogUE9SVElORyBOT1RFOiBUaGlzIGNsYXNzIHdhcyBpbXBsZW1lbnRlZCB0aGVuIHJlbW92ZWQgZnJvbSBvdGhlciBwbGF0Zm9ybXMuXHJcbiAqIElmIGJ5dGUtY291bnRpbmcgZW5kcyB1cCBiZWluZyBuZWVkZWQgb24gdGhlIG90aGVyIHBsYXRmb3JtcywgY29uc2lkZXJcclxuICogcG9ydGluZyB0aGlzIGNsYXNzIGFzIHBhcnQgb2YgdGhhdCBpbXBsZW1lbnRhdGlvbiB3b3JrLlxyXG4gKi9cclxudmFyIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gbWF5YmVEb2N1bWVudE1hcCgpO1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTaXplcyA9IG5ldyBPYmplY3RNYXAoZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4ga2V5LnRvU3RyaW5nKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKiogQnVmZmVycyBhIGBSZW1vdGVEb2N1bWVudENhY2hlLmFkZEVudHJ5KClgIGNhbGwuICovXHJcbiAgICBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlci5wcm90b3R5cGUuYWRkRW50cnkgPSBmdW5jdGlvbiAobWF5YmVEb2N1bWVudCkge1xyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gdGhpcy5hc3NlcnRDaGFuZ2VzKCk7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gY2hhbmdlcy5pbnNlcnQobWF5YmVEb2N1bWVudC5rZXksIG1heWJlRG9jdW1lbnQpO1xyXG4gICAgfTtcclxuICAgIC8vIE5PVEU6IHJlbW92ZUVudHJ5KCkgaXMgaW50ZW50aW9uYWxseSBvbWl0dGVkLiBJZiBpdCBuZWVkcyB0byBiZSBhZGRlZCBpblxyXG4gICAgLy8gdGhlIGZ1dHVyZSBpdCBtdXN0IHRha2UgYnl0ZSBjb3VudGluZyBpbnRvIGFjY291bnQuXHJcbiAgICAvKipcclxuICAgICAqIExvb2tzIHVwIGFuIGVudHJ5IGluIHRoZSBjYWNoZS4gVGhlIGJ1ZmZlcmVkIGNoYW5nZXMgd2lsbCBmaXJzdCBiZSBjaGVja2VkLFxyXG4gICAgICogYW5kIGlmIG5vIGJ1ZmZlcmVkIGNoYW5nZSBhcHBsaWVzLCB0aGlzIHdpbGwgZm9yd2FyZCB0b1xyXG4gICAgICogYFJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cnkoKWAuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHRyYW5zYWN0aW9uIFRoZSB0cmFuc2FjdGlvbiBpbiB3aGljaCB0byBwZXJmb3JtIGFueSBwZXJzaXN0ZW5jZVxyXG4gICAgICogICAgIG9wZXJhdGlvbnMuXHJcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gbG9vayB1cC5cclxuICAgICAqIEByZXR1cm4gVGhlIGNhY2hlZCBEb2N1bWVudCBvciBOb0RvY3VtZW50IGVudHJ5LCBvciBudWxsIGlmIHdlIGhhdmUgbm90aGluZ1xyXG4gICAgICogY2FjaGVkLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlci5wcm90b3R5cGUuZ2V0RW50cnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY2hhbmdlcyA9IHRoaXMuYXNzZXJ0Q2hhbmdlcygpO1xyXG4gICAgICAgIHZhciBidWZmZXJlZEVudHJ5ID0gY2hhbmdlcy5nZXQoZG9jdW1lbnRLZXkpO1xyXG4gICAgICAgIGlmIChidWZmZXJlZEVudHJ5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShidWZmZXJlZEVudHJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFJlY29yZCB0aGUgc2l6ZSBvZiBldmVyeXRoaW5nIHdlIGxvYWQgZnJvbSB0aGUgY2FjaGUgc28gd2UgY2FuIGNvbXB1dGUgYSBkZWx0YSBsYXRlci5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RnJvbUNhY2hlKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkubmV4dChmdW5jdGlvbiAoZ2V0UmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZ2V0UmVzdWx0ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZG9jdW1lbnRTaXplcy5zZXQoZG9jdW1lbnRLZXksIDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZG9jdW1lbnRTaXplcy5zZXQoZG9jdW1lbnRLZXksIGdldFJlc3VsdC5zaXplKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UmVzdWx0Lm1heWJlRG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFwcGxpZXMgYnVmZmVyZWQgY2hhbmdlcyB0byB0aGUgdW5kZXJseWluZyBSZW1vdGVEb2N1bWVudENhY2hlLCB1c2luZ1xyXG4gICAgICogdGhlIHByb3ZpZGVkIHRyYW5zYWN0aW9uLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlci5wcm90b3R5cGUuYXBwbHkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5hcHBseUNoYW5nZXModHJhbnNhY3Rpb24pO1xyXG4gICAgICAgIC8vIFdlIHNob3VsZCBub3QgYnVmZmVyIGFueSBtb3JlIGNoYW5nZXMuXHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIC8qKiBIZWxwZXIgdG8gYXNzZXJ0IHRoaXMuY2hhbmdlcyBpcyBub3QgbnVsbCBhbmQgcmV0dXJuIGl0LiAqL1xyXG4gICAgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIucHJvdG90eXBlLmFzc2VydENoYW5nZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuY2hhbmdlcyAhPT0gbnVsbCwgJ0NoYW5nZXMgaGF2ZSBhbHJlYWR5IGJlZW4gYXBwbGllZC4nKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jaGFuZ2VzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDEgPSAnU2ltcGxlRGInO1xyXG4vKipcclxuICogUHJvdmlkZXMgYSB3cmFwcGVyIGFyb3VuZCBJbmRleGVkRGIgd2l0aCBhIHNpbXBsaWZpZWQgaW50ZXJmYWNlIHRoYXQgdXNlc1xyXG4gKiBQcm9taXNlLWxpa2UgcmV0dXJuIHZhbHVlcyB0byBjaGFpbiBvcGVyYXRpb25zLiBSZWFsIHByb21pc2VzIGNhbm5vdCBiZSB1c2VkXHJcbiAqIHNpbmNlIC50aGVuKCkgY29udGludWF0aW9ucyBhcmUgZXhlY3V0ZWQgYXN5bmNocm9ub3VzbHkgKGUuZy4gdmlhXHJcbiAqIC5zZXRJbW1lZGlhdGUpLCB3aGljaCB3b3VsZCBjYXVzZSBJbmRleGVkREIgdG8gZW5kIHRoZSB0cmFuc2FjdGlvbi5cclxuICogU2VlIFBlcnNpc3RlbmNlUHJvbWlzZSBmb3IgbW9yZSBkZXRhaWxzLlxyXG4gKi9cclxudmFyIFNpbXBsZURiID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2ltcGxlRGIoZGIpIHtcclxuICAgICAgICB0aGlzLmRiID0gZGI7XHJcbiAgICB9XHJcbiAgICAvKiogT3BlbnMgdGhlIHNwZWNpZmllZCBkYXRhYmFzZSwgY3JlYXRpbmcgb3IgdXBncmFkaW5nIGl0IGlmIG5lY2Vzc2FyeS4gKi9cclxuICAgIFNpbXBsZURiLm9wZW5PckNyZWF0ZSA9IGZ1bmN0aW9uIChuYW1lLCB2ZXJzaW9uLCBzY2hlbWFDb252ZXJ0ZXIpIHtcclxuICAgICAgICBhc3NlcnQoU2ltcGxlRGIuaXNBdmFpbGFibGUoKSwgJ0luZGV4ZWREQiBub3Qgc3VwcG9ydGVkIGluIGN1cnJlbnQgZW52aXJvbm1lbnQuJyk7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnT3BlbmluZyBkYXRhYmFzZTonLCBuYW1lKTtcclxuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE8obWlrZWxlaGVuKTogSW52ZXN0aWdhdGUgYnJvd3NlciBjb21wYXRpYmlsaXR5LlxyXG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSW5kZXhlZERCX0FQSS9Vc2luZ19JbmRleGVkREJcclxuICAgICAgICAgICAgLy8gc3VnZ2VzdHMgSUU5IGFuZCBvbGRlciBXZWJLaXQgYnJvd3NlcnMgaGFuZGxlIHVwZ3JhZGVcclxuICAgICAgICAgICAgLy8gZGlmZmVyZW50bHkuIFRoZXkgZXhwZWN0IHNldFZlcnNpb24sIGFzIGRlc2NyaWJlZCBoZXJlOlxyXG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSURCVmVyc2lvbkNoYW5nZVJlcXVlc3Qvc2V0VmVyc2lvblxyXG4gICAgICAgICAgICB2YXIgcmVxdWVzdCA9IHdpbmRvdy5pbmRleGVkREIub3BlbihuYW1lLCB2ZXJzaW9uKTtcclxuICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKG5ldyBTaW1wbGVEYihkYikpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9uYmxvY2tlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCAnQ2Fubm90IHVwZ3JhZGUgSW5kZXhlZERCIHNjaGVtYSB3aGlsZSBhbm90aGVyIHRhYiBpcyBvcGVuLiAnICtcclxuICAgICAgICAgICAgICAgICAgICAnQ2xvc2UgYWxsIHRhYnMgdGhhdCBhY2Nlc3MgRmlyZXN0b3JlIGFuZCByZWxvYWQgdGhpcyBwYWdlIHRvIHByb2NlZWQuJykpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnRGF0YWJhc2UgXCInICsgbmFtZSArICdcIiByZXF1aXJlcyB1cGdyYWRlIGZyb20gdmVyc2lvbjonLCBldmVudC5vbGRWZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAvLyBXZSBhcmUgcHJvdmlkZWQgYSB2ZXJzaW9uIHVwZ3JhZGUgdHJhbnNhY3Rpb24gZnJvbSB0aGUgcmVxdWVzdCwgc29cclxuICAgICAgICAgICAgICAgIC8vIHdlIHdyYXAgdGhhdCBpbiBhIFNpbXBsZURiVHJhbnNhY3Rpb24gdG8gYWxsb3cgdXNlIG9mIG91ciBmcmllbmRsaWVyXHJcbiAgICAgICAgICAgICAgICAvLyBBUEkgZm9yIHNjaGVtYSBtaWdyYXRpb24gb3BlcmF0aW9ucy5cclxuICAgICAgICAgICAgICAgIHZhciB0eG4gPSBuZXcgU2ltcGxlRGJUcmFuc2FjdGlvbihyZXF1ZXN0LnRyYW5zYWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIHNjaGVtYUNvbnZlcnRlclxyXG4gICAgICAgICAgICAgICAgICAgIC5jcmVhdGVPclVwZ3JhZGUoZGIsIHR4biwgZXZlbnQub2xkVmVyc2lvbiwgU0NIRU1BX1ZFUlNJT04pXHJcbiAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckMSwgJ0RhdGFiYXNlIHVwZ3JhZGUgdG8gdmVyc2lvbiAnICsgU0NIRU1BX1ZFUlNJT04gKyAnIGNvbXBsZXRlJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KS50b1Byb21pc2UoKTtcclxuICAgIH07XHJcbiAgICAvKiogRGVsZXRlcyB0aGUgc3BlY2lmaWVkIGRhdGFiYXNlLiAqL1xyXG4gICAgU2ltcGxlRGIuZGVsZXRlID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEsICdSZW1vdmluZyBkYXRhYmFzZTonLCBuYW1lKTtcclxuICAgICAgICByZXR1cm4gd3JhcFJlcXVlc3Qod2luZG93LmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShuYW1lKSkudG9Qcm9taXNlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiBJbmRleGVkREIgaXMgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LiAqL1xyXG4gICAgU2ltcGxlRGIuaXNBdmFpbGFibGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8IHdpbmRvdy5pbmRleGVkREIgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFdlIGV4dGVuc2l2ZWx5IHVzZSBpbmRleGVkIGFycmF5IHZhbHVlcyBhbmQgY29tcG91bmQga2V5cyxcclxuICAgICAgICAvLyB3aGljaCBJRSBhbmQgRWRnZSBkbyBub3Qgc3VwcG9ydC4gSG93ZXZlciwgdGhleSBzdGlsbCBoYXZlIGluZGV4ZWREQlxyXG4gICAgICAgIC8vIGRlZmluZWQgb24gdGhlIHdpbmRvdywgc28gd2UgbmVlZCB0byBjaGVjayBmb3IgdGhlbSBoZXJlIGFuZCBtYWtlIHN1cmVcclxuICAgICAgICAvLyB0byByZXR1cm4gdGhhdCBwZXJzaXN0ZW5jZSBpcyBub3QgZW5hYmxlZCBmb3IgdGhvc2UgYnJvd3NlcnMuXHJcbiAgICAgICAgLy8gRm9yIHRyYWNraW5nIHN1cHBvcnQgb2YgdGhpcyBmZWF0dXJlLCBzZWUgaGVyZTpcclxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5taWNyb3NvZnQuY29tL2VuLXVzL21pY3Jvc29mdC1lZGdlL3BsYXRmb3JtL3N0YXR1cy9pbmRleGVkZGJhcnJheXNhbmRtdWx0aWVudHJ5c3VwcG9ydC9cclxuICAgICAgICAvLyBJZiB3ZSBhcmUgcnVubmluZyBpbiBOb2RlIHVzaW5nIHRoZSBJbmRleGVkREJTaGltLCBgd2luZG93YCBpcyBkZWZpbmVkLFxyXG4gICAgICAgIC8vIGJ1dCBgd2luZG93Lm5hdmlnYXRvcmAgaXMgbm90LiBJbiB0aGlzIGNhc2UsIHdlIHN1cHBvcnQgSW5kZXhlZERCIGFuZFxyXG4gICAgICAgIC8vIHJldHVybiBgdHJ1ZWAuXHJcbiAgICAgICAgaWYgKHdpbmRvdy5uYXZpZ2F0b3IgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvY2Vzcy5lbnYuVVNFX01PQ0tfUEVSU0lTVEVOQ0UgPT09ICdZRVMnO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDaGVjayB0aGUgVUEgc3RyaW5nIHRvIGZpbmQgb3V0IHRoZSBicm93c2VyLlxyXG4gICAgICAgIC8vIFRPRE8obWlrZWxlaGVuKTogTW92ZSB0aGlzIGxvZ2ljIGludG8gcGFja2FnZXMvdXRpbC9lbnZpcm9ubWVudC50c1xyXG4gICAgICAgIHZhciB1YSA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50O1xyXG4gICAgICAgIC8vIElFIDEwXHJcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKGNvbXBhdGlibGU7IE1TSUUgMTAuMDsgV2luZG93cyBOVCA2LjI7IFRyaWRlbnQvNi4wKSc7XHJcbiAgICAgICAgLy8gSUUgMTFcclxuICAgICAgICAvLyB1YSA9ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjM7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tvJztcclxuICAgICAgICAvLyBFZGdlXHJcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsXHJcbiAgICAgICAgLy8gbGlrZSBHZWNrbykgQ2hyb21lLzM5LjAuMjE3MS43MSBTYWZhcmkvNTM3LjM2IEVkZ2UvMTIuMCc7XHJcbiAgICAgICAgaWYgKHVhLmluZGV4T2YoJ01TSUUgJykgPiAwIHx8XHJcbiAgICAgICAgICAgIHVhLmluZGV4T2YoJ1RyaWRlbnQvJykgPiAwIHx8XHJcbiAgICAgICAgICAgIHVhLmluZGV4T2YoJ0VkZ2UvJykgPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZnJvbSBhIHRyYW5zYWN0aW9uLiAqL1xyXG4gICAgU2ltcGxlRGIuZ2V0U3RvcmUgPSBmdW5jdGlvbiAodHhuLCBzdG9yZSkge1xyXG4gICAgICAgIHJldHVybiB0eG4uc3RvcmUoc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiLnByb3RvdHlwZS5ydW5UcmFuc2FjdGlvbiA9IGZ1bmN0aW9uIChtb2RlLCBvYmplY3RTdG9yZXMsIHRyYW5zYWN0aW9uRm4pIHtcclxuICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBTaW1wbGVEYlRyYW5zYWN0aW9uLm9wZW4odGhpcy5kYiwgbW9kZSwgb2JqZWN0U3RvcmVzKTtcclxuICAgICAgICB2YXIgdHJhbnNhY3Rpb25GblJlc3VsdCA9IHRyYW5zYWN0aW9uRm4odHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgLy8gQWJvcnQgdGhlIHRyYW5zYWN0aW9uIGlmIHRoZXJlIHdhcyBhbiBlcnJvci5cclxuICAgICAgICAgICAgdHJhbnNhY3Rpb24uYWJvcnQoZXJyb3IkJDEpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50b1Byb21pc2UoKTtcclxuICAgICAgICAvLyBXYWl0IGZvciB0aGUgdHJhbnNhY3Rpb24gdG8gY29tcGxldGUgKGkuZS4gSW5kZXhlZERiJ3Mgb25zdWNjZXNzIGV2ZW50IHRvXHJcbiAgICAgICAgLy8gZmlyZSksIGJ1dCBzdGlsbCByZXR1cm4gdGhlIG9yaWdpbmFsIHRyYW5zYWN0aW9uRm5SZXN1bHQgYmFjayB0byB0aGVcclxuICAgICAgICAvLyBjYWxsZXIuXHJcbiAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uLmNvbXBsZXRpb25Qcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJhbnNhY3Rpb25GblJlc3VsdDsgfSk7XHJcbiAgICB9O1xyXG4gICAgU2ltcGxlRGIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZGIuY2xvc2UoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2ltcGxlRGI7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIGNvbnRyb2xsZXIgZm9yIGl0ZXJhdGluZyBvdmVyIGEga2V5IHJhbmdlIG9yIGluZGV4LiBJdCBhbGxvd3MgYW4gaXRlcmF0ZVxyXG4gKiBjYWxsYmFjayB0byBkZWxldGUgdGhlIGN1cnJlbnRseS1yZWZlcmVuY2VkIG9iamVjdCwgb3IganVtcCB0byBhIG5ldyBrZXlcclxuICogd2l0aGluIHRoZSBrZXkgcmFuZ2Ugb3IgaW5kZXguXHJcbiAqL1xyXG52YXIgSXRlcmF0aW9uQ29udHJvbGxlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEl0ZXJhdGlvbkNvbnRyb2xsZXIoZGJDdXJzb3IpIHtcclxuICAgICAgICB0aGlzLmRiQ3Vyc29yID0gZGJDdXJzb3I7XHJcbiAgICAgICAgdGhpcy5zaG91bGRTdG9wID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5uZXh0S2V5ID0gbnVsbDtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVyYXRpb25Db250cm9sbGVyLnByb3RvdHlwZSwgXCJpc0RvbmVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zaG91bGRTdG9wO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEl0ZXJhdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlLCBcInNraXBUb0tleVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5leHRLZXk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlcmF0aW9uQ29udHJvbGxlci5wcm90b3R5cGUsIFwiY3Vyc29yXCIsIHtcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmRiQ3Vyc29yID0gdmFsdWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCB0byBzdG9wIGl0ZXJhdGlvbiBhdCBhbnkgcG9pbnQuXHJcbiAgICAgKi9cclxuICAgIEl0ZXJhdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlLmRvbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zaG91bGRTdG9wID0gdHJ1ZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCB0byBza2lwIHRvIHRoYXQgbmV4dCBrZXksIHdoaWNoIGNvdWxkIGJlXHJcbiAgICAgKiBhbiBpbmRleCBvciBhIHByaW1hcnkga2V5LlxyXG4gICAgICovXHJcbiAgICBJdGVyYXRpb25Db250cm9sbGVyLnByb3RvdHlwZS5za2lwID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHRoaXMubmV4dEtleSA9IGtleTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIERlbGV0ZSB0aGUgY3VycmVudCBjdXJzb3IgdmFsdWUgZnJvbSB0aGUgb2JqZWN0IHN0b3JlLlxyXG4gICAgICpcclxuICAgICAqIE5PVEU6IFlvdSBDQU5OT1QgZG8gdGhpcyB3aXRoIGEga2V5c09ubHkgcXVlcnkuXHJcbiAgICAgKi9cclxuICAgIEl0ZXJhdGlvbkNvbnRyb2xsZXIucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gd3JhcFJlcXVlc3QodGhpcy5kYkN1cnNvci5kZWxldGUoKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEl0ZXJhdGlvbkNvbnRyb2xsZXI7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBXcmFwcyBhbiBJREJUcmFuc2FjdGlvbiBhbmQgZXhwb3NlcyBhIHN0b3JlKCkgbWV0aG9kIHRvIGdldCBhIGhhbmRsZSB0byBhXHJcbiAqIHNwZWNpZmljIG9iamVjdCBzdG9yZS5cclxuICovXHJcbnZhciBTaW1wbGVEYlRyYW5zYWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2ltcGxlRGJUcmFuc2FjdGlvbih0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy50cmFuc2FjdGlvbiA9IHRyYW5zYWN0aW9uO1xyXG4gICAgICAgIHRoaXMuYWJvcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIHJlc3VsdCBvZiB0aGUgSW5kZXhlZERiIHRyYW5zYWN0aW9uLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY29tcGxldGlvbkRlZmVycmVkID0gbmV3IERlZmVycmVkJDEoKTtcclxuICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmNvbXBsZXRpb25EZWZlcnJlZC5yZXNvbHZlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLm9uYWJvcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICh0cmFuc2FjdGlvbi5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY29tcGxldGlvbkRlZmVycmVkLnJlamVjdCh0cmFuc2FjdGlvbi5lcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5jb21wbGV0aW9uRGVmZXJyZWQucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgX3RoaXMuY29tcGxldGlvbkRlZmVycmVkLnJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBTaW1wbGVEYlRyYW5zYWN0aW9uLm9wZW4gPSBmdW5jdGlvbiAoZGIsIG1vZGUsIG9iamVjdFN0b3JlTmFtZXMpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNpbXBsZURiVHJhbnNhY3Rpb24oZGIudHJhbnNhY3Rpb24ob2JqZWN0U3RvcmVOYW1lcywgbW9kZSkpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTaW1wbGVEYlRyYW5zYWN0aW9uLnByb3RvdHlwZSwgXCJjb21wbGV0aW9uUHJvbWlzZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBsZXRpb25EZWZlcnJlZC5wcm9taXNlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgU2ltcGxlRGJUcmFuc2FjdGlvbi5wcm90b3R5cGUuYWJvcnQgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICBpZiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgdGhpcy5jb21wbGV0aW9uRGVmZXJyZWQucmVqZWN0KGVycm9yJCQxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmFib3J0ZWQpIHtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnQWJvcnRpbmcgdHJhbnNhY3Rpb246JywgZXJyb3IkJDEgPyBlcnJvciQkMS5tZXNzYWdlIDogJ0NsaWVudC1pbml0aWF0ZWQgYWJvcnQnKTtcclxuICAgICAgICAgICAgdGhpcy5hYm9ydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2FjdGlvbi5hYm9ydCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBTaW1wbGVEYlN0b3JlPEtleVR5cGUsIFZhbHVlVHlwZT4gZm9yIHRoZSBzcGVjaWZpZWQgc3RvcmUuIEFsbFxyXG4gICAgICogb3BlcmF0aW9ucyBwZXJmb3JtZWQgb24gdGhlIFNpbXBsZURiU3RvcmUgaGFwcGVuIHdpdGhpbiB0aGUgY29udGV4dCBvZiB0aGlzXHJcbiAgICAgKiB0cmFuc2FjdGlvbiBhbmQgaXQgY2Fubm90IGJlIHVzZWQgYW55bW9yZSBvbmNlIHRoZSB0cmFuc2FjdGlvbiBpc1xyXG4gICAgICogY29tcGxldGVkLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB3ZSBjYW4ndCBhY3R1YWxseSBlbmZvcmNlIHRoYXQgdGhlIEtleVR5cGUgYW5kIFZhbHVlVHlwZSBhcmVcclxuICAgICAqIGNvcnJlY3QsIGJ1dCB0aGV5IGFsbG93IHR5cGUgc2FmZXR5IHRocm91Z2ggdGhlIHJlc3Qgb2YgdGhlIGNvbnN1bWluZyBjb2RlLlxyXG4gICAgICovXHJcbiAgICBTaW1wbGVEYlRyYW5zYWN0aW9uLnByb3RvdHlwZS5zdG9yZSA9IGZ1bmN0aW9uIChzdG9yZU5hbWUpIHtcclxuICAgICAgICB2YXIgc3RvcmUgPSB0aGlzLnRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0KCEhc3RvcmUsICdPYmplY3Qgc3RvcmUgbm90IHBhcnQgb2YgdHJhbnNhY3Rpb246ICcgKyBzdG9yZU5hbWUpO1xyXG4gICAgICAgIHJldHVybiBuZXcgU2ltcGxlRGJTdG9yZShzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNpbXBsZURiVHJhbnNhY3Rpb247XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIHdyYXBwZXIgYXJvdW5kIGFuIElEQk9iamVjdFN0b3JlIHByb3ZpZGluZyBhbiBBUEkgdGhhdDpcclxuICpcclxuICogMSkgSGFzIGdlbmVyaWMgS2V5VHlwZSAvIFZhbHVlVHlwZSBwYXJhbWV0ZXJzIHRvIHByb3ZpZGUgc3Ryb25nbHktdHlwZWRcclxuICogbWV0aG9kcyBmb3IgYWN0aW5nIGFnYWluc3QgdGhlIG9iamVjdCBzdG9yZS5cclxuICogMikgRGVhbHMgd2l0aCBJbmRleGVkREIncyBvbnN1Y2Nlc3MgLyBvbmVycm9yIGV2ZW50IGNhbGxiYWNrcywgbWFraW5nIGV2ZXJ5XHJcbiAqIG1ldGhvZCByZXR1cm4gYSBQZXJzaXN0ZW5jZVByb21pc2UgaW5zdGVhZC5cclxuICogMykgUHJvdmlkZXMgYSBoaWdoZXItbGV2ZWwgQVBJIHRvIGF2b2lkIG5lZWRpbmcgdG8gZG8gZXhjZXNzaXZlIHdyYXBwaW5nIG9mXHJcbiAqIGludGVybWVkaWF0ZSBJbmRleGVkREIgdHlwZXMgKElEQkN1cnNvcldpdGhWYWx1ZSwgZXRjLilcclxuICovXHJcbnZhciBTaW1wbGVEYlN0b3JlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2ltcGxlRGJTdG9yZShzdG9yZSkge1xyXG4gICAgICAgIHRoaXMuc3RvcmUgPSBzdG9yZTtcclxuICAgIH1cclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uIChrZXlPclZhbHVlLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciByZXF1ZXN0O1xyXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckMSwgJ1BVVCcsIHRoaXMuc3RvcmUubmFtZSwga2V5T3JWYWx1ZSwgdmFsdWUpO1xyXG4gICAgICAgICAgICByZXF1ZXN0ID0gdGhpcy5zdG9yZS5wdXQodmFsdWUsIGtleU9yVmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnUFVUJywgdGhpcy5zdG9yZS5uYW1lLCAnPGF1dG8ta2V5PicsIGtleU9yVmFsdWUpO1xyXG4gICAgICAgICAgICByZXF1ZXN0ID0gdGhpcy5zdG9yZS5wdXQoa2V5T3JWYWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB3cmFwUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgYSBuZXcgdmFsdWUgaW50byBhbiBPYmplY3QgU3RvcmUgYW5kIHJldHVybnMgdGhlIG5ldyBrZXkuIFNpbWlsYXIgdG9cclxuICAgICAqIEluZGV4ZWREYidzIGBhZGQoKWAsIHRoaXMgbWV0aG9kIHdpbGwgZmFpbCBvbiBwcmltYXJ5IGtleSBjb2xsaXNpb25zLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2YWx1ZSBUaGUgb2JqZWN0IHRvIHdyaXRlLlxyXG4gICAgICogQHJldHVybiBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBhZGQuXHJcbiAgICAgKi9cclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMSwgJ0FERCcsIHRoaXMuc3RvcmUubmFtZSwgdmFsdWUsIHZhbHVlKTtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHRoaXMuc3RvcmUuYWRkKHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gd3JhcFJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIHRoZSBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBmcm9tIHRoZSBzcGVjaWZpZWQgc3RvcmUsIG9yIG51bGxcclxuICAgICAqIGlmIG5vIG9iamVjdCBleGlzdHMgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS5cclxuICAgICAqXHJcbiAgICAgKiBAa2V5IFRoZSBrZXkgb2YgdGhlIG9iamVjdCB0byBnZXQuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBvciBudWxsIGlmIG5vIG9iamVjdCBleGlzdHMuXHJcbiAgICAgKi9cclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0gdGhpcy5zdG9yZS5nZXQoa2V5KTtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55IFdlJ3JlIGRvaW5nIGFuIHVuc2FmZSBjYXN0IHRvIFZhbHVlVHlwZS5cclxuICAgICAgICByZXR1cm4gd3JhcFJlcXVlc3QocmVxdWVzdCkubmV4dChmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIC8vIE5vcm1hbGl6ZSBub25leGlzdGVuY2UgdG8gbnVsbC5cclxuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckMSwgJ0dFVCcsIF90aGlzLnN0b3JlLm5hbWUsIGtleSwgcmVzdWx0KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnREVMRVRFJywgdGhpcy5zdG9yZS5uYW1lLCBrZXkpO1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0gdGhpcy5zdG9yZS5kZWxldGUoa2V5KTtcclxuICAgICAgICByZXR1cm4gd3JhcFJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJZiB3ZSBldmVyIG5lZWQgbW9yZSBvZiB0aGUgY291bnQgdmFyaWFudHMsIHdlIGNhbiBhZGQgb3ZlcmxvYWRzLiBGb3Igbm93LFxyXG4gICAgICogYWxsIHdlIG5lZWQgaXMgdG8gY291bnQgZXZlcnl0aGluZyBpbiBhIHN0b3JlLlxyXG4gICAgICpcclxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiByb3dzIGluIHRoZSBzdG9yZS5cclxuICAgICAqL1xyXG4gICAgU2ltcGxlRGJTdG9yZS5wcm90b3R5cGUuY291bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxLCAnQ09VTlQnLCB0aGlzLnN0b3JlLm5hbWUpO1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0gdGhpcy5zdG9yZS5jb3VudCgpO1xyXG4gICAgICAgIHJldHVybiB3cmFwUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5sb2FkQWxsID0gZnVuY3Rpb24gKGluZGV4T3JSYW5nZSwgcmFuZ2UpIHtcclxuICAgICAgICB2YXIgY3Vyc29yID0gdGhpcy5jdXJzb3IodGhpcy5vcHRpb25zKGluZGV4T3JSYW5nZSwgcmFuZ2UpKTtcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIHJldHVybiB0aGlzLml0ZXJhdGVDdXJzb3IoY3Vyc29yLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICByZXN1bHRzLnB1c2godmFsdWUpO1xyXG4gICAgICAgIH0pLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTaW1wbGVEYlN0b3JlLnByb3RvdHlwZS5kZWxldGVBbGwgPSBmdW5jdGlvbiAoaW5kZXhPclJhbmdlLCByYW5nZSkge1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMSwgJ0RFTEVURSBBTEwnLCB0aGlzLnN0b3JlLm5hbWUpO1xyXG4gICAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zKGluZGV4T3JSYW5nZSwgcmFuZ2UpO1xyXG4gICAgICAgIG9wdGlvbnMua2V5c09ubHkgPSBmYWxzZTtcclxuICAgICAgICB2YXIgY3Vyc29yID0gdGhpcy5jdXJzb3Iob3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlcmF0ZUN1cnNvcihjdXJzb3IsIGZ1bmN0aW9uIChrZXksIHZhbHVlLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIC8vIE5PVEU6IENhbGxpbmcgZGVsZXRlKCkgb24gYSBjdXJzb3IgaXMgZG9jdW1lbnRlZCBhcyBtb3JlIGVmZmljaWVudCB0aGFuXHJcbiAgICAgICAgICAgIC8vIGNhbGxpbmcgZGVsZXRlKCkgb24gYW4gb2JqZWN0IHN0b3JlIHdpdGggYSBzaW5nbGUga2V5XHJcbiAgICAgICAgICAgIC8vIChodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSURCT2JqZWN0U3RvcmUvZGVsZXRlKSxcclxuICAgICAgICAgICAgLy8gaG93ZXZlciwgdGhpcyByZXF1aXJlcyB1cyAqbm90KiB0byB1c2UgYSBrZXlzT25seSBjdXJzb3JcclxuICAgICAgICAgICAgLy8gKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9JREJDdXJzb3IvZGVsZXRlKS4gV2VcclxuICAgICAgICAgICAgLy8gbWF5IHdhbnQgdG8gY29tcGFyZSB0aGUgcGVyZm9ybWFuY2Ugb2YgZWFjaCBtZXRob2QuXHJcbiAgICAgICAgICAgIHJldHVybiBjb250cm9sLmRlbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLml0ZXJhdGUgPSBmdW5jdGlvbiAob3B0aW9uc09yQ2FsbGJhY2ssIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIG9wdGlvbnM7XHJcbiAgICAgICAgaWYgKCFjYWxsYmFjaykge1xyXG4gICAgICAgICAgICBvcHRpb25zID0ge307XHJcbiAgICAgICAgICAgIGNhbGxiYWNrID0gb3B0aW9uc09yQ2FsbGJhY2s7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvcHRpb25zID0gb3B0aW9uc09yQ2FsbGJhY2s7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjdXJzb3IgPSB0aGlzLmN1cnNvcihvcHRpb25zKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRlQ3Vyc29yKGN1cnNvciwgY2FsbGJhY2spO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHN0b3JlLCBidXQgd2FpdHMgZm9yIHRoZSBnaXZlbiBjYWxsYmFjayB0byBjb21wbGV0ZSBmb3JcclxuICAgICAqIGVhY2ggZW50cnkgYmVmb3JlIGl0ZXJhdGluZyB0aGUgbmV4dCBlbnRyeS4gVGhpcyBhbGxvd3MgdGhlIGNhbGxiYWNrIHRvIGRvXHJcbiAgICAgKiBhc3luY2hyb25vdXMgd29yayB0byBkZXRlcm1pbmUgaWYgdGhpcyBpdGVyYXRpb24gc2hvdWxkIGNvbnRpbnVlLlxyXG4gICAgICpcclxuICAgICAqIFRoZSBwcm92aWRlZCBjYWxsYmFjayBzaG91bGQgcmV0dXJuIGB0cnVlYCB0byBjb250aW51ZSBpdGVyYXRpb24sIGFuZFxyXG4gICAgICogYGZhbHNlYCBvdGhlcndpc2UuXHJcbiAgICAgKi9cclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLml0ZXJhdGVTZXJpYWwgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgY3Vyc29yUmVxdWVzdCA9IHRoaXMuY3Vyc29yKHt9KTtcclxuICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIGN1cnNvclJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGN1cnNvclJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3Vyc29yID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgIGlmICghY3Vyc29yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGN1cnNvci5wcmltYXJ5S2V5LCBjdXJzb3IudmFsdWUpLm5leHQoZnVuY3Rpb24gKHNob3VsZENvbnRpbnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNob3VsZENvbnRpbnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLml0ZXJhdGVDdXJzb3IgPSBmdW5jdGlvbiAoY3Vyc29yUmVxdWVzdCwgZm4pIHtcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgY3Vyc29yUmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY3Vyc29yUmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjdXJzb3IgPSBldmVudC50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJzb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBuZXcgSXRlcmF0aW9uQ29udHJvbGxlcihjdXJzb3IpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJSZXN1bHQgPSBmbihjdXJzb3IucHJpbWFyeUtleSwgY3Vyc29yLnZhbHVlLCBjb250cm9sbGVyKTtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyUmVzdWx0IGluc3RhbmNlb2YgUGVyc2lzdGVuY2VQcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJQcm9taXNlID0gdXNlclJlc3VsdC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh1c2VyUHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoY29udHJvbGxlci5pc0RvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjb250cm9sbGVyLnNraXBUb0tleSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKGNvbnRyb2xsZXIuc2tpcFRvS2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHJlc3VsdHMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLm9wdGlvbnMgPSBmdW5jdGlvbiAoaW5kZXhPclJhbmdlLCByYW5nZSkge1xyXG4gICAgICAgIHZhciBpbmRleE5hbWUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgaWYgKGluZGV4T3JSYW5nZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5kZXhPclJhbmdlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgaW5kZXhOYW1lID0gaW5kZXhPclJhbmdlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KHJhbmdlID09PSB1bmRlZmluZWQsICczcmQgYXJndW1lbnQgbXVzdCBub3QgYmUgZGVmaW5lZCBpZiAybmQgaXMgYSByYW5nZS4nKTtcclxuICAgICAgICAgICAgICAgIHJhbmdlID0gaW5kZXhPclJhbmdlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7IGluZGV4OiBpbmRleE5hbWUsIHJhbmdlOiByYW5nZSB9O1xyXG4gICAgfTtcclxuICAgIFNpbXBsZURiU3RvcmUucHJvdG90eXBlLmN1cnNvciA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIGRpcmVjdGlvbiA9ICduZXh0JztcclxuICAgICAgICBpZiAob3B0aW9ucy5yZXZlcnNlKSB7XHJcbiAgICAgICAgICAgIGRpcmVjdGlvbiA9ICdwcmV2JztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuaW5kZXgpIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5zdG9yZS5pbmRleChvcHRpb25zLmluZGV4KTtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMua2V5c09ubHkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpbmRleC5vcGVuS2V5Q3Vyc29yKG9wdGlvbnMucmFuZ2UsIGRpcmVjdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXgub3BlbkN1cnNvcihvcHRpb25zLnJhbmdlLCBkaXJlY3Rpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS5vcGVuQ3Vyc29yKG9wdGlvbnMucmFuZ2UsIGRpcmVjdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBTaW1wbGVEYlN0b3JlO1xyXG59KCkpO1xyXG4vKipcclxuICogV3JhcHMgYW4gSURCUmVxdWVzdCBpbiBhIFBlcnNpc3RlbmNlUHJvbWlzZSwgdXNpbmcgdGhlIG9uc3VjY2VzcyAvIG9uZXJyb3JcclxuICogaGFuZGxlcnMgdG8gcmVzb2x2ZSAvIHJlamVjdCB0aGUgUGVyc2lzdGVuY2VQcm9taXNlIGFzIGFwcHJvcHJpYXRlLlxyXG4gKi9cclxuZnVuY3Rpb24gd3JhcFJlcXVlc3QocmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBldmVudC50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgUkVNT1RFX0RPQ1VNRU5UX0NIQU5HRV9NSVNTSU5HX0VSUl9NU0cgPSAnVGhlIHJlbW90ZSBkb2N1bWVudCBjaGFuZ2Vsb2cgbm8gbG9uZ2VyIGNvbnRhaW5zIGFsbCBjaGFuZ2VzIGZvciBhbGwgJyArXHJcbiAgICAnbG9jYWwgcXVlcnkgdmlld3MuIEl0IG1heSBiZSBuZWNlc3NhcnkgdG8gcmVidWlsZCB0aGVzZSB2aWV3cy4nO1xyXG52YXIgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIHtMb2NhbFNlcmlhbGl6ZXJ9IHNlcmlhbGl6ZXIgVGhlIGRvY3VtZW50IHNlcmlhbGl6ZXIuXHJcbiAgICAgKiBAcGFyYW0ga2VlcERvY3VtZW50Q2hhbmdlTG9nIFdoZXRoZXIgdG8ga2VlcCBhIGRvY3VtZW50IGNoYW5nZSBsb2cgaW5cclxuICAgICAqIEluZGV4ZWREYi4gVGhpcyBjaGFuZ2UgbG9nIGlzIHJlcXVpcmVkIGZvciBNdWx0aS1UYWIgc3luY2hyb25pemF0aW9uLCBidXRcclxuICAgICAqIG5vdCBuZWVkZWQgaW4gY2xpZW50cyB0aGF0IGRvbid0IHNoYXJlIGFjY2VzcyB0byB0aGVpciByZW1vdGUgZG9jdW1lbnRcclxuICAgICAqIGNhY2hlLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlKHNlcmlhbGl6ZXIsIGtlZXBEb2N1bWVudENoYW5nZUxvZykge1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgdGhpcy5rZWVwRG9jdW1lbnRDaGFuZ2VMb2cgPSBrZWVwRG9jdW1lbnRDaGFuZ2VMb2c7XHJcbiAgICAgICAgLyoqIFRoZSBsYXN0IGlkIHJlYWQgYnkgYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYC4gKi9cclxuICAgICAgICB0aGlzLl9sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCA9IDA7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUsIFwibGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyB1cCB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLlxyXG4gICAgICpcclxuICAgICAqIFJlYWRzIHRoZSBJRCBvZiB0aGUgbGFzdCAgZG9jdW1lbnQgY2hhbmdlIGZyb20gdGhlIGRvY3VtZW50Q2hhbmdlcyBzdG9yZS5cclxuICAgICAqIEV4aXN0aW5nIGNoYW5nZXMgd2lsbCBub3QgYmUgcmV0dXJuZWQgYXMgcGFydCBvZlxyXG4gICAgICogYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYC5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi5cclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gU2ltcGxlRGIuZ2V0U3RvcmUodHJhbnNhY3Rpb24sIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzLnN0b3JlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zeW5jaHJvbml6ZUxhc3REb2N1bWVudENoYW5nZUlkKHN0b3JlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgdGhlIHN1cHBsaWVkIGVudHJpZXMgdG8gdGhlIGNhY2hlLiBBZGRzIHRoZSBnaXZlbiBzaXplIGRlbHRhIHRvIHRoZSBjYWNoZWQgc2l6ZS5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuYWRkRW50cmllcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZW50cmllcywgc2l6ZURlbHRhKSB7XHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgaWYgKGVudHJpZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgZG9jdW1lbnRTdG9yZSA9IHJlbW90ZURvY3VtZW50c1N0b3JlKHRyYW5zYWN0aW9uKTtcclxuICAgICAgICAgICAgdmFyIGNoYW5nZWRLZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBlbnRyaWVzXzEgPSBlbnRyaWVzOyBfaSA8IGVudHJpZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBfYSA9IGVudHJpZXNfMVtfaV0sIGtleSA9IF9hLmtleSwgZG9jID0gX2EuZG9jO1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChkb2N1bWVudFN0b3JlLnB1dChkYktleShrZXkpLCBkb2MpKTtcclxuICAgICAgICAgICAgICAgIGNoYW5nZWRLZXlzID0gY2hhbmdlZEtleXMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMua2VlcERvY3VtZW50Q2hhbmdlTG9nKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKGRvY3VtZW50Q2hhbmdlc1N0b3JlKHRyYW5zYWN0aW9uKS5wdXQoe1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZXM6IHRoaXMuc2VyaWFsaXplci50b0RiUmVzb3VyY2VQYXRocyhjaGFuZ2VkS2V5cylcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMudXBkYXRlU2l6ZSh0cmFuc2FjdGlvbiwgc2l6ZURlbHRhKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIGEgZG9jdW1lbnQgZnJvbSB0aGUgY2FjaGUuIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBkb2VzICpub3QqIGRvIGFueVxyXG4gICAgICogc2l6ZSBhY2NvdW50aW5nLiBJdCBpcyB0aGUgcmVzcG9uc2liaWxpdHkgb2YgdGhlIGNhbGxlciB0byBjb3VudCB0aGUgYnl0ZXMgcmVtb3ZlZFxyXG4gICAgICogYW5kIGlzc3VlIGEgZmluYWwgdXBkYXRlU2l6ZSgpIGNhbGwgYWZ0ZXIgcmVtb3ZpbmcgZG9jdW1lbnRzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSBUaGUga2V5IG9mIHRoZSBkb2N1bWVudCB0byByZW1vdmVcclxuICAgICAqIEByZXR1cm4gVGhlIHNpemUgb2YgdGhlIGRvY3VtZW50IHRoYXQgd2FzIHJlbW92ZWQuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLnJlbW92ZUVudHJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIC8vIFdlIGRvbid0IG5lZWQgdG8ga2VlcCBjaGFuZ2Vsb2cgZm9yIHRoZXNlIHJlbW92YWxzIHNpbmNlIGByZW1vdmVFbnRyeWAgaXNcclxuICAgICAgICAvLyBvbmx5IHVzZWQgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbi5cclxuICAgICAgICB2YXIgc3RvcmUgPSByZW1vdGVEb2N1bWVudHNTdG9yZSh0cmFuc2FjdGlvbik7XHJcbiAgICAgICAgdmFyIGtleSA9IGRiS2V5KGRvY3VtZW50S2V5KTtcclxuICAgICAgICByZXR1cm4gc3RvcmUuZ2V0KGtleSkubmV4dChmdW5jdGlvbiAoZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RvcmUuZGVsZXRlKGtleSkubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBkYkRvY3VtZW50U2l6ZShkb2N1bWVudCk7IH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0RW50cnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gcmVtb3RlRG9jdW1lbnRzU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5nZXQoZGJLZXkoZG9jdW1lbnRLZXkpKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoZGJSZW1vdGVEb2MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRiUmVtb3RlRG9jXHJcbiAgICAgICAgICAgICAgICA/IF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiUmVtb3RlRG9jdW1lbnQoZGJSZW1vdGVEb2MpXHJcbiAgICAgICAgICAgICAgICA6IG51bGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBMb29rcyB1cCBhbiBlbnRyeSBpbiB0aGUgY2FjaGUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRvY3VtZW50S2V5IFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGxvb2sgdXAuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBjYWNoZWQgTWF5YmVEb2N1bWVudCBlbnRyeSBhbmQgaXRzIHNpemUsIG9yIG51bGwgaWYgd2UgaGF2ZSBub3RoaW5nIGNhY2hlZC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0U2l6ZWRFbnRyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiByZW1vdGVEb2N1bWVudHNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLmdldChkYktleShkb2N1bWVudEtleSkpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChkYlJlbW90ZURvYykge1xyXG4gICAgICAgICAgICByZXR1cm4gZGJSZW1vdGVEb2NcclxuICAgICAgICAgICAgICAgID8ge1xyXG4gICAgICAgICAgICAgICAgICAgIG1heWJlRG9jdW1lbnQ6IF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiUmVtb3RlRG9jdW1lbnQoZGJSZW1vdGVEb2MpLFxyXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IGRiRG9jdW1lbnRTaXplKGRiUmVtb3RlRG9jKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IGRvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgLy8gRG9jdW1lbnRzIGFyZSBvcmRlcmVkIGJ5IGtleSwgc28gd2UgY2FuIHVzZSBhIHByZWZpeCBzY2FuIHRvIG5hcnJvdyBkb3duXHJcbiAgICAgICAgLy8gdGhlIGRvY3VtZW50cyB3ZSBuZWVkIHRvIG1hdGNoIHRoZSBxdWVyeSBhZ2FpbnN0LlxyXG4gICAgICAgIHZhciBzdGFydEtleSA9IHF1ZXJ5LnBhdGgudG9BcnJheSgpO1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoc3RhcnRLZXkpO1xyXG4gICAgICAgIHJldHVybiByZW1vdGVEb2N1bWVudHNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLml0ZXJhdGUoeyByYW5nZTogcmFuZ2UgfSwgZnVuY3Rpb24gKGtleSwgZGJSZW1vdGVEb2MsIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgdmFyIG1heWJlRG9jID0gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJSZW1vdGVEb2N1bWVudChkYlJlbW90ZURvYyk7XHJcbiAgICAgICAgICAgIGlmICghcXVlcnkucGF0aC5pc1ByZWZpeE9mKG1heWJlRG9jLmtleS5wYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCAmJiBxdWVyeS5tYXRjaGVzKG1heWJlRG9jKSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuaW5zZXJ0KG1heWJlRG9jLmtleSwgbWF5YmVEb2MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0czsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQodGhpcy5rZWVwRG9jdW1lbnRDaGFuZ2VMb2csICdDYW4gb25seSBjYWxsIGdldE5ld0RvY3VtZW50Q2hhbmdlcygpIHdoZW4gZG9jdW1lbnQgY2hhbmdlIGxvZyBpcyBlbmFibGVkJyk7XHJcbiAgICAgICAgdmFyIGNoYW5nZWRLZXlzID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB2YXIgY2hhbmdlZERvY3MgPSBtYXliZURvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZCh0aGlzLl9sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCArIDEpO1xyXG4gICAgICAgIHZhciBmaXJzdEl0ZXJhdGlvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIGNoYW5nZXNTdG9yZSA9IGRvY3VtZW50Q2hhbmdlc1N0b3JlKHRyYW5zYWN0aW9uKTtcclxuICAgICAgICByZXR1cm4gY2hhbmdlc1N0b3JlXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHsgcmFuZ2U6IHJhbmdlIH0sIGZ1bmN0aW9uIChfLCBkb2N1bWVudENoYW5nZSkge1xyXG4gICAgICAgICAgICBpZiAoZmlyc3RJdGVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0SXRlcmF0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiBvdXIgY2xpZW50IHdhcyB0aHJvdHRsZWQgZm9yIG1vcmUgdGhhbiAzMCBtaW51dGVzLCBhbm90aGVyXHJcbiAgICAgICAgICAgICAgICAvLyBjbGllbnQgbWF5IGhhdmUgZ2FyYmFnZSBjb2xsZWN0ZWQgdGhlIHJlbW90ZSBkb2N1bWVudCBjaGFuZ2Vsb2cuXHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2xhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkICsgMSAhPT0gZG9jdW1lbnRDaGFuZ2UuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBSZXNldCB0aGUgYGxhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkYCB0byBhbGxvdyBmdXJ0aGVyXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaW52b2NhdGlvbnMgdG8gc3VjY2Vzc2Z1bGx5IHJldHVybiB0aGUgY2hhbmdlcyBhZnRlciB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVqZWN0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zeW5jaHJvbml6ZUxhc3REb2N1bWVudENoYW5nZUlkKGNoYW5nZXNTdG9yZSkubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkRBVEFfTE9TUywgUkVNT1RFX0RPQ1VNRU5UX0NIQU5HRV9NSVNTSU5HX0VSUl9NU0cpKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjaGFuZ2VkS2V5cyA9IGNoYW5nZWRLZXlzLnVuaW9uV2l0aChfdGhpcy5zZXJpYWxpemVyLmZyb21EYlJlc291cmNlUGF0aHMoZG9jdW1lbnRDaGFuZ2UuY2hhbmdlcykpO1xyXG4gICAgICAgICAgICBfdGhpcy5fbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQgPSBkb2N1bWVudENoYW5nZS5pZDtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBkb2N1bWVudFByb21pc2VzID0gW107XHJcbiAgICAgICAgICAgIGNoYW5nZWRLZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRQcm9taXNlcy5wdXNoKF90aGlzLmdldEVudHJ5KHRyYW5zYWN0aW9uLCBrZXkpLm5leHQoZnVuY3Rpb24gKG1heWJlRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gbWF5YmVEb2N1bWVudCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm9Eb2N1bWVudChrZXksIFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWREb2NzID0gY2hhbmdlZERvY3MuaW5zZXJ0KGtleSwgZG9jKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihkb2N1bWVudFByb21pc2VzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBjaGFuZ2VkRG9jczsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIGFsbCBjaGFuZ2VzIGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2hhbmdlbG9nIHRocm91Z2ggYGNoYW5nZUlkYFxyXG4gICAgICogKGluY2x1c2l2ZSkuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLnJlbW92ZURvY3VtZW50Q2hhbmdlc1Rocm91Z2hDaGFuZ2VJZCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgY2hhbmdlSWQpIHtcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS51cHBlckJvdW5kKGNoYW5nZUlkKTtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnRDaGFuZ2VzU3RvcmUodHJhbnNhY3Rpb24pLmRlbGV0ZShyYW5nZSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuc3luY2hyb25pemVMYXN0RG9jdW1lbnRDaGFuZ2VJZCA9IGZ1bmN0aW9uIChkb2N1bWVudENoYW5nZXNTdG9yZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gSWYgdGhlcmUgYXJlIG5vIGV4aXN0aW5nIGNoYW5nZXMsIHdlIHNldCBgbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWRgXHJcbiAgICAgICAgLy8gdG8gMCBzaW5jZSBJbmRleGVkRGIncyBhdXRvLWdlbmVyYXRlZCBrZXlzIHN0YXJ0IGF0IDEuXHJcbiAgICAgICAgdGhpcy5fbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQgPSAwO1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudENoYW5nZXNTdG9yZS5pdGVyYXRlKHsga2V5c09ubHk6IHRydWUsIHJldmVyc2U6IHRydWUgfSwgZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgX3RoaXMuX2xhc3RQcm9jZXNzZWREb2N1bWVudENoYW5nZUlkID0ga2V5O1xyXG4gICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5uZXdDaGFuZ2VCdWZmZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcih0aGlzKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXRTaXplID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE1ldGFkYXRhKHR4bikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHsgcmV0dXJuIG1ldGFkYXRhLmJ5dGVTaXplOyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXRNZXRhZGF0YSA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnRHbG9iYWxTdG9yZSh0eG4pXHJcbiAgICAgICAgICAgIC5nZXQoRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5rZXkpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICBhc3NlcnQoISFtZXRhZGF0YSwgJ01pc3NpbmcgZG9jdW1lbnQgY2FjaGUgbWV0YWRhdGEnKTtcclxuICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLnNldE1ldGFkYXRhID0gZnVuY3Rpb24gKHR4biwgbWV0YWRhdGEpIHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnRHbG9iYWxTdG9yZSh0eG4pLnB1dChEYlJlbW90ZURvY3VtZW50R2xvYmFsLmtleSwgbWV0YWRhdGEpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWRkcyB0aGUgZ2l2ZW4gZGVsdGEgdG8gdGhlIGNhY2hlZCBjdXJyZW50IHNpemUuIENhbGxlcnMgdG8gcmVtb3ZlRW50cnkgKm11c3QqIGNhbGwgdGhpc1xyXG4gICAgICogYWZ0ZXJ3YXJkcyB0byB1cGRhdGUgdGhlIHNpemUgb2YgdGhlIGNhY2hlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzaXplRGVsdGFcclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUudXBkYXRlU2l6ZSA9IGZ1bmN0aW9uICh0eG4sIHNpemVEZWx0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TWV0YWRhdGEodHhuKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5ieXRlU2l6ZSArPSBzaXplRGVsdGE7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zZXRNZXRhZGF0YSh0eG4sIG1ldGFkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZTtcclxufSgpKTtcclxuZnVuY3Rpb24gZG9jdW1lbnRHbG9iYWxTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiUmVtb3RlRG9jdW1lbnRHbG9iYWwuc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBIYW5kbGVzIHRoZSBkZXRhaWxzIG9mIGFkZGluZyBhbmQgdXBkYXRpbmcgZG9jdW1lbnRzIGluIHRoZSBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlXHJcbiAqL1xyXG52YXIgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhJbmRleGVkRGJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyKGRvY3VtZW50Q2FjaGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmRvY3VtZW50Q2FjaGUgPSBkb2N1bWVudENhY2hlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLnByb3RvdHlwZS5hcHBseUNoYW5nZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gdGhpcy5hc3NlcnRDaGFuZ2VzKCk7XHJcbiAgICAgICAgdmFyIGRlbHRhID0gMDtcclxuICAgICAgICB2YXIgdG9BcHBseSA9IFtdO1xyXG4gICAgICAgIGNoYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCBtYXliZURvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBkb2MgPSBfdGhpcy5kb2N1bWVudENhY2hlLnNlcmlhbGl6ZXIudG9EYlJlbW90ZURvY3VtZW50KG1heWJlRG9jdW1lbnQpO1xyXG4gICAgICAgICAgICB2YXIgcHJldmlvdXNTaXplID0gX3RoaXMuZG9jdW1lbnRTaXplcy5nZXQoa2V5KTtcclxuICAgICAgICAgICAgLy8gTk9URTogaWYgd2UgZXZlciBkZWNpZGUgd2UgbmVlZCB0byBzdXBwb3J0IGRvaW5nIHdyaXRlcyB3aXRob3V0XHJcbiAgICAgICAgICAgIC8vIHJlYWRpbmcgZmlyc3QsIHRoaXMgYXNzZXJ0IHdpbGwgbmVlZCB0byBjaGFuZ2UgdG8gZG8gdGhlIHJlYWQgYXV0b21hdGljYWxseS5cclxuICAgICAgICAgICAgYXNzZXJ0KHByZXZpb3VzU2l6ZSAhPT0gdW5kZWZpbmVkLCBcIkF0dGVtcHRpbmcgdG8gY2hhbmdlIGRvY3VtZW50IFwiICsga2V5LnRvU3RyaW5nKCkgKyBcIiB3aXRob3V0IGhhdmluZyByZWFkIGl0IGZpcnN0XCIpO1xyXG4gICAgICAgICAgICB2YXIgc2l6ZSA9IGRiRG9jdW1lbnRTaXplKGRvYyk7XHJcbiAgICAgICAgICAgIGRlbHRhICs9IHNpemUgLSBwcmV2aW91c1NpemU7XHJcbiAgICAgICAgICAgIHRvQXBwbHkucHVzaCh7IGtleToga2V5LCBkb2M6IGRvYyB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudENhY2hlLmFkZEVudHJpZXModHJhbnNhY3Rpb24sIHRvQXBwbHksIGRlbHRhKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlci5wcm90b3R5cGUuZ2V0RnJvbUNhY2hlID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50Q2FjaGUuZ2V0U2l6ZWRFbnRyeSh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcjtcclxufShSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlcikpO1xyXG5mdW5jdGlvbiBpc0RvY3VtZW50Q2hhbmdlTWlzc2luZ0Vycm9yKGVycikge1xyXG4gICAgcmV0dXJuIChlcnIuY29kZSA9PT0gQ29kZS5EQVRBX0xPU1MgJiZcclxuICAgICAgICBlcnIubWVzc2FnZSA9PT0gUkVNT1RFX0RPQ1VNRU5UX0NIQU5HRV9NSVNTSU5HX0VSUl9NU0cpO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHJlbW90ZURvY3VtZW50cyBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiByZW1vdGVEb2N1bWVudHNTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiUmVtb3RlRG9jdW1lbnQuc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHJlbW90ZURvY3VtZW50Q2hhbmdlcyBvYmplY3RcclxuICogc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBkb2N1bWVudENoYW5nZXNTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzLnN0b3JlKTtcclxufVxyXG5mdW5jdGlvbiBkYktleShkb2NLZXkpIHtcclxuICAgIHJldHVybiBkb2NLZXkucGF0aC50b0FycmF5KCk7XHJcbn1cclxuLyoqXHJcbiAqIFJldHJ1c24gYW4gYXBwcm94aW1hdGUgc2l6ZSBmb3IgdGhlIGdpdmVuIGRvY3VtZW50LlxyXG4gKi9cclxuZnVuY3Rpb24gZGJEb2N1bWVudFNpemUoZG9jKSB7XHJcbiAgICB2YXIgdmFsdWU7XHJcbiAgICBpZiAoZG9jLmRvY3VtZW50KSB7XHJcbiAgICAgICAgdmFsdWUgPSBkb2MuZG9jdW1lbnQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChkb2MudW5rbm93bkRvY3VtZW50KSB7XHJcbiAgICAgICAgdmFsdWUgPSBkb2MudW5rbm93bkRvY3VtZW50O1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoZG9jLm5vRG9jdW1lbnQpIHtcclxuICAgICAgICB2YWx1ZSA9IGRvYy5ub0RvY3VtZW50O1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgZmFpbCgnVW5rbm93biByZW1vdGUgZG9jdW1lbnQgdHlwZScpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbHVlKS5sZW5ndGg7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBTY2hlbWEgVmVyc2lvbiBmb3IgdGhlIFdlYiBjbGllbnQ6XHJcbiAqIDEuIEluaXRpYWwgdmVyc2lvbiBpbmNsdWRpbmcgTXV0YXRpb24gUXVldWUsIFF1ZXJ5IENhY2hlLCBhbmQgUmVtb3RlIERvY3VtZW50XHJcbiAqICAgIENhY2hlXHJcbiAqIDIuIFVzZWQgdG8gZW5zdXJlIGEgdGFyZ2V0R2xvYmFsIG9iamVjdCBleGlzdHMgYW5kIGFkZCB0YXJnZXRDb3VudCB0byBpdC4gTm9cclxuICogICAgbG9uZ2VyIHJlcXVpcmVkIGJlY2F1c2UgbWlncmF0aW9uIDMgdW5jb25kaXRpb25hbGx5IGNsZWFycyBpdC5cclxuICogMy4gRHJvcHBlZCBhbmQgcmUtY3JlYXRlZCBRdWVyeSBDYWNoZSB0byBkZWFsIHdpdGggY2FjaGUgY29ycnVwdGlvbiByZWxhdGVkXHJcbiAqICAgIHRvIGxpbWJvIHJlc29sdXRpb24uIEFkZHJlc3Nlc1xyXG4gKiAgICBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtaW9zLXNkay9pc3N1ZXMvMTU0OFxyXG4gKiA0LiBNdWx0aS1UYWIgU3VwcG9ydC5cclxuICogNS4gUmVtb3ZhbCBvZiBoZWxkIHdyaXRlIGFja3MuXHJcbiAqL1xyXG52YXIgU0NIRU1BX1ZFUlNJT04gPSA2O1xyXG4vKiogUGVyZm9ybXMgZGF0YWJhc2UgY3JlYXRpb24gYW5kIHNjaGVtYSB1cGdyYWRlcy4gKi9cclxudmFyIFNjaGVtYUNvbnZlcnRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNjaGVtYUNvbnZlcnRlcihzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGVyZm9ybXMgZGF0YWJhc2UgY3JlYXRpb24gYW5kIHNjaGVtYSB1cGdyYWRlcy5cclxuICAgICAqXHJcbiAgICAgKiBOb3RlIHRoYXQgaW4gcHJvZHVjdGlvbiwgdGhpcyBtZXRob2QgaXMgb25seSBldmVyIHVzZWQgdG8gdXBncmFkZSB0aGUgc2NoZW1hXHJcbiAgICAgKiB0byBTQ0hFTUFfVkVSU0lPTi4gRGlmZmVyZW50IHZhbHVlcyBvZiB0b1ZlcnNpb24gYXJlIG9ubHkgdXNlZCBmb3IgdGVzdGluZ1xyXG4gICAgICogYW5kIGxvY2FsIGZlYXR1cmUgZGV2ZWxvcG1lbnQuXHJcbiAgICAgKi9cclxuICAgIFNjaGVtYUNvbnZlcnRlci5wcm90b3R5cGUuY3JlYXRlT3JVcGdyYWRlID0gZnVuY3Rpb24gKGRiLCB0eG4sIGZyb21WZXJzaW9uLCB0b1ZlcnNpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydChmcm9tVmVyc2lvbiA8IHRvVmVyc2lvbiAmJlxyXG4gICAgICAgICAgICBmcm9tVmVyc2lvbiA+PSAwICYmXHJcbiAgICAgICAgICAgIHRvVmVyc2lvbiA8PSBTQ0hFTUFfVkVSU0lPTiwgXCJVbmV4cGVjdGVkIHNjaGVtYSB1cGdyYWRlIGZyb20gdlwiICsgZnJvbVZlcnNpb24gKyBcIiB0byB2e3RvVmVyc2lvbn0uXCIpO1xyXG4gICAgICAgIGlmIChmcm9tVmVyc2lvbiA8IDEgJiYgdG9WZXJzaW9uID49IDEpIHtcclxuICAgICAgICAgICAgY3JlYXRlUHJpbWFyeUNsaWVudFN0b3JlKGRiKTtcclxuICAgICAgICAgICAgY3JlYXRlTXV0YXRpb25RdWV1ZShkYik7XHJcbiAgICAgICAgICAgIGNyZWF0ZVF1ZXJ5Q2FjaGUoZGIpO1xyXG4gICAgICAgICAgICBjcmVhdGVSZW1vdGVEb2N1bWVudENhY2hlKGRiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gTWlncmF0aW9uIDIgdG8gcG9wdWxhdGUgdGhlIHRhcmdldEdsb2JhbCBvYmplY3Qgbm8gbG9uZ2VyIG5lZWRlZCBzaW5jZVxyXG4gICAgICAgIC8vIG1pZ3JhdGlvbiAzIHVuY29uZGl0aW9uYWxseSBjbGVhcnMgaXQuXHJcbiAgICAgICAgdmFyIHAgPSBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIGlmIChmcm9tVmVyc2lvbiA8IDMgJiYgdG9WZXJzaW9uID49IDMpIHtcclxuICAgICAgICAgICAgLy8gQnJhbmQgbmV3IGNsaWVudHMgZG9uJ3QgbmVlZCB0byBkcm9wIGFuZCByZWNyZWF0ZS0tb25seSBjbGllbnRzIHRoYXRcclxuICAgICAgICAgICAgLy8gcG90ZW50aWFsbHkgaGF2ZSBjb3JydXB0IGRhdGEuXHJcbiAgICAgICAgICAgIGlmIChmcm9tVmVyc2lvbiAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgZHJvcFF1ZXJ5Q2FjaGUoZGIpO1xyXG4gICAgICAgICAgICAgICAgY3JlYXRlUXVlcnlDYWNoZShkYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcCA9IHAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiB3cml0ZUVtcHR5VGFyZ2V0R2xvYmFsRW50cnkodHhuKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmcm9tVmVyc2lvbiA8IDQgJiYgdG9WZXJzaW9uID49IDQpIHtcclxuICAgICAgICAgICAgaWYgKGZyb21WZXJzaW9uICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBTY2hlbWEgdmVyc2lvbiAzIHVzZXMgYXV0by1nZW5lcmF0ZWQga2V5cyB0byBnZW5lcmF0ZSBnbG9iYWxseSB1bmlxdWVcclxuICAgICAgICAgICAgICAgIC8vIG11dGF0aW9uIGJhdGNoIElEcyAodGhpcyB3YXMgcHJldmlvdXNseSBlbnN1cmVkIGludGVybmFsbHkgYnkgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyBjbGllbnQpLiBUbyBtaWdyYXRlIHRvIHRoZSBuZXcgc2NoZW1hLCB3ZSBoYXZlIHRvIHJlYWQgYWxsIG11dGF0aW9uc1xyXG4gICAgICAgICAgICAgICAgLy8gYW5kIHdyaXRlIHRoZW0gYmFjayBvdXQuIFdlIHByZXNlcnZlIHRoZSBleGlzdGluZyBiYXRjaCBJRHMgdG8gZ3VhcmFudGVlXHJcbiAgICAgICAgICAgICAgICAvLyBjb25zaXN0ZW5jeSB3aXRoIG90aGVyIG9iamVjdCBzdG9yZXMuIEFueSBmdXJ0aGVyIG11dGF0aW9uIGJhdGNoIElEcyB3aWxsXHJcbiAgICAgICAgICAgICAgICAvLyBiZSBhdXRvLWdlbmVyYXRlZC5cclxuICAgICAgICAgICAgICAgIHAgPSBwLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gdXBncmFkZU11dGF0aW9uQmF0Y2hTY2hlbWFBbmRNaWdyYXRlRGF0YShkYiwgdHhuKTsgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcCA9IHAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVDbGllbnRNZXRhZGF0YVN0b3JlKGRiKTtcclxuICAgICAgICAgICAgICAgIGNyZWF0ZVJlbW90ZURvY3VtZW50Q2hhbmdlc1N0b3JlKGRiKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmcm9tVmVyc2lvbiA8IDUgJiYgdG9WZXJzaW9uID49IDUpIHtcclxuICAgICAgICAgICAgcCA9IHAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5yZW1vdmVBY2tub3dsZWRnZWRNdXRhdGlvbnModHhuKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChmcm9tVmVyc2lvbiA8IDYgJiYgdG9WZXJzaW9uID49IDYpIHtcclxuICAgICAgICAgICAgcCA9IHAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVEb2N1bWVudEdsb2JhbFN0b3JlKGRiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5hZGREb2N1bWVudEdsb2JhbCh0eG4pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHA7XHJcbiAgICB9O1xyXG4gICAgU2NoZW1hQ29udmVydGVyLnByb3RvdHlwZS5hZGREb2N1bWVudEdsb2JhbCA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgYnl0ZUNvdW50ID0gMDtcclxuICAgICAgICByZXR1cm4gdHhuXHJcbiAgICAgICAgICAgIC5zdG9yZShEYlJlbW90ZURvY3VtZW50LnN0b3JlKVxyXG4gICAgICAgICAgICAuaXRlcmF0ZShmdW5jdGlvbiAoXywgZG9jKSB7XHJcbiAgICAgICAgICAgIGJ5dGVDb3VudCArPSBkYkRvY3VtZW50U2l6ZShkb2MpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG1ldGFkYXRhID0gbmV3IERiUmVtb3RlRG9jdW1lbnRHbG9iYWwoYnl0ZUNvdW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIHR4blxyXG4gICAgICAgICAgICAgICAgLnN0b3JlKERiUmVtb3RlRG9jdW1lbnRHbG9iYWwuc3RvcmUpXHJcbiAgICAgICAgICAgICAgICAucHV0KERiUmVtb3RlRG9jdW1lbnRHbG9iYWwua2V5LCBtZXRhZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2NoZW1hQ29udmVydGVyLnByb3RvdHlwZS5yZW1vdmVBY2tub3dsZWRnZWRNdXRhdGlvbnMgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcXVldWVzU3RvcmUgPSB0eG4uc3RvcmUoRGJNdXRhdGlvblF1ZXVlLnN0b3JlKTtcclxuICAgICAgICB2YXIgbXV0YXRpb25zU3RvcmUgPSB0eG4uc3RvcmUoRGJNdXRhdGlvbkJhdGNoLnN0b3JlKTtcclxuICAgICAgICByZXR1cm4gcXVldWVzU3RvcmUubG9hZEFsbCgpLm5leHQoZnVuY3Rpb24gKHF1ZXVlcykge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2gocXVldWVzLCBmdW5jdGlvbiAocXVldWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmJvdW5kKFtxdWV1ZS51c2VySWQsIEJBVENISURfVU5LTk9XTl0sIFtxdWV1ZS51c2VySWQsIHF1ZXVlLmxhc3RBY2tub3dsZWRnZWRCYXRjaElkXSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbXV0YXRpb25zU3RvcmVcclxuICAgICAgICAgICAgICAgICAgICAubG9hZEFsbChEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0luZGV4LCByYW5nZSlcclxuICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoZGJCYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKGRiQmF0Y2hlcywgZnVuY3Rpb24gKGRiQmF0Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KGRiQmF0Y2gudXNlcklkID09PSBxdWV1ZS51c2VySWQsIFwiQ2Fubm90IHByb2Nlc3MgYmF0Y2ggXCIgKyBkYkJhdGNoLmJhdGNoSWQgKyBcIiBmcm9tIHVuZXhwZWN0ZWQgdXNlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJhdGNoID0gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJNdXRhdGlvbkJhdGNoKGRiQmF0Y2gpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVtb3ZlTXV0YXRpb25CYXRjaCh0eG4sIHF1ZXVlLnVzZXJJZCwgYmF0Y2gpLm5leHQoZnVuY3Rpb24gKCkgeyB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2NoZW1hQ29udmVydGVyO1xyXG59KCkpO1xyXG4vKipcclxuICogV3JhcHBlciBjbGFzcyB0byBzdG9yZSB0aW1lc3RhbXBzIChzZWNvbmRzIGFuZCBuYW5vcykgaW4gSW5kZXhlZERiIG9iamVjdHMuXHJcbiAqL1xyXG52YXIgRGJUaW1lc3RhbXAgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYlRpbWVzdGFtcChzZWNvbmRzLCBuYW5vc2Vjb25kcykge1xyXG4gICAgICAgIHRoaXMuc2Vjb25kcyA9IHNlY29uZHM7XHJcbiAgICAgICAgdGhpcy5uYW5vc2Vjb25kcyA9IG5hbm9zZWNvbmRzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIERiVGltZXN0YW1wO1xyXG59KCkpO1xyXG4vKipcclxuICogQSBzaW5nbGV0b24gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ293bmVyJyBzdG9yZSBpbiBJbmRleGVkRGIuXHJcbiAqXHJcbiAqIEEgZ2l2ZW4gZGF0YWJhc2UgY2FuIGhhdmUgYSBzaW5nbGUgcHJpbWFyeSB0YWIgYXNzaWduZWQgYXQgYSBnaXZlbiB0aW1lLiBUaGF0XHJcbiAqIHRhYiBtdXN0IHZhbGlkYXRlIHRoYXQgaXQgaXMgc3RpbGwgaG9sZGluZyB0aGUgcHJpbWFyeSBsZWFzZSBiZWZvcmUgZXZlcnlcclxuICogb3BlcmF0aW9uIHRoYXQgcmVxdWlyZXMgbG9ja2VkIGFjY2Vzcy4gVGhlIHByaW1hcnkgdGFiIHNob3VsZCByZWd1bGFybHlcclxuICogd3JpdGUgYW4gdXBkYXRlZCB0aW1lc3RhbXAgdG8gdGhpcyBsZWFzZSB0byBwcmV2ZW50IG90aGVyIHRhYnMgZnJvbVxyXG4gKiBcInN0ZWFsaW5nXCIgdGhlIHByaW1hcnkgbGVhc2VcclxuICovXHJcbnZhciBEYlByaW1hcnlDbGllbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYlByaW1hcnlDbGllbnQob3duZXJJZCwgXHJcbiAgICAvKiogV2hldGhlciB0byBhbGxvdyBzaGFyZWQgYWNjZXNzIGZyb20gbXVsdGlwbGUgdGFicy4gKi9cclxuICAgIGFsbG93VGFiU3luY2hyb25pemF0aW9uLCBsZWFzZVRpbWVzdGFtcE1zKSB7XHJcbiAgICAgICAgdGhpcy5vd25lcklkID0gb3duZXJJZDtcclxuICAgICAgICB0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uID0gYWxsb3dUYWJTeW5jaHJvbml6YXRpb247XHJcbiAgICAgICAgdGhpcy5sZWFzZVRpbWVzdGFtcE1zID0gbGVhc2VUaW1lc3RhbXBNcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS5cclxuICAgICAqXHJcbiAgICAgKiBOb3RlIHRoYXQgdGhlIG5hbWUgJ293bmVyJyBpcyBjaG9zZW4gdG8gZW5zdXJlIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGhcclxuICAgICAqIG9sZGVyIGNsaWVudHMgdGhhdCBvbmx5IHN1cHBvcnRlZCBzaW5nbGUgbG9ja2VkIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2VcclxuICAgICAqIGxheWVyLlxyXG4gICAgICovXHJcbiAgICBEYlByaW1hcnlDbGllbnQuc3RvcmUgPSAnb3duZXInO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUga2V5IHN0cmluZyB1c2VkIGZvciB0aGUgc2luZ2xlIG9iamVjdCB0aGF0IGV4aXN0cyBpbiB0aGVcclxuICAgICAqIERiUHJpbWFyeUNsaWVudCBzdG9yZS5cclxuICAgICAqL1xyXG4gICAgRGJQcmltYXJ5Q2xpZW50LmtleSA9ICdvd25lcic7XHJcbiAgICByZXR1cm4gRGJQcmltYXJ5Q2xpZW50O1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjcmVhdGVQcmltYXJ5Q2xpZW50U3RvcmUoZGIpIHtcclxuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiUHJpbWFyeUNsaWVudC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIEFuIG9iamVjdCB0byBiZSBzdG9yZWQgaW4gdGhlICdtdXRhdGlvblF1ZXVlcycgc3RvcmUgaW4gSW5kZXhlZERiLlxyXG4gKlxyXG4gKiBFYWNoIHVzZXIgZ2V0cyBhIHNpbmdsZSBxdWV1ZSBvZiBNdXRhdGlvbkJhdGNoZXMgdG8gYXBwbHkgdG8gdGhlIHNlcnZlci5cclxuICogRGJNdXRhdGlvblF1ZXVlIHRyYWNrcyB0aGUgbWV0YWRhdGEgYWJvdXQgdGhlIHF1ZXVlLlxyXG4gKi9cclxudmFyIERiTXV0YXRpb25RdWV1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiTXV0YXRpb25RdWV1ZShcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG5vcm1hbGl6ZWQgdXNlciBJRCB0byB3aGljaCB0aGlzIHF1ZXVlIGJlbG9uZ3MuXHJcbiAgICAgKi9cclxuICAgIHVzZXJJZCwgXHJcbiAgICAvKipcclxuICAgICAqIEFuIGlkZW50aWZpZXIgZm9yIHRoZSBoaWdoZXN0IG51bWJlcmVkIGJhdGNoIHRoYXQgaGFzIGJlZW4gYWNrbm93bGVkZ2VkXHJcbiAgICAgKiBieSB0aGUgc2VydmVyLiBBbGwgTXV0YXRpb25CYXRjaGVzIGluIHRoaXMgcXVldWUgd2l0aCBiYXRjaElkcyBsZXNzXHJcbiAgICAgKiB0aGFuIG9yIGVxdWFsIHRvIHRoaXMgdmFsdWUgYXJlIGNvbnNpZGVyZWQgdG8gaGF2ZSBiZWVuIGFja25vd2xlZGdlZCBieVxyXG4gICAgICogdGhlIHNlcnZlci5cclxuICAgICAqL1xyXG4gICAgbGFzdEFja25vd2xlZGdlZEJhdGNoSWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHN0cmVhbSB0b2tlbiB0aGF0IHdhcyBwcmV2aW91c2x5IHNlbnQgYnkgdGhlIHNlcnZlci5cclxuICAgICAqXHJcbiAgICAgKiBTZWUgU3RyZWFtaW5nV3JpdGVSZXF1ZXN0IGluIGRhdGFzdG9yZS5wcm90byBmb3IgbW9yZSBkZXRhaWxzIGFib3V0XHJcbiAgICAgKiB1c2FnZS5cclxuICAgICAqXHJcbiAgICAgKiBBZnRlciBzZW5kaW5nIHRoaXMgdG9rZW4sIGVhcmxpZXIgdG9rZW5zIG1heSBub3QgYmUgdXNlZCBhbnltb3JlIHNvXHJcbiAgICAgKiBvbmx5IGEgc2luZ2xlIHN0cmVhbSB0b2tlbiBpcyByZXRhaW5lZC5cclxuICAgICAqL1xyXG4gICAgbGFzdFN0cmVhbVRva2VuKSB7XHJcbiAgICAgICAgdGhpcy51c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgdGhpcy5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCA9IGxhc3RBY2tub3dsZWRnZWRCYXRjaElkO1xyXG4gICAgICAgIHRoaXMubGFzdFN0cmVhbVRva2VuID0gbGFzdFN0cmVhbVRva2VuO1xyXG4gICAgfVxyXG4gICAgLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICAqL1xyXG4gICAgRGJNdXRhdGlvblF1ZXVlLnN0b3JlID0gJ211dGF0aW9uUXVldWVzJztcclxuICAgIC8qKiBLZXlzIGFyZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHZpYSB0aGUgdXNlcklkIHByb3BlcnR5LiAqL1xyXG4gICAgRGJNdXRhdGlvblF1ZXVlLmtleVBhdGggPSAndXNlcklkJztcclxuICAgIHJldHVybiBEYk11dGF0aW9uUXVldWU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAnbXV0YXRpb25zJyBzdG9yZSBpbiBJbmRleGVkRGIuXHJcbiAqXHJcbiAqIFJlcHJlc2VudHMgYSBiYXRjaCBvZiB1c2VyLWxldmVsIG11dGF0aW9ucyBpbnRlbmRlZCB0byBiZSBzZW50IHRvIHRoZSBzZXJ2ZXJcclxuICogaW4gYSBzaW5nbGUgd3JpdGUuIEVhY2ggdXNlci1sZXZlbCBiYXRjaCBnZXRzIGEgc2VwYXJhdGUgRGJNdXRhdGlvbkJhdGNoXHJcbiAqIHdpdGggYSBuZXcgYmF0Y2hJZC5cclxuICovXHJcbnZhciBEYk11dGF0aW9uQmF0Y2ggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYk11dGF0aW9uQmF0Y2goXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBub3JtYWxpemVkIHVzZXIgSUQgdG8gd2hpY2ggdGhpcyBiYXRjaCBiZWxvbmdzLlxyXG4gICAgICovXHJcbiAgICB1c2VySWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBbiBpZGVudGlmaWVyIGZvciB0aGlzIGJhdGNoLCBhbGxvY2F0ZWQgdXNpbmcgYW4gYXV0by1nZW5lcmF0ZWQga2V5LlxyXG4gICAgICovXHJcbiAgICBiYXRjaElkLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGxvY2FsIHdyaXRlIHRpbWUgb2YgdGhlIGJhdGNoLCBzdG9yZWQgYXMgbWlsbGlzZWNvbmRzIHNpbmNlIHRoZVxyXG4gICAgICogZXBvY2guXHJcbiAgICAgKi9cclxuICAgIGxvY2FsV3JpdGVUaW1lTXMsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIGxpc3Qgb2YgbXV0YXRpb25zIHRvIGFwcGx5LiBBbGwgbXV0YXRpb25zIHdpbGwgYmUgYXBwbGllZCBhdG9taWNhbGx5LlxyXG4gICAgICpcclxuICAgICAqIE11dGF0aW9ucyBhcmUgc2VyaWFsaXplZCB2aWEgSnNvblByb3RvU2VyaWFsaXplci50b011dGF0aW9uKCkuXHJcbiAgICAgKi9cclxuICAgIG11dGF0aW9ucykge1xyXG4gICAgICAgIHRoaXMudXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuYmF0Y2hJZCA9IGJhdGNoSWQ7XHJcbiAgICAgICAgdGhpcy5sb2NhbFdyaXRlVGltZU1zID0gbG9jYWxXcml0ZVRpbWVNcztcclxuICAgICAgICB0aGlzLm11dGF0aW9ucyA9IG11dGF0aW9ucztcclxuICAgIH1cclxuICAgIC8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAgKi9cclxuICAgIERiTXV0YXRpb25CYXRjaC5zdG9yZSA9ICdtdXRhdGlvbnMnO1xyXG4gICAgLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB1c2VySWQsIGJhdGNoSWQgcHJvcGVydGllcy4gKi9cclxuICAgIERiTXV0YXRpb25CYXRjaC5rZXlQYXRoID0gJ2JhdGNoSWQnO1xyXG4gICAgLyoqIFRoZSBpbmRleCBuYW1lIGZvciBsb29rdXAgb2YgbXV0YXRpb25zIGJ5IHVzZXIuICovXHJcbiAgICBEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0luZGV4ID0gJ3VzZXJNdXRhdGlvbnNJbmRleCc7XHJcbiAgICAvKiogVGhlIHVzZXIgbXV0YXRpb25zIGluZGV4IGlzIGtleWVkIGJ5IFt1c2VySWQsIGJhdGNoSWRdIHBhaXJzLiAqL1xyXG4gICAgRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNLZXlQYXRoID0gWyd1c2VySWQnLCAnYmF0Y2hJZCddO1xyXG4gICAgcmV0dXJuIERiTXV0YXRpb25CYXRjaDtcclxufSgpKTtcclxuZnVuY3Rpb24gY3JlYXRlTXV0YXRpb25RdWV1ZShkYikge1xyXG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJNdXRhdGlvblF1ZXVlLnN0b3JlLCB7XHJcbiAgICAgICAga2V5UGF0aDogRGJNdXRhdGlvblF1ZXVlLmtleVBhdGhcclxuICAgIH0pO1xyXG4gICAgdmFyIG11dGF0aW9uQmF0Y2hlc1N0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJNdXRhdGlvbkJhdGNoLnN0b3JlLCB7XHJcbiAgICAgICAga2V5UGF0aDogRGJNdXRhdGlvbkJhdGNoLmtleVBhdGgsXHJcbiAgICAgICAgYXV0b0luY3JlbWVudDogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBtdXRhdGlvbkJhdGNoZXNTdG9yZS5jcmVhdGVJbmRleChEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0luZGV4LCBEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0tleVBhdGgsIHsgdW5pcXVlOiB0cnVlIH0pO1xyXG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJEb2N1bWVudE11dGF0aW9uLnN0b3JlKTtcclxufVxyXG4vKipcclxuICogVXBncmFkZSBmdW5jdGlvbiB0byBtaWdyYXRlIHRoZSAnbXV0YXRpb25zJyBzdG9yZSBmcm9tIFYxIHRvIFYzLiBMb2Fkc1xyXG4gKiBhbmQgcmV3cml0ZXMgYWxsIGRhdGEuXHJcbiAqL1xyXG5mdW5jdGlvbiB1cGdyYWRlTXV0YXRpb25CYXRjaFNjaGVtYUFuZE1pZ3JhdGVEYXRhKGRiLCB0eG4pIHtcclxuICAgIHZhciB2MU11dGF0aW9uc1N0b3JlID0gdHhuLnN0b3JlKERiTXV0YXRpb25CYXRjaC5zdG9yZSk7XHJcbiAgICByZXR1cm4gdjFNdXRhdGlvbnNTdG9yZS5sb2FkQWxsKCkubmV4dChmdW5jdGlvbiAoZXhpc3RpbmdNdXRhdGlvbnMpIHtcclxuICAgICAgICBkYi5kZWxldGVPYmplY3RTdG9yZShEYk11dGF0aW9uQmF0Y2guc3RvcmUpO1xyXG4gICAgICAgIHZhciBtdXRhdGlvbnNTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiTXV0YXRpb25CYXRjaC5zdG9yZSwge1xyXG4gICAgICAgICAgICBrZXlQYXRoOiBEYk11dGF0aW9uQmF0Y2gua2V5UGF0aCxcclxuICAgICAgICAgICAgYXV0b0luY3JlbWVudDogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG11dGF0aW9uc1N0b3JlLmNyZWF0ZUluZGV4KERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zSW5kZXgsIERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zS2V5UGF0aCwgeyB1bmlxdWU6IHRydWUgfSk7XHJcbiAgICAgICAgdmFyIHYzTXV0YXRpb25zU3RvcmUgPSB0eG4uc3RvcmUoRGJNdXRhdGlvbkJhdGNoLnN0b3JlKTtcclxuICAgICAgICB2YXIgd3JpdGVBbGwgPSBleGlzdGluZ011dGF0aW9ucy5tYXAoZnVuY3Rpb24gKG11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2M011dGF0aW9uc1N0b3JlLnB1dChtdXRhdGlvbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHdyaXRlQWxsKTtcclxuICAgIH0pO1xyXG59XHJcbi8qKlxyXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAnZG9jdW1lbnRNdXRhdGlvbnMnIHN0b3JlIGluIEluZGV4ZWREYi5cclxuICpcclxuICogQSBtYW51YWxseSBtYWludGFpbmVkIGluZGV4IG9mIGFsbCB0aGUgbXV0YXRpb24gYmF0Y2hlcyB0aGF0IGFmZmVjdCBhIGdpdmVuXHJcbiAqIGRvY3VtZW50IGtleS4gVGhlIHJvd3MgaW4gdGhpcyB0YWJsZSBhcmUgcmVmZXJlbmNlcyBiYXNlZCBvbiB0aGUgY29udGVudHMgb2ZcclxuICogRGJNdXRhdGlvbkJhdGNoLm11dGF0aW9ucy5cclxuICovXHJcbnZhciBEYkRvY3VtZW50TXV0YXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYkRvY3VtZW50TXV0YXRpb24oKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBbdXNlcklkXSBrZXkgZm9yIHVzZSBpbiB0aGUgRGJEb2N1bWVudE11dGF0aW9ucyBpbmRleCB0byBpdGVyYXRlXHJcbiAgICAgKiBvdmVyIGFsbCBvZiBhIHVzZXIncyBkb2N1bWVudCBtdXRhdGlvbnMuXHJcbiAgICAgKi9cclxuICAgIERiRG9jdW1lbnRNdXRhdGlvbi5wcmVmaXhGb3JVc2VyID0gZnVuY3Rpb24gKHVzZXJJZCkge1xyXG4gICAgICAgIHJldHVybiBbdXNlcklkXTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBbdXNlcklkLCBlbmNvZGVkUGF0aF0ga2V5IGZvciB1c2UgaW4gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnNcclxuICAgICAqIGluZGV4IHRvIGl0ZXJhdGUgb3ZlciBhbGwgYXQgZG9jdW1lbnQgbXV0YXRpb25zIGZvciBhIGdpdmVuIHBhdGggb3IgbG93ZXIuXHJcbiAgICAgKi9cclxuICAgIERiRG9jdW1lbnRNdXRhdGlvbi5wcmVmaXhGb3JQYXRoID0gZnVuY3Rpb24gKHVzZXJJZCwgcGF0aCkge1xyXG4gICAgICAgIHJldHVybiBbdXNlcklkLCBlbmNvZGUocGF0aCldO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIGZ1bGwgaW5kZXgga2V5IG9mIFt1c2VySWQsIGVuY29kZWRQYXRoLCBiYXRjaElkXSBmb3IgaW5zZXJ0aW5nXHJcbiAgICAgKiBhbmQgZGVsZXRpbmcgaW50byB0aGUgRGJEb2N1bWVudE11dGF0aW9ucyBpbmRleC5cclxuICAgICAqL1xyXG4gICAgRGJEb2N1bWVudE11dGF0aW9uLmtleSA9IGZ1bmN0aW9uICh1c2VySWQsIHBhdGgsIGJhdGNoSWQpIHtcclxuICAgICAgICByZXR1cm4gW3VzZXJJZCwgZW5jb2RlKHBhdGgpLCBiYXRjaElkXTtcclxuICAgIH07XHJcbiAgICBEYkRvY3VtZW50TXV0YXRpb24uc3RvcmUgPSAnZG9jdW1lbnRNdXRhdGlvbnMnO1xyXG4gICAgLyoqXHJcbiAgICAgKiBCZWNhdXNlIHdlIHN0b3JlIGFsbCB0aGUgdXNlZnVsIGluZm9ybWF0aW9uIGZvciB0aGlzIHN0b3JlIGluIHRoZSBrZXksXHJcbiAgICAgKiB0aGVyZSBpcyBubyB1c2VmdWwgaW5mb3JtYXRpb24gdG8gc3RvcmUgYXMgdGhlIHZhbHVlLiBUaGUgcmF3ICh1bmVuY29kZWQpXHJcbiAgICAgKiBwYXRoIGNhbm5vdCBiZSBzdG9yZWQgYmVjYXVzZSBJbmRleGVkRGIgZG9lc24ndCBzdG9yZSBwcm90b3R5cGVcclxuICAgICAqIGluZm9ybWF0aW9uLlxyXG4gICAgICovXHJcbiAgICBEYkRvY3VtZW50TXV0YXRpb24uUExBQ0VIT0xERVIgPSBuZXcgRGJEb2N1bWVudE11dGF0aW9uKCk7XHJcbiAgICByZXR1cm4gRGJEb2N1bWVudE11dGF0aW9uO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjcmVhdGVSZW1vdGVEb2N1bWVudENhY2hlKGRiKSB7XHJcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEYlJlbW90ZURvY3VtZW50LnN0b3JlKTtcclxufVxyXG4vKipcclxuICogUmVwcmVzZW50cyB0aGUga25vd24gYWJzZW5jZSBvZiBhIGRvY3VtZW50IGF0IGEgcGFydGljdWxhciB2ZXJzaW9uLlxyXG4gKiBTdG9yZWQgaW4gSW5kZXhlZERiIGFzIHBhcnQgb2YgYSBEYlJlbW90ZURvY3VtZW50IG9iamVjdC5cclxuICovXHJcbnZhciBEYk5vRG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYk5vRG9jdW1lbnQocGF0aCwgcmVhZFRpbWUpIHtcclxuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xyXG4gICAgICAgIHRoaXMucmVhZFRpbWUgPSByZWFkVGltZTtcclxuICAgIH1cclxuICAgIHJldHVybiBEYk5vRG9jdW1lbnQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBleGlzdCBidXQgd2hvc2UgZGF0YSBpcyB1bmtub3duLlxyXG4gKiBTdG9yZWQgaW4gSW5kZXhlZERiIGFzIHBhcnQgb2YgYSBEYlJlbW90ZURvY3VtZW50IG9iamVjdC5cclxuICovXHJcbnZhciBEYlVua25vd25Eb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiVW5rbm93bkRvY3VtZW50KHBhdGgsIHZlcnNpb24pIHtcclxuICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xyXG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb247XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRGJVbmtub3duRG9jdW1lbnQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAncmVtb3RlRG9jdW1lbnRzJyBzdG9yZSBpbiBJbmRleGVkRGIuXHJcbiAqIEl0IHJlcHJlc2VudHMgZWl0aGVyOlxyXG4gKlxyXG4gKiAtIEEgY29tcGxldGUgZG9jdW1lbnQuXHJcbiAqIC0gQSBcIm5vIGRvY3VtZW50XCIgcmVwcmVzZW50aW5nIGEgZG9jdW1lbnQgdGhhdCBpcyBrbm93biBub3QgdG8gZXhpc3QgKGF0XHJcbiAqIHNvbWUgdmVyc2lvbikuXHJcbiAqIC0gQW4gXCJ1bmtub3duIGRvY3VtZW50XCIgcmVwcmVzZW50aW5nIGEgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBleGlzdCAoYXRcclxuICogc29tZSB2ZXJzaW9uKSBidXQgd2hvc2UgY29udGVudHMgYXJlIHVua25vd24uXHJcbiAqXHJcbiAqIE5vdGU6IFRoaXMgaXMgdGhlIHBlcnNpc3RlZCBlcXVpdmFsZW50IG9mIGEgTWF5YmVEb2N1bWVudCBhbmQgY291bGQgcGVyaGFwc1xyXG4gKiBiZSBtYWRlIG1vcmUgZ2VuZXJhbCBpZiBuZWNlc3NhcnkuXHJcbiAqL1xyXG52YXIgRGJSZW1vdGVEb2N1bWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiUmVtb3RlRG9jdW1lbnQoXHJcbiAgICAvKipcclxuICAgICAqIFNldCB0byBhbiBpbnN0YW5jZSBvZiBEYlVua25vd25Eb2N1bWVudCBpZiB0aGUgZGF0YSBmb3IgYSBkb2N1bWVudCBpc1xyXG4gICAgICogbm90IGtub3duLCBidXQgaXQgaXMga25vd24gdGhhdCBhIGRvY3VtZW50IGV4aXN0cyBhdCB0aGUgc3BlY2lmaWVkXHJcbiAgICAgKiB2ZXJzaW9uIChlLmcuIGl0IGhhZCBhIHN1Y2Nlc3NmdWwgdXBkYXRlIGFwcGxpZWQgdG8gaXQpXHJcbiAgICAgKi9cclxuICAgIHVua25vd25Eb2N1bWVudCwgXHJcbiAgICAvKipcclxuICAgICAqIFNldCB0byBhbiBpbnN0YW5jZSBvZiBhIERiTm9Eb2N1bWVudCBpZiBpdCBpcyBrbm93biB0aGF0IG5vIGRvY3VtZW50XHJcbiAgICAgKiBleGlzdHMuXHJcbiAgICAgKi9cclxuICAgIG5vRG9jdW1lbnQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdG8gYW4gaW5zdGFuY2Ugb2YgYSBEb2N1bWVudCBpZiB0aGVyZSdzIGEgY2FjaGVkIHZlcnNpb24gb2YgdGhlXHJcbiAgICAgKiBkb2N1bWVudC5cclxuICAgICAqL1xyXG4gICAgZG9jdW1lbnQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBEb2N1bWVudHMgdGhhdCB3ZXJlIHdyaXR0ZW4gdG8gdGhlIHJlbW90ZSBkb2N1bWVudCBzdG9yZSBiYXNlZCBvblxyXG4gICAgICogYSB3cml0ZSBhY2tub3dsZWRnbWVudCBhcmUgbWFya2VkIHdpdGggYGhhc0NvbW1pdHRlZE11dGF0aW9uc2AuIFRoZXNlXHJcbiAgICAgKiBkb2N1bWVudHMgYXJlIHBvdGVudGlhbGx5IGluY29uc2lzdGVudCB3aXRoIHRoZSBiYWNrZW5kJ3MgY29weSBhbmQgdXNlXHJcbiAgICAgKiB0aGUgd3JpdGUncyBjb21taXQgdmVyc2lvbiBhcyB0aGVpciBkb2N1bWVudCB2ZXJzaW9uLlxyXG4gICAgICovXHJcbiAgICBoYXNDb21taXR0ZWRNdXRhdGlvbnMpIHtcclxuICAgICAgICB0aGlzLnVua25vd25Eb2N1bWVudCA9IHVua25vd25Eb2N1bWVudDtcclxuICAgICAgICB0aGlzLm5vRG9jdW1lbnQgPSBub0RvY3VtZW50O1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnQgPSBkb2N1bWVudDtcclxuICAgICAgICB0aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA9IGhhc0NvbW1pdHRlZE11dGF0aW9ucztcclxuICAgIH1cclxuICAgIERiUmVtb3RlRG9jdW1lbnQuc3RvcmUgPSAncmVtb3RlRG9jdW1lbnRzJztcclxuICAgIHJldHVybiBEYlJlbW90ZURvY3VtZW50O1xyXG59KCkpO1xyXG4vKipcclxuICogQ29udGFpbnMgYSBzaW5nbGUgZW50cnkgdGhhdCBoYXMgbWV0YWRhdGEgYWJvdXQgdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZS5cclxuICovXHJcbnZhciBEYlJlbW90ZURvY3VtZW50R2xvYmFsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gYnl0ZVNpemUgQXBwcm94aW1hdGVseSB0aGUgdG90YWwgc2l6ZSBpbiBieXRlcyBvZiBhbGwgdGhlIGRvY3VtZW50cyBpbiB0aGUgZG9jdW1lbnRcclxuICAgICAqIGNhY2hlLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBEYlJlbW90ZURvY3VtZW50R2xvYmFsKGJ5dGVTaXplKSB7XHJcbiAgICAgICAgdGhpcy5ieXRlU2l6ZSA9IGJ5dGVTaXplO1xyXG4gICAgfVxyXG4gICAgRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5zdG9yZSA9ICdyZW1vdGVEb2N1bWVudEdsb2JhbCc7XHJcbiAgICBEYlJlbW90ZURvY3VtZW50R2xvYmFsLmtleSA9ICdyZW1vdGVEb2N1bWVudEdsb2JhbEtleSc7XHJcbiAgICByZXR1cm4gRGJSZW1vdGVEb2N1bWVudEdsb2JhbDtcclxufSgpKTtcclxuZnVuY3Rpb24gY3JlYXRlRG9jdW1lbnRHbG9iYWxTdG9yZShkYikge1xyXG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIEFuIG9iamVjdCB0byBiZSBzdG9yZWQgaW4gdGhlICd0YXJnZXRzJyBzdG9yZSBpbiBJbmRleGVkRGIuXHJcbiAqXHJcbiAqIFRoaXMgaXMgYmFzZWQgb24gYW5kIHNob3VsZCBiZSBrZXB0IGluIHN5bmMgd2l0aCB0aGUgcHJvdG8gdXNlZCBpbiB0aGUgaU9TXHJcbiAqIGNsaWVudC5cclxuICpcclxuICogRWFjaCBxdWVyeSB0aGUgY2xpZW50IGxpc3RlbnMgdG8gYWdhaW5zdCB0aGUgc2VydmVyIGlzIHRyYWNrZWQgb24gZGlzayBzb1xyXG4gKiB0aGF0IHRoZSBxdWVyeSBjYW4gYmUgZWZmaWNpZW50bHkgcmVzdW1lZCBvbiByZXN0YXJ0LlxyXG4gKi9cclxudmFyIERiVGFyZ2V0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJUYXJnZXQoXHJcbiAgICAvKipcclxuICAgICAqIEFuIGF1dG8tZ2VuZXJhdGVkIHNlcXVlbnRpYWwgbnVtZXJpYyBpZGVudGlmaWVyIGZvciB0aGUgcXVlcnkuXHJcbiAgICAgKlxyXG4gICAgICogUXVlcmllcyBhcmUgc3RvcmVkIHVzaW5nIHRoZWlyIGNhbm9uaWNhbElkIGFzIHRoZSBrZXksIGJ1dCB0aGVzZVxyXG4gICAgICogY2Fub25pY2FsSWRzIGNhbiBiZSBxdWl0ZSBsb25nIHNvIHdlIGFkZGl0aW9uYWxseSBhc3NpZ24gYSB1bmlxdWVcclxuICAgICAqIHF1ZXJ5SWQgd2hpY2ggY2FuIGJlIHVzZWQgYnkgcmVmZXJlbmNlZCBkYXRhIHN0cnVjdHVyZXMgKGUuZy5cclxuICAgICAqIGluZGV4ZXMpIHRvIG1pbmltaXplIHRoZSBvbi1kaXNrIGNvc3QuXHJcbiAgICAgKi9cclxuICAgIHRhcmdldElkLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGNhbm9uaWNhbCBzdHJpbmcgcmVwcmVzZW50aW5nIHRoaXMgcXVlcnkuIFRoaXMgaXMgbm90IHVuaXF1ZS5cclxuICAgICAqL1xyXG4gICAgY2Fub25pY2FsSWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbGFzdCByZWFkVGltZSByZWNlaXZlZCBmcm9tIHRoZSBXYXRjaCBTZXJ2aWNlIGZvciB0aGlzIHF1ZXJ5LlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgaXMgdGhlIHNhbWUgdmFsdWUgYXMgVGFyZ2V0Q2hhbmdlLnJlYWRfdGltZSBpbiB0aGUgcHJvdG9zLlxyXG4gICAgICovXHJcbiAgICByZWFkVGltZSwgXHJcbiAgICAvKipcclxuICAgICAqIEFuIG9wYXF1ZSwgc2VydmVyLWFzc2lnbmVkIHRva2VuIHRoYXQgYWxsb3dzIHdhdGNoaW5nIGEgcXVlcnkgdG8gYmVcclxuICAgICAqIHJlc3VtZWQgYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YVxyXG4gICAgICogdGhhdCBtYXRjaGVzIHRoZSBxdWVyeS4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGFcclxuICAgICAqIHBvaW50IGluIHRpbWUgZnJvbSB3aGljaCB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgaXMgcmVsYXRlZCB0byB0aGUgc25hcHNob3RWZXJzaW9uIGluIHRoYXQgdGhlIHJlc3VtZVRva2VuXHJcbiAgICAgKiBlZmZlY3RpdmVseSBhbHNvIGVuY29kZXMgdGhhdCB2YWx1ZSwgYnV0IHRoZSByZXN1bWVUb2tlbiBpcyBvcGFxdWVcclxuICAgICAqIGFuZCBzb21ldGltZXMgZW5jb2RlcyBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEEgY29uc2VxdWVuY2Ugb2YgdGhpcyBpcyB0aGF0IHRoZSByZXN1bWVUb2tlbiBzaG91bGQgYmUgdXNlZCB3aGVuXHJcbiAgICAgKiBhc2tpbmcgdGhlIHNlcnZlciB0byByZWFzb24gYWJvdXQgd2hlcmUgdGhpcyBjbGllbnQgaXMgaW4gdGhlIHdhdGNoXHJcbiAgICAgKiBzdHJlYW0sIGJ1dCB0aGUgY2xpZW50IHNob3VsZCB1c2UgdGhlIHNuYXBzaG90VmVyc2lvbiBmb3IgaXRzIG93blxyXG4gICAgICogcHVycG9zZXMuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBpcyB0aGUgc2FtZSB2YWx1ZSBhcyBUYXJnZXRDaGFuZ2UucmVzdW1lX3Rva2VuIGluIHRoZSBwcm90b3MuXHJcbiAgICAgKi9cclxuICAgIHJlc3VtZVRva2VuLCBcclxuICAgIC8qKlxyXG4gICAgICogQSBzZXF1ZW5jZSBudW1iZXIgcmVwcmVzZW50aW5nIHRoZSBsYXN0IHRpbWUgdGhpcyBxdWVyeSB3YXNcclxuICAgICAqIGxpc3RlbmVkIHRvLCB1c2VkIGZvciBnYXJiYWdlIGNvbGxlY3Rpb24gcHVycG9zZXMuXHJcbiAgICAgKlxyXG4gICAgICogQ29udmVudGlvbmFsbHkgdGhpcyB3b3VsZCBiZSBhIHRpbWVzdGFtcCB2YWx1ZSwgYnV0IGRldmljZS1sb2NhbFxyXG4gICAgICogY2xvY2tzIGFyZSB1bnJlbGlhYmxlIGFuZCB0aGV5IG11c3QgYmUgYWJsZSB0byBjcmVhdGUgbmV3IGxpc3RlbnNcclxuICAgICAqIGV2ZW4gd2hpbGUgZGlzY29ubmVjdGVkLiBJbnN0ZWFkIHRoaXMgc2hvdWxkIGJlIGEgbW9ub3RvbmljYWxseVxyXG4gICAgICogaW5jcmVhc2luZyBudW1iZXIgdGhhdCdzIGluY3JlbWVudGVkIG9uIGVhY2ggbGlzdGVuIGNhbGwuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgcXVlcnlJZCBzaW5jZSB0aGUgcXVlcnlJZCBpcyBhblxyXG4gICAgICogaW1tdXRhYmxlIGlkZW50aWZpZXIgYXNzaWduZWQgdG8gdGhlIFF1ZXJ5IG9uIGZpcnN0IHVzZSB3aGlsZVxyXG4gICAgICogbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyIGlzIHVwZGF0ZWQgZXZlcnkgdGltZSB0aGUgcXVlcnkgaXNcclxuICAgICAqIGxpc3RlbmVkIHRvLlxyXG4gICAgICovXHJcbiAgICBsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcXVlcnkgZm9yIHRoaXMgdGFyZ2V0LlxyXG4gICAgICpcclxuICAgICAqIEJlY2F1c2UgY2Fub25pY2FsIGlkcyBhcmUgbm90IHVuaXF1ZSB3ZSBtdXN0IHN0b3JlIHRoZSBhY3R1YWwgcXVlcnkuIFdlXHJcbiAgICAgKiB1c2UgdGhlIHByb3RvIHRvIGhhdmUgYW4gb2JqZWN0IHdlIGNhbiBwZXJzaXN0IHdpdGhvdXQgaGF2aW5nIHRvXHJcbiAgICAgKiBkdXBsaWNhdGUgdHJhbnNsYXRpb24gbG9naWMgdG8gYW5kIGZyb20gYSBgUXVlcnlgIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgcXVlcnkpIHtcclxuICAgICAgICB0aGlzLnRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy5jYW5vbmljYWxJZCA9IGNhbm9uaWNhbElkO1xyXG4gICAgICAgIHRoaXMucmVhZFRpbWUgPSByZWFkVGltZTtcclxuICAgICAgICB0aGlzLnJlc3VtZVRva2VuID0gcmVzdW1lVG9rZW47XHJcbiAgICAgICAgdGhpcy5sYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgfVxyXG4gICAgRGJUYXJnZXQuc3RvcmUgPSAndGFyZ2V0cyc7XHJcbiAgICAvKiogS2V5cyBhcmUgYXV0b21hdGljYWxseSBhc3NpZ25lZCB2aWEgdGhlIHRhcmdldElkIHByb3BlcnR5LiAqL1xyXG4gICAgRGJUYXJnZXQua2V5UGF0aCA9ICd0YXJnZXRJZCc7XHJcbiAgICAvKiogVGhlIG5hbWUgb2YgdGhlIHF1ZXJ5VGFyZ2V0cyBpbmRleC4gKi9cclxuICAgIERiVGFyZ2V0LnF1ZXJ5VGFyZ2V0c0luZGV4TmFtZSA9ICdxdWVyeVRhcmdldHNJbmRleCc7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBpbmRleCBvZiBhbGwgY2Fub25pY2FsSWRzIHRvIHRoZSB0YXJnZXRzIHRoYXQgdGhleSBtYXRjaC4gVGhpcyBpcyBub3RcclxuICAgICAqIGEgdW5pcXVlIG1hcHBpbmcgYmVjYXVzZSBjYW5vbmljYWxJZCBkb2VzIG5vdCBwcm9taXNlIGEgdW5pcXVlIG5hbWUgZm9yIGFsbFxyXG4gICAgICogcG9zc2libGUgcXVlcmllcywgc28gd2UgYXBwZW5kIHRoZSB0YXJnZXRJZCB0byBtYWtlIHRoZSBtYXBwaW5nIHVuaXF1ZS5cclxuICAgICAqL1xyXG4gICAgRGJUYXJnZXQucXVlcnlUYXJnZXRzS2V5UGF0aCA9IFsnY2Fub25pY2FsSWQnLCAndGFyZ2V0SWQnXTtcclxuICAgIHJldHVybiBEYlRhcmdldDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEFuIG9iamVjdCByZXByZXNlbnRpbmcgYW4gYXNzb2NpYXRpb24gYmV0d2VlbiBhIHRhcmdldCBhbmQgYSBkb2N1bWVudCwgb3IgYVxyXG4gKiBzZW50aW5lbCByb3cgbWFya2luZyB0aGUgbGFzdCBzZXF1ZW5jZSBudW1iZXIgYXQgd2hpY2ggYSBkb2N1bWVudCB3YXMgdXNlZC5cclxuICogRWFjaCBkb2N1bWVudCBjYWNoZWQgbXVzdCBoYXZlIGEgY29ycmVzcG9uZGluZyBzZW50aW5lbCByb3cgYmVmb3JlIGxydVxyXG4gKiBnYXJiYWdlIGNvbGxlY3Rpb24gaXMgZW5hYmxlZC5cclxuICpcclxuICogVGhlIHRhcmdldCBhc3NvY2lhdGlvbnMgYW5kIHNlbnRpbmVsIHJvd3MgYXJlIGNvLWxvY2F0ZWQgc28gdGhhdCBvcnBoYW5lZFxyXG4gKiBkb2N1bWVudHMgYW5kIHRoZWlyIHNlcXVlbmNlIG51bWJlcnMgY2FuIGJlIGlkZW50aWZpZWQgZWZmaWNpZW50bHkgdmlhIGEgc2NhblxyXG4gKiBvZiB0aGlzIHN0b3JlLlxyXG4gKi9cclxudmFyIERiVGFyZ2V0RG9jdW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEYlRhcmdldERvY3VtZW50KFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdGFyZ2V0SWQgaWRlbnRpZnlpbmcgYSB0YXJnZXQgb3IgMCBmb3IgYSBzZW50aW5lbCByb3cuXHJcbiAgICAgKi9cclxuICAgIHRhcmdldElkLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHBhdGggdG8gdGhlIGRvY3VtZW50LCBhcyBlbmNvZGVkIGluIHRoZSBrZXkuXHJcbiAgICAgKi9cclxuICAgIHBhdGgsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBJZiB0aGlzIGlzIGEgc2VudGluZWwgcm93LCB0aGlzIHNob3VsZCBiZSB0aGUgc2VxdWVuY2UgbnVtYmVyIG9mIHRoZSBsYXN0XHJcbiAgICAgKiB0aW1lIHRoZSBkb2N1bWVudCBzcGVjaWZpZWQgYnkgYHBhdGhgIHdhcyB1c2VkLiBPdGhlcndpc2UsIGl0IHNob3VsZCBiZVxyXG4gICAgICogYHVuZGVmaW5lZGAuXHJcbiAgICAgKi9cclxuICAgIHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgIHRoaXMucGF0aCA9IHBhdGg7XHJcbiAgICAgICAgdGhpcy5zZXF1ZW5jZU51bWJlciA9IHNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgIGFzc2VydCgodGFyZ2V0SWQgPT09IDApID09PSAoc2VxdWVuY2VOdW1iZXIgIT09IHVuZGVmaW5lZCksIFxyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcclxuICAgICAgICAnQSB0YXJnZXQtZG9jdW1lbnQgcm93IG11c3QgZWl0aGVyIGhhdmUgdGFyZ2V0SWQgPT0gMCBhbmQgYSBkZWZpbmVkIHNlcXVlbmNlIG51bWJlciwgb3IgYSBub24temVybyB0YXJnZXRJZCBhbmQgbm8gc2VxdWVuY2UgbnVtYmVyJyk7XHJcbiAgICB9XHJcbiAgICAvKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gICovXHJcbiAgICBEYlRhcmdldERvY3VtZW50LnN0b3JlID0gJ3RhcmdldERvY3VtZW50cyc7XHJcbiAgICAvKiogS2V5cyBhcmUgYXV0b21hdGljYWxseSBhc3NpZ25lZCB2aWEgdGhlIHRhcmdldElkLCBwYXRoIHByb3BlcnRpZXMuICovXHJcbiAgICBEYlRhcmdldERvY3VtZW50LmtleVBhdGggPSBbJ3RhcmdldElkJywgJ3BhdGgnXTtcclxuICAgIC8qKiBUaGUgaW5kZXggbmFtZSBmb3IgdGhlIHJldmVyc2UgaW5kZXguICovXHJcbiAgICBEYlRhcmdldERvY3VtZW50LmRvY3VtZW50VGFyZ2V0c0luZGV4ID0gJ2RvY3VtZW50VGFyZ2V0c0luZGV4JztcclxuICAgIC8qKiBXZSBhbHNvIG5lZWQgdG8gY3JlYXRlIHRoZSByZXZlcnNlIGluZGV4IGZvciB0aGVzZSBwcm9wZXJ0aWVzLiAqL1xyXG4gICAgRGJUYXJnZXREb2N1bWVudC5kb2N1bWVudFRhcmdldHNLZXlQYXRoID0gWydwYXRoJywgJ3RhcmdldElkJ107XHJcbiAgICByZXR1cm4gRGJUYXJnZXREb2N1bWVudDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgcmVjb3JkIG9mIGdsb2JhbCBzdGF0ZSB0cmFja2VkIGFjcm9zcyBhbGwgVGFyZ2V0cywgdHJhY2tlZCBzZXBhcmF0ZWx5XHJcbiAqIHRvIGF2b2lkIHRoZSBuZWVkIGZvciBleHRyYSBpbmRleGVzLlxyXG4gKlxyXG4gKiBUaGlzIHNob3VsZCBiZSBrZXB0IGluLXN5bmMgd2l0aCB0aGUgcHJvdG8gdXNlZCBpbiB0aGUgaU9TIGNsaWVudC5cclxuICovXHJcbnZhciBEYlRhcmdldEdsb2JhbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiVGFyZ2V0R2xvYmFsKFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgaGlnaGVzdCBudW1iZXJlZCB0YXJnZXQgaWQgYWNyb3NzIGFsbCB0YXJnZXRzLlxyXG4gICAgICpcclxuICAgICAqIFNlZSBEYlRhcmdldC50YXJnZXRJZC5cclxuICAgICAqL1xyXG4gICAgaGlnaGVzdFRhcmdldElkLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGhpZ2hlc3QgbnVtYmVyZWQgbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyIGFjcm9zcyBhbGwgdGFyZ2V0cy5cclxuICAgICAqXHJcbiAgICAgKiBTZWUgRGJUYXJnZXQubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLlxyXG4gICAgICovXHJcbiAgICBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBIGdsb2JhbCBzbmFwc2hvdCB2ZXJzaW9uIHJlcHJlc2VudGluZyB0aGUgbGFzdCBjb25zaXN0ZW50IHNuYXBzaG90IHdlXHJcbiAgICAgKiByZWNlaXZlZCBmcm9tIHRoZSBiYWNrZW5kLiBUaGlzIGlzIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZyBhbmQgYW55XHJcbiAgICAgKiBzbmFwc2hvdHMgcmVjZWl2ZWQgZnJvbSB0aGUgYmFja2VuZCBwcmlvciB0byB0aGlzIHZlcnNpb24gKGUuZy4gZm9yXHJcbiAgICAgKiB0YXJnZXRzIHJlc3VtZWQgd2l0aCBhIHJlc3VtZVRva2VuKSBzaG91bGQgYmUgc3VwcHJlc3NlZCAoYnVmZmVyZWQpXHJcbiAgICAgKiB1bnRpbCB0aGUgYmFja2VuZCBoYXMgY2F1Z2h0IHVwIHRvIHRoaXMgc25hcHNob3QgdmVyc2lvbiBhZ2Fpbi4gVGhpc1xyXG4gICAgICogcHJldmVudHMgb3VyIGNhY2hlIGZyb20gZXZlciBnb2luZyBiYWNrd2FyZHMgaW4gdGltZS5cclxuICAgICAqL1xyXG4gICAgbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBudW1iZXIgb2YgdGFyZ2V0cyBwZXJzaXN0ZWQuXHJcbiAgICAgKi9cclxuICAgIHRhcmdldENvdW50KSB7XHJcbiAgICAgICAgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSBoaWdoZXN0VGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgdGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbjtcclxuICAgICAgICB0aGlzLnRhcmdldENvdW50ID0gdGFyZ2V0Q291bnQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBrZXkgc3RyaW5nIHVzZWQgZm9yIHRoZSBzaW5nbGUgb2JqZWN0IHRoYXQgZXhpc3RzIGluIHRoZVxyXG4gICAgICogRGJUYXJnZXRHbG9iYWwgc3RvcmUuXHJcbiAgICAgKi9cclxuICAgIERiVGFyZ2V0R2xvYmFsLmtleSA9ICd0YXJnZXRHbG9iYWxLZXknO1xyXG4gICAgRGJUYXJnZXRHbG9iYWwuc3RvcmUgPSAndGFyZ2V0R2xvYmFsJztcclxuICAgIHJldHVybiBEYlRhcmdldEdsb2JhbDtcclxufSgpKTtcclxuZnVuY3Rpb24gY3JlYXRlUXVlcnlDYWNoZShkYikge1xyXG4gICAgdmFyIHRhcmdldERvY3VtZW50c1N0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJUYXJnZXREb2N1bWVudC5zdG9yZSwge1xyXG4gICAgICAgIGtleVBhdGg6IERiVGFyZ2V0RG9jdW1lbnQua2V5UGF0aFxyXG4gICAgfSk7XHJcbiAgICB0YXJnZXREb2N1bWVudHNTdG9yZS5jcmVhdGVJbmRleChEYlRhcmdldERvY3VtZW50LmRvY3VtZW50VGFyZ2V0c0luZGV4LCBEYlRhcmdldERvY3VtZW50LmRvY3VtZW50VGFyZ2V0c0tleVBhdGgsIHsgdW5pcXVlOiB0cnVlIH0pO1xyXG4gICAgdmFyIHRhcmdldFN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJUYXJnZXQuc3RvcmUsIHtcclxuICAgICAgICBrZXlQYXRoOiBEYlRhcmdldC5rZXlQYXRoXHJcbiAgICB9KTtcclxuICAgIC8vIE5PVEU6IFRoaXMgaXMgdW5pcXVlIG9ubHkgYmVjYXVzZSB0aGUgVGFyZ2V0SWQgaXMgdGhlIHN1ZmZpeC5cclxuICAgIHRhcmdldFN0b3JlLmNyZWF0ZUluZGV4KERiVGFyZ2V0LnF1ZXJ5VGFyZ2V0c0luZGV4TmFtZSwgRGJUYXJnZXQucXVlcnlUYXJnZXRzS2V5UGF0aCwgeyB1bmlxdWU6IHRydWUgfSk7XHJcbiAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEYlRhcmdldEdsb2JhbC5zdG9yZSk7XHJcbn1cclxuZnVuY3Rpb24gZHJvcFF1ZXJ5Q2FjaGUoZGIpIHtcclxuICAgIGRiLmRlbGV0ZU9iamVjdFN0b3JlKERiVGFyZ2V0RG9jdW1lbnQuc3RvcmUpO1xyXG4gICAgZGIuZGVsZXRlT2JqZWN0U3RvcmUoRGJUYXJnZXQuc3RvcmUpO1xyXG4gICAgZGIuZGVsZXRlT2JqZWN0U3RvcmUoRGJUYXJnZXRHbG9iYWwuc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBDcmVhdGVzIHRoZSB0YXJnZXQgZ2xvYmFsIHNpbmdsZXRvbiByb3cuXHJcbiAqXHJcbiAqIEBwYXJhbSB7SURCVHJhbnNhY3Rpb259IHR4biBUaGUgdmVyc2lvbiB1cGdyYWRlIHRyYW5zYWN0aW9uIGZvciBpbmRleGVkZGJcclxuICovXHJcbmZ1bmN0aW9uIHdyaXRlRW1wdHlUYXJnZXRHbG9iYWxFbnRyeSh0eG4pIHtcclxuICAgIHZhciBnbG9iYWxTdG9yZSA9IHR4bi5zdG9yZShEYlRhcmdldEdsb2JhbC5zdG9yZSk7XHJcbiAgICB2YXIgbWV0YWRhdGEgPSBuZXcgRGJUYXJnZXRHbG9iYWwoXHJcbiAgICAvKmhpZ2hlc3RUYXJnZXRJZD0qLyAwLCBcclxuICAgIC8qbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyPSovIDAsIFNuYXBzaG90VmVyc2lvbi5NSU4udG9UaW1lc3RhbXAoKSwgXHJcbiAgICAvKnRhcmdldENvdW50PSovIDApO1xyXG4gICAgcmV0dXJuIGdsb2JhbFN0b3JlLnB1dChEYlRhcmdldEdsb2JhbC5rZXksIG1ldGFkYXRhKTtcclxufVxyXG4vKipcclxuICogQW4gb2JqZWN0IHN0b3JlIHRvIHN0b3JlIHRoZSBrZXlzIG9mIGNoYW5nZWQgZG9jdW1lbnRzLiBUaGlzIGlzIHVzZWQgdG9cclxuICogZmFjaWxpdGF0ZSBzdG9yaW5nIGRvY3VtZW50IGNoYW5nZWxvZ3MgaW4gdGhlIFJlbW90ZSBEb2N1bWVudCBDYWNoZS5cclxuICpcclxuICogUE9SVElORyBOT1RFOiBUaGlzIGlzIHVzZWQgZm9yIGNoYW5nZSBwcm9wYWdhdGlvbiBkdXJpbmcgbXVsdGktdGFiIHN5bmNpbmdcclxuICogYW5kIG5vdCBuZWVkZWQgb24gaU9TIGFuZCBBbmRyb2lkLlxyXG4gKi9cclxudmFyIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGJSZW1vdGVEb2N1bWVudENoYW5nZXMoXHJcbiAgICAvKiogVGhlIGtleXMgb2YgdGhlIGNoYW5nZWQgZG9jdW1lbnRzLiAqL1xyXG4gICAgY2hhbmdlcykge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IGNoYW5nZXM7XHJcbiAgICB9XHJcbiAgICAvKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gICovXHJcbiAgICBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcy5zdG9yZSA9ICdyZW1vdGVEb2N1bWVudENoYW5nZXMnO1xyXG4gICAgLyoqIEtleXMgYXJlIGF1dG8tZ2VuZXJhdGVkIHZpYSB0aGUgYGlkYCBwcm9wZXJ0eS4gKi9cclxuICAgIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzLmtleVBhdGggPSAnaWQnO1xyXG4gICAgcmV0dXJuIERiUmVtb3RlRG9jdW1lbnRDaGFuZ2VzO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjcmVhdGVSZW1vdGVEb2N1bWVudENoYW5nZXNTdG9yZShkYikge1xyXG4gICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoRGJSZW1vdGVEb2N1bWVudENoYW5nZXMuc3RvcmUsIHtcclxuICAgICAgICBrZXlQYXRoOiAnaWQnLFxyXG4gICAgICAgIGF1dG9JbmNyZW1lbnQ6IHRydWVcclxuICAgIH0pO1xyXG59XHJcbi8qKlxyXG4gKiBBIHJlY29yZCBvZiB0aGUgbWV0YWRhdGEgc3RhdGUgb2YgZWFjaCBjbGllbnQuXHJcbiAqXHJcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyB1c2VkIHRvIHN5bmNocm9uaXplIG11bHRpLXRhYiBzdGF0ZSBhbmQgZG9lcyBub3QgbmVlZFxyXG4gKiB0byBiZSBwb3J0ZWQgdG8gaU9TIG9yIEFuZHJvaWQuXHJcbiAqL1xyXG52YXIgRGJDbGllbnRNZXRhZGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERiQ2xpZW50TWV0YWRhdGEoXHJcbiAgICAvKiogVGhlIGF1dG8tZ2VuZXJhdGVkIGNsaWVudCBpZCBhc3NpZ25lZCBhdCBjbGllbnQgc3RhcnR1cC4gKi9cclxuICAgIGNsaWVudElkLCBcclxuICAgIC8qKiBUaGUgbGFzdCB0aW1lIHRoaXMgc3RhdGUgd2FzIHVwZGF0ZWQuICovXHJcbiAgICB1cGRhdGVUaW1lTXMsIFxyXG4gICAgLyoqIFdoZXRoZXIgdGhlIGNsaWVudCdzIG5ldHdvcmsgY29ubmVjdGlvbiBpcyBlbmFibGVkLiAqL1xyXG4gICAgbmV0d29ya0VuYWJsZWQsIFxyXG4gICAgLyoqIFdoZXRoZXIgdGhpcyBjbGllbnQgaXMgcnVubmluZyBpbiBhIGZvcmVncm91bmQgdGFiLiAqL1xyXG4gICAgaW5Gb3JlZ3JvdW5kLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGxhc3QgY2hhbmdlIHJlYWQgZnJvbSB0aGUgRGJSZW1vdGVEb2N1bWVudENoYW5nZXMgc3RvcmUuXHJcbiAgICAgKiBDYW4gYmUgdW5kZWZpbmVkIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS5cclxuICAgICAqL1xyXG4gICAgbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQpIHtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy51cGRhdGVUaW1lTXMgPSB1cGRhdGVUaW1lTXM7XHJcbiAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCA9IG5ldHdvcmtFbmFibGVkO1xyXG4gICAgICAgIHRoaXMuaW5Gb3JlZ3JvdW5kID0gaW5Gb3JlZ3JvdW5kO1xyXG4gICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWQgPSBsYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZDtcclxuICAgIH1cclxuICAgIC8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAqL1xyXG4gICAgRGJDbGllbnRNZXRhZGF0YS5zdG9yZSA9ICdjbGllbnRNZXRhZGF0YSc7XHJcbiAgICAvKiogS2V5cyBhcmUgYXV0b21hdGljYWxseSBhc3NpZ25lZCB2aWEgdGhlIGNsaWVudElkIHByb3BlcnRpZXMuICovXHJcbiAgICBEYkNsaWVudE1ldGFkYXRhLmtleVBhdGggPSAnY2xpZW50SWQnO1xyXG4gICAgcmV0dXJuIERiQ2xpZW50TWV0YWRhdGE7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGNyZWF0ZUNsaWVudE1ldGFkYXRhU3RvcmUoZGIpIHtcclxuICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERiQ2xpZW50TWV0YWRhdGEuc3RvcmUsIHtcclxuICAgICAgICBrZXlQYXRoOiBEYkNsaWVudE1ldGFkYXRhLmtleVBhdGhcclxuICAgIH0pO1xyXG59XHJcbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcclxudmFyIFYxX1NUT1JFUyA9IFtcclxuICAgIERiTXV0YXRpb25RdWV1ZS5zdG9yZSxcclxuICAgIERiTXV0YXRpb25CYXRjaC5zdG9yZSxcclxuICAgIERiRG9jdW1lbnRNdXRhdGlvbi5zdG9yZSxcclxuICAgIERiUmVtb3RlRG9jdW1lbnQuc3RvcmUsXHJcbiAgICBEYlRhcmdldC5zdG9yZSxcclxuICAgIERiUHJpbWFyeUNsaWVudC5zdG9yZSxcclxuICAgIERiVGFyZ2V0R2xvYmFsLnN0b3JlLFxyXG4gICAgRGJUYXJnZXREb2N1bWVudC5zdG9yZVxyXG5dO1xyXG4vLyBWMiBpcyBubyBsb25nZXIgdXNhYmxlIChzZWUgY29tbWVudCBhdCB0b3Agb2YgZmlsZSlcclxuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xyXG52YXIgVjNfU1RPUkVTID0gVjFfU1RPUkVTO1xyXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXHJcbnZhciBWNF9TVE9SRVMgPSBWM19TVE9SRVMuY29uY2F0KFtcclxuICAgIERiQ2xpZW50TWV0YWRhdGEuc3RvcmUsXHJcbiAgICBEYlJlbW90ZURvY3VtZW50Q2hhbmdlcy5zdG9yZVxyXG5dKTtcclxuLy8gVjUgZG9lcyBub3QgY2hhbmdlIHRoZSBzZXQgb2Ygc3RvcmVzLlxyXG52YXIgVjZfU1RPUkVTID0gVjRfU1RPUkVTLmNvbmNhdChbRGJSZW1vdGVEb2N1bWVudEdsb2JhbC5zdG9yZV0pO1xyXG4vKipcclxuICogVGhlIGxpc3Qgb2YgYWxsIGRlZmF1bHQgSW5kZXhlZERCIHN0b3JlcyB1c2VkIHRocm91Z2hvdXQgdGhlIFNESy4gVGhpcyBpc1xyXG4gKiB1c2VkIHdoZW4gY3JlYXRpbmcgdHJhbnNhY3Rpb25zIHNvIHRoYXQgYWNjZXNzIGFjcm9zcyBhbGwgc3RvcmVzIGlzIGRvbmVcclxuICogYXRvbWljYWxseS5cclxuICovXHJcbnZhciBBTExfU1RPUkVTID0gVjZfU1RPUkVTO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqIEEgbXV0YXRpb24gcXVldWUgZm9yIGEgc3BlY2lmaWMgdXNlciwgYmFja2VkIGJ5IEluZGV4ZWREQi4gKi9cclxudmFyIEluZGV4ZWREYk11dGF0aW9uUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBJbmRleGVkRGJNdXRhdGlvblF1ZXVlKFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbm9ybWFsaXplZCB1c2VySWQgKGUuZy4gbnVsbCBVSUQgPT4gXCJcIiB1c2VySWQpIHVzZWQgdG8gc3RvcmUgL1xyXG4gICAgICogcmV0cmlldmUgbXV0YXRpb25zLlxyXG4gICAgICovXHJcbiAgICB1c2VySWQsIHNlcmlhbGl6ZXIsIHJlZmVyZW5jZURlbGVnYXRlKSB7XHJcbiAgICAgICAgdGhpcy51c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gcmVmZXJlbmNlRGVsZWdhdGU7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2FjaGVzIHRoZSBkb2N1bWVudCBrZXlzIGZvciBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXMuIElmIHRoZSBtdXRhdGlvblxyXG4gICAgICAgICAqIGhhcyBiZWVuIHJlbW92ZWQgZnJvbSBJbmRleGVkRGIsIHRoZSBjYWNoZWQgdmFsdWUgbWF5IGNvbnRpbnVlIHRvXHJcbiAgICAgICAgICogYmUgdXNlZCB0byByZXRyaWV2ZSB0aGUgYmF0Y2gncyBkb2N1bWVudCBrZXlzLiBUbyByZW1vdmUgYSBjYWNoZWQgdmFsdWVcclxuICAgICAgICAgKiBsb2NhbGx5LCBgcmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKClgIHNob3VsZCBiZSBpbnZva2VkIGVpdGhlciBkaXJlY3RseVxyXG4gICAgICAgICAqIG9yIHRocm91Z2ggYHJlbW92ZU11dGF0aW9uQmF0Y2hlcygpYC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIFdpdGggbXVsdGktdGFiLCB3aGVuIHRoZSBwcmltYXJ5IGNsaWVudCBhY2tub3dsZWRnZXMgb3IgcmVqZWN0cyBhIG11dGF0aW9uLFxyXG4gICAgICAgICAqIHRoaXMgY2FjaGUgaXMgdXNlZCBieSBzZWNvbmRhcnkgY2xpZW50cyB0byBpbnZhbGlkYXRlIHRoZSBsb2NhbFxyXG4gICAgICAgICAqIHZpZXcgb2YgdGhlIGRvY3VtZW50cyB0aGF0IHdlcmUgcHJldmlvdXNseSBhZmZlY3RlZCBieSB0aGUgbXV0YXRpb24uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgICAgICB0aGlzLmRvY3VtZW50S2V5c0J5QmF0Y2hJZCA9IHt9O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbmV3IG11dGF0aW9uIHF1ZXVlIGZvciB0aGUgZ2l2ZW4gdXNlci5cclxuICAgICAqIEBwYXJhbSB1c2VyIFRoZSB1c2VyIGZvciB3aGljaCB0byBjcmVhdGUgYSBtdXRhdGlvbiBxdWV1ZS5cclxuICAgICAqIEBwYXJhbSBzZXJpYWxpemVyIFRoZSBzZXJpYWxpemVyIHRvIHVzZSB3aGVuIHBlcnNpc3RpbmcgdG8gSW5kZXhlZERiLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLmZvclVzZXIgPSBmdW5jdGlvbiAodXNlciwgc2VyaWFsaXplciwgcmVmZXJlbmNlRGVsZWdhdGUpIHtcclxuICAgICAgICAvLyBUT0RPKG1jZyk6IEZpZ3VyZSBvdXQgd2hhdCBjb25zdHJhaW50cyB0aGVyZSBhcmUgb24gdXNlcklEc1xyXG4gICAgICAgIC8vIEluIHBhcnRpY3VsYXIsIGFyZSB0aGVyZSBhbnkgcmVzZXJ2ZWQgY2hhcmFjdGVycz8gYXJlIGVtcHR5IGlkcyBhbGxvd2VkP1xyXG4gICAgICAgIC8vIEZvciB0aGUgbW9tZW50IHN0b3JlIHRoZXNlIHRvZ2V0aGVyIGluIHRoZSBzYW1lIG11dGF0aW9ucyB0YWJsZSBhc3N1bWluZ1xyXG4gICAgICAgIC8vIHRoYXQgZW1wdHkgdXNlcklEcyBhcmVuJ3QgYWxsb3dlZC5cclxuICAgICAgICBhc3NlcnQodXNlci51aWQgIT09ICcnLCAnVXNlcklEIG11c3Qgbm90IGJlIGFuIGVtcHR5IHN0cmluZy4nKTtcclxuICAgICAgICB2YXIgdXNlcklkID0gdXNlci5pc0F1dGhlbnRpY2F0ZWQoKSA/IHVzZXIudWlkIDogJyc7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBJbmRleGVkRGJNdXRhdGlvblF1ZXVlKHVzZXJJZCwgc2VyaWFsaXplciwgcmVmZXJlbmNlRGVsZWdhdGUpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmNoZWNrRW1wdHkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgZW1wdHkgPSB0cnVlO1xyXG4gICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLmJvdW5kKFt0aGlzLnVzZXJJZCwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZXSwgW3RoaXMudXNlcklkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFldKTtcclxuICAgICAgICByZXR1cm4gbXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHsgaW5kZXg6IERiTXV0YXRpb25CYXRjaC51c2VyTXV0YXRpb25zSW5kZXgsIHJhbmdlOiByYW5nZSB9LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29udHJvbCkge1xyXG4gICAgICAgICAgICBlbXB0eSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBlbXB0eTsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuYWNrbm93bGVkZ2VCYXRjaCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2gsIHN0cmVhbVRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TXV0YXRpb25RdWV1ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgYmF0Y2hJZCA9IGJhdGNoLmJhdGNoSWQ7XHJcbiAgICAgICAgICAgIGFzc2VydChiYXRjaElkID4gbWV0YWRhdGEubGFzdEFja25vd2xlZGdlZEJhdGNoSWQsICdNdXRhdGlvbiBiYXRjaElEcyBtdXN0IGJlIGFja25vd2xlZGdlZCBpbiBvcmRlcicpO1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCA9IGJhdGNoSWQ7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmxhc3RTdHJlYW1Ub2tlbiA9IGNvbnZlcnRTdHJlYW1Ub2tlbihzdHJlYW1Ub2tlbik7XHJcbiAgICAgICAgICAgIHJldHVybiBtdXRhdGlvblF1ZXVlc1N0b3JlKHRyYW5zYWN0aW9uKS5wdXQobWV0YWRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldExhc3RTdHJlYW1Ub2tlbiA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE11dGF0aW9uUXVldWVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHsgcmV0dXJuIG1ldGFkYXRhLmxhc3RTdHJlYW1Ub2tlbjsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuc2V0TGFzdFN0cmVhbVRva2VuID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBzdHJlYW1Ub2tlbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE11dGF0aW9uUXVldWVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgbWV0YWRhdGEubGFzdFN0cmVhbVRva2VuID0gY29udmVydFN0cmVhbVRva2VuKHN0cmVhbVRva2VuKTtcclxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9uUXVldWVzU3RvcmUodHJhbnNhY3Rpb24pLnB1dChtZXRhZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuYWRkTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgbG9jYWxXcml0ZVRpbWUsIG11dGF0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGRvY3VtZW50U3RvcmUgPSBkb2N1bWVudE11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKTtcclxuICAgICAgICB2YXIgbXV0YXRpb25TdG9yZSA9IG11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKTtcclxuICAgICAgICAvLyBUaGUgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uIGluIENocm9tZSAoYW5kIEZpcmVmb3gpIGRvZXMgbm90IGhhbmRsZVxyXG4gICAgICAgIC8vIGNvbXBvdW5kIGluZGljZXMgdGhhdCBpbmNsdWRlIGF1dG8tZ2VuZXJhdGVkIGtleXMgY29ycmVjdGx5LiBUbyBlbnN1cmVcclxuICAgICAgICAvLyB0aGF0IHRoZSBpbmRleCBlbnRyeSBpcyBhZGRlZCBjb3JyZWN0bHkgaW4gYWxsIGJyb3dzZXJzLCB3ZSBwZXJmb3JtIHR3b1xyXG4gICAgICAgIC8vIHdyaXRlczogVGhlIGZpcnN0IHdyaXRlIGlzIHVzZWQgdG8gcmV0cmlldmUgdGhlIG5leHQgYXV0by1nZW5lcmF0ZWQgQmF0Y2hcclxuICAgICAgICAvLyBJRCwgYW5kIHRoZSBzZWNvbmQgd3JpdGUgcG9wdWxhdGVzIHRoZSBpbmRleCBhbmQgc3RvcmVzIHRoZSBhY3R1YWxcclxuICAgICAgICAvLyBtdXRhdGlvbiBiYXRjaC5cclxuICAgICAgICAvLyBTZWU6IGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTcwMTk3MlxyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnkgV2Ugd3JpdGUgYW4gZW1wdHkgb2JqZWN0IHRvIG9idGFpbiBrZXlcclxuICAgICAgICByZXR1cm4gbXV0YXRpb25TdG9yZS5hZGQoe30pLm5leHQoZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KHR5cGVvZiBiYXRjaElkID09PSAnbnVtYmVyJywgJ0F1dG8tZ2VuZXJhdGVkIGtleSBpcyBub3QgYSBudW1iZXInKTtcclxuICAgICAgICAgICAgdmFyIGJhdGNoID0gbmV3IE11dGF0aW9uQmF0Y2goYmF0Y2hJZCwgbG9jYWxXcml0ZVRpbWUsIG11dGF0aW9ucyk7XHJcbiAgICAgICAgICAgIHZhciBkYkJhdGNoID0gX3RoaXMuc2VyaWFsaXplci50b0RiTXV0YXRpb25CYXRjaChfdGhpcy51c2VySWQsIGJhdGNoKTtcclxuICAgICAgICAgICAgX3RoaXMuZG9jdW1lbnRLZXlzQnlCYXRjaElkW2JhdGNoSWRdID0gYmF0Y2gua2V5cygpO1xyXG4gICAgICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBtdXRhdGlvbnNfMSA9IG11dGF0aW9uczsgX2kgPCBtdXRhdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBtdXRhdGlvbiA9IG11dGF0aW9uc18xW19pXTtcclxuICAgICAgICAgICAgICAgIHZhciBpbmRleEtleSA9IERiRG9jdW1lbnRNdXRhdGlvbi5rZXkoX3RoaXMudXNlcklkLCBtdXRhdGlvbi5rZXkucGF0aCwgYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKG11dGF0aW9uU3RvcmUucHV0KGRiQmF0Y2gpKTtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goZG9jdW1lbnRTdG9yZS5wdXQoaW5kZXhLZXksIERiRG9jdW1lbnRNdXRhdGlvbi5QTEFDRUhPTERFUikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcykubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBiYXRjaDsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUubG9va3VwTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuZ2V0KGJhdGNoSWQpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChkYkJhdGNoKSB7XHJcbiAgICAgICAgICAgIGlmIChkYkJhdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoZGJCYXRjaC51c2VySWQgPT09IF90aGlzLnVzZXJJZCwgXCJVbmV4cGVjdGVkIHVzZXIgJ1wiICsgZGJCYXRjaC51c2VySWQgKyBcIicgZm9yIG11dGF0aW9uIGJhdGNoIFwiICsgYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJNdXRhdGlvbkJhdGNoKGRiQmF0Y2gpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmxvb2t1cE11dGF0aW9uS2V5cyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnRLZXlzQnlCYXRjaElkW2JhdGNoSWRdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmRvY3VtZW50S2V5c0J5QmF0Y2hJZFtiYXRjaElkXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb29rdXBNdXRhdGlvbkJhdGNoKHRyYW5zYWN0aW9uLCBiYXRjaElkKS5uZXh0KGZ1bmN0aW9uIChiYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGJhdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleXMgPSBiYXRjaC5rZXlzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZG9jdW1lbnRLZXlzQnlCYXRjaElkW2JhdGNoSWRdID0ga2V5cztcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2V5cztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0TmV4dE11dGF0aW9uQmF0Y2hBZnRlckJhdGNoSWQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE11dGF0aW9uUXVldWVNZXRhZGF0YSh0cmFuc2FjdGlvbikubmV4dChmdW5jdGlvbiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgLy8gQWxsIGJhdGNoZXMgd2l0aCBiYXRjaElkIDw9IHRoaXMubWV0YWRhdGEubGFzdEFja25vd2xlZGdlZEJhdGNoSWQgaGF2ZVxyXG4gICAgICAgICAgICAvLyBiZWVuIGFja25vd2xlZGdlZCBzbyB0aGUgZmlyc3QgdW5hY2tub3dsZWRnZWQgYmF0Y2ggYWZ0ZXIgYmF0Y2hJRCB3aWxsXHJcbiAgICAgICAgICAgIC8vIGhhdmUgYSBiYXRjaElEIGxhcmdlciB0aGFuIGJvdGggb2YgdGhlc2UgdmFsdWVzLlxyXG4gICAgICAgICAgICB2YXIgbmV4dEJhdGNoSWQgPSBNYXRoLm1heChiYXRjaElkLCBtZXRhZGF0YS5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCkgKyAxO1xyXG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKFtfdGhpcy51c2VySWQsIG5leHRCYXRjaElkXSk7XHJcbiAgICAgICAgICAgIHZhciBmb3VuZEJhdGNoID0gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLml0ZXJhdGUoeyBpbmRleDogRGJNdXRhdGlvbkJhdGNoLnVzZXJNdXRhdGlvbnNJbmRleCwgcmFuZ2U6IHJhbmdlIH0sIGZ1bmN0aW9uIChrZXksIGRiQmF0Y2gsIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkYkJhdGNoLnVzZXJJZCA9PT0gX3RoaXMudXNlcklkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KGRiQmF0Y2guYmF0Y2hJZCA+PSBuZXh0QmF0Y2hJZCwgJ1Nob3VsZCBoYXZlIGZvdW5kIG11dGF0aW9uIGFmdGVyICcgKyBuZXh0QmF0Y2hJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm91bmRCYXRjaCA9IF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiTXV0YXRpb25CYXRjaChkYkJhdGNoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gZm91bmRCYXRjaDsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5ib3VuZChbdGhpcy51c2VySWQsIEJBVENISURfVU5LTk9XTl0sIFt0aGlzLnVzZXJJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZXSk7XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAubG9hZEFsbChEYk11dGF0aW9uQmF0Y2gudXNlck11dGF0aW9uc0luZGV4LCByYW5nZSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGRiQmF0Y2hlcykge1xyXG4gICAgICAgICAgICByZXR1cm4gZGJCYXRjaGVzLm1hcChmdW5jdGlvbiAoZGJCYXRjaCkgeyByZXR1cm4gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJNdXRhdGlvbkJhdGNoKGRiQmF0Y2gpOyB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFNjYW4gdGhlIGRvY3VtZW50LW11dGF0aW9uIGluZGV4IHN0YXJ0aW5nIHdpdGggYSBwcmVmaXggc3RhcnRpbmcgd2l0aFxyXG4gICAgICAgIC8vIHRoZSBnaXZlbiBkb2N1bWVudEtleS5cclxuICAgICAgICB2YXIgaW5kZXhQcmVmaXggPSBEYkRvY3VtZW50TXV0YXRpb24ucHJlZml4Rm9yUGF0aCh0aGlzLnVzZXJJZCwgZG9jdW1lbnRLZXkucGF0aCk7XHJcbiAgICAgICAgdmFyIGluZGV4U3RhcnQgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKGluZGV4UHJlZml4KTtcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudE11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuaXRlcmF0ZSh7IHJhbmdlOiBpbmRleFN0YXJ0IH0sIGZ1bmN0aW9uIChpbmRleEtleSwgXywgY29udHJvbCkge1xyXG4gICAgICAgICAgICB2YXIgdXNlcklEID0gaW5kZXhLZXlbMF0sIGVuY29kZWRQYXRoID0gaW5kZXhLZXlbMV0sIGJhdGNoSWQgPSBpbmRleEtleVsyXTtcclxuICAgICAgICAgICAgLy8gT25seSBjb25zaWRlciByb3dzIG1hdGNoaW5nIGV4YWN0bHkgdGhlIHNwZWNpZmljIGtleSBvZlxyXG4gICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXHJcbiAgICAgICAgICAgIC8vIG9yZGVyIHRlcm1pbmF0b3JzIGJlZm9yZSBwYXRoIHNlcGFyYXRvcnMsIHdlJ2xsIGVuY291bnRlciBhbGxcclxuICAgICAgICAgICAgLy8gdGhlIGluZGV4IHJvd3MgZm9yIGRvY3VtZW50S2V5IGNvbnRpZ3VvdXNseS4gSW4gcGFydGljdWxhciwgYWxsXHJcbiAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcclxuICAgICAgICAgICAgLy8gZG9jdW1lbnRzIG5lc3RlZCBpbiBhIHN1YmNvbGxlY3Rpb24gYmVuZWF0aCBkb2N1bWVudEtleSBzbyB3ZVxyXG4gICAgICAgICAgICAvLyBjYW4gc3RvcCBhcyBzb29uIGFzIHdlIGhpdCBhbnkgc3VjaCByb3cuXHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gZGVjb2RlJDEoZW5jb2RlZFBhdGgpO1xyXG4gICAgICAgICAgICBpZiAodXNlcklEICE9PSBfdGhpcy51c2VySWQgfHwgIWRvY3VtZW50S2V5LnBhdGguaXNFcXVhbChwYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gTG9vayB1cCB0aGUgbXV0YXRpb24gYmF0Y2ggaW4gdGhlIHN0b3JlLlxyXG4gICAgICAgICAgICByZXR1cm4gbXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgICAgICAuZ2V0KGJhdGNoSWQpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAobXV0YXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmICghbXV0YXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBmYWlsKCdEYW5nbGluZyBkb2N1bWVudC1tdXRhdGlvbiByZWZlcmVuY2UgZm91bmQ6ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleEtleSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICcgd2hpY2ggcG9pbnRzIHRvICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXRjaElkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFzc2VydChtdXRhdGlvbi51c2VySWQgPT09IF90aGlzLnVzZXJJZCwgXCJVbmV4cGVjdGVkIHVzZXIgJ1wiICsgbXV0YXRpb24udXNlcklkICsgXCInIGZvciBtdXRhdGlvbiBiYXRjaCBcIiArIGJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiTXV0YXRpb25CYXRjaChtdXRhdGlvbikpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHRzOyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHVuaXF1ZUJhdGNoSURzID0gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgICAgICBkb2N1bWVudEtleXMuZm9yRWFjaChmdW5jdGlvbiAoZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4U3RhcnQgPSBEYkRvY3VtZW50TXV0YXRpb24ucHJlZml4Rm9yUGF0aChfdGhpcy51c2VySWQsIGRvY3VtZW50S2V5LnBhdGgpO1xyXG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKGluZGV4U3RhcnQpO1xyXG4gICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRvY3VtZW50TXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pLml0ZXJhdGUoeyByYW5nZTogcmFuZ2UgfSwgZnVuY3Rpb24gKGluZGV4S2V5LCBfLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlcklEID0gaW5kZXhLZXlbMF0sIGVuY29kZWRQYXRoID0gaW5kZXhLZXlbMV0sIGJhdGNoSUQgPSBpbmRleEtleVsyXTtcclxuICAgICAgICAgICAgICAgIC8vIE9ubHkgY29uc2lkZXIgcm93cyBtYXRjaGluZyBleGFjdGx5IHRoZSBzcGVjaWZpYyBrZXkgb2ZcclxuICAgICAgICAgICAgICAgIC8vIGludGVyZXN0LiBOb3RlIHRoYXQgYmVjYXVzZSB3ZSBvcmRlciBieSBwYXRoIGZpcnN0LCBhbmQgd2VcclxuICAgICAgICAgICAgICAgIC8vIG9yZGVyIHRlcm1pbmF0b3JzIGJlZm9yZSBwYXRoIHNlcGFyYXRvcnMsIHdlJ2xsIGVuY291bnRlciBhbGxcclxuICAgICAgICAgICAgICAgIC8vIHRoZSBpbmRleCByb3dzIGZvciBkb2N1bWVudEtleSBjb250aWd1b3VzbHkuIEluIHBhcnRpY3VsYXIsIGFsbFxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIHJvd3MgZm9yIGRvY3VtZW50S2V5IHdpbGwgb2NjdXIgYmVmb3JlIGFueSByb3dzIGZvclxyXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnRzIG5lc3RlZCBpbiBhIHN1YmNvbGxlY3Rpb24gYmVuZWF0aCBkb2N1bWVudEtleSBzbyB3ZVxyXG4gICAgICAgICAgICAgICAgLy8gY2FuIHN0b3AgYXMgc29vbiBhcyB3ZSBoaXQgYW55IHN1Y2ggcm93LlxyXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSBkZWNvZGUkMShlbmNvZGVkUGF0aCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodXNlcklEICE9PSBfdGhpcy51c2VySWQgfHwgIWRvY3VtZW50S2V5LnBhdGguaXNFcXVhbChwYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHVuaXF1ZUJhdGNoSURzID0gdW5pcXVlQmF0Y2hJRHMuYWRkKGJhdGNoSUQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcHJvbWlzZXMucHVzaChwcm9taXNlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubG9va3VwTXV0YXRpb25CYXRjaGVzKHRyYW5zYWN0aW9uLCB1bmlxdWVCYXRjaElEcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoIXF1ZXJ5LmlzRG9jdW1lbnRRdWVyeSgpLCBcIkRvY3VtZW50IHF1ZXJpZXMgc2hvdWxkbid0IGdvIGRvd24gdGhpcyBwYXRoXCIpO1xyXG4gICAgICAgIHZhciBxdWVyeVBhdGggPSBxdWVyeS5wYXRoO1xyXG4gICAgICAgIHZhciBpbW1lZGlhdGVDaGlsZHJlbkxlbmd0aCA9IHF1ZXJ5UGF0aC5sZW5ndGggKyAxO1xyXG4gICAgICAgIC8vIFRPRE8obWNnKTogQWN0dWFsbHkgaW1wbGVtZW50IGEgc2luZ2xlLWNvbGxlY3Rpb24gcXVlcnlcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIFRoaXMgaXMgYWN0dWFsbHkgZXhlY3V0aW5nIGFuIGFuY2VzdG9yIHF1ZXJ5LCB0cmF2ZXJzaW5nIHRoZSB3aG9sZVxyXG4gICAgICAgIC8vIHN1YnRyZWUgYmVsb3cgdGhlIGNvbGxlY3Rpb24gd2hpY2ggY2FuIGJlIGhvcnJpZmljYWxseSBpbmVmZmljaWVudCBmb3JcclxuICAgICAgICAvLyBzb21lIHN0cnVjdHVyZXMuIFRoZSByaWdodCB3YXkgdG8gc29sdmUgdGhpcyBpcyB0byBpbXBsZW1lbnQgdGhlIGZ1bGxcclxuICAgICAgICAvLyB2YWx1ZSBpbmRleCwgYnV0IHRoYXQncyBub3QgaW4gdGhlIGNhcmRzIGluIHRoZSBuZWFyIGZ1dHVyZSBzbyB0aGlzIGlzXHJcbiAgICAgICAgLy8gdGhlIGJlc3Qgd2UgY2FuIGRvIGZvciB0aGUgbW9tZW50LlxyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gU2luY2Ugd2UgZG9uJ3QgeWV0IGluZGV4IHRoZSBhY3R1YWwgcHJvcGVydGllcyBpbiB0aGUgbXV0YXRpb25zLCBvdXJcclxuICAgICAgICAvLyBjdXJyZW50IGFwcHJvYWNoIGlzIHRvIGp1c3QgcmV0dXJuIGFsbCBtdXRhdGlvbiBiYXRjaGVzIHRoYXQgYWZmZWN0XHJcbiAgICAgICAgLy8gZG9jdW1lbnRzIGluIHRoZSBjb2xsZWN0aW9uIGJlaW5nIHF1ZXJpZWQuXHJcbiAgICAgICAgdmFyIGluZGV4UHJlZml4ID0gRGJEb2N1bWVudE11dGF0aW9uLnByZWZpeEZvclBhdGgodGhpcy51c2VySWQsIHF1ZXJ5UGF0aCk7XHJcbiAgICAgICAgdmFyIGluZGV4U3RhcnQgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKGluZGV4UHJlZml4KTtcclxuICAgICAgICAvLyBDb2xsZWN0IHVwIHVuaXF1ZSBiYXRjaElEcyBlbmNvdW50ZXJlZCBkdXJpbmcgYSBzY2FuIG9mIHRoZSBpbmRleC4gVXNlIGFcclxuICAgICAgICAvLyBTb3J0ZWRTZXQgdG8gYWNjdW11bGF0ZSBiYXRjaCBJRHMgc28gdGhleSBjYW4gYmUgdHJhdmVyc2VkIGluIG9yZGVyIGluIGFcclxuICAgICAgICAvLyBzY2FuIG9mIHRoZSBtYWluIHRhYmxlLlxyXG4gICAgICAgIHZhciB1bmlxdWVCYXRjaElEcyA9IG5ldyBTb3J0ZWRTZXQocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50TXV0YXRpb25zU3RvcmUodHJhbnNhY3Rpb24pXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHsgcmFuZ2U6IGluZGV4U3RhcnQgfSwgZnVuY3Rpb24gKGluZGV4S2V5LCBfLCBjb250cm9sKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VySUQgPSBpbmRleEtleVswXSwgZW5jb2RlZFBhdGggPSBpbmRleEtleVsxXSwgYmF0Y2hJRCA9IGluZGV4S2V5WzJdO1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IGRlY29kZSQxKGVuY29kZWRQYXRoKTtcclxuICAgICAgICAgICAgaWYgKHVzZXJJRCAhPT0gX3RoaXMudXNlcklkIHx8ICFxdWVyeVBhdGguaXNQcmVmaXhPZihwYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gUm93cyB3aXRoIGRvY3VtZW50IGtleXMgbW9yZSB0aGFuIG9uZSBzZWdtZW50IGxvbmdlciB0aGFuIHRoZVxyXG4gICAgICAgICAgICAvLyBxdWVyeSBwYXRoIGNhbid0IGJlIG1hdGNoZXMuIEZvciBleGFtcGxlLCBhIHF1ZXJ5IG9uICdyb29tcydcclxuICAgICAgICAgICAgLy8gY2FuJ3QgbWF0Y2ggdGhlIGRvY3VtZW50IC9yb29tcy9hYmMvbWVzc2FnZXMveHl4LlxyXG4gICAgICAgICAgICAvLyBUT0RPKG1jZyk6IHdlJ2xsIG5lZWQgYSBkaWZmZXJlbnQgc2Nhbm5lciB3aGVuIHdlIGltcGxlbWVudFxyXG4gICAgICAgICAgICAvLyBhbmNlc3RvciBxdWVyaWVzLlxyXG4gICAgICAgICAgICBpZiAocGF0aC5sZW5ndGggIT09IGltbWVkaWF0ZUNoaWxkcmVuTGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdW5pcXVlQmF0Y2hJRHMgPSB1bmlxdWVCYXRjaElEcy5hZGQoYmF0Y2hJRCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMubG9va3VwTXV0YXRpb25CYXRjaGVzKHRyYW5zYWN0aW9uLCB1bmlxdWVCYXRjaElEcyk7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLmxvb2t1cE11dGF0aW9uQmF0Y2hlcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2hJRHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXN1bHRzID0gW107XHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgLy8gVE9ETyhyb2Nrd29vZCk6IEltcGxlbWVudCB0aGlzIHVzaW5nIGl0ZXJhdGUuXHJcbiAgICAgICAgYmF0Y2hJRHMuZm9yRWFjaChmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKG11dGF0aW9uc1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgLmdldChiYXRjaElkKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKG11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBmYWlsKCdEYW5nbGluZyBkb2N1bWVudC1tdXRhdGlvbiByZWZlcmVuY2UgZm91bmQsICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnd2hpY2ggcG9pbnRzIHRvICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXRjaElkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFzc2VydChtdXRhdGlvbi51c2VySWQgPT09IF90aGlzLnVzZXJJZCwgXCJVbmV4cGVjdGVkIHVzZXIgJ1wiICsgbXV0YXRpb24udXNlcklkICsgXCInIGZvciBtdXRhdGlvbiBiYXRjaCBcIiArIGJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiTXV0YXRpb25CYXRjaChtdXRhdGlvbikpO1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlc3VsdHM7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYk11dGF0aW9uUXVldWUucHJvdG90eXBlLnJlbW92ZU11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gcmVtb3ZlTXV0YXRpb25CYXRjaCh0cmFuc2FjdGlvbi5zaW1wbGVEYlRyYW5zYWN0aW9uLCB0aGlzLnVzZXJJZCwgYmF0Y2gpLm5leHQoZnVuY3Rpb24gKHJlbW92ZWREb2N1bWVudHMpIHtcclxuICAgICAgICAgICAgX3RoaXMucmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKGJhdGNoLmJhdGNoSWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2gocmVtb3ZlZERvY3VtZW50cywgZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZU11dGF0aW9uUmVmZXJlbmNlKHRyYW5zYWN0aW9uLCBrZXkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5yZW1vdmVDYWNoZWRNdXRhdGlvbktleXMgPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmRvY3VtZW50S2V5c0J5QmF0Y2hJZFtiYXRjaElkXTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5wZXJmb3JtQ29uc2lzdGVuY3lDaGVjayA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrRW1wdHkodHhuKS5uZXh0KGZ1bmN0aW9uIChlbXB0eSkge1xyXG4gICAgICAgICAgICBpZiAoIWVtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBWZXJpZnkgdGhhdCB0aGVyZSBhcmUgbm8gZW50cmllcyBpbiB0aGUgZG9jdW1lbnRNdXRhdGlvbnMgaW5kZXggaWZcclxuICAgICAgICAgICAgLy8gdGhlIHF1ZXVlIGlzIGVtcHR5LlxyXG4gICAgICAgICAgICB2YXIgc3RhcnRSYW5nZSA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoRGJEb2N1bWVudE11dGF0aW9uLnByZWZpeEZvclVzZXIoX3RoaXMudXNlcklkKSk7XHJcbiAgICAgICAgICAgIHZhciBkYW5nbGluZ011dGF0aW9uUmVmZXJlbmNlcyA9IFtdO1xyXG4gICAgICAgICAgICByZXR1cm4gZG9jdW1lbnRNdXRhdGlvbnNTdG9yZSh0eG4pXHJcbiAgICAgICAgICAgICAgICAuaXRlcmF0ZSh7IHJhbmdlOiBzdGFydFJhbmdlIH0sIGZ1bmN0aW9uIChrZXksIF8sIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgICAgIHZhciB1c2VySUQgPSBrZXlbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAodXNlcklEICE9PSBfdGhpcy51c2VySWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sLmRvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IGRlY29kZSQxKGtleVsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGFuZ2xpbmdNdXRhdGlvblJlZmVyZW5jZXMucHVzaChwYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChkYW5nbGluZ011dGF0aW9uUmVmZXJlbmNlcy5sZW5ndGggPT09IDAsICdEb2N1bWVudCBsZWFrIC0tIGRldGVjdGVkIGRhbmdsaW5nIG11dGF0aW9uIHJlZmVyZW5jZXMgd2hlbiBxdWV1ZSBpcyBlbXB0eS4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJ0RhbmdsaW5nIGtleXM6ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgIGRhbmdsaW5nTXV0YXRpb25SZWZlcmVuY2VzLm1hcChmdW5jdGlvbiAocCkgeyByZXR1cm4gcC5jYW5vbmljYWxTdHJpbmcoKTsgfSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5jb250YWluc0tleSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHJldHVybiBtdXRhdGlvblF1ZXVlQ29udGFpbnNLZXkodHhuLCB0aGlzLnVzZXJJZCwga2V5KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5IChzdGF0ZSBpcyBoZWxkIGluIG1lbW9yeSBpbiBvdGhlciBjbGllbnRzKS5cclxuICAgIC8qKiBSZXR1cm5zIHRoZSBtdXRhdGlvbiBxdWV1ZSdzIG1ldGFkYXRhIGZyb20gSW5kZXhlZERiLiAqL1xyXG4gICAgSW5kZXhlZERiTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0TXV0YXRpb25RdWV1ZU1ldGFkYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbXV0YXRpb25RdWV1ZXNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLmdldCh0aGlzLnVzZXJJZClcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAobWV0YWRhdGEgfHxcclxuICAgICAgICAgICAgICAgIG5ldyBEYk11dGF0aW9uUXVldWUoX3RoaXMudXNlcklkLCBCQVRDSElEX1VOS05PV04sIFxyXG4gICAgICAgICAgICAgICAgLypsYXN0U3RyZWFtVG9rZW49Ki8gJycpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSW5kZXhlZERiTXV0YXRpb25RdWV1ZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgbXV0YXRpb24gcXVldWUgZm9yIHRoZSBnaXZlbiB1c2VyIGNvbnRhaW5zIGEgcGVuZGluZ1xyXG4gKiAgICAgICAgIG11dGF0aW9uIGZvciB0aGUgZ2l2ZW4ga2V5LlxyXG4gKi9cclxuZnVuY3Rpb24gbXV0YXRpb25RdWV1ZUNvbnRhaW5zS2V5KHR4biwgdXNlcklkLCBrZXkpIHtcclxuICAgIHZhciBpbmRleEtleSA9IERiRG9jdW1lbnRNdXRhdGlvbi5wcmVmaXhGb3JQYXRoKHVzZXJJZCwga2V5LnBhdGgpO1xyXG4gICAgdmFyIGVuY29kZWRQYXRoID0gaW5kZXhLZXlbMV07XHJcbiAgICB2YXIgc3RhcnRSYW5nZSA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoaW5kZXhLZXkpO1xyXG4gICAgdmFyIGNvbnRhaW5zS2V5ID0gZmFsc2U7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRNdXRhdGlvbnNTdG9yZSh0eG4pXHJcbiAgICAgICAgLml0ZXJhdGUoeyByYW5nZTogc3RhcnRSYW5nZSwga2V5c09ubHk6IHRydWUgfSwgZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbnRyb2wpIHtcclxuICAgICAgICB2YXIgdXNlcklEID0ga2V5WzBdLCBrZXlQYXRoID0ga2V5WzFdLCAvKmJhdGNoSUQqLyBfID0ga2V5WzJdO1xyXG4gICAgICAgIGlmICh1c2VySUQgPT09IHVzZXJJZCAmJiBrZXlQYXRoID09PSBlbmNvZGVkUGF0aCkge1xyXG4gICAgICAgICAgICBjb250YWluc0tleSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgfSlcclxuICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBjb250YWluc0tleTsgfSk7XHJcbn1cclxuLyoqIFJldHVybnMgdHJ1ZSBpZiBhbnkgbXV0YXRpb24gcXVldWUgY29udGFpbnMgdGhlIGdpdmVuIGRvY3VtZW50LiAqL1xyXG5mdW5jdGlvbiBtdXRhdGlvblF1ZXVlc0NvbnRhaW5LZXkodHhuLCBkb2NLZXkpIHtcclxuICAgIHZhciBmb3VuZCA9IGZhbHNlO1xyXG4gICAgcmV0dXJuIG11dGF0aW9uUXVldWVzU3RvcmUodHhuKVxyXG4gICAgICAgIC5pdGVyYXRlU2VyaWFsKGZ1bmN0aW9uICh1c2VySWQpIHtcclxuICAgICAgICByZXR1cm4gbXV0YXRpb25RdWV1ZUNvbnRhaW5zS2V5KHR4biwgdXNlcklkLCBkb2NLZXkpLm5leHQoZnVuY3Rpb24gKGNvbnRhaW5zS2V5KSB7XHJcbiAgICAgICAgICAgIGlmIChjb250YWluc0tleSkge1xyXG4gICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSghY29udGFpbnNLZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSlcclxuICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBmb3VuZDsgfSk7XHJcbn1cclxuLyoqXHJcbiAqIERlbGV0ZSBhIG11dGF0aW9uIGJhdGNoIGFuZCB0aGUgYXNzb2NpYXRlZCBkb2N1bWVudCBtdXRhdGlvbnMuXHJcbiAqIEByZXR1cm4gQSBQZXJzaXN0ZW5jZVByb21pc2Ugb2YgdGhlIGRvY3VtZW50IG11dGF0aW9ucyB0aGF0IHdlcmUgcmVtb3ZlZC5cclxuICovXHJcbmZ1bmN0aW9uIHJlbW92ZU11dGF0aW9uQmF0Y2godHhuLCB1c2VySWQsIGJhdGNoKSB7XHJcbiAgICB2YXIgbXV0YXRpb25TdG9yZSA9IHR4bi5zdG9yZShEYk11dGF0aW9uQmF0Y2guc3RvcmUpO1xyXG4gICAgdmFyIGluZGV4VHhuID0gdHhuLnN0b3JlKERiRG9jdW1lbnRNdXRhdGlvbi5zdG9yZSk7XHJcbiAgICB2YXIgcHJvbWlzZXMgPSBbXTtcclxuICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLm9ubHkoYmF0Y2guYmF0Y2hJZCk7XHJcbiAgICB2YXIgbnVtRGVsZXRlZCA9IDA7XHJcbiAgICB2YXIgcmVtb3ZlUHJvbWlzZSA9IG11dGF0aW9uU3RvcmUuaXRlcmF0ZSh7IHJhbmdlOiByYW5nZSB9LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgY29udHJvbCkge1xyXG4gICAgICAgIG51bURlbGV0ZWQrKztcclxuICAgICAgICByZXR1cm4gY29udHJvbC5kZWxldGUoKTtcclxuICAgIH0pO1xyXG4gICAgcHJvbWlzZXMucHVzaChyZW1vdmVQcm9taXNlLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydChudW1EZWxldGVkID09PSAxLCAnRGFuZ2xpbmcgZG9jdW1lbnQtbXV0YXRpb24gcmVmZXJlbmNlIGZvdW5kOiBNaXNzaW5nIGJhdGNoICcgK1xyXG4gICAgICAgICAgICBiYXRjaC5iYXRjaElkKTtcclxuICAgIH0pKTtcclxuICAgIHZhciByZW1vdmVkRG9jdW1lbnRzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gYmF0Y2gubXV0YXRpb25zOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBtdXRhdGlvbiA9IF9hW19pXTtcclxuICAgICAgICB2YXIgaW5kZXhLZXkgPSBEYkRvY3VtZW50TXV0YXRpb24ua2V5KHVzZXJJZCwgbXV0YXRpb24ua2V5LnBhdGgsIGJhdGNoLmJhdGNoSWQpO1xyXG4gICAgICAgIHByb21pc2VzLnB1c2goaW5kZXhUeG4uZGVsZXRlKGluZGV4S2V5KSk7XHJcbiAgICAgICAgcmVtb3ZlZERvY3VtZW50cy5wdXNoKG11dGF0aW9uLmtleSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVtb3ZlZERvY3VtZW50czsgfSk7XHJcbn1cclxuZnVuY3Rpb24gY29udmVydFN0cmVhbVRva2VuKHRva2VuKSB7XHJcbiAgICBpZiAodG9rZW4gaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XHJcbiAgICAgICAgLy8gVE9ETyhiLzc4NzcxNDAzKTogQ29udmVydCB0b2tlbnMgdG8gc3RyaW5ncyBkdXJpbmcgZGVzZXJpYWxpemF0aW9uXHJcbiAgICAgICAgYXNzZXJ0KHByb2Nlc3MuZW52LlVTRV9NT0NLX1BFUlNJU1RFTkNFID09PSAnWUVTJywgJ1BlcnNpc3Rpbmcgbm9uLXN0cmluZyBzdHJlYW0gdG9rZW5zIGlzIG9ubHkgc3VwcG9ydGVkIHdpdGggbW9jayBwZXJzaXN0ZW5jZS4nKTtcclxuICAgICAgICByZXR1cm4gdG9rZW4udG9TdHJpbmcoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0b2tlbjtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBtdXRhdGlvbnMgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gbXV0YXRpb25zU3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYk11dGF0aW9uQmF0Y2guc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9uUXVldWVzIG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIGRvY3VtZW50TXV0YXRpb25zU3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYkRvY3VtZW50TXV0YXRpb24uc3RvcmUpO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9uUXVldWVzIG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIG11dGF0aW9uUXVldWVzU3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYk11dGF0aW9uUXVldWUuc3RvcmUpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgUkVTRVJWRURfQklUUyA9IDE7XHJcbnZhciBHZW5lcmF0b3JJZHM7XHJcbihmdW5jdGlvbiAoR2VuZXJhdG9ySWRzKSB7XHJcbiAgICBHZW5lcmF0b3JJZHNbR2VuZXJhdG9ySWRzW1wiUXVlcnlDYWNoZVwiXSA9IDBdID0gXCJRdWVyeUNhY2hlXCI7XHJcbiAgICBHZW5lcmF0b3JJZHNbR2VuZXJhdG9ySWRzW1wiU3luY0VuZ2luZVwiXSA9IDFdID0gXCJTeW5jRW5naW5lXCI7IC8vIFRoZSB0YXJnZXQgSURzIGZvciBsaW1ibyBkZXRlY3Rpb24gYXJlIG9kZCAoZW5kIGluIDEpLlxyXG59KShHZW5lcmF0b3JJZHMgfHwgKEdlbmVyYXRvcklkcyA9IHt9KSk7XHJcbi8qKlxyXG4gKiBHZW5lcmF0ZXMgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nIHRhcmdldCBJRHMgZm9yIHNlbmRpbmcgdGFyZ2V0cyB0byB0aGVcclxuICogd2F0Y2ggc3RyZWFtLlxyXG4gKlxyXG4gKiBUaGUgY2xpZW50IGNvbnN0cnVjdHMgdHdvIGdlbmVyYXRvcnMsIG9uZSBmb3IgdGhlIHF1ZXJ5IGNhY2hlICh2aWFcclxuICogZm9yUXVlcnlDYWNoZSgpKSwgYW5kIG9uZSBmb3IgbGltYm8gZG9jdW1lbnRzICh2aWEgZm9yU3luY0VuZ2luZSgpKS4gVGhlc2VcclxuICogdHdvIGdlbmVyYXRvcnMgcHJvZHVjZSBub24tb3ZlcmxhcHBpbmcgSURzIChieSB1c2luZyBldmVuIGFuZCBvZGQgSURzXHJcbiAqIHJlc3BlY3RpdmVseSkuXHJcbiAqXHJcbiAqIEJ5IHNlcGFyYXRpbmcgdGhlIHRhcmdldCBJRCBzcGFjZSwgdGhlIHF1ZXJ5IGNhY2hlIGNhbiBnZW5lcmF0ZSB0YXJnZXQgSURzXHJcbiAqIHRoYXQgcGVyc2lzdCBhY3Jvc3MgY2xpZW50IHJlc3RhcnRzLCB3aGlsZSBzeW5jIGVuZ2luZSBjYW4gaW5kZXBlbmRlbnRseVxyXG4gKiBnZW5lcmF0ZSBpbi1tZW1vcnkgdGFyZ2V0IElEcyB0aGF0IGFyZSB0cmFuc2llbnQgYW5kIGNhbiBiZSByZXVzZWQgYWZ0ZXIgYVxyXG4gKiByZXN0YXJ0LlxyXG4gKi9cclxuLy8gVE9ETyhtcnNjaG1pZHQpOiBFeHBsb3JlIHJlbW92aW5nIHRoaXMgY2xhc3MgaW4gZmF2b3Igb2YgZ2VuZXJhdGluZyB0aGVzZSBJRHNcclxuLy8gZGlyZWN0bHkgaW4gU3luY0VuZ2luZSBhbmQgTG9jYWxTdG9yZS5cclxudmFyIFRhcmdldElkR2VuZXJhdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbnN0YW50aWF0ZXMgYSBuZXcgVGFyZ2V0SWRHZW5lcmF0b3IuIElmIGEgc2VlZCBpcyBwcm92aWRlZCwgdGhlIGdlbmVyYXRvclxyXG4gICAgICogd2lsbCB1c2UgdGhlIHNlZWQgdmFsdWUgYXMgdGhlIG5leHQgdGFyZ2V0IElELlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBUYXJnZXRJZEdlbmVyYXRvcihnZW5lcmF0b3JJZCwgc2VlZCkge1xyXG4gICAgICAgIHRoaXMuZ2VuZXJhdG9ySWQgPSBnZW5lcmF0b3JJZDtcclxuICAgICAgICBhc3NlcnQoKGdlbmVyYXRvcklkICYgUkVTRVJWRURfQklUUykgPT09IGdlbmVyYXRvcklkLCBcIkdlbmVyYXRvciBJRCBcIiArIGdlbmVyYXRvcklkICsgXCIgY29udGFpbnMgbW9yZSB0aGFuIFwiICsgUkVTRVJWRURfQklUUyArIFwiIHJlc2VydmVkIGJpdHNcIik7XHJcbiAgICAgICAgdGhpcy5zZWVrKHNlZWQgIT09IHVuZGVmaW5lZCA/IHNlZWQgOiB0aGlzLmdlbmVyYXRvcklkKTtcclxuICAgIH1cclxuICAgIFRhcmdldElkR2VuZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBuZXh0SWQgPSB0aGlzLm5leHRJZDtcclxuICAgICAgICB0aGlzLm5leHRJZCArPSAxIDw8IFJFU0VSVkVEX0JJVFM7XHJcbiAgICAgICAgcmV0dXJuIG5leHRJZDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIElEIHRoYXQgZm9sbG93cyB0aGUgZ2l2ZW4gSUQuIFN1YnNlcXVlbnQgY2FsbHMgdG8gYG5leHQoKWBcclxuICAgICAqIHVzZSB0aGUgbmV3bHkgcmV0dXJuZWQgdGFyZ2V0IElEIGFzIHRoZWlyIGJhc2UuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBUYXJnZXRJZEdlbmVyYXRvci5wcm90b3R5cGUuYWZ0ZXIgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLnNlZWsodGFyZ2V0SWQgKyAoMSA8PCBSRVNFUlZFRF9CSVRTKSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmV4dCgpO1xyXG4gICAgfTtcclxuICAgIFRhcmdldElkR2VuZXJhdG9yLnByb3RvdHlwZS5zZWVrID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgYXNzZXJ0KCh0YXJnZXRJZCAmIFJFU0VSVkVEX0JJVFMpID09PSB0aGlzLmdlbmVyYXRvcklkLCAnQ2Fubm90IHN1cHBseSB0YXJnZXQgSUQgZnJvbSBkaWZmZXJlbnQgZ2VuZXJhdG9yIElEJyk7XHJcbiAgICAgICAgdGhpcy5uZXh0SWQgPSB0YXJnZXRJZDtcclxuICAgIH07XHJcbiAgICBUYXJnZXRJZEdlbmVyYXRvci5mb3JRdWVyeUNhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIFdlIHNlZWQgdGhlIHF1ZXJ5IGNhY2hlIGdlbmVyYXRvciB0byByZXR1cm4gJzInIGFzIGl0cyBmaXJzdCBJRCwgYXMgdGhlcmVcclxuICAgICAgICAvLyBpcyBubyBkaWZmZXJlbnRpYXRpb24gaW4gdGhlIHByb3RvY29sIGxheWVyIGJldHdlZW4gYW4gdW5zZXQgbnVtYmVyIGFuZFxyXG4gICAgICAgIC8vIHRoZSBudW1iZXIgJzAnLiBJZiB3ZSB3ZXJlIHRvIHNlbnQgYSB0YXJnZXQgd2l0aCB0YXJnZXQgSUQgJzAnLCB0aGVcclxuICAgICAgICAvLyBiYWNrZW5kIHdvdWxkIGNvbnNpZGVyIGl0IHVuc2V0IGFuZCByZXBsYWNlIGl0IHdpdGggaXRzIG93biBJRC5cclxuICAgICAgICB2YXIgdGFyZ2V0SWRHZW5lcmF0b3IgPSBuZXcgVGFyZ2V0SWRHZW5lcmF0b3IoR2VuZXJhdG9ySWRzLlF1ZXJ5Q2FjaGUsIDIpO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRJZEdlbmVyYXRvcjtcclxuICAgIH07XHJcbiAgICBUYXJnZXRJZEdlbmVyYXRvci5mb3JTeW5jRW5naW5lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIFN5bmMgZW5naW5lIGFzc2lnbnMgdGFyZ2V0IElEcyBmb3IgbGltYm8gZG9jdW1lbnQgZGV0ZWN0aW9uLlxyXG4gICAgICAgIHJldHVybiBuZXcgVGFyZ2V0SWRHZW5lcmF0b3IoR2VuZXJhdG9ySWRzLlN5bmNFbmdpbmUpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBUYXJnZXRJZEdlbmVyYXRvcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBJbmRleGVkRGJRdWVyeUNhY2hlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSW5kZXhlZERiUXVlcnlDYWNoZShyZWZlcmVuY2VEZWxlZ2F0ZSwgc2VyaWFsaXplcikge1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSByZWZlcmVuY2VEZWxlZ2F0ZTtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogV2UgZG9uJ3QgY2FjaGUgZ2xvYmFsIG1ldGFkYXRhIGZvciB0aGUgcXVlcnkgY2FjaGUsIHNpbmNlXHJcbiAgICAgICAgLy8gc29tZSBvZiBpdCAoaW4gcGFydGljdWxhciBgaGlnaGVzdFRhcmdldElkYCkgY2FuIGJlIG1vZGlmaWVkIGJ5IHNlY29uZGFyeVxyXG4gICAgICAgIC8vIHRhYnMuIFdlIGNvdWxkIHBlcmhhcHMgYmUgbW9yZSBncmFudWxhciAoYW5kIGUuZy4gc3RpbGwgY2FjaGVcclxuICAgICAgICAvLyBgbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbmAgaW4gbWVtb3J5KSBidXQgZm9yIHNpbXBsaWNpdHkgd2UgY3VycmVudGx5IGdvXHJcbiAgICAgICAgLy8gdG8gSW5kZXhlZERiIHdoZW5ldmVyIHdlIG5lZWQgdG8gcmVhZCBtZXRhZGF0YS4gV2UgY2FuIHJldmlzaXQgaWYgaXQgdHVybnNcclxuICAgICAgICAvLyBvdXQgdG8gaGF2ZSBhIG1lYW5pbmdmdWwgcGVyZm9ybWFuY2UgaW1wYWN0LlxyXG4gICAgICAgIHRoaXMudGFyZ2V0SWRHZW5lcmF0b3IgPSBUYXJnZXRJZEdlbmVyYXRvci5mb3JRdWVyeUNhY2hlKCk7XHJcbiAgICB9XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5hbGxvY2F0ZVRhcmdldElkID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXRyaWV2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5oaWdoZXN0VGFyZ2V0SWQgPSBfdGhpcy50YXJnZXRJZEdlbmVyYXRvci5hZnRlcihtZXRhZGF0YS5oaWdoZXN0VGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc2F2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uLCBtZXRhZGF0YSkubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBtZXRhZGF0YS5oaWdoZXN0VGFyZ2V0SWQ7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXRyaWV2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gU25hcHNob3RWZXJzaW9uLmZyb21UaW1lc3RhbXAobmV3IFRpbWVzdGFtcChtZXRhZGF0YS5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uLnNlY29uZHMsIG1ldGFkYXRhLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24ubmFub3NlY29uZHMpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gZ2V0SGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKHRyYW5zYWN0aW9uLnNpbXBsZURiVHJhbnNhY3Rpb24pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnNldFRhcmdldHNNZXRhZGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyLCBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXRyaWV2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgICAgIGlmIChsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICBtZXRhZGF0YS5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi50b1RpbWVzdGFtcCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPiBtZXRhZGF0YS5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIG1ldGFkYXRhLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc2F2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uLCBtZXRhZGF0YSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuYWRkUXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNhdmVRdWVyeURhdGEodHJhbnNhY3Rpb24sIHF1ZXJ5RGF0YSkubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZXRyaWV2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgbWV0YWRhdGEudGFyZ2V0Q291bnQgKz0gMTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZU1ldGFkYXRhRnJvbVF1ZXJ5RGF0YShxdWVyeURhdGEsIG1ldGFkYXRhKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zYXZlTWV0YWRhdGEodHJhbnNhY3Rpb24sIG1ldGFkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUudXBkYXRlUXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zYXZlUXVlcnlEYXRhKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJlbW92ZVF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhLnRhcmdldElkKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiB0YXJnZXRzU3RvcmUodHJhbnNhY3Rpb24pLmRlbGV0ZShxdWVyeURhdGEudGFyZ2V0SWQpOyB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5yZXRyaWV2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKTsgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIGFzc2VydChtZXRhZGF0YS50YXJnZXRDb3VudCA+IDAsICdSZW1vdmluZyBmcm9tIGFuIGVtcHR5IHF1ZXJ5IGNhY2hlJyk7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLnRhcmdldENvdW50IC09IDE7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zYXZlTWV0YWRhdGEodHJhbnNhY3Rpb24sIG1ldGFkYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIERyb3BzIGFueSB0YXJnZXRzIHdpdGggc2VxdWVuY2UgbnVtYmVyIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgdXBwZXIgYm91bmQsIGV4Y2VwdGluZyB0aG9zZVxyXG4gICAgICogcHJlc2VudCBpbiBgYWN0aXZlVGFyZ2V0SWRzYC4gRG9jdW1lbnQgYXNzb2NpYXRpb25zIGZvciB0aGUgcmVtb3ZlZCB0YXJnZXRzIGFyZSBhbHNvIHJlbW92ZWQuXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgdGFyZ2V0cyByZW1vdmVkLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5yZW1vdmVUYXJnZXRzID0gZnVuY3Rpb24gKHR4biwgdXBwZXJCb3VuZCwgYWN0aXZlVGFyZ2V0SWRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRzU3RvcmUodHhuKVxyXG4gICAgICAgICAgICAuaXRlcmF0ZShmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlEYXRhID0gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJUYXJnZXQodmFsdWUpO1xyXG4gICAgICAgICAgICBpZiAocXVlcnlEYXRhLnNlcXVlbmNlTnVtYmVyIDw9IHVwcGVyQm91bmQgJiZcclxuICAgICAgICAgICAgICAgIGFjdGl2ZVRhcmdldElkc1txdWVyeURhdGEudGFyZ2V0SWRdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKF90aGlzLnJlbW92ZVF1ZXJ5RGF0YSh0eG4sIHF1ZXJ5RGF0YSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpOyB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBjb3VudDsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIHdpdGggZWFjaCBgUXVlcnlEYXRhYCB0aGF0IHdlIGhhdmUgY2FjaGVkLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5mb3JFYWNoVGFyZ2V0ID0gZnVuY3Rpb24gKHR4biwgZikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldHNTdG9yZSh0eG4pLml0ZXJhdGUoZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IF90aGlzLnNlcmlhbGl6ZXIuZnJvbURiVGFyZ2V0KHZhbHVlKTtcclxuICAgICAgICAgICAgZihxdWVyeURhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJldHJpZXZlTWV0YWRhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gcmV0cmlldmVNZXRhZGF0YSh0cmFuc2FjdGlvbi5zaW1wbGVEYlRyYW5zYWN0aW9uKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5zYXZlTWV0YWRhdGEgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIG1ldGFkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIGdsb2JhbFRhcmdldFN0b3JlKHRyYW5zYWN0aW9uKS5wdXQoRGJUYXJnZXRHbG9iYWwua2V5LCBtZXRhZGF0YSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUuc2F2ZVF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldHNTdG9yZSh0cmFuc2FjdGlvbikucHV0KHRoaXMuc2VyaWFsaXplci50b0RiVGFyZ2V0KHF1ZXJ5RGF0YSkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW4tcGxhY2UgdXBkYXRlcyB0aGUgcHJvdmlkZWQgbWV0YWRhdGEgdG8gYWNjb3VudCBmb3IgdmFsdWVzIGluIHRoZSBnaXZlblxyXG4gICAgICogUXVlcnlEYXRhLiBTYXZpbmcgaXMgZG9uZSBzZXBhcmF0ZWx5LiBSZXR1cm5zIHRydWUgaWYgdGhlcmUgd2VyZSBhbnlcclxuICAgICAqIGNoYW5nZXMgdG8gdGhlIG1ldGFkYXRhLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS51cGRhdGVNZXRhZGF0YUZyb21RdWVyeURhdGEgPSBmdW5jdGlvbiAocXVlcnlEYXRhLCBtZXRhZGF0YSkge1xyXG4gICAgICAgIHZhciB1cGRhdGVkID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHF1ZXJ5RGF0YS50YXJnZXRJZCA+IG1ldGFkYXRhLmhpZ2hlc3RUYXJnZXRJZCkge1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5oaWdoZXN0VGFyZ2V0SWQgPSBxdWVyeURhdGEudGFyZ2V0SWQ7XHJcbiAgICAgICAgICAgIHVwZGF0ZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocXVlcnlEYXRhLnNlcXVlbmNlTnVtYmVyID4gbWV0YWRhdGEuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IHF1ZXJ5RGF0YS5zZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICAgICAgdXBkYXRlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1cGRhdGVkO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldFF1ZXJ5Q291bnQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXRyaWV2ZU1ldGFkYXRhKHRyYW5zYWN0aW9uKS5uZXh0KGZ1bmN0aW9uIChtZXRhZGF0YSkgeyByZXR1cm4gbWV0YWRhdGEudGFyZ2V0Q291bnQ7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldFF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIEl0ZXJhdGluZyBieSB0aGUgY2Fub25pY2FsSWQgbWF5IHlpZWxkIG1vcmUgdGhhbiBvbmUgcmVzdWx0IGJlY2F1c2VcclxuICAgICAgICAvLyBjYW5vbmljYWxJZCB2YWx1ZXMgYXJlIG5vdCByZXF1aXJlZCB0byBiZSB1bmlxdWUgcGVyIHRhcmdldC4gVGhpcyBxdWVyeVxyXG4gICAgICAgIC8vIGRlcGVuZHMgb24gdGhlIHF1ZXJ5VGFyZ2V0cyBpbmRleCB0byBiZSBlZmZpY2llbnQuXHJcbiAgICAgICAgdmFyIGNhbm9uaWNhbElkID0gcXVlcnkuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5ib3VuZChbY2Fub25pY2FsSWQsIE51bWJlci5ORUdBVElWRV9JTkZJTklUWV0sIFtjYW5vbmljYWxJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZXSk7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldHNTdG9yZSh0cmFuc2FjdGlvbilcclxuICAgICAgICAgICAgLml0ZXJhdGUoeyByYW5nZTogcmFuZ2UsIGluZGV4OiBEYlRhcmdldC5xdWVyeVRhcmdldHNJbmRleE5hbWUgfSwgZnVuY3Rpb24gKGtleSwgdmFsdWUsIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgdmFyIGZvdW5kID0gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJUYXJnZXQodmFsdWUpO1xyXG4gICAgICAgICAgICAvLyBBZnRlciBmaW5kaW5nIGEgcG90ZW50aWFsIG1hdGNoLCBjaGVjayB0aGF0IHRoZSBxdWVyeSBpc1xyXG4gICAgICAgICAgICAvLyBhY3R1YWxseSBlcXVhbCB0byB0aGUgcmVxdWVzdGVkIHF1ZXJ5LlxyXG4gICAgICAgICAgICBpZiAocXVlcnkuaXNFcXVhbChmb3VuZC5xdWVyeSkpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZvdW5kO1xyXG4gICAgICAgICAgICAgICAgY29udHJvbC5kb25lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHQ7IH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmFkZE1hdGNoaW5nS2V5cyA9IGZ1bmN0aW9uICh0eG4sIGtleXMsIHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IFRoZSByZXZlcnNlIGluZGV4IChkb2N1bWVudHNUYXJnZXRzKSBpcyBtYWludGFpbmVkIGJ5XHJcbiAgICAgICAgLy8gSW5kZXhlZERiLlxyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIHZhciBzdG9yZSA9IGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKTtcclxuICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IGVuY29kZShrZXkucGF0aCk7XHJcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2goc3RvcmUucHV0KG5ldyBEYlRhcmdldERvY3VtZW50KHRhcmdldElkLCBwYXRoKSkpO1xyXG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKF90aGlzLnJlZmVyZW5jZURlbGVnYXRlLmFkZFJlZmVyZW5jZSh0eG4sIGtleSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcyk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUucmVtb3ZlTWF0Y2hpbmdLZXlzID0gZnVuY3Rpb24gKHR4biwga2V5cywgdGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcclxuICAgICAgICAvLyBJbmRleGVkRGIuXHJcbiAgICAgICAgdmFyIHN0b3JlID0gZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaChrZXlzLCBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gZW5jb2RlKGtleS5wYXRoKTtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKFtcclxuICAgICAgICAgICAgICAgIHN0b3JlLmRlbGV0ZShbdGFyZ2V0SWQsIHBhdGhdKSxcclxuICAgICAgICAgICAgICAgIF90aGlzLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVJlZmVyZW5jZSh0eG4sIGtleSlcclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUXVlcnlDYWNoZS5wcm90b3R5cGUucmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQgPSBmdW5jdGlvbiAodHhuLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBzdG9yZSA9IGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKTtcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5ib3VuZChbdGFyZ2V0SWRdLCBbdGFyZ2V0SWQgKyAxXSwgXHJcbiAgICAgICAgLypsb3dlck9wZW49Ki8gZmFsc2UsIFxyXG4gICAgICAgIC8qdXBwZXJPcGVuPSovIHRydWUpO1xyXG4gICAgICAgIHJldHVybiBzdG9yZS5kZWxldGUocmFuZ2UpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkID0gZnVuY3Rpb24gKHR4biwgdGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5ib3VuZChbdGFyZ2V0SWRdLCBbdGFyZ2V0SWQgKyAxXSwgXHJcbiAgICAgICAgLypsb3dlck9wZW49Ki8gZmFsc2UsIFxyXG4gICAgICAgIC8qdXBwZXJPcGVuPSovIHRydWUpO1xyXG4gICAgICAgIHZhciBzdG9yZSA9IGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICByZXR1cm4gc3RvcmVcclxuICAgICAgICAgICAgLml0ZXJhdGUoeyByYW5nZTogcmFuZ2UsIGtleXNPbmx5OiB0cnVlIH0sIGZ1bmN0aW9uIChrZXksIF8sIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBkZWNvZGUkMShrZXlbMV0pO1xyXG4gICAgICAgICAgICB2YXIgZG9jS2V5ID0gbmV3IERvY3VtZW50S2V5KHBhdGgpO1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuYWRkKGRvY0tleSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0OyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5jb250YWluc0tleSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHZhciBwYXRoID0gZW5jb2RlKGtleS5wYXRoKTtcclxuICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5ib3VuZChbcGF0aF0sIFtpbW1lZGlhdGVTdWNjZXNzb3IocGF0aCldLCBcclxuICAgICAgICAvKmxvd2VyT3Blbj0qLyBmYWxzZSwgXHJcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gdHJ1ZSk7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHtcclxuICAgICAgICAgICAgaW5kZXg6IERiVGFyZ2V0RG9jdW1lbnQuZG9jdW1lbnRUYXJnZXRzSW5kZXgsXHJcbiAgICAgICAgICAgIGtleXNPbmx5OiB0cnVlLFxyXG4gICAgICAgICAgICByYW5nZTogcmFuZ2VcclxuICAgICAgICB9LCBmdW5jdGlvbiAoX2EsIF8sIGNvbnRyb2wpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldElkID0gX2FbMF0sIHBhdGggPSBfYVsxXTtcclxuICAgICAgICAgICAgLy8gSGF2aW5nIGEgc2VudGluZWwgcm93IGZvciBhIGRvY3VtZW50IGRvZXMgbm90IGNvdW50IGFzIGNvbnRhaW5pbmcgdGhhdCBkb2N1bWVudDtcclxuICAgICAgICAgICAgLy8gRm9yIHRoZSBxdWVyeSBjYWNoZSwgY29udGFpbmluZyB0aGUgZG9jdW1lbnQgbWVhbnMgdGhlIGRvY3VtZW50IGlzIHBhcnQgb2Ygc29tZVxyXG4gICAgICAgICAgICAvLyB0YXJnZXQuXHJcbiAgICAgICAgICAgIGlmICh0YXJnZXRJZCAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgY291bnQrKztcclxuICAgICAgICAgICAgICAgIGNvbnRyb2wuZG9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gY291bnQgPiAwOyB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRRdWVyeURhdGFGb3JUYXJnZXQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHRhcmdldElkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGFyZ2V0c1N0b3JlKHRyYW5zYWN0aW9uKVxyXG4gICAgICAgICAgICAuZ2V0KHRhcmdldElkKVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoZm91bmQpIHtcclxuICAgICAgICAgICAgaWYgKGZvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc2VyaWFsaXplci5mcm9tRGJUYXJnZXQoZm91bmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUXVlcnlDYWNoZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgcXVlcmllcyBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiB0YXJnZXRzU3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYlRhcmdldC5zdG9yZSk7XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgdGFyZ2V0IGdsb2JhbHMgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gZ2xvYmFsVGFyZ2V0U3RvcmUodHhuKSB7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2UuZ2V0U3RvcmUodHhuLCBEYlRhcmdldEdsb2JhbC5zdG9yZSk7XHJcbn1cclxuZnVuY3Rpb24gcmV0cmlldmVNZXRhZGF0YSh0eG4pIHtcclxuICAgIHZhciBnbG9iYWxTdG9yZSA9IFNpbXBsZURiLmdldFN0b3JlKHR4biwgRGJUYXJnZXRHbG9iYWwuc3RvcmUpO1xyXG4gICAgcmV0dXJuIGdsb2JhbFN0b3JlLmdldChEYlRhcmdldEdsb2JhbC5rZXkpLm5leHQoZnVuY3Rpb24gKG1ldGFkYXRhKSB7XHJcbiAgICAgICAgYXNzZXJ0KG1ldGFkYXRhICE9PSBudWxsLCAnTWlzc2luZyBtZXRhZGF0YSByb3cuJyk7XHJcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0SGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKHR4bikge1xyXG4gICAgcmV0dXJuIHJldHJpZXZlTWV0YWRhdGEodHhuKS5uZXh0KGZ1bmN0aW9uICh0YXJnZXRHbG9iYWwpIHsgcmV0dXJuIHRhcmdldEdsb2JhbC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI7IH0pO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGRvY3VtZW50IHRhcmdldCBvYmplY3Qgc3RvcmUuXHJcbiAqL1xyXG5mdW5jdGlvbiBkb2N1bWVudFRhcmdldFN0b3JlKHR4bikge1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYlBlcnNpc3RlbmNlLmdldFN0b3JlKHR4biwgRGJUYXJnZXREb2N1bWVudC5zdG9yZSk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKiBTZXJpYWxpemVyIGZvciB2YWx1ZXMgc3RvcmVkIGluIHRoZSBMb2NhbFN0b3JlLiAqL1xyXG52YXIgTG9jYWxTZXJpYWxpemVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTG9jYWxTZXJpYWxpemVyKHJlbW90ZVNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB0aGlzLnJlbW90ZVNlcmlhbGl6ZXIgPSByZW1vdGVTZXJpYWxpemVyO1xyXG4gICAgfVxyXG4gICAgLyoqIERlY29kZXMgYSByZW1vdGUgZG9jdW1lbnQgZnJvbSBzdG9yYWdlIGxvY2FsbHkgdG8gYSBEb2N1bWVudC4gKi9cclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURiUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAocmVtb3RlRG9jKSB7XHJcbiAgICAgICAgaWYgKHJlbW90ZURvYy5kb2N1bWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVTZXJpYWxpemVyLmZyb21Eb2N1bWVudChyZW1vdGVEb2MuZG9jdW1lbnQsICEhcmVtb3RlRG9jLmhhc0NvbW1pdHRlZE11dGF0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHJlbW90ZURvYy5ub0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBEb2N1bWVudEtleS5mcm9tU2VnbWVudHMocmVtb3RlRG9jLm5vRG9jdW1lbnQucGF0aCk7XHJcbiAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gdGhpcy5mcm9tRGJUaW1lc3RhbXAocmVtb3RlRG9jLm5vRG9jdW1lbnQucmVhZFRpbWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE5vRG9jdW1lbnQoa2V5LCB2ZXJzaW9uLCB7XHJcbiAgICAgICAgICAgICAgICBoYXNDb21taXR0ZWRNdXRhdGlvbnM6ICEhcmVtb3RlRG9jLmhhc0NvbW1pdHRlZE11dGF0aW9uc1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocmVtb3RlRG9jLnVua25vd25Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gRG9jdW1lbnRLZXkuZnJvbVNlZ21lbnRzKHJlbW90ZURvYy51bmtub3duRG9jdW1lbnQucGF0aCk7XHJcbiAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gdGhpcy5mcm9tRGJUaW1lc3RhbXAocmVtb3RlRG9jLnVua25vd25Eb2N1bWVudC52ZXJzaW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmtub3duRG9jdW1lbnQoa2V5LCB2ZXJzaW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWlsKCdVbmV4cGVjdGVkIERiUmVtb3RlRG9jdW1lbnQnKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIEVuY29kZXMgYSBkb2N1bWVudCBmb3Igc3RvcmFnZSBsb2NhbGx5LiAqL1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS50b0RiUmVtb3RlRG9jdW1lbnQgPSBmdW5jdGlvbiAobWF5YmVEb2MpIHtcclxuICAgICAgICBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YXIgZG9jID0gdGhpcy5yZW1vdGVTZXJpYWxpemVyLnRvRG9jdW1lbnQobWF5YmVEb2MpO1xyXG4gICAgICAgICAgICB2YXIgaGFzQ29tbWl0dGVkTXV0YXRpb25zID0gbWF5YmVEb2MuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERiUmVtb3RlRG9jdW1lbnQoXHJcbiAgICAgICAgICAgIC8qIHVua25vd25Eb2N1bWVudD0gKi8gbnVsbCwgXHJcbiAgICAgICAgICAgIC8qIG5vRG9jdW1lbnQ9ICovIG51bGwsIGRvYywgaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBOb0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gbWF5YmVEb2Mua2V5LnBhdGgudG9BcnJheSgpO1xyXG4gICAgICAgICAgICB2YXIgcmVhZFRpbWUgPSB0aGlzLnRvRGJUaW1lc3RhbXAobWF5YmVEb2MudmVyc2lvbik7XHJcbiAgICAgICAgICAgIHZhciBoYXNDb21taXR0ZWRNdXRhdGlvbnMgPSBtYXliZURvYy5oYXNDb21taXR0ZWRNdXRhdGlvbnM7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGJSZW1vdGVEb2N1bWVudChcclxuICAgICAgICAgICAgLyogdW5rbm93bkRvY3VtZW50PSAqLyBudWxsLCBuZXcgRGJOb0RvY3VtZW50KHBhdGgsIHJlYWRUaW1lKSwgXHJcbiAgICAgICAgICAgIC8qIGRvY3VtZW50PSAqLyBudWxsLCBoYXNDb21taXR0ZWRNdXRhdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtYXliZURvYyBpbnN0YW5jZW9mIFVua25vd25Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9IG1heWJlRG9jLmtleS5wYXRoLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgdmFyIHJlYWRUaW1lID0gdGhpcy50b0RiVGltZXN0YW1wKG1heWJlRG9jLnZlcnNpb24pO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERiUmVtb3RlRG9jdW1lbnQobmV3IERiVW5rbm93bkRvY3VtZW50KHBhdGgsIHJlYWRUaW1lKSwgXHJcbiAgICAgICAgICAgIC8qIG5vRG9jdW1lbnQ9ICovIG51bGwsIFxyXG4gICAgICAgICAgICAvKiBkb2N1bWVudD0gKi8gbnVsbCwgXHJcbiAgICAgICAgICAgIC8qIGhhc0NvbW1pdHRlZE11dGF0aW9ucz0gKi8gdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFpbCgnVW5leHBlY3RlZCBNYXliZURvY3VtbWVudCcpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLnRvRGJUaW1lc3RhbXAgPSBmdW5jdGlvbiAoc25hcHNob3RWZXJzaW9uKSB7XHJcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IHNuYXBzaG90VmVyc2lvbi50b1RpbWVzdGFtcCgpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRGJUaW1lc3RhbXAodGltZXN0YW1wLnNlY29uZHMsIHRpbWVzdGFtcC5uYW5vc2Vjb25kcyk7XHJcbiAgICB9O1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRGJUaW1lc3RhbXAgPSBmdW5jdGlvbiAoZGJUaW1lc3RhbXApIHtcclxuICAgICAgICB2YXIgdGltZXN0YW1wID0gbmV3IFRpbWVzdGFtcChkYlRpbWVzdGFtcC5zZWNvbmRzLCBkYlRpbWVzdGFtcC5uYW5vc2Vjb25kcyk7XHJcbiAgICAgICAgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5mcm9tVGltZXN0YW1wKHRpbWVzdGFtcCk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEVuY29kZXMgYSBiYXRjaCBvZiBtdXRhdGlvbnMgaW50byBhIERiTXV0YXRpb25CYXRjaCBmb3IgbG9jYWwgc3RvcmFnZS4gKi9cclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUudG9EYk11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAodXNlcklkLCBiYXRjaCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHNlcmlhbGl6ZWRNdXRhdGlvbnMgPSBiYXRjaC5tdXRhdGlvbnMubWFwKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW1vdGVTZXJpYWxpemVyLnRvTXV0YXRpb24obSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYk11dGF0aW9uQmF0Y2godXNlcklkLCBiYXRjaC5iYXRjaElkLCBiYXRjaC5sb2NhbFdyaXRlVGltZS50b01pbGxpcygpLCBzZXJpYWxpemVkTXV0YXRpb25zKTtcclxuICAgIH07XHJcbiAgICAvKiogRGVjb2RlcyBhIERiTXV0YXRpb25CYXRjaCBpbnRvIGEgTXV0YXRpb25CYXRjaCAqL1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS5mcm9tRGJNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKGRiQmF0Y2gpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBtdXRhdGlvbnMgPSBkYkJhdGNoLm11dGF0aW9ucy5tYXAoZnVuY3Rpb24gKG0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW90ZVNlcmlhbGl6ZXIuZnJvbU11dGF0aW9uKG0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0aW1lc3RhbXAgPSBUaW1lc3RhbXAuZnJvbU1pbGxpcyhkYkJhdGNoLmxvY2FsV3JpdGVUaW1lTXMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgTXV0YXRpb25CYXRjaChkYkJhdGNoLmJhdGNoSWQsIHRpbWVzdGFtcCwgbXV0YXRpb25zKTtcclxuICAgIH07XHJcbiAgICAvKlxyXG4gICAgICogRW5jb2RlcyBhIHNldCBvZiBkb2N1bWVudCBrZXlzIGludG8gYW4gYXJyYXkgb2YgRW5jb2RlZFJlc291cmNlUGF0aHMuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUudG9EYlJlc291cmNlUGF0aHMgPSBmdW5jdGlvbiAoa2V5cykge1xyXG4gICAgICAgIHZhciBlbmNvZGVkS2V5cyA9IFtdO1xyXG4gICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIGVuY29kZWRLZXlzLnB1c2goZW5jb2RlKGtleS5wYXRoKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGVuY29kZWRLZXlzO1xyXG4gICAgfTtcclxuICAgIC8qKiBEZWNvZGVzIGFuIGFycmF5IG9mIEVuY29kZWRSZXNvdXJjZVBhdGhzIGludG8gYSBzZXQgb2YgZG9jdW1lbnQga2V5cy4gKi9cclxuICAgIExvY2FsU2VyaWFsaXplci5wcm90b3R5cGUuZnJvbURiUmVzb3VyY2VQYXRocyA9IGZ1bmN0aW9uIChlbmNvZGVkUGF0aHMpIHtcclxuICAgICAgICB2YXIga2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBlbmNvZGVkUGF0aHNfMSA9IGVuY29kZWRQYXRoczsgX2kgPCBlbmNvZGVkUGF0aHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGRvY3VtZW50S2V5ID0gZW5jb2RlZFBhdGhzXzFbX2ldO1xyXG4gICAgICAgICAgICBrZXlzID0ga2V5cy5hZGQobmV3IERvY3VtZW50S2V5KGRlY29kZSQxKGRvY3VtZW50S2V5KSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ga2V5cztcclxuICAgIH07XHJcbiAgICAvKiogRGVjb2RlcyBhIERiVGFyZ2V0IGludG8gUXVlcnlEYXRhICovXHJcbiAgICBMb2NhbFNlcmlhbGl6ZXIucHJvdG90eXBlLmZyb21EYlRhcmdldCA9IGZ1bmN0aW9uIChkYlRhcmdldCkge1xyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gdGhpcy5mcm9tRGJUaW1lc3RhbXAoZGJUYXJnZXQucmVhZFRpbWUpO1xyXG4gICAgICAgIHZhciBxdWVyeTtcclxuICAgICAgICBpZiAoaXNEb2N1bWVudFF1ZXJ5KGRiVGFyZ2V0LnF1ZXJ5KSkge1xyXG4gICAgICAgICAgICBxdWVyeSA9IHRoaXMucmVtb3RlU2VyaWFsaXplci5mcm9tRG9jdW1lbnRzVGFyZ2V0KGRiVGFyZ2V0LnF1ZXJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5ID0gdGhpcy5yZW1vdGVTZXJpYWxpemVyLmZyb21RdWVyeVRhcmdldChkYlRhcmdldC5xdWVyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnlEYXRhKHF1ZXJ5LCBkYlRhcmdldC50YXJnZXRJZCwgUXVlcnlQdXJwb3NlLkxpc3RlbiwgZGJUYXJnZXQubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLCB2ZXJzaW9uLCBkYlRhcmdldC5yZXN1bWVUb2tlbik7XHJcbiAgICB9O1xyXG4gICAgLyoqIEVuY29kZXMgUXVlcnlEYXRhIGludG8gYSBEYlRhcmdldCBmb3Igc3RvcmFnZSBsb2NhbGx5LiAqL1xyXG4gICAgTG9jYWxTZXJpYWxpemVyLnByb3RvdHlwZS50b0RiVGFyZ2V0ID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIGFzc2VydChRdWVyeVB1cnBvc2UuTGlzdGVuID09PSBxdWVyeURhdGEucHVycG9zZSwgJ09ubHkgcXVlcmllcyB3aXRoIHB1cnBvc2UgJyArXHJcbiAgICAgICAgICAgIFF1ZXJ5UHVycG9zZS5MaXN0ZW4gK1xyXG4gICAgICAgICAgICAnIG1heSBiZSBzdG9yZWQsIGdvdCAnICtcclxuICAgICAgICAgICAgcXVlcnlEYXRhLnB1cnBvc2UpO1xyXG4gICAgICAgIHZhciBkYlRpbWVzdGFtcCA9IHRoaXMudG9EYlRpbWVzdGFtcChxdWVyeURhdGEuc25hcHNob3RWZXJzaW9uKTtcclxuICAgICAgICB2YXIgcXVlcnlQcm90bztcclxuICAgICAgICBpZiAocXVlcnlEYXRhLnF1ZXJ5LmlzRG9jdW1lbnRRdWVyeSgpKSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5UHJvdG8gPSB0aGlzLnJlbW90ZVNlcmlhbGl6ZXIudG9Eb2N1bWVudHNUYXJnZXQocXVlcnlEYXRhLnF1ZXJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHF1ZXJ5UHJvdG8gPSB0aGlzLnJlbW90ZVNlcmlhbGl6ZXIudG9RdWVyeVRhcmdldChxdWVyeURhdGEucXVlcnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmVzdW1lVG9rZW47XHJcbiAgICAgICAgaWYgKHF1ZXJ5RGF0YS5yZXN1bWVUb2tlbiBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcclxuICAgICAgICAgICAgLy8gVE9ETyhiLzc4NzcxNDAzKTogQ29udmVydCB0b2tlbnMgdG8gc3RyaW5ncyBkdXJpbmcgZGVzZXJpYWxpemF0aW9uXHJcbiAgICAgICAgICAgIGFzc2VydChwcm9jZXNzLmVudi5VU0VfTU9DS19QRVJTSVNURU5DRSA9PT0gJ1lFUycsICdQZXJzaXN0aW5nIG5vbi1zdHJpbmcgc3RyZWFtIHRva2VucyBpcyBvbmx5IHN1cHBvcnRlZCB3aXRoIG1vY2sgcGVyc2lzdGVuY2UgLicpO1xyXG4gICAgICAgICAgICByZXN1bWVUb2tlbiA9IHF1ZXJ5RGF0YS5yZXN1bWVUb2tlbi50b1N0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmVzdW1lVG9rZW4gPSBxdWVyeURhdGEucmVzdW1lVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciBpcyBhbHdheXMgMCB1bnRpbCB3ZSBkbyByZWFsIEdDLlxyXG4gICAgICAgIHJldHVybiBuZXcgRGJUYXJnZXQocXVlcnlEYXRhLnRhcmdldElkLCBxdWVyeURhdGEucXVlcnkuY2Fub25pY2FsSWQoKSwgZGJUaW1lc3RhbXAsIHJlc3VtZVRva2VuLCBxdWVyeURhdGEuc2VxdWVuY2VOdW1iZXIsIHF1ZXJ5UHJvdG8pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMb2NhbFNlcmlhbGl6ZXI7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBBIGhlbHBlciBmdW5jdGlvbiBmb3IgZmlndXJpbmcgb3V0IHdoYXQga2luZCBvZiBxdWVyeSBoYXMgYmVlbiBzdG9yZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc0RvY3VtZW50UXVlcnkoZGJRdWVyeSkge1xyXG4gICAgcmV0dXJuIGRiUXVlcnkuZG9jdW1lbnRzICE9PSB1bmRlZmluZWQ7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGJ1ZmZlckVudHJ5Q29tcGFyYXRvcihfYSwgX2IpIHtcclxuICAgIHZhciBhU2VxdWVuY2UgPSBfYVswXSwgYUluZGV4ID0gX2FbMV07XHJcbiAgICB2YXIgYlNlcXVlbmNlID0gX2JbMF0sIGJJbmRleCA9IF9iWzFdO1xyXG4gICAgdmFyIHNlcUNtcCA9IHByaW1pdGl2ZUNvbXBhcmF0b3IoYVNlcXVlbmNlLCBiU2VxdWVuY2UpO1xyXG4gICAgaWYgKHNlcUNtcCA9PT0gMCkge1xyXG4gICAgICAgIC8vIFRoaXMgb3JkZXIgZG9lc24ndCBtYXR0ZXIsIGJ1dCB3ZSBjYW4gYmlhcyBhZ2FpbnN0IGNodXJuIGJ5IHNvcnRpbmdcclxuICAgICAgICAvLyBlbnRyaWVzIGNyZWF0ZWQgZWFybGllciBhcyBsZXNzIHRoYW4gbmV3ZXIgZW50cmllcy5cclxuICAgICAgICByZXR1cm4gcHJpbWl0aXZlQ29tcGFyYXRvcihhSW5kZXgsIGJJbmRleCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gc2VxQ21wO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBVc2VkIHRvIGNhbGN1bGF0ZSB0aGUgbnRoIHNlcXVlbmNlIG51bWJlci4gS2VlcHMgYSByb2xsaW5nIGJ1ZmZlciBvZiB0aGVcclxuICogbG93ZXN0IG4gdmFsdWVzIHBhc3NlZCB0byBgYWRkRWxlbWVudGAsIGFuZCBmaW5hbGx5IHJlcG9ydHMgdGhlIGxhcmdlc3Qgb2ZcclxuICogdGhlbSBpbiBgbWF4VmFsdWVgLlxyXG4gKi9cclxudmFyIFJvbGxpbmdTZXF1ZW5jZU51bWJlckJ1ZmZlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJvbGxpbmdTZXF1ZW5jZU51bWJlckJ1ZmZlcihtYXhFbGVtZW50cykge1xyXG4gICAgICAgIHRoaXMubWF4RWxlbWVudHMgPSBtYXhFbGVtZW50cztcclxuICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBTb3J0ZWRTZXQoYnVmZmVyRW50cnlDb21wYXJhdG9yKTtcclxuICAgICAgICB0aGlzLnByZXZpb3VzSW5kZXggPSAwO1xyXG4gICAgfVxyXG4gICAgUm9sbGluZ1NlcXVlbmNlTnVtYmVyQnVmZmVyLnByb3RvdHlwZS5uZXh0SW5kZXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICsrdGhpcy5wcmV2aW91c0luZGV4O1xyXG4gICAgfTtcclxuICAgIFJvbGxpbmdTZXF1ZW5jZU51bWJlckJ1ZmZlci5wcm90b3R5cGUuYWRkRWxlbWVudCA9IGZ1bmN0aW9uIChzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgIHZhciBlbnRyeSA9IFtzZXF1ZW5jZU51bWJlciwgdGhpcy5uZXh0SW5kZXgoKV07XHJcbiAgICAgICAgaWYgKHRoaXMuYnVmZmVyLnNpemUgPCB0aGlzLm1heEVsZW1lbnRzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuYWRkKGVudHJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBoaWdoZXN0VmFsdWUgPSB0aGlzLmJ1ZmZlci5sYXN0KCk7XHJcbiAgICAgICAgICAgIGlmIChidWZmZXJFbnRyeUNvbXBhcmF0b3IoZW50cnksIGhpZ2hlc3RWYWx1ZSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLmRlbGV0ZShoaWdoZXN0VmFsdWUpLmFkZChlbnRyeSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJvbGxpbmdTZXF1ZW5jZU51bWJlckJ1ZmZlci5wcm90b3R5cGUsIFwibWF4VmFsdWVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBHdWFyYW50ZWVkIHRvIGJlIG5vbi1lbXB0eS4gSWYgd2UgZGVjaWRlIHdlIGFyZSBub3QgY29sbGVjdGluZyBhbnlcclxuICAgICAgICAgICAgLy8gc2VxdWVuY2UgbnVtYmVycywgbnRoU2VxdWVuY2VOdW1iZXIgYmVsb3cgc2hvcnQtY2lyY3VpdHMuIElmIHdlIGhhdmVcclxuICAgICAgICAgICAgLy8gZGVjaWRlZCB0aGF0IHdlIGFyZSBjb2xsZWN0aW5nIG4gc2VxdWVuY2UgbnVtYmVycywgaXQncyBiZWNhdXNlIG4gaXMgc29tZVxyXG4gICAgICAgICAgICAvLyBwZXJjZW50YWdlIG9mIHRoZSBleGlzdGluZyBzZXF1ZW5jZSBudW1iZXJzLiBUaGF0IG1lYW5zIHdlIHNob3VsZCBuZXZlclxyXG4gICAgICAgICAgICAvLyBiZSBpbiBhIHNpdHVhdGlvbiB3aGVyZSB3ZSBhcmUgY29sbGVjdGluZyBzZXF1ZW5jZSBudW1iZXJzIGJ1dCBkb24ndFxyXG4gICAgICAgICAgICAvLyBhY3R1YWxseSBoYXZlIGFueS5cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmxhc3QoKVswXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBSb2xsaW5nU2VxdWVuY2VOdW1iZXJCdWZmZXI7XHJcbn0oKSk7XHJcbi8qKiBJbXBsZW1lbnRzIHRoZSBzdGVwcyBmb3IgTFJVIGdhcmJhZ2UgY29sbGVjdGlvbi4gKi9cclxudmFyIExydUdhcmJhZ2VDb2xsZWN0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMcnVHYXJiYWdlQ29sbGVjdG9yKGRlbGVnYXRlKSB7XHJcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlO1xyXG4gICAgfVxyXG4gICAgLyoqIEdpdmVuIGEgcGVyY2VudGlsZSBvZiB0YXJnZXQgdG8gY29sbGVjdCwgcmV0dXJucyB0aGUgbnVtYmVyIG9mIHRhcmdldHMgdG8gY29sbGVjdC4gKi9cclxuICAgIExydUdhcmJhZ2VDb2xsZWN0b3IucHJvdG90eXBlLmNhbGN1bGF0ZVRhcmdldENvdW50ID0gZnVuY3Rpb24gKHR4biwgcGVyY2VudGlsZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmdldFRhcmdldENvdW50KHR4bikubmV4dChmdW5jdGlvbiAodGFyZ2V0Q291bnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IocGVyY2VudGlsZSAvIDEwMC4wICogdGFyZ2V0Q291bnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBSZXR1cm5zIHRoZSBudGggc2VxdWVuY2UgbnVtYmVyLCBjb3VudGluZyBpbiBvcmRlciBmcm9tIHRoZSBzbWFsbGVzdC4gKi9cclxuICAgIExydUdhcmJhZ2VDb2xsZWN0b3IucHJvdG90eXBlLm50aFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKHR4biwgbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKG4gPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKExpc3RlblNlcXVlbmNlLklOVkFMSUQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYnVmZmVyID0gbmV3IFJvbGxpbmdTZXF1ZW5jZU51bWJlckJ1ZmZlcihuKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZVxyXG4gICAgICAgICAgICAuZm9yRWFjaFRhcmdldCh0eG4sIGZ1bmN0aW9uICh0YXJnZXQpIHsgcmV0dXJuIGJ1ZmZlci5hZGRFbGVtZW50KHRhcmdldC5zZXF1ZW5jZU51bWJlcik7IH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmRlbGVnYXRlLmZvckVhY2hPcnBoYW5lZERvY3VtZW50U2VxdWVuY2VOdW1iZXIodHhuLCBmdW5jdGlvbiAoc2VxdWVuY2VOdW1iZXIpIHsgcmV0dXJuIGJ1ZmZlci5hZGRFbGVtZW50KHNlcXVlbmNlTnVtYmVyKTsgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYnVmZmVyLm1heFZhbHVlOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZXMgdGFyZ2V0cyB3aXRoIGEgc2VxdWVuY2UgbnVtYmVyIGVxdWFsIHRvIG9yIGxlc3MgdGhhbiB0aGUgZ2l2ZW4gdXBwZXIgYm91bmQsIGFuZCByZW1vdmVzXHJcbiAgICAgKiBkb2N1bWVudCBhc3NvY2lhdGlvbnMgd2l0aCB0aG9zZSB0YXJnZXRzLlxyXG4gICAgICovXHJcbiAgICBMcnVHYXJiYWdlQ29sbGVjdG9yLnByb3RvdHlwZS5yZW1vdmVUYXJnZXRzID0gZnVuY3Rpb24gKHR4biwgdXBwZXJCb3VuZCwgYWN0aXZlVGFyZ2V0SWRzKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUucmVtb3ZlVGFyZ2V0cyh0eG4sIHVwcGVyQm91bmQsIGFjdGl2ZVRhcmdldElkcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIGRvY3VtZW50cyB0aGF0IGhhdmUgYSBzZXF1ZW5jZSBudW1iZXIgZXF1YWwgdG8gb3IgbGVzcyB0aGFuIHRoZSB1cHBlciBib3VuZCBhbmQgYXJlIG5vdFxyXG4gICAgICogb3RoZXJ3aXNlIHBpbm5lZC5cclxuICAgICAqL1xyXG4gICAgTHJ1R2FyYmFnZUNvbGxlY3Rvci5wcm90b3R5cGUucmVtb3ZlT3JwaGFuZWREb2N1bWVudHMgPSBmdW5jdGlvbiAodHhuLCB1cHBlckJvdW5kKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZWdhdGUucmVtb3ZlT3JwaGFuZWREb2N1bWVudHModHhuLCB1cHBlckJvdW5kKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTHJ1R2FyYmFnZUNvbGxlY3RvcjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBPcGFxdWUgaW50ZXJmYWNlIHJlcHJlc2VudGluZyBhIHBlcnNpc3RlbmNlIHRyYW5zYWN0aW9uLlxyXG4gKlxyXG4gKiBXaGVuIHlvdSBjYWxsIFBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCksIGl0IHdpbGwgY3JlYXRlIGEgdHJhbnNhY3Rpb24gYW5kXHJcbiAqIHBhc3MgaXQgdG8geW91ciBjYWxsYmFjay4gWW91IHRoZW4gcGFzcyBpdCB0byBhbnkgbWV0aG9kIHRoYXQgb3BlcmF0ZXNcclxuICogb24gcGVyc2lzdGVuY2UuXHJcbiAqL1xyXG52YXIgUGVyc2lzdGVuY2VUcmFuc2FjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBlcnNpc3RlbmNlVHJhbnNhY3Rpb24oKSB7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUGVyc2lzdGVuY2VUcmFuc2FjdGlvbjtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDIgPSAnSW5kZXhlZERiUGVyc2lzdGVuY2UnO1xyXG4vKipcclxuICogT2xkZXN0IGFjY2VwdGFibGUgYWdlIGluIG1pbGxpc2Vjb25kcyBmb3IgY2xpZW50IG1ldGFkYXRhIGJlZm9yZSB0aGUgY2xpZW50XHJcbiAqIGlzIGNvbnNpZGVyZWQgaW5hY3RpdmUgYW5kIGl0cyBhc3NvY2lhdGVkIGRhdGEgKHN1Y2ggYXMgdGhlIHJlbW90ZSBkb2N1bWVudFxyXG4gKiBjYWNoZSBjaGFuZ2Vsb2cpIGlzIGdhcmJhZ2UgY29sbGVjdGVkLlxyXG4gKi9cclxudmFyIE1BWF9DTElFTlRfQUdFX01TID0gMzAgKiA2MCAqIDEwMDA7IC8vIDMwIG1pbnV0ZXNcclxuLyoqXHJcbiAqIE9sZGVzdCBhY2NlcHRhYmxlIG1ldGFkYXRhIGFnZSBmb3IgY2xpZW50cyB0aGF0IG1heSBwYXJ0aWNpcGF0ZSBpbiB0aGVcclxuICogcHJpbWFyeSBsZWFzZSBlbGVjdGlvbi4gQ2xpZW50cyB0aGF0IGhhdmUgbm90IHVwZGF0ZWQgdGhlaXIgY2xpZW50IG1ldGFkYXRhXHJcbiAqIHdpdGhpbiA1IHNlY29uZHMgYXJlIG5vdCBlbGlnaWJsZSB0byByZWNlaXZlIGEgcHJpbWFyeSBsZWFzZS5cclxuICovXHJcbnZhciBNQVhfUFJJTUFSWV9FTElHSUJMRV9BR0VfTVMgPSA1MDAwO1xyXG4vKipcclxuICogVGhlIGludGVydmFsIGF0IHdoaWNoIGNsaWVudHMgd2lsbCB1cGRhdGUgdGhlaXIgbWV0YWRhdGEsIGluY2x1ZGluZ1xyXG4gKiByZWZyZXNoaW5nIHRoZWlyIHByaW1hcnkgbGVhc2UgaWYgaGVsZCBvciBwb3RlbnRpYWxseSB0cnlpbmcgdG8gYWNxdWlyZSBpdCBpZlxyXG4gKiBub3QgaGVsZC5cclxuICpcclxuICogUHJpbWFyeSBjbGllbnRzIG1heSBvcHBvcnR1bmlzdGljYWxseSByZWZyZXNoIHRoZWlyIG1ldGFkYXRhIGVhcmxpZXJcclxuICogaWYgdGhleSdyZSBhbHJlYWR5IHBlcmZvcm1pbmcgYW4gSW5kZXhlZERCIG9wZXJhdGlvbi5cclxuICovXHJcbnZhciBDTElFTlRfTUVUQURBVEFfUkVGUkVTSF9JTlRFUlZBTF9NUyA9IDQwMDA7XHJcbi8qKiBVc2VyLWZhY2luZyBlcnJvciB3aGVuIHRoZSBwcmltYXJ5IGxlYXNlIGlzIHJlcXVpcmVkIGJ1dCBub3QgYXZhaWxhYmxlLiAqL1xyXG52YXIgUFJJTUFSWV9MRUFTRV9MT1NUX0VSUk9SX01TRyA9ICdUaGUgY3VycmVudCB0YWIgaXMgbm90IGluIHRoZSByZXF1aXJlZCBzdGF0ZSB0byBwZXJmb3JtIHRoaXMgb3BlcmF0aW9uLiAnICtcclxuICAgICdJdCBtaWdodCBiZSBuZWNlc3NhcnkgdG8gcmVmcmVzaCB0aGUgYnJvd3NlciB0YWIuJztcclxudmFyIFBSSU1BUllfTEVBU0VfRVhDTFVTSVZFX0VSUk9SX01TRyA9ICdBbm90aGVyIHRhYiBoYXMgZXhjbHVzaXZlIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2UgbGF5ZXIuICcgK1xyXG4gICAgJ1RvIGFsbG93IHNoYXJlZCBhY2Nlc3MsIG1ha2Ugc3VyZSB0byBpbnZva2UgJyArXHJcbiAgICAnYGVuYWJsZVBlcnNpc3RlbmNlKClgIHdpdGggYGV4cGVyaW1lbnRhbFRhYlN5bmNocm9uaXphdGlvbjp0cnVlYCBpbiBhbGwgdGFicy4nO1xyXG52YXIgVU5TVVBQT1JURURfUExBVEZPUk1fRVJST1JfTVNHID0gJ1RoaXMgcGxhdGZvcm0gaXMgZWl0aGVyIG1pc3NpbmcnICtcclxuICAgICcgSW5kZXhlZERCIG9yIGlzIGtub3duIHRvIGhhdmUgYW4gaW5jb21wbGV0ZSBpbXBsZW1lbnRhdGlvbi4gT2ZmbGluZScgK1xyXG4gICAgJyBwZXJzaXN0ZW5jZSBoYXMgYmVlbiBkaXNhYmxlZC4nO1xyXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBMb2NhbFN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIHpvbWJpZWQgY2xpZW50IGlzOlxyXG4vLyAgICAgZmlyZXN0b3JlX3pvbWJpZV88cGVyc2lzdGVuY2VfcHJlZml4Pl88aW5zdGFuY2Vfa2V5PlxyXG52YXIgWk9NQklFRF9DTElFTlRTX0tFWV9QUkVGSVggPSAnZmlyZXN0b3JlX3pvbWJpZSc7XHJcbnZhciBJbmRleGVkRGJUcmFuc2FjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEluZGV4ZWREYlRyYW5zYWN0aW9uLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gSW5kZXhlZERiVHJhbnNhY3Rpb24oc2ltcGxlRGJUcmFuc2FjdGlvbiwgY3VycmVudFNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5zaW1wbGVEYlRyYW5zYWN0aW9uID0gc2ltcGxlRGJUcmFuc2FjdGlvbjtcclxuICAgICAgICBfdGhpcy5jdXJyZW50U2VxdWVuY2VOdW1iZXIgPSBjdXJyZW50U2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEluZGV4ZWREYlRyYW5zYWN0aW9uO1xyXG59KFBlcnNpc3RlbmNlVHJhbnNhY3Rpb24pKTtcclxudmFyIEluZGV4ZWREYlBlcnNpc3RlbmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gTm90ZSB0aGF0IGBtdWx0aUNsaWVudFBhcmFtc2AgbXVzdCBiZSBwcmVzZW50IHRvIGVuYWJsZSBtdWx0aS1jbGllbnQgc3VwcG9ydCB3aGlsZSBtdWx0aS10YWJcclxuICAgIC8vIGlzIHN0aWxsIGV4cGVyaW1lbnRhbC4gV2hlbiBtdWx0aS1jbGllbnQgaXMgc3dpdGNoZWQgdG8gYWx3YXlzIG9uLCBgbXVsdGlDbGllbnRQYXJhbXNgIHdpbGxcclxuICAgIC8vIG5vIGxvbmdlciBiZSBvcHRpb25hbC5cclxuICAgIGZ1bmN0aW9uIEluZGV4ZWREYlBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlS2V5LCBjbGllbnRJZCwgcGxhdGZvcm0sIHF1ZXVlLCBzZXJpYWxpemVyLCBtdWx0aUNsaWVudFBhcmFtcykge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2VLZXkgPSBwZXJzaXN0ZW5jZUtleTtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IHF1ZXVlO1xyXG4gICAgICAgIHRoaXMubXVsdGlDbGllbnRQYXJhbXMgPSBtdWx0aUNsaWVudFBhcmFtcztcclxuICAgICAgICB0aGlzLl9zdGFydGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc1ByaW1hcnkgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmluRm9yZWdyb3VuZCA9IGZhbHNlO1xyXG4gICAgICAgIC8qKiBUaGUgbGFzdCB0aW1lIHdlIGdhcmJhZ2UgY29sbGVjdGVkIHRoZSBSZW1vdGUgRG9jdW1lbnQgQ2hhbmdlbG9nLiAqL1xyXG4gICAgICAgIHRoaXMubGFzdEdhcmJhZ2VDb2xsZWN0aW9uVGltZSA9IE51bWJlci5ORUdBVElWRV9JTkZJTklUWTtcclxuICAgICAgICAvKiogQSBsaXN0ZW5lciB0byBub3RpZnkgb24gcHJpbWFyeSBzdGF0ZSBjaGFuZ2VzLiAqL1xyXG4gICAgICAgIHRoaXMucHJpbWFyeVN0YXRlTGlzdGVuZXIgPSBmdW5jdGlvbiAoXykgeyByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7IH07XHJcbiAgICAgICAgaWYgKCFJbmRleGVkRGJQZXJzaXN0ZW5jZS5pc0F2YWlsYWJsZSgpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOSU1QTEVNRU5URUQsIFVOU1VQUE9SVEVEX1BMQVRGT1JNX0VSUk9SX01TRyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBuZXcgSW5kZXhlZERiTHJ1RGVsZWdhdGUodGhpcyk7XHJcbiAgICAgICAgdGhpcy5kYk5hbWUgPSBwZXJzaXN0ZW5jZUtleSArIEluZGV4ZWREYlBlcnNpc3RlbmNlLk1BSU5fREFUQUJBU0U7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gbmV3IExvY2FsU2VyaWFsaXplcihzZXJpYWxpemVyKTtcclxuICAgICAgICB0aGlzLmRvY3VtZW50ID0gcGxhdGZvcm0uZG9jdW1lbnQ7XHJcbiAgICAgICAgdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbiA9IG11bHRpQ2xpZW50UGFyYW1zICE9PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5xdWVyeUNhY2hlID0gbmV3IEluZGV4ZWREYlF1ZXJ5Q2FjaGUodGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSwgdGhpcy5zZXJpYWxpemVyKTtcclxuICAgICAgICB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUgPSBuZXcgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZSh0aGlzLnNlcmlhbGl6ZXIsIFxyXG4gICAgICAgIC8qa2VlcERvY3VtZW50Q2hhbmdlTG9nPSovIHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24pO1xyXG4gICAgICAgIGlmIChwbGF0Zm9ybS53aW5kb3cgJiYgcGxhdGZvcm0ud2luZG93LmxvY2FsU3RvcmFnZSkge1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvdyA9IHBsYXRmb3JtLndpbmRvdztcclxuICAgICAgICAgICAgdGhpcy53ZWJTdG9yYWdlID0gdGhpcy53aW5kb3cubG9jYWxTdG9yYWdlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5JTVBMRU1FTlRFRCwgJ0luZGV4ZWREQiBwZXJzaXN0ZW5jZSBpcyBvbmx5IGF2YWlsYWJsZSBvbiBwbGF0Zm9ybXMgdGhhdCBzdXBwb3J0IExvY2FsU3RvcmFnZS4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSA9IGZ1bmN0aW9uICh0eG4sIHN0b3JlKSB7XHJcbiAgICAgICAgaWYgKHR4biBpbnN0YW5jZW9mIEluZGV4ZWREYlRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTaW1wbGVEYi5nZXRTdG9yZSh0eG4uc2ltcGxlRGJUcmFuc2FjdGlvbiwgc3RvcmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgZmFpbCgnSW5kZXhlZERiUGVyc2lzdGVuY2UgbXVzdCB1c2UgaW5zdGFuY2VzIG9mIEluZGV4ZWREYlRyYW5zYWN0aW9uJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLmNyZWF0ZUluZGV4ZWREYlBlcnNpc3RlbmNlID0gZnVuY3Rpb24gKHBlcnNpc3RlbmNlS2V5LCBjbGllbnRJZCwgcGxhdGZvcm0sIHF1ZXVlLCBzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwZXJzaXN0ZW5jZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZW5jZSA9IG5ldyBJbmRleGVkRGJQZXJzaXN0ZW5jZShwZXJzaXN0ZW5jZUtleSwgY2xpZW50SWQsIHBsYXRmb3JtLCBxdWV1ZSwgc2VyaWFsaXplcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBlcnNpc3RlbmNlLnN0YXJ0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcGVyc2lzdGVuY2VdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5jcmVhdGVNdWx0aUNsaWVudEluZGV4ZWREYlBlcnNpc3RlbmNlID0gZnVuY3Rpb24gKHBlcnNpc3RlbmNlS2V5LCBjbGllbnRJZCwgcGxhdGZvcm0sIHF1ZXVlLCBzZXJpYWxpemVyLCBtdWx0aUNsaWVudFBhcmFtcykge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcGVyc2lzdGVuY2U7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdGVuY2UgPSBuZXcgSW5kZXhlZERiUGVyc2lzdGVuY2UocGVyc2lzdGVuY2VLZXksIGNsaWVudElkLCBwbGF0Zm9ybSwgcXVldWUsIHNlcmlhbGl6ZXIsIG11bHRpQ2xpZW50UGFyYW1zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGVyc2lzdGVuY2Uuc3RhcnQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBwZXJzaXN0ZW5jZV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQXR0ZW1wdCB0byBzdGFydCBJbmRleGVkRGIgcGVyc2lzdGVuY2UuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybiB7UHJvbWlzZTx2b2lkPn0gV2hldGhlciBwZXJzaXN0ZW5jZSB3YXMgZW5hYmxlZC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLnN0YXJ0ZWQsICdJbmRleGVkRGJQZXJzaXN0ZW5jZSBkb3VibGUtc3RhcnRlZCEnKTtcclxuICAgICAgICBhc3NlcnQodGhpcy53aW5kb3cgIT09IG51bGwsIFwiRXhwZWN0ZWQgJ3dpbmRvdycgdG8gYmUgZGVmaW5lZFwiKTtcclxuICAgICAgICByZXR1cm4gU2ltcGxlRGIub3Blbk9yQ3JlYXRlKHRoaXMuZGJOYW1lLCBTQ0hFTUFfVkVSU0lPTiwgbmV3IFNjaGVtYUNvbnZlcnRlcih0aGlzLnNlcmlhbGl6ZXIpKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGIpIHtcclxuICAgICAgICAgICAgX3RoaXMuc2ltcGxlRGIgPSBkYjtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zdGFydFJlbW90ZURvY3VtZW50Q2FjaGUoKTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hdHRhY2hWaXNpYmlsaXR5SGFuZGxlcigpO1xyXG4gICAgICAgICAgICBfdGhpcy5hdHRhY2hXaW5kb3dVbmxvYWRIb29rKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy51cGRhdGVDbGllbnRNZXRhZGF0YUFuZFRyeUJlY29tZVByaW1hcnkoKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zY2hlZHVsZUNsaWVudE1ldGFkYXRhQW5kUHJpbWFyeUxlYXNlUmVmcmVzaGVzKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNpbXBsZURiLnJ1blRyYW5zYWN0aW9uKCdyZWFkb25seScsIFtEYlRhcmdldEdsb2JhbC5zdG9yZV0sIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRIaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIodHhuKS5uZXh0KGZ1bmN0aW9uIChoaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2VxdWVuY2VOdW1iZXJTeW5jZXIgPSBfdGhpcy5tdWx0aUNsaWVudFBhcmFtc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IF90aGlzLm11bHRpQ2xpZW50UGFyYW1zLnNlcXVlbmNlTnVtYmVyU3luY2VyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmxpc3RlblNlcXVlbmNlID0gbmV3IExpc3RlblNlcXVlbmNlKGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciwgc2VxdWVuY2VOdW1iZXJTeW5jZXIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMuX3N0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnNpbXBsZURiICYmIF90aGlzLnNpbXBsZURiLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZWFzb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5zdGFydFJlbW90ZURvY3VtZW50Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5zaW1wbGVEYi5ydW5UcmFuc2FjdGlvbigncmVhZG9ubHknLCBBTExfU1RPUkVTLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLnN0YXJ0KHR4bik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnNldFByaW1hcnlTdGF0ZUxpc3RlbmVyID0gZnVuY3Rpb24gKHByaW1hcnlTdGF0ZUxpc3RlbmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnByaW1hcnlTdGF0ZUxpc3RlbmVyID0gZnVuY3Rpb24gKHByaW1hcnlTdGF0ZSkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBwcmltYXJ5U3RhdGVMaXN0ZW5lcihwcmltYXJ5U3RhdGUpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH07XHJcbiAgICAgICAgcmV0dXJuIHByaW1hcnlTdGF0ZUxpc3RlbmVyKHRoaXMuaXNQcmltYXJ5KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc2V0TmV0d29ya0VuYWJsZWQgPSBmdW5jdGlvbiAobmV0d29ya0VuYWJsZWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLm5ldHdvcmtFbmFibGVkICE9PSBuZXR3b3JrRW5hYmxlZCkge1xyXG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkID0gbmV0d29ya0VuYWJsZWQ7XHJcbiAgICAgICAgICAgIC8vIFNjaGVkdWxlIGEgcHJpbWFyeSBsZWFzZSByZWZyZXNoIGZvciBpbW1lZGlhdGUgZXhlY3V0aW9uLiBUaGUgZXZlbnR1YWxcclxuICAgICAgICAgICAgLy8gbGVhc2UgdXBkYXRlIHdpbGwgYmUgcHJvcGFnYXRlZCB2aWEgYHByaW1hcnlTdGF0ZUxpc3RlbmVyYC5cclxuICAgICAgICAgICAgdGhpcy5xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc3RhcnRlZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnVwZGF0ZUNsaWVudE1ldGFkYXRhQW5kVHJ5QmVjb21lUHJpbWFyeSgpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgdGhlIGNsaWVudCBtZXRhZGF0YSBpbiBJbmRleGVkRGIgYW5kIGF0dGVtcHRzIHRvIGVpdGhlciBvYnRhaW4gb3JcclxuICAgICAqIGV4dGVuZCB0aGUgcHJpbWFyeSBsZWFzZSBmb3IgdGhlIGxvY2FsIGNsaWVudC4gQXN5bmNocm9ub3VzbHkgbm90aWZpZXMgdGhlXHJcbiAgICAgKiBwcmltYXJ5IHN0YXRlIGxpc3RlbmVyIGlmIHRoZSBjbGllbnQgZWl0aGVyIG5ld2x5IG9idGFpbmVkIG9yIHJlbGVhc2VkIGl0c1xyXG4gICAgICogcHJpbWFyeSBsZWFzZS5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnVwZGF0ZUNsaWVudE1ldGFkYXRhQW5kVHJ5QmVjb21lUHJpbWFyeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNpbXBsZURiLnJ1blRyYW5zYWN0aW9uKCdyZWFkd3JpdGUnLCBBTExfU1RPUkVTLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YVN0b3JlID0gY2xpZW50TWV0YWRhdGFTdG9yZSh0eG4pO1xyXG4gICAgICAgICAgICByZXR1cm4gbWV0YWRhdGFTdG9yZVxyXG4gICAgICAgICAgICAgICAgLnB1dChuZXcgRGJDbGllbnRNZXRhZGF0YShfdGhpcy5jbGllbnRJZCwgRGF0ZS5ub3coKSwgX3RoaXMubmV0d29ya0VuYWJsZWQsIF90aGlzLmluRm9yZWdyb3VuZCwgX3RoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCkpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnZlcmlmeVByaW1hcnlMZWFzZSh0eG4pLm5leHQoZnVuY3Rpb24gKHN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc1ByaW1hcnkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnF1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wcmltYXJ5U3RhdGVMaXN0ZW5lcihmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuY2FuQWN0QXNQcmltYXJ5KHR4bik7IH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoY2FuQWN0QXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgd2FzUHJpbWFyeSA9IF90aGlzLmlzUHJpbWFyeTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmlzUHJpbWFyeSA9IGNhbkFjdEFzUHJpbWFyeTtcclxuICAgICAgICAgICAgICAgIGlmICh3YXNQcmltYXJ5ICE9PSBfdGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnByaW1hcnlTdGF0ZUxpc3RlbmVyKF90aGlzLmlzUHJpbWFyeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAod2FzUHJpbWFyeSAmJiAhX3RoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbGVhc2VQcmltYXJ5TGVhc2VJZkhlbGQodHhuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKF90aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5hY3F1aXJlT3JFeHRlbmRQcmltYXJ5TGVhc2UodHhuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnZlcmlmeVByaW1hcnlMZWFzZSA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzdG9yZSA9IHByaW1hcnlDbGllbnRTdG9yZSh0eG4pO1xyXG4gICAgICAgIHJldHVybiBzdG9yZS5nZXQoRGJQcmltYXJ5Q2xpZW50LmtleSkubmV4dChmdW5jdGlvbiAocHJpbWFyeUNsaWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoX3RoaXMuaXNMb2NhbENsaWVudChwcmltYXJ5Q2xpZW50KSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnJlbW92ZUNsaWVudE1ldGFkYXRhID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBtZXRhZGF0YVN0b3JlID0gY2xpZW50TWV0YWRhdGFTdG9yZSh0eG4pO1xyXG4gICAgICAgIHJldHVybiBtZXRhZGF0YVN0b3JlLmRlbGV0ZSh0aGlzLmNsaWVudElkKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIElmIHRoZSBnYXJiYWdlIGNvbGxlY3Rpb24gdGhyZXNob2xkIGhhcyBwYXNzZWQsIHBydW5lcyB0aGVcclxuICAgICAqIFJlbW90ZURvY3VtZW50Q2hhbmdlcyBhbmQgdGhlIENsaWVudE1ldGFkYXRhIHN0b3JlIGJhc2VkIG9uIHRoZSBsYXN0IHVwZGF0ZVxyXG4gICAgICogdGltZSBvZiBhbGwgY2xpZW50cy5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLm1heWJlR2FyYmFnZUNvbGxlY3RNdWx0aUNsaWVudFN0YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgYWN0aXZlQ2xpZW50c18xLCBpbmFjdGl2ZUNsaWVudHNfMTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLmlzUHJpbWFyeSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMuaXNXaXRoaW5BZ2UodGhpcy5sYXN0R2FyYmFnZUNvbGxlY3Rpb25UaW1lLCBNQVhfQ0xJRU5UX0FHRV9NUykpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0R2FyYmFnZUNvbGxlY3Rpb25UaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5hY3RpdmVDbGllbnRzXzEgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5ydW5UcmFuc2FjdGlvbignbWF5YmVHYXJiYWdlQ29sbGVjdE11bHRpQ2xpZW50U3RhdGUnLCAncmVhZHdyaXRlLXByaW1hcnknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGFkYXRhU3RvcmUgPSBJbmRleGVkRGJQZXJzaXN0ZW5jZS5nZXRTdG9yZSh0eG4sIERiQ2xpZW50TWV0YWRhdGEuc3RvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YVN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5sb2FkQWxsKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGV4aXN0aW5nQ2xpZW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVDbGllbnRzXzEgPSBfdGhpcy5maWx0ZXJBY3RpdmVDbGllbnRzKGV4aXN0aW5nQ2xpZW50cywgTUFYX0NMSUVOVF9BR0VfTVMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmFjdGl2ZUNsaWVudHNfMSA9IGV4aXN0aW5nQ2xpZW50cy5maWx0ZXIoZnVuY3Rpb24gKGNsaWVudCkgeyByZXR1cm4gYWN0aXZlQ2xpZW50c18xLmluZGV4T2YoY2xpZW50KSA9PT0gLTE7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIG1ldGFkYXRhIGZvciBjbGllbnRzIHRoYXQgYXJlIG5vIGxvbmdlciBjb25zaWRlcmVkIGFjdGl2ZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKGluYWN0aXZlQ2xpZW50c18xLCBmdW5jdGlvbiAoaW5hY3RpdmVDbGllbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRhZGF0YVN0b3JlLmRlbGV0ZShpbmFjdGl2ZUNsaWVudC5jbGllbnRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmV0cmlldmUgdGhlIG1pbmltdW0gY2hhbmdlIElEIGZyb20gdGhlIHNldCBvZiBhY3RpdmUgY2xpZW50cy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHByaW1hcnkgY2xpZW50IGRvZXNuJ3QgcmVhZCBmcm9tIHRoZSBkb2N1bWVudCBjaGFuZ2UgbG9nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgaGVuY2Ugd2UgZXhjbHVkZSBpdCB3aGVuIHdlIGRldGVybWluZSB0aGUgbWluaW11bVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBgbGFzdFByb2Nlc3NlZERvY3VtZW50Q2hhbmdlSWRgLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVDbGllbnRzXzEgPSBhY3RpdmVDbGllbnRzXzEuZmlsdGVyKGZ1bmN0aW9uIChjbGllbnQpIHsgcmV0dXJuIGNsaWVudC5jbGllbnRJZCAhPT0gX3RoaXMuY2xpZW50SWQ7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlQ2xpZW50c18xLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzZWRDaGFuZ2VJZHMgPSBhY3RpdmVDbGllbnRzXzEubWFwKGZ1bmN0aW9uIChjbGllbnQpIHsgcmV0dXJuIGNsaWVudC5sYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZCB8fCAwOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbGRlc3RDaGFuZ2VJZCA9IE1hdGgubWluLmFwcGx5KE1hdGgsIHByb2Nlc3NlZENoYW5nZUlkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5yZW1vdmVEb2N1bWVudENoYW5nZXNUaHJvdWdoQ2hhbmdlSWQodHhuLCBvbGRlc3RDaGFuZ2VJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIHBvdGVudGlhbCBsZWZ0b3ZlciBlbnRyaWVzIHRoYXQgbWF5IGNvbnRpbnVlIHRvIG1hcmsgdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluYWN0aXZlIGNsaWVudHMgYXMgem9tYmllZCBpbiBMb2NhbFN0b3JhZ2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElkZWFsbHkgd2UnZCBkZWxldGUgdGhlIEluZGV4ZWREYiBhbmQgTG9jYWxTdG9yYWdlIHpvbWJpZSBlbnRyaWVzIGZvclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgY2xpZW50IGF0b21pY2FsbHksIGJ1dCB3ZSBjYW4ndC4gU28gd2Ugb3B0IHRvIGRlbGV0ZSB0aGUgSW5kZXhlZERiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVudHJpZXMgZmlyc3QgdG8gYXZvaWQgcG90ZW50aWFsbHkgcmV2aXZpbmcgYSB6b21iaWVkIGNsaWVudC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5hY3RpdmVDbGllbnRzXzEuZm9yRWFjaChmdW5jdGlvbiAoaW5hY3RpdmVDbGllbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShfdGhpcy56b21iaWVkQ2xpZW50TG9jYWxTdG9yYWdlS2V5KGluYWN0aXZlQ2xpZW50LmNsaWVudElkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU2NoZWR1bGVzIGEgcmVjdXJyaW5nIHRpbWVyIHRvIHVwZGF0ZSB0aGUgY2xpZW50IG1ldGFkYXRhIGFuZCB0byBlaXRoZXJcclxuICAgICAqIGV4dGVuZCBvciBhY3F1aXJlIHRoZSBwcmltYXJ5IGxlYXNlIGlmIHRoZSBjbGllbnQgaXMgZWxpZ2libGUuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5zY2hlZHVsZUNsaWVudE1ldGFkYXRhQW5kUHJpbWFyeUxlYXNlUmVmcmVzaGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5jbGllbnRNZXRhZGF0YVJlZnJlc2hlciA9IHRoaXMucXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkoVGltZXJJZC5DbGllbnRNZXRhZGF0YVJlZnJlc2gsIENMSUVOVF9NRVRBREFUQV9SRUZSRVNIX0lOVEVSVkFMX01TLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy51cGRhdGVDbGllbnRNZXRhZGF0YUFuZFRyeUJlY29tZVByaW1hcnkoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMubWF5YmVHYXJiYWdlQ29sbGVjdE11bHRpQ2xpZW50U3RhdGUoKTsgfSlcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnNjaGVkdWxlQ2xpZW50TWV0YWRhdGFBbmRQcmltYXJ5TGVhc2VSZWZyZXNoZXMoKTsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIENoZWNrcyB3aGV0aGVyIGBjbGllbnRgIGlzIHRoZSBsb2NhbCBjbGllbnQuICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuaXNMb2NhbENsaWVudCA9IGZ1bmN0aW9uIChjbGllbnQpIHtcclxuICAgICAgICByZXR1cm4gY2xpZW50ID8gY2xpZW50Lm93bmVySWQgPT09IHRoaXMuY2xpZW50SWQgOiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEV2YWx1YXRlIHRoZSBzdGF0ZSBvZiBhbGwgYWN0aXZlIGNsaWVudHMgYW5kIGRldGVybWluZSB3aGV0aGVyIHRoZSBsb2NhbFxyXG4gICAgICogY2xpZW50IGlzIG9yIGNhbiBhY3QgYXMgdGhlIGhvbGRlciBvZiB0aGUgcHJpbWFyeSBsZWFzZS4gUmV0dXJucyB3aGV0aGVyXHJcbiAgICAgKiB0aGUgY2xpZW50IGlzIGVsaWdpYmxlIGZvciB0aGUgbGVhc2UsIGJ1dCBkb2VzIG5vdCBhY3R1YWxseSBhY3F1aXJlIGl0LlxyXG4gICAgICogTWF5IHJldHVybiAnZmFsc2UnIGV2ZW4gaWYgdGhlcmUgaXMgbm8gYWN0aXZlIGxlYXNlaG9sZGVyIGFuZCBhbm90aGVyXHJcbiAgICAgKiAoZm9yZWdyb3VuZCkgY2xpZW50IHNob3VsZCBiZWNvbWUgbGVhc2Vob2xkZXIgaW5zdGVhZC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmNhbkFjdEFzUHJpbWFyeSA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzdG9yZSA9IHByaW1hcnlDbGllbnRTdG9yZSh0eG4pO1xyXG4gICAgICAgIHJldHVybiBzdG9yZVxyXG4gICAgICAgICAgICAuZ2V0KERiUHJpbWFyeUNsaWVudC5rZXkpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChjdXJyZW50UHJpbWFyeSkge1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudExlYXNlSXNWYWxpZCA9IGN1cnJlbnRQcmltYXJ5ICE9PSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5pc1dpdGhpbkFnZShjdXJyZW50UHJpbWFyeS5sZWFzZVRpbWVzdGFtcE1zLCBNQVhfUFJJTUFSWV9FTElHSUJMRV9BR0VfTVMpICYmXHJcbiAgICAgICAgICAgICAgICAhX3RoaXMuaXNDbGllbnRab21iaWVkKGN1cnJlbnRQcmltYXJ5Lm93bmVySWQpO1xyXG4gICAgICAgICAgICAvLyBBIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhlIHByaW1hcnkgbGVhc2UgaWY6XHJcbiAgICAgICAgICAgIC8vIC0gaXRzIG5ldHdvcmsgaXMgZW5hYmxlZCBhbmQgdGhlIGNsaWVudCdzIHRhYiBpcyBpbiB0aGUgZm9yZWdyb3VuZC5cclxuICAgICAgICAgICAgLy8gLSBpdHMgbmV0d29yayBpcyBlbmFibGVkIGFuZCBubyBvdGhlciBjbGllbnQncyB0YWIgaXMgaW4gdGhlXHJcbiAgICAgICAgICAgIC8vICAgZm9yZWdyb3VuZC5cclxuICAgICAgICAgICAgLy8gLSBldmVyeSBjbGllbnRzIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIHRoZSBjbGllbnQncyB0YWIgaXMgaW4gdGhlXHJcbiAgICAgICAgICAgIC8vICAgZm9yZWdyb3VuZC5cclxuICAgICAgICAgICAgLy8gLSBldmVyeSBjbGllbnRzIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIG5vIG90aGVyIGNsaWVudCdzIHRhYiBpcyBpblxyXG4gICAgICAgICAgICAvLyAgIHRoZSBmb3JlZ3JvdW5kLlxyXG4gICAgICAgICAgICBpZiAoY3VycmVudExlYXNlSXNWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzTG9jYWxDbGllbnQoY3VycmVudFByaW1hcnkpICYmIF90aGlzLm5ldHdvcmtFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIV90aGlzLmlzTG9jYWxDbGllbnQoY3VycmVudFByaW1hcnkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50UHJpbWFyeS5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGYWlsIHRoZSBgY2FuQWN0QXNQcmltYXJ5YCBjaGVjayBpZiB0aGUgY3VycmVudCBsZWFzZWhvbGRlciBoYXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm90IG9wdGVkIGludG8gbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi4gSWYgdGhpcyBoYXBwZW5zIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNsaWVudCBzdGFydHVwLCB3ZSByZWplY3QgdGhlIFByb21pc2UgcmV0dXJuZWQgYnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYGVuYWJsZVBlcnNpc3RlbmNlKClgIGFuZCB0aGUgdXNlciBjYW4gY29udGludWUgdG8gdXNlIEZpcmVzdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3aXRoIGluLW1lbW9yeSBwZXJzaXN0ZW5jZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBmYWlscyBkdXJpbmcgYSBsZWFzZSByZWZyZXNoLCB3ZSB3aWxsIGluc3RlYWQgYmxvY2sgdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFzeW5jUXVldWUgZnJvbSBleGVjdXRpbmcgZnVydGhlciBvcGVyYXRpb25zLiBOb3RlIHRoYXQgdGhpcyBpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhY2NlcHRhYmxlIHNpbmNlIG1peGluZyAmIG1hdGNoaW5nIGRpZmZlcmVudCBgc3luY2hyb25pemVUYWJzYFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXR0aW5ncyBpcyBub3Qgc3VwcG9ydGVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIHRoaXMgY2hlY2sgd2hlbiBgc3luY2hyb25pemVUYWJzYCBjYW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm8gbG9uZ2VyIGJlIHR1cm5lZCBvZmYuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sIFBSSU1BUllfTEVBU0VfRVhDTFVTSVZFX0VSUk9SX01TRyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoX3RoaXMubmV0d29ya0VuYWJsZWQgJiYgX3RoaXMuaW5Gb3JlZ3JvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gY2xpZW50TWV0YWRhdGFTdG9yZSh0eG4pXHJcbiAgICAgICAgICAgICAgICAubG9hZEFsbCgpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoZXhpc3RpbmdDbGllbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGFsbCBleGlzdGluZyBjbGllbnRzIGFuZCBkZXRlcm1pbmUgd2hldGhlciBhdCBsZWFzdCBvbmUgb2ZcclxuICAgICAgICAgICAgICAgIC8vIHRoZW0gaXMgYmV0dGVyIHN1aXRlZCB0byBvYnRhaW4gdGhlIHByaW1hcnkgbGVhc2UuXHJcbiAgICAgICAgICAgICAgICB2YXIgcHJlZmVycmVkQ2FuZGlkYXRlID0gX3RoaXMuZmlsdGVyQWN0aXZlQ2xpZW50cyhleGlzdGluZ0NsaWVudHMsIE1BWF9QUklNQVJZX0VMSUdJQkxFX0FHRV9NUykuZmluZChmdW5jdGlvbiAob3RoZXJDbGllbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY2xpZW50SWQgIT09IG90aGVyQ2xpZW50LmNsaWVudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdGhlckNsaWVudEhhc0JldHRlck5ldHdvcmtTdGF0ZSA9ICFfdGhpcy5uZXR3b3JrRW5hYmxlZCAmJiBvdGhlckNsaWVudC5uZXR3b3JrRW5hYmxlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG90aGVyQ2xpZW50SGFzQmV0dGVyVmlzaWJpbGl0eSA9ICFfdGhpcy5pbkZvcmVncm91bmQgJiYgb3RoZXJDbGllbnQuaW5Gb3JlZ3JvdW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXJDbGllbnRIYXNTYW1lTmV0d29ya1N0YXRlID0gX3RoaXMubmV0d29ya0VuYWJsZWQgPT09IG90aGVyQ2xpZW50Lm5ldHdvcmtFbmFibGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3RoZXJDbGllbnRIYXNCZXR0ZXJOZXR3b3JrU3RhdGUgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvdGhlckNsaWVudEhhc0JldHRlclZpc2liaWxpdHkgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdGhlckNsaWVudEhhc1NhbWVOZXR3b3JrU3RhdGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcmVmZXJyZWRDYW5kaWRhdGUgPT09IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGNhbkFjdEFzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuaXNQcmltYXJ5ICE9PSBjYW5BY3RBc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckMiwgXCJDbGllbnQgXCIgKyAoY2FuQWN0QXNQcmltYXJ5ID8gJ2lzJyA6ICdpcyBub3QnKSArIFwiIGVsaWdpYmxlIGZvciBhIHByaW1hcnkgbGVhc2UuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBjYW5BY3RBc1ByaW1hcnk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnNodXRkb3duID0gZnVuY3Rpb24gKGRlbGV0ZURhdGEpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc2h1dGRvd24oKSBvcGVyYXRpb25zIGFyZSBpZGVtcG90ZW50IGFuZCBjYW4gYmUgY2FsbGVkIGV2ZW4gd2hlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFydCgpIGFib3J0ZWQgKGUuZy4gYmVjYXVzZSBpdCBjb3VsZG4ndCBhY3F1aXJlIHRoZSBwZXJzaXN0ZW5jZSBsZWFzZSkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0ZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrQ2xpZW50Wm9tYmllZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jbGllbnRNZXRhZGF0YVJlZnJlc2hlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGllbnRNZXRhZGF0YVJlZnJlc2hlci5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRldGFjaFZpc2liaWxpdHlIYW5kbGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoV2luZG93VW5sb2FkSG9vaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnNpbXBsZURiLnJ1blRyYW5zYWN0aW9uKCdyZWFkd3JpdGUnLCBbRGJQcmltYXJ5Q2xpZW50LnN0b3JlLCBEYkNsaWVudE1ldGFkYXRhLnN0b3JlXSwgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZWxlYXNlUHJpbWFyeUxlYXNlSWZIZWxkKHR4bikubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW1vdmVDbGllbnRNZXRhZGF0YSh0eG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpbXBsZURiLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgZW50cnkgbWFya2luZyB0aGUgY2xpZW50IGFzIHpvbWJpZWQgZnJvbSBMb2NhbFN0b3JhZ2Ugc2luY2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2Ugc3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgaXRzIG1ldGFkYXRhIGZyb20gSW5kZXhlZERiLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNsaWVudFpvbWJpZWRFbnRyeSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRlbGV0ZURhdGEpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBTaW1wbGVEYi5kZWxldGUodGhpcy5kYk5hbWUpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgY2xpZW50cyB0aGF0IGFyZSBub3Qgem9tYmllZCBhbmQgaGF2ZSBhbiB1cGRhdGVUaW1lIHdpdGhpbiB0aGVcclxuICAgICAqIHByb3ZpZGVkIHRocmVzaG9sZC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmZpbHRlckFjdGl2ZUNsaWVudHMgPSBmdW5jdGlvbiAoY2xpZW50cywgYWN0aXZpdHlUaHJlc2hvbGRNcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIGNsaWVudHMuZmlsdGVyKGZ1bmN0aW9uIChjbGllbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmlzV2l0aGluQWdlKGNsaWVudC51cGRhdGVUaW1lTXMsIGFjdGl2aXR5VGhyZXNob2xkTXMpICYmXHJcbiAgICAgICAgICAgICAgICAhX3RoaXMuaXNDbGllbnRab21iaWVkKGNsaWVudC5jbGllbnRJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmdldEFjdGl2ZUNsaWVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5zaW1wbGVEYi5ydW5UcmFuc2FjdGlvbigncmVhZG9ubHknLCBbRGJDbGllbnRNZXRhZGF0YS5zdG9yZV0sIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNsaWVudE1ldGFkYXRhU3RvcmUodHhuKVxyXG4gICAgICAgICAgICAgICAgLmxvYWRBbGwoKVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGNsaWVudHMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5maWx0ZXJBY3RpdmVDbGllbnRzKGNsaWVudHMsIE1BWF9DTElFTlRfQUdFX01TKS5tYXAoZnVuY3Rpb24gKGNsaWVudE1ldGFkYXRhKSB7IHJldHVybiBjbGllbnRNZXRhZGF0YS5jbGllbnRJZDsgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUsIFwic3RhcnRlZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGFydGVkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmdldE11dGF0aW9uUXVldWUgPSBmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnN0YXJ0ZWQsICdDYW5ub3QgaW5pdGlhbGl6ZSBNdXRhdGlvblF1ZXVlIGJlZm9yZSBwZXJzaXN0ZW5jZSBpcyBzdGFydGVkLicpO1xyXG4gICAgICAgIHJldHVybiBJbmRleGVkRGJNdXRhdGlvblF1ZXVlLmZvclVzZXIodXNlciwgdGhpcy5zZXJpYWxpemVyLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuZ2V0UXVlcnlDYWNoZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5zdGFydGVkLCAnQ2Fubm90IGluaXRpYWxpemUgUXVlcnlDYWNoZSBiZWZvcmUgcGVyc2lzdGVuY2UgaXMgc3RhcnRlZC4nKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5xdWVyeUNhY2hlO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRSZW1vdGVEb2N1bWVudENhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnN0YXJ0ZWQsICdDYW5ub3QgaW5pdGlhbGl6ZSBSZW1vdGVEb2N1bWVudENhY2hlIGJlZm9yZSBwZXJzaXN0ZW5jZSBpcyBzdGFydGVkLicpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGU7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnJ1blRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKGFjdGlvbiwgbW9kZSwgdHJhbnNhY3Rpb25PcGVyYXRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMiwgJ1N0YXJ0aW5nIHRyYW5zYWN0aW9uOicsIGFjdGlvbik7XHJcbiAgICAgICAgLy8gRG8gYWxsIHRyYW5zYWN0aW9ucyBhcyByZWFkd3JpdGUgYWdhaW5zdCBhbGwgb2JqZWN0IHN0b3Jlcywgc2luY2Ugd2VcclxuICAgICAgICAvLyBhcmUgdGhlIG9ubHkgcmVhZGVyL3dyaXRlci5cclxuICAgICAgICByZXR1cm4gdGhpcy5zaW1wbGVEYi5ydW5UcmFuc2FjdGlvbihtb2RlID09PSAncmVhZG9ubHknID8gJ3JlYWRvbmx5JyA6ICdyZWFkd3JpdGUnLCBBTExfU1RPUkVTLCBmdW5jdGlvbiAoc2ltcGxlRGJUeG4pIHtcclxuICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdyZWFkd3JpdGUtcHJpbWFyeScpIHtcclxuICAgICAgICAgICAgICAgIC8vIFdoaWxlIHdlIG1lcmVseSB2ZXJpZnkgdGhhdCB3ZSBoYXZlIChvciBjYW4gYWNxdWlyZSkgdGhlIGxlYXNlXHJcbiAgICAgICAgICAgICAgICAvLyBpbW1lZGlhdGVseSwgd2Ugd2FpdCB0byBleHRlbmQgdGhlIHByaW1hcnkgbGVhc2UgdW50aWwgYWZ0ZXJcclxuICAgICAgICAgICAgICAgIC8vIGV4ZWN1dGluZyB0cmFuc2FjdGlvbk9wZXJhdGlvbigpLiBUaGlzIGVuc3VyZXMgdGhhdCBldmVuIGlmIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gdHJhbnNhY3Rpb25PcGVyYXRpb24gdGFrZXMgYSBsb25nIHRpbWUsIHdlJ2xsIHVzZSBhIHJlY2VudFxyXG4gICAgICAgICAgICAgICAgLy8gbGVhc2VUaW1lc3RhbXBNcyBpbiB0aGUgZXh0ZW5kZWQgKG9yIG5ld2x5IGFjcXVpcmVkKSBsZWFzZS5cclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy52ZXJpZnlQcmltYXJ5TGVhc2Uoc2ltcGxlRGJUeG4pXHJcbiAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoXCJGYWlsZWQgdG8gb2J0YWluIHByaW1hcnkgbGVhc2UgZm9yIGFjdGlvbiAnXCIgKyBhY3Rpb24gKyBcIicuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc1ByaW1hcnkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucHJpbWFyeVN0YXRlTGlzdGVuZXIoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgUFJJTUFSWV9MRUFTRV9MT1NUX0VSUk9SX01TRyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbk9wZXJhdGlvbihuZXcgSW5kZXhlZERiVHJhbnNhY3Rpb24oc2ltcGxlRGJUeG4sIF90aGlzLmxpc3RlblNlcXVlbmNlLm5leHQoKSkpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmFjcXVpcmVPckV4dGVuZFByaW1hcnlMZWFzZShzaW1wbGVEYlR4bikubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiByZXN1bHQ7IH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudmVyaWZ5QWxsb3dUYWJTeW5jaHJvbml6YXRpb24oc2ltcGxlRGJUeG4pLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2FjdGlvbk9wZXJhdGlvbihuZXcgSW5kZXhlZERiVHJhbnNhY3Rpb24oc2ltcGxlRGJUeG4sIF90aGlzLmxpc3RlblNlcXVlbmNlLm5leHQoKSkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFZlcmlmaWVzIHRoYXQgdGhlIGN1cnJlbnQgdGFiIGlzIHRoZSBwcmltYXJ5IGxlYXNlaG9sZGVyIG9yIGFsdGVybmF0aXZlbHlcclxuICAgICAqIHRoYXQgdGhlIGxlYXNlaG9sZGVyIGhhcyBvcHRlZCBpbnRvIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uXHJcbiAgICAgKi9cclxuICAgIC8vIFRPRE8oYi8xMTQyMjYyMzQpOiBSZW1vdmUgdGhpcyBjaGVjayB3aGVuIGBzeW5jaHJvbml6ZVRhYnNgIGNhbiBubyBsb25nZXJcclxuICAgIC8vIGJlIHR1cm5lZCBvZmYuXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUudmVyaWZ5QWxsb3dUYWJTeW5jaHJvbml6YXRpb24gPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgc3RvcmUgPSBwcmltYXJ5Q2xpZW50U3RvcmUodHhuKTtcclxuICAgICAgICByZXR1cm4gc3RvcmUuZ2V0KERiUHJpbWFyeUNsaWVudC5rZXkpLm5leHQoZnVuY3Rpb24gKGN1cnJlbnRQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50TGVhc2VJc1ZhbGlkID0gY3VycmVudFByaW1hcnkgIT09IG51bGwgJiZcclxuICAgICAgICAgICAgICAgIF90aGlzLmlzV2l0aGluQWdlKGN1cnJlbnRQcmltYXJ5LmxlYXNlVGltZXN0YW1wTXMsIE1BWF9QUklNQVJZX0VMSUdJQkxFX0FHRV9NUykgJiZcclxuICAgICAgICAgICAgICAgICFfdGhpcy5pc0NsaWVudFpvbWJpZWQoY3VycmVudFByaW1hcnkub3duZXJJZCk7XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50TGVhc2VJc1ZhbGlkICYmICFfdGhpcy5pc0xvY2FsQ2xpZW50KGN1cnJlbnRQcmltYXJ5KSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50UHJpbWFyeS5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sIFBSSU1BUllfTEVBU0VfRVhDTFVTSVZFX0VSUk9SX01TRyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIE9idGFpbnMgb3IgZXh0ZW5kcyB0aGUgbmV3IHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIFRoaXNcclxuICAgICAqIG1ldGhvZCBkb2VzIG5vdCB2ZXJpZnkgdGhhdCB0aGUgY2xpZW50IGlzIGVsaWdpYmxlIGZvciB0aGlzIGxlYXNlLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuYWNxdWlyZU9yRXh0ZW5kUHJpbWFyeUxlYXNlID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHZhciBuZXdQcmltYXJ5ID0gbmV3IERiUHJpbWFyeUNsaWVudCh0aGlzLmNsaWVudElkLCB0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uLCBEYXRlLm5vdygpKTtcclxuICAgICAgICByZXR1cm4gcHJpbWFyeUNsaWVudFN0b3JlKHR4bikucHV0KERiUHJpbWFyeUNsaWVudC5rZXksIG5ld1ByaW1hcnkpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLmlzQXZhaWxhYmxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBTaW1wbGVEYi5pc0F2YWlsYWJsZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogR2VuZXJhdGVzIGEgc3RyaW5nIHVzZWQgYXMgYSBwcmVmaXggd2hlbiBzdG9yaW5nIGRhdGEgaW4gSW5kZXhlZERCIGFuZFxyXG4gICAgICogTG9jYWxTdG9yYWdlLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5idWlsZFN0b3JhZ2VQcmVmaXggPSBmdW5jdGlvbiAoZGF0YWJhc2VJbmZvKSB7XHJcbiAgICAgICAgLy8gVXNlIHR3byBkaWZmZXJlbnQgcHJlZml4IGZvcm1hdHM6XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICogZmlyZXN0b3JlIC8gcGVyc2lzdGVuY2VLZXkgLyBwcm9qZWN0SUQgLiBkYXRhYmFzZUlEIC8gLi4uXHJcbiAgICAgICAgLy8gICAqIGZpcmVzdG9yZSAvIHBlcnNpc3RlbmNlS2V5IC8gcHJvamVjdElEIC8gLi4uXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBwcm9qZWN0SURzIGFyZSBETlMtY29tcGF0aWJsZSBuYW1lcyBhbmQgY2Fubm90IGNvbnRhaW4gZG90c1xyXG4gICAgICAgIC8vIHNvIHRoZXJlJ3Mgbm8gZGFuZ2VyIG9mIGNvbGxpc2lvbnMuXHJcbiAgICAgICAgdmFyIGRhdGFiYXNlID0gZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQucHJvamVjdElkO1xyXG4gICAgICAgIGlmICghZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQuaXNEZWZhdWx0RGF0YWJhc2UpIHtcclxuICAgICAgICAgICAgZGF0YWJhc2UgKz0gJy4nICsgZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQuZGF0YWJhc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAnZmlyZXN0b3JlLycgKyBkYXRhYmFzZUluZm8ucGVyc2lzdGVuY2VLZXkgKyAnLycgKyBkYXRhYmFzZSArICcvJztcclxuICAgIH07XHJcbiAgICAvKiogQ2hlY2tzIHRoZSBwcmltYXJ5IGxlYXNlIGFuZCByZW1vdmVzIGl0IGlmIHdlIGFyZSB0aGUgY3VycmVudCBwcmltYXJ5LiAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLnJlbGVhc2VQcmltYXJ5TGVhc2VJZkhlbGQgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgc3RvcmUgPSBwcmltYXJ5Q2xpZW50U3RvcmUodHhuKTtcclxuICAgICAgICByZXR1cm4gc3RvcmUuZ2V0KERiUHJpbWFyeUNsaWVudC5rZXkpLm5leHQoZnVuY3Rpb24gKHByaW1hcnlDbGllbnQpIHtcclxuICAgICAgICAgICAgaWYgKF90aGlzLmlzTG9jYWxDbGllbnQocHJpbWFyeUNsaWVudCkpIHtcclxuICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckMiwgJ1JlbGVhc2luZyBwcmltYXJ5IGxlYXNlLicpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRlbGV0ZShEYlByaW1hcnlDbGllbnQua2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFZlcmlmaWVzIHRoYXQgYHVwZGF0ZVRpbWVNc2AgaXMgd2l0aGluIGBtYXhBZ2VNc2AuICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuaXNXaXRoaW5BZ2UgPSBmdW5jdGlvbiAodXBkYXRlVGltZU1zLCBtYXhBZ2VNcykge1xyXG4gICAgICAgIHZhciBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIHZhciBtaW5BY2NlcHRhYmxlID0gbm93IC0gbWF4QWdlTXM7XHJcbiAgICAgICAgdmFyIG1heEFjY2VwdGFibGUgPSBub3c7XHJcbiAgICAgICAgaWYgKHVwZGF0ZVRpbWVNcyA8IG1pbkFjY2VwdGFibGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh1cGRhdGVUaW1lTXMgPiBtYXhBY2NlcHRhYmxlKSB7XHJcbiAgICAgICAgICAgIGVycm9yKFwiRGV0ZWN0ZWQgYW4gdXBkYXRlIHRpbWUgdGhhdCBpcyBpbiB0aGUgZnV0dXJlOiBcIiArIHVwZGF0ZVRpbWVNcyArIFwiID4gXCIgKyBtYXhBY2NlcHRhYmxlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuYXR0YWNoVmlzaWJpbGl0eUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5kb2N1bWVudCAhPT0gbnVsbCAmJlxyXG4gICAgICAgICAgICB0eXBlb2YgdGhpcy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRWaXNpYmlsaXR5SGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXVlLmVucXVldWVBbmRGb3JnZXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmluRm9yZWdyb3VuZCA9IF90aGlzLmRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSA9PT0gJ3Zpc2libGUnO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy51cGRhdGVDbGllbnRNZXRhZGF0YUFuZFRyeUJlY29tZVByaW1hcnkoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Zpc2liaWxpdHljaGFuZ2UnLCB0aGlzLmRvY3VtZW50VmlzaWJpbGl0eUhhbmRsZXIpO1xyXG4gICAgICAgICAgICB0aGlzLmluRm9yZWdyb3VuZCA9IHRoaXMuZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09PSAndmlzaWJsZSc7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5kZXRhY2hWaXNpYmlsaXR5SGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5kb2N1bWVudFZpc2liaWxpdHlIYW5kbGVyKSB7XHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLmRvY3VtZW50ICE9PSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICB0eXBlb2YgdGhpcy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nLCBcIkV4cGVjdGVkICdkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyJyB0byBiZSBhIGZ1bmN0aW9uXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Zpc2liaWxpdHljaGFuZ2UnLCB0aGlzLmRvY3VtZW50VmlzaWJpbGl0eUhhbmRsZXIpO1xyXG4gICAgICAgICAgICB0aGlzLmRvY3VtZW50VmlzaWJpbGl0eUhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEF0dGFjaGVzIGEgd2luZG93LnVubG9hZCBoYW5kbGVyIHRoYXQgd2lsbCBzeW5jaHJvbm91c2x5IHdyaXRlIG91clxyXG4gICAgICogY2xpZW50SWQgdG8gYSBcInpvbWJpZSBjbGllbnQgaWRcIiBsb2NhdGlvbiBpbiBMb2NhbFN0b3JhZ2UuIFRoaXMgY2FuIGJlIHVzZWRcclxuICAgICAqIGJ5IHRhYnMgdHJ5aW5nIHRvIGFjcXVpcmUgdGhlIHByaW1hcnkgbGVhc2UgdG8gZGV0ZXJtaW5lIHRoYXQgdGhlIGxlYXNlXHJcbiAgICAgKiBpcyBubyBsb25nZXIgdmFsaWQgZXZlbiBpZiB0aGUgdGltZXN0YW1wIGlzIHJlY2VudC4gVGhpcyBpcyBwYXJ0aWN1bGFybHlcclxuICAgICAqIGltcG9ydGFudCBmb3IgdGhlIHJlZnJlc2ggY2FzZSAoc28gdGhlIHRhYiBjb3JyZWN0bHkgcmUtYWNxdWlyZXMgdGhlXHJcbiAgICAgKiBwcmltYXJ5IGxlYXNlKS4gTG9jYWxTdG9yYWdlIGlzIHVzZWQgZm9yIHRoaXMgcmF0aGVyIHRoYW4gSW5kZXhlZERiIGJlY2F1c2VcclxuICAgICAqIGl0IGlzIGEgc3luY2hyb25vdXMgQVBJIGFuZCBzbyBjYW4gYmUgdXNlZCByZWxpYWJseSBmcm9tICBhbiB1bmxvYWRcclxuICAgICAqIGhhbmRsZXIuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLnByb3RvdHlwZS5hdHRhY2hXaW5kb3dVbmxvYWRIb29rID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2luZG93VW5sb2FkSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIC8vIE5vdGU6IEluIHRoZW9yeSwgdGhpcyBzaG91bGQgYmUgc2NoZWR1bGVkIG9uIHRoZSBBc3luY1F1ZXVlIHNpbmNlIGl0XHJcbiAgICAgICAgICAgICAgICAvLyBhY2Nlc3NlcyBpbnRlcm5hbCBzdGF0ZS4gV2UgZXhlY3V0ZSB0aGlzIGNvZGUgZGlyZWN0bHkgZHVyaW5nIHNodXRkb3duXHJcbiAgICAgICAgICAgICAgICAvLyB0byBtYWtlIHN1cmUgaXQgZ2V0cyBhIGNoYW5jZSB0byBydW4uXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5tYXJrQ2xpZW50Wm9tYmllZCgpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0ZW1wdCBncmFjZWZ1bCBzaHV0ZG93biAoaW5jbHVkaW5nIHJlbGVhc2luZyBvdXIgcHJpbWFyeSBsZWFzZSksXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYnV0IHRoZXJlJ3Mgbm8gZ3VhcmFudGVlIGl0IHdpbGwgY29tcGxldGUuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNodXRkb3duKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5sb2FkJywgdGhpcy53aW5kb3dVbmxvYWRIYW5kbGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLmRldGFjaFdpbmRvd1VubG9hZEhvb2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMud2luZG93VW5sb2FkSGFuZGxlcikge1xyXG4gICAgICAgICAgICBhc3NlcnQodHlwZW9mIHRoaXMud2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIgPT09ICdmdW5jdGlvbicsIFwiRXhwZWN0ZWQgJ3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyJyB0byBiZSBhIGZ1bmN0aW9uXCIpO1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd1bmxvYWQnLCB0aGlzLndpbmRvd1VubG9hZEhhbmRsZXIpO1xyXG4gICAgICAgICAgICB0aGlzLndpbmRvd1VubG9hZEhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgd2hldGhlciBhIGNsaWVudCBpcyBcInpvbWJpZWRcIiBiYXNlZCBvbiBpdHMgTG9jYWxTdG9yYWdlIGVudHJ5LlxyXG4gICAgICogQ2xpZW50cyBiZWNvbWUgem9tYmllZCB3aGVuIHRoZWlyIHRhYiBjbG9zZXMgd2l0aG91dCBydW5uaW5nIGFsbCBvZiB0aGVcclxuICAgICAqIGNsZWFudXAgbG9naWMgaW4gYHNodXRkb3duKClgLlxyXG4gICAgICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuaXNDbGllbnRab21iaWVkID0gZnVuY3Rpb24gKGNsaWVudElkKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIGlzWm9tYmllZCA9IHRoaXMud2ViU3RvcmFnZS5nZXRJdGVtKHRoaXMuem9tYmllZENsaWVudExvY2FsU3RvcmFnZUtleShjbGllbnRJZCkpICE9PVxyXG4gICAgICAgICAgICAgICAgbnVsbDtcclxuICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQyLCBcIkNsaWVudCAnXCIgKyBjbGllbnRJZCArIFwiJyBcIiArIChpc1pvbWJpZWQgPyAnaXMnIDogJ2lzIG5vdCcpICsgXCIgem9tYmllZCBpbiBMb2NhbFN0b3JhZ2VcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBpc1pvbWJpZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIEdyYWNlZnVsbHkgaGFuZGxlIGlmIExvY2FsU3RvcmFnZSBpc24ndCB3b3JraW5nLlxyXG4gICAgICAgICAgICBlcnJvcihMT0dfVEFHJDIsICdGYWlsZWQgdG8gZ2V0IHpvbWJpZWQgY2xpZW50IGlkLicsIGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVjb3JkIGNsaWVudCBhcyB6b21iaWVkIChhIGNsaWVudCB0aGF0IGhhZCBpdHMgdGFiIGNsb3NlZCkuIFpvbWJpZWRcclxuICAgICAqIGNsaWVudHMgYXJlIGlnbm9yZWQgZHVyaW5nIHByaW1hcnkgdGFiIHNlbGVjdGlvbi5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiUGVyc2lzdGVuY2UucHJvdG90eXBlLm1hcmtDbGllbnRab21iaWVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHRoaXMud2ViU3RvcmFnZS5zZXRJdGVtKHRoaXMuem9tYmllZENsaWVudExvY2FsU3RvcmFnZUtleSh0aGlzLmNsaWVudElkKSwgU3RyaW5nKERhdGUubm93KCkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgLy8gR3JhY2VmdWxseSBoYW5kbGUgaWYgTG9jYWxTdG9yYWdlIGlzbid0IGF2YWlsYWJsZSAvIHdvcmtpbmcuXHJcbiAgICAgICAgICAgIGVycm9yKCdGYWlsZWQgdG8gc2V0IHpvbWJpZSBjbGllbnQgaWQuJywgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBSZW1vdmVzIHRoZSB6b21iaWVkIGNsaWVudCBlbnRyeSBpZiBpdCBleGlzdHMuICovXHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUucmVtb3ZlQ2xpZW50Wm9tYmllZEVudHJ5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHRoaXMud2ViU3RvcmFnZS5yZW1vdmVJdGVtKHRoaXMuem9tYmllZENsaWVudExvY2FsU3RvcmFnZUtleSh0aGlzLmNsaWVudElkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIElnbm9yZVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJQZXJzaXN0ZW5jZS5wcm90b3R5cGUuem9tYmllZENsaWVudExvY2FsU3RvcmFnZUtleSA9IGZ1bmN0aW9uIChjbGllbnRJZCkge1xyXG4gICAgICAgIHJldHVybiBaT01CSUVEX0NMSUVOVFNfS0VZX1BSRUZJWCArIFwiX1wiICsgdGhpcy5wZXJzaXN0ZW5jZUtleSArIFwiX1wiICsgY2xpZW50SWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgbWFpbiAoYW5kIGN1cnJlbnRseSBvbmx5KSBJbmRleGVkREIgZGF0YWJhc2UuIHRoaXMgbmFtZSBpc1xyXG4gICAgICogYXBwZW5kZWQgdG8gdGhlIHByZWZpeCBwcm92aWRlZCB0byB0aGUgSW5kZXhlZERiUGVyc2lzdGVuY2UgY29uc3RydWN0b3IuXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYlBlcnNpc3RlbmNlLk1BSU5fREFUQUJBU0UgPSAnbWFpbic7XHJcbiAgICByZXR1cm4gSW5kZXhlZERiUGVyc2lzdGVuY2U7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGlzUHJpbWFyeUxlYXNlTG9zdEVycm9yKGVycikge1xyXG4gICAgcmV0dXJuIChlcnIuY29kZSA9PT0gQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OICYmXHJcbiAgICAgICAgZXJyLm1lc3NhZ2UgPT09IFBSSU1BUllfTEVBU0VfTE9TVF9FUlJPUl9NU0cpO1xyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHByaW1hcnkgY2xpZW50IG9iamVjdCBzdG9yZS5cclxuICovXHJcbmZ1bmN0aW9uIHByaW1hcnlDbGllbnRTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiB0eG4uc3RvcmUoRGJQcmltYXJ5Q2xpZW50LnN0b3JlKTtcclxufVxyXG4vKipcclxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gY2xpZW50TWV0YWRhdGFTdG9yZSh0eG4pIHtcclxuICAgIHJldHVybiB0eG4uc3RvcmUoRGJDbGllbnRNZXRhZGF0YS5zdG9yZSk7XHJcbn1cclxuLyoqIFByb3ZpZGVzIExSVSBmdW5jdGlvbmFsaXR5IGZvciBJbmRleGVkREIgcGVyc2lzdGVuY2UuICovXHJcbnZhciBJbmRleGVkRGJMcnVEZWxlZ2F0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEluZGV4ZWREYkxydURlbGVnYXRlKGRiKSB7XHJcbiAgICAgICAgdGhpcy5kYiA9IGRiO1xyXG4gICAgICAgIHRoaXMuZ2FyYmFnZUNvbGxlY3RvciA9IG5ldyBMcnVHYXJiYWdlQ29sbGVjdG9yKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLmdldFRhcmdldENvdW50ID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFF1ZXJ5Q2FjaGUoKS5nZXRRdWVyeUNvdW50KHR4bik7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLmZvckVhY2hUYXJnZXQgPSBmdW5jdGlvbiAodHhuLCBmKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0UXVlcnlDYWNoZSgpLmZvckVhY2hUYXJnZXQodHhuLCBmKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuZm9yRWFjaE9ycGhhbmVkRG9jdW1lbnRTZXF1ZW5jZU51bWJlciA9IGZ1bmN0aW9uICh0eG4sIGYpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoT3JwaGFuZWREb2N1bWVudCh0eG4sIGZ1bmN0aW9uIChkb2NLZXksIHNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmKHNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuc2V0SW5NZW1vcnlQaW5zID0gZnVuY3Rpb24gKGluTWVtb3J5UGlucykge1xyXG4gICAgICAgIHRoaXMuaW5NZW1vcnlQaW5zID0gaW5NZW1vcnlQaW5zO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5hZGRSZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gd3JpdGVTZW50aW5lbEtleSh0eG4sIGtleSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZVJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHJldHVybiB3cml0ZVNlbnRpbmVsS2V5KHR4biwga2V5KTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlVGFyZ2V0cyA9IGZ1bmN0aW9uICh0eG4sIHVwcGVyQm91bmQsIGFjdGl2ZVRhcmdldElkcykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRiXHJcbiAgICAgICAgICAgIC5nZXRRdWVyeUNhY2hlKClcclxuICAgICAgICAgICAgLnJlbW92ZVRhcmdldHModHhuLCB1cHBlckJvdW5kLCBhY3RpdmVUYXJnZXRJZHMpO1xyXG4gICAgfTtcclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVNdXRhdGlvblJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHJldHVybiB3cml0ZVNlbnRpbmVsS2V5KHR4biwga2V5KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBhbnl0aGluZyB3b3VsZCBwcmV2ZW50IHRoaXMgZG9jdW1lbnQgZnJvbSBiZWluZyBnYXJiYWdlXHJcbiAgICAgKiBjb2xsZWN0ZWQsIGdpdmVuIHRoYXQgdGhlIGRvY3VtZW50IGluIHF1ZXN0aW9uIGlzIG5vdCBwcmVzZW50IGluIGFueVxyXG4gICAgICogdGFyZ2V0cyBhbmQgaGFzIGEgc2VxdWVuY2UgbnVtYmVyIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgdXBwZXIgYm91bmQgZm9yXHJcbiAgICAgKiB0aGUgY29sbGVjdGlvbiBydW4uXHJcbiAgICAgKi9cclxuICAgIEluZGV4ZWREYkxydURlbGVnYXRlLnByb3RvdHlwZS5pc1Bpbm5lZCA9IGZ1bmN0aW9uICh0eG4sIGRvY0tleSkge1xyXG4gICAgICAgIGlmICh0aGlzLmluTWVtb3J5UGlucy5jb250YWluc0tleShkb2NLZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtdXRhdGlvblF1ZXVlc0NvbnRhaW5LZXkodHhuLCBkb2NLZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlT3JwaGFuZWREb2N1bWVudHMgPSBmdW5jdGlvbiAodHhuLCB1cHBlckJvdW5kKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgICAgIHZhciBieXRlc1JlbW92ZWQgPSAwO1xyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIHZhciBpdGVyYXRpb24gPSB0aGlzLmZvckVhY2hPcnBoYW5lZERvY3VtZW50KHR4biwgZnVuY3Rpb24gKGRvY0tleSwgc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgaWYgKHNlcXVlbmNlTnVtYmVyIDw9IHVwcGVyQm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gX3RoaXMuaXNQaW5uZWQodHhuLCBkb2NLZXkpLm5leHQoZnVuY3Rpb24gKGlzUGlubmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1Bpbm5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVtb3ZlT3JwaGFuZWREb2N1bWVudCh0eG4sIGRvY0tleSkubmV4dChmdW5jdGlvbiAoZG9jdW1lbnRCeXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXNSZW1vdmVkICs9IGRvY3VtZW50Qnl0ZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFdhaXQgZm9yIGl0ZXJhdGlvbiBmaXJzdCB0byBtYWtlIHN1cmUgd2UgaGF2ZSBhIGNoYW5jZSB0byBhZGQgYWxsIG9mIHRoZVxyXG4gICAgICAgIC8vIHJlbW92YWwgcHJvbWlzZXMgdG8gdGhlIGFycmF5LlxyXG4gICAgICAgIHJldHVybiBpdGVyYXRpb25cclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpOyB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5kYi5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCkudXBkYXRlU2l6ZSh0eG4sIC1ieXRlc1JlbW92ZWQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNvdW50OyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENsZWFycyBhIGRvY3VtZW50IGZyb20gdGhlIGNhY2hlLiBUaGUgZG9jdW1lbnQgaXMgYXNzdW1lZCB0byBiZSBvcnBoYW5lZCwgc28gdGFyZ2V0LWRvY3VtZW50XHJcbiAgICAgKiBhc3NvY2lhdGlvbnMgYXJlIG5vdCBxdWVyaWVkLiBXZSByZW1vdmUgaXQgZnJvbSB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLCBhcyB3ZWxsIGFzIHJlbW92ZVxyXG4gICAgICogaXRzIHNlbnRpbmVsIHJvdy5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnQgPSBmdW5jdGlvbiAodHhuLCBkb2NLZXkpIHtcclxuICAgICAgICB2YXIgdG90YWxCeXRlc1JlbW92ZWQgPSAwO1xyXG4gICAgICAgIHZhciBkb2N1bWVudENhY2hlID0gdGhpcy5kYi5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKFtcclxuICAgICAgICAgICAgZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pLmRlbGV0ZShzZW50aW5lbEtleShkb2NLZXkpKSxcclxuICAgICAgICAgICAgZG9jdW1lbnRDYWNoZS5yZW1vdmVFbnRyeSh0eG4sIGRvY0tleSkubmV4dChmdW5jdGlvbiAoYnl0ZXNSZW1vdmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0b3RhbEJ5dGVzUmVtb3ZlZCArPSBieXRlc1JlbW92ZWQ7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgXSkubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiB0b3RhbEJ5dGVzUmVtb3ZlZDsgfSk7XHJcbiAgICB9O1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZVRhcmdldCA9IGZ1bmN0aW9uICh0eG4sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciB1cGRhdGVkID0gcXVlcnlEYXRhLmNvcHkoe1xyXG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlclxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFF1ZXJ5Q2FjaGUoKS51cGRhdGVRdWVyeURhdGEodHhuLCB1cGRhdGVkKTtcclxuICAgIH07XHJcbiAgICBJbmRleGVkRGJMcnVEZWxlZ2F0ZS5wcm90b3R5cGUudXBkYXRlTGltYm9Eb2N1bWVudCA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHJldHVybiB3cml0ZVNlbnRpbmVsS2V5KHR4biwga2V5KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENhbGwgcHJvdmlkZWQgZnVuY3Rpb24gZm9yIGVhY2ggZG9jdW1lbnQgaW4gdGhlIGNhY2hlIHRoYXQgaXMgJ29ycGhhbmVkJy4gT3JwaGFuZWRcclxuICAgICAqIG1lYW5zIG5vdCBhIHBhcnQgb2YgYW55IHRhcmdldCwgc28gdGhlIG9ubHkgZW50cnkgaW4gdGhlIHRhcmdldC1kb2N1bWVudCBpbmRleCBmb3JcclxuICAgICAqIHRoYXQgZG9jdW1lbnQgd2lsbCBiZSB0aGUgc2VudGluZWwgcm93ICh0YXJnZXRJZCAwKSwgd2hpY2ggd2lsbCBhbHNvIGhhdmUgdGhlIHNlcXVlbmNlXHJcbiAgICAgKiBudW1iZXIgZm9yIHRoZSBsYXN0IHRpbWUgdGhlIGRvY3VtZW50IHdhcyBhY2Nlc3NlZC5cclxuICAgICAqL1xyXG4gICAgSW5kZXhlZERiTHJ1RGVsZWdhdGUucHJvdG90eXBlLmZvckVhY2hPcnBoYW5lZERvY3VtZW50ID0gZnVuY3Rpb24gKHR4biwgZikge1xyXG4gICAgICAgIHZhciBzdG9yZSA9IGRvY3VtZW50VGFyZ2V0U3RvcmUodHhuKTtcclxuICAgICAgICB2YXIgbmV4dFRvUmVwb3J0ID0gTGlzdGVuU2VxdWVuY2UuSU5WQUxJRDtcclxuICAgICAgICB2YXIgbmV4dFBhdGg7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlXHJcbiAgICAgICAgICAgIC5pdGVyYXRlKHtcclxuICAgICAgICAgICAgaW5kZXg6IERiVGFyZ2V0RG9jdW1lbnQuZG9jdW1lbnRUYXJnZXRzSW5kZXhcclxuICAgICAgICB9LCBmdW5jdGlvbiAoX2EsIF9iKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IF9hWzBdLCBkb2NLZXkgPSBfYVsxXTtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBfYi5wYXRoLCBzZXF1ZW5jZU51bWJlciA9IF9iLnNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0SWQgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIG5leHRUb1JlcG9ydCBpcyB2YWxpZCwgcmVwb3J0IGl0LCB0aGlzIGlzIGEgbmV3IGtleSBzbyB0aGVcclxuICAgICAgICAgICAgICAgIC8vIGxhc3Qgb25lIG11c3Qgbm90IGJlIGEgbWVtYmVyIG9mIGFueSB0YXJnZXRzLlxyXG4gICAgICAgICAgICAgICAgaWYgKG5leHRUb1JlcG9ydCAhPT0gTGlzdGVuU2VxdWVuY2UuSU5WQUxJRCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYobmV3IERvY3VtZW50S2V5KGRlY29kZSQxKG5leHRQYXRoKSksIG5leHRUb1JlcG9ydCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBzZXQgbmV4dFRvUmVwb3J0IHRvIGJlIHRoaXMgc2VxdWVuY2UgbnVtYmVyLiBJdCdzIHRoZSBuZXh0IG9uZSB3ZVxyXG4gICAgICAgICAgICAgICAgLy8gbWlnaHQgcmVwb3J0LCBpZiB3ZSBkb24ndCBmaW5kIGFueSB0YXJnZXRzIGZvciB0aGlzIGRvY3VtZW50LlxyXG4gICAgICAgICAgICAgICAgLy8gTm90ZSB0aGF0IHRoZSBzZXF1ZW5jZSBudW1iZXIgbXVzdCBiZSBkZWZpbmVkIHdoZW4gdGhlIHRhcmdldElkXHJcbiAgICAgICAgICAgICAgICAvLyBpcyAwLlxyXG4gICAgICAgICAgICAgICAgbmV4dFRvUmVwb3J0ID0gc2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgICAgICAgICBuZXh0UGF0aCA9IHBhdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBzZXQgbmV4dFRvUmVwb3J0IHRvIGJlIGludmFsaWQsIHdlIGtub3cgd2UgZG9uJ3QgbmVlZCB0byByZXBvcnRcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgb25lIHNpbmNlIHdlIGZvdW5kIGEgdGFyZ2V0IGZvciBpdC5cclxuICAgICAgICAgICAgICAgIG5leHRUb1JlcG9ydCA9IExpc3RlblNlcXVlbmNlLklOVkFMSUQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIFNpbmNlIHdlIHJlcG9ydCBzZXF1ZW5jZSBudW1iZXJzIGFmdGVyIGdldHRpbmcgdG8gdGhlIG5leHQga2V5LCB3ZVxyXG4gICAgICAgICAgICAvLyBuZWVkIHRvIGNoZWNrIGlmIHRoZSBsYXN0IGtleSB3ZSBpdGVyYXRlZCBvdmVyIHdhcyBhbiBvcnBoYW5lZFxyXG4gICAgICAgICAgICAvLyBkb2N1bWVudCBhbmQgcmVwb3J0IGl0LlxyXG4gICAgICAgICAgICBpZiAobmV4dFRvUmVwb3J0ICE9PSBMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEKSB7XHJcbiAgICAgICAgICAgICAgICBmKG5ldyBEb2N1bWVudEtleShkZWNvZGUkMShuZXh0UGF0aCkpLCBuZXh0VG9SZXBvcnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEluZGV4ZWREYkxydURlbGVnYXRlO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBzZW50aW5lbEtleShrZXkpIHtcclxuICAgIHJldHVybiBbMCwgZW5jb2RlKGtleS5wYXRoKV07XHJcbn1cclxuLyoqXHJcbiAqIEByZXR1cm4gQSB2YWx1ZSBzdWl0YWJsZSBmb3Igd3JpdGluZyBhIHNlbnRpbmVsIHJvdyBpbiB0aGUgdGFyZ2V0LWRvY3VtZW50XHJcbiAqIHN0b3JlLlxyXG4gKi9cclxuZnVuY3Rpb24gc2VudGluZWxSb3coa2V5LCBzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgcmV0dXJuIG5ldyBEYlRhcmdldERvY3VtZW50KDAsIGVuY29kZShrZXkucGF0aCksIHNlcXVlbmNlTnVtYmVyKTtcclxufVxyXG5mdW5jdGlvbiB3cml0ZVNlbnRpbmVsS2V5KHR4biwga2V5KSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRUYXJnZXRTdG9yZSh0eG4pLnB1dChzZW50aW5lbFJvdyhrZXksIHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXIpKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgcmVhZG9ubHkgdmlldyBvZiB0aGUgbG9jYWwgc3RhdGUgb2YgYWxsIGRvY3VtZW50cyB3ZSdyZSB0cmFja2luZyAoaS5lLiB3ZVxyXG4gKiBoYXZlIGEgY2FjaGVkIHZlcnNpb24gaW4gcmVtb3RlRG9jdW1lbnRDYWNoZSBvciBsb2NhbCBtdXRhdGlvbnMgZm9yIHRoZVxyXG4gKiBkb2N1bWVudCkuIFRoZSB2aWV3IGlzIGNvbXB1dGVkIGJ5IGFwcGx5aW5nIHRoZSBtdXRhdGlvbnMgaW4gdGhlXHJcbiAqIE11dGF0aW9uUXVldWUgdG8gdGhlIFJlbW90ZURvY3VtZW50Q2FjaGUuXHJcbiAqL1xyXG52YXIgTG9jYWxEb2N1bWVudHNWaWV3ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTG9jYWxEb2N1bWVudHNWaWV3KHJlbW90ZURvY3VtZW50Q2FjaGUsIG11dGF0aW9uUXVldWUpIHtcclxuICAgICAgICB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUgPSByZW1vdGVEb2N1bWVudENhY2hlO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IG11dGF0aW9uUXVldWU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgbG9jYWwgdmlldyBvZiB0aGUgZG9jdW1lbnQgaWRlbnRpZmllZCBieSBga2V5YC5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIExvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50IG9yIG51bGwgaWYgd2UgZG9uJ3QgaGF2ZSBhbnkgY2FjaGVkXHJcbiAgICAgKiBzdGF0ZSBmb3IgaXQuXHJcbiAgICAgKi9cclxuICAgIExvY2FsRG9jdW1lbnRzVmlldy5wcm90b3R5cGUuZ2V0RG9jdW1lbnQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb25RdWV1ZVxyXG4gICAgICAgICAgICAuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkodHJhbnNhY3Rpb24sIGtleSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGJhdGNoZXMpIHsgcmV0dXJuIF90aGlzLmdldERvY3VtZW50SW50ZXJuYWwodHJhbnNhY3Rpb24sIGtleSwgYmF0Y2hlcyk7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBJbnRlcm5hbCB2ZXJzaW9uIG9mIGBnZXREb2N1bWVudGAgdGhhdCBhbGxvd3MgcmV1c2luZyBiYXRjaGVzLiAqL1xyXG4gICAgTG9jYWxEb2N1bWVudHNWaWV3LnByb3RvdHlwZS5nZXREb2N1bWVudEludGVybmFsID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBrZXksIGluQmF0Y2hlcykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cnkodHJhbnNhY3Rpb24sIGtleSkubmV4dChmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgaW5CYXRjaGVzXzEgPSBpbkJhdGNoZXM7IF9pIDwgaW5CYXRjaGVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmF0Y2ggPSBpbkJhdGNoZXNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICBkb2MgPSBiYXRjaC5hcHBseVRvTG9jYWxWaWV3KGtleSwgZG9jKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB0aGUgbG9jYWwgdmlldyBvZiB0aGUgZG9jdW1lbnRzIGlkZW50aWZpZWQgYnkgYGtleXNgLlxyXG4gICAgICpcclxuICAgICAqIElmIHdlIGRvbid0IGhhdmUgY2FjaGVkIHN0YXRlIGZvciBhIGRvY3VtZW50IGluIGBrZXlzYCwgYSBOb0RvY3VtZW50IHdpbGxcclxuICAgICAqIGJlIHN0b3JlZCBmb3IgdGhhdCBrZXkgaW4gdGhlIHJlc3VsdGluZyBzZXQuXHJcbiAgICAgKi9cclxuICAgIExvY2FsRG9jdW1lbnRzVmlldy5wcm90b3R5cGUuZ2V0RG9jdW1lbnRzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBrZXlzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvblF1ZXVlXHJcbiAgICAgICAgICAgIC5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXModHJhbnNhY3Rpb24sIGtleXMpXHJcbiAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChiYXRjaGVzKSB7XHJcbiAgICAgICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0cyA9IG1heWJlRG9jdW1lbnRNYXAoKTtcclxuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goX3RoaXMuZ2V0RG9jdW1lbnRJbnRlcm5hbCh0cmFuc2FjdGlvbiwga2V5LCBiYXRjaGVzKS5uZXh0KGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oaHR0cDovL2IvMzIyNzUzNzgpOiBEb24ndCBjb25mbGF0ZSBtaXNzaW5nIC8gZGVsZXRlZC5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW1heWJlRG9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heWJlRG9jID0gbmV3IE5vRG9jdW1lbnQoa2V5LCBTbmFwc2hvdFZlcnNpb24uZm9yRGVsZXRlZERvYygpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuaW5zZXJ0KGtleSwgbWF5YmVEb2MpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKS5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlc3VsdHM7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBQZXJmb3JtcyBhIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHZpZXcgb2YgYWxsIGRvY3VtZW50cy4gKi9cclxuICAgIExvY2FsRG9jdW1lbnRzVmlldy5wcm90b3R5cGUuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnkpIHtcclxuICAgICAgICBpZiAoRG9jdW1lbnRLZXkuaXNEb2N1bWVudEtleShxdWVyeS5wYXRoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXREb2N1bWVudHNNYXRjaGluZ0RvY3VtZW50UXVlcnkodHJhbnNhY3Rpb24sIHF1ZXJ5LnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdDb2xsZWN0aW9uUXVlcnkodHJhbnNhY3Rpb24sIHF1ZXJ5KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTG9jYWxEb2N1bWVudHNWaWV3LnByb3RvdHlwZS5nZXREb2N1bWVudHNNYXRjaGluZ0RvY3VtZW50UXVlcnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY1BhdGgpIHtcclxuICAgICAgICAvLyBKdXN0IGRvIGEgc2ltcGxlIGRvY3VtZW50IGxvb2t1cC5cclxuICAgICAgICByZXR1cm4gdGhpcy5nZXREb2N1bWVudCh0cmFuc2FjdGlvbiwgbmV3IERvY3VtZW50S2V5KGRvY1BhdGgpKS5uZXh0KGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gZG9jdW1lbnRNYXAoKTtcclxuICAgICAgICAgICAgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5pbnNlcnQobWF5YmVEb2Mua2V5LCBtYXliZURvYyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBMb2NhbERvY3VtZW50c1ZpZXcucHJvdG90eXBlLmdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvblF1ZXJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gUXVlcnkgdGhlIHJlbW90ZSBkb2N1bWVudHMgYW5kIG92ZXJsYXkgbXV0YXRpb25zLlxyXG4gICAgICAgIHZhciByZXN1bHRzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGVcclxuICAgICAgICAgICAgLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkodHJhbnNhY3Rpb24sIHF1ZXJ5KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAocXVlcnlSZXN1bHRzKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdHMgPSBxdWVyeVJlc3VsdHM7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ1F1ZXJ5KHRyYW5zYWN0aW9uLCBxdWVyeSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKG1hdGNoaW5nTXV0YXRpb25CYXRjaGVzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgbWF0Y2hpbmdNdXRhdGlvbkJhdGNoZXNfMSA9IG1hdGNoaW5nTXV0YXRpb25CYXRjaGVzOyBfaSA8IG1hdGNoaW5nTXV0YXRpb25CYXRjaGVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmF0Y2ggPSBtYXRjaGluZ011dGF0aW9uQmF0Y2hlc18xW19pXTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgX2IgPSBiYXRjaC5tdXRhdGlvbnM7IF9hIDwgX2IubGVuZ3RoOyBfYSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG11dGF0aW9uID0gX2JbX2FdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBtdXRhdGlvbi5rZXk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gT25seSBwcm9jZXNzIGRvY3VtZW50cyBiZWxvbmdpbmcgdG8gdGhlIGNvbGxlY3Rpb24uXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFxdWVyeS5wYXRoLmlzSW1tZWRpYXRlUGFyZW50T2Yoa2V5LnBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgYmFzZURvYyA9IHJlc3VsdHMuZ2V0KGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG11dGF0ZWREb2MgPSBtdXRhdGlvbi5hcHBseVRvTG9jYWxWaWV3KGJhc2VEb2MsIGJhc2VEb2MsIGJhdGNoLmxvY2FsV3JpdGVUaW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobXV0YXRlZERvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmluc2VydChrZXksIG11dGF0ZWREb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMucmVtb3ZlKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBGaW5hbGx5LCBmaWx0ZXIgb3V0IGFueSBkb2N1bWVudHMgdGhhdCBkb24ndCBhY3R1YWxseSBtYXRjaFxyXG4gICAgICAgICAgICAvLyB0aGUgcXVlcnkuXHJcbiAgICAgICAgICAgIHJlc3VsdHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCBkb2MpIHtcclxuICAgICAgICAgICAgICAgIGlmICghcXVlcnkubWF0Y2hlcyhkb2MpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMucmVtb3ZlKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTG9jYWxEb2N1bWVudHNWaWV3O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgY29sbGVjdGlvbiBvZiByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgZnJvbSBzb21lIGtpbmQgb2YgbnVtYmVyZWQgZW50aXR5XHJcbiAqIChlaXRoZXIgYSB0YXJnZXQgSUQgb3IgYmF0Y2ggSUQpLiBBcyByZWZlcmVuY2VzIGFyZSBhZGRlZCB0byBvciByZW1vdmVkIGZyb21cclxuICogdGhlIHNldCBjb3JyZXNwb25kaW5nIGV2ZW50cyBhcmUgZW1pdHRlZCB0byBhIHJlZ2lzdGVyZWQgZ2FyYmFnZSBjb2xsZWN0b3IuXHJcbiAqXHJcbiAqIEVhY2ggcmVmZXJlbmNlIGlzIHJlcHJlc2VudGVkIGJ5IGEgRG9jdW1lbnRSZWZlcmVuY2Ugb2JqZWN0LiBFYWNoIG9mIHRoZW1cclxuICogY29udGFpbnMgZW5vdWdoIGluZm9ybWF0aW9uIHRvIHVuaXF1ZWx5IGlkZW50aWZ5IHRoZSByZWZlcmVuY2UuIFRoZXkgYXJlIGFsbFxyXG4gKiBzdG9yZWQgcHJpbWFyaWx5IGluIGEgc2V0IHNvcnRlZCBieSBrZXkuIEEgZG9jdW1lbnQgaXMgY29uc2lkZXJlZCBnYXJiYWdlIGlmXHJcbiAqIHRoZXJlJ3Mgbm8gcmVmZXJlbmNlcyBpbiB0aGF0IHNldCAodGhpcyBjYW4gYmUgZWZmaWNpZW50bHkgY2hlY2tlZCB0aGFua3MgdG9cclxuICogc29ydGluZyBieSBrZXkpLlxyXG4gKlxyXG4gKiBSZWZlcmVuY2VTZXQgYWxzbyBrZWVwcyBhIHNlY29uZGFyeSBzZXQgdGhhdCBjb250YWlucyByZWZlcmVuY2VzIHNvcnRlZCBieVxyXG4gKiBJRHMuIFRoaXMgb25lIGlzIHVzZWQgdG8gZWZmaWNpZW50bHkgaW1wbGVtZW50IHJlbW92YWwgb2YgYWxsIHJlZmVyZW5jZXMgYnlcclxuICogc29tZSB0YXJnZXQgSUQuXHJcbiAqL1xyXG52YXIgUmVmZXJlbmNlU2V0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVmZXJlbmNlU2V0KCkge1xyXG4gICAgICAgIC8vIEEgc2V0IG9mIG91dHN0YW5kaW5nIHJlZmVyZW5jZXMgdG8gYSBkb2N1bWVudCBzb3J0ZWQgYnkga2V5LlxyXG4gICAgICAgIHRoaXMucmVmc0J5S2V5ID0gbmV3IFNvcnRlZFNldChEb2NSZWZlcmVuY2UuY29tcGFyZUJ5S2V5KTtcclxuICAgICAgICAvLyBBIHNldCBvZiBvdXRzdGFuZGluZyByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgc29ydGVkIGJ5IHRhcmdldCBpZC5cclxuICAgICAgICB0aGlzLnJlZnNCeVRhcmdldCA9IG5ldyBTb3J0ZWRTZXQoRG9jUmVmZXJlbmNlLmNvbXBhcmVCeVRhcmdldElkKTtcclxuICAgIH1cclxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIHJlZmVyZW5jZSBzZXQgY29udGFpbnMgbm8gcmVmZXJlbmNlcy4gKi9cclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUuaXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZWZzQnlLZXkuaXNFbXB0eSgpO1xyXG4gICAgfTtcclxuICAgIC8qKiBBZGRzIGEgcmVmZXJlbmNlIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBrZXkgZm9yIHRoZSBnaXZlbiBJRC4gKi9cclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUuYWRkUmVmZXJlbmNlID0gZnVuY3Rpb24gKGtleSwgaWQpIHtcclxuICAgICAgICB2YXIgcmVmID0gbmV3IERvY1JlZmVyZW5jZShrZXksIGlkKTtcclxuICAgICAgICB0aGlzLnJlZnNCeUtleSA9IHRoaXMucmVmc0J5S2V5LmFkZChyZWYpO1xyXG4gICAgICAgIHRoaXMucmVmc0J5VGFyZ2V0ID0gdGhpcy5yZWZzQnlUYXJnZXQuYWRkKHJlZik7XHJcbiAgICB9O1xyXG4gICAgLyoqIEFkZCByZWZlcmVuY2VzIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBrZXlzIGZvciB0aGUgZ2l2ZW4gSUQuICovXHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLmFkZFJlZmVyZW5jZXMgPSBmdW5jdGlvbiAoa2V5cywgaWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBfdGhpcy5hZGRSZWZlcmVuY2Uoa2V5LCBpZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5IGZvciB0aGUgZ2l2ZW5cclxuICAgICAqIElELlxyXG4gICAgICovXHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLnJlbW92ZVJlZmVyZW5jZSA9IGZ1bmN0aW9uIChrZXksIGlkKSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVSZWYobmV3IERvY1JlZmVyZW5jZShrZXksIGlkKSk7XHJcbiAgICB9O1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5yZW1vdmVSZWZlcmVuY2VzID0gZnVuY3Rpb24gKGtleXMsIGlkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gX3RoaXMucmVtb3ZlUmVmZXJlbmNlKGtleSwgaWQpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENsZWFycyBhbGwgcmVmZXJlbmNlcyB3aXRoIGEgZ2l2ZW4gSUQuIENhbGxzIHJlbW92ZVJlZigpIGZvciBlYWNoIGtleVxyXG4gICAgICogcmVtb3ZlZC5cclxuICAgICAqL1xyXG4gICAgUmVmZXJlbmNlU2V0LnByb3RvdHlwZS5yZW1vdmVSZWZlcmVuY2VzRm9ySWQgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBlbXB0eUtleSA9IERvY3VtZW50S2V5LkVNUFRZO1xyXG4gICAgICAgIHZhciBzdGFydFJlZiA9IG5ldyBEb2NSZWZlcmVuY2UoZW1wdHlLZXksIGlkKTtcclxuICAgICAgICB2YXIgZW5kUmVmID0gbmV3IERvY1JlZmVyZW5jZShlbXB0eUtleSwgaWQgKyAxKTtcclxuICAgICAgICB2YXIga2V5cyA9IFtdO1xyXG4gICAgICAgIHRoaXMucmVmc0J5VGFyZ2V0LmZvckVhY2hJblJhbmdlKFtzdGFydFJlZiwgZW5kUmVmXSwgZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgICAgICBfdGhpcy5yZW1vdmVSZWYocmVmKTtcclxuICAgICAgICAgICAga2V5cy5wdXNoKHJlZi5rZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgfTtcclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUucmVtb3ZlQWxsUmVmZXJlbmNlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMucmVmc0J5S2V5LmZvckVhY2goZnVuY3Rpb24gKHJlZikgeyByZXR1cm4gX3RoaXMucmVtb3ZlUmVmKHJlZik7IH0pO1xyXG4gICAgfTtcclxuICAgIFJlZmVyZW5jZVNldC5wcm90b3R5cGUucmVtb3ZlUmVmID0gZnVuY3Rpb24gKHJlZikge1xyXG4gICAgICAgIHRoaXMucmVmc0J5S2V5ID0gdGhpcy5yZWZzQnlLZXkuZGVsZXRlKHJlZik7XHJcbiAgICAgICAgdGhpcy5yZWZzQnlUYXJnZXQgPSB0aGlzLnJlZnNCeVRhcmdldC5kZWxldGUocmVmKTtcclxuICAgIH07XHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLnJlZmVyZW5jZXNGb3JJZCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICAgIHZhciBlbXB0eUtleSA9IERvY3VtZW50S2V5LkVNUFRZO1xyXG4gICAgICAgIHZhciBzdGFydFJlZiA9IG5ldyBEb2NSZWZlcmVuY2UoZW1wdHlLZXksIGlkKTtcclxuICAgICAgICB2YXIgZW5kUmVmID0gbmV3IERvY1JlZmVyZW5jZShlbXB0eUtleSwgaWQgKyAxKTtcclxuICAgICAgICB2YXIga2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdGhpcy5yZWZzQnlUYXJnZXQuZm9yRWFjaEluUmFuZ2UoW3N0YXJ0UmVmLCBlbmRSZWZdLCBmdW5jdGlvbiAocmVmKSB7XHJcbiAgICAgICAgICAgIGtleXMgPSBrZXlzLmFkZChyZWYua2V5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4ga2V5cztcclxuICAgIH07XHJcbiAgICBSZWZlcmVuY2VTZXQucHJvdG90eXBlLmNvbnRhaW5zS2V5ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciByZWYgPSBuZXcgRG9jUmVmZXJlbmNlKGtleSwgMCk7XHJcbiAgICAgICAgdmFyIGZpcnN0UmVmID0gdGhpcy5yZWZzQnlLZXkuZmlyc3RBZnRlck9yRXF1YWwocmVmKTtcclxuICAgICAgICByZXR1cm4gZmlyc3RSZWYgIT09IG51bGwgJiYga2V5LmlzRXF1YWwoZmlyc3RSZWYua2V5KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVmZXJlbmNlU2V0O1xyXG59KCkpO1xyXG52YXIgRG9jUmVmZXJlbmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jUmVmZXJlbmNlKGtleSwgdGFyZ2V0T3JCYXRjaElkKSB7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRPckJhdGNoSWQgPSB0YXJnZXRPckJhdGNoSWQ7XHJcbiAgICB9XHJcbiAgICAvKiogQ29tcGFyZSBieSBrZXkgdGhlbiBieSBJRCAqL1xyXG4gICAgRG9jUmVmZXJlbmNlLmNvbXBhcmVCeUtleSA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xyXG4gICAgICAgIHJldHVybiAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcihsZWZ0LmtleSwgcmlnaHQua2V5KSB8fFxyXG4gICAgICAgICAgICBwcmltaXRpdmVDb21wYXJhdG9yKGxlZnQudGFyZ2V0T3JCYXRjaElkLCByaWdodC50YXJnZXRPckJhdGNoSWQpKTtcclxuICAgIH07XHJcbiAgICAvKiogQ29tcGFyZSBieSBJRCB0aGVuIGJ5IGtleSAqL1xyXG4gICAgRG9jUmVmZXJlbmNlLmNvbXBhcmVCeVRhcmdldElkID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIChwcmltaXRpdmVDb21wYXJhdG9yKGxlZnQudGFyZ2V0T3JCYXRjaElkLCByaWdodC50YXJnZXRPckJhdGNoSWQpIHx8XHJcbiAgICAgICAgICAgIERvY3VtZW50S2V5LmNvbXBhcmF0b3IobGVmdC5rZXksIHJpZ2h0LmtleSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEb2NSZWZlcmVuY2U7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQzID0gJ0xvY2FsU3RvcmUnO1xyXG4vKipcclxuICogTG9jYWwgc3RvcmFnZSBpbiB0aGUgRmlyZXN0b3JlIGNsaWVudC4gQ29vcmRpbmF0ZXMgcGVyc2lzdGVuY2UgY29tcG9uZW50c1xyXG4gKiBsaWtlIHRoZSBtdXRhdGlvbiBxdWV1ZSBhbmQgcmVtb3RlIGRvY3VtZW50IGNhY2hlIHRvIHByZXNlbnQgYVxyXG4gKiBsYXRlbmN5LWNvbXBlbnNhdGVkIHZpZXcgb2Ygc3RvcmVkIGRhdGEuXHJcbiAqXHJcbiAqIFRoZSBMb2NhbFN0b3JlIGlzIHJlc3BvbnNpYmxlIGZvciBhY2NlcHRpbmcgbXV0YXRpb25zIGZyb20gdGhlIFN5bmMgRW5naW5lLlxyXG4gKiBXcml0ZXMgZnJvbSB0aGUgY2xpZW50IGFyZSBwdXQgaW50byBhIHF1ZXVlIGFzIHByb3Zpc2lvbmFsIE11dGF0aW9ucyB1bnRpbFxyXG4gKiB0aGV5IGFyZSBwcm9jZXNzZWQgYnkgdGhlIFJlbW90ZVN0b3JlIGFuZCBjb25maXJtZWQgYXMgaGF2aW5nIGJlZW4gd3JpdHRlblxyXG4gKiB0byB0aGUgc2VydmVyLlxyXG4gKlxyXG4gKiBUaGUgbG9jYWwgc3RvcmUgcHJvdmlkZXMgdGhlIGxvY2FsIHZlcnNpb24gb2YgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuXHJcbiAqIG1vZGlmaWVkIGxvY2FsbHkuIEl0IG1haW50YWlucyB0aGUgY29uc3RyYWludDpcclxuICpcclxuICogICBMb2NhbERvY3VtZW50ID0gUmVtb3RlRG9jdW1lbnQgKyBBY3RpdmUoTG9jYWxNdXRhdGlvbnMpXHJcbiAqXHJcbiAqIChBY3RpdmUgbXV0YXRpb25zIGFyZSB0aG9zZSB0aGF0IGFyZSBlbnF1ZXVlZCBhbmQgaGF2ZSBub3QgYmVlbiBwcmV2aW91c2x5XHJcbiAqIGFja25vd2xlZGdlZCBvciByZWplY3RlZCkuXHJcbiAqXHJcbiAqIFRoZSBSZW1vdGVEb2N1bWVudCAoXCJncm91bmQgdHJ1dGhcIikgc3RhdGUgaXMgcHJvdmlkZWQgdmlhIHRoZVxyXG4gKiBhcHBseUNoYW5nZUJhdGNoIG1ldGhvZC4gSXQgd2lsbCBiZSBzb21lIHZlcnNpb24gb2YgYSBzZXJ2ZXItcHJvdmlkZWRcclxuICogZG9jdW1lbnQgT1Igd2lsbCBiZSBhIHNlcnZlci1wcm92aWRlZCBkb2N1bWVudCBQTFVTIGFja25vd2xlZGdlZCBtdXRhdGlvbnM6XHJcbiAqXHJcbiAqICAgUmVtb3RlRG9jdW1lbnQnID0gUmVtb3RlRG9jdW1lbnQgKyBBY2tub3dsZWRnZWQoTG9jYWxNdXRhdGlvbnMpXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCB0aGlzIFwiZGlydHlcIiB2ZXJzaW9uIG9mIGEgUmVtb3RlRG9jdW1lbnQgd2lsbCBub3QgYmUgaWRlbnRpY2FsIHRvIGFcclxuICogc2VydmVyIGJhc2UgdmVyc2lvbiwgc2luY2UgaXQgaGFzIExvY2FsTXV0YXRpb25zIGFkZGVkIHRvIGl0IHBlbmRpbmcgZ2V0dGluZ1xyXG4gKiBhbiBhdXRob3JpdGF0aXZlIGNvcHkgZnJvbSB0aGUgc2VydmVyLlxyXG4gKlxyXG4gKiBTaW5jZSBMb2NhbE11dGF0aW9ucyBjYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIHNlcnZlciwgd2UgaGF2ZSB0byBiZSBhYmxlIHRvXHJcbiAqIHJldmVydCBhIExvY2FsTXV0YXRpb24gdGhhdCBoYXMgYWxyZWFkeSBiZWVuIGFwcGxpZWQgdG8gdGhlIExvY2FsRG9jdW1lbnRcclxuICogKHR5cGljYWxseSBkb25lIGJ5IHJlcGxheWluZyBhbGwgcmVtYWluaW5nIExvY2FsTXV0YXRpb25zIHRvIHRoZVxyXG4gKiBSZW1vdGVEb2N1bWVudCB0byByZS1hcHBseSkuXHJcbiAqXHJcbiAqIFRoZSBMb2NhbFN0b3JlIGlzIHJlc3BvbnNpYmxlIGZvciB0aGUgZ2FyYmFnZSBjb2xsZWN0aW9uIG9mIHRoZSBkb2N1bWVudHMgaXRcclxuICogY29udGFpbnMuIEZvciBub3csIGl0IGV2ZXJ5IGRvYyByZWZlcmVuY2VkIGJ5IGEgdmlldywgdGhlIG11dGF0aW9uIHF1ZXVlLCBvclxyXG4gKiB0aGUgUmVtb3RlU3RvcmUuXHJcbiAqXHJcbiAqIEl0IGFsc28gbWFpbnRhaW5zIHRoZSBwZXJzaXN0ZW5jZSBvZiBtYXBwaW5nIHF1ZXJpZXMgdG8gcmVzdW1lIHRva2VucyBhbmRcclxuICogdGFyZ2V0IGlkcy4gSXQgbmVlZHMgdG8ga25vdyB0aGlzIGRhdGEgYWJvdXQgcXVlcmllcyB0byBwcm9wZXJseSBrbm93IHdoYXRcclxuICogZG9jcyBpdCB3b3VsZCBiZSBhbGxvd2VkIHRvIGdhcmJhZ2UgY29sbGVjdC5cclxuICpcclxuICogVGhlIExvY2FsU3RvcmUgbXVzdCBiZSBhYmxlIHRvIGVmZmljaWVudGx5IGV4ZWN1dGUgcXVlcmllcyBhZ2FpbnN0IGl0cyBsb2NhbFxyXG4gKiBjYWNoZSBvZiB0aGUgZG9jdW1lbnRzLCB0byBwcm92aWRlIHRoZSBpbml0aWFsIHNldCBvZiByZXN1bHRzIGJlZm9yZSBhbnlcclxuICogcmVtb3RlIGNoYW5nZXMgaGF2ZSBiZWVuIHJlY2VpdmVkLlxyXG4gKlxyXG4gKiBOb3RlOiBJbiBUeXBlU2NyaXB0LCBtb3N0IG1ldGhvZHMgcmV0dXJuIFByb21pc2VzIHNpbmNlIHRoZSBpbXBsZW1lbnRhdGlvblxyXG4gKiBtYXkgcmVseSBvbiBmZXRjaGluZyBkYXRhIGZyb20gSW5kZXhlZERCIHdoaWNoIGlzIGFzeW5jLlxyXG4gKiBUaGVzZSBQcm9taXNlcyB3aWxsIG9ubHkgYmUgcmVqZWN0ZWQgb24gYW4gSS9PIGVycm9yIG9yIG90aGVyIGludGVybmFsXHJcbiAqICh1bmV4cGVjdGVkKSBmYWlsdXJlIChlLmcuIGZhaWxlZCBhc3NlcnQpIGFuZCBhbHdheXMgcmVwcmVzZW50IGFuXHJcbiAqIHVucmVjb3ZlcmFibGUgZXJyb3IgKHNob3VsZCBiZSBjYXVnaHQgLyByZXBvcnRlZCBieSB0aGUgYXN5bmNfcXVldWUpLlxyXG4gKi9cclxudmFyIExvY2FsU3RvcmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBMb2NhbFN0b3JlKFxyXG4gICAgLyoqIE1hbmFnZXMgb3VyIGluLW1lbW9yeSBvciBkdXJhYmxlIHBlcnNpc3RlbmNlLiAqL1xyXG4gICAgcGVyc2lzdGVuY2UsIGluaXRpYWxVc2VyKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IHBlcnNpc3RlbmNlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnQgcmVmZXJlbmNlcyBtYWludGFpbmVkIGJ5IGFueSBsb2NhbCB2aWV3cy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmxvY2FsVmlld1JlZmVyZW5jZXMgPSBuZXcgUmVmZXJlbmNlU2V0KCk7XHJcbiAgICAgICAgLyoqIE1hcHMgYSB0YXJnZXRJRCB0byBkYXRhIGFib3V0IGl0cyBxdWVyeS4gKi9cclxuICAgICAgICB0aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0ID0ge307XHJcbiAgICAgICAgYXNzZXJ0KHBlcnNpc3RlbmNlLnN0YXJ0ZWQsICdMb2NhbFN0b3JlIHdhcyBwYXNzZWQgYW4gdW5zdGFydGVkIHBlcnNpc3RlbmNlIGltcGxlbWVudGF0aW9uJyk7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5zZXRJbk1lbW9yeVBpbnModGhpcy5sb2NhbFZpZXdSZWZlcmVuY2VzKTtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBwZXJzaXN0ZW5jZS5nZXRNdXRhdGlvblF1ZXVlKGluaXRpYWxVc2VyKTtcclxuICAgICAgICB0aGlzLnJlbW90ZURvY3VtZW50cyA9IHBlcnNpc3RlbmNlLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKTtcclxuICAgICAgICB0aGlzLnF1ZXJ5Q2FjaGUgPSBwZXJzaXN0ZW5jZS5nZXRRdWVyeUNhY2hlKCk7XHJcbiAgICAgICAgdGhpcy5sb2NhbERvY3VtZW50cyA9IG5ldyBMb2NhbERvY3VtZW50c1ZpZXcodGhpcy5yZW1vdGVEb2N1bWVudHMsIHRoaXMubXV0YXRpb25RdWV1ZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRlbGxzIHRoZSBMb2NhbFN0b3JlIHRoYXQgdGhlIGN1cnJlbnRseSBhdXRoZW50aWNhdGVkIHVzZXIgaGFzIGNoYW5nZWQuXHJcbiAgICAgKlxyXG4gICAgICogSW4gcmVzcG9uc2UgdGhlIGxvY2FsIHN0b3JlIHN3aXRjaGVzIHRoZSBtdXRhdGlvbiBxdWV1ZSB0byB0aGUgbmV3IHVzZXIgYW5kXHJcbiAgICAgKiByZXR1cm5zIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcy5cclxuICAgICAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBBbmRyb2lkIGFuZCBpT1Mgb25seSByZXR1cm4gdGhlIGRvY3VtZW50cyBhZmZlY3RlZCBieSB0aGVcclxuICAgIC8vIGNoYW5nZS5cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmhhbmRsZVVzZXJDaGFuZ2UgPSBmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0hhbmRsZSB1c2VyIGNoYW5nZScsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgLy8gU3dhcCBvdXQgdGhlIG11dGF0aW9uIHF1ZXVlLCBncmFiYmluZyB0aGUgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzXHJcbiAgICAgICAgICAgIC8vIGJlZm9yZSBhbmQgYWZ0ZXIuXHJcbiAgICAgICAgICAgIHZhciBvbGRCYXRjaGVzO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZVxyXG4gICAgICAgICAgICAgICAgLmdldEFsbE11dGF0aW9uQmF0Y2hlcyh0eG4pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAocHJvbWlzZWRPbGRCYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICBvbGRCYXRjaGVzID0gcHJvbWlzZWRPbGRCYXRjaGVzO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubXV0YXRpb25RdWV1ZSA9IF90aGlzLnBlcnNpc3RlbmNlLmdldE11dGF0aW9uUXVldWUodXNlcik7XHJcbiAgICAgICAgICAgICAgICAvLyBSZWNyZWF0ZSBvdXIgTG9jYWxEb2N1bWVudHNWaWV3IHVzaW5nIHRoZSBuZXdcclxuICAgICAgICAgICAgICAgIC8vIE11dGF0aW9uUXVldWUuXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5sb2NhbERvY3VtZW50cyA9IG5ldyBMb2NhbERvY3VtZW50c1ZpZXcoX3RoaXMucmVtb3RlRG9jdW1lbnRzLCBfdGhpcy5tdXRhdGlvblF1ZXVlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLmdldEFsbE11dGF0aW9uQmF0Y2hlcyh0eG4pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKG5ld0JhdGNoZXMpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZW1vdmVkQmF0Y2hJZHMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHZhciBhZGRlZEJhdGNoSWRzID0gW107XHJcbiAgICAgICAgICAgICAgICAvLyBVbmlvbiB0aGUgb2xkL25ldyBjaGFuZ2VkIGtleXMuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2hhbmdlZEtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBvbGRCYXRjaGVzXzEgPSBvbGRCYXRjaGVzOyBfaSA8IG9sZEJhdGNoZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYmF0Y2ggPSBvbGRCYXRjaGVzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZWRCYXRjaElkcy5wdXNoKGJhdGNoLmJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgX2IgPSBiYXRjaC5tdXRhdGlvbnM7IF9hIDwgX2IubGVuZ3RoOyBfYSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtdXRhdGlvbiA9IF9iW19hXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlZEtleXMgPSBjaGFuZ2VkS2V5cy5hZGQobXV0YXRpb24ua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYyA9IDAsIG5ld0JhdGNoZXNfMSA9IG5ld0JhdGNoZXM7IF9jIDwgbmV3QmF0Y2hlc18xLmxlbmd0aDsgX2MrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiYXRjaCA9IG5ld0JhdGNoZXNfMVtfY107XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkZWRCYXRjaElkcy5wdXNoKGJhdGNoLmJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9kID0gMCwgX2UgPSBiYXRjaC5tdXRhdGlvbnM7IF9kIDwgX2UubGVuZ3RoOyBfZCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtdXRhdGlvbiA9IF9lW19kXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlZEtleXMgPSBjaGFuZ2VkS2V5cy5hZGQobXV0YXRpb24ua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gdGhlIHNldCBvZiBhbGwgKHBvdGVudGlhbGx5KSBjaGFuZ2VkIGRvY3VtZW50cyBhbmQgdGhlIGxpc3RcclxuICAgICAgICAgICAgICAgIC8vIG9mIG11dGF0aW9uIGJhdGNoIElEcyB0aGF0IHdlcmUgYWZmZWN0ZWQgYnkgY2hhbmdlLlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsRG9jdW1lbnRzXHJcbiAgICAgICAgICAgICAgICAgICAgLmdldERvY3VtZW50cyh0eG4sIGNoYW5nZWRLZXlzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChhZmZlY3RlZERvY3VtZW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmZmVjdGVkRG9jdW1lbnRzOiBhZmZlY3RlZERvY3VtZW50cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZEJhdGNoSWRzOiByZW1vdmVkQmF0Y2hJZHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkQmF0Y2hJZHM6IGFkZGVkQmF0Y2hJZHNcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qIEFjY2VwdCBsb2NhbGx5IGdlbmVyYXRlZCBNdXRhdGlvbnMgYW5kIGNvbW1pdCB0aGVtIHRvIHN0b3JhZ2UuICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5sb2NhbFdyaXRlID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0xvY2FsbHkgd3JpdGUgbXV0YXRpb25zJywgJ3JlYWR3cml0ZScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgdmFyIGJhdGNoO1xyXG4gICAgICAgICAgICB2YXIgbG9jYWxXcml0ZVRpbWUgPSBUaW1lc3RhbXAubm93KCk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlXHJcbiAgICAgICAgICAgICAgICAuYWRkTXV0YXRpb25CYXRjaCh0eG4sIGxvY2FsV3JpdGVUaW1lLCBtdXRhdGlvbnMpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAocHJvbWlzZWRCYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgYmF0Y2ggPSBwcm9taXNlZEJhdGNoO1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhrb3NzKTogVGhpcyBpcyBkb2luZyBhbiBOXjIgdXBkYXRlIGJ5IHJlcGxheWluZyBBTEwgdGhlXHJcbiAgICAgICAgICAgICAgICAvLyBtdXRhdGlvbnMgb24gZWFjaCBkb2N1bWVudCAoaW5zdGVhZCBvZiBqdXN0IHRoZSBvbmVzIGFkZGVkKSBpblxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBiYXRjaC5cclxuICAgICAgICAgICAgICAgIHZhciBrZXlzID0gYmF0Y2gua2V5cygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyh0eG4sIGtleXMpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGNoYW5nZWREb2N1bWVudHMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IGJhdGNoSWQ6IGJhdGNoLmJhdGNoSWQsIGNoYW5nZXM6IGNoYW5nZWREb2N1bWVudHMgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFJldHVybnMgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50cyBhZmZlY3RlZCBieSBhIG11dGF0aW9uIGJhdGNoLiAqL1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLmxvb2t1cE11dGF0aW9uRG9jdW1lbnRzID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdMb29rdXAgbXV0YXRpb24gZG9jdW1lbnRzJywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZVxyXG4gICAgICAgICAgICAgICAgLmxvb2t1cE11dGF0aW9uS2V5cyh0eG4sIGJhdGNoSWQpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoa2V5cykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGtleXMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKHR4biwga2V5cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUobnVsbCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWNrbm93bGVkZ2UgdGhlIGdpdmVuIGJhdGNoLlxyXG4gICAgICpcclxuICAgICAqIE9uIHRoZSBoYXBweSBwYXRoIHdoZW4gYSBiYXRjaCBpcyBhY2tub3dsZWRnZWQsIHRoZSBsb2NhbCBzdG9yZSB3aWxsXHJcbiAgICAgKlxyXG4gICAgICogICsgcmVtb3ZlIHRoZSBiYXRjaCBmcm9tIHRoZSBtdXRhdGlvbiBxdWV1ZTtcclxuICAgICAqICArIGFwcGx5IHRoZSBjaGFuZ2VzIHRvIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGU7XHJcbiAgICAgKiAgKyByZWNhbGN1bGF0ZSB0aGUgbGF0ZW5jeSBjb21wZW5zYXRlZCB2aWV3IGltcGxpZWQgYnkgdGhvc2UgY2hhbmdlcyAodGhlcmVcclxuICAgICAqICAgIG1heSBiZSBtdXRhdGlvbnMgaW4gdGhlIHF1ZXVlIHRoYXQgYWZmZWN0IHRoZSBkb2N1bWVudHMgYnV0IGhhdmVuJ3QgYmVlblxyXG4gICAgICogICAgYWNrbm93bGVkZ2VkIHlldCk7IGFuZFxyXG4gICAgICogICsgZ2l2ZSB0aGUgY2hhbmdlZCBkb2N1bWVudHMgYmFjayB0aGUgc3luYyBlbmdpbmVcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIChtb2RpZmllZCkgZG9jdW1lbnRzLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5hY2tub3dsZWRnZUJhdGNoID0gZnVuY3Rpb24gKGJhdGNoUmVzdWx0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignQWNrbm93bGVkZ2UgYmF0Y2gnLCAncmVhZHdyaXRlLXByaW1hcnknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHZhciBhZmZlY3RlZCA9IGJhdGNoUmVzdWx0LmJhdGNoLmtleXMoKTtcclxuICAgICAgICAgICAgdmFyIGRvY3VtZW50QnVmZmVyID0gX3RoaXMucmVtb3RlRG9jdW1lbnRzLm5ld0NoYW5nZUJ1ZmZlcigpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZVxyXG4gICAgICAgICAgICAgICAgLmFja25vd2xlZGdlQmF0Y2godHhuLCBiYXRjaFJlc3VsdC5iYXRjaCwgYmF0Y2hSZXN1bHQuc3RyZWFtVG9rZW4pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuYXBwbHlXcml0ZVRvUmVtb3RlRG9jdW1lbnRzKHR4biwgYmF0Y2hSZXN1bHQsIGRvY3VtZW50QnVmZmVyKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGRvY3VtZW50QnVmZmVyLmFwcGx5KHR4bik7IH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLnBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrKHR4bik7IH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHModHhuLCBhZmZlY3RlZCk7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIG11dGF0aW9ucyBmcm9tIHRoZSBNdXRhdGlvblF1ZXVlIGZvciB0aGUgc3BlY2lmaWVkIGJhdGNoO1xyXG4gICAgICogTG9jYWxEb2N1bWVudHMgd2lsbCBiZSByZWNhbGN1bGF0ZWQuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgVGhlIHJlc3VsdGluZyBtb2RpZmllZCBkb2N1bWVudHMuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLnJlamVjdEJhdGNoID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdSZWplY3QgYmF0Y2gnLCAncmVhZHdyaXRlLXByaW1hcnknLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHZhciBhZmZlY3RlZEtleXM7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlXHJcbiAgICAgICAgICAgICAgICAubG9va3VwTXV0YXRpb25CYXRjaCh0eG4sIGJhdGNoSWQpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoYmF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChiYXRjaCAhPT0gbnVsbCwgJ0F0dGVtcHQgdG8gcmVqZWN0IG5vbmV4aXN0ZW50IGJhdGNoIScpO1xyXG4gICAgICAgICAgICAgICAgYWZmZWN0ZWRLZXlzID0gYmF0Y2gua2V5cygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUucmVtb3ZlTXV0YXRpb25CYXRjaCh0eG4sIGJhdGNoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5tdXRhdGlvblF1ZXVlLnBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrKHR4bik7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKHR4biwgYWZmZWN0ZWRLZXlzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFJldHVybnMgdGhlIGxhc3QgcmVjb3JkZWQgc3RyZWFtIHRva2VuIGZvciB0aGUgY3VycmVudCB1c2VyLiAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuZ2V0TGFzdFN0cmVhbVRva2VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0dldCBsYXN0IHN0cmVhbSB0b2tlbicsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUuZ2V0TGFzdFN0cmVhbVRva2VuKHR4bik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTZXRzIHRoZSBzdHJlYW0gdG9rZW4gZm9yIHRoZSBjdXJyZW50IHVzZXIgd2l0aG91dCBhY2tub3dsZWRnaW5nIGFueVxyXG4gICAgICogbXV0YXRpb24gYmF0Y2guIFRoaXMgaXMgdXN1YWxseSBvbmx5IHVzZWZ1bCBhZnRlciBhIHN0cmVhbSBoYW5kc2hha2Ugb3IgaW5cclxuICAgICAqIHJlc3BvbnNlIHRvIGFuIGVycm9yIHRoYXQgcmVxdWlyZXMgY2xlYXJpbmcgdGhlIHN0cmVhbSB0b2tlbi5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuc2V0TGFzdFN0cmVhbVRva2VuID0gZnVuY3Rpb24gKHN0cmVhbVRva2VuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignU2V0IGxhc3Qgc3RyZWFtIHRva2VuJywgJ3JlYWR3cml0ZS1wcmltYXJ5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5zZXRMYXN0U3RyZWFtVG9rZW4odHhuLCBzdHJlYW1Ub2tlbik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBsYXN0IGNvbnNpc3RlbnQgc25hcHNob3QgcHJvY2Vzc2VkICh1c2VkIGJ5IHRoZSBSZW1vdGVTdG9yZSB0b1xyXG4gICAgICogZGV0ZXJtaW5lIHdoZXRoZXIgdG8gYnVmZmVyIGluY29taW5nIHNuYXBzaG90cyBmcm9tIHRoZSBiYWNrZW5kKS5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdHZXQgbGFzdCByZW1vdGUgc25hcHNob3QgdmVyc2lvbicsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHsgcmV0dXJuIF90aGlzLnF1ZXJ5Q2FjaGUuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbih0eG4pOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZSB0aGUgXCJncm91bmQtc3RhdGVcIiAocmVtb3RlKSBkb2N1bWVudHMuIFdlIGFzc3VtZSB0aGF0IHRoZSByZW1vdGVcclxuICAgICAqIGV2ZW50IHJlZmxlY3RzIGFueSB3cml0ZSBiYXRjaGVzIHRoYXQgaGF2ZSBiZWVuIGFja25vd2xlZGdlZCBvciByZWplY3RlZFxyXG4gICAgICogKGkuZS4gd2UgZG8gbm90IHJlLWFwcGx5IGxvY2FsIG11dGF0aW9ucyB0byB1cGRhdGVzIGZyb20gdGhpcyBldmVudCkuXHJcbiAgICAgKlxyXG4gICAgICogTG9jYWxEb2N1bWVudHMgYXJlIHJlLWNhbGN1bGF0ZWQgaWYgdGhlcmUgYXJlIHJlbWFpbmluZyBtdXRhdGlvbnMgaW4gdGhlXHJcbiAgICAgKiBxdWV1ZS5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuYXBwbHlSZW1vdGVFdmVudCA9IGZ1bmN0aW9uIChyZW1vdGVFdmVudCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGRvY3VtZW50QnVmZmVyID0gdGhpcy5yZW1vdGVEb2N1bWVudHMubmV3Q2hhbmdlQnVmZmVyKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0FwcGx5IHJlbW90ZSBldmVudCcsICdyZWFkd3JpdGUtcHJpbWFyeScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgICAgIHZhciBhdXRob3JpdGF0aXZlVXBkYXRlcyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgICAgIGZvckVhY2hOdW1iZXIocmVtb3RlRXZlbnQudGFyZ2V0Q2hhbmdlcywgZnVuY3Rpb24gKHRhcmdldElkLCBjaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIC8vIERvIG5vdCByZWYvdW5yZWYgdW5hc3NpZ25lZCB0YXJnZXRJZHMgLSBpdCBtYXkgbGVhZCB0byBsZWFrcy5cclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeURhdGEgPSBfdGhpcy5xdWVyeURhdGFCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5RGF0YSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAvLyBXaGVuIGEgZ2xvYmFsIHNuYXBzaG90IGNvbnRhaW5zIHVwZGF0ZXMgKGVpdGhlciBhZGQgb3IgbW9kaWZ5KSB3ZVxyXG4gICAgICAgICAgICAgICAgLy8gY2FuIGNvbXBsZXRlbHkgdHJ1c3QgdGhlc2UgdXBkYXRlcyBhcyBhdXRob3JpdGF0aXZlIGFuZCBibGluZGx5XHJcbiAgICAgICAgICAgICAgICAvLyBhcHBseSB0aGVtIHRvIG91ciBjYWNoZSAoYXMgYSBkZWZlbnNpdmUgbWVhc3VyZSB0byBwcm9tb3RlXHJcbiAgICAgICAgICAgICAgICAvLyBzZWxmLWhlYWxpbmcgaW4gdGhlIHVuZm9ydHVuYXRlIGNhc2UgdGhhdCBvdXIgY2FjaGUgaXMgZXZlciBzb21laG93XHJcbiAgICAgICAgICAgICAgICAvLyBjb3JydXB0ZWQgLyBvdXQtb2Ytc3luYykuXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIGRvY3VtZW50IGlzIG9ubHkgdXBkYXRlZCB3aGlsZSByZW1vdmluZyBpdCBmcm9tIGEgdGFyZ2V0XHJcbiAgICAgICAgICAgICAgICAvLyB0aGVuIHdhdGNoIGlzbid0IG9ibGlnYXRlZCB0byBzZW5kIHRoZSBhYnNvbHV0ZSBsYXRlc3QgdmVyc2lvbjogaXRcclxuICAgICAgICAgICAgICAgIC8vIGNhbiBzZW5kIHRoZSBmaXJzdCB2ZXJzaW9uIHRoYXQgY2F1c2VkIHRoZSBkb2N1bWVudCBub3QgdG8gbWF0Y2guXHJcbiAgICAgICAgICAgICAgICBjaGFuZ2UuYWRkZWREb2N1bWVudHMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXRhdGl2ZVVwZGF0ZXMgPSBhdXRob3JpdGF0aXZlVXBkYXRlcy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlLm1vZGlmaWVkRG9jdW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dGhvcml0YXRpdmVVcGRhdGVzID0gYXV0aG9yaXRhdGl2ZVVwZGF0ZXMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goX3RoaXMucXVlcnlDYWNoZVxyXG4gICAgICAgICAgICAgICAgICAgIC5yZW1vdmVNYXRjaGluZ0tleXModHhuLCBjaGFuZ2UucmVtb3ZlZERvY3VtZW50cywgdGFyZ2V0SWQpXHJcbiAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUNhY2hlLmFkZE1hdGNoaW5nS2V5cyh0eG4sIGNoYW5nZS5hZGRlZERvY3VtZW50cywgdGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSByZXN1bWUgdG9rZW4gaWYgdGhlIGNoYW5nZSBpbmNsdWRlcyBvbmUuIERvbid0IGNsZWFyXHJcbiAgICAgICAgICAgICAgICAvLyBhbnkgcHJlZXhpc3RpbmcgdmFsdWUuXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzdW1lVG9rZW4gPSBjaGFuZ2UucmVzdW1lVG9rZW47XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdW1lVG9rZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRRdWVyeURhdGEgPSBxdWVyeURhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRhID0gcXVlcnlEYXRhLmNvcHkoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bWVUb2tlbjogcmVzdW1lVG9rZW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNuYXBzaG90VmVyc2lvbjogcmVtb3RlRXZlbnQuc25hcHNob3RWZXJzaW9uXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVlcnlEYXRhQnlUYXJnZXRbdGFyZ2V0SWRdID0gcXVlcnlEYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChMb2NhbFN0b3JlLnNob3VsZFBlcnNpc3RRdWVyeURhdGEob2xkUXVlcnlEYXRhLCBxdWVyeURhdGEsIGNoYW5nZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChfdGhpcy5xdWVyeUNhY2hlLnVwZGF0ZVF1ZXJ5RGF0YSh0eG4sIHF1ZXJ5RGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkRG9jS2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgICAgIHJlbW90ZUV2ZW50LmRvY3VtZW50VXBkYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIGRvYykge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlZERvY0tleXMgPSBjaGFuZ2VkRG9jS2V5cy5hZGQoa2V5KTtcclxuICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goZG9jdW1lbnRCdWZmZXIuZ2V0RW50cnkodHhuLCBrZXkpLm5leHQoZnVuY3Rpb24gKGV4aXN0aW5nRG9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgYSBkb2N1bWVudCB1cGRhdGUgaXNuJ3QgYXV0aG9yaXRhdGl2ZSwgbWFrZSBzdXJlIHdlIGRvbid0XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYXBwbHkgYW4gb2xkIGRvY3VtZW50IHZlcnNpb24gdG8gdGhlIHJlbW90ZSBjYWNoZS4gV2UgbWFrZSBhblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGV4Y2VwdGlvbiBmb3IgU25hcHNob3RWZXJzaW9uLk1JTiB3aGljaCBjYW4gaGFwcGVuIGZvclxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hbnVmYWN0dXJlZCBldmVudHMgKGUuZy4gaW4gdGhlIGNhc2Ugb2YgYSBsaW1ibyBkb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc29sdXRpb24gZmFpbGluZykuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRG9jID09IG51bGwgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jLnZlcnNpb24uaXNFcXVhbChTbmFwc2hvdFZlcnNpb24uTUlOKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYXV0aG9yaXRhdGl2ZVVwZGF0ZXMuaGFzKGRvYy5rZXkpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZXhpc3RpbmdEb2MuaGFzUGVuZGluZ1dyaXRlcykgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jLnZlcnNpb24uY29tcGFyZVRvKGV4aXN0aW5nRG9jLnZlcnNpb24pID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRCdWZmZXIuYWRkRW50cnkoZG9jKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckMywgJ0lnbm9yaW5nIG91dGRhdGVkIHdhdGNoIHVwZGF0ZSBmb3IgJywga2V5LCAnLiBDdXJyZW50IHZlcnNpb246JywgZXhpc3RpbmdEb2MudmVyc2lvbiwgJyBXYXRjaCB2ZXJzaW9uOicsIGRvYy52ZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVtb3RlRXZlbnQucmVzb2x2ZWRMaW1ib0RvY3VtZW50cy5oYXMoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goX3RoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUudXBkYXRlTGltYm9Eb2N1bWVudCh0eG4sIGtleSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8gSEFDSzogVGhlIG9ubHkgcmVhc29uIHdlIGFsbG93IGEgbnVsbCBzbmFwc2hvdCB2ZXJzaW9uIGlzIHNvIHRoYXQgd2VcclxuICAgICAgICAgICAgLy8gY2FuIHN5bnRoZXNpemUgcmVtb3RlIGV2ZW50cyB3aGVuIHdlIGdldCBwZXJtaXNzaW9uIGRlbmllZCBlcnJvcnMgd2hpbGVcclxuICAgICAgICAgICAgLy8gdHJ5aW5nIHRvIHJlc29sdmUgdGhlIHN0YXRlIG9mIGEgbG9jYWxseSBjYWNoZWQgZG9jdW1lbnQgdGhhdCBpcyBpblxyXG4gICAgICAgICAgICAvLyBsaW1iby5cclxuICAgICAgICAgICAgdmFyIHJlbW90ZVZlcnNpb24gPSByZW1vdGVFdmVudC5zbmFwc2hvdFZlcnNpb247XHJcbiAgICAgICAgICAgIGlmICghcmVtb3RlVmVyc2lvbi5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5NSU4pKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXBkYXRlUmVtb3RlVmVyc2lvbiA9IF90aGlzLnF1ZXJ5Q2FjaGVcclxuICAgICAgICAgICAgICAgICAgICAuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbih0eG4pXHJcbiAgICAgICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGxhc3RSZW1vdGVWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHJlbW90ZVZlcnNpb24uY29tcGFyZVRvKGxhc3RSZW1vdGVWZXJzaW9uKSA+PSAwLCAnV2F0Y2ggc3RyZWFtIHJldmVydGVkIHRvIHByZXZpb3VzIHNuYXBzaG90Pz8gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVZlcnNpb24gK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnIDwgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RSZW1vdGVWZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucXVlcnlDYWNoZS5zZXRUYXJnZXRzTWV0YWRhdGEodHhuLCB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyLCByZW1vdGVWZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh1cGRhdGVSZW1vdGVWZXJzaW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocHJvbWlzZXMpXHJcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBkb2N1bWVudEJ1ZmZlci5hcHBseSh0eG4pOyB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyh0eG4sIGNoYW5nZWREb2NLZXlzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIG5ld1F1ZXJ5RGF0YSBzaG91bGQgYmUgcGVyc2lzdGVkIGR1cmluZyBhbiB1cGRhdGUgb2ZcclxuICAgICAqIGFuIGFjdGl2ZSB0YXJnZXQuIFF1ZXJ5RGF0YSBzaG91bGQgYWx3YXlzIGJlIHBlcnNpc3RlZCB3aGVuIGEgdGFyZ2V0IGlzXHJcbiAgICAgKiBiZWluZyByZWxlYXNlZCBhbmQgc2hvdWxkIG5vdCBjYWxsIHRoaXMgZnVuY3Rpb24uXHJcbiAgICAgKlxyXG4gICAgICogV2hpbGUgdGhlIHRhcmdldCBpcyBhY3RpdmUsIFF1ZXJ5RGF0YSB1cGRhdGVzIGNhbiBiZSBvbWl0dGVkIHdoZW4gbm90aGluZ1xyXG4gICAgICogYWJvdXQgdGhlIHRhcmdldCBoYXMgY2hhbmdlZCBleGNlcHQgbWV0YWRhdGEgbGlrZSB0aGUgcmVzdW1lIHRva2VuIG9yXHJcbiAgICAgKiBzbmFwc2hvdCB2ZXJzaW9uLiBPY2Nhc2lvbmFsbHkgaXQncyB3b3J0aCB0aGUgZXh0cmEgd3JpdGUgdG8gcHJldmVudCB0aGVzZVxyXG4gICAgICogdmFsdWVzIGZyb20gZ2V0dGluZyB0b28gc3RhbGUgYWZ0ZXIgYSBjcmFzaCwgYnV0IHRoaXMgZG9lc24ndCBoYXZlIHRvIGJlXHJcbiAgICAgKiB0b28gZnJlcXVlbnQuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUuc2hvdWxkUGVyc2lzdFF1ZXJ5RGF0YSA9IGZ1bmN0aW9uIChvbGRRdWVyeURhdGEsIG5ld1F1ZXJ5RGF0YSwgY2hhbmdlKSB7XHJcbiAgICAgICAgLy8gQXZvaWQgY2xlYXJpbmcgYW55IGV4aXN0aW5nIHZhbHVlXHJcbiAgICAgICAgaWYgKG5ld1F1ZXJ5RGF0YS5yZXN1bWVUb2tlbi5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAvLyBBbnkgcmVzdW1lIHRva2VuIGlzIGludGVyZXN0aW5nIGlmIHRoZXJlIGlzbid0IG9uZSBhbHJlYWR5LlxyXG4gICAgICAgIGlmIChvbGRRdWVyeURhdGEucmVzdW1lVG9rZW4ubGVuZ3RoID09PSAwKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAvLyBEb24ndCBhbGxvdyByZXN1bWUgdG9rZW4gY2hhbmdlcyB0byBiZSBidWZmZXJlZCBpbmRlZmluaXRlbHkuIFRoaXNcclxuICAgICAgICAvLyBhbGxvd3MgdXMgdG8gYmUgcmVhc29uYWJseSB1cC10by1kYXRlIGFmdGVyIGEgY3Jhc2ggYW5kIGF2b2lkcyBuZWVkaW5nXHJcbiAgICAgICAgLy8gdG8gbG9vcCBvdmVyIGFsbCBhY3RpdmUgcXVlcmllcyBvbiBzaHV0ZG93bi4gRXNwZWNpYWxseSBpbiB0aGUgYnJvd3NlclxyXG4gICAgICAgIC8vIHdlIG1heSBub3QgZ2V0IHRpbWUgdG8gZG8gYW55dGhpbmcgaW50ZXJlc3Rpbmcgd2hpbGUgdGhlIGN1cnJlbnQgdGFiIGlzXHJcbiAgICAgICAgLy8gY2xvc2luZy5cclxuICAgICAgICB2YXIgdGltZURlbHRhID0gbmV3UXVlcnlEYXRhLnNuYXBzaG90VmVyc2lvbi50b01pY3Jvc2Vjb25kcygpIC1cclxuICAgICAgICAgICAgb2xkUXVlcnlEYXRhLnNuYXBzaG90VmVyc2lvbi50b01pY3Jvc2Vjb25kcygpO1xyXG4gICAgICAgIGlmICh0aW1lRGVsdGEgPj0gdGhpcy5SRVNVTUVfVE9LRU5fTUFYX0FHRV9NSUNST1MpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIC8vIE90aGVyd2lzZSBpZiB0aGUgb25seSB0aGluZyB0aGF0IGhhcyBjaGFuZ2VkIGFib3V0IGEgdGFyZ2V0IGlzIGl0cyByZXN1bWVcclxuICAgICAgICAvLyB0b2tlbiBpdCdzIG5vdCB3b3J0aCBwZXJzaXN0aW5nLiBOb3RlIHRoYXQgdGhlIFJlbW90ZVN0b3JlIGtlZXBzIGFuXHJcbiAgICAgICAgLy8gaW4tbWVtb3J5IHZpZXcgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGFyZ2V0cyB3aGljaCBpbmNsdWRlcyB0aGUgY3VycmVudFxyXG4gICAgICAgIC8vIHJlc3VtZSB0b2tlbiwgc28gc3RyZWFtIGZhaWx1cmUgb3IgdXNlciBjaGFuZ2VzIHdpbGwgc3RpbGwgdXNlIGFuXHJcbiAgICAgICAgLy8gdXAtdG8tZGF0ZSByZXN1bWUgdG9rZW4gcmVnYXJkbGVzcyBvZiB3aGF0IHdlIGRvIGhlcmUuXHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSBjaGFuZ2UuYWRkZWREb2N1bWVudHMuc2l6ZSArXHJcbiAgICAgICAgICAgIGNoYW5nZS5tb2RpZmllZERvY3VtZW50cy5zaXplICtcclxuICAgICAgICAgICAgY2hhbmdlLnJlbW92ZWREb2N1bWVudHMuc2l6ZTtcclxuICAgICAgICByZXR1cm4gY2hhbmdlcyA+IDA7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBOb3RpZnkgbG9jYWwgc3RvcmUgb2YgdGhlIGNoYW5nZWQgdmlld3MgdG8gbG9jYWxseSBwaW4gZG9jdW1lbnRzLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5ub3RpZnlMb2NhbFZpZXdDaGFuZ2VzID0gZnVuY3Rpb24gKHZpZXdDaGFuZ2VzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignbm90aWZ5TG9jYWxWaWV3Q2hhbmdlcycsICdyZWFkd3JpdGUnLCBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh2aWV3Q2hhbmdlcywgZnVuY3Rpb24gKHZpZXdDaGFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmxvY2FsVmlld1JlZmVyZW5jZXMuYWRkUmVmZXJlbmNlcyh2aWV3Q2hhbmdlLmFkZGVkS2V5cywgdmlld0NoYW5nZS50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5sb2NhbFZpZXdSZWZlcmVuY2VzLnJlbW92ZVJlZmVyZW5jZXModmlld0NoYW5nZS5yZW1vdmVkS2V5cywgdmlld0NoYW5nZS50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godmlld0NoYW5nZS5yZW1vdmVkS2V5cywgZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVSZWZlcmVuY2UodHhuLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogR2V0cyB0aGUgbXV0YXRpb24gYmF0Y2ggYWZ0ZXIgdGhlIHBhc3NlZCBpbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZVxyXG4gICAgICogb3IgbnVsbCBpZiBlbXB0eS5cclxuICAgICAqIEBwYXJhbSBhZnRlckJhdGNoSWQgSWYgcHJvdmlkZWQsIHRoZSBiYXRjaCB0byBzZWFyY2ggYWZ0ZXIuXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgbmV4dCBtdXRhdGlvbiBvciBudWxsIGlmIHRoZXJlIHdhc24ndCBvbmUuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLm5leHRNdXRhdGlvbkJhdGNoID0gZnVuY3Rpb24gKGFmdGVyQmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0dldCBuZXh0IG11dGF0aW9uIGJhdGNoJywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICBpZiAoYWZ0ZXJCYXRjaElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGFmdGVyQmF0Y2hJZCA9IEJBVENISURfVU5LTk9XTjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubXV0YXRpb25RdWV1ZS5nZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCh0eG4sIGFmdGVyQmF0Y2hJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZWFkIHRoZSBjdXJyZW50IHZhbHVlIG9mIGEgRG9jdW1lbnQgd2l0aCBhIGdpdmVuIGtleSBvciBudWxsIGlmIG5vdFxyXG4gICAgICogZm91bmQgLSB1c2VkIGZvciB0ZXN0aW5nLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5yZWFkRG9jdW1lbnQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbigncmVhZCBkb2N1bWVudCcsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50KHR4biwga2V5KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEFzc2lnbnMgdGhlIGdpdmVuIHF1ZXJ5IGFuIGludGVybmFsIElEIHNvIHRoYXQgaXRzIHJlc3VsdHMgY2FuIGJlIHBpbm5lZCBzb1xyXG4gICAgICogdGhleSBkb24ndCBnZXQgR0MnZC4gQSBxdWVyeSBtdXN0IGJlIGFsbG9jYXRlZCBpbiB0aGUgbG9jYWwgc3RvcmUgYmVmb3JlXHJcbiAgICAgKiB0aGUgc3RvcmUgY2FuIGJlIHVzZWQgdG8gbWFuYWdlIGl0cyB2aWV3LlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5hbGxvY2F0ZVF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignQWxsb2NhdGUgcXVlcnknLCAncmVhZHdyaXRlJywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlEYXRhO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucXVlcnlDYWNoZVxyXG4gICAgICAgICAgICAgICAgLmdldFF1ZXJ5RGF0YSh0eG4sIHF1ZXJ5KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGNhY2hlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgcXVlcnkgaGFzIGJlZW4gbGlzdGVuZWQgdG8gcHJldmlvdXNseSwgc28gcmV1c2UgdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcHJldmlvdXMgdGFyZ2V0SUQuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiBmcmVzaGVuIGxhc3QgYWNjZXNzZWQgZGF0ZT9cclxuICAgICAgICAgICAgICAgICAgICBxdWVyeURhdGEgPSBjYWNoZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucXVlcnlDYWNoZS5hbGxvY2F0ZVRhcmdldElkKHR4bikubmV4dChmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRhID0gbmV3IFF1ZXJ5RGF0YShxdWVyeSwgdGFyZ2V0SWQsIFF1ZXJ5UHVycG9zZS5MaXN0ZW4sIHR4bi5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucXVlcnlDYWNoZS5hZGRRdWVyeURhdGEodHhuLCBxdWVyeURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KCFfdGhpcy5xdWVyeURhdGFCeVRhcmdldFtxdWVyeURhdGEudGFyZ2V0SWRdLCAnVHJpZWQgdG8gYWxsb2NhdGUgYW4gYWxyZWFkeSBhbGxvY2F0ZWQgcXVlcnk6ICcgKyBxdWVyeSk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWVyeURhdGFCeVRhcmdldFtxdWVyeURhdGEudGFyZ2V0SWRdID0gcXVlcnlEYXRhO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5RGF0YTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVbnBpbiBhbGwgdGhlIGRvY3VtZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIHF1ZXJ5LiBJZlxyXG4gICAgICogYGtlZXBQZXJzaXN0ZWRRdWVyeURhdGFgIGlzIHNldCB0byBmYWxzZSBhbmQgRWFnZXIgR0MgZW5hYmxlZCwgdGhlIG1ldGhvZFxyXG4gICAgICogZGlyZWN0bHkgcmVtb3ZlcyB0aGUgYXNzb2NpYXRlZCBxdWVyeSBkYXRhIGZyb20gdGhlIHF1ZXJ5IGNhY2hlLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IGBrZWVwUGVyc2lzdGVkUXVlcnlEYXRhYCBpcyBtdWx0aS10YWIgb25seS5cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLnJlbGVhc2VRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeSwga2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG1vZGUgPSBrZWVwUGVyc2lzdGVkUXVlcnlEYXRhID8gJ3JlYWR3cml0ZScgOiAncmVhZHdyaXRlLXByaW1hcnknO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdSZWxlYXNlIHF1ZXJ5JywgbW9kZSwgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucXVlcnlDYWNoZVxyXG4gICAgICAgICAgICAgICAgLmdldFF1ZXJ5RGF0YSh0eG4sIHF1ZXJ5KVxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KHF1ZXJ5RGF0YSAhPSBudWxsLCAnVHJpZWQgdG8gcmVsZWFzZSBub25leGlzdGVudCBxdWVyeTogJyArIHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRJZCA9IHF1ZXJ5RGF0YS50YXJnZXRJZDtcclxuICAgICAgICAgICAgICAgIHZhciBjYWNoZWRRdWVyeURhdGEgPSBfdGhpcy5xdWVyeURhdGFCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICAvLyBSZWZlcmVuY2VzIGZvciBkb2N1bWVudHMgc2VudCB2aWEgV2F0Y2ggYXJlIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZCB3aGVuIHdlIGRlbGV0ZSBhXHJcbiAgICAgICAgICAgICAgICAvLyBxdWVyeSdzIHRhcmdldCBkYXRhIGZyb20gdGhlIHJlZmVyZW5jZSBkZWxlZ2F0ZS4gU2luY2UgdGhpcyBkb2VzIG5vdCByZW1vdmUgcmVmZXJlbmNlc1xyXG4gICAgICAgICAgICAgICAgLy8gZm9yIGxvY2FsbHkgbXV0YXRlZCBkb2N1bWVudHMsIHdlIGhhdmUgdG8gcmVtb3ZlIHRoZSB0YXJnZXQgYXNzb2NpYXRpb25zIGZvciB0aGVzZVxyXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnRzIG1hbnVhbGx5LlxyXG4gICAgICAgICAgICAgICAgdmFyIHJlbW92ZWQgPSBfdGhpcy5sb2NhbFZpZXdSZWZlcmVuY2VzLnJlbW92ZVJlZmVyZW5jZXNGb3JJZCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXMucXVlcnlEYXRhQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFrZWVwUGVyc2lzdGVkUXVlcnlEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHJlbW92ZWQsIGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVJlZmVyZW5jZSh0eG4sIGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSkubmV4dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVUYXJnZXQodHhuLCBjYWNoZWRRdWVyeURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUnVucyB0aGUgc3BlY2lmaWVkIHF1ZXJ5IGFnYWluc3QgYWxsIHRoZSBkb2N1bWVudHMgaW4gdGhlIGxvY2FsIHN0b3JlIGFuZFxyXG4gICAgICogcmV0dXJucyB0aGUgcmVzdWx0cy5cclxuICAgICAqL1xyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuZXhlY3V0ZVF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbignRXhlY3V0ZSBxdWVyeScsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkodHhuLCBxdWVyeSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBrZXlzIG9mIHRoZSBkb2N1bWVudHMgdGhhdCBhcmUgYXNzb2NpYXRlZCB3aXRoIHRoZSBnaXZlblxyXG4gICAgICogdGFyZ2V0IGlkIGluIHRoZSByZW1vdGUgdGFibGUuXHJcbiAgICAgKi9cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLnJlbW90ZURvY3VtZW50S2V5cyA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ1JlbW90ZSBkb2N1bWVudCBrZXlzJywgJ3JlYWRvbmx5JywgZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucXVlcnlDYWNoZS5nZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0eG4sIHRhcmdldElkKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuZ2V0QWN0aXZlQ2xpZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5nZXRBY3RpdmVDbGllbnRzKCk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cclxuICAgIExvY2FsU3RvcmUucHJvdG90eXBlLnJlbW92ZUNhY2hlZE11dGF0aW9uQmF0Y2hNZXRhZGF0YSA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLnJlbW92ZUNhY2hlZE11dGF0aW9uS2V5cyhiYXRjaElkKTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuc2V0TmV0d29ya0VuYWJsZWQgPSBmdW5jdGlvbiAobmV0d29ya0VuYWJsZWQpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlLnNldE5ldHdvcmtFbmFibGVkKG5ldHdvcmtFbmFibGVkKTtcclxuICAgIH07XHJcbiAgICBMb2NhbFN0b3JlLnByb3RvdHlwZS5hcHBseVdyaXRlVG9SZW1vdGVEb2N1bWVudHMgPSBmdW5jdGlvbiAodHhuLCBiYXRjaFJlc3VsdCwgZG9jdW1lbnRCdWZmZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBiYXRjaCA9IGJhdGNoUmVzdWx0LmJhdGNoO1xyXG4gICAgICAgIHZhciBkb2NLZXlzID0gYmF0Y2gua2V5cygpO1xyXG4gICAgICAgIHZhciBwcm9taXNlQ2hhaW4gPSBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIGRvY0tleXMuZm9yRWFjaChmdW5jdGlvbiAoZG9jS2V5KSB7XHJcbiAgICAgICAgICAgIHByb21pc2VDaGFpbiA9IHByb21pc2VDaGFpblxyXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50QnVmZmVyLmdldEVudHJ5KHR4biwgZG9jS2V5KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChyZW1vdGVEb2MpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2MgPSByZW1vdGVEb2M7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWNrVmVyc2lvbiA9IGJhdGNoUmVzdWx0LmRvY1ZlcnNpb25zLmdldChkb2NLZXkpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGFja1ZlcnNpb24gIT09IG51bGwsICdhY2tWZXJzaW9ucyBzaG91bGQgY29udGFpbiBldmVyeSBkb2MgaW4gdGhlIHdyaXRlLicpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFkb2MgfHwgZG9jLnZlcnNpb24uY29tcGFyZVRvKGFja1ZlcnNpb24pIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvYyA9IGJhdGNoLmFwcGx5VG9SZW1vdGVEb2N1bWVudChkb2NLZXksIGRvYywgYmF0Y2hSZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZG9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCghcmVtb3RlRG9jLCAnTXV0YXRpb24gYmF0Y2ggJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXRjaCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIGFwcGxpZWQgdG8gZG9jdW1lbnQgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVEb2MgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJyByZXN1bHRlZCBpbiBudWxsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudEJ1ZmZlci5hZGRFbnRyeShkb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHByb21pc2VDaGFpbi5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm11dGF0aW9uUXVldWUucmVtb3ZlTXV0YXRpb25CYXRjaCh0eG4sIGJhdGNoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuZ2V0UXVlcnlGb3JUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5RGF0YUJ5VGFyZ2V0W3RhcmdldElkXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMucXVlcnlEYXRhQnlUYXJnZXRbdGFyZ2V0SWRdLnF1ZXJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCdHZXQgcXVlcnkgZGF0YScsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5xdWVyeUNhY2hlXHJcbiAgICAgICAgICAgICAgICAgICAgLmdldFF1ZXJ5RGF0YUZvclRhcmdldCh0eG4sIHRhcmdldElkKVxyXG4gICAgICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChxdWVyeURhdGEpIHsgcmV0dXJuIChxdWVyeURhdGEgPyBxdWVyeURhdGEucXVlcnkgOiBudWxsKTsgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgTG9jYWxTdG9yZS5wcm90b3R5cGUuZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oJ0dldCBuZXcgZG9jdW1lbnQgY2hhbmdlcycsICdyZWFkb25seScsIGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbW90ZURvY3VtZW50cy5nZXROZXdEb2N1bWVudENoYW5nZXModHhuKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBtYXhpbXVtIHRpbWUgdG8gbGVhdmUgYSByZXN1bWUgdG9rZW4gYnVmZmVyZWQgd2l0aG91dCB3cml0aW5nIGl0IG91dC5cclxuICAgICAqIFRoaXMgdmFsdWUgaXMgYXJiaXRyYXJ5OiBpdCdzIGxvbmcgZW5vdWdoIHRvIGF2b2lkIHNldmVyYWwgd3JpdGVzXHJcbiAgICAgKiAocG9zc2libHkgaW5kZWZpbml0ZWx5IGlmIHVwZGF0ZXMgY29tZSBtb3JlIGZyZXF1ZW50bHkgdGhhbiB0aGlzKSBidXRcclxuICAgICAqIHNob3J0IGVub3VnaCB0aGF0IHJlc3RhcnRpbmcgYWZ0ZXIgY3Jhc2hpbmcgd2lsbCBzdGlsbCBoYXZlIGEgcHJldHR5XHJcbiAgICAgKiByZWNlbnQgcmVzdW1lIHRva2VuLlxyXG4gICAgICovXHJcbiAgICBMb2NhbFN0b3JlLlJFU1VNRV9UT0tFTl9NQVhfQUdFX01JQ1JPUyA9IDUgKiA2MCAqIDFlNjtcclxuICAgIHJldHVybiBMb2NhbFN0b3JlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIE1lbW9yeU11dGF0aW9uUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNZW1vcnlNdXRhdGlvblF1ZXVlKHJlZmVyZW5jZURlbGVnYXRlKSB7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHJlZmVyZW5jZURlbGVnYXRlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBzZXQgb2YgYWxsIG11dGF0aW9ucyB0aGF0IGhhdmUgYmVlbiBzZW50IGJ1dCBub3QgeWV0IGJlZW4gYXBwbGllZCB0b1xyXG4gICAgICAgICAqIHRoZSBiYWNrZW5kLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IFtdO1xyXG4gICAgICAgIC8qKiBOZXh0IHZhbHVlIHRvIHVzZSB3aGVuIGFzc2lnbmluZyBzZXF1ZW50aWFsIElEcyB0byBlYWNoIG11dGF0aW9uIGJhdGNoLiAqL1xyXG4gICAgICAgIHRoaXMubmV4dEJhdGNoSWQgPSAxO1xyXG4gICAgICAgIC8qKiBUaGUgaGlnaGVzdCBhY2tub3dsZWRnZWQgbXV0YXRpb24gaW4gdGhlIHF1ZXVlLiAqL1xyXG4gICAgICAgIHRoaXMuaGlnaGVzdEFja25vd2xlZGdlZEJhdGNoSWQgPSBCQVRDSElEX1VOS05PV047XHJcbiAgICAgICAgLyoqIFRoZSBsYXN0IHJlY2VpdmVkIHN0cmVhbSB0b2tlbiBmcm9tIHRoZSBzZXJ2ZXIsIHVzZWQgdG8gYWNrbm93bGVkZ2Ugd2hpY2hcclxuICAgICAgICAgKiByZXNwb25zZXMgdGhlIGNsaWVudCBoYXMgcHJvY2Vzc2VkLiBTdHJlYW0gdG9rZW5zIGFyZSBvcGFxdWUgY2hlY2twb2ludFxyXG4gICAgICAgICAqIG1hcmtlcnMgd2hvc2Ugb25seSByZWFsIHZhbHVlIGlzIHRoZWlyIGluY2x1c2lvbiBpbiB0aGUgbmV4dCByZXF1ZXN0LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubGFzdFN0cmVhbVRva2VuID0gZW1wdHlCeXRlU3RyaW5nKCk7XHJcbiAgICAgICAgLyoqIEFuIG9yZGVyZWQgbWFwcGluZyBiZXR3ZWVuIGRvY3VtZW50cyBhbmQgdGhlIG11dGF0aW9ucyBiYXRjaCBJRHMuICovXHJcbiAgICAgICAgdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleSA9IG5ldyBTb3J0ZWRTZXQoRG9jUmVmZXJlbmNlLmNvbXBhcmVCeUtleSk7XHJcbiAgICB9XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5jaGVja0VtcHR5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggPT09IDApO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmFja25vd2xlZGdlQmF0Y2ggPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoLCBzdHJlYW1Ub2tlbikge1xyXG4gICAgICAgIHZhciBiYXRjaElkID0gYmF0Y2guYmF0Y2hJZDtcclxuICAgICAgICBhc3NlcnQoYmF0Y2hJZCA+IHRoaXMuaGlnaGVzdEFja25vd2xlZGdlZEJhdGNoSWQsICdNdXRhdGlvbiBiYXRjaElEcyBtdXN0IGJlIGFja25vd2xlZGdlZCBpbiBvcmRlcicpO1xyXG4gICAgICAgIHZhciBiYXRjaEluZGV4ID0gdGhpcy5pbmRleE9mRXhpc3RpbmdCYXRjaElkKGJhdGNoSWQsICdhY2tub3dsZWRnZWQnKTtcclxuICAgICAgICBhc3NlcnQoYmF0Y2hJbmRleCA9PT0gMCwgJ0NhbiBvbmx5IGFja25vd2xlZGdlIHRoZSBmaXJzdCBiYXRjaCBpbiB0aGUgbXV0YXRpb24gcXVldWUnKTtcclxuICAgICAgICAvLyBWZXJpZnkgdGhhdCB0aGUgYmF0Y2ggaW4gdGhlIHF1ZXVlIGlzIHRoZSBvbmUgdG8gYmUgYWNrbm93bGVkZ2VkLlxyXG4gICAgICAgIHZhciBjaGVjayA9IHRoaXMubXV0YXRpb25RdWV1ZVtiYXRjaEluZGV4XTtcclxuICAgICAgICBhc3NlcnQoYmF0Y2hJZCA9PT0gY2hlY2suYmF0Y2hJZCwgJ1F1ZXVlIG9yZGVyaW5nIGZhaWx1cmU6IGV4cGVjdGVkIGJhdGNoICcgK1xyXG4gICAgICAgICAgICBiYXRjaElkICtcclxuICAgICAgICAgICAgJywgZ290IGJhdGNoICcgK1xyXG4gICAgICAgICAgICBjaGVjay5iYXRjaElkKTtcclxuICAgICAgICB0aGlzLmhpZ2hlc3RBY2tub3dsZWRnZWRCYXRjaElkID0gYmF0Y2hJZDtcclxuICAgICAgICB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHN0cmVhbVRva2VuO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldExhc3RTdHJlYW1Ub2tlbiA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmxhc3RTdHJlYW1Ub2tlbik7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuc2V0TGFzdFN0cmVhbVRva2VuID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBzdHJlYW1Ub2tlbikge1xyXG4gICAgICAgIHRoaXMubGFzdFN0cmVhbVRva2VuID0gc3RyZWFtVG9rZW47XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuYWRkTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgbG9jYWxXcml0ZVRpbWUsIG11dGF0aW9ucykge1xyXG4gICAgICAgIGFzc2VydChtdXRhdGlvbnMubGVuZ3RoICE9PSAwLCAnTXV0YXRpb24gYmF0Y2hlcyBzaG91bGQgbm90IGJlIGVtcHR5Jyk7XHJcbiAgICAgICAgdmFyIGJhdGNoSWQgPSB0aGlzLm5leHRCYXRjaElkO1xyXG4gICAgICAgIHRoaXMubmV4dEJhdGNoSWQrKztcclxuICAgICAgICBpZiAodGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIHByaW9yID0gdGhpcy5tdXRhdGlvblF1ZXVlW3RoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgYXNzZXJ0KHByaW9yLmJhdGNoSWQgPCBiYXRjaElkLCAnTXV0YXRpb24gYmF0Y2hJRHMgbXVzdCBiZSBtb25vdG9uaWNhbGx5IGluY3JlYXNpbmcgb3JkZXInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGJhdGNoID0gbmV3IE11dGF0aW9uQmF0Y2goYmF0Y2hJZCwgbG9jYWxXcml0ZVRpbWUsIG11dGF0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLnB1c2goYmF0Y2gpO1xyXG4gICAgICAgIC8vIFRyYWNrIHJlZmVyZW5jZXMgYnkgZG9jdW1lbnQga2V5LlxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgbXV0YXRpb25zXzEgPSBtdXRhdGlvbnM7IF9pIDwgbXV0YXRpb25zXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBtdXRhdGlvbiA9IG11dGF0aW9uc18xW19pXTtcclxuICAgICAgICAgICAgdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleSA9IHRoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkuYWRkKG5ldyBEb2NSZWZlcmVuY2UobXV0YXRpb24ua2V5LCBiYXRjaElkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShiYXRjaCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUubG9va3VwTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgYmF0Y2hJZCkge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmZpbmRNdXRhdGlvbkJhdGNoKGJhdGNoSWQpKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5sb29rdXBNdXRhdGlvbktleXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoSWQpIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25CYXRjaCA9IHRoaXMuZmluZE11dGF0aW9uQmF0Y2goYmF0Y2hJZCk7XHJcbiAgICAgICAgYXNzZXJ0KG11dGF0aW9uQmF0Y2ggIT0gbnVsbCwgJ0ZhaWxlZCB0byBmaW5kIGxvY2FsIG11dGF0aW9uIGJhdGNoLicpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShtdXRhdGlvbkJhdGNoLmtleXMoKSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0TmV4dE11dGF0aW9uQmF0Y2hBZnRlckJhdGNoSWQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoSWQpIHtcclxuICAgICAgICAvLyBBbGwgYmF0Y2hlcyB3aXRoIGJhdGNoSWQgPD0gdGhpcy5oaWdoZXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCBoYXZlIGJlZW5cclxuICAgICAgICAvLyBhY2tub3dsZWRnZWQgc28gdGhlIGZpcnN0IHVuYWNrbm93bGVkZ2VkIGJhdGNoIGFmdGVyIGJhdGNoSUQgd2lsbCBoYXZlIGFcclxuICAgICAgICAvLyBiYXRjaElEIGxhcmdlciB0aGFuIGJvdGggb2YgdGhlc2UgdmFsdWVzLlxyXG4gICAgICAgIHZhciBuZXh0QmF0Y2hJZCA9IE1hdGgubWF4KGJhdGNoSWQsIHRoaXMuaGlnaGVzdEFja25vd2xlZGdlZEJhdGNoSWQpICsgMTtcclxuICAgICAgICAvLyBUaGUgcmVxdWVzdGVkIGJhdGNoSWQgbWF5IHN0aWxsIGJlIG91dCBvZiByYW5nZSBzbyBub3JtYWxpemUgaXQgdG8gdGhlXHJcbiAgICAgICAgLy8gc3RhcnQgb2YgdGhlIHF1ZXVlLlxyXG4gICAgICAgIHZhciByYXdJbmRleCA9IHRoaXMuaW5kZXhPZkJhdGNoSWQobmV4dEJhdGNoSWQpO1xyXG4gICAgICAgIHZhciBpbmRleCA9IHJhd0luZGV4IDwgMCA/IDAgOiByYXdJbmRleDtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA+IGluZGV4ID8gdGhpcy5tdXRhdGlvblF1ZXVlW2luZGV4XSA6IG51bGwpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldEFsbE11dGF0aW9uQmF0Y2hlcyA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLm11dGF0aW9uUXVldWUuc2xpY2UoKSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgc3RhcnQgPSBuZXcgRG9jUmVmZXJlbmNlKGRvY3VtZW50S2V5LCAwKTtcclxuICAgICAgICB2YXIgZW5kID0gbmV3IERvY1JlZmVyZW5jZShkb2N1bWVudEtleSwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleS5mb3JFYWNoSW5SYW5nZShbc3RhcnQsIGVuZF0sIGZ1bmN0aW9uIChyZWYpIHtcclxuICAgICAgICAgICAgYXNzZXJ0KGRvY3VtZW50S2V5LmlzRXF1YWwocmVmLmtleSksIFwiU2hvdWxkIG9ubHkgaXRlcmF0ZSBvdmVyIGEgc2luZ2xlIGtleSdzIGJhdGNoZXNcIik7XHJcbiAgICAgICAgICAgIHZhciBiYXRjaCA9IF90aGlzLmZpbmRNdXRhdGlvbkJhdGNoKHJlZi50YXJnZXRPckJhdGNoSWQpO1xyXG4gICAgICAgICAgICBhc3NlcnQoYmF0Y2ggIT09IG51bGwsICdCYXRjaGVzIGluIHRoZSBpbmRleCBtdXN0IGV4aXN0IGluIHRoZSBtYWluIHRhYmxlJyk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGJhdGNoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUocmVzdWx0KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHVuaXF1ZUJhdGNoSURzID0gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgICAgICBkb2N1bWVudEtleXMuZm9yRWFjaChmdW5jdGlvbiAoZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gbmV3IERvY1JlZmVyZW5jZShkb2N1bWVudEtleSwgMCk7XHJcbiAgICAgICAgICAgIHZhciBlbmQgPSBuZXcgRG9jUmVmZXJlbmNlKGRvY3VtZW50S2V5LCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpO1xyXG4gICAgICAgICAgICBfdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleS5mb3JFYWNoSW5SYW5nZShbc3RhcnQsIGVuZF0sIGZ1bmN0aW9uIChyZWYpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChkb2N1bWVudEtleS5pc0VxdWFsKHJlZi5rZXkpLCBcIkZvciBlYWNoIGtleSwgc2hvdWxkIG9ubHkgaXRlcmF0ZSBvdmVyIGEgc2luZ2xlIGtleSdzIGJhdGNoZXNcIik7XHJcbiAgICAgICAgICAgICAgICB1bmlxdWVCYXRjaElEcyA9IHVuaXF1ZUJhdGNoSURzLmFkZChyZWYudGFyZ2V0T3JCYXRjaElkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuZmluZE11dGF0aW9uQmF0Y2hlcyh1bmlxdWVCYXRjaElEcykpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ1F1ZXJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeSkge1xyXG4gICAgICAgIC8vIFVzZSB0aGUgcXVlcnkgcGF0aCBhcyBhIHByZWZpeCBmb3IgdGVzdGluZyBpZiBhIGRvY3VtZW50IG1hdGNoZXMgdGhlXHJcbiAgICAgICAgLy8gcXVlcnkuXHJcbiAgICAgICAgdmFyIHByZWZpeCA9IHF1ZXJ5LnBhdGg7XHJcbiAgICAgICAgdmFyIGltbWVkaWF0ZUNoaWxkcmVuUGF0aExlbmd0aCA9IHByZWZpeC5sZW5ndGggKyAxO1xyXG4gICAgICAgIC8vIENvbnN0cnVjdCBhIGRvY3VtZW50IHJlZmVyZW5jZSBmb3IgYWN0dWFsbHkgc2Nhbm5pbmcgdGhlIGluZGV4LiBVbmxpa2VcclxuICAgICAgICAvLyB0aGUgcHJlZml4IHRoZSBkb2N1bWVudCBrZXkgaW4gdGhpcyByZWZlcmVuY2UgbXVzdCBoYXZlIGFuIGV2ZW4gbnVtYmVyIG9mXHJcbiAgICAgICAgLy8gc2VnbWVudHMuIFRoZSBlbXB0eSBzZWdtZW50IGNhbiBiZSB1c2VkIGEgc3VmZml4IG9mIHRoZSBxdWVyeSBwYXRoXHJcbiAgICAgICAgLy8gYmVjYXVzZSBpdCBwcmVjZWRlcyBhbGwgb3RoZXIgc2VnbWVudHMgaW4gYW4gb3JkZXJlZCB0cmF2ZXJzYWwuXHJcbiAgICAgICAgdmFyIHN0YXJ0UGF0aCA9IHByZWZpeDtcclxuICAgICAgICBpZiAoIURvY3VtZW50S2V5LmlzRG9jdW1lbnRLZXkoc3RhcnRQYXRoKSkge1xyXG4gICAgICAgICAgICBzdGFydFBhdGggPSBzdGFydFBhdGguY2hpbGQoJycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc3RhcnQgPSBuZXcgRG9jUmVmZXJlbmNlKG5ldyBEb2N1bWVudEtleShzdGFydFBhdGgpLCAwKTtcclxuICAgICAgICAvLyBGaW5kIHVuaXF1ZSBiYXRjaElEcyByZWZlcmVuY2VkIGJ5IGFsbCBkb2N1bWVudHMgcG90ZW50aWFsbHkgbWF0Y2hpbmcgdGhlXHJcbiAgICAgICAgLy8gcXVlcnkuXHJcbiAgICAgICAgdmFyIHVuaXF1ZUJhdGNoSURzID0gbmV3IFNvcnRlZFNldChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgICAgICB0aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5LmZvckVhY2hXaGlsZShmdW5jdGlvbiAocmVmKSB7XHJcbiAgICAgICAgICAgIHZhciByb3dLZXlQYXRoID0gcmVmLmtleS5wYXRoO1xyXG4gICAgICAgICAgICBpZiAoIXByZWZpeC5pc1ByZWZpeE9mKHJvd0tleVBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSb3dzIHdpdGggZG9jdW1lbnQga2V5cyBtb3JlIHRoYW4gb25lIHNlZ21lbnQgbG9uZ2VyIHRoYW4gdGhlIHF1ZXJ5XHJcbiAgICAgICAgICAgICAgICAvLyBwYXRoIGNhbid0IGJlIG1hdGNoZXMuIEZvciBleGFtcGxlLCBhIHF1ZXJ5IG9uICdyb29tcycgY2FuJ3QgbWF0Y2hcclxuICAgICAgICAgICAgICAgIC8vIHRoZSBkb2N1bWVudCAvcm9vbXMvYWJjL21lc3NhZ2VzL3h5eC5cclxuICAgICAgICAgICAgICAgIC8vIFRPRE8obWNnKTogd2UnbGwgbmVlZCBhIGRpZmZlcmVudCBzY2FubmVyIHdoZW4gd2UgaW1wbGVtZW50XHJcbiAgICAgICAgICAgICAgICAvLyBhbmNlc3RvciBxdWVyaWVzLlxyXG4gICAgICAgICAgICAgICAgaWYgKHJvd0tleVBhdGgubGVuZ3RoID09PSBpbW1lZGlhdGVDaGlsZHJlblBhdGhMZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB1bmlxdWVCYXRjaElEcyA9IHVuaXF1ZUJhdGNoSURzLmFkZChyZWYudGFyZ2V0T3JCYXRjaElkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgc3RhcnQpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSh0aGlzLmZpbmRNdXRhdGlvbkJhdGNoZXModW5pcXVlQmF0Y2hJRHMpKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5maW5kTXV0YXRpb25CYXRjaGVzID0gZnVuY3Rpb24gKGJhdGNoSURzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBDb25zdHJ1Y3QgYW4gYXJyYXkgb2YgbWF0Y2hpbmcgYmF0Y2hlcywgc29ydGVkIGJ5IGJhdGNoSUQgdG8gZW5zdXJlIHRoYXRcclxuICAgICAgICAvLyBtdWx0aXBsZSBtdXRhdGlvbnMgYWZmZWN0aW5nIHRoZSBzYW1lIGRvY3VtZW50IGtleSBhcmUgYXBwbGllZCBpbiBvcmRlci5cclxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgYmF0Y2hJRHMuZm9yRWFjaChmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgICAgICB2YXIgYmF0Y2ggPSBfdGhpcy5maW5kTXV0YXRpb25CYXRjaChiYXRjaElkKTtcclxuICAgICAgICAgICAgaWYgKGJhdGNoICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChiYXRjaCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLnJlbW92ZU11dGF0aW9uQmF0Y2ggPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGJhdGNoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBGaW5kIHRoZSBwb3NpdGlvbiBvZiB0aGUgZmlyc3QgYmF0Y2ggZm9yIHJlbW92YWwuIFRoaXMgbmVlZCBub3QgYmUgdGhlXHJcbiAgICAgICAgLy8gZmlyc3QgZW50cnkgaW4gdGhlIHF1ZXVlLlxyXG4gICAgICAgIHZhciBiYXRjaEluZGV4ID0gdGhpcy5pbmRleE9mRXhpc3RpbmdCYXRjaElkKGJhdGNoLmJhdGNoSWQsICdyZW1vdmVkJyk7XHJcbiAgICAgICAgYXNzZXJ0KGJhdGNoSW5kZXggPT09IDAsICdDYW4gb25seSByZW1vdmUgdGhlIGZpcnN0IGVudHJ5IG9mIHRoZSBtdXRhdGlvbiBxdWV1ZScpO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5zaGlmdCgpO1xyXG4gICAgICAgIHZhciByZWZlcmVuY2VzID0gdGhpcy5iYXRjaGVzQnlEb2N1bWVudEtleTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2goYmF0Y2gubXV0YXRpb25zLCBmdW5jdGlvbiAobXV0YXRpb24pIHtcclxuICAgICAgICAgICAgdmFyIHJlZiA9IG5ldyBEb2NSZWZlcmVuY2UobXV0YXRpb24ua2V5LCBiYXRjaC5iYXRjaElkKTtcclxuICAgICAgICAgICAgcmVmZXJlbmNlcyA9IHJlZmVyZW5jZXMuZGVsZXRlKHJlZik7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVNdXRhdGlvblJlZmVyZW5jZSh0cmFuc2FjdGlvbiwgbXV0YXRpb24ua2V5KTtcclxuICAgICAgICB9KS5uZXh0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMuYmF0Y2hlc0J5RG9jdW1lbnRLZXkgPSByZWZlcmVuY2VzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLnJlbW92ZUNhY2hlZE11dGF0aW9uS2V5cyA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgLy8gTm8tb3Agc2luY2UgdGhlIG1lbW9yeSBtdXRhdGlvbiBxdWV1ZSBkb2VzIG5vdCBtYWludGFpbiBhIHNlcGFyYXRlIGNhY2hlLlxyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLmNvbnRhaW5zS2V5ID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdmFyIHJlZiA9IG5ldyBEb2NSZWZlcmVuY2Uoa2V5LCAwKTtcclxuICAgICAgICB2YXIgZmlyc3RSZWYgPSB0aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5LmZpcnN0QWZ0ZXJPckVxdWFsKHJlZik7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGtleS5pc0VxdWFsKGZpcnN0UmVmICYmIGZpcnN0UmVmLmtleSkpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeU11dGF0aW9uUXVldWUucHJvdG90eXBlLnBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrID0gZnVuY3Rpb24gKHR4bikge1xyXG4gICAgICAgIGlmICh0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLmJhdGNoZXNCeURvY3VtZW50S2V5LmlzRW1wdHkoKSwgJ0RvY3VtZW50IGxlYWsgLS0gZGV0ZWN0ZWQgZGFuZ2xpbmcgbXV0YXRpb24gcmVmZXJlbmNlcyB3aGVuIHF1ZXVlIGlzIGVtcHR5LicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEZpbmRzIHRoZSBpbmRleCBvZiB0aGUgZ2l2ZW4gYmF0Y2hJZCBpbiB0aGUgbXV0YXRpb24gcXVldWUgYW5kIGFzc2VydHMgdGhhdFxyXG4gICAgICogdGhlIHJlc3VsdGluZyBpbmRleCBpcyB3aXRoaW4gdGhlIGJvdW5kcyBvZiB0aGUgcXVldWUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGJhdGNoSWQgVGhlIGJhdGNoSWQgdG8gc2VhcmNoIGZvclxyXG4gICAgICogQHBhcmFtIGFjdGlvbiBBIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIGNhbGxlciBpcyBkb2luZywgcGhyYXNlZCBpbiBwYXNzaXZlXHJcbiAgICAgKiBmb3JtIChlLmcuIFwiYWNrbm93bGVkZ2VkXCIgaW4gYSByb3V0aW5lIHRoYXQgYWNrbm93bGVkZ2VzIGJhdGNoZXMpLlxyXG4gICAgICovXHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5pbmRleE9mRXhpc3RpbmdCYXRjaElkID0gZnVuY3Rpb24gKGJhdGNoSWQsIGFjdGlvbikge1xyXG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXhPZkJhdGNoSWQoYmF0Y2hJZCk7XHJcbiAgICAgICAgYXNzZXJ0KGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoLCAnQmF0Y2hlcyBtdXN0IGV4aXN0IHRvIGJlICcgKyBhY3Rpb24pO1xyXG4gICAgICAgIHJldHVybiBpbmRleDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEZpbmRzIHRoZSBpbmRleCBvZiB0aGUgZ2l2ZW4gYmF0Y2hJZCBpbiB0aGUgbXV0YXRpb24gcXVldWUuIFRoaXMgb3BlcmF0aW9uXHJcbiAgICAgKiBpcyBPKDEpLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm4gVGhlIGNvbXB1dGVkIGluZGV4IG9mIHRoZSBiYXRjaCB3aXRoIHRoZSBnaXZlbiBiYXRjaElkLCBiYXNlZCBvblxyXG4gICAgICogdGhlIHN0YXRlIG9mIHRoZSBxdWV1ZS4gTm90ZSB0aGlzIGluZGV4IGNhbiBiZSBuZWdhdGl2ZSBpZiB0aGUgcmVxdWVzdGVkXHJcbiAgICAgKiBiYXRjaElkIGhhcyBhbHJlYWR5IGJlZW4gcmVtdm9lZCBmcm9tIHRoZSBxdWV1ZSBvciBwYXN0IHRoZSBlbmQgb2YgdGhlXHJcbiAgICAgKiBxdWV1ZSBpZiB0aGUgYmF0Y2hJZCBpcyBsYXJnZXIgdGhhbiB0aGUgbGFzdCBhZGRlZCBiYXRjaC5cclxuICAgICAqL1xyXG4gICAgTWVtb3J5TXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuaW5kZXhPZkJhdGNoSWQgPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIGlmICh0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIC8vIEFzIGFuIGluZGV4IHRoaXMgaXMgcGFzdCB0aGUgZW5kIG9mIHRoZSBxdWV1ZVxyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gRXhhbWluZSB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlIHRvIGZpZ3VyZSBvdXQgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGVcclxuICAgICAgICAvLyBiYXRjaElkIGFuZCBpbmRleGVzIGluIHRoZSBhcnJheS4gTm90ZSB0aGF0IHNpbmNlIHRoZSBxdWV1ZSBpcyBvcmRlcmVkXHJcbiAgICAgICAgLy8gYnkgYmF0Y2hJZCwgaWYgdGhlIGZpcnN0IGJhdGNoIGhhcyBhIGxhcmdlciBiYXRjaElkIHRoZW4gdGhlIHJlcXVlc3RlZFxyXG4gICAgICAgIC8vIGJhdGNoSWQgZG9lc24ndCBleGlzdCBpbiB0aGUgcXVldWUuXHJcbiAgICAgICAgdmFyIGZpcnN0QmF0Y2hJZCA9IHRoaXMubXV0YXRpb25RdWV1ZVswXS5iYXRjaElkO1xyXG4gICAgICAgIHJldHVybiBiYXRjaElkIC0gZmlyc3RCYXRjaElkO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQSB2ZXJzaW9uIG9mIGxvb2t1cE11dGF0aW9uQmF0Y2ggdGhhdCBkb2Vzbid0IHJldHVybiBhIHByb21pc2UsIHRoaXMgbWFrZXNcclxuICAgICAqIG90aGVyIGZ1bmN0aW9ucyB0aGF0IHVzZXMgdGhpcyBjb2RlIGVhc2llciB0byByZWFkIGFuZCBtb3JlIGVmZmljZW50LlxyXG4gICAgICovXHJcbiAgICBNZW1vcnlNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5maW5kTXV0YXRpb25CYXRjaCA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleE9mQmF0Y2hJZChiYXRjaElkKTtcclxuICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBiYXRjaCA9IHRoaXMubXV0YXRpb25RdWV1ZVtpbmRleF07XHJcbiAgICAgICAgYXNzZXJ0KGJhdGNoLmJhdGNoSWQgPT09IGJhdGNoSWQsICdJZiBmb3VuZCBiYXRjaCBtdXN0IG1hdGNoJyk7XHJcbiAgICAgICAgcmV0dXJuIGJhdGNoO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNZW1vcnlNdXRhdGlvblF1ZXVlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIE1lbW9yeVF1ZXJ5Q2FjaGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNZW1vcnlRdWVyeUNhY2hlKHBlcnNpc3RlbmNlKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IHBlcnNpc3RlbmNlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIE1hcHMgYSBxdWVyeSB0byB0aGUgZGF0YSBhYm91dCB0aGF0IHF1ZXJ5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5xdWVyaWVzID0gbmV3IE9iamVjdE1hcChmdW5jdGlvbiAocSkgeyByZXR1cm4gcS5jYW5vbmljYWxJZCgpOyB9KTtcclxuICAgICAgICAvKiogVGhlIGxhc3QgcmVjZWl2ZWQgc25hcHNob3QgdmVyc2lvbi4gKi9cclxuICAgICAgICB0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBTbmFwc2hvdFZlcnNpb24uTUlOO1xyXG4gICAgICAgIC8qKiBUaGUgaGlnaGVzdCBudW1iZXJlZCB0YXJnZXQgSUQgZW5jb3VudGVyZWQuICovXHJcbiAgICAgICAgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSAwO1xyXG4gICAgICAgIC8qKiBUaGUgaGlnaGVzdCBzZXF1ZW5jZSBudW1iZXIgZW5jb3VudGVyZWQuICovXHJcbiAgICAgICAgdGhpcy5oaWdoZXN0U2VxdWVuY2VOdW1iZXIgPSAwO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgb3JkZXJlZCBiaWRpcmVjdGlvbmFsIG1hcHBpbmcgYmV0d2VlbiBkb2N1bWVudHMgYW5kIHRoZSByZW1vdGUgdGFyZ2V0XHJcbiAgICAgICAgICogSURzLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlcyA9IG5ldyBSZWZlcmVuY2VTZXQoKTtcclxuICAgICAgICB0aGlzLnRhcmdldENvdW50ID0gMDtcclxuICAgICAgICB0aGlzLnRhcmdldElkR2VuZXJhdG9yID0gVGFyZ2V0SWRHZW5lcmF0b3IuZm9yUXVlcnlDYWNoZSgpO1xyXG4gICAgfVxyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0VGFyZ2V0Q291bnQgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMudGFyZ2V0Q291bnQpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmZvckVhY2hUYXJnZXQgPSBmdW5jdGlvbiAodHhuLCBmKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKF8sIHF1ZXJ5RGF0YSkgeyByZXR1cm4gZihxdWVyeURhdGEpOyB9KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbik7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuaGlnaGVzdFNlcXVlbmNlTnVtYmVyKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5hbGxvY2F0ZVRhcmdldElkID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdmFyIG5leHRUYXJnZXRJZCA9IHRoaXMudGFyZ2V0SWRHZW5lcmF0b3IuYWZ0ZXIodGhpcy5oaWdoZXN0VGFyZ2V0SWQpO1xyXG4gICAgICAgIHRoaXMuaGlnaGVzdFRhcmdldElkID0gbmV4dFRhcmdldElkO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShuZXh0VGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLnNldFRhcmdldHNNZXRhZGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyLCBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKSB7XHJcbiAgICAgICAgaWYgKGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA+IHRoaXMuaGlnaGVzdFNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlnaGVzdFNlcXVlbmNlTnVtYmVyID0gaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5zYXZlUXVlcnlEYXRhID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHRoaXMucXVlcmllcy5zZXQocXVlcnlEYXRhLnF1ZXJ5LCBxdWVyeURhdGEpO1xyXG4gICAgICAgIHZhciB0YXJnZXRJZCA9IHF1ZXJ5RGF0YS50YXJnZXRJZDtcclxuICAgICAgICBpZiAodGFyZ2V0SWQgPiB0aGlzLmhpZ2hlc3RUYXJnZXRJZCkge1xyXG4gICAgICAgICAgICB0aGlzLmhpZ2hlc3RUYXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocXVlcnlEYXRhLnNlcXVlbmNlTnVtYmVyID4gdGhpcy5oaWdoZXN0U2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5oaWdoZXN0U2VxdWVuY2VOdW1iZXIgPSBxdWVyeURhdGEuc2VxdWVuY2VOdW1iZXI7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmFkZFF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLnF1ZXJpZXMuaGFzKHF1ZXJ5RGF0YS5xdWVyeSksICdBZGRpbmcgYSBxdWVyeSB0aGF0IGFscmVhZHkgZXhpc3RzJyk7XHJcbiAgICAgICAgdGhpcy5zYXZlUXVlcnlEYXRhKHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRDb3VudCArPSAxO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLnVwZGF0ZVF1ZXJ5RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgcXVlcnlEYXRhKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMucXVlcmllcy5oYXMocXVlcnlEYXRhLnF1ZXJ5KSwgJ1VwZGF0aW5nIGEgbm9uLWV4aXN0ZW50IHF1ZXJ5Jyk7XHJcbiAgICAgICAgdGhpcy5zYXZlUXVlcnlEYXRhKHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUucmVtb3ZlUXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy50YXJnZXRDb3VudCA+IDAsICdSZW1vdmluZyBhIHRhcmdldCBmcm9tIGFuIGVtcHR5IGNhY2hlJyk7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMucXVlcmllcy5oYXMocXVlcnlEYXRhLnF1ZXJ5KSwgJ1JlbW92aW5nIGEgbm9uLWV4aXN0ZW50IHRhcmdldCBmcm9tIHRoZSBjYWNoZScpO1xyXG4gICAgICAgIHRoaXMucXVlcmllcy5kZWxldGUocXVlcnlEYXRhLnF1ZXJ5KTtcclxuICAgICAgICB0aGlzLnJlZmVyZW5jZXMucmVtb3ZlUmVmZXJlbmNlc0ZvcklkKHF1ZXJ5RGF0YS50YXJnZXRJZCk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRDb3VudCAtPSAxO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLnJlbW92ZVRhcmdldHMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIHVwcGVyQm91bmQsIGFjdGl2ZVRhcmdldElkcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcclxuICAgICAgICB2YXIgcmVtb3ZhbHMgPSBbXTtcclxuICAgICAgICB0aGlzLnF1ZXJpZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCBxdWVyeURhdGEpIHtcclxuICAgICAgICAgICAgaWYgKHF1ZXJ5RGF0YS5zZXF1ZW5jZU51bWJlciA8PSB1cHBlckJvdW5kICYmXHJcbiAgICAgICAgICAgICAgICAhYWN0aXZlVGFyZ2V0SWRzW3F1ZXJ5RGF0YS50YXJnZXRJZF0pIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXJpZXMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgICAgICByZW1vdmFscy5wdXNoKF90aGlzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHRyYW5zYWN0aW9uLCBxdWVyeURhdGEudGFyZ2V0SWQpKTtcclxuICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLndhaXRGb3IocmVtb3ZhbHMpLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gY291bnQ7IH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldFF1ZXJ5Q291bnQgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy50YXJnZXRDb3VudCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuZ2V0UXVlcnlEYXRhID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeSkge1xyXG4gICAgICAgIHZhciBxdWVyeURhdGEgPSB0aGlzLnF1ZXJpZXMuZ2V0KHF1ZXJ5KSB8fCBudWxsO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShxdWVyeURhdGEpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldFF1ZXJ5RGF0YUZvclRhcmdldCA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgdGFyZ2V0SWQpIHtcclxuICAgICAgICAvLyBUaGlzIG1ldGhvZCBpcyBvbmx5IG5lZWRlZCBmb3IgbXVsdGktdGFiIGFuZCB3ZSBjYW4ndCBpbXBsZW1lbnQgaXRcclxuICAgICAgICAvLyBlZmZpY2llbnRseSB3aXRob3V0IGFkZGl0aW9uYWwgZGF0YSBzdHJ1Y3R1cmVzLlxyXG4gICAgICAgIHJldHVybiBmYWlsKCdOb3QgeWV0IGltcGxlbWVudGVkLicpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmFkZE1hdGNoaW5nS2V5cyA9IGZ1bmN0aW9uICh0eG4sIGtleXMsIHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VzLmFkZFJlZmVyZW5jZXMoa2V5cywgdGFyZ2V0SWQpO1xyXG4gICAgICAgIHZhciByZWZlcmVuY2VEZWxlZ2F0ZSA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGU7XHJcbiAgICAgICAgdmFyIHByb21pc2VzID0gW107XHJcbiAgICAgICAgaWYgKHJlZmVyZW5jZURlbGVnYXRlKSB7XHJcbiAgICAgICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICBwcm9taXNlcy5wdXNoKHJlZmVyZW5jZURlbGVnYXRlLmFkZFJlZmVyZW5jZSh0eG4sIGtleSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS53YWl0Rm9yKHByb21pc2VzKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlRdWVyeUNhY2hlLnByb3RvdHlwZS5yZW1vdmVNYXRjaGluZ0tleXMgPSBmdW5jdGlvbiAodHhuLCBrZXlzLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlcy5yZW1vdmVSZWZlcmVuY2VzKGtleXMsIHRhcmdldElkKTtcclxuICAgICAgICB2YXIgcmVmZXJlbmNlRGVsZWdhdGUgPSB0aGlzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlO1xyXG4gICAgICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIGlmIChyZWZlcmVuY2VEZWxlZ2F0ZSkge1xyXG4gICAgICAgICAgICBrZXlzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaChyZWZlcmVuY2VEZWxlZ2F0ZS5yZW1vdmVSZWZlcmVuY2UodHhuLCBrZXkpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uud2FpdEZvcihwcm9taXNlcyk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUucmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQgPSBmdW5jdGlvbiAodHhuLCB0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMucmVmZXJlbmNlcy5yZW1vdmVSZWZlcmVuY2VzRm9ySWQodGFyZ2V0SWQpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVF1ZXJ5Q2FjaGUucHJvdG90eXBlLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkID0gZnVuY3Rpb24gKHR4biwgdGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgbWF0Y2hpbmdLZXlzID0gdGhpcy5yZWZlcmVuY2VzLnJlZmVyZW5jZXNGb3JJZCh0YXJnZXRJZCk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG1hdGNoaW5nS2V5cyk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UXVlcnlDYWNoZS5wcm90b3R5cGUuY29udGFpbnNLZXkgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5yZWZlcmVuY2VzLmNvbnRhaW5zS2V5KGtleSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNZW1vcnlRdWVyeUNhY2hlO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gZG9jdW1lbnRTaXplTWFwKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTb3J0ZWRNYXAoRG9jdW1lbnRLZXkuY29tcGFyYXRvcik7XHJcbn1cclxudmFyIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBzaXplciBVc2VkIHRvIGFzc2VzcyB0aGUgc2l6ZSBvZiBhIGRvY3VtZW50LiBGb3IgZWFnZXIgR0MsIHRoaXMgaXMgZXhwZWN0ZWQgdG8ganVzdFxyXG4gICAgICogcmV0dXJuIDAgdG8gYXZvaWQgdW5uZWNlc3NhcmlseSBkb2luZyB0aGUgd29yayBvZiBjYWxjdWxhdGluZyB0aGUgc2l6ZS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZShzaXplcikge1xyXG4gICAgICAgIHRoaXMuc2l6ZXIgPSBzaXplcjtcclxuICAgICAgICB0aGlzLmRvY3MgPSBkb2N1bWVudFNpemVNYXAoKTtcclxuICAgICAgICB0aGlzLm5ld0RvY3VtZW50Q2hhbmdlcyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdGhpcy5zaXplID0gMDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyB0aGUgc3VwcGxpZWQgZW50cmllcyB0byB0aGUgY2FjaGUuIEFkZHMgdGhlIGdpdmVuIHNpemUgZGVsdGEgdG8gdGhlIGNhY2hlZCBzaXplLlxyXG4gICAgICovXHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5hZGRFbnRyaWVzID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBlbnRyaWVzLCBzaXplRGVsdGEpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGVudHJpZXNfMSA9IGVudHJpZXM7IF9pIDwgZW50cmllc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZW50cnkgPSBlbnRyaWVzXzFbX2ldO1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gZW50cnkubWF5YmVEb2N1bWVudC5rZXk7XHJcbiAgICAgICAgICAgIHRoaXMuZG9jcyA9IHRoaXMuZG9jcy5pbnNlcnQoa2V5LCBlbnRyeSk7XHJcbiAgICAgICAgICAgIHRoaXMubmV3RG9jdW1lbnRDaGFuZ2VzID0gdGhpcy5uZXdEb2N1bWVudENoYW5nZXMuYWRkKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2l6ZSArPSBzaXplRGVsdGE7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIHRoZSBzcGVjaWZpZWQgZW50cnkgZnJvbSB0aGUgY2FjaGUgYW5kIHVwZGF0ZXMgdGhlIHNpemUgYXMgYXBwcm9wcmlhdGUuXHJcbiAgICAgKi9cclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLnJlbW92ZUVudHJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBkb2N1bWVudEtleSkge1xyXG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMuZG9jcy5nZXQoZG9jdW1lbnRLZXkpO1xyXG4gICAgICAgIGlmIChlbnRyeSkge1xyXG4gICAgICAgICAgICB0aGlzLmRvY3MgPSB0aGlzLmRvY3MucmVtb3ZlKGRvY3VtZW50S2V5KTtcclxuICAgICAgICAgICAgdGhpcy5zaXplIC09IGVudHJ5LnNpemU7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShlbnRyeS5zaXplKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgwKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0RW50cnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy5kb2NzLmdldChkb2N1bWVudEtleSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKGVudHJ5ID8gZW50cnkubWF5YmVEb2N1bWVudCA6IG51bGwpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogTG9va3MgdXAgYW4gZW50cnkgaW4gdGhlIGNhY2hlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBsb29rIHVwLlxyXG4gICAgICogQHJldHVybiBUaGUgY2FjaGVkIE1heWJlRG9jdW1lbnQgZW50cnkgYW5kIGl0cyBzaXplLCBvciBudWxsIGlmIHdlIGhhdmUgbm90aGluZyBjYWNoZWQuXHJcbiAgICAgKi9cclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUucHJvdG90eXBlLmdldFNpemVkRW50cnkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKHRoaXMuZG9jcy5nZXQoZG9jdW1lbnRLZXkpKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBxdWVyeSkge1xyXG4gICAgICAgIHZhciByZXN1bHRzID0gZG9jdW1lbnRNYXAoKTtcclxuICAgICAgICAvLyBEb2N1bWVudHMgYXJlIG9yZGVyZWQgYnkga2V5LCBzbyB3ZSBjYW4gdXNlIGEgcHJlZml4IHNjYW4gdG8gbmFycm93IGRvd25cclxuICAgICAgICAvLyB0aGUgZG9jdW1lbnRzIHdlIG5lZWQgdG8gbWF0Y2ggdGhlIHF1ZXJ5IGFnYWluc3QuXHJcbiAgICAgICAgdmFyIHByZWZpeCA9IG5ldyBEb2N1bWVudEtleShxdWVyeS5wYXRoLmNoaWxkKCcnKSk7XHJcbiAgICAgICAgdmFyIGl0ZXJhdG9yID0gdGhpcy5kb2NzLmdldEl0ZXJhdG9yRnJvbShwcmVmaXgpO1xyXG4gICAgICAgIHdoaWxlIChpdGVyYXRvci5oYXNOZXh0KCkpIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gaXRlcmF0b3IuZ2V0TmV4dCgpLCBrZXkgPSBfYS5rZXksIG1heWJlRG9jdW1lbnQgPSBfYS52YWx1ZS5tYXliZURvY3VtZW50O1xyXG4gICAgICAgICAgICBpZiAoIXF1ZXJ5LnBhdGguaXNQcmVmaXhPZihrZXkucGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChtYXliZURvY3VtZW50IGluc3RhbmNlb2YgRG9jdW1lbnQgJiYgcXVlcnkubWF0Y2hlcyhtYXliZURvY3VtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuaW5zZXJ0KG1heWJlRG9jdW1lbnQua2V5LCBtYXliZURvY3VtZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUocmVzdWx0cyk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZm9yRWFjaERvY3VtZW50S2V5ID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCBmKSB7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5mb3JFYWNoKHRoaXMuZG9jcywgZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gZihrZXkpOyB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlLnByb3RvdHlwZS5nZXROZXdEb2N1bWVudENoYW5nZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjaGFuZ2VkRG9jcyA9IG1heWJlRG9jdW1lbnRNYXAoKTtcclxuICAgICAgICB0aGlzLm5ld0RvY3VtZW50Q2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgdmFyIGVudHJ5ID0gX3RoaXMuZG9jcy5nZXQoa2V5KTtcclxuICAgICAgICAgICAgdmFyIGNoYW5nZWREb2MgPSBlbnRyeVxyXG4gICAgICAgICAgICAgICAgPyBlbnRyeS5tYXliZURvY3VtZW50XHJcbiAgICAgICAgICAgICAgICA6IG5ldyBOb0RvY3VtZW50KGtleSwgU25hcHNob3RWZXJzaW9uLmZvckRlbGV0ZWREb2MoKSk7XHJcbiAgICAgICAgICAgIGNoYW5nZWREb2NzID0gY2hhbmdlZERvY3MuaW5zZXJ0KGtleSwgY2hhbmdlZERvYyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5uZXdEb2N1bWVudENoYW5nZXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZShjaGFuZ2VkRG9jcyk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUubmV3Q2hhbmdlQnVmZmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIodGhpcy5zaXplciwgdGhpcyk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUodGhpcy5zaXplKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEhhbmRsZXMgdGhlIGRldGFpbHMgb2YgYWRkaW5nIGFuZCB1cGRhdGluZyBkb2N1bWVudHMgaW4gdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUuXHJcbiAqL1xyXG52YXIgTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhNZW1vcnlSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyKHNpemVyLCBkb2N1bWVudENhY2hlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5zaXplciA9IHNpemVyO1xyXG4gICAgICAgIF90aGlzLmRvY3VtZW50Q2FjaGUgPSBkb2N1bWVudENhY2hlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLnByb3RvdHlwZS5hcHBseUNoYW5nZXMgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gdGhpcy5hc3NlcnRDaGFuZ2VzKCk7XHJcbiAgICAgICAgdmFyIGRlbHRhID0gMDtcclxuICAgICAgICB2YXIgZG9jcyA9IFtdO1xyXG4gICAgICAgIGNoYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5LCBtYXliZURvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBwcmV2aW91c1NpemUgPSBfdGhpcy5kb2N1bWVudFNpemVzLmdldChrZXkpO1xyXG4gICAgICAgICAgICBhc3NlcnQocHJldmlvdXNTaXplICE9PSB1bmRlZmluZWQsIFwiQXR0ZW1wdGluZyB0byBjaGFuZ2UgZG9jdW1lbnQgXCIgKyBrZXkudG9TdHJpbmcoKSArIFwiIHdpdGhvdXQgaGF2aW5nIHJlYWQgaXQgZmlyc3RcIik7XHJcbiAgICAgICAgICAgIHZhciBzaXplID0gX3RoaXMuc2l6ZXIobWF5YmVEb2N1bWVudCk7XHJcbiAgICAgICAgICAgIGRlbHRhICs9IHNpemUgLSBwcmV2aW91c1NpemU7XHJcbiAgICAgICAgICAgIGRvY3MucHVzaCh7IG1heWJlRG9jdW1lbnQ6IG1heWJlRG9jdW1lbnQsIHNpemU6IHNpemUgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnRDYWNoZS5hZGRFbnRyaWVzKHRyYW5zYWN0aW9uLCBkb2NzLCBkZWx0YSk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIucHJvdG90eXBlLmdldEZyb21DYWNoZSA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZG9jdW1lbnRLZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudENhY2hlLmdldFNpemVkRW50cnkodHJhbnNhY3Rpb24sIGRvY3VtZW50S2V5KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXI7XHJcbn0oUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDQgPSAnTWVtb3J5UGVyc2lzdGVuY2UnO1xyXG4vKipcclxuICogQSBtZW1vcnktYmFja2VkIGluc3RhbmNlIG9mIFBlcnNpc3RlbmNlLiBEYXRhIGlzIHN0b3JlZCBvbmx5IGluIFJBTSBhbmRcclxuICogbm90IHBlcnNpc3RlZCBhY3Jvc3Mgc2Vzc2lvbnMuXHJcbiAqL1xyXG52YXIgTWVtb3J5UGVyc2lzdGVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNZW1vcnlQZXJzaXN0ZW5jZShjbGllbnRJZCwgaXNFYWdlciwgc2VyaWFsaXplcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIE5vdGUgdGhhdCB0aGVzZSBhcmUgcmV0YWluZWQgaGVyZSB0byBtYWtlIGl0IGVhc2llciB0byB3cml0ZSB0ZXN0c1xyXG4gICAgICAgICAqIGFmZmVjdGluZyBib3RoIHRoZSBpbi1tZW1vcnkgYW5kIEluZGV4ZWREQi1iYWNrZWQgcGVyc2lzdGVuY2UgbGF5ZXJzLiBUZXN0c1xyXG4gICAgICAgICAqIGNhbiBjcmVhdGUgYSBuZXcgTG9jYWxTdG9yZSB3cmFwcGluZyB0aGlzIFBlcnNpc3RlbmNlIGluc3RhbmNlIGFuZCB0aGlzXHJcbiAgICAgICAgICogd2lsbCBtYWtlIHRoZSBpbi1tZW1vcnkgcGVyc2lzdGVuY2UgbGF5ZXIgYmVoYXZlIGFzIGlmIGl0IHdlcmUgYWN0dWFsbHlcclxuICAgICAgICAgKiBwZXJzaXN0aW5nIHZhbHVlcy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWVzID0ge307XHJcbiAgICAgICAgdGhpcy5saXN0ZW5TZXF1ZW5jZSA9IG5ldyBMaXN0ZW5TZXF1ZW5jZSgwKTtcclxuICAgICAgICB0aGlzLl9zdGFydGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKGlzRWFnZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IG5ldyBNZW1vcnlFYWdlckRlbGVnYXRlKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IG5ldyBNZW1vcnlMcnVEZWxlZ2F0ZSh0aGlzLCBuZXcgTG9jYWxTZXJpYWxpemVyKHNlcmlhbGl6ZXIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5xdWVyeUNhY2hlID0gbmV3IE1lbW9yeVF1ZXJ5Q2FjaGUodGhpcyk7XHJcbiAgICAgICAgdmFyIHNpemVyID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmVmZXJlbmNlRGVsZWdhdGUuZG9jdW1lbnRTaXplKGRvYyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUgPSBuZXcgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZShzaXplcik7XHJcbiAgICB9XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5jcmVhdGVMcnVQZXJzaXN0ZW5jZSA9IGZ1bmN0aW9uIChjbGllbnRJZCwgc2VyaWFsaXplcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgTWVtb3J5UGVyc2lzdGVuY2UoY2xpZW50SWQsIC8qIGlzRWFnZXI9ICovIGZhbHNlLCBzZXJpYWxpemVyKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5jcmVhdGVFYWdlclBlcnNpc3RlbmNlID0gZnVuY3Rpb24gKGNsaWVudElkLCBzZXJpYWxpemVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNZW1vcnlQZXJzaXN0ZW5jZShjbGllbnRJZCwgLyogaXNFYWdlcj0gKi8gdHJ1ZSwgc2VyaWFsaXplcik7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLnNodXRkb3duID0gZnVuY3Rpb24gKGRlbGV0ZURhdGEpIHtcclxuICAgICAgICAvLyBObyBkdXJhYmxlIHN0YXRlIHRvIGVuc3VyZSBpcyBjbG9zZWQgb24gc2h1dGRvd24uXHJcbiAgICAgICAgdGhpcy5fc3RhcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLCBcInN0YXJ0ZWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhcnRlZDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRBY3RpdmVDbGllbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBbdGhpcy5jbGllbnRJZF1dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUuc2V0UHJpbWFyeVN0YXRlTGlzdGVuZXIgPSBmdW5jdGlvbiAocHJpbWFyeVN0YXRlTGlzdGVuZXIpIHtcclxuICAgICAgICAvLyBBbGwgY2xpZW50cyB1c2luZyBtZW1vcnkgcGVyc2lzdGVuY2UgYWN0IGFzIHByaW1hcnkuXHJcbiAgICAgICAgcmV0dXJuIHByaW1hcnlTdGF0ZUxpc3RlbmVyKHRydWUpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5zZXROZXR3b3JrRW5hYmxlZCA9IGZ1bmN0aW9uIChuZXR3b3JrRW5hYmxlZCkge1xyXG4gICAgICAgIC8vIE5vIG9wLlxyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRNdXRhdGlvblF1ZXVlID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICB2YXIgcXVldWUgPSB0aGlzLm11dGF0aW9uUXVldWVzW3VzZXIudG9LZXkoKV07XHJcbiAgICAgICAgaWYgKCFxdWV1ZSkge1xyXG4gICAgICAgICAgICBxdWV1ZSA9IG5ldyBNZW1vcnlNdXRhdGlvblF1ZXVlKHRoaXMucmVmZXJlbmNlRGVsZWdhdGUpO1xyXG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uUXVldWVzW3VzZXIudG9LZXkoKV0gPSBxdWV1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHF1ZXVlO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRRdWVyeUNhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJ5Q2FjaGU7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5UGVyc2lzdGVuY2UucHJvdG90eXBlLmdldFJlbW90ZURvY3VtZW50Q2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlQZXJzaXN0ZW5jZS5wcm90b3R5cGUucnVuVHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAoYWN0aW9uLCBtb2RlLCB0cmFuc2FjdGlvbk9wZXJhdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQ0LCAnU3RhcnRpbmcgdHJhbnNhY3Rpb246JywgYWN0aW9uKTtcclxuICAgICAgICB2YXIgdHhuID0gbmV3IE1lbW9yeVRyYW5zYWN0aW9uKHRoaXMubGlzdGVuU2VxdWVuY2UubmV4dCgpKTtcclxuICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm9uVHJhbnNhY3Rpb25TdGFydGVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uT3BlcmF0aW9uKHR4bilcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMucmVmZXJlbmNlRGVsZWdhdGVcclxuICAgICAgICAgICAgICAgIC5vblRyYW5zYWN0aW9uQ29tbWl0dGVkKHR4bilcclxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlc3VsdDsgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRvUHJvbWlzZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVBlcnNpc3RlbmNlLnByb3RvdHlwZS5tdXRhdGlvblF1ZXVlc0NvbnRhaW5LZXkgPSBmdW5jdGlvbiAodHJhbnNhY3Rpb24sIGtleSkge1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2Uub3IodmFsdWVzKHRoaXMubXV0YXRpb25RdWV1ZXMpXHJcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHF1ZXVlKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBxdWV1ZS5jb250YWluc0tleSh0cmFuc2FjdGlvbiwga2V5KTsgfTsgfSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNZW1vcnlQZXJzaXN0ZW5jZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIE1lbW9yeSBwZXJzaXN0ZW5jZSBpcyBub3QgYWN0dWFsbHkgdHJhbnNhY3Rpb25hbCwgYnV0IGZ1dHVyZSBpbXBsZW1lbnRhdGlvbnNcclxuICogbWF5IGhhdmUgdHJhbnNhY3Rpb24tc2NvcGVkIHN0YXRlLlxyXG4gKi9cclxudmFyIE1lbW9yeVRyYW5zYWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5VHJhbnNhY3Rpb24oY3VycmVudFNlcXVlbmNlTnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50U2VxdWVuY2VOdW1iZXIgPSBjdXJyZW50U2VxdWVuY2VOdW1iZXI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTWVtb3J5VHJhbnNhY3Rpb247XHJcbn0oKSk7XHJcbnZhciBNZW1vcnlFYWdlckRlbGVnYXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5RWFnZXJEZWxlZ2F0ZShwZXJzaXN0ZW5jZSkge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSBwZXJzaXN0ZW5jZTtcclxuICAgIH1cclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLnNldEluTWVtb3J5UGlucyA9IGZ1bmN0aW9uIChpbk1lbW9yeVBpbnMpIHtcclxuICAgICAgICB0aGlzLmluTWVtb3J5UGlucyA9IGluTWVtb3J5UGlucztcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5hZGRSZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkRG9jdW1lbnRzLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZVJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWREb2N1bWVudHMuYWRkKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5RWFnZXJEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlTXV0YXRpb25SZWZlcmVuY2UgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkRG9jdW1lbnRzLmFkZChrZXkpO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZVRhcmdldCA9IGZ1bmN0aW9uICh0eG4sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNhY2hlID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXRRdWVyeUNhY2hlKCk7XHJcbiAgICAgICAgcmV0dXJuIGNhY2hlXHJcbiAgICAgICAgICAgIC5nZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0eG4sIHF1ZXJ5RGF0YS50YXJnZXRJZClcclxuICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGtleXMpIHtcclxuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIF90aGlzLm9ycGhhbmVkRG9jdW1lbnRzLmFkZChrZXkpOyB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoKSB7IHJldHVybiBjYWNoZS5yZW1vdmVRdWVyeURhdGEodHhuLCBxdWVyeURhdGEpOyB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5vblRyYW5zYWN0aW9uU3RhcnRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLm9ycGhhbmVkRG9jdW1lbnRzID0gbmV3IFNldCgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLm9uVHJhbnNhY3Rpb25Db21taXR0ZWQgPSBmdW5jdGlvbiAodHhuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY2FjaGUgPSB0aGlzLnBlcnNpc3RlbmNlLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLmZvckVhY2godGhpcy5vcnBoYW5lZERvY3VtZW50cywgZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuaXNSZWZlcmVuY2VkKHR4biwga2V5KS5uZXh0KGZ1bmN0aW9uIChpc1JlZmVyZW5jZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghaXNSZWZlcmVuY2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU2luY2UgdGhpcyBpcyB0aGUgZWFnZXIgZGVsZWdhdGUgYW5kIG1lbW9yeSBwZXJzaXN0ZW5jZSxcclxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBkb24ndCBjYXJlIGFib3V0IHRoZSBzaXplIG9mIGRvY3VtZW50cy4gV2UgZG9uJ3QgdHJhY2tcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2l6ZSBvZiB0aGUgY2FjaGUgZm9yIGVhZ2VyIEdDLlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZS5yZW1vdmVFbnRyeSh0eG4sIGtleSkubmV4dChmdW5jdGlvbiAoKSB7IH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLnVwZGF0ZUxpbWJvRG9jdW1lbnQgPSBmdW5jdGlvbiAodHhuLCBrZXkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlzUmVmZXJlbmNlZCh0eG4sIGtleSkubmV4dChmdW5jdGlvbiAoaXNSZWZlcmVuY2VkKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1JlZmVyZW5jZWQpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLm9ycGhhbmVkRG9jdW1lbnRzLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub3JwaGFuZWREb2N1bWVudHMuYWRkKGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlFYWdlckRlbGVnYXRlLnByb3RvdHlwZS5kb2N1bWVudFNpemUgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgLy8gRm9yIGVhZ2VyIEdDLCB3ZSBkb24ndCBjYXJlIGFib3V0IHRoZSBkb2N1bWVudCBzaXplLCB0aGVyZSBhcmUgbm8gc2l6ZSB0aHJlc2hvbGRzLlxyXG4gICAgICAgIHJldHVybiAwO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUVhZ2VyRGVsZWdhdGUucHJvdG90eXBlLmlzUmVmZXJlbmNlZCA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5vcihbXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnBlcnNpc3RlbmNlLmdldFF1ZXJ5Q2FjaGUoKS5jb250YWluc0tleSh0eG4sIGtleSk7IH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnBlcnNpc3RlbmNlLm11dGF0aW9uUXVldWVzQ29udGFpbktleSh0eG4sIGtleSk7IH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHsgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKF90aGlzLmluTWVtb3J5UGlucy5jb250YWluc0tleShrZXkpKTsgfVxyXG4gICAgICAgIF0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNZW1vcnlFYWdlckRlbGVnYXRlO1xyXG59KCkpO1xyXG52YXIgTWVtb3J5THJ1RGVsZWdhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNZW1vcnlMcnVEZWxlZ2F0ZShwZXJzaXN0ZW5jZSwgc2VyaWFsaXplcikge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSBwZXJzaXN0ZW5jZTtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWRTZXF1ZW5jZU51bWJlcnMgPSBuZXcgT2JqZWN0TWFwKGZ1bmN0aW9uIChrKSB7IHJldHVybiBlbmNvZGUoay5wYXRoKTsgfSk7XHJcbiAgICAgICAgdGhpcy5nYXJiYWdlQ29sbGVjdG9yID0gbmV3IExydUdhcmJhZ2VDb2xsZWN0b3IodGhpcyk7XHJcbiAgICB9XHJcbiAgICAvLyBOby1vcHMsIHByZXNlbnQgc28gbWVtb3J5IHBlcnNpc3RlbmNlIGRvZXNuJ3QgaGF2ZSB0byBjYXJlIHdoaWNoIGRlbGVnYXRlXHJcbiAgICAvLyBpdCBoYXMuXHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUub25UcmFuc2FjdGlvblN0YXJ0ZWQgPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUub25UcmFuc2FjdGlvbkNvbW1pdHRlZCA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuZm9yRWFjaFRhcmdldCA9IGZ1bmN0aW9uICh0eG4sIGYpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5nZXRRdWVyeUNhY2hlKCkuZm9yRWFjaFRhcmdldCh0eG4sIGYpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5nZXRUYXJnZXRDb3VudCA9IGZ1bmN0aW9uICh0eG4pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5nZXRRdWVyeUNhY2hlKCkuZ2V0VGFyZ2V0Q291bnQodHhuKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuZm9yRWFjaE9ycGhhbmVkRG9jdW1lbnRTZXF1ZW5jZU51bWJlciA9IGZ1bmN0aW9uICh0eG4sIGYpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBQZXJzaXN0ZW5jZVByb21pc2UuZm9yRWFjaCh0aGlzLm9ycGhhbmVkU2VxdWVuY2VOdW1iZXJzLCBmdW5jdGlvbiAoa2V5LCBzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgICAgICAvLyBQYXNzIGluIHRoZSBleGFjdCBzZXF1ZW5jZSBudW1iZXIgYXMgdGhlIHVwcGVyIGJvdW5kIHNvIHdlIGtub3cgaXQgd29uJ3QgYmUgcGlubmVkIGJ5XHJcbiAgICAgICAgICAgIC8vIGJlaW5nIHRvbyByZWNlbnQuXHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5pc1Bpbm5lZCh0eG4sIGtleSwgc2VxdWVuY2VOdW1iZXIpLm5leHQoZnVuY3Rpb24gKGlzUGlubmVkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWlzUGlubmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYoc2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5zZXRJbk1lbW9yeVBpbnMgPSBmdW5jdGlvbiAoaW5NZW1vcnlQaW5zKSB7XHJcbiAgICAgICAgdGhpcy5pbk1lbW9yeVBpbnMgPSBpbk1lbW9yeVBpbnM7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZVRhcmdldHMgPSBmdW5jdGlvbiAodHhuLCB1cHBlckJvdW5kLCBhY3RpdmVUYXJnZXRJZHMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZVxyXG4gICAgICAgICAgICAuZ2V0UXVlcnlDYWNoZSgpXHJcbiAgICAgICAgICAgIC5yZW1vdmVUYXJnZXRzKHR4biwgdXBwZXJCb3VuZCwgYWN0aXZlVGFyZ2V0SWRzKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlT3JwaGFuZWREb2N1bWVudHMgPSBmdW5jdGlvbiAodHhuLCB1cHBlckJvdW5kKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgICAgIHZhciBjYWNoZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpO1xyXG4gICAgICAgIHZhciBwID0gY2FjaGUuZm9yRWFjaERvY3VtZW50S2V5KHR4biwgZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuaXNQaW5uZWQodHhuLCBrZXksIHVwcGVyQm91bmQpLm5leHQoZnVuY3Rpb24gKGlzUGlubmVkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNQaW5uZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIG1lbW9yeSByZW1vdGUgZG9jdW1lbnQgY2FjaGUgZG9lcyBpdHMgb3duIGJ5dGVcclxuICAgICAgICAgICAgICAgICAgICAvLyBhY2NvdW50aW5nIG9uIHJlbW92YWwuIFRoaXMgaXMgb2sgYmVjYXVzZSB1cGRhdGluZyB0aGUgc2l6ZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciBtZW1vcnkgcGVyc2lzdGVuY2UgZG9lcyBub3QgaW5jdXIgSU8uXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLnJlbW92ZUVudHJ5KHR4biwga2V5KS5uZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBwLm5leHQoZnVuY3Rpb24gKCkgeyByZXR1cm4gY291bnQ7IH0pO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeUxydURlbGVnYXRlLnByb3RvdHlwZS5yZW1vdmVNdXRhdGlvblJlZmVyZW5jZSA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWRTZXF1ZW5jZU51bWJlcnMuc2V0KGtleSwgdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLnJlbW92ZVRhcmdldCA9IGZ1bmN0aW9uICh0eG4sIHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHZhciB1cGRhdGVkID0gcXVlcnlEYXRhLmNvcHkoe1xyXG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlclxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldFF1ZXJ5Q2FjaGUoKS51cGRhdGVRdWVyeURhdGEodHhuLCB1cGRhdGVkKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUuYWRkUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZFNlcXVlbmNlTnVtYmVycy5zZXQoa2V5LCB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUucmVtb3ZlUmVmZXJlbmNlID0gZnVuY3Rpb24gKHR4biwga2V5KSB7XHJcbiAgICAgICAgdGhpcy5vcnBoYW5lZFNlcXVlbmNlTnVtYmVycy5zZXQoa2V5LCB0eG4uY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlMcnVEZWxlZ2F0ZS5wcm90b3R5cGUudXBkYXRlTGltYm9Eb2N1bWVudCA9IGZ1bmN0aW9uICh0eG4sIGtleSkge1xyXG4gICAgICAgIHRoaXMub3JwaGFuZWRTZXF1ZW5jZU51bWJlcnMuc2V0KGtleSwgdHhuLmN1cnJlbnRTZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLmRvY3VtZW50U2l6ZSA9IGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgIHZhciByZW1vdGVEb2N1bWVudCA9IHRoaXMuc2VyaWFsaXplci50b0RiUmVtb3RlRG9jdW1lbnQobWF5YmVEb2MpO1xyXG4gICAgICAgIHZhciB2YWx1ZTtcclxuICAgICAgICBpZiAocmVtb3RlRG9jdW1lbnQuZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFsdWUgPSByZW1vdGVEb2N1bWVudC5kb2N1bWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocmVtb3RlRG9jdW1lbnQudW5rbm93bkRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gcmVtb3RlRG9jdW1lbnQudW5rbm93bkRvY3VtZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChyZW1vdGVEb2N1bWVudC5ub0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gcmVtb3RlRG9jdW1lbnQubm9Eb2N1bWVudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGZhaWwoJ1Vua25vd24gcmVtb3RlIGRvY3VtZW50IHR5cGUnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbHVlKS5sZW5ndGg7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5THJ1RGVsZWdhdGUucHJvdG90eXBlLmlzUGlubmVkID0gZnVuY3Rpb24gKHR4biwga2V5LCB1cHBlckJvdW5kKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLm9yKFtcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucGVyc2lzdGVuY2UubXV0YXRpb25RdWV1ZXNDb250YWluS2V5KHR4biwga2V5KTsgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkgeyByZXR1cm4gUGVyc2lzdGVuY2VQcm9taXNlLnJlc29sdmUoX3RoaXMuaW5NZW1vcnlQaW5zLmNvbnRhaW5zS2V5KGtleSkpOyB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5wZXJzaXN0ZW5jZS5nZXRRdWVyeUNhY2hlKCkuY29udGFpbnNLZXkodHhuLCBrZXkpOyB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3JwaGFuZWRBdCA9IF90aGlzLm9ycGhhbmVkU2VxdWVuY2VOdW1iZXJzLmdldChrZXkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBlcnNpc3RlbmNlUHJvbWlzZS5yZXNvbHZlKG9ycGhhbmVkQXQgIT09IHVuZGVmaW5lZCAmJiBvcnBoYW5lZEF0ID4gdXBwZXJCb3VuZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTWVtb3J5THJ1RGVsZWdhdGU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQ1ID0gJ0V4cG9uZW50aWFsQmFja29mZic7XHJcbi8qKlxyXG4gKiBBIGhlbHBlciBmb3IgcnVubmluZyBkZWxheWVkIHRhc2tzIGZvbGxvd2luZyBhbiBleHBvbmVudGlhbCBiYWNrb2ZmIGN1cnZlXHJcbiAqIGJldHdlZW4gYXR0ZW1wdHMuXHJcbiAqXHJcbiAqIEVhY2ggZGVsYXkgaXMgbWFkZSB1cCBvZiBhIFwiYmFzZVwiIGRlbGF5IHdoaWNoIGZvbGxvd3MgdGhlIGV4cG9uZW50aWFsXHJcbiAqIGJhY2tvZmYgY3VydmUsIGFuZCBhICsvLSA1MCUgXCJqaXR0ZXJcIiB0aGF0IGlzIGNhbGN1bGF0ZWQgYW5kIGFkZGVkIHRvIHRoZVxyXG4gKiBiYXNlIGRlbGF5LiBUaGlzIHByZXZlbnRzIGNsaWVudHMgZnJvbSBhY2NpZGVudGFsbHkgc3luY2hyb25pemluZyB0aGVpclxyXG4gKiBkZWxheXMgY2F1c2luZyBzcGlrZXMgb2YgbG9hZCB0byB0aGUgYmFja2VuZC5cclxuICovXHJcbnZhciBFeHBvbmVudGlhbEJhY2tvZmYgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFeHBvbmVudGlhbEJhY2tvZmYoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBBc3luY1F1ZXVlIHRvIHJ1biBiYWNrb2ZmIG9wZXJhdGlvbnMgb24uXHJcbiAgICAgKi9cclxuICAgIHF1ZXVlLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIElEIHRvIHVzZSB3aGVuIHNjaGVkdWxpbmcgYmFja29mZiBvcGVyYXRpb25zIG9uIHRoZSBBc3luY1F1ZXVlLlxyXG4gICAgICovXHJcbiAgICB0aW1lcklkLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGluaXRpYWwgZGVsYXkgKHVzZWQgYXMgdGhlIGJhc2UgZGVsYXkgb24gdGhlIGZpcnN0IHJldHJ5IGF0dGVtcHQpLlxyXG4gICAgICogTm90ZSB0aGF0IGppdHRlciB3aWxsIHN0aWxsIGJlIGFwcGxpZWQsIHNvIHRoZSBhY3R1YWwgZGVsYXkgY291bGQgYmUgYXNcclxuICAgICAqIGxpdHRsZSBhcyAwLjUqaW5pdGlhbERlbGF5TXMuXHJcbiAgICAgKi9cclxuICAgIGluaXRpYWxEZWxheU1zLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG11bHRpcGxpZXIgdG8gdXNlIHRvIGRldGVybWluZSB0aGUgZXh0ZW5kZWQgYmFzZSBkZWxheSBhZnRlciBlYWNoXHJcbiAgICAgKiBhdHRlbXB0LlxyXG4gICAgICovXHJcbiAgICBiYWNrb2ZmRmFjdG9yLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIG1heGltdW0gYmFzZSBkZWxheSBhZnRlciB3aGljaCBubyBmdXJ0aGVyIGJhY2tvZmYgaXMgcGVyZm9ybWVkLlxyXG4gICAgICogTm90ZSB0aGF0IGppdHRlciB3aWxsIHN0aWxsIGJlIGFwcGxpZWQsIHNvIHRoZSBhY3R1YWwgZGVsYXkgY291bGQgYmUgYXNcclxuICAgICAqIG11Y2ggYXMgMS41Km1heERlbGF5TXMuXHJcbiAgICAgKi9cclxuICAgIG1heERlbGF5TXMpIHtcclxuICAgICAgICB0aGlzLnF1ZXVlID0gcXVldWU7XHJcbiAgICAgICAgdGhpcy50aW1lcklkID0gdGltZXJJZDtcclxuICAgICAgICB0aGlzLmluaXRpYWxEZWxheU1zID0gaW5pdGlhbERlbGF5TXM7XHJcbiAgICAgICAgdGhpcy5iYWNrb2ZmRmFjdG9yID0gYmFja29mZkZhY3RvcjtcclxuICAgICAgICB0aGlzLm1heERlbGF5TXMgPSBtYXhEZWxheU1zO1xyXG4gICAgICAgIHRoaXMudGltZXJQcm9taXNlID0gbnVsbDtcclxuICAgICAgICAvKiogVGhlIGxhc3QgYmFja29mZiBhdHRlbXB0LCBhcyBlcG9jaCBtaWxsaXNlY29uZHMuICovXHJcbiAgICAgICAgdGhpcy5sYXN0QXR0ZW1wdFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVzZXRzIHRoZSBiYWNrb2ZmIGRlbGF5LlxyXG4gICAgICpcclxuICAgICAqIFRoZSB2ZXJ5IG5leHQgYmFja29mZkFuZFdhaXQoKSB3aWxsIGhhdmUgbm8gZGVsYXkuIElmIGl0IGlzIGNhbGxlZCBhZ2FpblxyXG4gICAgICogKGkuZS4gZHVlIHRvIGFuIGVycm9yKSwgaW5pdGlhbERlbGF5TXMgKHBsdXMgaml0dGVyKSB3aWxsIGJlIHVzZWQsIGFuZFxyXG4gICAgICogc3Vic2VxdWVudCBvbmVzIHdpbGwgaW5jcmVhc2UgYWNjb3JkaW5nIHRvIHRoZSBiYWNrb2ZmRmFjdG9yLlxyXG4gICAgICovXHJcbiAgICBFeHBvbmVudGlhbEJhY2tvZmYucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEJhc2VNcyA9IDA7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldHMgdGhlIGJhY2tvZmYgZGVsYXkgdG8gdGhlIG1heGltdW0gZGVsYXkgKGUuZy4gZm9yIHVzZSBhZnRlciBhXHJcbiAgICAgKiBSRVNPVVJDRV9FWEhBVVNURUQgZXJyb3IpLlxyXG4gICAgICovXHJcbiAgICBFeHBvbmVudGlhbEJhY2tvZmYucHJvdG90eXBlLnJlc2V0VG9NYXggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50QmFzZU1zID0gdGhpcy5tYXhEZWxheU1zO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciBjdXJyZW50RGVsYXlNcywgYW5kIGluY3JlYXNlcyB0aGVcclxuICAgICAqIGRlbGF5IGZvciBhbnkgc3Vic2VxdWVudCBhdHRlbXB0cy4gSWYgdGhlcmUgd2FzIGEgcGVuZGluZyBiYWNrb2ZmIG9wZXJhdGlvblxyXG4gICAgICogYWxyZWFkeSwgaXQgd2lsbCBiZSBjYW5jZWxlZC5cclxuICAgICAqL1xyXG4gICAgRXhwb25lbnRpYWxCYWNrb2ZmLnByb3RvdHlwZS5iYWNrb2ZmQW5kUnVuID0gZnVuY3Rpb24gKG9wKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBDYW5jZWwgYW55IHBlbmRpbmcgYmFja29mZiBvcGVyYXRpb24uXHJcbiAgICAgICAgdGhpcy5jYW5jZWwoKTtcclxuICAgICAgICAvLyBGaXJzdCBzY2hlZHVsZSB1c2luZyB0aGUgY3VycmVudCBiYXNlICh3aGljaCBtYXkgYmUgMCBhbmQgc2hvdWxkIGJlXHJcbiAgICAgICAgLy8gaG9ub3JlZCBhcyBzdWNoKS5cclxuICAgICAgICB2YXIgZGVzaXJlZERlbGF5V2l0aEppdHRlck1zID0gTWF0aC5mbG9vcih0aGlzLmN1cnJlbnRCYXNlTXMgKyB0aGlzLmppdHRlckRlbGF5TXMoKSk7XHJcbiAgICAgICAgLy8gR3VhcmQgYWdhaW5zdCBsYXN0QXR0ZW1wdFRpbWUgYmVpbmcgaW4gdGhlIGZ1dHVyZSBkdWUgdG8gYSBjbG9jayBjaGFuZ2UuXHJcbiAgICAgICAgdmFyIGRlbGF5U29GYXJNcyA9IE1hdGgubWF4KDAsIERhdGUubm93KCkgLSB0aGlzLmxhc3RBdHRlbXB0VGltZSk7XHJcbiAgICAgICAgLy8gR3VhcmQgYWdhaW5zdCB0aGUgYmFja29mZiBkZWxheSBhbHJlYWR5IGJlaW5nIHBhc3QuXHJcbiAgICAgICAgdmFyIHJlbWFpbmluZ0RlbGF5TXMgPSBNYXRoLm1heCgwLCBkZXNpcmVkRGVsYXlXaXRoSml0dGVyTXMgLSBkZWxheVNvRmFyTXMpO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRCYXNlTXMgPiAwKSB7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckNSwgXCJCYWNraW5nIG9mZiBmb3IgXCIgKyByZW1haW5pbmdEZWxheU1zICsgXCIgbXMgXCIgK1xyXG4gICAgICAgICAgICAgICAgKFwiKGJhc2UgZGVsYXk6IFwiICsgdGhpcy5jdXJyZW50QmFzZU1zICsgXCIgbXMsIFwiKSArXHJcbiAgICAgICAgICAgICAgICAoXCJkZWxheSB3aXRoIGppdHRlcjogXCIgKyBkZXNpcmVkRGVsYXlXaXRoSml0dGVyTXMgKyBcIiBtcywgXCIpICtcclxuICAgICAgICAgICAgICAgIChcImxhc3QgYXR0ZW1wdDogXCIgKyBkZWxheVNvRmFyTXMgKyBcIiBtcyBhZ28pXCIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50aW1lclByb21pc2UgPSB0aGlzLnF1ZXVlLmVucXVldWVBZnRlckRlbGF5KHRoaXMudGltZXJJZCwgcmVtYWluaW5nRGVsYXlNcywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5sYXN0QXR0ZW1wdFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICByZXR1cm4gb3AoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBBcHBseSBiYWNrb2ZmIGZhY3RvciB0byBkZXRlcm1pbmUgbmV4dCBkZWxheSBhbmQgZW5zdXJlIGl0IGlzIHdpdGhpblxyXG4gICAgICAgIC8vIGJvdW5kcy5cclxuICAgICAgICB0aGlzLmN1cnJlbnRCYXNlTXMgKj0gdGhpcy5iYWNrb2ZmRmFjdG9yO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRCYXNlTXMgPCB0aGlzLmluaXRpYWxEZWxheU1zKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEJhc2VNcyA9IHRoaXMuaW5pdGlhbERlbGF5TXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRCYXNlTXMgPiB0aGlzLm1heERlbGF5TXMpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50QmFzZU1zID0gdGhpcy5tYXhEZWxheU1zO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBFeHBvbmVudGlhbEJhY2tvZmYucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy50aW1lclByb21pc2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lclByb21pc2UuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXJQcm9taXNlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIFJldHVybnMgYSByYW5kb20gdmFsdWUgaW4gdGhlIHJhbmdlIFstY3VycmVudEJhc2VNcy8yLCBjdXJyZW50QmFzZU1zLzJdICovXHJcbiAgICBFeHBvbmVudGlhbEJhY2tvZmYucHJvdG90eXBlLmppdHRlckRlbGF5TXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIHRoaXMuY3VycmVudEJhc2VNcztcclxuICAgIH07XHJcbiAgICByZXR1cm4gRXhwb25lbnRpYWxCYWNrb2ZmO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckNiA9ICdQZXJzaXN0ZW50U3RyZWFtJztcclxuLyoqXHJcbiAqIFBlcnNpc3RlbnRTdHJlYW0gY2FuIGJlIGluIG9uZSBvZiA1IHN0YXRlcyAoZWFjaCBkZXNjcmliZWQgaW4gZGV0YWlsIGJlbG93KVxyXG4gKiBiYXNlZCBvbiB0aGUgZm9sbG93aW5nIHN0YXRlIHRyYW5zaXRpb24gZGlhZ3JhbTpcclxuICpcclxuICogICAgICAgICAgc3RhcnQoKSBjYWxsZWQgICAgICAgICAgICAgYXV0aCAmIGNvbm5lY3Rpb24gc3VjY2VlZGVkXHJcbiAqIElOSVRJQUwgLS0tLS0tLS0tLS0tLS0tLT4gU1RBUlRJTkcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0+IE9QRU5cclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIF4gIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIHwgICAgICAgICAgICAgICAgICAgIGVycm9yIG9jY3VycmVkIHxcclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgIFxcLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS12LS0tLS0vXHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqICAgICAgICAgICAgICAgICAgICBiYWNrb2ZmICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8XHJcbiAqICAgICAgICAgICAgICAgICAgICBlbGFwc2VkICB8ICAgICAgICAgICAgICBzdGFydCgpIGNhbGxlZCAgICB8XHJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcXC0tLSBCQUNLT0ZGIDwtLS0tLS0tLS0tLS0tLS0tIEVSUk9SXHJcbiAqXHJcbiAqIFthbnkgc3RhdGVdIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPiBJTklUSUFMXHJcbiAqICAgICAgICAgICAgICAgc3RvcCgpIGNhbGxlZCBvclxyXG4gKiAgICAgICAgICAgICAgIGlkbGUgdGltZXIgZXhwaXJlZFxyXG4gKi9cclxudmFyIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZTtcclxuKGZ1bmN0aW9uIChQZXJzaXN0ZW50U3RyZWFtU3RhdGUpIHtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHN0cmVhbWluZyBSUEMgaXMgbm90IHlldCBydW5uaW5nIGFuZCB0aGVyZSdzIG5vIGVycm9yIGNvbmRpdGlvbi5cclxuICAgICAqIENhbGxpbmcgc3RhcnQoKSB3aWxsIHN0YXJ0IHRoZSBzdHJlYW0gaW1tZWRpYXRlbHkgd2l0aG91dCBiYWNrb2ZmLlxyXG4gICAgICogV2hpbGUgaW4gdGhpcyBzdGF0ZSBpc1N0YXJ0ZWQoKSB3aWxsIHJldHVybiBmYWxzZS5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbVN0YXRlW1BlcnNpc3RlbnRTdHJlYW1TdGF0ZVtcIkluaXRpYWxcIl0gPSAwXSA9IFwiSW5pdGlhbFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc3RyZWFtIGlzIHN0YXJ0aW5nLCBlaXRoZXIgd2FpdGluZyBmb3IgYW4gYXV0aCB0b2tlbiBvciBmb3IgdGhlIHN0cmVhbVxyXG4gICAgICogdG8gc3VjY2Vzc2Z1bGx5IG9wZW4uIFdoaWxlIGluIHRoaXMgc3RhdGUsIGlzU3RhcnRlZCgpIHdpbGwgcmV0dXJuIHRydWUgYnV0XHJcbiAgICAgKiBpc09wZW4oKSB3aWxsIHJldHVybiBmYWxzZS5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbVN0YXRlW1BlcnNpc3RlbnRTdHJlYW1TdGF0ZVtcIlN0YXJ0aW5nXCJdID0gMV0gPSBcIlN0YXJ0aW5nXCI7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBzdHJlYW1pbmcgUlBDIGlzIHVwIGFuZCBydW5uaW5nLiBSZXF1ZXN0cyBhbmQgcmVzcG9uc2VzIGNhbiBmbG93XHJcbiAgICAgKiBmcmVlbHkuIEJvdGggaXNTdGFydGVkKCkgYW5kIGlzT3BlbigpIHdpbGwgcmV0dXJuIHRydWUuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZVtQZXJzaXN0ZW50U3RyZWFtU3RhdGVbXCJPcGVuXCJdID0gMl0gPSBcIk9wZW5cIjtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIHN0cmVhbSBlbmNvdW50ZXJlZCBhbiBlcnJvci4gVGhlIG5leHQgc3RhcnQgYXR0ZW1wdCB3aWxsIGJhY2sgb2ZmLlxyXG4gICAgICogV2hpbGUgaW4gdGhpcyBzdGF0ZSBpc1N0YXJ0ZWQoKSB3aWxsIHJldHVybiBmYWxzZS5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbVN0YXRlW1BlcnNpc3RlbnRTdHJlYW1TdGF0ZVtcIkVycm9yXCJdID0gM10gPSBcIkVycm9yXCI7XHJcbiAgICAvKipcclxuICAgICAqIEFuIGluLWJldHdlZW4gc3RhdGUgYWZ0ZXIgYW4gZXJyb3Igd2hlcmUgdGhlIHN0cmVhbSBpcyB3YWl0aW5nIGJlZm9yZVxyXG4gICAgICogcmUtc3RhcnRpbmcuIEFmdGVyIHdhaXRpbmcgaXMgY29tcGxldGUsIHRoZSBzdHJlYW0gd2lsbCB0cnkgdG8gb3Blbi5cclxuICAgICAqIFdoaWxlIGluIHRoaXMgc3RhdGUgaXNTdGFydGVkKCkgd2lsbCByZXR1cm4gdHJ1ZSBidXQgaXNPcGVuKCkgd2lsbCByZXR1cm5cclxuICAgICAqIGZhbHNlLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtU3RhdGVbUGVyc2lzdGVudFN0cmVhbVN0YXRlW1wiQmFja29mZlwiXSA9IDRdID0gXCJCYWNrb2ZmXCI7XHJcbn0pKFBlcnNpc3RlbnRTdHJlYW1TdGF0ZSB8fCAoUGVyc2lzdGVudFN0cmVhbVN0YXRlID0ge30pKTtcclxuLyoqXHJcbiAqIEluaXRpYWwgYmFja29mZiB0aW1lIGluIG1pbGxpc2Vjb25kcyBhZnRlciBhbiBlcnJvci5cclxuICogU2V0IHRvIDFzIGFjY29yZGluZyB0byBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vYXBpcy9kZXNpZ24vZXJyb3JzLlxyXG4gKi9cclxudmFyIEJBQ0tPRkZfSU5JVElBTF9ERUxBWV9NUyA9IDEwMDA7XHJcbi8qKiBNYXhpbXVtIGJhY2tvZmYgdGltZSBpbiBtaWxsaXNlY29uZHMgKi9cclxudmFyIEJBQ0tPRkZfTUFYX0RFTEFZX01TID0gNjAgKiAxMDAwO1xyXG52YXIgQkFDS09GRl9GQUNUT1IgPSAxLjU7XHJcbi8qKiBUaGUgdGltZSBhIHN0cmVhbSBzdGF5cyBvcGVuIGFmdGVyIGl0IGlzIG1hcmtlZCBpZGxlLiAqL1xyXG52YXIgSURMRV9USU1FT1VUX01TID0gNjAgKiAxMDAwO1xyXG4vKipcclxuICogQSBQZXJzaXN0ZW50U3RyZWFtIGlzIGFuIGFic3RyYWN0IGJhc2UgY2xhc3MgdGhhdCByZXByZXNlbnRzIGEgc3RyZWFtaW5nIFJQQ1xyXG4gKiB0byB0aGUgRmlyZXN0b3JlIGJhY2tlbmQuIEl0J3MgYnVpbHQgb24gdG9wIG9mIHRoZSBjb25uZWN0aW9ucyBvd24gc3VwcG9ydFxyXG4gKiBmb3Igc3RyZWFtaW5nIFJQQ3MsIGFuZCBhZGRzIHNldmVyYWwgY3JpdGljYWwgZmVhdHVyZXMgZm9yIG91ciBjbGllbnRzOlxyXG4gKlxyXG4gKiAgIC0gRXhwb25lbnRpYWwgYmFja29mZiBvbiBmYWlsdXJlXHJcbiAqICAgLSBBdXRoZW50aWNhdGlvbiB2aWEgQ3JlZGVudGlhbHNQcm92aWRlclxyXG4gKiAgIC0gRGlzcGF0Y2hpbmcgYWxsIGNhbGxiYWNrcyBpbnRvIHRoZSBzaGFyZWQgd29ya2VyIHF1ZXVlXHJcbiAqICAgLSBDbG9zaW5nIGlkbGUgc3RyZWFtcyBhZnRlciA2MCBzZWNvbmRzIG9mIGluYWN0aXZpdHlcclxuICpcclxuICogU3ViY2xhc3NlcyBvZiBQZXJzaXN0ZW50U3RyZWFtIGltcGxlbWVudCBzZXJpYWxpemF0aW9uIG9mIG1vZGVscyB0byBhbmRcclxuICogZnJvbSB0aGUgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGUgcHJvdG9jb2wgYnVmZmVycyBmb3IgYSBzcGVjaWZpY1xyXG4gKiBzdHJlYW1pbmcgUlBDLlxyXG4gKlxyXG4gKiAjIyBTdGFydGluZyBhbmQgU3RvcHBpbmdcclxuICpcclxuICogU3RyZWFtaW5nIFJQQ3MgYXJlIHN0YXRlZnVsIGFuZCBuZWVkIHRvIGJlIHN0YXJ0KCllZCBiZWZvcmUgbWVzc2FnZXMgY2FuXHJcbiAqIGJlIHNlbnQgYW5kIHJlY2VpdmVkLiBUaGUgUGVyc2lzdGVudFN0cmVhbSB3aWxsIGNhbGwgdGhlIG9uT3BlbigpIGZ1bmN0aW9uXHJcbiAqIG9mIHRoZSBsaXN0ZW5lciBvbmNlIHRoZSBzdHJlYW0gaXMgcmVhZHkgdG8gYWNjZXB0IHJlcXVlc3RzLlxyXG4gKlxyXG4gKiBTaG91bGQgYSBzdGFydCgpIGZhaWwsIFBlcnNpc3RlbnRTdHJlYW0gd2lsbCBjYWxsIHRoZSByZWdpc3RlcmVkIG9uQ2xvc2UoKVxyXG4gKiBsaXN0ZW5lciB3aXRoIGEgRmlyZXN0b3JlRXJyb3IgaW5kaWNhdGluZyB3aGF0IHdlbnQgd3JvbmcuXHJcbiAqXHJcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSBjYW4gYmUgc3RhcnRlZCBhbmQgc3RvcHBlZCByZXBlYXRlZGx5LlxyXG4gKlxyXG4gKiBHZW5lcmljIHR5cGVzOlxyXG4gKiAgU2VuZFR5cGU6IFRoZSB0eXBlIG9mIHRoZSBvdXRnb2luZyBtZXNzYWdlIG9mIHRoZSB1bmRlcmx5aW5nXHJcbiAqICAgIGNvbm5lY3Rpb24gc3RyZWFtXHJcbiAqICBSZWNlaXZlVHlwZTogVGhlIHR5cGUgb2YgdGhlIGluY29taW5nIG1lc3NhZ2Ugb2YgdGhlIHVuZGVybHlpbmdcclxuICogICAgY29ubmVjdGlvbiBzdHJlYW1cclxuICogIExpc3RlbmVyVHlwZTogVGhlIHR5cGUgb2YgdGhlIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSB1c2VkIGZvciBjYWxsYmFja3NcclxuICovXHJcbnZhciBQZXJzaXN0ZW50U3RyZWFtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGVyc2lzdGVudFN0cmVhbShxdWV1ZSwgY29ubmVjdGlvblRpbWVySWQsIGlkbGVUaW1lcklkLCBjb25uZWN0aW9uLCBjcmVkZW50aWFsc1Byb3ZpZGVyLCBsaXN0ZW5lcikge1xyXG4gICAgICAgIHRoaXMucXVldWUgPSBxdWV1ZTtcclxuICAgICAgICB0aGlzLmlkbGVUaW1lcklkID0gaWRsZVRpbWVySWQ7XHJcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcclxuICAgICAgICB0aGlzLmNyZWRlbnRpYWxzUHJvdmlkZXIgPSBjcmVkZW50aWFsc1Byb3ZpZGVyO1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXIgPSBsaXN0ZW5lcjtcclxuICAgICAgICB0aGlzLnN0YXRlID0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkluaXRpYWw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBjbG9zZSBjb3VudCB0aGF0J3MgaW5jcmVtZW50ZWQgZXZlcnkgdGltZSB0aGUgc3RyZWFtIGlzIGNsb3NlZDsgdXNlZCBieVxyXG4gICAgICAgICAqIGdldENsb3NlR3VhcmRlZERpc3BhdGNoZXIoKSB0byBpbnZhbGlkYXRlIGNhbGxiYWNrcyB0aGF0IGhhcHBlbiBhZnRlclxyXG4gICAgICAgICAqIGNsb3NlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY2xvc2VDb3VudCA9IDA7XHJcbiAgICAgICAgdGhpcy5pZGxlVGltZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtID0gbnVsbDtcclxuICAgICAgICB0aGlzLmJhY2tvZmYgPSBuZXcgRXhwb25lbnRpYWxCYWNrb2ZmKHF1ZXVlLCBjb25uZWN0aW9uVGltZXJJZCwgQkFDS09GRl9JTklUSUFMX0RFTEFZX01TLCBCQUNLT0ZGX0ZBQ1RPUiwgQkFDS09GRl9NQVhfREVMQVlfTVMpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgc3RhcnQoKSBoYXMgYmVlbiBjYWxsZWQgYW5kIG5vIGVycm9yIGhhcyBvY2N1cnJlZC4gVHJ1ZVxyXG4gICAgICogaW5kaWNhdGVzIHRoZSBzdHJlYW0gaXMgb3BlbiBvciBpbiB0aGUgcHJvY2VzcyBvZiBvcGVuaW5nICh3aGljaFxyXG4gICAgICogZW5jb21wYXNzZXMgcmVzcGVjdGluZyBiYWNrb2ZmLCBnZXR0aW5nIGF1dGggdG9rZW5zLCBhbmQgc3RhcnRpbmcgdGhlXHJcbiAgICAgKiBhY3R1YWwgUlBDKS4gVXNlIGlzT3BlbigpIHRvIGRldGVybWluZSBpZiB0aGUgc3RyZWFtIGlzIG9wZW4gYW5kIHJlYWR5IGZvclxyXG4gICAgICogb3V0Ym91bmQgcmVxdWVzdHMuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmlzU3RhcnRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5TdGFydGluZyB8fFxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuT3BlbiB8fFxyXG4gICAgICAgICAgICB0aGlzLnN0YXRlID09PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuQmFja29mZik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHVuZGVybHlpbmcgUlBDIGlzIG9wZW4gKHRoZSBvbk9wZW4oKSBsaXN0ZW5lciBoYXMgYmVlblxyXG4gICAgICogY2FsbGVkKSBhbmQgdGhlIHN0cmVhbSBpcyByZWFkeSBmb3Igb3V0Ym91bmQgcmVxdWVzdHMuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmlzT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLk9wZW47XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdGFydHMgdGhlIFJQQy4gT25seSBhbGxvd2VkIGlmIGlzU3RhcnRlZCgpIHJldHVybnMgZmFsc2UuIFRoZSBzdHJlYW0gaXNcclxuICAgICAqIG5vdCBpbW1lZGlhdGVseSByZWFkeSBmb3IgdXNlOiBvbk9wZW4oKSB3aWxsIGJlIGludm9rZWQgd2hlbiB0aGUgUlBDIGlzXHJcbiAgICAgKiByZWFkeSBmb3Igb3V0Ym91bmQgcmVxdWVzdHMsIGF0IHdoaWNoIHBvaW50IGlzT3BlbigpIHdpbGwgcmV0dXJuIHRydWUuXHJcbiAgICAgKlxyXG4gICAgICogV2hlbiBzdGFydCByZXR1cm5zLCBpc1N0YXJ0ZWQoKSB3aWxsIHJldHVybiB0cnVlLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkVycm9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVyZm9ybUJhY2tvZmYoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBhc3NlcnQodGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkluaXRpYWwsICdBbHJlYWR5IHN0YXJ0ZWQnKTtcclxuICAgICAgICB0aGlzLmF1dGgoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFN0b3BzIHRoZSBSUEMuIFRoaXMgY2FsbCBpcyBpZGVtcG90ZW50IGFuZCBhbGxvd2VkIHJlZ2FyZGxlc3Mgb2YgdGhlXHJcbiAgICAgKiBjdXJyZW50IGlzU3RhcnRlZCgpIHN0YXRlLlxyXG4gICAgICpcclxuICAgICAqIFdoZW4gc3RvcCByZXR1cm5zLCBpc1N0YXJ0ZWQoKSBhbmQgaXNPcGVuKCkgd2lsbCBib3RoIHJldHVybiBmYWxzZS5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNTdGFydGVkKCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsb3NlKFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBZnRlciBhbiBlcnJvciB0aGUgc3RyZWFtIHdpbGwgdXN1YWxseSBiYWNrIG9mZiBvbiB0aGUgbmV4dCBhdHRlbXB0IHRvXHJcbiAgICAgKiBzdGFydCBpdC4gSWYgdGhlIGVycm9yIHdhcnJhbnRzIGFuIGltbWVkaWF0ZSByZXN0YXJ0IG9mIHRoZSBzdHJlYW0sIHRoZVxyXG4gICAgICogc2VuZGVyIGNhbiB1c2UgdGhpcyB0byBpbmRpY2F0ZSB0aGF0IHRoZSByZWNlaXZlciBzaG91bGQgbm90IGJhY2sgb2ZmLlxyXG4gICAgICpcclxuICAgICAqIEVhY2ggZXJyb3Igd2lsbCBjYWxsIHRoZSBvbkNsb3NlKCkgbGlzdGVuZXIuIFRoYXQgZnVuY3Rpb24gY2FuIGRlY2lkZSB0b1xyXG4gICAgICogaW5oaWJpdCBiYWNrb2ZmIGlmIHJlcXVpcmVkLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5pbmhpYml0QmFja29mZiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuaXNTdGFydGVkKCksICdDYW4gb25seSBpbmhpYml0IGJhY2tvZmYgaW4gYSBzdG9wcGVkIHN0YXRlJyk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsO1xyXG4gICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogTWFya3MgdGhpcyBzdHJlYW0gYXMgaWRsZS4gSWYgbm8gZnVydGhlciBhY3Rpb25zIGFyZSBwZXJmb3JtZWQgb24gdGhlXHJcbiAgICAgKiBzdHJlYW0gZm9yIG9uZSBtaW51dGUsIHRoZSBzdHJlYW0gd2lsbCBhdXRvbWF0aWNhbGx5IGNsb3NlIGl0c2VsZiBhbmRcclxuICAgICAqIG5vdGlmeSB0aGUgc3RyZWFtJ3Mgb25DbG9zZSgpIGhhbmRsZXIgd2l0aCBTdGF0dXMuT0suIFRoZSBzdHJlYW0gd2lsbCB0aGVuXHJcbiAgICAgKiBiZSBpbiBhICFpc1N0YXJ0ZWQoKSBzdGF0ZSwgcmVxdWlyaW5nIHRoZSBjYWxsZXIgdG8gc3RhcnQgdGhlIHN0cmVhbSBhZ2FpblxyXG4gICAgICogYmVmb3JlIGZ1cnRoZXIgdXNlLlxyXG4gICAgICpcclxuICAgICAqIE9ubHkgc3RyZWFtcyB0aGF0IGFyZSBpbiBzdGF0ZSAnT3BlbicgY2FuIGJlIG1hcmtlZCBpZGxlLCBhcyBhbGwgb3RoZXJcclxuICAgICAqIHN0YXRlcyBpbXBseSBwZW5kaW5nIG5ldHdvcmsgb3BlcmF0aW9ucy5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUubWFya0lkbGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBTdGFydHMgdGhlIGlkbGUgdGltZSBpZiB3ZSBhcmUgaW4gc3RhdGUgJ09wZW4nIGFuZCBhcmUgbm90IHlldCBhbHJlYWR5XHJcbiAgICAgICAgLy8gcnVubmluZyBhIHRpbWVyIChpbiB3aGljaCBjYXNlIHRoZSBwcmV2aW91cyBpZGxlIHRpbWVvdXQgc3RpbGwgYXBwbGllcykuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuKCkgJiYgdGhpcy5pZGxlVGltZXIgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5pZGxlVGltZXIgPSB0aGlzLnF1ZXVlLmVucXVldWVBZnRlckRlbGF5KHRoaXMuaWRsZVRpbWVySWQsIElETEVfVElNRU9VVF9NUywgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlSWRsZUNsb3NlVGltZXIoKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiBTZW5kcyBhIG1lc3NhZ2UgdG8gdGhlIHVuZGVybHlpbmcgc3RyZWFtLiAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuc2VuZFJlcXVlc3QgPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgdGhpcy5jYW5jZWxJZGxlQ2hlY2soKTtcclxuICAgICAgICB0aGlzLnN0cmVhbS5zZW5kKG1zZyk7XHJcbiAgICB9O1xyXG4gICAgLyoqIENhbGxlZCBieSB0aGUgaWRsZSB0aW1lciB3aGVuIHRoZSBzdHJlYW0gc2hvdWxkIGNsb3NlIGR1ZSB0byBpbmFjdGl2aXR5LiAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuaGFuZGxlSWRsZUNsb3NlVGltZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNPcGVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBXaGVuIHRpbWluZyBvdXQgYW4gaWRsZSBzdHJlYW0gdGhlcmUncyBubyByZWFzb24gdG8gZm9yY2UgdGhlIHN0cmVhbSBpbnRvIGJhY2tvZmYgd2hlblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGl0IHJlc3RhcnRzIHNvIHNldCB0aGUgc3RyZWFtIHN0YXRlIHRvIEluaXRpYWwgaW5zdGVhZCBvZiBFcnJvci5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5jbG9zZShQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKiogTWFya3MgdGhlIHN0cmVhbSBhcyBhY3RpdmUgYWdhaW4uICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5jYW5jZWxJZGxlQ2hlY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaWRsZVRpbWVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaWRsZVRpbWVyLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICB0aGlzLmlkbGVUaW1lciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2xvc2VzIHRoZSBzdHJlYW0gYW5kIGNsZWFucyB1cCBhcyBuZWNlc3Nhcnk6XHJcbiAgICAgKlxyXG4gICAgICogKiBjbG9zZXMgdGhlIHVuZGVybHlpbmcgR1JQQyBzdHJlYW07XHJcbiAgICAgKiAqIGNhbGxzIHRoZSBvbkNsb3NlIGhhbmRsZXIgd2l0aCB0aGUgZ2l2ZW4gJ2Vycm9yJztcclxuICAgICAqICogc2V0cyBpbnRlcm5hbCBzdHJlYW0gc3RhdGUgdG8gJ2ZpbmFsU3RhdGUnO1xyXG4gICAgICogKiBhZGp1c3RzIHRoZSBiYWNrb2ZmIHRpbWVyIGJhc2VkIG9uIHRoZSBlcnJvclxyXG4gICAgICpcclxuICAgICAqIEEgbmV3IHN0cmVhbSBjYW4gYmUgb3BlbmVkIGJ5IGNhbGxpbmcgc3RhcnQoKS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZmluYWxTdGF0ZSB0aGUgaW50ZW5kZWQgc3RhdGUgb2YgdGhlIHN0cmVhbSBhZnRlciBjbG9zaW5nLlxyXG4gICAgICogQHBhcmFtIGVycm9yIHRoZSBlcnJvciB0aGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIHdpdGguXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKGZpbmFsU3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHRoaXMuaXNTdGFydGVkKCksICdPbmx5IHN0YXJ0ZWQgc3RyZWFtcyBzaG91bGQgYmUgY2xvc2VkLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoZmluYWxTdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkVycm9yIHx8IGlzTnVsbE9yVW5kZWZpbmVkKGVycm9yJCQxKSwgXCJDYW4ndCBwcm92aWRlIGFuIGVycm9yIHdoZW4gbm90IGluIGFuIGVycm9yIHN0YXRlLlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FuY2VsIGFueSBvdXRzdGFuZGluZyB0aW1lcnMgKHRoZXkncmUgZ3VhcmFudGVlZCBub3QgdG8gZXhlY3V0ZSkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsSWRsZUNoZWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmFja29mZi5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW52YWxpZGF0ZXMgYW55IHN0cmVhbS1yZWxhdGVkIGNhbGxiYWNrcyAoZS5nLiBmcm9tIGF1dGggb3IgdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVuZGVybHlpbmcgc3RyZWFtKSwgZ3VhcmFudGVlaW5nIHRoZXkgd29uJ3QgZXhlY3V0ZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZUNvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaW5hbFN0YXRlICE9PSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgaXMgYW4gaW50ZW50aW9uYWwgY2xvc2UgZW5zdXJlIHdlIGRvbid0IGRlbGF5IG91ciBuZXh0IGNvbm5lY3Rpb24gYXR0ZW1wdC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmFja29mZi5yZXNldCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGVycm9yJCQxICYmIGVycm9yJCQxLmNvZGUgPT09IENvZGUuUkVTT1VSQ0VfRVhIQVVTVEVEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMb2cgdGhlIGVycm9yLiAoUHJvYmFibHkgZWl0aGVyICdxdW90YSBleGNlZWRlZCcgb3IgJ21heCBxdWV1ZSBsZW5ndGggcmVhY2hlZCcuKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IoZXJyb3IkJDEudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcignVXNpbmcgbWF4aW11bSBiYWNrb2ZmIGRlbGF5IHRvIHByZXZlbnQgb3ZlcmxvYWRpbmcgdGhlIGJhY2tlbmQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhY2tvZmYucmVzZXRUb01heCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGVycm9yJCQxICYmIGVycm9yJCQxLmNvZGUgPT09IENvZGUuVU5BVVRIRU5USUNBVEVEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBcInVuYXV0aGVudGljYXRlZFwiIGVycm9yIG1lYW5zIHRoZSB0b2tlbiB3YXMgcmVqZWN0ZWQuIFRyeSBmb3JjZSByZWZyZXNoaW5nIGl0IGluIGNhc2UgaXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGp1c3QgZXhwaXJlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlZGVudGlhbHNQcm92aWRlci5pbnZhbGlkYXRlVG9rZW4oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDbGVhbiB1cCB0aGUgdW5kZXJseWluZyBzdHJlYW0gYmVjYXVzZSB3ZSBhcmUgbm8gbG9uZ2VyIGludGVyZXN0ZWQgaW4gZXZlbnRzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdHJlYW0gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVhckRvd24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RyZWFtLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0cmVhbSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBzdGF0ZSBtdXN0IGJlIGFzc2lnbmVkIGJlZm9yZSBjYWxsaW5nIG9uQ2xvc2UoKSB0byBhbGxvdyB0aGUgY2FsbGJhY2sgdG9cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5oaWJpdCBiYWNrb2ZmIG9yIG90aGVyd2lzZSBtYW5pcHVsYXRlIHRoZSBzdGF0ZSBpbiBpdHMgbm9uLXN0YXJ0ZWQgc3RhdGUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBmaW5hbFN0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZnkgdGhlIGxpc3RlbmVyIHRoYXQgdGhlIHN0cmVhbSBjbG9zZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubGlzdGVuZXIub25DbG9zZShlcnJvciQkMSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90aWZ5IHRoZSBsaXN0ZW5lciB0aGF0IHRoZSBzdHJlYW0gY2xvc2VkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBwZXJmb3JtIGFkZGl0aW9uYWwgY2xlYW51cCBiZWZvcmUgdGhlIHN0cmVhbSBpcyBjbG9zZWQuXHJcbiAgICAgKiBDYWxsaW5nIHN1cGVyLnRlYXJEb3duKCkgaXMgbm90IHJlcXVpcmVkLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS50ZWFyRG93biA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgIFBlcnNpc3RlbnRTdHJlYW0ucHJvdG90eXBlLmF1dGggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQodGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkluaXRpYWwsICdNdXN0IGJlIGluIGluaXRpYWwgc3RhdGUgdG8gYXV0aCcpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuU3RhcnRpbmc7XHJcbiAgICAgICAgdmFyIGRpc3BhdGNoSWZOb3RDbG9zZWQgPSB0aGlzLmdldENsb3NlR3VhcmRlZERpc3BhdGNoZXIodGhpcy5jbG9zZUNvdW50KTtcclxuICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IEp1c3QgdXNlIGRpc3BhdGNoSWZOb3RDbG9zZWQsIGJ1dCBzZWUgVE9ETyBiZWxvdy5cclxuICAgICAgICB2YXIgY2xvc2VDb3VudCA9IHRoaXMuY2xvc2VDb3VudDtcclxuICAgICAgICB0aGlzLmNyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0VG9rZW4oKS50aGVuKGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgICAgICAvLyBTdHJlYW0gY2FuIGJlIHN0b3BwZWQgd2hpbGUgd2FpdGluZyBmb3IgYXV0aGVudGljYXRpb24uXHJcbiAgICAgICAgICAgIC8vIFRPRE8obWlrZWxlaGVuKTogV2UgcmVhbGx5IHNob3VsZCBqdXN0IHVzZSBkaXNwYXRjaElmTm90Q2xvc2VkXHJcbiAgICAgICAgICAgIC8vIGFuZCBsZXQgdGhpcyBkaXNwYXRjaCBvbnRvIHRoZSBxdWV1ZSwgYnV0IHRoYXQgb3BlbmVkIGEgc3BlYyB0ZXN0IGNhblxyXG4gICAgICAgICAgICAvLyBvZiB3b3JtcyB0aGF0IEkgZG9uJ3Qgd2FudCB0byBkZWFsIHdpdGggaW4gdGhpcyBQUi5cclxuICAgICAgICAgICAgaWYgKF90aGlzLmNsb3NlQ291bnQgPT09IGNsb3NlQ291bnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIE5vcm1hbGx5IHdlJ2QgaGF2ZSB0byBzY2hlZHVsZSB0aGUgY2FsbGJhY2sgb24gdGhlIEFzeW5jUXVldWUuXHJcbiAgICAgICAgICAgICAgICAvLyBIb3dldmVyLCB0aGUgZm9sbG93aW5nIGNhbGxzIGFyZSBzYWZlIHRvIGJlIGNhbGxlZCBvdXRzaWRlIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gQXN5bmNRdWV1ZSBzaW5jZSB0aGV5IGRvbid0IGNoYWluIGFzeW5jaHJvbm91cyBjYWxsc1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuc3RhcnRTdHJlYW0odG9rZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgIGRpc3BhdGNoSWZOb3RDbG9zZWQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJwY0Vycm9yID0gbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuVU5LTk9XTiwgJ0ZldGNoaW5nIGF1dGggdG9rZW4gZmFpbGVkOiAnICsgZXJyb3IkJDEubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuaGFuZGxlU3RyZWFtQ2xvc2UocnBjRXJyb3IpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW50U3RyZWFtLnByb3RvdHlwZS5zdGFydFN0cmVhbSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5TdGFydGluZywgJ1RyeWluZyB0byBzdGFydCBzdHJlYW0gaW4gYSBub24tc3RhcnRpbmcgc3RhdGUnKTtcclxuICAgICAgICB2YXIgZGlzcGF0Y2hJZk5vdENsb3NlZCA9IHRoaXMuZ2V0Q2xvc2VHdWFyZGVkRGlzcGF0Y2hlcih0aGlzLmNsb3NlQ291bnQpO1xyXG4gICAgICAgIHRoaXMuc3RyZWFtID0gdGhpcy5zdGFydFJwYyh0b2tlbik7XHJcbiAgICAgICAgdGhpcy5zdHJlYW0ub25PcGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZGlzcGF0Y2hJZk5vdENsb3NlZChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoX3RoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5TdGFydGluZywgJ0V4cGVjdGVkIHN0cmVhbSB0byBiZSBpbiBzdGF0ZSBTdGFydGluZywgYnV0IHdhcyAnICsgX3RoaXMuc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuc3RhdGUgPSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuT3BlbjtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5saXN0ZW5lci5vbk9wZW4oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zdHJlYW0ub25DbG9zZShmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICAgICAgZGlzcGF0Y2hJZk5vdENsb3NlZChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuaGFuZGxlU3RyZWFtQ2xvc2UoZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnN0cmVhbS5vbk1lc3NhZ2UoZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgICAgICBkaXNwYXRjaElmTm90Q2xvc2VkKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5vbk1lc3NhZ2UobXNnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUucGVyZm9ybUJhY2tvZmYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQodGhpcy5zdGF0ZSA9PT0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkVycm9yLCAnU2hvdWxkIG9ubHkgcGVyZm9ybSBiYWNrb2ZmIHdoZW4gaW4gRXJyb3Igc3RhdGUnKTtcclxuICAgICAgICB0aGlzLnN0YXRlID0gUGVyc2lzdGVudFN0cmVhbVN0YXRlLkJhY2tvZmY7XHJcbiAgICAgICAgdGhpcy5iYWNrb2ZmLmJhY2tvZmZBbmRSdW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KHRoaXMuc3RhdGUgPT09IFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5CYWNrb2ZmLCAnQmFja29mZiBlbGFwc2VkIGJ1dCBzdGF0ZSBpcyBub3c6ICcgKyB0aGlzLnN0YXRlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcclxuICAgICAgICAgICAgICAgIGFzc2VydCh0aGlzLmlzU3RhcnRlZCgpLCAnUGVyc2lzdGVudFN0cmVhbSBzaG91bGQgaGF2ZSBzdGFydGVkJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyB9KTtcclxuICAgIH07XHJcbiAgICAvLyBWaXNpYmxlIGZvciB0ZXN0c1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuaGFuZGxlU3RyZWFtQ2xvc2UgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5pc1N0YXJ0ZWQoKSwgXCJDYW4ndCBoYW5kbGUgc2VydmVyIGNsb3NlIG9uIG5vbi1zdGFydGVkIHN0cmVhbVwiKTtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDYsIFwiY2xvc2Ugd2l0aCBlcnJvcjogXCIgKyBlcnJvciQkMSk7XHJcbiAgICAgICAgdGhpcy5zdHJlYW0gPSBudWxsO1xyXG4gICAgICAgIC8vIEluIHRoZW9yeSB0aGUgc3RyZWFtIGNvdWxkIGNsb3NlIGNsZWFubHksIGhvd2V2ZXIsIGluIG91ciBjdXJyZW50IG1vZGVsXHJcbiAgICAgICAgLy8gd2UgbmV2ZXIgZXhwZWN0IHRoaXMgdG8gaGFwcGVuIGJlY2F1c2UgaWYgd2Ugc3RvcCBhIHN0cmVhbSBvdXJzZWx2ZXMsXHJcbiAgICAgICAgLy8gdGhpcyBjYWxsYmFjayB3aWxsIG5ldmVyIGJlIGNhbGxlZC4gVG8gcHJldmVudCBjYXNlcyB3aGVyZSB3ZSByZXRyeVxyXG4gICAgICAgIC8vIHdpdGhvdXQgYSBiYWNrb2ZmIGFjY2lkZW50YWxseSwgd2Ugc2V0IHRoZSBzdHJlYW0gdG8gZXJyb3IgaW4gYWxsIGNhc2VzLlxyXG4gICAgICAgIHJldHVybiB0aGlzLmNsb3NlKFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5FcnJvciwgZXJyb3IkJDEpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIFwiZGlzcGF0Y2hlclwiIGZ1bmN0aW9uIHRoYXQgZGlzcGF0Y2hlcyBvcGVyYXRpb25zIG9udG8gdGhlXHJcbiAgICAgKiBBc3luY1F1ZXVlIGJ1dCBvbmx5IHJ1bnMgdGhlbSBpZiBjbG9zZUNvdW50IHJlbWFpbnMgdW5jaGFuZ2VkLiBUaGlzIGFsbG93c1xyXG4gICAgICogdXMgdG8gdHVybiBhdXRoIC8gc3RyZWFtIGNhbGxiYWNrcyBpbnRvIG5vLW9wcyBpZiB0aGUgc3RyZWFtIGlzIGNsb3NlZCAvXHJcbiAgICAgKiByZS1vcGVuZWQsIGV0Yy5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFN0cmVhbS5wcm90b3R5cGUuZ2V0Q2xvc2VHdWFyZGVkRGlzcGF0Y2hlciA9IGZ1bmN0aW9uIChzdGFydENsb3NlQ291bnQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICAgICAgX3RoaXMucXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY2xvc2VDb3VudCA9PT0gc3RhcnRDbG9zZUNvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDYsICdzdHJlYW0gY2FsbGJhY2sgc2tpcHBlZCBieSBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGVyc2lzdGVudFN0cmVhbTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSB0aGF0IGltcGxlbWVudHMgdGhlIExpc3RlbiBSUEMuXHJcbiAqXHJcbiAqIE9uY2UgdGhlIExpc3RlbiBzdHJlYW0gaGFzIGNhbGxlZCB0aGUgb25PcGVuKCkgbGlzdGVuZXIsIGFueSBudW1iZXIgb2ZcclxuICogbGlzdGVuKCkgYW5kIHVubGlzdGVuKCkgY2FsbHMgY2FuIGJlIG1hZGUgdG8gY29udHJvbCB3aGF0IGNoYW5nZXMgd2lsbCBiZVxyXG4gKiBzZW50IGZyb20gdGhlIHNlcnZlciBmb3IgTGlzdGVuUmVzcG9uc2VzLlxyXG4gKi9cclxudmFyIFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhQZXJzaXN0ZW50TGlzdGVuU3RyZWFtLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUGVyc2lzdGVudExpc3RlblN0cmVhbShxdWV1ZSwgY29ubmVjdGlvbiwgY3JlZGVudGlhbHMsIHNlcmlhbGl6ZXIsIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcXVldWUsIFRpbWVySWQuTGlzdGVuU3RyZWFtQ29ubmVjdGlvbkJhY2tvZmYsIFRpbWVySWQuTGlzdGVuU3RyZWFtSWRsZSwgY29ubmVjdGlvbiwgY3JlZGVudGlhbHMsIGxpc3RlbmVyKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW0ucHJvdG90eXBlLnN0YXJ0UnBjID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbi5vcGVuU3RyZWFtKCdMaXN0ZW4nLCB0b2tlbik7XHJcbiAgICB9O1xyXG4gICAgUGVyc2lzdGVudExpc3RlblN0cmVhbS5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24gKHdhdGNoQ2hhbmdlUHJvdG8pIHtcclxuICAgICAgICAvLyBBIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgbWVhbnMgdGhlIHN0cmVhbSBpcyBoZWFsdGh5XHJcbiAgICAgICAgdGhpcy5iYWNrb2ZmLnJlc2V0KCk7XHJcbiAgICAgICAgdmFyIHdhdGNoQ2hhbmdlID0gdGhpcy5zZXJpYWxpemVyLmZyb21XYXRjaENoYW5nZSh3YXRjaENoYW5nZVByb3RvKTtcclxuICAgICAgICB2YXIgc25hcHNob3QgPSB0aGlzLnNlcmlhbGl6ZXIudmVyc2lvbkZyb21MaXN0ZW5SZXNwb25zZSh3YXRjaENoYW5nZVByb3RvKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5saXN0ZW5lci5vbldhdGNoQ2hhbmdlKHdhdGNoQ2hhbmdlLCBzbmFwc2hvdCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlcnMgaW50ZXJlc3QgaW4gdGhlIHJlc3VsdHMgb2YgdGhlIGdpdmVuIHF1ZXJ5LiBJZiB0aGUgcXVlcnlcclxuICAgICAqIGluY2x1ZGVzIGEgcmVzdW1lVG9rZW4gaXQgd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgcmVxdWVzdC4gUmVzdWx0cyB0aGF0XHJcbiAgICAgKiBhZmZlY3QgdGhlIHF1ZXJ5IHdpbGwgYmUgc3RyZWFtZWQgYmFjayBhcyBXYXRjaENoYW5nZSBtZXNzYWdlcyB0aGF0XHJcbiAgICAgKiByZWZlcmVuY2UgdGhlIHRhcmdldElkLlxyXG4gICAgICovXHJcbiAgICBQZXJzaXN0ZW50TGlzdGVuU3RyZWFtLnByb3RvdHlwZS53YXRjaCA9IGZ1bmN0aW9uIChxdWVyeURhdGEpIHtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHt9O1xyXG4gICAgICAgIHJlcXVlc3QuZGF0YWJhc2UgPSB0aGlzLnNlcmlhbGl6ZXIuZW5jb2RlZERhdGFiYXNlSWQ7XHJcbiAgICAgICAgcmVxdWVzdC5hZGRUYXJnZXQgPSB0aGlzLnNlcmlhbGl6ZXIudG9UYXJnZXQocXVlcnlEYXRhKTtcclxuICAgICAgICB2YXIgbGFiZWxzID0gdGhpcy5zZXJpYWxpemVyLnRvTGlzdGVuUmVxdWVzdExhYmVscyhxdWVyeURhdGEpO1xyXG4gICAgICAgIGlmIChsYWJlbHMpIHtcclxuICAgICAgICAgICAgcmVxdWVzdC5sYWJlbHMgPSBsYWJlbHM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VuZFJlcXVlc3QocmVxdWVzdCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVbnJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgcXVlcnkgYXNzb2NpYXRlZCB3aXRoIHRoZVxyXG4gICAgICogZ2l2ZW4gdGFyZ2V0SWQuXHJcbiAgICAgKi9cclxuICAgIFBlcnNpc3RlbnRMaXN0ZW5TdHJlYW0ucHJvdG90eXBlLnVud2F0Y2ggPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHt9O1xyXG4gICAgICAgIHJlcXVlc3QuZGF0YWJhc2UgPSB0aGlzLnNlcmlhbGl6ZXIuZW5jb2RlZERhdGFiYXNlSWQ7XHJcbiAgICAgICAgcmVxdWVzdC5yZW1vdmVUYXJnZXQgPSB0YXJnZXRJZDtcclxuICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQZXJzaXN0ZW50TGlzdGVuU3RyZWFtO1xyXG59KFBlcnNpc3RlbnRTdHJlYW0pKTtcclxuLyoqXHJcbiAqIEEgU3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgV3JpdGUgUlBDLlxyXG4gKlxyXG4gKiBUaGUgV3JpdGUgUlBDIHJlcXVpcmVzIHRoZSBjYWxsZXIgdG8gbWFpbnRhaW4gc3BlY2lhbCBzdHJlYW1Ub2tlblxyXG4gKiBzdGF0ZSBpbiBiZXR3ZWVuIGNhbGxzLCB0byBoZWxwIHRoZSBzZXJ2ZXIgdW5kZXJzdGFuZCB3aGljaCByZXNwb25zZXMgdGhlXHJcbiAqIGNsaWVudCBoYXMgcHJvY2Vzc2VkIGJ5IHRoZSB0aW1lIHRoZSBuZXh0IHJlcXVlc3QgaXMgbWFkZS4gRXZlcnkgcmVzcG9uc2VcclxuICogd2lsbCBjb250YWluIGEgc3RyZWFtVG9rZW47IHRoaXMgdmFsdWUgbXVzdCBiZSBwYXNzZWQgdG8gdGhlIG5leHRcclxuICogcmVxdWVzdC5cclxuICpcclxuICogQWZ0ZXIgY2FsbGluZyBzdGFydCgpIG9uIHRoaXMgc3RyZWFtLCB0aGUgbmV4dCByZXF1ZXN0IG11c3QgYmUgYSBoYW5kc2hha2UsXHJcbiAqIGNvbnRhaW5pbmcgd2hhdGV2ZXIgc3RyZWFtVG9rZW4gaXMgb24gaGFuZC4gT25jZSBhIHJlc3BvbnNlIHRvIHRoaXNcclxuICogcmVxdWVzdCBpcyByZWNlaXZlZCwgYWxsIHBlbmRpbmcgbXV0YXRpb25zIG1heSBiZSBzdWJtaXR0ZWQuIFdoZW5cclxuICogc3VibWl0dGluZyBtdWx0aXBsZSBiYXRjaGVzIG9mIG11dGF0aW9ucyBhdCB0aGUgc2FtZSB0aW1lLCBpdCdzXHJcbiAqIG9rYXkgdG8gdXNlIHRoZSBzYW1lIHN0cmVhbVRva2VuIGZvciB0aGUgY2FsbHMgdG8gd3JpdGVNdXRhdGlvbnMuXHJcbiAqXHJcbiAqIFRPRE8oYi8zMzI3MTIzNSk6IFVzZSBwcm90byB0eXBlc1xyXG4gKi9cclxudmFyIFBlcnNpc3RlbnRXcml0ZVN0cmVhbSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFBlcnNpc3RlbnRXcml0ZVN0cmVhbSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFBlcnNpc3RlbnRXcml0ZVN0cmVhbShxdWV1ZSwgY29ubmVjdGlvbiwgY3JlZGVudGlhbHMsIHNlcmlhbGl6ZXIsIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcXVldWUsIFRpbWVySWQuV3JpdGVTdHJlYW1Db25uZWN0aW9uQmFja29mZiwgVGltZXJJZC5Xcml0ZVN0cmVhbUlkbGUsIGNvbm5lY3Rpb24sIGNyZWRlbnRpYWxzLCBsaXN0ZW5lcikgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgICAgICBfdGhpcy5oYW5kc2hha2VDb21wbGV0ZV8gPSBmYWxzZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGVyc2lzdGVudFdyaXRlU3RyZWFtLnByb3RvdHlwZSwgXCJoYW5kc2hha2VDb21wbGV0ZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVHJhY2tzIHdoZXRoZXIgb3Igbm90IGEgaGFuZHNoYWtlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBleGNoYW5nZWQgYW5kXHJcbiAgICAgICAgICogdGhlIHN0cmVhbSBpcyByZWFkeSB0byBhY2NlcHQgbXV0YXRpb25zLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oYW5kc2hha2VDb21wbGV0ZV87XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvLyBPdmVycmlkZSBvZiBQZXJzaXN0ZW50U3RyZWFtLnN0YXJ0XHJcbiAgICBQZXJzaXN0ZW50V3JpdGVTdHJlYW0ucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuaGFuZHNoYWtlQ29tcGxldGVfID0gZmFsc2U7XHJcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zdGFydC5jYWxsKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIFBlcnNpc3RlbnRXcml0ZVN0cmVhbS5wcm90b3R5cGUudGVhckRvd24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFuZHNoYWtlQ29tcGxldGVfKSB7XHJcbiAgICAgICAgICAgIHRoaXMud3JpdGVNdXRhdGlvbnMoW10pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW50V3JpdGVTdHJlYW0ucHJvdG90eXBlLnN0YXJ0UnBjID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbi5vcGVuU3RyZWFtKCdXcml0ZScsIHRva2VuKTtcclxuICAgIH07XHJcbiAgICBQZXJzaXN0ZW50V3JpdGVTdHJlYW0ucHJvdG90eXBlLm9uTWVzc2FnZSA9IGZ1bmN0aW9uIChyZXNwb25zZVByb3RvKSB7XHJcbiAgICAgICAgLy8gQWx3YXlzIGNhcHR1cmUgdGhlIGxhc3Qgc3RyZWFtIHRva2VuLlxyXG4gICAgICAgIGFzc2VydCghIXJlc3BvbnNlUHJvdG8uc3RyZWFtVG9rZW4sICdHb3QgYSB3cml0ZSByZXNwb25zZSB3aXRob3V0IGEgc3RyZWFtIHRva2VuJyk7XHJcbiAgICAgICAgdGhpcy5sYXN0U3RyZWFtVG9rZW4gPSByZXNwb25zZVByb3RvLnN0cmVhbVRva2VuO1xyXG4gICAgICAgIGlmICghdGhpcy5oYW5kc2hha2VDb21wbGV0ZV8pIHtcclxuICAgICAgICAgICAgLy8gVGhlIGZpcnN0IHJlc3BvbnNlIGlzIGFsd2F5cyB0aGUgaGFuZHNoYWtlIHJlc3BvbnNlXHJcbiAgICAgICAgICAgIGFzc2VydCghcmVzcG9uc2VQcm90by53cml0ZVJlc3VsdHMgfHwgcmVzcG9uc2VQcm90by53cml0ZVJlc3VsdHMubGVuZ3RoID09PSAwLCAnR290IG11dGF0aW9uIHJlc3VsdHMgZm9yIGhhbmRzaGFrZScpO1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRzaGFrZUNvbXBsZXRlXyA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVyLm9uSGFuZHNoYWtlQ29tcGxldGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEEgc3VjY2Vzc2Z1bCBmaXJzdCB3cml0ZSByZXNwb25zZSBtZWFucyB0aGUgc3RyZWFtIGlzIGhlYWx0aHksXHJcbiAgICAgICAgICAgIC8vIE5vdGUsIHRoYXQgd2UgY291bGQgY29uc2lkZXIgYSBzdWNjZXNzZnVsIGhhbmRzaGFrZSBoZWFsdGh5LCBob3dldmVyLFxyXG4gICAgICAgICAgICAvLyB0aGUgd3JpdGUgaXRzZWxmIG1pZ2h0IGJlIGNhdXNpbmcgYW4gZXJyb3Igd2Ugd2FudCB0byBiYWNrIG9mZiBmcm9tLlxyXG4gICAgICAgICAgICB0aGlzLmJhY2tvZmYucmVzZXQoKTtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSB0aGlzLnNlcmlhbGl6ZXIuZnJvbVdyaXRlUmVzdWx0cyhyZXNwb25zZVByb3RvLndyaXRlUmVzdWx0cywgcmVzcG9uc2VQcm90by5jb21taXRUaW1lKTtcclxuICAgICAgICAgICAgdmFyIGNvbW1pdFZlcnNpb24gPSB0aGlzLnNlcmlhbGl6ZXIuZnJvbVZlcnNpb24ocmVzcG9uc2VQcm90by5jb21taXRUaW1lKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIub25NdXRhdGlvblJlc3VsdChjb21taXRWZXJzaW9uLCByZXN1bHRzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTZW5kcyBhbiBpbml0aWFsIHN0cmVhbVRva2VuIHRvIHRoZSBzZXJ2ZXIsIHBlcmZvcm1pbmcgdGhlIGhhbmRzaGFrZVxyXG4gICAgICogcmVxdWlyZWQgdG8gbWFrZSB0aGUgU3RyZWFtaW5nV3JpdGUgUlBDIHdvcmsuIFN1YnNlcXVlbnRcclxuICAgICAqIGNhbGxzIHNob3VsZCB3YWl0IHVudGlsIG9uSGFuZHNoYWtlQ29tcGxldGUgd2FzIGNhbGxlZC5cclxuICAgICAqL1xyXG4gICAgUGVyc2lzdGVudFdyaXRlU3RyZWFtLnByb3RvdHlwZS53cml0ZUhhbmRzaGFrZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5pc09wZW4oKSwgJ1dyaXRpbmcgaGFuZHNoYWtlIHJlcXVpcmVzIGFuIG9wZW5lZCBzdHJlYW0nKTtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuaGFuZHNoYWtlQ29tcGxldGVfLCAnSGFuZHNoYWtlIGFscmVhZHkgY29tcGxldGVkJyk7XHJcbiAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBTdXBwb3J0IHN0cmVhbSByZXN1bXB0aW9uLiBXZSBpbnRlbnRpb25hbGx5IGRvIG5vdCBzZXQgdGhlXHJcbiAgICAgICAgLy8gc3RyZWFtIHRva2VuIG9uIHRoZSBoYW5kc2hha2UsIGlnbm9yaW5nIGFueSBzdHJlYW0gdG9rZW4gd2UgbWlnaHQgaGF2ZS5cclxuICAgICAgICB2YXIgcmVxdWVzdCA9IHt9O1xyXG4gICAgICAgIHJlcXVlc3QuZGF0YWJhc2UgPSB0aGlzLnNlcmlhbGl6ZXIuZW5jb2RlZERhdGFiYXNlSWQ7XHJcbiAgICAgICAgdGhpcy5zZW5kUmVxdWVzdChyZXF1ZXN0KTtcclxuICAgIH07XHJcbiAgICAvKiogU2VuZHMgYSBncm91cCBvZiBtdXRhdGlvbnMgdG8gdGhlIEZpcmVzdG9yZSBiYWNrZW5kIHRvIGFwcGx5LiAqL1xyXG4gICAgUGVyc2lzdGVudFdyaXRlU3RyZWFtLnByb3RvdHlwZS53cml0ZU11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmlzT3BlbigpLCAnV3JpdGluZyBtdXRhdGlvbnMgcmVxdWlyZXMgYW4gb3BlbmVkIHN0cmVhbScpO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmhhbmRzaGFrZUNvbXBsZXRlXywgJ0hhbmRzaGFrZSBtdXN0IGJlIGNvbXBsZXRlIGJlZm9yZSB3cml0aW5nIG11dGF0aW9ucycpO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmxhc3RTdHJlYW1Ub2tlbi5sZW5ndGggPiAwLCAnVHJ5aW5nIHRvIHdyaXRlIG11dGF0aW9uIHdpdGhvdXQgYSB0b2tlbicpO1xyXG4gICAgICAgIHZhciByZXF1ZXN0ID0ge1xyXG4gICAgICAgICAgICAvLyBQcm90b3MgYXJlIHR5cGVkIHdpdGggc3RyaW5nLCBidXQgd2Ugc3VwcG9ydCBVSW50OEFycmF5IG9uIE5vZGVcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG4gICAgICAgICAgICBzdHJlYW1Ub2tlbjogdGhpcy5sYXN0U3RyZWFtVG9rZW4sXHJcbiAgICAgICAgICAgIHdyaXRlczogbXV0YXRpb25zLm1hcChmdW5jdGlvbiAobXV0YXRpb24pIHsgcmV0dXJuIF90aGlzLnNlcmlhbGl6ZXIudG9NdXRhdGlvbihtdXRhdGlvbik7IH0pXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnNlbmRSZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBQZXJzaXN0ZW50V3JpdGVTdHJlYW07XHJcbn0oUGVyc2lzdGVudFN0cmVhbSkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERhdGFzdG9yZSBpcyBhIHdyYXBwZXIgYXJvdW5kIHRoZSBleHRlcm5hbCBHb29nbGUgQ2xvdWQgRGF0YXN0b3JlIGdycGMgQVBJLFxyXG4gKiB3aGljaCBwcm92aWRlcyBhbiBpbnRlcmZhY2UgdGhhdCBpcyBtb3JlIGNvbnZlbmllbnQgZm9yIHRoZSByZXN0IG9mIHRoZVxyXG4gKiBjbGllbnQgU0RLIGFyY2hpdGVjdHVyZSB0byBjb25zdW1lLlxyXG4gKi9cclxudmFyIERhdGFzdG9yZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERhdGFzdG9yZShxdWV1ZSwgY29ubmVjdGlvbiwgY3JlZGVudGlhbHMsIHNlcmlhbGl6ZXIpIHtcclxuICAgICAgICB0aGlzLnF1ZXVlID0gcXVldWU7XHJcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcclxuICAgICAgICB0aGlzLmNyZWRlbnRpYWxzID0gY3JlZGVudGlhbHM7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgIH1cclxuICAgIERhdGFzdG9yZS5wcm90b3R5cGUubmV3UGVyc2lzdGVudFdyaXRlU3RyZWFtID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW50V3JpdGVTdHJlYW0odGhpcy5xdWV1ZSwgdGhpcy5jb25uZWN0aW9uLCB0aGlzLmNyZWRlbnRpYWxzLCB0aGlzLnNlcmlhbGl6ZXIsIGxpc3RlbmVyKTtcclxuICAgIH07XHJcbiAgICBEYXRhc3RvcmUucHJvdG90eXBlLm5ld1BlcnNpc3RlbnRXYXRjaFN0cmVhbSA9IGZ1bmN0aW9uIChsaXN0ZW5lcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVudExpc3RlblN0cmVhbSh0aGlzLnF1ZXVlLCB0aGlzLmNvbm5lY3Rpb24sIHRoaXMuY3JlZGVudGlhbHMsIHRoaXMuc2VyaWFsaXplciwgbGlzdGVuZXIpO1xyXG4gICAgfTtcclxuICAgIERhdGFzdG9yZS5wcm90b3R5cGUuY29tbWl0ID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IHtcclxuICAgICAgICAgICAgZGF0YWJhc2U6IHRoaXMuc2VyaWFsaXplci5lbmNvZGVkRGF0YWJhc2VJZCxcclxuICAgICAgICAgICAgd3JpdGVzOiBtdXRhdGlvbnMubWFwKGZ1bmN0aW9uIChtKSB7IHJldHVybiBfdGhpcy5zZXJpYWxpemVyLnRvTXV0YXRpb24obSk7IH0pXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnZva2VSUEMoJ0NvbW1pdCcsIHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnNlcmlhbGl6ZXIuZnJvbVdyaXRlUmVzdWx0cyhyZXNwb25zZS53cml0ZVJlc3VsdHMsIHJlc3BvbnNlLmNvbW1pdFRpbWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIERhdGFzdG9yZS5wcm90b3R5cGUubG9va3VwID0gZnVuY3Rpb24gKGtleXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgIGRhdGFiYXNlOiB0aGlzLnNlcmlhbGl6ZXIuZW5jb2RlZERhdGFiYXNlSWQsXHJcbiAgICAgICAgICAgIGRvY3VtZW50czoga2V5cy5tYXAoZnVuY3Rpb24gKGspIHsgcmV0dXJuIF90aGlzLnNlcmlhbGl6ZXIudG9OYW1lKGspOyB9KVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW52b2tlU3RyZWFtaW5nUlBDKCdCYXRjaEdldERvY3VtZW50cycsIHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgdmFyIGRvY3MgPSBtYXliZURvY3VtZW50TWFwKCk7XHJcbiAgICAgICAgICAgIHJlc3BvbnNlLmZvckVhY2goZnVuY3Rpb24gKHByb3RvKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jID0gX3RoaXMuc2VyaWFsaXplci5mcm9tTWF5YmVEb2N1bWVudChwcm90byk7XHJcbiAgICAgICAgICAgICAgICBkb2NzID0gZG9jcy5pbnNlcnQoZG9jLmtleSwgZG9jKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2MgPSBkb2NzLmdldChrZXkpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KCEhZG9jLCAnTWlzc2luZyBlbnRpdHkgaW4gd3JpdGUgcmVzcG9uc2UgZm9yICcgKyBrZXkpO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goZG9jKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIEdldHMgYW4gYXV0aCB0b2tlbiBhbmQgaW52b2tlcyB0aGUgcHJvdmlkZWQgUlBDLiAqL1xyXG4gICAgRGF0YXN0b3JlLnByb3RvdHlwZS5pbnZva2VSUEMgPSBmdW5jdGlvbiAocnBjTmFtZSwgcmVxdWVzdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlZGVudGlhbHNcclxuICAgICAgICAgICAgLmdldFRva2VuKClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5jb25uZWN0aW9uLmludm9rZVJQQyhycGNOYW1lLCByZXF1ZXN0LCB0b2tlbik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gQ29kZS5VTkFVVEhFTlRJQ0FURUQpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNyZWRlbnRpYWxzLmludmFsaWRhdGVUb2tlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBHZXRzIGFuIGF1dGggdG9rZW4gYW5kIGludm9rZXMgdGhlIHByb3ZpZGVkIFJQQyB3aXRoIHN0cmVhbWVkIHJlc3VsdHMuICovXHJcbiAgICBEYXRhc3RvcmUucHJvdG90eXBlLmludm9rZVN0cmVhbWluZ1JQQyA9IGZ1bmN0aW9uIChycGNOYW1lLCByZXF1ZXN0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5jcmVkZW50aWFsc1xyXG4gICAgICAgICAgICAuZ2V0VG9rZW4oKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNvbm5lY3Rpb24uaW52b2tlU3RyZWFtaW5nUlBDKHJwY05hbWUsIHJlcXVlc3QsIHRva2VuKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvci5jb2RlID09PSBDb2RlLlVOQVVUSEVOVElDQVRFRCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuY3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERhdGFzdG9yZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBJbnRlcm5hbCB0cmFuc2FjdGlvbiBvYmplY3QgcmVzcG9uc2libGUgZm9yIGFjY3VtdWxhdGluZyB0aGUgbXV0YXRpb25zIHRvXHJcbiAqIHBlcmZvcm0gYW5kIHRoZSBiYXNlIHZlcnNpb25zIGZvciBhbnkgZG9jdW1lbnRzIHJlYWQuXHJcbiAqL1xyXG52YXIgVHJhbnNhY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUcmFuc2FjdGlvbihkYXRhc3RvcmUpIHtcclxuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IGRhdGFzdG9yZTtcclxuICAgICAgICAvLyBUaGUgdmVyc2lvbiBvZiBlYWNoIGRvY3VtZW50IHRoYXQgd2FzIHJlYWQgZHVyaW5nIHRoaXMgdHJhbnNhY3Rpb24uXHJcbiAgICAgICAgdGhpcy5yZWFkVmVyc2lvbnMgPSBkb2N1bWVudFZlcnNpb25NYXAoKTtcclxuICAgICAgICB0aGlzLm11dGF0aW9ucyA9IFtdO1xyXG4gICAgICAgIHRoaXMuY29tbWl0dGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUucmVjb3JkVmVyc2lvbiA9IGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICB2YXIgZG9jVmVyc2lvbjtcclxuICAgICAgICBpZiAoZG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgZG9jVmVyc2lvbiA9IGRvYy52ZXJzaW9uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkb2MgaW5zdGFuY2VvZiBOb0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgIC8vIEZvciBkZWxldGVkIGRvY3MsIHdlIG11c3QgdXNlIGJhc2VWZXJzaW9uIDAgd2hlbiB3ZSBvdmVyd3JpdGUgdGhlbS5cclxuICAgICAgICAgICAgZG9jVmVyc2lvbiA9IFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBmYWlsKCdEb2N1bWVudCBpbiBhIHRyYW5zYWN0aW9uIHdhcyBhICcgKyBkb2MuY29uc3RydWN0b3IubmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBleGlzdGluZ1ZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQoZG9jLmtleSk7XHJcbiAgICAgICAgaWYgKGV4aXN0aW5nVmVyc2lvbiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAoIWRvY1ZlcnNpb24uaXNFcXVhbChleGlzdGluZ1ZlcnNpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHRyYW5zYWN0aW9uIHdpbGwgZmFpbCBubyBtYXR0ZXIgd2hhdC5cclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkFCT1JURUQsICdEb2N1bWVudCB2ZXJzaW9uIGNoYW5nZWQgYmV0d2VlbiB0d28gcmVhZHMuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVhZFZlcnNpb25zID0gdGhpcy5yZWFkVmVyc2lvbnMuaW5zZXJ0KGRvYy5rZXksIGRvY1ZlcnNpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUubG9va3VwID0gZnVuY3Rpb24gKGtleXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbW1pdHRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ1RyYW5zYWN0aW9uIGhhcyBhbHJlYWR5IGNvbXBsZXRlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMubXV0YXRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdUcmFuc2FjdGlvbnMgbG9va3VwcyBhcmUgaW52YWxpZCBhZnRlciB3cml0ZXMuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFzdG9yZS5sb29rdXAoa2V5cykudGhlbihmdW5jdGlvbiAoZG9jcykge1xyXG4gICAgICAgICAgICBkb2NzLmZvckVhY2goZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRvYyBpbnN0YW5jZW9mIE5vRG9jdW1lbnQgfHwgZG9jIGluc3RhbmNlb2YgRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZWNvcmRWZXJzaW9uKGRvYyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmYWlsKCdEb2N1bWVudCBpbiBhIHRyYW5zYWN0aW9uIHdhcyBhICcgKyBkb2MuY29uc3RydWN0b3IubmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZG9jcztcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAobXV0YXRpb25zKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29tbWl0dGVkKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04sICdUcmFuc2FjdGlvbiBoYXMgYWxyZWFkeSBjb21wbGV0ZWQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubXV0YXRpb25zID0gdGhpcy5tdXRhdGlvbnMuY29uY2F0KG11dGF0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSB2ZXJzaW9uIG9mIHRoaXMgZG9jdW1lbnQgd2hlbiBpdCB3YXMgcmVhZCBpbiB0aGlzIHRyYW5zYWN0aW9uLFxyXG4gICAgICogYXMgYSBwcmVjb25kaXRpb24sIG9yIG5vIHByZWNvbmRpdGlvbiBpZiBpdCB3YXMgbm90IHJlYWQuXHJcbiAgICAgKi9cclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5wcmVjb25kaXRpb24gPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQoa2V5KTtcclxuICAgICAgICBpZiAodmVyc2lvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJlY29uZGl0aW9uLnVwZGF0ZVRpbWUodmVyc2lvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJlY29uZGl0aW9uLk5PTkU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgcHJlY29uZGl0aW9uIGZvciBhIGRvY3VtZW50IGlmIHRoZSBvcGVyYXRpb24gaXMgYW4gdXBkYXRlLlxyXG4gICAgICovXHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUucHJlY29uZGl0aW9uRm9yVXBkYXRlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciB2ZXJzaW9uID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KGtleSk7XHJcbiAgICAgICAgaWYgKHZlcnNpb24gJiYgdmVyc2lvbi5pc0VxdWFsKFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCkpKSB7XHJcbiAgICAgICAgICAgIC8vIFRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LCBzbyBmYWlsIHRoZSB0cmFuc2FjdGlvbi5cclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJDYW4ndCB1cGRhdGUgYSBkb2N1bWVudCB0aGF0IGRvZXNuJ3QgZXhpc3QuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgICAgIC8vIERvY3VtZW50IGV4aXN0cywgYmFzZSBwcmVjb25kaXRpb24gb24gZG9jdW1lbnQgdXBkYXRlIHRpbWUuXHJcbiAgICAgICAgICAgIHJldHVybiBQcmVjb25kaXRpb24udXBkYXRlVGltZSh2ZXJzaW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIERvY3VtZW50IHdhcyBub3QgcmVhZCwgc28gd2UganVzdCB1c2UgdGhlIHByZWNvbmRpdGlvbnMgZm9yIGEgYmxpbmRcclxuICAgICAgICAgICAgLy8gdXBkYXRlLlxyXG4gICAgICAgICAgICByZXR1cm4gUHJlY29uZGl0aW9uLmV4aXN0cyh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChrZXksIGRhdGEpIHtcclxuICAgICAgICB0aGlzLndyaXRlKGRhdGEudG9NdXRhdGlvbnMoa2V5LCB0aGlzLnByZWNvbmRpdGlvbihrZXkpKSk7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChrZXksIGRhdGEpIHtcclxuICAgICAgICB0aGlzLndyaXRlKGRhdGEudG9NdXRhdGlvbnMoa2V5LCB0aGlzLnByZWNvbmRpdGlvbkZvclVwZGF0ZShrZXkpKSk7XHJcbiAgICB9O1xyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB0aGlzLndyaXRlKFtuZXcgRGVsZXRlTXV0YXRpb24oa2V5LCB0aGlzLnByZWNvbmRpdGlvbihrZXkpKV0pO1xyXG4gICAgICAgIC8vIFNpbmNlIHRoZSBkZWxldGUgd2lsbCBiZSBhcHBsaWVkIGJlZm9yZSBhbGwgZm9sbG93aW5nIHdyaXRlcywgd2UgbmVlZCB0b1xyXG4gICAgICAgIC8vIGVuc3VyZSB0aGF0IHRoZSBwcmVjb25kaXRpb24gZm9yIHRoZSBuZXh0IHdyaXRlIHdpbGwgYmUgZXhpc3RzOiBmYWxzZS5cclxuICAgICAgICB0aGlzLnJlYWRWZXJzaW9ucyA9IHRoaXMucmVhZFZlcnNpb25zLmluc2VydChrZXksIFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCkpO1xyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5jb21taXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdW53cml0dGVuID0gdGhpcy5yZWFkVmVyc2lvbnM7XHJcbiAgICAgICAgLy8gRm9yIGVhY2ggbXV0YXRpb24sIG5vdGUgdGhhdCB0aGUgZG9jIHdhcyB3cml0dGVuLlxyXG4gICAgICAgIHRoaXMubXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHVud3JpdHRlbiA9IHVud3JpdHRlbi5yZW1vdmUobXV0YXRpb24ua2V5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoIXVud3JpdHRlbi5pc0VtcHR5KCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KEVycm9yKCdFdmVyeSBkb2N1bWVudCByZWFkIGluIGEgdHJhbnNhY3Rpb24gbXVzdCBhbHNvIGJlIHdyaXR0ZW4uJykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhc3RvcmUuY29tbWl0KHRoaXMubXV0YXRpb25zKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMuY29tbWl0dGVkID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVHJhbnNhY3Rpb247XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRGVzY3JpYmVzIHRoZSBvbmxpbmUgc3RhdGUgb2YgdGhlIEZpcmVzdG9yZSBjbGllbnQuIE5vdGUgdGhhdCB0aGlzIGRvZXMgbm90XHJcbiAqIGluZGljYXRlIHdoZXRoZXIgb3Igbm90IHRoZSByZW1vdGUgc3RvcmUgaXMgdHJ5aW5nIHRvIGNvbm5lY3Qgb3Igbm90LiBUaGlzIGlzXHJcbiAqIHByaW1hcmlseSB1c2VkIGJ5IHRoZSBWaWV3IC8gRXZlbnRNYW5hZ2VyIGNvZGUgdG8gY2hhbmdlIHRoZWlyIGJlaGF2aW9yIHdoaWxlXHJcbiAqIG9mZmxpbmUgKGUuZy4gZ2V0KCkgY2FsbHMgc2hvdWxkbid0IHdhaXQgZm9yIGRhdGEgZnJvbSB0aGUgc2VydmVyIGFuZFxyXG4gKiBzbmFwc2hvdCBldmVudHMgc2hvdWxkIHNldCBtZXRhZGF0YS5pc0Zyb21DYWNoZT10cnVlKS5cclxuICovXHJcbnZhciBPbmxpbmVTdGF0ZTtcclxuKGZ1bmN0aW9uIChPbmxpbmVTdGF0ZSkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgRmlyZXN0b3JlIGNsaWVudCBpcyBpbiBhbiB1bmtub3duIG9ubGluZSBzdGF0ZS4gVGhpcyBtZWFucyB0aGUgY2xpZW50XHJcbiAgICAgKiBpcyBlaXRoZXIgbm90IGFjdGl2ZWx5IHRyeWluZyB0byBlc3RhYmxpc2ggYSBjb25uZWN0aW9uIG9yIGl0IGlzIGN1cnJlbnRseVxyXG4gICAgICogdHJ5aW5nIHRvIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24sIGJ1dCBpdCBoYXMgbm90IHN1Y2NlZWRlZCBvciBmYWlsZWQgeWV0LlxyXG4gICAgICogSGlnaGVyLWxldmVsIGNvbXBvbmVudHMgc2hvdWxkIG5vdCBvcGVyYXRlIGluIG9mZmxpbmUgbW9kZS5cclxuICAgICAqL1xyXG4gICAgT25saW5lU3RhdGVbT25saW5lU3RhdGVbXCJVbmtub3duXCJdID0gMF0gPSBcIlVua25vd25cIjtcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGNsaWVudCBpcyBjb25uZWN0ZWQgYW5kIHRoZSBjb25uZWN0aW9ucyBhcmUgaGVhbHRoeS4gVGhpcyBzdGF0ZSBpc1xyXG4gICAgICogcmVhY2hlZCBhZnRlciBhIHN1Y2Nlc3NmdWwgY29ubmVjdGlvbiBhbmQgdGhlcmUgaGFzIGJlZW4gYXQgbGVhc3Qgb25lXHJcbiAgICAgKiBzdWNjZXNzZnVsIG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSB0aGUgYmFja2VuZHMuXHJcbiAgICAgKi9cclxuICAgIE9ubGluZVN0YXRlW09ubGluZVN0YXRlW1wiT25saW5lXCJdID0gMV0gPSBcIk9ubGluZVwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgY2xpZW50IGlzIGVpdGhlciB0cnlpbmcgdG8gZXN0YWJsaXNoIGEgY29ubmVjdGlvbiBidXQgZmFpbGluZywgb3IgaXRcclxuICAgICAqIGhhcyBiZWVuIGV4cGxpY2l0bHkgbWFya2VkIG9mZmxpbmUgdmlhIGEgY2FsbCB0byBkaXNhYmxlTmV0d29yaygpLlxyXG4gICAgICogSGlnaGVyLWxldmVsIGNvbXBvbmVudHMgc2hvdWxkIG9wZXJhdGUgaW4gb2ZmbGluZSBtb2RlLlxyXG4gICAgICovXHJcbiAgICBPbmxpbmVTdGF0ZVtPbmxpbmVTdGF0ZVtcIk9mZmxpbmVcIl0gPSAyXSA9IFwiT2ZmbGluZVwiO1xyXG59KShPbmxpbmVTdGF0ZSB8fCAoT25saW5lU3RhdGUgPSB7fSkpO1xyXG4vKiogVGhlIHNvdXJjZSBvZiBhbiBvbmxpbmUgc3RhdGUgZXZlbnQuICovXHJcbnZhciBPbmxpbmVTdGF0ZVNvdXJjZTtcclxuKGZ1bmN0aW9uIChPbmxpbmVTdGF0ZVNvdXJjZSkge1xyXG4gICAgT25saW5lU3RhdGVTb3VyY2VbT25saW5lU3RhdGVTb3VyY2VbXCJSZW1vdGVTdG9yZVwiXSA9IDBdID0gXCJSZW1vdGVTdG9yZVwiO1xyXG4gICAgT25saW5lU3RhdGVTb3VyY2VbT25saW5lU3RhdGVTb3VyY2VbXCJTaGFyZWRDbGllbnRTdGF0ZVwiXSA9IDFdID0gXCJTaGFyZWRDbGllbnRTdGF0ZVwiO1xyXG59KShPbmxpbmVTdGF0ZVNvdXJjZSB8fCAoT25saW5lU3RhdGVTb3VyY2UgPSB7fSkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckNyA9ICdPbmxpbmVTdGF0ZVRyYWNrZXInO1xyXG4vLyBUbyBkZWFsIHdpdGggdHJhbnNpZW50IGZhaWx1cmVzLCB3ZSBhbGxvdyBtdWx0aXBsZSBzdHJlYW0gYXR0ZW1wdHMgYmVmb3JlXHJcbi8vIGdpdmluZyB1cCBhbmQgdHJhbnNpdGlvbmluZyBmcm9tIE9ubGluZVN0YXRlLlVua25vd24gdG8gT2ZmbGluZS5cclxuLy8gVE9ETyhtaWtlbGVoZW4pOiBUaGlzIHVzZWQgdG8gYmUgc2V0IHRvIDIgYXMgYSBtaXRpZ2F0aW9uIGZvciBiLzY2MjI4Mzk0LlxyXG4vLyBAamRpbW9uZCB0aGlua3MgdGhhdCBidWcgaXMgc3VmZmljaWVudGx5IGZpeGVkIHNvIHRoYXQgd2UgY2FuIHNldCB0aGlzIGJhY2tcclxuLy8gdG8gMS4gSWYgdGhhdCB3b3JrcyBva2F5LCB3ZSBjb3VsZCBwb3RlbnRpYWxseSByZW1vdmUgdGhpcyBsb2dpYyBlbnRpcmVseS5cclxudmFyIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMgPSAxO1xyXG4vLyBUbyBkZWFsIHdpdGggc3RyZWFtIGF0dGVtcHRzIHRoYXQgZG9uJ3Qgc3VjY2VlZCBvciBmYWlsIGluIGEgdGltZWx5IG1hbm5lcixcclxuLy8gd2UgaGF2ZSBhIHRpbWVvdXQgZm9yIE9ubGluZVN0YXRlIHRvIHJlYWNoIE9ubGluZSBvciBPZmZsaW5lLlxyXG4vLyBJZiB0aGUgdGltZW91dCBpcyByZWFjaGVkLCB3ZSB0cmFuc2l0aW9uIHRvIE9mZmxpbmUgcmF0aGVyIHRoYW4gd2FpdGluZ1xyXG4vLyBpbmRlZmluaXRlbHkuXHJcbnZhciBPTkxJTkVfU1RBVEVfVElNRU9VVF9NUyA9IDEwICogMTAwMDtcclxuLyoqXHJcbiAqIEEgY29tcG9uZW50IHVzZWQgYnkgdGhlIFJlbW90ZVN0b3JlIHRvIHRyYWNrIHRoZSBPbmxpbmVTdGF0ZSAodGhhdCBpcyxcclxuICogd2hldGhlciBvciBub3QgdGhlIGNsaWVudCBhcyBhIHdob2xlIHNob3VsZCBiZSBjb25zaWRlcmVkIHRvIGJlIG9ubGluZSBvclxyXG4gKiBvZmZsaW5lKSwgaW1wbGVtZW50aW5nIHRoZSBhcHByb3ByaWF0ZSBoZXVyaXN0aWNzLlxyXG4gKlxyXG4gKiBJbiBwYXJ0aWN1bGFyLCB3aGVuIHRoZSBjbGllbnQgaXMgdHJ5aW5nIHRvIGNvbm5lY3QgdG8gdGhlIGJhY2tlbmQsIHdlXHJcbiAqIGFsbG93IHVwIHRvIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMgd2l0aGluIE9OTElORV9TVEFURV9USU1FT1VUX01TIGZvclxyXG4gKiBhIGNvbm5lY3Rpb24gdG8gc3VjY2VlZC4gSWYgd2UgaGF2ZSB0b28gbWFueSBmYWlsdXJlcyBvciB0aGUgdGltZW91dCBlbGFwc2VzLFxyXG4gKiB0aGVuIHdlIHNldCB0aGUgT25saW5lU3RhdGUgdG8gT2ZmbGluZSwgYW5kIHRoZSBjbGllbnQgd2lsbCBiZWhhdmUgYXMgaWZcclxuICogaXQgaXMgb2ZmbGluZSAoZ2V0KClzIHdpbGwgcmV0dXJuIGNhY2hlZCBkYXRhLCBldGMuKS5cclxuICovXHJcbnZhciBPbmxpbmVTdGF0ZVRyYWNrZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBPbmxpbmVTdGF0ZVRyYWNrZXIoYXN5bmNRdWV1ZSwgb25saW5lU3RhdGVIYW5kbGVyKSB7XHJcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gYXN5bmNRdWV1ZTtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlSGFuZGxlciA9IG9ubGluZVN0YXRlSGFuZGxlcjtcclxuICAgICAgICAvKiogVGhlIGN1cnJlbnQgT25saW5lU3RhdGUuICovXHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IE9ubGluZVN0YXRlLlVua25vd247XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBjb3VudCBvZiBjb25zZWN1dGl2ZSBmYWlsdXJlcyB0byBvcGVuIHRoZSBzdHJlYW0uIElmIGl0IHJlYWNoZXMgdGhlXHJcbiAgICAgICAgICogbWF4aW11bSBkZWZpbmVkIGJ5IE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMsIHdlJ2xsIHNldCB0aGUgT25saW5lU3RhdGUgdG9cclxuICAgICAgICAgKiBPZmZsaW5lLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMud2F0Y2hTdHJlYW1GYWlsdXJlcyA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSB0aW1lciB0aGF0IGVsYXBzZXMgYWZ0ZXIgT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMsIGF0IHdoaWNoIHBvaW50IHdlXHJcbiAgICAgICAgICogdHJhbnNpdGlvbiBmcm9tIE9ubGluZVN0YXRlLlVua25vd24gdG8gT25saW5lU3RhdGUuT2ZmbGluZSB3aXRob3V0IHdhaXRpbmdcclxuICAgICAgICAgKiBmb3IgdGhlIHN0cmVhbSB0byBhY3R1YWxseSBmYWlsIChNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTIHRpbWVzKS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlVGltZXIgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFdoZXRoZXIgdGhlIGNsaWVudCBzaG91bGQgbG9nIGEgd2FybmluZyBtZXNzYWdlIGlmIGl0IGZhaWxzIHRvIGNvbm5lY3QgdG9cclxuICAgICAgICAgKiB0aGUgYmFja2VuZCAoaW5pdGlhbGx5IHRydWUsIGNsZWFyZWQgYWZ0ZXIgYSBzdWNjZXNzZnVsIHN0cmVhbSwgb3IgaWYgd2UndmVcclxuICAgICAgICAgKiBsb2dnZWQgdGhlIG1lc3NhZ2UgYWxyZWFkeSkuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5zaG91bGRXYXJuQ2xpZW50SXNPZmZsaW5lID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIGJ5IFJlbW90ZVN0b3JlIHdoZW4gYSB3YXRjaCBzdHJlYW0gaXMgc3RhcnRlZCAoaW5jbHVkaW5nIG9uIGVhY2hcclxuICAgICAqIGJhY2tvZmYgYXR0ZW1wdCkuXHJcbiAgICAgKlxyXG4gICAgICogSWYgdGhpcyBpcyB0aGUgZmlyc3QgYXR0ZW1wdCwgaXQgc2V0cyB0aGUgT25saW5lU3RhdGUgdG8gVW5rbm93biBhbmQgc3RhcnRzXHJcbiAgICAgKiB0aGUgb25saW5lU3RhdGVUaW1lci5cclxuICAgICAqL1xyXG4gICAgT25saW5lU3RhdGVUcmFja2VyLnByb3RvdHlwZS5oYW5kbGVXYXRjaFN0cmVhbVN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMud2F0Y2hTdHJlYW1GYWlsdXJlcyA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldEFuZEJyb2FkY2FzdChPbmxpbmVTdGF0ZS5Vbmtub3duKTtcclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMub25saW5lU3RhdGVUaW1lciA9PT0gbnVsbCwgXCJvbmxpbmVTdGF0ZVRpbWVyIHNob3VsZG4ndCBiZSBzdGFydGVkIHlldFwiKTtcclxuICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRpbWVyID0gdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBZnRlckRlbGF5KFRpbWVySWQuT25saW5lU3RhdGVUaW1lb3V0LCBPTkxJTkVfU1RBVEVfVElNRU9VVF9NUywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub25saW5lU3RhdGVUaW1lciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQoX3RoaXMuc3RhdGUgPT09IE9ubGluZVN0YXRlLlVua25vd24sICdUaW1lciBzaG91bGQgYmUgY2FuY2VsZWQgaWYgd2UgdHJhbnNpdGlvbmVkIHRvIGEgZGlmZmVyZW50IHN0YXRlLicpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubG9nQ2xpZW50T2ZmbGluZVdhcm5pbmdJZk5lY2Vzc2FyeShcIkJhY2tlbmQgZGlkbid0IHJlc3BvbmQgd2l0aGluIFwiICsgT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMgLyAxMDAwICsgXCIgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwic2Vjb25kcy5cIik7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRBbmRCcm9hZGNhc3QoT25saW5lU3RhdGUuT2ZmbGluZSk7XHJcbiAgICAgICAgICAgICAgICAvLyBOT1RFOiBoYW5kbGVXYXRjaFN0cmVhbUZhaWx1cmUoKSB3aWxsIGNvbnRpbnVlIHRvIGluY3JlbWVudFxyXG4gICAgICAgICAgICAgICAgLy8gd2F0Y2hTdHJlYW1GYWlsdXJlcyBldmVuIHRob3VnaCB3ZSBhcmUgYWxyZWFkeSBtYXJrZWQgT2ZmbGluZSxcclxuICAgICAgICAgICAgICAgIC8vIGJ1dCB0aGlzIGlzIG5vbi1oYXJtZnVsLlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIG91ciBPbmxpbmVTdGF0ZSBhcyBhcHByb3ByaWF0ZSBhZnRlciB0aGUgd2F0Y2ggc3RyZWFtIHJlcG9ydHMgYVxyXG4gICAgICogZmFpbHVyZS4gVGhlIGZpcnN0IGZhaWx1cmUgbW92ZXMgdXMgdG8gdGhlICdVbmtub3duJyBzdGF0ZS4gV2UgdGhlbiBtYXlcclxuICAgICAqIGFsbG93IG11bHRpcGxlIGZhaWx1cmVzIChiYXNlZCBvbiBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTKSBiZWZvcmUgd2VcclxuICAgICAqIGFjdHVhbGx5IHRyYW5zaXRpb24gdG8gdGhlICdPZmZsaW5lJyBzdGF0ZS5cclxuICAgICAqL1xyXG4gICAgT25saW5lU3RhdGVUcmFja2VyLnByb3RvdHlwZS5oYW5kbGVXYXRjaFN0cmVhbUZhaWx1cmUgPSBmdW5jdGlvbiAoZXJyb3IkJDEpIHtcclxuICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gT25saW5lU3RhdGUuT25saW5lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QW5kQnJvYWRjYXN0KE9ubGluZVN0YXRlLlVua25vd24pO1xyXG4gICAgICAgICAgICAvLyBUbyBnZXQgdG8gT25saW5lU3RhdGUuT25saW5lLCBzZXQoKSBtdXN0IGhhdmUgYmVlbiBjYWxsZWQgd2hpY2ggd291bGRcclxuICAgICAgICAgICAgLy8gaGF2ZSByZXNldCBvdXIgaGV1cmlzdGljcy5cclxuICAgICAgICAgICAgYXNzZXJ0KHRoaXMud2F0Y2hTdHJlYW1GYWlsdXJlcyA9PT0gMCwgJ3dhdGNoU3RyZWFtRmFpbHVyZXMgbXVzdCBiZSAwJyk7XHJcbiAgICAgICAgICAgIGFzc2VydCh0aGlzLm9ubGluZVN0YXRlVGltZXIgPT09IG51bGwsICdvbmxpbmVTdGF0ZVRpbWVyIG11c3QgYmUgbnVsbCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy53YXRjaFN0cmVhbUZhaWx1cmVzKys7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLndhdGNoU3RyZWFtRmFpbHVyZXMgPj0gTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhck9ubGluZVN0YXRlVGltZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nQ2xpZW50T2ZmbGluZVdhcm5pbmdJZk5lY2Vzc2FyeShcIkNvbm5lY3Rpb24gZmFpbGVkIFwiICsgTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyArIFwiIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAoXCJ0aW1lcy4gTW9zdCByZWNlbnQgZXJyb3I6IFwiICsgZXJyb3IkJDEudG9TdHJpbmcoKSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRBbmRCcm9hZGNhc3QoT25saW5lU3RhdGUuT2ZmbGluZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBFeHBsaWNpdGx5IHNldHMgdGhlIE9ubGluZVN0YXRlIHRvIHRoZSBzcGVjaWZpZWQgc3RhdGUuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IHRoaXMgcmVzZXRzIG91ciB0aW1lcnMgLyBmYWlsdXJlIGNvdW50ZXJzLCBldGMuIHVzZWQgYnkgb3VyXHJcbiAgICAgKiBPZmZsaW5lIGhldXJpc3RpY3MsIHNvIG11c3Qgbm90IGJlIHVzZWQgaW4gcGxhY2Ugb2ZcclxuICAgICAqIGhhbmRsZVdhdGNoU3RyZWFtU3RhcnQoKSBhbmQgaGFuZGxlV2F0Y2hTdHJlYW1GYWlsdXJlKCkuXHJcbiAgICAgKi9cclxuICAgIE9ubGluZVN0YXRlVHJhY2tlci5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKG5ld1N0YXRlKSB7XHJcbiAgICAgICAgdGhpcy5jbGVhck9ubGluZVN0YXRlVGltZXIoKTtcclxuICAgICAgICB0aGlzLndhdGNoU3RyZWFtRmFpbHVyZXMgPSAwO1xyXG4gICAgICAgIGlmIChuZXdTdGF0ZSA9PT0gT25saW5lU3RhdGUuT25saW5lKSB7XHJcbiAgICAgICAgICAgIC8vIFdlJ3ZlIGNvbm5lY3RlZCB0byB3YXRjaCBhdCBsZWFzdCBvbmNlLiBEb24ndCB3YXJuIHRoZSBkZXZlbG9wZXJcclxuICAgICAgICAgICAgLy8gYWJvdXQgYmVpbmcgb2ZmbGluZSBnb2luZyBmb3J3YXJkLlxyXG4gICAgICAgICAgICB0aGlzLnNob3VsZFdhcm5DbGllbnRJc09mZmxpbmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRBbmRCcm9hZGNhc3QobmV3U3RhdGUpO1xyXG4gICAgfTtcclxuICAgIE9ubGluZVN0YXRlVHJhY2tlci5wcm90b3R5cGUuc2V0QW5kQnJvYWRjYXN0ID0gZnVuY3Rpb24gKG5ld1N0YXRlKSB7XHJcbiAgICAgICAgaWYgKG5ld1N0YXRlICE9PSB0aGlzLnN0YXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBuZXdTdGF0ZTtcclxuICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIobmV3U3RhdGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPbmxpbmVTdGF0ZVRyYWNrZXIucHJvdG90eXBlLmxvZ0NsaWVudE9mZmxpbmVXYXJuaW5nSWZOZWNlc3NhcnkgPSBmdW5jdGlvbiAoZGV0YWlscykge1xyXG4gICAgICAgIHZhciBtZXNzYWdlID0gXCJDb3VsZCBub3QgcmVhY2ggQ2xvdWQgRmlyZXN0b3JlIGJhY2tlbmQuIFwiICsgZGV0YWlscyArIFwiXFxuXCIgK1xyXG4gICAgICAgICAgICBcIlRoaXMgdHlwaWNhbGx5IGluZGljYXRlcyB0aGF0IHlvdXIgZGV2aWNlIGRvZXMgbm90IGhhdmUgYSBoZWFsdGh5IFwiICtcclxuICAgICAgICAgICAgXCJJbnRlcm5ldCBjb25uZWN0aW9uIGF0IHRoZSBtb21lbnQuIFRoZSBjbGllbnQgd2lsbCBvcGVyYXRlIGluIG9mZmxpbmUgXCIgK1xyXG4gICAgICAgICAgICBcIm1vZGUgdW50aWwgaXQgaXMgYWJsZSB0byBzdWNjZXNzZnVsbHkgY29ubmVjdCB0byB0aGUgYmFja2VuZC5cIjtcclxuICAgICAgICBpZiAodGhpcy5zaG91bGRXYXJuQ2xpZW50SXNPZmZsaW5lKSB7XHJcbiAgICAgICAgICAgIGVycm9yKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB0aGlzLnNob3VsZFdhcm5DbGllbnRJc09mZmxpbmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckNywgbWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE9ubGluZVN0YXRlVHJhY2tlci5wcm90b3R5cGUuY2xlYXJPbmxpbmVTdGF0ZVRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLm9ubGluZVN0YXRlVGltZXIgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRpbWVyLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVGltZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gT25saW5lU3RhdGVUcmFja2VyO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIExPR19UQUckOCA9ICdSZW1vdGVTdG9yZSc7XHJcbi8vIFRPRE8oYi8zNTg1MzQwMik6IE5lZ290aWF0ZSB0aGlzIHdpdGggdGhlIHN0cmVhbS5cclxudmFyIE1BWF9QRU5ESU5HX1dSSVRFUyA9IDEwO1xyXG4vKipcclxuICogUmVtb3RlU3RvcmUgLSBBbiBpbnRlcmZhY2UgdG8gcmVtb3RlbHkgc3RvcmVkIGRhdGEsIGJhc2ljYWxseSBwcm92aWRpbmcgYVxyXG4gKiB3cmFwcGVyIGFyb3VuZCB0aGUgRGF0YXN0b3JlIHRoYXQgaXMgbW9yZSByZWxpYWJsZSBmb3IgdGhlIHJlc3Qgb2YgdGhlXHJcbiAqIHN5c3RlbS5cclxuICpcclxuICogUmVtb3RlU3RvcmUgaXMgcmVzcG9uc2libGUgZm9yIG1haW50YWluaW5nIHRoZSBjb25uZWN0aW9uIHRvIHRoZSBzZXJ2ZXIuXHJcbiAqIC0gbWFpbnRhaW5pbmcgYSBsaXN0IG9mIGFjdGl2ZSBsaXN0ZW5zLlxyXG4gKiAtIHJlY29ubmVjdGluZyB3aGVuIHRoZSBjb25uZWN0aW9uIGlzIGRyb3BwZWQuXHJcbiAqIC0gcmVzdW1pbmcgYWxsIHRoZSBhY3RpdmUgbGlzdGVucyBvbiByZWNvbm5lY3QuXHJcbiAqXHJcbiAqIFJlbW90ZVN0b3JlIGhhbmRsZXMgYWxsIGluY29taW5nIGV2ZW50cyBmcm9tIHRoZSBEYXRhc3RvcmUuXHJcbiAqIC0gbGlzdGVuaW5nIHRvIHRoZSB3YXRjaCBzdHJlYW0gYW5kIHJlcGFja2FnaW5nIHRoZSBldmVudHMgYXMgUmVtb3RlRXZlbnRzXHJcbiAqIC0gbm90aWZ5aW5nIFN5bmNFbmdpbmUgb2YgYW55IGNoYW5nZXMgdG8gdGhlIGFjdGl2ZSBsaXN0ZW5zLlxyXG4gKlxyXG4gKiBSZW1vdGVTdG9yZSB0YWtlcyB3cml0ZXMgZnJvbSBvdGhlciBjb21wb25lbnRzIGFuZCBoYW5kbGVzIHRoZW0gcmVsaWFibHkuXHJcbiAqIC0gcHVsbGluZyBwZW5kaW5nIG11dGF0aW9ucyBmcm9tIExvY2FsU3RvcmUgYW5kIHNlbmRpbmcgdGhlbSB0byBEYXRhc3RvcmUuXHJcbiAqIC0gcmV0cnlpbmcgbXV0YXRpb25zIHRoYXQgZmFpbGVkIGJlY2F1c2Ugb2YgbmV0d29yayBwcm9ibGVtcy5cclxuICogLSBhY2tpbmcgbXV0YXRpb25zIHRvIHRoZSBTeW5jRW5naW5lIG9uY2UgdGhleSBhcmUgYWNjZXB0ZWQgb3IgcmVqZWN0ZWQuXHJcbiAqL1xyXG52YXIgUmVtb3RlU3RvcmUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZW1vdGVTdG9yZShcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGxvY2FsIHN0b3JlLCB1c2VkIHRvIGZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIHdpdGggb3V0Ym91bmQgbXV0YXRpb25zLlxyXG4gICAgICovXHJcbiAgICBsb2NhbFN0b3JlLCBcclxuICAgIC8qKiBUaGUgY2xpZW50LXNpZGUgcHJveHkgZm9yIGludGVyYWN0aW5nIHdpdGggdGhlIGJhY2tlbmQuICovXHJcbiAgICBkYXRhc3RvcmUsIGFzeW5jUXVldWUsIG9ubGluZVN0YXRlSGFuZGxlcikge1xyXG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IGxvY2FsU3RvcmU7XHJcbiAgICAgICAgdGhpcy5kYXRhc3RvcmUgPSBkYXRhc3RvcmU7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQSBsaXN0IG9mIHVwIHRvIE1BWF9QRU5ESU5HX1dSSVRFUyB3cml0ZXMgdGhhdCB3ZSBoYXZlIGZldGNoZWQgZnJvbSB0aGVcclxuICAgICAgICAgKiBMb2NhbFN0b3JlIHZpYSBmaWxsV3JpdGVQaXBlbGluZSgpIGFuZCBoYXZlIG9yIHdpbGwgc2VuZCB0byB0aGUgd3JpdGVcclxuICAgICAgICAgKiBzdHJlYW0uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBXaGVuZXZlciB3cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDAgdGhlIFJlbW90ZVN0b3JlIHdpbGwgYXR0ZW1wdCB0byBzdGFydCBvclxyXG4gICAgICAgICAqIHJlc3RhcnQgdGhlIHdyaXRlIHN0cmVhbS4gV2hlbiB0aGUgc3RyZWFtIGlzIGVzdGFibGlzaGVkIHRoZSB3cml0ZXMgaW4gdGhlXHJcbiAgICAgICAgICogcGlwZWxpbmUgd2lsbCBiZSBzZW50IGluIG9yZGVyLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogV3JpdGVzIHJlbWFpbiBpbiB3cml0ZVBpcGVsaW5lIHVudGlsIHRoZXkgYXJlIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZFxyXG4gICAgICAgICAqIGFuZCB0aHVzIHdpbGwgYXV0b21hdGljYWxseSBiZSByZS1zZW50IGlmIHRoZSBzdHJlYW0gaXMgaW50ZXJydXB0ZWQgL1xyXG4gICAgICAgICAqIHJlc3RhcnRlZCBiZWZvcmUgdGhleSdyZSBhY2tub3dsZWRnZWQuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBXcml0ZSByZXNwb25zZXMgZnJvbSB0aGUgYmFja2VuZCBhcmUgbGlua2VkIHRvIHRoZWlyIG9yaWdpbmF0aW5nIHJlcXVlc3RcclxuICAgICAgICAgKiBwdXJlbHkgYmFzZWQgb24gb3JkZXIsIGFuZCBzbyB3ZSBjYW4ganVzdCBzaGlmdCgpIHdyaXRlcyBmcm9tIHRoZSBmcm9udCBvZlxyXG4gICAgICAgICAqIHRoZSB3cml0ZVBpcGVsaW5lIGFzIHdlIHJlY2VpdmUgcmVzcG9uc2VzLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMud3JpdGVQaXBlbGluZSA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgbWFwcGluZyBvZiB3YXRjaGVkIHRhcmdldHMgdGhhdCB0aGUgY2xpZW50IGNhcmVzIGFib3V0IHRyYWNraW5nIGFuZCB0aGVcclxuICAgICAgICAgKiB1c2VyIGhhcyBleHBsaWNpdGx5IGNhbGxlZCBhICdsaXN0ZW4nIGZvciB0aGlzIHRhcmdldC5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIFRoZXNlIHRhcmdldHMgbWF5IG9yIG1heSBub3QgaGF2ZSBiZWVuIHNlbnQgdG8gb3IgYWNrbm93bGVkZ2VkIGJ5IHRoZVxyXG4gICAgICAgICAqIHNlcnZlci4gT24gcmUtZXN0YWJsaXNoaW5nIHRoZSBsaXN0ZW4gc3RyZWFtLCB0aGVzZSB0YXJnZXRzIHNob3VsZCBiZSBzZW50XHJcbiAgICAgICAgICogdG8gdGhlIHNlcnZlci4gVGhlIHRhcmdldHMgcmVtb3ZlZCB3aXRoIHVubGlzdGVucyBhcmUgcmVtb3ZlZCBlYWdlcmx5XHJcbiAgICAgICAgICogd2l0aG91dCB3YWl0aW5nIGZvciBjb25maXJtYXRpb24gZnJvbSB0aGUgbGlzdGVuIHN0cmVhbS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmxpc3RlblRhcmdldHMgPSB7fTtcclxuICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvciA9IG51bGw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogU2V0IHRvIHRydWUgYnkgZW5hYmxlTmV0d29yaygpIGFuZCBmYWxzZSBieSBkaXNhYmxlTmV0d29yaygpIGFuZCBpbmRpY2F0ZXNcclxuICAgICAgICAgKiB0aGUgdXNlci1wcmVmZXJyZWQgbmV0d29yayBzdGF0ZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pc1ByaW1hcnkgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlciA9IG5ldyBPbmxpbmVTdGF0ZVRyYWNrZXIoYXN5bmNRdWV1ZSwgb25saW5lU3RhdGVIYW5kbGVyKTtcclxuICAgICAgICAvLyBDcmVhdGUgc3RyZWFtcyAoYnV0IG5vdGUgdGhleSdyZSBub3Qgc3RhcnRlZCB5ZXQpLlxyXG4gICAgICAgIHRoaXMud2F0Y2hTdHJlYW0gPSB0aGlzLmRhdGFzdG9yZS5uZXdQZXJzaXN0ZW50V2F0Y2hTdHJlYW0oe1xyXG4gICAgICAgICAgICBvbk9wZW46IHRoaXMub25XYXRjaFN0cmVhbU9wZW4uYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgb25DbG9zZTogdGhpcy5vbldhdGNoU3RyZWFtQ2xvc2UuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgb25XYXRjaENoYW5nZTogdGhpcy5vbldhdGNoU3RyZWFtQ2hhbmdlLmJpbmQodGhpcylcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLndyaXRlU3RyZWFtID0gdGhpcy5kYXRhc3RvcmUubmV3UGVyc2lzdGVudFdyaXRlU3RyZWFtKHtcclxuICAgICAgICAgICAgb25PcGVuOiB0aGlzLm9uV3JpdGVTdHJlYW1PcGVuLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIG9uQ2xvc2U6IHRoaXMub25Xcml0ZVN0cmVhbUNsb3NlLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIG9uSGFuZHNoYWtlQ29tcGxldGU6IHRoaXMub25Xcml0ZUhhbmRzaGFrZUNvbXBsZXRlLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIG9uTXV0YXRpb25SZXN1bHQ6IHRoaXMub25NdXRhdGlvblJlc3VsdC5iaW5kKHRoaXMpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyB1cCB0aGUgcmVtb3RlIHN0b3JlLCBjcmVhdGluZyBzdHJlYW1zLCByZXN0b3Jpbmcgc3RhdGUgZnJvbVxyXG4gICAgICogTG9jYWxTdG9yZSwgZXRjLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5hYmxlTmV0d29yaygpO1xyXG4gICAgfTtcclxuICAgIC8qKiBSZS1lbmFibGVzIHRoZSBuZXR3b3JrLiBJZGVtcG90ZW50LiAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmVuYWJsZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhblVzZU5ldHdvcmsoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcy53cml0ZVN0cmVhbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmdldExhc3RTdHJlYW1Ub2tlbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhc3RTdHJlYW1Ub2tlbiA9IF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvdWxkU3RhcnRXYXRjaFN0cmVhbSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0V2F0Y2hTdHJlYW0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLnNldChPbmxpbmVTdGF0ZS5Vbmtub3duKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHdpbGwgc3RhcnQgdGhlIHdyaXRlIHN0cmVhbSBpZiBuZWNlc3NhcnkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZmlsbFdyaXRlUGlwZWxpbmUoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHdpbGwgc3RhcnQgdGhlIHdyaXRlIHN0cmVhbSBpZiBuZWNlc3NhcnkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRlbXBvcmFyaWx5IGRpc2FibGVzIHRoZSBuZXR3b3JrLiBUaGUgbmV0d29yayBjYW4gYmUgcmUtZW5hYmxlZCB1c2luZ1xyXG4gICAgICogZW5hYmxlTmV0d29yaygpLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuZGlzYWJsZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmRpc2FibGVOZXR3b3JrSW50ZXJuYWwoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgT25saW5lU3RhdGUgdG8gT2ZmbGluZSBzbyBnZXQoKXMgcmV0dXJuIGZyb20gY2FjaGUsIGV0Yy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuc2V0KE9ubGluZVN0YXRlLk9mZmxpbmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5kaXNhYmxlTmV0d29ya0ludGVybmFsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMud3JpdGVTdHJlYW0uc3RvcCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy53YXRjaFN0cmVhbS5zdG9wKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckOCwgXCJTdG9wcGluZyB3cml0ZSBzdHJlYW0gd2l0aCBcIiArIHRoaXMud3JpdGVQaXBlbGluZS5sZW5ndGggKyBcIiBwZW5kaW5nIHdyaXRlc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGVQaXBlbGluZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYW5VcFdhdGNoU3RyZWFtU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuc2h1dGRvd24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ4LCAnUmVtb3RlU3RvcmUgc2h1dHRpbmcgZG93bi4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmRpc2FibGVOZXR3b3JrSW50ZXJuYWwoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgT25saW5lU3RhdGUgdG8gVW5rbm93biAocmF0aGVyIHRoYW4gT2ZmbGluZSkgdG8gYXZvaWQgcG90ZW50aWFsbHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHJpZ2dlcmluZyBzcHVyaW91cyBsaXN0ZW5lciBldmVudHMgd2l0aCBjYWNoZWQgZGF0YSwgZXRjLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9ubGluZVN0YXRlVHJhY2tlci5zZXQoT25saW5lU3RhdGUuVW5rbm93bik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFN0YXJ0cyBuZXcgbGlzdGVuIGZvciB0aGUgZ2l2ZW4gcXVlcnkuIFVzZXMgcmVzdW1lIHRva2VuIGlmIHByb3ZpZGVkICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUubGlzdGVuID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIGFzc2VydCghY29udGFpbnModGhpcy5saXN0ZW5UYXJnZXRzLCBxdWVyeURhdGEudGFyZ2V0SWQpLCAnbGlzdGVuIGNhbGxlZCB3aXRoIGR1cGxpY2F0ZSB0YXJnZXRJZCEnKTtcclxuICAgICAgICAvLyBNYXJrIHRoaXMgYXMgc29tZXRoaW5nIHRoZSBjbGllbnQgaXMgY3VycmVudGx5IGxpc3RlbmluZyBmb3IuXHJcbiAgICAgICAgdGhpcy5saXN0ZW5UYXJnZXRzW3F1ZXJ5RGF0YS50YXJnZXRJZF0gPSBxdWVyeURhdGE7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvdWxkU3RhcnRXYXRjaFN0cmVhbSgpKSB7XHJcbiAgICAgICAgICAgIC8vIFRoZSBsaXN0ZW4gd2lsbCBiZSBzZW50IGluIG9uV2F0Y2hTdHJlYW1PcGVuXHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRXYXRjaFN0cmVhbSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLndhdGNoU3RyZWFtLmlzT3BlbigpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZFdhdGNoUmVxdWVzdChxdWVyeURhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiogUmVtb3ZlcyB0aGUgbGlzdGVuIGZyb20gc2VydmVyICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUudW5saXN0ZW4gPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICBhc3NlcnQoY29udGFpbnModGhpcy5saXN0ZW5UYXJnZXRzLCB0YXJnZXRJZCksICd1bmxpc3RlbiBjYWxsZWQgd2l0aG91dCBhc3NpZ25lZCB0YXJnZXQgSUQhJyk7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMubGlzdGVuVGFyZ2V0c1t0YXJnZXRJZF07XHJcbiAgICAgICAgaWYgKHRoaXMud2F0Y2hTdHJlYW0uaXNPcGVuKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZW5kVW53YXRjaFJlcXVlc3QodGFyZ2V0SWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNFbXB0eSh0aGlzLmxpc3RlblRhcmdldHMpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLndhdGNoU3RyZWFtLmlzT3BlbigpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndhdGNoU3RyZWFtLm1hcmtJZGxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5jYW5Vc2VOZXR3b3JrKCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJldmVydCB0byBPbmxpbmVTdGF0ZS5Vbmtub3duIGlmIHRoZSB3YXRjaCBzdHJlYW0gaXMgbm90IG9wZW4gYW5kIHdlXHJcbiAgICAgICAgICAgICAgICAvLyBoYXZlIG5vIGxpc3RlbmVycywgc2luY2Ugd2l0aG91dCBhbnkgbGlzdGVucyB0byBzZW5kIHdlIGNhbm5vdFxyXG4gICAgICAgICAgICAgICAgLy8gY29uZmlybSBpZiB0aGUgc3RyZWFtIGlzIGhlYWx0aHkgYW5kIHVwZ3JhZGUgdG8gT25saW5lU3RhdGUuT25saW5lLlxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuc2V0KE9ubGluZVN0YXRlLlVua25vd24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiB7QGxpbmsgVGFyZ2V0TWV0YWRhdGFQcm92aWRlci5nZXRRdWVyeURhdGFGb3JUYXJnZXR9ICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuZ2V0UXVlcnlEYXRhRm9yVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuVGFyZ2V0c1t0YXJnZXRJZF0gfHwgbnVsbDtcclxuICAgIH07XHJcbiAgICAvKioge0BsaW5rIFRhcmdldE1ldGFkYXRhUHJvdmlkZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldH0gKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFdlIG5lZWQgdG8gaW5jcmVtZW50IHRoZSB0aGUgZXhwZWN0ZWQgbnVtYmVyIG9mIHBlbmRpbmcgcmVzcG9uc2VzIHdlJ3JlIGR1ZVxyXG4gICAgICogZnJvbSB3YXRjaCBzbyB3ZSB3YWl0IGZvciB0aGUgYWNrIHRvIHByb2Nlc3MgYW55IG1lc3NhZ2VzIGZyb20gdGhpcyB0YXJnZXQuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5zZW5kV2F0Y2hSZXF1ZXN0ID0gZnVuY3Rpb24gKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yLnJlY29yZFBlbmRpbmdUYXJnZXRSZXF1ZXN0KHF1ZXJ5RGF0YS50YXJnZXRJZCk7XHJcbiAgICAgICAgdGhpcy53YXRjaFN0cmVhbS53YXRjaChxdWVyeURhdGEpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogV2UgbmVlZCB0byBpbmNyZW1lbnQgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyB3ZSdyZSBkdWVcclxuICAgICAqIGZyb20gd2F0Y2ggc28gd2Ugd2FpdCBmb3IgdGhlIHJlbW92YWwgb24gdGhlIHNlcnZlciBiZWZvcmUgd2UgcHJvY2VzcyBhbnlcclxuICAgICAqIG1lc3NhZ2VzIGZyb20gdGhpcyB0YXJnZXQuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5zZW5kVW53YXRjaFJlcXVlc3QgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvci5yZWNvcmRQZW5kaW5nVGFyZ2V0UmVxdWVzdCh0YXJnZXRJZCk7XHJcbiAgICAgICAgdGhpcy53YXRjaFN0cmVhbS51bndhdGNoKHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuc3RhcnRXYXRjaFN0cmVhbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3NlcnQodGhpcy5zaG91bGRTdGFydFdhdGNoU3RyZWFtKCksICdzdGFydFdhdGNoU3RyZWFtKCkgY2FsbGVkIHdoZW4gc2hvdWxkU3RhcnRXYXRjaFN0cmVhbSgpIGlzIGZhbHNlLicpO1xyXG4gICAgICAgIHRoaXMud2F0Y2hDaGFuZ2VBZ2dyZWdhdG9yID0gbmV3IFdhdGNoQ2hhbmdlQWdncmVnYXRvcih0aGlzKTtcclxuICAgICAgICB0aGlzLndhdGNoU3RyZWFtLnN0YXJ0KCk7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuaGFuZGxlV2F0Y2hTdHJlYW1TdGFydCgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSB3YXRjaCBzdHJlYW0gc2hvdWxkIGJlIHN0YXJ0ZWQgYmVjYXVzZSBpdCdzIG5lY2Vzc2FyeVxyXG4gICAgICogYW5kIGhhcyBub3QgeWV0IGJlZW4gc3RhcnRlZC5cclxuICAgICAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnNob3VsZFN0YXJ0V2F0Y2hTdHJlYW0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmNhblVzZU5ldHdvcmsoKSAmJlxyXG4gICAgICAgICAgICAhdGhpcy53YXRjaFN0cmVhbS5pc1N0YXJ0ZWQoKSAmJlxyXG4gICAgICAgICAgICAhaXNFbXB0eSh0aGlzLmxpc3RlblRhcmdldHMpKTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuY2FuVXNlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pc1ByaW1hcnkgJiYgdGhpcy5uZXR3b3JrRW5hYmxlZDtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuY2xlYW5VcFdhdGNoU3RyZWFtU3RhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IgPSBudWxsO1xyXG4gICAgfTtcclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5vbldhdGNoU3RyZWFtT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBmb3JFYWNoTnVtYmVyKHRoaXMubGlzdGVuVGFyZ2V0cywgZnVuY3Rpb24gKHRhcmdldElkLCBxdWVyeURhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZW5kV2F0Y2hSZXF1ZXN0KHF1ZXJ5RGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLm9uV2F0Y2hTdHJlYW1DbG9zZSA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnJvciQkMSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gR3JhY2VmdWwgc3RvcCAoZHVlIHRvIHN0b3AoKSBvciBpZGxlIHRpbWVvdXQpLiBNYWtlIHN1cmUgdGhhdCdzXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVzaXJhYmxlLlxyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydCghdGhpcy5zaG91bGRTdGFydFdhdGNoU3RyZWFtKCksICdXYXRjaCBzdHJlYW0gd2FzIHN0b3BwZWQgZ3JhY2VmdWxseSB3aGlsZSBzdGlsbCBuZWVkZWQuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFuVXBXYXRjaFN0cmVhbVN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBzdGlsbCBuZWVkIHRoZSB3YXRjaCBzdHJlYW0sIHJldHJ5IHRoZSBjb25uZWN0aW9uLlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvdWxkU3RhcnRXYXRjaFN0cmVhbSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuaGFuZGxlV2F0Y2hTdHJlYW1GYWlsdXJlKGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0V2F0Y2hTdHJlYW0oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIE5vIG5lZWQgdG8gcmVzdGFydCB3YXRjaCBzdHJlYW0gYmVjYXVzZSB0aGVyZSBhcmUgbm8gYWN0aXZlIHRhcmdldHMuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIG9ubGluZSBzdGF0ZSBpcyBzZXQgdG8gdW5rbm93biBiZWNhdXNlIHRoZXJlIGlzIG5vIGFjdGl2ZSBhdHRlbXB0XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYXQgZXN0YWJsaXNoaW5nIGEgY29ubmVjdGlvblxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLnNldChPbmxpbmVTdGF0ZS5Vbmtub3duKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLm9uV2F0Y2hTdHJlYW1DaGFuZ2UgPSBmdW5jdGlvbiAod2F0Y2hDaGFuZ2UsIHNuYXBzaG90VmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIHRoZSBjbGllbnQgYXMgb25saW5lIHNpbmNlIHdlIGdvdCBhIG1lc3NhZ2UgZnJvbSB0aGUgc2VydmVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLnNldChPbmxpbmVTdGF0ZS5PbmxpbmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod2F0Y2hDaGFuZ2UgaW5zdGFuY2VvZiBXYXRjaFRhcmdldENoYW5nZSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F0Y2hDaGFuZ2Uuc3RhdGUgPT09IFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVtb3ZlZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F0Y2hDaGFuZ2UuY2F1c2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIHdhcyBhbiBlcnJvciBvbiBhIHRhcmdldCwgZG9uJ3Qgd2FpdCBmb3IgYSBjb25zaXN0ZW50IHNuYXBzaG90XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byByYWlzZSBldmVudHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmhhbmRsZVRhcmdldEVycm9yKHdhdGNoQ2hhbmdlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdhdGNoQ2hhbmdlIGluc3RhbmNlb2YgRG9jdW1lbnRXYXRjaENoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IuaGFuZGxlRG9jdW1lbnRDaGFuZ2Uod2F0Y2hDaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHdhdGNoQ2hhbmdlIGluc3RhbmNlb2YgRXhpc3RlbmNlRmlsdGVyQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhdGNoQ2hhbmdlQWdncmVnYXRvci5oYW5kbGVFeGlzdGVuY2VGaWx0ZXIod2F0Y2hDaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHdhdGNoQ2hhbmdlIGluc3RhbmNlb2YgV2F0Y2hUYXJnZXRDaGFuZ2UsICdFeHBlY3RlZCB3YXRjaENoYW5nZSB0byBiZSBhbiBpbnN0YW5jZSBvZiBXYXRjaFRhcmdldENoYW5nZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IuaGFuZGxlVGFyZ2V0Q2hhbmdlKHdhdGNoQ2hhbmdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFzbmFwc2hvdFZlcnNpb24uaXNFcXVhbChTbmFwc2hvdFZlcnNpb24uTUlOKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5nZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoc25hcHNob3RWZXJzaW9uLmNvbXBhcmVUbyhsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKSA+PSAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgcmVjZWl2ZWQgYSB0YXJnZXQgY2hhbmdlIHdpdGggYSBnbG9iYWwgc25hcHNob3QgaWYgdGhlIHNuYXBzaG90XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZlcnNpb24gaXMgbm90IGVxdWFsIHRvIFNuYXBzaG90VmVyc2lvbi5NSU4uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmFpc2VXYXRjaFNuYXBzaG90KHNuYXBzaG90VmVyc2lvbildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSByZWNlaXZlZCBhIHRhcmdldCBjaGFuZ2Ugd2l0aCBhIGdsb2JhbCBzbmFwc2hvdCBpZiB0aGUgc25hcHNob3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmVyc2lvbiBpcyBub3QgZXF1YWwgdG8gU25hcHNob3RWZXJzaW9uLk1JTi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVGFrZXMgYSBiYXRjaCBvZiBjaGFuZ2VzIGZyb20gdGhlIERhdGFzdG9yZSwgcmVwYWNrYWdlcyB0aGVtIGFzIGFcclxuICAgICAqIFJlbW90ZUV2ZW50LCBhbmQgcGFzc2VzIHRoYXQgb24gdG8gdGhlIGxpc3RlbmVyLCB3aGljaCBpcyB0eXBpY2FsbHkgdGhlXHJcbiAgICAgKiBTeW5jRW5naW5lLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUucmFpc2VXYXRjaFNuYXBzaG90ID0gZnVuY3Rpb24gKHNuYXBzaG90VmVyc2lvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KCFzbmFwc2hvdFZlcnNpb24uaXNFcXVhbChTbmFwc2hvdFZlcnNpb24uTUlOKSwgXCJDYW4ndCByYWlzZSBldmVudCBmb3IgdW5rbm93biBTbmFwc2hvdFZlcnNpb25cIik7XHJcbiAgICAgICAgdmFyIHJlbW90ZUV2ZW50ID0gdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IuY3JlYXRlUmVtb3RlRXZlbnQoc25hcHNob3RWZXJzaW9uKTtcclxuICAgICAgICAvLyBVcGRhdGUgaW4tbWVtb3J5IHJlc3VtZSB0b2tlbnMuIExvY2FsU3RvcmUgd2lsbCB1cGRhdGUgdGhlXHJcbiAgICAgICAgLy8gcGVyc2lzdGVudCB2aWV3IG9mIHRoZXNlIHdoZW4gYXBwbHlpbmcgdGhlIGNvbXBsZXRlZCBSZW1vdGVFdmVudC5cclxuICAgICAgICBmb3JFYWNoTnVtYmVyKHJlbW90ZUV2ZW50LnRhcmdldENoYW5nZXMsIGZ1bmN0aW9uICh0YXJnZXRJZCwgY2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2UucmVzdW1lVG9rZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IF90aGlzLmxpc3RlblRhcmdldHNbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgLy8gQSB3YXRjaGVkIHRhcmdldCBtaWdodCBoYXZlIGJlZW4gcmVtb3ZlZCBhbHJlYWR5LlxyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXJ5RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmxpc3RlblRhcmdldHNbdGFyZ2V0SWRdID0gcXVlcnlEYXRhLmNvcHkoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bWVUb2tlbjogY2hhbmdlLnJlc3VtZVRva2VuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzbmFwc2hvdFZlcnNpb246IHNuYXBzaG90VmVyc2lvblxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gUmUtZXN0YWJsaXNoIGxpc3RlbnMgZm9yIHRoZSB0YXJnZXRzIHRoYXQgaGF2ZSBiZWVuIGludmFsaWRhdGVkIGJ5XHJcbiAgICAgICAgLy8gZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLlxyXG4gICAgICAgIHJlbW90ZUV2ZW50LnRhcmdldE1pc21hdGNoZXMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YSA9IF90aGlzLmxpc3RlblRhcmdldHNbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICBpZiAoIXF1ZXJ5RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgLy8gQSB3YXRjaGVkIHRhcmdldCBtaWdodCBoYXZlIGJlZW4gcmVtb3ZlZCBhbHJlYWR5LlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIENsZWFyIHRoZSByZXN1bWUgdG9rZW4gZm9yIHRoZSBxdWVyeSwgc2luY2Ugd2UncmUgaW4gYSBrbm93biBtaXNtYXRjaFxyXG4gICAgICAgICAgICAvLyBzdGF0ZS5cclxuICAgICAgICAgICAgX3RoaXMubGlzdGVuVGFyZ2V0c1t0YXJnZXRJZF0gPSBxdWVyeURhdGEuY29weSh7XHJcbiAgICAgICAgICAgICAgICByZXN1bWVUb2tlbjogZW1wdHlCeXRlU3RyaW5nKClcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIENhdXNlIGEgaGFyZCByZXNldCBieSB1bndhdGNoaW5nIGFuZCByZXdhdGNoaW5nIGltbWVkaWF0ZWx5LCBidXRcclxuICAgICAgICAgICAgLy8gZGVsaWJlcmF0ZWx5IGRvbid0IHNlbmQgYSByZXN1bWUgdG9rZW4gc28gdGhhdCB3ZSBnZXQgYSBmdWxsIHVwZGF0ZS5cclxuICAgICAgICAgICAgX3RoaXMuc2VuZFVud2F0Y2hSZXF1ZXN0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgLy8gTWFyayB0aGUgcXVlcnkgd2Ugc2VuZCBhcyBiZWluZyBvbiBiZWhhbGYgb2YgYW4gZXhpc3RlbmNlIGZpbHRlclxyXG4gICAgICAgICAgICAvLyBtaXNtYXRjaCwgYnV0IGRvbid0IGFjdHVhbGx5IHJldGFpbiB0aGF0IGluIGxpc3RlblRhcmdldHMuIFRoaXMgZW5zdXJlc1xyXG4gICAgICAgICAgICAvLyB0aGF0IHdlIGZsYWcgdGhlIGZpcnN0IHJlLWxpc3RlbiB0aGlzIHdheSB3aXRob3V0IGltcGFjdGluZyBmdXR1cmVcclxuICAgICAgICAgICAgLy8gbGlzdGVucyBvZiB0aGlzIHRhcmdldCAodGhhdCBtaWdodCBoYXBwZW4gZS5nLiBvbiByZWNvbm5lY3QpLlxyXG4gICAgICAgICAgICB2YXIgcmVxdWVzdFF1ZXJ5RGF0YSA9IG5ldyBRdWVyeURhdGEocXVlcnlEYXRhLnF1ZXJ5LCB0YXJnZXRJZCwgUXVlcnlQdXJwb3NlLkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoLCBxdWVyeURhdGEuc2VxdWVuY2VOdW1iZXIpO1xyXG4gICAgICAgICAgICBfdGhpcy5zZW5kV2F0Y2hSZXF1ZXN0KHJlcXVlc3RRdWVyeURhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIEZpbmFsbHkgcmFpc2UgcmVtb3RlIGV2ZW50XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5hcHBseVJlbW90ZUV2ZW50KHJlbW90ZUV2ZW50KTtcclxuICAgIH07XHJcbiAgICAvKiogSGFuZGxlcyBhbiBlcnJvciBvbiBhIHRhcmdldCAqL1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmhhbmRsZVRhcmdldEVycm9yID0gZnVuY3Rpb24gKHdhdGNoQ2hhbmdlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoISF3YXRjaENoYW5nZS5jYXVzZSwgJ0hhbmRsaW5nIHRhcmdldCBlcnJvciB3aXRob3V0IGEgY2F1c2UnKTtcclxuICAgICAgICB2YXIgZXJyb3IkJDEgPSB3YXRjaENoYW5nZS5jYXVzZTtcclxuICAgICAgICB2YXIgcHJvbWlzZUNoYWluID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgd2F0Y2hDaGFuZ2UudGFyZ2V0SWRzLmZvckVhY2goZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgIHByb21pc2VDaGFpbiA9IHByb21pc2VDaGFpbi50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQSB3YXRjaGVkIHRhcmdldCBtaWdodCBoYXZlIGJlZW4gcmVtb3ZlZCBhbHJlYWR5LlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250YWlucyh0aGlzLmxpc3RlblRhcmdldHMsIHRhcmdldElkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5UYXJnZXRzW3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53YXRjaENoYW5nZUFnZ3JlZ2F0b3IucmVtb3ZlVGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuc3luY0VuZ2luZS5yZWplY3RMaXN0ZW4odGFyZ2V0SWQsIGVycm9yJCQxKV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHByb21pc2VDaGFpbjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEF0dGVtcHRzIHRvIGZpbGwgb3VyIHdyaXRlIHBpcGVsaW5lIHdpdGggd3JpdGVzIGZyb20gdGhlIExvY2FsU3RvcmUuXHJcbiAgICAgKlxyXG4gICAgICogQ2FsbGVkIGludGVybmFsbHkgdG8gYm9vdHN0cmFwIG9yIHJlZmlsbCB0aGUgd3JpdGUgcGlwZWxpbmUgYW5kIGJ5XHJcbiAgICAgKiBTeW5jRW5naW5lIHdoZW5ldmVyIHRoZXJlIGFyZSBuZXcgbXV0YXRpb25zIHRvIHByb2Nlc3MuXHJcbiAgICAgKlxyXG4gICAgICogU3RhcnRzIHRoZSB3cml0ZSBzdHJlYW0gaWYgbmVjZXNzYXJ5LlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuZmlsbFdyaXRlUGlwZWxpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBsYXN0QmF0Y2hJZFJldHJpZXZlZCwgYmF0Y2g7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhbkFkZFRvV3JpdGVQaXBlbGluZSgpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEJhdGNoSWRSZXRyaWV2ZWQgPSB0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoID4gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLndyaXRlUGlwZWxpbmVbdGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCAtIDFdLmJhdGNoSWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogQkFUQ0hJRF9VTktOT1dOO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUubmV4dE11dGF0aW9uQmF0Y2gobGFzdEJhdGNoSWRSZXRyaWV2ZWQpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShiYXRjaCA9PT0gbnVsbCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53cml0ZVN0cmVhbS5tYXJrSWRsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRUb1dyaXRlUGlwZWxpbmUoYmF0Y2gpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmZpbGxXcml0ZVBpcGVsaW5lKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG91bGRTdGFydFdyaXRlU3RyZWFtKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRXcml0ZVN0cmVhbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgd2UgY2FuIGFkZCB0byB0aGUgd3JpdGUgcGlwZWxpbmUgKGkuZS4gdGhlIG5ldHdvcmsgaXNcclxuICAgICAqIGVuYWJsZWQgYW5kIHRoZSB3cml0ZSBwaXBlbGluZSBpcyBub3QgZnVsbCkuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5jYW5BZGRUb1dyaXRlUGlwZWxpbmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmNhblVzZU5ldHdvcmsoKSAmJiB0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoIDwgTUFYX1BFTkRJTkdfV1JJVEVTKTtcclxuICAgIH07XHJcbiAgICAvLyBGb3IgdGVzdGluZ1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLm91dHN0YW5kaW5nV3JpdGVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUXVldWVzIGFkZGl0aW9uYWwgd3JpdGVzIHRvIGJlIHNlbnQgdG8gdGhlIHdyaXRlIHN0cmVhbSwgc2VuZGluZyB0aGVtXHJcbiAgICAgKiBpbW1lZGlhdGVseSBpZiB0aGUgd3JpdGUgc3RyZWFtIGlzIGVzdGFibGlzaGVkLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuYWRkVG9Xcml0ZVBpcGVsaW5lID0gZnVuY3Rpb24gKGJhdGNoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuY2FuQWRkVG9Xcml0ZVBpcGVsaW5lKCksICdhZGRUb1dyaXRlUGlwZWxpbmUgY2FsbGVkIHdoZW4gcGlwZWxpbmUgaXMgZnVsbCcpO1xyXG4gICAgICAgIHRoaXMud3JpdGVQaXBlbGluZS5wdXNoKGJhdGNoKTtcclxuICAgICAgICBpZiAodGhpcy53cml0ZVN0cmVhbS5pc09wZW4oKSAmJiB0aGlzLndyaXRlU3RyZWFtLmhhbmRzaGFrZUNvbXBsZXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMud3JpdGVTdHJlYW0ud3JpdGVNdXRhdGlvbnMoYmF0Y2gubXV0YXRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnNob3VsZFN0YXJ0V3JpdGVTdHJlYW0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmNhblVzZU5ldHdvcmsoKSAmJlxyXG4gICAgICAgICAgICAhdGhpcy53cml0ZVN0cmVhbS5pc1N0YXJ0ZWQoKSAmJlxyXG4gICAgICAgICAgICB0aGlzLndyaXRlUGlwZWxpbmUubGVuZ3RoID4gMCk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLnN0YXJ0V3JpdGVTdHJlYW0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc2hvdWxkU3RhcnRXcml0ZVN0cmVhbSgpLCAnc3RhcnRXcml0ZVN0cmVhbSgpIGNhbGxlZCB3aGVuIHNob3VsZFN0YXJ0V3JpdGVTdHJlYW0oKSBpcyBmYWxzZS4nKTtcclxuICAgICAgICB0aGlzLndyaXRlU3RyZWFtLnN0YXJ0KCk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLm9uV3JpdGVTdHJlYW1PcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMud3JpdGVTdHJlYW0ud3JpdGVIYW5kc2hha2UoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLm9uV3JpdGVIYW5kc2hha2VDb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFJlY29yZCB0aGUgc3RyZWFtIHRva2VuLlxyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgLnNldExhc3RTdHJlYW1Ub2tlbih0aGlzLndyaXRlU3RyZWFtLmxhc3RTdHJlYW1Ub2tlbilcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBTZW5kIHRoZSB3cml0ZSBwaXBlbGluZSBub3cgdGhhdCB0aGUgc3RyZWFtIGlzIGVzdGFibGlzaGVkLlxyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gX3RoaXMud3JpdGVQaXBlbGluZTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBiYXRjaCA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIF90aGlzLndyaXRlU3RyZWFtLndyaXRlTXV0YXRpb25zKGJhdGNoLm11dGF0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX3RoaXMuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGVycik7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVmVyaWZpZXMgdGhlIGVycm9yIHRocm93biBieSBhbiBMb2NhbFN0b3JlIG9wZXJhdGlvbi4gSWYgYSBMb2NhbFN0b3JlXHJcbiAgICAgKiBvcGVyYXRpb24gZmFpbHMgYmVjYXVzZSB0aGUgcHJpbWFyeSBsZWFzZSBoYXMgYmVlbiB0YWtlbiBieSBhbm90aGVyIGNsaWVudCxcclxuICAgICAqIHdlIGlnbm9yZSB0aGUgZXJyb3IuIEFsbCBvdGhlciBlcnJvcnMgYXJlIHJlLXRocm93bi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXJyIEFuIGVycm9yIHJldHVybmVkIGJ5IGEgTG9jYWxTdG9yZSBvcGVyYXRpb24uXHJcbiAgICAgKiBAcmV0dXJuIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIHdlIHJlY292ZXJlZCwgb3IgdGhlIG9yaWdpbmFsIGVycm9yLlxyXG4gICAgICovXHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgIGlmIChpc1ByaW1hcnlMZWFzZUxvc3RFcnJvcihlcnIpKSB7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckOCwgJ1VuZXhwZWN0ZWRseSBsb3N0IHByaW1hcnkgbGVhc2UnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLm9uTXV0YXRpb25SZXN1bHQgPSBmdW5jdGlvbiAoY29tbWl0VmVyc2lvbiwgcmVzdWx0cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gVGhpcyBpcyBhIHJlc3BvbnNlIHRvIGEgd3JpdGUgY29udGFpbmluZyBtdXRhdGlvbnMgYW5kIHNob3VsZCBiZVxyXG4gICAgICAgIC8vIGNvcnJlbGF0ZWQgdG8gdGhlIGZpcnN0IHdyaXRlIGluIG91ciB3cml0ZSBwaXBlbGluZS5cclxuICAgICAgICBhc3NlcnQodGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDAsICdHb3QgcmVzdWx0IGZvciBlbXB0eSB3cml0ZSBwaXBlbGluZScpO1xyXG4gICAgICAgIHZhciBiYXRjaCA9IHRoaXMud3JpdGVQaXBlbGluZS5zaGlmdCgpO1xyXG4gICAgICAgIHZhciBzdWNjZXNzID0gTXV0YXRpb25CYXRjaFJlc3VsdC5mcm9tKGJhdGNoLCBjb21taXRWZXJzaW9uLCByZXN1bHRzLCB0aGlzLndyaXRlU3RyZWFtLmxhc3RTdHJlYW1Ub2tlbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5hcHBseVN1Y2Nlc3NmdWxXcml0ZShzdWNjZXNzKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHdpdGggdGhlIGNvbXBsZXRpb24gb2YgdGhpcyBtdXRhdGlvbiBhbm90aGVyXHJcbiAgICAgICAgICAgIC8vIHNsb3QgaGFzIGZyZWVkIHVwLlxyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZmlsbFdyaXRlUGlwZWxpbmUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUub25Xcml0ZVN0cmVhbUNsb3NlID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBlcnJvckhhbmRsaW5nO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnJvciQkMSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gR3JhY2VmdWwgc3RvcCAoZHVlIHRvIHN0b3AoKSBvciBpZGxlIHRpbWVvdXQpLiBNYWtlIHN1cmUgdGhhdCdzXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZGVzaXJhYmxlLlxyXG4gICAgICAgICAgICAgICAgICAgIGFzc2VydCghdGhpcy5zaG91bGRTdGFydFdyaXRlU3RyZWFtKCksICdXcml0ZSBzdHJlYW0gd2FzIHN0b3BwZWQgZ3JhY2VmdWxseSB3aGlsZSBzdGlsbCBuZWVkZWQuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgd3JpdGUgc3RyZWFtIGNsb3NlZCBkdWUgdG8gYW4gZXJyb3IsIGludm9rZSB0aGUgZXJyb3IgY2FsbGJhY2tzIGlmXHJcbiAgICAgICAgICAgICAgICAvLyB0aGVyZSBhcmUgcGVuZGluZyB3cml0ZXMuXHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IkJDEgJiYgdGhpcy53cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvckhhbmRsaW5nID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndyaXRlU3RyZWFtLmhhbmRzaGFrZUNvbXBsZXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgZXJyb3IgYWZmZWN0cyB0aGUgYWN0dWFsIHdyaXRlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvckhhbmRsaW5nID0gdGhpcy5oYW5kbGVXcml0ZUVycm9yKGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIHdhcyBhbiBlcnJvciBiZWZvcmUgdGhlIGhhbmRzaGFrZSBoYXMgZmluaXNoZWQsIGl0J3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9zc2libGUgdGhhdCB0aGUgc2VydmVyIGlzIHVuYWJsZSB0byBwcm9jZXNzIHRoZSBzdHJlYW0gdG9rZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UncmUgc2VuZGluZy4gKFBlcmhhcHMgaXQncyB0b28gb2xkPylcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JIYW5kbGluZyA9IHRoaXMuaGFuZGxlSGFuZHNoYWtlRXJyb3IoZXJyb3IkJDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZXJyb3JIYW5kbGluZy50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSB3cml0ZSBzdHJlYW0gbWlnaHQgaGF2ZSBiZWVuIHN0YXJ0ZWQgYnkgcmVmaWxsaW5nIHRoZSB3cml0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGlwZWxpbmUgZm9yIGZhaWxlZCB3cml0ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5zaG91bGRTdGFydFdyaXRlU3RyZWFtKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdGFydFdyaXRlU3RyZWFtKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmhhbmRsZUhhbmRzaGFrZUVycm9yID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIHRva2VuIGlmIGl0J3MgYSBwZXJtYW5lbnQgZXJyb3Igb3IgdGhlIGVycm9yIGNvZGUgaXNcclxuICAgICAgICAgICAgICAgIC8vIEFCT1JURUQsIHNpZ25hbGluZyB0aGUgd3JpdGUgc3RyZWFtIGlzIG5vIGxvbmdlciB2YWxpZC5cclxuICAgICAgICAgICAgICAgIGlmIChpc1Blcm1hbmVudEVycm9yKGVycm9yJCQxLmNvZGUpIHx8IGVycm9yJCQxLmNvZGUgPT09IENvZGUuQUJPUlRFRCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckOCwgJ1JlbW90ZVN0b3JlIGVycm9yIGJlZm9yZSBjb21wbGV0ZWQgaGFuZHNoYWtlOyByZXNldHRpbmcgc3RyZWFtIHRva2VuOiAnLCB0aGlzLndyaXRlU3RyZWFtLmxhc3RTdHJlYW1Ub2tlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cml0ZVN0cmVhbS5sYXN0U3RyZWFtVG9rZW4gPSBlbXB0eUJ5dGVTdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0TGFzdFN0cmVhbVRva2VuKGVtcHR5Qnl0ZVN0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIF90aGlzLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlcnIpOyB9KV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTb21lIG90aGVyIGVycm9yLCBkb24ndCByZXNldCBzdHJlYW0gdG9rZW4uIE91ciBzdHJlYW0gbG9naWMgd2lsbFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGp1c3QgcmV0cnkgd2l0aCBleHBvbmVudGlhbCBiYWNrb2ZmLlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuaGFuZGxlV3JpdGVFcnJvciA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgYmF0Y2g7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzUGVybWFuZW50RXJyb3IoZXJyb3IkJDEuY29kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBiYXRjaCA9IHRoaXMud3JpdGVQaXBlbGluZS5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEluIHRoaXMgY2FzZSBpdCdzIGFsc28gdW5saWtlbHkgdGhhdCB0aGUgc2VydmVyIGl0c2VsZiBpcyBtZWx0aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZG93biAtLSB0aGlzIHdhcyBqdXN0IGEgYmFkIHJlcXVlc3Qgc28gaW5oaWJpdCBiYWNrb2ZmIG9uIHRoZSBuZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzdGFydC5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndyaXRlU3RyZWFtLmluaGliaXRCYWNrb2ZmKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuc3luY0VuZ2luZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlamVjdEZhaWxlZFdyaXRlKGJhdGNoLmJhdGNoSWQsIGVycm9yJCQxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHdpdGggdGhlIGNvbXBsZXRpb24gb2YgdGhpcyBtdXRhdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5vdGhlciBzbG90IGhhcyBmcmVlZCB1cC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5maWxsV3JpdGVQaXBlbGluZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUcmFuc2llbnQgZXJyb3IsIGp1c3QgbGV0IHRoZSByZXRyeSBsb2dpYyBraWNrIGluLlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZW1vdGVTdG9yZS5wcm90b3R5cGUuY3JlYXRlVHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUcmFuc2FjdGlvbih0aGlzLmRhdGFzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgUmVtb3RlU3RvcmUucHJvdG90eXBlLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhblVzZU5ldHdvcmsoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRlYXIgZG93biBhbmQgcmUtY3JlYXRlIG91ciBuZXR3b3JrIHN0cmVhbXMuIFRoaXMgd2lsbCBlbnN1cmUgd2UgZ2V0IGEgZnJlc2ggYXV0aCB0b2tlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmb3IgdGhlIG5ldyB1c2VyIGFuZCByZS1maWxsIHRoZSB3cml0ZSBwaXBlbGluZSB3aXRoIG5ldyBtdXRhdGlvbnMgZnJvbSB0aGUgTG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAoc2luY2UgbXV0YXRpb25zIGFyZSBwZXItdXNlcikuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckOCwgJ1JlbW90ZVN0b3JlIHJlc3RhcnRpbmcgc3RyZWFtcyBmb3IgbmV3IGNyZWRlbnRpYWwnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXR3b3JrRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmRpc2FibGVOZXR3b3JrSW50ZXJuYWwoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25saW5lU3RhdGVUcmFja2VyLnNldChPbmxpbmVTdGF0ZS5Vbmtub3duKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbmFibGVOZXR3b3JrKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVG9nZ2xlcyB0aGUgbmV0d29yayBzdGF0ZSB3aGVuIHRoZSBjbGllbnQgZ2FpbnMgb3IgbG9zZXMgaXRzIHByaW1hcnkgbGVhc2UuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZVN0b3JlLnByb3RvdHlwZS5hcHBseVByaW1hcnlTdGF0ZSA9IGZ1bmN0aW9uIChpc1ByaW1hcnkpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUHJpbWFyeSA9IGlzUHJpbWFyeTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaXNQcmltYXJ5ICYmIHRoaXMubmV0d29ya0VuYWJsZWQpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5lbmFibGVOZXR3b3JrKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWlzUHJpbWFyeSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZGlzYWJsZU5ldHdvcmtJbnRlcm5hbCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZVRyYWNrZXIuc2V0KE9ubGluZVN0YXRlLlVua25vd24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSZW1vdGVTdG9yZTtcclxufSgpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBIb2xkcyB0aGUgbGlzdGVuZXJzIGFuZCB0aGUgbGFzdCByZWNlaXZlZCBWaWV3U25hcHNob3QgZm9yIGEgcXVlcnkgYmVpbmdcclxuICogdHJhY2tlZCBieSBFdmVudE1hbmFnZXIuXHJcbiAqL1xyXG52YXIgUXVlcnlMaXN0ZW5lcnNJbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlMaXN0ZW5lcnNJbmZvKCkge1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gW107XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUXVlcnlMaXN0ZW5lcnNJbmZvO1xyXG59KCkpO1xyXG4vKipcclxuICogRXZlbnRNYW5hZ2VyIGlzIHJlc3BvbnNpYmxlIGZvciBtYXBwaW5nIHF1ZXJpZXMgdG8gcXVlcnkgZXZlbnQgZW1pdHRlcnMuXHJcbiAqIEl0IGhhbmRsZXMgXCJmYW4tb3V0XCIuIC0tIElkZW50aWNhbCBxdWVyaWVzIHdpbGwgcmUtdXNlIHRoZSBzYW1lIHdhdGNoIG9uIHRoZVxyXG4gKiBiYWNrZW5kLlxyXG4gKi9cclxudmFyIEV2ZW50TWFuYWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEV2ZW50TWFuYWdlcihzeW5jRW5naW5lKSB7XHJcbiAgICAgICAgdGhpcy5zeW5jRW5naW5lID0gc3luY0VuZ2luZTtcclxuICAgICAgICB0aGlzLnF1ZXJpZXMgPSBuZXcgT2JqZWN0TWFwKGZ1bmN0aW9uIChxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBxLmNhbm9uaWNhbElkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZSA9IE9ubGluZVN0YXRlLlVua25vd247XHJcbiAgICAgICAgdGhpcy5zeW5jRW5naW5lLnN1YnNjcmliZSh0aGlzKTtcclxuICAgIH1cclxuICAgIEV2ZW50TWFuYWdlci5wcm90b3R5cGUubGlzdGVuID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgdmFyIHF1ZXJ5ID0gbGlzdGVuZXIucXVlcnk7XHJcbiAgICAgICAgdmFyIGZpcnN0TGlzdGVuID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIHF1ZXJ5SW5mbyA9IHRoaXMucXVlcmllcy5nZXQocXVlcnkpO1xyXG4gICAgICAgIGlmICghcXVlcnlJbmZvKSB7XHJcbiAgICAgICAgICAgIGZpcnN0TGlzdGVuID0gdHJ1ZTtcclxuICAgICAgICAgICAgcXVlcnlJbmZvID0gbmV3IFF1ZXJ5TGlzdGVuZXJzSW5mbygpO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMuc2V0KHF1ZXJ5LCBxdWVyeUluZm8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBxdWVyeUluZm8ubGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpO1xyXG4gICAgICAgIGxpc3RlbmVyLmFwcGx5T25saW5lU3RhdGVDaGFuZ2UodGhpcy5vbmxpbmVTdGF0ZSk7XHJcbiAgICAgICAgaWYgKHF1ZXJ5SW5mby52aWV3U25hcClcclxuICAgICAgICAgICAgbGlzdGVuZXIub25WaWV3U25hcHNob3QocXVlcnlJbmZvLnZpZXdTbmFwKTtcclxuICAgICAgICBpZiAoZmlyc3RMaXN0ZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5saXN0ZW4ocXVlcnkpLnRoZW4oZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgICAgICBxdWVyeUluZm8udGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRJZDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHF1ZXJ5SW5mby50YXJnZXRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEV2ZW50TWFuYWdlci5wcm90b3R5cGUudW5saXN0ZW4gPSBmdW5jdGlvbiAobGlzdGVuZXIpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5LCBsYXN0TGlzdGVuLCBxdWVyeUluZm8sIGk7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgcXVlcnkgPSBsaXN0ZW5lci5xdWVyeTtcclxuICAgICAgICAgICAgICAgIGxhc3RMaXN0ZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHF1ZXJ5SW5mbyA9IHRoaXMucXVlcmllcy5nZXQocXVlcnkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXJ5SW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBxdWVyeUluZm8ubGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlJbmZvLmxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RMaXN0ZW4gPSBxdWVyeUluZm8ubGlzdGVuZXJzLmxlbmd0aCA9PT0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobGFzdExpc3Rlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcmllcy5kZWxldGUocXVlcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnN5bmNFbmdpbmUudW5saXN0ZW4ocXVlcnkpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRXZlbnRNYW5hZ2VyLnByb3RvdHlwZS5vbldhdGNoQ2hhbmdlID0gZnVuY3Rpb24gKHZpZXdTbmFwcykge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgdmlld1NuYXBzXzEgPSB2aWV3U25hcHM7IF9pIDwgdmlld1NuYXBzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB2aWV3U25hcCA9IHZpZXdTbmFwc18xW19pXTtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gdmlld1NuYXAucXVlcnk7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeUluZm8gPSB0aGlzLnF1ZXJpZXMuZ2V0KHF1ZXJ5KTtcclxuICAgICAgICAgICAgaWYgKHF1ZXJ5SW5mbykge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBfYiA9IHF1ZXJ5SW5mby5saXN0ZW5lcnM7IF9hIDwgX2IubGVuZ3RoOyBfYSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX2JbX2FdO1xyXG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVyLm9uVmlld1NuYXBzaG90KHZpZXdTbmFwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHF1ZXJ5SW5mby52aWV3U25hcCA9IHZpZXdTbmFwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEV2ZW50TWFuYWdlci5wcm90b3R5cGUub25XYXRjaEVycm9yID0gZnVuY3Rpb24gKHF1ZXJ5LCBlcnJvcikge1xyXG4gICAgICAgIHZhciBxdWVyeUluZm8gPSB0aGlzLnF1ZXJpZXMuZ2V0KHF1ZXJ5KTtcclxuICAgICAgICBpZiAocXVlcnlJbmZvKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBxdWVyeUluZm8ubGlzdGVuZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgbGlzdGVuZXIub25FcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gUmVtb3ZlIGFsbCBsaXN0ZW5lcnMuIE5PVEU6IFdlIGRvbid0IG5lZWQgdG8gY2FsbCBzeW5jRW5naW5lLnVubGlzdGVuKClcclxuICAgICAgICAvLyBhZnRlciBhbiBlcnJvci5cclxuICAgICAgICB0aGlzLnF1ZXJpZXMuZGVsZXRlKHF1ZXJ5KTtcclxuICAgIH07XHJcbiAgICBFdmVudE1hbmFnZXIucHJvdG90eXBlLm9uT25saW5lU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gb25saW5lU3RhdGU7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKF8sIHF1ZXJ5SW5mbykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gcXVlcnlJbmZvLmxpc3RlbmVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIGxpc3RlbmVyLmFwcGx5T25saW5lU3RhdGVDaGFuZ2Uob25saW5lU3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEV2ZW50TWFuYWdlcjtcclxufSgpKTtcclxuLyoqXHJcbiAqIFF1ZXJ5TGlzdGVuZXIgdGFrZXMgYSBzZXJpZXMgb2YgaW50ZXJuYWwgdmlldyBzbmFwc2hvdHMgYW5kIGRldGVybWluZXNcclxuICogd2hlbiB0byByYWlzZSB0aGUgZXZlbnQuXHJcbiAqXHJcbiAqIEl0IHVzZXMgYW4gT2JzZXJ2ZXIgdG8gZGlzcGF0Y2ggZXZlbnRzLlxyXG4gKi9cclxudmFyIFF1ZXJ5TGlzdGVuZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBRdWVyeUxpc3RlbmVyKHF1ZXJ5LCBxdWVyeU9ic2VydmVyLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHRoaXMucXVlcnlPYnNlcnZlciA9IHF1ZXJ5T2JzZXJ2ZXI7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogSW5pdGlhbCBzbmFwc2hvdHMgKGUuZy4gZnJvbSBjYWNoZSkgbWF5IG5vdCBiZSBwcm9wYWdhdGVkIHRvIHRoZSB3cmFwcGVkXHJcbiAgICAgICAgICogb2JzZXJ2ZXIuIFRoaXMgZmxhZyBpcyBzZXQgdG8gdHJ1ZSBvbmNlIHdlJ3ZlIGFjdHVhbGx5IHJhaXNlZCBhbiBldmVudC5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnJhaXNlZEluaXRpYWxFdmVudCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGUgPSBPbmxpbmVTdGF0ZS5Vbmtub3duO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICB9XHJcbiAgICBRdWVyeUxpc3RlbmVyLnByb3RvdHlwZS5vblZpZXdTbmFwc2hvdCA9IGZ1bmN0aW9uIChzbmFwKSB7XHJcbiAgICAgICAgYXNzZXJ0KHNuYXAuZG9jQ2hhbmdlcy5sZW5ndGggPiAwIHx8IHNuYXAuc3luY1N0YXRlQ2hhbmdlZCwgJ1dlIGdvdCBhIG5ldyBzbmFwc2hvdCB3aXRoIG5vIGNoYW5nZXM/Jyk7XHJcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcykge1xyXG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIG1ldGFkYXRhIG9ubHkgY2hhbmdlcy5cclxuICAgICAgICAgICAgdmFyIGRvY0NoYW5nZXMgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHNuYXAuZG9jQ2hhbmdlczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBkb2NDaGFuZ2UgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZG9jQ2hhbmdlLnR5cGUgIT09IENoYW5nZVR5cGUuTWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb2NDaGFuZ2VzLnB1c2goZG9jQ2hhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzbmFwID0gbmV3IFZpZXdTbmFwc2hvdChzbmFwLnF1ZXJ5LCBzbmFwLmRvY3MsIHNuYXAub2xkRG9jcywgZG9jQ2hhbmdlcywgc25hcC5tdXRhdGVkS2V5cywgc25hcC5mcm9tQ2FjaGUsIHNuYXAuc3luY1N0YXRlQ2hhbmdlZCwgXHJcbiAgICAgICAgICAgIC8qIGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzPSAqLyB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnJhaXNlZEluaXRpYWxFdmVudCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zaG91bGRSYWlzZUluaXRpYWxFdmVudChzbmFwLCB0aGlzLm9ubGluZVN0YXRlKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yYWlzZUluaXRpYWxFdmVudChzbmFwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLnNob3VsZFJhaXNlRXZlbnQoc25hcCkpIHtcclxuICAgICAgICAgICAgdGhpcy5xdWVyeU9ic2VydmVyLm5leHQoc25hcCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc25hcCA9IHNuYXA7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlMaXN0ZW5lci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIHRoaXMucXVlcnlPYnNlcnZlci5lcnJvcihlcnJvcik7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlMaXN0ZW5lci5wcm90b3R5cGUuYXBwbHlPbmxpbmVTdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGUgPSBvbmxpbmVTdGF0ZTtcclxuICAgICAgICBpZiAodGhpcy5zbmFwICYmXHJcbiAgICAgICAgICAgICF0aGlzLnJhaXNlZEluaXRpYWxFdmVudCAmJlxyXG4gICAgICAgICAgICB0aGlzLnNob3VsZFJhaXNlSW5pdGlhbEV2ZW50KHRoaXMuc25hcCwgb25saW5lU3RhdGUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmFpc2VJbml0aWFsRXZlbnQodGhpcy5zbmFwKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUXVlcnlMaXN0ZW5lci5wcm90b3R5cGUuc2hvdWxkUmFpc2VJbml0aWFsRXZlbnQgPSBmdW5jdGlvbiAoc25hcCwgb25saW5lU3RhdGUpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMucmFpc2VkSW5pdGlhbEV2ZW50LCAnRGV0ZXJtaW5pbmcgd2hldGhlciB0byByYWlzZSBmaXJzdCBldmVudCBidXQgYWxyZWFkeSBoYWQgZmlyc3QgZXZlbnQnKTtcclxuICAgICAgICAvLyBBbHdheXMgcmFpc2UgdGhlIGZpcnN0IGV2ZW50IHdoZW4gd2UncmUgc3luY2VkXHJcbiAgICAgICAgaWYgKCFzbmFwLmZyb21DYWNoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gTk9URTogV2UgY29uc2lkZXIgT25saW5lU3RhdGUuVW5rbm93biBhcyBvbmxpbmUgKGl0IHNob3VsZCBiZWNvbWUgT2ZmbGluZVxyXG4gICAgICAgIC8vIG9yIE9ubGluZSBpZiB3ZSB3YWl0IGxvbmcgZW5vdWdoKS5cclxuICAgICAgICB2YXIgbWF5YmVPbmxpbmUgPSBvbmxpbmVTdGF0ZSAhPT0gT25saW5lU3RhdGUuT2ZmbGluZTtcclxuICAgICAgICAvLyBEb24ndCByYWlzZSB0aGUgZXZlbnQgaWYgd2UncmUgb25saW5lLCBhcmVuJ3Qgc3luY2VkIHlldCAoY2hlY2tlZFxyXG4gICAgICAgIC8vIGFib3ZlKSBhbmQgYXJlIHdhaXRpbmcgZm9yIGEgc3luYy5cclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLndhaXRGb3JTeW5jV2hlbk9ubGluZSAmJiBtYXliZU9ubGluZSkge1xyXG4gICAgICAgICAgICBhc3NlcnQoc25hcC5mcm9tQ2FjaGUsICdXYWl0aW5nIGZvciBzeW5jLCBidXQgc25hcHNob3QgaXMgbm90IGZyb20gY2FjaGUnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBSYWlzZSBkYXRhIGZyb20gY2FjaGUgaWYgd2UgaGF2ZSBhbnkgZG9jdW1lbnRzIG9yIHdlIGFyZSBvZmZsaW5lXHJcbiAgICAgICAgcmV0dXJuICFzbmFwLmRvY3MuaXNFbXB0eSgpIHx8IG9ubGluZVN0YXRlID09PSBPbmxpbmVTdGF0ZS5PZmZsaW5lO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5TGlzdGVuZXIucHJvdG90eXBlLnNob3VsZFJhaXNlRXZlbnQgPSBmdW5jdGlvbiAoc25hcCkge1xyXG4gICAgICAgIC8vIFdlIGRvbid0IG5lZWQgdG8gaGFuZGxlIGluY2x1ZGVEb2N1bWVudE1ldGFkYXRhQ2hhbmdlcyBoZXJlIGJlY2F1c2VcclxuICAgICAgICAvLyB0aGUgTWV0YWRhdGEgb25seSBjaGFuZ2VzIGhhdmUgYWxyZWFkeSBiZWVuIHN0cmlwcGVkIG91dCBpZiBuZWVkZWQuXHJcbiAgICAgICAgLy8gQXQgdGhpcyBwb2ludCB0aGUgb25seSBjaGFuZ2VzIHdlIHdpbGwgc2VlIGFyZSB0aGUgb25lcyB3ZSBzaG91bGRcclxuICAgICAgICAvLyBwcm9wYWdhdGUuXHJcbiAgICAgICAgaWYgKHNuYXAuZG9jQ2hhbmdlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaGFzUGVuZGluZ1dyaXRlc0NoYW5nZWQgPSB0aGlzLnNuYXAgJiYgdGhpcy5zbmFwLmhhc1BlbmRpbmdXcml0ZXMgIT09IHNuYXAuaGFzUGVuZGluZ1dyaXRlcztcclxuICAgICAgICBpZiAoc25hcC5zeW5jU3RhdGVDaGFuZ2VkIHx8IGhhc1BlbmRpbmdXcml0ZXNDaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyA9PT0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gR2VuZXJhbGx5IHdlIHNob3VsZCBoYXZlIGhpdCBvbmUgb2YgdGhlIGNhc2VzIGFib3ZlLCBidXQgaXQncyBwb3NzaWJsZVxyXG4gICAgICAgIC8vIHRvIGdldCBoZXJlIGlmIHRoZXJlIHdlcmUgb25seSBtZXRhZGF0YSBkb2NDaGFuZ2VzIGFuZCB0aGV5IGdvdFxyXG4gICAgICAgIC8vIHN0cmlwcGVkIG91dC5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlMaXN0ZW5lci5wcm90b3R5cGUucmFpc2VJbml0aWFsRXZlbnQgPSBmdW5jdGlvbiAoc25hcCkge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5yYWlzZWRJbml0aWFsRXZlbnQsICdUcnlpbmcgdG8gcmFpc2UgaW5pdGlhbCBldmVudHMgZm9yIHNlY29uZCB0aW1lJyk7XHJcbiAgICAgICAgc25hcCA9IFZpZXdTbmFwc2hvdC5mcm9tSW5pdGlhbERvY3VtZW50cyhzbmFwLnF1ZXJ5LCBzbmFwLmRvY3MsIHNuYXAubXV0YXRlZEtleXMsIHNuYXAuZnJvbUNhY2hlKTtcclxuICAgICAgICB0aGlzLnJhaXNlZEluaXRpYWxFdmVudCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5xdWVyeU9ic2VydmVyLm5leHQoc25hcCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5TGlzdGVuZXI7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQSBzZXQgb2YgY2hhbmdlcyB0byB3aGF0IGRvY3VtZW50cyBhcmUgY3VycmVudGx5IGluIHZpZXcgYW5kIG91dCBvZiB2aWV3IGZvclxyXG4gKiBhIGdpdmVuIHF1ZXJ5LiBUaGVzZSBjaGFuZ2VzIGFyZSBzZW50IHRvIHRoZSBMb2NhbFN0b3JlIGJ5IHRoZSBWaWV3ICh2aWFcclxuICogdGhlIFN5bmNFbmdpbmUpIGFuZCBhcmUgdXNlZCB0byBwaW4gLyB1bnBpbiBkb2N1bWVudHMgYXMgYXBwcm9wcmlhdGUuXHJcbiAqL1xyXG52YXIgTG9jYWxWaWV3Q2hhbmdlcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExvY2FsVmlld0NoYW5nZXModGFyZ2V0SWQsIGFkZGVkS2V5cywgcmVtb3ZlZEtleXMpIHtcclxuICAgICAgICB0aGlzLnRhcmdldElkID0gdGFyZ2V0SWQ7XHJcbiAgICAgICAgdGhpcy5hZGRlZEtleXMgPSBhZGRlZEtleXM7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVkS2V5cyA9IHJlbW92ZWRLZXlzO1xyXG4gICAgfVxyXG4gICAgTG9jYWxWaWV3Q2hhbmdlcy5mcm9tU25hcHNob3QgPSBmdW5jdGlvbiAodGFyZ2V0SWQsIHZpZXdTbmFwc2hvdCkge1xyXG4gICAgICAgIHZhciBhZGRlZEtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHZhciByZW1vdmVkS2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHZpZXdTbmFwc2hvdC5kb2NDaGFuZ2VzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgZG9jQ2hhbmdlID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGRvY0NoYW5nZS50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuQWRkZWQ6XHJcbiAgICAgICAgICAgICAgICAgICAgYWRkZWRLZXlzID0gYWRkZWRLZXlzLmFkZChkb2NDaGFuZ2UuZG9jLmtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuUmVtb3ZlZDpcclxuICAgICAgICAgICAgICAgICAgICByZW1vdmVkS2V5cyA9IHJlbW92ZWRLZXlzLmFkZChkb2NDaGFuZ2UuZG9jLmtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgTG9jYWxWaWV3Q2hhbmdlcyh0YXJnZXRJZCwgYWRkZWRLZXlzLCByZW1vdmVkS2V5cyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExvY2FsVmlld0NoYW5nZXM7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgQWRkZWRMaW1ib0RvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQWRkZWRMaW1ib0RvY3VtZW50KGtleSkge1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEFkZGVkTGltYm9Eb2N1bWVudDtcclxufSgpKTtcclxudmFyIFJlbW92ZWRMaW1ib0RvY3VtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVtb3ZlZExpbWJvRG9jdW1lbnQoa2V5KSB7XHJcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUmVtb3ZlZExpbWJvRG9jdW1lbnQ7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBWaWV3IGlzIHJlc3BvbnNpYmxlIGZvciBjb21wdXRpbmcgdGhlIGZpbmFsIG1lcmdlZCB0cnV0aCBvZiB3aGF0IGRvY3MgYXJlIGluXHJcbiAqIGEgcXVlcnkuIEl0IGdldHMgbm90aWZpZWQgb2YgbG9jYWwgYW5kIHJlbW90ZSBjaGFuZ2VzIHRvIGRvY3MsIGFuZCBhcHBsaWVzXHJcbiAqIHRoZSBxdWVyeSBmaWx0ZXJzIGFuZCBsaW1pdHMgdG8gZGV0ZXJtaW5lIHRoZSBtb3N0IGNvcnJlY3QgcG9zc2libGUgcmVzdWx0cy5cclxuICovXHJcbnZhciBWaWV3ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVmlldyhxdWVyeSwgXHJcbiAgICAvKiogRG9jdW1lbnRzIGluY2x1ZGVkIGluIHRoZSByZW1vdGUgdGFyZ2V0ICovXHJcbiAgICBfc3luY2VkRG9jdW1lbnRzKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHRoaXMuX3N5bmNlZERvY3VtZW50cyA9IF9zeW5jZWREb2N1bWVudHM7XHJcbiAgICAgICAgdGhpcy5zeW5jU3RhdGUgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgZmxhZyB3aGV0aGVyIHRoZSB2aWV3IGlzIGN1cnJlbnQgd2l0aCB0aGUgYmFja2VuZC4gQSB2aWV3IGlzIGNvbnNpZGVyZWRcclxuICAgICAgICAgKiBjdXJyZW50IGFmdGVyIGl0IGhhcyBzZWVuIHRoZSBjdXJyZW50IGZsYWcgZnJvbSB0aGUgYmFja2VuZCBhbmQgZGlkIG5vdFxyXG4gICAgICAgICAqIGxvc2UgY29uc2lzdGVuY3kgd2l0aGluIHRoZSB3YXRjaCBzdHJlYW0gKGUuZy4gYmVjYXVzZSBvZiBhbiBleGlzdGVuY2VcclxuICAgICAgICAgKiBmaWx0ZXIgbWlzbWF0Y2gpLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IGZhbHNlO1xyXG4gICAgICAgIC8qKiBEb2N1bWVudHMgaW4gdGhlIHZpZXcgYnV0IG5vdCBpbiB0aGUgcmVtb3RlIHRhcmdldCAqL1xyXG4gICAgICAgIHRoaXMubGltYm9Eb2N1bWVudHMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIC8qKiBEb2N1bWVudCBLZXlzIHRoYXQgaGF2ZSBsb2NhbCBjaGFuZ2VzICovXHJcbiAgICAgICAgdGhpcy5tdXRhdGVkS2V5cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudFNldCA9IG5ldyBEb2N1bWVudFNldChxdWVyeS5kb2NDb21wYXJhdG9yLmJpbmQocXVlcnkpKTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3LnByb3RvdHlwZSwgXCJzeW5jZWREb2N1bWVudHNcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBzZXQgb2YgcmVtb3RlIGRvY3VtZW50cyB0aGF0IHRoZSBzZXJ2ZXIgaGFzIHRvbGQgdXMgYmVsb25ncyB0byB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aFxyXG4gICAgICAgICAqIHRoaXMgdmlldy5cclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N5bmNlZERvY3VtZW50cztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHNldCBvZiBkb2MgY2hhbmdlcywgYXBwbGllcyB0aGUgcXVlcnkgbGltaXQsIGFuZCBjb21wdXRlc1xyXG4gICAgICogd2hhdCB0aGUgbmV3IHJlc3VsdHMgc2hvdWxkIGJlLCB3aGF0IHRoZSBjaGFuZ2VzIHdlcmUsIGFuZCB3aGV0aGVyIHdlIG1heVxyXG4gICAgICogbmVlZCB0byBnbyBiYWNrIHRvIHRoZSBsb2NhbCBjYWNoZSBmb3IgbW9yZSByZXN1bHRzLiBEb2VzIG5vdCBtYWtlIGFueVxyXG4gICAgICogY2hhbmdlcyB0byB0aGUgdmlldy5cclxuICAgICAqIEBwYXJhbSBkb2NDaGFuZ2VzIFRoZSBkb2MgY2hhbmdlcyB0byBhcHBseSB0byB0aGlzIHZpZXcuXHJcbiAgICAgKiBAcGFyYW0gcHJldmlvdXNDaGFuZ2VzIElmIHRoaXMgaXMgYmVpbmcgY2FsbGVkIHdpdGggYSByZWZpbGwsIHRoZW4gc3RhcnRcclxuICAgICAqICAgICAgICB3aXRoIHRoaXMgc2V0IG9mIGRvY3MgYW5kIGNoYW5nZXMgaW5zdGVhZCBvZiB0aGUgY3VycmVudCB2aWV3LlxyXG4gICAgICogQHJldHVybiBhIG5ldyBzZXQgb2YgZG9jcywgY2hhbmdlcywgYW5kIHJlZmlsbCBmbGFnLlxyXG4gICAgICovXHJcbiAgICBWaWV3LnByb3RvdHlwZS5jb21wdXRlRG9jQ2hhbmdlcyA9IGZ1bmN0aW9uIChkb2NDaGFuZ2VzLCBwcmV2aW91c0NoYW5nZXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjaGFuZ2VTZXQgPSBwcmV2aW91c0NoYW5nZXNcclxuICAgICAgICAgICAgPyBwcmV2aW91c0NoYW5nZXMuY2hhbmdlU2V0XHJcbiAgICAgICAgICAgIDogbmV3IERvY3VtZW50Q2hhbmdlU2V0KCk7XHJcbiAgICAgICAgdmFyIG9sZERvY3VtZW50U2V0ID0gcHJldmlvdXNDaGFuZ2VzXHJcbiAgICAgICAgICAgID8gcHJldmlvdXNDaGFuZ2VzLmRvY3VtZW50U2V0XHJcbiAgICAgICAgICAgIDogdGhpcy5kb2N1bWVudFNldDtcclxuICAgICAgICB2YXIgbmV3TXV0YXRlZEtleXMgPSBwcmV2aW91c0NoYW5nZXNcclxuICAgICAgICAgICAgPyBwcmV2aW91c0NoYW5nZXMubXV0YXRlZEtleXNcclxuICAgICAgICAgICAgOiB0aGlzLm11dGF0ZWRLZXlzO1xyXG4gICAgICAgIHZhciBuZXdEb2N1bWVudFNldCA9IG9sZERvY3VtZW50U2V0O1xyXG4gICAgICAgIHZhciBuZWVkc1JlZmlsbCA9IGZhbHNlO1xyXG4gICAgICAgIC8vIFRyYWNrIHRoZSBsYXN0IGRvYyBpbiBhIChmdWxsKSBsaW1pdC4gVGhpcyBpcyBuZWNlc3NhcnksIGJlY2F1c2Ugc29tZVxyXG4gICAgICAgIC8vIHVwZGF0ZSAoYSBkZWxldGUsIG9yIGFuIHVwZGF0ZSBtb3ZpbmcgYSBkb2MgcGFzdCB0aGUgb2xkIGxpbWl0KSBtaWdodFxyXG4gICAgICAgIC8vIG1lYW4gdGhlcmUgaXMgc29tZSBvdGhlciBkb2N1bWVudCBpbiB0aGUgbG9jYWwgY2FjaGUgdGhhdCBlaXRoZXIgc2hvdWxkXHJcbiAgICAgICAgLy8gY29tZSAoMSkgYmV0d2VlbiB0aGUgb2xkIGxhc3QgbGltaXQgZG9jIGFuZCB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZVxyXG4gICAgICAgIC8vIGNhc2Ugb2YgdXBkYXRlcywgb3IgKDIpIGFmdGVyIHRoZSBuZXcgbGFzdCBkb2N1bWVudCwgaW4gdGhlIGNhc2Ugb2ZcclxuICAgICAgICAvLyBkZWxldGVzLiBTbyB3ZSBrZWVwIHRoaXMgZG9jIGF0IHRoZSBvbGQgbGltaXQgdG8gY29tcGFyZSB0aGUgdXBkYXRlcyB0by5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIE5vdGUgdGhhdCB0aGlzIHNob3VsZCBuZXZlciBnZXQgdXNlZCBpbiBhIHJlZmlsbCAod2hlbiBwcmV2aW91c0NoYW5nZXMgaXNcclxuICAgICAgICAvLyBzZXQpLCBiZWNhdXNlIHRoZXJlIHdpbGwgb25seSBiZSBhZGRzIC0tIG5vIGRlbGV0ZXMgb3IgdXBkYXRlcy5cclxuICAgICAgICB2YXIgbGFzdERvY0luTGltaXQgPSB0aGlzLnF1ZXJ5Lmhhc0xpbWl0KCkgJiYgb2xkRG9jdW1lbnRTZXQuc2l6ZSA9PT0gdGhpcy5xdWVyeS5saW1pdFxyXG4gICAgICAgICAgICA/IG9sZERvY3VtZW50U2V0Lmxhc3QoKVxyXG4gICAgICAgICAgICA6IG51bGw7XHJcbiAgICAgICAgZG9jQ2hhbmdlcy5pbm9yZGVyVHJhdmVyc2FsKGZ1bmN0aW9uIChrZXksIG5ld01heWJlRG9jKSB7XHJcbiAgICAgICAgICAgIHZhciBvbGREb2MgPSBvbGREb2N1bWVudFNldC5nZXQoa2V5KTtcclxuICAgICAgICAgICAgdmFyIG5ld0RvYyA9IG5ld01heWJlRG9jIGluc3RhbmNlb2YgRG9jdW1lbnQgPyBuZXdNYXliZURvYyA6IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChuZXdEb2MpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChrZXkuaXNFcXVhbChuZXdEb2Mua2V5KSwgJ01pc21hdGNoaW5nIGtleXMgZm91bmQgaW4gZG9jdW1lbnQgY2hhbmdlczogJyArXHJcbiAgICAgICAgICAgICAgICAgICAga2V5ICtcclxuICAgICAgICAgICAgICAgICAgICAnICE9ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0RvYy5rZXkpO1xyXG4gICAgICAgICAgICAgICAgbmV3RG9jID0gX3RoaXMucXVlcnkubWF0Y2hlcyhuZXdEb2MpID8gbmV3RG9jIDogbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgb2xkRG9jSGFkUGVuZGluZ011dGF0aW9ucyA9IG9sZERvY1xyXG4gICAgICAgICAgICAgICAgPyBfdGhpcy5tdXRhdGVkS2V5cy5oYXMob2xkRG9jLmtleSlcclxuICAgICAgICAgICAgICAgIDogZmFsc2U7XHJcbiAgICAgICAgICAgIHZhciBuZXdEb2NIYXNQZW5kaW5nTXV0YXRpb25zID0gbmV3RG9jXHJcbiAgICAgICAgICAgICAgICA/IG5ld0RvYy5oYXNMb2NhbE11dGF0aW9ucyB8fFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG9ubHkgY29uc2lkZXIgY29tbWl0dGVkIG11dGF0aW9ucyBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG11dGF0ZWQgZHVyaW5nIHRoZSBsaWZldGltZSBvZiB0aGUgdmlldy5cclxuICAgICAgICAgICAgICAgICAgICAoX3RoaXMubXV0YXRlZEtleXMuaGFzKG5ld0RvYy5rZXkpICYmIG5ld0RvYy5oYXNDb21taXR0ZWRNdXRhdGlvbnMpXHJcbiAgICAgICAgICAgICAgICA6IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgY2hhbmdlQXBwbGllZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXHJcbiAgICAgICAgICAgIGlmIChvbGREb2MgJiYgbmV3RG9jKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZG9jc0VxdWFsID0gb2xkRG9jLmRhdGEuaXNFcXVhbChuZXdEb2MuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWRvY3NFcXVhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghX3RoaXMuc2hvdWxkV2FpdEZvclN5bmNlZERvY3VtZW50KG9sZERvYywgbmV3RG9jKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VTZXQudHJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQ2hhbmdlVHlwZS5Nb2RpZmllZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYzogbmV3RG9jXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VBcHBsaWVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3REb2NJbkxpbWl0ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5xdWVyeS5kb2NDb21wYXJhdG9yKG5ld0RvYywgbGFzdERvY0luTGltaXQpID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBkb2MgbW92ZWQgZnJvbSBpbnNpZGUgdGhlIGxpbWl0IHRvIGFmdGVyIHRoZSBsaW1pdC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoYXQgbWVhbnMgdGhlcmUgbWF5IGJlIHNvbWUgZG9jIGluIHRoZSBsb2NhbCBjYWNoZSB0aGF0J3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjdHVhbGx5IGxlc3MgdGhhbiB0aGlzIG9uZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5lZWRzUmVmaWxsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9sZERvY0hhZFBlbmRpbmdNdXRhdGlvbnMgIT09IG5ld0RvY0hhc1BlbmRpbmdNdXRhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VTZXQudHJhY2soeyB0eXBlOiBDaGFuZ2VUeXBlLk1ldGFkYXRhLCBkb2M6IG5ld0RvYyB9KTtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VBcHBsaWVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICghb2xkRG9jICYmIG5ld0RvYykge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlU2V0LnRyYWNrKHsgdHlwZTogQ2hhbmdlVHlwZS5BZGRlZCwgZG9jOiBuZXdEb2MgfSk7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VBcHBsaWVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChvbGREb2MgJiYgIW5ld0RvYykge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlU2V0LnRyYWNrKHsgdHlwZTogQ2hhbmdlVHlwZS5SZW1vdmVkLCBkb2M6IG9sZERvYyB9KTtcclxuICAgICAgICAgICAgICAgIGNoYW5nZUFwcGxpZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxhc3REb2NJbkxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQSBkb2Mgd2FzIHJlbW92ZWQgZnJvbSBhIGZ1bGwgbGltaXQgcXVlcnkuIFdlJ2xsIG5lZWQgdG9cclxuICAgICAgICAgICAgICAgICAgICAvLyByZXF1ZXJ5IGZyb20gdGhlIGxvY2FsIGNhY2hlIHRvIHNlZSBpZiB3ZSBrbm93IGFib3V0IHNvbWUgb3RoZXJcclxuICAgICAgICAgICAgICAgICAgICAvLyBkb2MgdGhhdCBzaG91bGQgYmUgaW4gdGhlIHJlc3VsdHMuXHJcbiAgICAgICAgICAgICAgICAgICAgbmVlZHNSZWZpbGwgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjaGFuZ2VBcHBsaWVkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3RG9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3RG9jdW1lbnRTZXQgPSBuZXdEb2N1bWVudFNldC5hZGQobmV3RG9jKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmV3RG9jSGFzUGVuZGluZ011dGF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNdXRhdGVkS2V5cyA9IG5ld011dGF0ZWRLZXlzLmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3TXV0YXRlZEtleXMgPSBuZXdNdXRhdGVkS2V5cy5kZWxldGUoa2V5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdEb2N1bWVudFNldCA9IG5ld0RvY3VtZW50U2V0LmRlbGV0ZShrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld011dGF0ZWRLZXlzID0gbmV3TXV0YXRlZEtleXMuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5xdWVyeS5oYXNMaW1pdCgpKSB7XHJcbiAgICAgICAgICAgIHdoaWxlIChuZXdEb2N1bWVudFNldC5zaXplID4gdGhpcy5xdWVyeS5saW1pdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9sZERvYyA9IG5ld0RvY3VtZW50U2V0Lmxhc3QoKTtcclxuICAgICAgICAgICAgICAgIG5ld0RvY3VtZW50U2V0ID0gbmV3RG9jdW1lbnRTZXQuZGVsZXRlKG9sZERvYy5rZXkpO1xyXG4gICAgICAgICAgICAgICAgbmV3TXV0YXRlZEtleXMgPSBuZXdNdXRhdGVkS2V5cy5kZWxldGUob2xkRG9jLmtleSk7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VTZXQudHJhY2soeyB0eXBlOiBDaGFuZ2VUeXBlLlJlbW92ZWQsIGRvYzogb2xkRG9jIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFzc2VydCghbmVlZHNSZWZpbGwgfHwgIXByZXZpb3VzQ2hhbmdlcywgJ1ZpZXcgd2FzIHJlZmlsbGVkIHVzaW5nIGRvY3MgdGhhdCB0aGVtc2VsdmVzIG5lZWRlZCByZWZpbGxpbmcuJyk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZG9jdW1lbnRTZXQ6IG5ld0RvY3VtZW50U2V0LFxyXG4gICAgICAgICAgICBjaGFuZ2VTZXQ6IGNoYW5nZVNldCxcclxuICAgICAgICAgICAgbmVlZHNSZWZpbGw6IG5lZWRzUmVmaWxsLFxyXG4gICAgICAgICAgICBtdXRhdGVkS2V5czogbmV3TXV0YXRlZEtleXNcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFZpZXcucHJvdG90eXBlLnNob3VsZFdhaXRGb3JTeW5jZWREb2N1bWVudCA9IGZ1bmN0aW9uIChvbGREb2MsIG5ld0RvYykge1xyXG4gICAgICAgIC8vIFdlIHN1cHByZXNzIHRoZSBpbml0aWFsIGNoYW5nZSBldmVudCBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZSBtb2RpZmllZCBhc1xyXG4gICAgICAgIC8vIHBhcnQgb2YgYSB3cml0ZSBhY2tub3dsZWRnbWVudCAoZS5nLiB3aGVuIHRoZSB2YWx1ZSBvZiBhIHNlcnZlciB0cmFuc2Zvcm1cclxuICAgICAgICAvLyBpcyBhcHBsaWVkKSBhcyBXYXRjaCB3aWxsIHNlbmQgdXMgdGhlIHNhbWUgZG9jdW1lbnQgYWdhaW4uXHJcbiAgICAgICAgLy8gQnkgc3VwcHJlc3NpbmcgdGhlIGV2ZW50LCB3ZSBvbmx5IHJhaXNlIHR3byB1c2VyIHZpc2libGUgZXZlbnRzIChvbmUgd2l0aFxyXG4gICAgICAgIC8vIGBoYXNQZW5kaW5nV3JpdGVzYCBhbmQgdGhlIGZpbmFsIHN0YXRlIG9mIHRoZSBkb2N1bWVudCkgaW5zdGVhZCBvZiB0aHJlZVxyXG4gICAgICAgIC8vIChvbmUgd2l0aCBgaGFzUGVuZGluZ1dyaXRlc2AsIHRoZSBtb2RpZmllZCBkb2N1bWVudCB3aXRoXHJcbiAgICAgICAgLy8gYGhhc1BlbmRpbmdXcml0ZXNgIGFuZCB0aGUgZmluYWwgc3RhdGUgb2YgdGhlIGRvY3VtZW50KS5cclxuICAgICAgICByZXR1cm4gKG9sZERvYy5oYXNMb2NhbE11dGF0aW9ucyAmJlxyXG4gICAgICAgICAgICBuZXdEb2MuaGFzQ29tbWl0dGVkTXV0YXRpb25zICYmXHJcbiAgICAgICAgICAgICFuZXdEb2MuaGFzTG9jYWxNdXRhdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlcyB0aGUgdmlldyB3aXRoIHRoZSBnaXZlbiBWaWV3RG9jdW1lbnRDaGFuZ2VzIGFuZCBvcHRpb25hbGx5IHVwZGF0ZXNcclxuICAgICAqIGxpbWJvIGRvY3MgYW5kIHN5bmMgc3RhdGUgZnJvbSB0aGUgcHJvdmlkZWQgdGFyZ2V0IGNoYW5nZS5cclxuICAgICAqIEBwYXJhbSBkb2NDaGFuZ2VzIFRoZSBzZXQgb2YgY2hhbmdlcyB0byBtYWtlIHRvIHRoZSB2aWV3J3MgZG9jcy5cclxuICAgICAqIEBwYXJhbSB1cGRhdGVMaW1ib0RvY3VtZW50cyBXaGV0aGVyIHRvIHVwZGF0ZSBsaW1ibyBkb2N1bWVudHMgYmFzZWQgb24gdGhpc1xyXG4gICAgICogICAgICAgIGNoYW5nZS5cclxuICAgICAqIEBwYXJhbSB0YXJnZXRDaGFuZ2UgQSB0YXJnZXQgY2hhbmdlIHRvIGFwcGx5IGZvciBjb21wdXRpbmcgbGltYm8gZG9jcyBhbmRcclxuICAgICAqICAgICAgICBzeW5jIHN0YXRlLlxyXG4gICAgICogQHJldHVybiBBIG5ldyBWaWV3Q2hhbmdlIHdpdGggdGhlIGdpdmVuIGRvY3MsIGNoYW5nZXMsIGFuZCBzeW5jIHN0YXRlLlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IFRoZSBpT1MvQW5kcm9pZCBjbGllbnRzIGFsd2F5cyBjb21wdXRlIGxpbWJvIGRvY3VtZW50IGNoYW5nZXMuXHJcbiAgICBWaWV3LnByb3RvdHlwZS5hcHBseUNoYW5nZXMgPSBmdW5jdGlvbiAoZG9jQ2hhbmdlcywgdXBkYXRlTGltYm9Eb2N1bWVudHMsIHRhcmdldENoYW5nZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgYXNzZXJ0KCFkb2NDaGFuZ2VzLm5lZWRzUmVmaWxsLCAnQ2Fubm90IGFwcGx5IGNoYW5nZXMgdGhhdCBuZWVkIGEgcmVmaWxsJyk7XHJcbiAgICAgICAgdmFyIG9sZERvY3MgPSB0aGlzLmRvY3VtZW50U2V0O1xyXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTZXQgPSBkb2NDaGFuZ2VzLmRvY3VtZW50U2V0O1xyXG4gICAgICAgIHRoaXMubXV0YXRlZEtleXMgPSBkb2NDaGFuZ2VzLm11dGF0ZWRLZXlzO1xyXG4gICAgICAgIC8vIFNvcnQgY2hhbmdlcyBiYXNlZCBvbiB0eXBlIGFuZCBxdWVyeSBjb21wYXJhdG9yXHJcbiAgICAgICAgdmFyIGNoYW5nZXMgPSBkb2NDaGFuZ2VzLmNoYW5nZVNldC5nZXRDaGFuZ2VzKCk7XHJcbiAgICAgICAgY2hhbmdlcy5zb3J0KGZ1bmN0aW9uIChjMSwgYzIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChjb21wYXJlQ2hhbmdlVHlwZShjMS50eXBlLCBjMi50eXBlKSB8fFxyXG4gICAgICAgICAgICAgICAgX3RoaXMucXVlcnkuZG9jQ29tcGFyYXRvcihjMS5kb2MsIGMyLmRvYykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuYXBwbHlUYXJnZXRDaGFuZ2UodGFyZ2V0Q2hhbmdlKTtcclxuICAgICAgICB2YXIgbGltYm9DaGFuZ2VzID0gdXBkYXRlTGltYm9Eb2N1bWVudHNcclxuICAgICAgICAgICAgPyB0aGlzLnVwZGF0ZUxpbWJvRG9jdW1lbnRzKClcclxuICAgICAgICAgICAgOiBbXTtcclxuICAgICAgICB2YXIgc3luY2VkID0gdGhpcy5saW1ib0RvY3VtZW50cy5zaXplID09PSAwICYmIHRoaXMuY3VycmVudDtcclxuICAgICAgICB2YXIgbmV3U3luY1N0YXRlID0gc3luY2VkID8gU3luY1N0YXRlLlN5bmNlZCA6IFN5bmNTdGF0ZS5Mb2NhbDtcclxuICAgICAgICB2YXIgc3luY1N0YXRlQ2hhbmdlZCA9IG5ld1N5bmNTdGF0ZSAhPT0gdGhpcy5zeW5jU3RhdGU7XHJcbiAgICAgICAgdGhpcy5zeW5jU3RhdGUgPSBuZXdTeW5jU3RhdGU7XHJcbiAgICAgICAgaWYgKGNoYW5nZXMubGVuZ3RoID09PSAwICYmICFzeW5jU3RhdGVDaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgIC8vIG5vIGNoYW5nZXNcclxuICAgICAgICAgICAgcmV0dXJuIHsgbGltYm9DaGFuZ2VzOiBsaW1ib0NoYW5nZXMgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBzbmFwID0gbmV3IFZpZXdTbmFwc2hvdCh0aGlzLnF1ZXJ5LCBkb2NDaGFuZ2VzLmRvY3VtZW50U2V0LCBvbGREb2NzLCBjaGFuZ2VzLCBkb2NDaGFuZ2VzLm11dGF0ZWRLZXlzLCBuZXdTeW5jU3RhdGUgPT09IFN5bmNTdGF0ZS5Mb2NhbCwgc3luY1N0YXRlQ2hhbmdlZCwgXHJcbiAgICAgICAgICAgIC8qIGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzPSAqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBzbmFwc2hvdDogc25hcCxcclxuICAgICAgICAgICAgICAgIGxpbWJvQ2hhbmdlczogbGltYm9DaGFuZ2VzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQXBwbGllcyBhbiBPbmxpbmVTdGF0ZSBjaGFuZ2UgdG8gdGhlIHZpZXcsIHBvdGVudGlhbGx5IGdlbmVyYXRpbmcgYVxyXG4gICAgICogVmlld0NoYW5nZSBpZiB0aGUgdmlldydzIHN5bmNTdGF0ZSBjaGFuZ2VzIGFzIGEgcmVzdWx0LlxyXG4gICAgICovXHJcbiAgICBWaWV3LnByb3RvdHlwZS5hcHBseU9ubGluZVN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudCAmJiBvbmxpbmVTdGF0ZSA9PT0gT25saW5lU3RhdGUuT2ZmbGluZSkge1xyXG4gICAgICAgICAgICAvLyBJZiB3ZSdyZSBvZmZsaW5lLCBzZXQgYGN1cnJlbnRgIHRvIGZhbHNlIGFuZCB0aGVuIGNhbGwgYXBwbHlDaGFuZ2VzKClcclxuICAgICAgICAgICAgLy8gdG8gcmVmcmVzaCBvdXIgc3luY1N0YXRlIGFuZCBnZW5lcmF0ZSBhIFZpZXdDaGFuZ2UgYXMgYXBwcm9wcmlhdGUuIFdlXHJcbiAgICAgICAgICAgIC8vIGFyZSBndWFyYW50ZWVkIHRvIGdldCBhIG5ldyBUYXJnZXRDaGFuZ2UgdGhhdCBzZXRzIGBjdXJyZW50YCBiYWNrIHRvXHJcbiAgICAgICAgICAgIC8vIHRydWUgb25jZSB0aGUgY2xpZW50IGlzIGJhY2sgb25saW5lLlxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlDaGFuZ2VzKHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50U2V0OiB0aGlzLmRvY3VtZW50U2V0LFxyXG4gICAgICAgICAgICAgICAgY2hhbmdlU2V0OiBuZXcgRG9jdW1lbnRDaGFuZ2VTZXQoKSxcclxuICAgICAgICAgICAgICAgIG11dGF0ZWRLZXlzOiB0aGlzLm11dGF0ZWRLZXlzLFxyXG4gICAgICAgICAgICAgICAgbmVlZHNSZWZpbGw6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sIFxyXG4gICAgICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gTm8gZWZmZWN0LCBqdXN0IHJldHVybiBhIG5vLW9wIFZpZXdDaGFuZ2UuXHJcbiAgICAgICAgICAgIHJldHVybiB7IGxpbWJvQ2hhbmdlczogW10gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIGRvYyBmb3IgdGhlIGdpdmVuIGtleSBzaG91bGQgYmUgaW4gbGltYm8uXHJcbiAgICAgKi9cclxuICAgIFZpZXcucHJvdG90eXBlLnNob3VsZEJlSW5MaW1ibyA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAvLyBJZiB0aGUgcmVtb3RlIGVuZCBzYXlzIGl0J3MgcGFydCBvZiB0aGlzIHF1ZXJ5LCBpdCdzIG5vdCBpbiBsaW1iby5cclxuICAgICAgICBpZiAodGhpcy5fc3luY2VkRG9jdW1lbnRzLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIGRvZXNuJ3QgdGhpbmsgaXQncyBhIHJlc3VsdCwgc28gaXQgc2hvdWxkbid0IGJlIGluIGxpbWJvLlxyXG4gICAgICAgIGlmICghdGhpcy5kb2N1bWVudFNldC5oYXMoa2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIHRoZXJlIGFyZSBsb2NhbCBjaGFuZ2VzIHRvIHRoZSBkb2MsIHRoZXkgbWlnaHQgZXhwbGFpbiB3aHkgdGhlIHNlcnZlclxyXG4gICAgICAgIC8vIGRvZXNuJ3Qga25vdyB0aGF0IGl0J3MgcGFydCBvZiB0aGUgcXVlcnkuIFNvIGRvbid0IHB1dCBpdCBpbiBsaW1iby5cclxuICAgICAgICAvLyBUT0RPKGtsaW10KTogSWRlYWxseSwgd2Ugd291bGQgb25seSBjb25zaWRlciBjaGFuZ2VzIHRoYXQgbWlnaHQgYWN0dWFsbHlcclxuICAgICAgICAvLyBhZmZlY3QgdGhpcyBzcGVjaWZpYyBxdWVyeS5cclxuICAgICAgICBpZiAodGhpcy5kb2N1bWVudFNldC5nZXQoa2V5KS5oYXNMb2NhbE11dGF0aW9ucykge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEV2ZXJ5dGhpbmcgZWxzZSBpcyBpbiBsaW1iby5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgc3luY2VkRG9jdW1lbnRzLCBjdXJyZW50LCBhbmQgbGltYm8gZG9jcyBiYXNlZCBvbiB0aGUgZ2l2ZW4gY2hhbmdlLlxyXG4gICAgICogUmV0dXJucyB0aGUgbGlzdCBvZiBjaGFuZ2VzIHRvIHdoaWNoIGRvY3MgYXJlIGluIGxpbWJvLlxyXG4gICAgICovXHJcbiAgICBWaWV3LnByb3RvdHlwZS5hcHBseVRhcmdldENoYW5nZSA9IGZ1bmN0aW9uICh0YXJnZXRDaGFuZ2UpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0YXJnZXRDaGFuZ2UpIHtcclxuICAgICAgICAgICAgdGFyZ2V0Q2hhbmdlLmFkZGVkRG9jdW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gKF90aGlzLl9zeW5jZWREb2N1bWVudHMgPSBfdGhpcy5fc3luY2VkRG9jdW1lbnRzLmFkZChrZXkpKTsgfSk7XHJcbiAgICAgICAgICAgIHRhcmdldENoYW5nZS5tb2RpZmllZERvY3VtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhc3NlcnQoX3RoaXMuX3N5bmNlZERvY3VtZW50cy5oYXMoa2V5KSwgXCJNb2RpZmllZCBkb2N1bWVudCBcIiArIGtleSArIFwiIG5vdCBmb3VuZCBpbiB2aWV3LlwiKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRhcmdldENoYW5nZS5yZW1vdmVkRG9jdW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gKF90aGlzLl9zeW5jZWREb2N1bWVudHMgPSBfdGhpcy5fc3luY2VkRG9jdW1lbnRzLmRlbGV0ZShrZXkpKTsgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IHRhcmdldENoYW5nZS5jdXJyZW50O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBWaWV3LnByb3RvdHlwZS51cGRhdGVMaW1ib0RvY3VtZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIFdlIGNhbiBvbmx5IGRldGVybWluZSBsaW1ibyBkb2N1bWVudHMgd2hlbiB3ZSdyZSBpbi1zeW5jIHdpdGggdGhlIHNlcnZlci5cclxuICAgICAgICBpZiAoIXRoaXMuY3VycmVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRPRE8oa2xpbXQpOiBEbyB0aGlzIGluY3JlbWVudGFsbHkgc28gdGhhdCBpdCdzIG5vdCBxdWFkcmF0aWMgd2hlblxyXG4gICAgICAgIC8vIHVwZGF0aW5nIG1hbnkgZG9jdW1lbnRzLlxyXG4gICAgICAgIHZhciBvbGRMaW1ib0RvY3VtZW50cyA9IHRoaXMubGltYm9Eb2N1bWVudHM7XHJcbiAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50cyA9IGRvY3VtZW50S2V5U2V0KCk7XHJcbiAgICAgICAgdGhpcy5kb2N1bWVudFNldC5mb3JFYWNoKGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgaWYgKF90aGlzLnNob3VsZEJlSW5MaW1ibyhkb2Mua2V5KSkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubGltYm9Eb2N1bWVudHMgPSBfdGhpcy5saW1ib0RvY3VtZW50cy5hZGQoZG9jLmtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBEaWZmIHRoZSBuZXcgbGltYm8gZG9jcyB3aXRoIHRoZSBvbGQgbGltYm8gZG9jcy5cclxuICAgICAgICB2YXIgY2hhbmdlcyA9IFtdO1xyXG4gICAgICAgIG9sZExpbWJvRG9jdW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICBpZiAoIV90aGlzLmxpbWJvRG9jdW1lbnRzLmhhcyhrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLnB1c2gobmV3IFJlbW92ZWRMaW1ib0RvY3VtZW50KGtleSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFvbGRMaW1ib0RvY3VtZW50cy5oYXMoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlcy5wdXNoKG5ldyBBZGRlZExpbWJvRG9jdW1lbnQoa2V5KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY2hhbmdlcztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZSB0aGUgaW4tbWVtb3J5IHN0YXRlIG9mIHRoZSBjdXJyZW50IHZpZXcgd2l0aCB0aGUgc3RhdGUgcmVhZCBmcm9tXHJcbiAgICAgKiBwZXJzaXN0ZW5jZS5cclxuICAgICAqXHJcbiAgICAgKiBXZSB1cGRhdGUgdGhlIHF1ZXJ5IHZpZXcgd2hlbmV2ZXIgYSBjbGllbnQncyBwcmltYXJ5IHN0YXR1cyBjaGFuZ2VzOlxyXG4gICAgICogLSBXaGVuIGEgY2xpZW50IHRyYW5zaXRpb25zIGZyb20gcHJpbWFyeSB0byBzZWNvbmRhcnksIGl0IGNhbiBtaXNzXHJcbiAgICAgKiAgIExvY2FsU3RvcmFnZSB1cGRhdGVzIGFuZCBpdHMgcXVlcnkgdmlld3MgbWF5IHRlbXBvcmFyaWx5IG5vdCBiZVxyXG4gICAgICogICBzeW5jaHJvbml6ZWQgd2l0aCB0aGUgc3RhdGUgb24gZGlzay5cclxuICAgICAqIC0gRm9yIHNlY29uZGFyeSB0byBwcmltYXJ5IHRyYW5zaXRpb25zLCB0aGUgY2xpZW50IG5lZWRzIHRvIHVwZGF0ZSB0aGUgbGlzdFxyXG4gICAgICogICBvZiBgc3luY2VkRG9jdW1lbnRzYCBzaW5jZSBzZWNvbmRhcnkgY2xpZW50cyB1cGRhdGUgdGhlaXIgcXVlcnkgdmlld3NcclxuICAgICAqICAgYmFzZWQgcHVyZWx5IG9uIHN5bnRoZXNpemVkIFJlbW90ZUV2ZW50cy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbG9jYWxEb2NzIC0gVGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoIHRoZSBxdWVyeSBhY2NvcmRpbmcgdG8gdGhlXHJcbiAgICAgKiBMb2NhbFN0b3JlLlxyXG4gICAgICogQHBhcmFtIHJlbW90ZUtleXMgLSBUaGUga2V5cyBvZiB0aGUgZG9jdW1lbnRzIHRoYXQgbWF0Y2ggdGhlIHF1ZXJ5XHJcbiAgICAgKiBhY2NvcmRpbmcgdG8gdGhlIGJhY2tlbmQuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybiBUaGUgVmlld0NoYW5nZSB0aGF0IHJlc3VsdGVkIGZyb20gdGhpcyBzeW5jaHJvbml6YXRpb24uXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBWaWV3LnByb3RvdHlwZS5zeW5jaHJvbml6ZVdpdGhQZXJzaXN0ZWRTdGF0ZSA9IGZ1bmN0aW9uIChsb2NhbERvY3MsIHJlbW90ZUtleXMpIHtcclxuICAgICAgICB0aGlzLl9zeW5jZWREb2N1bWVudHMgPSByZW1vdGVLZXlzO1xyXG4gICAgICAgIHRoaXMubGltYm9Eb2N1bWVudHMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgIHZhciBkb2NDaGFuZ2VzID0gdGhpcy5jb21wdXRlRG9jQ2hhbmdlcyhsb2NhbERvY3MpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5Q2hhbmdlcyhkb2NDaGFuZ2VzLCAvKnVwZGF0ZUxpbWJvRG9jdW1lbnRzPSovIHRydWUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIHZpZXcgc25hcHNob3QgYXMgaWYgdGhpcyBxdWVyeSB3YXMganVzdCBsaXN0ZW5lZCB0by4gQ29udGFpbnNcclxuICAgICAqIGEgZG9jdW1lbnQgYWRkIGZvciBldmVyeSBleGlzdGluZyBkb2N1bWVudCBhbmQgdGhlIGBmcm9tQ2FjaGVgIGFuZFxyXG4gICAgICogYGhhc1BlbmRpbmdXcml0ZXNgIHN0YXR1cyBvZiB0aGUgYWxyZWFkeSBlc3RhYmxpc2hlZCB2aWV3LlxyXG4gICAgICovXHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxyXG4gICAgVmlldy5wcm90b3R5cGUuY29tcHV0ZUluaXRpYWxTbmFwc2hvdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gVmlld1NuYXBzaG90LmZyb21Jbml0aWFsRG9jdW1lbnRzKHRoaXMucXVlcnksIHRoaXMuZG9jdW1lbnRTZXQsIHRoaXMubXV0YXRlZEtleXMsIHRoaXMuc3luY1N0YXRlID09PSBTeW5jU3RhdGUuTG9jYWwpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBWaWV3O1xyXG59KCkpO1xyXG5mdW5jdGlvbiBjb21wYXJlQ2hhbmdlVHlwZShjMSwgYzIpIHtcclxuICAgIHZhciBvcmRlciA9IGZ1bmN0aW9uIChjaGFuZ2UpIHtcclxuICAgICAgICBzd2l0Y2ggKGNoYW5nZSkge1xyXG4gICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuQWRkZWQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLk1vZGlmaWVkOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XHJcbiAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5NZXRhZGF0YTpcclxuICAgICAgICAgICAgICAgIC8vIEEgbWV0YWRhdGEgY2hhbmdlIGlzIGNvbnZlcnRlZCB0byBhIG1vZGlmaWVkIGNoYW5nZSBhdCB0aGUgcHVibGljXHJcbiAgICAgICAgICAgICAgICAvLyBhcGkgbGF5ZXIuICBTaW5jZSB3ZSBzb3J0IGJ5IGRvY3VtZW50IGtleSBhbmQgdGhlbiBjaGFuZ2UgdHlwZSxcclxuICAgICAgICAgICAgICAgIC8vIG1ldGFkYXRhIGFuZCBtb2RpZmllZCBjaGFuZ2VzIG11c3QgYmUgc29ydGVkIGVxdWl2YWxlbnRseS5cclxuICAgICAgICAgICAgICAgIHJldHVybiAyO1xyXG4gICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuUmVtb3ZlZDpcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gQ2hhbmdlVHlwZTogJyArIGNoYW5nZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBvcmRlcihjMSkgLSBvcmRlcihjMik7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBMT0dfVEFHJDkgPSAnU3luY0VuZ2luZSc7XHJcbi8qKlxyXG4gKiBRdWVyeVZpZXcgY29udGFpbnMgYWxsIG9mIHRoZSBkYXRhIHRoYXQgU3luY0VuZ2luZSBuZWVkcyB0byBrZWVwIHRyYWNrIG9mIGZvclxyXG4gKiBhIHBhcnRpY3VsYXIgcXVlcnkuXHJcbiAqL1xyXG52YXIgUXVlcnlWaWV3ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlWaWV3KFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcXVlcnkgaXRzZWxmLlxyXG4gICAgICovXHJcbiAgICBxdWVyeSwgXHJcbiAgICAvKipcclxuICAgICAqIFRoZSB0YXJnZXQgbnVtYmVyIGNyZWF0ZWQgYnkgdGhlIGNsaWVudCB0aGF0IGlzIHVzZWQgaW4gdGhlIHdhdGNoXHJcbiAgICAgKiBzdHJlYW0gdG8gaWRlbnRpZnkgdGhpcyBxdWVyeS5cclxuICAgICAqL1xyXG4gICAgdGFyZ2V0SWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdmlldyBpcyByZXNwb25zaWJsZSBmb3IgY29tcHV0aW5nIHRoZSBmaW5hbCBtZXJnZWQgdHJ1dGggb2Ygd2hhdFxyXG4gICAgICogZG9jcyBhcmUgaW4gdGhlIHF1ZXJ5LiBJdCBnZXRzIG5vdGlmaWVkIG9mIGxvY2FsIGFuZCByZW1vdGUgY2hhbmdlcyxcclxuICAgICAqIGFuZCBhcHBsaWVzIHRoZSBxdWVyeSBmaWx0ZXJzIGFuZCBsaW1pdHMgdG8gZGV0ZXJtaW5lIHRoZSBtb3N0IGNvcnJlY3RcclxuICAgICAqIHBvc3NpYmxlIHJlc3VsdHMuXHJcbiAgICAgKi9cclxuICAgIHZpZXcpIHtcclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHRhcmdldElkO1xyXG4gICAgICAgIHRoaXMudmlldyA9IHZpZXc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUXVlcnlWaWV3O1xyXG59KCkpO1xyXG4vKiogVHJhY2tzIGEgbGltYm8gcmVzb2x1dGlvbi4gKi9cclxudmFyIExpbWJvUmVzb2x1dGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIExpbWJvUmVzb2x1dGlvbihrZXkpIHtcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgIH1cclxuICAgIHJldHVybiBMaW1ib1Jlc29sdXRpb247XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBTeW5jRW5naW5lIGlzIHRoZSBjZW50cmFsIGNvbnRyb2xsZXIgaW4gdGhlIGNsaWVudCBTREsgYXJjaGl0ZWN0dXJlLiBJdCBpc1xyXG4gKiB0aGUgZ2x1ZSBjb2RlIGJldHdlZW4gdGhlIEV2ZW50TWFuYWdlciwgTG9jYWxTdG9yZSwgYW5kIFJlbW90ZVN0b3JlLiBTb21lIG9mXHJcbiAqIFN5bmNFbmdpbmUncyByZXNwb25zaWJpbGl0aWVzIGluY2x1ZGU6XHJcbiAqIDEuIENvb3JkaW5hdGluZyBjbGllbnQgcmVxdWVzdHMgYW5kIHJlbW90ZSBldmVudHMgYmV0d2VlbiB0aGUgRXZlbnRNYW5hZ2VyXHJcbiAqICAgIGFuZCB0aGUgbG9jYWwgYW5kIHJlbW90ZSBkYXRhIHN0b3Jlcy5cclxuICogMi4gTWFuYWdpbmcgYSBWaWV3IG9iamVjdCBmb3IgZWFjaCBxdWVyeSwgcHJvdmlkaW5nIHRoZSB1bmlmaWVkIHZpZXcgYmV0d2VlblxyXG4gKiAgICB0aGUgbG9jYWwgYW5kIHJlbW90ZSBkYXRhIHN0b3Jlcy5cclxuICogMy4gTm90aWZ5aW5nIHRoZSBSZW1vdGVTdG9yZSB3aGVuIHRoZSBMb2NhbFN0b3JlIGhhcyBuZXcgbXV0YXRpb25zIGluIGl0c1xyXG4gKiAgICBxdWV1ZSB0aGF0IG5lZWQgc2VuZGluZyB0byB0aGUgYmFja2VuZC5cclxuICpcclxuICogVGhlIFN5bmNFbmdpbmXigJlzIG1ldGhvZHMgc2hvdWxkIG9ubHkgZXZlciBiZSBjYWxsZWQgYnkgbWV0aG9kcyBydW5uaW5nIGluIHRoZVxyXG4gKiBnbG9iYWwgYXN5bmMgcXVldWUuXHJcbiAqL1xyXG52YXIgU3luY0VuZ2luZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFN5bmNFbmdpbmUobG9jYWxTdG9yZSwgcmVtb3RlU3RvcmUsIFxyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNYW5hZ2VzIHN0YXRlIHN5bmNocm9uaXphdGlvbiBpbiBtdWx0aS10YWIgZW52aXJvbm1lbnRzLlxyXG4gICAgc2hhcmVkQ2xpZW50U3RhdGUsIGN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlID0gbG9jYWxTdG9yZTtcclxuICAgICAgICB0aGlzLnJlbW90ZVN0b3JlID0gcmVtb3RlU3RvcmU7XHJcbiAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHNoYXJlZENsaWVudFN0YXRlO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBjdXJyZW50VXNlcjtcclxuICAgICAgICB0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5xdWVyeVZpZXdzQnlRdWVyeSA9IG5ldyBPYmplY3RNYXAoZnVuY3Rpb24gKHEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHEuY2Fub25pY2FsSWQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldCA9IHt9O1xyXG4gICAgICAgIHRoaXMubGltYm9UYXJnZXRzQnlLZXkgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG4gICAgICAgIHRoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0ID0ge307XHJcbiAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50UmVmcyA9IG5ldyBSZWZlcmVuY2VTZXQoKTtcclxuICAgICAgICAvKiogU3RvcmVzIHVzZXIgY29tcGxldGlvbiBoYW5kbGVycywgaW5kZXhlZCBieSBVc2VyIGFuZCBCYXRjaElkLiAqL1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25Vc2VyQ2FsbGJhY2tzID0ge307XHJcbiAgICAgICAgdGhpcy5saW1ib1RhcmdldElkR2VuZXJhdG9yID0gVGFyZ2V0SWRHZW5lcmF0b3IuZm9yU3luY0VuZ2luZSgpO1xyXG4gICAgICAgIC8vIFRoZSBwcmltYXJ5IHN0YXRlIGlzIHNldCB0byBgdHJ1ZWAgb3IgYGZhbHNlYCBpbW1lZGlhdGVseSBhZnRlciBGaXJlc3RvcmVcclxuICAgICAgICAvLyBzdGFydHVwLiBJbiB0aGUgaW50ZXJpbSwgYSBjbGllbnQgc2hvdWxkIG9ubHkgYmUgY29uc2lkZXJlZCBwcmltYXJ5IGlmXHJcbiAgICAgICAgLy8gYGlzUHJpbWFyeWAgaXMgdHJ1ZS5cclxuICAgICAgICB0aGlzLmlzUHJpbWFyeSA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gT25saW5lU3RhdGUuVW5rbm93bjtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTeW5jRW5naW5lLnByb3RvdHlwZSwgXCJpc1ByaW1hcnlDbGllbnRcIiwge1xyXG4gICAgICAgIC8vIE9ubHkgdXNlZCBmb3IgdGVzdGluZy5cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNQcmltYXJ5ID09PSB0cnVlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqIFN1YnNjcmliZXMgdG8gU3luY0VuZ2luZSBub3RpZmljYXRpb25zLiBIYXMgdG8gYmUgY2FsbGVkIGV4YWN0bHkgb25jZS4gKi9cclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzeW5jRW5naW5lTGlzdGVuZXIpIHtcclxuICAgICAgICBhc3NlcnQoc3luY0VuZ2luZUxpc3RlbmVyICE9PSBudWxsLCAnU3luY0VuZ2luZSBsaXN0ZW5lciBjYW5ub3QgYmUgbnVsbCcpO1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lciA9PT0gbnVsbCwgJ1N5bmNFbmdpbmUgYWxyZWFkeSBoYXMgYSBzdWJzY3JpYmVyLicpO1xyXG4gICAgICAgIHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyID0gc3luY0VuZ2luZUxpc3RlbmVyO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhdGVzIHRoZSBuZXcgbGlzdGVuLCByZXNvbHZlcyBwcm9taXNlIHdoZW4gbGlzdGVuIGVucXVldWVkIHRvIHRoZVxyXG4gICAgICogc2VydmVyLiBBbGwgdGhlIHN1YnNlcXVlbnQgdmlldyBzbmFwc2hvdHMgb3IgZXJyb3JzIGFyZSBzZW50IHRvIHRoZVxyXG4gICAgICogc3Vic2NyaWJlZCBoYW5kbGVycy4gUmV0dXJucyB0aGUgdGFyZ2V0SWQgb2YgdGhlIHF1ZXJ5LlxyXG4gICAgICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldElkLCB2aWV3U25hcHNob3QsIHF1ZXJ5VmlldywgcXVlcnlEYXRhLCBzdGF0dXNfMTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFzc2VydFN1YnNjcmliZWQoJ2xpc3RlbigpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5VmlldyA9IHRoaXMucXVlcnlWaWV3c0J5UXVlcnkuZ2V0KHF1ZXJ5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFxdWVyeVZpZXcpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IFdpdGggTXVsdC1UYWIgV2ViLCBpdCBpcyBwb3NzaWJsZSB0aGF0IGEgcXVlcnkgdmlld1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbHJlYWR5IGV4aXN0cyB3aGVuIEV2ZW50TWFuYWdlciBjYWxscyB1cyBmb3IgdGhlIGZpcnN0IHRpbWUuIFRoaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGFwcGVucyB3aGVuIHRoZSBwcmltYXJ5IHRhYiBpcyBhbHJlYWR5IGxpc3RlbmluZyB0byB0aGlzIHF1ZXJ5IG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJlaGFsZiBvZiBhbm90aGVyIHRhYiBhbmQgdGhlIHVzZXIgb2YgdGhlIHByaW1hcnkgYWxzbyBzdGFydHMgbGlzdGVuaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvIHRoZSBxdWVyeS4gRXZlbnRNYW5hZ2VyIHdpbGwgbm90IGhhdmUgYW4gYXNzaWduZWQgdGFyZ2V0IElEIGluIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSBhbmQgY2FsbHMgYGxpc3RlbmAgdG8gb2J0YWluIHRoaXMgSUQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkID0gcXVlcnlWaWV3LnRhcmdldElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlLmFkZExvY2FsUXVlcnlUYXJnZXQodGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3U25hcHNob3QgPSBxdWVyeVZpZXcudmlldy5jb21wdXRlSW5pdGlhbFNuYXBzaG90KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmFsbG9jYXRlUXVlcnkocXVlcnkpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0YSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzXzEgPSB0aGlzLnNoYXJlZENsaWVudFN0YXRlLmFkZExvY2FsUXVlcnlUYXJnZXQocXVlcnlEYXRhLnRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQgPSBxdWVyeURhdGEudGFyZ2V0SWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaW5pdGlhbGl6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QocXVlcnlEYXRhLCBzdGF0dXNfMSA9PT0gJ2N1cnJlbnQnKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3U25hcHNob3QgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVTdG9yZS5saXN0ZW4ocXVlcnlEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lci5vbldhdGNoQ2hhbmdlKFt2aWV3U25hcHNob3RdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRhcmdldElkXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlcnMgYSB2aWV3IGZvciBhIHByZXZpb3VzbHkgdW5rbm93biBxdWVyeSBhbmQgY29tcHV0ZXMgaXRzIGluaXRpYWxcclxuICAgICAqIHNuYXBzaG90LlxyXG4gICAgICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5pbml0aWFsaXplVmlld0FuZENvbXB1dGVTbmFwc2hvdCA9IGZ1bmN0aW9uIChxdWVyeURhdGEsIGN1cnJlbnQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBxdWVyeSA9IHF1ZXJ5RGF0YS5xdWVyeTtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlLmV4ZWN1dGVRdWVyeShxdWVyeSkudGhlbihmdW5jdGlvbiAoZG9jcykge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAgICAgLnJlbW90ZURvY3VtZW50S2V5cyhxdWVyeURhdGEudGFyZ2V0SWQpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVtb3RlS2V5cykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXcgPSBuZXcgVmlldyhxdWVyeSwgcmVtb3RlS2V5cyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlld0RvY0NoYW5nZXMgPSB2aWV3LmNvbXB1dGVEb2NDaGFuZ2VzKGRvY3MpO1xyXG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aCBQcmV0dGllciBmb3JtYXRzIHRoaXMgZXhjZWVkIDEwMCBjaGFyYWN0ZXJzLlxyXG4gICAgICAgICAgICAgICAgdmFyIHN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlID0gVGFyZ2V0Q2hhbmdlLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZShxdWVyeURhdGEudGFyZ2V0SWQsIGN1cnJlbnQgJiYgX3RoaXMub25saW5lU3RhdGUgIT09IE9ubGluZVN0YXRlLk9mZmxpbmUpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXdDaGFuZ2UgPSB2aWV3LmFwcGx5Q2hhbmdlcyh2aWV3RG9jQ2hhbmdlcywgXHJcbiAgICAgICAgICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gX3RoaXMuaXNQcmltYXJ5ID09PSB0cnVlLCBzeW50aGVzaXplZFRhcmdldENoYW5nZSk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQodmlld0NoYW5nZS5saW1ib0NoYW5nZXMubGVuZ3RoID09PSAwLCAnVmlldyByZXR1cm5lZCBsaW1ibyBkb2NzIGJlZm9yZSB0YXJnZXQgYWNrIGZyb20gdGhlIHNlcnZlci4nKTtcclxuICAgICAgICAgICAgICAgIGFzc2VydCghIXZpZXdDaGFuZ2Uuc25hcHNob3QsICdhcHBseUNoYW5nZXMgZm9yIG5ldyB2aWV3IHNob3VsZCBhbHdheXMgcmV0dXJuIGEgc25hcHNob3QnKTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFF1ZXJ5VmlldyhxdWVyeSwgcXVlcnlEYXRhLnRhcmdldElkLCB2aWV3KTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXJ5Vmlld3NCeVF1ZXJ5LnNldChxdWVyeSwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbcXVlcnlEYXRhLnRhcmdldElkXSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdmlld0NoYW5nZS5zbmFwc2hvdDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZWNvbmNpbGUgdGhlIGxpc3Qgb2Ygc3luY2VkIGRvY3VtZW50cyBpbiBhbiBleGlzdGluZyB2aWV3IHdpdGggdGhvc2VcclxuICAgICAqIGZyb20gcGVyc2lzdGVuY2UuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5zeW5jaHJvbml6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QgPSBmdW5jdGlvbiAocXVlcnlWaWV3KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlLmV4ZWN1dGVRdWVyeShxdWVyeVZpZXcucXVlcnkpLnRoZW4oZnVuY3Rpb24gKGRvY3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsU3RvcmVcclxuICAgICAgICAgICAgICAgIC5yZW1vdGVEb2N1bWVudEtleXMocXVlcnlWaWV3LnRhcmdldElkKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlbW90ZUtleXMpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXdTbmFwc2hvdDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdTbmFwc2hvdCA9IHF1ZXJ5Vmlldy52aWV3LnN5bmNocm9uaXplV2l0aFBlcnNpc3RlZFN0YXRlKGRvY3MsIHJlbW90ZUtleXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRyYWNrZWRMaW1ib3MocXVlcnlWaWV3LnRhcmdldElkLCB2aWV3U25hcHNob3QubGltYm9DaGFuZ2VzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHZpZXdTbmFwc2hvdF07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7IH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiBTdG9wcyBsaXN0ZW5pbmcgdG8gdGhlIHF1ZXJ5LiAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUudW5saXN0ZW4gPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5VmlldywgdGFyZ2V0UmVtYWluc0FjdGl2ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFzc2VydFN1YnNjcmliZWQoJ3VubGlzdGVuKCknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlWaWV3ID0gdGhpcy5xdWVyeVZpZXdzQnlRdWVyeS5nZXQocXVlcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoISFxdWVyeVZpZXcsICdUcnlpbmcgdG8gdW5saXN0ZW4gb24gcXVlcnkgbm90IGZvdW5kOicgKyBxdWVyeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc1ByaW1hcnkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHJlbW92ZSB0aGUgbG9jYWwgcXVlcnkgdGFyZ2V0IGZpcnN0IHRvIGFsbG93IHVzIHRvIHZlcmlmeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3aGV0aGVyIGFueSBvdGhlciBjbGllbnQgaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGlzIHRhcmdldC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KHF1ZXJ5Vmlldy50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbWFpbnNBY3RpdmUgPSB0aGlzLnNoYXJlZENsaWVudFN0YXRlLmlzQWN0aXZlUXVlcnlUYXJnZXQocXVlcnlWaWV3LnRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGFyZ2V0UmVtYWluc0FjdGl2ZSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZWxlYXNlUXVlcnkocXVlcnksIC8qa2VlcFBlcnNpc3RlZFF1ZXJ5RGF0YT0qLyBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2hhcmVkQ2xpZW50U3RhdGUuY2xlYXJRdWVyeVN0YXRlKHF1ZXJ5Vmlldy50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVtb3RlU3RvcmUudW5saXN0ZW4ocXVlcnlWaWV3LnRhcmdldElkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdmVBbmRDbGVhbnVwUXVlcnkocXVlcnlWaWV3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIF90aGlzLmlnbm9yZUlmUHJpbWFyeUxlYXNlTG9zcyhlcnIpOyB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBbmRDbGVhbnVwUXVlcnkocXVlcnlWaWV3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLnJlbGVhc2VRdWVyeShxdWVyeSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKmtlZXBQZXJzaXN0ZWRRdWVyeURhdGE9Ki8gdHJ1ZSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhdGVzIHRoZSB3cml0ZSBvZiBsb2NhbCBtdXRhdGlvbiBiYXRjaCB3aGljaCBpbnZvbHZlcyBhZGRpbmcgdGhlXHJcbiAgICAgKiB3cml0ZXMgdG8gdGhlIG11dGF0aW9uIHF1ZXVlLCBub3RpZnlpbmcgdGhlIHJlbW90ZSBzdG9yZSBhYm91dCBuZXdcclxuICAgICAqIG11dGF0aW9ucyBhbmQgcmFpc2luZyBldmVudHMgZm9yIGFueSBjaGFuZ2VzIHRoaXMgd3JpdGUgY2F1c2VkLlxyXG4gICAgICpcclxuICAgICAqIFRoZSBwcm9taXNlIHJldHVybmVkIGJ5IHRoaXMgY2FsbCBpcyByZXNvbHZlZCB3aGVuIHRoZSBhYm92ZSBzdGVwc1xyXG4gICAgICogaGF2ZSBjb21wbGV0ZWQsICpub3QqIHdoZW4gdGhlIHdyaXRlIHdhcyBhY2tlZCBieSB0aGUgYmFja2VuZC4gVGhlXHJcbiAgICAgKiB1c2VyQ2FsbGJhY2sgaXMgcmVzb2x2ZWQgb25jZSB0aGUgd3JpdGUgd2FzIGFja2VkL3JlamVjdGVkIGJ5IHRoZVxyXG4gICAgICogYmFja2VuZCAob3IgZmFpbGVkIGxvY2FsbHkgZm9yIGFueSBvdGhlciByZWFzb24pLlxyXG4gICAgICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChiYXRjaCwgdXNlckNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmFzc2VydFN1YnNjcmliZWQoJ3dyaXRlKCknKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgIC5sb2NhbFdyaXRlKGJhdGNoKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIF90aGlzLnNoYXJlZENsaWVudFN0YXRlLmFkZFBlbmRpbmdNdXRhdGlvbihyZXN1bHQuYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgIF90aGlzLmFkZE11dGF0aW9uQ2FsbGJhY2socmVzdWx0LmJhdGNoSWQsIHVzZXJDYWxsYmFjayk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5lbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKHJlc3VsdC5jaGFuZ2VzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW1vdGVTdG9yZS5maWxsV3JpdGVQaXBlbGluZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFRPRE8oa2xpbXQpOiBXcmFwIHRoZSBnaXZlbiBlcnJvciBpbiBhIHN0YW5kYXJkIEZpcmVzdG9yZSBlcnJvciBvYmplY3QuXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS53cmFwVXBkYXRlRnVuY3Rpb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgIHJldHVybiBlcnJvciQkMTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFRha2VzIGFuIHVwZGF0ZUZ1bmN0aW9uIGluIHdoaWNoIGEgc2V0IG9mIHJlYWRzIGFuZCB3cml0ZXMgY2FuIGJlIHBlcmZvcm1lZFxyXG4gICAgICogYXRvbWljYWxseS4gSW4gdGhlIHVwZGF0ZUZ1bmN0aW9uLCB0aGUgY2xpZW50IGNhbiByZWFkIGFuZCB3cml0ZSB2YWx1ZXNcclxuICAgICAqIHVzaW5nIHRoZSBzdXBwbGllZCB0cmFuc2FjdGlvbiBvYmplY3QuIEFmdGVyIHRoZSB1cGRhdGVGdW5jdGlvbiwgYWxsXHJcbiAgICAgKiBjaGFuZ2VzIHdpbGwgYmUgY29tbWl0dGVkLiBJZiBzb21lIG90aGVyIGNsaWVudCBoYXMgY2hhbmdlZCBhbnkgb2YgdGhlIGRhdGFcclxuICAgICAqIHJlZmVyZW5jZWQsIHRoZW4gdGhlIHVwZGF0ZUZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFnYWluLiBJZiB0aGVcclxuICAgICAqIHVwZGF0ZUZ1bmN0aW9uIHN0aWxsIGZhaWxzIGFmdGVyIHRoZSBnaXZlbiBudW1iZXIgb2YgcmV0cmllcywgdGhlbiB0aGVcclxuICAgICAqIHRyYW5zYWN0aW9uIHdpbGwgYmUgcmVqZWN0aW9uLlxyXG4gICAgICpcclxuICAgICAqIFRoZSB0cmFuc2FjdGlvbiBvYmplY3QgcGFzc2VkIHRvIHRoZSB1cGRhdGVGdW5jdGlvbiBjb250YWlucyBtZXRob2RzIGZvclxyXG4gICAgICogYWNjZXNzaW5nIGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMuIFVubGlrZSBvdGhlciBkYXRhc3RvcmUgYWNjZXNzLCBkYXRhXHJcbiAgICAgKiBhY2Nlc3NlZCB3aXRoIHRoZSB0cmFuc2FjdGlvbiB3aWxsIG5vdCByZWZsZWN0IGxvY2FsIGNoYW5nZXMgdGhhdCBoYXZlIG5vdFxyXG4gICAgICogYmVlbiBjb21taXR0ZWQuIEZvciB0aGlzIHJlYXNvbiwgaXQgaXMgcmVxdWlyZWQgdGhhdCBhbGwgcmVhZHMgYXJlXHJcbiAgICAgKiBwZXJmb3JtZWQgYmVmb3JlIGFueSB3cml0ZXMuIFRyYW5zYWN0aW9ucyBtdXN0IGJlIHBlcmZvcm1lZCB3aGlsZSBvbmxpbmUuXHJcbiAgICAgKlxyXG4gICAgICogVGhlIHByb21pc2UgcmV0dXJuZWQgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgdHJhbnNhY3Rpb24gaXMgZnVsbHkgY29tbWl0dGVkLlxyXG4gICAgICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5ydW5UcmFuc2FjdGlvbiA9IGZ1bmN0aW9uICh1cGRhdGVGdW5jdGlvbiwgcmV0cmllcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHJldHJpZXMgPT09IHZvaWQgMCkgeyByZXRyaWVzID0gNTsgfVxyXG4gICAgICAgIGFzc2VydChyZXRyaWVzID49IDAsICdHb3QgbmVnYXRpdmUgbnVtYmVyIG9mIHJldHJpZXMgZm9yIHRyYW5zYWN0aW9uLicpO1xyXG4gICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IHRoaXMucmVtb3RlU3RvcmUuY3JlYXRlVHJhbnNhY3Rpb24oKTtcclxuICAgICAgICB2YXIgd3JhcHBlZFVwZGF0ZUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJQcm9taXNlID0gdXBkYXRlRnVuY3Rpb24odHJhbnNhY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzTnVsbE9yVW5kZWZpbmVkKHVzZXJQcm9taXNlKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICF1c2VyUHJvbWlzZS5jYXRjaCB8fFxyXG4gICAgICAgICAgICAgICAgICAgICF1c2VyUHJvbWlzZS50aGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KEVycm9yKCdUcmFuc2FjdGlvbiBjYWxsYmFjayBtdXN0IHJldHVybiBhIFByb21pc2UnKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXNlclByb21pc2UuY2F0Y2goZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX3RoaXMud3JhcFVwZGF0ZUZ1bmN0aW9uRXJyb3IoZSkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChfdGhpcy53cmFwVXBkYXRlRnVuY3Rpb25FcnJvcihlKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiB3cmFwcGVkVXBkYXRlRnVuY3Rpb24oKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICAuY29tbWl0KClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmV0cmllcyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGtsaW10KTogUHV0IGluIGEgcmV0cnkgZGVsYXk/XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucnVuVHJhbnNhY3Rpb24odXBkYXRlRnVuY3Rpb24sIHJldHJpZXMgLSAxKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYXBwbHlSZW1vdGVFdmVudCA9IGZ1bmN0aW9uIChyZW1vdGVFdmVudCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5hc3NlcnRTdWJzY3JpYmVkKCdhcHBseVJlbW90ZUV2ZW50KCknKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgIC5hcHBseVJlbW90ZUV2ZW50KHJlbW90ZUV2ZW50KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoY2hhbmdlcykge1xyXG4gICAgICAgICAgICAvLyBVcGRhdGUgYHJlY2VpdmVkRG9jdW1lbnRgIGFzIGFwcHJvcHJpYXRlIGZvciBhbnkgbGltYm8gdGFyZ2V0cy5cclxuICAgICAgICAgICAgZm9yRWFjaChyZW1vdGVFdmVudC50YXJnZXRDaGFuZ2VzLCBmdW5jdGlvbiAodGFyZ2V0SWQsIHRhcmdldENoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpbWJvUmVzb2x1dGlvbiA9IF90aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldFt0YXJnZXRJZF07XHJcbiAgICAgICAgICAgICAgICBpZiAobGltYm9SZXNvbHV0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU2luY2UgdGhpcyBpcyBhIGxpbWJvIHJlc29sdXRpb24gbG9va3VwLCBpdCdzIGZvciBhIHNpbmdsZSBkb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFuZCBpdCBjb3VsZCBiZSBhZGRlZCwgbW9kaWZpZWQsIG9yIHJlbW92ZWQsIGJ1dCBub3QgYSBjb21iaW5hdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICBhc3NlcnQodGFyZ2V0Q2hhbmdlLmFkZGVkRG9jdW1lbnRzLnNpemUgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRDaGFuZ2UubW9kaWZpZWREb2N1bWVudHMuc2l6ZSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldENoYW5nZS5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPD1cclxuICAgICAgICAgICAgICAgICAgICAgICAgMSwgJ0xpbWJvIHJlc29sdXRpb24gZm9yIHNpbmdsZSBkb2N1bWVudCBjb250YWlucyBtdWx0aXBsZSBjaGFuZ2VzLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXRDaGFuZ2UuYWRkZWREb2N1bWVudHMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGltYm9SZXNvbHV0aW9uLnJlY2VpdmVkRG9jdW1lbnQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0YXJnZXRDaGFuZ2UubW9kaWZpZWREb2N1bWVudHMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KGxpbWJvUmVzb2x1dGlvbi5yZWNlaXZlZERvY3VtZW50LCAnUmVjZWl2ZWQgY2hhbmdlIGZvciBsaW1ibyB0YXJnZXQgZG9jdW1lbnQgd2l0aG91dCBhZGQuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRhcmdldENoYW5nZS5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydChsaW1ib1Jlc29sdXRpb24ucmVjZWl2ZWREb2N1bWVudCwgJ1JlY2VpdmVkIHJlbW92ZSBmb3IgbGltYm8gdGFyZ2V0IGRvY3VtZW50IHdpdGhvdXQgYWRkLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW1ib1Jlc29sdXRpb24ucmVjZWl2ZWREb2N1bWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3YXMgcHJvYmFibHkganVzdCBhIENVUlJFTlQgdGFyZ2V0Q2hhbmdlIG9yIHNpbWlsYXIuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUoY2hhbmdlcywgcmVtb3RlRXZlbnQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfdGhpcy5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZXJyKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBsaWVzIGFuIE9ubGluZVN0YXRlIGNoYW5nZSB0byB0aGUgc3luYyBlbmdpbmUgYW5kIG5vdGlmaWVzIGFueSB2aWV3cyBvZlxyXG4gICAgICogdGhlIGNoYW5nZS5cclxuICAgICAqL1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYXBwbHlPbmxpbmVTdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSwgc291cmNlKSB7XHJcbiAgICAgICAgLy8gSWYgd2UgYXJlIHRoZSBzZWNvbmRhcnkgY2xpZW50LCB3ZSBleHBsaWNpdGx5IGlnbm9yZSB0aGUgcmVtb3RlIHN0b3JlJ3NcclxuICAgICAgICAvLyBvbmxpbmUgc3RhdGUgKHRoZSBsb2NhbCBjbGllbnQgbWF5IGdvIG9mZmxpbmUsIGV2ZW4gdGhvdWdoIHRoZSBwcmltYXJ5XHJcbiAgICAgICAgLy8gdGFiIHJlbWFpbnMgb25saW5lKSBhbmQgb25seSBhcHBseSB0aGUgcHJpbWFyeSB0YWIncyBvbmxpbmUgc3RhdGUgZnJvbVxyXG4gICAgICAgIC8vIFNoYXJlZENsaWVudFN0YXRlLlxyXG4gICAgICAgIGlmICgodGhpcy5pc1ByaW1hcnkgJiYgc291cmNlID09PSBPbmxpbmVTdGF0ZVNvdXJjZS5SZW1vdGVTdG9yZSkgfHxcclxuICAgICAgICAgICAgKCF0aGlzLmlzUHJpbWFyeSAmJiBzb3VyY2UgPT09IE9ubGluZVN0YXRlU291cmNlLlNoYXJlZENsaWVudFN0YXRlKSkge1xyXG4gICAgICAgICAgICB2YXIgbmV3Vmlld1NuYXBzaG90c18xID0gW107XHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlWaWV3c0J5UXVlcnkuZm9yRWFjaChmdW5jdGlvbiAocXVlcnksIHF1ZXJ5Vmlldykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXdDaGFuZ2UgPSBxdWVyeVZpZXcudmlldy5hcHBseU9ubGluZVN0YXRlQ2hhbmdlKG9ubGluZVN0YXRlKTtcclxuICAgICAgICAgICAgICAgIGFzc2VydCh2aWV3Q2hhbmdlLmxpbWJvQ2hhbmdlcy5sZW5ndGggPT09IDAsICdPbmxpbmVTdGF0ZSBzaG91bGQgbm90IGFmZmVjdCBsaW1ibyBkb2N1bWVudHMuJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmlld0NoYW5nZS5zbmFwc2hvdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld1ZpZXdTbmFwc2hvdHNfMS5wdXNoKHZpZXdDaGFuZ2Uuc25hcHNob3QpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIub25PbmxpbmVTdGF0ZUNoYW5nZShvbmxpbmVTdGF0ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyLm9uV2F0Y2hDaGFuZ2UobmV3Vmlld1NuYXBzaG90c18xKTtcclxuICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZSA9IG9ubGluZVN0YXRlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc2V0T25saW5lU3RhdGUob25saW5lU3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnJlamVjdExpc3RlbiA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgZXJyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBsaW1ib1Jlc29sdXRpb24sIGxpbWJvS2V5LCBkb2N1bWVudFVwZGF0ZXMsIHJlc29sdmVkTGltYm9Eb2N1bWVudHMsIGV2ZW50XzEsIHF1ZXJ5Vmlld18xO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0U3Vic2NyaWJlZCgncmVqZWN0TGlzdGVucygpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUudXBkYXRlUXVlcnlTdGF0ZSh0YXJnZXRJZCwgJ3JlamVjdGVkJywgZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGltYm9SZXNvbHV0aW9uID0gdGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW1ib0tleSA9IGxpbWJvUmVzb2x1dGlvbiAmJiBsaW1ib1Jlc29sdXRpb24ua2V5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxpbWJvS2V5KSByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2luY2UgdGhpcyBxdWVyeSBmYWlsZWQsIHdlIHdvbid0IHdhbnQgdG8gbWFudWFsbHkgdW5saXN0ZW4gdG8gaXQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNvIGdvIGFoZWFkIGFuZCByZW1vdmUgaXQgZnJvbSBib29ra2VlcGluZy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saW1ib1RhcmdldHNCeUtleSA9IHRoaXMubGltYm9UYXJnZXRzQnlLZXkucmVtb3ZlKGxpbWJvS2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubGltYm9SZXNvbHV0aW9uc0J5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRVcGRhdGVzID0gbmV3IFNvcnRlZE1hcChEb2N1bWVudEtleS5jb21wYXJhdG9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRVcGRhdGVzID0gZG9jdW1lbnRVcGRhdGVzLmluc2VydChsaW1ib0tleSwgbmV3IE5vRG9jdW1lbnQobGltYm9LZXksIFNuYXBzaG90VmVyc2lvbi5mb3JEZWxldGVkRG9jKCkpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRMaW1ib0RvY3VtZW50cyA9IGRvY3VtZW50S2V5U2V0KCkuYWRkKGxpbWJvS2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRfMSA9IG5ldyBSZW1vdGVFdmVudChTbmFwc2hvdFZlcnNpb24uTUlOLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgLyogdGFyZ2V0Q2hhbmdlcz0gKi8ge30sIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvKiB0YXJnZXRNaXNtYXRjaGVzPSAqLyBuZXcgU29ydGVkU2V0KHByaW1pdGl2ZUNvbXBhcmF0b3IpLCBkb2N1bWVudFVwZGF0ZXMsIHJlc29sdmVkTGltYm9Eb2N1bWVudHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5hcHBseVJlbW90ZUV2ZW50KGV2ZW50XzEpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5Vmlld18xID0gdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoISFxdWVyeVZpZXdfMSwgJ1Vua25vd24gdGFyZ2V0SWQ6ICcgKyB0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZWxlYXNlUXVlcnkocXVlcnlWaWV3XzEucXVlcnksIC8qIGtlZXBQZXJzaXN0ZWRRdWVyeURhdGEgKi8gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucmVtb3ZlQW5kQ2xlYW51cFF1ZXJ5KHF1ZXJ5Vmlld18xKTsgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX3RoaXMuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGVycik7IH0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIub25XYXRjaEVycm9yKHF1ZXJ5Vmlld18xLnF1ZXJ5LCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFwcGx5QmF0Y2hTdGF0ZSA9IGZ1bmN0aW9uIChiYXRjaElkLCBiYXRjaFN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZG9jdW1lbnRzO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXNzZXJ0U3Vic2NyaWJlZCgnYXBwbHlCYXRjaFN0YXRlKCknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmxvb2t1cE11dGF0aW9uRG9jdW1lbnRzKGJhdGNoSWQpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50cyA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50cyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSB0aHJvdHRsZWQgdGFiIG1heSBub3QgaGF2ZSBzZWVuIHRoZSBtdXRhdGlvbiBiZWZvcmUgaXQgd2FzIGNvbXBsZXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHJlbW92ZWQgZnJvbSB0aGUgbXV0YXRpb24gcXVldWUsIGluIHdoaWNoIGNhc2Ugd2Ugd29uJ3QgaGF2ZSBjYWNoZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBhZmZlY3RlZCBkb2N1bWVudHMuIEluIHRoaXMgY2FzZSB3ZSBjYW4gc2FmZWx5IGlnbm9yZSB0aGUgdXBkYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaW5jZSB0aGF0IG1lYW5zIHdlIGRpZG4ndCBhcHBseSB0aGUgbXV0YXRpb24gbG9jYWxseSBhdCBhbGwgKGlmIHdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoYWQsIHdlIHdvdWxkIGhhdmUgY2FjaGVkIHRoZSBhZmZlY3RlZCBkb2N1bWVudHMpLCBhbmQgc28gd2Ugd2lsbCBqdXN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWUgYW55IHJlc3VsdGluZyBkb2N1bWVudCBjaGFuZ2VzIHZpYSBub3JtYWwgcmVtb3RlIGRvY3VtZW50IHVwZGF0ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFzIGFwcGxpY2FibGUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDksICdDYW5ub3QgYXBwbHkgbXV0YXRpb24gYmF0Y2ggd2l0aCBpZDogJyArIGJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGJhdGNoU3RhdGUgPT09ICdwZW5kaW5nJykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSBhcmUgdGhlIHByaW1hcnkgY2xpZW50LCB3ZSBuZWVkIHRvIHNlbmQgdGhpcyB3cml0ZSB0byB0aGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmFja2VuZC4gU2Vjb25kYXJ5IGNsaWVudHMgd2lsbCBpZ25vcmUgdGhlc2Ugd3JpdGVzIHNpbmNlIHRoZWlyIHJlbW90ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25uZWN0aW9uIGlzIGRpc2FibGVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlbW90ZVN0b3JlLmZpbGxXcml0ZVBpcGVsaW5lKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgYXJlIHRoZSBwcmltYXJ5IGNsaWVudCwgd2UgbmVlZCB0byBzZW5kIHRoaXMgd3JpdGUgdG8gdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tlbmQuIFNlY29uZGFyeSBjbGllbnRzIHdpbGwgaWdub3JlIHRoZXNlIHdyaXRlcyBzaW5jZSB0aGVpciByZW1vdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29ubmVjdGlvbiBpcyBkaXNhYmxlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYXRjaFN0YXRlID09PSAnYWNrbm93bGVkZ2VkJyB8fCBiYXRjaFN0YXRlID09PSAncmVqZWN0ZWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBCb3RoIHRoZXNlIG1ldGhvZHMgYXJlIG5vLW9wcyBmb3IgYmF0Y2hlcyB0aGF0IG9yaWdpbmF0ZWQgZnJvbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXIgY2xpZW50cy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc1VzZXJDYWxsYmFjayhiYXRjaElkLCBlcnJvciQkMSA/IGVycm9yJCQxIDogbnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvY2FsU3RvcmUucmVtb3ZlQ2FjaGVkTXV0YXRpb25CYXRjaE1ldGFkYXRhKGJhdGNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbChcIlVua25vd24gYmF0Y2hTdGF0ZTogXCIgKyBiYXRjaFN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmVtaXROZXdTbmFwc0FuZE5vdGlmeUxvY2FsU3RvcmUoZG9jdW1lbnRzKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYXBwbHlTdWNjZXNzZnVsV3JpdGUgPSBmdW5jdGlvbiAobXV0YXRpb25CYXRjaFJlc3VsdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5hc3NlcnRTdWJzY3JpYmVkKCdhcHBseVN1Y2Nlc3NmdWxXcml0ZSgpJyk7XHJcbiAgICAgICAgdmFyIGJhdGNoSWQgPSBtdXRhdGlvbkJhdGNoUmVzdWx0LmJhdGNoLmJhdGNoSWQ7XHJcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIG1heSBvciBtYXkgbm90IGJlIGFibGUgdG8gYXBwbHkgdGhlIHdyaXRlIHJlc3VsdCBhbmRcclxuICAgICAgICAvLyByYWlzZSBldmVudHMgaW1tZWRpYXRlbHkgKGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB3YXRjaGVyIGlzIGNhdWdodFxyXG4gICAgICAgIC8vIHVwKSwgc28gd2UgcmFpc2UgdXNlciBjYWxsYmFja3MgZmlyc3Qgc28gdGhhdCB0aGV5IGNvbnNpc3RlbnRseSBoYXBwZW5cclxuICAgICAgICAvLyBiZWZvcmUgbGlzdGVuIGV2ZW50cy5cclxuICAgICAgICB0aGlzLnByb2Nlc3NVc2VyQ2FsbGJhY2soYmF0Y2hJZCwgLyplcnJvcj0qLyBudWxsKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgIC5hY2tub3dsZWRnZUJhdGNoKG11dGF0aW9uQmF0Y2hSZXN1bHQpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChjaGFuZ2VzKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZU11dGF0aW9uU3RhdGUoYmF0Y2hJZCwgJ2Fja25vd2xlZGdlZCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuZW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShjaGFuZ2VzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX3RoaXMuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGVycik7IH0pO1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLnJlamVjdEZhaWxlZFdyaXRlID0gZnVuY3Rpb24gKGJhdGNoSWQsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmFzc2VydFN1YnNjcmliZWQoJ3JlamVjdEZhaWxlZFdyaXRlKCknKTtcclxuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgbWF5IG9yIG1heSBub3QgYmUgYWJsZSB0byBhcHBseSB0aGUgd3JpdGUgcmVzdWx0IGFuZFxyXG4gICAgICAgIC8vIHJhaXNlIGV2ZW50cyBpbW1lZGlhdGVseSAoZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlIHdhdGNoZXIgaXMgY2F1Z2h0IHVwKSxcclxuICAgICAgICAvLyBzbyB3ZSByYWlzZSB1c2VyIGNhbGxiYWNrcyBmaXJzdCBzbyB0aGF0IHRoZXkgY29uc2lzdGVudGx5IGhhcHBlbiBiZWZvcmVcclxuICAgICAgICAvLyBsaXN0ZW4gZXZlbnRzLlxyXG4gICAgICAgIHRoaXMucHJvY2Vzc1VzZXJDYWxsYmFjayhiYXRjaElkLCBlcnJvciQkMSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZVxyXG4gICAgICAgICAgICAucmVqZWN0QmF0Y2goYmF0Y2hJZClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGNoYW5nZXMpIHtcclxuICAgICAgICAgICAgX3RoaXMuc2hhcmVkQ2xpZW50U3RhdGUudXBkYXRlTXV0YXRpb25TdGF0ZShiYXRjaElkLCAncmVqZWN0ZWQnLCBlcnJvciQkMSk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5lbWl0TmV3U25hcHNBbmROb3RpZnlMb2NhbFN0b3JlKGNoYW5nZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBfdGhpcy5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MoZXJyKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYWRkTXV0YXRpb25DYWxsYmFjayA9IGZ1bmN0aW9uIChiYXRjaElkLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBuZXdDYWxsYmFja3MgPSB0aGlzLm11dGF0aW9uVXNlckNhbGxiYWNrc1t0aGlzLmN1cnJlbnRVc2VyLnRvS2V5KCldO1xyXG4gICAgICAgIGlmICghbmV3Q2FsbGJhY2tzKSB7XHJcbiAgICAgICAgICAgIG5ld0NhbGxiYWNrcyA9IG5ldyBTb3J0ZWRNYXAocHJpbWl0aXZlQ29tcGFyYXRvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5ld0NhbGxiYWNrcyA9IG5ld0NhbGxiYWNrcy5pbnNlcnQoYmF0Y2hJZCwgY2FsbGJhY2spO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25Vc2VyQ2FsbGJhY2tzW3RoaXMuY3VycmVudFVzZXIudG9LZXkoKV0gPSBuZXdDYWxsYmFja3M7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNvbHZlcyBvciByZWplY3RzIHRoZSB1c2VyIGNhbGxiYWNrIGZvciB0aGUgZ2l2ZW4gYmF0Y2ggYW5kIHRoZW4gZGlzY2FyZHNcclxuICAgICAqIGl0LlxyXG4gICAgICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5wcm9jZXNzVXNlckNhbGxiYWNrID0gZnVuY3Rpb24gKGJhdGNoSWQsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdmFyIG5ld0NhbGxiYWNrcyA9IHRoaXMubXV0YXRpb25Vc2VyQ2FsbGJhY2tzW3RoaXMuY3VycmVudFVzZXIudG9LZXkoKV07XHJcbiAgICAgICAgLy8gTk9URTogTXV0YXRpb25zIHJlc3RvcmVkIGZyb20gcGVyc2lzdGVuY2Ugd29uJ3QgaGF2ZSBjYWxsYmFja3MsIHNvIGl0J3NcclxuICAgICAgICAvLyBva2F5IGZvciB0aGVyZSB0byBiZSBubyBjYWxsYmFjayBmb3IgdGhpcyBJRC5cclxuICAgICAgICBpZiAobmV3Q2FsbGJhY2tzKSB7XHJcbiAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IG5ld0NhbGxiYWNrcy5nZXQoYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgYXNzZXJ0KGJhdGNoSWQgPT09IG5ld0NhbGxiYWNrcy5taW5LZXkoKSwgJ011dGF0aW9uIGNhbGxiYWNrcyBwcm9jZXNzZWQgb3V0LW9mLW9yZGVyPycpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yJCQxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sucmVqZWN0KGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG5ld0NhbGxiYWNrcyA9IG5ld0NhbGxiYWNrcy5yZW1vdmUoYmF0Y2hJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tdXRhdGlvblVzZXJDYWxsYmFja3NbdGhpcy5jdXJyZW50VXNlci50b0tleSgpXSA9IG5ld0NhbGxiYWNrcztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUucmVtb3ZlQW5kQ2xlYW51cFF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5Vmlldykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KHF1ZXJ5Vmlldy50YXJnZXRJZCk7XHJcbiAgICAgICAgdGhpcy5xdWVyeVZpZXdzQnlRdWVyeS5kZWxldGUocXVlcnlWaWV3LnF1ZXJ5KTtcclxuICAgICAgICBkZWxldGUgdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbcXVlcnlWaWV3LnRhcmdldElkXTtcclxuICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgdmFyIGxpbWJvS2V5cyA9IHRoaXMubGltYm9Eb2N1bWVudFJlZnMucmVmZXJlbmNlc0ZvcklkKHF1ZXJ5Vmlldy50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgIHRoaXMubGltYm9Eb2N1bWVudFJlZnMucmVtb3ZlUmVmZXJlbmNlc0ZvcklkKHF1ZXJ5Vmlldy50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgIGxpbWJvS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChsaW1ib0tleSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlzUmVmZXJlbmNlZCA9IF90aGlzLmxpbWJvRG9jdW1lbnRSZWZzLmNvbnRhaW5zS2V5KGxpbWJvS2V5KTtcclxuICAgICAgICAgICAgICAgIGlmICghaXNSZWZlcmVuY2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgcmVtb3ZlZCB0aGUgbGFzdCByZWZlcmVuY2UgZm9yIHRoaXMga2V5XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVtb3ZlTGltYm9UYXJnZXQobGltYm9LZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUucmVtb3ZlTGltYm9UYXJnZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHRoZSB0YXJnZXQgYWxyZWFkeSBnb3QgcmVtb3ZlZCBiZWNhdXNlIHRoZSBxdWVyeSBmYWlsZWQuIEluIHRoYXQgY2FzZSxcclxuICAgICAgICAvLyB0aGUga2V5IHdvbid0IGV4aXN0IGluIGBsaW1ib1RhcmdldHNCeUtleWAuIE9ubHkgZG8gdGhlIGNsZWFudXAgaWYgd2Ugc3RpbGwgaGF2ZSB0aGUgdGFyZ2V0LlxyXG4gICAgICAgIHZhciBsaW1ib1RhcmdldElkID0gdGhpcy5saW1ib1RhcmdldHNCeUtleS5nZXQoa2V5KTtcclxuICAgICAgICBpZiAobGltYm9UYXJnZXRJZCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyBUaGlzIHRhcmdldCBhbHJlYWR5IGdvdCByZW1vdmVkLCBiZWNhdXNlIHRoZSBxdWVyeSBmYWlsZWQuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZW1vdGVTdG9yZS51bmxpc3RlbihsaW1ib1RhcmdldElkKTtcclxuICAgICAgICB0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5ID0gdGhpcy5saW1ib1RhcmdldHNCeUtleS5yZW1vdmUoa2V5KTtcclxuICAgICAgICBkZWxldGUgdGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXRbbGltYm9UYXJnZXRJZF07XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUudXBkYXRlVHJhY2tlZExpbWJvcyA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgbGltYm9DaGFuZ2VzKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBsaW1ib0NoYW5nZXNfMSA9IGxpbWJvQ2hhbmdlczsgX2kgPCBsaW1ib0NoYW5nZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGxpbWJvQ2hhbmdlID0gbGltYm9DaGFuZ2VzXzFbX2ldO1xyXG4gICAgICAgICAgICBpZiAobGltYm9DaGFuZ2UgaW5zdGFuY2VvZiBBZGRlZExpbWJvRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGltYm9Eb2N1bWVudFJlZnMuYWRkUmVmZXJlbmNlKGxpbWJvQ2hhbmdlLmtleSwgdGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmFja0xpbWJvQ2hhbmdlKGxpbWJvQ2hhbmdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChsaW1ib0NoYW5nZSBpbnN0YW5jZW9mIFJlbW92ZWRMaW1ib0RvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDksICdEb2N1bWVudCBubyBsb25nZXIgaW4gbGltYm86ICcgKyBsaW1ib0NoYW5nZS5rZXkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saW1ib0RvY3VtZW50UmVmcy5yZW1vdmVSZWZlcmVuY2UobGltYm9DaGFuZ2Uua2V5LCB0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNSZWZlcmVuY2VkID0gdGhpcy5saW1ib0RvY3VtZW50UmVmcy5jb250YWluc0tleShsaW1ib0NoYW5nZS5rZXkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpc1JlZmVyZW5jZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBXZSByZW1vdmVkIHRoZSBsYXN0IHJlZmVyZW5jZSBmb3IgdGhpcyBrZXlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUxpbWJvVGFyZ2V0KGxpbWJvQ2hhbmdlLmtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmYWlsKCdVbmtub3duIGxpbWJvIGNoYW5nZTogJyArIEpTT04uc3RyaW5naWZ5KGxpbWJvQ2hhbmdlKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUudHJhY2tMaW1ib0NoYW5nZSA9IGZ1bmN0aW9uIChsaW1ib0NoYW5nZSkge1xyXG4gICAgICAgIHZhciBrZXkgPSBsaW1ib0NoYW5nZS5rZXk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmxpbWJvVGFyZ2V0c0J5S2V5LmdldChrZXkpKSB7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckOSwgJ05ldyBkb2N1bWVudCBpbiBsaW1ibzogJyArIGtleSk7XHJcbiAgICAgICAgICAgIHZhciBsaW1ib1RhcmdldElkID0gdGhpcy5saW1ib1RhcmdldElkR2VuZXJhdG9yLm5leHQoKTtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gUXVlcnkuYXRQYXRoKGtleS5wYXRoKTtcclxuICAgICAgICAgICAgdGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXRbbGltYm9UYXJnZXRJZF0gPSBuZXcgTGltYm9SZXNvbHV0aW9uKGtleSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3RlU3RvcmUubGlzdGVuKG5ldyBRdWVyeURhdGEocXVlcnksIGxpbWJvVGFyZ2V0SWQsIFF1ZXJ5UHVycG9zZS5MaW1ib1Jlc29sdXRpb24sIExpc3RlblNlcXVlbmNlLklOVkFMSUQpKTtcclxuICAgICAgICAgICAgdGhpcy5saW1ib1RhcmdldHNCeUtleSA9IHRoaXMubGltYm9UYXJnZXRzQnlLZXkuaW5zZXJ0KGtleSwgbGltYm9UYXJnZXRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmdcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmN1cnJlbnRMaW1ib0RvY3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGltYm9UYXJnZXRzQnlLZXk7XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuZW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZSA9IGZ1bmN0aW9uIChjaGFuZ2VzLCByZW1vdGVFdmVudCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgbmV3U25hcHMsIGRvY0NoYW5nZXNJbkFsbFZpZXdzLCBxdWVyaWVzUHJvY2Vzc2VkO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1NuYXBzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY0NoYW5nZXNJbkFsbFZpZXdzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJpZXNQcm9jZXNzZWQgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeVZpZXdzQnlRdWVyeS5mb3JFYWNoKGZ1bmN0aW9uIChfLCBxdWVyeVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJpZXNQcm9jZXNzZWQucHVzaChQcm9taXNlLnJlc29sdmUoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmlld0RvY0NoYW5nZXMgPSBxdWVyeVZpZXcudmlldy5jb21wdXRlRG9jQ2hhbmdlcyhjaGFuZ2VzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXZpZXdEb2NDaGFuZ2VzLm5lZWRzUmVmaWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2aWV3RG9jQ2hhbmdlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHF1ZXJ5IGhhcyBhIGxpbWl0IGFuZCBzb21lIGRvY3Mgd2VyZSByZW1vdmVkLCBzbyB3ZSBuZWVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gcmUtcnVuIHRoZSBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCBzdG9yZSB0byBtYWtlIHN1cmUgd2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkaWRuJ3QgbG9zZSBhbnkgZ29vZCBkb2NzIHRoYXQgaGFkIGJlZW4gcGFzdCB0aGUgbGltaXQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmxvY2FsU3RvcmUuZXhlY3V0ZVF1ZXJ5KHF1ZXJ5Vmlldy5xdWVyeSkudGhlbihmdW5jdGlvbiAoZG9jcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcXVlcnlWaWV3LnZpZXcuY29tcHV0ZURvY0NoYW5nZXMoZG9jcywgdmlld0RvY0NoYW5nZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodmlld0RvY0NoYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0Q2hhbmdlID0gcmVtb3RlRXZlbnQgJiYgcmVtb3RlRXZlbnQudGFyZ2V0Q2hhbmdlc1txdWVyeVZpZXcudGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aWV3Q2hhbmdlID0gcXVlcnlWaWV3LnZpZXcuYXBwbHlDaGFuZ2VzKHZpZXdEb2NDaGFuZ2VzLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gX3RoaXMuaXNQcmltYXJ5ID09PSB0cnVlLCB0YXJnZXRDaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnVwZGF0ZVRyYWNrZWRMaW1ib3MocXVlcnlWaWV3LnRhcmdldElkLCB2aWV3Q2hhbmdlLmxpbWJvQ2hhbmdlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdDaGFuZ2Uuc25hcHNob3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2hhcmVkQ2xpZW50U3RhdGUudXBkYXRlUXVlcnlTdGF0ZShxdWVyeVZpZXcudGFyZ2V0SWQsIHZpZXdDaGFuZ2Uuc25hcHNob3QuZnJvbUNhY2hlID8gJ25vdC1jdXJyZW50JyA6ICdjdXJyZW50Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3U25hcHMucHVzaCh2aWV3Q2hhbmdlLnNuYXBzaG90KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRvY0NoYW5nZXMgPSBMb2NhbFZpZXdDaGFuZ2VzLmZyb21TbmFwc2hvdChxdWVyeVZpZXcudGFyZ2V0SWQsIHZpZXdDaGFuZ2Uuc25hcHNob3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2NDaGFuZ2VzSW5BbGxWaWV3cy5wdXNoKGRvY0NoYW5nZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIFByb21pc2UuYWxsKHF1ZXJpZXNQcm9jZXNzZWQpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIub25XYXRjaENoYW5nZShuZXdTbmFwcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5ub3RpZnlMb2NhbFZpZXdDaGFuZ2VzKGRvY0NoYW5nZXNJbkFsbFZpZXdzKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBWZXJpZmllcyB0aGUgZXJyb3IgdGhyb3duIGJ5IGFuIExvY2FsU3RvcmUgb3BlcmF0aW9uLiBJZiBhIExvY2FsU3RvcmVcclxuICAgICAqIG9wZXJhdGlvbiBmYWlscyBiZWNhdXNlIHRoZSBwcmltYXJ5IGxlYXNlIGhhcyBiZWVuIHRha2VuIGJ5IGFub3RoZXIgY2xpZW50LFxyXG4gICAgICogd2UgaWdub3JlIHRoZSBlcnJvciAodGhlIHBlcnNpc3RlbmNlIGxheWVyIHdpbGwgaW1tZWRpYXRlbHkgY2FsbFxyXG4gICAgICogYGFwcGx5UHJpbWFyeUxlYXNlYCB0byBwcm9wYWdhdGUgdGhlIHByaW1hcnkgc3RhdGUgY2hhbmdlKS4gQWxsIG90aGVyXHJcbiAgICAgKiBlcnJvcnMgYXJlIHJlLXRocm93bi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXJyIEFuIGVycm9yIHJldHVybmVkIGJ5IGEgTG9jYWxTdG9yZSBvcGVyYXRpb24uXHJcbiAgICAgKiBAcmV0dXJuIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIHdlIHJlY292ZXJlZCwgb3IgdGhlIG9yaWdpbmFsIGVycm9yLlxyXG4gICAgICovXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5pZ25vcmVJZlByaW1hcnlMZWFzZUxvc3MgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzUHJpbWFyeUxlYXNlTG9zdEVycm9yKGVycikpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWJ1ZyhMT0dfVEFHJDksICdVbmV4cGVjdGVkbHkgbG9zdCBwcmltYXJ5IGxlYXNlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFzc2VydFN1YnNjcmliZWQgPSBmdW5jdGlvbiAoZm5OYW1lKSB7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuc3luY0VuZ2luZUxpc3RlbmVyICE9PSBudWxsLCAnVHJ5aW5nIHRvIGNhbGwgJyArIGZuTmFtZSArICcgYmVmb3JlIGNhbGxpbmcgc3Vic2NyaWJlKCkuJyk7XHJcbiAgICB9O1xyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuaGFuZGxlQ3JlZGVudGlhbENoYW5nZSA9IGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB1c2VyQ2hhbmdlZCwgcmVzdWx0O1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJDaGFuZ2VkID0gIXRoaXMuY3VycmVudFVzZXIuaXNFcXVhbCh1c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdXNlckNoYW5nZWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuaGFuZGxlVXNlckNoYW5nZSh1c2VyKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oYi8xMTQyMjY0MTcpOiBDb25zaWRlciBjYWxsaW5nIHRoaXMgb25seSBpbiB0aGUgcHJpbWFyeSB0YWIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuaGFuZGxlVXNlckNoYW5nZSh1c2VyLCByZXN1bHQucmVtb3ZlZEJhdGNoSWRzLCByZXN1bHQuYWRkZWRCYXRjaElkcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShyZXN1bHQuYWZmZWN0ZWREb2N1bWVudHMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZW1vdGVTdG9yZS5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmFwcGx5UHJpbWFyeVN0YXRlID0gZnVuY3Rpb24gKGlzUHJpbWFyeSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgYWN0aXZlVGFyZ2V0cywgYWN0aXZlUXVlcmllcywgX2ksIGFjdGl2ZVF1ZXJpZXNfMSwgcXVlcnlEYXRhLCBhY3RpdmVUYXJnZXRzXzEsIHBfMTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpc1ByaW1hcnkgPT09IHRydWUgJiYgdGhpcy5pc1ByaW1hcnkgIT09IHRydWUpKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1ByaW1hcnkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlbW90ZVN0b3JlLmFwcGx5UHJpbWFyeVN0YXRlKHRydWUpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGFyZ2V0cyA9IHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc3luY2hyb25pemVRdWVyeVZpZXdzQW5kUmFpc2VTbmFwc2hvdHMoYWN0aXZlVGFyZ2V0cy50b0FycmF5KCkpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVF1ZXJpZXMgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2kgPSAwLCBhY3RpdmVRdWVyaWVzXzEgPSBhY3RpdmVRdWVyaWVzOyBfaSA8IGFjdGl2ZVF1ZXJpZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0YSA9IGFjdGl2ZVF1ZXJpZXNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLmxpc3RlbihxdWVyeURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaXNQcmltYXJ5ID09PSBmYWxzZSAmJiB0aGlzLmlzUHJpbWFyeSAhPT0gZmFsc2UpKSByZXR1cm4gWzMgLypicmVhayovLCA3XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1ByaW1hcnkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGFyZ2V0c18xID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBfMSA9IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JFYWNoTnVtYmVyKHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0LCBmdW5jdGlvbiAodGFyZ2V0SWQsIHF1ZXJ5Vmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnNoYXJlZENsaWVudFN0YXRlLmlzTG9jYWxRdWVyeVRhcmdldCh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVUYXJnZXRzXzEucHVzaCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwXzEgPSBwXzEudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy51bmxpc3RlbihxdWVyeVZpZXcucXVlcnkpOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJlbW90ZVN0b3JlLnVubGlzdGVuKHF1ZXJ5Vmlldy50YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBwXzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnN5bmNocm9uaXplUXVlcnlWaWV3c0FuZFJhaXNlU25hcHNob3RzKGFjdGl2ZVRhcmdldHNfMSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0TGltYm9Eb2N1bWVudHMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZW1vdGVTdG9yZS5hcHBseVByaW1hcnlTdGF0ZShmYWxzZSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDc7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5yZXNldExpbWJvRG9jdW1lbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgZm9yRWFjaE51bWJlcih0aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldCwgZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnJlbW90ZVN0b3JlLnVubGlzdGVuKHRhcmdldElkKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmxpbWJvRG9jdW1lbnRSZWZzLnJlbW92ZUFsbFJlZmVyZW5jZXMoKTtcclxuICAgICAgICB0aGlzLmxpbWJvUmVzb2x1dGlvbnNCeVRhcmdldCA9IFtdO1xyXG4gICAgICAgIHRoaXMubGltYm9UYXJnZXRzQnlLZXkgPSBuZXcgU29ydGVkTWFwKERvY3VtZW50S2V5LmNvbXBhcmF0b3IpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVjb25jaWxlIHRoZSBxdWVyeSB2aWV3cyBvZiB0aGUgcHJvdmlkZWQgcXVlcnkgdGFyZ2V0cyB3aXRoIHRoZSBzdGF0ZSBmcm9tXHJcbiAgICAgKiBwZXJzaXN0ZW5jZS4gUmFpc2VzIHNuYXBzaG90cyBmb3IgYW55IGNoYW5nZXMgdGhhdCBhZmZlY3QgdGhlIGxvY2FsXHJcbiAgICAgKiBjbGllbnQgYW5kIHJldHVybnMgdGhlIHVwZGF0ZWQgc3RhdGUgb2YgYWxsIHRhcmdldCdzIHF1ZXJ5IGRhdGEuXHJcbiAgICAgKi9cclxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5zeW5jaHJvbml6ZVF1ZXJ5Vmlld3NBbmRSYWlzZVNuYXBzaG90cyA9IGZ1bmN0aW9uICh0YXJnZXRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcCA9IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIHZhciBhY3RpdmVRdWVyaWVzID0gW107XHJcbiAgICAgICAgdmFyIG5ld1ZpZXdTbmFwc2hvdHMgPSBbXTtcclxuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgICAgICBwID0gcC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHF1ZXJ5RGF0YSwgcXVlcnlWaWV3LCB2aWV3Q2hhbmdlLCBxdWVyeTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlWaWV3ID0gdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFxdWVyeVZpZXcpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIHF1ZXJpZXMgdGhhdCBoYXZlIGEgbG9jYWwgVmlldywgd2UgbmVlZCB0byB1cGRhdGUgdGhlaXIgc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluIExvY2FsU3RvcmUgKGFzIHRoZSByZXN1bWUgdG9rZW4gYW5kIHRoZSBzbmFwc2hvdCB2ZXJzaW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtaWdodCBoYXZlIGNoYW5nZWQpIGFuZCByZWNvbmNpbGUgdGhlaXIgdmlld3Mgd2l0aCB0aGUgcGVyc2lzdGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGF0ZSAodGhlIGxpc3Qgb2Ygc3luY2VkRG9jdW1lbnRzIG1heSBoYXZlIGdvdHRlbiBvdXQgb2Ygc3luYykuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUucmVsZWFzZVF1ZXJ5KHF1ZXJ5Vmlldy5xdWVyeSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyprZWVwUGVyc2lzdGVkUXVlcnlEYXRhPSovIHRydWUpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIHF1ZXJpZXMgdGhhdCBoYXZlIGEgbG9jYWwgVmlldywgd2UgbmVlZCB0byB1cGRhdGUgdGhlaXIgc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluIExvY2FsU3RvcmUgKGFzIHRoZSByZXN1bWUgdG9rZW4gYW5kIHRoZSBzbmFwc2hvdCB2ZXJzaW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtaWdodCBoYXZlIGNoYW5nZWQpIGFuZCByZWNvbmNpbGUgdGhlaXIgdmlld3Mgd2l0aCB0aGUgcGVyc2lzdGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGF0ZSAodGhlIGxpc3Qgb2Ygc3luY2VkRG9jdW1lbnRzIG1heSBoYXZlIGdvdHRlbiBvdXQgb2Ygc3luYykuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuYWxsb2NhdGVRdWVyeShxdWVyeVZpZXcucXVlcnkpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRhID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zeW5jaHJvbml6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QocXVlcnlWaWV3KV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdDaGFuZ2UgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlld0NoYW5nZS5zbmFwc2hvdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZpZXdTbmFwc2hvdHMucHVzaCh2aWV3Q2hhbmdlLnNuYXBzaG90KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQodGhpcy5pc1ByaW1hcnkgPT09IHRydWUsICdBIHNlY29uZGFyeSB0YWIgc2hvdWxkIG5ldmVyIGhhdmUgYW4gYWN0aXZlIHF1ZXJ5IHdpdGhvdXQgYW4gYWN0aXZlIHZpZXcuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuZ2V0UXVlcnlGb3JUYXJnZXQodGFyZ2V0SWQpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoISFxdWVyeSwgXCJRdWVyeSBkYXRhIGZvciB0YXJnZXQgXCIgKyB0YXJnZXRJZCArIFwiIG5vdCBmb3VuZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9jYWxTdG9yZS5hbGxvY2F0ZVF1ZXJ5KHF1ZXJ5KV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5RGF0YSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaW5pdGlhbGl6ZVZpZXdBbmRDb21wdXRlU25hcHNob3QocXVlcnlEYXRhLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKmN1cnJlbnQ9Ki8gZmFsc2UpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVRdWVyaWVzLnB1c2gocXVlcnlEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7IH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCB0YXJnZXRzXzEgPSB0YXJnZXRzOyBfaSA8IHRhcmdldHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldElkID0gdGFyZ2V0c18xW19pXTtcclxuICAgICAgICAgICAgX2xvb3BfMSh0YXJnZXRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5zeW5jRW5naW5lTGlzdGVuZXIub25XYXRjaENoYW5nZShuZXdWaWV3U25hcHNob3RzKTtcclxuICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZVF1ZXJpZXM7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuZ2V0QWN0aXZlQ2xpZW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0b3JlLmdldEFjdGl2ZUNsaWVudHMoKTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5XHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5hcHBseVRhcmdldFN0YXRlID0gZnVuY3Rpb24gKHRhcmdldElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIF9hLCBxdWVyeVZpZXc7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQcmltYXJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZWNlaXZlIGEgdGFyZ2V0IHN0YXRlIG5vdGlmaWNhdGlvbiB2aWEgV2ViU3RvcmFnZSwgd2UgYXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlaXRoZXIgYWxyZWFkeSBzZWNvbmRhcnkgb3IgYW5vdGhlciB0YWIgaGFzIHRha2VuIHRoZSBwcmltYXJ5IGxlYXNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWcoTE9HX1RBRyQ5LCAnSWdub3JpbmcgdW5leHBlY3RlZCBxdWVyeSBzdGF0ZSBub3RpZmljYXRpb24uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFt0YXJnZXRJZF0pIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHN0YXRlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50JzogcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdub3QtY3VycmVudCc6IHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVqZWN0ZWQnOiByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmxvY2FsU3RvcmUuZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKCkudGhlbihmdW5jdGlvbiAoY2hhbmdlcykgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzeW50aGVzaXplZFJlbW90ZUV2ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5bnRoZXNpemVkUmVtb3RlRXZlbnQgPSBSZW1vdGVFdmVudC5jcmVhdGVTeW50aGVzaXplZFJlbW90ZUV2ZW50Rm9yQ3VycmVudENoYW5nZSh0YXJnZXRJZCwgc3RhdGUgPT09ICdjdXJyZW50Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZW1pdE5ld1NuYXBzQW5kTm90aWZ5TG9jYWxTdG9yZShjaGFuZ2VzLCBzeW50aGVzaXplZFJlbW90ZUV2ZW50KV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH0sIGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlVGFyZ2V0c18yO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNEb2N1bWVudENoYW5nZU1pc3NpbmdFcnJvcihlcnIpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVGFyZ2V0c18yID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvckVhY2hOdW1iZXIodGhpcy5xdWVyeVZpZXdzQnlUYXJnZXQsIGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3RpdmVUYXJnZXRzXzIucHVzaCh0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zeW5jaHJvbml6ZVF1ZXJ5Vmlld3NBbmRSYWlzZVNuYXBzaG90cyhhY3RpdmVUYXJnZXRzXzIpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlWaWV3ID0gdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUFuZENsZWFudXBRdWVyeShxdWVyeVZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUucmVsZWFzZVF1ZXJ5KHF1ZXJ5Vmlldy5xdWVyeSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKmtlZXBQZXJzaXN0ZWRRdWVyeURhdGE9Ki8gdHJ1ZSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN5bmNFbmdpbmVMaXN0ZW5lci5vbldhdGNoRXJyb3IocXVlcnlWaWV3LnF1ZXJ5LCBlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbCgnVW5leHBlY3RlZCB0YXJnZXQgc3RhdGU6ICcgKyBzdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuYXBwbHlBY3RpdmVUYXJnZXRzQ2hhbmdlID0gZnVuY3Rpb24gKGFkZGVkLCByZW1vdmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBfaSwgYWRkZWRfMSwgdGFyZ2V0SWQsIHF1ZXJ5LCBxdWVyeURhdGEsIF9sb29wXzIsIHRoaXNfMSwgX2EsIHJlbW92ZWRfMSwgdGFyZ2V0SWQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzUHJpbWFyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pID0gMCwgYWRkZWRfMSA9IGFkZGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShfaSA8IGFkZGVkXzEubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkID0gYWRkZWRfMVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCghdGhpcy5xdWVyeVZpZXdzQnlUYXJnZXRbdGFyZ2V0SWRdLCAnVHJ5aW5nIHRvIGFkZCBhbiBhbHJlYWR5IGFjdGl2ZSB0YXJnZXQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2NhbFN0b3JlLmdldFF1ZXJ5Rm9yVGFyZ2V0KHRhcmdldElkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KCEhcXVlcnksIFwiUXVlcnkgZGF0YSBmb3IgYWN0aXZlIHRhcmdldCBcIiArIHRhcmdldElkICsgXCIgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvY2FsU3RvcmUuYWxsb2NhdGVRdWVyeShxdWVyeSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlEYXRhID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmluaXRpYWxpemVWaWV3QW5kQ29tcHV0ZVNuYXBzaG90KHF1ZXJ5RGF0YSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKmN1cnJlbnQ9Ki8gZmFsc2UpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVTdG9yZS5saXN0ZW4ocXVlcnlEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2krKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9vcF8yID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcXVlcnlWaWV3O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVZpZXcgPSB0aGlzXzEucXVlcnlWaWV3c0J5VGFyZ2V0W3RhcmdldElkXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnlWaWV3KSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXNfMS5sb2NhbFN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZWxlYXNlUXVlcnkocXVlcnlWaWV3LnF1ZXJ5LCAvKmtlZXBQZXJzaXN0ZWRRdWVyeURhdGE9Ki8gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucmVtb3RlU3RvcmUudW5saXN0ZW4odGFyZ2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdmVBbmRDbGVhbnVwUXVlcnkocXVlcnlWaWV3KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikgeyByZXR1cm4gX3RoaXMuaWdub3JlSWZQcmltYXJ5TGVhc2VMb3NzKGVycik7IH0pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc18xID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSAwLCByZW1vdmVkXzEgPSByZW1vdmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDc7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShfYSA8IHJlbW92ZWRfMS5sZW5ndGgpKSByZXR1cm4gWzMgLypicmVhayovLCAxMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkID0gcmVtb3ZlZF8xW19hXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs1IC8qeWllbGQqKi8sIF9sb29wXzIodGFyZ2V0SWQpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA5O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2ErKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LiBJbiBvdGhlciBjbGllbnRzLCBMb2NhbFN0b3JlIGlzIHVuYXdhcmUgb2ZcclxuICAgIC8vIHRoZSBvbmxpbmUgc3RhdGUuXHJcbiAgICBTeW5jRW5naW5lLnByb3RvdHlwZS5lbmFibGVOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubG9jYWxTdG9yZS5zZXROZXR3b3JrRW5hYmxlZCh0cnVlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVTdG9yZS5lbmFibGVOZXR3b3JrKCk7XHJcbiAgICB9O1xyXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS4gSW4gb3RoZXIgY2xpZW50cywgTG9jYWxTdG9yZSBpcyB1bmF3YXJlIG9mXHJcbiAgICAvLyB0aGUgb25saW5lIHN0YXRlLlxyXG4gICAgU3luY0VuZ2luZS5wcm90b3R5cGUuZGlzYWJsZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlLnNldE5ldHdvcmtFbmFibGVkKGZhbHNlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVTdG9yZS5kaXNhYmxlTmV0d29yaygpO1xyXG4gICAgfTtcclxuICAgIFN5bmNFbmdpbmUucHJvdG90eXBlLmdldFJlbW90ZUtleXNGb3JUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgbGltYm9SZXNvbHV0aW9uID0gdGhpcy5saW1ib1Jlc29sdXRpb25zQnlUYXJnZXRbdGFyZ2V0SWRdO1xyXG4gICAgICAgIGlmIChsaW1ib1Jlc29sdXRpb24gJiYgbGltYm9SZXNvbHV0aW9uLnJlY2VpdmVkRG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50S2V5U2V0KCkuYWRkKGxpbWJvUmVzb2x1dGlvbi5rZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVlcnlWaWV3c0J5VGFyZ2V0W3RhcmdldElkXVxyXG4gICAgICAgICAgICAgICAgPyB0aGlzLnF1ZXJ5Vmlld3NCeVRhcmdldFt0YXJnZXRJZF0udmlldy5zeW5jZWREb2N1bWVudHNcclxuICAgICAgICAgICAgICAgIDogZG9jdW1lbnRLZXlTZXQoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFN5bmNFbmdpbmU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogU2ltcGxlIHdyYXBwZXIgYXJvdW5kIGEgbnVsbGFibGUgVUlELiBNb3N0bHkgZXhpc3RzIHRvIG1ha2UgY29kZSBtb3JlXHJcbiAqIHJlYWRhYmxlLlxyXG4gKi9cclxudmFyIFVzZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBVc2VyKHVpZCkge1xyXG4gICAgICAgIHRoaXMudWlkID0gdWlkO1xyXG4gICAgfVxyXG4gICAgVXNlci5wcm90b3R5cGUuaXNBdXRoZW50aWNhdGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnVpZCAhPSBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIGtleSByZXByZXNlbnRpbmcgdGhpcyB1c2VyLCBzdWl0YWJsZSBmb3IgaW5jbHVzaW9uIGluIGFcclxuICAgICAqIGRpY3Rpb25hcnkuXHJcbiAgICAgKi9cclxuICAgIFVzZXIucHJvdG90eXBlLnRvS2V5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQXV0aGVudGljYXRlZCgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAndWlkOicgKyB0aGlzLnVpZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnYW5vbnltb3VzLXVzZXInO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBVc2VyLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyVXNlcikge1xyXG4gICAgICAgIHJldHVybiBvdGhlclVzZXIudWlkID09PSB0aGlzLnVpZDtcclxuICAgIH07XHJcbiAgICAvKiogQSB1c2VyIHdpdGggYSBudWxsIFVJRC4gKi9cclxuICAgIFVzZXIuVU5BVVRIRU5USUNBVEVEID0gbmV3IFVzZXIobnVsbCk7XHJcbiAgICAvLyBUT0RPKG1pa2VsZWhlbik6IExvb2sgaW50byBnZXR0aW5nIGEgcHJvcGVyIHVpZC1lcXVpdmFsZW50IGZvclxyXG4gICAgLy8gbm9uLUZpcmViYXNlQXV0aCBwcm92aWRlcnMuXHJcbiAgICBVc2VyLkdPT0dMRV9DUkVERU5USUFMUyA9IG5ldyBVc2VyKCdnb29nbGUtY3JlZGVudGlhbHMtdWlkJyk7XHJcbiAgICBVc2VyLkZJUlNUX1BBUlRZID0gbmV3IFVzZXIoJ2ZpcnN0LXBhcnR5LXVpZCcpO1xyXG4gICAgcmV0dXJuIFVzZXI7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQxMCA9ICdTaGFyZWRDbGllbnRTdGF0ZSc7XHJcbi8vIFRoZSBmb3JtYXQgb2YgdGhlIExvY2FsU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGNsaWVudCBzdGF0ZSBpczpcclxuLy8gICAgIGZpcmVzdG9yZV9jbGllbnRzXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XzxpbnN0YW5jZV9rZXk+XHJcbnZhciBDTElFTlRfU1RBVEVfS0VZX1BSRUZJWCA9ICdmaXJlc3RvcmVfY2xpZW50cyc7XHJcbi8vIFRoZSBmb3JtYXQgb2YgdGhlIFdlYlN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIHRoZSBtdXRhdGlvbiBzdGF0ZSBpczpcclxuLy8gICAgIGZpcmVzdG9yZV9tdXRhdGlvbnNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPGJhdGNoX2lkPlxyXG4vLyAgICAgKGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnMpXHJcbi8vIG9yOiBmaXJlc3RvcmVfbXV0YXRpb25zXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XzxiYXRjaF9pZD5fPHVzZXJfdWlkPlxyXG4vL1xyXG4vLyAndXNlcl91aWQnIGlzIGxhc3QgdG8gYXZvaWQgbmVlZGluZyB0byBlc2NhcGUgJ18nIGNoYXJhY3RlcnMgdGhhdCBpdCBtaWdodFxyXG4vLyBjb250YWluLlxyXG52YXIgTVVUQVRJT05fQkFUQ0hfS0VZX1BSRUZJWCA9ICdmaXJlc3RvcmVfbXV0YXRpb25zJztcclxuLy8gVGhlIGZvcm1hdCBvZiB0aGUgV2ViU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgYSBxdWVyeSB0YXJnZXQncyBtZXRhZGF0YSBpczpcclxuLy8gICAgIGZpcmVzdG9yZV90YXJnZXRzXzxwZXJzaXN0ZW5jZV9wcmVmaXg+Xzx0YXJnZXRfaWQ+XHJcbnZhciBRVUVSWV9UQVJHRVRfS0VZX1BSRUZJWCA9ICdmaXJlc3RvcmVfdGFyZ2V0cyc7XHJcbi8vIFRoZSBXZWJTdG9yYWdlIHByZWZpeCB0aGF0IHN0b3JlcyB0aGUgcHJpbWFyeSB0YWIncyBvbmxpbmUgc3RhdGUuIFRoZVxyXG4vLyBmb3JtYXQgb2YgdGhlIGtleSBpczpcclxuLy8gICAgIGZpcmVzdG9yZV9vbmxpbmVfc3RhdGVfPHBlcnNpc3RlbmNlX3ByZWZpeD5cclxudmFyIE9OTElORV9TVEFURV9LRVlfUFJFRklYID0gJ2ZpcmVzdG9yZV9vbmxpbmVfc3RhdGUnO1xyXG4vLyBUaGUgV2ViU3RvcmFnZSBrZXkgcHJlZml4IGZvciB0aGUga2V5IHRoYXQgc3RvcmVzIHRoZSBsYXN0IHNlcXVlbmNlIG51bWJlciBhbGxvY2F0ZWQuIFRoZSBrZXlcclxuLy8gbG9va3MgbGlrZSAnZmlyZXN0b3JlX3NlcXVlbmNlX251bWJlcl88cGVyc2lzdGVuY2VfcHJlZml4PicuXHJcbnZhciBTRVFVRU5DRV9OVU1CRVJfS0VZX1BSRUZJWCA9ICdmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyJztcclxuLyoqXHJcbiAqIEhvbGRzIHRoZSBzdGF0ZSBvZiBhIG11dGF0aW9uIGJhdGNoLCBpbmNsdWRpbmcgaXRzIHVzZXIgSUQsIGJhdGNoIElEIGFuZFxyXG4gKiB3aGV0aGVyIHRoZSBiYXRjaCBpcyAncGVuZGluZycsICdhY2tub3dsZWRnZWQnIG9yICdyZWplY3RlZCcuXHJcbiAqL1xyXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXHJcbnZhciBNdXRhdGlvbk1ldGFkYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTXV0YXRpb25NZXRhZGF0YSh1c2VyLCBiYXRjaElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgIHRoaXMuYmF0Y2hJZCA9IGJhdGNoSWQ7XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvciQkMTtcclxuICAgICAgICBhc3NlcnQoKGVycm9yJCQxICE9PSB1bmRlZmluZWQpID09PSAoc3RhdGUgPT09ICdyZWplY3RlZCcpLCBcIk11dGF0aW9uTWV0YWRhdGEgbXVzdCBjb250YWluIGFuIGVycm9yIGlmZiBzdGF0ZSBpcyAncmVqZWN0ZWQnXCIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBNdXRhdGlvbk1ldGFkYXRhIGZyb20gaXRzIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cclxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXHJcbiAgICAgKi9cclxuICAgIE11dGF0aW9uTWV0YWRhdGEuZnJvbVdlYlN0b3JhZ2VFbnRyeSA9IGZ1bmN0aW9uICh1c2VyLCBiYXRjaElkLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBtdXRhdGlvbkJhdGNoID0gSlNPTi5wYXJzZSh2YWx1ZSk7XHJcbiAgICAgICAgdmFyIHZhbGlkRGF0YSA9IHR5cGVvZiBtdXRhdGlvbkJhdGNoID09PSAnb2JqZWN0JyAmJlxyXG4gICAgICAgICAgICBbJ3BlbmRpbmcnLCAnYWNrbm93bGVkZ2VkJywgJ3JlamVjdGVkJ10uaW5kZXhPZihtdXRhdGlvbkJhdGNoLnN0YXRlKSAhPT1cclxuICAgICAgICAgICAgICAgIC0xICYmXHJcbiAgICAgICAgICAgIChtdXRhdGlvbkJhdGNoLmVycm9yID09PSB1bmRlZmluZWQgfHxcclxuICAgICAgICAgICAgICAgIHR5cGVvZiBtdXRhdGlvbkJhdGNoLmVycm9yID09PSAnb2JqZWN0Jyk7XHJcbiAgICAgICAgdmFyIGZpcmVzdG9yZUVycm9yID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGlmICh2YWxpZERhdGEgJiYgbXV0YXRpb25CYXRjaC5lcnJvcikge1xyXG4gICAgICAgICAgICB2YWxpZERhdGEgPVxyXG4gICAgICAgICAgICAgICAgdHlwZW9mIG11dGF0aW9uQmF0Y2guZXJyb3IubWVzc2FnZSA9PT0gJ3N0cmluZycgJiZcclxuICAgICAgICAgICAgICAgICAgICB0eXBlb2YgbXV0YXRpb25CYXRjaC5lcnJvci5jb2RlID09PSAnc3RyaW5nJztcclxuICAgICAgICAgICAgaWYgKHZhbGlkRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgZmlyZXN0b3JlRXJyb3IgPSBuZXcgRmlyZXN0b3JlRXJyb3IobXV0YXRpb25CYXRjaC5lcnJvci5jb2RlLCBtdXRhdGlvbkJhdGNoLmVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWxpZERhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBNdXRhdGlvbk1ldGFkYXRhKHVzZXIsIGJhdGNoSWQsIG11dGF0aW9uQmF0Y2guc3RhdGUsIGZpcmVzdG9yZUVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGVycm9yKExPR19UQUckMTAsIFwiRmFpbGVkIHRvIHBhcnNlIG11dGF0aW9uIHN0YXRlIGZvciBJRCAnXCIgKyBiYXRjaElkICsgXCInOiBcIiArIHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE11dGF0aW9uTWV0YWRhdGEucHJvdG90eXBlLnRvV2ViU3RvcmFnZUpTT04gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGJhdGNoTWV0YWRhdGEgPSB7XHJcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxyXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KCkgLy8gTW9kaWZ5IHRoZSBleGlzdGluZyB2YWx1ZSB0byB0cmlnZ2VyIHVwZGF0ZS5cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yKSB7XHJcbiAgICAgICAgICAgIGJhdGNoTWV0YWRhdGEuZXJyb3IgPSB7XHJcbiAgICAgICAgICAgICAgICBjb2RlOiB0aGlzLmVycm9yLmNvZGUsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiB0aGlzLmVycm9yLm1lc3NhZ2VcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGJhdGNoTWV0YWRhdGEpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNdXRhdGlvbk1ldGFkYXRhO1xyXG59KCkpO1xyXG4vKipcclxuICogSG9sZHMgdGhlIHN0YXRlIG9mIGEgcXVlcnkgdGFyZ2V0LCBpbmNsdWRpbmcgaXRzIHRhcmdldCBJRCBhbmQgd2hldGhlciB0aGVcclxuICogdGFyZ2V0IGlzICdub3QtY3VycmVudCcsICdjdXJyZW50JyBvciAncmVqZWN0ZWQnLlxyXG4gKi9cclxuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xyXG52YXIgUXVlcnlUYXJnZXRNZXRhZGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEodGFyZ2V0SWQsIHN0YXRlLCBlcnJvciQkMSkge1xyXG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0YXJnZXRJZDtcclxuICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XHJcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yJCQxO1xyXG4gICAgICAgIGFzc2VydCgoZXJyb3IkJDEgIT09IHVuZGVmaW5lZCkgPT09IChzdGF0ZSA9PT0gJ3JlamVjdGVkJyksIFwiUXVlcnlUYXJnZXRNZXRhZGF0YSBtdXN0IGNvbnRhaW4gYW4gZXJyb3IgaWZmIHN0YXRlIGlzICdyZWplY3RlZCdcIik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxyXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cclxuICAgICAqL1xyXG4gICAgUXVlcnlUYXJnZXRNZXRhZGF0YS5mcm9tV2ViU3RvcmFnZUVudHJ5ID0gZnVuY3Rpb24gKHRhcmdldElkLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciB0YXJnZXRTdGF0ZSA9IEpTT04ucGFyc2UodmFsdWUpO1xyXG4gICAgICAgIHZhciB2YWxpZERhdGEgPSB0eXBlb2YgdGFyZ2V0U3RhdGUgPT09ICdvYmplY3QnICYmXHJcbiAgICAgICAgICAgIFsnbm90LWN1cnJlbnQnLCAnY3VycmVudCcsICdyZWplY3RlZCddLmluZGV4T2YodGFyZ2V0U3RhdGUuc3RhdGUpICE9PVxyXG4gICAgICAgICAgICAgICAgLTEgJiZcclxuICAgICAgICAgICAgKHRhcmdldFN0YXRlLmVycm9yID09PSB1bmRlZmluZWQgfHxcclxuICAgICAgICAgICAgICAgIHR5cGVvZiB0YXJnZXRTdGF0ZS5lcnJvciA9PT0gJ29iamVjdCcpO1xyXG4gICAgICAgIHZhciBmaXJlc3RvcmVFcnJvciA9IHVuZGVmaW5lZDtcclxuICAgICAgICBpZiAodmFsaWREYXRhICYmIHRhcmdldFN0YXRlLmVycm9yKSB7XHJcbiAgICAgICAgICAgIHZhbGlkRGF0YSA9XHJcbiAgICAgICAgICAgICAgICB0eXBlb2YgdGFyZ2V0U3RhdGUuZXJyb3IubWVzc2FnZSA9PT0gJ3N0cmluZycgJiZcclxuICAgICAgICAgICAgICAgICAgICB0eXBlb2YgdGFyZ2V0U3RhdGUuZXJyb3IuY29kZSA9PT0gJ3N0cmluZyc7XHJcbiAgICAgICAgICAgIGlmICh2YWxpZERhdGEpIHtcclxuICAgICAgICAgICAgICAgIGZpcmVzdG9yZUVycm9yID0gbmV3IEZpcmVzdG9yZUVycm9yKHRhcmdldFN0YXRlLmVycm9yLmNvZGUsIHRhcmdldFN0YXRlLmVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWxpZERhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBRdWVyeVRhcmdldE1ldGFkYXRhKHRhcmdldElkLCB0YXJnZXRTdGF0ZS5zdGF0ZSwgZmlyZXN0b3JlRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZXJyb3IoTE9HX1RBRyQxMCwgXCJGYWlsZWQgdG8gcGFyc2UgdGFyZ2V0IHN0YXRlIGZvciBJRCAnXCIgKyB0YXJnZXRJZCArIFwiJzogXCIgKyB2YWx1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBRdWVyeVRhcmdldE1ldGFkYXRhLnByb3RvdHlwZS50b1dlYlN0b3JhZ2VKU09OID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0YXJnZXRTdGF0ZSA9IHtcclxuICAgICAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXHJcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKSAvLyBNb2RpZnkgdGhlIGV4aXN0aW5nIHZhbHVlIHRvIHRyaWdnZXIgdXBkYXRlLlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKHRoaXMuZXJyb3IpIHtcclxuICAgICAgICAgICAgdGFyZ2V0U3RhdGUuZXJyb3IgPSB7XHJcbiAgICAgICAgICAgICAgICBjb2RlOiB0aGlzLmVycm9yLmNvZGUsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiB0aGlzLmVycm9yLm1lc3NhZ2VcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRhcmdldFN0YXRlKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUXVlcnlUYXJnZXRNZXRhZGF0YTtcclxufSgpKTtcclxuLyoqXHJcbiAqIFRoaXMgY2xhc3MgcmVwcmVzZW50cyB0aGUgaW1tdXRhYmxlIENsaWVudFN0YXRlIGZvciBhIGNsaWVudCByZWFkIGZyb21cclxuICogV2ViU3RvcmFnZSwgY29udGFpbmluZyB0aGUgbGlzdCBvZiBhY3RpdmUgcXVlcnkgdGFyZ2V0cy5cclxuICovXHJcbnZhciBSZW1vdGVDbGllbnRTdGF0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlbW90ZUNsaWVudFN0YXRlKGNsaWVudElkLCBhY3RpdmVUYXJnZXRJZHMpIHtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSBhY3RpdmVUYXJnZXRJZHM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIFJlbW90ZUNsaWVudFN0YXRlIGZyb20gdGhlIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cclxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXHJcbiAgICAgKi9cclxuICAgIFJlbW90ZUNsaWVudFN0YXRlLmZyb21XZWJTdG9yYWdlRW50cnkgPSBmdW5jdGlvbiAoY2xpZW50SWQsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIGNsaWVudFN0YXRlID0gSlNPTi5wYXJzZSh2YWx1ZSk7XHJcbiAgICAgICAgdmFyIHZhbGlkRGF0YSA9IHR5cGVvZiBjbGllbnRTdGF0ZSA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgICAgICAgY2xpZW50U3RhdGUuYWN0aXZlVGFyZ2V0SWRzIGluc3RhbmNlb2YgQXJyYXk7XHJcbiAgICAgICAgdmFyIGFjdGl2ZVRhcmdldElkc1NldCA9IHRhcmdldElkU2V0KCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IHZhbGlkRGF0YSAmJiBpIDwgY2xpZW50U3RhdGUuYWN0aXZlVGFyZ2V0SWRzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkRGF0YSA9IGlzU2FmZUludGVnZXIoY2xpZW50U3RhdGUuYWN0aXZlVGFyZ2V0SWRzW2ldKTtcclxuICAgICAgICAgICAgYWN0aXZlVGFyZ2V0SWRzU2V0ID0gYWN0aXZlVGFyZ2V0SWRzU2V0LmFkZChjbGllbnRTdGF0ZS5hY3RpdmVUYXJnZXRJZHNbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsaWREYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVtb3RlQ2xpZW50U3RhdGUoY2xpZW50SWQsIGFjdGl2ZVRhcmdldElkc1NldCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBlcnJvcihMT0dfVEFHJDEwLCBcIkZhaWxlZCB0byBwYXJzZSBjbGllbnQgZGF0YSBmb3IgaW5zdGFuY2UgJ1wiICsgY2xpZW50SWQgKyBcIic6IFwiICsgdmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlbW90ZUNsaWVudFN0YXRlO1xyXG59KCkpO1xyXG4vKipcclxuICogVGhpcyBjbGFzcyByZXByZXNlbnRzIHRoZSBvbmxpbmUgc3RhdGUgZm9yIGFsbCBjbGllbnRzIHBhcnRpY2lwYXRpbmcgaW5cclxuICogbXVsdGktdGFiLiBUaGUgb25saW5lIHN0YXRlIGlzIG9ubHkgd3JpdHRlbiB0byBieSB0aGUgcHJpbWFyeSBjbGllbnQsIGFuZFxyXG4gKiB1c2VkIGluIHNlY29uZGFyeSBjbGllbnRzIHRvIHVwZGF0ZSB0aGVpciBxdWVyeSB2aWV3cy5cclxuICovXHJcbnZhciBTaGFyZWRPbmxpbmVTdGF0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNoYXJlZE9ubGluZVN0YXRlKGNsaWVudElkLCBvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlID0gb25saW5lU3RhdGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIFNoYXJlZE9ubGluZVN0YXRlIGZyb20gaXRzIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cclxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXHJcbiAgICAgKi9cclxuICAgIFNoYXJlZE9ubGluZVN0YXRlLmZyb21XZWJTdG9yYWdlRW50cnkgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICB2YXIgb25saW5lU3RhdGUgPSBKU09OLnBhcnNlKHZhbHVlKTtcclxuICAgICAgICB2YXIgdmFsaWREYXRhID0gdHlwZW9mIG9ubGluZVN0YXRlID09PSAnb2JqZWN0JyAmJlxyXG4gICAgICAgICAgICBPbmxpbmVTdGF0ZVtvbmxpbmVTdGF0ZS5vbmxpbmVTdGF0ZV0gIT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICB0eXBlb2Ygb25saW5lU3RhdGUuY2xpZW50SWQgPT09ICdzdHJpbmcnO1xyXG4gICAgICAgIGlmICh2YWxpZERhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTaGFyZWRPbmxpbmVTdGF0ZShvbmxpbmVTdGF0ZS5jbGllbnRJZCwgT25saW5lU3RhdGVbb25saW5lU3RhdGUub25saW5lU3RhdGVdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGVycm9yKExPR19UQUckMTAsIFwiRmFpbGVkIHRvIHBhcnNlIG9ubGluZSBzdGF0ZTogXCIgKyB2YWx1ZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gU2hhcmVkT25saW5lU3RhdGU7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBNZXRhZGF0YSBzdGF0ZSBvZiB0aGUgbG9jYWwgY2xpZW50LiBVbmxpa2UgYFJlbW90ZUNsaWVudFN0YXRlYCwgdGhpcyBjbGFzcyBpc1xyXG4gKiBtdXRhYmxlIGFuZCBrZWVwcyB0cmFjayBvZiBhbGwgcGVuZGluZyBtdXRhdGlvbnMsIHdoaWNoIGFsbG93cyB1cyB0b1xyXG4gKiB1cGRhdGUgdGhlIHJhbmdlIG9mIHBlbmRpbmcgbXV0YXRpb24gYmF0Y2ggSURzIGFzIG5ldyBtdXRhdGlvbnMgYXJlIGFkZGVkIG9yXHJcbiAqIHJlbW92ZWQuXHJcbiAqXHJcbiAqIFRoZSBkYXRhIGluIGBMb2NhbENsaWVudFN0YXRlYCBpcyBub3QgcmVhZCBmcm9tIFdlYlN0b3JhZ2UgYW5kIGluc3RlYWRcclxuICogdXBkYXRlZCB2aWEgaXRzIGluc3RhbmNlIG1ldGhvZHMuIFRoZSB1cGRhdGVkIHN0YXRlIGNhbiBiZSBzZXJpYWxpemVkIHZpYVxyXG4gKiBgdG9XZWJTdG9yYWdlSlNPTigpYC5cclxuICovXHJcbi8vIFZpc2libGUgZm9yIHRlc3RpbmcuXHJcbnZhciBMb2NhbENsaWVudFN0YXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTG9jYWxDbGllbnRTdGF0ZSgpIHtcclxuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHRhcmdldElkU2V0KCk7XHJcbiAgICB9XHJcbiAgICBMb2NhbENsaWVudFN0YXRlLnByb3RvdHlwZS5hZGRRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5hY3RpdmVUYXJnZXRJZHMuaGFzKHRhcmdldElkKSwgXCJUYXJnZXQgd2l0aCBJRCAnXCIgKyB0YXJnZXRJZCArIFwiJyBhbHJlYWR5IGFjdGl2ZS5cIik7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0aGlzLmFjdGl2ZVRhcmdldElkcy5hZGQodGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIExvY2FsQ2xpZW50U3RhdGUucHJvdG90eXBlLnJlbW92ZVF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0aGlzLmFjdGl2ZVRhcmdldElkcy5kZWxldGUodGFyZ2V0SWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgdGhpcyBlbnRyeSBpbnRvIGEgSlNPTi1lbmNvZGVkIGZvcm1hdCB3ZSBjYW4gdXNlIGZvciBXZWJTdG9yYWdlLlxyXG4gICAgICogRG9lcyBub3QgZW5jb2RlIGBjbGllbnRJZGAgYXMgaXQgaXMgcGFydCBvZiB0aGUga2V5IGluIFdlYlN0b3JhZ2UuXHJcbiAgICAgKi9cclxuICAgIExvY2FsQ2xpZW50U3RhdGUucHJvdG90eXBlLnRvV2ViU3RvcmFnZUpTT04gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB7XHJcbiAgICAgICAgICAgIGFjdGl2ZVRhcmdldElkczogdGhpcy5hY3RpdmVUYXJnZXRJZHMudG9BcnJheSgpLFxyXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KCkgLy8gTW9kaWZ5IHRoZSBleGlzdGluZyB2YWx1ZSB0byB0cmlnZ2VyIHVwZGF0ZS5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTG9jYWxDbGllbnRTdGF0ZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgIHVzZXMgV2ViU3RvcmFnZSAod2luZG93LmxvY2FsU3RvcmFnZSkgYXMgdGhlXHJcbiAqIGJhY2tpbmcgc3RvcmUgZm9yIHRoZSBTaGFyZWRDbGllbnRTdGF0ZS4gSXQga2VlcHMgdHJhY2sgb2YgYWxsIGFjdGl2ZVxyXG4gKiBjbGllbnRzIGFuZCBzdXBwb3J0cyBtb2RpZmljYXRpb25zIG9mIHRoZSBsb2NhbCBjbGllbnQncyBkYXRhLlxyXG4gKi9cclxudmFyIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZShxdWV1ZSwgcGxhdGZvcm0sIHBlcnNpc3RlbmNlS2V5LCBsb2NhbENsaWVudElkLCBpbml0aWFsVXNlcikge1xyXG4gICAgICAgIHRoaXMucXVldWUgPSBxdWV1ZTtcclxuICAgICAgICB0aGlzLnBsYXRmb3JtID0gcGxhdGZvcm07XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IHBlcnNpc3RlbmNlS2V5O1xyXG4gICAgICAgIHRoaXMubG9jYWxDbGllbnRJZCA9IGxvY2FsQ2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy5zeW5jRW5naW5lID0gbnVsbDtcclxuICAgICAgICB0aGlzLm9ubGluZVN0YXRlSGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlQ2xpZW50cyA9IHt9O1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZUxpc3RlbmVyID0gdGhpcy5oYW5kbGVXZWJTdG9yYWdlRXZlbnQuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDYXB0dXJlcyBXZWJTdG9yYWdlIGV2ZW50cyB0aGF0IG9jY3VyIGJlZm9yZSBgc3RhcnQoKWAgaXMgY2FsbGVkLiBUaGVzZVxyXG4gICAgICAgICAqIGV2ZW50cyBhcmUgcmVwbGF5ZWQgb25jZSBgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlYCBpcyBzdGFydGVkLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuZWFybHlFdmVudHMgPSBbXTtcclxuICAgICAgICBpZiAoIVdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5pc0F2YWlsYWJsZSh0aGlzLnBsYXRmb3JtKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTklNUExFTUVOVEVELCAnTG9jYWxTdG9yYWdlIGlzIG5vdCBhdmFpbGFibGUgb24gdGhpcyBwbGF0Zm9ybS4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gRXNjYXBlIHRoZSBzcGVjaWFsIGNoYXJhY3RlcnMgbWVudGlvbmVkIGhlcmU6XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9HdWlkZS9SZWd1bGFyX0V4cHJlc3Npb25zXHJcbiAgICAgICAgdmFyIGVzY2FwZWRQZXJzaXN0ZW5jZUtleSA9IHBlcnNpc3RlbmNlS2V5LnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyk7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gdGhpcy5wbGF0Zm9ybS53aW5kb3cubG9jYWxTdG9yYWdlO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBpbml0aWFsVXNlcjtcclxuICAgICAgICB0aGlzLmxvY2FsQ2xpZW50U3RvcmFnZUtleSA9IHRoaXMudG9XZWJTdG9yYWdlQ2xpZW50U3RhdGVLZXkodGhpcy5sb2NhbENsaWVudElkKTtcclxuICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVyS2V5ID0gU0VRVUVOQ0VfTlVNQkVSX0tFWV9QUkVGSVggKyBcIl9cIiArIHBlcnNpc3RlbmNlS2V5O1xyXG4gICAgICAgIHRoaXMuYWN0aXZlQ2xpZW50c1t0aGlzLmxvY2FsQ2xpZW50SWRdID0gbmV3IExvY2FsQ2xpZW50U3RhdGUoKTtcclxuICAgICAgICB0aGlzLmNsaWVudFN0YXRlS2V5UmUgPSBuZXcgUmVnRXhwKFwiXlwiICsgQ0xJRU5UX1NUQVRFX0tFWV9QUkVGSVggKyBcIl9cIiArIGVzY2FwZWRQZXJzaXN0ZW5jZUtleSArIFwiXyhbXl9dKikkXCIpO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25CYXRjaEtleVJlID0gbmV3IFJlZ0V4cChcIl5cIiArIE1VVEFUSU9OX0JBVENIX0tFWV9QUkVGSVggKyBcIl9cIiArIGVzY2FwZWRQZXJzaXN0ZW5jZUtleSArIFwiXyhcXFxcZCspKD86XyguKikpPyRcIik7XHJcbiAgICAgICAgdGhpcy5xdWVyeVRhcmdldEtleVJlID0gbmV3IFJlZ0V4cChcIl5cIiArIFFVRVJZX1RBUkdFVF9LRVlfUFJFRklYICsgXCJfXCIgKyBlc2NhcGVkUGVyc2lzdGVuY2VLZXkgKyBcIl8oXFxcXGQrKSRcIik7XHJcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUtleSA9IE9OTElORV9TVEFURV9LRVlfUFJFRklYICsgXCJfXCIgKyBwZXJzaXN0ZW5jZUtleTtcclxuICAgICAgICAvLyBSYXRoZXIgdGhhbiBhZGRpbmcgdGhlIHN0b3JhZ2Ugb2JzZXJ2ZXIgZHVyaW5nIHN0YXJ0KCksIHdlIGFkZCB0aGVcclxuICAgICAgICAvLyBzdG9yYWdlIG9ic2VydmVyIGR1cmluZyBpbml0aWFsaXphdGlvbi4gVGhpcyBlbnN1cmVzIHRoYXQgd2UgY29sbGVjdFxyXG4gICAgICAgIC8vIGV2ZW50cyBiZWZvcmUgb3RoZXIgY29tcG9uZW50cyBwb3B1bGF0ZSB0aGVpciBpbml0aWFsIHN0YXRlIChkdXJpbmcgdGhlaXJcclxuICAgICAgICAvLyByZXNwZWN0aXZlIHN0YXJ0KCkgY2FsbHMpLiBPdGhlcndpc2UsIHdlIG1pZ2h0IGZvciBleGFtcGxlIG1pc3MgYVxyXG4gICAgICAgIC8vIG11dGF0aW9uIHRoYXQgaXMgYWRkZWQgYWZ0ZXIgTG9jYWxTdG9yZSdzIHN0YXJ0KCkgcHJvY2Vzc2VkIHRoZSBleGlzdGluZ1xyXG4gICAgICAgIC8vIG11dGF0aW9ucyBidXQgYmVmb3JlIHdlIG9ic2VydmUgV2ViU3RvcmFnZSBldmVudHMuXHJcbiAgICAgICAgdGhpcy5wbGF0Zm9ybS53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuc3RvcmFnZUxpc3RlbmVyKTtcclxuICAgIH1cclxuICAgIC8qKiBSZXR1cm5zICd0cnVlJyBpZiBXZWJTdG9yYWdlIGlzIGF2YWlsYWJsZSBpbiB0aGUgY3VycmVudCBlbnZpcm9ubWVudC4gKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5pc0F2YWlsYWJsZSA9IGZ1bmN0aW9uIChwbGF0Zm9ybSkge1xyXG4gICAgICAgIHJldHVybiAhIShwbGF0Zm9ybS53aW5kb3cgJiYgcGxhdGZvcm0ud2luZG93LmxvY2FsU3RvcmFnZSAhPSBudWxsKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgZXhpc3RpbmdDbGllbnRzLCBfaSwgZXhpc3RpbmdDbGllbnRzXzEsIGNsaWVudElkLCBzdG9yYWdlSXRlbSwgY2xpZW50U3RhdGUsIG9ubGluZVN0YXRlSlNPTiwgb25saW5lU3RhdGUsIF9hLCBfYiwgZXZlbnRfMTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQoIXRoaXMuc3RhcnRlZCwgJ1dlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZSBhbHJlYWR5IHN0YXJ0ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHRoaXMuc3luY0VuZ2luZSAhPT0gbnVsbCwgJ3N5bmNFbmdpbmUgcHJvcGVydHkgbXVzdCBiZSBzZXQgYmVmb3JlIGNhbGxpbmcgc3RhcnQoKScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnQodGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgIT09IG51bGwsICdvbmxpbmVTdGF0ZUhhbmRsZXIgcHJvcGVydHkgbXVzdCBiZSBzZXQgYmVmb3JlIGNhbGxpbmcgc3RhcnQoKScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnN5bmNFbmdpbmUuZ2V0QWN0aXZlQ2xpZW50cygpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nQ2xpZW50cyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChfaSA9IDAsIGV4aXN0aW5nQ2xpZW50c18xID0gZXhpc3RpbmdDbGllbnRzOyBfaSA8IGV4aXN0aW5nQ2xpZW50c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50SWQgPSBleGlzdGluZ0NsaWVudHNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xpZW50SWQgPT09IHRoaXMubG9jYWxDbGllbnRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZUl0ZW0gPSB0aGlzLmdldEl0ZW0odGhpcy50b1dlYlN0b3JhZ2VDbGllbnRTdGF0ZUtleShjbGllbnRJZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0b3JhZ2VJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50U3RhdGUgPSBSZW1vdGVDbGllbnRTdGF0ZS5mcm9tV2ViU3RvcmFnZUVudHJ5KGNsaWVudElkLCBzdG9yYWdlSXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsaWVudFN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlQ2xpZW50c1tjbGllbnRTdGF0ZS5jbGllbnRJZF0gPSBjbGllbnRTdGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0Q2xpZW50U3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25saW5lU3RhdGVKU09OID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0odGhpcy5vbmxpbmVTdGF0ZUtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvbmxpbmVTdGF0ZUpTT04pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubGluZVN0YXRlID0gdGhpcy5mcm9tV2ViU3RvcmFnZU9ubGluZVN0YXRlKG9ubGluZVN0YXRlSlNPTik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZU9ubGluZVN0YXRlRXZlbnQob25saW5lU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2EgPSAwLCBfYiA9IHRoaXMuZWFybHlFdmVudHM7IF9hIDwgX2IubGVuZ3RoOyBfYSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudF8xID0gX2JbX2FdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVXZWJTdG9yYWdlRXZlbnQoZXZlbnRfMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lYXJseUV2ZW50cyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWdpc3RlciBhIHdpbmRvdyB1bmxvYWQgaG9vayB0byByZW1vdmUgdGhlIGNsaWVudCBtZXRhZGF0YSBlbnRyeSBmcm9tXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlYlN0b3JhZ2UgZXZlbiBpZiBgc2h1dGRvd24oKWAgd2FzIG5vdCBjYWxsZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGxhdGZvcm0ud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnNodXRkb3duKCk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUud3JpdGVTZXF1ZW5jZU51bWJlciA9IGZ1bmN0aW9uIChzZXF1ZW5jZU51bWJlcikge1xyXG4gICAgICAgIHRoaXMuc2V0SXRlbSh0aGlzLnNlcXVlbmNlTnVtYmVyS2V5LCBKU09OLnN0cmluZ2lmeShzZXF1ZW5jZU51bWJlcikpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhY3RpdmVUYXJnZXRzID0gdGFyZ2V0SWRTZXQoKTtcclxuICAgICAgICBmb3JFYWNoKHRoaXMuYWN0aXZlQ2xpZW50cywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgYWN0aXZlVGFyZ2V0cyA9IGFjdGl2ZVRhcmdldHMudW5pb25XaXRoKHZhbHVlLmFjdGl2ZVRhcmdldElkcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGFjdGl2ZVRhcmdldHM7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgLy8gVGhpcyBpcyBub3QgdXNpbmcgYG9iai5mb3JFYWNoYCBzaW5jZSBgZm9yRWFjaGAgZG9lc24ndCBzdXBwb3J0IGVhcmx5XHJcbiAgICAgICAgLy8gcmV0dXJuLlxyXG4gICAgICAgIGZvciAodmFyIGNsaWVudElkIGluIHRoaXMuYWN0aXZlQ2xpZW50cykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVDbGllbnRzLmhhc093blByb3BlcnR5KGNsaWVudElkKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlQ2xpZW50c1tjbGllbnRJZF0uYWN0aXZlVGFyZ2V0SWRzLmhhcyh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5hZGRQZW5kaW5nTXV0YXRpb24gPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdE11dGF0aW9uU3RhdGUoYmF0Y2hJZCwgJ3BlbmRpbmcnKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnVwZGF0ZU11dGF0aW9uU3RhdGUgPSBmdW5jdGlvbiAoYmF0Y2hJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0TXV0YXRpb25TdGF0ZShiYXRjaElkLCBzdGF0ZSwgZXJyb3IkJDEpO1xyXG4gICAgICAgIC8vIE9uY2UgYSBmaW5hbCBtdXRhdGlvbiByZXN1bHQgaXMgb2JzZXJ2ZWQgYnkgb3RoZXIgY2xpZW50cywgdGhleSBubyBsb25nZXJcclxuICAgICAgICAvLyBhY2Nlc3MgdGhlIG11dGF0aW9uJ3MgbWV0YWRhdGEgZW50cnkuIFNpbmNlIFdlYlN0b3JhZ2UgcmVwbGF5cyBldmVudHNcclxuICAgICAgICAvLyBpbiBvcmRlciwgaXQgaXMgc2FmZSB0byBkZWxldGUgdGhlIGVudHJ5IHJpZ2h0IGFmdGVyIHVwZGF0aW5nIGl0LlxyXG4gICAgICAgIHRoaXMucmVtb3ZlTXV0YXRpb25TdGF0ZShiYXRjaElkKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmFkZExvY2FsUXVlcnlUYXJnZXQgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB2YXIgcXVlcnlTdGF0ZSA9ICdub3QtY3VycmVudCc7XHJcbiAgICAgICAgLy8gTG9va3VwIGFuIGV4aXN0aW5nIHF1ZXJ5IHN0YXRlIGlmIHRoZSB0YXJnZXQgSUQgd2FzIGFscmVhZHkgcmVnaXN0ZXJlZFxyXG4gICAgICAgIC8vIGJ5IGFub3RoZXIgdGFiXHJcbiAgICAgICAgaWYgKHRoaXMuaXNBY3RpdmVRdWVyeVRhcmdldCh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgdmFyIHN0b3JhZ2VJdGVtID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0odGhpcy50b1dlYlN0b3JhZ2VRdWVyeVRhcmdldE1ldGFkYXRhS2V5KHRhcmdldElkKSk7XHJcbiAgICAgICAgICAgIGlmIChzdG9yYWdlSXRlbSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1ldGFkYXRhID0gUXVlcnlUYXJnZXRNZXRhZGF0YS5mcm9tV2ViU3RvcmFnZUVudHJ5KHRhcmdldElkLCBzdG9yYWdlSXRlbSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWVyeVN0YXRlID0gbWV0YWRhdGEuc3RhdGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5sb2NhbENsaWVudFN0YXRlLmFkZFF1ZXJ5VGFyZ2V0KHRhcmdldElkKTtcclxuICAgICAgICB0aGlzLnBlcnNpc3RDbGllbnRTdGF0ZSgpO1xyXG4gICAgICAgIHJldHVybiBxdWVyeVN0YXRlO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUucmVtb3ZlTG9jYWxRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMubG9jYWxDbGllbnRTdGF0ZS5yZW1vdmVRdWVyeVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0Q2xpZW50U3RhdGUoKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmlzTG9jYWxRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsQ2xpZW50U3RhdGUuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5jbGVhclF1ZXJ5U3RhdGUgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICB0aGlzLnJlbW92ZUl0ZW0odGhpcy50b1dlYlN0b3JhZ2VRdWVyeVRhcmdldE1ldGFkYXRhS2V5KHRhcmdldElkKSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS51cGRhdGVRdWVyeVN0YXRlID0gZnVuY3Rpb24gKHRhcmdldElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RRdWVyeVRhcmdldFN0YXRlKHRhcmdldElkLCBzdGF0ZSwgZXJyb3IkJDEpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaGFuZGxlVXNlckNoYW5nZSA9IGZ1bmN0aW9uICh1c2VyLCByZW1vdmVkQmF0Y2hJZHMsIGFkZGVkQmF0Y2hJZHMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJlbW92ZWRCYXRjaElkcy5mb3JFYWNoKGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnJlbW92ZU11dGF0aW9uU3RhdGUoYmF0Y2hJZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgICAgICAgYWRkZWRCYXRjaElkcy5mb3JFYWNoKGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmFkZFBlbmRpbmdNdXRhdGlvbihiYXRjaElkKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnNldE9ubGluZVN0YXRlID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0T25saW5lU3RhdGUob25saW5lU3RhdGUpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuc2h1dGRvd24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXRmb3JtLndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgdGhpcy5zdG9yYWdlTGlzdGVuZXIpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUl0ZW0odGhpcy5sb2NhbENsaWVudFN0b3JhZ2VLZXkpO1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5nZXRJdGVtID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxMCwgJ1JFQUQnLCBrZXksIHZhbHVlKTtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5zZXRJdGVtID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICBkZWJ1ZyhMT0dfVEFHJDEwLCAnU0VUJywga2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5yZW1vdmVJdGVtID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMTAsICdSRU1PVkUnLCBrZXkpO1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5oYW5kbGVXZWJTdG9yYWdlRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChldmVudC5zdG9yYWdlQXJlYSA9PT0gdGhpcy5zdG9yYWdlKSB7XHJcbiAgICAgICAgICAgIGRlYnVnKExPR19UQUckMTAsICdFVkVOVCcsIGV2ZW50LmtleSwgZXZlbnQubmV3VmFsdWUpO1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSB0aGlzLmxvY2FsQ2xpZW50U3RvcmFnZUtleSkge1xyXG4gICAgICAgICAgICAgICAgZXJyb3IoJ1JlY2VpdmVkIFdlYlN0b3JhZ2Ugbm90aWZpY2F0aW9uIGZvciBsb2NhbCBjaGFuZ2UuIEFub3RoZXIgY2xpZW50IG1pZ2h0IGhhdmUgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgJ2dhcmJhZ2UtY29sbGVjdGVkIG91ciBzdGF0ZScpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbGllbnRTdGF0ZSwgY2xpZW50SWQsIG11dGF0aW9uTWV0YWRhdGEsIHF1ZXJ5VGFyZ2V0TWV0YWRhdGEsIG9ubGluZVN0YXRlLCBzZXF1ZW5jZU51bWJlcjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWFybHlFdmVudHMucHVzaChldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNsaWVudFN0YXRlS2V5UmUudGVzdChldmVudC5rZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5uZXdWYWx1ZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRTdGF0ZSA9IHRoaXMuZnJvbVdlYlN0b3JhZ2VDbGllbnRTdGF0ZShldmVudC5rZXksIGV2ZW50Lm5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGllbnRTdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLmhhbmRsZUNsaWVudFN0YXRlRXZlbnQoY2xpZW50U3RhdGUuY2xpZW50SWQsIGNsaWVudFN0YXRlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRJZCA9IHRoaXMuZnJvbVdlYlN0b3JhZ2VDbGllbnRTdGF0ZUtleShldmVudC5rZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuaGFuZGxlQ2xpZW50U3RhdGVFdmVudChjbGllbnRJZCwgbnVsbCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubXV0YXRpb25CYXRjaEtleVJlLnRlc3QoZXZlbnQua2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQubmV3VmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9uTWV0YWRhdGEgPSB0aGlzLmZyb21XZWJTdG9yYWdlTXV0YXRpb25NZXRhZGF0YShldmVudC5rZXksIGV2ZW50Lm5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbk1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuaGFuZGxlTXV0YXRpb25CYXRjaEV2ZW50KG11dGF0aW9uTWV0YWRhdGEpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnF1ZXJ5VGFyZ2V0S2V5UmUudGVzdChldmVudC5rZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5uZXdWYWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlUYXJnZXRNZXRhZGF0YSA9IHRoaXMuZnJvbVdlYlN0b3JhZ2VRdWVyeVRhcmdldE1ldGFkYXRhKGV2ZW50LmtleSwgZXZlbnQubmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXJ5VGFyZ2V0TWV0YWRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5oYW5kbGVRdWVyeVRhcmdldEV2ZW50KHF1ZXJ5VGFyZ2V0TWV0YWRhdGEpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC5rZXkgPT09IHRoaXMub25saW5lU3RhdGVLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm5ld1ZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmxpbmVTdGF0ZSA9IHRoaXMuZnJvbVdlYlN0b3JhZ2VPbmxpbmVTdGF0ZShldmVudC5uZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy5oYW5kbGVPbmxpbmVTdGF0ZUV2ZW50KG9ubGluZVN0YXRlKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQua2V5ID09PSB0aGlzLnNlcXVlbmNlTnVtYmVyS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydCghIXRoaXMuc2VxdWVuY2VOdW1iZXJIYW5kbGVyLCAnTWlzc2luZyBzZXF1ZW5jZU51bWJlckhhbmRsZXInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXIgPSBmcm9tV2ViU3RvcmFnZVNlcXVlbmNlTnVtYmVyKGV2ZW50Lm5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlcXVlbmNlTnVtYmVyICE9PSBMaXN0ZW5TZXF1ZW5jZS5JTlZBTElEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlcihzZXF1ZW5jZU51bWJlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pOyB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUsIFwibG9jYWxDbGllbnRTdGF0ZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZUNsaWVudHNbdGhpcy5sb2NhbENsaWVudElkXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUucGVyc2lzdENsaWVudFN0YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2V0SXRlbSh0aGlzLmxvY2FsQ2xpZW50U3RvcmFnZUtleSwgdGhpcy5sb2NhbENsaWVudFN0YXRlLnRvV2ViU3RvcmFnZUpTT04oKSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5wZXJzaXN0TXV0YXRpb25TdGF0ZSA9IGZ1bmN0aW9uIChiYXRjaElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25TdGF0ZSA9IG5ldyBNdXRhdGlvbk1ldGFkYXRhKHRoaXMuY3VycmVudFVzZXIsIGJhdGNoSWQsIHN0YXRlLCBlcnJvciQkMSk7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uS2V5ID0gdGhpcy50b1dlYlN0b3JhZ2VNdXRhdGlvbkJhdGNoS2V5KGJhdGNoSWQpO1xyXG4gICAgICAgIHRoaXMuc2V0SXRlbShtdXRhdGlvbktleSwgbXV0YXRpb25TdGF0ZS50b1dlYlN0b3JhZ2VKU09OKCkpO1xyXG4gICAgfTtcclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUucmVtb3ZlTXV0YXRpb25TdGF0ZSA9IGZ1bmN0aW9uIChiYXRjaElkKSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uS2V5ID0gdGhpcy50b1dlYlN0b3JhZ2VNdXRhdGlvbkJhdGNoS2V5KGJhdGNoSWQpO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbShtdXRhdGlvbktleSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5wZXJzaXN0T25saW5lU3RhdGUgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICB2YXIgZW50cnkgPSB7XHJcbiAgICAgICAgICAgIGNsaWVudElkOiB0aGlzLmxvY2FsQ2xpZW50SWQsXHJcbiAgICAgICAgICAgIG9ubGluZVN0YXRlOiBPbmxpbmVTdGF0ZVtvbmxpbmVTdGF0ZV1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKHRoaXMub25saW5lU3RhdGVLZXksIEpTT04uc3RyaW5naWZ5KGVudHJ5KSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5wZXJzaXN0UXVlcnlUYXJnZXRTdGF0ZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldEtleSA9IHRoaXMudG9XZWJTdG9yYWdlUXVlcnlUYXJnZXRNZXRhZGF0YUtleSh0YXJnZXRJZCk7XHJcbiAgICAgICAgdmFyIHRhcmdldE1ldGFkYXRhID0gbmV3IFF1ZXJ5VGFyZ2V0TWV0YWRhdGEodGFyZ2V0SWQsIHN0YXRlLCBlcnJvciQkMSk7XHJcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRhcmdldEtleSwgdGFyZ2V0TWV0YWRhdGEudG9XZWJTdG9yYWdlSlNPTigpKTtcclxuICAgIH07XHJcbiAgICAvKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIGEgY2xpZW50IHN0YXRlIGluIFdlYlN0b3JhZ2UgKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUudG9XZWJTdG9yYWdlQ2xpZW50U3RhdGVLZXkgPSBmdW5jdGlvbiAoY2xpZW50SWQpIHtcclxuICAgICAgICBhc3NlcnQoY2xpZW50SWQuaW5kZXhPZignXycpID09PSAtMSwgXCJDbGllbnQga2V5IGNhbm5vdCBjb250YWluICdfJywgYnV0IHdhcyAnXCIgKyBjbGllbnRJZCArIFwiJ1wiKTtcclxuICAgICAgICByZXR1cm4gQ0xJRU5UX1NUQVRFX0tFWV9QUkVGSVggKyBcIl9cIiArIHRoaXMucGVyc2lzdGVuY2VLZXkgKyBcIl9cIiArIGNsaWVudElkO1xyXG4gICAgfTtcclxuICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBxdWVyeSBzdGF0ZSBpbiBXZWJTdG9yYWdlICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnRvV2ViU3RvcmFnZVF1ZXJ5VGFyZ2V0TWV0YWRhdGFLZXkgPSBmdW5jdGlvbiAodGFyZ2V0SWQpIHtcclxuICAgICAgICByZXR1cm4gUVVFUllfVEFSR0VUX0tFWV9QUkVGSVggKyBcIl9cIiArIHRoaXMucGVyc2lzdGVuY2VLZXkgKyBcIl9cIiArIHRhcmdldElkO1xyXG4gICAgfTtcclxuICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBtdXRhdGlvbiBiYXRjaCBpbiBXZWJTdG9yYWdlICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnRvV2ViU3RvcmFnZU11dGF0aW9uQmF0Y2hLZXkgPSBmdW5jdGlvbiAoYmF0Y2hJZCkge1xyXG4gICAgICAgIHZhciBtdXRhdGlvbktleSA9IE1VVEFUSU9OX0JBVENIX0tFWV9QUkVGSVggKyBcIl9cIiArIHRoaXMucGVyc2lzdGVuY2VLZXkgKyBcIl9cIiArIGJhdGNoSWQ7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIuaXNBdXRoZW50aWNhdGVkKCkpIHtcclxuICAgICAgICAgICAgbXV0YXRpb25LZXkgKz0gXCJfXCIgKyB0aGlzLmN1cnJlbnRVc2VyLnVpZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9uS2V5O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgY2xpZW50IHN0YXRlIGtleSBpbiBXZWJTdG9yYWdlLiBSZXR1cm5zIG51bGwgaWYgdGhlIGtleSBkb2VzIG5vdFxyXG4gICAgICogbWF0Y2ggdGhlIGV4cGVjdGVkIGtleSBmb3JtYXQuXHJcbiAgICAgKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuZnJvbVdlYlN0b3JhZ2VDbGllbnRTdGF0ZUtleSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgbWF0Y2ggPSB0aGlzLmNsaWVudFN0YXRlS2V5UmUuZXhlYyhrZXkpO1xyXG4gICAgICAgIHJldHVybiBtYXRjaCA/IG1hdGNoWzFdIDogbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyBhIGNsaWVudCBzdGF0ZSBpbiBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWUgY291bGQgbm90XHJcbiAgICAgKiBiZSBwYXJzZWQuXHJcbiAgICAgKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuZnJvbVdlYlN0b3JhZ2VDbGllbnRTdGF0ZSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIGNsaWVudElkID0gdGhpcy5mcm9tV2ViU3RvcmFnZUNsaWVudFN0YXRlS2V5KGtleSk7XHJcbiAgICAgICAgYXNzZXJ0KGNsaWVudElkICE9PSBudWxsLCBcIkNhbm5vdCBwYXJzZSBjbGllbnQgc3RhdGUga2V5ICdcIiArIGtleSArIFwiJ1wiKTtcclxuICAgICAgICByZXR1cm4gUmVtb3RlQ2xpZW50U3RhdGUuZnJvbVdlYlN0b3JhZ2VFbnRyeShjbGllbnRJZCwgdmFsdWUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIGEgbXV0YXRpb24gYmF0Y2ggc3RhdGUgaW4gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlXHJcbiAgICAgKiBjb3VsZCBub3QgYmUgcGFyc2VkLlxyXG4gICAgICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmZyb21XZWJTdG9yYWdlTXV0YXRpb25NZXRhZGF0YSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG1hdGNoID0gdGhpcy5tdXRhdGlvbkJhdGNoS2V5UmUuZXhlYyhrZXkpO1xyXG4gICAgICAgIGFzc2VydChtYXRjaCAhPT0gbnVsbCwgXCJDYW5ub3QgcGFyc2UgbXV0YXRpb24gYmF0Y2gga2V5ICdcIiArIGtleSArIFwiJ1wiKTtcclxuICAgICAgICB2YXIgYmF0Y2hJZCA9IE51bWJlcihtYXRjaFsxXSk7XHJcbiAgICAgICAgdmFyIHVzZXJJZCA9IG1hdGNoWzJdICE9PSB1bmRlZmluZWQgPyBtYXRjaFsyXSA6IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIE11dGF0aW9uTWV0YWRhdGEuZnJvbVdlYlN0b3JhZ2VFbnRyeShuZXcgVXNlcih1c2VySWQpLCBiYXRjaElkLCB2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYSBxdWVyeSB0YXJnZXQgc3RhdGUgZnJvbSBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWVcclxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXHJcbiAgICAgKi9cclxuICAgIFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuZnJvbVdlYlN0b3JhZ2VRdWVyeVRhcmdldE1ldGFkYXRhID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgbWF0Y2ggPSB0aGlzLnF1ZXJ5VGFyZ2V0S2V5UmUuZXhlYyhrZXkpO1xyXG4gICAgICAgIGFzc2VydChtYXRjaCAhPT0gbnVsbCwgXCJDYW5ub3QgcGFyc2UgcXVlcnkgdGFyZ2V0IGtleSAnXCIgKyBrZXkgKyBcIidcIik7XHJcbiAgICAgICAgdmFyIHRhcmdldElkID0gTnVtYmVyKG1hdGNoWzFdKTtcclxuICAgICAgICByZXR1cm4gUXVlcnlUYXJnZXRNZXRhZGF0YS5mcm9tV2ViU3RvcmFnZUVudHJ5KHRhcmdldElkLCB2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQYXJzZXMgYW4gb25saW5lIHN0YXRlIGZyb20gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlXHJcbiAgICAgKiBjb3VsZCBub3QgYmUgcGFyc2VkLlxyXG4gICAgICovXHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmZyb21XZWJTdG9yYWdlT25saW5lU3RhdGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gU2hhcmVkT25saW5lU3RhdGUuZnJvbVdlYlN0b3JhZ2VFbnRyeSh2YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5oYW5kbGVNdXRhdGlvbkJhdGNoRXZlbnQgPSBmdW5jdGlvbiAobXV0YXRpb25CYXRjaCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbkJhdGNoLnVzZXIudWlkICE9PSB0aGlzLmN1cnJlbnRVc2VyLnVpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKExPR19UQUckMTAsIFwiSWdub3JpbmcgbXV0YXRpb24gZm9yIG5vbi1hY3RpdmUgdXNlciBcIiArIG11dGF0aW9uQmF0Y2gudXNlci51aWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnN5bmNFbmdpbmUuYXBwbHlCYXRjaFN0YXRlKG11dGF0aW9uQmF0Y2guYmF0Y2hJZCwgbXV0YXRpb25CYXRjaC5zdGF0ZSwgbXV0YXRpb25CYXRjaC5lcnJvcildO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmhhbmRsZVF1ZXJ5VGFyZ2V0RXZlbnQgPSBmdW5jdGlvbiAodGFyZ2V0TWV0YWRhdGEpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zeW5jRW5naW5lLmFwcGx5VGFyZ2V0U3RhdGUodGFyZ2V0TWV0YWRhdGEudGFyZ2V0SWQsIHRhcmdldE1ldGFkYXRhLnN0YXRlLCB0YXJnZXRNZXRhZGF0YS5lcnJvcik7XHJcbiAgICB9O1xyXG4gICAgV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5oYW5kbGVDbGllbnRTdGF0ZUV2ZW50ID0gZnVuY3Rpb24gKGNsaWVudElkLCBjbGllbnRTdGF0ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGV4aXN0aW5nVGFyZ2V0cyA9IHRoaXMuZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCk7XHJcbiAgICAgICAgaWYgKGNsaWVudFN0YXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlQ2xpZW50c1tjbGllbnRJZF0gPSBjbGllbnRTdGF0ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmFjdGl2ZUNsaWVudHNbY2xpZW50SWRdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbmV3VGFyZ2V0cyA9IHRoaXMuZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCk7XHJcbiAgICAgICAgdmFyIGFkZGVkVGFyZ2V0cyA9IFtdO1xyXG4gICAgICAgIHZhciByZW1vdmVkVGFyZ2V0cyA9IFtdO1xyXG4gICAgICAgIG5ld1RhcmdldHMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0SWQpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmICghZXhpc3RpbmdUYXJnZXRzLmhhcyh0YXJnZXRJZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhZGRlZFRhcmdldHMucHVzaCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyB9KTtcclxuICAgICAgICBleGlzdGluZ1RhcmdldHMuZm9yRWFjaChmdW5jdGlvbiAodGFyZ2V0SWQpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIGlmICghbmV3VGFyZ2V0cy5oYXModGFyZ2V0SWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZFRhcmdldHMucHVzaCh0YXJnZXRJZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zeW5jRW5naW5lLmFwcGx5QWN0aXZlVGFyZ2V0c0NoYW5nZShhZGRlZFRhcmdldHMsIHJlbW92ZWRUYXJnZXRzKTtcclxuICAgIH07XHJcbiAgICBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmhhbmRsZU9ubGluZVN0YXRlRXZlbnQgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICAvLyBXZSBjaGVjayB3aGV0aGVyIHRoZSBjbGllbnQgdGhhdCB3cm90ZSB0aGlzIG9ubGluZSBzdGF0ZSBpcyBzdGlsbCBhY3RpdmVcclxuICAgICAgICAvLyBieSBjb21wYXJpbmcgaXRzIGNsaWVudCBJRCB0byB0aGUgbGlzdCBvZiBjbGllbnRzIGtlcHQgYWN0aXZlIGluXHJcbiAgICAgICAgLy8gSW5kZXhlZERiLiBJZiBhIGNsaWVudCBkb2VzIG5vdCB1cGRhdGUgdGhlaXIgSW5kZXhlZERiIGNsaWVudCBzdGF0ZVxyXG4gICAgICAgIC8vIHdpdGhpbiA1IHNlY29uZHMsIGl0IGlzIGNvbnNpZGVyZWQgaW5hY3RpdmUgYW5kIHdlIGRvbid0IGVtaXQgYW4gb25saW5lXHJcbiAgICAgICAgLy8gc3RhdGUgZXZlbnQuXHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlQ2xpZW50c1tvbmxpbmVTdGF0ZS5jbGllbnRJZF0pIHtcclxuICAgICAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIob25saW5lU3RhdGUub25saW5lU3RhdGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gV2ViU3RvcmFnZVNoYXJlZENsaWVudFN0YXRlO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBmcm9tV2ViU3RvcmFnZVNlcXVlbmNlTnVtYmVyKHNlcVN0cmluZykge1xyXG4gICAgdmFyIHNlcXVlbmNlTnVtYmVyID0gTGlzdGVuU2VxdWVuY2UuSU5WQUxJRDtcclxuICAgIGlmIChzZXFTdHJpbmcgIT0gbnVsbCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJzZWQgPSBKU09OLnBhcnNlKHNlcVN0cmluZyk7XHJcbiAgICAgICAgICAgIGFzc2VydCh0eXBlb2YgcGFyc2VkID09PSAnbnVtYmVyJywgJ0ZvdW5kIG5vbi1udW1lcmljIHNlcXVlbmNlIG51bWJlcicpO1xyXG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlciA9IHBhcnNlZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgZXJyb3IoTE9HX1RBRyQxMCwgJ0ZhaWxlZCB0byByZWFkIHNlcXVlbmNlIG51bWJlciBmcm9tIFdlYlN0b3JhZ2UnLCBlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2VxdWVuY2VOdW1iZXI7XHJcbn1cclxuLyoqXHJcbiAqIGBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZWAgaXMgYSBzaW1wbGUgaW1wbGVtZW50YXRpb24gb2YgU2hhcmVkQ2xpZW50U3RhdGUgZm9yXHJcbiAqIGNsaWVudHMgdXNpbmcgbWVtb3J5IHBlcnNpc3RlbmNlLiBUaGUgc3RhdGUgaW4gdGhpcyBjbGFzcyByZW1haW5zIGZ1bGx5XHJcbiAqIGlzb2xhdGVkIGFuZCBubyBzeW5jaHJvbml6YXRpb24gaXMgcGVyZm9ybWVkLlxyXG4gKi9cclxudmFyIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUoKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbFN0YXRlID0gbmV3IExvY2FsQ2xpZW50U3RhdGUoKTtcclxuICAgICAgICB0aGlzLnF1ZXJ5U3RhdGUgPSB7fTtcclxuICAgICAgICB0aGlzLnN5bmNFbmdpbmUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuYWRkUGVuZGluZ011dGF0aW9uID0gZnVuY3Rpb24gKGJhdGNoSWQpIHtcclxuICAgICAgICAvLyBObyBvcC5cclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUudXBkYXRlTXV0YXRpb25TdGF0ZSA9IGZ1bmN0aW9uIChiYXRjaElkLCBzdGF0ZSwgZXJyb3IkJDEpIHtcclxuICAgICAgICAvLyBObyBvcC5cclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuYWRkTG9jYWxRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHRoaXMubG9jYWxTdGF0ZS5hZGRRdWVyeVRhcmdldCh0YXJnZXRJZCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcnlTdGF0ZVt0YXJnZXRJZF0gfHwgJ25vdC1jdXJyZW50JztcclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUudXBkYXRlUXVlcnlTdGF0ZSA9IGZ1bmN0aW9uICh0YXJnZXRJZCwgc3RhdGUsIGVycm9yJCQxKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyeVN0YXRlW3RhcmdldElkXSA9IHN0YXRlO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbFN0YXRlLnJlbW92ZVF1ZXJ5VGFyZ2V0KHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaXNMb2NhbFF1ZXJ5VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdGF0ZS5hY3RpdmVUYXJnZXRJZHMuaGFzKHRhcmdldElkKTtcclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuY2xlYXJRdWVyeVN0YXRlID0gZnVuY3Rpb24gKHRhcmdldElkKSB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMucXVlcnlTdGF0ZVt0YXJnZXRJZF07XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLmdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbFN0YXRlLmFjdGl2ZVRhcmdldElkcztcclxuICAgIH07XHJcbiAgICBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZS5wcm90b3R5cGUuaXNBY3RpdmVRdWVyeVRhcmdldCA9IGZ1bmN0aW9uICh0YXJnZXRJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RhdGUuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0YXJnZXRJZCk7XHJcbiAgICB9O1xyXG4gICAgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubG9jYWxTdGF0ZSA9IG5ldyBMb2NhbENsaWVudFN0YXRlKCk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5oYW5kbGVVc2VyQ2hhbmdlID0gZnVuY3Rpb24gKHVzZXIsIHJlbW92ZWRCYXRjaElkcywgYWRkZWRCYXRjaElkcykge1xyXG4gICAgICAgIC8vIE5vIG9wLlxyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5zZXRPbmxpbmVTdGF0ZSA9IGZ1bmN0aW9uIChvbmxpbmVTdGF0ZSkge1xyXG4gICAgICAgIC8vIE5vIG9wLlxyXG4gICAgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS5zaHV0ZG93biA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgIE1lbW9yeVNoYXJlZENsaWVudFN0YXRlLnByb3RvdHlwZS53cml0ZVNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKHNlcXVlbmNlTnVtYmVyKSB7IH07XHJcbiAgICByZXR1cm4gTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGU7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgTE9HX1RBRyQxMSA9ICdGaXJlc3RvcmVDbGllbnQnO1xyXG4vKiogVGhlIERPTUV4Y2VwdGlvbiBjb2RlIGZvciBhbiBhYm9ydGVkIG9wZXJhdGlvbi4gKi9cclxudmFyIERPTV9FWENFUFRJT05fQUJPUlRFRCA9IDIwO1xyXG4vKiogVGhlIERPTUV4Y2VwdGlvbiBjb2RlIGZvciBxdW90YSBleGNlZWRlZC4gKi9cclxudmFyIERPTV9FWENFUFRJT05fUVVPVEFfRVhDRUVERUQgPSAyMjtcclxuLyoqXHJcbiAqIEZpcmVzdG9yZUNsaWVudCBpcyBhIHRvcC1sZXZlbCBjbGFzcyB0aGF0IGNvbnN0cnVjdHMgYW5kIG93bnMgYWxsIG9mIHRoZVxyXG4gKiBwaWVjZXMgb2YgdGhlIGNsaWVudCBTREsgYXJjaGl0ZWN0dXJlLiBJdCBpcyByZXNwb25zaWJsZSBmb3IgY3JlYXRpbmcgdGhlXHJcbiAqIGFzeW5jIHF1ZXVlIHRoYXQgaXMgc2hhcmVkIGJ5IGFsbCBvZiB0aGUgb3RoZXIgY29tcG9uZW50cyBpbiB0aGUgc3lzdGVtLlxyXG4gKi9cclxudmFyIEZpcmVzdG9yZUNsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcmVzdG9yZUNsaWVudChwbGF0Zm9ybSwgZGF0YWJhc2VJbmZvLCBjcmVkZW50aWFscywgXHJcbiAgICAvKipcclxuICAgICAqIEFzeW5jaHJvbm91cyBxdWV1ZSByZXNwb25zaWJsZSBmb3IgYWxsIG9mIG91ciBpbnRlcm5hbCBwcm9jZXNzaW5nLiBXaGVuXHJcbiAgICAgKiB3ZSBnZXQgaW5jb21pbmcgd29yayBmcm9tIHRoZSB1c2VyICh2aWEgcHVibGljIEFQSSkgb3IgdGhlIG5ldHdvcmtcclxuICAgICAqIChpbmNvbWluZyBHUlBDIG1lc3NhZ2VzKSwgd2Ugc2hvdWxkIGFsd2F5cyBzY2hlZHVsZSBvbnRvIHRoaXMgcXVldWUuXHJcbiAgICAgKiBUaGlzIGVuc3VyZXMgYWxsIG9mIG91ciB3b3JrIGlzIHByb3Blcmx5IHNlcmlhbGl6ZWQgKGUuZy4gd2UgZG9uJ3RcclxuICAgICAqIHN0YXJ0IHByb2Nlc3NpbmcgYSBuZXcgb3BlcmF0aW9uIHdoaWxlIHRoZSBwcmV2aW91cyBvbmUgaXMgd2FpdGluZyBmb3JcclxuICAgICAqIGFuIGFzeW5jIEkvTyB0byBjb21wbGV0ZSkuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jUXVldWUpIHtcclxuICAgICAgICB0aGlzLnBsYXRmb3JtID0gcGxhdGZvcm07XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZUluZm8gPSBkYXRhYmFzZUluZm87XHJcbiAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IGNyZWRlbnRpYWxzO1xyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZSA9IGFzeW5jUXVldWU7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IEF1dG9JZC5uZXdJZCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdGFydHMgdXAgdGhlIEZpcmVzdG9yZUNsaWVudCwgcmV0dXJuaW5nIG9ubHkgd2hldGhlciBvciBub3QgZW5hYmxpbmdcclxuICAgICAqIHBlcnNpc3RlbmNlIHN1Y2NlZWRlZC5cclxuICAgICAqXHJcbiAgICAgKiBUaGUgaW50ZW50IGhlcmUgaXMgdG8gXCJkbyB0aGUgcmlnaHQgdGhpbmdcIiBhcyBmYXIgYXMgdXNlcnMgYXJlIGNvbmNlcm5lZC5cclxuICAgICAqIE5hbWVseSwgaW4gY2FzZXMgd2hlcmUgb2ZmbGluZSBwZXJzaXN0ZW5jZSBpcyByZXF1ZXN0ZWQgYW5kIHBvc3NpYmxlLFxyXG4gICAgICogZW5hYmxlIGl0LCBidXQgb3RoZXJ3aXNlIGZhbGwgYmFjayB0byBwZXJzaXN0ZW5jZSBkaXNhYmxlZC4gRm9yIHRoZSBtb3N0XHJcbiAgICAgKiBwYXJ0IHdlIGV4cGVjdCB0aGlzIHRvIHN1Y2NlZWQgb25lIHdheSBvciB0aGUgb3RoZXIgc28gd2UgZG9uJ3QgZXhwZWN0IG91clxyXG4gICAgICogdXNlcnMgdG8gYWN0dWFsbHkgd2FpdCBvbiB0aGUgZmlyZXN0b3JlLmVuYWJsZVBlcnNpc3RlbmNlIFByb21pc2Ugc2luY2VcclxuICAgICAqIHRoZXkgZ2VuZXJhbGx5IHdvbid0IGNhcmUuXHJcbiAgICAgKlxyXG4gICAgICogT2YgY291cnNlIHNvbWUgdXNlcnMgYWN0dWFsbHkgZG8gY2FyZSBhYm91dCB3aGV0aGVyIG9yIG5vdCBwZXJzaXN0ZW5jZVxyXG4gICAgICogd2FzIHN1Y2Nlc3NmdWxseSBlbmFibGVkLCBzbyB0aGUgUHJvbWlzZSByZXR1cm5lZCBmcm9tIHRoaXMgbWV0aG9kXHJcbiAgICAgKiBpbmRpY2F0ZXMgdGhpcyBvdXRjb21lLlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgcHJlc2VudHMgYSBwcm9ibGVtIHRob3VnaDogZXZlbiBiZWZvcmUgZW5hYmxlUGVyc2lzdGVuY2UgcmVzb2x2ZXMgb3JcclxuICAgICAqIHJlamVjdHMsIHVzZXJzIG1heSBoYXZlIG1hZGUgY2FsbHMgdG8gZS5nLiBmaXJlc3RvcmUuY29sbGVjdGlvbigpIHdoaWNoXHJcbiAgICAgKiBtZWFucyB0aGF0IHRoZSBGaXJlc3RvcmVDbGllbnQgaW4gdGhlcmUgd2lsbCBiZSBhdmFpbGFibGUgYW5kIHdpbGwgYmVcclxuICAgICAqIGVucXVldWluZyBhY3Rpb25zIG9uIHRoZSBhc3luYyBxdWV1ZS5cclxuICAgICAqXHJcbiAgICAgKiBNZWFud2hpbGUgYW55IGZhaWx1cmUgb2YgYW4gb3BlcmF0aW9uIG9uIHRoZSBhc3luYyBxdWV1ZSBjYXVzZXMgaXQgdG9cclxuICAgICAqIHBhbmljIGFuZCByZWplY3QgYW55IGZ1cnRoZXIgd29yaywgb24gdGhlIHByZW1pc2UgdGhhdCB1bmhhbmRsZWQgZXJyb3JzXHJcbiAgICAgKiBhcmUgZmF0YWwuXHJcbiAgICAgKlxyXG4gICAgICogQ29uc2VxdWVudGx5IHRoZSBmYWxsYmFjayBpcyBoYW5kbGVkIGludGVybmFsbHkgaGVyZSBpbiBzdGFydCwgYW5kIGlmIHRoZVxyXG4gICAgICogZmFsbGJhY2sgc3VjY2VlZHMgd2Ugc2lnbmFsIHN1Y2Nlc3MgdG8gdGhlIGFzeW5jIHF1ZXVlIGV2ZW4gdGhvdWdoIHRoZVxyXG4gICAgICogc3RhcnQoKSBpdHNlbGYgc2lnbmFscyBmYWlsdXJlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwZXJzaXN0ZW5jZVNldHRpbmdzIFNldHRpbmdzIG9iamVjdCB0byBjb25maWd1cmUgb2ZmbGluZVxyXG4gICAgICogICAgIHBlcnNpc3RlbmNlLlxyXG4gICAgICogQHJldHVybnMgQSBkZWZlcnJlZCByZXN1bHQgaW5kaWNhdGluZyB0aGUgdXNlci12aXNpYmxlIHJlc3VsdCBvZiBlbmFibGluZ1xyXG4gICAgICogICAgIG9mZmxpbmUgcGVyc2lzdGVuY2UuIFRoaXMgbWV0aG9kIHdpbGwgcmVqZWN0IHRoaXMgaWYgSW5kZXhlZERCIGZhaWxzIHRvXHJcbiAgICAgKiAgICAgc3RhcnQgZm9yIGFueSByZWFzb24uIElmIHVzZVBlcnNpc3RlbmNlIGlzIGZhbHNlIHRoaXMgaXNcclxuICAgICAqICAgICB1bmNvbmRpdGlvbmFsbHkgcmVzb2x2ZWQuXHJcbiAgICAgKi9cclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAocGVyc2lzdGVuY2VTZXR0aW5ncykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gV2UgZGVmZXIgb3VyIGluaXRpYWxpemF0aW9uIHVudGlsIHdlIGdldCB0aGUgY3VycmVudCB1c2VyIGZyb21cclxuICAgICAgICAvLyBzZXRDaGFuZ2VMaXN0ZW5lcigpLiBXZSBibG9jayB0aGUgYXN5bmMgcXVldWUgdW50aWwgd2UgZ290IHRoZSBpbml0aWFsXHJcbiAgICAgICAgLy8gdXNlciBhbmQgdGhlIGluaXRpYWxpemF0aW9uIGlzIGNvbXBsZXRlZC4gVGhpcyB3aWxsIHByZXZlbnQgYW55IHNjaGVkdWxlZFxyXG4gICAgICAgIC8vIHdvcmsgZnJvbSBoYXBwZW5pbmcgYmVmb3JlIGluaXRpYWxpemF0aW9uIGlzIGNvbXBsZXRlZC5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIElmIGluaXRpYWxpemF0aW9uRG9uZSByZXNvbHZlZCB0aGVuIHRoZSBGaXJlc3RvcmVDbGllbnQgaXMgaW4gYSB1c2FibGVcclxuICAgICAgICAvLyBzdGF0ZS5cclxuICAgICAgICB2YXIgaW5pdGlhbGl6YXRpb25Eb25lID0gbmV3IERlZmVycmVkJDEoKTtcclxuICAgICAgICAvLyBJZiB1c2VQZXJzaXN0ZW5jZSBpcyB0cnVlLCBjZXJ0YWluIGNsYXNzZXMgb2YgZXJyb3JzIHdoaWxlIHN0YXJ0aW5nIGFyZVxyXG4gICAgICAgIC8vIHJlY292ZXJhYmxlIGJ1dCBvbmx5IGJ5IGZhbGxpbmcgYmFjayB0byBwZXJzaXN0ZW5jZSBkaXNhYmxlZC5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIElmIHRoZXJlJ3MgYW4gZXJyb3IgaW4gdGhlIGZpcnN0IGNhc2UgYnV0IG5vdCBpbiByZWNvdmVyeSB3ZSBjYW5ub3RcclxuICAgICAgICAvLyByZWplY3QgdGhlIHByb21pc2UgYmxvY2tpbmcgdGhlIGFzeW5jIHF1ZXVlIGJlY2F1c2UgdGhpcyB3aWxsIGNhdXNlIHRoZVxyXG4gICAgICAgIC8vIGFzeW5jIHF1ZXVlIHRvIHBhbmljLlxyXG4gICAgICAgIHZhciBwZXJzaXN0ZW5jZVJlc3VsdCA9IG5ldyBEZWZlcnJlZCQxKCk7XHJcbiAgICAgICAgdmFyIGluaXRpYWxpemVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jcmVkZW50aWFscy5zZXRDaGFuZ2VMaXN0ZW5lcihmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgICAgICBpZiAoIWluaXRpYWxpemVkKSB7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5pbml0aWFsaXplUGVyc2lzdGVuY2UocGVyc2lzdGVuY2VTZXR0aW5ncywgcGVyc2lzdGVuY2VSZXN1bHQsIHVzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaW5pdGlhbGl6ZVJlc3QodXNlcik7IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oaW5pdGlhbGl6YXRpb25Eb25lLnJlc29sdmUsIGluaXRpYWxpemF0aW9uRG9uZS5yZWplY3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuaGFuZGxlQ3JlZGVudGlhbENoYW5nZSh1c2VyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gQmxvY2sgdGhlIGFzeW5jIHF1ZXVlIHVudGlsIGluaXRpYWxpemF0aW9uIGlzIGRvbmVcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbml0aWFsaXphdGlvbkRvbmUucHJvbWlzZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBSZXR1cm4gb25seSB0aGUgcmVzdWx0IG9mIGVuYWJsaW5nIHBlcnNpc3RlbmNlLiBOb3RlIHRoYXQgdGhpcyBkb2VzIG5vdFxyXG4gICAgICAgIC8vIG5lZWQgdG8gYXdhaXQgdGhlIGNvbXBsZXRpb24gb2YgaW5pdGlhbGl6YXRpb25Eb25lIGJlY2F1c2UgdGhlIHJlc3VsdCBvZlxyXG4gICAgICAgIC8vIHRoaXMgbWV0aG9kIHNob3VsZCBub3QgcmVmbGVjdCBhbnkgb3RoZXIga2luZCBvZiBmYWlsdXJlIHRvIHN0YXJ0LlxyXG4gICAgICAgIHJldHVybiBwZXJzaXN0ZW5jZVJlc3VsdC5wcm9taXNlO1xyXG4gICAgfTtcclxuICAgIC8qKiBFbmFibGVzIHRoZSBuZXR3b3JrIGNvbm5lY3Rpb24gYW5kIHJlcXVldWVzIGFsbCBwZW5kaW5nIG9wZXJhdGlvbnMuICovXHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmVuYWJsZU5ldHdvcmsgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5hc3luY1F1ZXVlLmVucXVldWUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc3luY0VuZ2luZS5lbmFibGVOZXR3b3JrKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplcyBwZXJzaXN0ZW50IHN0b3JhZ2UsIGF0dGVtcHRpbmcgdG8gdXNlIEluZGV4ZWREQiBpZlxyXG4gICAgICogdXNlUGVyc2lzdGVuY2UgaXMgdHJ1ZSBvciBtZW1vcnktb25seSBpZiBmYWxzZS5cclxuICAgICAqXHJcbiAgICAgKiBJZiBJbmRleGVkREIgZmFpbHMgYmVjYXVzZSBpdCdzIGFscmVhZHkgb3BlbiBpbiBhbm90aGVyIHRhYiBvciBiZWNhdXNlIHRoZVxyXG4gICAgICogcGxhdGZvcm0gY2FuJ3QgcG9zc2libHkgc3VwcG9ydCBvdXIgaW1wbGVtZW50YXRpb24gdGhlbiB0aGlzIG1ldGhvZCByZWplY3RzXHJcbiAgICAgKiB0aGUgcGVyc2lzdGVuY2VSZXN1bHQgYW5kIGZhbGxzIGJhY2sgb24gbWVtb3J5LW9ubHkgcGVyc2lzdGVuY2UuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBlcnNpc3RlbmNlU2V0dGluZ3MgU2V0dGluZ3Mgb2JqZWN0IHRvIGNvbmZpZ3VyZSBvZmZsaW5lIHBlcnNpc3RlbmNlXHJcbiAgICAgKiBAcGFyYW0gcGVyc2lzdGVuY2VSZXN1bHQgQSBkZWZlcnJlZCByZXN1bHQgaW5kaWNhdGluZyB0aGUgdXNlci12aXNpYmxlXHJcbiAgICAgKiAgICAgcmVzdWx0IG9mIGVuYWJsaW5nIG9mZmxpbmUgcGVyc2lzdGVuY2UuIFRoaXMgbWV0aG9kIHdpbGwgcmVqZWN0IHRoaXMgaWZcclxuICAgICAqICAgICBJbmRleGVkREIgZmFpbHMgdG8gc3RhcnQgZm9yIGFueSByZWFzb24uIElmIHVzZVBlcnNpc3RlbmNlIGlzIGZhbHNlXHJcbiAgICAgKiAgICAgdGhpcyBpcyB1bmNvbmRpdGlvbmFsbHkgcmVzb2x2ZWQuXHJcbiAgICAgKiBAcmV0dXJucyBhIFByb21pc2UgaW5kaWNhdGluZyB3aGV0aGVyIG9yIG5vdCBpbml0aWFsaXphdGlvbiBzaG91bGRcclxuICAgICAqICAgICBjb250aW51ZSwgaS5lLiB0aGF0IG9uZSBvZiB0aGUgcGVyc2lzdGVuY2UgaW1wbGVtZW50YXRpb25zIGFjdHVhbGx5XHJcbiAgICAgKiAgICAgc3VjY2VlZGVkLlxyXG4gICAgICovXHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmluaXRpYWxpemVQZXJzaXN0ZW5jZSA9IGZ1bmN0aW9uIChwZXJzaXN0ZW5jZVNldHRpbmdzLCBwZXJzaXN0ZW5jZVJlc3VsdCwgdXNlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHBlcnNpc3RlbmNlU2V0dGluZ3MuZW5hYmxlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdGFydEluZGV4ZWREYlBlcnNpc3RlbmNlKHVzZXIsIHBlcnNpc3RlbmNlU2V0dGluZ3MpXHJcbiAgICAgICAgICAgICAgICAudGhlbihwZXJzaXN0ZW5jZVJlc3VsdC5yZXNvbHZlKVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvciQkMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVnYXJkbGVzcyBvZiB3aGV0aGVyIG9yIG5vdCB0aGUgcmV0cnkgc3VjY2VlZHMsIGZyb20gYW4gdXNlclxyXG4gICAgICAgICAgICAgICAgLy8gcGVyc3BlY3RpdmUsIG9mZmxpbmUgcGVyc2lzdGVuY2UgaGFzIGZhaWxlZC5cclxuICAgICAgICAgICAgICAgIHBlcnNpc3RlbmNlUmVzdWx0LnJlamVjdChlcnJvciQkMSk7XHJcbiAgICAgICAgICAgICAgICAvLyBBbiB1bmtub3duIGZhaWx1cmUgb24gdGhlIGZpcnN0IHN0YWdlIHNodXRzIGV2ZXJ5dGhpbmcgZG93bi5cclxuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuY2FuRmFsbGJhY2soZXJyb3IkJDEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignRXJyb3IgZW5hYmxpbmcgb2ZmbGluZSBzdG9yYWdlLiBGYWxsaW5nIGJhY2sgdG8nICtcclxuICAgICAgICAgICAgICAgICAgICAnIHN0b3JhZ2UgZGlzYWJsZWQ6ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yJCQxKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zdGFydE1lbW9yeVBlcnNpc3RlbmNlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gV2hlbiB1c2VQZXJzaXN0ZW5jZSA9PSBmYWxzZSwgZW5hYmxpbmcgb2ZmbGluZSBwZXJzaXN0ZW5jZSBpcyBkZWZpbmVkXHJcbiAgICAgICAgICAgIC8vIHRvIHVuY29uZGl0aW9uYWxseSBzdWNjZWVkLiBUaGlzIGFsbG93cyBzdGFydCgpIHRvIGhhdmUgdGhlIHNhbWVcclxuICAgICAgICAgICAgLy8gc2lnbmF0dXJlIGZvciBib3RoIGNhc2VzLCBkZXNwaXRlIHRoZSBmYWN0IHRoYXQgdGhlIHJldHVybmVkIHByb21pc2VcclxuICAgICAgICAgICAgLy8gaXMgb25seSB1c2VkIGluIHRoZSBlbmFibGVQZXJzaXN0ZW5jZSBjYWxsLlxyXG4gICAgICAgICAgICBwZXJzaXN0ZW5jZVJlc3VsdC5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0TWVtb3J5UGVyc2lzdGVuY2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBEZWNpZGVzIHdoZXRoZXIgdGhlIHByb3ZpZGVkIGVycm9yIGFsbG93cyB1cyB0byBncmFjZWZ1bGx5IGRpc2FibGVcclxuICAgICAqIHBlcnNpc3RlbmNlIChhcyBvcHBvc2VkIHRvIGNyYXNoaW5nIHRoZSBjbGllbnQpLlxyXG4gICAgICovXHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmNhbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVycm9yJCQxKSB7XHJcbiAgICAgICAgaWYgKGVycm9yJCQxIGluc3RhbmNlb2YgRmlyZXN0b3JlRXJyb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlcnJvciQkMS5jb2RlID09PSBDb2RlLkZBSUxFRF9QUkVDT05ESVRJT04gfHxcclxuICAgICAgICAgICAgICAgIGVycm9yJCQxLmNvZGUgPT09IENvZGUuVU5JTVBMRU1FTlRFRCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBET01FeGNlcHRpb24gIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgICAgIGVycm9yJCQxIGluc3RhbmNlb2YgRE9NRXhjZXB0aW9uKSB7XHJcbiAgICAgICAgICAgIC8vIFdlIGZhbGwgYmFjayB0byBtZW1vcnkgcGVyc2lzdGVuY2UgaWYgd2UgY2Fubm90IHdyaXRlIHRoZSBwcmltYXJ5XHJcbiAgICAgICAgICAgIC8vIGxlYXNlLiBUaGlzIGNhbiBoYXBwZW4gY2FuIGR1cmluZyBhIHNjaGVtYSBtaWdyYXRpb24sIG9yIGlmIHdlIHJ1biBvdXRcclxuICAgICAgICAgICAgLy8gb2YgcXVvdGEgd2hlbiB3ZSB0cnkgdG8gd3JpdGUgdGhlIHByaW1hcnkgbGVhc2UuXHJcbiAgICAgICAgICAgIC8vIEZvciBib3RoIHRoZSBgUXVvdGFFeGNlZWRlZEVycm9yYCBhbmQgdGhlICBgQWJvcnRFcnJvcmAsIGl0IGlzIHNhZmUgdG9cclxuICAgICAgICAgICAgLy8gZmFsbCBiYWNrIHRvIG1lbW9yeSBwZXJzaXN0ZW5jZSBzaW5jZSBhbGwgbW9kaWZpY2F0aW9ucyB0byBJbmRleGVkRGJcclxuICAgICAgICAgICAgLy8gZmFpbGVkIHRvIGNvbW1pdC5cclxuICAgICAgICAgICAgcmV0dXJuIChlcnJvciQkMS5jb2RlID09PSBET01fRVhDRVBUSU9OX1FVT1RBX0VYQ0VFREVEIHx8XHJcbiAgICAgICAgICAgICAgICBlcnJvciQkMS5jb2RlID09PSBET01fRVhDRVBUSU9OX0FCT1JURUQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyBJbmRleGVkREItYmFzZWQgcGVyc2lzdGVuY2UuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIGluZGljYXRpbmcgc3VjY2VzcyBvciBmYWlsdXJlLlxyXG4gICAgICovXHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLnN0YXJ0SW5kZXhlZERiUGVyc2lzdGVuY2UgPSBmdW5jdGlvbiAodXNlciwgc2V0dGluZ3MpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGFzc2VydChzZXR0aW5ncy5lbmFibGVkLCAnU2hvdWxkIG9ubHkgc3RhcnQgSW5kZXhlZERiIHBlcnNpdGVuY2Ugd2l0aCBvZmZsaW5lIHBlcnNpc3RlbmNlIGVuYWJsZWQuJyk7XHJcbiAgICAgICAgLy8gVE9ETyhodHRwOi8vYi8zMzM4NDUyMyk6IEZvciBub3cgd2UganVzdCBkaXNhYmxlIGdhcmJhZ2UgY29sbGVjdGlvblxyXG4gICAgICAgIC8vIHdoZW4gcGVyc2lzdGVuY2UgaXMgZW5hYmxlZC5cclxuICAgICAgICB2YXIgc3RvcmFnZVByZWZpeCA9IEluZGV4ZWREYlBlcnNpc3RlbmNlLmJ1aWxkU3RvcmFnZVByZWZpeCh0aGlzLmRhdGFiYXNlSW5mbyk7XHJcbiAgICAgICAgLy8gT3B0IHRvIHVzZSBwcm90bzMgSlNPTiBpbiBjYXNlIHRoZSBwbGF0Zm9ybSBkb2Vzbid0IHN1cHBvcnQgVWludDhBcnJheS5cclxuICAgICAgICB2YXIgc2VyaWFsaXplciA9IG5ldyBKc29uUHJvdG9TZXJpYWxpemVyKHRoaXMuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQsIHtcclxuICAgICAgICAgICAgdXNlUHJvdG8zSnNvbjogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5leHBlcmltZW50YWxUYWJTeW5jaHJvbml6YXRpb24gJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICFXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGUuaXNBdmFpbGFibGUodGhpcy5wbGF0Zm9ybSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOSU1QTEVNRU5URUQsICdJbmRleGVkREIgcGVyc2lzdGVuY2UgaXMgb25seSBhdmFpbGFibGUgb24gcGxhdGZvcm1zIHRoYXQgc3VwcG9ydCBMb2NhbFN0b3JhZ2UuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZXR0aW5ncy5leHBlcmltZW50YWxUYWJTeW5jaHJvbml6YXRpb24pIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlID0gbmV3IFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZSh0aGlzLmFzeW5jUXVldWUsIHRoaXMucGxhdGZvcm0sIHN0b3JhZ2VQcmVmaXgsIHRoaXMuY2xpZW50SWQsIHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEluZGV4ZWREYlBlcnNpc3RlbmNlLmNyZWF0ZU11bHRpQ2xpZW50SW5kZXhlZERiUGVyc2lzdGVuY2Uoc3RvcmFnZVByZWZpeCwgdGhpcy5jbGllbnRJZCwgdGhpcy5wbGF0Zm9ybSwgdGhpcy5hc3luY1F1ZXVlLCBzZXJpYWxpemVyLCB7IHNlcXVlbmNlTnVtYmVyU3luY2VyOiB0aGlzLnNoYXJlZENsaWVudFN0YXRlIH0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnBlcnNpc3RlbmNlID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSBuZXcgTWVtb3J5U2hhcmVkQ2xpZW50U3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBJbmRleGVkRGJQZXJzaXN0ZW5jZS5jcmVhdGVJbmRleGVkRGJQZXJzaXN0ZW5jZShzdG9yYWdlUHJlZml4LCB0aGlzLmNsaWVudElkLCB0aGlzLnBsYXRmb3JtLCB0aGlzLmFzeW5jUXVldWUsIHNlcmlhbGl6ZXIpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnBlcnNpc3RlbmNlID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyBNZW1vcnktYmFja2VkIHBlcnNpc3RlbmNlLiBJbiBwcmFjdGljZSB0aGlzIGNhbm5vdCBmYWlsLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHdpbGwgc3VjY2Vzc2Z1bGx5IHJlc29sdmUuXHJcbiAgICAgKi9cclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuc3RhcnRNZW1vcnlQZXJzaXN0ZW5jZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyBPcHQgdG8gdXNlIHByb3RvMyBKU09OIGluIGNhc2UgdGhlIHBsYXRmb3JtIGRvZXNuJ3Qgc3VwcG9ydCBVaW50OEFycmF5LlxyXG4gICAgICAgIHZhciBzZXJpYWxpemVyID0gbmV3IEpzb25Qcm90b1NlcmlhbGl6ZXIodGhpcy5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCwge1xyXG4gICAgICAgICAgICB1c2VQcm90bzNKc29uOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IE1lbW9yeVBlcnNpc3RlbmNlLmNyZWF0ZUVhZ2VyUGVyc2lzdGVuY2UodGhpcy5jbGllbnRJZCwgc2VyaWFsaXplcik7XHJcbiAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IG5ldyBNZW1vcnlTaGFyZWRDbGllbnRTdGF0ZSgpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYWxpemVzIHRoZSByZXN0IG9mIHRoZSBGaXJlc3RvcmVDbGllbnQsIGFzc3VtaW5nIHRoZSBpbml0aWFsIHVzZXJcclxuICAgICAqIGhhcyBiZWVuIG9idGFpbmVkIGZyb20gdGhlIGNyZWRlbnRpYWwgcHJvdmlkZXIgYW5kIHNvbWUgcGVyc2lzdGVuY2VcclxuICAgICAqIGltcGxlbWVudGF0aW9uIGlzIGF2YWlsYWJsZSBpbiB0aGlzLnBlcnNpc3RlbmNlLlxyXG4gICAgICovXHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmluaXRpYWxpemVSZXN0ID0gZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGRlYnVnKExPR19UQUckMTEsICdJbml0aWFsaXppbmcuIHVzZXI9JywgdXNlci51aWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBsYXRmb3JtXHJcbiAgICAgICAgICAgIC5sb2FkQ29ubmVjdGlvbih0aGlzLmRhdGFiYXNlSW5mbylcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGNvbm5lY3Rpb24pIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgc2VyaWFsaXplciwgZGF0YXN0b3JlLCByZW1vdGVTdG9yZU9ubGluZVN0YXRlQ2hhbmdlZEhhbmRsZXIsIHNoYXJlZENsaWVudFN0YXRlT25saW5lU3RhdGVDaGFuZ2VkSGFuZGxlcjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvY2FsU3RvcmUgPSBuZXcgTG9jYWxTdG9yZSh0aGlzLnBlcnNpc3RlbmNlLCB1c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWFsaXplciA9IHRoaXMucGxhdGZvcm0ubmV3U2VyaWFsaXplcih0aGlzLmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXN0b3JlID0gbmV3IERhdGFzdG9yZSh0aGlzLmFzeW5jUXVldWUsIGNvbm5lY3Rpb24sIHRoaXMuY3JlZGVudGlhbHMsIHNlcmlhbGl6ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVTdG9yZU9ubGluZVN0YXRlQ2hhbmdlZEhhbmRsZXIgPSBmdW5jdGlvbiAob25saW5lU3RhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zeW5jRW5naW5lLmFwcGx5T25saW5lU3RhdGVDaGFuZ2Uob25saW5lU3RhdGUsIE9ubGluZVN0YXRlU291cmNlLlJlbW90ZVN0b3JlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVkQ2xpZW50U3RhdGVPbmxpbmVTdGF0ZUNoYW5nZWRIYW5kbGVyID0gZnVuY3Rpb24gKG9ubGluZVN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc3luY0VuZ2luZS5hcHBseU9ubGluZVN0YXRlQ2hhbmdlKG9ubGluZVN0YXRlLCBPbmxpbmVTdGF0ZVNvdXJjZS5TaGFyZWRDbGllbnRTdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3RlU3RvcmUgPSBuZXcgUmVtb3RlU3RvcmUodGhpcy5sb2NhbFN0b3JlLCBkYXRhc3RvcmUsIHRoaXMuYXN5bmNRdWV1ZSwgcmVtb3RlU3RvcmVPbmxpbmVTdGF0ZUNoYW5nZWRIYW5kbGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zeW5jRW5naW5lID0gbmV3IFN5bmNFbmdpbmUodGhpcy5sb2NhbFN0b3JlLCB0aGlzLnJlbW90ZVN0b3JlLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlLCB1c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBzaGFyZWRDbGllbnRTdGF0ZU9ubGluZVN0YXRlQ2hhbmdlZEhhbmRsZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCB1cCB3aXJpbmcgYmV0d2VlbiBzeW5jIGVuZ2luZSBhbmQgb3RoZXIgY29tcG9uZW50c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLnN5bmNFbmdpbmUgPSB0aGlzLnN5bmNFbmdpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc3luY0VuZ2luZSA9IHRoaXMuc3luY0VuZ2luZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmVudE1nciA9IG5ldyBFdmVudE1hbmFnZXIodGhpcy5zeW5jRW5naW5lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUE9SVElORyBOT1RFOiBMb2NhbFN0b3JlIGRvZXNuJ3QgbmVlZCBhbiBleHBsaWNpdCBzdGFydCgpIG9uIHRoZSBXZWIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc3RhcnQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IExvY2FsU3RvcmUgZG9lc24ndCBuZWVkIGFuIGV4cGxpY2l0IHN0YXJ0KCkgb24gdGhlIFdlYi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlbW90ZVN0b3JlLnN0YXJ0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBUaGlzIHdpbGwgaW1tZWRpYXRlbHkgY2FsbCB0aGUgbGlzdGVuZXIsIHNvIHdlIG1ha2Ugc3VyZSB0b1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgaXQgYWZ0ZXIgbG9jYWxTdG9yZSAvIHJlbW90ZVN0b3JlIGFyZSBzdGFydGVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBlcnNpc3RlbmNlLnNldFByaW1hcnlTdGF0ZUxpc3RlbmVyKGZ1bmN0aW9uIChpc1ByaW1hcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc3luY0VuZ2luZS5hcHBseVByaW1hcnlTdGF0ZShpc1ByaW1hcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTk9URTogVGhpcyB3aWxsIGltbWVkaWF0ZWx5IGNhbGwgdGhlIGxpc3RlbmVyLCBzbyB3ZSBtYWtlIHN1cmUgdG9cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGl0IGFmdGVyIGxvY2FsU3RvcmUgLyByZW1vdGVTdG9yZSBhcmUgc3RhcnRlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pOyB9KTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UgPSBmdW5jdGlvbiAodXNlcikge1xyXG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS52ZXJpZnlPcGVyYXRpb25JblByb2dyZXNzKCk7XHJcbiAgICAgICAgZGVidWcoTE9HX1RBRyQxMSwgJ0NyZWRlbnRpYWwgQ2hhbmdlZC4gQ3VycmVudCB1c2VyOiAnICsgdXNlci51aWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuaGFuZGxlQ3JlZGVudGlhbENoYW5nZSh1c2VyKTtcclxuICAgIH07XHJcbiAgICAvKiogRGlzYWJsZXMgdGhlIG5ldHdvcmsgY29ubmVjdGlvbi4gUGVuZGluZyBvcGVyYXRpb25zIHdpbGwgbm90IGNvbXBsZXRlLiAqL1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5kaXNhYmxlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zeW5jRW5naW5lLmRpc2FibGVOZXR3b3JrKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5zaHV0ZG93biA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gdGhpcy5hc3luY1F1ZXVlLmVucXVldWUoZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUE9SVElORyBOT1RFOiBMb2NhbFN0b3JlIGRvZXMgbm90IG5lZWQgYW4gZXhwbGljaXQgc2h1dGRvd24gb24gd2ViLlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVtb3RlU3RvcmUuc2h1dGRvd24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IExvY2FsU3RvcmUgZG9lcyBub3QgbmVlZCBhbiBleHBsaWNpdCBzaHV0ZG93biBvbiB3ZWIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zaHV0ZG93bigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wZXJzaXN0ZW5jZS5zaHV0ZG93bihvcHRpb25zICYmIG9wdGlvbnMucHVyZ2VQZXJzaXN0ZW5jZVdpdGhEYXRhTG9zcyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBgcmVtb3ZlQ2hhbmdlTGlzdGVuZXJgIG11c3QgYmUgY2FsbGVkIGFmdGVyIHNodXR0aW5nIGRvd24gdGhlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW90ZVN0b3JlIGFzIGl0IHdpbGwgcHJldmVudCB0aGUgUmVtb3RlU3RvcmUgZnJvbSByZXRyaWV2aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGF1dGggdG9rZW5zLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWRlbnRpYWxzLnJlbW92ZUNoYW5nZUxpc3RlbmVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUubGlzdGVuID0gZnVuY3Rpb24gKHF1ZXJ5LCBvYnNlcnZlciwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gbmV3IFF1ZXJ5TGlzdGVuZXIocXVlcnksIG9ic2VydmVyLCBvcHRpb25zKTtcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5ldmVudE1nci5saXN0ZW4obGlzdGVuZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBsaXN0ZW5lcjtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5ldmVudE1nci51bmxpc3RlbihsaXN0ZW5lcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5nZXREb2N1bWVudEZyb21Mb2NhbENhY2hlID0gZnVuY3Rpb24gKGRvY0tleSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXN5bmNRdWV1ZVxyXG4gICAgICAgICAgICAuZW5xdWV1ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbFN0b3JlLnJlYWREb2N1bWVudChkb2NLZXkpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChtYXliZURvYykge1xyXG4gICAgICAgICAgICBpZiAobWF5YmVEb2MgaW5zdGFuY2VvZiBEb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1heWJlRG9jO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG1heWJlRG9jIGluc3RhbmNlb2YgTm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5VTkFWQUlMQUJMRSwgJ0ZhaWxlZCB0byBnZXQgZG9jdW1lbnQgZnJvbSBjYWNoZS4gKEhvd2V2ZXIsIHRoaXMgZG9jdW1lbnQgbWF5ICcgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwiZXhpc3Qgb24gdGhlIHNlcnZlci4gUnVuIGFnYWluIHdpdGhvdXQgc2V0dGluZyAnc291cmNlJyBpbiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RoZSBHZXRPcHRpb25zIHRvIGF0dGVtcHQgdG8gcmV0cmlldmUgdGhlIGRvY3VtZW50IGZyb20gdGhlICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICdzZXJ2ZXIuKScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlQ2xpZW50LnByb3RvdHlwZS5nZXREb2N1bWVudHNGcm9tTG9jYWxDYWNoZSA9IGZ1bmN0aW9uIChxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXN5bmNRdWV1ZVxyXG4gICAgICAgICAgICAuZW5xdWV1ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5sb2NhbFN0b3JlLmV4ZWN1dGVRdWVyeShxdWVyeSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRvY3MpIHtcclxuICAgICAgICAgICAgdmFyIHJlbW90ZUtleXMgPSBkb2N1bWVudEtleVNldCgpO1xyXG4gICAgICAgICAgICB2YXIgdmlldyA9IG5ldyBWaWV3KHF1ZXJ5LCByZW1vdGVLZXlzKTtcclxuICAgICAgICAgICAgdmFyIHZpZXdEb2NDaGFuZ2VzID0gdmlldy5jb21wdXRlRG9jQ2hhbmdlcyhkb2NzKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZpZXcuYXBwbHlDaGFuZ2VzKHZpZXdEb2NDaGFuZ2VzLCBcclxuICAgICAgICAgICAgLyogdXBkYXRlTGltYm9Eb2N1bWVudHM9ICovIGZhbHNlKS5zbmFwc2hvdDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGRlZmVycmVkID0gbmV3IERlZmVycmVkJDEoKTtcclxuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5zeW5jRW5naW5lLndyaXRlKG11dGF0aW9ucywgZGVmZXJyZWQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZUNsaWVudC5wcm90b3R5cGUuZGF0YWJhc2VJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZDtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmVDbGllbnQucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKHVwZGF0ZUZ1bmN0aW9uKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBXZSBoYXZlIHRvIHdhaXQgZm9yIHRoZSBhc3luYyBxdWV1ZSB0byBiZSBzdXJlIHN5bmNFbmdpbmUgaXMgaW5pdGlhbGl6ZWQuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXN5bmNRdWV1ZVxyXG4gICAgICAgICAgICAuZW5xdWV1ZShmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICB9KTsgfSk7IH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnN5bmNFbmdpbmUucnVuVHJhbnNhY3Rpb24odXBkYXRlRnVuY3Rpb24pOyB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmlyZXN0b3JlQ2xpZW50O1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLypcclxuICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIE9ic2VydmVyPFQ+IHRoYXQgd2lsbCBkaXNwYXRjaCBldmVudHNcclxuICogYXN5bmNocm9ub3VzbHkuIFRvIGFsbG93IGltbWVkaWF0ZSBzaWxlbmNpbmcsIGEgbXV0ZSBjYWxsIGlzIGFkZGVkIHdoaWNoXHJcbiAqIGNhdXNlcyBldmVudHMgc2NoZWR1bGVkIHRvIG5vIGxvbmdlciBiZSByYWlzZWQuXHJcbiAqL1xyXG52YXIgQXN5bmNPYnNlcnZlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFzeW5jT2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcclxuICAgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogV2hlbiBzZXQgdG8gdHJ1ZSwgd2lsbCBub3QgcmFpc2UgZnV0dXJlIGV2ZW50cy4gTmVjZXNzYXJ5IHRvIGRlYWwgd2l0aFxyXG4gICAgICAgICAqIGFzeW5jIGRldGFjaG1lbnQgb2YgbGlzdGVuZXIuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5tdXRlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgQXN5bmNPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVFdmVudCh0aGlzLm9ic2VydmVyLm5leHQsIHZhbHVlKTtcclxuICAgIH07XHJcbiAgICBBc3luY09ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVFdmVudCh0aGlzLm9ic2VydmVyLmVycm9yLCBlcnJvcik7XHJcbiAgICB9O1xyXG4gICAgQXN5bmNPYnNlcnZlci5wcm90b3R5cGUubXV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLm11dGVkID0gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBBc3luY09ic2VydmVyLnByb3RvdHlwZS5zY2hlZHVsZUV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50SGFuZGxlciwgZXZlbnQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICghdGhpcy5tdXRlZCkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghX3RoaXMubXV0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudEhhbmRsZXIoZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFzeW5jT2JzZXJ2ZXI7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBUaGUgb2JqZWN0cyB0aGF0IGFyZSBhIHBhcnQgb2YgdGhpcyBBUEkgYXJlIGV4cG9zZWQgdG8gdGhpcmQtcGFydGllcyBhc1xyXG4vLyBjb21waWxlZCBqYXZhc2NyaXB0IHNvIHdlIHdhbnQgdG8gZmxhZyBvdXIgcHJpdmF0ZSBtZW1iZXJzIHdpdGggYSBsZWFkaW5nXHJcbi8vIHVuZGVyc2NvcmUgdG8gZGlzY291cmFnZSB0aGVpciB1c2UuXHJcbi8vIHRzbGludDpkaXNhYmxlOnN0cmlwLXByaXZhdGUtcHJvcGVydHktdW5kZXJzY29yZVxyXG4vKipcclxuICogQSBGaWVsZFBhdGggcmVmZXJzIHRvIGEgZmllbGQgaW4gYSBkb2N1bWVudC4gVGhlIHBhdGggbWF5IGNvbnNpc3Qgb2YgYSBzaW5nbGVcclxuICogZmllbGQgbmFtZSAocmVmZXJyaW5nIHRvIGEgdG9wLWxldmVsIGZpZWxkIGluIHRoZSBkb2N1bWVudCksIG9yIGEgbGlzdCBvZlxyXG4gKiBmaWVsZCBuYW1lcyAocmVmZXJyaW5nIHRvIGEgbmVzdGVkIGZpZWxkIGluIHRoZSBkb2N1bWVudCkuXHJcbiAqL1xyXG52YXIgRmllbGRQYXRoJDEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBGaWVsZFBhdGggZnJvbSB0aGUgcHJvdmlkZWQgZmllbGQgbmFtZXMuIElmIG1vcmUgdGhhbiBvbmUgZmllbGRcclxuICAgICAqIG5hbWUgaXMgcHJvdmlkZWQsIHRoZSBwYXRoIHdpbGwgcG9pbnQgdG8gYSBuZXN0ZWQgZmllbGQgaW4gYSBkb2N1bWVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZmllbGROYW1lcyBBIGxpc3Qgb2YgZmllbGQgbmFtZXMuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIEZpZWxkUGF0aCQkMSgpIHtcclxuICAgICAgICB2YXIgZmllbGROYW1lcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGZpZWxkTmFtZXNbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVOYW1lZEFycmF5QXRMZWFzdE51bWJlck9mRWxlbWVudHMoJ0ZpZWxkUGF0aCcsIGZpZWxkTmFtZXMsICdmaWVsZE5hbWVzJywgMSk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaWVsZE5hbWVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnRmllbGRQYXRoJywgJ3N0cmluZycsIGksIGZpZWxkTmFtZXNbaV0pO1xyXG4gICAgICAgICAgICBpZiAoZmllbGROYW1lc1tpXS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBmaWVsZCBuYW1lIGF0IGFyZ3VtZW50ICQoaSArIDEpLiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgJ0ZpZWxkIG5hbWVzIG11c3Qgbm90IGJlIGVtcHR5LicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2ludGVybmFsUGF0aCA9IG5ldyBGaWVsZFBhdGgoZmllbGROYW1lcyk7XHJcbiAgICB9XHJcbiAgICBGaWVsZFBhdGgkJDEuZG9jdW1lbnRJZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gRmllbGRQYXRoJCQxLl9ET0NVTUVOVF9JRDtcclxuICAgIH07XHJcbiAgICBGaWVsZFBhdGgkJDEucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIEZpZWxkUGF0aCQkMSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZENsYXNzRXJyb3IoJ2lzRXF1YWwnLCAnRmllbGRQYXRoJywgMSwgb3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5faW50ZXJuYWxQYXRoLmlzRXF1YWwob3RoZXIuX2ludGVybmFsUGF0aCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbnRlcm5hbCBOb3RlOiBUaGUgYmFja2VuZCBkb2Vzbid0IHRlY2huaWNhbGx5IHN1cHBvcnQgcXVlcnlpbmcgYnlcclxuICAgICAqIGRvY3VtZW50IElELiBJbnN0ZWFkIGl0IHF1ZXJpZXMgYnkgdGhlIGVudGlyZSBkb2N1bWVudCBuYW1lIChmdWxsIHBhdGhcclxuICAgICAqIGluY2x1ZGVkKSwgYnV0IGluIHRoZSBjYXNlcyB3ZSBjdXJyZW50bHkgc3VwcG9ydCBkb2N1bWVudElkKCksIHRoZSBuZXRcclxuICAgICAqIGVmZmVjdCBpcyB0aGUgc2FtZS5cclxuICAgICAqL1xyXG4gICAgRmllbGRQYXRoJCQxLl9ET0NVTUVOVF9JRCA9IG5ldyBGaWVsZFBhdGgkJDEoRmllbGRQYXRoLmtleUZpZWxkKCkuY2Fub25pY2FsU3RyaW5nKCkpO1xyXG4gICAgcmV0dXJuIEZpZWxkUGF0aCQkMTtcclxufSgpKTtcclxuLyoqXHJcbiAqIE1hdGNoZXMgYW55IGNoYXJhY3RlcnMgaW4gYSBmaWVsZCBwYXRoIHN0cmluZyB0aGF0IGFyZSByZXNlcnZlZC5cclxuICovXHJcbnZhciBSRVNFUlZFRCA9IG5ldyBSZWdFeHAoJ1t+XFxcXCovXFxcXFtcXFxcXV0nKTtcclxuLyoqXHJcbiAqIFBhcnNlcyBhIGZpZWxkIHBhdGggc3RyaW5nIGludG8gYSBGaWVsZFBhdGgsIHRyZWF0aW5nIGRvdHMgYXMgc2VwYXJhdG9ycy5cclxuICovXHJcbmZ1bmN0aW9uIGZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcocGF0aCkge1xyXG4gICAgdmFyIGZvdW5kID0gcGF0aC5zZWFyY2goUkVTRVJWRUQpO1xyXG4gICAgaWYgKGZvdW5kID49IDApIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgZmllbGQgcGF0aCAoXCIgKyBwYXRoICsgXCIpLiBQYXRocyBtdXN0IG5vdCBjb250YWluIFwiICtcclxuICAgICAgICAgICAgXCInficsICcqJywgJy8nLCAnWycsIG9yICddJ1wiKTtcclxuICAgIH1cclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyAoRmllbGRQYXRoJDEuYmluZC5hcHBseShGaWVsZFBhdGgkMSwgW3ZvaWQgMF0uY29uY2F0KHBhdGguc3BsaXQoJy4nKSkpKSgpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgZmllbGQgcGF0aCAoXCIgKyBwYXRoICsgXCIpLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgXCIgK1xyXG4gICAgICAgICAgICBcImJlZ2luIHdpdGggJy4nLCBlbmQgd2l0aCAnLicsIG9yIGNvbnRhaW4gJy4uJ1wiKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIE9BdXRoVG9rZW4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBPQXV0aFRva2VuKHZhbHVlLCB1c2VyKSB7XHJcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcclxuICAgICAgICB0aGlzLnR5cGUgPSAnT0F1dGgnO1xyXG4gICAgICAgIHRoaXMuYXV0aEhlYWRlcnMgPSB7IEF1dGhvcml6YXRpb246IFwiQmVhcmVyIFwiICsgdmFsdWUgfTtcclxuICAgIH1cclxuICAgIHJldHVybiBPQXV0aFRva2VuO1xyXG59KCkpO1xyXG4vKiogQSBDcmVkZW50aWFsc1Byb3ZpZGVyIHRoYXQgYWx3YXlzIHlpZWxkcyBhbiBlbXB0eSB0b2tlbi4gKi9cclxudmFyIEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlcigpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBTdG9yZXMgdGhlIGxpc3RlbmVyIHJlZ2lzdGVyZWQgd2l0aCBzZXRDaGFuZ2VMaXN0ZW5lcigpXHJcbiAgICAgICAgICogVGhpcyBpc24ndCBhY3R1YWxseSBuZWNlc3Nhcnkgc2luY2UgdGhlIFVJRCBuZXZlciBjaGFuZ2VzLCBidXQgd2UgdXNlIHRoaXNcclxuICAgICAgICAgKiB0byB2ZXJpZnkgdGhlIGxpc3RlbiBjb250cmFjdCBpcyBhZGhlcmVkIHRvIGluIHRlc3RzLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5nZXRUb2tlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xyXG4gICAgfTtcclxuICAgIEVtcHR5Q3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuaW52YWxpZGF0ZVRva2VuID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5zZXRDaGFuZ2VMaXN0ZW5lciA9IGZ1bmN0aW9uIChjaGFuZ2VMaXN0ZW5lcikge1xyXG4gICAgICAgIGFzc2VydCghdGhpcy5jaGFuZ2VMaXN0ZW5lciwgJ0NhbiBvbmx5IGNhbGwgc2V0Q2hhbmdlTGlzdGVuZXIoKSBvbmNlLicpO1xyXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBjaGFuZ2VMaXN0ZW5lcjtcclxuICAgICAgICAvLyBGaXJlIHdpdGggaW5pdGlhbCB1c2VyLlxyXG4gICAgICAgIGNoYW5nZUxpc3RlbmVyKFVzZXIuVU5BVVRIRU5USUNBVEVEKTtcclxuICAgIH07XHJcbiAgICBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLnJlbW92ZUNoYW5nZUxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLmNoYW5nZUxpc3RlbmVyICE9PSBudWxsLCAncmVtb3ZlQ2hhbmdlTGlzdGVuZXIoKSB3aGVuIG5vIGxpc3RlbmVyIHJlZ2lzdGVyZWQnKTtcclxuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gbnVsbDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyO1xyXG59KCkpO1xyXG52YXIgRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyKGFwcCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGF1dGggdG9rZW4gbGlzdGVuZXIgcmVnaXN0ZXJlZCB3aXRoIEZpcmViYXNlQXBwLCByZXRhaW5lZCBoZXJlIHNvIHdlXHJcbiAgICAgICAgICogY2FuIHVucmVnaXN0ZXIgaXQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy50b2tlbkxpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb3VudGVyIHVzZWQgdG8gZGV0ZWN0IGlmIHRoZSB0b2tlbiBjaGFuZ2VkIHdoaWxlIGEgZ2V0VG9rZW4gcmVxdWVzdCB3YXNcclxuICAgICAgICAgKiBvdXRzdGFuZGluZy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRva2VuQ291bnRlciA9IDA7XHJcbiAgICAgICAgLyoqIFRoZSBsaXN0ZW5lciByZWdpc3RlcmVkIHdpdGggc2V0Q2hhbmdlTGlzdGVuZXIoKS4gKi9cclxuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMudG9rZW5MaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMudG9rZW5Db3VudGVyKys7XHJcbiAgICAgICAgICAgIF90aGlzLmN1cnJlbnRVc2VyID0gX3RoaXMuZ2V0VXNlcigpO1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuY2hhbmdlTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNoYW5nZUxpc3RlbmVyKF90aGlzLmN1cnJlbnRVc2VyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy50b2tlbkNvdW50ZXIgPSAwO1xyXG4gICAgICAgIC8vIFdpbGwgZmlyZSBhdCBsZWFzdCBvbmNlIHdoZXJlIHdlIHNldCB0aGlzLmN1cnJlbnRVc2VyXHJcbiAgICAgICAgdGhpcy5hcHAuSU5URVJOQUwuYWRkQXV0aFRva2VuTGlzdGVuZXIodGhpcy50b2tlbkxpc3RlbmVyKTtcclxuICAgIH1cclxuICAgIEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuZ2V0VG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQodGhpcy50b2tlbkxpc3RlbmVyICE9IG51bGwsICdnZXRUb2tlbiBjYW5ub3QgYmUgY2FsbGVkIGFmdGVyIGxpc3RlbmVyIHJlbW92ZWQuJyk7XHJcbiAgICAgICAgLy8gVGFrZSBub3RlIG9mIHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSB0b2tlbkNvdW50ZXIgc28gdGhhdCB0aGlzIG1ldGhvZFxyXG4gICAgICAgIC8vIGNhbiBmYWlsICh3aXRoIGFuIEFCT1JURUQgZXJyb3IpIGlmIHRoZXJlIGlzIGEgdG9rZW4gY2hhbmdlIHdoaWxlIHRoZVxyXG4gICAgICAgIC8vIHJlcXVlc3QgaXMgb3V0c3RhbmRpbmcuXHJcbiAgICAgICAgdmFyIGluaXRpYWxUb2tlbkNvdW50ZXIgPSB0aGlzLnRva2VuQ291bnRlcjtcclxuICAgICAgICB2YXIgZm9yY2VSZWZyZXNoID0gdGhpcy5mb3JjZVJlZnJlc2g7XHJcbiAgICAgICAgdGhpcy5mb3JjZVJlZnJlc2ggPSBmYWxzZTtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHAuSU5URVJOQUwuZ2V0VG9rZW4oZm9yY2VSZWZyZXNoKS50aGVuKGZ1bmN0aW9uICh0b2tlbkRhdGEpIHtcclxuICAgICAgICAgICAgLy8gQ2FuY2VsIHRoZSByZXF1ZXN0IHNpbmNlIHRoZSB0b2tlbiBjaGFuZ2VkIHdoaWxlIHRoZSByZXF1ZXN0IHdhc1xyXG4gICAgICAgICAgICAvLyBvdXRzdGFuZGluZyBzbyB0aGUgcmVzcG9uc2UgaXMgcG90ZW50aWFsbHkgZm9yIGEgcHJldmlvdXMgdXNlciAod2hpY2hcclxuICAgICAgICAgICAgLy8gdXNlciwgd2UgY2FuJ3QgYmUgc3VyZSkuXHJcbiAgICAgICAgICAgIGlmIChfdGhpcy50b2tlbkNvdW50ZXIgIT09IGluaXRpYWxUb2tlbkNvdW50ZXIpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLkFCT1JURUQsICdnZXRUb2tlbiBhYm9ydGVkIGR1ZSB0byB0b2tlbiBjaGFuZ2UuJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodG9rZW5EYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHR5cGVvZiB0b2tlbkRhdGEuYWNjZXNzVG9rZW4gPT09ICdzdHJpbmcnLCAnSW52YWxpZCB0b2tlbkRhdGEgcmV0dXJuZWQgZnJvbSBnZXRUb2tlbigpOicgKyB0b2tlbkRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT0F1dGhUb2tlbih0b2tlbkRhdGEuYWNjZXNzVG9rZW4sIF90aGlzLmN1cnJlbnRVc2VyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5pbnZhbGlkYXRlVG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5mb3JjZVJlZnJlc2ggPSB0cnVlO1xyXG4gICAgfTtcclxuICAgIEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuc2V0Q2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAoY2hhbmdlTGlzdGVuZXIpIHtcclxuICAgICAgICBhc3NlcnQoIXRoaXMuY2hhbmdlTGlzdGVuZXIsICdDYW4gb25seSBjYWxsIHNldENoYW5nZUxpc3RlbmVyKCkgb25jZS4nKTtcclxuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gY2hhbmdlTGlzdGVuZXI7XHJcbiAgICAgICAgLy8gRmlyZSB0aGUgaW5pdGlhbCBldmVudCwgYnV0IG9ubHkgaWYgd2UgcmVjZWl2ZWQgdGhlIGluaXRpYWwgdXNlclxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgICAgIGNoYW5nZUxpc3RlbmVyKHRoaXMuY3VycmVudFVzZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLnJlbW92ZUNoYW5nZUxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGFzc2VydCh0aGlzLnRva2VuTGlzdGVuZXIgIT0gbnVsbCwgJ3JlbW92ZUNoYW5nZUxpc3RlbmVyKCkgY2FsbGVkIHR3aWNlJyk7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuY2hhbmdlTGlzdGVuZXIgIT09IG51bGwsICdyZW1vdmVDaGFuZ2VMaXN0ZW5lcigpIGNhbGxlZCB3aGVuIG5vIGxpc3RlbmVyIHJlZ2lzdGVyZWQnKTtcclxuICAgICAgICB0aGlzLmFwcC5JTlRFUk5BTC5yZW1vdmVBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLnRva2VuTGlzdGVuZXIpO1xyXG4gICAgICAgIHRoaXMudG9rZW5MaXN0ZW5lciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VMaXN0ZW5lciA9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyLnByb3RvdHlwZS5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjdXJyZW50VWlkID0gdGhpcy5hcHAuSU5URVJOQUwuZ2V0VWlkKCk7XHJcbiAgICAgICAgYXNzZXJ0KGN1cnJlbnRVaWQgPT09IG51bGwgfHwgdHlwZW9mIGN1cnJlbnRVaWQgPT09ICdzdHJpbmcnLCAnUmVjZWl2ZWQgaW52YWxpZCBVSUQ6ICcgKyBjdXJyZW50VWlkKTtcclxuICAgICAgICByZXR1cm4gbmV3IFVzZXIoY3VycmVudFVpZCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlcjtcclxufSgpKTtcclxuLypcclxuICogRmlyc3RQYXJ0eVRva2VuIHByb3ZpZGVzIGEgZnJlc2ggdG9rZW4gZWFjaCB0aW1lIGl0cyB2YWx1ZVxyXG4gKiBpcyByZXF1ZXN0ZWQsIGJlY2F1c2UgaWYgdGhlIHRva2VuIGlzIHRvbyBvbGQsIHJlcXVlc3RzIHdpbGwgYmUgcmVqZWN0ZWQuXHJcbiAqIFRPRE8oYi8zMzE0NzgxOCkgdGhpcyBpbXBsZW1lbnRhdGlvbiB2aW9sYXRlcyB0aGUgY3VycmVudCBhc3N1bXB0aW9uIHRoYXRcclxuICogdG9rZW5zIGFyZSBpbW11dGFibGUuICBXZSBuZWVkIHRvIGVpdGhlciByZXZpc2l0IHRoaXMgYXNzdW1wdGlvbiBvciBjb21lXHJcbiAqIHVwIHdpdGggc29tZSB3YXkgZm9yIEZQQSB0byB1c2UgdGhlIGxpc3Rlbi91bmxpc3RlbiBpbnRlcmZhY2UuXHJcbiAqL1xyXG52YXIgRmlyc3RQYXJ0eVRva2VuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyc3RQYXJ0eVRva2VuKGdhcGksIHNlc3Npb25JbmRleCkge1xyXG4gICAgICAgIHRoaXMuZ2FwaSA9IGdhcGk7XHJcbiAgICAgICAgdGhpcy5zZXNzaW9uSW5kZXggPSBzZXNzaW9uSW5kZXg7XHJcbiAgICAgICAgdGhpcy50eXBlID0gJ0ZpcnN0UGFydHknO1xyXG4gICAgICAgIHRoaXMudXNlciA9IFVzZXIuRklSU1RfUEFSVFk7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuZ2FwaSAmJlxyXG4gICAgICAgICAgICB0aGlzLmdhcGlbJ2F1dGgnXSAmJlxyXG4gICAgICAgICAgICB0aGlzLmdhcGlbJ2F1dGgnXVsnZ2V0QXV0aEhlYWRlclZhbHVlRm9yRmlyc3RQYXJ0eSddLCAndW5leHBlY3RlZCBnYXBpIGludGVyZmFjZScpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpcnN0UGFydHlUb2tlbi5wcm90b3R5cGUsIFwiYXV0aEhlYWRlcnNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogdGhpcy5nYXBpWydhdXRoJ11bJ2dldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHknXShbXSksXHJcbiAgICAgICAgICAgICAgICAnWC1Hb29nLUF1dGhVc2VyJzogdGhpcy5zZXNzaW9uSW5kZXhcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBGaXJzdFBhcnR5VG9rZW47XHJcbn0oKSk7XHJcbi8qXHJcbiAqIFByb3ZpZGVzIHVzZXIgY3JlZGVudGlhbHMgcmVxdWlyZWQgZm9yIHRoZSBGaXJlc3RvcmUgSmF2YVNjcmlwdCBTREtcclxuICogdG8gYXV0aGVudGljYXRlIHRoZSB1c2VyLCB1c2luZyB0ZWNobmlxdWUgdGhhdCBpcyBvbmx5IGF2YWlsYWJsZVxyXG4gKiB0byBhcHBsaWNhdGlvbnMgaG9zdGVkIGJ5IEdvb2dsZS5cclxuICovXHJcbnZhciBGaXJzdFBhcnR5Q3JlZGVudGlhbHNQcm92aWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcnN0UGFydHlDcmVkZW50aWFsc1Byb3ZpZGVyKGdhcGksIHNlc3Npb25JbmRleCkge1xyXG4gICAgICAgIHRoaXMuZ2FwaSA9IGdhcGk7XHJcbiAgICAgICAgdGhpcy5zZXNzaW9uSW5kZXggPSBzZXNzaW9uSW5kZXg7XHJcbiAgICAgICAgYXNzZXJ0KHRoaXMuZ2FwaSAmJlxyXG4gICAgICAgICAgICB0aGlzLmdhcGlbJ2F1dGgnXSAmJlxyXG4gICAgICAgICAgICB0aGlzLmdhcGlbJ2F1dGgnXVsnZ2V0QXV0aEhlYWRlclZhbHVlRm9yRmlyc3RQYXJ0eSddLCAndW5leHBlY3RlZCBnYXBpIGludGVyZmFjZScpO1xyXG4gICAgfVxyXG4gICAgRmlyc3RQYXJ0eUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLmdldFRva2VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEZpcnN0UGFydHlUb2tlbih0aGlzLmdhcGksIHRoaXMuc2Vzc2lvbkluZGV4KSk7XHJcbiAgICB9O1xyXG4gICAgLy8gVE9ETygzMzEwODkyNSk6IGNhbiBzb21lb25lIHN3aXRjaCB1c2VycyB3L28gYSBwYWdlIHJlZnJlc2g/XHJcbiAgICAvLyBUT0RPKDMzMTEwNjIxKTogbmVlZCB0byB1bmRlcnN0YW5kIHRva2VuL3Nlc3Npb24gbGlmZWN5Y2xlXHJcbiAgICBGaXJzdFBhcnR5Q3JlZGVudGlhbHNQcm92aWRlci5wcm90b3R5cGUuc2V0Q2hhbmdlTGlzdGVuZXIgPSBmdW5jdGlvbiAoY2hhbmdlTGlzdGVuZXIpIHtcclxuICAgICAgICAvLyBGaXJlIHdpdGggaW5pdGlhbCB1aWQuXHJcbiAgICAgICAgY2hhbmdlTGlzdGVuZXIoVXNlci5GSVJTVF9QQVJUWSk7XHJcbiAgICB9O1xyXG4gICAgRmlyc3RQYXJ0eUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLnJlbW92ZUNoYW5nZUxpc3RlbmVyID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgRmlyc3RQYXJ0eUNyZWRlbnRpYWxzUHJvdmlkZXIucHJvdG90eXBlLmludmFsaWRhdGVUb2tlbiA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgIHJldHVybiBGaXJzdFBhcnR5Q3JlZGVudGlhbHNQcm92aWRlcjtcclxufSgpKTtcclxuLyoqXHJcbiAqIEJ1aWxkcyBhIENyZWRlbnRpYWxzUHJvdmlkZXIgZGVwZW5kaW5nIG9uIHRoZSB0eXBlIG9mXHJcbiAqIHRoZSBjcmVkZW50aWFscyBwYXNzZWQgaW4uXHJcbiAqL1xyXG5mdW5jdGlvbiBtYWtlQ3JlZGVudGlhbHNQcm92aWRlcihjcmVkZW50aWFscykge1xyXG4gICAgaWYgKCFjcmVkZW50aWFscykge1xyXG4gICAgICAgIHJldHVybiBuZXcgRW1wdHlDcmVkZW50aWFsc1Byb3ZpZGVyKCk7XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKGNyZWRlbnRpYWxzLnR5cGUpIHtcclxuICAgICAgICBjYXNlICdnYXBpJzpcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGaXJzdFBhcnR5Q3JlZGVudGlhbHNQcm92aWRlcihjcmVkZW50aWFscy5jbGllbnQsIGNyZWRlbnRpYWxzLnNlc3Npb25JbmRleCB8fCAnMCcpO1xyXG4gICAgICAgIGNhc2UgJ3Byb3ZpZGVyJzpcclxuICAgICAgICAgICAgcmV0dXJuIGNyZWRlbnRpYWxzLmNsaWVudDtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnbWFrZUNyZWRlbnRpYWxzUHJvdmlkZXIgZmFpbGVkIGR1ZSB0byBpbnZhbGlkIGNyZWRlbnRpYWwgdHlwZScpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1BhcnRpYWxPYnNlcnZlcihvYmopIHtcclxuICAgIHJldHVybiBpbXBsZW1lbnRzQW55TWV0aG9kcyQxKG9iaiwgWyduZXh0JywgJ2Vycm9yJywgJ2NvbXBsZXRlJ10pO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRydWUgaWYgb2JqIGlzIGFuIG9iamVjdCBhbmQgY29udGFpbnMgYXQgbGVhc3Qgb25lIG9mIHRoZSBzcGVjaWZpZWRcclxuICogbWV0aG9kcy5cclxuICovXHJcbmZ1bmN0aW9uIGltcGxlbWVudHNBbnlNZXRob2RzJDEob2JqLCBtZXRob2RzKSB7XHJcbiAgICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcgfHwgb2JqID09PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgdmFyIG9iamVjdCA9IG9iajtcclxuICAgIGZvciAodmFyIF9pID0gMCwgbWV0aG9kc18xID0gbWV0aG9kczsgX2kgPCBtZXRob2RzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIG1ldGhvZCA9IG1ldGhvZHNfMVtfaV07XHJcbiAgICAgICAgaWYgKG1ldGhvZCBpbiBvYmplY3QgJiYgdHlwZW9mIG9iamVjdFttZXRob2RdID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEFuIG9wYXF1ZSBiYXNlIGNsYXNzIGZvciBGaWVsZFZhbHVlIHNlbnRpbmVsIG9iamVjdHMgaW4gb3VyIHB1YmxpYyBBUEksXHJcbiAqIHdpdGggcHVibGljIHN0YXRpYyBtZXRob2RzIGZvciBjcmVhdGluZyBzYWlkIHNlbnRpbmVsIG9iamVjdHMuXHJcbiAqL1xyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y2xhc3MtYXMtbmFtZXNwYWNlICBXZSB1c2UgdGhpcyBhcyBhIGJhc2UgY2xhc3MuXHJcbnZhciBGaWVsZFZhbHVlSW1wbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpZWxkVmFsdWVJbXBsKF9tZXRob2ROYW1lKSB7XHJcbiAgICAgICAgdGhpcy5fbWV0aG9kTmFtZSA9IF9tZXRob2ROYW1lO1xyXG4gICAgfVxyXG4gICAgRmllbGRWYWx1ZUltcGwuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBEZWxldGVGaWVsZFZhbHVlSW1wbC5pbnN0YW5jZTtcclxuICAgIH07XHJcbiAgICBGaWVsZFZhbHVlSW1wbC5zZXJ2ZXJUaW1lc3RhbXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFNlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsLmluc3RhbmNlO1xyXG4gICAgfTtcclxuICAgIEZpZWxkVmFsdWVJbXBsLmFycmF5VW5pb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGVsZW1lbnRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgZWxlbWVudHNbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdGaWVsZFZhbHVlLmFycmF5VW5pb24nLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIC8vIE5PVEU6IFdlIGRvbid0IGFjdHVhbGx5IHBhcnNlIHRoZSBkYXRhIHVudGlsIGl0J3MgdXNlZCBpbiBzZXQoKSBvclxyXG4gICAgICAgIC8vIHVwZGF0ZSgpIHNpbmNlIHdlIG5lZWQgYWNjZXNzIHRvIHRoZSBGaXJlc3RvcmUgaW5zdGFuY2UuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBBcnJheVVuaW9uRmllbGRWYWx1ZUltcGwoZWxlbWVudHMpO1xyXG4gICAgfTtcclxuICAgIEZpZWxkVmFsdWVJbXBsLmFycmF5UmVtb3ZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlbGVtZW50cyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGVsZW1lbnRzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnRmllbGRWYWx1ZS5hcnJheVJlbW92ZScsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgLy8gTk9URTogV2UgZG9uJ3QgYWN0dWFsbHkgcGFyc2UgdGhlIGRhdGEgdW50aWwgaXQncyB1c2VkIGluIHNldCgpIG9yXHJcbiAgICAgICAgLy8gdXBkYXRlKCkgc2luY2Ugd2UgbmVlZCBhY2Nlc3MgdG8gdGhlIEZpcmVzdG9yZSBpbnN0YW5jZS5cclxuICAgICAgICByZXR1cm4gbmV3IEFycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGwoZWxlbWVudHMpO1xyXG4gICAgfTtcclxuICAgIEZpZWxkVmFsdWVJbXBsLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IG90aGVyO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBGaWVsZFZhbHVlSW1wbDtcclxufSgpKTtcclxudmFyIERlbGV0ZUZpZWxkVmFsdWVJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRGVsZXRlRmllbGRWYWx1ZUltcGwsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBEZWxldGVGaWVsZFZhbHVlSW1wbCgpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgJ0ZpZWxkVmFsdWUuZGVsZXRlJykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIC8qKiBTaW5nbGV0b24gaW5zdGFuY2UuICovXHJcbiAgICBEZWxldGVGaWVsZFZhbHVlSW1wbC5pbnN0YW5jZSA9IG5ldyBEZWxldGVGaWVsZFZhbHVlSW1wbCgpO1xyXG4gICAgcmV0dXJuIERlbGV0ZUZpZWxkVmFsdWVJbXBsO1xyXG59KEZpZWxkVmFsdWVJbXBsKSk7XHJcbnZhciBTZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFNlcnZlclRpbWVzdGFtcEZpZWxkVmFsdWVJbXBsLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2VydmVyVGltZXN0YW1wRmllbGRWYWx1ZUltcGwoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsICdGaWVsZFZhbHVlLnNlcnZlclRpbWVzdGFtcCcpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICAvKiogU2luZ2xldG9uIGluc3RhbmNlLiAqL1xyXG4gICAgU2VydmVyVGltZXN0YW1wRmllbGRWYWx1ZUltcGwuaW5zdGFuY2UgPSBuZXcgU2VydmVyVGltZXN0YW1wRmllbGRWYWx1ZUltcGwoKTtcclxuICAgIHJldHVybiBTZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbDtcclxufShGaWVsZFZhbHVlSW1wbCkpO1xyXG52YXIgQXJyYXlVbmlvbkZpZWxkVmFsdWVJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQXJyYXlVbmlvbkZpZWxkVmFsdWVJbXBsLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQXJyYXlVbmlvbkZpZWxkVmFsdWVJbXBsKF9lbGVtZW50cykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsICdGaWVsZFZhbHVlLmFycmF5VW5pb24nKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLl9lbGVtZW50cyA9IF9lbGVtZW50cztcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gQXJyYXlVbmlvbkZpZWxkVmFsdWVJbXBsO1xyXG59KEZpZWxkVmFsdWVJbXBsKSk7XHJcbnZhciBBcnJheVJlbW92ZUZpZWxkVmFsdWVJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQXJyYXlSZW1vdmVGaWVsZFZhbHVlSW1wbCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEFycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGwoX2VsZW1lbnRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgJ0ZpZWxkVmFsdWUuYXJyYXlSZW1vdmUnKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLl9lbGVtZW50cyA9IF9lbGVtZW50cztcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gQXJyYXlSZW1vdmVGaWVsZFZhbHVlSW1wbDtcclxufShGaWVsZFZhbHVlSW1wbCkpO1xyXG4vLyBQdWJsaWMgaW5zdGFuY2UgdGhhdCBkaXNhbGxvd3MgY29uc3RydWN0aW9uIGF0IHJ1bnRpbWUuIFRoaXMgY29uc3RydWN0b3IgaXNcclxuLy8gdXNlZCB3aGVuIGV4cG9ydGluZyBGaWVsZFZhbHVlSW1wbCBvbiBmaXJlYmFzZS5maXJlc3RvcmUuRmllbGRWYWx1ZSBhbmQgd2lsbFxyXG4vLyBiZSBjYWxsZWQgRmllbGRWYWx1ZSBwdWJsaWNseS4gSW50ZXJuYWxseSB3ZSBzdGlsbCB1c2UgRmllbGRWYWx1ZUltcGwgd2hpY2hcclxuLy8gaGFzIGEgdHlwZS1jaGVja2VkIHByaXZhdGUgY29uc3RydWN0b3IuIE5vdGUgdGhhdCBGaWVsZFZhbHVlSW1wbCBhbmRcclxuLy8gUHVibGljRmllbGRWYWx1ZSBjYW4gYmUgdXNlZCBpbnRlcmNoYW5nZWFibHkgaW4gaW5zdGFuY2VvZiBjaGVja3MuXHJcbi8vIEZvciBvdXIgaW50ZXJuYWwgVHlwZVNjcmlwdCBjb2RlIFB1YmxpY0ZpZWxkVmFsdWUgZG9lc24ndCBleGlzdCBhcyBhIHR5cGUsXHJcbi8vIGFuZCBzbyB3ZSBuZWVkIHRvIHVzZSBGaWVsZFZhbHVlSW1wbCBhcyB0eXBlIGFuZCBleHBvcnQgaXQgdG9vLlxyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dmFyaWFibGUtbmFtZSAgV2UgdHJlYXQgdGhpcyBhcyBhIGNsYXNzIG5hbWUuXHJcbnZhciBQdWJsaWNGaWVsZFZhbHVlID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShGaWVsZFZhbHVlSW1wbCwgJ1VzZSBGaWVsZFZhbHVlLjxmaWVsZD4oKSBpbnN0ZWFkLicpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIFJFU0VSVkVEX0ZJRUxEX1JFR0VYID0gL15fXy4qX18kLztcclxuLyoqIFRoZSByZXN1bHQgb2YgcGFyc2luZyBkb2N1bWVudCBkYXRhIChlLmcuIGZvciBhIHNldERhdGEgY2FsbCkuICovXHJcbnZhciBQYXJzZWRTZXREYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGFyc2VkU2V0RGF0YShkYXRhLCBmaWVsZE1hc2ssIGZpZWxkVHJhbnNmb3Jtcykge1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgdGhpcy5maWVsZE1hc2sgPSBmaWVsZE1hc2s7XHJcbiAgICAgICAgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBmaWVsZFRyYW5zZm9ybXM7XHJcbiAgICB9XHJcbiAgICBQYXJzZWRTZXREYXRhLnByb3RvdHlwZS50b011dGF0aW9ucyA9IGZ1bmN0aW9uIChrZXksIHByZWNvbmRpdGlvbikge1xyXG4gICAgICAgIHZhciBtdXRhdGlvbnMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5maWVsZE1hc2sgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgbXV0YXRpb25zLnB1c2gobmV3IFBhdGNoTXV0YXRpb24oa2V5LCB0aGlzLmRhdGEsIHRoaXMuZmllbGRNYXNrLCBwcmVjb25kaXRpb24pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG11dGF0aW9ucy5wdXNoKG5ldyBTZXRNdXRhdGlvbihrZXksIHRoaXMuZGF0YSwgcHJlY29uZGl0aW9uKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIG11dGF0aW9ucy5wdXNoKG5ldyBUcmFuc2Zvcm1NdXRhdGlvbihrZXksIHRoaXMuZmllbGRUcmFuc2Zvcm1zKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBhcnNlZFNldERhdGE7XHJcbn0oKSk7XHJcbi8qKiBUaGUgcmVzdWx0IG9mIHBhcnNpbmcgXCJ1cGRhdGVcIiBkYXRhIChpLmUuIGZvciBhbiB1cGRhdGVEYXRhIGNhbGwpLiAqL1xyXG52YXIgUGFyc2VkVXBkYXRlRGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBhcnNlZFVwZGF0ZURhdGEoZGF0YSwgZmllbGRNYXNrLCBmaWVsZFRyYW5zZm9ybXMpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuZmllbGRNYXNrID0gZmllbGRNYXNrO1xyXG4gICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gZmllbGRUcmFuc2Zvcm1zO1xyXG4gICAgfVxyXG4gICAgUGFyc2VkVXBkYXRlRGF0YS5wcm90b3R5cGUudG9NdXRhdGlvbnMgPSBmdW5jdGlvbiAoa2V5LCBwcmVjb25kaXRpb24pIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25zID0gW1xyXG4gICAgICAgICAgICBuZXcgUGF0Y2hNdXRhdGlvbihrZXksIHRoaXMuZGF0YSwgdGhpcy5maWVsZE1hc2ssIHByZWNvbmRpdGlvbilcclxuICAgICAgICBdO1xyXG4gICAgICAgIGlmICh0aGlzLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIG11dGF0aW9ucy5wdXNoKG5ldyBUcmFuc2Zvcm1NdXRhdGlvbihrZXksIHRoaXMuZmllbGRUcmFuc2Zvcm1zKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFBhcnNlZFVwZGF0ZURhdGE7XHJcbn0oKSk7XHJcbi8qXHJcbiAqIFJlcHJlc2VudHMgd2hhdCB0eXBlIG9mIEFQSSBtZXRob2QgcHJvdmlkZWQgdGhlIGRhdGEgYmVpbmcgcGFyc2VkOyB1c2VmdWxcclxuICogZm9yIGRldGVybWluaW5nIHdoaWNoIGVycm9yIGNvbmRpdGlvbnMgYXBwbHkgZHVyaW5nIHBhcnNpbmcgYW5kIHByb3ZpZGluZ1xyXG4gKiBiZXR0ZXIgZXJyb3IgbWVzc2FnZXMuXHJcbiAqL1xyXG52YXIgVXNlckRhdGFTb3VyY2U7XHJcbihmdW5jdGlvbiAoVXNlckRhdGFTb3VyY2UpIHtcclxuICAgIFVzZXJEYXRhU291cmNlW1VzZXJEYXRhU291cmNlW1wiU2V0XCJdID0gMF0gPSBcIlNldFwiO1xyXG4gICAgVXNlckRhdGFTb3VyY2VbVXNlckRhdGFTb3VyY2VbXCJVcGRhdGVcIl0gPSAxXSA9IFwiVXBkYXRlXCI7XHJcbiAgICBVc2VyRGF0YVNvdXJjZVtVc2VyRGF0YVNvdXJjZVtcIk1lcmdlU2V0XCJdID0gMl0gPSBcIk1lcmdlU2V0XCI7XHJcbiAgICAvKipcclxuICAgICAqIEluZGljYXRlcyB0aGUgc291cmNlIGlzIGEgd2hlcmUgY2xhdXNlLCBjdXJzb3IgYm91bmQsIGFycmF5VW5pb24oKVxyXG4gICAgICogZWxlbWVudCwgZXRjLiBPZiBub3RlLCBpc1dyaXRlKHNvdXJjZSkgd2lsbCByZXR1cm4gZmFsc2UuXHJcbiAgICAgKi9cclxuICAgIFVzZXJEYXRhU291cmNlW1VzZXJEYXRhU291cmNlW1wiQXJndW1lbnRcIl0gPSAzXSA9IFwiQXJndW1lbnRcIjtcclxufSkoVXNlckRhdGFTb3VyY2UgfHwgKFVzZXJEYXRhU291cmNlID0ge30pKTtcclxuZnVuY3Rpb24gaXNXcml0ZShkYXRhU291cmNlKSB7XHJcbiAgICBzd2l0Y2ggKGRhdGFTb3VyY2UpIHtcclxuICAgICAgICBjYXNlIFVzZXJEYXRhU291cmNlLlNldDogLy8gZmFsbCB0aHJvdWdoXHJcbiAgICAgICAgY2FzZSBVc2VyRGF0YVNvdXJjZS5NZXJnZVNldDogLy8gZmFsbCB0aHJvdWdoXHJcbiAgICAgICAgY2FzZSBVc2VyRGF0YVNvdXJjZS5VcGRhdGU6XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIGNhc2UgVXNlckRhdGFTb3VyY2UuQXJndW1lbnQ6XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICB0aHJvdyBmYWlsKFwiVW5leHBlY3RlZCBjYXNlIGZvciBVc2VyRGF0YVNvdXJjZTogXCIgKyBkYXRhU291cmNlKTtcclxuICAgIH1cclxufVxyXG4vKiogQSBcImNvbnRleHRcIiBvYmplY3QgcGFzc2VkIGFyb3VuZCB3aGlsZSBwYXJzaW5nIHVzZXIgZGF0YS4gKi9cclxudmFyIFBhcnNlQ29udGV4dCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZXMgYSBQYXJzZUNvbnRleHQgd2l0aCB0aGUgZ2l2ZW4gc291cmNlIGFuZCBwYXRoLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkYXRhU291cmNlIEluZGljYXRlcyB3aGF0IGtpbmQgb2YgQVBJIG1ldGhvZCB0aGlzIGRhdGEgY2FtZSBmcm9tLlxyXG4gICAgICogQHBhcmFtIG1ldGhvZE5hbWUgVGhlIG5hbWUgb2YgdGhlIG1ldGhvZCB0aGUgdXNlciBjYWxsZWQgdG8gY3JlYXRlIHRoaXNcclxuICAgICAqICAgICBQYXJzZUNvbnRleHQuXHJcbiAgICAgKiBAcGFyYW0gcGF0aCBBIHBhdGggd2l0aGluIHRoZSBvYmplY3QgYmVpbmcgcGFyc2VkLiBUaGlzIGNvdWxkIGJlIGFuIGVtcHR5XHJcbiAgICAgKiAgICAgcGF0aCAoaW4gd2hpY2ggY2FzZSB0aGUgY29udGV4dCByZXByZXNlbnRzIHRoZSByb290IG9mIHRoZSBkYXRhIGJlaW5nXHJcbiAgICAgKiAgICAgcGFyc2VkKSwgb3IgYSBub25lbXB0eSBwYXRoIChpbmRpY2F0aW5nIHRoZSBjb250ZXh0IHJlcHJlc2VudHMgYSBuZXN0ZWRcclxuICAgICAqICAgICBsb2NhdGlvbiB3aXRoaW4gdGhlIGRhdGEpLlxyXG4gICAgICogQHBhcmFtIGFycmF5RWxlbWVudCBXaGV0aGVyIG9yIG5vdCB0aGlzIGNvbnRleHQgY29ycmVzcG9uZHMgdG8gYW4gZWxlbWVudFxyXG4gICAgICogICAgIG9mIGFuIGFycmF5LlxyXG4gICAgICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyBBIG11dGFibGUgbGlzdCBvZiBmaWVsZCB0cmFuc2Zvcm1zIGVuY291bnRlcmVkIHdoaWxlXHJcbiAgICAgKiAgICAgcGFyc2luZyB0aGUgZGF0YS5cclxuICAgICAqIEBwYXJhbSBmaWVsZE1hc2sgQSBtdXRhYmxlIGxpc3Qgb2YgZmllbGQgcGF0aHMgZW5jb3VudGVyZWQgd2hpbGUgcGFyc2luZ1xyXG4gICAgICogICAgIHRoZSBkYXRhLlxyXG4gICAgICpcclxuICAgICAqIFRPRE8oYi8zNDg3MTEzMSk6IFdlIGRvbid0IHN1cHBvcnQgYXJyYXkgcGF0aHMgcmlnaHQgbm93LCBzbyBwYXRoIGNhbiBiZVxyXG4gICAgICogbnVsbCB0byBpbmRpY2F0ZSB0aGUgY29udGV4dCByZXByZXNlbnRzIGFueSBsb2NhdGlvbiB3aXRoaW4gYW4gYXJyYXkgKGluXHJcbiAgICAgKiB3aGljaCBjYXNlIGNlcnRhaW4gZmVhdHVyZXMgd2lsbCBub3Qgd29yayBhbmQgZXJyb3JzIHdpbGwgYmUgc29tZXdoYXRcclxuICAgICAqIGNvbXByb21pc2VkKS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gUGFyc2VDb250ZXh0KGRhdGFTb3VyY2UsIG1ldGhvZE5hbWUsIHBhdGgsIGFycmF5RWxlbWVudCwgZmllbGRUcmFuc2Zvcm1zLCBmaWVsZE1hc2spIHtcclxuICAgICAgICB0aGlzLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xyXG4gICAgICAgIHRoaXMubWV0aG9kTmFtZSA9IG1ldGhvZE5hbWU7XHJcbiAgICAgICAgdGhpcy5wYXRoID0gcGF0aDtcclxuICAgICAgICB0aGlzLmFycmF5RWxlbWVudCA9IGFycmF5RWxlbWVudDtcclxuICAgICAgICAvLyBNaW5vciBoYWNrOiBJZiBmaWVsZFRyYW5zZm9ybXMgaXMgdW5kZWZpbmVkLCB3ZSBhc3N1bWUgdGhpcyBpcyBhblxyXG4gICAgICAgIC8vIGV4dGVybmFsIGNhbGwgYW5kIHdlIG5lZWQgdG8gdmFsaWRhdGUgdGhlIGVudGlyZSBwYXRoLlxyXG4gICAgICAgIGlmIChmaWVsZFRyYW5zZm9ybXMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlUGF0aCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFycmF5RWxlbWVudCA9IGFycmF5RWxlbWVudCAhPT0gdW5kZWZpbmVkID8gYXJyYXlFbGVtZW50IDogZmFsc2U7XHJcbiAgICAgICAgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBmaWVsZFRyYW5zZm9ybXMgfHwgW107XHJcbiAgICAgICAgdGhpcy5maWVsZE1hc2sgPSBmaWVsZE1hc2sgfHwgW107XHJcbiAgICB9XHJcbiAgICBQYXJzZUNvbnRleHQucHJvdG90eXBlLmNoaWxkQ29udGV4dEZvckZpZWxkID0gZnVuY3Rpb24gKGZpZWxkKSB7XHJcbiAgICAgICAgdmFyIGNoaWxkUGF0aCA9IHRoaXMucGF0aCA9PSBudWxsID8gbnVsbCA6IHRoaXMucGF0aC5jaGlsZChmaWVsZCk7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgUGFyc2VDb250ZXh0KHRoaXMuZGF0YVNvdXJjZSwgdGhpcy5tZXRob2ROYW1lLCBjaGlsZFBhdGgsIFxyXG4gICAgICAgIC8qYXJyYXlFbGVtZW50PSovIGZhbHNlLCB0aGlzLmZpZWxkVHJhbnNmb3JtcywgdGhpcy5maWVsZE1hc2spO1xyXG4gICAgICAgIGNvbnRleHQudmFsaWRhdGVQYXRoU2VnbWVudChmaWVsZCk7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRleHQ7XHJcbiAgICB9O1xyXG4gICAgUGFyc2VDb250ZXh0LnByb3RvdHlwZS5jaGlsZENvbnRleHRGb3JGaWVsZFBhdGggPSBmdW5jdGlvbiAoZmllbGQpIHtcclxuICAgICAgICB2YXIgY2hpbGRQYXRoID0gdGhpcy5wYXRoID09IG51bGwgPyBudWxsIDogdGhpcy5wYXRoLmNoaWxkKGZpZWxkKTtcclxuICAgICAgICB2YXIgY29udGV4dCA9IG5ldyBQYXJzZUNvbnRleHQodGhpcy5kYXRhU291cmNlLCB0aGlzLm1ldGhvZE5hbWUsIGNoaWxkUGF0aCwgXHJcbiAgICAgICAgLyphcnJheUVsZW1lbnQ9Ki8gZmFsc2UsIHRoaXMuZmllbGRUcmFuc2Zvcm1zLCB0aGlzLmZpZWxkTWFzayk7XHJcbiAgICAgICAgY29udGV4dC52YWxpZGF0ZVBhdGgoKTtcclxuICAgICAgICByZXR1cm4gY29udGV4dDtcclxuICAgIH07XHJcbiAgICBQYXJzZUNvbnRleHQucHJvdG90eXBlLmNoaWxkQ29udGV4dEZvckFycmF5ID0gZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogV2UgZG9uJ3Qgc3VwcG9ydCBhcnJheSBwYXRocyByaWdodCBub3c7IHNvIG1ha2UgcGF0aFxyXG4gICAgICAgIC8vIG51bGwuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQYXJzZUNvbnRleHQodGhpcy5kYXRhU291cmNlLCB0aGlzLm1ldGhvZE5hbWUsIFxyXG4gICAgICAgIC8qcGF0aD0qLyBudWxsLCBcclxuICAgICAgICAvKmFycmF5RWxlbWVudD0qLyB0cnVlLCB0aGlzLmZpZWxkVHJhbnNmb3JtcywgdGhpcy5maWVsZE1hc2spO1xyXG4gICAgfTtcclxuICAgIFBhcnNlQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlRXJyb3IgPSBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgdmFyIGZpZWxkRGVzY3JpcHRpb24gPSB0aGlzLnBhdGggPT09IG51bGwgfHwgdGhpcy5wYXRoLmlzRW1wdHkoKVxyXG4gICAgICAgICAgICA/ICcnXHJcbiAgICAgICAgICAgIDogXCIgKGZvdW5kIGluIGZpZWxkIFwiICsgdGhpcy5wYXRoLnRvU3RyaW5nKCkgKyBcIilcIjtcclxuICAgICAgICByZXR1cm4gbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIHRoaXMubWV0aG9kTmFtZSArIFwiKCkgY2FsbGVkIHdpdGggaW52YWxpZCBkYXRhLiBcIiArXHJcbiAgICAgICAgICAgIHJlYXNvbiArXHJcbiAgICAgICAgICAgIGZpZWxkRGVzY3JpcHRpb24pO1xyXG4gICAgfTtcclxuICAgIC8qKiBSZXR1cm5zICd0cnVlJyBpZiAnZmllbGRQYXRoJyB3YXMgdHJhdmVyc2VkIHdoZW4gY3JlYXRpbmcgdGhpcyBjb250ZXh0LiAqL1xyXG4gICAgUGFyc2VDb250ZXh0LnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uIChmaWVsZFBhdGgpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuZmllbGRNYXNrLmZpbmQoZnVuY3Rpb24gKGZpZWxkKSB7IHJldHVybiBmaWVsZFBhdGguaXNQcmVmaXhPZihmaWVsZCk7IH0pICE9PSB1bmRlZmluZWQgfHxcclxuICAgICAgICAgICAgdGhpcy5maWVsZFRyYW5zZm9ybXMuZmluZChmdW5jdGlvbiAodHJhbnNmb3JtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmllbGRQYXRoLmlzUHJlZml4T2YodHJhbnNmb3JtLmZpZWxkKTtcclxuICAgICAgICAgICAgfSkgIT09IHVuZGVmaW5lZCk7XHJcbiAgICB9O1xyXG4gICAgUGFyc2VDb250ZXh0LnByb3RvdHlwZS52YWxpZGF0ZVBhdGggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogUmVtb3ZlIG51bGwgY2hlY2sgb25jZSB3ZSBoYXZlIHByb3BlciBwYXRocyBmb3IgZmllbGRzXHJcbiAgICAgICAgLy8gd2l0aGluIGFycmF5cy5cclxuICAgICAgICBpZiAodGhpcy5wYXRoID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBhdGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZVBhdGhTZWdtZW50KHRoaXMucGF0aC5nZXQoaSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQYXJzZUNvbnRleHQucHJvdG90eXBlLnZhbGlkYXRlUGF0aFNlZ21lbnQgPSBmdW5jdGlvbiAoc2VnbWVudCkge1xyXG4gICAgICAgIGlmIChpc1dyaXRlKHRoaXMuZGF0YVNvdXJjZSkgJiYgUkVTRVJWRURfRklFTERfUkVHRVgudGVzdChzZWdtZW50KSkge1xyXG4gICAgICAgICAgICB0aHJvdyB0aGlzLmNyZWF0ZUVycm9yKCdEb2N1bWVudCBmaWVsZHMgY2Fubm90IGJlZ2luIGFuZCBlbmQgd2l0aCBfXycpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gUGFyc2VDb250ZXh0O1xyXG59KCkpO1xyXG4vKipcclxuICogQSBwbGFjZWhvbGRlciBvYmplY3QgZm9yIERvY3VtZW50UmVmZXJlbmNlcyBpbiB0aGlzIGZpbGUsIGluIG9yZGVyIHRvXHJcbiAqIGF2b2lkIGEgY2lyY3VsYXIgZGVwZW5kZW5jeS4gU2VlIHRoZSBjb21tZW50cyBmb3IgYERhdGFQcmVDb252ZXJ0ZXJgIGZvclxyXG4gKiB0aGUgZnVsbCBjb250ZXh0LlxyXG4gKi9cclxudmFyIERvY3VtZW50S2V5UmVmZXJlbmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRLZXlSZWZlcmVuY2UoZGF0YWJhc2VJZCwga2V5KSB7XHJcbiAgICAgICAgdGhpcy5kYXRhYmFzZUlkID0gZGF0YWJhc2VJZDtcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgIH1cclxuICAgIHJldHVybiBEb2N1bWVudEtleVJlZmVyZW5jZTtcclxufSgpKTtcclxuLyoqXHJcbiAqIEhlbHBlciBmb3IgcGFyc2luZyByYXcgdXNlciBpbnB1dCAocHJvdmlkZWQgdmlhIHRoZSBBUEkpIGludG8gaW50ZXJuYWwgbW9kZWxcclxuICogY2xhc3Nlcy5cclxuICovXHJcbnZhciBVc2VyRGF0YUNvbnZlcnRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFVzZXJEYXRhQ29udmVydGVyKHByZUNvbnZlcnRlcikge1xyXG4gICAgICAgIHRoaXMucHJlQ29udmVydGVyID0gcHJlQ29udmVydGVyO1xyXG4gICAgfVxyXG4gICAgLyoqIFBhcnNlIGRvY3VtZW50IGRhdGEgZnJvbSBhIG5vbi1tZXJnZSBzZXQoKSBjYWxsLiAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlU2V0RGF0YSA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCBpbnB1dCkge1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0gbmV3IFBhcnNlQ29udGV4dChVc2VyRGF0YVNvdXJjZS5TZXQsIG1ldGhvZE5hbWUsIEZpZWxkUGF0aC5FTVBUWV9QQVRIKTtcclxuICAgICAgICB2YWxpZGF0ZVBsYWluT2JqZWN0KCdEYXRhIG11c3QgYmUgYW4gb2JqZWN0LCBidXQgaXQgd2FzOicsIGNvbnRleHQsIGlucHV0KTtcclxuICAgICAgICB2YXIgdXBkYXRlRGF0YSA9IHRoaXMucGFyc2VEYXRhKGlucHV0LCBjb250ZXh0KTtcclxuICAgICAgICByZXR1cm4gbmV3IFBhcnNlZFNldERhdGEodXBkYXRlRGF0YSwgXHJcbiAgICAgICAgLyogZmllbGRNYXNrPSAqLyBudWxsLCBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFBhcnNlIGRvY3VtZW50IGRhdGEgZnJvbSBhIHNldCgpIGNhbGwgd2l0aCAne21lcmdlOnRydWV9Jy4gKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZU1lcmdlRGF0YSA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCBpbnB1dCwgZmllbGRQYXRocykge1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0gbmV3IFBhcnNlQ29udGV4dChVc2VyRGF0YVNvdXJjZS5NZXJnZVNldCwgbWV0aG9kTmFtZSwgRmllbGRQYXRoLkVNUFRZX1BBVEgpO1xyXG4gICAgICAgIHZhbGlkYXRlUGxhaW5PYmplY3QoJ0RhdGEgbXVzdCBiZSBhbiBvYmplY3QsIGJ1dCBpdCB3YXM6JywgY29udGV4dCwgaW5wdXQpO1xyXG4gICAgICAgIHZhciB1cGRhdGVEYXRhID0gdGhpcy5wYXJzZURhdGEoaW5wdXQsIGNvbnRleHQpO1xyXG4gICAgICAgIHZhciBmaWVsZE1hc2s7XHJcbiAgICAgICAgdmFyIGZpZWxkVHJhbnNmb3JtcztcclxuICAgICAgICBpZiAoIWZpZWxkUGF0aHMpIHtcclxuICAgICAgICAgICAgZmllbGRNYXNrID0gbmV3IEZpZWxkTWFzayhjb250ZXh0LmZpZWxkTWFzayk7XHJcbiAgICAgICAgICAgIGZpZWxkVHJhbnNmb3JtcyA9IGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHZhbGlkYXRlZEZpZWxkUGF0aHMgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBmaWVsZFBhdGhzXzEgPSBmaWVsZFBhdGhzOyBfaSA8IGZpZWxkUGF0aHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHJpbmdPckZpZWxkUGF0aCA9IGZpZWxkUGF0aHNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgZmllbGRQYXRoID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0cmluZ09yRmllbGRQYXRoIGluc3RhbmNlb2YgRmllbGRQYXRoJDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZFBhdGggPSBzdHJpbmdPckZpZWxkUGF0aC5faW50ZXJuYWxQYXRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHN0cmluZ09yRmllbGRQYXRoID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkUGF0aCA9IGZpZWxkUGF0aEZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcobWV0aG9kTmFtZSwgc3RyaW5nT3JGaWVsZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZmFpbCgnRXhwZWN0ZWQgc3RyaW5nT3JGaWVsZFBhdGggdG8gYmUgYSBzdHJpbmcgb3IgYSBGaWVsZFBhdGgnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghY29udGV4dC5jb250YWlucyhmaWVsZFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGaWVsZCAnXCIgKyBmaWVsZFBhdGggKyBcIicgaXMgc3BlY2lmaWVkIGluIHlvdXIgZmllbGQgbWFzayBidXQgbWlzc2luZyBmcm9tIHlvdXIgaW5wdXQgZGF0YS5cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZWRGaWVsZFBhdGhzLnB1c2goZmllbGRQYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmaWVsZE1hc2sgPSBuZXcgRmllbGRNYXNrKHZhbGlkYXRlZEZpZWxkUGF0aHMpO1xyXG4gICAgICAgICAgICBmaWVsZFRyYW5zZm9ybXMgPSBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcy5maWx0ZXIoZnVuY3Rpb24gKHRyYW5zZm9ybSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpZWxkTWFzay5jb3ZlcnModHJhbnNmb3JtLmZpZWxkKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgUGFyc2VkU2V0RGF0YSh1cGRhdGVEYXRhLCBmaWVsZE1hc2ssIGZpZWxkVHJhbnNmb3Jtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFBhcnNlIHVwZGF0ZSBkYXRhIGZyb20gYW4gdXBkYXRlKCkgY2FsbC4gKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZVVwZGF0ZURhdGEgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgaW5wdXQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0gbmV3IFBhcnNlQ29udGV4dChVc2VyRGF0YVNvdXJjZS5VcGRhdGUsIG1ldGhvZE5hbWUsIEZpZWxkUGF0aC5FTVBUWV9QQVRIKTtcclxuICAgICAgICB2YWxpZGF0ZVBsYWluT2JqZWN0KCdEYXRhIG11c3QgYmUgYW4gb2JqZWN0LCBidXQgaXQgd2FzOicsIGNvbnRleHQsIGlucHV0KTtcclxuICAgICAgICB2YXIgZmllbGRNYXNrUGF0aHMgPSBbXTtcclxuICAgICAgICB2YXIgdXBkYXRlRGF0YSA9IE9iamVjdFZhbHVlLkVNUFRZO1xyXG4gICAgICAgIGZvckVhY2goaW5wdXQsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gZmllbGRQYXRoRnJvbURvdFNlcGFyYXRlZFN0cmluZyhtZXRob2ROYW1lLCBrZXkpO1xyXG4gICAgICAgICAgICB2YXIgY2hpbGRDb250ZXh0ID0gY29udGV4dC5jaGlsZENvbnRleHRGb3JGaWVsZFBhdGgocGF0aCk7XHJcbiAgICAgICAgICAgIHZhbHVlID0gX3RoaXMucnVuUHJlQ29udmVydGVyKHZhbHVlLCBjaGlsZENvbnRleHQpO1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEZWxldGVGaWVsZFZhbHVlSW1wbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSBmaWVsZCBtYXNrLCBidXQgZG9uJ3QgYWRkIGFueXRoaW5nIHRvIHVwZGF0ZURhdGEuXHJcbiAgICAgICAgICAgICAgICBmaWVsZE1hc2tQYXRocy5wdXNoKHBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcnNlZFZhbHVlID0gX3RoaXMucGFyc2VEYXRhKHZhbHVlLCBjaGlsZENvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlZFZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZE1hc2tQYXRocy5wdXNoKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZURhdGEgPSB1cGRhdGVEYXRhLnNldChwYXRoLCBwYXJzZWRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgbWFzayA9IG5ldyBGaWVsZE1hc2soZmllbGRNYXNrUGF0aHMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUGFyc2VkVXBkYXRlRGF0YSh1cGRhdGVEYXRhLCBtYXNrLCBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqIFBhcnNlIHVwZGF0ZSBkYXRhIGZyb20gYSBsaXN0IG9mIGZpZWxkL3ZhbHVlIGFyZ3VtZW50cy4gKi9cclxuICAgIFVzZXJEYXRhQ29udmVydGVyLnByb3RvdHlwZS5wYXJzZVVwZGF0ZVZhcmFyZ3MgPSBmdW5jdGlvbiAobWV0aG9kTmFtZSwgZmllbGQsIHZhbHVlLCBtb3JlRmllbGRzQW5kVmFsdWVzKSB7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgUGFyc2VDb250ZXh0KFVzZXJEYXRhU291cmNlLlVwZGF0ZSwgbWV0aG9kTmFtZSwgRmllbGRQYXRoLkVNUFRZX1BBVEgpO1xyXG4gICAgICAgIHZhciBrZXlzID0gW2ZpZWxkUGF0aEZyb21Bcmd1bWVudChtZXRob2ROYW1lLCBmaWVsZCldO1xyXG4gICAgICAgIHZhciB2YWx1ZXMkJDEgPSBbdmFsdWVdO1xyXG4gICAgICAgIGlmIChtb3JlRmllbGRzQW5kVmFsdWVzLmxlbmd0aCAlIDIgIT09IDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIG1ldGhvZE5hbWUgKyBcIigpIG5lZWRzIHRvIGJlIGNhbGxlZCB3aXRoIGFuIGV2ZW4gbnVtYmVyIFwiICtcclxuICAgICAgICAgICAgICAgICdvZiBhcmd1bWVudHMgdGhhdCBhbHRlcm5hdGUgYmV0d2VlbiBmaWVsZCBuYW1lcyBhbmQgdmFsdWVzLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vcmVGaWVsZHNBbmRWYWx1ZXMubGVuZ3RoOyBpICs9IDIpIHtcclxuICAgICAgICAgICAga2V5cy5wdXNoKGZpZWxkUGF0aEZyb21Bcmd1bWVudChtZXRob2ROYW1lLCBtb3JlRmllbGRzQW5kVmFsdWVzW2ldKSk7XHJcbiAgICAgICAgICAgIHZhbHVlcyQkMS5wdXNoKG1vcmVGaWVsZHNBbmRWYWx1ZXNbaSArIDFdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGZpZWxkTWFza1BhdGhzID0gW107XHJcbiAgICAgICAgdmFyIHVwZGF0ZURhdGEgPSBPYmplY3RWYWx1ZS5FTVBUWTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSBrZXlzW2ldO1xyXG4gICAgICAgICAgICB2YXIgY2hpbGRDb250ZXh0ID0gY29udGV4dC5jaGlsZENvbnRleHRGb3JGaWVsZFBhdGgocGF0aCk7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZV8xID0gdGhpcy5ydW5QcmVDb252ZXJ0ZXIodmFsdWVzJCQxW2ldLCBjaGlsZENvbnRleHQpO1xyXG4gICAgICAgICAgICBpZiAodmFsdWVfMSBpbnN0YW5jZW9mIERlbGV0ZUZpZWxkVmFsdWVJbXBsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGZpZWxkIG1hc2ssIGJ1dCBkb24ndCBhZGQgYW55dGhpbmcgdG8gdXBkYXRlRGF0YS5cclxuICAgICAgICAgICAgICAgIGZpZWxkTWFza1BhdGhzLnB1c2gocGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyc2VkVmFsdWUgPSB0aGlzLnBhcnNlRGF0YSh2YWx1ZV8xLCBjaGlsZENvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlZFZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZE1hc2tQYXRocy5wdXNoKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZURhdGEgPSB1cGRhdGVEYXRhLnNldChwYXRoLCBwYXJzZWRWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1hc2sgPSBuZXcgRmllbGRNYXNrKGZpZWxkTWFza1BhdGhzKTtcclxuICAgICAgICByZXR1cm4gbmV3IFBhcnNlZFVwZGF0ZURhdGEodXBkYXRlRGF0YSwgbWFzaywgY29udGV4dC5maWVsZFRyYW5zZm9ybXMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGFyc2UgYSBcInF1ZXJ5IHZhbHVlXCIgKGUuZy4gdmFsdWUgaW4gYSB3aGVyZSBmaWx0ZXIgb3IgYSB2YWx1ZSBpbiBhIGN1cnNvclxyXG4gICAgICogYm91bmQpLlxyXG4gICAgICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VRdWVyeVZhbHVlID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGlucHV0KSB7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgUGFyc2VDb250ZXh0KFVzZXJEYXRhU291cmNlLkFyZ3VtZW50LCBtZXRob2ROYW1lLCBGaWVsZFBhdGguRU1QVFlfUEFUSCk7XHJcbiAgICAgICAgdmFyIHBhcnNlZCA9IHRoaXMucGFyc2VEYXRhKGlucHV0LCBjb250ZXh0KTtcclxuICAgICAgICBhc3NlcnQocGFyc2VkICE9IG51bGwsICdQYXJzZWQgZGF0YSBzaG91bGQgbm90IGJlIG51bGwuJyk7XHJcbiAgICAgICAgYXNzZXJ0KGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLmxlbmd0aCA9PT0gMCwgJ0ZpZWxkIHRyYW5zZm9ybXMgc2hvdWxkIGhhdmUgYmVlbiBkaXNhbGxvd2VkLicpO1xyXG4gICAgICAgIHJldHVybiBwYXJzZWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqIFNlbmRzIGRhdGEgdGhyb3VnaCB0aGlzLnByZUNvbnZlcnRlciwgaGFuZGxpbmcgYW55IHRocm93biBlcnJvcnMuICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucnVuUHJlQ29udmVydGVyID0gZnVuY3Rpb24gKGlucHV0LCBjb250ZXh0KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJlQ29udmVydGVyKGlucHV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UoZSk7XHJcbiAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IobWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJuYWwgaGVscGVyIGZvciBwYXJzaW5nIHVzZXIgZGF0YS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgRGF0YSB0byBiZSBwYXJzZWQuXHJcbiAgICAgKiBAcGFyYW0gY29udGV4dCBBIGNvbnRleHQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBwYXRoIGJlaW5nIHBhcnNlZCxcclxuICAgICAqIHRoZSBzb3VyY2Ugb2YgdGhlIGRhdGEgYmVpbmcgcGFyc2VkLCBldGMuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBwYXJzZWQgdmFsdWUsIG9yIG51bGwgaWYgdGhlIHZhbHVlIHdhcyBhIEZpZWxkVmFsdWUgc2VudGluZWxcclxuICAgICAqIHRoYXQgc2hvdWxkIG5vdCBiZSBpbmNsdWRlZCBpbiB0aGUgcmVzdWx0aW5nIHBhcnNlZCBkYXRhLlxyXG4gICAgICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VEYXRhID0gZnVuY3Rpb24gKGlucHV0LCBjb250ZXh0KSB7XHJcbiAgICAgICAgaW5wdXQgPSB0aGlzLnJ1blByZUNvbnZlcnRlcihpbnB1dCwgY29udGV4dCk7XHJcbiAgICAgICAgaWYgKGxvb2tzTGlrZUpzb25PYmplY3QoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlUGxhaW5PYmplY3QoJ1Vuc3VwcG9ydGVkIGZpZWxkIHZhbHVlOicsIGNvbnRleHQsIGlucHV0KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VPYmplY3QoaW5wdXQsIGNvbnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIEZpZWxkVmFsdWVJbXBsKSB7XHJcbiAgICAgICAgICAgIC8vIEZpZWxkVmFsdWVzIHVzdWFsbHkgcGFyc2UgaW50byB0cmFuc2Zvcm1zIChleGNlcHQgRmllbGRWYWx1ZS5kZWxldGUoKSlcclxuICAgICAgICAgICAgLy8gaW4gd2hpY2ggY2FzZSB3ZSBkbyBub3Qgd2FudCB0byBpbmNsdWRlIHRoaXMgZmllbGQgaW4gb3VyIHBhcnNlZCBkYXRhXHJcbiAgICAgICAgICAgIC8vIChhcyBkb2luZyBzbyB3aWxsIG92ZXJ3cml0ZSB0aGUgZmllbGQgZGlyZWN0bHkgcHJpb3IgdG8gdGhlIHRyYW5zZm9ybVxyXG4gICAgICAgICAgICAvLyB0cnlpbmcgdG8gdHJhbnNmb3JtIGl0KS4gU28gd2UgZG9uJ3QgYWRkIHRoaXMgbG9jYXRpb24gdG9cclxuICAgICAgICAgICAgLy8gY29udGV4dC5maWVsZE1hc2sgYW5kIHdlIHJldHVybiBudWxsIGFzIG91ciBwYXJzaW5nIHJlc3VsdC5cclxuICAgICAgICAgICAgdGhpcy5wYXJzZVNlbnRpbmVsRmllbGRWYWx1ZShpbnB1dCwgY29udGV4dCk7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSWYgY29udGV4dC5wYXRoIGlzIG51bGwgd2UgYXJlIGluc2lkZSBhbiBhcnJheSBhbmQgd2UgZG9uJ3Qgc3VwcG9ydFxyXG4gICAgICAgICAgICAvLyBmaWVsZCBtYXNrIHBhdGhzIG1vcmUgZ3JhbnVsYXIgdGhhbiB0aGUgdG9wLWxldmVsIGFycmF5LlxyXG4gICAgICAgICAgICBpZiAoY29udGV4dC5wYXRoKSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpZWxkTWFzay5wdXNoKGNvbnRleHQucGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGlucHV0IGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYi8zNDg3MTEzMSk6IEluY2x1ZGUgdGhlIHBhdGggY29udGFpbmluZyB0aGUgYXJyYXkgaW4gdGhlIGVycm9yXHJcbiAgICAgICAgICAgICAgICAvLyBtZXNzYWdlLlxyXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRleHQuYXJyYXlFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcignTmVzdGVkIGFycmF5cyBhcmUgbm90IHN1cHBvcnRlZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VBcnJheShpbnB1dCwgY29udGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZVNjYWxhclZhbHVlKGlucHV0LCBjb250ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VPYmplY3QgPSBmdW5jdGlvbiAob2JqLCBjb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFNvcnRlZE1hcChwcmltaXRpdmVDb21wYXJhdG9yKTtcclxuICAgICAgICBpZiAoaXNFbXB0eShvYmopKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHdlIGVuY291bnRlciBhbiBlbXB0eSBvYmplY3QsIHdlIGV4cGxpY2l0bHkgYWRkIGl0IHRvIHRoZSB1cGRhdGVcclxuICAgICAgICAgICAgLy8gbWFzayB0byBlbnN1cmUgdGhhdCB0aGUgc2VydmVyIGNyZWF0ZXMgYSBtYXAgZW50cnkuXHJcbiAgICAgICAgICAgIGlmIChjb250ZXh0LnBhdGggJiYgY29udGV4dC5wYXRoLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmllbGRNYXNrLnB1c2goY29udGV4dC5wYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yRWFjaChvYmosIGZ1bmN0aW9uIChrZXksIHZhbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcnNlZFZhbHVlID0gX3RoaXMucGFyc2VEYXRhKHZhbCwgY29udGV4dC5jaGlsZENvbnRleHRGb3JGaWVsZChrZXkpKTtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJzZWRWYWx1ZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0Lmluc2VydChrZXksIHBhcnNlZFZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgT2JqZWN0VmFsdWUocmVzdWx0KTtcclxuICAgIH07XHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VBcnJheSA9IGZ1bmN0aW9uIChhcnJheSwgY29udGV4dCkge1xyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICB2YXIgZW50cnlJbmRleCA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhcnJheV8xID0gYXJyYXk7IF9pIDwgYXJyYXlfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGVudHJ5ID0gYXJyYXlfMVtfaV07XHJcbiAgICAgICAgICAgIHZhciBwYXJzZWRFbnRyeSA9IHRoaXMucGFyc2VEYXRhKGVudHJ5LCBjb250ZXh0LmNoaWxkQ29udGV4dEZvckFycmF5KGVudHJ5SW5kZXgpKTtcclxuICAgICAgICAgICAgaWYgKHBhcnNlZEVudHJ5ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIEp1c3QgaW5jbHVkZSBudWxscyBpbiB0aGUgYXJyYXkgZm9yIGZpZWxkcyBiZWluZyByZXBsYWNlZCB3aXRoIGFcclxuICAgICAgICAgICAgICAgIC8vIHNlbnRpbmVsLlxyXG4gICAgICAgICAgICAgICAgcGFyc2VkRW50cnkgPSBOdWxsVmFsdWUuSU5TVEFOQ0U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzdWx0LnB1c2gocGFyc2VkRW50cnkpO1xyXG4gICAgICAgICAgICBlbnRyeUluZGV4Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgQXJyYXlWYWx1ZShyZXN1bHQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogXCJQYXJzZXNcIiB0aGUgcHJvdmlkZWQgRmllbGRWYWx1ZUltcGwsIGFkZGluZyBhbnkgbmVjZXNzYXJ5IHRyYW5zZm9ybXMgdG9cclxuICAgICAqIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLlxyXG4gICAgICovXHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VTZW50aW5lbEZpZWxkVmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIGNvbnRleHQpIHtcclxuICAgICAgICAvLyBTZW50aW5lbHMgYXJlIG9ubHkgc3VwcG9ydGVkIHdpdGggd3JpdGVzLCBhbmQgbm90IHdpdGhpbiBhcnJheXMuXHJcbiAgICAgICAgaWYgKCFpc1dyaXRlKGNvbnRleHQuZGF0YVNvdXJjZSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcih2YWx1ZS5fbWV0aG9kTmFtZSArIFwiKCkgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIHVwZGF0ZSgpIGFuZCBzZXQoKVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvbnRleHQucGF0aCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKHZhbHVlLl9tZXRob2ROYW1lICsgXCIoKSBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBpbnNpZGUgYXJyYXlzXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEZWxldGVGaWVsZFZhbHVlSW1wbCkge1xyXG4gICAgICAgICAgICBpZiAoY29udGV4dC5kYXRhU291cmNlID09PSBVc2VyRGF0YVNvdXJjZS5NZXJnZVNldCkge1xyXG4gICAgICAgICAgICAgICAgLy8gTm8gdHJhbnNmb3JtIHRvIGFkZCBmb3IgYSBkZWxldGUsIGJ1dCB3ZSBuZWVkIHRvIGFkZCBpdCB0byBvdXJcclxuICAgICAgICAgICAgICAgIC8vIGZpZWxkTWFzayBzbyBpdCBnZXRzIGRlbGV0ZWQuXHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpZWxkTWFzay5wdXNoKGNvbnRleHQucGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY29udGV4dC5kYXRhU291cmNlID09PSBVc2VyRGF0YVNvdXJjZS5VcGRhdGUpIHtcclxuICAgICAgICAgICAgICAgIGFzc2VydChjb250ZXh0LnBhdGgubGVuZ3RoID4gMCwgJ0ZpZWxkVmFsdWUuZGVsZXRlKCkgYXQgdGhlIHRvcCBsZXZlbCBzaG91bGQgaGF2ZSBhbHJlYWR5JyArXHJcbiAgICAgICAgICAgICAgICAgICAgJyBiZWVuIGhhbmRsZWQuJyk7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKCdGaWVsZFZhbHVlLmRlbGV0ZSgpIGNhbiBvbmx5IGFwcGVhciBhdCB0aGUgdG9wIGxldmVsICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICdvZiB5b3VyIHVwZGF0ZSBkYXRhJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBXZSBzaG91bGRuJ3QgZW5jb3VudGVyIGRlbGV0ZSBzZW50aW5lbHMgZm9yIHF1ZXJpZXMgb3Igbm9uLW1lcmdlIHNldCgpIGNhbGxzLlxyXG4gICAgICAgICAgICAgICAgdGhyb3cgY29udGV4dC5jcmVhdGVFcnJvcignRmllbGRWYWx1ZS5kZWxldGUoKSBjYW5ub3QgYmUgdXNlZCB3aXRoIHNldCgpIHVubGVzcyB5b3UgcGFzcyAnICtcclxuICAgICAgICAgICAgICAgICAgICAne21lcmdlOnRydWV9Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBTZXJ2ZXJUaW1lc3RhbXBGaWVsZFZhbHVlSW1wbCkge1xyXG4gICAgICAgICAgICBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcy5wdXNoKG5ldyBGaWVsZFRyYW5zZm9ybShjb250ZXh0LnBhdGgsIFNlcnZlclRpbWVzdGFtcFRyYW5zZm9ybS5pbnN0YW5jZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5VW5pb25GaWVsZFZhbHVlSW1wbCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyc2VkRWxlbWVudHMgPSB0aGlzLnBhcnNlQXJyYXlUcmFuc2Zvcm1FbGVtZW50cyh2YWx1ZS5fbWV0aG9kTmFtZSwgdmFsdWUuX2VsZW1lbnRzKTtcclxuICAgICAgICAgICAgdmFyIGFycmF5VW5pb24gPSBuZXcgQXJyYXlVbmlvblRyYW5zZm9ybU9wZXJhdGlvbihwYXJzZWRFbGVtZW50cyk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLnB1c2gobmV3IEZpZWxkVHJhbnNmb3JtKGNvbnRleHQucGF0aCwgYXJyYXlVbmlvbikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5UmVtb3ZlRmllbGRWYWx1ZUltcGwpIHtcclxuICAgICAgICAgICAgdmFyIHBhcnNlZEVsZW1lbnRzID0gdGhpcy5wYXJzZUFycmF5VHJhbnNmb3JtRWxlbWVudHModmFsdWUuX21ldGhvZE5hbWUsIHZhbHVlLl9lbGVtZW50cyk7XHJcbiAgICAgICAgICAgIHZhciBhcnJheVJlbW92ZSA9IG5ldyBBcnJheVJlbW92ZVRyYW5zZm9ybU9wZXJhdGlvbihwYXJzZWRFbGVtZW50cyk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLnB1c2gobmV3IEZpZWxkVHJhbnNmb3JtKGNvbnRleHQucGF0aCwgYXJyYXlSZW1vdmUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZhaWwoJ1Vua25vd24gRmllbGRWYWx1ZSB0eXBlOiAnICsgdmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEhlbHBlciB0byBwYXJzZSBhIHNjYWxhciB2YWx1ZSAoaS5lLiBub3QgYW4gT2JqZWN0LCBBcnJheSwgb3IgRmllbGRWYWx1ZSlcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBwYXJzZWQgdmFsdWVcclxuICAgICAqL1xyXG4gICAgVXNlckRhdGFDb252ZXJ0ZXIucHJvdG90eXBlLnBhcnNlU2NhbGFyVmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIGNvbnRleHQpIHtcclxuICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE51bGxWYWx1ZS5JTlNUQU5DRTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgICAgICAgICBpZiAoaXNTYWZlSW50ZWdlcih2YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgSW50ZWdlclZhbHVlKHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG91YmxlVmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBCb29sZWFuVmFsdWUub2YodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nVmFsdWUodmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUaW1lc3RhbXBWYWx1ZShUaW1lc3RhbXAuZnJvbURhdGUodmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBUaW1lc3RhbXApIHtcclxuICAgICAgICAgICAgLy8gRmlyZXN0b3JlIGJhY2tlbmQgdHJ1bmNhdGVzIHByZWNpc2lvbiBkb3duIHRvIG1pY3Jvc2Vjb25kcy4gVG8gZW5zdXJlXHJcbiAgICAgICAgICAgIC8vIG9mZmxpbmUgbW9kZSB3b3JrcyB0aGUgc2FtZSB3aXRoIHJlZ2FyZHMgdG8gdHJ1bmNhdGlvbiwgcGVyZm9ybSB0aGVcclxuICAgICAgICAgICAgLy8gdHJ1bmNhdGlvbiBpbW1lZGlhdGVseSB3aXRob3V0IHdhaXRpbmcgZm9yIHRoZSBiYWNrZW5kIHRvIGRvIHRoYXQuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVGltZXN0YW1wVmFsdWUobmV3IFRpbWVzdGFtcCh2YWx1ZS5zZWNvbmRzLCBNYXRoLmZsb29yKHZhbHVlLm5hbm9zZWNvbmRzIC8gMTAwMCkgKiAxMDAwKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgR2VvUG9pbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW9Qb2ludFZhbHVlKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBCbG9iKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYlZhbHVlKHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBEb2N1bWVudEtleVJlZmVyZW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFJlZlZhbHVlKHZhbHVlLmRhdGFiYXNlSWQsIHZhbHVlLmtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKFwiVW5zdXBwb3J0ZWQgZmllbGQgdmFsdWU6IFwiICsgdmFsdWVEZXNjcmlwdGlvbih2YWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBVc2VyRGF0YUNvbnZlcnRlci5wcm90b3R5cGUucGFyc2VBcnJheVRyYW5zZm9ybUVsZW1lbnRzID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGVsZW1lbnRzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gZWxlbWVudHMubWFwKGZ1bmN0aW9uIChlbGVtZW50LCBpKSB7XHJcbiAgICAgICAgICAgIC8vIEFsdGhvdWdoIGFycmF5IHRyYW5zZm9ybXMgYXJlIHVzZWQgd2l0aCB3cml0ZXMsIHRoZSBhY3R1YWwgZWxlbWVudHNcclxuICAgICAgICAgICAgLy8gYmVpbmcgdW5pb25lZCBvciByZW1vdmVkIGFyZSBub3QgY29uc2lkZXJlZCB3cml0ZXMgc2luY2UgdGhleSBjYW5ub3RcclxuICAgICAgICAgICAgLy8gY29udGFpbiBhbnkgRmllbGRWYWx1ZSBzZW50aW5lbHMsIGV0Yy5cclxuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBuZXcgUGFyc2VDb250ZXh0KFVzZXJEYXRhU291cmNlLkFyZ3VtZW50LCBtZXRob2ROYW1lLCBGaWVsZFBhdGguRU1QVFlfUEFUSCk7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcy5wYXJzZURhdGEoZWxlbWVudCwgY29udGV4dC5jaGlsZENvbnRleHRGb3JBcnJheShpKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFVzZXJEYXRhQ29udmVydGVyO1xyXG59KCkpO1xyXG4vKipcclxuICogQ2hlY2tzIHdoZXRoZXIgYW4gb2JqZWN0IGxvb2tzIGxpa2UgYSBKU09OIG9iamVjdCB0aGF0IHNob3VsZCBiZSBjb252ZXJ0ZWRcclxuICogaW50byBhIHN0cnVjdC4gTm9ybWFsIGNsYXNzL3Byb3RvdHlwZSBpbnN0YW5jZXMgYXJlIGNvbnNpZGVyZWQgdG8gbG9vayBsaWtlXHJcbiAqIEpTT04gb2JqZWN0cyBzaW5jZSB0aGV5IHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gYSBzdHJ1Y3QgdmFsdWUuIEFycmF5cywgRGF0ZXMsXHJcbiAqIEdlb1BvaW50cywgZXRjLiBhcmUgbm90IGNvbnNpZGVyZWQgdG8gbG9vayBsaWtlIEpTT04gb2JqZWN0cyBzaW5jZSB0aGV5IG1hcFxyXG4gKiB0byBzcGVjaWZpYyBGaWVsZFZhbHVlIHR5cGVzIG90aGVyIHRoYW4gT2JqZWN0VmFsdWUuXHJcbiAqL1xyXG5mdW5jdGlvbiBsb29rc0xpa2VKc29uT2JqZWN0KGlucHV0KSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcgJiZcclxuICAgICAgICBpbnB1dCAhPT0gbnVsbCAmJlxyXG4gICAgICAgICEoaW5wdXQgaW5zdGFuY2VvZiBBcnJheSkgJiZcclxuICAgICAgICAhKGlucHV0IGluc3RhbmNlb2YgRGF0ZSkgJiZcclxuICAgICAgICAhKGlucHV0IGluc3RhbmNlb2YgVGltZXN0YW1wKSAmJlxyXG4gICAgICAgICEoaW5wdXQgaW5zdGFuY2VvZiBHZW9Qb2ludCkgJiZcclxuICAgICAgICAhKGlucHV0IGluc3RhbmNlb2YgQmxvYikgJiZcclxuICAgICAgICAhKGlucHV0IGluc3RhbmNlb2YgRG9jdW1lbnRLZXlSZWZlcmVuY2UpICYmXHJcbiAgICAgICAgIShpbnB1dCBpbnN0YW5jZW9mIEZpZWxkVmFsdWVJbXBsKSk7XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVQbGFpbk9iamVjdChtZXNzYWdlLCBjb250ZXh0LCBpbnB1dCkge1xyXG4gICAgaWYgKCFsb29rc0xpa2VKc29uT2JqZWN0KGlucHV0KSB8fCAhaXNQbGFpbk9iamVjdChpbnB1dCkpIHtcclxuICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSB2YWx1ZURlc2NyaXB0aW9uKGlucHV0KTtcclxuICAgICAgICBpZiAoZGVzY3JpcHRpb24gPT09ICdhbiBvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIC8vIE1hc3NhZ2UgdGhlIGVycm9yIGlmIGl0IHdhcyBhbiBvYmplY3QuXHJcbiAgICAgICAgICAgIHRocm93IGNvbnRleHQuY3JlYXRlRXJyb3IobWVzc2FnZSArICcgYSBjdXN0b20gb2JqZWN0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBjb250ZXh0LmNyZWF0ZUVycm9yKG1lc3NhZ2UgKyAnICcgKyBkZXNjcmlwdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdGhhdCBjYWxscyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKCkgYnV0IHdyYXBzIGFueSBlcnJvciB0aHJvd24uXHJcbiAqL1xyXG5mdW5jdGlvbiBmaWVsZFBhdGhGcm9tQXJndW1lbnQobWV0aG9kTmFtZSwgcGF0aCkge1xyXG4gICAgaWYgKHBhdGggaW5zdGFuY2VvZiBGaWVsZFBhdGgkMSkge1xyXG4gICAgICAgIHJldHVybiBwYXRoLl9pbnRlcm5hbFBhdGg7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0eXBlb2YgcGF0aCA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICByZXR1cm4gZmllbGRQYXRoRnJvbURvdFNlcGFyYXRlZFN0cmluZyhtZXRob2ROYW1lLCBwYXRoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHZhciBtZXNzYWdlID0gJ0ZpZWxkIHBhdGggYXJndW1lbnRzIG11c3QgYmUgb2YgdHlwZSBzdHJpbmcgb3IgRmllbGRQYXRoLic7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIG1ldGhvZE5hbWUgKyBcIigpIGNhbGxlZCB3aXRoIGludmFsaWQgZGF0YS4gXCIgKyBtZXNzYWdlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogV3JhcHMgZnJvbURvdFNlcGFyYXRlZFN0cmluZyB3aXRoIGFuIGVycm9yIG1lc3NhZ2UgYWJvdXQgdGhlIG1ldGhvZCB0aGF0XHJcbiAqIHdhcyB0aHJvd24uXHJcbiAqIEBwYXJhbSBtZXRob2ROYW1lIFRoZSBwdWJsaWNseSB2aXNpYmxlIG1ldGhvZCBuYW1lXHJcbiAqIEBwYXJhbSBwYXRoIFRoZSBkb3Qtc2VwYXJhdGVkIHN0cmluZyBmb3JtIG9mIGEgZmllbGQgcGF0aCB3aGljaCB3aWxsIGJlIHNwbGl0XHJcbiAqIG9uIGRvdHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBmaWVsZFBhdGhGcm9tRG90U2VwYXJhdGVkU3RyaW5nKG1ldGhvZE5hbWUsIHBhdGgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIGZyb21Eb3RTZXBhcmF0ZWRTdHJpbmcocGF0aCkuX2ludGVybmFsUGF0aDtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UoZSk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBcIiArIG1ldGhvZE5hbWUgKyBcIigpIGNhbGxlZCB3aXRoIGludmFsaWQgZGF0YS4gXCIgKyBtZXNzYWdlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogRXh0cmFjdHMgdGhlIG1lc3NhZ2UgZnJvbSBhIGNhdWdodCBleGNlcHRpb24sIHdoaWNoIHNob3VsZCBiZSBhbiBFcnJvciBvYmplY3RcclxuICogdGhvdWdoIEpTIGRvZXNuJ3QgZ3VhcmFudGVlIHRoYXQuXHJcbiAqL1xyXG5mdW5jdGlvbiBlcnJvck1lc3NhZ2UoZXJyb3IpIHtcclxuICAgIHJldHVybiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IGVycm9yLnRvU3RyaW5nKCk7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIFRoZSBvYmplY3RzIHRoYXQgYXJlIGEgcGFydCBvZiB0aGlzIEFQSSBhcmUgZXhwb3NlZCB0byB0aGlyZC1wYXJ0aWVzIGFzXHJcbi8vIGNvbXBpbGVkIGphdmFzY3JpcHQgc28gd2Ugd2FudCB0byBmbGFnIG91ciBwcml2YXRlIG1lbWJlcnMgd2l0aCBhIGxlYWRpbmdcclxuLy8gdW5kZXJzY29yZSB0byBkaXNjb3VyYWdlIHRoZWlyIHVzZS5cclxuLy8gdHNsaW50OmRpc2FibGU6c3RyaXAtcHJpdmF0ZS1wcm9wZXJ0eS11bmRlcnNjb3JlXHJcbi8vIHNldHRpbmdzKCkgZGVmYXVsdHM6XHJcbnZhciBERUZBVUxUX0hPU1QgPSAnZmlyZXN0b3JlLmdvb2dsZWFwaXMuY29tJztcclxudmFyIERFRkFVTFRfU1NMID0gdHJ1ZTtcclxudmFyIERFRkFVTFRfVElNRVNUQU1QU19JTl9TTkFQU0hPVFMgPSBmYWxzZTtcclxuLy8gZW5hYmxlUGVyc2lzdGVuY2UoKSBkZWZhdWx0czpcclxudmFyIERFRkFVTFRfU1lOQ0hST05JWkVfVEFCUyA9IGZhbHNlO1xyXG4vKipcclxuICogQSBjb25jcmV0ZSB0eXBlIGRlc2NyaWJpbmcgYWxsIHRoZSB2YWx1ZXMgdGhhdCBjYW4gYmUgYXBwbGllZCB2aWEgYVxyXG4gKiB1c2VyLXN1cHBsaWVkIGZpcmVzdG9yZS5TZXR0aW5ncyBvYmplY3QuIFRoaXMgaXMgYSBzZXBhcmF0ZSB0eXBlIHNvIHRoYXRcclxuICogZGVmYXVsdHMgY2FuIGJlIHN1cHBsaWVkIGFuZCB0aGUgdmFsdWUgY2FuIGJlIGNoZWNrZWQgZm9yIGVxdWFsaXR5LlxyXG4gKi9cclxudmFyIEZpcmVzdG9yZVNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZXN0b3JlU2V0dGluZ3Moc2V0dGluZ3MpIHtcclxuICAgICAgICBpZiAoc2V0dGluZ3MuaG9zdCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5zc2wgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJDYW4ndCBwcm92aWRlIHNzbCBvcHRpb24gaWYgaG9zdCBvcHRpb24gaXMgbm90IHNldFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmhvc3QgPSBERUZBVUxUX0hPU1Q7XHJcbiAgICAgICAgICAgIHRoaXMuc3NsID0gREVGQVVMVF9TU0w7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU5hbWVkVHlwZSgnc2V0dGluZ3MnLCAnbm9uLWVtcHR5IHN0cmluZycsICdob3N0Jywgc2V0dGluZ3MuaG9zdCk7XHJcbiAgICAgICAgICAgIHRoaXMuaG9zdCA9IHNldHRpbmdzLmhvc3Q7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFR5cGUoJ3NldHRpbmdzJywgJ2Jvb2xlYW4nLCAnc3NsJywgc2V0dGluZ3Muc3NsKTtcclxuICAgICAgICAgICAgdGhpcy5zc2wgPSBkZWZhdWx0ZWQoc2V0dGluZ3Muc3NsLCBERUZBVUxUX1NTTCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlT3B0aW9uTmFtZXMoJ3NldHRpbmdzJywgc2V0dGluZ3MsIFtcclxuICAgICAgICAgICAgJ2hvc3QnLFxyXG4gICAgICAgICAgICAnc3NsJyxcclxuICAgICAgICAgICAgJ2NyZWRlbnRpYWxzJyxcclxuICAgICAgICAgICAgJ3RpbWVzdGFtcHNJblNuYXBzaG90cydcclxuICAgICAgICBdKTtcclxuICAgICAgICB2YWxpZGF0ZU5hbWVkT3B0aW9uYWxUeXBlKCdzZXR0aW5ncycsICdvYmplY3QnLCAnY3JlZGVudGlhbHMnLCBzZXR0aW5ncy5jcmVkZW50aWFscyk7XHJcbiAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IHNldHRpbmdzLmNyZWRlbnRpYWxzO1xyXG4gICAgICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFR5cGUoJ3NldHRpbmdzJywgJ2Jvb2xlYW4nLCAndGltZXN0YW1wc0luU25hcHNob3RzJywgc2V0dGluZ3MudGltZXN0YW1wc0luU25hcHNob3RzKTtcclxuICAgICAgICB0aGlzLnRpbWVzdGFtcHNJblNuYXBzaG90cyA9IGRlZmF1bHRlZChzZXR0aW5ncy50aW1lc3RhbXBzSW5TbmFwc2hvdHMsIERFRkFVTFRfVElNRVNUQU1QU19JTl9TTkFQU0hPVFMpO1xyXG4gICAgfVxyXG4gICAgRmlyZXN0b3JlU2V0dGluZ3MucHJvdG90eXBlLmlzRXF1YWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuaG9zdCA9PT0gb3RoZXIuaG9zdCAmJlxyXG4gICAgICAgICAgICB0aGlzLnNzbCA9PT0gb3RoZXIuc3NsICYmXHJcbiAgICAgICAgICAgIHRoaXMudGltZXN0YW1wc0luU25hcHNob3RzID09PSBvdGhlci50aW1lc3RhbXBzSW5TbmFwc2hvdHMgJiZcclxuICAgICAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9PT0gb3RoZXIuY3JlZGVudGlhbHMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBGaXJlc3RvcmVTZXR0aW5ncztcclxufSgpKTtcclxudmFyIEZpcmVzdG9yZUNvbmZpZyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZpcmVzdG9yZUNvbmZpZygpIHtcclxuICAgIH1cclxuICAgIHJldHVybiBGaXJlc3RvcmVDb25maWc7XHJcbn0oKSk7XHJcbi8qKlxyXG4gKiBFbmNhcHN1bGF0ZXMgdGhlIHNldHRpbmdzIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29uZmlndXJlIEZpcmVzdG9yZVxyXG4gKiBwZXJzaXN0ZW5jZS5cclxuICovXHJcbnZhciBQZXJzaXN0ZW5jZVNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGVyc2lzdGVuY2VTZXR0aW5ncyhlbmFibGVkLCBzZXR0aW5ncykge1xyXG4gICAgICAgIHRoaXMuZW5hYmxlZCA9IGVuYWJsZWQ7XHJcbiAgICAgICAgYXNzZXJ0KGVuYWJsZWQgfHwgIXNldHRpbmdzLCAnQ2FuIG9ubHkgcHJvdmlkZSBQZXJzaXN0ZW5jZVNldHRpbmdzIHdpdGggcGVyc2lzdGVuY2UgZW5hYmxlZCcpO1xyXG4gICAgICAgIHNldHRpbmdzID0gc2V0dGluZ3MgfHwge307XHJcbiAgICAgICAgdGhpcy5leHBlcmltZW50YWxUYWJTeW5jaHJvbml6YXRpb24gPSBkZWZhdWx0ZWQoc2V0dGluZ3MuZXhwZXJpbWVudGFsVGFiU3luY2hyb25pemF0aW9uLCBERUZBVUxUX1NZTkNIUk9OSVpFX1RBQlMpO1xyXG4gICAgfVxyXG4gICAgUGVyc2lzdGVuY2VTZXR0aW5ncy5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5lbmFibGVkID09PSBvdGhlci5lbmFibGVkICYmXHJcbiAgICAgICAgICAgIHRoaXMuZXhwZXJpbWVudGFsVGFiU3luY2hyb25pemF0aW9uID09PVxyXG4gICAgICAgICAgICAgICAgb3RoZXIuZXhwZXJpbWVudGFsVGFiU3luY2hyb25pemF0aW9uKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGVyc2lzdGVuY2VTZXR0aW5ncztcclxufSgpKTtcclxuLyoqXHJcbiAqIFRoZSByb290IHJlZmVyZW5jZSB0byB0aGUgZGF0YWJhc2UuXHJcbiAqL1xyXG52YXIgRmlyZXN0b3JlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZXN0b3JlKGRhdGFiYXNlSWRPckFwcCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gUHVibGljIGZvciB1c2UgaW4gdGVzdHMuXHJcbiAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBVc2UgbW9kdWxhcml6ZWQgaW5pdGlhbGl6YXRpb24gaW5zdGVhZC5cclxuICAgICAgICB0aGlzLl9xdWV1ZSA9IG5ldyBBc3luY1F1ZXVlKCk7XHJcbiAgICAgICAgdGhpcy5JTlRFUk5BTCA9IHtcclxuICAgICAgICAgICAgZGVsZXRlOiBmdW5jdGlvbiAob3B0aW9ucykgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZmlyZXN0b3JlQ2xpZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLl9maXJlc3RvcmVDbGllbnQuc2h1dGRvd24ob3B0aW9ucyldO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7IH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBjb25maWcgPSBuZXcgRmlyZXN0b3JlQ29uZmlnKCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhYmFzZUlkT3JBcHAub3B0aW9ucyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyB2ZXJ5IGxpa2VseSBhIEZpcmViYXNlIGFwcCBvYmplY3RcclxuICAgICAgICAgICAgLy8gVE9ETyhiLzM0MTc3NjA1KTogQ2FuIHdlIHNvbWVob3cgdXNlIGluc3RhbmNlb2Y/XHJcbiAgICAgICAgICAgIHZhciBhcHAgPSBkYXRhYmFzZUlkT3JBcHA7XHJcbiAgICAgICAgICAgIGNvbmZpZy5maXJlYmFzZUFwcCA9IGFwcDtcclxuICAgICAgICAgICAgY29uZmlnLmRhdGFiYXNlSWQgPSBGaXJlc3RvcmUuZGF0YWJhc2VJZEZyb21BcHAoYXBwKTtcclxuICAgICAgICAgICAgY29uZmlnLnBlcnNpc3RlbmNlS2V5ID0gY29uZmlnLmZpcmViYXNlQXBwLm5hbWU7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jcmVkZW50aWFscyA9IG5ldyBGaXJlYmFzZUNyZWRlbnRpYWxzUHJvdmlkZXIoYXBwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBleHRlcm5hbF8xID0gZGF0YWJhc2VJZE9yQXBwO1xyXG4gICAgICAgICAgICBpZiAoIWV4dGVybmFsXzEucHJvamVjdElkKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnTXVzdCBwcm92aWRlIHByb2plY3RJZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbmZpZy5kYXRhYmFzZUlkID0gbmV3IERhdGFiYXNlSWQoZXh0ZXJuYWxfMS5wcm9qZWN0SWQsIGV4dGVybmFsXzEuZGF0YWJhc2UpO1xyXG4gICAgICAgICAgICAvLyBVc2UgYSBkZWZhdWx0IHBlcnNpc3RlbmNlS2V5IHRoYXQgbGluZXMgdXAgd2l0aCBGaXJlYmFzZUFwcC5cclxuICAgICAgICAgICAgY29uZmlnLnBlcnNpc3RlbmNlS2V5ID0gJ1tERUZBVUxUXSc7XHJcbiAgICAgICAgICAgIGNvbmZpZy5jcmVkZW50aWFscyA9IG5ldyBFbXB0eUNyZWRlbnRpYWxzUHJvdmlkZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uZmlnLnNldHRpbmdzID0gbmV3IEZpcmVzdG9yZVNldHRpbmdzKHt9KTtcclxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XHJcbiAgICAgICAgdGhpcy5fZGF0YWJhc2VJZCA9IGNvbmZpZy5kYXRhYmFzZUlkO1xyXG4gICAgfVxyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5zZXR0aW5ncyA9IGZ1bmN0aW9uIChzZXR0aW5nc0xpdGVyYWwpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdGaXJlc3RvcmUuc2V0dGluZ3MnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnRmlyZXN0b3JlLnNldHRpbmdzJywgJ29iamVjdCcsIDEsIHNldHRpbmdzTGl0ZXJhbCk7XHJcbiAgICAgICAgaWYgKGNvbnRhaW5zKHNldHRpbmdzTGl0ZXJhbCwgJ3BlcnNpc3RlbmNlJykpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1wicGVyc2lzdGVuY2VcIiBpcyBub3cgc3BlY2lmaWVkIHdpdGggYSBzZXBhcmF0ZSBjYWxsIHRvICcgK1xyXG4gICAgICAgICAgICAgICAgJ2ZpcmVzdG9yZS5lbmFibGVQZXJzaXN0ZW5jZSgpLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbmV3U2V0dGluZ3MgPSBuZXcgRmlyZXN0b3JlU2V0dGluZ3Moc2V0dGluZ3NMaXRlcmFsKTtcclxuICAgICAgICBpZiAodGhpcy5fZmlyZXN0b3JlQ2xpZW50ICYmICF0aGlzLl9jb25maWcuc2V0dGluZ3MuaXNFcXVhbChuZXdTZXR0aW5ncykpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuRkFJTEVEX1BSRUNPTkRJVElPTiwgJ0ZpcmVzdG9yZSBoYXMgYWxyZWFkeSBiZWVuIHN0YXJ0ZWQgYW5kIGl0cyBzZXR0aW5ncyBjYW4gbm8gbG9uZ2VyICcgK1xyXG4gICAgICAgICAgICAgICAgJ2JlIGNoYW5nZWQuIFlvdSBjYW4gb25seSBjYWxsIHNldHRpbmdzKCkgYmVmb3JlIGNhbGxpbmcgYW55IG90aGVyICcgK1xyXG4gICAgICAgICAgICAgICAgJ21ldGhvZHMgb24gYSBGaXJlc3RvcmUgb2JqZWN0LicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jb25maWcuc2V0dGluZ3MgPSBuZXdTZXR0aW5ncztcclxuICAgICAgICBpZiAobmV3U2V0dGluZ3MuY3JlZGVudGlhbHMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jb25maWcuY3JlZGVudGlhbHMgPSBtYWtlQ3JlZGVudGlhbHNQcm92aWRlcihuZXdTZXR0aW5ncy5jcmVkZW50aWFscyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEZpcmVzdG9yZS5wcm90b3R5cGUuZW5hYmxlTmV0d29yayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50LmVuYWJsZU5ldHdvcmsoKTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLmRpc2FibGVOZXR3b3JrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maXJlc3RvcmVDbGllbnQuZGlzYWJsZU5ldHdvcmsoKTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLmVuYWJsZVBlcnNpc3RlbmNlID0gZnVuY3Rpb24gKHNldHRpbmdzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2ZpcmVzdG9yZUNsaWVudCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCAnRmlyZXN0b3JlIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBhbmQgcGVyc2lzdGVuY2UgY2FuIG5vIGxvbmdlciAnICtcclxuICAgICAgICAgICAgICAgICdiZSBlbmFibGVkLiBZb3UgY2FuIG9ubHkgY2FsbCBlbmFibGVQZXJzaXN0ZW5jZSgpIGJlZm9yZSBjYWxsaW5nICcgK1xyXG4gICAgICAgICAgICAgICAgJ2FueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlndXJlQ2xpZW50KG5ldyBQZXJzaXN0ZW5jZVNldHRpbmdzKC8qIGVuYWJsZWQ9ICovIHRydWUsIHNldHRpbmdzKSk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5lbnN1cmVDbGllbnRDb25maWd1cmVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5fZmlyZXN0b3JlQ2xpZW50KSB7XHJcbiAgICAgICAgICAgIC8vIEtpY2sgb2ZmIHN0YXJ0aW5nIHRoZSBjbGllbnQgYnV0IGRvbid0IGFjdHVhbGx5IHdhaXQgZm9yIGl0LlxyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICAgICAgdGhpcy5jb25maWd1cmVDbGllbnQobmV3IFBlcnNpc3RlbmNlU2V0dGluZ3MoLyogZW5hYmxlZD0gKi8gZmFsc2UpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpcmVzdG9yZUNsaWVudDtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLmNvbmZpZ3VyZUNsaWVudCA9IGZ1bmN0aW9uIChwZXJzaXN0ZW5jZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBhc3NlcnQoISF0aGlzLl9jb25maWcuc2V0dGluZ3MuaG9zdCwgJ0ZpcmVzdG9yZVNldHRpbmdzLmhvc3QgY2Fubm90IGJlIGZhbHNleScpO1xyXG4gICAgICAgIGlmICghdGhpcy5fY29uZmlnLnNldHRpbmdzLnRpbWVzdGFtcHNJblNuYXBzaG90cykge1xyXG4gICAgICAgICAgICBlcnJvcihcIlxcblRoZSBiZWhhdmlvciBmb3IgRGF0ZSBvYmplY3RzIHN0b3JlZCBpbiBGaXJlc3RvcmUgaXMgZ29pbmcgdG8gY2hhbmdlXFxuQU5EIFlPVVIgQVBQIE1BWSBCUkVBSy5cXG5UbyBoaWRlIHRoaXMgd2FybmluZyBhbmQgZW5zdXJlIHlvdXIgYXBwIGRvZXMgbm90IGJyZWFrLCB5b3UgbmVlZCB0byBhZGQgdGhlXFxuZm9sbG93aW5nIGNvZGUgdG8geW91ciBhcHAgYmVmb3JlIGNhbGxpbmcgYW55IG90aGVyIENsb3VkIEZpcmVzdG9yZSBtZXRob2RzOlxcblxcbiAgY29uc3QgZmlyZXN0b3JlID0gZmlyZWJhc2UuZmlyZXN0b3JlKCk7XFxuICBjb25zdCBzZXR0aW5ncyA9IHsvKiB5b3VyIHNldHRpbmdzLi4uICovIHRpbWVzdGFtcHNJblNuYXBzaG90czogdHJ1ZX07XFxuICBmaXJlc3RvcmUuc2V0dGluZ3Moc2V0dGluZ3MpO1xcblxcbldpdGggdGhpcyBjaGFuZ2UsIHRpbWVzdGFtcHMgc3RvcmVkIGluIENsb3VkIEZpcmVzdG9yZSB3aWxsIGJlIHJlYWQgYmFjayBhc1xcbkZpcmViYXNlIFRpbWVzdGFtcCBvYmplY3RzIGluc3RlYWQgb2YgYXMgc3lzdGVtIERhdGUgb2JqZWN0cy4gU28geW91IHdpbGwgYWxzb1xcbm5lZWQgdG8gdXBkYXRlIGNvZGUgZXhwZWN0aW5nIGEgRGF0ZSB0byBpbnN0ZWFkIGV4cGVjdCBhIFRpbWVzdGFtcC4gRm9yIGV4YW1wbGU6XFxuXFxuICAvLyBPbGQ6XFxuICBjb25zdCBkYXRlID0gc25hcHNob3QuZ2V0KCdjcmVhdGVkX2F0Jyk7XFxuICAvLyBOZXc6XFxuICBjb25zdCB0aW1lc3RhbXAgPSBzbmFwc2hvdC5nZXQoJ2NyZWF0ZWRfYXQnKTtcXG4gIGNvbnN0IGRhdGUgPSB0aW1lc3RhbXAudG9EYXRlKCk7XFxuXFxuUGxlYXNlIGF1ZGl0IGFsbCBleGlzdGluZyB1c2FnZXMgb2YgRGF0ZSB3aGVuIHlvdSBlbmFibGUgdGhlIG5ldyBiZWhhdmlvci4gSW4gYVxcbmZ1dHVyZSByZWxlYXNlLCB0aGUgYmVoYXZpb3Igd2lsbCBjaGFuZ2UgdG8gdGhlIG5ldyBiZWhhdmlvciwgc28gaWYgeW91IGRvIG5vdFxcbmZvbGxvdyB0aGVzZSBzdGVwcywgWU9VUiBBUFAgTUFZIEJSRUFLLlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYXNzZXJ0KCF0aGlzLl9maXJlc3RvcmVDbGllbnQsICdjb25maWd1cmVDbGllbnQoKSBjYWxsZWQgbXVsdGlwbGUgdGltZXMnKTtcclxuICAgICAgICB2YXIgZGF0YWJhc2VJbmZvID0gbmV3IERhdGFiYXNlSW5mbyh0aGlzLl9jb25maWcuZGF0YWJhc2VJZCwgdGhpcy5fY29uZmlnLnBlcnNpc3RlbmNlS2V5LCB0aGlzLl9jb25maWcuc2V0dGluZ3MuaG9zdCwgdGhpcy5fY29uZmlnLnNldHRpbmdzLnNzbCk7XHJcbiAgICAgICAgdmFyIHByZUNvbnZlcnRlciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEb2N1bWVudFJlZmVyZW5jZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRoaXNEYiA9IF90aGlzLl9jb25maWcuZGF0YWJhc2VJZDtcclxuICAgICAgICAgICAgICAgIHZhciBvdGhlckRiID0gdmFsdWUuZmlyZXN0b3JlLl9jb25maWcuZGF0YWJhc2VJZDtcclxuICAgICAgICAgICAgICAgIGlmICghb3RoZXJEYi5pc0VxdWFsKHRoaXNEYikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnRG9jdW1lbnQgcmVmZXJlbmNlIGlzIGZvciBkYXRhYmFzZSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKG90aGVyRGIucHJvamVjdElkICsgXCIvXCIgKyBvdGhlckRiLmRhdGFiYXNlICsgXCIgYnV0IHNob3VsZCBiZSBcIikgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAoXCJmb3IgZGF0YWJhc2UgXCIgKyB0aGlzRGIucHJvamVjdElkICsgXCIvXCIgKyB0aGlzRGIuZGF0YWJhc2UpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRLZXlSZWZlcmVuY2UoX3RoaXMuX2NvbmZpZy5kYXRhYmFzZUlkLCB2YWx1ZS5fa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fZGF0YUNvbnZlcnRlciA9IG5ldyBVc2VyRGF0YUNvbnZlcnRlcihwcmVDb252ZXJ0ZXIpO1xyXG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZUNsaWVudCA9IG5ldyBGaXJlc3RvcmVDbGllbnQoUGxhdGZvcm1TdXBwb3J0LmdldFBsYXRmb3JtKCksIGRhdGFiYXNlSW5mbywgdGhpcy5fY29uZmlnLmNyZWRlbnRpYWxzLCB0aGlzLl9xdWV1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpcmVzdG9yZUNsaWVudC5zdGFydChwZXJzaXN0ZW5jZVNldHRpbmdzKTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUuZGF0YWJhc2VJZEZyb21BcHAgPSBmdW5jdGlvbiAoYXBwKSB7XHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSBhcHAub3B0aW9ucztcclxuICAgICAgICBpZiAoIWNvbnRhaW5zKG9wdGlvbnMsICdwcm9qZWN0SWQnKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnXCJwcm9qZWN0SWRcIiBub3QgcHJvdmlkZWQgaW4gZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHByb2plY3RJZCA9IG9wdGlvbnNbJ3Byb2plY3RJZCddO1xyXG4gICAgICAgIGlmICghcHJvamVjdElkIHx8IHR5cGVvZiBwcm9qZWN0SWQgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdwcm9qZWN0SWQgbXVzdCBiZSBhIHN0cmluZyBpbiBGaXJlYmFzZUFwcC5vcHRpb25zJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgRGF0YWJhc2VJZChwcm9qZWN0SWQpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaXJlc3RvcmUucHJvdG90eXBlLCBcImFwcFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5fY29uZmlnLmZpcmViYXNlQXBwKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkZpcmVzdG9yZSB3YXMgbm90IGluaXRpYWxpemVkIHVzaW5nIHRoZSBGaXJlYmFzZSBTREsuICdhcHAnIGlzIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAnbm90IGF2YWlsYWJsZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb25maWcuZmlyZWJhc2VBcHA7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLmNvbGxlY3Rpb24gPSBmdW5jdGlvbiAocGF0aFN0cmluZykge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0ZpcmVzdG9yZS5jb2xsZWN0aW9uJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0ZpcmVzdG9yZS5jb2xsZWN0aW9uJywgJ25vbi1lbXB0eSBzdHJpbmcnLCAxLCBwYXRoU3RyaW5nKTtcclxuICAgICAgICBpZiAoIXBhdGhTdHJpbmcpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ011c3QgcHJvdmlkZSBhIG5vbi1lbXB0eSBjb2xsZWN0aW9uIHBhdGggdG8gY29sbGVjdGlvbigpJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpO1xyXG4gICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvblJlZmVyZW5jZShSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhwYXRoU3RyaW5nKSwgdGhpcyk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5kb2MgPSBmdW5jdGlvbiAocGF0aFN0cmluZykge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0ZpcmVzdG9yZS5kb2MnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnRmlyZXN0b3JlLmRvYycsICdub24tZW1wdHkgc3RyaW5nJywgMSwgcGF0aFN0cmluZyk7XHJcbiAgICAgICAgaWYgKCFwYXRoU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdNdXN0IHByb3ZpZGUgYSBub24tZW1wdHkgZG9jdW1lbnQgcGF0aCB0byBkb2MoKScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKTtcclxuICAgICAgICByZXR1cm4gRG9jdW1lbnRSZWZlcmVuY2UuZm9yUGF0aChSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhwYXRoU3RyaW5nKSwgdGhpcyk7XHJcbiAgICB9O1xyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5ydW5UcmFuc2FjdGlvbiA9IGZ1bmN0aW9uICh1cGRhdGVGdW5jdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnRmlyZXN0b3JlLnJ1blRyYW5zYWN0aW9uJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0ZpcmVzdG9yZS5ydW5UcmFuc2FjdGlvbicsICdmdW5jdGlvbicsIDEsIHVwZGF0ZUZ1bmN0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5lbnN1cmVDbGllbnRDb25maWd1cmVkKCkudHJhbnNhY3Rpb24oZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVGdW5jdGlvbihuZXcgVHJhbnNhY3Rpb24kMShfdGhpcywgdHJhbnNhY3Rpb24pKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBGaXJlc3RvcmUucHJvdG90eXBlLmJhdGNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpO1xyXG4gICAgICAgIHJldHVybiBuZXcgV3JpdGVCYXRjaCh0aGlzKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlyZXN0b3JlLCBcImxvZ0xldmVsXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChnZXRMb2dMZXZlbCgpKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIExvZ0xldmVsLkRFQlVHOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnZGVidWcnO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBMb2dMZXZlbC5FUlJPUjpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2Vycm9yJztcclxuICAgICAgICAgICAgICAgIGNhc2UgTG9nTGV2ZWwuU0lMRU5UOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnc2lsZW50JztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gbG9nIGxldmVsOiAnICsgZ2V0TG9nTGV2ZWwoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEZpcmVzdG9yZS5zZXRMb2dMZXZlbCA9IGZ1bmN0aW9uIChsZXZlbCkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ0ZpcmVzdG9yZS5zZXRMb2dMZXZlbCcsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdGaXJlc3RvcmUuc2V0TG9nTGV2ZWwnLCAnbm9uLWVtcHR5IHN0cmluZycsIDEsIGxldmVsKTtcclxuICAgICAgICBzd2l0Y2ggKGxldmVsKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2RlYnVnJzpcclxuICAgICAgICAgICAgICAgIHNldExvZ0xldmVsKExvZ0xldmVsLkRFQlVHKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdlcnJvcic6XHJcbiAgICAgICAgICAgICAgICBzZXRMb2dMZXZlbChMb2dMZXZlbC5FUlJPUik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnc2lsZW50JzpcclxuICAgICAgICAgICAgICAgIHNldExvZ0xldmVsKExvZ0xldmVsLlNJTEVOVCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIGxvZyBsZXZlbDogJyArIGxldmVsKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gTm90ZTogdGhpcyBpcyBub3QgYSBwcm9wZXJ0eSBiZWNhdXNlIHRoZSBtaW5pZmllciBjYW4ndCB3b3JrIGNvcnJlY3RseSB3aXRoXHJcbiAgICAvLyB0aGUgd2F5IFR5cGVTY3JpcHQgY29tcGlsZXIgb3V0cHV0cyBwcm9wZXJ0aWVzLlxyXG4gICAgRmlyZXN0b3JlLnByb3RvdHlwZS5fYXJlVGltZXN0YW1wc0luU25hcHNob3RzRW5hYmxlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY29uZmlnLnNldHRpbmdzLnRpbWVzdGFtcHNJblNuYXBzaG90cztcclxuICAgIH07XHJcbiAgICByZXR1cm4gRmlyZXN0b3JlO1xyXG59KCkpO1xyXG4vKipcclxuICogQSByZWZlcmVuY2UgdG8gYSB0cmFuc2FjdGlvbi5cclxuICovXHJcbnZhciBUcmFuc2FjdGlvbiQxID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVHJhbnNhY3Rpb24oX2ZpcmVzdG9yZSwgX3RyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gX2ZpcmVzdG9yZTtcclxuICAgICAgICB0aGlzLl90cmFuc2FjdGlvbiA9IF90cmFuc2FjdGlvbjtcclxuICAgIH1cclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoZG9jdW1lbnRSZWYpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ1RyYW5zYWN0aW9uLmdldCcsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFyIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdUcmFuc2FjdGlvbi5nZXQnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNhY3Rpb25cclxuICAgICAgICAgICAgLmxvb2t1cChbcmVmLl9rZXldKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZG9jcykge1xyXG4gICAgICAgICAgICBpZiAoIWRvY3MgfHwgZG9jcy5sZW5ndGggIT09IDEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWlsKCdNaXNtYXRjaCBpbiBkb2NzIHJldHVybmVkIGZyb20gZG9jdW1lbnQgbG9va3VwLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBkb2MgPSBkb2NzWzBdO1xyXG4gICAgICAgICAgICBpZiAoZG9jIGluc3RhbmNlb2YgTm9Eb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFNuYXBzaG90KF90aGlzLl9maXJlc3RvcmUsIHJlZi5fa2V5LCBudWxsLCBcclxuICAgICAgICAgICAgICAgIC8qIGZyb21DYWNoZT0gKi8gZmFsc2UsIFxyXG4gICAgICAgICAgICAgICAgLyogaGFzUGVuZGluZ1dyaXRlcz0gKi8gZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGRvYyBpbnN0YW5jZW9mIERvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50U25hcHNob3QoX3RoaXMuX2ZpcmVzdG9yZSwgcmVmLl9rZXksIGRvYywgXHJcbiAgICAgICAgICAgICAgICAvKiBmcm9tQ2FjaGU9ICovIGZhbHNlLCBcclxuICAgICAgICAgICAgICAgIC8qIGhhc1BlbmRpbmdXcml0ZXM9ICovIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IGZhaWwoXCJCYXRjaEdldERvY3VtZW50c1JlcXVlc3QgcmV0dXJuZWQgdW5leHBlY3RlZCBkb2N1bWVudCB0eXBlOiBcIiArIGRvYy5jb25zdHJ1Y3Rvci5uYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoZG9jdW1lbnRSZWYsIHZhbHVlLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdUcmFuc2FjdGlvbi5zZXQnLCBhcmd1bWVudHMsIDIsIDMpO1xyXG4gICAgICAgIHZhciByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnVHJhbnNhY3Rpb24uc2V0JywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgb3B0aW9ucyA9IHZhbGlkYXRlU2V0T3B0aW9ucygnVHJhbnNhY3Rpb24uc2V0Jywgb3B0aW9ucyk7XHJcbiAgICAgICAgdmFyIHBhcnNlZCA9IG9wdGlvbnMubWVyZ2UgfHwgb3B0aW9ucy5tZXJnZUZpZWxkc1xyXG4gICAgICAgICAgICA/IHRoaXMuX2ZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZU1lcmdlRGF0YSgnVHJhbnNhY3Rpb24uc2V0JywgdmFsdWUsIG9wdGlvbnMubWVyZ2VGaWVsZHMpXHJcbiAgICAgICAgICAgIDogdGhpcy5fZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlU2V0RGF0YSgnVHJhbnNhY3Rpb24uc2V0JywgdmFsdWUpO1xyXG4gICAgICAgIHRoaXMuX3RyYW5zYWN0aW9uLnNldChyZWYuX2tleSwgcGFyc2VkKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRvY3VtZW50UmVmLCBmaWVsZE9yVXBkYXRlRGF0YSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgbW9yZUZpZWxkc0FuZFZhbHVlcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMzsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIG1vcmVGaWVsZHNBbmRWYWx1ZXNbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByZWY7XHJcbiAgICAgICAgdmFyIHBhcnNlZDtcclxuICAgICAgICBpZiAodHlwZW9mIGZpZWxkT3JVcGRhdGVEYXRhID09PSAnc3RyaW5nJyB8fFxyXG4gICAgICAgICAgICBmaWVsZE9yVXBkYXRlRGF0YSBpbnN0YW5jZW9mIEZpZWxkUGF0aCQxKSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnVHJhbnNhY3Rpb24udXBkYXRlJywgYXJndW1lbnRzLCAzKTtcclxuICAgICAgICAgICAgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1RyYW5zYWN0aW9uLnVwZGF0ZScsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgICAgICBwYXJzZWQgPSB0aGlzLl9maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VVcGRhdGVWYXJhcmdzKCdUcmFuc2FjdGlvbi51cGRhdGUnLCBmaWVsZE9yVXBkYXRlRGF0YSwgdmFsdWUsIG1vcmVGaWVsZHNBbmRWYWx1ZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnVHJhbnNhY3Rpb24udXBkYXRlJywgYXJndW1lbnRzLCAyKTtcclxuICAgICAgICAgICAgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1RyYW5zYWN0aW9uLnVwZGF0ZScsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgICAgICBwYXJzZWQgPSB0aGlzLl9maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VVcGRhdGVEYXRhKCdUcmFuc2FjdGlvbi51cGRhdGUnLCBmaWVsZE9yVXBkYXRlRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3RyYW5zYWN0aW9uLnVwZGF0ZShyZWYuX2tleSwgcGFyc2VkKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGRvY3VtZW50UmVmKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnVHJhbnNhY3Rpb24uZGVsZXRlJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YXIgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1RyYW5zYWN0aW9uLmRlbGV0ZScsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgIHRoaXMuX3RyYW5zYWN0aW9uLmRlbGV0ZShyZWYuX2tleSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRyYW5zYWN0aW9uO1xyXG59KCkpO1xyXG52YXIgV3JpdGVCYXRjaCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdyaXRlQmF0Y2goX2ZpcmVzdG9yZSkge1xyXG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IF9maXJlc3RvcmU7XHJcbiAgICAgICAgdGhpcy5fbXV0YXRpb25zID0gW107XHJcbiAgICAgICAgdGhpcy5fY29tbWl0dGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBXcml0ZUJhdGNoLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoZG9jdW1lbnRSZWYsIHZhbHVlLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdXcml0ZUJhdGNoLnNldCcsIGFyZ3VtZW50cywgMiwgMyk7XHJcbiAgICAgICAgdGhpcy52ZXJpZnlOb3RDb21taXR0ZWQoKTtcclxuICAgICAgICB2YXIgcmVmID0gdmFsaWRhdGVSZWZlcmVuY2UoJ1dyaXRlQmF0Y2guc2V0JywgZG9jdW1lbnRSZWYsIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgb3B0aW9ucyA9IHZhbGlkYXRlU2V0T3B0aW9ucygnV3JpdGVCYXRjaC5zZXQnLCBvcHRpb25zKTtcclxuICAgICAgICB2YXIgcGFyc2VkID0gb3B0aW9ucy5tZXJnZSB8fCBvcHRpb25zLm1lcmdlRmllbGRzXHJcbiAgICAgICAgICAgID8gdGhpcy5fZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlTWVyZ2VEYXRhKCdXcml0ZUJhdGNoLnNldCcsIHZhbHVlLCBvcHRpb25zLm1lcmdlRmllbGRzKVxyXG4gICAgICAgICAgICA6IHRoaXMuX2ZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVNldERhdGEoJ1dyaXRlQmF0Y2guc2V0JywgdmFsdWUpO1xyXG4gICAgICAgIHRoaXMuX211dGF0aW9ucyA9IHRoaXMuX211dGF0aW9ucy5jb25jYXQocGFyc2VkLnRvTXV0YXRpb25zKHJlZi5fa2V5LCBQcmVjb25kaXRpb24uTk9ORSkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIFdyaXRlQmF0Y2gucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkb2N1bWVudFJlZiwgZmllbGRPclVwZGF0ZURhdGEsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG1vcmVGaWVsZHNBbmRWYWx1ZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBtb3JlRmllbGRzQW5kVmFsdWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnZlcmlmeU5vdENvbW1pdHRlZCgpO1xyXG4gICAgICAgIHZhciByZWY7XHJcbiAgICAgICAgdmFyIHBhcnNlZDtcclxuICAgICAgICBpZiAodHlwZW9mIGZpZWxkT3JVcGRhdGVEYXRhID09PSAnc3RyaW5nJyB8fFxyXG4gICAgICAgICAgICBmaWVsZE9yVXBkYXRlRGF0YSBpbnN0YW5jZW9mIEZpZWxkUGF0aCQxKSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnV3JpdGVCYXRjaC51cGRhdGUnLCBhcmd1bWVudHMsIDMpO1xyXG4gICAgICAgICAgICByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnV3JpdGVCYXRjaC51cGRhdGUnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICAgICAgcGFyc2VkID0gdGhpcy5fZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlVXBkYXRlVmFyYXJncygnV3JpdGVCYXRjaC51cGRhdGUnLCBmaWVsZE9yVXBkYXRlRGF0YSwgdmFsdWUsIG1vcmVGaWVsZHNBbmRWYWx1ZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnV3JpdGVCYXRjaC51cGRhdGUnLCBhcmd1bWVudHMsIDIpO1xyXG4gICAgICAgICAgICByZWYgPSB2YWxpZGF0ZVJlZmVyZW5jZSgnV3JpdGVCYXRjaC51cGRhdGUnLCBkb2N1bWVudFJlZiwgdGhpcy5fZmlyZXN0b3JlKTtcclxuICAgICAgICAgICAgcGFyc2VkID0gdGhpcy5fZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlVXBkYXRlRGF0YSgnV3JpdGVCYXRjaC51cGRhdGUnLCBmaWVsZE9yVXBkYXRlRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX211dGF0aW9ucyA9IHRoaXMuX211dGF0aW9ucy5jb25jYXQocGFyc2VkLnRvTXV0YXRpb25zKHJlZi5fa2V5LCBQcmVjb25kaXRpb24uZXhpc3RzKHRydWUpKSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgV3JpdGVCYXRjaC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGRvY3VtZW50UmVmKSB7XHJcbiAgICAgICAgdmFsaWRhdGVFeGFjdE51bWJlck9mQXJncygnV3JpdGVCYXRjaC5kZWxldGUnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHRoaXMudmVyaWZ5Tm90Q29tbWl0dGVkKCk7XHJcbiAgICAgICAgdmFyIHJlZiA9IHZhbGlkYXRlUmVmZXJlbmNlKCdXcml0ZUJhdGNoLmRlbGV0ZScsIGRvY3VtZW50UmVmLCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgIHRoaXMuX211dGF0aW9ucyA9IHRoaXMuX211dGF0aW9ucy5jb25jYXQobmV3IERlbGV0ZU11dGF0aW9uKHJlZi5fa2V5LCBQcmVjb25kaXRpb24uTk9ORSkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIFdyaXRlQmF0Y2gucHJvdG90eXBlLmNvbW1pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZlcmlmeU5vdENvbW1pdHRlZCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29tbWl0dGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tdXRhdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLl9maXJlc3RvcmUuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpLndyaXRlKHRoaXMuX211dGF0aW9ucyldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBXcml0ZUJhdGNoLnByb3RvdHlwZS52ZXJpZnlOb3RDb21taXR0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NvbW1pdHRlZCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5GQUlMRURfUFJFQ09ORElUSU9OLCAnQSB3cml0ZSBiYXRjaCBjYW4gbm8gbG9uZ2VyIGJlIHVzZWQgYWZ0ZXIgY29tbWl0KCkgJyArXHJcbiAgICAgICAgICAgICAgICAnaGFzIGJlZW4gY2FsbGVkLicpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gV3JpdGVCYXRjaDtcclxufSgpKTtcclxuLyoqXHJcbiAqIEEgcmVmZXJlbmNlIHRvIGEgcGFydGljdWxhciBkb2N1bWVudCBpbiBhIGNvbGxlY3Rpb24gaW4gdGhlIGRhdGFiYXNlLlxyXG4gKi9cclxudmFyIERvY3VtZW50UmVmZXJlbmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRSZWZlcmVuY2UoX2tleSwgZmlyZXN0b3JlKSB7XHJcbiAgICAgICAgdGhpcy5fa2V5ID0gX2tleTtcclxuICAgICAgICB0aGlzLmZpcmVzdG9yZSA9IGZpcmVzdG9yZTtcclxuICAgICAgICB0aGlzLl9maXJlc3RvcmVDbGllbnQgPSB0aGlzLmZpcmVzdG9yZS5lbnN1cmVDbGllbnRDb25maWd1cmVkKCk7XHJcbiAgICB9XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5mb3JQYXRoID0gZnVuY3Rpb24gKHBhdGgsIGZpcmVzdG9yZSkge1xyXG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCAlIDIgIT09IDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgZG9jdW1lbnQgcmVmZXJlbmNlLiBEb2N1bWVudCAnICtcclxuICAgICAgICAgICAgICAgICdyZWZlcmVuY2VzIG11c3QgaGF2ZSBhbiBldmVuIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICcgK1xyXG4gICAgICAgICAgICAgICAgKHBhdGguY2Fub25pY2FsU3RyaW5nKCkgKyBcIiBoYXMgXCIgKyBwYXRoLmxlbmd0aCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50UmVmZXJlbmNlKG5ldyBEb2N1bWVudEtleShwYXRoKSwgZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLCBcImlkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2tleS5wYXRoLmxhc3RTZWdtZW50KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLCBcInBhcmVudFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvblJlZmVyZW5jZSh0aGlzLl9rZXkucGF0aC5wb3BMYXN0KCksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUsIFwicGF0aFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS5jb2xsZWN0aW9uID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdEb2N1bWVudFJlZmVyZW5jZS5jb2xsZWN0aW9uJywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0RvY3VtZW50UmVmZXJlbmNlLmNvbGxlY3Rpb24nLCAnbm9uLWVtcHR5IHN0cmluZycsIDEsIHBhdGhTdHJpbmcpO1xyXG4gICAgICAgIGlmICghcGF0aFN0cmluZykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnTXVzdCBwcm92aWRlIGEgbm9uLWVtcHR5IGNvbGxlY3Rpb24gbmFtZSB0byBjb2xsZWN0aW9uKCknKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBhdGggPSBSZXNvdXJjZVBhdGguZnJvbVN0cmluZyhwYXRoU3RyaW5nKTtcclxuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb25SZWZlcmVuY2UodGhpcy5fa2V5LnBhdGguY2hpbGQocGF0aCksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgRG9jdW1lbnRSZWZlcmVuY2UpKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludmFsaWRDbGFzc0Vycm9yKCdpc0VxdWFsJywgJ0RvY3VtZW50UmVmZXJlbmNlJywgMSwgb3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5maXJlc3RvcmUgPT09IG90aGVyLmZpcmVzdG9yZSAmJiB0aGlzLl9rZXkuaXNFcXVhbChvdGhlci5fa2V5KTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHZhbHVlLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdEb2N1bWVudFJlZmVyZW5jZS5zZXQnLCBhcmd1bWVudHMsIDEsIDIpO1xyXG4gICAgICAgIG9wdGlvbnMgPSB2YWxpZGF0ZVNldE9wdGlvbnMoJ0RvY3VtZW50UmVmZXJlbmNlLnNldCcsIG9wdGlvbnMpO1xyXG4gICAgICAgIHZhciBwYXJzZWQgPSBvcHRpb25zLm1lcmdlIHx8IG9wdGlvbnMubWVyZ2VGaWVsZHNcclxuICAgICAgICAgICAgPyB0aGlzLmZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZU1lcmdlRGF0YSgnRG9jdW1lbnRSZWZlcmVuY2Uuc2V0JywgdmFsdWUsIG9wdGlvbnMubWVyZ2VGaWVsZHMpXHJcbiAgICAgICAgICAgIDogdGhpcy5maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VTZXREYXRhKCdEb2N1bWVudFJlZmVyZW5jZS5zZXQnLCB2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpcmVzdG9yZUNsaWVudC53cml0ZShwYXJzZWQudG9NdXRhdGlvbnModGhpcy5fa2V5LCBQcmVjb25kaXRpb24uTk9ORSkpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50UmVmZXJlbmNlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZmllbGRPclVwZGF0ZURhdGEsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIG1vcmVGaWVsZHNBbmRWYWx1ZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBtb3JlRmllbGRzQW5kVmFsdWVzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcGFyc2VkO1xyXG4gICAgICAgIGlmICh0eXBlb2YgZmllbGRPclVwZGF0ZURhdGEgPT09ICdzdHJpbmcnIHx8XHJcbiAgICAgICAgICAgIGZpZWxkT3JVcGRhdGVEYXRhIGluc3RhbmNlb2YgRmllbGRQYXRoJDEpIHtcclxuICAgICAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdEb2N1bWVudFJlZmVyZW5jZS51cGRhdGUnLCBhcmd1bWVudHMsIDIpO1xyXG4gICAgICAgICAgICBwYXJzZWQgPSB0aGlzLmZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVVwZGF0ZVZhcmFyZ3MoJ0RvY3VtZW50UmVmZXJlbmNlLnVwZGF0ZScsIGZpZWxkT3JVcGRhdGVEYXRhLCB2YWx1ZSwgbW9yZUZpZWxkc0FuZFZhbHVlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdEb2N1bWVudFJlZmVyZW5jZS51cGRhdGUnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgICAgICBwYXJzZWQgPSB0aGlzLmZpcmVzdG9yZS5fZGF0YUNvbnZlcnRlci5wYXJzZVVwZGF0ZURhdGEoJ0RvY3VtZW50UmVmZXJlbmNlLnVwZGF0ZScsIGZpZWxkT3JVcGRhdGVEYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpcmVzdG9yZUNsaWVudC53cml0ZShwYXJzZWQudG9NdXRhdGlvbnModGhpcy5fa2V5LCBQcmVjb25kaXRpb24uZXhpc3RzKHRydWUpKSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdEb2N1bWVudFJlZmVyZW5jZS5kZWxldGUnLCBhcmd1bWVudHMsIDApO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9maXJlc3RvcmVDbGllbnQud3JpdGUoW1xyXG4gICAgICAgICAgICBuZXcgRGVsZXRlTXV0YXRpb24odGhpcy5fa2V5LCBQcmVjb25kaXRpb24uTk9ORSlcclxuICAgICAgICBdKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUub25TbmFwc2hvdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdEb2N1bWVudFJlZmVyZW5jZS5vblNuYXBzaG90JywgYXJndW1lbnRzLCAxLCA0KTtcclxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogZmFsc2VcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBvYnNlcnZlcjtcclxuICAgICAgICB2YXIgY3VyckFyZyA9IDA7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBhcmdzW2N1cnJBcmddID09PSAnb2JqZWN0JyAmJlxyXG4gICAgICAgICAgICAhaXNQYXJ0aWFsT2JzZXJ2ZXIoYXJnc1tjdXJyQXJnXSkpIHtcclxuICAgICAgICAgICAgb3B0aW9ucyA9IGFyZ3NbY3VyckFyZ107XHJcbiAgICAgICAgICAgIHZhbGlkYXRlT3B0aW9uTmFtZXMoJ0RvY3VtZW50UmVmZXJlbmNlLm9uU25hcHNob3QnLCBvcHRpb25zLCBbXHJcbiAgICAgICAgICAgICAgICAnaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcydcclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFR5cGUoJ0RvY3VtZW50UmVmZXJlbmNlLm9uU25hcHNob3QnLCAnYm9vbGVhbicsICdpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzJywgb3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzKTtcclxuICAgICAgICAgICAgY3VyckFyZysrO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaW50ZXJuYWxPcHRpb25zID0ge1xyXG4gICAgICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiBvcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXNcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChpc1BhcnRpYWxPYnNlcnZlcihhcmdzW2N1cnJBcmddKSkge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IGFyZ3NbY3VyckFyZ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ0RvY3VtZW50UmVmZXJlbmNlLm9uU25hcHNob3QnLCAnZnVuY3Rpb24nLCBjdXJyQXJnLCBhcmdzW2N1cnJBcmddKTtcclxuICAgICAgICAgICAgdmFsaWRhdGVPcHRpb25hbEFyZ1R5cGUoJ0RvY3VtZW50UmVmZXJlbmNlLm9uU25hcHNob3QnLCAnZnVuY3Rpb24nLCBjdXJyQXJnICsgMSwgYXJnc1tjdXJyQXJnICsgMV0pO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU9wdGlvbmFsQXJnVHlwZSgnRG9jdW1lbnRSZWZlcmVuY2Uub25TbmFwc2hvdCcsICdmdW5jdGlvbicsIGN1cnJBcmcgKyAyLCBhcmdzW2N1cnJBcmcgKyAyXSk7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0ge1xyXG4gICAgICAgICAgICAgICAgbmV4dDogYXJnc1tjdXJyQXJnXSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBhcmdzW2N1cnJBcmcgKyAxXSxcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBhcmdzW2N1cnJBcmcgKyAyXVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5vblNuYXBzaG90SW50ZXJuYWwoaW50ZXJuYWxPcHRpb25zLCBvYnNlcnZlcik7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLm9uU25hcHNob3RJbnRlcm5hbCA9IGZ1bmN0aW9uIChvcHRpb25zLCBvYnNlcnZlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGVyckhhbmRsZXIgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuY2F1Z2h0IEVycm9yIGluIG9uU25hcHNob3Q6JywgZXJyKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChvYnNlcnZlci5lcnJvcikge1xyXG4gICAgICAgICAgICBlcnJIYW5kbGVyID0gb2JzZXJ2ZXIuZXJyb3IuYmluZChvYnNlcnZlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBhc3luY09ic2VydmVyID0gbmV3IEFzeW5jT2JzZXJ2ZXIoe1xyXG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAoc25hcHNob3QpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlci5uZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0KHNuYXBzaG90LmRvY3Muc2l6ZSA8PSAxLCAnVG9vIG1hbnkgZG9jdW1lbnRzIHJldHVybmVkIG9uIGEgZG9jdW1lbnQgcXVlcnknKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gc25hcHNob3QuZG9jcy5nZXQoX3RoaXMuX2tleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChuZXcgRG9jdW1lbnRTbmFwc2hvdChfdGhpcy5maXJlc3RvcmUsIF90aGlzLl9rZXksIGRvYywgc25hcHNob3QuZnJvbUNhY2hlLCBzbmFwc2hvdC5oYXNQZW5kaW5nV3JpdGVzKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiBlcnJIYW5kbGVyXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGludGVybmFsTGlzdGVuZXIgPSB0aGlzLl9maXJlc3RvcmVDbGllbnQubGlzdGVuKFF1ZXJ5LmF0UGF0aCh0aGlzLl9rZXkucGF0aCksIGFzeW5jT2JzZXJ2ZXIsIG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGFzeW5jT2JzZXJ2ZXIubXV0ZSgpO1xyXG4gICAgICAgICAgICBfdGhpcy5fZmlyZXN0b3JlQ2xpZW50LnVubGlzdGVuKGludGVybmFsTGlzdGVuZXIpO1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRSZWZlcmVuY2UucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ0RvY3VtZW50UmVmZXJlbmNlLmdldCcsIGFyZ3VtZW50cywgMCwgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVHZXRPcHRpb25zKCdEb2N1bWVudFJlZmVyZW5jZS5nZXQnLCBvcHRpb25zKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnNvdXJjZSA9PT0gJ2NhY2hlJykge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZmlyZXN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgLmVuc3VyZUNsaWVudENvbmZpZ3VyZWQoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5nZXREb2N1bWVudEZyb21Mb2NhbENhY2hlKF90aGlzLl9rZXkpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUobmV3IERvY3VtZW50U25hcHNob3QoX3RoaXMuZmlyZXN0b3JlLCBfdGhpcy5fa2V5LCBkb2MsIFxyXG4gICAgICAgICAgICAgICAgICAgIC8qZnJvbUNhY2hlPSovIHRydWUsIGRvYyBpbnN0YW5jZW9mIERvY3VtZW50ID8gZG9jLmhhc0xvY2FsTXV0YXRpb25zIDogZmFsc2UpKTtcclxuICAgICAgICAgICAgICAgIH0sIHJlamVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5nZXRWaWFTbmFwc2hvdExpc3RlbmVyKHJlc29sdmUsIHJlamVjdCwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudFJlZmVyZW5jZS5wcm90b3R5cGUuZ2V0VmlhU25hcHNob3RMaXN0ZW5lciA9IGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgdW5saXN0ZW4gPSB0aGlzLm9uU25hcHNob3RJbnRlcm5hbCh7XHJcbiAgICAgICAgICAgIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6IHRydWUsXHJcbiAgICAgICAgICAgIHdhaXRGb3JTeW5jV2hlbk9ubGluZTogdHJ1ZVxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKHNuYXApIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBxdWVyeSBmaXJzdCBiZWZvcmUgcGFzc2luZyBldmVudCB0byB1c2VyIHRvIGF2b2lkXHJcbiAgICAgICAgICAgICAgICAvLyB1c2VyIGFjdGlvbnMgYWZmZWN0aW5nIHRoZSBub3cgc3RhbGUgcXVlcnkuXHJcbiAgICAgICAgICAgICAgICB1bmxpc3RlbigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzbmFwLmV4aXN0cyAmJiBzbmFwLm1ldGFkYXRhLmZyb21DYWNoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogSWYgd2UncmUgb25saW5lIGFuZCB0aGUgZG9jdW1lbnQgZG9lc24ndFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGV4aXN0IHRoZW4gd2UgcmVzb2x2ZSB3aXRoIGEgZG9jLmV4aXN0cyBzZXQgdG8gZmFsc2UuIElmXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UncmUgb2ZmbGluZSBob3dldmVyLCB3ZSByZWplY3QgdGhlIFByb21pc2UgaW4gdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNhc2UuIFR3byBvcHRpb25zOiAxKSBDYWNoZSB0aGUgbmVnYXRpdmUgcmVzcG9uc2UgZnJvbVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzZXJ2ZXIgc28gd2UgY2FuIGRlbGl2ZXIgdGhhdCBldmVuIHdoZW4geW91J3JlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb2ZmbGluZSAyKSBBY3R1YWxseSByZWplY3QgdGhlIFByb21pc2UgaW4gdGhlIG9ubGluZSBjYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOQVZBSUxBQkxFLCAnRmFpbGVkIHRvIGdldCBkb2N1bWVudCBiZWNhdXNlIHRoZSBjbGllbnQgaXMgJyArICdvZmZsaW5lLicpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNuYXAuZXhpc3RzICYmXHJcbiAgICAgICAgICAgICAgICAgICAgc25hcC5tZXRhZGF0YS5mcm9tQ2FjaGUgJiZcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zICYmXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zb3VyY2UgPT09ICdzZXJ2ZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOQVZBSUxBQkxFLCAnRmFpbGVkIHRvIGdldCBkb2N1bWVudCBmcm9tIHNlcnZlci4gKEhvd2V2ZXIsIHRoaXMgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdkb2N1bWVudCBkb2VzIGV4aXN0IGluIHRoZSBsb2NhbCBjYWNoZS4gUnVuIGFnYWluICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnd2l0aG91dCBzZXR0aW5nIHNvdXJjZSB0byBcInNlcnZlclwiIHRvICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAncmV0cmlldmUgdGhlIGNhY2hlZCBkb2N1bWVudC4pJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzbmFwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IHJlamVjdFxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEb2N1bWVudFJlZmVyZW5jZTtcclxufSgpKTtcclxudmFyIFNuYXBzaG90TWV0YWRhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTbmFwc2hvdE1ldGFkYXRhKGhhc1BlbmRpbmdXcml0ZXMsIGZyb21DYWNoZSkge1xyXG4gICAgICAgIHRoaXMuaGFzUGVuZGluZ1dyaXRlcyA9IGhhc1BlbmRpbmdXcml0ZXM7XHJcbiAgICAgICAgdGhpcy5mcm9tQ2FjaGUgPSBmcm9tQ2FjaGU7XHJcbiAgICB9XHJcbiAgICBTbmFwc2hvdE1ldGFkYXRhLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmhhc1BlbmRpbmdXcml0ZXMgPT09IG90aGVyLmhhc1BlbmRpbmdXcml0ZXMgJiZcclxuICAgICAgICAgICAgdGhpcy5mcm9tQ2FjaGUgPT09IG90aGVyLmZyb21DYWNoZSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNuYXBzaG90TWV0YWRhdGE7XHJcbn0oKSk7XHJcbnZhciBEb2N1bWVudFNuYXBzaG90ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRTbmFwc2hvdChfZmlyZXN0b3JlLCBfa2V5LCBfZG9jdW1lbnQsIF9mcm9tQ2FjaGUsIF9oYXNQZW5kaW5nV3JpdGVzKSB7XHJcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gX2ZpcmVzdG9yZTtcclxuICAgICAgICB0aGlzLl9rZXkgPSBfa2V5O1xyXG4gICAgICAgIHRoaXMuX2RvY3VtZW50ID0gX2RvY3VtZW50O1xyXG4gICAgICAgIHRoaXMuX2Zyb21DYWNoZSA9IF9mcm9tQ2FjaGU7XHJcbiAgICAgICAgdGhpcy5faGFzUGVuZGluZ1dyaXRlcyA9IF9oYXNQZW5kaW5nV3JpdGVzO1xyXG4gICAgfVxyXG4gICAgRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUuZGF0YSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdEb2N1bWVudFNuYXBzaG90LmRhdGEnLCBhcmd1bWVudHMsIDAsIDEpO1xyXG4gICAgICAgIG9wdGlvbnMgPSB2YWxpZGF0ZVNuYXBzaG90T3B0aW9ucygnRG9jdW1lbnRTbmFwc2hvdC5kYXRhJywgb3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuICF0aGlzLl9kb2N1bWVudFxyXG4gICAgICAgICAgICA/IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICA6IHRoaXMuY29udmVydE9iamVjdCh0aGlzLl9kb2N1bWVudC5kYXRhLCBGaWVsZFZhbHVlT3B0aW9ucy5mcm9tU25hcHNob3RPcHRpb25zKG9wdGlvbnMsIHRoaXMuX2ZpcmVzdG9yZS5fYXJlVGltZXN0YW1wc0luU25hcHNob3RzRW5hYmxlZCgpKSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGZpZWxkUGF0aCwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhbGlkYXRlQmV0d2Vlbk51bWJlck9mQXJncygnRG9jdW1lbnRTbmFwc2hvdC5nZXQnLCBhcmd1bWVudHMsIDEsIDIpO1xyXG4gICAgICAgIG9wdGlvbnMgPSB2YWxpZGF0ZVNuYXBzaG90T3B0aW9ucygnRG9jdW1lbnRTbmFwc2hvdC5nZXQnLCBvcHRpb25zKTtcclxuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5fZG9jdW1lbnQuZGF0YS5maWVsZChmaWVsZFBhdGhGcm9tQXJndW1lbnQoJ0RvY3VtZW50U25hcHNob3QuZ2V0JywgZmllbGRQYXRoKSk7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0VmFsdWUodmFsdWUsIEZpZWxkVmFsdWVPcHRpb25zLmZyb21TbmFwc2hvdE9wdGlvbnMob3B0aW9ucywgdGhpcy5fZmlyZXN0b3JlLl9hcmVUaW1lc3RhbXBzSW5TbmFwc2hvdHNFbmFibGVkKCkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZSwgXCJpZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5sYXN0U2VnbWVudCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLCBcInJlZlwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRSZWZlcmVuY2UodGhpcy5fa2V5LCB0aGlzLl9maXJlc3RvcmUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLCBcImV4aXN0c1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kb2N1bWVudCAhPT0gbnVsbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEb2N1bWVudFNuYXBzaG90LnByb3RvdHlwZSwgXCJtZXRhZGF0YVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgU25hcHNob3RNZXRhZGF0YSh0aGlzLl9oYXNQZW5kaW5nV3JpdGVzLCB0aGlzLl9mcm9tQ2FjaGUpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUuaXNFcXVhbCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgRG9jdW1lbnRTbmFwc2hvdCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZENsYXNzRXJyb3IoJ2lzRXF1YWwnLCAnRG9jdW1lbnRTbmFwc2hvdCcsIDEsIG90aGVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLl9maXJlc3RvcmUgPT09IG90aGVyLl9maXJlc3RvcmUgJiZcclxuICAgICAgICAgICAgdGhpcy5fZnJvbUNhY2hlID09PSBvdGhlci5fZnJvbUNhY2hlICYmXHJcbiAgICAgICAgICAgIHRoaXMuX2tleS5pc0VxdWFsKG90aGVyLl9rZXkpICYmXHJcbiAgICAgICAgICAgICh0aGlzLl9kb2N1bWVudCA9PT0gbnVsbFxyXG4gICAgICAgICAgICAgICAgPyBvdGhlci5fZG9jdW1lbnQgPT09IG51bGxcclxuICAgICAgICAgICAgICAgIDogdGhpcy5fZG9jdW1lbnQuaXNFcXVhbChvdGhlci5fZG9jdW1lbnQpKSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRTbmFwc2hvdC5wcm90b3R5cGUuY29udmVydE9iamVjdCA9IGZ1bmN0aW9uIChkYXRhLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICAgICAgZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gX3RoaXMuY29udmVydFZhbHVlKHZhbHVlLCBvcHRpb25zKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLmNvbnZlcnRWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgb3B0aW9ucykge1xyXG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE9iamVjdFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRPYmplY3QodmFsdWUsIG9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5VmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydEFycmF5KHZhbHVlLCBvcHRpb25zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBSZWZWYWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdmFsdWUudmFsdWUob3B0aW9ucyk7XHJcbiAgICAgICAgICAgIHZhciBkYXRhYmFzZSA9IHRoaXMuX2ZpcmVzdG9yZS5lbnN1cmVDbGllbnRDb25maWd1cmVkKCkuZGF0YWJhc2VJZCgpO1xyXG4gICAgICAgICAgICBpZiAoIXZhbHVlLmRhdGFiYXNlSWQuaXNFcXVhbChkYXRhYmFzZSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYi82NDEzMDIwMik6IFNvbWVob3cgc3VwcG9ydCBmb3JlaWduIHJlZmVyZW5jZXMuXHJcbiAgICAgICAgICAgICAgICBlcnJvcihcIkRvY3VtZW50IFwiICsgdGhpcy5fa2V5LnBhdGggKyBcIiBjb250YWlucyBhIGRvY3VtZW50IFwiICtcclxuICAgICAgICAgICAgICAgICAgICBcInJlZmVyZW5jZSB3aXRoaW4gYSBkaWZmZXJlbnQgZGF0YWJhc2UgKFwiICtcclxuICAgICAgICAgICAgICAgICAgICAodmFsdWUuZGF0YWJhc2VJZC5wcm9qZWN0SWQgKyBcIi9cIiArIHZhbHVlLmRhdGFiYXNlSWQuZGF0YWJhc2UgKyBcIikgd2hpY2ggaXMgbm90IFwiKSArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzdXBwb3J0ZWQuIEl0IHdpbGwgYmUgdHJlYXRlZCBhcyBhIHJlZmVyZW5jZSBpbiB0aGUgY3VycmVudCBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgKFwiZGF0YWJhc2UgKFwiICsgZGF0YWJhc2UucHJvamVjdElkICsgXCIvXCIgKyBkYXRhYmFzZS5kYXRhYmFzZSArIFwiKSBcIikgK1xyXG4gICAgICAgICAgICAgICAgICAgIFwiaW5zdGVhZC5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFJlZmVyZW5jZShrZXksIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUudmFsdWUob3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERvY3VtZW50U25hcHNob3QucHJvdG90eXBlLmNvbnZlcnRBcnJheSA9IGZ1bmN0aW9uIChkYXRhLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gZGF0YS5pbnRlcm5hbFZhbHVlLm1hcChmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNvbnZlcnRWYWx1ZSh2YWx1ZSwgb3B0aW9ucyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERvY3VtZW50U25hcHNob3Q7XHJcbn0oKSk7XHJcbnZhciBRdWVyeURvY3VtZW50U25hcHNob3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhRdWVyeURvY3VtZW50U25hcHNob3QsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBRdWVyeURvY3VtZW50U25hcHNob3QoZmlyZXN0b3JlLCBrZXksIGRvY3VtZW50LCBmcm9tQ2FjaGUsIGhhc1BlbmRpbmdXcml0ZXMpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgZmlyZXN0b3JlLCBrZXksIGRvY3VtZW50LCBmcm9tQ2FjaGUsIGhhc1BlbmRpbmdXcml0ZXMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBRdWVyeURvY3VtZW50U25hcHNob3QucHJvdG90eXBlLmRhdGEgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBkYXRhID0gX3N1cGVyLnByb3RvdHlwZS5kYXRhLmNhbGwodGhpcywgb3B0aW9ucyk7XHJcbiAgICAgICAgYXNzZXJ0KHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JywgJ0RvY3VtZW50IGluIGEgUXVlcnlEb2N1bWVudFNuYXBzaG90IHNob3VsZCBleGlzdCcpO1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeURvY3VtZW50U25hcHNob3Q7XHJcbn0oRG9jdW1lbnRTbmFwc2hvdCkpO1xyXG52YXIgUXVlcnkkMSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5JCQxKF9xdWVyeSwgZmlyZXN0b3JlKSB7XHJcbiAgICAgICAgdGhpcy5fcXVlcnkgPSBfcXVlcnk7XHJcbiAgICAgICAgdGhpcy5maXJlc3RvcmUgPSBmaXJlc3RvcmU7XHJcbiAgICB9XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUud2hlcmUgPSBmdW5jdGlvbiAoZmllbGQsIG9wU3RyLCB2YWx1ZSkge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ1F1ZXJ5LndoZXJlJywgYXJndW1lbnRzLCAzKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ1F1ZXJ5LndoZXJlJywgJ25vbi1lbXB0eSBzdHJpbmcnLCAyLCBvcFN0cik7XHJcbiAgICAgICAgdmFsaWRhdGVEZWZpbmVkKCdRdWVyeS53aGVyZScsIDMsIHZhbHVlKTtcclxuICAgICAgICB2YXIgZmllbGRWYWx1ZTtcclxuICAgICAgICB2YXIgZmllbGRQYXRoID0gZmllbGRQYXRoRnJvbUFyZ3VtZW50KCdRdWVyeS53aGVyZScsIGZpZWxkKTtcclxuICAgICAgICB2YXIgcmVsYXRpb25PcCA9IFJlbGF0aW9uT3AuZnJvbVN0cmluZyhvcFN0cik7XHJcbiAgICAgICAgaWYgKGZpZWxkUGF0aC5pc0tleUZpZWxkKCkpIHtcclxuICAgICAgICAgICAgaWYgKHJlbGF0aW9uT3AgPT09IFJlbGF0aW9uT3AuQVJSQVlfQ09OVEFJTlMpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBRdWVyeS4gWW91IGNhbid0IHBlcmZvcm0gYXJyYXktY29udGFpbnMgcXVlcmllcyBvbiBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgJ0ZpZWxkUGF0aC5kb2N1bWVudElkKCkgc2luY2UgZG9jdW1lbnQgSURzIGFyZSBub3QgYXJyYXlzLicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUuaW5kZXhPZignLycpICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogQWxsb3cgc2xhc2hlcyBvbmNlIGFuY2VzdG9yIHF1ZXJpZXMgYXJlIHN1cHBvcnRlZFxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdGdW5jdGlvbiBRdWVyeS53aGVyZSgpIHJlcXVpcmVzIGl0cyB0aGlyZCBwYXJhbWV0ZXIgdG8gYmUgYSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ3ZhbGlkIGRvY3VtZW50IElEIGlmIHRoZSBmaXJzdCBwYXJhbWV0ZXIgaXMgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCBidXQgaXQgY29udGFpbnMgYSBzbGFzaC4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnRnVuY3Rpb24gUXVlcnkud2hlcmUoKSByZXF1aXJlcyBpdHMgdGhpcmQgcGFyYW1ldGVyIHRvIGJlIGEgJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd2YWxpZCBkb2N1bWVudCBJRCBpZiB0aGUgZmlyc3QgcGFyYW1ldGVyIGlzICcgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgYnV0IGl0IHdhcyBhbiBlbXB0eSBzdHJpbmcuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMuX3F1ZXJ5LnBhdGguY2hpbGQobmV3IFJlc291cmNlUGF0aChbdmFsdWVdKSk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQocGF0aC5sZW5ndGggJSAyID09PSAwLCAnUGF0aCBzaG91bGQgYmUgYSBkb2N1bWVudCBrZXknKTtcclxuICAgICAgICAgICAgICAgIGZpZWxkVmFsdWUgPSBuZXcgUmVmVmFsdWUodGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQsIG5ldyBEb2N1bWVudEtleShwYXRoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBEb2N1bWVudFJlZmVyZW5jZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlZiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgZmllbGRWYWx1ZSA9IG5ldyBSZWZWYWx1ZSh0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgcmVmLl9rZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJGdW5jdGlvbiBRdWVyeS53aGVyZSgpIHJlcXVpcmVzIGl0cyB0aGlyZCBwYXJhbWV0ZXIgdG8gYmUgYSBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzdHJpbmcgb3IgYSBEb2N1bWVudFJlZmVyZW5jZSBpZiB0aGUgZmlyc3QgcGFyYW1ldGVyIGlzIFwiICtcclxuICAgICAgICAgICAgICAgICAgICBcIkZpZWxkUGF0aC5kb2N1bWVudElkKCksIGJ1dCBpdCB3YXM6IFwiICtcclxuICAgICAgICAgICAgICAgICAgICAodmFsdWVEZXNjcmlwdGlvbih2YWx1ZSkgKyBcIi5cIikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmaWVsZFZhbHVlID0gdGhpcy5maXJlc3RvcmUuX2RhdGFDb252ZXJ0ZXIucGFyc2VRdWVyeVZhbHVlKCdRdWVyeS53aGVyZScsIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGZpbHRlciA9IEZpbHRlci5jcmVhdGUoZmllbGRQYXRoLCByZWxhdGlvbk9wLCBmaWVsZFZhbHVlKTtcclxuICAgICAgICB0aGlzLnZhbGlkYXRlTmV3RmlsdGVyKGZpbHRlcik7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSQkMSh0aGlzLl9xdWVyeS5hZGRGaWx0ZXIoZmlsdGVyKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5vcmRlckJ5ID0gZnVuY3Rpb24gKGZpZWxkLCBkaXJlY3Rpb25TdHIpIHtcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ1F1ZXJ5Lm9yZGVyQnknLCBhcmd1bWVudHMsIDEsIDIpO1xyXG4gICAgICAgIHZhbGlkYXRlT3B0aW9uYWxBcmdUeXBlKCdRdWVyeS5vcmRlckJ5JywgJ25vbi1lbXB0eSBzdHJpbmcnLCAyLCBkaXJlY3Rpb25TdHIpO1xyXG4gICAgICAgIHZhciBkaXJlY3Rpb247XHJcbiAgICAgICAgaWYgKGRpcmVjdGlvblN0ciA9PT0gdW5kZWZpbmVkIHx8IGRpcmVjdGlvblN0ciA9PT0gJ2FzYycpIHtcclxuICAgICAgICAgICAgZGlyZWN0aW9uID0gRGlyZWN0aW9uLkFTQ0VORElORztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZGlyZWN0aW9uU3RyID09PSAnZGVzYycpIHtcclxuICAgICAgICAgICAgZGlyZWN0aW9uID0gRGlyZWN0aW9uLkRFU0NFTkRJTkc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkZ1bmN0aW9uIFF1ZXJ5Lm9yZGVyQnkoKSBoYXMgdW5rbm93biBkaXJlY3Rpb24gJ1wiICsgZGlyZWN0aW9uU3RyICsgXCInLCBcIiArXHJcbiAgICAgICAgICAgICAgICBcImV4cGVjdGVkICdhc2MnIG9yICdkZXNjJy5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9xdWVyeS5zdGFydEF0ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIHF1ZXJ5LiBZb3UgbXVzdCBub3QgY2FsbCBRdWVyeS5zdGFydEF0KCkgb3IgJyArXHJcbiAgICAgICAgICAgICAgICAnUXVlcnkuc3RhcnRBZnRlcigpIGJlZm9yZSBjYWxsaW5nIFF1ZXJ5Lm9yZGVyQnkoKS4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3F1ZXJ5LmVuZEF0ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIHF1ZXJ5LiBZb3UgbXVzdCBub3QgY2FsbCBRdWVyeS5lbmRBdCgpIG9yICcgK1xyXG4gICAgICAgICAgICAgICAgJ1F1ZXJ5LmVuZEJlZm9yZSgpIGJlZm9yZSBjYWxsaW5nIFF1ZXJ5Lm9yZGVyQnkoKS4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGZpZWxkUGF0aCA9IGZpZWxkUGF0aEZyb21Bcmd1bWVudCgnUXVlcnkub3JkZXJCeScsIGZpZWxkKTtcclxuICAgICAgICB2YXIgb3JkZXJCeSA9IG5ldyBPcmRlckJ5KGZpZWxkUGF0aCwgZGlyZWN0aW9uKTtcclxuICAgICAgICB0aGlzLnZhbGlkYXRlTmV3T3JkZXJCeShvcmRlckJ5KTtcclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5JCQxKHRoaXMuX3F1ZXJ5LmFkZE9yZGVyQnkob3JkZXJCeSksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUubGltaXQgPSBmdW5jdGlvbiAobikge1xyXG4gICAgICAgIHZhbGlkYXRlRXhhY3ROdW1iZXJPZkFyZ3MoJ1F1ZXJ5LmxpbWl0JywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ1F1ZXJ5LmxpbWl0JywgJ251bWJlcicsIDEsIG4pO1xyXG4gICAgICAgIGlmIChuIDw9IDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIFF1ZXJ5LiBRdWVyeSBsaW1pdCAoXCIgKyBuICsgXCIpIGlzIGludmFsaWQuIExpbWl0IG11c3QgYmUgXCIgK1xyXG4gICAgICAgICAgICAgICAgJ3Bvc2l0aXZlLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5JCQxKHRoaXMuX3F1ZXJ5LndpdGhMaW1pdChuKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5zdGFydEF0ID0gZnVuY3Rpb24gKGRvY09yRmllbGQpIHtcclxuICAgICAgICB2YXIgZmllbGRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgZmllbGRzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ1F1ZXJ5LnN0YXJ0QXQnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhciBib3VuZCA9IHRoaXMuYm91bmRGcm9tRG9jT3JGaWVsZHMoJ1F1ZXJ5LnN0YXJ0QXQnLCBkb2NPckZpZWxkLCBmaWVsZHMsIFxyXG4gICAgICAgIC8qYmVmb3JlPSovIHRydWUpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkkJDEodGhpcy5fcXVlcnkud2l0aFN0YXJ0QXQoYm91bmQpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLnN0YXJ0QWZ0ZXIgPSBmdW5jdGlvbiAoZG9jT3JGaWVsZCkge1xyXG4gICAgICAgIHZhciBmaWVsZHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBmaWVsZHNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQXRMZWFzdE51bWJlck9mQXJncygnUXVlcnkuc3RhcnRBZnRlcicsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFyIGJvdW5kID0gdGhpcy5ib3VuZEZyb21Eb2NPckZpZWxkcygnUXVlcnkuc3RhcnRBZnRlcicsIGRvY09yRmllbGQsIGZpZWxkcywgXHJcbiAgICAgICAgLypiZWZvcmU9Ki8gZmFsc2UpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkkJDEodGhpcy5fcXVlcnkud2l0aFN0YXJ0QXQoYm91bmQpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmVuZEJlZm9yZSA9IGZ1bmN0aW9uIChkb2NPckZpZWxkKSB7XHJcbiAgICAgICAgdmFyIGZpZWxkcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGZpZWxkc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFsaWRhdGVBdExlYXN0TnVtYmVyT2ZBcmdzKCdRdWVyeS5lbmRCZWZvcmUnLCBhcmd1bWVudHMsIDEpO1xyXG4gICAgICAgIHZhciBib3VuZCA9IHRoaXMuYm91bmRGcm9tRG9jT3JGaWVsZHMoJ1F1ZXJ5LmVuZEJlZm9yZScsIGRvY09yRmllbGQsIGZpZWxkcywgXHJcbiAgICAgICAgLypiZWZvcmU9Ki8gdHJ1ZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSQkMSh0aGlzLl9xdWVyeS53aXRoRW5kQXQoYm91bmQpLCB0aGlzLmZpcmVzdG9yZSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmVuZEF0ID0gZnVuY3Rpb24gKGRvY09yRmllbGQpIHtcclxuICAgICAgICB2YXIgZmllbGRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgZmllbGRzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUF0TGVhc3ROdW1iZXJPZkFyZ3MoJ1F1ZXJ5LmVuZEF0JywgYXJndW1lbnRzLCAxKTtcclxuICAgICAgICB2YXIgYm91bmQgPSB0aGlzLmJvdW5kRnJvbURvY09yRmllbGRzKCdRdWVyeS5lbmRBdCcsIGRvY09yRmllbGQsIGZpZWxkcywgXHJcbiAgICAgICAgLypiZWZvcmU9Ki8gZmFsc2UpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnkkJDEodGhpcy5fcXVlcnkud2l0aEVuZEF0KGJvdW5kKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBRdWVyeSQkMSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZENsYXNzRXJyb3IoJ2lzRXF1YWwnLCAnUXVlcnknLCAxLCBvdGhlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAodGhpcy5maXJlc3RvcmUgPT09IG90aGVyLmZpcmVzdG9yZSAmJiB0aGlzLl9xdWVyeS5pc0VxdWFsKG90aGVyLl9xdWVyeSkpO1xyXG4gICAgfTtcclxuICAgIC8qKiBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgYm91bmQgZnJvbSBhIGRvY3VtZW50IG9yIGZpZWxkcyAqL1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmJvdW5kRnJvbURvY09yRmllbGRzID0gZnVuY3Rpb24gKG1ldGhvZE5hbWUsIGRvY09yRmllbGQsIGZpZWxkcywgYmVmb3JlKSB7XHJcbiAgICAgICAgdmFsaWRhdGVEZWZpbmVkKG1ldGhvZE5hbWUsIDEsIGRvY09yRmllbGQpO1xyXG4gICAgICAgIGlmIChkb2NPckZpZWxkIGluc3RhbmNlb2YgRG9jdW1lbnRTbmFwc2hvdCkge1xyXG4gICAgICAgICAgICBpZiAoZmllbGRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiVG9vIG1hbnkgYXJndW1lbnRzIHByb3ZpZGVkIHRvIFwiICsgbWV0aG9kTmFtZSArIFwiKCkuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzbmFwID0gZG9jT3JGaWVsZDtcclxuICAgICAgICAgICAgaWYgKCFzbmFwLmV4aXN0cykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuTk9UX0ZPVU5ELCBcIkNhbid0IHVzZSBhIERvY3VtZW50U25hcHNob3QgdGhhdCBkb2Vzbid0IGV4aXN0IGZvciBcIiArXHJcbiAgICAgICAgICAgICAgICAgICAgKG1ldGhvZE5hbWUgKyBcIigpLlwiKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm91bmRGcm9tRG9jdW1lbnQobWV0aG9kTmFtZSwgc25hcC5fZG9jdW1lbnQsIGJlZm9yZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgYWxsRmllbGRzID0gW2RvY09yRmllbGRdLmNvbmNhdChmaWVsZHMpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3VuZEZyb21GaWVsZHMobWV0aG9kTmFtZSwgYWxsRmllbGRzLCBiZWZvcmUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBhIEJvdW5kIGZyb20gYSBxdWVyeSBhbmQgYSBkb2N1bWVudC5cclxuICAgICAqXHJcbiAgICAgKiBOb3RlIHRoYXQgdGhlIEJvdW5kIHdpbGwgYWx3YXlzIGluY2x1ZGUgdGhlIGtleSBvZiB0aGUgZG9jdW1lbnRcclxuICAgICAqIGFuZCBzbyBvbmx5IHRoZSBwcm92aWRlZCBkb2N1bWVudCB3aWxsIGNvbXBhcmUgZXF1YWwgdG8gdGhlIHJldHVybmVkXHJcbiAgICAgKiBwb3NpdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBXaWxsIHRocm93IGlmIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBjb250YWluIGFsbCBmaWVsZHMgb2YgdGhlIG9yZGVyIGJ5XHJcbiAgICAgKiBvZiB0aGUgcXVlcnkuXHJcbiAgICAgKi9cclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5ib3VuZEZyb21Eb2N1bWVudCA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCBkb2MsIGJlZm9yZSkge1xyXG4gICAgICAgIHZhciBjb21wb25lbnRzID0gW107XHJcbiAgICAgICAgLy8gQmVjYXVzZSBwZW9wbGUgZXhwZWN0IHRvIGNvbnRpbnVlL2VuZCBhIHF1ZXJ5IGF0IHRoZSBleGFjdCBkb2N1bWVudFxyXG4gICAgICAgIC8vIHByb3ZpZGVkLCB3ZSBuZWVkIHRvIHVzZSB0aGUgaW1wbGljaXQgc29ydCBvcmRlciByYXRoZXIgdGhhbiB0aGUgZXhwbGljaXRcclxuICAgICAgICAvLyBzb3J0IG9yZGVyLCBiZWNhdXNlIGl0J3MgZ3VhcmFudGVlZCB0byBjb250YWluIHRoZSBkb2N1bWVudCBrZXkuIFRoYXQgd2F5XHJcbiAgICAgICAgLy8gdGhlIHBvc2l0aW9uIGJlY29tZXMgdW5hbWJpZ3VvdXMgYW5kIHRoZSBxdWVyeSBjb250aW51ZXMvZW5kcyBleGFjdGx5IGF0XHJcbiAgICAgICAgLy8gdGhlIHByb3ZpZGVkIGRvY3VtZW50LiBXaXRob3V0IHRoZSBrZXkgKGJ5IHVzaW5nIHRoZSBleHBsaWNpdCBzb3J0XHJcbiAgICAgICAgLy8gb3JkZXJzKSwgbXVsdGlwbGUgZG9jdW1lbnRzIGNvdWxkIG1hdGNoIHRoZSBwb3NpdGlvbiwgeWllbGRpbmcgZHVwbGljYXRlXHJcbiAgICAgICAgLy8gcmVzdWx0cy5cclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fcXVlcnkub3JkZXJCeTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG9yZGVyQnkgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmIChvcmRlckJ5LmZpZWxkLmlzS2V5RmllbGQoKSkge1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKG5ldyBSZWZWYWx1ZSh0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgZG9jLmtleSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZG9jLmZpZWxkKG9yZGVyQnkuZmllbGQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRzLnB1c2godmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkID0gb3JkZXJCeS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFlvdSBhcmUgdHJ5aW5nIHRvIHN0YXJ0IG9yIGVuZCBhIHF1ZXJ5IHVzaW5nIGEgXCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAoXCJkb2N1bWVudCBmb3Igd2hpY2ggdGhlIGZpZWxkICdcIiArIGZpZWxkICsgXCInICh1c2VkIGFzIHRoZSBcIikgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm9yZGVyQnkpIGRvZXMgbm90IGV4aXN0LlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IEJvdW5kKGNvbXBvbmVudHMsIGJlZm9yZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb252ZXJ0cyBhIGxpc3Qgb2YgZmllbGQgdmFsdWVzIHRvIGEgQm91bmQgZm9yIHRoZSBnaXZlbiBxdWVyeS5cclxuICAgICAqL1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmJvdW5kRnJvbUZpZWxkcyA9IGZ1bmN0aW9uIChtZXRob2ROYW1lLCB2YWx1ZXMkJDEsIGJlZm9yZSkge1xyXG4gICAgICAgIC8vIFVzZSBleHBsaWNpdCBvcmRlciBieSdzIGJlY2F1c2UgaXQgaGFzIHRvIG1hdGNoIHRoZSBxdWVyeSB0aGUgdXNlciBtYWRlXHJcbiAgICAgICAgdmFyIG9yZGVyQnkgPSB0aGlzLl9xdWVyeS5leHBsaWNpdE9yZGVyQnk7XHJcbiAgICAgICAgaWYgKHZhbHVlcyQkMS5sZW5ndGggPiBvcmRlckJ5Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCBcIlRvbyBtYW55IGFyZ3VtZW50cyBwcm92aWRlZCB0byBcIiArIG1ldGhvZE5hbWUgKyBcIigpLiBcIiArXHJcbiAgICAgICAgICAgICAgICBcIlRoZSBudW1iZXIgb2YgYXJndW1lbnRzIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBcIiArXHJcbiAgICAgICAgICAgICAgICBcIm51bWJlciBvZiBRdWVyeS5vcmRlckJ5KCkgY2xhdXNlc1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvbXBvbmVudHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlcyQkMS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgcmF3VmFsdWUgPSB2YWx1ZXMkJDFbaV07XHJcbiAgICAgICAgICAgIHZhciBvcmRlckJ5Q29tcG9uZW50ID0gb3JkZXJCeVtpXTtcclxuICAgICAgICAgICAgaWYgKG9yZGVyQnlDb21wb25lbnQuZmllbGQuaXNLZXlGaWVsZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJhd1ZhbHVlICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gRXhwZWN0ZWQgYSBzdHJpbmcgZm9yIGRvY3VtZW50IElEIGluIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKG1ldGhvZE5hbWUgKyBcIigpLCBidXQgZ290IGEgXCIgKyB0eXBlb2YgcmF3VmFsdWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChyYXdWYWx1ZS5pbmRleE9mKCcvJykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHF1ZXJ5LiBEb2N1bWVudCBJRCAnXCIgKyByYXdWYWx1ZSArIFwiJyBjb250YWlucyBhIHNsYXNoIGluIFwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgKG1ldGhvZE5hbWUgKyBcIigpXCIpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBuZXcgRG9jdW1lbnRLZXkodGhpcy5fcXVlcnkucGF0aC5jaGlsZChyYXdWYWx1ZSkpO1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50cy5wdXNoKG5ldyBSZWZWYWx1ZSh0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwga2V5KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgd3JhcHBlZCA9IHRoaXMuZmlyZXN0b3JlLl9kYXRhQ29udmVydGVyLnBhcnNlUXVlcnlWYWx1ZShtZXRob2ROYW1lLCByYXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnRzLnB1c2god3JhcHBlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBCb3VuZChjb21wb25lbnRzLCBiZWZvcmUpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5vblNuYXBzaG90ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ1F1ZXJ5Lm9uU25hcHNob3QnLCBhcmd1bWVudHMsIDEsIDQpO1xyXG4gICAgICAgIHZhciBvcHRpb25zID0ge307XHJcbiAgICAgICAgdmFyIG9ic2VydmVyO1xyXG4gICAgICAgIHZhciBjdXJyQXJnID0gMDtcclxuICAgICAgICBpZiAodHlwZW9mIGFyZ3NbY3VyckFyZ10gPT09ICdvYmplY3QnICYmXHJcbiAgICAgICAgICAgICFpc1BhcnRpYWxPYnNlcnZlcihhcmdzW2N1cnJBcmddKSkge1xyXG4gICAgICAgICAgICBvcHRpb25zID0gYXJnc1tjdXJyQXJnXTtcclxuICAgICAgICAgICAgdmFsaWRhdGVPcHRpb25OYW1lcygnUXVlcnkub25TbmFwc2hvdCcsIG9wdGlvbnMsIFtcclxuICAgICAgICAgICAgICAgICdpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzJ1xyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsVHlwZSgnUXVlcnkub25TbmFwc2hvdCcsICdib29sZWFuJywgJ2luY2x1ZGVNZXRhZGF0YUNoYW5nZXMnLCBvcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMpO1xyXG4gICAgICAgICAgICBjdXJyQXJnKys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc1BhcnRpYWxPYnNlcnZlcihhcmdzW2N1cnJBcmddKSkge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IGFyZ3NbY3VyckFyZ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZUFyZ1R5cGUoJ1F1ZXJ5Lm9uU25hcHNob3QnLCAnZnVuY3Rpb24nLCBjdXJyQXJnLCBhcmdzW2N1cnJBcmddKTtcclxuICAgICAgICAgICAgdmFsaWRhdGVPcHRpb25hbEFyZ1R5cGUoJ1F1ZXJ5Lm9uU25hcHNob3QnLCAnZnVuY3Rpb24nLCBjdXJyQXJnICsgMSwgYXJnc1tjdXJyQXJnICsgMV0pO1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU9wdGlvbmFsQXJnVHlwZSgnUXVlcnkub25TbmFwc2hvdCcsICdmdW5jdGlvbicsIGN1cnJBcmcgKyAyLCBhcmdzW2N1cnJBcmcgKyAyXSk7XHJcbiAgICAgICAgICAgIG9ic2VydmVyID0ge1xyXG4gICAgICAgICAgICAgICAgbmV4dDogYXJnc1tjdXJyQXJnXSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBhcmdzW2N1cnJBcmcgKyAxXSxcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBhcmdzW2N1cnJBcmcgKyAyXVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5vblNuYXBzaG90SW50ZXJuYWwob3B0aW9ucywgb2JzZXJ2ZXIpO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5vblNuYXBzaG90SW50ZXJuYWwgPSBmdW5jdGlvbiAob3B0aW9ucywgb2JzZXJ2ZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBlcnJIYW5kbGVyID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmNhdWdodCBFcnJvciBpbiBvblNuYXBzaG90OicsIGVycik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IpIHtcclxuICAgICAgICAgICAgZXJySGFuZGxlciA9IG9ic2VydmVyLmVycm9yLmJpbmQob2JzZXJ2ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYXN5bmNPYnNlcnZlciA9IG5ldyBBc3luY09ic2VydmVyKHtcclxuICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyLm5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KG5ldyBRdWVyeVNuYXBzaG90KF90aGlzLmZpcmVzdG9yZSwgX3RoaXMuX3F1ZXJ5LCByZXN1bHQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGVyckhhbmRsZXJcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgZmlyZXN0b3JlQ2xpZW50ID0gdGhpcy5maXJlc3RvcmUuZW5zdXJlQ2xpZW50Q29uZmlndXJlZCgpO1xyXG4gICAgICAgIHZhciBpbnRlcm5hbExpc3RlbmVyID0gZmlyZXN0b3JlQ2xpZW50Lmxpc3Rlbih0aGlzLl9xdWVyeSwgYXN5bmNPYnNlcnZlciwgb3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgYXN5bmNPYnNlcnZlci5tdXRlKCk7XHJcbiAgICAgICAgICAgIGZpcmVzdG9yZUNsaWVudC51bmxpc3RlbihpbnRlcm5hbExpc3RlbmVyKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFsaWRhdGVCZXR3ZWVuTnVtYmVyT2ZBcmdzKCdRdWVyeS5nZXQnLCBhcmd1bWVudHMsIDAsIDEpO1xyXG4gICAgICAgIHZhbGlkYXRlR2V0T3B0aW9ucygnUXVlcnkuZ2V0Jywgb3B0aW9ucyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5zb3VyY2UgPT09ICdjYWNoZScpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmZpcmVzdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgIC5lbnN1cmVDbGllbnRDb25maWd1cmVkKClcclxuICAgICAgICAgICAgICAgICAgICAuZ2V0RG9jdW1lbnRzRnJvbUxvY2FsQ2FjaGUoX3RoaXMuX3F1ZXJ5KVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICh2aWV3U25hcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUobmV3IFF1ZXJ5U25hcHNob3QoX3RoaXMuZmlyZXN0b3JlLCBfdGhpcy5fcXVlcnksIHZpZXdTbmFwKSk7XHJcbiAgICAgICAgICAgICAgICB9LCByZWplY3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZ2V0VmlhU25hcHNob3RMaXN0ZW5lcihyZXNvbHZlLCByZWplY3QsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLmdldFZpYVNuYXBzaG90TGlzdGVuZXIgPSBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0LCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIHVubGlzdGVuID0gdGhpcy5vblNuYXBzaG90SW50ZXJuYWwoe1xyXG4gICAgICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiB0cnVlLFxyXG4gICAgICAgICAgICB3YWl0Rm9yU3luY1doZW5PbmxpbmU6IHRydWVcclxuICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBxdWVyeSBmaXJzdCBiZWZvcmUgcGFzc2luZyBldmVudCB0byB1c2VyIHRvIGF2b2lkXHJcbiAgICAgICAgICAgICAgICAvLyB1c2VyIGFjdGlvbnMgYWZmZWN0aW5nIHRoZSBub3cgc3RhbGUgcXVlcnkuXHJcbiAgICAgICAgICAgICAgICB1bmxpc3RlbigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5tZXRhZGF0YS5mcm9tQ2FjaGUgJiZcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zICYmXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5zb3VyY2UgPT09ICdzZXJ2ZXInKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLlVOQVZBSUxBQkxFLCAnRmFpbGVkIHRvIGdldCBkb2N1bWVudHMgZnJvbSBzZXJ2ZXIuIChIb3dldmVyLCB0aGVzZSAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RvY3VtZW50cyBtYXkgZXhpc3QgaW4gdGhlIGxvY2FsIGNhY2hlLiBSdW4gYWdhaW4gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd3aXRob3V0IHNldHRpbmcgc291cmNlIHRvIFwic2VydmVyXCIgdG8gJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdyZXRyaWV2ZSB0aGUgY2FjaGVkIGRvY3VtZW50cy4pJykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlcnJvcjogcmVqZWN0XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnkkJDEucHJvdG90eXBlLnZhbGlkYXRlTmV3RmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgIGlmIChmaWx0ZXIgaW5zdGFuY2VvZiBSZWxhdGlvbkZpbHRlcikge1xyXG4gICAgICAgICAgICBpZiAoZmlsdGVyLmlzSW5lcXVhbGl0eSgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGaWVsZCA9IHRoaXMuX3F1ZXJ5LmdldEluZXF1YWxpdHlGaWx0ZXJGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRmllbGQgIT09IG51bGwgJiYgIWV4aXN0aW5nRmllbGQuaXNFcXVhbChmaWx0ZXIuZmllbGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIEFsbCB3aGVyZSBmaWx0ZXJzIHdpdGggYW4gaW5lcXVhbGl0eScgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnICg8LCA8PSwgPiwgb3IgPj0pIG11c3QgYmUgb24gdGhlIHNhbWUgZmllbGQuIEJ1dCB5b3UgaGF2ZScgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAoXCIgaW5lcXVhbGl0eSBmaWx0ZXJzIG9uICdcIiArIGV4aXN0aW5nRmllbGQudG9TdHJpbmcoKSArIFwiJ1wiKSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChcIiBhbmQgJ1wiICsgZmlsdGVyLmZpZWxkLnRvU3RyaW5nKCkgKyBcIidcIikpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0T3JkZXJCeUZpZWxkID0gdGhpcy5fcXVlcnkuZ2V0Rmlyc3RPcmRlckJ5RmllbGQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChmaXJzdE9yZGVyQnlGaWVsZCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGVPcmRlckJ5QW5kSW5lcXVhbGl0eU1hdGNoKGZpbHRlci5maWVsZCwgZmlyc3RPcmRlckJ5RmllbGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGZpbHRlci5vcCA9PT0gUmVsYXRpb25PcC5BUlJBWV9DT05UQUlOUykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3F1ZXJ5Lmhhc0FycmF5Q29udGFpbnNGaWx0ZXIoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdJbnZhbGlkIHF1ZXJ5LiBRdWVyaWVzIG9ubHkgc3VwcG9ydCBhIHNpbmdsZSBhcnJheS1jb250YWlucyAnICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2ZpbHRlci4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBRdWVyeSQkMS5wcm90b3R5cGUudmFsaWRhdGVOZXdPcmRlckJ5ID0gZnVuY3Rpb24gKG9yZGVyQnkpIHtcclxuICAgICAgICBpZiAodGhpcy5fcXVlcnkuZ2V0Rmlyc3RPcmRlckJ5RmllbGQoKSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBvcmRlciBieS4gSXQgbXVzdCBtYXRjaCBhbnkgaW5lcXVhbGl0eS5cclxuICAgICAgICAgICAgdmFyIGluZXF1YWxpdHlGaWVsZCA9IHRoaXMuX3F1ZXJ5LmdldEluZXF1YWxpdHlGaWx0ZXJGaWVsZCgpO1xyXG4gICAgICAgICAgICBpZiAoaW5lcXVhbGl0eUZpZWxkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRlT3JkZXJCeUFuZEluZXF1YWxpdHlNYXRjaChpbmVxdWFsaXR5RmllbGQsIG9yZGVyQnkuZmllbGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFF1ZXJ5JCQxLnByb3RvdHlwZS52YWxpZGF0ZU9yZGVyQnlBbmRJbmVxdWFsaXR5TWF0Y2ggPSBmdW5jdGlvbiAoaW5lcXVhbGl0eSwgb3JkZXJCeSkge1xyXG4gICAgICAgIGlmICghb3JkZXJCeS5pc0VxdWFsKGluZXF1YWxpdHkpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IGhhdmUgYSB3aGVyZSBmaWx0ZXIgd2l0aCBhbiBpbmVxdWFsaXR5IFwiICtcclxuICAgICAgICAgICAgICAgIChcIig8LCA8PSwgPiwgb3IgPj0pIG9uIGZpZWxkICdcIiArIGluZXF1YWxpdHkudG9TdHJpbmcoKSArIFwiJyBcIikgK1xyXG4gICAgICAgICAgICAgICAgKFwiYW5kIHNvIHlvdSBtdXN0IGFsc28gdXNlICdcIiArIGluZXF1YWxpdHkudG9TdHJpbmcoKSArIFwiJyBcIikgK1xyXG4gICAgICAgICAgICAgICAgXCJhcyB5b3VyIGZpcnN0IFF1ZXJ5Lm9yZGVyQnkoKSwgYnV0IHlvdXIgZmlyc3QgUXVlcnkub3JkZXJCeSgpIFwiICtcclxuICAgICAgICAgICAgICAgIChcImlzIG9uIGZpZWxkICdcIiArIG9yZGVyQnkudG9TdHJpbmcoKSArIFwiJyBpbnN0ZWFkLlwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeSQkMTtcclxufSgpKTtcclxudmFyIFF1ZXJ5U25hcHNob3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBRdWVyeVNuYXBzaG90KF9maXJlc3RvcmUsIF9vcmlnaW5hbFF1ZXJ5LCBfc25hcHNob3QpIHtcclxuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSBfZmlyZXN0b3JlO1xyXG4gICAgICAgIHRoaXMuX29yaWdpbmFsUXVlcnkgPSBfb3JpZ2luYWxRdWVyeTtcclxuICAgICAgICB0aGlzLl9zbmFwc2hvdCA9IF9zbmFwc2hvdDtcclxuICAgICAgICB0aGlzLl9jYWNoZWRDaGFuZ2VzID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9jYWNoZWRDaGFuZ2VzSW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBTbmFwc2hvdE1ldGFkYXRhKF9zbmFwc2hvdC5oYXNQZW5kaW5nV3JpdGVzLCBfc25hcHNob3QuZnJvbUNhY2hlKTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShRdWVyeVNuYXBzaG90LnByb3RvdHlwZSwgXCJkb2NzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24gKGRvYykgeyByZXR1cm4gcmVzdWx0LnB1c2goZG9jKTsgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUsIFwiZW1wdHlcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc25hcHNob3QuZG9jcy5pc0VtcHR5KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUsIFwic2l6ZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zbmFwc2hvdC5kb2NzLnNpemU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBRdWVyeVNuYXBzaG90LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ1F1ZXJ5U25hcHNob3QuZm9yRWFjaCcsIGFyZ3VtZW50cywgMSwgMik7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdRdWVyeVNuYXBzaG90LmZvckVhY2gnLCAnZnVuY3Rpb24nLCAxLCBjYWxsYmFjayk7XHJcbiAgICAgICAgdGhpcy5fc25hcHNob3QuZG9jcy5mb3JFYWNoKGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCBfdGhpcy5jb252ZXJ0VG9Eb2N1bWVudEltcGwoZG9jKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLCBcInF1ZXJ5XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBRdWVyeSQxKHRoaXMuX29yaWdpbmFsUXVlcnksIHRoaXMuX2ZpcmVzdG9yZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBRdWVyeVNuYXBzaG90LnByb3RvdHlwZS5kb2NDaGFuZ2VzID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAob3B0aW9ucykge1xyXG4gICAgICAgICAgICB2YWxpZGF0ZU9wdGlvbk5hbWVzKCdRdWVyeVNuYXBzaG90LmRvY0NoYW5nZXMnLCBvcHRpb25zLCBbXHJcbiAgICAgICAgICAgICAgICAnaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcydcclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFR5cGUoJ1F1ZXJ5U25hcHNob3QuZG9jQ2hhbmdlcycsICdib29sZWFuJywgJ2luY2x1ZGVNZXRhZGF0YUNoYW5nZXMnLCBvcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyA9ICEhKG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzKTtcclxuICAgICAgICBpZiAoaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyAmJiB0aGlzLl9zbmFwc2hvdC5leGNsdWRlc01ldGFkYXRhQ2hhbmdlcykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnVG8gaW5jbHVkZSBtZXRhZGF0YSBjaGFuZ2VzIHdpdGggeW91ciBkb2N1bWVudCBjaGFuZ2VzLCB5b3UgbXVzdCAnICtcclxuICAgICAgICAgICAgICAgICdhbHNvIHBhc3MgeyBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOnRydWUgfSB0byBvblNuYXBzaG90KCkuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5fY2FjaGVkQ2hhbmdlcyB8fFxyXG4gICAgICAgICAgICB0aGlzLl9jYWNoZWRDaGFuZ2VzSW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyAhPT0gaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcykge1xyXG4gICAgICAgICAgICB0aGlzLl9jYWNoZWRDaGFuZ2VzID0gY2hhbmdlc0Zyb21TbmFwc2hvdCh0aGlzLl9maXJlc3RvcmUsIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXMsIHRoaXMuX3NuYXBzaG90KTtcclxuICAgICAgICAgICAgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPSBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FjaGVkQ2hhbmdlcztcclxuICAgIH07XHJcbiAgICAvKiogQ2hlY2sgdGhlIGVxdWFsaXR5LiBUaGUgY2FsbCBjYW4gYmUgdmVyeSBleHBlbnNpdmUuICovXHJcbiAgICBRdWVyeVNuYXBzaG90LnByb3RvdHlwZS5pc0VxdWFsID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBRdWVyeVNuYXBzaG90KSkge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkQ2xhc3NFcnJvcignaXNFcXVhbCcsICdRdWVyeVNuYXBzaG90JywgMSwgb3RoZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKHRoaXMuX2ZpcmVzdG9yZSA9PT0gb3RoZXIuX2ZpcmVzdG9yZSAmJlxyXG4gICAgICAgICAgICB0aGlzLl9vcmlnaW5hbFF1ZXJ5LmlzRXF1YWwob3RoZXIuX29yaWdpbmFsUXVlcnkpICYmXHJcbiAgICAgICAgICAgIHRoaXMuX3NuYXBzaG90LmlzRXF1YWwob3RoZXIuX3NuYXBzaG90KSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUuY29udmVydFRvRG9jdW1lbnRJbXBsID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIHJldHVybiBuZXcgUXVlcnlEb2N1bWVudFNuYXBzaG90KHRoaXMuX2ZpcmVzdG9yZSwgZG9jLmtleSwgZG9jLCB0aGlzLm1ldGFkYXRhLmZyb21DYWNoZSwgdGhpcy5fc25hcHNob3QubXV0YXRlZEtleXMuaGFzKGRvYy5rZXkpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUXVlcnlTbmFwc2hvdDtcclxufSgpKTtcclxuLy8gVE9ETygyMDE4LzExLzAxKTogQXMgb2YgMjAxOC8wNC8xNyB3ZSdyZSBjaGFuZ2luZyBkb2NDaGFuZ2VzIGZyb20gYW4gYXJyYXlcclxuLy8gaW50byBhIG1ldGhvZC4gQmVjYXVzZSB0aGlzIGlzIGEgcnVudGltZSBicmVha2luZyBjaGFuZ2UgYW5kIHNvbWV3aGF0IHN1YnRsZVxyXG4vLyAoYm90aCBBcnJheSBhbmQgRnVuY3Rpb24gaGF2ZSBhIC5sZW5ndGgsIGV0Yy4pLCB3ZSdsbCByZXBsYWNlIGNvbW1vbmx5LXVzZWRcclxuLy8gcHJvcGVydGllcyAoaW5jbHVkaW5nIFN5bWJvbC5pdGVyYXRvcikgdG8gdGhyb3cgYSBjdXN0b20gZXJyb3IgbWVzc2FnZS4gSW5cclxuLy8gfjYgbW9udGhzIHdlIGNhbiBkZWxldGUgdGhlIGN1c3RvbSBlcnJvciBhcyBtb3N0IGZvbGtzIHdpbGwgaGF2ZSBob3BlZnVsbHlcclxuLy8gbWlncmF0ZWQuXHJcbmZ1bmN0aW9uIHRocm93RG9jQ2hhbmdlc01ldGhvZEVycm9yKCkge1xyXG4gICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ1F1ZXJ5U25hcHNob3QuZG9jQ2hhbmdlcyBoYXMgYmVlbiBjaGFuZ2VkIGZyb20gYSBwcm9wZXJ0eSBpbnRvIGEgJyArXHJcbiAgICAgICAgJ21ldGhvZCwgc28gdXNhZ2VzIGxpa2UgXCJxdWVyeVNuYXBzaG90LmRvY0NoYW5nZXNcIiBzaG91bGQgYmVjb21lICcgK1xyXG4gICAgICAgICdcInF1ZXJ5U25hcHNob3QuZG9jQ2hhbmdlcygpXCInKTtcclxufVxyXG52YXIgZG9jQ2hhbmdlc1Byb3BlcnRpZXNUb092ZXJyaWRlID0gW1xyXG4gICAgJ2xlbmd0aCcsXHJcbiAgICAnZm9yRWFjaCcsXHJcbiAgICAnbWFwJ1xyXG5dLmNvbmNhdCgodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgPyBbU3ltYm9sLml0ZXJhdG9yXSA6IFtdKSk7XHJcbmRvY0NoYW5nZXNQcm9wZXJ0aWVzVG9PdmVycmlkZS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBXZSBhcmUgKHJlLSlkZWZpbmluZyBwcm9wZXJ0aWVzIG9uIFF1ZXJ5U25hcHNob3QucHJvdG90eXBlLmRvY0NoYW5nZXMgd2hpY2hcclxuICAgICAqIGlzIGEgRnVuY3Rpb24uIFRoaXMgY291bGQgZmFpbCwgaW4gcGFydGljdWxhciBpbiB0aGUgY2FzZSBvZiAnbGVuZ3RoJyB3aGljaFxyXG4gICAgICogYWxyZWFkeSBleGlzdHMgb24gRnVuY3Rpb24ucHJvdG90eXBlIGFuZCBvbiBJRTExIGlzIGltcHJvcGVybHkgZGVmaW5lZCB3aXRoXHJcbiAgICAgKiBgeyBjb25maWd1cmFibGU6IGZhbHNlIH1gLiBTbyB3ZSB3cmFwIHRoaXMgaW4gYSB0cnkvY2F0Y2ggdG8gZW5zdXJlIHRoYXQgd2VcclxuICAgICAqIHN0aWxsIGhhdmUgYSBmdW5jdGlvbmFsIFNESy5cclxuICAgICAqL1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUXVlcnlTbmFwc2hvdC5wcm90b3R5cGUuZG9jQ2hhbmdlcywgcHJvcGVydHksIHtcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aHJvd0RvY0NoYW5nZXNNZXRob2RFcnJvcigpOyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyKSB7IH0gLy8gSWdub3JlIHRoaXMgZmFpbHVyZSBpbnRlbnRpb25hbGx5XHJcbn0pO1xyXG52YXIgQ29sbGVjdGlvblJlZmVyZW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKENvbGxlY3Rpb25SZWZlcmVuY2UsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uUmVmZXJlbmNlKHBhdGgsIGZpcmVzdG9yZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIFF1ZXJ5LmF0UGF0aChwYXRoKSwgZmlyZXN0b3JlKSB8fCB0aGlzO1xyXG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCAlIDIgIT09IDEpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgY29sbGVjdGlvbiByZWZlcmVuY2UuIENvbGxlY3Rpb24gJyArXHJcbiAgICAgICAgICAgICAgICAncmVmZXJlbmNlcyBtdXN0IGhhdmUgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICcgK1xyXG4gICAgICAgICAgICAgICAgKHBhdGguY2Fub25pY2FsU3RyaW5nKCkgKyBcIiBoYXMgXCIgKyBwYXRoLmxlbmd0aCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sbGVjdGlvblJlZmVyZW5jZS5wcm90b3R5cGUsIFwiaWRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcXVlcnkucGF0aC5sYXN0U2VnbWVudCgpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbGxlY3Rpb25SZWZlcmVuY2UucHJvdG90eXBlLCBcInBhcmVudFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnRQYXRoID0gdGhpcy5fcXVlcnkucGF0aC5wb3BMYXN0KCk7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnRQYXRoLmlzRW1wdHkoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERvY3VtZW50UmVmZXJlbmNlKG5ldyBEb2N1bWVudEtleShwYXJlbnRQYXRoKSwgdGhpcy5maXJlc3RvcmUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sbGVjdGlvblJlZmVyZW5jZS5wcm90b3R5cGUsIFwicGF0aFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9xdWVyeS5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQ29sbGVjdGlvblJlZmVyZW5jZS5wcm90b3R5cGUuZG9jID0gZnVuY3Rpb24gKHBhdGhTdHJpbmcpIHtcclxuICAgICAgICB2YWxpZGF0ZUJldHdlZW5OdW1iZXJPZkFyZ3MoJ0NvbGxlY3Rpb25SZWZlcmVuY2UuZG9jJywgYXJndW1lbnRzLCAwLCAxKTtcclxuICAgICAgICAvLyBXZSBhbGxvdyBvbWlzc2lvbiBvZiAncGF0aFN0cmluZycgYnV0IGV4cGxpY2l0bHkgcHJvaGliaXQgcGFzc2luZyBpbiBib3RoXHJcbiAgICAgICAgLy8gJ3VuZGVmaW5lZCcgYW5kICdudWxsJy5cclxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBwYXRoU3RyaW5nID0gQXV0b0lkLm5ld0lkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhbGlkYXRlQXJnVHlwZSgnQ29sbGVjdGlvblJlZmVyZW5jZS5kb2MnLCAnbm9uLWVtcHR5IHN0cmluZycsIDEsIHBhdGhTdHJpbmcpO1xyXG4gICAgICAgIGlmIChwYXRoU3RyaW5nID09PSAnJykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRmlyZXN0b3JlRXJyb3IoQ29kZS5JTlZBTElEX0FSR1VNRU5ULCAnRG9jdW1lbnQgcGF0aCBtdXN0IGJlIGEgbm9uLWVtcHR5IHN0cmluZycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcGF0aCA9IFJlc291cmNlUGF0aC5mcm9tU3RyaW5nKHBhdGhTdHJpbmcpO1xyXG4gICAgICAgIHJldHVybiBEb2N1bWVudFJlZmVyZW5jZS5mb3JQYXRoKHRoaXMuX3F1ZXJ5LnBhdGguY2hpbGQocGF0aCksIHRoaXMuZmlyZXN0b3JlKTtcclxuICAgIH07XHJcbiAgICBDb2xsZWN0aW9uUmVmZXJlbmNlLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICB2YWxpZGF0ZUV4YWN0TnVtYmVyT2ZBcmdzKCdDb2xsZWN0aW9uUmVmZXJlbmNlLmFkZCcsIGFyZ3VtZW50cywgMSk7XHJcbiAgICAgICAgdmFsaWRhdGVBcmdUeXBlKCdDb2xsZWN0aW9uUmVmZXJlbmNlLmFkZCcsICdvYmplY3QnLCAxLCB2YWx1ZSk7XHJcbiAgICAgICAgdmFyIGRvY1JlZiA9IHRoaXMuZG9jKCk7XHJcbiAgICAgICAgcmV0dXJuIGRvY1JlZi5zZXQodmFsdWUpLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gZG9jUmVmOyB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ29sbGVjdGlvblJlZmVyZW5jZTtcclxufShRdWVyeSQxKSk7XHJcbmZ1bmN0aW9uIHZhbGlkYXRlU2V0T3B0aW9ucyhtZXRob2ROYW1lLCBvcHRpb25zKSB7XHJcbiAgICBpZiAob3B0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbWVyZ2U6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIHZhbGlkYXRlT3B0aW9uTmFtZXMobWV0aG9kTmFtZSwgb3B0aW9ucywgWydtZXJnZScsICdtZXJnZUZpZWxkcyddKTtcclxuICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFR5cGUobWV0aG9kTmFtZSwgJ2Jvb2xlYW4nLCAnbWVyZ2UnLCBvcHRpb25zLm1lcmdlKTtcclxuICAgIHZhbGlkYXRlT3B0aW9uYWxBcnJheUVsZW1lbnRzKG1ldGhvZE5hbWUsICdtZXJnZUZpZWxkcycsICdhIHN0cmluZyBvciBhIEZpZWxkUGF0aCcsIG9wdGlvbnMubWVyZ2VGaWVsZHMsIGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBlbGVtZW50ID09PSAnc3RyaW5nJyB8fCBlbGVtZW50IGluc3RhbmNlb2YgRmllbGRQYXRoJDE7XHJcbiAgICB9KTtcclxuICAgIGlmIChvcHRpb25zLm1lcmdlRmllbGRzICE9PSB1bmRlZmluZWQgJiYgb3B0aW9ucy5tZXJnZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEZpcmVzdG9yZUVycm9yKENvZGUuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIG9wdGlvbnMgcGFzc2VkIHRvIGZ1bmN0aW9uIFwiICsgbWV0aG9kTmFtZSArIFwiKCk6IFlvdSBjYW5ub3Qgc3BlY2lmeSBib3RoIFxcXCJtZXJnZVxcXCIgXCIgK1xyXG4gICAgICAgICAgICBcImFuZCBcXFwibWVyZ2VGaWVsZHNcXFwiLlwiKTtcclxuICAgIH1cclxuICAgIHJldHVybiBvcHRpb25zO1xyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlU25hcHNob3RPcHRpb25zKG1ldGhvZE5hbWUsIG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm4ge307XHJcbiAgICB9XHJcbiAgICB2YWxpZGF0ZU9wdGlvbk5hbWVzKG1ldGhvZE5hbWUsIG9wdGlvbnMsIFsnc2VydmVyVGltZXN0YW1wcyddKTtcclxuICAgIHZhbGlkYXRlTmFtZWRPcHRpb25hbFByb3BlcnR5RXF1YWxzKG1ldGhvZE5hbWUsICdvcHRpb25zJywgJ3NlcnZlclRpbWVzdGFtcHMnLCBvcHRpb25zLnNlcnZlclRpbWVzdGFtcHMsIFsnZXN0aW1hdGUnLCAncHJldmlvdXMnLCAnbm9uZSddKTtcclxuICAgIHJldHVybiBvcHRpb25zO1xyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlR2V0T3B0aW9ucyhtZXRob2ROYW1lLCBvcHRpb25zKSB7XHJcbiAgICB2YWxpZGF0ZU9wdGlvbmFsQXJnVHlwZShtZXRob2ROYW1lLCAnb2JqZWN0JywgMSwgb3B0aW9ucyk7XHJcbiAgICBpZiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhbGlkYXRlT3B0aW9uTmFtZXMobWV0aG9kTmFtZSwgb3B0aW9ucywgWydzb3VyY2UnXSk7XHJcbiAgICAgICAgdmFsaWRhdGVOYW1lZE9wdGlvbmFsUHJvcGVydHlFcXVhbHMobWV0aG9kTmFtZSwgJ29wdGlvbnMnLCAnc291cmNlJywgb3B0aW9ucy5zb3VyY2UsIFsnZGVmYXVsdCcsICdzZXJ2ZXInLCAnY2FjaGUnXSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVSZWZlcmVuY2UobWV0aG9kTmFtZSwgZG9jdW1lbnRSZWYsIGZpcmVzdG9yZSkge1xyXG4gICAgaWYgKCEoZG9jdW1lbnRSZWYgaW5zdGFuY2VvZiBEb2N1bWVudFJlZmVyZW5jZSkpIHtcclxuICAgICAgICB0aHJvdyBpbnZhbGlkQ2xhc3NFcnJvcihtZXRob2ROYW1lLCAnRG9jdW1lbnRSZWZlcmVuY2UnLCAxLCBkb2N1bWVudFJlZik7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChkb2N1bWVudFJlZi5maXJlc3RvcmUgIT09IGZpcmVzdG9yZSkge1xyXG4gICAgICAgIHRocm93IG5ldyBGaXJlc3RvcmVFcnJvcihDb2RlLklOVkFMSURfQVJHVU1FTlQsICdQcm92aWRlZCBkb2N1bWVudCByZWZlcmVuY2UgaXMgZnJvbSBhIGRpZmZlcmVudCBGaXJlc3RvcmUgaW5zdGFuY2UuJyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnRSZWY7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIENhbGN1bGF0ZXMgdGhlIGFycmF5IG9mIGZpcmVzdG9yZS5Eb2N1bWVudENoYW5nZSdzIGZvciBhIGdpdmVuIFZpZXdTbmFwc2hvdC5cclxuICpcclxuICogRXhwb3J0ZWQgZm9yIHRlc3RpbmcuXHJcbiAqL1xyXG5mdW5jdGlvbiBjaGFuZ2VzRnJvbVNuYXBzaG90KGZpcmVzdG9yZSwgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcywgc25hcHNob3QpIHtcclxuICAgIGlmIChzbmFwc2hvdC5vbGREb2NzLmlzRW1wdHkoKSkge1xyXG4gICAgICAgIC8vIFNwZWNpYWwgY2FzZSB0aGUgZmlyc3Qgc25hcHNob3QgYmVjYXVzZSBpbmRleCBjYWxjdWxhdGlvbiBpcyBlYXN5IGFuZFxyXG4gICAgICAgIC8vIGZhc3RcclxuICAgICAgICB2YXIgbGFzdERvY18xO1xyXG4gICAgICAgIHZhciBpbmRleF8xID0gMDtcclxuICAgICAgICByZXR1cm4gc25hcHNob3QuZG9jQ2hhbmdlcy5tYXAoZnVuY3Rpb24gKGNoYW5nZSkge1xyXG4gICAgICAgICAgICB2YXIgZG9jID0gbmV3IFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdChmaXJlc3RvcmUsIGNoYW5nZS5kb2Mua2V5LCBjaGFuZ2UuZG9jLCBzbmFwc2hvdC5mcm9tQ2FjaGUsIHNuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhjaGFuZ2UuZG9jLmtleSkpO1xyXG4gICAgICAgICAgICBhc3NlcnQoY2hhbmdlLnR5cGUgPT09IENoYW5nZVR5cGUuQWRkZWQsICdJbnZhbGlkIGV2ZW50IHR5cGUgZm9yIGZpcnN0IHNuYXBzaG90Jyk7XHJcbiAgICAgICAgICAgIGFzc2VydCghbGFzdERvY18xIHx8IHNuYXBzaG90LnF1ZXJ5LmRvY0NvbXBhcmF0b3IobGFzdERvY18xLCBjaGFuZ2UuZG9jKSA8IDAsICdHb3QgYWRkZWQgZXZlbnRzIGluIHdyb25nIG9yZGVyJyk7XHJcbiAgICAgICAgICAgIGxhc3REb2NfMSA9IGNoYW5nZS5kb2M7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnYWRkZWQnLFxyXG4gICAgICAgICAgICAgICAgZG9jOiBkb2MsXHJcbiAgICAgICAgICAgICAgICBvbGRJbmRleDogLTEsXHJcbiAgICAgICAgICAgICAgICBuZXdJbmRleDogaW5kZXhfMSsrXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBBIERvY3VtZW50U2V0IHRoYXQgaXMgdXBkYXRlZCBpbmNyZW1lbnRhbGx5IGFzIGNoYW5nZXMgYXJlIGFwcGxpZWQgdG8gdXNlXHJcbiAgICAgICAgLy8gdG8gbG9va3VwIHRoZSBpbmRleCBvZiBhIGRvY3VtZW50LlxyXG4gICAgICAgIHZhciBpbmRleFRyYWNrZXJfMSA9IHNuYXBzaG90Lm9sZERvY3M7XHJcbiAgICAgICAgcmV0dXJuIHNuYXBzaG90LmRvY0NoYW5nZXNcclxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoY2hhbmdlKSB7IHJldHVybiBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzIHx8IGNoYW5nZS50eXBlICE9PSBDaGFuZ2VUeXBlLk1ldGFkYXRhOyB9KVxyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChjaGFuZ2UpIHtcclxuICAgICAgICAgICAgdmFyIGRvYyA9IG5ldyBRdWVyeURvY3VtZW50U25hcHNob3QoZmlyZXN0b3JlLCBjaGFuZ2UuZG9jLmtleSwgY2hhbmdlLmRvYywgc25hcHNob3QuZnJvbUNhY2hlLCBzbmFwc2hvdC5tdXRhdGVkS2V5cy5oYXMoY2hhbmdlLmRvYy5rZXkpKTtcclxuICAgICAgICAgICAgdmFyIG9sZEluZGV4ID0gLTE7XHJcbiAgICAgICAgICAgIHZhciBuZXdJbmRleCA9IC0xO1xyXG4gICAgICAgICAgICBpZiAoY2hhbmdlLnR5cGUgIT09IENoYW5nZVR5cGUuQWRkZWQpIHtcclxuICAgICAgICAgICAgICAgIG9sZEluZGV4ID0gaW5kZXhUcmFja2VyXzEuaW5kZXhPZihjaGFuZ2UuZG9jLmtleSk7XHJcbiAgICAgICAgICAgICAgICBhc3NlcnQob2xkSW5kZXggPj0gMCwgJ0luZGV4IGZvciBkb2N1bWVudCBub3QgZm91bmQnKTtcclxuICAgICAgICAgICAgICAgIGluZGV4VHJhY2tlcl8xID0gaW5kZXhUcmFja2VyXzEuZGVsZXRlKGNoYW5nZS5kb2Mua2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY2hhbmdlLnR5cGUgIT09IENoYW5nZVR5cGUuUmVtb3ZlZCkge1xyXG4gICAgICAgICAgICAgICAgaW5kZXhUcmFja2VyXzEgPSBpbmRleFRyYWNrZXJfMS5hZGQoY2hhbmdlLmRvYyk7XHJcbiAgICAgICAgICAgICAgICBuZXdJbmRleCA9IGluZGV4VHJhY2tlcl8xLmluZGV4T2YoY2hhbmdlLmRvYy5rZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IHJlc3VsdENoYW5nZVR5cGUoY2hhbmdlLnR5cGUpLCBkb2M6IGRvYywgb2xkSW5kZXg6IG9sZEluZGV4LCBuZXdJbmRleDogbmV3SW5kZXggfTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXN1bHRDaGFuZ2VUeXBlKHR5cGUpIHtcclxuICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5BZGRlZDpcclxuICAgICAgICAgICAgcmV0dXJuICdhZGRlZCc7XHJcbiAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLk1vZGlmaWVkOlxyXG4gICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5NZXRhZGF0YTpcclxuICAgICAgICAgICAgcmV0dXJuICdtb2RpZmllZCc7XHJcbiAgICAgICAgY2FzZSBDaGFuZ2VUeXBlLlJlbW92ZWQ6XHJcbiAgICAgICAgICAgIHJldHVybiAncmVtb3ZlZCc7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIGZhaWwoJ1Vua25vd24gY2hhbmdlIHR5cGU6ICcgKyB0eXBlKTtcclxuICAgIH1cclxufVxyXG4vLyBFeHBvcnQgdGhlIGNsYXNzZXMgd2l0aCBhIHByaXZhdGUgY29uc3RydWN0b3IgKGl0IHdpbGwgZmFpbCBpZiBpbnZva2VkXHJcbi8vIGF0IHJ1bnRpbWUpLiBOb3RlIHRoYXQgdGhpcyBzdGlsbCBhbGxvd3MgaW5zdGFuY2VvZiBjaGVja3MuXHJcbi8vIFdlJ3JlIHRyZWF0aW5nIHRoZSB2YXJpYWJsZXMgYXMgY2xhc3MgbmFtZXMsIHNvIGRpc2FibGUgY2hlY2tpbmcgZm9yIGxvd2VyXHJcbi8vIGNhc2UgdmFyaWFibGUgbmFtZXMuXHJcbi8vIHRzbGludDpkaXNhYmxlOnZhcmlhYmxlLW5hbWVcclxudmFyIFB1YmxpY0ZpcmVzdG9yZSA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoRmlyZXN0b3JlLCAnVXNlIGZpcmViYXNlLmZpcmVzdG9yZSgpIGluc3RlYWQuJyk7XHJcbnZhciBQdWJsaWNUcmFuc2FjdGlvbiA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoVHJhbnNhY3Rpb24kMSwgJ1VzZSBmaXJlYmFzZS5maXJlc3RvcmUoKS5ydW5UcmFuc2FjdGlvbigpIGluc3RlYWQuJyk7XHJcbnZhciBQdWJsaWNXcml0ZUJhdGNoID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShXcml0ZUJhdGNoLCAnVXNlIGZpcmViYXNlLmZpcmVzdG9yZSgpLmJhdGNoKCkgaW5zdGVhZC4nKTtcclxudmFyIFB1YmxpY0RvY3VtZW50UmVmZXJlbmNlID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShEb2N1bWVudFJlZmVyZW5jZSwgJ1VzZSBmaXJlYmFzZS5maXJlc3RvcmUoKS5kb2MoKSBpbnN0ZWFkLicpO1xyXG52YXIgUHVibGljRG9jdW1lbnRTbmFwc2hvdCA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoRG9jdW1lbnRTbmFwc2hvdCk7XHJcbnZhciBQdWJsaWNRdWVyeURvY3VtZW50U25hcHNob3QgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdCk7XHJcbnZhciBQdWJsaWNRdWVyeSA9IG1ha2VDb25zdHJ1Y3RvclByaXZhdGUoUXVlcnkkMSk7XHJcbnZhciBQdWJsaWNRdWVyeVNuYXBzaG90ID0gbWFrZUNvbnN0cnVjdG9yUHJpdmF0ZShRdWVyeVNuYXBzaG90KTtcclxudmFyIFB1YmxpY0NvbGxlY3Rpb25SZWZlcmVuY2UgPSBtYWtlQ29uc3RydWN0b3JQcml2YXRlKENvbGxlY3Rpb25SZWZlcmVuY2UsICdVc2UgZmlyZWJhc2UuZmlyZXN0b3JlKCkuY29sbGVjdGlvbigpIGluc3RlYWQuJyk7XHJcbi8vIHRzbGludDplbmFibGU6dmFyaWFibGUtbmFtZVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIGZpcmVzdG9yZU5hbWVzcGFjZSA9IHtcclxuICAgIEZpcmVzdG9yZTogUHVibGljRmlyZXN0b3JlLFxyXG4gICAgR2VvUG9pbnQ6IEdlb1BvaW50LFxyXG4gICAgVGltZXN0YW1wOiBUaW1lc3RhbXAsXHJcbiAgICBCbG9iOiBQdWJsaWNCbG9iLFxyXG4gICAgVHJhbnNhY3Rpb246IFB1YmxpY1RyYW5zYWN0aW9uLFxyXG4gICAgV3JpdGVCYXRjaDogUHVibGljV3JpdGVCYXRjaCxcclxuICAgIERvY3VtZW50UmVmZXJlbmNlOiBQdWJsaWNEb2N1bWVudFJlZmVyZW5jZSxcclxuICAgIERvY3VtZW50U25hcHNob3Q6IFB1YmxpY0RvY3VtZW50U25hcHNob3QsXHJcbiAgICBRdWVyeTogUHVibGljUXVlcnksXHJcbiAgICBRdWVyeURvY3VtZW50U25hcHNob3Q6IFB1YmxpY1F1ZXJ5RG9jdW1lbnRTbmFwc2hvdCxcclxuICAgIFF1ZXJ5U25hcHNob3Q6IFB1YmxpY1F1ZXJ5U25hcHNob3QsXHJcbiAgICBDb2xsZWN0aW9uUmVmZXJlbmNlOiBQdWJsaWNDb2xsZWN0aW9uUmVmZXJlbmNlLFxyXG4gICAgRmllbGRQYXRoOiBGaWVsZFBhdGgkMSxcclxuICAgIEZpZWxkVmFsdWU6IFB1YmxpY0ZpZWxkVmFsdWUsXHJcbiAgICBzZXRMb2dMZXZlbDogRmlyZXN0b3JlLnNldExvZ0xldmVsXHJcbn07XHJcbi8qKlxyXG4gKiBDb25maWd1cmVzIEZpcmVzdG9yZSBhcyBwYXJ0IG9mIHRoZSBGaXJlYmFzZSBTREsgYnkgY2FsbGluZyByZWdpc3RlclNlcnZpY2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBjb25maWd1cmVGb3JGaXJlYmFzZShmaXJlYmFzZSQkMSkge1xyXG4gICAgZmlyZWJhc2UkJDEuSU5URVJOQUwucmVnaXN0ZXJTZXJ2aWNlKCdmaXJlc3RvcmUnLCBmdW5jdGlvbiAoYXBwKSB7IHJldHVybiBuZXcgRmlyZXN0b3JlKGFwcCk7IH0sIHNoYWxsb3dDb3B5KGZpcmVzdG9yZU5hbWVzcGFjZSkpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWdpc3RlckZpcmVzdG9yZShpbnN0YW5jZSkge1xyXG4gICAgY29uZmlndXJlRm9yRmlyZWJhc2UoaW5zdGFuY2UpO1xyXG59XHJcbnJlZ2lzdGVyRmlyZXN0b3JlKGZpcmViYXNlKTtcblxuZXhwb3J0cy5yZWdpc3RlckZpcmVzdG9yZSA9IHJlZ2lzdGVyRmlyZXN0b3JlO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L0BmaXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5janMuanNcbi8vIG1vZHVsZSBpZCA9IDM1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQSBjb250YWluZXIgZm9yIGFsbCBvZiB0aGUgTG9nZ2VyIGluc3RhbmNlc1xyXG4gKi9cclxudmFyIGluc3RhbmNlcyA9IFtdO1xyXG4vKipcclxuICogVGhlIEpTIFNESyBzdXBwb3J0cyA1IGxvZyBsZXZlbHMgYW5kIGFsc28gYWxsb3dzIGEgdXNlciB0aGUgYWJpbGl0eSB0b1xyXG4gKiBzaWxlbmNlIHRoZSBsb2dzIGFsdG9nZXRoZXIuXHJcbiAqXHJcbiAqIFRoZSBvcmRlciBpcyBhIGZvbGxvd3M6XHJcbiAqIERFQlVHIDwgVkVSQk9TRSA8IElORk8gPCBXQVJOIDwgRVJST1JcclxuICpcclxuICogQWxsIG9mIHRoZSBsb2cgdHlwZXMgYWJvdmUgdGhlIGN1cnJlbnQgbG9nIGxldmVsIHdpbGwgYmUgY2FwdHVyZWQgKGkuZS4gaWZcclxuICogeW91IHNldCB0aGUgbG9nIGxldmVsIHRvIGBJTkZPYCwgZXJyb3JzIHdpbGwgc3RpbGwgYmUgbG9nZ2VkLCBidXQgYERFQlVHYCBhbmRcclxuICogYFZFUkJPU0VgIGxvZ3Mgd2lsbCBub3QpXHJcbiAqL1xyXG52YXIgTG9nTGV2ZWw7XHJcbihmdW5jdGlvbiAoTG9nTGV2ZWwpIHtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiREVCVUdcIl0gPSAwXSA9IFwiREVCVUdcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiVkVSQk9TRVwiXSA9IDFdID0gXCJWRVJCT1NFXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIklORk9cIl0gPSAyXSA9IFwiSU5GT1wiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJXQVJOXCJdID0gM10gPSBcIldBUk5cIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiRVJST1JcIl0gPSA0XSA9IFwiRVJST1JcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiU0lMRU5UXCJdID0gNV0gPSBcIlNJTEVOVFwiO1xyXG59KShMb2dMZXZlbCB8fCAoTG9nTGV2ZWwgPSB7fSkpO1xyXG4vKipcclxuICogVGhlIGRlZmF1bHQgbG9nIGxldmVsXHJcbiAqL1xyXG52YXIgZGVmYXVsdExvZ0xldmVsID0gTG9nTGV2ZWwuSU5GTztcclxuLyoqXHJcbiAqIFRoZSBkZWZhdWx0IGxvZyBoYW5kbGVyIHdpbGwgZm9yd2FyZCBERUJVRywgVkVSQk9TRSwgSU5GTywgV0FSTiwgYW5kIEVSUk9SXHJcbiAqIG1lc3NhZ2VzIG9uIHRvIHRoZWlyIGNvcnJlc3BvbmRpbmcgY29uc29sZSBjb3VudGVycGFydHMgKGlmIHRoZSBsb2cgbWV0aG9kXHJcbiAqIGlzIHN1cHBvcnRlZCBieSB0aGUgY3VycmVudCBsb2cgbGV2ZWwpXHJcbiAqL1xyXG52YXIgZGVmYXVsdExvZ0hhbmRsZXIgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIGxvZ1R5cGUpIHtcclxuICAgIHZhciBhcmdzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICBpZiAobG9nVHlwZSA8IGluc3RhbmNlLmxvZ0xldmVsKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XHJcbiAgICBzd2l0Y2ggKGxvZ1R5cGUpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBCeSBkZWZhdWx0LCBgY29uc29sZS5kZWJ1Z2AgaXMgbm90IGRpc3BsYXllZCBpbiB0aGUgZGV2ZWxvcGVyIGNvbnNvbGUgKGluXHJcbiAgICAgICAgICogY2hyb21lKS4gVG8gYXZvaWQgZm9yY2luZyB1c2VycyB0byBoYXZlIHRvIG9wdC1pbiB0byB0aGVzZSBsb2dzIHR3aWNlXHJcbiAgICAgICAgICogKGkuZS4gb25jZSBmb3IgZmlyZWJhc2UsIGFuZCBvbmNlIGluIHRoZSBjb25zb2xlKSwgd2UgYXJlIHNlbmRpbmcgYERFQlVHYFxyXG4gICAgICAgICAqIGxvZ3MgdG8gdGhlIGBjb25zb2xlLmxvZ2AgZnVuY3Rpb24uXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5ERUJVRzpcclxuICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgW1wiW1wiICsgbm93ICsgXCJdICBcIiArIGluc3RhbmNlLm5hbWUgKyBcIjpcIl0uY29uY2F0KGFyZ3MpKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBMb2dMZXZlbC5WRVJCT1NFOlxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBbXCJbXCIgKyBub3cgKyBcIl0gIFwiICsgaW5zdGFuY2UubmFtZSArIFwiOlwiXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIExvZ0xldmVsLklORk86XHJcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mby5hcHBseShjb25zb2xlLCBbXCJbXCIgKyBub3cgKyBcIl0gIFwiICsgaW5zdGFuY2UubmFtZSArIFwiOlwiXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIExvZ0xldmVsLldBUk46XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybi5hcHBseShjb25zb2xlLCBbXCJbXCIgKyBub3cgKyBcIl0gIFwiICsgaW5zdGFuY2UubmFtZSArIFwiOlwiXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIExvZ0xldmVsLkVSUk9SOlxyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUsIFtcIltcIiArIG5vdyArIFwiXSAgXCIgKyBpbnN0YW5jZS5uYW1lICsgXCI6XCJdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBsb2cgYSBtZXNzYWdlIHdpdGggYW4gaW52YWxpZCBsb2dUeXBlICh2YWx1ZTogXCIgKyBsb2dUeXBlICsgXCIpXCIpO1xyXG4gICAgfVxyXG59O1xyXG52YXIgTG9nZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLyoqXHJcbiAgICAgKiBHaXZlcyB5b3UgYW4gaW5zdGFuY2Ugb2YgYSBMb2dnZXIgdG8gY2FwdHVyZSBtZXNzYWdlcyBhY2NvcmRpbmcgdG9cclxuICAgICAqIEZpcmViYXNlJ3MgbG9nZ2luZyBzY2hlbWUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgdGhhdCB0aGUgbG9ncyB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aFxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBMb2dnZXIobmFtZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGxvZyBsZXZlbCBvZiB0aGUgZ2l2ZW4gTG9nZ2VyIGluc3RhbmNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX2xvZ0xldmVsID0gZGVmYXVsdExvZ0xldmVsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBsb2cgaGFuZGxlciBmb3IgdGhlIExvZ2dlciBpbnN0YW5jZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyID0gZGVmYXVsdExvZ0hhbmRsZXI7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2FwdHVyZSB0aGUgY3VycmVudCBpbnN0YW5jZSBmb3IgbGF0ZXIgdXNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgaW5zdGFuY2VzLnB1c2godGhpcyk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTG9nZ2VyLnByb3RvdHlwZSwgXCJsb2dMZXZlbFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2dMZXZlbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgICAgICBpZiAoISh2YWwgaW4gTG9nTGV2ZWwpKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIHZhbHVlIGFzc2lnbmVkIHRvIGBsb2dMZXZlbGAnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9sb2dMZXZlbCA9IHZhbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMb2dnZXIucHJvdG90eXBlLCBcImxvZ0hhbmRsZXJcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9nSGFuZGxlcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbCAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVmFsdWUgYXNzaWduZWQgdG8gYGxvZ0hhbmRsZXJgIG11c3QgYmUgYSBmdW5jdGlvbicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIgPSB2YWw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBmdW5jdGlvbnMgYmVsb3cgYXJlIGFsbCBiYXNlZCBvbiB0aGUgYGNvbnNvbGVgIGludGVyZmFjZVxyXG4gICAgICovXHJcbiAgICBMb2dnZXIucHJvdG90eXBlLmRlYnVnID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyLmFwcGx5KHRoaXMsIFt0aGlzLCBMb2dMZXZlbC5ERUJVR10uY29uY2F0KGFyZ3MpKTtcclxuICAgIH07XHJcbiAgICBMb2dnZXIucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBbdGhpcywgTG9nTGV2ZWwuVkVSQk9TRV0uY29uY2F0KGFyZ3MpKTtcclxuICAgIH07XHJcbiAgICBMb2dnZXIucHJvdG90eXBlLmluZm8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIuYXBwbHkodGhpcywgW3RoaXMsIExvZ0xldmVsLklORk9dLmNvbmNhdChhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS53YXJuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyLmFwcGx5KHRoaXMsIFt0aGlzLCBMb2dMZXZlbC5XQVJOXS5jb25jYXQoYXJncykpO1xyXG4gICAgfTtcclxuICAgIExvZ2dlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIuYXBwbHkodGhpcywgW3RoaXMsIExvZ0xldmVsLkVSUk9SXS5jb25jYXQoYXJncykpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBMb2dnZXI7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRMb2dMZXZlbChsZXZlbCkge1xyXG4gICAgaW5zdGFuY2VzLmZvckVhY2goZnVuY3Rpb24gKGluc3QpIHtcclxuICAgICAgICBpbnN0LmxvZ0xldmVsID0gbGV2ZWw7XHJcbiAgICB9KTtcclxufVxuXG5leHBvcnQgeyBzZXRMb2dMZXZlbCwgTG9nZ2VyLCBMb2dMZXZlbCB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L0BmaXJlYmFzZS9sb2dnZXIvZGlzdC9pbmRleC5lc20uanNcbi8vIG1vZHVsZSBpZCA9IDM2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAnd2hhdHdnLWZldGNoJztcblxuLy8gU3RvcmUgc2V0VGltZW91dCByZWZlcmVuY2Ugc28gcHJvbWlzZS1wb2x5ZmlsbCB3aWxsIGJlIHVuYWZmZWN0ZWQgYnlcbi8vIG90aGVyIGNvZGUgbW9kaWZ5aW5nIHNldFRpbWVvdXQgKGxpa2Ugc2lub24udXNlRmFrZVRpbWVycygpKVxudmFyIHNldFRpbWVvdXRGdW5jID0gc2V0VGltZW91dDtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbi8vIFBvbHlmaWxsIGZvciBGdW5jdGlvbi5wcm90b3R5cGUuYmluZFxuZnVuY3Rpb24gYmluZChmbiwgdGhpc0FyZykge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgZm4uYXBwbHkodGhpc0FyZywgYXJndW1lbnRzKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gUHJvbWlzZShmbikge1xuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSkpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUHJvbWlzZXMgbXVzdCBiZSBjb25zdHJ1Y3RlZCB2aWEgbmV3Jyk7XG4gIGlmICh0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHRocm93IG5ldyBUeXBlRXJyb3IoJ25vdCBhIGZ1bmN0aW9uJyk7XG4gIHRoaXMuX3N0YXRlID0gMDtcbiAgdGhpcy5faGFuZGxlZCA9IGZhbHNlO1xuICB0aGlzLl92YWx1ZSA9IHVuZGVmaW5lZDtcbiAgdGhpcy5fZGVmZXJyZWRzID0gW107XG5cbiAgZG9SZXNvbHZlKGZuLCB0aGlzKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlKHNlbGYsIGRlZmVycmVkKSB7XG4gIHdoaWxlIChzZWxmLl9zdGF0ZSA9PT0gMykge1xuICAgIHNlbGYgPSBzZWxmLl92YWx1ZTtcbiAgfVxuICBpZiAoc2VsZi5fc3RhdGUgPT09IDApIHtcbiAgICBzZWxmLl9kZWZlcnJlZHMucHVzaChkZWZlcnJlZCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIHNlbGYuX2hhbmRsZWQgPSB0cnVlO1xuICBQcm9taXNlLl9pbW1lZGlhdGVGbihmdW5jdGlvbigpIHtcbiAgICB2YXIgY2IgPSBzZWxmLl9zdGF0ZSA9PT0gMSA/IGRlZmVycmVkLm9uRnVsZmlsbGVkIDogZGVmZXJyZWQub25SZWplY3RlZDtcbiAgICBpZiAoY2IgPT09IG51bGwpIHtcbiAgICAgIChzZWxmLl9zdGF0ZSA9PT0gMSA/IHJlc29sdmUgOiByZWplY3QpKGRlZmVycmVkLnByb21pc2UsIHNlbGYuX3ZhbHVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHJldDtcbiAgICB0cnkge1xuICAgICAgcmV0ID0gY2Ioc2VsZi5fdmFsdWUpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJlamVjdChkZWZlcnJlZC5wcm9taXNlLCBlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmVzb2x2ZShkZWZlcnJlZC5wcm9taXNlLCByZXQpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcmVzb2x2ZShzZWxmLCBuZXdWYWx1ZSkge1xuICB0cnkge1xuICAgIC8vIFByb21pc2UgUmVzb2x1dGlvbiBQcm9jZWR1cmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9wcm9taXNlcy1hcGx1cy9wcm9taXNlcy1zcGVjI3RoZS1wcm9taXNlLXJlc29sdXRpb24tcHJvY2VkdXJlXG4gICAgaWYgKG5ld1ZhbHVlID09PSBzZWxmKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQSBwcm9taXNlIGNhbm5vdCBiZSByZXNvbHZlZCB3aXRoIGl0c2VsZi4nKTtcbiAgICBpZiAoXG4gICAgICBuZXdWYWx1ZSAmJlxuICAgICAgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIG5ld1ZhbHVlID09PSAnZnVuY3Rpb24nKVxuICAgICkge1xuICAgICAgdmFyIHRoZW4gPSBuZXdWYWx1ZS50aGVuO1xuICAgICAgaWYgKG5ld1ZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICBzZWxmLl9zdGF0ZSA9IDM7XG4gICAgICAgIHNlbGYuX3ZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgIGZpbmFsZShzZWxmKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBkb1Jlc29sdmUoYmluZCh0aGVuLCBuZXdWYWx1ZSksIHNlbGYpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHNlbGYuX3N0YXRlID0gMTtcbiAgICBzZWxmLl92YWx1ZSA9IG5ld1ZhbHVlO1xuICAgIGZpbmFsZShzZWxmKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJlamVjdChzZWxmLCBlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZWplY3Qoc2VsZiwgbmV3VmFsdWUpIHtcbiAgc2VsZi5fc3RhdGUgPSAyO1xuICBzZWxmLl92YWx1ZSA9IG5ld1ZhbHVlO1xuICBmaW5hbGUoc2VsZik7XG59XG5cbmZ1bmN0aW9uIGZpbmFsZShzZWxmKSB7XG4gIGlmIChzZWxmLl9zdGF0ZSA9PT0gMiAmJiBzZWxmLl9kZWZlcnJlZHMubGVuZ3RoID09PSAwKSB7XG4gICAgUHJvbWlzZS5faW1tZWRpYXRlRm4oZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXNlbGYuX2hhbmRsZWQpIHtcbiAgICAgICAgUHJvbWlzZS5fdW5oYW5kbGVkUmVqZWN0aW9uRm4oc2VsZi5fdmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHNlbGYuX2RlZmVycmVkcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIGhhbmRsZShzZWxmLCBzZWxmLl9kZWZlcnJlZHNbaV0pO1xuICB9XG4gIHNlbGYuX2RlZmVycmVkcyA9IG51bGw7XG59XG5cbmZ1bmN0aW9uIEhhbmRsZXIob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQsIHByb21pc2UpIHtcbiAgdGhpcy5vbkZ1bGZpbGxlZCA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogbnVsbDtcbiAgdGhpcy5vblJlamVjdGVkID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT09ICdmdW5jdGlvbicgPyBvblJlamVjdGVkIDogbnVsbDtcbiAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTtcbn1cblxuLyoqXG4gKiBUYWtlIGEgcG90ZW50aWFsbHkgbWlzYmVoYXZpbmcgcmVzb2x2ZXIgZnVuY3Rpb24gYW5kIG1ha2Ugc3VyZVxuICogb25GdWxmaWxsZWQgYW5kIG9uUmVqZWN0ZWQgYXJlIG9ubHkgY2FsbGVkIG9uY2UuXG4gKlxuICogTWFrZXMgbm8gZ3VhcmFudGVlcyBhYm91dCBhc3luY2hyb255LlxuICovXG5mdW5jdGlvbiBkb1Jlc29sdmUoZm4sIHNlbGYpIHtcbiAgdmFyIGRvbmUgPSBmYWxzZTtcbiAgdHJ5IHtcbiAgICBmbihcbiAgICAgIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIGlmIChkb25lKSByZXR1cm47XG4gICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICByZXNvbHZlKHNlbGYsIHZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgaWYgKGRvbmUpIHJldHVybjtcbiAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgIHJlamVjdChzZWxmLCByZWFzb24pO1xuICAgICAgfVxuICAgICk7XG4gIH0gY2F0Y2ggKGV4KSB7XG4gICAgaWYgKGRvbmUpIHJldHVybjtcbiAgICBkb25lID0gdHJ1ZTtcbiAgICByZWplY3Qoc2VsZiwgZXgpO1xuICB9XG59XG5cblByb21pc2UucHJvdG90eXBlWydjYXRjaCddID0gZnVuY3Rpb24ob25SZWplY3RlZCkge1xuICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0ZWQpO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG4gIHZhciBwcm9tID0gbmV3IHRoaXMuY29uc3RydWN0b3Iobm9vcCk7XG5cbiAgaGFuZGxlKHRoaXMsIG5ldyBIYW5kbGVyKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBwcm9tKSk7XG4gIHJldHVybiBwcm9tO1xufTtcblxuUHJvbWlzZS5wcm90b3R5cGVbJ2ZpbmFsbHknXSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gIHZhciBjb25zdHJ1Y3RvciA9IHRoaXMuY29uc3RydWN0b3I7XG4gIHJldHVybiB0aGlzLnRoZW4oXG4gICAgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5yZXNvbHZlKGNhbGxiYWNrKCkpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gY29uc3RydWN0b3IucmVqZWN0KHJlYXNvbik7XG4gICAgICB9KTtcbiAgICB9XG4gICk7XG59O1xuXG5Qcm9taXNlLmFsbCA9IGZ1bmN0aW9uKGFycikge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgaWYgKCFhcnIgfHwgdHlwZW9mIGFyci5sZW5ndGggPT09ICd1bmRlZmluZWQnKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUHJvbWlzZS5hbGwgYWNjZXB0cyBhbiBhcnJheScpO1xuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTtcbiAgICBpZiAoYXJncy5sZW5ndGggPT09IDApIHJldHVybiByZXNvbHZlKFtdKTtcbiAgICB2YXIgcmVtYWluaW5nID0gYXJncy5sZW5ndGg7XG5cbiAgICBmdW5jdGlvbiByZXMoaSwgdmFsKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAodmFsICYmICh0eXBlb2YgdmFsID09PSAnb2JqZWN0JyB8fCB0eXBlb2YgdmFsID09PSAnZnVuY3Rpb24nKSkge1xuICAgICAgICAgIHZhciB0aGVuID0gdmFsLnRoZW47XG4gICAgICAgICAgaWYgKHR5cGVvZiB0aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGVuLmNhbGwoXG4gICAgICAgICAgICAgIHZhbCxcbiAgICAgICAgICAgICAgZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAgICAgcmVzKGksIHZhbCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHJlamVjdFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXJnc1tpXSA9IHZhbDtcbiAgICAgICAgaWYgKC0tcmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgICAgcmVzb2x2ZShhcmdzKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlcyhpLCBhcmdzW2ldKTtcbiAgICB9XG4gIH0pO1xufTtcblxuUHJvbWlzZS5yZXNvbHZlID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUuY29uc3RydWN0b3IgPT09IFByb21pc2UpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgIHJlc29sdmUodmFsdWUpO1xuICB9KTtcbn07XG5cblByb21pc2UucmVqZWN0ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHJlamVjdCh2YWx1ZSk7XG4gIH0pO1xufTtcblxuUHJvbWlzZS5yYWNlID0gZnVuY3Rpb24odmFsdWVzKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdmFsdWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICB2YWx1ZXNbaV0udGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH1cbiAgfSk7XG59O1xuXG4vLyBVc2UgcG9seWZpbGwgZm9yIHNldEltbWVkaWF0ZSBmb3IgcGVyZm9ybWFuY2UgZ2FpbnNcblByb21pc2UuX2ltbWVkaWF0ZUZuID1cbiAgKHR5cGVvZiBzZXRJbW1lZGlhdGUgPT09ICdmdW5jdGlvbicgJiZcbiAgICBmdW5jdGlvbihmbikge1xuICAgICAgc2V0SW1tZWRpYXRlKGZuKTtcbiAgICB9KSB8fFxuICBmdW5jdGlvbihmbikge1xuICAgIHNldFRpbWVvdXRGdW5jKGZuLCAwKTtcbiAgfTtcblxuUHJvbWlzZS5fdW5oYW5kbGVkUmVqZWN0aW9uRm4gPSBmdW5jdGlvbiBfdW5oYW5kbGVkUmVqZWN0aW9uRm4oZXJyKSB7XG4gIGlmICh0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgY29uc29sZSkge1xuICAgIGNvbnNvbGUud2FybignUG9zc2libGUgVW5oYW5kbGVkIFByb21pc2UgUmVqZWN0aW9uOicsIGVycik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICB9XG59O1xuXG52YXIgZ2xvYmFsTlMgPSAoZnVuY3Rpb24oKSB7XG4gIC8vIHRoZSBvbmx5IHJlbGlhYmxlIG1lYW5zIHRvIGdldCB0aGUgZ2xvYmFsIG9iamVjdCBpc1xuICAvLyBgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKWBcbiAgLy8gSG93ZXZlciwgdGhpcyBjYXVzZXMgQ1NQIHZpb2xhdGlvbnMgaW4gQ2hyb21lIGFwcHMuXG4gIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gc2VsZjtcbiAgfVxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gd2luZG93O1xuICB9XG4gIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBnbG9iYWw7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKCd1bmFibGUgdG8gbG9jYXRlIGdsb2JhbCBvYmplY3QnKTtcbn0pKCk7XG5cbmlmICghZ2xvYmFsTlMuUHJvbWlzZSkge1xuICBnbG9iYWxOUy5Qcm9taXNlID0gUHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29tbW9uanNNb2R1bGUoZm4sIG1vZHVsZSkge1xuXHRyZXR1cm4gbW9kdWxlID0geyBleHBvcnRzOiB7fSB9LCBmbihtb2R1bGUsIG1vZHVsZS5leHBvcnRzKSwgbW9kdWxlLmV4cG9ydHM7XG59XG5cbnZhciBfZ2xvYmFsID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkge1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzg2I2lzc3VlY29tbWVudC0xMTU3NTkwMjhcbnZhciBnbG9iYWwgPSBtb2R1bGUuZXhwb3J0cyA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93Lk1hdGggPT0gTWF0aFxuICA/IHdpbmRvdyA6IHR5cGVvZiBzZWxmICE9ICd1bmRlZmluZWQnICYmIHNlbGYuTWF0aCA9PSBNYXRoID8gc2VsZlxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tbmV3LWZ1bmNcbiAgOiBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuaWYgKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpIF9fZyA9IGdsb2JhbDsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxufSk7XG5cbnZhciBfY29yZSA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHtcbnZhciBjb3JlID0gbW9kdWxlLmV4cG9ydHMgPSB7IHZlcnNpb246ICcyLjUuNScgfTtcbmlmICh0eXBlb2YgX19lID09ICdudW1iZXInKSBfX2UgPSBjb3JlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG59KTtcbnZhciBfY29yZV8xID0gX2NvcmUudmVyc2lvbjtcblxudmFyIF9pc09iamVjdCA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nO1xufTtcblxudmFyIF9hbk9iamVjdCA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoIV9pc09iamVjdChpdCkpIHRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTtcbiAgcmV0dXJuIGl0O1xufTtcblxudmFyIF9mYWlscyA9IGZ1bmN0aW9uIChleGVjKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuICEhZXhlYygpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn07XG5cbi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHlcbnZhciBfZGVzY3JpcHRvcnMgPSAhX2ZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7IGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gNzsgfSB9KS5hICE9IDc7XG59KTtcblxudmFyIGRvY3VtZW50ID0gX2dsb2JhbC5kb2N1bWVudDtcbi8vIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50IGlzICdvYmplY3QnIGluIG9sZCBJRVxudmFyIGlzID0gX2lzT2JqZWN0KGRvY3VtZW50KSAmJiBfaXNPYmplY3QoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCk7XG52YXIgX2RvbUNyZWF0ZSA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXMgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGl0KSA6IHt9O1xufTtcblxudmFyIF9pZThEb21EZWZpbmUgPSAhX2Rlc2NyaXB0b3JzICYmICFfZmFpbHMoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KF9kb21DcmVhdGUoJ2RpdicpLCAnYScsIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiA3OyB9IH0pLmEgIT0gNztcbn0pO1xuXG4vLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSlcblxuLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2Vcbi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nXG52YXIgX3RvUHJpbWl0aXZlID0gZnVuY3Rpb24gKGl0LCBTKSB7XG4gIGlmICghX2lzT2JqZWN0KGl0KSkgcmV0dXJuIGl0O1xuICB2YXIgZm4sIHZhbDtcbiAgaWYgKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFfaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKSByZXR1cm4gdmFsO1xuICBpZiAodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIV9pc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIGlmICghUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIV9pc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZVwiKTtcbn07XG5cbnZhciBkUCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblxudmFyIGYgPSBfZGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydHkgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKSB7XG4gIF9hbk9iamVjdChPKTtcbiAgUCA9IF90b1ByaW1pdGl2ZShQLCB0cnVlKTtcbiAgX2FuT2JqZWN0KEF0dHJpYnV0ZXMpO1xuICBpZiAoX2llOERvbURlZmluZSkgdHJ5IHtcbiAgICByZXR1cm4gZFAoTywgUCwgQXR0cmlidXRlcyk7XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxuICBpZiAoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKSB0aHJvdyBUeXBlRXJyb3IoJ0FjY2Vzc29ycyBub3Qgc3VwcG9ydGVkIScpO1xuICBpZiAoJ3ZhbHVlJyBpbiBBdHRyaWJ1dGVzKSBPW1BdID0gQXR0cmlidXRlcy52YWx1ZTtcbiAgcmV0dXJuIE87XG59O1xuXG52YXIgX29iamVjdERwID0ge1xuXHRmOiBmXG59O1xuXG52YXIgX3Byb3BlcnR5RGVzYyA9IGZ1bmN0aW9uIChiaXRtYXAsIHZhbHVlKSB7XG4gIHJldHVybiB7XG4gICAgZW51bWVyYWJsZTogIShiaXRtYXAgJiAxKSxcbiAgICBjb25maWd1cmFibGU6ICEoYml0bWFwICYgMiksXG4gICAgd3JpdGFibGU6ICEoYml0bWFwICYgNCksXG4gICAgdmFsdWU6IHZhbHVlXG4gIH07XG59O1xuXG52YXIgX2hpZGUgPSBfZGVzY3JpcHRvcnMgPyBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7XG4gIHJldHVybiBfb2JqZWN0RHAuZihvYmplY3QsIGtleSwgX3Byb3BlcnR5RGVzYygxLCB2YWx1ZSkpO1xufSA6IGZ1bmN0aW9uIChvYmplY3QsIGtleSwgdmFsdWUpIHtcbiAgb2JqZWN0W2tleV0gPSB2YWx1ZTtcbiAgcmV0dXJuIG9iamVjdDtcbn07XG5cbnZhciBoYXNPd25Qcm9wZXJ0eSA9IHt9Lmhhc093blByb3BlcnR5O1xudmFyIF9oYXMgPSBmdW5jdGlvbiAoaXQsIGtleSkge1xuICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChpdCwga2V5KTtcbn07XG5cbnZhciBpZCA9IDA7XG52YXIgcHggPSBNYXRoLnJhbmRvbSgpO1xudmFyIF91aWQgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHJldHVybiAnU3ltYm9sKCcuY29uY2F0KGtleSA9PT0gdW5kZWZpbmVkID8gJycgOiBrZXksICcpXycsICgrK2lkICsgcHgpLnRvU3RyaW5nKDM2KSk7XG59O1xuXG52YXIgX3JlZGVmaW5lID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkge1xudmFyIFNSQyA9IF91aWQoJ3NyYycpO1xudmFyIFRPX1NUUklORyA9ICd0b1N0cmluZyc7XG52YXIgJHRvU3RyaW5nID0gRnVuY3Rpb25bVE9fU1RSSU5HXTtcbnZhciBUUEwgPSAoJycgKyAkdG9TdHJpbmcpLnNwbGl0KFRPX1NUUklORyk7XG5cbl9jb3JlLmluc3BlY3RTb3VyY2UgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuICR0b1N0cmluZy5jYWxsKGl0KTtcbn07XG5cbihtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChPLCBrZXksIHZhbCwgc2FmZSkge1xuICB2YXIgaXNGdW5jdGlvbiA9IHR5cGVvZiB2YWwgPT0gJ2Z1bmN0aW9uJztcbiAgaWYgKGlzRnVuY3Rpb24pIF9oYXModmFsLCAnbmFtZScpIHx8IF9oaWRlKHZhbCwgJ25hbWUnLCBrZXkpO1xuICBpZiAoT1trZXldID09PSB2YWwpIHJldHVybjtcbiAgaWYgKGlzRnVuY3Rpb24pIF9oYXModmFsLCBTUkMpIHx8IF9oaWRlKHZhbCwgU1JDLCBPW2tleV0gPyAnJyArIE9ba2V5XSA6IFRQTC5qb2luKFN0cmluZyhrZXkpKSk7XG4gIGlmIChPID09PSBfZ2xvYmFsKSB7XG4gICAgT1trZXldID0gdmFsO1xuICB9IGVsc2UgaWYgKCFzYWZlKSB7XG4gICAgZGVsZXRlIE9ba2V5XTtcbiAgICBfaGlkZShPLCBrZXksIHZhbCk7XG4gIH0gZWxzZSBpZiAoT1trZXldKSB7XG4gICAgT1trZXldID0gdmFsO1xuICB9IGVsc2Uge1xuICAgIF9oaWRlKE8sIGtleSwgdmFsKTtcbiAgfVxuLy8gYWRkIGZha2UgRnVuY3Rpb24jdG9TdHJpbmcgZm9yIGNvcnJlY3Qgd29yayB3cmFwcGVkIG1ldGhvZHMgLyBjb25zdHJ1Y3RvcnMgd2l0aCBtZXRob2RzIGxpa2UgTG9EYXNoIGlzTmF0aXZlXG59KShGdW5jdGlvbi5wcm90b3R5cGUsIFRPX1NUUklORywgZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gIHJldHVybiB0eXBlb2YgdGhpcyA9PSAnZnVuY3Rpb24nICYmIHRoaXNbU1JDXSB8fCAkdG9TdHJpbmcuY2FsbCh0aGlzKTtcbn0pO1xufSk7XG5cbnZhciBfYUZ1bmN0aW9uID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmICh0eXBlb2YgaXQgIT0gJ2Z1bmN0aW9uJykgdGhyb3cgVHlwZUVycm9yKGl0ICsgJyBpcyBub3QgYSBmdW5jdGlvbiEnKTtcbiAgcmV0dXJuIGl0O1xufTtcblxuLy8gb3B0aW9uYWwgLyBzaW1wbGUgY29udGV4dCBiaW5kaW5nXG5cbnZhciBfY3R4ID0gZnVuY3Rpb24gKGZuLCB0aGF0LCBsZW5ndGgpIHtcbiAgX2FGdW5jdGlvbihmbik7XG4gIGlmICh0aGF0ID09PSB1bmRlZmluZWQpIHJldHVybiBmbjtcbiAgc3dpdGNoIChsZW5ndGgpIHtcbiAgICBjYXNlIDE6IHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSk7XG4gICAgfTtcbiAgICBjYXNlIDI6IHJldHVybiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7XG4gICAgfTtcbiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbiAoYSwgYiwgYykge1xuICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYiwgYyk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gZnVuY3Rpb24gKC8qIC4uLmFyZ3MgKi8pIHtcbiAgICByZXR1cm4gZm4uYXBwbHkodGhhdCwgYXJndW1lbnRzKTtcbiAgfTtcbn07XG5cbnZhciBQUk9UT1RZUEUgPSAncHJvdG90eXBlJztcblxudmFyICRleHBvcnQgPSBmdW5jdGlvbiAodHlwZSwgbmFtZSwgc291cmNlKSB7XG4gIHZhciBJU19GT1JDRUQgPSB0eXBlICYgJGV4cG9ydC5GO1xuICB2YXIgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuRztcbiAgdmFyIElTX1NUQVRJQyA9IHR5cGUgJiAkZXhwb3J0LlM7XG4gIHZhciBJU19QUk9UTyA9IHR5cGUgJiAkZXhwb3J0LlA7XG4gIHZhciBJU19CSU5EID0gdHlwZSAmICRleHBvcnQuQjtcbiAgdmFyIHRhcmdldCA9IElTX0dMT0JBTCA/IF9nbG9iYWwgOiBJU19TVEFUSUMgPyBfZ2xvYmFsW25hbWVdIHx8IChfZ2xvYmFsW25hbWVdID0ge30pIDogKF9nbG9iYWxbbmFtZV0gfHwge30pW1BST1RPVFlQRV07XG4gIHZhciBleHBvcnRzID0gSVNfR0xPQkFMID8gX2NvcmUgOiBfY29yZVtuYW1lXSB8fCAoX2NvcmVbbmFtZV0gPSB7fSk7XG4gIHZhciBleHBQcm90byA9IGV4cG9ydHNbUFJPVE9UWVBFXSB8fCAoZXhwb3J0c1tQUk9UT1RZUEVdID0ge30pO1xuICB2YXIga2V5LCBvd24sIG91dCwgZXhwO1xuICBpZiAoSVNfR0xPQkFMKSBzb3VyY2UgPSBuYW1lO1xuICBmb3IgKGtleSBpbiBzb3VyY2UpIHtcbiAgICAvLyBjb250YWlucyBpbiBuYXRpdmVcbiAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkO1xuICAgIC8vIGV4cG9ydCBuYXRpdmUgb3IgcGFzc2VkXG4gICAgb3V0ID0gKG93biA/IHRhcmdldCA6IHNvdXJjZSlba2V5XTtcbiAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dFxuICAgIGV4cCA9IElTX0JJTkQgJiYgb3duID8gX2N0eChvdXQsIF9nbG9iYWwpIDogSVNfUFJPVE8gJiYgdHlwZW9mIG91dCA9PSAnZnVuY3Rpb24nID8gX2N0eChGdW5jdGlvbi5jYWxsLCBvdXQpIDogb3V0O1xuICAgIC8vIGV4dGVuZCBnbG9iYWxcbiAgICBpZiAodGFyZ2V0KSBfcmVkZWZpbmUodGFyZ2V0LCBrZXksIG91dCwgdHlwZSAmICRleHBvcnQuVSk7XG4gICAgLy8gZXhwb3J0XG4gICAgaWYgKGV4cG9ydHNba2V5XSAhPSBvdXQpIF9oaWRlKGV4cG9ydHMsIGtleSwgZXhwKTtcbiAgICBpZiAoSVNfUFJPVE8gJiYgZXhwUHJvdG9ba2V5XSAhPSBvdXQpIGV4cFByb3RvW2tleV0gPSBvdXQ7XG4gIH1cbn07XG5fZ2xvYmFsLmNvcmUgPSBfY29yZTtcbi8vIHR5cGUgYml0bWFwXG4kZXhwb3J0LkYgPSAxOyAgIC8vIGZvcmNlZFxuJGV4cG9ydC5HID0gMjsgICAvLyBnbG9iYWxcbiRleHBvcnQuUyA9IDQ7ICAgLy8gc3RhdGljXG4kZXhwb3J0LlAgPSA4OyAgIC8vIHByb3RvXG4kZXhwb3J0LkIgPSAxNjsgIC8vIGJpbmRcbiRleHBvcnQuVyA9IDMyOyAgLy8gd3JhcFxuJGV4cG9ydC5VID0gNjQ7ICAvLyBzYWZlXG4kZXhwb3J0LlIgPSAxMjg7IC8vIHJlYWwgcHJvdG8gbWV0aG9kIGZvciBgbGlicmFyeWBcbnZhciBfZXhwb3J0ID0gJGV4cG9ydDtcblxudmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7XG5cbnZhciBfY29mID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKGl0KS5zbGljZSg4LCAtMSk7XG59O1xuXG4vLyBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIGFuZCBub24tZW51bWVyYWJsZSBvbGQgVjggc3RyaW5nc1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcHJvdG90eXBlLWJ1aWx0aW5zXG52YXIgX2lvYmplY3QgPSBPYmplY3QoJ3onKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKSA/IE9iamVjdCA6IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gX2NvZihpdCkgPT0gJ1N0cmluZycgPyBpdC5zcGxpdCgnJykgOiBPYmplY3QoaXQpO1xufTtcblxuLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudClcbnZhciBfZGVmaW5lZCA9IGZ1bmN0aW9uIChpdCkge1xuICBpZiAoaXQgPT0gdW5kZWZpbmVkKSB0aHJvdyBUeXBlRXJyb3IoXCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgXCIgKyBpdCk7XG4gIHJldHVybiBpdDtcbn07XG5cbi8vIDcuMS4xMyBUb09iamVjdChhcmd1bWVudClcblxudmFyIF90b09iamVjdCA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gT2JqZWN0KF9kZWZpbmVkKGl0KSk7XG59O1xuXG4vLyA3LjEuNCBUb0ludGVnZXJcbnZhciBjZWlsID0gTWF0aC5jZWlsO1xudmFyIGZsb29yID0gTWF0aC5mbG9vcjtcbnZhciBfdG9JbnRlZ2VyID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpc05hTihpdCA9ICtpdCkgPyAwIDogKGl0ID4gMCA/IGZsb29yIDogY2VpbCkoaXQpO1xufTtcblxuLy8gNy4xLjE1IFRvTGVuZ3RoXG5cbnZhciBtaW4gPSBNYXRoLm1pbjtcbnZhciBfdG9MZW5ndGggPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGl0ID4gMCA/IG1pbihfdG9JbnRlZ2VyKGl0KSwgMHgxZmZmZmZmZmZmZmZmZikgOiAwOyAvLyBwb3coMiwgNTMpIC0gMSA9PSA5MDA3MTk5MjU0NzQwOTkxXG59O1xuXG4vLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KVxuXG52YXIgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIGlzQXJyYXkoYXJnKSB7XG4gIHJldHVybiBfY29mKGFyZykgPT0gJ0FycmF5Jztcbn07XG5cbnZhciBTSEFSRUQgPSAnX19jb3JlLWpzX3NoYXJlZF9fJztcbnZhciBzdG9yZSA9IF9nbG9iYWxbU0hBUkVEXSB8fCAoX2dsb2JhbFtTSEFSRURdID0ge30pO1xudmFyIF9zaGFyZWQgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pO1xufTtcblxudmFyIF93a3MgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7XG52YXIgc3RvcmUgPSBfc2hhcmVkKCd3a3MnKTtcblxudmFyIFN5bWJvbCA9IF9nbG9iYWwuU3ltYm9sO1xudmFyIFVTRV9TWU1CT0wgPSB0eXBlb2YgU3ltYm9sID09ICdmdW5jdGlvbic7XG5cbnZhciAkZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9XG4gICAgVVNFX1NZTUJPTCAmJiBTeW1ib2xbbmFtZV0gfHwgKFVTRV9TWU1CT0wgPyBTeW1ib2wgOiBfdWlkKSgnU3ltYm9sLicgKyBuYW1lKSk7XG59O1xuXG4kZXhwb3J0cy5zdG9yZSA9IHN0b3JlO1xufSk7XG5cbnZhciBTUEVDSUVTID0gX3drcygnc3BlY2llcycpO1xuXG52YXIgX2FycmF5U3BlY2llc0NvbnN0cnVjdG9yID0gZnVuY3Rpb24gKG9yaWdpbmFsKSB7XG4gIHZhciBDO1xuICBpZiAoX2lzQXJyYXkob3JpZ2luYWwpKSB7XG4gICAgQyA9IG9yaWdpbmFsLmNvbnN0cnVjdG9yO1xuICAgIC8vIGNyb3NzLXJlYWxtIGZhbGxiYWNrXG4gICAgaWYgKHR5cGVvZiBDID09ICdmdW5jdGlvbicgJiYgKEMgPT09IEFycmF5IHx8IF9pc0FycmF5KEMucHJvdG90eXBlKSkpIEMgPSB1bmRlZmluZWQ7XG4gICAgaWYgKF9pc09iamVjdChDKSkge1xuICAgICAgQyA9IENbU1BFQ0lFU107XG4gICAgICBpZiAoQyA9PT0gbnVsbCkgQyA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH0gcmV0dXJuIEMgPT09IHVuZGVmaW5lZCA/IEFycmF5IDogQztcbn07XG5cbi8vIDkuNC4yLjMgQXJyYXlTcGVjaWVzQ3JlYXRlKG9yaWdpbmFsQXJyYXksIGxlbmd0aClcblxuXG52YXIgX2FycmF5U3BlY2llc0NyZWF0ZSA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbGVuZ3RoKSB7XG4gIHJldHVybiBuZXcgKF9hcnJheVNwZWNpZXNDb25zdHJ1Y3RvcihvcmlnaW5hbCkpKGxlbmd0aCk7XG59O1xuXG4vLyAwIC0+IEFycmF5I2ZvckVhY2hcbi8vIDEgLT4gQXJyYXkjbWFwXG4vLyAyIC0+IEFycmF5I2ZpbHRlclxuLy8gMyAtPiBBcnJheSNzb21lXG4vLyA0IC0+IEFycmF5I2V2ZXJ5XG4vLyA1IC0+IEFycmF5I2ZpbmRcbi8vIDYgLT4gQXJyYXkjZmluZEluZGV4XG5cblxuXG5cblxudmFyIF9hcnJheU1ldGhvZHMgPSBmdW5jdGlvbiAoVFlQRSwgJGNyZWF0ZSkge1xuICB2YXIgSVNfTUFQID0gVFlQRSA9PSAxO1xuICB2YXIgSVNfRklMVEVSID0gVFlQRSA9PSAyO1xuICB2YXIgSVNfU09NRSA9IFRZUEUgPT0gMztcbiAgdmFyIElTX0VWRVJZID0gVFlQRSA9PSA0O1xuICB2YXIgSVNfRklORF9JTkRFWCA9IFRZUEUgPT0gNjtcbiAgdmFyIE5PX0hPTEVTID0gVFlQRSA9PSA1IHx8IElTX0ZJTkRfSU5ERVg7XG4gIHZhciBjcmVhdGUgPSAkY3JlYXRlIHx8IF9hcnJheVNwZWNpZXNDcmVhdGU7XG4gIHJldHVybiBmdW5jdGlvbiAoJHRoaXMsIGNhbGxiYWNrZm4sIHRoYXQpIHtcbiAgICB2YXIgTyA9IF90b09iamVjdCgkdGhpcyk7XG4gICAgdmFyIHNlbGYgPSBfaW9iamVjdChPKTtcbiAgICB2YXIgZiA9IF9jdHgoY2FsbGJhY2tmbiwgdGhhdCwgMyk7XG4gICAgdmFyIGxlbmd0aCA9IF90b0xlbmd0aChzZWxmLmxlbmd0aCk7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgcmVzdWx0ID0gSVNfTUFQID8gY3JlYXRlKCR0aGlzLCBsZW5ndGgpIDogSVNfRklMVEVSID8gY3JlYXRlKCR0aGlzLCAwKSA6IHVuZGVmaW5lZDtcbiAgICB2YXIgdmFsLCByZXM7XG4gICAgZm9yICg7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIGlmIChOT19IT0xFUyB8fCBpbmRleCBpbiBzZWxmKSB7XG4gICAgICB2YWwgPSBzZWxmW2luZGV4XTtcbiAgICAgIHJlcyA9IGYodmFsLCBpbmRleCwgTyk7XG4gICAgICBpZiAoVFlQRSkge1xuICAgICAgICBpZiAoSVNfTUFQKSByZXN1bHRbaW5kZXhdID0gcmVzOyAgIC8vIG1hcFxuICAgICAgICBlbHNlIGlmIChyZXMpIHN3aXRjaCAoVFlQRSkge1xuICAgICAgICAgIGNhc2UgMzogcmV0dXJuIHRydWU7ICAgICAgICAgICAgIC8vIHNvbWVcbiAgICAgICAgICBjYXNlIDU6IHJldHVybiB2YWw7ICAgICAgICAgICAgICAvLyBmaW5kXG4gICAgICAgICAgY2FzZSA2OiByZXR1cm4gaW5kZXg7ICAgICAgICAgICAgLy8gZmluZEluZGV4XG4gICAgICAgICAgY2FzZSAyOiByZXN1bHQucHVzaCh2YWwpOyAgICAgICAgLy8gZmlsdGVyXG4gICAgICAgIH0gZWxzZSBpZiAoSVNfRVZFUlkpIHJldHVybiBmYWxzZTsgLy8gZXZlcnlcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIElTX0ZJTkRfSU5ERVggPyAtMSA6IElTX1NPTUUgfHwgSVNfRVZFUlkgPyBJU19FVkVSWSA6IHJlc3VsdDtcbiAgfTtcbn07XG5cbi8vIDIyLjEuMy4zMSBBcnJheS5wcm90b3R5cGVbQEB1bnNjb3BhYmxlc11cbnZhciBVTlNDT1BBQkxFUyA9IF93a3MoJ3Vuc2NvcGFibGVzJyk7XG52YXIgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTtcbmlmIChBcnJheVByb3RvW1VOU0NPUEFCTEVTXSA9PSB1bmRlZmluZWQpIF9oaWRlKEFycmF5UHJvdG8sIFVOU0NPUEFCTEVTLCB7fSk7XG52YXIgX2FkZFRvVW5zY29wYWJsZXMgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIEFycmF5UHJvdG9bVU5TQ09QQUJMRVNdW2tleV0gPSB0cnVlO1xufTtcblxuLy8gMjIuMS4zLjggQXJyYXkucHJvdG90eXBlLmZpbmQocHJlZGljYXRlLCB0aGlzQXJnID0gdW5kZWZpbmVkKVxuXG52YXIgJGZpbmQgPSBfYXJyYXlNZXRob2RzKDUpO1xudmFyIEtFWSA9ICdmaW5kJztcbnZhciBmb3JjZWQgPSB0cnVlO1xuLy8gU2hvdWxkbid0IHNraXAgaG9sZXNcbmlmIChLRVkgaW4gW10pIEFycmF5KDEpW0tFWV0oZnVuY3Rpb24gKCkgeyBmb3JjZWQgPSBmYWxzZTsgfSk7XG5fZXhwb3J0KF9leHBvcnQuUCArIF9leHBvcnQuRiAqIGZvcmNlZCwgJ0FycmF5Jywge1xuICBmaW5kOiBmdW5jdGlvbiBmaW5kKGNhbGxiYWNrZm4gLyogLCB0aGF0ID0gdW5kZWZpbmVkICovKSB7XG4gICAgcmV0dXJuICRmaW5kKHRoaXMsIGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTtcbiAgfVxufSk7XG5fYWRkVG9VbnNjb3BhYmxlcyhLRVkpO1xuXG52YXIgZmluZCA9IF9jb3JlLkFycmF5LmZpbmQ7XG5cbi8vIDIyLjEuMy45IEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXgocHJlZGljYXRlLCB0aGlzQXJnID0gdW5kZWZpbmVkKVxuXG52YXIgJGZpbmQkMSA9IF9hcnJheU1ldGhvZHMoNik7XG52YXIgS0VZJDEgPSAnZmluZEluZGV4JztcbnZhciBmb3JjZWQkMSA9IHRydWU7XG4vLyBTaG91bGRuJ3Qgc2tpcCBob2xlc1xuaWYgKEtFWSQxIGluIFtdKSBBcnJheSgxKVtLRVkkMV0oZnVuY3Rpb24gKCkgeyBmb3JjZWQkMSA9IGZhbHNlOyB9KTtcbl9leHBvcnQoX2V4cG9ydC5QICsgX2V4cG9ydC5GICogZm9yY2VkJDEsICdBcnJheScsIHtcbiAgZmluZEluZGV4OiBmdW5jdGlvbiBmaW5kSW5kZXgoY2FsbGJhY2tmbiAvKiAsIHRoYXQgPSB1bmRlZmluZWQgKi8pIHtcbiAgICByZXR1cm4gJGZpbmQkMSh0aGlzLCBjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7XG4gIH1cbn0pO1xuX2FkZFRvVW5zY29wYWJsZXMoS0VZJDEpO1xuXG52YXIgZmluZEluZGV4ID0gX2NvcmUuQXJyYXkuZmluZEluZGV4O1xuXG4vLyB0byBpbmRleGVkIG9iamVjdCwgdG9PYmplY3Qgd2l0aCBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIHN0cmluZ3NcblxuXG52YXIgX3RvSW9iamVjdCA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gX2lvYmplY3QoX2RlZmluZWQoaXQpKTtcbn07XG5cbnZhciBtYXggPSBNYXRoLm1heDtcbnZhciBtaW4kMSA9IE1hdGgubWluO1xudmFyIF90b0Fic29sdXRlSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgsIGxlbmd0aCkge1xuICBpbmRleCA9IF90b0ludGVnZXIoaW5kZXgpO1xuICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbiQxKGluZGV4LCBsZW5ndGgpO1xufTtcblxuLy8gZmFsc2UgLT4gQXJyYXkjaW5kZXhPZlxuLy8gdHJ1ZSAgLT4gQXJyYXkjaW5jbHVkZXNcblxuXG5cbnZhciBfYXJyYXlJbmNsdWRlcyA9IGZ1bmN0aW9uIChJU19JTkNMVURFUykge1xuICByZXR1cm4gZnVuY3Rpb24gKCR0aGlzLCBlbCwgZnJvbUluZGV4KSB7XG4gICAgdmFyIE8gPSBfdG9Jb2JqZWN0KCR0aGlzKTtcbiAgICB2YXIgbGVuZ3RoID0gX3RvTGVuZ3RoKE8ubGVuZ3RoKTtcbiAgICB2YXIgaW5kZXggPSBfdG9BYnNvbHV0ZUluZGV4KGZyb21JbmRleCwgbGVuZ3RoKTtcbiAgICB2YXIgdmFsdWU7XG4gICAgLy8gQXJyYXkjaW5jbHVkZXMgdXNlcyBTYW1lVmFsdWVaZXJvIGVxdWFsaXR5IGFsZ29yaXRobVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zZWxmLWNvbXBhcmVcbiAgICBpZiAoSVNfSU5DTFVERVMgJiYgZWwgIT0gZWwpIHdoaWxlIChsZW5ndGggPiBpbmRleCkge1xuICAgICAgdmFsdWUgPSBPW2luZGV4KytdO1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtY29tcGFyZVxuICAgICAgaWYgKHZhbHVlICE9IHZhbHVlKSByZXR1cm4gdHJ1ZTtcbiAgICAvLyBBcnJheSNpbmRleE9mIGlnbm9yZXMgaG9sZXMsIEFycmF5I2luY2x1ZGVzIC0gbm90XG4gICAgfSBlbHNlIGZvciAoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKSBpZiAoSVNfSU5DTFVERVMgfHwgaW5kZXggaW4gTykge1xuICAgICAgaWYgKE9baW5kZXhdID09PSBlbCkgcmV0dXJuIElTX0lOQ0xVREVTIHx8IGluZGV4IHx8IDA7XG4gICAgfSByZXR1cm4gIUlTX0lOQ0xVREVTICYmIC0xO1xuICB9O1xufTtcblxudmFyIHNoYXJlZCA9IF9zaGFyZWQoJ2tleXMnKTtcblxudmFyIF9zaGFyZWRLZXkgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSBfdWlkKGtleSkpO1xufTtcblxudmFyIGFycmF5SW5kZXhPZiA9IF9hcnJheUluY2x1ZGVzKGZhbHNlKTtcbnZhciBJRV9QUk9UTyA9IF9zaGFyZWRLZXkoJ0lFX1BST1RPJyk7XG5cbnZhciBfb2JqZWN0S2V5c0ludGVybmFsID0gZnVuY3Rpb24gKG9iamVjdCwgbmFtZXMpIHtcbiAgdmFyIE8gPSBfdG9Jb2JqZWN0KG9iamVjdCk7XG4gIHZhciBpID0gMDtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIga2V5O1xuICBmb3IgKGtleSBpbiBPKSBpZiAoa2V5ICE9IElFX1BST1RPKSBfaGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTtcbiAgLy8gRG9uJ3QgZW51bSBidWcgJiBoaWRkZW4ga2V5c1xuICB3aGlsZSAobmFtZXMubGVuZ3RoID4gaSkgaWYgKF9oYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpIHtcbiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzXG52YXIgX2VudW1CdWdLZXlzID0gKFxuICAnY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mJ1xuKS5zcGxpdCgnLCcpO1xuXG4vLyAxOS4xLjIuMTQgLyAxNS4yLjMuMTQgT2JqZWN0LmtleXMoTylcblxuXG5cbnZhciBfb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTykge1xuICByZXR1cm4gX29iamVjdEtleXNJbnRlcm5hbChPLCBfZW51bUJ1Z0tleXMpO1xufTtcblxudmFyIGYkMSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG5cbnZhciBfb2JqZWN0R29wcyA9IHtcblx0ZjogZiQxXG59O1xuXG52YXIgZiQyID0ge30ucHJvcGVydHlJc0VudW1lcmFibGU7XG5cbnZhciBfb2JqZWN0UGllID0ge1xuXHRmOiBmJDJcbn07XG5cbi8vIDE5LjEuMi4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UsIC4uLilcblxuXG5cblxuXG52YXIgJGFzc2lnbiA9IE9iamVjdC5hc3NpZ247XG5cbi8vIHNob3VsZCB3b3JrIHdpdGggc3ltYm9scyBhbmQgc2hvdWxkIGhhdmUgZGV0ZXJtaW5pc3RpYyBwcm9wZXJ0eSBvcmRlciAoVjggYnVnKVxudmFyIF9vYmplY3RBc3NpZ24gPSAhJGFzc2lnbiB8fCBfZmFpbHMoZnVuY3Rpb24gKCkge1xuICB2YXIgQSA9IHt9O1xuICB2YXIgQiA9IHt9O1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgdmFyIFMgPSBTeW1ib2woKTtcbiAgdmFyIEsgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3QnO1xuICBBW1NdID0gNztcbiAgSy5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbiAoaykgeyBCW2tdID0gazsgfSk7XG4gIHJldHVybiAkYXNzaWduKHt9LCBBKVtTXSAhPSA3IHx8IE9iamVjdC5rZXlzKCRhc3NpZ24oe30sIEIpKS5qb2luKCcnKSAhPSBLO1xufSkgPyBmdW5jdGlvbiBhc3NpZ24odGFyZ2V0LCBzb3VyY2UpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICB2YXIgVCA9IF90b09iamVjdCh0YXJnZXQpO1xuICB2YXIgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gIHZhciBpbmRleCA9IDE7XG4gIHZhciBnZXRTeW1ib2xzID0gX29iamVjdEdvcHMuZjtcbiAgdmFyIGlzRW51bSA9IF9vYmplY3RQaWUuZjtcbiAgd2hpbGUgKGFMZW4gPiBpbmRleCkge1xuICAgIHZhciBTID0gX2lvYmplY3QoYXJndW1lbnRzW2luZGV4KytdKTtcbiAgICB2YXIga2V5cyA9IGdldFN5bWJvbHMgPyBfb2JqZWN0S2V5cyhTKS5jb25jYXQoZ2V0U3ltYm9scyhTKSkgOiBfb2JqZWN0S2V5cyhTKTtcbiAgICB2YXIgbGVuZ3RoID0ga2V5cy5sZW5ndGg7XG4gICAgdmFyIGogPSAwO1xuICAgIHZhciBrZXk7XG4gICAgd2hpbGUgKGxlbmd0aCA+IGopIGlmIChpc0VudW0uY2FsbChTLCBrZXkgPSBrZXlzW2orK10pKSBUW2tleV0gPSBTW2tleV07XG4gIH0gcmV0dXJuIFQ7XG59IDogJGFzc2lnbjtcblxuLy8gMTkuMS4zLjEgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHNvdXJjZSlcblxuXG5fZXhwb3J0KF9leHBvcnQuUyArIF9leHBvcnQuRiwgJ09iamVjdCcsIHsgYXNzaWduOiBfb2JqZWN0QXNzaWduIH0pO1xuXG52YXIgYXNzaWduID0gX2NvcmUuT2JqZWN0LmFzc2lnbjtcblxuLy8gNy4yLjggSXNSZWdFeHAoYXJndW1lbnQpXG5cblxudmFyIE1BVENIID0gX3drcygnbWF0Y2gnKTtcbnZhciBfaXNSZWdleHAgPSBmdW5jdGlvbiAoaXQpIHtcbiAgdmFyIGlzUmVnRXhwO1xuICByZXR1cm4gX2lzT2JqZWN0KGl0KSAmJiAoKGlzUmVnRXhwID0gaXRbTUFUQ0hdKSAhPT0gdW5kZWZpbmVkID8gISFpc1JlZ0V4cCA6IF9jb2YoaXQpID09ICdSZWdFeHAnKTtcbn07XG5cbi8vIGhlbHBlciBmb3IgU3RyaW5nI3tzdGFydHNXaXRoLCBlbmRzV2l0aCwgaW5jbHVkZXN9XG5cblxuXG52YXIgX3N0cmluZ0NvbnRleHQgPSBmdW5jdGlvbiAodGhhdCwgc2VhcmNoU3RyaW5nLCBOQU1FKSB7XG4gIGlmIChfaXNSZWdleHAoc2VhcmNoU3RyaW5nKSkgdGhyb3cgVHlwZUVycm9yKCdTdHJpbmcjJyArIE5BTUUgKyBcIiBkb2Vzbid0IGFjY2VwdCByZWdleCFcIik7XG4gIHJldHVybiBTdHJpbmcoX2RlZmluZWQodGhhdCkpO1xufTtcblxudmFyIE1BVENIJDEgPSBfd2tzKCdtYXRjaCcpO1xudmFyIF9mYWlsc0lzUmVnZXhwID0gZnVuY3Rpb24gKEtFWSkge1xuICB2YXIgcmUgPSAvLi87XG4gIHRyeSB7XG4gICAgJy8uLydbS0VZXShyZSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0cnkge1xuICAgICAgcmVbTUFUQ0gkMV0gPSBmYWxzZTtcbiAgICAgIHJldHVybiAhJy8uLydbS0VZXShyZSk7XG4gICAgfSBjYXRjaCAoZikgeyAvKiBlbXB0eSAqLyB9XG4gIH0gcmV0dXJuIHRydWU7XG59O1xuXG52YXIgU1RBUlRTX1dJVEggPSAnc3RhcnRzV2l0aCc7XG52YXIgJHN0YXJ0c1dpdGggPSAnJ1tTVEFSVFNfV0lUSF07XG5cbl9leHBvcnQoX2V4cG9ydC5QICsgX2V4cG9ydC5GICogX2ZhaWxzSXNSZWdleHAoU1RBUlRTX1dJVEgpLCAnU3RyaW5nJywge1xuICBzdGFydHNXaXRoOiBmdW5jdGlvbiBzdGFydHNXaXRoKHNlYXJjaFN0cmluZyAvKiAsIHBvc2l0aW9uID0gMCAqLykge1xuICAgIHZhciB0aGF0ID0gX3N0cmluZ0NvbnRleHQodGhpcywgc2VhcmNoU3RyaW5nLCBTVEFSVFNfV0lUSCk7XG4gICAgdmFyIGluZGV4ID0gX3RvTGVuZ3RoKE1hdGgubWluKGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkLCB0aGF0Lmxlbmd0aCkpO1xuICAgIHZhciBzZWFyY2ggPSBTdHJpbmcoc2VhcmNoU3RyaW5nKTtcbiAgICByZXR1cm4gJHN0YXJ0c1dpdGhcbiAgICAgID8gJHN0YXJ0c1dpdGguY2FsbCh0aGF0LCBzZWFyY2gsIGluZGV4KVxuICAgICAgOiB0aGF0LnNsaWNlKGluZGV4LCBpbmRleCArIHNlYXJjaC5sZW5ndGgpID09PSBzZWFyY2g7XG4gIH1cbn0pO1xuXG52YXIgc3RhcnRzV2l0aCA9IF9jb3JlLlN0cmluZy5zdGFydHNXaXRoO1xuXG52YXIgX3N0cmluZ1JlcGVhdCA9IGZ1bmN0aW9uIHJlcGVhdChjb3VudCkge1xuICB2YXIgc3RyID0gU3RyaW5nKF9kZWZpbmVkKHRoaXMpKTtcbiAgdmFyIHJlcyA9ICcnO1xuICB2YXIgbiA9IF90b0ludGVnZXIoY291bnQpO1xuICBpZiAobiA8IDAgfHwgbiA9PSBJbmZpbml0eSkgdGhyb3cgUmFuZ2VFcnJvcihcIkNvdW50IGNhbid0IGJlIG5lZ2F0aXZlXCIpO1xuICBmb3IgKDtuID4gMDsgKG4gPj4+PSAxKSAmJiAoc3RyICs9IHN0cikpIGlmIChuICYgMSkgcmVzICs9IHN0cjtcbiAgcmV0dXJuIHJlcztcbn07XG5cbl9leHBvcnQoX2V4cG9ydC5QLCAnU3RyaW5nJywge1xuICAvLyAyMS4xLjMuMTMgU3RyaW5nLnByb3RvdHlwZS5yZXBlYXQoY291bnQpXG4gIHJlcGVhdDogX3N0cmluZ1JlcGVhdFxufSk7XG5cbnZhciByZXBlYXQgPSBfY29yZS5TdHJpbmcucmVwZWF0O1xuXG52YXIgX21ldGEgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7XG52YXIgTUVUQSA9IF91aWQoJ21ldGEnKTtcblxuXG52YXIgc2V0RGVzYyA9IF9vYmplY3REcC5mO1xudmFyIGlkID0gMDtcbnZhciBpc0V4dGVuc2libGUgPSBPYmplY3QuaXNFeHRlbnNpYmxlIHx8IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRydWU7XG59O1xudmFyIEZSRUVaRSA9ICFfZmFpbHMoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gaXNFeHRlbnNpYmxlKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpO1xufSk7XG52YXIgc2V0TWV0YSA9IGZ1bmN0aW9uIChpdCkge1xuICBzZXREZXNjKGl0LCBNRVRBLCB7IHZhbHVlOiB7XG4gICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElEXG4gICAgdzoge30gICAgICAgICAgLy8gd2VhayBjb2xsZWN0aW9ucyBJRHNcbiAgfSB9KTtcbn07XG52YXIgZmFzdEtleSA9IGZ1bmN0aW9uIChpdCwgY3JlYXRlKSB7XG4gIC8vIHJldHVybiBwcmltaXRpdmUgd2l0aCBwcmVmaXhcbiAgaWYgKCFfaXNPYmplY3QoaXQpKSByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0O1xuICBpZiAoIV9oYXMoaXQsIE1FVEEpKSB7XG4gICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3RcbiAgICBpZiAoIWlzRXh0ZW5zaWJsZShpdCkpIHJldHVybiAnRic7XG4gICAgLy8gbm90IG5lY2Vzc2FyeSB0byBhZGQgbWV0YWRhdGFcbiAgICBpZiAoIWNyZWF0ZSkgcmV0dXJuICdFJztcbiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YVxuICAgIHNldE1ldGEoaXQpO1xuICAvLyByZXR1cm4gb2JqZWN0IElEXG4gIH0gcmV0dXJuIGl0W01FVEFdLmk7XG59O1xudmFyIGdldFdlYWsgPSBmdW5jdGlvbiAoaXQsIGNyZWF0ZSkge1xuICBpZiAoIV9oYXMoaXQsIE1FVEEpKSB7XG4gICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3RcbiAgICBpZiAoIWlzRXh0ZW5zaWJsZShpdCkpIHJldHVybiB0cnVlO1xuICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhXG4gICAgaWYgKCFjcmVhdGUpIHJldHVybiBmYWxzZTtcbiAgICAvLyBhZGQgbWlzc2luZyBtZXRhZGF0YVxuICAgIHNldE1ldGEoaXQpO1xuICAvLyByZXR1cm4gaGFzaCB3ZWFrIGNvbGxlY3Rpb25zIElEc1xuICB9IHJldHVybiBpdFtNRVRBXS53O1xufTtcbi8vIGFkZCBtZXRhZGF0YSBvbiBmcmVlemUtZmFtaWx5IG1ldGhvZHMgY2FsbGluZ1xudmFyIG9uRnJlZXplID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmIChGUkVFWkUgJiYgbWV0YS5ORUVEICYmIGlzRXh0ZW5zaWJsZShpdCkgJiYgIV9oYXMoaXQsIE1FVEEpKSBzZXRNZXRhKGl0KTtcbiAgcmV0dXJuIGl0O1xufTtcbnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7XG4gIEtFWTogTUVUQSxcbiAgTkVFRDogZmFsc2UsXG4gIGZhc3RLZXk6IGZhc3RLZXksXG4gIGdldFdlYWs6IGdldFdlYWssXG4gIG9uRnJlZXplOiBvbkZyZWV6ZVxufTtcbn0pO1xudmFyIF9tZXRhXzEgPSBfbWV0YS5LRVk7XG52YXIgX21ldGFfMiA9IF9tZXRhLk5FRUQ7XG52YXIgX21ldGFfMyA9IF9tZXRhLmZhc3RLZXk7XG52YXIgX21ldGFfNCA9IF9tZXRhLmdldFdlYWs7XG52YXIgX21ldGFfNSA9IF9tZXRhLm9uRnJlZXplO1xuXG52YXIgZGVmID0gX29iamVjdERwLmY7XG5cbnZhciBUQUcgPSBfd2tzKCd0b1N0cmluZ1RhZycpO1xuXG52YXIgX3NldFRvU3RyaW5nVGFnID0gZnVuY3Rpb24gKGl0LCB0YWcsIHN0YXQpIHtcbiAgaWYgKGl0ICYmICFfaGFzKGl0ID0gc3RhdCA/IGl0IDogaXQucHJvdG90eXBlLCBUQUcpKSBkZWYoaXQsIFRBRywgeyBjb25maWd1cmFibGU6IHRydWUsIHZhbHVlOiB0YWcgfSk7XG59O1xuXG52YXIgZiQzID0gX3drcztcblxudmFyIF93a3NFeHQgPSB7XG5cdGY6IGYkM1xufTtcblxudmFyIF9saWJyYXJ5ID0gZmFsc2U7XG5cbnZhciBkZWZpbmVQcm9wZXJ0eSA9IF9vYmplY3REcC5mO1xudmFyIF93a3NEZWZpbmUgPSBmdW5jdGlvbiAobmFtZSkge1xuICB2YXIgJFN5bWJvbCA9IF9jb3JlLlN5bWJvbCB8fCAoX2NvcmUuU3ltYm9sID0gX2xpYnJhcnkgPyB7fSA6IF9nbG9iYWwuU3ltYm9sIHx8IHt9KTtcbiAgaWYgKG5hbWUuY2hhckF0KDApICE9ICdfJyAmJiAhKG5hbWUgaW4gJFN5bWJvbCkpIGRlZmluZVByb3BlcnR5KCRTeW1ib2wsIG5hbWUsIHsgdmFsdWU6IF93a3NFeHQuZihuYW1lKSB9KTtcbn07XG5cbi8vIGFsbCBlbnVtZXJhYmxlIG9iamVjdCBrZXlzLCBpbmNsdWRlcyBzeW1ib2xzXG5cblxuXG52YXIgX2VudW1LZXlzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHZhciByZXN1bHQgPSBfb2JqZWN0S2V5cyhpdCk7XG4gIHZhciBnZXRTeW1ib2xzID0gX29iamVjdEdvcHMuZjtcbiAgaWYgKGdldFN5bWJvbHMpIHtcbiAgICB2YXIgc3ltYm9scyA9IGdldFN5bWJvbHMoaXQpO1xuICAgIHZhciBpc0VudW0gPSBfb2JqZWN0UGllLmY7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBrZXk7XG4gICAgd2hpbGUgKHN5bWJvbHMubGVuZ3RoID4gaSkgaWYgKGlzRW51bS5jYWxsKGl0LCBrZXkgPSBzeW1ib2xzW2krK10pKSByZXN1bHQucHVzaChrZXkpO1xuICB9IHJldHVybiByZXN1bHQ7XG59O1xuXG52YXIgX29iamVjdERwcyA9IF9kZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzIDogZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKSB7XG4gIF9hbk9iamVjdChPKTtcbiAgdmFyIGtleXMgPSBfb2JqZWN0S2V5cyhQcm9wZXJ0aWVzKTtcbiAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICB2YXIgaSA9IDA7XG4gIHZhciBQO1xuICB3aGlsZSAobGVuZ3RoID4gaSkgX29iamVjdERwLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7XG4gIHJldHVybiBPO1xufTtcblxudmFyIGRvY3VtZW50JDEgPSBfZ2xvYmFsLmRvY3VtZW50O1xudmFyIF9odG1sID0gZG9jdW1lbnQkMSAmJiBkb2N1bWVudCQxLmRvY3VtZW50RWxlbWVudDtcblxuLy8gMTkuMS4yLjIgLyAxNS4yLjMuNSBPYmplY3QuY3JlYXRlKE8gWywgUHJvcGVydGllc10pXG5cblxuXG52YXIgSUVfUFJPVE8kMSA9IF9zaGFyZWRLZXkoJ0lFX1BST1RPJyk7XG52YXIgRW1wdHkgPSBmdW5jdGlvbiAoKSB7IC8qIGVtcHR5ICovIH07XG52YXIgUFJPVE9UWVBFJDEgPSAncHJvdG90eXBlJztcblxuLy8gQ3JlYXRlIG9iamVjdCB3aXRoIGZha2UgYG51bGxgIHByb3RvdHlwZTogdXNlIGlmcmFtZSBPYmplY3Qgd2l0aCBjbGVhcmVkIHByb3RvdHlwZVxudmFyIGNyZWF0ZURpY3QgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIFRocmFzaCwgd2FzdGUgYW5kIHNvZG9teTogSUUgR0MgYnVnXG4gIHZhciBpZnJhbWUgPSBfZG9tQ3JlYXRlKCdpZnJhbWUnKTtcbiAgdmFyIGkgPSBfZW51bUJ1Z0tleXMubGVuZ3RoO1xuICB2YXIgbHQgPSAnPCc7XG4gIHZhciBndCA9ICc+JztcbiAgdmFyIGlmcmFtZURvY3VtZW50O1xuICBpZnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgX2h0bWwuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgaWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0Oic7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2NyaXB0LXVybFxuICAvLyBjcmVhdGVEaWN0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuT2JqZWN0O1xuICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7XG4gIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gIGlmcmFtZURvY3VtZW50Lm9wZW4oKTtcbiAgaWZyYW1lRG9jdW1lbnQud3JpdGUobHQgKyAnc2NyaXB0JyArIGd0ICsgJ2RvY3VtZW50LkY9T2JqZWN0JyArIGx0ICsgJy9zY3JpcHQnICsgZ3QpO1xuICBpZnJhbWVEb2N1bWVudC5jbG9zZSgpO1xuICBjcmVhdGVEaWN0ID0gaWZyYW1lRG9jdW1lbnQuRjtcbiAgd2hpbGUgKGktLSkgZGVsZXRlIGNyZWF0ZURpY3RbUFJPVE9UWVBFJDFdW19lbnVtQnVnS2V5c1tpXV07XG4gIHJldHVybiBjcmVhdGVEaWN0KCk7XG59O1xuXG52YXIgX29iamVjdENyZWF0ZSA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpIHtcbiAgdmFyIHJlc3VsdDtcbiAgaWYgKE8gIT09IG51bGwpIHtcbiAgICBFbXB0eVtQUk9UT1RZUEUkMV0gPSBfYW5PYmplY3QoTyk7XG4gICAgcmVzdWx0ID0gbmV3IEVtcHR5KCk7XG4gICAgRW1wdHlbUFJPVE9UWVBFJDFdID0gbnVsbDtcbiAgICAvLyBhZGQgXCJfX3Byb3RvX19cIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsXG4gICAgcmVzdWx0W0lFX1BST1RPJDFdID0gTztcbiAgfSBlbHNlIHJlc3VsdCA9IGNyZWF0ZURpY3QoKTtcbiAgcmV0dXJuIFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCA/IHJlc3VsdCA6IF9vYmplY3REcHMocmVzdWx0LCBQcm9wZXJ0aWVzKTtcbn07XG5cbi8vIDE5LjEuMi43IC8gMTUuMi4zLjQgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTylcblxudmFyIGhpZGRlbktleXMgPSBfZW51bUJ1Z0tleXMuY29uY2F0KCdsZW5ndGgnLCAncHJvdG90eXBlJyk7XG5cbnZhciBmJDQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pIHtcbiAgcmV0dXJuIF9vYmplY3RLZXlzSW50ZXJuYWwoTywgaGlkZGVuS2V5cyk7XG59O1xuXG52YXIgX29iamVjdEdvcG4gPSB7XG5cdGY6IGYkNFxufTtcblxuLy8gZmFsbGJhY2sgZm9yIElFMTEgYnVnZ3kgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgd2l0aCBpZnJhbWUgYW5kIHdpbmRvd1xuXG52YXIgZ09QTiA9IF9vYmplY3RHb3BuLmY7XG52YXIgdG9TdHJpbmckMSA9IHt9LnRvU3RyaW5nO1xuXG52YXIgd2luZG93TmFtZXMgPSB0eXBlb2Ygd2luZG93ID09ICdvYmplY3QnICYmIHdpbmRvdyAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lc1xuICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdykgOiBbXTtcblxudmFyIGdldFdpbmRvd05hbWVzID0gZnVuY3Rpb24gKGl0KSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGdPUE4oaXQpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHdpbmRvd05hbWVzLnNsaWNlKCk7XG4gIH1cbn07XG5cbnZhciBmJDUgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKGl0KSB7XG4gIHJldHVybiB3aW5kb3dOYW1lcyAmJiB0b1N0cmluZyQxLmNhbGwoaXQpID09ICdbb2JqZWN0IFdpbmRvd10nID8gZ2V0V2luZG93TmFtZXMoaXQpIDogZ09QTihfdG9Jb2JqZWN0KGl0KSk7XG59O1xuXG52YXIgX29iamVjdEdvcG5FeHQgPSB7XG5cdGY6IGYkNVxufTtcblxudmFyIGdPUEQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuXG52YXIgZiQ2ID0gX2Rlc2NyaXB0b3JzID8gZ09QRCA6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKSB7XG4gIE8gPSBfdG9Jb2JqZWN0KE8pO1xuICBQID0gX3RvUHJpbWl0aXZlKFAsIHRydWUpO1xuICBpZiAoX2llOERvbURlZmluZSkgdHJ5IHtcbiAgICByZXR1cm4gZ09QRChPLCBQKTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG4gIGlmIChfaGFzKE8sIFApKSByZXR1cm4gX3Byb3BlcnR5RGVzYyghX29iamVjdFBpZS5mLmNhbGwoTywgUCksIE9bUF0pO1xufTtcblxudmFyIF9vYmplY3RHb3BkID0ge1xuXHRmOiBmJDZcbn07XG5cbi8vIEVDTUFTY3JpcHQgNiBzeW1ib2xzIHNoaW1cblxuXG5cblxuXG52YXIgTUVUQSA9IF9tZXRhLktFWTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIGdPUEQkMSA9IF9vYmplY3RHb3BkLmY7XG52YXIgZFAkMSA9IF9vYmplY3REcC5mO1xudmFyIGdPUE4kMSA9IF9vYmplY3RHb3BuRXh0LmY7XG52YXIgJFN5bWJvbCA9IF9nbG9iYWwuU3ltYm9sO1xudmFyICRKU09OID0gX2dsb2JhbC5KU09OO1xudmFyIF9zdHJpbmdpZnkgPSAkSlNPTiAmJiAkSlNPTi5zdHJpbmdpZnk7XG52YXIgUFJPVE9UWVBFJDIgPSAncHJvdG90eXBlJztcbnZhciBISURERU4gPSBfd2tzKCdfaGlkZGVuJyk7XG52YXIgVE9fUFJJTUlUSVZFID0gX3drcygndG9QcmltaXRpdmUnKTtcbnZhciBpc0VudW0gPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBTeW1ib2xSZWdpc3RyeSA9IF9zaGFyZWQoJ3N5bWJvbC1yZWdpc3RyeScpO1xudmFyIEFsbFN5bWJvbHMgPSBfc2hhcmVkKCdzeW1ib2xzJyk7XG52YXIgT1BTeW1ib2xzID0gX3NoYXJlZCgnb3Atc3ltYm9scycpO1xudmFyIE9iamVjdFByb3RvID0gT2JqZWN0W1BST1RPVFlQRSQyXTtcbnZhciBVU0VfTkFUSVZFID0gdHlwZW9mICRTeW1ib2wgPT0gJ2Z1bmN0aW9uJztcbnZhciBRT2JqZWN0ID0gX2dsb2JhbC5RT2JqZWN0O1xuLy8gRG9uJ3QgdXNlIHNldHRlcnMgaW4gUXQgU2NyaXB0LCBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvMTczXG52YXIgc2V0dGVyID0gIVFPYmplY3QgfHwgIVFPYmplY3RbUFJPVE9UWVBFJDJdIHx8ICFRT2JqZWN0W1BST1RPVFlQRSQyXS5maW5kQ2hpbGQ7XG5cbi8vIGZhbGxiYWNrIGZvciBvbGQgQW5kcm9pZCwgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTY4N1xudmFyIHNldFN5bWJvbERlc2MgPSBfZGVzY3JpcHRvcnMgJiYgX2ZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIF9vYmplY3RDcmVhdGUoZFAkMSh7fSwgJ2EnLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBkUCQxKHRoaXMsICdhJywgeyB2YWx1ZTogNyB9KS5hOyB9XG4gIH0pKS5hICE9IDc7XG59KSA/IGZ1bmN0aW9uIChpdCwga2V5LCBEKSB7XG4gIHZhciBwcm90b0Rlc2MgPSBnT1BEJDEoT2JqZWN0UHJvdG8sIGtleSk7XG4gIGlmIChwcm90b0Rlc2MpIGRlbGV0ZSBPYmplY3RQcm90b1trZXldO1xuICBkUCQxKGl0LCBrZXksIEQpO1xuICBpZiAocHJvdG9EZXNjICYmIGl0ICE9PSBPYmplY3RQcm90bykgZFAkMShPYmplY3RQcm90bywga2V5LCBwcm90b0Rlc2MpO1xufSA6IGRQJDE7XG5cbnZhciB3cmFwID0gZnVuY3Rpb24gKHRhZykge1xuICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX29iamVjdENyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRSQyXSk7XG4gIHN5bS5fayA9IHRhZztcbiAgcmV0dXJuIHN5bTtcbn07XG5cbnZhciBpc1N5bWJvbCA9IFVTRV9OQVRJVkUgJiYgdHlwZW9mICRTeW1ib2wuaXRlcmF0b3IgPT0gJ3N5bWJvbCcgPyBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIHR5cGVvZiBpdCA9PSAnc3ltYm9sJztcbn0gOiBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGl0IGluc3RhbmNlb2YgJFN5bWJvbDtcbn07XG5cbnZhciAkZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBEKSB7XG4gIGlmIChpdCA9PT0gT2JqZWN0UHJvdG8pICRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7XG4gIF9hbk9iamVjdChpdCk7XG4gIGtleSA9IF90b1ByaW1pdGl2ZShrZXksIHRydWUpO1xuICBfYW5PYmplY3QoRCk7XG4gIGlmIChfaGFzKEFsbFN5bWJvbHMsIGtleSkpIHtcbiAgICBpZiAoIUQuZW51bWVyYWJsZSkge1xuICAgICAgaWYgKCFfaGFzKGl0LCBISURERU4pKSBkUCQxKGl0LCBISURERU4sIF9wcm9wZXJ0eURlc2MoMSwge30pKTtcbiAgICAgIGl0W0hJRERFTl1ba2V5XSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChfaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSkgaXRbSElEREVOXVtrZXldID0gZmFsc2U7XG4gICAgICBEID0gX29iamVjdENyZWF0ZShELCB7IGVudW1lcmFibGU6IF9wcm9wZXJ0eURlc2MoMCwgZmFsc2UpIH0pO1xuICAgIH0gcmV0dXJuIHNldFN5bWJvbERlc2MoaXQsIGtleSwgRCk7XG4gIH0gcmV0dXJuIGRQJDEoaXQsIGtleSwgRCk7XG59O1xudmFyICRkZWZpbmVQcm9wZXJ0aWVzID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyhpdCwgUCkge1xuICBfYW5PYmplY3QoaXQpO1xuICB2YXIga2V5cyA9IF9lbnVtS2V5cyhQID0gX3RvSW9iamVjdChQKSk7XG4gIHZhciBpID0gMDtcbiAgdmFyIGwgPSBrZXlzLmxlbmd0aDtcbiAgdmFyIGtleTtcbiAgd2hpbGUgKGwgPiBpKSAkZGVmaW5lUHJvcGVydHkoaXQsIGtleSA9IGtleXNbaSsrXSwgUFtrZXldKTtcbiAgcmV0dXJuIGl0O1xufTtcbnZhciAkY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGl0LCBQKSB7XG4gIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfb2JqZWN0Q3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9vYmplY3RDcmVhdGUoaXQpLCBQKTtcbn07XG52YXIgJHByb3BlcnR5SXNFbnVtZXJhYmxlID0gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoa2V5KSB7XG4gIHZhciBFID0gaXNFbnVtLmNhbGwodGhpcywga2V5ID0gX3RvUHJpbWl0aXZlKGtleSwgdHJ1ZSkpO1xuICBpZiAodGhpcyA9PT0gT2JqZWN0UHJvdG8gJiYgX2hhcyhBbGxTeW1ib2xzLCBrZXkpICYmICFfaGFzKE9QU3ltYm9scywga2V5KSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gRSB8fCAhX2hhcyh0aGlzLCBrZXkpIHx8ICFfaGFzKEFsbFN5bWJvbHMsIGtleSkgfHwgX2hhcyh0aGlzLCBISURERU4pICYmIHRoaXNbSElEREVOXVtrZXldID8gRSA6IHRydWU7XG59O1xudmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSkge1xuICBpdCA9IF90b0lvYmplY3QoaXQpO1xuICBrZXkgPSBfdG9QcmltaXRpdmUoa2V5LCB0cnVlKTtcbiAgaWYgKGl0ID09PSBPYmplY3RQcm90byAmJiBfaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIV9oYXMoT1BTeW1ib2xzLCBrZXkpKSByZXR1cm47XG4gIHZhciBEID0gZ09QRCQxKGl0LCBrZXkpO1xuICBpZiAoRCAmJiBfaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIShfaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSkpIEQuZW51bWVyYWJsZSA9IHRydWU7XG4gIHJldHVybiBEO1xufTtcbnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpIHtcbiAgdmFyIG5hbWVzID0gZ09QTiQxKF90b0lvYmplY3QoaXQpKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIgaSA9IDA7XG4gIHZhciBrZXk7XG4gIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKSB7XG4gICAgaWYgKCFfaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIGtleSAhPSBISURERU4gJiYga2V5ICE9IE1FVEEpIHJlc3VsdC5wdXNoKGtleSk7XG4gIH0gcmV0dXJuIHJlc3VsdDtcbn07XG52YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCkge1xuICB2YXIgSVNfT1AgPSBpdCA9PT0gT2JqZWN0UHJvdG87XG4gIHZhciBuYW1lcyA9IGdPUE4kMShJU19PUCA/IE9QU3ltYm9scyA6IF90b0lvYmplY3QoaXQpKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIgaSA9IDA7XG4gIHZhciBrZXk7XG4gIHdoaWxlIChuYW1lcy5sZW5ndGggPiBpKSB7XG4gICAgaWYgKF9oYXMoQWxsU3ltYm9scywga2V5ID0gbmFtZXNbaSsrXSkgJiYgKElTX09QID8gX2hhcyhPYmplY3RQcm90bywga2V5KSA6IHRydWUpKSByZXN1bHQucHVzaChBbGxTeW1ib2xzW2tleV0pO1xuICB9IHJldHVybiByZXN1bHQ7XG59O1xuXG4vLyAxOS40LjEuMSBTeW1ib2woW2Rlc2NyaXB0aW9uXSlcbmlmICghVVNFX05BVElWRSkge1xuICAkU3ltYm9sID0gZnVuY3Rpb24gU3ltYm9sKCkge1xuICAgIGlmICh0aGlzIGluc3RhbmNlb2YgJFN5bWJvbCkgdGhyb3cgVHlwZUVycm9yKCdTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IhJyk7XG4gICAgdmFyIHRhZyA9IF91aWQoYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpO1xuICAgIHZhciAkc2V0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICBpZiAodGhpcyA9PT0gT2JqZWN0UHJvdG8pICRzZXQuY2FsbChPUFN5bWJvbHMsIHZhbHVlKTtcbiAgICAgIGlmIChfaGFzKHRoaXMsIEhJRERFTikgJiYgX2hhcyh0aGlzW0hJRERFTl0sIHRhZykpIHRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7XG4gICAgICBzZXRTeW1ib2xEZXNjKHRoaXMsIHRhZywgX3Byb3BlcnR5RGVzYygxLCB2YWx1ZSkpO1xuICAgIH07XG4gICAgaWYgKF9kZXNjcmlwdG9ycyAmJiBzZXR0ZXIpIHNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywgeyBjb25maWd1cmFibGU6IHRydWUsIHNldDogJHNldCB9KTtcbiAgICByZXR1cm4gd3JhcCh0YWcpO1xuICB9O1xuICBfcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEUkMl0sICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiB0aGlzLl9rO1xuICB9KTtcblxuICBfb2JqZWN0R29wZC5mID0gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgX29iamVjdERwLmYgPSAkZGVmaW5lUHJvcGVydHk7XG4gIF9vYmplY3RHb3BuLmYgPSBfb2JqZWN0R29wbkV4dC5mID0gJGdldE93blByb3BlcnR5TmFtZXM7XG4gIF9vYmplY3RQaWUuZiA9ICRwcm9wZXJ0eUlzRW51bWVyYWJsZTtcbiAgX29iamVjdEdvcHMuZiA9ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XG5cbiAgaWYgKF9kZXNjcmlwdG9ycyAmJiAhX2xpYnJhcnkpIHtcbiAgICBfcmVkZWZpbmUoT2JqZWN0UHJvdG8sICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsICRwcm9wZXJ0eUlzRW51bWVyYWJsZSwgdHJ1ZSk7XG4gIH1cblxuICBfd2tzRXh0LmYgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHJldHVybiB3cmFwKF93a3MobmFtZSkpO1xuICB9O1xufVxuXG5fZXhwb3J0KF9leHBvcnQuRyArIF9leHBvcnQuVyArIF9leHBvcnQuRiAqICFVU0VfTkFUSVZFLCB7IFN5bWJvbDogJFN5bWJvbCB9KTtcblxuZm9yICh2YXIgZXM2U3ltYm9scyA9IChcbiAgLy8gMTkuNC4yLjIsIDE5LjQuMi4zLCAxOS40LjIuNCwgMTkuNC4yLjYsIDE5LjQuMi44LCAxOS40LjIuOSwgMTkuNC4yLjEwLCAxOS40LjIuMTEsIDE5LjQuMi4xMiwgMTkuNC4yLjEzLCAxOS40LjIuMTRcbiAgJ2hhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzJ1xuKS5zcGxpdCgnLCcpLCBqID0gMDsgZXM2U3ltYm9scy5sZW5ndGggPiBqOylfd2tzKGVzNlN5bWJvbHNbaisrXSk7XG5cbmZvciAodmFyIHdlbGxLbm93blN5bWJvbHMgPSBfb2JqZWN0S2V5cyhfd2tzLnN0b3JlKSwgayA9IDA7IHdlbGxLbm93blN5bWJvbHMubGVuZ3RoID4gazspIF93a3NEZWZpbmUod2VsbEtub3duU3ltYm9sc1trKytdKTtcblxuX2V4cG9ydChfZXhwb3J0LlMgKyBfZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgJ1N5bWJvbCcsIHtcbiAgLy8gMTkuNC4yLjEgU3ltYm9sLmZvcihrZXkpXG4gICdmb3InOiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmV0dXJuIF9oYXMoU3ltYm9sUmVnaXN0cnksIGtleSArPSAnJylcbiAgICAgID8gU3ltYm9sUmVnaXN0cnlba2V5XVxuICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpO1xuICB9LFxuICAvLyAxOS40LjIuNSBTeW1ib2wua2V5Rm9yKHN5bSlcbiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioc3ltKSB7XG4gICAgaWYgKCFpc1N5bWJvbChzeW0pKSB0aHJvdyBUeXBlRXJyb3Ioc3ltICsgJyBpcyBub3QgYSBzeW1ib2whJyk7XG4gICAgZm9yICh2YXIga2V5IGluIFN5bWJvbFJlZ2lzdHJ5KSBpZiAoU3ltYm9sUmVnaXN0cnlba2V5XSA9PT0gc3ltKSByZXR1cm4ga2V5O1xuICB9LFxuICB1c2VTZXR0ZXI6IGZ1bmN0aW9uICgpIHsgc2V0dGVyID0gdHJ1ZTsgfSxcbiAgdXNlU2ltcGxlOiBmdW5jdGlvbiAoKSB7IHNldHRlciA9IGZhbHNlOyB9XG59KTtcblxuX2V4cG9ydChfZXhwb3J0LlMgKyBfZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgJ09iamVjdCcsIHtcbiAgLy8gMTkuMS4yLjIgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKVxuICBjcmVhdGU6ICRjcmVhdGUsXG4gIC8vIDE5LjEuMi40IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKVxuICBkZWZpbmVQcm9wZXJ0eTogJGRlZmluZVByb3BlcnR5LFxuICAvLyAxOS4xLjIuMyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKVxuICBkZWZpbmVQcm9wZXJ0aWVzOiAkZGVmaW5lUHJvcGVydGllcyxcbiAgLy8gMTkuMS4yLjYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKVxuICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gIC8vIDE5LjEuMi43IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE8pXG4gIGdldE93blByb3BlcnR5TmFtZXM6ICRnZXRPd25Qcm9wZXJ0eU5hbWVzLFxuICAvLyAxOS4xLjIuOCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKE8pXG4gIGdldE93blByb3BlcnR5U3ltYm9sczogJGdldE93blByb3BlcnR5U3ltYm9sc1xufSk7XG5cbi8vIDI0LjMuMiBKU09OLnN0cmluZ2lmeSh2YWx1ZSBbLCByZXBsYWNlciBbLCBzcGFjZV1dKVxuJEpTT04gJiYgX2V4cG9ydChfZXhwb3J0LlMgKyBfZXhwb3J0LkYgKiAoIVVTRV9OQVRJVkUgfHwgX2ZhaWxzKGZ1bmN0aW9uICgpIHtcbiAgdmFyIFMgPSAkU3ltYm9sKCk7XG4gIC8vIE1TIEVkZ2UgY29udmVydHMgc3ltYm9sIHZhbHVlcyB0byBKU09OIGFzIHt9XG4gIC8vIFdlYktpdCBjb252ZXJ0cyBzeW1ib2wgdmFsdWVzIHRvIEpTT04gYXMgbnVsbFxuICAvLyBWOCB0aHJvd3Mgb24gYm94ZWQgc3ltYm9sc1xuICByZXR1cm4gX3N0cmluZ2lmeShbU10pICE9ICdbbnVsbF0nIHx8IF9zdHJpbmdpZnkoeyBhOiBTIH0pICE9ICd7fScgfHwgX3N0cmluZ2lmeShPYmplY3QoUykpICE9ICd7fSc7XG59KSksICdKU09OJywge1xuICBzdHJpbmdpZnk6IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCkge1xuICAgIHZhciBhcmdzID0gW2l0XTtcbiAgICB2YXIgaSA9IDE7XG4gICAgdmFyIHJlcGxhY2VyLCAkcmVwbGFjZXI7XG4gICAgd2hpbGUgKGFyZ3VtZW50cy5sZW5ndGggPiBpKSBhcmdzLnB1c2goYXJndW1lbnRzW2krK10pO1xuICAgICRyZXBsYWNlciA9IHJlcGxhY2VyID0gYXJnc1sxXTtcbiAgICBpZiAoIV9pc09iamVjdChyZXBsYWNlcikgJiYgaXQgPT09IHVuZGVmaW5lZCB8fCBpc1N5bWJvbChpdCkpIHJldHVybjsgLy8gSUU4IHJldHVybnMgc3RyaW5nIG9uIHVuZGVmaW5lZFxuICAgIGlmICghX2lzQXJyYXkocmVwbGFjZXIpKSByZXBsYWNlciA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICBpZiAodHlwZW9mICRyZXBsYWNlciA9PSAnZnVuY3Rpb24nKSB2YWx1ZSA9ICRyZXBsYWNlci5jYWxsKHRoaXMsIGtleSwgdmFsdWUpO1xuICAgICAgaWYgKCFpc1N5bWJvbCh2YWx1ZSkpIHJldHVybiB2YWx1ZTtcbiAgICB9O1xuICAgIGFyZ3NbMV0gPSByZXBsYWNlcjtcbiAgICByZXR1cm4gX3N0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJncyk7XG4gIH1cbn0pO1xuXG4vLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpXG4kU3ltYm9sW1BST1RPVFlQRSQyXVtUT19QUklNSVRJVkVdIHx8IF9oaWRlKCRTeW1ib2xbUFJPVE9UWVBFJDJdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFJDJdLnZhbHVlT2YpO1xuLy8gMTkuNC4zLjUgU3ltYm9sLnByb3RvdHlwZVtAQHRvU3RyaW5nVGFnXVxuX3NldFRvU3RyaW5nVGFnKCRTeW1ib2wsICdTeW1ib2wnKTtcbi8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ11cbl9zZXRUb1N0cmluZ1RhZyhNYXRoLCAnTWF0aCcsIHRydWUpO1xuLy8gMjQuMy4zIEpTT05bQEB0b1N0cmluZ1RhZ11cbl9zZXRUb1N0cmluZ1RhZyhfZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7XG5cbi8vIGdldHRpbmcgdGFnIGZyb20gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpXG5cbnZhciBUQUckMSA9IF93a3MoJ3RvU3RyaW5nVGFnJyk7XG4vLyBFUzMgd3JvbmcgaGVyZVxudmFyIEFSRyA9IF9jb2YoZnVuY3Rpb24gKCkgeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpID09ICdBcmd1bWVudHMnO1xuXG4vLyBmYWxsYmFjayBmb3IgSUUxMSBTY3JpcHQgQWNjZXNzIERlbmllZCBlcnJvclxudmFyIHRyeUdldCA9IGZ1bmN0aW9uIChpdCwga2V5KSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGl0W2tleV07XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxufTtcblxudmFyIF9jbGFzc29mID0gZnVuY3Rpb24gKGl0KSB7XG4gIHZhciBPLCBULCBCO1xuICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogaXQgPT09IG51bGwgPyAnTnVsbCdcbiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2VcbiAgICA6IHR5cGVvZiAoVCA9IHRyeUdldChPID0gT2JqZWN0KGl0KSwgVEFHJDEpKSA9PSAnc3RyaW5nJyA/IFRcbiAgICAvLyBidWlsdGluVGFnIGNhc2VcbiAgICA6IEFSRyA/IF9jb2YoTylcbiAgICAvLyBFUzMgYXJndW1lbnRzIGZhbGxiYWNrXG4gICAgOiAoQiA9IF9jb2YoTykpID09ICdPYmplY3QnICYmIHR5cGVvZiBPLmNhbGxlZSA9PSAnZnVuY3Rpb24nID8gJ0FyZ3VtZW50cycgOiBCO1xufTtcblxuLy8gMTkuMS4zLjYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZygpXG5cbnZhciB0ZXN0ID0ge307XG50ZXN0W193a3MoJ3RvU3RyaW5nVGFnJyldID0gJ3onO1xuaWYgKHRlc3QgKyAnJyAhPSAnW29iamVjdCB6XScpIHtcbiAgX3JlZGVmaW5lKE9iamVjdC5wcm90b3R5cGUsICd0b1N0cmluZycsIGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiAnW29iamVjdCAnICsgX2NsYXNzb2YodGhpcykgKyAnXSc7XG4gIH0sIHRydWUpO1xufVxuXG5fd2tzRGVmaW5lKCdhc3luY0l0ZXJhdG9yJyk7XG5cbl93a3NEZWZpbmUoJ29ic2VydmFibGUnKTtcblxudmFyIHN5bWJvbCA9IF9jb3JlLlN5bWJvbDtcblxuLy8gdHJ1ZSAgLT4gU3RyaW5nI2F0XG4vLyBmYWxzZSAtPiBTdHJpbmcjY29kZVBvaW50QXRcbnZhciBfc3RyaW5nQXQgPSBmdW5jdGlvbiAoVE9fU1RSSU5HKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGhhdCwgcG9zKSB7XG4gICAgdmFyIHMgPSBTdHJpbmcoX2RlZmluZWQodGhhdCkpO1xuICAgIHZhciBpID0gX3RvSW50ZWdlcihwb3MpO1xuICAgIHZhciBsID0gcy5sZW5ndGg7XG4gICAgdmFyIGEsIGI7XG4gICAgaWYgKGkgPCAwIHx8IGkgPj0gbCkgcmV0dXJuIFRPX1NUUklORyA/ICcnIDogdW5kZWZpbmVkO1xuICAgIGEgPSBzLmNoYXJDb2RlQXQoaSk7XG4gICAgcmV0dXJuIGEgPCAweGQ4MDAgfHwgYSA+IDB4ZGJmZiB8fCBpICsgMSA9PT0gbCB8fCAoYiA9IHMuY2hhckNvZGVBdChpICsgMSkpIDwgMHhkYzAwIHx8IGIgPiAweGRmZmZcbiAgICAgID8gVE9fU1RSSU5HID8gcy5jaGFyQXQoaSkgOiBhXG4gICAgICA6IFRPX1NUUklORyA/IHMuc2xpY2UoaSwgaSArIDIpIDogKGEgLSAweGQ4MDAgPDwgMTApICsgKGIgLSAweGRjMDApICsgMHgxMDAwMDtcbiAgfTtcbn07XG5cbnZhciBfaXRlcmF0b3JzID0ge307XG5cbnZhciBJdGVyYXRvclByb3RvdHlwZSA9IHt9O1xuXG4vLyAyNS4xLjIuMS4xICVJdGVyYXRvclByb3RvdHlwZSVbQEBpdGVyYXRvcl0oKVxuX2hpZGUoSXRlcmF0b3JQcm90b3R5cGUsIF93a3MoJ2l0ZXJhdG9yJyksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0pO1xuXG52YXIgX2l0ZXJDcmVhdGUgPSBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpIHtcbiAgQ29uc3RydWN0b3IucHJvdG90eXBlID0gX29iamVjdENyZWF0ZShJdGVyYXRvclByb3RvdHlwZSwgeyBuZXh0OiBfcHJvcGVydHlEZXNjKDEsIG5leHQpIH0pO1xuICBfc2V0VG9TdHJpbmdUYWcoQ29uc3RydWN0b3IsIE5BTUUgKyAnIEl0ZXJhdG9yJyk7XG59O1xuXG4vLyAxOS4xLjIuOSAvIDE1LjIuMy4yIE9iamVjdC5nZXRQcm90b3R5cGVPZihPKVxuXG5cbnZhciBJRV9QUk9UTyQyID0gX3NoYXJlZEtleSgnSUVfUFJPVE8nKTtcbnZhciBPYmplY3RQcm90byQxID0gT2JqZWN0LnByb3RvdHlwZTtcblxudmFyIF9vYmplY3RHcG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKE8pIHtcbiAgTyA9IF90b09iamVjdChPKTtcbiAgaWYgKF9oYXMoTywgSUVfUFJPVE8kMikpIHJldHVybiBPW0lFX1BST1RPJDJdO1xuICBpZiAodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcikge1xuICAgIHJldHVybiBPLmNvbnN0cnVjdG9yLnByb3RvdHlwZTtcbiAgfSByZXR1cm4gTyBpbnN0YW5jZW9mIE9iamVjdCA/IE9iamVjdFByb3RvJDEgOiBudWxsO1xufTtcblxudmFyIElURVJBVE9SID0gX3drcygnaXRlcmF0b3InKTtcbnZhciBCVUdHWSA9ICEoW10ua2V5cyAmJiAnbmV4dCcgaW4gW10ua2V5cygpKTsgLy8gU2FmYXJpIGhhcyBidWdneSBpdGVyYXRvcnMgdy9vIGBuZXh0YFxudmFyIEZGX0lURVJBVE9SID0gJ0BAaXRlcmF0b3InO1xudmFyIEtFWVMgPSAna2V5cyc7XG52YXIgVkFMVUVTID0gJ3ZhbHVlcyc7XG5cbnZhciByZXR1cm5UaGlzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfTtcblxudmFyIF9pdGVyRGVmaW5lID0gZnVuY3Rpb24gKEJhc2UsIE5BTUUsIENvbnN0cnVjdG9yLCBuZXh0LCBERUZBVUxULCBJU19TRVQsIEZPUkNFRCkge1xuICBfaXRlckNyZWF0ZShDb25zdHJ1Y3RvciwgTkFNRSwgbmV4dCk7XG4gIHZhciBnZXRNZXRob2QgPSBmdW5jdGlvbiAoa2luZCkge1xuICAgIGlmICghQlVHR1kgJiYga2luZCBpbiBwcm90bykgcmV0dXJuIHByb3RvW2tpbmRdO1xuICAgIHN3aXRjaCAoa2luZCkge1xuICAgICAgY2FzZSBLRVlTOiByZXR1cm4gZnVuY3Rpb24ga2V5cygpIHsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTtcbiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCkgeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9O1xuICAgIH0gcmV0dXJuIGZ1bmN0aW9uIGVudHJpZXMoKSB7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07XG4gIH07XG4gIHZhciBUQUcgPSBOQU1FICsgJyBJdGVyYXRvcic7XG4gIHZhciBERUZfVkFMVUVTID0gREVGQVVMVCA9PSBWQUxVRVM7XG4gIHZhciBWQUxVRVNfQlVHID0gZmFsc2U7XG4gIHZhciBwcm90byA9IEJhc2UucHJvdG90eXBlO1xuICB2YXIgJG5hdGl2ZSA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXTtcbiAgdmFyICRkZWZhdWx0ID0gJG5hdGl2ZSB8fCBnZXRNZXRob2QoREVGQVVMVCk7XG4gIHZhciAkZW50cmllcyA9IERFRkFVTFQgPyAhREVGX1ZBTFVFUyA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKCdlbnRyaWVzJykgOiB1bmRlZmluZWQ7XG4gIHZhciAkYW55TmF0aXZlID0gTkFNRSA9PSAnQXJyYXknID8gcHJvdG8uZW50cmllcyB8fCAkbmF0aXZlIDogJG5hdGl2ZTtcbiAgdmFyIG1ldGhvZHMsIGtleSwgSXRlcmF0b3JQcm90b3R5cGU7XG4gIC8vIEZpeCBuYXRpdmVcbiAgaWYgKCRhbnlOYXRpdmUpIHtcbiAgICBJdGVyYXRvclByb3RvdHlwZSA9IF9vYmplY3RHcG8oJGFueU5hdGl2ZS5jYWxsKG5ldyBCYXNlKCkpKTtcbiAgICBpZiAoSXRlcmF0b3JQcm90b3R5cGUgIT09IE9iamVjdC5wcm90b3R5cGUgJiYgSXRlcmF0b3JQcm90b3R5cGUubmV4dCkge1xuICAgICAgLy8gU2V0IEBAdG9TdHJpbmdUYWcgdG8gbmF0aXZlIGl0ZXJhdG9yc1xuICAgICAgX3NldFRvU3RyaW5nVGFnKEl0ZXJhdG9yUHJvdG90eXBlLCBUQUcsIHRydWUpO1xuICAgICAgLy8gZml4IGZvciBzb21lIG9sZCBlbmdpbmVzXG4gICAgICBpZiAoIV9saWJyYXJ5ICYmIHR5cGVvZiBJdGVyYXRvclByb3RvdHlwZVtJVEVSQVRPUl0gIT0gJ2Z1bmN0aW9uJykgX2hpZGUoSXRlcmF0b3JQcm90b3R5cGUsIElURVJBVE9SLCByZXR1cm5UaGlzKTtcbiAgICB9XG4gIH1cbiAgLy8gZml4IEFycmF5I3t2YWx1ZXMsIEBAaXRlcmF0b3J9Lm5hbWUgaW4gVjggLyBGRlxuICBpZiAoREVGX1ZBTFVFUyAmJiAkbmF0aXZlICYmICRuYXRpdmUubmFtZSAhPT0gVkFMVUVTKSB7XG4gICAgVkFMVUVTX0JVRyA9IHRydWU7XG4gICAgJGRlZmF1bHQgPSBmdW5jdGlvbiB2YWx1ZXMoKSB7IHJldHVybiAkbmF0aXZlLmNhbGwodGhpcyk7IH07XG4gIH1cbiAgLy8gRGVmaW5lIGl0ZXJhdG9yXG4gIGlmICgoIV9saWJyYXJ5IHx8IEZPUkNFRCkgJiYgKEJVR0dZIHx8IFZBTFVFU19CVUcgfHwgIXByb3RvW0lURVJBVE9SXSkpIHtcbiAgICBfaGlkZShwcm90bywgSVRFUkFUT1IsICRkZWZhdWx0KTtcbiAgfVxuICAvLyBQbHVnIGZvciBsaWJyYXJ5XG4gIF9pdGVyYXRvcnNbTkFNRV0gPSAkZGVmYXVsdDtcbiAgX2l0ZXJhdG9yc1tUQUddID0gcmV0dXJuVGhpcztcbiAgaWYgKERFRkFVTFQpIHtcbiAgICBtZXRob2RzID0ge1xuICAgICAgdmFsdWVzOiBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSxcbiAgICAgIGtleXM6IElTX1NFVCA/ICRkZWZhdWx0IDogZ2V0TWV0aG9kKEtFWVMpLFxuICAgICAgZW50cmllczogJGVudHJpZXNcbiAgICB9O1xuICAgIGlmIChGT1JDRUQpIGZvciAoa2V5IGluIG1ldGhvZHMpIHtcbiAgICAgIGlmICghKGtleSBpbiBwcm90bykpIF9yZWRlZmluZShwcm90bywga2V5LCBtZXRob2RzW2tleV0pO1xuICAgIH0gZWxzZSBfZXhwb3J0KF9leHBvcnQuUCArIF9leHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7XG4gIH1cbiAgcmV0dXJuIG1ldGhvZHM7XG59O1xuXG52YXIgJGF0ID0gX3N0cmluZ0F0KHRydWUpO1xuXG4vLyAyMS4xLjMuMjcgU3RyaW5nLnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpXG5faXRlckRlZmluZShTdHJpbmcsICdTdHJpbmcnLCBmdW5jdGlvbiAoaXRlcmF0ZWQpIHtcbiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldFxuICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleFxuLy8gMjEuMS41LjIuMSAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKVxufSwgZnVuY3Rpb24gKCkge1xuICB2YXIgTyA9IHRoaXMuX3Q7XG4gIHZhciBpbmRleCA9IHRoaXMuX2k7XG4gIHZhciBwb2ludDtcbiAgaWYgKGluZGV4ID49IE8ubGVuZ3RoKSByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlIH07XG4gIHBvaW50ID0gJGF0KE8sIGluZGV4KTtcbiAgdGhpcy5faSArPSBwb2ludC5sZW5ndGg7XG4gIHJldHVybiB7IHZhbHVlOiBwb2ludCwgZG9uZTogZmFsc2UgfTtcbn0pO1xuXG52YXIgX2l0ZXJTdGVwID0gZnVuY3Rpb24gKGRvbmUsIHZhbHVlKSB7XG4gIHJldHVybiB7IHZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lIH07XG59O1xuXG4vLyAyMi4xLjMuNCBBcnJheS5wcm90b3R5cGUuZW50cmllcygpXG4vLyAyMi4xLjMuMTMgQXJyYXkucHJvdG90eXBlLmtleXMoKVxuLy8gMjIuMS4zLjI5IEFycmF5LnByb3RvdHlwZS52YWx1ZXMoKVxuLy8gMjIuMS4zLjMwIEFycmF5LnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpXG52YXIgZXM2X2FycmF5X2l0ZXJhdG9yID0gX2l0ZXJEZWZpbmUoQXJyYXksICdBcnJheScsIGZ1bmN0aW9uIChpdGVyYXRlZCwga2luZCkge1xuICB0aGlzLl90ID0gX3RvSW9iamVjdChpdGVyYXRlZCk7IC8vIHRhcmdldFxuICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleFxuICB0aGlzLl9rID0ga2luZDsgICAgICAgICAgICAgICAgLy8ga2luZFxuLy8gMjIuMS41LjIuMSAlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUubmV4dCgpXG59LCBmdW5jdGlvbiAoKSB7XG4gIHZhciBPID0gdGhpcy5fdDtcbiAgdmFyIGtpbmQgPSB0aGlzLl9rO1xuICB2YXIgaW5kZXggPSB0aGlzLl9pKys7XG4gIGlmICghTyB8fCBpbmRleCA+PSBPLmxlbmd0aCkge1xuICAgIHRoaXMuX3QgPSB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIF9pdGVyU3RlcCgxKTtcbiAgfVxuICBpZiAoa2luZCA9PSAna2V5cycpIHJldHVybiBfaXRlclN0ZXAoMCwgaW5kZXgpO1xuICBpZiAoa2luZCA9PSAndmFsdWVzJykgcmV0dXJuIF9pdGVyU3RlcCgwLCBPW2luZGV4XSk7XG4gIHJldHVybiBfaXRlclN0ZXAoMCwgW2luZGV4LCBPW2luZGV4XV0pO1xufSwgJ3ZhbHVlcycpO1xuXG4vLyBhcmd1bWVudHNMaXN0W0BAaXRlcmF0b3JdIGlzICVBcnJheVByb3RvX3ZhbHVlcyUgKDkuNC40LjYsIDkuNC40LjcpXG5faXRlcmF0b3JzLkFyZ3VtZW50cyA9IF9pdGVyYXRvcnMuQXJyYXk7XG5cbl9hZGRUb1Vuc2NvcGFibGVzKCdrZXlzJyk7XG5fYWRkVG9VbnNjb3BhYmxlcygndmFsdWVzJyk7XG5fYWRkVG9VbnNjb3BhYmxlcygnZW50cmllcycpO1xuXG52YXIgSVRFUkFUT1IkMSA9IF93a3MoJ2l0ZXJhdG9yJyk7XG52YXIgVE9fU1RSSU5HX1RBRyA9IF93a3MoJ3RvU3RyaW5nVGFnJyk7XG52YXIgQXJyYXlWYWx1ZXMgPSBfaXRlcmF0b3JzLkFycmF5O1xuXG52YXIgRE9NSXRlcmFibGVzID0ge1xuICBDU1NSdWxlTGlzdDogdHJ1ZSwgLy8gVE9ETzogTm90IHNwZWMgY29tcGxpYW50LCBzaG91bGQgYmUgZmFsc2UuXG4gIENTU1N0eWxlRGVjbGFyYXRpb246IGZhbHNlLFxuICBDU1NWYWx1ZUxpc3Q6IGZhbHNlLFxuICBDbGllbnRSZWN0TGlzdDogZmFsc2UsXG4gIERPTVJlY3RMaXN0OiBmYWxzZSxcbiAgRE9NU3RyaW5nTGlzdDogZmFsc2UsXG4gIERPTVRva2VuTGlzdDogdHJ1ZSxcbiAgRGF0YVRyYW5zZmVySXRlbUxpc3Q6IGZhbHNlLFxuICBGaWxlTGlzdDogZmFsc2UsXG4gIEhUTUxBbGxDb2xsZWN0aW9uOiBmYWxzZSxcbiAgSFRNTENvbGxlY3Rpb246IGZhbHNlLFxuICBIVE1MRm9ybUVsZW1lbnQ6IGZhbHNlLFxuICBIVE1MU2VsZWN0RWxlbWVudDogZmFsc2UsXG4gIE1lZGlhTGlzdDogdHJ1ZSwgLy8gVE9ETzogTm90IHNwZWMgY29tcGxpYW50LCBzaG91bGQgYmUgZmFsc2UuXG4gIE1pbWVUeXBlQXJyYXk6IGZhbHNlLFxuICBOYW1lZE5vZGVNYXA6IGZhbHNlLFxuICBOb2RlTGlzdDogdHJ1ZSxcbiAgUGFpbnRSZXF1ZXN0TGlzdDogZmFsc2UsXG4gIFBsdWdpbjogZmFsc2UsXG4gIFBsdWdpbkFycmF5OiBmYWxzZSxcbiAgU1ZHTGVuZ3RoTGlzdDogZmFsc2UsXG4gIFNWR051bWJlckxpc3Q6IGZhbHNlLFxuICBTVkdQYXRoU2VnTGlzdDogZmFsc2UsXG4gIFNWR1BvaW50TGlzdDogZmFsc2UsXG4gIFNWR1N0cmluZ0xpc3Q6IGZhbHNlLFxuICBTVkdUcmFuc2Zvcm1MaXN0OiBmYWxzZSxcbiAgU291cmNlQnVmZmVyTGlzdDogZmFsc2UsXG4gIFN0eWxlU2hlZXRMaXN0OiB0cnVlLCAvLyBUT0RPOiBOb3Qgc3BlYyBjb21wbGlhbnQsIHNob3VsZCBiZSBmYWxzZS5cbiAgVGV4dFRyYWNrQ3VlTGlzdDogZmFsc2UsXG4gIFRleHRUcmFja0xpc3Q6IGZhbHNlLFxuICBUb3VjaExpc3Q6IGZhbHNlXG59O1xuXG5mb3IgKHZhciBjb2xsZWN0aW9ucyA9IF9vYmplY3RLZXlzKERPTUl0ZXJhYmxlcyksIGkgPSAwOyBpIDwgY29sbGVjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgdmFyIE5BTUUgPSBjb2xsZWN0aW9uc1tpXTtcbiAgdmFyIGV4cGxpY2l0ID0gRE9NSXRlcmFibGVzW05BTUVdO1xuICB2YXIgQ29sbGVjdGlvbiA9IF9nbG9iYWxbTkFNRV07XG4gIHZhciBwcm90byA9IENvbGxlY3Rpb24gJiYgQ29sbGVjdGlvbi5wcm90b3R5cGU7XG4gIHZhciBrZXk7XG4gIGlmIChwcm90bykge1xuICAgIGlmICghcHJvdG9bSVRFUkFUT1IkMV0pIF9oaWRlKHByb3RvLCBJVEVSQVRPUiQxLCBBcnJheVZhbHVlcyk7XG4gICAgaWYgKCFwcm90b1tUT19TVFJJTkdfVEFHXSkgX2hpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpO1xuICAgIF9pdGVyYXRvcnNbTkFNRV0gPSBBcnJheVZhbHVlcztcbiAgICBpZiAoZXhwbGljaXQpIGZvciAoa2V5IGluIGVzNl9hcnJheV9pdGVyYXRvcikgaWYgKCFwcm90b1trZXldKSBfcmVkZWZpbmUocHJvdG8sIGtleSwgZXM2X2FycmF5X2l0ZXJhdG9yW2tleV0sIHRydWUpO1xuICB9XG59XG5cbnZhciBpdGVyYXRvciA9IF93a3NFeHQuZignaXRlcmF0b3InKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vQGZpcmViYXNlL3BvbHlmaWxsL2Rpc3QvaW5kZXguZXNtLmpzXG4vLyBtb2R1bGUgaWQgPSAzN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG5cbnZhciB0c2xpYl8xID0gcmVxdWlyZSgndHNsaWInKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IEZpcmViYXNlIGNvbnN0YW50cy4gIFNvbWUgb2YgdGhlc2UgKEBkZWZpbmVzKSBjYW4gYmUgb3ZlcnJpZGRlbiBhdCBjb21waWxlLXRpbWUuXHJcbiAqL1xyXG52YXIgQ09OU1RBTlRTID0ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVmaW5lIHtib29sZWFufSBXaGV0aGVyIHRoaXMgaXMgdGhlIGNsaWVudCBOb2RlLmpzIFNESy5cclxuICAgICAqL1xyXG4gICAgTk9ERV9DTElFTlQ6IGZhbHNlLFxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVmaW5lIHtib29sZWFufSBXaGV0aGVyIHRoaXMgaXMgdGhlIEFkbWluIE5vZGUuanMgU0RLLlxyXG4gICAgICovXHJcbiAgICBOT0RFX0FETUlOOiBmYWxzZSxcclxuICAgIC8qKlxyXG4gICAgICogRmlyZWJhc2UgU0RLIFZlcnNpb25cclxuICAgICAqL1xyXG4gICAgU0RLX1ZFUlNJT046ICcke0pTQ09SRV9WRVJTSU9OfSdcclxufTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIHByb3ZpZGVkIGFzc2VydGlvbiBpcyBmYWxzeVxyXG4gKiBAcGFyYW0geyp9IGFzc2VydGlvbiBUaGUgYXNzZXJ0aW9uIHRvIGJlIHRlc3RlZCBmb3IgZmFsc2luZXNzXHJcbiAqIEBwYXJhbSB7IXN0cmluZ30gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBkaXNwbGF5IGlmIHRoZSBjaGVjayBmYWlsc1xyXG4gKi9cclxudmFyIGFzc2VydCA9IGZ1bmN0aW9uIChhc3NlcnRpb24sIG1lc3NhZ2UpIHtcclxuICAgIGlmICghYXNzZXJ0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgYXNzZXJ0aW9uRXJyb3IobWVzc2FnZSk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGFuIEVycm9yIG9iamVjdCBzdWl0YWJsZSBmb3IgdGhyb3dpbmcuXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXHJcbiAqIEByZXR1cm4geyFFcnJvcn1cclxuICovXHJcbnZhciBhc3NlcnRpb25FcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XHJcbiAgICByZXR1cm4gbmV3IEVycm9yKCdGaXJlYmFzZSBEYXRhYmFzZSAoJyArXHJcbiAgICAgICAgQ09OU1RBTlRTLlNES19WRVJTSU9OICtcclxuICAgICAgICAnKSBJTlRFUk5BTCBBU1NFUlQgRkFJTEVEOiAnICtcclxuICAgICAgICBtZXNzYWdlKTtcclxufTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBzdHJpbmdUb0J5dGVBcnJheSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIC8vIFRPRE8odXNlcik6IFVzZSBuYXRpdmUgaW1wbGVtZW50YXRpb25zIGlmL3doZW4gYXZhaWxhYmxlXHJcbiAgICB2YXIgb3V0ID0gW10sIHAgPSAwO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gYztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiA2KSB8IDE5MjtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoKGMgJiAweGZjMDApID09IDB4ZDgwMCAmJlxyXG4gICAgICAgICAgICBpICsgMSA8IHN0ci5sZW5ndGggJiZcclxuICAgICAgICAgICAgKHN0ci5jaGFyQ29kZUF0KGkgKyAxKSAmIDB4ZmMwMCkgPT0gMHhkYzAwKSB7XHJcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXHJcbiAgICAgICAgICAgIGMgPSAweDEwMDAwICsgKChjICYgMHgwM2ZmKSA8PCAxMCkgKyAoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4MDNmZik7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTgpIHwgMjQwO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiAxMikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxMikgfCAyMjQ7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvdXQ7XHJcbn07XHJcbi8qKlxyXG4gKiBUdXJucyBhbiBhcnJheSBvZiBudW1iZXJzIGludG8gdGhlIHN0cmluZyBnaXZlbiBieSB0aGUgY29uY2F0ZW5hdGlvbiBvZiB0aGVcclxuICogY2hhcmFjdGVycyB0byB3aGljaCB0aGUgbnVtYmVycyBjb3JyZXNwb25kLlxyXG4gKiBAcGFyYW0ge0FycmF5PG51bWJlcj59IGJ5dGVzIEFycmF5IG9mIG51bWJlcnMgcmVwcmVzZW50aW5nIGNoYXJhY3RlcnMuXHJcbiAqIEByZXR1cm4ge3N0cmluZ30gU3RyaW5naWZpY2F0aW9uIG9mIHRoZSBhcnJheS5cclxuICovXHJcbnZhciBieXRlQXJyYXlUb1N0cmluZyA9IGZ1bmN0aW9uIChieXRlcykge1xyXG4gICAgLy8gVE9ETyh1c2VyKTogVXNlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMgaWYvd2hlbiBhdmFpbGFibGVcclxuICAgIHZhciBvdXQgPSBbXSwgcG9zID0gMCwgYyA9IDA7XHJcbiAgICB3aGlsZSAocG9zIDwgYnl0ZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgdmFyIGMxID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgIGlmIChjMSA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoYzEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjMSA+IDE5MSAmJiBjMSA8IDIyNCkge1xyXG4gICAgICAgICAgICB2YXIgYzIgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgoKGMxICYgMzEpIDw8IDYpIHwgKGMyICYgNjMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYzEgPiAyMzkgJiYgYzEgPCAzNjUpIHtcclxuICAgICAgICAgICAgLy8gU3Vycm9nYXRlIFBhaXJcclxuICAgICAgICAgICAgdmFyIGMyID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICB2YXIgYzMgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIHZhciBjNCA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgdmFyIHUgPSAoKChjMSAmIDcpIDw8IDE4KSB8ICgoYzIgJiA2MykgPDwgMTIpIHwgKChjMyAmIDYzKSA8PCA2KSB8IChjNCAmIDYzKSkgLVxyXG4gICAgICAgICAgICAgICAgMHgxMDAwMDtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ZDgwMCArICh1ID4+IDEwKSk7XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweGRjMDAgKyAodSAmIDEwMjMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBjMiA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgdmFyIGMzID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjMSAmIDE1KSA8PCAxMikgfCAoKGMyICYgNjMpIDw8IDYpIHwgKGMzICYgNjMpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0LmpvaW4oJycpO1xyXG59O1xyXG4vLyBTdGF0aWMgbG9va3VwIG1hcHMsIGxhemlseSBwb3B1bGF0ZWQgYnkgaW5pdF8oKVxyXG52YXIgYmFzZTY0ID0ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIGJ5dGVzIHRvIGNoYXJhY3RlcnMuXHJcbiAgICAgKiBAdHlwZSB7T2JqZWN0fVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgYnl0ZVRvQ2hhck1hcF86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgY2hhcmFjdGVycyB0byBieXRlcy5cclxuICAgICAqIEB0eXBlIHtPYmplY3R9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBjaGFyVG9CeXRlTWFwXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBieXRlcyB0byB3ZWJzYWZlIGNoYXJhY3RlcnMuXHJcbiAgICAgKiBAdHlwZSB7T2JqZWN0fVxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgYnl0ZVRvQ2hhck1hcFdlYlNhZmVfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIHdlYnNhZmUgY2hhcmFjdGVycyB0byBieXRlcy5cclxuICAgICAqIEB0eXBlIHtPYmplY3R9XHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBjaGFyVG9CeXRlTWFwV2ViU2FmZV86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE91ciBkZWZhdWx0IGFscGhhYmV0LCBzaGFyZWQgYmV0d2VlblxyXG4gICAgICogRU5DT0RFRF9WQUxTIGFuZCBFTkNPREVEX1ZBTFNfV0VCU0FGRVxyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgRU5DT0RFRF9WQUxTX0JBU0U6ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicgKyAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonICsgJzAxMjM0NTY3ODknLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldC4gVmFsdWUgNjQgKD0pIGlzIHNwZWNpYWw7IGl0IG1lYW5zIFwibm90aGluZy5cIlxyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgZ2V0IEVOQ09ERURfVkFMUygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5FTkNPREVEX1ZBTFNfQkFTRSArICcrLz0nO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogT3VyIHdlYnNhZmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICovXHJcbiAgICBnZXQgRU5DT0RFRF9WQUxTX1dFQlNBRkUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UgKyAnLV8uJztcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIFdoZXRoZXIgdGhpcyBicm93c2VyIHN1cHBvcnRzIHRoZSBhdG9iIGFuZCBidG9hIGZ1bmN0aW9ucy4gVGhpcyBleHRlbnNpb25cclxuICAgICAqIHN0YXJ0ZWQgYXQgTW96aWxsYSBidXQgaXMgbm93IGltcGxlbWVudGVkIGJ5IG1hbnkgYnJvd3NlcnMuIFdlIHVzZSB0aGVcclxuICAgICAqIEFTU1VNRV8qIHZhcmlhYmxlcyB0byBhdm9pZCBwdWxsaW5nIGluIHRoZSBmdWxsIHVzZXJhZ2VudCBkZXRlY3Rpb24gbGlicmFyeVxyXG4gICAgICogYnV0IHN0aWxsIGFsbG93aW5nIHRoZSBzdGFuZGFyZCBwZXItYnJvd3NlciBjb21waWxhdGlvbnMuXHJcbiAgICAgKlxyXG4gICAgICogQHR5cGUge2Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIEhBU19OQVRJVkVfU1VQUE9SVDogdHlwZW9mIGF0b2IgPT09ICdmdW5jdGlvbicsXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1lbmNvZGUgYW4gYXJyYXkgb2YgYnl0ZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtBcnJheTxudW1iZXI+fFVpbnQ4QXJyYXl9IGlucHV0IEFuIGFycmF5IG9mIGJ5dGVzIChudW1iZXJzIHdpdGhcclxuICAgICAqICAgICB2YWx1ZSBpbiBbMCwgMjU1XSkgdG8gZW5jb2RlLlxyXG4gICAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0X3dlYlNhZmUgQm9vbGVhbiBpbmRpY2F0aW5nIHdlIHNob3VsZCB1c2UgdGhlXHJcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGVuY29kZUJ5dGVBcnJheTogZnVuY3Rpb24gKGlucHV0LCBvcHRfd2ViU2FmZSkge1xyXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ2VuY29kZUJ5dGVBcnJheSB0YWtlcyBhbiBhcnJheSBhcyBhIHBhcmFtZXRlcicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluaXRfKCk7XHJcbiAgICAgICAgdmFyIGJ5dGVUb0NoYXJNYXAgPSBvcHRfd2ViU2FmZVxyXG4gICAgICAgICAgICA/IHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfXHJcbiAgICAgICAgICAgIDogdGhpcy5ieXRlVG9DaGFyTWFwXztcclxuICAgICAgICB2YXIgb3V0cHV0ID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkgKz0gMykge1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTEgPSBpbnB1dFtpXTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMiA9IGkgKyAxIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBpbnB1dFtpICsgMV0gOiAwO1xyXG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGUzID0gaSArIDIgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMyA9IGhhdmVCeXRlMyA/IGlucHV0W2kgKyAyXSA6IDA7XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMSA9IGJ5dGUxID4+IDI7XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMiA9ICgoYnl0ZTEgJiAweDAzKSA8PCA0KSB8IChieXRlMiA+PiA0KTtcclxuICAgICAgICAgICAgdmFyIG91dEJ5dGUzID0gKChieXRlMiAmIDB4MGYpIDw8IDIpIHwgKGJ5dGUzID4+IDYpO1xyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTQgPSBieXRlMyAmIDB4M2Y7XHJcbiAgICAgICAgICAgIGlmICghaGF2ZUJ5dGUzKSB7XHJcbiAgICAgICAgICAgICAgICBvdXRCeXRlNCA9IDY0O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXZlQnl0ZTIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvdXRCeXRlMyA9IDY0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTFdLCBieXRlVG9DaGFyTWFwW291dEJ5dGUyXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlM10sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTRdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dC5qb2luKCcnKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1lbmNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGlucHV0IEEgc3RyaW5nIHRvIGVuY29kZS5cclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdF93ZWJTYWZlIElmIHRydWUsIHdlIHNob3VsZCB1c2UgdGhlXHJcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGVuY29kZVN0cmluZzogZnVuY3Rpb24gKGlucHV0LCBvcHRfd2ViU2FmZSkge1xyXG4gICAgICAgIC8vIFNob3J0Y3V0IGZvciBNb3ppbGxhIGJyb3dzZXJzIHRoYXQgaW1wbGVtZW50XHJcbiAgICAgICAgLy8gYSBuYXRpdmUgYmFzZTY0IGVuY29kZXIgaW4gdGhlIGZvcm0gb2YgXCJidG9hL2F0b2JcIlxyXG4gICAgICAgIGlmICh0aGlzLkhBU19OQVRJVkVfU1VQUE9SVCAmJiAhb3B0X3dlYlNhZmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGJ0b2EoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVCeXRlQXJyYXkoc3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQpLCBvcHRfd2ViU2FmZSk7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBCYXNlNjQtZGVjb2RlIGEgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbnB1dCB0byBkZWNvZGUuXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfd2ViU2FmZSBUcnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlXHJcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGRlY29kZWQgdmFsdWUuXHJcbiAgICAgKi9cclxuICAgIGRlY29kZVN0cmluZzogZnVuY3Rpb24gKGlucHV0LCBvcHRfd2ViU2FmZSkge1xyXG4gICAgICAgIC8vIFNob3J0Y3V0IGZvciBNb3ppbGxhIGJyb3dzZXJzIHRoYXQgaW1wbGVtZW50XHJcbiAgICAgICAgLy8gYSBuYXRpdmUgYmFzZTY0IGVuY29kZXIgaW4gdGhlIGZvcm0gb2YgXCJidG9hL2F0b2JcIlxyXG4gICAgICAgIGlmICh0aGlzLkhBU19OQVRJVkVfU1VQUE9SVCAmJiAhb3B0X3dlYlNhZmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGF0b2IoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYnl0ZUFycmF5VG9TdHJpbmcodGhpcy5kZWNvZGVTdHJpbmdUb0J5dGVBcnJheShpbnB1dCwgb3B0X3dlYlNhZmUpKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1kZWNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogSW4gYmFzZS02NCBkZWNvZGluZywgZ3JvdXBzIG9mIGZvdXIgY2hhcmFjdGVycyBhcmUgY29udmVydGVkIGludG8gdGhyZWVcclxuICAgICAqIGJ5dGVzLiAgSWYgdGhlIGVuY29kZXIgZGlkIG5vdCBhcHBseSBwYWRkaW5nLCB0aGUgaW5wdXQgbGVuZ3RoIG1heSBub3RcclxuICAgICAqIGJlIGEgbXVsdGlwbGUgb2YgNC5cclxuICAgICAqXHJcbiAgICAgKiBJbiB0aGlzIGNhc2UsIHRoZSBsYXN0IGdyb3VwIHdpbGwgaGF2ZSBmZXdlciB0aGFuIDQgY2hhcmFjdGVycywgYW5kXHJcbiAgICAgKiBwYWRkaW5nIHdpbGwgYmUgaW5mZXJyZWQuICBJZiB0aGUgZ3JvdXAgaGFzIG9uZSBvciB0d28gY2hhcmFjdGVycywgaXQgZGVjb2Rlc1xyXG4gICAgICogdG8gb25lIGJ5dGUuICBJZiB0aGUgZ3JvdXAgaGFzIHRocmVlIGNoYXJhY3RlcnMsIGl0IGRlY29kZXMgdG8gdHdvIGJ5dGVzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpbnB1dCBJbnB1dCB0byBkZWNvZGUuXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRfd2ViU2FmZSBUcnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlIHdlYi1zYWZlIGFscGhhYmV0LlxyXG4gICAgICogQHJldHVybiB7IUFycmF5PG51bWJlcj59IGJ5dGVzIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXk6IGZ1bmN0aW9uIChpbnB1dCwgb3B0X3dlYlNhZmUpIHtcclxuICAgICAgICB0aGlzLmluaXRfKCk7XHJcbiAgICAgICAgdmFyIGNoYXJUb0J5dGVNYXAgPSBvcHRfd2ViU2FmZVxyXG4gICAgICAgICAgICA/IHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfXHJcbiAgICAgICAgICAgIDogdGhpcy5jaGFyVG9CeXRlTWFwXztcclxuICAgICAgICB2YXIgb3V0cHV0ID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7KSB7XHJcbiAgICAgICAgICAgIHZhciBieXRlMSA9IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkrKyldO1xyXG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGUyID0gaSA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgdmFyIGJ5dGUyID0gaGF2ZUJ5dGUyID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogMDtcclxuICAgICAgICAgICAgKytpO1xyXG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGUzID0gaSA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgdmFyIGJ5dGUzID0gaGF2ZUJ5dGUzID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogNjQ7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlNCA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlNCA9IGhhdmVCeXRlNCA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDY0O1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIGlmIChieXRlMSA9PSBudWxsIHx8IGJ5dGUyID09IG51bGwgfHwgYnl0ZTMgPT0gbnVsbCB8fCBieXRlNCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMSA9IChieXRlMSA8PCAyKSB8IChieXRlMiA+PiA0KTtcclxuICAgICAgICAgICAgb3V0cHV0LnB1c2gob3V0Qnl0ZTEpO1xyXG4gICAgICAgICAgICBpZiAoYnl0ZTMgIT0gNjQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvdXRCeXRlMiA9ICgoYnl0ZTIgPDwgNCkgJiAweGYwKSB8IChieXRlMyA+PiAyKTtcclxuICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUyKTtcclxuICAgICAgICAgICAgICAgIGlmIChieXRlNCAhPSA2NCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvdXRCeXRlMyA9ICgoYnl0ZTMgPDwgNikgJiAweGMwKSB8IGJ5dGU0O1xyXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3V0cHV0O1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogTGF6eSBzdGF0aWMgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24uIENhbGxlZCBiZWZvcmVcclxuICAgICAqIGFjY2Vzc2luZyBhbnkgb2YgdGhlIHN0YXRpYyBtYXAgdmFyaWFibGVzLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgaW5pdF86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYnl0ZVRvQ2hhck1hcF8pIHtcclxuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwXyA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfID0ge307XHJcbiAgICAgICAgICAgIC8vIFdlIHdhbnQgcXVpY2sgbWFwcGluZ3MgYmFjayBhbmQgZm9ydGgsIHNvIHdlIHByZWNvbXB1dGUgdHdvIG1hcHMuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5FTkNPREVEX1ZBTFMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcF9baV0gPSB0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfW3RoaXMuYnl0ZVRvQ2hhck1hcF9baV1dID0gaTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfW2ldID0gdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1tpXV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgLy8gQmUgZm9yZ2l2aW5nIHdoZW4gZGVjb2RpbmcgYW5kIGNvcnJlY3RseSBkZWNvZGUgYm90aCBlbmNvZGluZ3MuXHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSB0aGlzLkVOQ09ERURfVkFMU19CQVNFLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSldID0gaTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSldID0gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIFVSTC1zYWZlIGJhc2U2NCBlbmNvZGluZ1xyXG4gKiBAcGFyYW0geyFzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHshc3RyaW5nfVxyXG4gKi9cclxudmFyIGJhc2U2NEVuY29kZSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHZhciB1dGY4Qnl0ZXMgPSBzdHJpbmdUb0J5dGVBcnJheShzdHIpO1xyXG4gICAgcmV0dXJuIGJhc2U2NC5lbmNvZGVCeXRlQXJyYXkodXRmOEJ5dGVzLCB0cnVlKTtcclxufTtcclxuLyoqXHJcbiAqIFVSTC1zYWZlIGJhc2U2NCBkZWNvZGluZ1xyXG4gKlxyXG4gKiBOT1RFOiBETyBOT1QgdXNlIHRoZSBnbG9iYWwgYXRvYigpIGZ1bmN0aW9uIC0gaXQgZG9lcyBOT1Qgc3VwcG9ydCB0aGVcclxuICogYmFzZTY0VXJsIHZhcmlhbnQgZW5jb2RpbmcuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgVG8gYmUgZGVjb2RlZFxyXG4gKiBAcmV0dXJuIHs/c3RyaW5nfSBEZWNvZGVkIHJlc3VsdCwgaWYgcG9zc2libGVcclxuICovXHJcbnZhciBiYXNlNjREZWNvZGUgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBiYXNlNjQuZGVjb2RlU3RyaW5nKHN0ciwgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2Jhc2U2NERlY29kZSBmYWlsZWQ6ICcsIGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn07XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRG8gYSBkZWVwLWNvcHkgb2YgYmFzaWMgSmF2YVNjcmlwdCBPYmplY3RzIG9yIEFycmF5cy5cclxuICovXHJcbmZ1bmN0aW9uIGRlZXBDb3B5KHZhbHVlKSB7XHJcbiAgICByZXR1cm4gZGVlcEV4dGVuZCh1bmRlZmluZWQsIHZhbHVlKTtcclxufVxyXG4vKipcclxuICogQ29weSBwcm9wZXJ0aWVzIGZyb20gc291cmNlIHRvIHRhcmdldCAocmVjdXJzaXZlbHkgYWxsb3dzIGV4dGVuc2lvblxyXG4gKiBvZiBPYmplY3RzIGFuZCBBcnJheXMpLiAgU2NhbGFyIHZhbHVlcyBpbiB0aGUgdGFyZ2V0IGFyZSBvdmVyLXdyaXR0ZW4uXHJcbiAqIElmIHRhcmdldCBpcyB1bmRlZmluZWQsIGFuIG9iamVjdCBvZiB0aGUgYXBwcm9wcmlhdGUgdHlwZSB3aWxsIGJlIGNyZWF0ZWRcclxuICogKGFuZCByZXR1cm5lZCkuXHJcbiAqXHJcbiAqIFdlIHJlY3Vyc2l2ZWx5IGNvcHkgYWxsIGNoaWxkIHByb3BlcnRpZXMgb2YgcGxhaW4gT2JqZWN0cyBpbiB0aGUgc291cmNlLSBzb1xyXG4gKiB0aGF0IG5hbWVzcGFjZS0gbGlrZSBkaWN0aW9uYXJpZXMgYXJlIG1lcmdlZC5cclxuICpcclxuICogTm90ZSB0aGF0IHRoZSB0YXJnZXQgY2FuIGJlIGEgZnVuY3Rpb24sIGluIHdoaWNoIGNhc2UgdGhlIHByb3BlcnRpZXMgaW5cclxuICogdGhlIHNvdXJjZSBPYmplY3QgYXJlIGNvcGllZCBvbnRvIGl0IGFzIHN0YXRpYyBwcm9wZXJ0aWVzIG9mIHRoZSBGdW5jdGlvbi5cclxuICovXHJcbmZ1bmN0aW9uIGRlZXBFeHRlbmQodGFyZ2V0LCBzb3VyY2UpIHtcclxuICAgIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIE9iamVjdCkpIHtcclxuICAgICAgICByZXR1cm4gc291cmNlO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoIChzb3VyY2UuY29uc3RydWN0b3IpIHtcclxuICAgICAgICBjYXNlIERhdGU6XHJcbiAgICAgICAgICAgIC8vIFRyZWF0IERhdGVzIGxpa2Ugc2NhbGFyczsgaWYgdGhlIHRhcmdldCBkYXRlIG9iamVjdCBoYWQgYW55IGNoaWxkXHJcbiAgICAgICAgICAgIC8vIHByb3BlcnRpZXMgLSB0aGV5IHdpbGwgYmUgbG9zdCFcclxuICAgICAgICAgICAgdmFyIGRhdGVWYWx1ZSA9IHNvdXJjZTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGVWYWx1ZS5nZXRUaW1lKCkpO1xyXG4gICAgICAgIGNhc2UgT2JqZWN0OlxyXG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQXJyYXk6XHJcbiAgICAgICAgICAgIC8vIEFsd2F5cyBjb3B5IHRoZSBhcnJheSBzb3VyY2UgYW5kIG92ZXJ3cml0ZSB0aGUgdGFyZ2V0LlxyXG4gICAgICAgICAgICB0YXJnZXQgPSBbXTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgLy8gTm90IGEgcGxhaW4gT2JqZWN0IC0gdHJlYXQgaXQgYXMgYSBzY2FsYXIuXHJcbiAgICAgICAgICAgIHJldHVybiBzb3VyY2U7XHJcbiAgICB9XHJcbiAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xyXG4gICAgICAgIGlmICghc291cmNlLmhhc093blByb3BlcnR5KHByb3ApKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0YXJnZXRbcHJvcF0gPSBkZWVwRXh0ZW5kKHRhcmdldFtwcm9wXSwgc291cmNlW3Byb3BdKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0YXJnZXQ7XHJcbn1cclxuLy8gVE9ETzogUmVhbGx5IG5lZWRlZCAoZm9yIEpTQ29tcGlsZXIgdHlwZSBjaGVja2luZyk/XHJcbmZ1bmN0aW9uIHBhdGNoUHJvcGVydHkob2JqLCBwcm9wLCB2YWx1ZSkge1xyXG4gICAgb2JqW3Byb3BdID0gdmFsdWU7XHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBEZWZlcnJlZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERlZmVycmVkKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgX3RoaXMucmVqZWN0ID0gcmVqZWN0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgQVBJIGludGVybmFscyBhcmUgbm90IHByb21pc2VpZmllZCBhbmQgY2Fubm90IGJlY2F1c2Ugb3VyIGNhbGxiYWNrIEFQSXMgaGF2ZSBzdWJ0bGUgZXhwZWN0YXRpb25zIGFyb3VuZFxyXG4gICAgICogaW52b2tpbmcgcHJvbWlzZXMgaW5saW5lLCB3aGljaCBQcm9taXNlcyBhcmUgZm9yYmlkZGVuIHRvIGRvLiBUaGlzIG1ldGhvZCBhY2NlcHRzIGFuIG9wdGlvbmFsIG5vZGUtc3R5bGUgY2FsbGJhY2tcclxuICAgICAqIGFuZCByZXR1cm5zIGEgbm9kZS1zdHlsZSBjYWxsYmFjayB3aGljaCB3aWxsIHJlc29sdmUgb3IgcmVqZWN0IHRoZSBEZWZlcnJlZCdzIHByb21pc2UuXHJcbiAgICAgKiBAcGFyYW0geygoP2Z1bmN0aW9uKD8oRXJyb3IpKTogKD98dW5kZWZpbmVkKSl8ICg/ZnVuY3Rpb24oPyhFcnJvciksPz0pOiAoP3x1bmRlZmluZWQpKSk9fSBjYWxsYmFja1xyXG4gICAgICogQHJldHVybiB7IWZ1bmN0aW9uKD8oRXJyb3IpLCA/PSl9XHJcbiAgICAgKi9cclxuICAgIERlZmVycmVkLnByb3RvdHlwZS53cmFwQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXJyb3IsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIC8vIEF0dGFjaGluZyBub29wIGhhbmRsZXIganVzdCBpbiBjYXNlIGRldmVsb3BlciB3YXNuJ3QgZXhwZWN0aW5nXHJcbiAgICAgICAgICAgICAgICAvLyBwcm9taXNlc1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucHJvbWlzZS5jYXRjaChmdW5jdGlvbiAoKSB7IH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gU29tZSBvZiBvdXIgY2FsbGJhY2tzIGRvbid0IGV4cGVjdCBhIHZhbHVlIGFuZCBvdXIgb3duIHRlc3RzXHJcbiAgICAgICAgICAgICAgICAvLyBhc3NlcnQgdGhhdCB0aGUgcGFyYW1ldGVyIGxlbmd0aCBpcyAxXHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2subGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlZmVycmVkO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFJldHVybnMgbmF2aWdhdG9yLnVzZXJBZ2VudCBzdHJpbmcgb3IgJycgaWYgaXQncyBub3QgZGVmaW5lZC5cclxuICogQHJldHVybiB7c3RyaW5nfSB1c2VyIGFnZW50IHN0cmluZ1xyXG4gKi9cclxudmFyIGdldFVBID0gZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgdHlwZW9mIG5hdmlnYXRvclsndXNlckFnZW50J10gPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgcmV0dXJuIG5hdmlnYXRvclsndXNlckFnZW50J107XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBEZXRlY3QgQ29yZG92YSAvIFBob25lR2FwIC8gSW9uaWMgZnJhbWV3b3JrcyBvbiBhIG1vYmlsZSBkZXZpY2UuXHJcbiAqXHJcbiAqIERlbGliZXJhdGVseSBkb2VzIG5vdCByZWx5IG9uIGNoZWNraW5nIGBmaWxlOi8vYCBVUkxzIChhcyB0aGlzIGZhaWxzIFBob25lR2FwIGluIHRoZSBSaXBwbGUgZW11bGF0b3IpIG5vclxyXG4gKiBDb3Jkb3ZhIGBvbkRldmljZVJlYWR5YCwgd2hpY2ggd291bGQgbm9ybWFsbHkgd2FpdCBmb3IgYSBjYWxsYmFjay5cclxuICpcclxuICogQHJldHVybiB7Ym9vbGVhbn0gaXNNb2JpbGVDb3Jkb3ZhXHJcbiAqL1xyXG52YXIgaXNNb2JpbGVDb3Jkb3ZhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgICEhKHdpbmRvd1snY29yZG92YSddIHx8IHdpbmRvd1sncGhvbmVnYXAnXSB8fCB3aW5kb3dbJ1Bob25lR2FwJ10pICYmXHJcbiAgICAgICAgL2lvc3xpcGhvbmV8aXBvZHxpcGFkfGFuZHJvaWR8YmxhY2tiZXJyeXxpZW1vYmlsZS9pLnRlc3QoZ2V0VUEoKSkpO1xyXG59O1xyXG4vKipcclxuICogRGV0ZWN0IFJlYWN0IE5hdGl2ZS5cclxuICpcclxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiBSZWFjdE5hdGl2ZSBlbnZpcm9ubWVudCBpcyBkZXRlY3RlZC5cclxuICovXHJcbnZhciBpc1JlYWN0TmF0aXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuICh0eXBlb2YgbmF2aWdhdG9yID09PSAnb2JqZWN0JyAmJiBuYXZpZ2F0b3JbJ3Byb2R1Y3QnXSA9PT0gJ1JlYWN0TmF0aXZlJyk7XHJcbn07XHJcbi8qKlxyXG4gKiBEZXRlY3QgTm9kZS5qcy5cclxuICpcclxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiBOb2RlLmpzIGVudmlyb25tZW50IGlzIGRldGVjdGVkLlxyXG4gKi9cclxudmFyIGlzTm9kZVNkayA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBDT05TVEFOVFMuTk9ERV9DTElFTlQgPT09IHRydWUgfHwgQ09OU1RBTlRTLk5PREVfQURNSU4gPT09IHRydWU7XHJcbn07XG5cbnZhciBFUlJPUl9OQU1FID0gJ0ZpcmViYXNlRXJyb3InO1xyXG52YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvclxyXG4gICAgLmNhcHR1cmVTdGFja1RyYWNlO1xyXG4vLyBFeHBvcnQgZm9yIGZha2luZyBpbiB0ZXN0c1xyXG5mdW5jdGlvbiBwYXRjaENhcHR1cmUoY2FwdHVyZUZha2UpIHtcclxuICAgIHZhciByZXN1bHQgPSBjYXB0dXJlU3RhY2tUcmFjZTtcclxuICAgIGNhcHR1cmVTdGFja1RyYWNlID0gY2FwdHVyZUZha2U7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbnZhciBGaXJlYmFzZUVycm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmlyZWJhc2VFcnJvcihjb2RlLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgICAgIC8vIFdlIHdhbnQgdGhlIHN0YWNrIHZhbHVlLCBpZiBpbXBsZW1lbnRlZCBieSBFcnJvclxyXG4gICAgICAgIGlmIChjYXB0dXJlU3RhY2tUcmFjZSkge1xyXG4gICAgICAgICAgICAvLyBQYXRjaGVzIHRoaXMuc3RhY2ssIG9taXR0ZWQgY2FsbHMgYWJvdmUgRXJyb3JGYWN0b3J5I2NyZWF0ZVxyXG4gICAgICAgICAgICBjYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBFcnJvckZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8gSW4gY2FzZSBvZiBJRTExLCBzdGFjayB3aWxsIGJlIHNldCBvbmx5IGFmdGVyIGVycm9yIGlzIHJhaXNlZC5cclxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZG9jcy5taWNyb3NvZnQuY29tL2VuLXVzL3NjcmlwdGluZy9qYXZhc2NyaXB0L3JlZmVyZW5jZS9zdGFjay1wcm9wZXJ0eS1lcnJvci1qYXZhc2NyaXB0XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9IEVSUk9SX05BTUU7XHJcbiAgICAgICAgICAgICAgICAvLyBNYWtlIG5vbi1lbnVtZXJhYmxlIGdldHRlciBmb3IgdGhlIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdzdGFjaycsIHtcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVyci5zdGFjaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBGaXJlYmFzZUVycm9yO1xyXG59KCkpO1xyXG4vLyBCYWNrLWRvb3IgaW5oZXJpdGFuY2VcclxuRmlyZWJhc2VFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XHJcbkZpcmViYXNlRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRmlyZWJhc2VFcnJvcjtcclxuRmlyZWJhc2VFcnJvci5wcm90b3R5cGUubmFtZSA9IEVSUk9SX05BTUU7XHJcbnZhciBFcnJvckZhY3RvcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBFcnJvckZhY3Rvcnkoc2VydmljZSwgc2VydmljZU5hbWUsIGVycm9ycykge1xyXG4gICAgICAgIHRoaXMuc2VydmljZSA9IHNlcnZpY2U7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlTmFtZSA9IHNlcnZpY2VOYW1lO1xyXG4gICAgICAgIHRoaXMuZXJyb3JzID0gZXJyb3JzO1xyXG4gICAgICAgIC8vIE1hdGNoZXMgeyRuYW1lfSwgYnkgZGVmYXVsdC5cclxuICAgICAgICB0aGlzLnBhdHRlcm4gPSAvXFx7XFwkKFtefV0rKX0vZztcclxuICAgICAgICAvLyBlbXB0eVxyXG4gICAgfVxyXG4gICAgRXJyb3JGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoY29kZSwgZGF0YSkge1xyXG4gICAgICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgZGF0YSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgdGVtcGxhdGUgPSB0aGlzLmVycm9yc1tjb2RlXTtcclxuICAgICAgICB2YXIgZnVsbENvZGUgPSB0aGlzLnNlcnZpY2UgKyAnLycgKyBjb2RlO1xyXG4gICAgICAgIHZhciBtZXNzYWdlO1xyXG4gICAgICAgIGlmICh0ZW1wbGF0ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSAnRXJyb3InO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbWVzc2FnZSA9IHRlbXBsYXRlLnJlcGxhY2UodGhpcy5wYXR0ZXJuLCBmdW5jdGlvbiAobWF0Y2gsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtrZXldO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZS50b1N0cmluZygpIDogJzwnICsga2V5ICsgJz8+JztcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFNlcnZpY2U6IEVycm9yIG1lc3NhZ2UgKHNlcnZpY2UvY29kZSkuXHJcbiAgICAgICAgbWVzc2FnZSA9IHRoaXMuc2VydmljZU5hbWUgKyAnOiAnICsgbWVzc2FnZSArICcgKCcgKyBmdWxsQ29kZSArICcpLic7XHJcbiAgICAgICAgdmFyIGVyciA9IG5ldyBGaXJlYmFzZUVycm9yKGZ1bGxDb2RlLCBtZXNzYWdlKTtcclxuICAgICAgICAvLyBQb3B1bGF0ZSB0aGUgRXJyb3Igb2JqZWN0IHdpdGggbWVzc2FnZSBwYXJ0cyBmb3IgcHJvZ3JhbW1hdGljXHJcbiAgICAgICAgLy8gYWNjZXNzZXMgKGUuZy4sIGUuZmlsZSkuXHJcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmICghZGF0YS5oYXNPd25Qcm9wZXJ0eShwcm9wKSB8fCBwcm9wLnNsaWNlKC0xKSA9PT0gJ18nKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlcnJbcHJvcF0gPSBkYXRhW3Byb3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZXJyO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBFcnJvckZhY3Rvcnk7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRXZhbHVhdGVzIGEgSlNPTiBzdHJpbmcgaW50byBhIGphdmFzY3JpcHQgb2JqZWN0LlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyIEEgc3RyaW5nIGNvbnRhaW5pbmcgSlNPTi5cclxuICogQHJldHVybiB7Kn0gVGhlIGphdmFzY3JpcHQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc3BlY2lmaWVkIEpTT04uXHJcbiAqL1xyXG5mdW5jdGlvbiBqc29uRXZhbChzdHIpIHtcclxuICAgIHJldHVybiBKU09OLnBhcnNlKHN0cik7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgSlNPTiByZXByZXNlbnRpbmcgYSBqYXZhc2NyaXB0IG9iamVjdC5cclxuICogQHBhcmFtIHsqfSBkYXRhIEphdmFzY3JpcHQgb2JqZWN0IHRvIGJlIHN0cmluZ2lmaWVkLlxyXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBKU09OIGNvbnRlbnRzIG9mIHRoZSBvYmplY3QuXHJcbiAqL1xyXG5mdW5jdGlvbiBzdHJpbmdpZnkoZGF0YSkge1xyXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG59XG5cbi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgSW5jLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGludG8gY29uc3RpdHVlbnQgcGFydHMuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gd2l0aCBpbnZhbGlkIC8gaW5jb21wbGV0ZSBjbGFpbXMgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7P3N0cmluZ30gdG9rZW5cclxuICogQHJldHVybiB7e2hlYWRlcjogKiwgY2xhaW1zOiAqLCBkYXRhOiAqLCBzaWduYXR1cmU6IHN0cmluZ319XHJcbiAqL1xyXG52YXIgZGVjb2RlID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICB2YXIgaGVhZGVyID0ge30sIGNsYWltcyA9IHt9LCBkYXRhID0ge30sIHNpZ25hdHVyZSA9ICcnO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgcGFydHMgPSB0b2tlbi5zcGxpdCgnLicpO1xyXG4gICAgICAgIGhlYWRlciA9IGpzb25FdmFsKGJhc2U2NERlY29kZShwYXJ0c1swXSkgfHwgJycpO1xyXG4gICAgICAgIGNsYWltcyA9IGpzb25FdmFsKGJhc2U2NERlY29kZShwYXJ0c1sxXSkgfHwgJycpO1xyXG4gICAgICAgIHNpZ25hdHVyZSA9IHBhcnRzWzJdO1xyXG4gICAgICAgIGRhdGEgPSBjbGFpbXNbJ2QnXSB8fCB7fTtcclxuICAgICAgICBkZWxldGUgY2xhaW1zWydkJ107XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkgeyB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGhlYWRlcjogaGVhZGVyLFxyXG4gICAgICAgIGNsYWltczogY2xhaW1zLFxyXG4gICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgc2lnbmF0dXJlOiBzaWduYXR1cmVcclxuICAgIH07XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIGNoZWNrcyB0aGUgdmFsaWRpdHkgb2YgaXRzIHRpbWUtYmFzZWQgY2xhaW1zLiBXaWxsIHJldHVybiB0cnVlIGlmIHRoZVxyXG4gKiB0b2tlbiBpcyB3aXRoaW4gdGhlIHRpbWUgd2luZG93IGF1dGhvcml6ZWQgYnkgdGhlICduYmYnIChub3QtYmVmb3JlKSBhbmQgJ2lhdCcgKGlzc3VlZC1hdCkgY2xhaW1zLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7P3N0cmluZ30gdG9rZW5cclxuICogQHJldHVybiB7Ym9vbGVhbn1cclxuICovXHJcbnZhciBpc1ZhbGlkVGltZXN0YW1wID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICB2YXIgY2xhaW1zID0gZGVjb2RlKHRva2VuKS5jbGFpbXMsIG5vdyA9IE1hdGguZmxvb3IobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKSwgdmFsaWRTaW5jZSwgdmFsaWRVbnRpbDtcclxuICAgIGlmICh0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ25iZicpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ25iZiddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ2lhdCddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCdleHAnKSkge1xyXG4gICAgICAgICAgICB2YWxpZFVudGlsID0gY2xhaW1zWydleHAnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRva2VuIHdpbGwgZXhwaXJlIGFmdGVyIDI0aCBieSBkZWZhdWx0XHJcbiAgICAgICAgICAgIHZhbGlkVW50aWwgPSB2YWxpZFNpbmNlICsgODY0MDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIChub3cgJiYgdmFsaWRTaW5jZSAmJiB2YWxpZFVudGlsICYmIG5vdyA+PSB2YWxpZFNpbmNlICYmIG5vdyA8PSB2YWxpZFVudGlsKTtcclxufTtcclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgcmV0dXJucyBpdHMgaXNzdWVkIGF0IHRpbWUgaWYgdmFsaWQsIG51bGwgb3RoZXJ3aXNlLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIG51bGwgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7P3N0cmluZ30gdG9rZW5cclxuICogQHJldHVybiB7P251bWJlcn1cclxuICovXHJcbnZhciBpc3N1ZWRBdFRpbWUgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBjbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcztcclxuICAgIGlmICh0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpKSB7XHJcbiAgICAgICAgcmV0dXJuIGNsYWltc1snaWF0J107XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufTtcclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgY2hlY2tzIHRoZSB2YWxpZGl0eSBvZiBpdHMgZm9ybWF0LiBFeHBlY3RzIGEgdmFsaWQgaXNzdWVkLWF0IHRpbWUuXHJcbiAqXHJcbiAqIE5vdGVzOlxyXG4gKiAtIE1heSByZXR1cm4gYSBmYWxzZSBuZWdhdGl2ZSBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICpcclxuICogQHBhcmFtIHs/c3RyaW5nfSB0b2tlblxyXG4gKiBAcmV0dXJuIHtib29sZWFufVxyXG4gKi9cclxudmFyIGlzVmFsaWRGb3JtYXQgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBkZWNvZGVkID0gZGVjb2RlKHRva2VuKSwgY2xhaW1zID0gZGVjb2RlZC5jbGFpbXM7XHJcbiAgICByZXR1cm4gISFjbGFpbXMgJiYgdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKTtcclxufTtcclxuLyoqXHJcbiAqIEF0dGVtcHRzIHRvIHBlZXIgaW50byBhbiBhdXRoIHRva2VuIGFuZCBkZXRlcm1pbmUgaWYgaXQncyBhbiBhZG1pbiBhdXRoIHRva2VuIGJ5IGxvb2tpbmcgYXQgdGhlIGNsYWltcyBwb3J0aW9uLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7P3N0cmluZ30gdG9rZW5cclxuICogQHJldHVybiB7Ym9vbGVhbn1cclxuICovXHJcbnZhciBpc0FkbWluID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICB2YXIgY2xhaW1zID0gZGVjb2RlKHRva2VuKS5jbGFpbXM7XHJcbiAgICByZXR1cm4gdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zWydhZG1pbiddID09PSB0cnVlO1xyXG59O1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gU2VlIGh0dHA6Ly93d3cuZGV2dGhvdWdodC5jb20vMjAxMi8wMS8xOC9hbi1vYmplY3QtaXMtbm90LWEtaGFzaC9cclxudmFyIGNvbnRhaW5zID0gZnVuY3Rpb24gKG9iaiwga2V5KSB7XHJcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcclxufTtcclxudmFyIHNhZmVHZXQgPSBmdW5jdGlvbiAob2JqLCBrZXkpIHtcclxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKVxyXG4gICAgICAgIHJldHVybiBvYmpba2V5XTtcclxuICAgIC8vIGVsc2UgcmV0dXJuIHVuZGVmaW5lZC5cclxufTtcclxuLyoqXHJcbiAqIEVudW1lcmF0ZXMgdGhlIGtleXMvdmFsdWVzIGluIGFuIG9iamVjdCwgZXhjbHVkaW5nIGtleXMgZGVmaW5lZCBvbiB0aGUgcHJvdG90eXBlLlxyXG4gKlxyXG4gKiBAcGFyYW0gez9PYmplY3QuPEssVj59IG9iaiBPYmplY3QgdG8gZW51bWVyYXRlLlxyXG4gKiBAcGFyYW0geyFmdW5jdGlvbihLLCBWKX0gZm4gRnVuY3Rpb24gdG8gY2FsbCBmb3IgZWFjaCBrZXkgYW5kIHZhbHVlLlxyXG4gKiBAdGVtcGxhdGUgSyxWXHJcbiAqL1xyXG52YXIgZm9yRWFjaCA9IGZ1bmN0aW9uIChvYmosIGZuKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcclxuICAgICAgICAgICAgZm4oa2V5LCBvYmpba2V5XSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogQ29waWVzIGFsbCB0aGUgKG93bikgcHJvcGVydGllcyBmcm9tIG9uZSBvYmplY3QgdG8gYW5vdGhlci5cclxuICogQHBhcmFtIHshT2JqZWN0fSBvYmpUb1xyXG4gKiBAcGFyYW0geyFPYmplY3R9IG9iakZyb21cclxuICogQHJldHVybiB7IU9iamVjdH0gb2JqVG9cclxuICovXHJcbnZhciBleHRlbmQgPSBmdW5jdGlvbiAob2JqVG8sIG9iakZyb20pIHtcclxuICAgIGZvckVhY2gob2JqRnJvbSwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICBvYmpUb1trZXldID0gdmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBvYmpUbztcclxufTtcclxuLyoqXHJcbiAqIFJldHVybnMgYSBjbG9uZSBvZiB0aGUgc3BlY2lmaWVkIG9iamVjdC5cclxuICogQHBhcmFtIHshT2JqZWN0fSBvYmpcclxuICogQHJldHVybiB7IU9iamVjdH0gY2xvbmVkIG9iai5cclxuICovXHJcbnZhciBjbG9uZSA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgIHJldHVybiBleHRlbmQoe30sIG9iaik7XHJcbn07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRydWUgaWYgb2JqIGhhcyB0eXBlb2YgXCJvYmplY3RcIiBhbmQgaXMgbm90IG51bGwuICBVbmxpa2UgZ29vZy5pc09iamVjdCgpLCBkb2VzIG5vdCByZXR1cm4gdHJ1ZVxyXG4gKiBmb3IgZnVuY3Rpb25zLlxyXG4gKlxyXG4gKiBAcGFyYW0gb2JqIHsqfSBBIHBvdGVudGlhbCBvYmplY3QuXHJcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGl0J3MgYW4gb2JqZWN0LlxyXG4gKi9cclxudmFyIGlzTm9uTnVsbE9iamVjdCA9IGZ1bmN0aW9uIChvYmopIHtcclxuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiBvYmogIT09IG51bGw7XHJcbn07XHJcbnZhciBpc0VtcHR5ID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59O1xyXG52YXIgZ2V0Q291bnQgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICB2YXIgcnYgPSAwO1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIHJ2Kys7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcnY7XHJcbn07XHJcbnZhciBtYXAgPSBmdW5jdGlvbiAob2JqLCBmLCBvcHRfb2JqKSB7XHJcbiAgICB2YXIgcmVzID0ge307XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgcmVzW2tleV0gPSBmLmNhbGwob3B0X29iaiwgb2JqW2tleV0sIGtleSwgb2JqKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn07XHJcbnZhciBmaW5kS2V5ID0gZnVuY3Rpb24gKG9iaiwgZm4sIG9wdF90aGlzKSB7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKGZuLmNhbGwob3B0X3RoaXMsIG9ialtrZXldLCBrZXksIG9iaikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGtleTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG59O1xyXG52YXIgZmluZFZhbHVlID0gZnVuY3Rpb24gKG9iaiwgZm4sIG9wdF90aGlzKSB7XHJcbiAgICB2YXIga2V5ID0gZmluZEtleShvYmosIGZuLCBvcHRfdGhpcyk7XHJcbiAgICByZXR1cm4ga2V5ICYmIG9ialtrZXldO1xyXG59O1xyXG52YXIgZ2V0QW55S2V5ID0gZnVuY3Rpb24gKG9iaikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIHJldHVybiBrZXk7XHJcbiAgICB9XHJcbn07XHJcbnZhciBnZXRWYWx1ZXMgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICB2YXIgcmVzID0gW107XHJcbiAgICB2YXIgaSA9IDA7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgcmVzW2krK10gPSBvYmpba2V5XTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn07XHJcbi8qKlxyXG4gKiBUZXN0cyB3aGV0aGVyIGV2ZXJ5IGtleS92YWx1ZSBwYWlyIGluIGFuIG9iamVjdCBwYXNzIHRoZSB0ZXN0IGltcGxlbWVudGVkXHJcbiAqIGJ5IHRoZSBwcm92aWRlZCBmdW5jdGlvblxyXG4gKlxyXG4gKiBAcGFyYW0gez9PYmplY3QuPEssVj59IG9iaiBPYmplY3QgdG8gdGVzdC5cclxuICogQHBhcmFtIHshZnVuY3Rpb24oSywgVil9IGZuIEZ1bmN0aW9uIHRvIGNhbGwgZm9yIGVhY2gga2V5IGFuZCB2YWx1ZS5cclxuICogQHRlbXBsYXRlIEssVlxyXG4gKi9cclxudmFyIGV2ZXJ5ID0gZnVuY3Rpb24gKG9iaiwgZm4pIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICBpZiAoIWZuKGtleSwgb2JqW2tleV0pKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgcXVlcnlzdHJpbmctZm9ybWF0dGVkIHN0cmluZyAoZS5nLiAmYXJnPXZhbCZhcmcyPXZhbDIpIGZyb20gYSBwYXJhbXNcclxuICogb2JqZWN0IChlLmcuIHthcmc6ICd2YWwnLCBhcmcyOiAndmFsMid9KVxyXG4gKiBOb3RlOiBZb3UgbXVzdCBwcmVwZW5kIGl0IHdpdGggPyB3aGVuIGFkZGluZyBpdCB0byBhIFVSTC5cclxuICpcclxuICogQHBhcmFtIHshT2JqZWN0fSBxdWVyeXN0cmluZ1BhcmFtc1xyXG4gKiBAcmV0dXJuIHtzdHJpbmd9XHJcbiAqL1xyXG52YXIgcXVlcnlzdHJpbmcgPSBmdW5jdGlvbiAocXVlcnlzdHJpbmdQYXJhbXMpIHtcclxuICAgIHZhciBwYXJhbXMgPSBbXTtcclxuICAgIGZvckVhY2gocXVlcnlzdHJpbmdQYXJhbXMsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goZnVuY3Rpb24gKGFycmF5VmFsKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChhcnJheVZhbCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmFtcy5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcGFyYW1zLmxlbmd0aCA/ICcmJyArIHBhcmFtcy5qb2luKCcmJykgOiAnJztcclxufTtcclxuLyoqXHJcbiAqIERlY29kZXMgYSBxdWVyeXN0cmluZyAoZS5nLiA/YXJnPXZhbCZhcmcyPXZhbDIpIGludG8gYSBwYXJhbXMgb2JqZWN0IChlLmcuIHthcmc6ICd2YWwnLCBhcmcyOiAndmFsMid9KVxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcXVlcnlzdHJpbmdcclxuICogQHJldHVybiB7IU9iamVjdH1cclxuICovXHJcbnZhciBxdWVyeXN0cmluZ0RlY29kZSA9IGZ1bmN0aW9uIChxdWVyeXN0cmluZykge1xyXG4gICAgdmFyIG9iaiA9IHt9O1xyXG4gICAgdmFyIHRva2VucyA9IHF1ZXJ5c3RyaW5nLnJlcGxhY2UoL15cXD8vLCAnJykuc3BsaXQoJyYnKTtcclxuICAgIHRva2Vucy5mb3JFYWNoKGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdG9rZW4uc3BsaXQoJz0nKTtcclxuICAgICAgICAgICAgb2JqW2tleVswXV0gPSBrZXlbMV07XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gb2JqO1xyXG59O1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gQ29weXJpZ2h0IDIwMTEgVGhlIENsb3N1cmUgTGlicmFyeSBBdXRob3JzLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4vL1xyXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4vL1xyXG4vLyAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4vL1xyXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMtSVNcIiBCQVNJUyxcclxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbi8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IEFic3RyYWN0IGNyeXB0b2dyYXBoaWMgaGFzaCBpbnRlcmZhY2UuXHJcbiAqXHJcbiAqIFNlZSBTaGExIGFuZCBNZDUgZm9yIHNhbXBsZSBpbXBsZW1lbnRhdGlvbnMuXHJcbiAqXHJcbiAqL1xyXG4vKipcclxuICogQ3JlYXRlIGEgY3J5cHRvZ3JhcGhpYyBoYXNoIGluc3RhbmNlLlxyXG4gKlxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQHN0cnVjdFxyXG4gKi9cclxudmFyIEhhc2ggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBIYXNoKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBibG9jayBzaXplIGZvciB0aGUgaGFzaGVyLlxyXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5ibG9ja1NpemUgPSAtMTtcclxuICAgIH1cclxuICAgIHJldHVybiBIYXNoO1xyXG59KCkpO1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoLlxyXG4gKiBWYXJpYWJsZSBuYW1lcyBmb2xsb3cgdGhlIG5vdGF0aW9uIGluIEZJUFMgUFVCIDE4MC0zOlxyXG4gKiBodHRwOi8vY3NyYy5uaXN0Lmdvdi9wdWJsaWNhdGlvbnMvZmlwcy9maXBzMTgwLTMvZmlwczE4MC0zX2ZpbmFsLnBkZi5cclxuICpcclxuICogVXNhZ2U6XHJcbiAqICAgdmFyIHNoYTEgPSBuZXcgc2hhMSgpO1xyXG4gKiAgIHNoYTEudXBkYXRlKGJ5dGVzKTtcclxuICogICB2YXIgaGFzaCA9IHNoYTEuZGlnZXN0KCk7XHJcbiAqXHJcbiAqIFBlcmZvcm1hbmNlOlxyXG4gKiAgIENocm9tZSAyMzogICB+NDAwIE1iaXQvc1xyXG4gKiAgIEZpcmVmb3ggMTY6ICB+MjUwIE1iaXQvc1xyXG4gKlxyXG4gKi9cclxuLyoqXHJcbiAqIFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaCBjb25zdHJ1Y3Rvci5cclxuICpcclxuICogVGhlIHByb3BlcnRpZXMgZGVjbGFyZWQgaGVyZSBhcmUgZGlzY3Vzc2VkIGluIHRoZSBhYm92ZSBhbGdvcml0aG0gZG9jdW1lbnQuXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZXh0ZW5kcyB7SGFzaH1cclxuICogQGZpbmFsXHJcbiAqIEBzdHJ1Y3RcclxuICovXHJcbnZhciBTaGExID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU2hhMSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFNoYTEoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBIb2xkcyB0aGUgcHJldmlvdXMgdmFsdWVzIG9mIGFjY3VtdWxhdGVkIHZhcmlhYmxlcyBhLWUgaW4gdGhlIGNvbXByZXNzX1xyXG4gICAgICAgICAqIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLmNoYWluXyA9IFtdO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgYnVmZmVyIGhvbGRpbmcgdGhlIHBhcnRpYWxseSBjb21wdXRlZCBoYXNoIHJlc3VsdC5cclxuICAgICAgICAgKiBAdHlwZSB7IUFycmF5PG51bWJlcj59XHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy5idWZfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQW4gYXJyYXkgb2YgODAgYnl0ZXMsIGVhY2ggYSBwYXJ0IG9mIHRoZSBtZXNzYWdlIHRvIGJlIGhhc2hlZC4gIFJlZmVycmVkIHRvXHJcbiAgICAgICAgICogYXMgdGhlIG1lc3NhZ2Ugc2NoZWR1bGUgaW4gdGhlIGRvY3MuXHJcbiAgICAgICAgICogQHR5cGUgeyFBcnJheTxudW1iZXI+fVxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgX3RoaXMuV18gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb250YWlucyBkYXRhIG5lZWRlZCB0byBwYWQgbWVzc2FnZXMgbGVzcyB0aGFuIDY0IGJ5dGVzLlxyXG4gICAgICAgICAqIEB0eXBlIHshQXJyYXk8bnVtYmVyPn1cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLnBhZF8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIF90aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBfdGhpcy50b3RhbF8gPSAwO1xyXG4gICAgICAgIF90aGlzLmJsb2NrU2l6ZSA9IDUxMiAvIDg7XHJcbiAgICAgICAgX3RoaXMucGFkX1swXSA9IDEyODtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IF90aGlzLmJsb2NrU2l6ZTsgKytpKSB7XHJcbiAgICAgICAgICAgIF90aGlzLnBhZF9baV0gPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFNoYTEucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzBdID0gMHg2NzQ1MjMwMTtcclxuICAgICAgICB0aGlzLmNoYWluX1sxXSA9IDB4ZWZjZGFiODk7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMl0gPSAweDk4YmFkY2ZlO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzNdID0gMHgxMDMyNTQ3NjtcclxuICAgICAgICB0aGlzLmNoYWluX1s0XSA9IDB4YzNkMmUxZjA7XHJcbiAgICAgICAgdGhpcy5pbmJ1Zl8gPSAwO1xyXG4gICAgICAgIHRoaXMudG90YWxfID0gMDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEludGVybmFsIGNvbXByZXNzIGhlbHBlciBmdW5jdGlvbi5cclxuICAgICAqIEBwYXJhbSB7IUFycmF5PG51bWJlcj58IVVpbnQ4QXJyYXl8c3RyaW5nfSBidWYgQmxvY2sgdG8gY29tcHJlc3MuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcj19IG9wdF9vZmZzZXQgT2Zmc2V0IG9mIHRoZSBibG9jayBpbiB0aGUgYnVmZmVyLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgU2hhMS5wcm90b3R5cGUuY29tcHJlc3NfID0gZnVuY3Rpb24gKGJ1Ziwgb3B0X29mZnNldCkge1xyXG4gICAgICAgIGlmICghb3B0X29mZnNldCkge1xyXG4gICAgICAgICAgICBvcHRfb2Zmc2V0ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIFcgPSB0aGlzLldfO1xyXG4gICAgICAgIC8vIGdldCAxNiBiaWcgZW5kaWFuIHdvcmRzXHJcbiAgICAgICAgaWYgKHR5cGVvZiBidWYgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyh1c2VyKTogW2J1ZyA4MTQwMTIyXSBSZWNlbnQgdmVyc2lvbnMgb2YgU2FmYXJpIGZvciBNYWMgT1MgYW5kIGlPU1xyXG4gICAgICAgICAgICAgICAgLy8gaGF2ZSBhIGJ1ZyB0aGF0IHR1cm5zIHRoZSBwb3N0LWluY3JlbWVudCArKyBvcGVyYXRvciBpbnRvIHByZS1pbmNyZW1lbnRcclxuICAgICAgICAgICAgICAgIC8vIGR1cmluZyBKSVQgY29tcGlsYXRpb24uICBXZSBoYXZlIGNvZGUgdGhhdCBkZXBlbmRzIGhlYXZpbHkgb24gU0hBLTEgZm9yXHJcbiAgICAgICAgICAgICAgICAvLyBjb3JyZWN0bmVzcyBhbmQgd2hpY2ggaXMgYWZmZWN0ZWQgYnkgdGhpcyBidWcsIHNvIEkndmUgcmVtb3ZlZCBhbGwgdXNlc1xyXG4gICAgICAgICAgICAgICAgLy8gb2YgcG9zdC1pbmNyZW1lbnQgKysgaW4gd2hpY2ggdGhlIHJlc3VsdCB2YWx1ZSBpcyB1c2VkLiAgV2UgY2FuIHJldmVydFxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBjaGFuZ2Ugb25jZSB0aGUgU2FmYXJpIGJ1Z1xyXG4gICAgICAgICAgICAgICAgLy8gKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDkwMzYpIGhhcyBiZWVuIGZpeGVkIGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gbW9zdCBjbGllbnRzIGhhdmUgYmVlbiB1cGRhdGVkLlxyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQpIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvcHRfb2Zmc2V0ICsgMSkgPDwgMTYpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQgKyAyKSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5jaGFyQ29kZUF0KG9wdF9vZmZzZXQgKyAzKTtcclxuICAgICAgICAgICAgICAgIG9wdF9vZmZzZXQgKz0gNDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBXW2ldID1cclxuICAgICAgICAgICAgICAgICAgICAoYnVmW29wdF9vZmZzZXRdIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb3B0X29mZnNldCArIDFdIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb3B0X29mZnNldCArIDJdIDw8IDgpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVmW29wdF9vZmZzZXQgKyAzXTtcclxuICAgICAgICAgICAgICAgIG9wdF9vZmZzZXQgKz0gNDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBleHBhbmQgdG8gODAgd29yZHNcclxuICAgICAgICBmb3IgKHZhciBpID0gMTY7IGkgPCA4MDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gV1tpIC0gM10gXiBXW2kgLSA4XSBeIFdbaSAtIDE0XSBeIFdbaSAtIDE2XTtcclxuICAgICAgICAgICAgV1tpXSA9ICgodCA8PCAxKSB8ICh0ID4+PiAzMSkpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGEgPSB0aGlzLmNoYWluX1swXTtcclxuICAgICAgICB2YXIgYiA9IHRoaXMuY2hhaW5fWzFdO1xyXG4gICAgICAgIHZhciBjID0gdGhpcy5jaGFpbl9bMl07XHJcbiAgICAgICAgdmFyIGQgPSB0aGlzLmNoYWluX1szXTtcclxuICAgICAgICB2YXIgZSA9IHRoaXMuY2hhaW5fWzRdO1xyXG4gICAgICAgIHZhciBmLCBrO1xyXG4gICAgICAgIC8vIFRPRE8odXNlcik6IFRyeSB0byB1bnJvbGwgdGhpcyBsb29wIHRvIHNwZWVkIHVwIHRoZSBjb21wdXRhdGlvbi5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDgwOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGkgPCA0MCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPCAyMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSBkIF4gKGIgJiAoYyBeIGQpKTtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg1YTgyNzk5OTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGYgPSBiIF4gYyBeIGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4NmVkOWViYTE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDYwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IChiICYgYykgfCAoZCAmIChiIHwgYykpO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDhmMWJiY2RjO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGIgXiBjIF4gZDtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHhjYTYyYzFkNjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdCA9ICgoKGEgPDwgNSkgfCAoYSA+Pj4gMjcpKSArIGYgKyBlICsgayArIFdbaV0pICYgMHhmZmZmZmZmZjtcclxuICAgICAgICAgICAgZSA9IGQ7XHJcbiAgICAgICAgICAgIGQgPSBjO1xyXG4gICAgICAgICAgICBjID0gKChiIDw8IDMwKSB8IChiID4+PiAyKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgICAgICBiID0gYTtcclxuICAgICAgICAgICAgYSA9IHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2hhaW5fWzBdID0gKHRoaXMuY2hhaW5fWzBdICsgYSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gKHRoaXMuY2hhaW5fWzFdICsgYikgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzJdID0gKHRoaXMuY2hhaW5fWzJdICsgYykgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzNdID0gKHRoaXMuY2hhaW5fWzNdICsgZCkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gKHRoaXMuY2hhaW5fWzRdICsgZSkgJiAweGZmZmZmZmZmO1xyXG4gICAgfTtcclxuICAgIFNoYTEucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChieXRlcywgb3B0X2xlbmd0aCkge1xyXG4gICAgICAgIC8vIFRPRE8oam9obmxlbnopOiB0aWdodGVuIHRoZSBmdW5jdGlvbiBzaWduYXR1cmUgYW5kIHJlbW92ZSB0aGlzIGNoZWNrXHJcbiAgICAgICAgaWYgKGJ5dGVzID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob3B0X2xlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9wdF9sZW5ndGggPSBieXRlcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsZW5ndGhNaW51c0Jsb2NrID0gb3B0X2xlbmd0aCAtIHRoaXMuYmxvY2tTaXplO1xyXG4gICAgICAgIHZhciBuID0gMDtcclxuICAgICAgICAvLyBVc2luZyBsb2NhbCBpbnN0ZWFkIG9mIG1lbWJlciB2YXJpYWJsZXMgZ2l2ZXMgfjUlIHNwZWVkdXAgb24gRmlyZWZveCAxNi5cclxuICAgICAgICB2YXIgYnVmID0gdGhpcy5idWZfO1xyXG4gICAgICAgIHZhciBpbmJ1ZiA9IHRoaXMuaW5idWZfO1xyXG4gICAgICAgIC8vIFRoZSBvdXRlciB3aGlsZSBsb29wIHNob3VsZCBleGVjdXRlIGF0IG1vc3QgdHdpY2UuXHJcbiAgICAgICAgd2hpbGUgKG4gPCBvcHRfbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgaGF2ZSBubyBkYXRhIGluIHRoZSBibG9jayB0byB0b3AgdXAsIHdlIGNhbiBkaXJlY3RseSBwcm9jZXNzIHRoZVxyXG4gICAgICAgICAgICAvLyBpbnB1dCBidWZmZXIgKGFzc3VtaW5nIGl0IGNvbnRhaW5zIHN1ZmZpY2llbnQgZGF0YSkuIFRoaXMgZ2l2ZXMgfjI1JVxyXG4gICAgICAgICAgICAvLyBzcGVlZHVwIG9uIENocm9tZSAyMyBhbmQgfjE1JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYsIGJ1dCByZXF1aXJlcyB0aGF0XHJcbiAgICAgICAgICAgIC8vIHRoZSBkYXRhIGlzIHByb3ZpZGVkIGluIGxhcmdlIGNodW5rcyAob3IgaW4gbXVsdGlwbGVzIG9mIDY0IGJ5dGVzKS5cclxuICAgICAgICAgICAgaWYgKGluYnVmID09IDApIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDw9IGxlbmd0aE1pbnVzQmxvY2spIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhieXRlcywgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgbiArPSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPCBvcHRfbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzLmNoYXJDb2RlQXQobik7XHJcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcclxuICAgICAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09IHRoaXMuYmxvY2tTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IG9wdF9sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXNbbl07XHJcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcclxuICAgICAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09IHRoaXMuYmxvY2tTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbmJ1Zl8gPSBpbmJ1ZjtcclxuICAgICAgICB0aGlzLnRvdGFsXyArPSBvcHRfbGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIC8qKiBAb3ZlcnJpZGUgKi9cclxuICAgIFNoYTEucHJvdG90eXBlLmRpZ2VzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZGlnZXN0ID0gW107XHJcbiAgICAgICAgdmFyIHRvdGFsQml0cyA9IHRoaXMudG90YWxfICogODtcclxuICAgICAgICAvLyBBZGQgcGFkIDB4ODAgMHgwMCouXHJcbiAgICAgICAgaWYgKHRoaXMuaW5idWZfIDwgNTYpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCA1NiAtIHRoaXMuaW5idWZfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgdGhpcy5ibG9ja1NpemUgLSAodGhpcy5pbmJ1Zl8gLSA1NikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBZGQgIyBiaXRzLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLmJsb2NrU2l6ZSAtIDE7IGkgPj0gNTY7IGktLSkge1xyXG4gICAgICAgICAgICB0aGlzLmJ1Zl9baV0gPSB0b3RhbEJpdHMgJiAyNTU7XHJcbiAgICAgICAgICAgIHRvdGFsQml0cyAvPSAyNTY7IC8vIERvbid0IHVzZSBiaXQtc2hpZnRpbmcgaGVyZSFcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wcmVzc18odGhpcy5idWZfKTtcclxuICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDI0OyBqID49IDA7IGogLT0gOCkge1xyXG4gICAgICAgICAgICAgICAgZGlnZXN0W25dID0gKHRoaXMuY2hhaW5fW2ldID4+IGopICYgMjU1O1xyXG4gICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkaWdlc3Q7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNoYTE7XHJcbn0oSGFzaCkpO1xuXG4vKipcclxuICogSGVscGVyIHRvIG1ha2UgYSBTdWJzY3JpYmUgZnVuY3Rpb24gKGp1c3QgbGlrZSBQcm9taXNlIGhlbHBzIG1ha2UgYVxyXG4gKiBUaGVuYWJsZSkuXHJcbiAqXHJcbiAqIEBwYXJhbSBleGVjdXRvciBGdW5jdGlvbiB3aGljaCBjYW4gbWFrZSBjYWxscyB0byBhIHNpbmdsZSBPYnNlcnZlclxyXG4gKiAgICAgYXMgYSBwcm94eS5cclxuICogQHBhcmFtIG9uTm9PYnNlcnZlcnMgQ2FsbGJhY2sgd2hlbiBjb3VudCBvZiBPYnNlcnZlcnMgZ29lcyB0byB6ZXJvLlxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlU3Vic2NyaWJlKGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKSB7XHJcbiAgICB2YXIgcHJveHkgPSBuZXcgT2JzZXJ2ZXJQcm94eShleGVjdXRvciwgb25Ob09ic2VydmVycyk7XHJcbiAgICByZXR1cm4gcHJveHkuc3Vic2NyaWJlLmJpbmQocHJveHkpO1xyXG59XHJcbi8qKlxyXG4gKiBJbXBsZW1lbnQgZmFuLW91dCBmb3IgYW55IG51bWJlciBvZiBPYnNlcnZlcnMgYXR0YWNoZWQgdmlhIGEgc3Vic2NyaWJlXHJcbiAqIGZ1bmN0aW9uLlxyXG4gKi9cclxudmFyIE9ic2VydmVyUHJveHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBleGVjdXRvciBGdW5jdGlvbiB3aGljaCBjYW4gbWFrZSBjYWxscyB0byBhIHNpbmdsZSBPYnNlcnZlclxyXG4gICAgICogICAgIGFzIGEgcHJveHkuXHJcbiAgICAgKiBAcGFyYW0gb25Ob09ic2VydmVycyBDYWxsYmFjayB3aGVuIGNvdW50IG9mIE9ic2VydmVycyBnb2VzIHRvIHplcm8uXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIE9ic2VydmVyUHJveHkoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XHJcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZXMgPSBbXTtcclxuICAgICAgICB0aGlzLm9ic2VydmVyQ291bnQgPSAwO1xyXG4gICAgICAgIC8vIE1pY3JvLXRhc2sgc2NoZWR1bGluZyBieSBjYWxsaW5nIHRhc2sudGhlbigpLlxyXG4gICAgICAgIHRoaXMudGFzayA9IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIHRoaXMuZmluYWxpemVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzID0gb25Ob09ic2VydmVycztcclxuICAgICAgICAvLyBDYWxsIHRoZSBleGVjdXRvciBhc3luY2hyb25vdXNseSBzbyBzdWJzY3JpYmVycyB0aGF0IGFyZSBjYWxsZWRcclxuICAgICAgICAvLyBzeW5jaHJvbm91c2x5IGFmdGVyIHRoZSBjcmVhdGlvbiBvZiB0aGUgc3Vic2NyaWJlIGZ1bmN0aW9uXHJcbiAgICAgICAgLy8gY2FuIHN0aWxsIHJlY2VpdmUgdGhlIHZlcnkgZmlyc3QgdmFsdWUgZ2VuZXJhdGVkIGluIHRoZSBleGVjdXRvci5cclxuICAgICAgICB0aGlzLnRhc2tcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBleGVjdXRvcihfdGhpcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmVycm9yKGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KHZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZShlcnJvcik7XHJcbiAgICB9O1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogU3Vic2NyaWJlIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gYWRkIGFuIE9ic2VydmVyIHRvIHRoZSBmYW4tb3V0IGxpc3QuXHJcbiAgICAgKlxyXG4gICAgICogLSBXZSByZXF1aXJlIHRoYXQgbm8gZXZlbnQgaXMgc2VudCB0byBhIHN1YnNjcmliZXIgc3ljaHJvbm91c2x5IHRvIHRoZWlyXHJcbiAgICAgKiAgIGNhbGwgdG8gc3Vic2NyaWJlKCkuXHJcbiAgICAgKi9cclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgb2JzZXJ2ZXI7XHJcbiAgICAgICAgaWYgKG5leHRPck9ic2VydmVyID09PSB1bmRlZmluZWQgJiZcclxuICAgICAgICAgICAgZXJyb3IgPT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICBjb21wbGV0ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBPYnNlcnZlci4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQXNzZW1ibGUgYW4gT2JzZXJ2ZXIgb2JqZWN0IHdoZW4gcGFzc2VkIGFzIGNhbGxiYWNrIGZ1bmN0aW9ucy5cclxuICAgICAgICBpZiAoaW1wbGVtZW50c0FueU1ldGhvZHMobmV4dE9yT2JzZXJ2ZXIsIFsnbmV4dCcsICdlcnJvcicsICdjb21wbGV0ZSddKSkge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IG5leHRPck9ic2VydmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcclxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBjb21wbGV0ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQgPSBub29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvciA9IG5vb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvYnNlcnZlci5jb21wbGV0ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlID0gbm9vcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHVuc3ViID0gdGhpcy51bnN1YnNjcmliZU9uZS5iaW5kKHRoaXMsIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCk7XHJcbiAgICAgICAgLy8gQXR0ZW1wdCB0byBzdWJzY3JpYmUgdG8gYSB0ZXJtaW5hdGVkIE9ic2VydmFibGUgLSB3ZVxyXG4gICAgICAgIC8vIGp1c3QgcmVzcG9uZCB0byB0aGUgT2JzZXJ2ZXIgd2l0aCB0aGUgZmluYWwgZXJyb3Igb3IgY29tcGxldGVcclxuICAgICAgICAvLyBldmVudC5cclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgdGhpcy50YXNrLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuZmluYWxFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihfdGhpcy5maW5hbEVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG9ic2VydmVyKTtcclxuICAgICAgICByZXR1cm4gdW5zdWI7XHJcbiAgICB9O1xyXG4gICAgLy8gVW5zdWJzY3JpYmUgaXMgc3luY2hyb25vdXMgLSB3ZSBndWFyYW50ZWUgdGhhdCBubyBldmVudHMgYXJlIHNlbnQgdG9cclxuICAgIC8vIGFueSB1bnN1YnNjcmliZWQgT2JzZXJ2ZXIuXHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS51bnN1YnNjcmliZU9uZSA9IGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub2JzZXJ2ZXJzID09PSB1bmRlZmluZWQgfHwgdGhpcy5vYnNlcnZlcnNbaV0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlbGV0ZSB0aGlzLm9ic2VydmVyc1tpXTtcclxuICAgICAgICB0aGlzLm9ic2VydmVyQ291bnQgLT0gMTtcclxuICAgICAgICBpZiAodGhpcy5vYnNlcnZlckNvdW50ID09PSAwICYmIHRoaXMub25Ob09ic2VydmVycyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25Ob09ic2VydmVycyh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuZm9yRWFjaE9ic2VydmVyID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmluYWxpemVkKSB7XHJcbiAgICAgICAgICAgIC8vIEFscmVhZHkgY2xvc2VkIGJ5IHByZXZpb3VzIGV2ZW50Li4uLmp1c3QgZWF0IHRoZSBhZGRpdGlvbmFsIHZhbHVlcy5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTaW5jZSBzZW5kT25lIGNhbGxzIGFzeW5jaHJvbm91c2x5IC0gdGhlcmUgaXMgbm8gY2hhbmNlIHRoYXRcclxuICAgICAgICAvLyB0aGlzLm9ic2VydmVycyB3aWxsIGJlY29tZSB1bmRlZmluZWQuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm9ic2VydmVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLnNlbmRPbmUoaSwgZm4pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyBDYWxsIHRoZSBPYnNlcnZlciB2aWEgb25lIG9mIGl0J3MgY2FsbGJhY2sgZnVuY3Rpb24uIFdlIGFyZSBjYXJlZnVsIHRvXHJcbiAgICAvLyBjb25maXJtIHRoYXQgdGhlIG9ic2VydmUgaGFzIG5vdCBiZWVuIHVuc3Vic2NyaWJlZCBzaW5jZSB0aGlzIGFzeW5jaHJvbm91c1xyXG4gICAgLy8gZnVuY3Rpb24gaGFkIGJlZW4gcXVldWVkLlxyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuc2VuZE9uZSA9IGZ1bmN0aW9uIChpLCBmbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gRXhlY3V0ZSB0aGUgY2FsbGJhY2sgYXN5bmNocm9ub3VzbHlcclxuICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5vYnNlcnZlcnMgIT09IHVuZGVmaW5lZCAmJiBfdGhpcy5vYnNlcnZlcnNbaV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBmbihfdGhpcy5vYnNlcnZlcnNbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZXhjZXB0aW9ucyByYWlzZWQgaW4gT2JzZXJ2ZXJzIG9yIG1pc3NpbmcgbWV0aG9kcyBvZiBhblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE9ic2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIExvZyBlcnJvciB0byBjb25zb2xlLiBiLzMxNDA0ODA2XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmZpbmFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKGVyciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmluYWxFcnJvciA9IGVycjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gUHJveHkgaXMgbm8gbG9uZ2VyIG5lZWRlZCAtIGdhcmJhZ2UgY29sbGVjdCByZWZlcmVuY2VzXHJcbiAgICAgICAgdGhpcy50YXNrLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBfdGhpcy5vYnNlcnZlcnMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIF90aGlzLm9uTm9PYnNlcnZlcnMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE9ic2VydmVyUHJveHk7XHJcbn0oKSk7XHJcbi8qKiBUdXJuIHN5bmNocm9ub3VzIGZ1bmN0aW9uIGludG8gb25lIGNhbGxlZCBhc3luY2hyb25vdXNseS4gKi9cclxuZnVuY3Rpb24gYXN5bmMoZm4sIG9uRXJyb3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSh0cnVlKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGZuLmFwcGx5KHZvaWQgMCwgYXJncyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xyXG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBvYmplY3QgcGFzc2VkIGluIGltcGxlbWVudHMgYW55IG9mIHRoZSBuYW1lZCBtZXRob2RzLlxyXG4gKi9cclxuZnVuY3Rpb24gaW1wbGVtZW50c0FueU1ldGhvZHMob2JqLCBtZXRob2RzKSB7XHJcbiAgICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcgfHwgb2JqID09PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBtZXRob2RzXzEgPSBtZXRob2RzOyBfaSA8IG1ldGhvZHNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgbWV0aG9kID0gbWV0aG9kc18xW19pXTtcclxuICAgICAgICBpZiAobWV0aG9kIGluIG9iaiAmJiB0eXBlb2Ygb2JqW21ldGhvZF0gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcbmZ1bmN0aW9uIG5vb3AoKSB7XHJcbiAgICAvLyBkbyBub3RoaW5nXHJcbn1cblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBDaGVjayB0byBtYWtlIHN1cmUgdGhlIGFwcHJvcHJpYXRlIG51bWJlciBvZiBhcmd1bWVudHMgYXJlIHByb3ZpZGVkIGZvciBhIHB1YmxpYyBmdW5jdGlvbi5cclxuICogVGhyb3dzIGFuIGVycm9yIGlmIGl0IGZhaWxzLlxyXG4gKlxyXG4gKiBAcGFyYW0geyFzdHJpbmd9IGZuTmFtZSBUaGUgZnVuY3Rpb24gbmFtZVxyXG4gKiBAcGFyYW0geyFudW1iZXJ9IG1pbkNvdW50IFRoZSBtaW5pbXVtIG51bWJlciBvZiBhcmd1bWVudHMgdG8gYWxsb3cgZm9yIHRoZSBmdW5jdGlvbiBjYWxsXHJcbiAqIEBwYXJhbSB7IW51bWJlcn0gbWF4Q291bnQgVGhlIG1heGltdW0gbnVtYmVyIG9mIGFyZ3VtZW50IHRvIGFsbG93IGZvciB0aGUgZnVuY3Rpb24gY2FsbFxyXG4gKiBAcGFyYW0geyFudW1iZXJ9IGFyZ0NvdW50IFRoZSBhY3R1YWwgbnVtYmVyIG9mIGFyZ3VtZW50cyBwcm92aWRlZC5cclxuICovXHJcbnZhciB2YWxpZGF0ZUFyZ0NvdW50ID0gZnVuY3Rpb24gKGZuTmFtZSwgbWluQ291bnQsIG1heENvdW50LCBhcmdDb3VudCkge1xyXG4gICAgdmFyIGFyZ0Vycm9yO1xyXG4gICAgaWYgKGFyZ0NvdW50IDwgbWluQ291bnQpIHtcclxuICAgICAgICBhcmdFcnJvciA9ICdhdCBsZWFzdCAnICsgbWluQ291bnQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChhcmdDb3VudCA+IG1heENvdW50KSB7XHJcbiAgICAgICAgYXJnRXJyb3IgPSBtYXhDb3VudCA9PT0gMCA/ICdub25lJyA6ICdubyBtb3JlIHRoYW4gJyArIG1heENvdW50O1xyXG4gICAgfVxyXG4gICAgaWYgKGFyZ0Vycm9yKSB7XHJcbiAgICAgICAgdmFyIGVycm9yID0gZm5OYW1lICtcclxuICAgICAgICAgICAgJyBmYWlsZWQ6IFdhcyBjYWxsZWQgd2l0aCAnICtcclxuICAgICAgICAgICAgYXJnQ291bnQgK1xyXG4gICAgICAgICAgICAoYXJnQ291bnQgPT09IDEgPyAnIGFyZ3VtZW50LicgOiAnIGFyZ3VtZW50cy4nKSArXHJcbiAgICAgICAgICAgICcgRXhwZWN0cyAnICtcclxuICAgICAgICAgICAgYXJnRXJyb3IgK1xyXG4gICAgICAgICAgICAnLic7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIEdlbmVyYXRlcyBhIHN0cmluZyB0byBwcmVmaXggYW4gZXJyb3IgbWVzc2FnZSBhYm91dCBmYWlsZWQgYXJndW1lbnQgdmFsaWRhdGlvblxyXG4gKlxyXG4gKiBAcGFyYW0geyFzdHJpbmd9IGZuTmFtZSBUaGUgZnVuY3Rpb24gbmFtZVxyXG4gKiBAcGFyYW0geyFudW1iZXJ9IGFyZ3VtZW50TnVtYmVyIFRoZSBpbmRleCBvZiB0aGUgYXJndW1lbnRcclxuICogQHBhcmFtIHtib29sZWFufSBvcHRpb25hbCBXaGV0aGVyIG9yIG5vdCB0aGUgYXJndW1lbnQgaXMgb3B0aW9uYWxcclxuICogQHJldHVybiB7IXN0cmluZ30gVGhlIHByZWZpeCB0byBhZGQgdG8gdGhlIGVycm9yIHRocm93biBmb3IgdmFsaWRhdGlvbi5cclxuICovXHJcbmZ1bmN0aW9uIGVycm9yUHJlZml4KGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG9wdGlvbmFsKSB7XHJcbiAgICB2YXIgYXJnTmFtZSA9ICcnO1xyXG4gICAgc3dpdGNoIChhcmd1bWVudE51bWJlcikge1xyXG4gICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgYXJnTmFtZSA9IG9wdGlvbmFsID8gJ2ZpcnN0JyA6ICdGaXJzdCc7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgYXJnTmFtZSA9IG9wdGlvbmFsID8gJ3NlY29uZCcgOiAnU2Vjb25kJztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICBhcmdOYW1lID0gb3B0aW9uYWwgPyAndGhpcmQnIDogJ1RoaXJkJztcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICBhcmdOYW1lID0gb3B0aW9uYWwgPyAnZm91cnRoJyA6ICdGb3VydGgnO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Vycm9yUHJlZml4IGNhbGxlZCB3aXRoIGFyZ3VtZW50TnVtYmVyID4gNC4gIE5lZWQgdG8gdXBkYXRlIGl0PycpO1xyXG4gICAgfVxyXG4gICAgdmFyIGVycm9yID0gZm5OYW1lICsgJyBmYWlsZWQ6ICc7XHJcbiAgICBlcnJvciArPSBhcmdOYW1lICsgJyBhcmd1bWVudCAnO1xyXG4gICAgcmV0dXJuIGVycm9yO1xyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0geyFzdHJpbmd9IGZuTmFtZVxyXG4gKiBAcGFyYW0geyFudW1iZXJ9IGFyZ3VtZW50TnVtYmVyXHJcbiAqIEBwYXJhbSB7IXN0cmluZ30gbmFtZXNwYWNlXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9uYWxcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTmFtZXNwYWNlKGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIG5hbWVzcGFjZSwgb3B0aW9uYWwpIHtcclxuICAgIGlmIChvcHRpb25hbCAmJiAhbmFtZXNwYWNlKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmICh0eXBlb2YgbmFtZXNwYWNlICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgIC8vVE9ETzogSSBzaG91bGQgZG8gbW9yZSB2YWxpZGF0aW9uIGhlcmUuIFdlIG9ubHkgYWxsb3cgY2VydGFpbiBjaGFycyBpbiBuYW1lc3BhY2VzLlxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgK1xyXG4gICAgICAgICAgICAnbXVzdCBiZSBhIHZhbGlkIGZpcmViYXNlIG5hbWVzcGFjZS4nKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUNhbGxiYWNrKGZuTmFtZSwgYXJndW1lbnROdW1iZXIsIGNhbGxiYWNrLCBvcHRpb25hbCkge1xyXG4gICAgaWYgKG9wdGlvbmFsICYmICFjYWxsYmFjaylcclxuICAgICAgICByZXR1cm47XHJcbiAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBvcHRpb25hbCkgK1xyXG4gICAgICAgICAgICAnbXVzdCBiZSBhIHZhbGlkIGZ1bmN0aW9uLicpO1xyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlQ29udGV4dE9iamVjdChmbk5hbWUsIGFyZ3VtZW50TnVtYmVyLCBjb250ZXh0LCBvcHRpb25hbCkge1xyXG4gICAgaWYgKG9wdGlvbmFsICYmICFjb250ZXh0KVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmICh0eXBlb2YgY29udGV4dCAhPT0gJ29iamVjdCcgfHwgY29udGV4dCA9PT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE51bWJlciwgb3B0aW9uYWwpICtcclxuICAgICAgICAgICAgJ211c3QgYmUgYSB2YWxpZCBjb250ZXh0IG9iamVjdC4nKTtcclxufVxuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gQ29kZSBvcmlnaW5hbGx5IGNhbWUgZnJvbSBnb29nLmNyeXB0LnN0cmluZ1RvVXRmOEJ5dGVBcnJheSwgYnV0IGZvciBzb21lIHJlYXNvbiB0aGV5XHJcbi8vIGF1dG9tYXRpY2FsbHkgcmVwbGFjZWQgJ1xcclxcbicgd2l0aCAnXFxuJywgYW5kIHRoZXkgZGlkbid0IGhhbmRsZSBzdXJyb2dhdGUgcGFpcnMsXHJcbi8vIHNvIGl0J3MgYmVlbiBtb2RpZmllZC5cclxuLy8gTm90ZSB0aGF0IG5vdCBhbGwgVW5pY29kZSBjaGFyYWN0ZXJzIGFwcGVhciBhcyBzaW5nbGUgY2hhcmFjdGVycyBpbiBKYXZhU2NyaXB0IHN0cmluZ3MuXHJcbi8vIGZyb21DaGFyQ29kZSByZXR1cm5zIHRoZSBVVEYtMTYgZW5jb2Rpbmcgb2YgYSBjaGFyYWN0ZXIgLSBzbyBzb21lIFVuaWNvZGUgY2hhcmFjdGVyc1xyXG4vLyB1c2UgMiBjaGFyYWN0ZXJzIGluIEphdmFzY3JpcHQuICBBbGwgNC1ieXRlIFVURi04IGNoYXJhY3RlcnMgYmVnaW4gd2l0aCBhIGZpcnN0XHJcbi8vIGNoYXJhY3RlciBpbiB0aGUgcmFuZ2UgMHhEODAwIC0gMHhEQkZGICh0aGUgZmlyc3QgY2hhcmFjdGVyIG9mIGEgc28tY2FsbGVkIHN1cnJvZ2F0ZVxyXG4vLyBwYWlyKS5cclxuLy8gU2VlIGh0dHA6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi81LjEvI3NlYy0xNS4xLjNcclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcclxuICogQHJldHVybiB7QXJyYXl9XHJcbiAqL1xyXG52YXIgc3RyaW5nVG9CeXRlQXJyYXkkMSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHZhciBvdXQgPSBbXSwgcCA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIHZhciBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgLy8gSXMgdGhpcyB0aGUgbGVhZCBzdXJyb2dhdGUgaW4gYSBzdXJyb2dhdGUgcGFpcj9cclxuICAgICAgICBpZiAoYyA+PSAweGQ4MDAgJiYgYyA8PSAweGRiZmYpIHtcclxuICAgICAgICAgICAgdmFyIGhpZ2ggPSBjIC0gMHhkODAwOyAvLyB0aGUgaGlnaCAxMCBiaXRzLlxyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIGFzc2VydChpIDwgc3RyLmxlbmd0aCwgJ1N1cnJvZ2F0ZSBwYWlyIG1pc3NpbmcgdHJhaWwgc3Vycm9nYXRlLicpO1xyXG4gICAgICAgICAgICB2YXIgbG93ID0gc3RyLmNoYXJDb2RlQXQoaSkgLSAweGRjMDA7IC8vIHRoZSBsb3cgMTAgYml0cy5cclxuICAgICAgICAgICAgYyA9IDB4MTAwMDAgKyAoaGlnaCA8PCAxMCkgKyBsb3c7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gYztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiA2KSB8IDE5MjtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDY1NTM2KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTIpIHwgMjI0O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTgpIHwgMjQwO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiAxMikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvdXQ7XHJcbn07XHJcbi8qKlxyXG4gKiBDYWxjdWxhdGUgbGVuZ3RoIHdpdGhvdXQgYWN0dWFsbHkgY29udmVydGluZzsgdXNlZnVsIGZvciBkb2luZyBjaGVhcGVyIHZhbGlkYXRpb24uXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcclxuICogQHJldHVybiB7bnVtYmVyfVxyXG4gKi9cclxudmFyIHN0cmluZ0xlbmd0aCA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHZhciBwID0gMDtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICBpZiAoYyA8IDEyOCkge1xyXG4gICAgICAgICAgICBwKys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XHJcbiAgICAgICAgICAgIHAgKz0gMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA+PSAweGQ4MDAgJiYgYyA8PSAweGRiZmYpIHtcclxuICAgICAgICAgICAgLy8gTGVhZCBzdXJyb2dhdGUgb2YgYSBzdXJyb2dhdGUgcGFpci4gIFRoZSBwYWlyIHRvZ2V0aGVyIHdpbGwgdGFrZSA0IGJ5dGVzIHRvIHJlcHJlc2VudC5cclxuICAgICAgICAgICAgcCArPSA0O1xyXG4gICAgICAgICAgICBpKys7IC8vIHNraXAgdHJhaWwgc3Vycm9nYXRlLlxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcCArPSAzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBwO1xyXG59O1xuXG4vKipcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIEluYy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxuZXhwb3J0cy5hc3NlcnQgPSBhc3NlcnQ7XG5leHBvcnRzLmFzc2VydGlvbkVycm9yID0gYXNzZXJ0aW9uRXJyb3I7XG5leHBvcnRzLmJhc2U2NCA9IGJhc2U2NDtcbmV4cG9ydHMuYmFzZTY0RGVjb2RlID0gYmFzZTY0RGVjb2RlO1xuZXhwb3J0cy5iYXNlNjRFbmNvZGUgPSBiYXNlNjRFbmNvZGU7XG5leHBvcnRzLkNPTlNUQU5UUyA9IENPTlNUQU5UUztcbmV4cG9ydHMuZGVlcENvcHkgPSBkZWVwQ29weTtcbmV4cG9ydHMuZGVlcEV4dGVuZCA9IGRlZXBFeHRlbmQ7XG5leHBvcnRzLnBhdGNoUHJvcGVydHkgPSBwYXRjaFByb3BlcnR5O1xuZXhwb3J0cy5EZWZlcnJlZCA9IERlZmVycmVkO1xuZXhwb3J0cy5nZXRVQSA9IGdldFVBO1xuZXhwb3J0cy5pc01vYmlsZUNvcmRvdmEgPSBpc01vYmlsZUNvcmRvdmE7XG5leHBvcnRzLmlzTm9kZVNkayA9IGlzTm9kZVNkaztcbmV4cG9ydHMuaXNSZWFjdE5hdGl2ZSA9IGlzUmVhY3ROYXRpdmU7XG5leHBvcnRzLkVycm9yRmFjdG9yeSA9IEVycm9yRmFjdG9yeTtcbmV4cG9ydHMuRmlyZWJhc2VFcnJvciA9IEZpcmViYXNlRXJyb3I7XG5leHBvcnRzLnBhdGNoQ2FwdHVyZSA9IHBhdGNoQ2FwdHVyZTtcbmV4cG9ydHMuanNvbkV2YWwgPSBqc29uRXZhbDtcbmV4cG9ydHMuc3RyaW5naWZ5ID0gc3RyaW5naWZ5O1xuZXhwb3J0cy5kZWNvZGUgPSBkZWNvZGU7XG5leHBvcnRzLmlzQWRtaW4gPSBpc0FkbWluO1xuZXhwb3J0cy5pc3N1ZWRBdFRpbWUgPSBpc3N1ZWRBdFRpbWU7XG5leHBvcnRzLmlzVmFsaWRGb3JtYXQgPSBpc1ZhbGlkRm9ybWF0O1xuZXhwb3J0cy5pc1ZhbGlkVGltZXN0YW1wID0gaXNWYWxpZFRpbWVzdGFtcDtcbmV4cG9ydHMuY2xvbmUgPSBjbG9uZTtcbmV4cG9ydHMuY29udGFpbnMgPSBjb250YWlucztcbmV4cG9ydHMuZXZlcnkgPSBldmVyeTtcbmV4cG9ydHMuZXh0ZW5kID0gZXh0ZW5kO1xuZXhwb3J0cy5maW5kS2V5ID0gZmluZEtleTtcbmV4cG9ydHMuZmluZFZhbHVlID0gZmluZFZhbHVlO1xuZXhwb3J0cy5mb3JFYWNoID0gZm9yRWFjaDtcbmV4cG9ydHMuZ2V0QW55S2V5ID0gZ2V0QW55S2V5O1xuZXhwb3J0cy5nZXRDb3VudCA9IGdldENvdW50O1xuZXhwb3J0cy5nZXRWYWx1ZXMgPSBnZXRWYWx1ZXM7XG5leHBvcnRzLmlzRW1wdHkgPSBpc0VtcHR5O1xuZXhwb3J0cy5pc05vbk51bGxPYmplY3QgPSBpc05vbk51bGxPYmplY3Q7XG5leHBvcnRzLm1hcCA9IG1hcDtcbmV4cG9ydHMuc2FmZUdldCA9IHNhZmVHZXQ7XG5leHBvcnRzLnF1ZXJ5c3RyaW5nID0gcXVlcnlzdHJpbmc7XG5leHBvcnRzLnF1ZXJ5c3RyaW5nRGVjb2RlID0gcXVlcnlzdHJpbmdEZWNvZGU7XG5leHBvcnRzLlNoYTEgPSBTaGExO1xuZXhwb3J0cy5hc3luYyA9IGFzeW5jO1xuZXhwb3J0cy5jcmVhdGVTdWJzY3JpYmUgPSBjcmVhdGVTdWJzY3JpYmU7XG5leHBvcnRzLmVycm9yUHJlZml4ID0gZXJyb3JQcmVmaXg7XG5leHBvcnRzLnZhbGlkYXRlQXJnQ291bnQgPSB2YWxpZGF0ZUFyZ0NvdW50O1xuZXhwb3J0cy52YWxpZGF0ZUNhbGxiYWNrID0gdmFsaWRhdGVDYWxsYmFjaztcbmV4cG9ydHMudmFsaWRhdGVDb250ZXh0T2JqZWN0ID0gdmFsaWRhdGVDb250ZXh0T2JqZWN0O1xuZXhwb3J0cy52YWxpZGF0ZU5hbWVzcGFjZSA9IHZhbGlkYXRlTmFtZXNwYWNlO1xuZXhwb3J0cy5zdHJpbmdMZW5ndGggPSBzdHJpbmdMZW5ndGg7XG5leHBvcnRzLnN0cmluZ1RvQnl0ZUFycmF5ID0gc3RyaW5nVG9CeXRlQXJyYXkkMTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9AZmlyZWJhc2UvdXRpbC9kaXN0L2luZGV4LmNqcy5qc1xuLy8gbW9kdWxlIGlkID0gMzhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIGNvbW1vbmpzR2xvYmFsID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB7fTtcblxudmFyIGUsZ29vZz1nb29nfHx7fSxoPWNvbW1vbmpzR2xvYmFsO2Z1bmN0aW9uIGwoYSl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGF9ZnVuY3Rpb24gbShhLGIpe2E9YS5zcGxpdChcIi5cIik7Yj1ifHxoO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKWlmKGI9YlthW2NdXSwgbnVsbD09YilyZXR1cm4gbnVsbDtyZXR1cm4gYn1mdW5jdGlvbiBhYSgpe31cbmZ1bmN0aW9uIGJhKGEpe3ZhciBiPXR5cGVvZiBhO2lmKFwib2JqZWN0XCI9PWIpaWYoYSl7aWYoYSBpbnN0YW5jZW9mIEFycmF5KXJldHVyblwiYXJyYXlcIjtpZihhIGluc3RhbmNlb2YgT2JqZWN0KXJldHVybiBiO3ZhciBjPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKTtpZihcIltvYmplY3QgV2luZG93XVwiPT1jKXJldHVyblwib2JqZWN0XCI7aWYoXCJbb2JqZWN0IEFycmF5XVwiPT1jfHxcIm51bWJlclwiPT10eXBlb2YgYS5sZW5ndGgmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLnNwbGljZSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGEucHJvcGVydHlJc0VudW1lcmFibGUmJiFhLnByb3BlcnR5SXNFbnVtZXJhYmxlKFwic3BsaWNlXCIpKXJldHVyblwiYXJyYXlcIjtpZihcIltvYmplY3QgRnVuY3Rpb25dXCI9PWN8fFwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLmNhbGwmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBhLnByb3BlcnR5SXNFbnVtZXJhYmxlJiYhYS5wcm9wZXJ0eUlzRW51bWVyYWJsZShcImNhbGxcIikpcmV0dXJuXCJmdW5jdGlvblwifWVsc2UgcmV0dXJuXCJudWxsXCI7XG5lbHNlIGlmKFwiZnVuY3Rpb25cIj09YiYmXCJ1bmRlZmluZWRcIj09dHlwZW9mIGEuY2FsbClyZXR1cm5cIm9iamVjdFwiO3JldHVybiBifWZ1bmN0aW9uIG4oYSl7cmV0dXJuXCJhcnJheVwiPT1iYShhKX1mdW5jdGlvbiBjYShhKXt2YXIgYj1iYShhKTtyZXR1cm5cImFycmF5XCI9PWJ8fFwib2JqZWN0XCI9PWImJlwibnVtYmVyXCI9PXR5cGVvZiBhLmxlbmd0aH1mdW5jdGlvbiBxKGEpe3JldHVyblwiZnVuY3Rpb25cIj09YmEoYSl9ZnVuY3Rpb24gcihhKXt2YXIgYj10eXBlb2YgYTtyZXR1cm5cIm9iamVjdFwiPT1iJiZudWxsIT1hfHxcImZ1bmN0aW9uXCI9PWJ9dmFyIHQ9XCJjbG9zdXJlX3VpZF9cIisoMUU5Kk1hdGgucmFuZG9tKCk+Pj4wKSxkYT0wO2Z1bmN0aW9uIGVhKGEsYixjKXtyZXR1cm4gYS5jYWxsLmFwcGx5KGEuYmluZCxhcmd1bWVudHMpfVxuZnVuY3Rpb24gZmEoYSxiLGMpe2lmKCFhKXRocm93IEVycm9yKCk7aWYoMjxhcmd1bWVudHMubGVuZ3RoKXt2YXIgZD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtBcnJheS5wcm90b3R5cGUudW5zaGlmdC5hcHBseShjLGQpO3JldHVybiBhLmFwcGx5KGIsYyl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGIsYXJndW1lbnRzKX19ZnVuY3Rpb24gdShhLGIsYyl7dT1GdW5jdGlvbi5wcm90b3R5cGUuYmluZCYmLTEhPUZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLnRvU3RyaW5nKCkuaW5kZXhPZihcIm5hdGl2ZSBjb2RlXCIpP2VhOmZhO3JldHVybiB1LmFwcGx5KG51bGwsYXJndW1lbnRzKX1cbmZ1bmN0aW9uIHYoYSxiKXt2YXIgYz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGI9Yy5zbGljZSgpO2IucHVzaC5hcHBseShiLGFyZ3VtZW50cyk7cmV0dXJuIGEuYXBwbHkodGhpcyxiKX19dmFyIHc9RGF0ZS5ub3d8fGZ1bmN0aW9uKCl7cmV0dXJuK25ldyBEYXRlfTtmdW5jdGlvbiB4KGEsYil7ZnVuY3Rpb24gYygpe31jLnByb3RvdHlwZT1iLnByb3RvdHlwZTthLkw9Yi5wcm90b3R5cGU7YS5wcm90b3R5cGU9bmV3IGM7YS5wcm90b3R5cGUuY29uc3RydWN0b3I9YTthLm1oPWZ1bmN0aW9uKGEsYyxnKXtmb3IodmFyIGQ9QXJyYXkoYXJndW1lbnRzLmxlbmd0aC0yKSxmPTI7Zjxhcmd1bWVudHMubGVuZ3RoO2YrKylkW2YtMl09YXJndW1lbnRzW2ZdO3JldHVybiBiLnByb3RvdHlwZVtjXS5hcHBseShhLGQpfTt9ZnVuY3Rpb24geShhKXtpZihFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSlFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLHkpO2Vsc2V7dmFyIGI9RXJyb3IoKS5zdGFjaztiJiYodGhpcy5zdGFjaz1iKTt9YSYmKHRoaXMubWVzc2FnZT1TdHJpbmcoYSkpO314KHksRXJyb3IpO3kucHJvdG90eXBlLm5hbWU9XCJDdXN0b21FcnJvclwiO2Z1bmN0aW9uIGhhKGEsYil7YT1hLnNwbGl0KFwiJXNcIik7Zm9yKHZhciBjPVwiXCIsZD1hLmxlbmd0aC0xLGY9MDtmPGQ7ZisrKWMrPWFbZl0rKGY8Yi5sZW5ndGg/YltmXTpcIiVzXCIpO3kuY2FsbCh0aGlzLGMrYVtkXSk7fXgoaGEseSk7aGEucHJvdG90eXBlLm5hbWU9XCJBc3NlcnRpb25FcnJvclwiO2Z1bmN0aW9uIGlhKGEsYil7dGhyb3cgbmV3IGhhKFwiRmFpbHVyZVwiKyhhP1wiOiBcIithOlwiXCIpLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7fWZ1bmN0aW9uIHooKXswIT1qYSYmKGthW3RoaXNbdF18fCh0aGlzW3RdPSsrZGEpXT10aGlzKTt0aGlzLkthPXRoaXMuS2E7dGhpcy5RYT10aGlzLlFhO312YXIgamE9MCxrYT17fTt6LnByb3RvdHlwZS5LYT0hMTt6LnByb3RvdHlwZS5iYj1mdW5jdGlvbigpe2lmKCF0aGlzLkthJiYodGhpcy5LYT0hMCwgdGhpcy5GKCksIDAhPWphKSl7dmFyIGE9dGhpc1t0XXx8KHRoaXNbdF09KytkYSk7aWYoMCE9amEmJnRoaXMuUWEmJjA8dGhpcy5RYS5sZW5ndGgpdGhyb3cgRXJyb3IodGhpcytcIiBkaWQgbm90IGVtcHR5IGl0cyBvbkRpc3Bvc2VDYWxsYmFja3MgcXVldWUuIFRoaXMgcHJvYmFibHkgbWVhbnMgaXQgb3ZlcnJvZGUgZGlzcG9zZSgpIG9yIGRpc3Bvc2VJbnRlcm5hbCgpIHdpdGhvdXQgY2FsbGluZyB0aGUgc3VwZXJjbGFzcycgbWV0aG9kLlwiKTtkZWxldGUga2FbYV07fX07ei5wcm90b3R5cGUuRj1mdW5jdGlvbigpe2lmKHRoaXMuUWEpZm9yKDt0aGlzLlFhLmxlbmd0aDspdGhpcy5RYS5zaGlmdCgpKCk7fTt2YXIgbGE9QXJyYXkucHJvdG90eXBlLmluZGV4T2Y/ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChhLGIsdm9pZCAwKX06ZnVuY3Rpb24oYSxiKXtpZihsKGEpKXJldHVybiBsKGIpJiYxPT1iLmxlbmd0aD9hLmluZGV4T2YoYiwwKTotMTtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKylpZihjIGluIGEmJmFbY109PT1iKXJldHVybiBjO3JldHVybi0xfSxtYT1BcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2Y/ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mLmNhbGwoYSxiLGEubGVuZ3RoLTEpfTpmdW5jdGlvbihhLGIpe3ZhciBjPWEubGVuZ3RoLTE7MD5jJiYoYz1NYXRoLm1heCgwLGEubGVuZ3RoK2MpKTtpZihsKGEpKXJldHVybiBsKGIpJiYxPT1iLmxlbmd0aD9hLmxhc3RJbmRleE9mKGIsYyk6LTE7Zm9yKDswPD1jO2MtLSlpZihjIGluIGEmJmFbY109PT1iKXJldHVybiBjO3JldHVybi0xfSxuYT1cbkFycmF5LnByb3RvdHlwZS5mb3JFYWNoP2Z1bmN0aW9uKGEsYixjKXtBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGEsYixjKTt9OmZ1bmN0aW9uKGEsYixjKXtmb3IodmFyIGQ9YS5sZW5ndGgsZj1sKGEpP2Euc3BsaXQoXCJcIik6YSxnPTA7ZzxkO2crKylnIGluIGYmJmIuY2FsbChjLGZbZ10sZyxhKTt9LG9hPUFycmF5LnByb3RvdHlwZS5zb21lP2Z1bmN0aW9uKGEsYil7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zb21lLmNhbGwoYSxiLHZvaWQgMCl9OmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPWEubGVuZ3RoLGQ9bChhKT9hLnNwbGl0KFwiXCIpOmEsZj0wO2Y8YztmKyspaWYoZiBpbiBkJiZiLmNhbGwodm9pZCAwLGRbZl0sZixhKSlyZXR1cm4hMDtyZXR1cm4hMX07XG5mdW5jdGlvbiBwYShhKXthOnt2YXIgYj1xYTtmb3IodmFyIGM9YS5sZW5ndGgsZD1sKGEpP2Euc3BsaXQoXCJcIik6YSxmPTA7ZjxjO2YrKylpZihmIGluIGQmJmIuY2FsbCh2b2lkIDAsZFtmXSxmLGEpKXtiPWY7YnJlYWsgYX1iPS0xO31yZXR1cm4gMD5iP251bGw6bChhKT9hLmNoYXJBdChiKTphW2JdfWZ1bmN0aW9uIHJhKGEpe2lmKCFuKGEpKWZvcih2YXIgYj1hLmxlbmd0aC0xOzA8PWI7Yi0tKWRlbGV0ZSBhW2JdO2EubGVuZ3RoPTA7fWZ1bmN0aW9uIHNhKGEsYil7Yj1sYShhLGIpO3ZhciBjOyhjPTA8PWIpJiZBcnJheS5wcm90b3R5cGUuc3BsaWNlLmNhbGwoYSxiLDEpO3JldHVybiBjfWZ1bmN0aW9uIHRhKGEpe3JldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLGFyZ3VtZW50cyl9ZnVuY3Rpb24gdWEoYSl7dmFyIGI9YS5sZW5ndGg7aWYoMDxiKXtmb3IodmFyIGM9QXJyYXkoYiksZD0wO2Q8YjtkKyspY1tkXT1hW2RdO3JldHVybiBjfXJldHVybltdfWZ1bmN0aW9uIHZhKGEpe3JldHVybi9eW1xcc1xceGEwXSokLy50ZXN0KGEpfXZhciB3YT1TdHJpbmcucHJvdG90eXBlLnRyaW0/ZnVuY3Rpb24oYSl7cmV0dXJuIGEudHJpbSgpfTpmdW5jdGlvbihhKXtyZXR1cm4vXltcXHNcXHhhMF0qKFtcXHNcXFNdKj8pW1xcc1xceGEwXSokLy5leGVjKGEpWzFdfTtmdW5jdGlvbiB4YShhLGIpe3JldHVybiBhPGI/LTE6YT5iPzE6MH12YXIgQTthOnt2YXIgeWE9aC5uYXZpZ2F0b3I7aWYoeWEpe3ZhciB6YT15YS51c2VyQWdlbnQ7aWYoemEpe0E9emE7YnJlYWsgYX19QT1cIlwiO31mdW5jdGlvbiBCKGEpe3JldHVybi0xIT1BLmluZGV4T2YoYSl9ZnVuY3Rpb24gQWEoYSxiLGMpe2Zvcih2YXIgZCBpbiBhKWIuY2FsbChjLGFbZF0sZCxhKTt9ZnVuY3Rpb24gQmEoYSl7dmFyIGI9W10sYz0wLGQ7Zm9yKGQgaW4gYSliW2MrK109YVtkXTtyZXR1cm4gYn1mdW5jdGlvbiBDYShhKXt2YXIgYj1bXSxjPTAsZDtmb3IoZCBpbiBhKWJbYysrXT1kO3JldHVybiBifWZ1bmN0aW9uIERhKGEpe3ZhciBiPXt9LGM7Zm9yKGMgaW4gYSliW2NdPWFbY107cmV0dXJuIGJ9dmFyIEVhPVwiY29uc3RydWN0b3IgaGFzT3duUHJvcGVydHkgaXNQcm90b3R5cGVPZiBwcm9wZXJ0eUlzRW51bWVyYWJsZSB0b0xvY2FsZVN0cmluZyB0b1N0cmluZyB2YWx1ZU9mXCIuc3BsaXQoXCIgXCIpO1xuZnVuY3Rpb24gRmEoYSxiKXtmb3IodmFyIGMsZCxmPTE7Zjxhcmd1bWVudHMubGVuZ3RoO2YrKyl7ZD1hcmd1bWVudHNbZl07Zm9yKGMgaW4gZClhW2NdPWRbY107Zm9yKHZhciBnPTA7ZzxFYS5sZW5ndGg7ZysrKWM9RWFbZ10sIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkLGMpJiYoYVtjXT1kW2NdKTt9fWZ1bmN0aW9uIEdhKGEpe0dhW1wiIFwiXShhKTtyZXR1cm4gYX1HYVtcIiBcIl09YWE7ZnVuY3Rpb24gSGEoYSxiKXt2YXIgYz1JYTtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGMsYSk/Y1thXTpjW2FdPWIoYSl9dmFyIEphPUIoXCJPcGVyYVwiKSxDPUIoXCJUcmlkZW50XCIpfHxCKFwiTVNJRVwiKSxLYT1CKFwiRWRnZVwiKSxMYT1LYXx8QyxNYT1CKFwiR2Vja29cIikmJiEoLTEhPUEudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwid2Via2l0XCIpJiYhQihcIkVkZ2VcIikpJiYhKEIoXCJUcmlkZW50XCIpfHxCKFwiTVNJRVwiKSkmJiFCKFwiRWRnZVwiKSxOYT0tMSE9QS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJ3ZWJraXRcIikmJiFCKFwiRWRnZVwiKTtmdW5jdGlvbiBPYSgpe3ZhciBhPWguZG9jdW1lbnQ7cmV0dXJuIGE/YS5kb2N1bWVudE1vZGU6dm9pZCAwfXZhciBQYTtcbmE6e3ZhciBRYT1cIlwiLFJhPWZ1bmN0aW9uKCl7dmFyIGE9QTtpZihNYSlyZXR1cm4vcnY6KFteXFwpO10rKShcXCl8OykvLmV4ZWMoYSk7aWYoS2EpcmV0dXJuL0VkZ2VcXC8oW1xcZFxcLl0rKS8uZXhlYyhhKTtpZihDKXJldHVybi9cXGIoPzpNU0lFfHJ2KVs6IF0oW15cXCk7XSspKFxcKXw7KS8uZXhlYyhhKTtpZihOYSlyZXR1cm4vV2ViS2l0XFwvKFxcUyspLy5leGVjKGEpO2lmKEphKXJldHVybi8oPzpWZXJzaW9uKVsgXFwvXT8oXFxTKykvLmV4ZWMoYSl9KCk7UmEmJihRYT1SYT9SYVsxXTpcIlwiKTtpZihDKXt2YXIgU2E9T2EoKTtpZihudWxsIT1TYSYmU2E+cGFyc2VGbG9hdChRYSkpe1BhPVN0cmluZyhTYSk7YnJlYWsgYX19UGE9UWE7fXZhciBJYT17fTtcbmZ1bmN0aW9uIFRhKGEpe3JldHVybiBIYShhLGZ1bmN0aW9uKCl7Zm9yKHZhciBiPTAsYz13YShTdHJpbmcoUGEpKS5zcGxpdChcIi5cIiksZD13YShTdHJpbmcoYSkpLnNwbGl0KFwiLlwiKSxmPU1hdGgubWF4KGMubGVuZ3RoLGQubGVuZ3RoKSxnPTA7MD09YiYmZzxmO2crKyl7dmFyIGs9Y1tnXXx8XCJcIixwPWRbZ118fFwiXCI7ZG97az0vKFxcZCopKFxcRCopKC4qKS8uZXhlYyhrKXx8W1wiXCIsXCJcIixcIlwiLFwiXCJdO3A9LyhcXGQqKShcXEQqKSguKikvLmV4ZWMocCl8fFtcIlwiLFwiXCIsXCJcIixcIlwiXTtpZigwPT1rWzBdLmxlbmd0aCYmMD09cFswXS5sZW5ndGgpYnJlYWs7Yj14YSgwPT1rWzFdLmxlbmd0aD8wOnBhcnNlSW50KGtbMV0sMTApLDA9PXBbMV0ubGVuZ3RoPzA6cGFyc2VJbnQocFsxXSwxMCkpfHx4YSgwPT1rWzJdLmxlbmd0aCwwPT1wWzJdLmxlbmd0aCl8fHhhKGtbMl0scFsyXSk7az1rWzNdO3A9cFszXTt9d2hpbGUoMD09Yil9cmV0dXJuIDA8PWJ9KX12YXIgVWE7dmFyIFZhPWguZG9jdW1lbnQ7XG5VYT1WYSYmQz9PYSgpfHwoXCJDU1MxQ29tcGF0XCI9PVZhLmNvbXBhdE1vZGU/cGFyc2VJbnQoUGEsMTApOjUpOnZvaWQgMDt2YXIgV2E9T2JqZWN0LmZyZWV6ZXx8ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O3ZhciBYYT0hQ3x8OTw9TnVtYmVyKFVhKSxZYT1DJiYhVGEoXCI5XCIpLFphPWZ1bmN0aW9uKCl7aWYoIWguYWRkRXZlbnRMaXN0ZW5lcnx8IU9iamVjdC5kZWZpbmVQcm9wZXJ0eSlyZXR1cm4hMTt2YXIgYT0hMSxiPU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSxcInBhc3NpdmVcIix7Z2V0OmZ1bmN0aW9uKCl7YT0hMDt9fSk7dHJ5e2guYWRkRXZlbnRMaXN0ZW5lcihcInRlc3RcIixhYSxiKSwgaC5yZW1vdmVFdmVudExpc3RlbmVyKFwidGVzdFwiLGFhLGIpO31jYXRjaChjKXt9cmV0dXJuIGF9KCk7ZnVuY3Rpb24gRChhLGIpe3RoaXMudHlwZT1hO3RoaXMuY3VycmVudFRhcmdldD10aGlzLnRhcmdldD1iO3RoaXMuZGVmYXVsdFByZXZlbnRlZD10aGlzLkVhPSExO3RoaXMuQmU9ITA7fUQucHJvdG90eXBlLnN0b3BQcm9wYWdhdGlvbj1mdW5jdGlvbigpe3RoaXMuRWE9ITA7fTtELnByb3RvdHlwZS5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe3RoaXMuZGVmYXVsdFByZXZlbnRlZD0hMDt0aGlzLkJlPSExO307ZnVuY3Rpb24gRShhLGIpe0QuY2FsbCh0aGlzLGE/YS50eXBlOlwiXCIpO3RoaXMucmVsYXRlZFRhcmdldD10aGlzLmN1cnJlbnRUYXJnZXQ9dGhpcy50YXJnZXQ9bnVsbDt0aGlzLmJ1dHRvbj10aGlzLnNjcmVlblk9dGhpcy5zY3JlZW5YPXRoaXMuY2xpZW50WT10aGlzLmNsaWVudFg9dGhpcy5vZmZzZXRZPXRoaXMub2Zmc2V0WD0wO3RoaXMua2V5PVwiXCI7dGhpcy5jaGFyQ29kZT10aGlzLmtleUNvZGU9MDt0aGlzLm1ldGFLZXk9dGhpcy5zaGlmdEtleT10aGlzLmFsdEtleT10aGlzLmN0cmxLZXk9ITE7dGhpcy5zdGF0ZT1udWxsO3RoaXMucG9pbnRlcklkPTA7dGhpcy5wb2ludGVyVHlwZT1cIlwiO3RoaXMuZmI9bnVsbDthJiZ0aGlzLktmKGEsYik7fXgoRSxEKTt2YXIgJGE9V2EoezI6XCJ0b3VjaFwiLDM6XCJwZW5cIiw0OlwibW91c2VcIn0pO1xuRS5wcm90b3R5cGUuS2Y9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnR5cGU9YS50eXBlLGQ9YS5jaGFuZ2VkVG91Y2hlcz9hLmNoYW5nZWRUb3VjaGVzWzBdOm51bGw7dGhpcy50YXJnZXQ9YS50YXJnZXR8fGEuc3JjRWxlbWVudDt0aGlzLmN1cnJlbnRUYXJnZXQ9YjtpZihiPWEucmVsYXRlZFRhcmdldCl7aWYoTWEpe2E6e3RyeXtHYShiLm5vZGVOYW1lKTt2YXIgZj0hMDticmVhayBhfWNhdGNoKGcpe31mPSExO31mfHwoYj1udWxsKTt9fWVsc2VcIm1vdXNlb3ZlclwiPT1jP2I9YS5mcm9tRWxlbWVudDpcIm1vdXNlb3V0XCI9PWMmJihiPWEudG9FbGVtZW50KTt0aGlzLnJlbGF0ZWRUYXJnZXQ9YjtudWxsPT09ZD8odGhpcy5vZmZzZXRYPU5hfHx2b2lkIDAhPT1hLm9mZnNldFg/YS5vZmZzZXRYOmEubGF5ZXJYLCB0aGlzLm9mZnNldFk9TmF8fHZvaWQgMCE9PWEub2Zmc2V0WT9hLm9mZnNldFk6YS5sYXllclksIHRoaXMuY2xpZW50WD12b2lkIDAhPT1hLmNsaWVudFg/YS5jbGllbnRYOmEucGFnZVgsIHRoaXMuY2xpZW50WT12b2lkIDAhPT1hLmNsaWVudFk/YS5jbGllbnRZOmEucGFnZVksIHRoaXMuc2NyZWVuWD1hLnNjcmVlblh8fDAsIHRoaXMuc2NyZWVuWT1hLnNjcmVlbll8fDApOih0aGlzLmNsaWVudFg9dm9pZCAwIT09ZC5jbGllbnRYP2QuY2xpZW50WDpkLnBhZ2VYLCB0aGlzLmNsaWVudFk9dm9pZCAwIT09ZC5jbGllbnRZP2QuY2xpZW50WTpkLnBhZ2VZLCB0aGlzLnNjcmVlblg9ZC5zY3JlZW5YfHwwLCB0aGlzLnNjcmVlblk9ZC5zY3JlZW5ZfHwwKTt0aGlzLmJ1dHRvbj1hLmJ1dHRvbjt0aGlzLmtleUNvZGU9YS5rZXlDb2RlfHwwO3RoaXMua2V5PWEua2V5fHxcIlwiO3RoaXMuY2hhckNvZGU9YS5jaGFyQ29kZXx8KFwia2V5cHJlc3NcIj09Yz9hLmtleUNvZGU6MCk7dGhpcy5jdHJsS2V5PWEuY3RybEtleTt0aGlzLmFsdEtleT1hLmFsdEtleTt0aGlzLnNoaWZ0S2V5PWEuc2hpZnRLZXk7dGhpcy5tZXRhS2V5PWEubWV0YUtleTt0aGlzLnBvaW50ZXJJZD1hLnBvaW50ZXJJZHx8MDt0aGlzLnBvaW50ZXJUeXBlPVxubChhLnBvaW50ZXJUeXBlKT9hLnBvaW50ZXJUeXBlOiRhW2EucG9pbnRlclR5cGVdfHxcIlwiO3RoaXMuc3RhdGU9YS5zdGF0ZTt0aGlzLmZiPWE7YS5kZWZhdWx0UHJldmVudGVkJiZ0aGlzLnByZXZlbnREZWZhdWx0KCk7fTtFLnByb3RvdHlwZS5zdG9wUHJvcGFnYXRpb249ZnVuY3Rpb24oKXtFLkwuc3RvcFByb3BhZ2F0aW9uLmNhbGwodGhpcyk7dGhpcy5mYi5zdG9wUHJvcGFnYXRpb24/dGhpcy5mYi5zdG9wUHJvcGFnYXRpb24oKTp0aGlzLmZiLmNhbmNlbEJ1YmJsZT0hMDt9O0UucHJvdG90eXBlLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7RS5MLnByZXZlbnREZWZhdWx0LmNhbGwodGhpcyk7dmFyIGE9dGhpcy5mYjtpZihhLnByZXZlbnREZWZhdWx0KWEucHJldmVudERlZmF1bHQoKTtlbHNlIGlmKGEucmV0dXJuVmFsdWU9ITEsIFlhKXRyeXtpZihhLmN0cmxLZXl8fDExMjw9YS5rZXlDb2RlJiYxMjM+PWEua2V5Q29kZSlhLmtleUNvZGU9LTE7fWNhdGNoKGIpe319O3ZhciBhYj1cImNsb3N1cmVfbGlzdGVuYWJsZV9cIisoMUU2Kk1hdGgucmFuZG9tKCl8MCk7ZnVuY3Rpb24gRihhKXtyZXR1cm4hKCFhfHwhYVthYl0pfXZhciBiYj0wO2Z1bmN0aW9uIGNiKGEsYixjLGQsZil7dGhpcy5saXN0ZW5lcj1hO3RoaXMucHJveHk9bnVsbDt0aGlzLnNyYz1iO3RoaXMudHlwZT1jO3RoaXMuY2FwdHVyZT0hIWQ7dGhpcy5PYj1mO3RoaXMua2V5PSsrYmI7dGhpcy5TYT10aGlzLkViPSExO31jYi5wcm90b3R5cGUuVmI9ZnVuY3Rpb24oKXt0aGlzLlNhPSEwO3RoaXMuT2I9dGhpcy5zcmM9dGhpcy5wcm94eT10aGlzLmxpc3RlbmVyPW51bGw7fTtmdW5jdGlvbiBkYihhKXt0aGlzLnNyYz1hO3RoaXMuSj17fTt0aGlzLnhiPTA7fWU9ZGIucHJvdG90eXBlO2UuYWRkPWZ1bmN0aW9uKGEsYixjLGQsZil7dmFyIGc9YS50b1N0cmluZygpO2E9dGhpcy5KW2ddO2F8fChhPXRoaXMuSltnXT1bXSwgdGhpcy54YisrKTt2YXIgaz1lYihhLGIsZCxmKTstMTxrPyhiPWFba10sIGN8fChiLkViPSExKSk6KGI9bmV3IGNiKGIsdGhpcy5zcmMsZywhIWQsZiksIGIuRWI9YywgYS5wdXNoKGIpKTtyZXR1cm4gYn07ZS5yZW1vdmU9ZnVuY3Rpb24oYSxiLGMsZCl7YT1hLnRvU3RyaW5nKCk7aWYoIShhIGluIHRoaXMuSikpcmV0dXJuITE7dmFyIGY9dGhpcy5KW2FdO2I9ZWIoZixiLGMsZCk7cmV0dXJuLTE8Yj8oZltiXS5WYigpLCBBcnJheS5wcm90b3R5cGUuc3BsaWNlLmNhbGwoZixiLDEpLCAwPT1mLmxlbmd0aCYmKGRlbGV0ZSB0aGlzLkpbYV0sIHRoaXMueGItLSksICEwKTohMX07XG5lLnllPWZ1bmN0aW9uKGEpe3ZhciBiPWEudHlwZTtiIGluIHRoaXMuSiYmc2EodGhpcy5KW2JdLGEpJiYoYS5WYigpLCAwPT10aGlzLkpbYl0ubGVuZ3RoJiYoZGVsZXRlIHRoaXMuSltiXSwgdGhpcy54Yi0tKSk7fTtlLnBiPWZ1bmN0aW9uKGEpe2E9YSYmYS50b1N0cmluZygpO3ZhciBjO2ZvcihjIGluIHRoaXMuSilpZighYXx8Yz09YSl7Zm9yKHZhciBkPXRoaXMuSltjXSxmPTA7ZjxkLmxlbmd0aDtmKyspZFtmXS5WYigpO2RlbGV0ZSB0aGlzLkpbY107dGhpcy54Yi0tO319O2UuamI9ZnVuY3Rpb24oYSxiLGMsZCl7YT10aGlzLkpbYS50b1N0cmluZygpXTt2YXIgZj0tMTthJiYoZj1lYihhLGIsYyxkKSk7cmV0dXJuLTE8Zj9hW2ZdOm51bGx9O2Z1bmN0aW9uIGViKGEsYixjLGQpe2Zvcih2YXIgZj0wO2Y8YS5sZW5ndGg7KytmKXt2YXIgZz1hW2ZdO2lmKCFnLlNhJiZnLmxpc3RlbmVyPT1iJiZnLmNhcHR1cmU9PSEhYyYmZy5PYj09ZClyZXR1cm4gZn1yZXR1cm4tMX12YXIgZmI9XCJjbG9zdXJlX2xtX1wiKygxRTYqTWF0aC5yYW5kb20oKXwwKSxnYj17fTtmdW5jdGlvbiBpYihhLGIsYyxkLGYpe2lmKGQmJmQub25jZSlyZXR1cm4gamIoYSxiLGMsZCxmKTtpZihuKGIpKXtmb3IodmFyIGc9MDtnPGIubGVuZ3RoO2crKylpYihhLGJbZ10sYyxkLGYpO3JldHVybiBudWxsfWM9a2IoYyk7cmV0dXJuIEYoYSk/YS5uYihiLGMscihkKT8hIWQuY2FwdHVyZTohIWQsZik6bGIoYSxiLGMsITEsZCxmKX1cbmZ1bmN0aW9uIGxiKGEsYixjLGQsZixnKXtpZighYil0aHJvdyBFcnJvcihcIkludmFsaWQgZXZlbnQgdHlwZVwiKTt2YXIgaz1yKGYpPyEhZi5jYXB0dXJlOiEhZixwPUcoYSk7cHx8KGFbZmJdPXA9bmV3IGRiKGEpKTtjPXAuYWRkKGIsYyxkLGssZyk7aWYoYy5wcm94eSlyZXR1cm4gYztkPW1iKCk7Yy5wcm94eT1kO2Quc3JjPWE7ZC5saXN0ZW5lcj1jO2lmKGEuYWRkRXZlbnRMaXN0ZW5lcilaYXx8KGY9ayksIHZvaWQgMD09PWYmJihmPSExKSwgYS5hZGRFdmVudExpc3RlbmVyKGIudG9TdHJpbmcoKSxkLGYpO2Vsc2UgaWYoYS5hdHRhY2hFdmVudClhLmF0dGFjaEV2ZW50KG5iKGIudG9TdHJpbmcoKSksZCk7ZWxzZSBpZihhLmFkZExpc3RlbmVyJiZhLnJlbW92ZUxpc3RlbmVyKWEuYWRkTGlzdGVuZXIoZCk7ZWxzZSB0aHJvdyBFcnJvcihcImFkZEV2ZW50TGlzdGVuZXIgYW5kIGF0dGFjaEV2ZW50IGFyZSB1bmF2YWlsYWJsZS5cIik7cmV0dXJuIGN9XG5mdW5jdGlvbiBtYigpe3ZhciBhPW9iLGI9WGE/ZnVuY3Rpb24oYyl7cmV0dXJuIGEuY2FsbChiLnNyYyxiLmxpc3RlbmVyLGMpfTpmdW5jdGlvbihjKXtjPWEuY2FsbChiLnNyYyxiLmxpc3RlbmVyLGMpO2lmKCFjKXJldHVybiBjfTtyZXR1cm4gYn1mdW5jdGlvbiBqYihhLGIsYyxkLGYpe2lmKG4oYikpe2Zvcih2YXIgZz0wO2c8Yi5sZW5ndGg7ZysrKWpiKGEsYltnXSxjLGQsZik7cmV0dXJuIG51bGx9Yz1rYihjKTtyZXR1cm4gRihhKT9hLk9jKGIsYyxyKGQpPyEhZC5jYXB0dXJlOiEhZCxmKTpsYihhLGIsYywhMCxkLGYpfWZ1bmN0aW9uIHBiKGEsYixjLGQsZil7aWYobihiKSlmb3IodmFyIGc9MDtnPGIubGVuZ3RoO2crKylwYihhLGJbZ10sYyxkLGYpO2Vsc2UgZD1yKGQpPyEhZC5jYXB0dXJlOiEhZCwgYz1rYihjKSwgRihhKT9hLmVkKGIsYyxkLGYpOmEmJihhPUcoYSkpJiYoYj1hLmpiKGIsYyxkLGYpKSYmcWIoYik7fVxuZnVuY3Rpb24gcWIoYSl7aWYoXCJudW1iZXJcIiE9dHlwZW9mIGEmJmEmJiFhLlNhKXt2YXIgYj1hLnNyYztpZihGKGIpKWIuTGUoYSk7ZWxzZXt2YXIgYz1hLnR5cGUsZD1hLnByb3h5O2IucmVtb3ZlRXZlbnRMaXN0ZW5lcj9iLnJlbW92ZUV2ZW50TGlzdGVuZXIoYyxkLGEuY2FwdHVyZSk6Yi5kZXRhY2hFdmVudD9iLmRldGFjaEV2ZW50KG5iKGMpLGQpOmIuYWRkTGlzdGVuZXImJmIucmVtb3ZlTGlzdGVuZXImJmIucmVtb3ZlTGlzdGVuZXIoZCk7KGM9RyhiKSk/KGMueWUoYSksIDA9PWMueGImJihjLnNyYz1udWxsLCBiW2ZiXT1udWxsKSk6YS5WYigpO319fWZ1bmN0aW9uIG5iKGEpe3JldHVybiBhIGluIGdiP2diW2FdOmdiW2FdPVwib25cIithfVxuZnVuY3Rpb24gcmIoYSxiLGMsZCl7dmFyIGY9ITA7aWYoYT1HKGEpKWlmKGI9YS5KW2IudG9TdHJpbmcoKV0pZm9yKGI9Yi5jb25jYXQoKSwgYT0wO2E8Yi5sZW5ndGg7YSsrKXt2YXIgZz1iW2FdO2cmJmcuY2FwdHVyZT09YyYmIWcuU2EmJihnPXNiKGcsZCksIGY9ZiYmITEhPT1nKTt9cmV0dXJuIGZ9ZnVuY3Rpb24gc2IoYSxiKXt2YXIgYz1hLmxpc3RlbmVyLGQ9YS5PYnx8YS5zcmM7YS5FYiYmcWIoYSk7cmV0dXJuIGMuY2FsbChkLGIpfVxuZnVuY3Rpb24gb2IoYSxiKXtpZihhLlNhKXJldHVybiEwO2lmKCFYYSl7dmFyIGM9Ynx8bShcIndpbmRvdy5ldmVudFwiKTtiPW5ldyBFKGMsdGhpcyk7dmFyIGQ9ITA7aWYoISgwPmMua2V5Q29kZXx8dm9pZCAwIT1jLnJldHVyblZhbHVlKSl7YTp7dmFyIGY9ITE7aWYoMD09Yy5rZXlDb2RlKXRyeXtjLmtleUNvZGU9LTE7YnJlYWsgYX1jYXRjaChrKXtmPSEwO31pZihmfHx2b2lkIDA9PWMucmV0dXJuVmFsdWUpYy5yZXR1cm5WYWx1ZT0hMDt9Yz1bXTtmb3IoZj1iLmN1cnJlbnRUYXJnZXQ7ZjtmPWYucGFyZW50Tm9kZSljLnB1c2goZik7YT1hLnR5cGU7Zm9yKGY9Yy5sZW5ndGgtMTshYi5FYSYmMDw9ZjtmLS0pe2IuY3VycmVudFRhcmdldD1jW2ZdO3ZhciBnPXJiKGNbZl0sYSwhMCxiKTtkPWQmJmc7fWZvcihmPTA7IWIuRWEmJmY8Yy5sZW5ndGg7ZisrKWIuY3VycmVudFRhcmdldD1jW2ZdLCBnPXJiKGNbZl0sYSwhMSxiKSwgZD1kJiZnO31yZXR1cm4gZH1yZXR1cm4gc2IoYSxuZXcgRShiLHRoaXMpKX1cbmZ1bmN0aW9uIEcoYSl7YT1hW2ZiXTtyZXR1cm4gYSBpbnN0YW5jZW9mIGRiP2E6bnVsbH12YXIgdGI9XCJfX2Nsb3N1cmVfZXZlbnRzX2ZuX1wiKygxRTkqTWF0aC5yYW5kb20oKT4+PjApO2Z1bmN0aW9uIGtiKGEpe2lmKHEoYSkpcmV0dXJuIGE7YVt0Yl18fChhW3RiXT1mdW5jdGlvbihiKXtyZXR1cm4gYS5oYW5kbGVFdmVudChiKX0pO3JldHVybiBhW3RiXX1mdW5jdGlvbiBIKCl7ei5jYWxsKHRoaXMpO3RoaXMua2E9bmV3IGRiKHRoaXMpO3RoaXMuUGU9dGhpczt0aGlzLlVjPW51bGw7fXgoSCx6KTtILnByb3RvdHlwZVthYl09ITA7ZT1ILnByb3RvdHlwZTtlLmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oYSxiLGMsZCl7aWIodGhpcyxhLGIsYyxkKTt9O2UucmVtb3ZlRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyxkKXtwYih0aGlzLGEsYixjLGQpO307XG5lLmRpc3BhdGNoRXZlbnQ9ZnVuY3Rpb24oYSl7dmFyIGIsYz10aGlzLlVjO2lmKGMpZm9yKGI9W107YztjPWMuVWMpYi5wdXNoKGMpO2M9dGhpcy5QZTt2YXIgZD1hLnR5cGV8fGE7aWYobChhKSlhPW5ldyBEKGEsYyk7ZWxzZSBpZihhIGluc3RhbmNlb2YgRClhLnRhcmdldD1hLnRhcmdldHx8YztlbHNle3ZhciBmPWE7YT1uZXcgRChkLGMpO0ZhKGEsZik7fWY9ITA7aWYoYilmb3IodmFyIGc9Yi5sZW5ndGgtMTshYS5FYSYmMDw9ZztnLS0pe3ZhciBrPWEuY3VycmVudFRhcmdldD1iW2ddO2Y9ay5MYihkLCEwLGEpJiZmO31hLkVhfHwoaz1hLmN1cnJlbnRUYXJnZXQ9YywgZj1rLkxiKGQsITAsYSkmJmYsIGEuRWF8fChmPWsuTGIoZCwhMSxhKSYmZikpO2lmKGIpZm9yKGc9MDshYS5FYSYmZzxiLmxlbmd0aDtnKyspaz1hLmN1cnJlbnRUYXJnZXQ9YltnXSwgZj1rLkxiKGQsITEsYSkmJmY7cmV0dXJuIGZ9O1xuZS5GPWZ1bmN0aW9uKCl7SC5MLkYuY2FsbCh0aGlzKTt0aGlzLnBnKCk7dGhpcy5VYz1udWxsO307ZS5uYj1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5rYS5hZGQoU3RyaW5nKGEpLGIsITEsYyxkKX07ZS5PYz1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5rYS5hZGQoU3RyaW5nKGEpLGIsITAsYyxkKX07ZS5lZD1mdW5jdGlvbihhLGIsYyxkKXt0aGlzLmthLnJlbW92ZShTdHJpbmcoYSksYixjLGQpO307ZS5MZT1mdW5jdGlvbihhKXt0aGlzLmthLnllKGEpO307ZS5wZz1mdW5jdGlvbigpe3RoaXMua2EmJnRoaXMua2EucGIodm9pZCAwKTt9O1xuZS5MYj1mdW5jdGlvbihhLGIsYyl7YT10aGlzLmthLkpbU3RyaW5nKGEpXTtpZighYSlyZXR1cm4hMDthPWEuY29uY2F0KCk7Zm9yKHZhciBkPSEwLGY9MDtmPGEubGVuZ3RoOysrZil7dmFyIGc9YVtmXTtpZihnJiYhZy5TYSYmZy5jYXB0dXJlPT1iKXt2YXIgaz1nLmxpc3RlbmVyLHA9Zy5PYnx8Zy5zcmM7Zy5FYiYmdGhpcy5MZShnKTtkPSExIT09ay5jYWxsKHAsYykmJmQ7fX1yZXR1cm4gZCYmMCE9Yy5CZX07ZS5qYj1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5rYS5qYihTdHJpbmcoYSksYixjLGQpfTt2YXIgdWI9aC5KU09OLnN0cmluZ2lmeTtmdW5jdGlvbiB2YihhLGIpe3RoaXMuU2Y9MTAwO3RoaXMuZWY9YTt0aGlzLnVnPWI7dGhpcy5aYj0wO3RoaXMuUGI9bnVsbDt9dmIucHJvdG90eXBlLmdldD1mdW5jdGlvbigpe2lmKDA8dGhpcy5aYil7dGhpcy5aYi0tO3ZhciBhPXRoaXMuUGI7dGhpcy5QYj1hLm5leHQ7YS5uZXh0PW51bGw7fWVsc2UgYT10aGlzLmVmKCk7cmV0dXJuIGF9O3ZiLnByb3RvdHlwZS5wdXQ9ZnVuY3Rpb24oYSl7dGhpcy51ZyhhKTt0aGlzLlpiPHRoaXMuU2YmJih0aGlzLlpiKyssIGEubmV4dD10aGlzLlBiLCB0aGlzLlBiPWEpO307ZnVuY3Rpb24gSSgpe3RoaXMubGM9dGhpcy5WYT1udWxsO312YXIgeGI9bmV3IHZiKGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB3Yn0sZnVuY3Rpb24oYSl7YS5yZXNldCgpO30pO0kucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuQWYoKTtjLnNldChhLGIpO3RoaXMubGM/dGhpcy5sYy5uZXh0PWM6dGhpcy5WYT1jO3RoaXMubGM9Yzt9O0kucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3ZhciBhPW51bGw7dGhpcy5WYSYmKGE9dGhpcy5WYSwgdGhpcy5WYT10aGlzLlZhLm5leHQsIHRoaXMuVmF8fCh0aGlzLmxjPW51bGwpLCBhLm5leHQ9bnVsbCk7cmV0dXJuIGF9O0kucHJvdG90eXBlLndnPWZ1bmN0aW9uKGEpe3hiLnB1dChhKTt9O0kucHJvdG90eXBlLkFmPWZ1bmN0aW9uKCl7cmV0dXJuIHhiLmdldCgpfTtmdW5jdGlvbiB3Yigpe3RoaXMubmV4dD10aGlzLnNjb3BlPXRoaXMuR2M9bnVsbDt9XG53Yi5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKGEsYil7dGhpcy5HYz1hO3RoaXMuc2NvcGU9Yjt0aGlzLm5leHQ9bnVsbDt9O3diLnByb3RvdHlwZS5yZXNldD1mdW5jdGlvbigpe3RoaXMubmV4dD10aGlzLnNjb3BlPXRoaXMuR2M9bnVsbDt9O2Z1bmN0aW9uIHliKGEpe2guc2V0VGltZW91dChmdW5jdGlvbigpe3Rocm93IGE7fSwwKTt9dmFyIHpiO1xuZnVuY3Rpb24gQWIoKXt2YXIgYT1oLk1lc3NhZ2VDaGFubmVsO1widW5kZWZpbmVkXCI9PT10eXBlb2YgYSYmXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiB3aW5kb3cmJndpbmRvdy5wb3N0TWVzc2FnZSYmd2luZG93LmFkZEV2ZW50TGlzdGVuZXImJiFCKFwiUHJlc3RvXCIpJiYoYT1mdW5jdGlvbigpe3ZhciBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJJRlJBTUVcIik7YS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO2Euc3JjPVwiXCI7ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGEpO3ZhciBiPWEuY29udGVudFdpbmRvdzthPWIuZG9jdW1lbnQ7YS5vcGVuKCk7YS53cml0ZShcIlwiKTthLmNsb3NlKCk7dmFyIGM9XCJjYWxsSW1tZWRpYXRlXCIrTWF0aC5yYW5kb20oKSxkPVwiZmlsZTpcIj09Yi5sb2NhdGlvbi5wcm90b2NvbD9cIipcIjpiLmxvY2F0aW9uLnByb3RvY29sK1wiLy9cIitiLmxvY2F0aW9uLmhvc3Q7YT11KGZ1bmN0aW9uKGEpe2lmKChcIipcIj09ZHx8YS5vcmlnaW49PWQpJiZhLmRhdGE9PVxuYyl0aGlzLnBvcnQxLm9ubWVzc2FnZSgpO30sdGhpcyk7Yi5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLGEsITEpO3RoaXMucG9ydDE9e307dGhpcy5wb3J0Mj17cG9zdE1lc3NhZ2U6ZnVuY3Rpb24oKXtiLnBvc3RNZXNzYWdlKGMsZCk7fX07fSk7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBhJiYhQihcIlRyaWRlbnRcIikmJiFCKFwiTVNJRVwiKSl7dmFyIGI9bmV3IGEsYz17fSxkPWM7Yi5wb3J0MS5vbm1lc3NhZ2U9ZnVuY3Rpb24oKXtpZih2b2lkIDAhPT1jLm5leHQpe2M9Yy5uZXh0O3ZhciBhPWMucmQ7Yy5yZD1udWxsO2EoKTt9fTtyZXR1cm4gZnVuY3Rpb24oYSl7ZC5uZXh0PXtyZDphfTtkPWQubmV4dDtiLnBvcnQyLnBvc3RNZXNzYWdlKDApO319cmV0dXJuXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBkb2N1bWVudCYmXCJvbnJlYWR5c3RhdGVjaGFuZ2VcImluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJTQ1JJUFRcIik/ZnVuY3Rpb24oYSl7dmFyIGI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIlNDUklQVFwiKTtcbmIub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7Yi5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDtiLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYik7Yj1udWxsO2EoKTthPW51bGw7fTtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoYik7fTpmdW5jdGlvbihhKXtoLnNldFRpbWVvdXQoYSwwKTt9fXZhciBCYjtmdW5jdGlvbiBDYigpe2lmKGguUHJvbWlzZSYmaC5Qcm9taXNlLnJlc29sdmUpe3ZhciBhPWguUHJvbWlzZS5yZXNvbHZlKHZvaWQgMCk7QmI9ZnVuY3Rpb24oKXthLnRoZW4oRGIpO307fWVsc2UgQmI9ZnVuY3Rpb24oKXt2YXIgYT1EYjshcShoLnNldEltbWVkaWF0ZSl8fGguV2luZG93JiZoLldpbmRvdy5wcm90b3R5cGUmJiFCKFwiRWRnZVwiKSYmaC5XaW5kb3cucHJvdG90eXBlLnNldEltbWVkaWF0ZT09aC5zZXRJbW1lZGlhdGU/KHpifHwoemI9QWIoKSksIHpiKGEpKTpoLnNldEltbWVkaWF0ZShhKTt9O312YXIgRWI9ITEsRmI9bmV3IEk7ZnVuY3Rpb24gRGIoKXtmb3IodmFyIGE7YT1GYi5yZW1vdmUoKTspe3RyeXthLkdjLmNhbGwoYS5zY29wZSk7fWNhdGNoKGIpe3liKGIpO31GYi53ZyhhKTt9RWI9ITE7fWZ1bmN0aW9uIEdiKGEsYil7SC5jYWxsKHRoaXMpO3RoaXMuTmE9YXx8MTt0aGlzLndiPWJ8fGg7dGhpcy5uZD11KHRoaXMuUmcsdGhpcyk7dGhpcy5pZT13KCk7fXgoR2IsSCk7ZT1HYi5wcm90b3R5cGU7ZS5lbmFibGVkPSExO2UuQj1udWxsO2Uuc2V0SW50ZXJ2YWw9ZnVuY3Rpb24oYSl7dGhpcy5OYT1hO3RoaXMuQiYmdGhpcy5lbmFibGVkPyh0aGlzLnN0b3AoKSwgdGhpcy5zdGFydCgpKTp0aGlzLkImJnRoaXMuc3RvcCgpO307ZS5SZz1mdW5jdGlvbigpe2lmKHRoaXMuZW5hYmxlZCl7dmFyIGE9dygpLXRoaXMuaWU7MDxhJiZhPC44KnRoaXMuTmE/dGhpcy5CPXRoaXMud2Iuc2V0VGltZW91dCh0aGlzLm5kLHRoaXMuTmEtYSk6KHRoaXMuQiYmKHRoaXMud2IuY2xlYXJUaW1lb3V0KHRoaXMuQiksIHRoaXMuQj1udWxsKSwgdGhpcy5mZigpLCB0aGlzLmVuYWJsZWQmJih0aGlzLnN0b3AoKSwgdGhpcy5zdGFydCgpKSk7fX07ZS5mZj1mdW5jdGlvbigpe3RoaXMuZGlzcGF0Y2hFdmVudChcInRpY2tcIik7fTtcbmUuc3RhcnQ9ZnVuY3Rpb24oKXt0aGlzLmVuYWJsZWQ9ITA7dGhpcy5CfHwodGhpcy5CPXRoaXMud2Iuc2V0VGltZW91dCh0aGlzLm5kLHRoaXMuTmEpLCB0aGlzLmllPXcoKSk7fTtlLnN0b3A9ZnVuY3Rpb24oKXt0aGlzLmVuYWJsZWQ9ITE7dGhpcy5CJiYodGhpcy53Yi5jbGVhclRpbWVvdXQodGhpcy5CKSwgdGhpcy5CPW51bGwpO307ZS5GPWZ1bmN0aW9uKCl7R2IuTC5GLmNhbGwodGhpcyk7dGhpcy5zdG9wKCk7ZGVsZXRlIHRoaXMud2I7fTtmdW5jdGlvbiBIYihhLGIsYyl7aWYocShhKSljJiYoYT11KGEsYykpO2Vsc2UgaWYoYSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5oYW5kbGVFdmVudClhPXUoYS5oYW5kbGVFdmVudCxhKTtlbHNlIHRocm93IEVycm9yKFwiSW52YWxpZCBsaXN0ZW5lciBhcmd1bWVudFwiKTtyZXR1cm4gMjE0NzQ4MzY0NzxOdW1iZXIoYik/LTE6aC5zZXRUaW1lb3V0KGEsYnx8MCl9ZnVuY3Rpb24gSWIoYSxiLGMpe3ouY2FsbCh0aGlzKTt0aGlzLlVmPW51bGwhPWM/dShhLGMpOmE7dGhpcy5OYT1iO3RoaXMuWGU9dSh0aGlzLmZnLHRoaXMpO3RoaXMucWM9W107fXgoSWIseik7ZT1JYi5wcm90b3R5cGU7ZS5UYT0hMTtlLm9iPTA7ZS5CPW51bGw7ZS5tZj1mdW5jdGlvbihhKXt0aGlzLnFjPWFyZ3VtZW50czt0aGlzLkJ8fHRoaXMub2I/dGhpcy5UYT0hMDp0aGlzLkNjKCk7fTtlLnN0b3A9ZnVuY3Rpb24oKXt0aGlzLkImJihoLmNsZWFyVGltZW91dCh0aGlzLkIpLCB0aGlzLkI9bnVsbCwgdGhpcy5UYT0hMSwgdGhpcy5xYz1bXSk7fTtlLnBhdXNlPWZ1bmN0aW9uKCl7dGhpcy5vYisrO307ZS5yZXN1bWU9ZnVuY3Rpb24oKXt0aGlzLm9iLS07dGhpcy5vYnx8IXRoaXMuVGF8fHRoaXMuQnx8KHRoaXMuVGE9ITEsIHRoaXMuQ2MoKSk7fTtlLkY9ZnVuY3Rpb24oKXtJYi5MLkYuY2FsbCh0aGlzKTt0aGlzLnN0b3AoKTt9O1xuZS5mZz1mdW5jdGlvbigpe3RoaXMuQj1udWxsO3RoaXMuVGEmJiF0aGlzLm9iJiYodGhpcy5UYT0hMSwgdGhpcy5DYygpKTt9O2UuQ2M9ZnVuY3Rpb24oKXt0aGlzLkI9SGIodGhpcy5YZSx0aGlzLk5hKTt0aGlzLlVmLmFwcGx5KG51bGwsdGhpcy5xYyk7fTtmdW5jdGlvbiBKYihhKXt6LmNhbGwodGhpcyk7dGhpcy5pPWE7dGhpcy5vPXt9O314KEpiLHopO3ZhciBLYj1bXTtlPUpiLnByb3RvdHlwZTtlLm5iPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLlRmKGEsYixjLGQpfTtlLlRmPWZ1bmN0aW9uKGEsYixjLGQpe24oYil8fChiJiYoS2JbMF09Yi50b1N0cmluZygpKSwgYj1LYik7Zm9yKHZhciBmPTA7ZjxiLmxlbmd0aDtmKyspe3ZhciBnPWliKGEsYltmXSxjfHx0aGlzLmhhbmRsZUV2ZW50LGR8fCExLHRoaXMuaXx8dGhpcyk7aWYoIWcpYnJlYWs7dGhpcy5vW2cua2V5XT1nO31yZXR1cm4gdGhpc307ZS5PYz1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5qZShhLGIsYyxkKX07XG5lLmplPWZ1bmN0aW9uKGEsYixjLGQsZil7aWYobihiKSlmb3IodmFyIGc9MDtnPGIubGVuZ3RoO2crKyl0aGlzLmplKGEsYltnXSxjLGQsZik7ZWxzZXthPWpiKGEsYixjfHx0aGlzLmhhbmRsZUV2ZW50LGQsZnx8dGhpcy5pfHx0aGlzKTtpZighYSlyZXR1cm4gdGhpczt0aGlzLm9bYS5rZXldPWE7fXJldHVybiB0aGlzfTtlLmVkPWZ1bmN0aW9uKGEsYixjLGQsZil7aWYobihiKSlmb3IodmFyIGc9MDtnPGIubGVuZ3RoO2crKyl0aGlzLmVkKGEsYltnXSxjLGQsZik7ZWxzZSBjPWN8fHRoaXMuaGFuZGxlRXZlbnQsIGQ9cihkKT8hIWQuY2FwdHVyZTohIWQsIGY9Znx8dGhpcy5pfHx0aGlzLCBjPWtiKGMpLCBkPSEhZCwgYj1GKGEpP2EuamIoYixjLGQsZik6YT8oYT1HKGEpKT9hLmpiKGIsYyxkLGYpOm51bGw6bnVsbCwgYiYmKHFiKGIpLCBkZWxldGUgdGhpcy5vW2Iua2V5XSk7fTtcbmUucGI9ZnVuY3Rpb24oKXtBYSh0aGlzLm8sZnVuY3Rpb24oYSxiKXt0aGlzLm8uaGFzT3duUHJvcGVydHkoYikmJnFiKGEpO30sdGhpcyk7dGhpcy5vPXt9O307ZS5GPWZ1bmN0aW9uKCl7SmIuTC5GLmNhbGwodGhpcyk7dGhpcy5wYigpO307ZS5oYW5kbGVFdmVudD1mdW5jdGlvbigpe3Rocm93IEVycm9yKFwiRXZlbnRIYW5kbGVyLmhhbmRsZUV2ZW50IG5vdCBpbXBsZW1lbnRlZFwiKTt9O2Z1bmN0aW9uIEooYSxiLGMpe3RoaXMucmVzZXQoYSxiLGMsdm9pZCAwLHZvaWQgMCk7fUoucHJvdG90eXBlLk1kPW51bGw7Si5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oYSxiLGMsZCxmKXt0aGlzLm1iPWE7ZGVsZXRlIHRoaXMuTWQ7fTtKLnByb3RvdHlwZS5CZz1mdW5jdGlvbihhKXt0aGlzLk1kPWE7fTtKLnByb3RvdHlwZS5HZT1mdW5jdGlvbihhKXt0aGlzLm1iPWE7fTtmdW5jdGlvbiBNYihhKXt0aGlzLnBlPWE7dGhpcy5aZD10aGlzLnVjPXRoaXMubWI9dGhpcy4kYj1udWxsO31mdW5jdGlvbiBLKGEsYil7dGhpcy5uYW1lPWE7dGhpcy52YWx1ZT1iO31LLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWV9O3ZhciBOYj1uZXcgSyhcIlNFVkVSRVwiLDFFMyksT2I9bmV3IEsoXCJXQVJOSU5HXCIsOTAwKSxQYj1uZXcgSyhcIklORk9cIiw4MDApLFFiPW5ldyBLKFwiQ09ORklHXCIsNzAwKSxSYj1uZXcgSyhcIkZJTkVcIiw1MDApO2U9TWIucHJvdG90eXBlO2UuZ2V0TmFtZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBlfTtlLmdldFBhcmVudD1mdW5jdGlvbigpe3JldHVybiB0aGlzLiRifTtlLnBmPWZ1bmN0aW9uKCl7dGhpcy51Y3x8KHRoaXMudWM9e30pO3JldHVybiB0aGlzLnVjfTtlLkdlPWZ1bmN0aW9uKGEpe3RoaXMubWI9YTt9O1xuZS5RZD1mdW5jdGlvbigpe2lmKHRoaXMubWIpcmV0dXJuIHRoaXMubWI7aWYodGhpcy4kYilyZXR1cm4gdGhpcy4kYi5RZCgpO2lhKFwiUm9vdCBsb2dnZXIgaGFzIG5vIGxldmVsIHNldC5cIik7cmV0dXJuIG51bGx9O2UuUGY9ZnVuY3Rpb24oYSl7cmV0dXJuIGEudmFsdWU+PXRoaXMuUWQoKS52YWx1ZX07ZS5sb2c9ZnVuY3Rpb24oYSxiLGMpe3RoaXMuUGYoYSkmJihxKGIpJiYoYj1iKCkpLCB0aGlzLmdmKHRoaXMudWYoYSxiLGMpKSk7fTtlLnVmPWZ1bmN0aW9uKGEsYixjKXthPW5ldyBKKGEsU3RyaW5nKGIpLHRoaXMucGUpO2MmJmEuQmcoYyk7cmV0dXJuIGF9O2UuY2E9ZnVuY3Rpb24oYSxiKXt0aGlzLmxvZyhOYixhLGIpO307ZS5UPWZ1bmN0aW9uKGEsYil7dGhpcy5sb2coT2IsYSxiKTt9O2UuaW5mbz1mdW5jdGlvbihhLGIpe3RoaXMubG9nKFBiLGEsYik7fTtlLmxmPWZ1bmN0aW9uKGEpe3RoaXMubG9nKFJiLGEsdm9pZCAwKTt9O1xuZS5nZj1mdW5jdGlvbihhKXtmb3IodmFyIGI9dGhpcztiOyliLldlKGEpLCBiPWIuZ2V0UGFyZW50KCk7fTtlLldlPWZ1bmN0aW9uKGEpe2lmKHRoaXMuWmQpZm9yKHZhciBiPTAsYztjPXRoaXMuWmRbYl07YisrKWMoYSk7fTtlLkZnPWZ1bmN0aW9uKGEpe3RoaXMuJGI9YTt9O2UuUWU9ZnVuY3Rpb24oYSxiKXt0aGlzLnBmKClbYV09Yjt9O3ZhciBTYj17fSxUYj1udWxsO2Z1bmN0aW9uIFZiKGEpe1RifHwoVGI9bmV3IE1iKFwiXCIpLCBTYltcIlwiXT1UYiwgVGIuR2UoUWIpKTt2YXIgYjtpZighKGI9U2JbYV0pKXtiPW5ldyBNYihhKTt2YXIgYz1hLmxhc3RJbmRleE9mKFwiLlwiKSxkPWEuc3Vic3RyKGMrMSk7Yz1WYihhLnN1YnN0cigwLGMpKTtjLlFlKGQsYik7Yi5GZyhjKTtTYlthXT1iO31yZXR1cm4gYn1mdW5jdGlvbiBXYihhLGIpe2EmJmEuaW5mbyhiLHZvaWQgMCk7fWZ1bmN0aW9uIEwoYSxiKXthJiZhLmxmKGIpO31mdW5jdGlvbiBYYigpe3RoaXMucz1WYihcImdvb2cubGFicy5uZXQud2ViQ2hhbm5lbC5XZWJDaGFubmVsRGVidWdcIik7dGhpcy5XYz0hMDt9ZT1YYi5wcm90b3R5cGU7ZS5JZD1mdW5jdGlvbigpe3RoaXMuV2M9ITE7fTtlLlRnPWZ1bmN0aW9uKGEsYixjLGQsZil7dmFyIGc9dGhpczt0aGlzLmluZm8oZnVuY3Rpb24oKXtyZXR1cm5cIlhNTEhUVFAgUkVRIChcIitjK1wiKSBbYXR0ZW1wdCBcIitkK1wiXTogXCIrYStcIlxcblwiK2IrXCJcXG5cIitnLlhmKGYpfSk7fTtlLlVnPWZ1bmN0aW9uKGEsYixjLGQsZixnKXt0aGlzLmluZm8oZnVuY3Rpb24oKXtyZXR1cm5cIlhNTEhUVFAgUkVTUCAoXCIrYytcIikgWyBhdHRlbXB0IFwiK2QrXCJdOiBcIithK1wiXFxuXCIrYitcIlxcblwiK2YrXCIgXCIrZ30pO307ZS5XYT1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpczt0aGlzLmluZm8oZnVuY3Rpb24oKXtyZXR1cm5cIlhNTEhUVFAgVEVYVCAoXCIrYStcIik6IFwiK2QubmcoYikrKGM/XCIgXCIrYzpcIlwiKX0pO307XG5lLlNnPWZ1bmN0aW9uKGEpe3RoaXMuaW5mbyhmdW5jdGlvbigpe3JldHVyblwiVElNRU9VVDogXCIrYX0pO307ZS5kZWJ1Zz1mdW5jdGlvbihhKXtMKHRoaXMucyxhKTt9O2UuY2I9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnM7YyYmYy5jYShifHxcIkV4Y2VwdGlvblwiLGEpO307ZS5pbmZvPWZ1bmN0aW9uKGEpe1diKHRoaXMucyxhKTt9O2UuVD1mdW5jdGlvbihhKXt2YXIgYj10aGlzLnM7YiYmYi5UKGEsdm9pZCAwKTt9O2UuY2E9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5zO2ImJmIuY2EoYSx2b2lkIDApO307XG5lLm5nPWZ1bmN0aW9uKGEpe2lmKCF0aGlzLldjKXJldHVybiBhO2lmKCFhKXJldHVybiBudWxsO3RyeXt2YXIgYj1KU09OLnBhcnNlKGEpO2lmKGIpZm9yKHZhciBjPTA7YzxiLmxlbmd0aDtjKyspbihiW2NdKSYmdGhpcy5XZihiW2NdKTtyZXR1cm4gdWIoYil9Y2F0Y2goZCl7cmV0dXJuIHRoaXMuZGVidWcoXCJFeGNlcHRpb24gcGFyc2luZyBleHBlY3RlZCBKUyBhcnJheSAtIHByb2JhYmx5IHdhcyBub3QgSlNcIiksIGF9fTtlLldmPWZ1bmN0aW9uKGEpe2lmKCEoMj5hLmxlbmd0aHx8KGE9YVsxXSwgIW4oYSl8fDE+YS5sZW5ndGgpKSl7dmFyIGI9YVswXTtpZihcIm5vb3BcIiE9YiYmXCJzdG9wXCIhPWImJlwiY2xvc2VcIiE9Yilmb3IoYj0xO2I8YS5sZW5ndGg7YisrKWFbYl09XCJcIjt9fTtcbmUuWGY9ZnVuY3Rpb24oYSl7aWYoIXRoaXMuV2MpcmV0dXJuIGE7aWYoIWEpcmV0dXJuIG51bGw7dmFyIGI9XCJcIjthPWEuc3BsaXQoXCImXCIpO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKXt2YXIgZD1hW2NdLnNwbGl0KFwiPVwiKTtpZigxPGQubGVuZ3RoKXt2YXIgZj1kWzBdO2Q9ZFsxXTt2YXIgZz1mLnNwbGl0KFwiX1wiKTtiPTI8PWcubGVuZ3RoJiZcInR5cGVcIj09Z1sxXT9iKyhmK1wiPVwiK2QrXCImXCIpOmIrKGYrXCI9cmVkYWN0ZWQmXCIpO319cmV0dXJuIGJ9O3ZhciBNPW5ldyBIO2Z1bmN0aW9uIFliKGEpe0QuY2FsbCh0aGlzLFwic2VydmVycmVhY2hhYmlsaXR5XCIsYSk7fXgoWWIsRCk7ZnVuY3Rpb24gTihhKXtNLmRpc3BhdGNoRXZlbnQobmV3IFliKE0sYSkpO31mdW5jdGlvbiBaYihhLGIpe0QuY2FsbCh0aGlzLFwic3RhdGV2ZW50XCIsYSk7dGhpcy5zdGF0PWI7fXgoWmIsRCk7ZnVuY3Rpb24gTyhhKXtNLmRpc3BhdGNoRXZlbnQobmV3IFpiKE0sYSkpO31mdW5jdGlvbiAkYihhLGIsYyl7RC5jYWxsKHRoaXMsXCJ0aW1pbmdldmVudFwiLGEpO3RoaXMuc2l6ZT1iO3RoaXMucnR0PWM7fXgoJGIsRCk7ZnVuY3Rpb24gYWMoYSxiLGMpe00uZGlzcGF0Y2hFdmVudChuZXcgJGIoTSxhLGIsYykpO31mdW5jdGlvbiBQKGEsYil7aWYoIXEoYSkpdGhyb3cgRXJyb3IoXCJGbiBtdXN0IG5vdCBiZSBudWxsIGFuZCBtdXN0IGJlIGEgZnVuY3Rpb25cIik7cmV0dXJuIGguc2V0VGltZW91dChmdW5jdGlvbigpe2EoKTt9LGIpfXZhciBiYz17Tk9fRVJST1I6MCxWZzoxLGJoOjIsYWg6MyxZZzo0LCRnOjUsZGg6NixOZTo3LFRJTUVPVVQ6OCxnaDo5fTt2YXIgY2M9e1hnOlwiY29tcGxldGVcIixraDpcInN1Y2Nlc3NcIixPZTpcImVycm9yXCIsTmU6XCJhYm9ydFwiLGloOlwicmVhZHlcIixqaDpcInJlYWR5c3RhdGVjaGFuZ2VcIixUSU1FT1VUOlwidGltZW91dFwiLGVoOlwiaW5jcmVtZW50YWxkYXRhXCIsaGg6XCJwcm9ncmVzc1wiLFpnOlwiZG93bmxvYWRwcm9ncmVzc1wiLGxoOlwidXBsb2FkcHJvZ3Jlc3NcIn07ZnVuY3Rpb24gZGMoKXt9ZGMucHJvdG90eXBlLnBkPW51bGw7ZGMucHJvdG90eXBlLlZkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGR8fCh0aGlzLnBkPXRoaXMuTWYoKSl9O2Z1bmN0aW9uIGVjKCl7fXZhciBRPXtPUEVOOlwiYVwiLFdnOlwiYlwiLE9lOlwiY1wiLGZoOlwiZFwifTtmdW5jdGlvbiBmYygpe0QuY2FsbCh0aGlzLFwiZFwiKTt9eChmYyxEKTtmdW5jdGlvbiBnYygpe0QuY2FsbCh0aGlzLFwiY1wiKTt9eChnYyxEKTt2YXIgaGM7ZnVuY3Rpb24gaWMoKXt9eChpYyxkYyk7aWMucHJvdG90eXBlLkRkPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5XZCgpO3JldHVybiBhP25ldyBBY3RpdmVYT2JqZWN0KGEpOm5ldyBYTUxIdHRwUmVxdWVzdH07aWMucHJvdG90eXBlLk1mPWZ1bmN0aW9uKCl7dmFyIGE9e307dGhpcy5XZCgpJiYoYVswXT0hMCwgYVsxXT0hMCk7cmV0dXJuIGF9O1xuaWMucHJvdG90eXBlLldkPWZ1bmN0aW9uKCl7aWYoIXRoaXMuYmUmJlwidW5kZWZpbmVkXCI9PXR5cGVvZiBYTUxIdHRwUmVxdWVzdCYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIEFjdGl2ZVhPYmplY3Qpe2Zvcih2YXIgYT1bXCJNU1hNTDIuWE1MSFRUUC42LjBcIixcIk1TWE1MMi5YTUxIVFRQLjMuMFwiLFwiTVNYTUwyLlhNTEhUVFBcIixcIk1pY3Jvc29mdC5YTUxIVFRQXCJdLGI9MDtiPGEubGVuZ3RoO2IrKyl7dmFyIGM9YVtiXTt0cnl7cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KGMpLCB0aGlzLmJlPWN9Y2F0Y2goZCl7fX10aHJvdyBFcnJvcihcIkNvdWxkIG5vdCBjcmVhdGUgQWN0aXZlWE9iamVjdC4gQWN0aXZlWCBtaWdodCBiZSBkaXNhYmxlZCwgb3IgTVNYTUwgbWlnaHQgbm90IGJlIGluc3RhbGxlZFwiKTt9cmV0dXJuIHRoaXMuYmV9O2hjPW5ldyBpYztmdW5jdGlvbiBSKGEsYixjLGQsZil7dGhpcy5iPWE7dGhpcy5hPWI7dGhpcy5yYT1jO3RoaXMuUj1kO3RoaXMuWGM9Znx8MTt0aGlzLkZjPW5ldyBKYih0aGlzKTt0aGlzLlVhPWpjO2E9TGE/MTI1OnZvaWQgMDt0aGlzLlZjPW5ldyBHYihhKTt0aGlzLkE9bnVsbDt0aGlzLlM9ITE7dGhpcy5EYT10aGlzLnBhPXRoaXMudWE9dGhpcy5pYz10aGlzLnFiPXRoaXMuaGQ9dGhpcy5HYT1udWxsO3RoaXMuYmE9W107dGhpcy5oPW51bGw7dGhpcy5CYj0wO3RoaXMuST10aGlzLkZhPW51bGw7dGhpcy53PS0xO3RoaXMuWmE9ITE7dGhpcy5SYT0wO3RoaXMuYWM9bnVsbDt0aGlzLmxiPXRoaXMuRWQ9dGhpcy55Yz0hMTt9dmFyIGpjPTQ1RTM7XG5mdW5jdGlvbiBrYyhhLGIpe3N3aXRjaChhKXtjYXNlIDA6cmV0dXJuXCJOb24tMjAwIHJldHVybiBjb2RlIChcIitiK1wiKVwiO2Nhc2UgMTpyZXR1cm5cIlhNTEhUVFAgZmFpbHVyZSAobm8gZGF0YSlcIjtjYXNlIDI6cmV0dXJuXCJIdHRwQ29ubmVjdGlvbiB0aW1lb3V0XCI7ZGVmYXVsdDpyZXR1cm5cIlVua25vd24gZXJyb3JcIn19dmFyIGxjPXt9LG1jPXt9O2U9Ui5wcm90b3R5cGU7ZS5nYT1mdW5jdGlvbihhKXt0aGlzLkE9YTt9O2Uuc2V0VGltZW91dD1mdW5jdGlvbihhKXt0aGlzLlVhPWE7fTtlLkhlPWZ1bmN0aW9uKGEpe3RoaXMuUmE9YTt9O2UuR2c9ZnVuY3Rpb24oYSl7dGhpcy5iYT1hO307ZS5sYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJhfTtlLmtkPWZ1bmN0aW9uKGEsYil7dGhpcy5pYz0xO3RoaXMudWE9YS5jbG9uZSgpLlViKCk7dGhpcy5EYT1iO3RoaXMueWM9ITA7dGhpcy5DZShudWxsKTt9O1xuZS5qZD1mdW5jdGlvbihhLGIsYyl7dGhpcy5pYz0xO3RoaXMudWE9YS5jbG9uZSgpLlViKCk7dGhpcy5EYT1udWxsO3RoaXMueWM9Yjt0aGlzLkNlKGMpO307XG5lLkNlPWZ1bmN0aW9uKGEpe3RoaXMucWI9dygpO3RoaXMuZWIoKTt0aGlzLnBhPXRoaXMudWEuY2xvbmUoKTt0aGlzLnBhLmRjKFwidFwiLHRoaXMuWGMpO3RoaXMuQmI9MDt0aGlzLmg9dGhpcy5iLkpiKHRoaXMuYi5mYygpP2E6bnVsbCk7MDx0aGlzLlJhJiYodGhpcy5hYz1uZXcgSWIodSh0aGlzLk1lLHRoaXMsdGhpcy5oKSx0aGlzLlJhKSk7dGhpcy5GYy5uYih0aGlzLmgsXCJyZWFkeXN0YXRlY2hhbmdlXCIsdGhpcy5tZyk7YT10aGlzLkE/RGEodGhpcy5BKTp7fTt0aGlzLkRhPyh0aGlzLkZhfHwodGhpcy5GYT1cIlBPU1RcIiksIGFbXCJDb250ZW50LVR5cGVcIl09XCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIiwgdGhpcy5oLnNlbmQodGhpcy5wYSx0aGlzLkZhLHRoaXMuRGEsYSkpOih0aGlzLkZhPVwiR0VUXCIsIHRoaXMuaC5zZW5kKHRoaXMucGEsdGhpcy5GYSxudWxsLGEpKTtOKDEpO3RoaXMuYS5UZyh0aGlzLkZhLHRoaXMucGEsdGhpcy5SLHRoaXMuWGMsdGhpcy5EYSk7fTtcbmUubWc9ZnVuY3Rpb24oYSl7YT1hLnRhcmdldDt2YXIgYj10aGlzLmFjO2ImJjM9PWEubWEoKT8odGhpcy5hLmRlYnVnKFwiVGhyb3R0bGluZyByZWFkeXN0YXRlY2hhbmdlLlwiKSwgYi5tZigpKTp0aGlzLk1lKGEpO307ZS5NZT1mdW5jdGlvbihhKXt0cnl7YT09dGhpcy5oP3RoaXMuaGcoKTp0aGlzLmEuVChcIkNhbGxlZCBiYWNrIHdpdGggYW4gdW5leHBlY3RlZCB4bWxodHRwXCIpO31jYXRjaChjKXtpZih0aGlzLmEuZGVidWcoXCJGYWlsZWQgY2FsbCB0byBPblhtbEh0dHBSZWFkeVN0YXRlQ2hhbmdlZF9cIiksIHRoaXMuaCYmdGhpcy5oLnlhKCkpe3ZhciBiPXRoaXM7dGhpcy5hLmNiKGMsZnVuY3Rpb24oKXtyZXR1cm5cIlJlc3BvbnNlVGV4dDogXCIrYi5oLnlhKCl9KTt9ZWxzZSB0aGlzLmEuY2IoYyxcIk5vIHJlc3BvbnNlIHRleHRcIik7fWZpbmFsbHl7fX07XG5lLmhnPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5oLm1hKCksYj10aGlzLmguVWQoKSxjPXRoaXMuaC56YSgpO2lmKCEoMz5hfHwzPT1hJiYhTGEmJiF0aGlzLmgueWEoKSkpe3RoaXMuWmF8fDQhPWF8fDc9PWJ8fCg4PT1ifHwwPj1jP04oMyk6TigyKSk7dGhpcy5GYigpO3ZhciBkPXRoaXMuaC56YSgpO3RoaXMudz1kO2I9dGhpcy5oLnlhKCk7aWYoIWIpe3ZhciBmPXRoaXM7dGhpcy5hLmRlYnVnKGZ1bmN0aW9uKCl7cmV0dXJuXCJObyByZXNwb25zZSB0ZXh0IGZvciB1cmkgXCIrZi5wYStcIiBzdGF0dXMgXCIrZH0pO310aGlzLlM9MjAwPT1kO3RoaXMuYS5VZyh0aGlzLkZhLHRoaXMucGEsdGhpcy5SLHRoaXMuWGMsYSxkKTtpZih0aGlzLlMpe2lmKHRoaXMuSWcoKSlpZihjPXRoaXMuc2YoKSl0aGlzLmEuV2EodGhpcy5SLGMsXCJJbml0aWFsIGhhbmRzaGFrZSByZXNwb25zZSB2aWEgWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIiksIHRoaXMubGI9ITAsIHRoaXMuWWMoYyk7ZWxzZXt0aGlzLlM9ITE7XG50aGlzLkk9MztPKDEyKTt0aGlzLmEuVChcIlhNTEhUVFAgTWlzc2luZyBYX0hUVFBfSU5JVElBTF9SRVNQT05TRSAoXCIrdGhpcy5SK1wiKVwiKTt0aGlzLklhKCk7dGhpcy5LYigpO3JldHVybn10aGlzLnljPyh0aGlzLkZkKGEsYiksIExhJiZ0aGlzLlMmJjM9PWEmJnRoaXMuTmcoKSk6KHRoaXMuYS5XYSh0aGlzLlIsYixudWxsKSwgdGhpcy5ZYyhiKSk7ND09YSYmdGhpcy5JYSgpO3RoaXMuUyYmIXRoaXMuWmEmJig0PT1hP3RoaXMuYi5UYyh0aGlzKToodGhpcy5TPSExLCB0aGlzLmViKCkpKTt9ZWxzZSA0MDA9PWQmJjA8Yi5pbmRleE9mKFwiVW5rbm93biBTSURcIik/KHRoaXMuST0zLCBPKDEyKSwgdGhpcy5hLlQoXCJYTUxIVFRQIFVua25vd24gU0lEIChcIit0aGlzLlIrXCIpXCIpKToodGhpcy5JPTAsIE8oMTMpLCB0aGlzLmEuVChcIlhNTEhUVFAgQmFkIHN0YXR1cyBcIitkK1wiIChcIit0aGlzLlIrXCIpXCIpKSwgdGhpcy5JYSgpLCB0aGlzLktiKCk7fX07ZS5JZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLkVkJiYhdGhpcy5sYn07XG5lLnNmPWZ1bmN0aW9uKCl7aWYodGhpcy5oKXt2YXIgYT10aGlzLmgua2IoXCJYLUhUVFAtSW5pdGlhbC1SZXNwb25zZVwiKTtpZihhJiYhdmEoYSkpcmV0dXJuIGF9cmV0dXJuIG51bGx9O2UuQWc9ZnVuY3Rpb24oKXt0aGlzLkVkPSEwO307XG5lLkZkPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPSEwOyF0aGlzLlphJiZ0aGlzLkJiPGIubGVuZ3RoOyl7dmFyIGQ9dGhpcy52ZihiKTtpZihkPT1tYyl7ND09YSYmKHRoaXMuST00LCBPKDE0KSwgYz0hMSk7dGhpcy5hLldhKHRoaXMuUixudWxsLFwiW0luY29tcGxldGUgUmVzcG9uc2VdXCIpO2JyZWFrfWVsc2UgaWYoZD09bGMpe3RoaXMuST00O08oMTUpO3RoaXMuYS5XYSh0aGlzLlIsYixcIltJbnZhbGlkIENodW5rXVwiKTtjPSExO2JyZWFrfWVsc2UgdGhpcy5hLldhKHRoaXMuUixkLG51bGwpLCB0aGlzLlljKGQpO300PT1hJiYwPT1iLmxlbmd0aCYmKHRoaXMuST0xLCBPKDE2KSwgYz0hMSk7dGhpcy5TPXRoaXMuUyYmYztjfHwodGhpcy5hLldhKHRoaXMuUixiLFwiW0ludmFsaWQgQ2h1bmtlZCBSZXNwb25zZV1cIiksIHRoaXMuSWEoKSwgdGhpcy5LYigpKTt9O1xuZS5rZz1mdW5jdGlvbigpe2lmKHRoaXMuaCl7dmFyIGE9dGhpcy5oLm1hKCksYj10aGlzLmgueWEoKTt0aGlzLkJiPGIubGVuZ3RoJiYodGhpcy5GYigpLCB0aGlzLkZkKGEsYiksIHRoaXMuUyYmNCE9YSYmdGhpcy5lYigpKTt9fTtlLk5nPWZ1bmN0aW9uKCl7dGhpcy5GYy5uYih0aGlzLlZjLFwidGlja1wiLHRoaXMua2cpO3RoaXMuVmMuc3RhcnQoKTt9O2UudmY9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5CYixjPWEuaW5kZXhPZihcIlxcblwiLGIpO2lmKC0xPT1jKXJldHVybiBtYztiPU51bWJlcihhLnN1YnN0cmluZyhiLGMpKTtpZihpc05hTihiKSlyZXR1cm4gbGM7Yys9MTtpZihjK2I+YS5sZW5ndGgpcmV0dXJuIG1jO2E9YS5zdWJzdHIoYyxiKTt0aGlzLkJiPWMrYjtyZXR1cm4gYX07XG5lLnlnPWZ1bmN0aW9uKGEpe3RoaXMuaWM9Mjt0aGlzLnVhPWEuY2xvbmUoKS5VYigpO2E9ITE7aC5uYXZpZ2F0b3ImJmgubmF2aWdhdG9yLnNlbmRCZWFjb24mJihhPWgubmF2aWdhdG9yLnNlbmRCZWFjb24odGhpcy51YS50b1N0cmluZygpLFwiXCIpKTshYSYmaC5JbWFnZSYmKChuZXcgSW1hZ2UpLnNyYz10aGlzLnVhLCBhPSEwKTthfHwodGhpcy5oPXRoaXMuYi5KYihudWxsKSwgdGhpcy5oLnNlbmQodGhpcy51YSkpO3RoaXMucWI9dygpO3RoaXMuZWIoKTt9O2UuY2FuY2VsPWZ1bmN0aW9uKCl7dGhpcy5aYT0hMDt0aGlzLklhKCk7fTtlLnRnPWZ1bmN0aW9uKGEpe2EmJnRoaXMuc2V0VGltZW91dChhKTt0aGlzLkdhJiYodGhpcy5GYigpLCB0aGlzLmViKCkpO307ZS5lYj1mdW5jdGlvbigpe3RoaXMuaGQ9dygpK3RoaXMuVWE7dGhpcy5LZSh0aGlzLlVhKTt9O1xuZS5LZT1mdW5jdGlvbihhKXtpZihudWxsIT10aGlzLkdhKXRocm93IEVycm9yKFwiV2F0Y2hEb2cgdGltZXIgbm90IG51bGxcIik7dGhpcy5HYT1QKHUodGhpcy5nZyx0aGlzKSxhKTt9O2UuRmI9ZnVuY3Rpb24oKXt0aGlzLkdhJiYoaC5jbGVhclRpbWVvdXQodGhpcy5HYSksIHRoaXMuR2E9bnVsbCk7fTtlLmdnPWZ1bmN0aW9uKCl7dGhpcy5HYT1udWxsO3ZhciBhPXcoKTswPD1hLXRoaXMuaGQ/dGhpcy5EZigpOih0aGlzLmEuVChcIldhdGNoRG9nIHRpbWVyIGNhbGxlZCB0b28gZWFybHlcIiksIHRoaXMuS2UodGhpcy5oZC1hKSk7fTtlLkRmPWZ1bmN0aW9uKCl7dGhpcy5TJiZ0aGlzLmEuY2EoXCJSZWNlaXZlZCB3YXRjaGRvZyB0aW1lb3V0IGV2ZW4gdGhvdWdoIHJlcXVlc3QgbG9hZGVkIHN1Y2Nlc3NmdWxseVwiKTt0aGlzLmEuU2codGhpcy5wYSk7MiE9dGhpcy5pYyYmKE4oMyksIE8oMTcpKTt0aGlzLklhKCk7dGhpcy5JPTI7dGhpcy5LYigpO307XG5lLktiPWZ1bmN0aW9uKCl7dGhpcy5iLmRlKCl8fHRoaXMuWmF8fHRoaXMuYi5UYyh0aGlzKTt9O2UuSWE9ZnVuY3Rpb24oKXt0aGlzLkZiKCk7dmFyIGE9dGhpcy5hYzthJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLmJiJiZhLmJiKCk7dGhpcy5hYz1udWxsO3RoaXMuVmMuc3RvcCgpO3RoaXMuRmMucGIoKTt0aGlzLmgmJihhPXRoaXMuaCwgdGhpcy5oPW51bGwsIGEuYWJvcnQoKSwgYS5iYigpKTt9O2UuSGM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5JfTtlLlljPWZ1bmN0aW9uKGEpe3RyeXt0aGlzLmIudWUodGhpcyxhKSwgTig0KTt9Y2F0Y2goYil7dGhpcy5hLmNiKGIsXCJFcnJvciBpbiBodHRwcmVxdWVzdCBjYWxsYmFja1wiKTt9fTtmdW5jdGlvbiBuYyhhKXtpZihhLkgmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuSClyZXR1cm4gYS5IKCk7aWYobChhKSlyZXR1cm4gYS5zcGxpdChcIlwiKTtpZihjYShhKSl7Zm9yKHZhciBiPVtdLGM9YS5sZW5ndGgsZD0wO2Q8YztkKyspYi5wdXNoKGFbZF0pO3JldHVybiBifXJldHVybiBCYShhKX1cbmZ1bmN0aW9uIG9jKGEsYixjKXtpZihhLmZvckVhY2gmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuZm9yRWFjaClhLmZvckVhY2goYixjKTtlbHNlIGlmKGNhKGEpfHxsKGEpKW5hKGEsYixjKTtlbHNle2lmKGEuVyYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5XKXZhciBkPWEuVygpO2Vsc2UgaWYoYS5IJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLkgpZD12b2lkIDA7ZWxzZSBpZihjYShhKXx8bChhKSl7ZD1bXTtmb3IodmFyIGY9YS5sZW5ndGgsZz0wO2c8ZjtnKyspZC5wdXNoKGcpO31lbHNlIGQ9Q2EoYSk7Zj1uYyhhKTtnPWYubGVuZ3RoO2Zvcih2YXIgaz0wO2s8ZztrKyspYi5jYWxsKGMsZltrXSxkJiZkW2tdLGEpO319ZnVuY3Rpb24gUyhhLGIpe3RoaXMuRD17fTt0aGlzLm89W107dGhpcy5qPTA7dmFyIGM9YXJndW1lbnRzLmxlbmd0aDtpZigxPGMpe2lmKGMlMil0aHJvdyBFcnJvcihcIlVuZXZlbiBudW1iZXIgb2YgYXJndW1lbnRzXCIpO2Zvcih2YXIgZD0wO2Q8YztkKz0yKXRoaXMuc2V0KGFyZ3VtZW50c1tkXSxhcmd1bWVudHNbZCsxXSk7fWVsc2UgYSYmdGhpcy5hZGRBbGwoYSk7fWU9Uy5wcm90b3R5cGU7ZS5DPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuan07ZS5IPWZ1bmN0aW9uKCl7dGhpcy53YygpO2Zvcih2YXIgYT1bXSxiPTA7Yjx0aGlzLm8ubGVuZ3RoO2IrKylhLnB1c2godGhpcy5EW3RoaXMub1tiXV0pO3JldHVybiBhfTtlLlc9ZnVuY3Rpb24oKXt0aGlzLndjKCk7cmV0dXJuIHRoaXMuby5jb25jYXQoKX07ZS52YT1mdW5jdGlvbihhKXtyZXR1cm4gVCh0aGlzLkQsYSl9O2UuWD1mdW5jdGlvbigpe3JldHVybiAwPT10aGlzLmp9O1xuZS5jbGVhcj1mdW5jdGlvbigpe3RoaXMuRD17fTt0aGlzLmo9dGhpcy5vLmxlbmd0aD0wO307ZS5yZW1vdmU9ZnVuY3Rpb24oYSl7cmV0dXJuIFQodGhpcy5ELGEpPyhkZWxldGUgdGhpcy5EW2FdLCB0aGlzLmotLSwgdGhpcy5vLmxlbmd0aD4yKnRoaXMuaiYmdGhpcy53YygpLCAhMCk6ITF9O2Uud2M9ZnVuY3Rpb24oKXtpZih0aGlzLmohPXRoaXMuby5sZW5ndGgpe2Zvcih2YXIgYT0wLGI9MDthPHRoaXMuby5sZW5ndGg7KXt2YXIgYz10aGlzLm9bYV07VCh0aGlzLkQsYykmJih0aGlzLm9bYisrXT1jKTthKys7fXRoaXMuby5sZW5ndGg9Yjt9aWYodGhpcy5qIT10aGlzLm8ubGVuZ3RoKXt2YXIgZD17fTtmb3IoYj1hPTA7YTx0aGlzLm8ubGVuZ3RoOyljPXRoaXMub1thXSwgVChkLGMpfHwodGhpcy5vW2IrK109YywgZFtjXT0xKSwgYSsrO3RoaXMuby5sZW5ndGg9Yjt9fTtlLmdldD1mdW5jdGlvbihhLGIpe3JldHVybiBUKHRoaXMuRCxhKT90aGlzLkRbYV06Yn07XG5lLnNldD1mdW5jdGlvbihhLGIpe1QodGhpcy5ELGEpfHwodGhpcy5qKyssIHRoaXMuby5wdXNoKGEpKTt0aGlzLkRbYV09Yjt9O2UuYWRkQWxsPWZ1bmN0aW9uKGEpe2lmKGEgaW5zdGFuY2VvZiBTKWZvcih2YXIgYj1hLlcoKSxjPTA7YzxiLmxlbmd0aDtjKyspdGhpcy5zZXQoYltjXSxhLmdldChiW2NdKSk7ZWxzZSBmb3IoYiBpbiBhKXRoaXMuc2V0KGIsYVtiXSk7fTtlLmZvckVhY2g9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9dGhpcy5XKCksZD0wO2Q8Yy5sZW5ndGg7ZCsrKXt2YXIgZj1jW2RdLGc9dGhpcy5nZXQoZik7YS5jYWxsKGIsZyxmLHRoaXMpO319O2UuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFModGhpcyl9O2Z1bmN0aW9uIFQoYSxiKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGEsYil9dmFyIHBjPS9eKD86KFteOi8/Iy5dKyk6KT8oPzpcXC9cXC8oPzooW14vPyNdKilAKT8oW14vIz9dKj8pKD86OihbMC05XSspKT8oPz1bLyM/XXwkKSk/KFtePyNdKyk/KD86XFw/KFteI10qKSk/KD86IyhbXFxzXFxTXSopKT8kLztmdW5jdGlvbiBxYyhhLGIpe2lmKGEpe2E9YS5zcGxpdChcIiZcIik7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10uaW5kZXhPZihcIj1cIiksZj1udWxsO2lmKDA8PWQpe3ZhciBnPWFbY10uc3Vic3RyaW5nKDAsZCk7Zj1hW2NdLnN1YnN0cmluZyhkKzEpO31lbHNlIGc9YVtjXTtiKGcsZj9kZWNvZGVVUklDb21wb25lbnQoZi5yZXBsYWNlKC9cXCsvZyxcIiBcIikpOlwiXCIpO319fWZ1bmN0aW9uIFUoYSxiKXt0aGlzLnhhPXRoaXMuemI9dGhpcy5xYT1cIlwiO3RoaXMuQ2E9bnVsbDt0aGlzLmliPXRoaXMuSz1cIlwiO3RoaXMuTz10aGlzLlFmPSExO3ZhciBjO2EgaW5zdGFuY2VvZiBVPyh0aGlzLk89dm9pZCAwIT09Yj9iOmEuTywgdGhpcy50YihhLnFhKSwgdGhpcy5jZChhLnpiKSwgdGhpcy5yYihhLnhhKSwgdGhpcy5zYihhLkNhKSwgdGhpcy5lYyhhLkspLCB0aGlzLmJkKGEuUC5jbG9uZSgpKSwgdGhpcy4kYyhhLmliKSk6YSYmKGM9U3RyaW5nKGEpLm1hdGNoKHBjKSk/KHRoaXMuTz0hIWIsIHRoaXMudGIoY1sxXXx8XCJcIiwhMCksIHRoaXMuY2QoY1syXXx8XCJcIiwhMCksIHRoaXMucmIoY1szXXx8XCJcIiwhMCksIHRoaXMuc2IoY1s0XSksIHRoaXMuZWMoY1s1XXx8XCJcIiwhMCksIHRoaXMuYmQoY1s2XXx8XCJcIiwhMCksIHRoaXMuJGMoY1s3XXx8XCJcIiwhMCkpOih0aGlzLk89ISFiLCB0aGlzLlA9bmV3IHJjKG51bGwsdGhpcy5PKSk7fWU9VS5wcm90b3R5cGU7XG5lLnRvU3RyaW5nPWZ1bmN0aW9uKCl7dmFyIGE9W10sYj10aGlzLnFhO2ImJmEucHVzaChzYyhiLHRjLCEwKSxcIjpcIik7dmFyIGM9dGhpcy54YTtpZihjfHxcImZpbGVcIj09YilhLnB1c2goXCIvL1wiKSwgKGI9dGhpcy56YikmJmEucHVzaChzYyhiLHRjLCEwKSxcIkBcIiksIGEucHVzaChlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGMpKS5yZXBsYWNlKC8lMjUoWzAtOWEtZkEtRl17Mn0pL2csXCIlJDFcIikpLCBjPXRoaXMuQ2EsIG51bGwhPWMmJmEucHVzaChcIjpcIixTdHJpbmcoYykpO2lmKGM9dGhpcy5LKXRoaXMuSWMoKSYmXCIvXCIhPWMuY2hhckF0KDApJiZhLnB1c2goXCIvXCIpLCBhLnB1c2goc2MoYyxcIi9cIj09Yy5jaGFyQXQoMCk/dWM6d2MsITApKTsoYz10aGlzLlJkKCkpJiZhLnB1c2goXCI/XCIsYyk7KGM9dGhpcy5pYikmJmEucHVzaChcIiNcIixzYyhjLHhjKSk7cmV0dXJuIGEuam9pbihcIlwiKX07XG5lLnJlc29sdmU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5jbG9uZSgpLGM9YS5IZigpO2M/Yi50YihhLnFhKTpjPWEuSWYoKTtjP2IuY2QoYS56Yik6Yz1hLkljKCk7Yz9iLnJiKGEueGEpOmM9YS5GZigpO3ZhciBkPWEuSztpZihjKWIuc2IoYS5DYSk7ZWxzZSBpZihjPWEuYWUoKSl7aWYoXCIvXCIhPWQuY2hhckF0KDApKWlmKHRoaXMuSWMoKSYmIXRoaXMuYWUoKSlkPVwiL1wiK2Q7ZWxzZXt2YXIgZj1iLksubGFzdEluZGV4T2YoXCIvXCIpOy0xIT1mJiYoZD1iLksuc3Vic3RyKDAsZisxKStkKTt9Zj1kO2lmKFwiLi5cIj09Znx8XCIuXCI9PWYpZD1cIlwiO2Vsc2UgaWYoLTEhPWYuaW5kZXhPZihcIi4vXCIpfHwtMSE9Zi5pbmRleE9mKFwiLy5cIikpe2Q9MD09Zi5sYXN0SW5kZXhPZihcIi9cIiwwKTtmPWYuc3BsaXQoXCIvXCIpO2Zvcih2YXIgZz1bXSxrPTA7azxmLmxlbmd0aDspe3ZhciBwPWZbaysrXTtcIi5cIj09cD9kJiZrPT1mLmxlbmd0aCYmZy5wdXNoKFwiXCIpOlwiLi5cIj09cD8oKDE8Zy5sZW5ndGh8fDE9PWcubGVuZ3RoJiZcblwiXCIhPWdbMF0pJiZnLnBvcCgpLCBkJiZrPT1mLmxlbmd0aCYmZy5wdXNoKFwiXCIpKTooZy5wdXNoKHApLCBkPSEwKTt9ZD1nLmpvaW4oXCIvXCIpO31lbHNlIGQ9Zjt9Yz9iLmVjKGQpOmM9YS5HZigpO2M/Yi5iZChhLlAuY2xvbmUoKSk6Yz1hLkVmKCk7YyYmYi4kYyhhLmliKTtyZXR1cm4gYn07ZS5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgVSh0aGlzKX07ZS50Yj1mdW5jdGlvbihhLGIpe3RoaXMuVSgpO2lmKHRoaXMucWE9Yj95YyhhLCEwKTphKXRoaXMucWE9dGhpcy5xYS5yZXBsYWNlKC86JC8sXCJcIik7fTtlLkhmPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLnFhfTtlLmNkPWZ1bmN0aW9uKGEsYil7dGhpcy5VKCk7dGhpcy56Yj1iP3ljKGEpOmE7fTtlLklmPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLnpifTtlLnJiPWZ1bmN0aW9uKGEsYil7dGhpcy5VKCk7dGhpcy54YT1iP3ljKGEsITApOmE7fTtlLkljPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLnhhfTtcbmUuc2I9ZnVuY3Rpb24oYSl7dGhpcy5VKCk7aWYoYSl7YT1OdW1iZXIoYSk7aWYoaXNOYU4oYSl8fDA+YSl0aHJvdyBFcnJvcihcIkJhZCBwb3J0IG51bWJlciBcIithKTt0aGlzLkNhPWE7fWVsc2UgdGhpcy5DYT1udWxsO307ZS5GZj1mdW5jdGlvbigpe3JldHVybiBudWxsIT10aGlzLkNhfTtlLmVjPWZ1bmN0aW9uKGEsYil7dGhpcy5VKCk7dGhpcy5LPWI/eWMoYSwhMCk6YTt9O2UuYWU9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuS307ZS5HZj1mdW5jdGlvbigpe3JldHVyblwiXCIhPT10aGlzLlAudG9TdHJpbmcoKX07ZS5iZD1mdW5jdGlvbihhLGIpe3RoaXMuVSgpO2EgaW5zdGFuY2VvZiByYz8odGhpcy5QPWEsIHRoaXMuUC5hZCh0aGlzLk8pKTooYnx8KGE9c2MoYSx6YykpLCB0aGlzLlA9bmV3IHJjKGEsdGhpcy5PKSk7fTtlLlJkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuUC50b1N0cmluZygpfTtlLmdldFF1ZXJ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuUmQoKX07XG5lLmw9ZnVuY3Rpb24oYSxiKXt0aGlzLlUoKTt0aGlzLlAuc2V0KGEsYik7fTtlLmRjPWZ1bmN0aW9uKGEsYil7dGhpcy5VKCk7bihiKXx8KGI9W1N0cmluZyhiKV0pO3RoaXMuUC5JZShhLGIpO307ZS4kYz1mdW5jdGlvbihhLGIpe3RoaXMuVSgpO3RoaXMuaWI9Yj95YyhhKTphO307ZS5FZj1mdW5jdGlvbigpe3JldHVybiEhdGhpcy5pYn07ZS5VYj1mdW5jdGlvbigpe3RoaXMuVSgpO3RoaXMubChcInp4XCIsTWF0aC5mbG9vcigyMTQ3NDgzNjQ4Kk1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKDM2KStNYXRoLmFicyhNYXRoLmZsb29yKDIxNDc0ODM2NDgqTWF0aC5yYW5kb20oKSledygpKS50b1N0cmluZygzNikpO3JldHVybiB0aGlzfTtlLnJlbW92ZVBhcmFtZXRlcj1mdW5jdGlvbihhKXt0aGlzLlUoKTt0aGlzLlAucmVtb3ZlKGEpO3JldHVybiB0aGlzfTtlLlU9ZnVuY3Rpb24oKXtpZih0aGlzLlFmKXRocm93IEVycm9yKFwiVHJpZWQgdG8gbW9kaWZ5IGEgcmVhZC1vbmx5IFVyaVwiKTt9O1xuZS5hZD1mdW5jdGlvbihhKXt0aGlzLk89YTt0aGlzLlAmJnRoaXMuUC5hZChhKTt9O2Z1bmN0aW9uIEFjKGEpe3JldHVybiBhIGluc3RhbmNlb2YgVT9hLmNsb25lKCk6bmV3IFUoYSx2b2lkIDApfWZ1bmN0aW9uIEJjKGEsYixjLGQpe3ZhciBmPW5ldyBVKG51bGwsdm9pZCAwKTthJiZmLnRiKGEpO2ImJmYucmIoYik7YyYmZi5zYihjKTtkJiZmLmVjKGQpO3JldHVybiBmfWZ1bmN0aW9uIHljKGEsYil7cmV0dXJuIGE/Yj9kZWNvZGVVUkkoYS5yZXBsYWNlKC8lMjUvZyxcIiUyNTI1XCIpKTpkZWNvZGVVUklDb21wb25lbnQoYSk6XCJcIn1mdW5jdGlvbiBzYyhhLGIsYyl7cmV0dXJuIGwoYSk/KGE9ZW5jb2RlVVJJKGEpLnJlcGxhY2UoYixDYyksIGMmJihhPWEucmVwbGFjZSgvJTI1KFswLTlhLWZBLUZdezJ9KS9nLFwiJSQxXCIpKSwgYSk6bnVsbH1cbmZ1bmN0aW9uIENjKGEpe2E9YS5jaGFyQ29kZUF0KDApO3JldHVyblwiJVwiKyhhPj40JjE1KS50b1N0cmluZygxNikrKGEmMTUpLnRvU3RyaW5nKDE2KX12YXIgdGM9L1sjXFwvXFw/QF0vZyx3Yz0vWyNcXD86XS9nLHVjPS9bI1xcP10vZyx6Yz0vWyNcXD9AXS9nLHhjPS8jL2c7ZnVuY3Rpb24gcmMoYSxiKXt0aGlzLmo9dGhpcy5tPW51bGw7dGhpcy5qYT1hfHxudWxsO3RoaXMuTz0hIWI7fWU9cmMucHJvdG90eXBlO2UuJD1mdW5jdGlvbigpe2lmKCF0aGlzLm0mJih0aGlzLm09bmV3IFMsIHRoaXMuaj0wLCB0aGlzLmphKSl7dmFyIGE9dGhpcztxYyh0aGlzLmphLGZ1bmN0aW9uKGIsYyl7YS5hZGQoZGVjb2RlVVJJQ29tcG9uZW50KGIucmVwbGFjZSgvXFwrL2csXCIgXCIpKSxjKTt9KTt9fTtlLkM9ZnVuY3Rpb24oKXt0aGlzLiQoKTtyZXR1cm4gdGhpcy5qfTtcbmUuYWRkPWZ1bmN0aW9uKGEsYil7dGhpcy4kKCk7dGhpcy5PYSgpO2E9dGhpcy5NYShhKTt2YXIgYz10aGlzLm0uZ2V0KGEpO2N8fHRoaXMubS5zZXQoYSxjPVtdKTtjLnB1c2goYik7dGhpcy5qKz0xO3JldHVybiB0aGlzfTtlLnJlbW92ZT1mdW5jdGlvbihhKXt0aGlzLiQoKTthPXRoaXMuTWEoYSk7cmV0dXJuIHRoaXMubS52YShhKT8odGhpcy5PYSgpLCB0aGlzLmotPXRoaXMubS5nZXQoYSkubGVuZ3RoLCB0aGlzLm0ucmVtb3ZlKGEpKTohMX07ZS5jbGVhcj1mdW5jdGlvbigpe3RoaXMuT2EoKTt0aGlzLm09bnVsbDt0aGlzLmo9MDt9O2UuWD1mdW5jdGlvbigpe3RoaXMuJCgpO3JldHVybiAwPT10aGlzLmp9O2UudmE9ZnVuY3Rpb24oYSl7dGhpcy4kKCk7YT10aGlzLk1hKGEpO3JldHVybiB0aGlzLm0udmEoYSl9O1xuZS5mb3JFYWNoPWZ1bmN0aW9uKGEsYil7dGhpcy4kKCk7dGhpcy5tLmZvckVhY2goZnVuY3Rpb24oYyxkKXtuYShjLGZ1bmN0aW9uKGMpe2EuY2FsbChiLGMsZCx0aGlzKTt9LHRoaXMpO30sdGhpcyk7fTtlLlc9ZnVuY3Rpb24oKXt0aGlzLiQoKTtmb3IodmFyIGE9dGhpcy5tLkgoKSxiPXRoaXMubS5XKCksYz1bXSxkPTA7ZDxiLmxlbmd0aDtkKyspZm9yKHZhciBmPWFbZF0sZz0wO2c8Zi5sZW5ndGg7ZysrKWMucHVzaChiW2RdKTtyZXR1cm4gY307ZS5IPWZ1bmN0aW9uKGEpe3RoaXMuJCgpO3ZhciBiPVtdO2lmKGwoYSkpdGhpcy52YShhKSYmKGI9dGEoYix0aGlzLm0uZ2V0KHRoaXMuTWEoYSkpKSk7ZWxzZXthPXRoaXMubS5IKCk7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspYj10YShiLGFbY10pO31yZXR1cm4gYn07XG5lLnNldD1mdW5jdGlvbihhLGIpe3RoaXMuJCgpO3RoaXMuT2EoKTthPXRoaXMuTWEoYSk7dGhpcy52YShhKSYmKHRoaXMuai09dGhpcy5tLmdldChhKS5sZW5ndGgpO3RoaXMubS5zZXQoYSxbYl0pO3RoaXMuais9MTtyZXR1cm4gdGhpc307ZS5nZXQ9ZnVuY3Rpb24oYSxiKXtpZighYSlyZXR1cm4gYjthPXRoaXMuSChhKTtyZXR1cm4gMDxhLmxlbmd0aD9TdHJpbmcoYVswXSk6Yn07ZS5JZT1mdW5jdGlvbihhLGIpe3RoaXMucmVtb3ZlKGEpOzA8Yi5sZW5ndGgmJih0aGlzLk9hKCksIHRoaXMubS5zZXQodGhpcy5NYShhKSx1YShiKSksIHRoaXMuais9Yi5sZW5ndGgpO307XG5lLnRvU3RyaW5nPWZ1bmN0aW9uKCl7aWYodGhpcy5qYSlyZXR1cm4gdGhpcy5qYTtpZighdGhpcy5tKXJldHVyblwiXCI7Zm9yKHZhciBhPVtdLGI9dGhpcy5tLlcoKSxjPTA7YzxiLmxlbmd0aDtjKyspe3ZhciBkPWJbY10sZj1lbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGQpKTtkPXRoaXMuSChkKTtmb3IodmFyIGc9MDtnPGQubGVuZ3RoO2crKyl7dmFyIGs9ZjtcIlwiIT09ZFtnXSYmKGsrPVwiPVwiK2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoZFtnXSkpKTthLnB1c2goayk7fX1yZXR1cm4gdGhpcy5qYT1hLmpvaW4oXCImXCIpfTtlLk9hPWZ1bmN0aW9uKCl7dGhpcy5qYT1udWxsO307ZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBhPW5ldyByYzthLmphPXRoaXMuamE7dGhpcy5tJiYoYS5tPXRoaXMubS5jbG9uZSgpLCBhLmo9dGhpcy5qKTtyZXR1cm4gYX07ZS5NYT1mdW5jdGlvbihhKXthPVN0cmluZyhhKTt0aGlzLk8mJihhPWEudG9Mb3dlckNhc2UoKSk7cmV0dXJuIGF9O1xuZS5hZD1mdW5jdGlvbihhKXthJiYhdGhpcy5PJiYodGhpcy4kKCksIHRoaXMuT2EoKSwgdGhpcy5tLmZvckVhY2goZnVuY3Rpb24oYSxjKXt2YXIgYj1jLnRvTG93ZXJDYXNlKCk7YyE9YiYmKHRoaXMucmVtb3ZlKGMpLCB0aGlzLkllKGIsYSkpO30sdGhpcykpO3RoaXMuTz1hO307ZS5leHRlbmQ9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTA7Yjxhcmd1bWVudHMubGVuZ3RoO2IrKylvYyhhcmd1bWVudHNbYl0sZnVuY3Rpb24oYSxiKXt0aGlzLmFkZChiLGEpO30sdGhpcyk7fTtmdW5jdGlvbiBGYygpe31mdW5jdGlvbiBHYygpe314KEdjLEZjKTtmdW5jdGlvbiBIYyhhLGIpe3RoaXMuYj1hO3RoaXMuYT1iO3RoaXMuZj10aGlzLkE9bnVsbDt0aGlzLmJjPSExO3RoaXMuSz1udWxsO3RoaXMudz0tMTt0aGlzLkFkPXRoaXMubmE9bnVsbDt9ZT1IYy5wcm90b3R5cGU7ZS5nPW51bGw7ZS5nYT1mdW5jdGlvbihhKXt0aGlzLkE9YTt9O2UuY29ubmVjdD1mdW5jdGlvbihhKXt0aGlzLks9YTthPXRoaXMuYi5TZCh0aGlzLkspO08oMyk7dmFyIGI9dGhpcy5iLkliLiRkO251bGwhPWI/KHRoaXMubmE9dGhpcy5iLiRhKGJbMF0pLCB0aGlzLmc9MSwgdGhpcy54ZCgpKTooYS5kYyhcIk1PREVcIixcImluaXRcIiksICF0aGlzLmIudGEmJnRoaXMuYi5hYSYmYS5kYyhcIlgtSFRUUC1TZXNzaW9uLUlkXCIsdGhpcy5iLmFhKSwgdGhpcy5mPW5ldyBSKHRoaXMsdGhpcy5hLHZvaWQgMCx2b2lkIDAsdm9pZCAwKSwgdGhpcy5mLmdhKHRoaXMuQSksIHRoaXMuZi5qZChhLCExLG51bGwpLCB0aGlzLmc9MCk7fTtcbmUueGQ9ZnVuY3Rpb24oKXt0aGlzLmEuZGVidWcoXCJUZXN0Q29ubmVjdGlvbjogc3RhcnRpbmcgc3RhZ2UgMlwiKTt2YXIgYT10aGlzLmIuSWIub2Q7aWYobnVsbCE9YSl0aGlzLmEuZGVidWcoZnVuY3Rpb24oKXtyZXR1cm5cIlRlc3RDb25uZWN0aW9uOiBza2lwcGluZyBzdGFnZSAyLCBwcmVjb21wdXRlZCByZXN1bHQgaXMgXCIrYT9cIkJ1ZmZlcmVkXCI6XCJVbmJ1ZmZlcmVkXCJ9KSwgTyg0KSwgYT8oTygxMCksIHRoaXMuYi51Yih0aGlzLCExKSk6KE8oMTEpLCB0aGlzLmIudWIodGhpcywhMCkpO2Vsc2V7dGhpcy5mPW5ldyBSKHRoaXMsdGhpcy5hLHZvaWQgMCx2b2lkIDAsdm9pZCAwKTt0aGlzLmYuZ2EodGhpcy5BKTt2YXIgYj10aGlzLmIuUGQodGhpcy5uYSx0aGlzLkspO08oNCk7Yi5kYyhcIlRZUEVcIixcInhtbGh0dHBcIik7dmFyIGM9dGhpcy5iLmFhLGQ9dGhpcy5iLktjO2MmJmQmJmIubChjLGQpO3RoaXMuZi5qZChiLCExLHRoaXMubmEpO319O2UuSmI9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYi5KYihhKX07XG5lLmFib3J0PWZ1bmN0aW9uKCl7dGhpcy5mJiYodGhpcy5mLmNhbmNlbCgpLCB0aGlzLmY9bnVsbCk7dGhpcy53PS0xO307ZS5kZT1mdW5jdGlvbigpe3JldHVybiExfTtcbmUudWU9ZnVuY3Rpb24oYSxiKXt0aGlzLnc9YS53O2lmKDA9PXRoaXMuZylpZih0aGlzLmEuZGVidWcoXCJUZXN0Q29ubmVjdGlvbjogR290IGRhdGEgZm9yIHN0YWdlIDFcIiksIHRoaXMucGMoYSksIGIpe3RyeXt2YXIgYz10aGlzLmIua2MuemMoYik7fWNhdGNoKGQpe3RoaXMuYS5jYihkKTt0aGlzLmIuZGQodGhpcyk7cmV0dXJufXRoaXMubmE9dGhpcy5iLiRhKGNbMF0pO31lbHNlIHRoaXMuYS5kZWJ1ZyhcIlRlc3RDb25uZWN0aW9uOiBOdWxsIHJlc3BvbnNlVGV4dFwiKSwgdGhpcy5iLmRkKHRoaXMpO2Vsc2UgMT09dGhpcy5nJiYodGhpcy5iYz9PKDYpOlwiMTExMTFcIj09Yj8oTyg1KSwgdGhpcy5iYz0hMCwgdGhpcy5aZSgpJiYodGhpcy53PTIwMCwgdGhpcy5mLmNhbmNlbCgpLCB0aGlzLmEuZGVidWcoXCJUZXN0IGNvbm5lY3Rpb24gc3VjY2VlZGVkOyB1c2luZyBzdHJlYW1pbmcgY29ubmVjdGlvblwiKSwgTygxMSksIHRoaXMuYi51Yih0aGlzLCEwKSkpOihPKDcpLCB0aGlzLmJjPSExKSk7fTtcbmUuVGM9ZnVuY3Rpb24oKXt0aGlzLnc9dGhpcy5mLnc7dGhpcy5mLlM/MD09dGhpcy5nPyh0aGlzLmc9MSwgdGhpcy5hLmRlYnVnKFwiVGVzdENvbm5lY3Rpb246IHJlcXVlc3QgY29tcGxldGUgZm9yIGluaXRpYWwgY2hlY2tcIiksIHRoaXMueGQoKSk6MT09dGhpcy5nJiYodGhpcy5hLmRlYnVnKFwiVGVzdENvbm5lY3Rpb246IHJlcXVlc3QgY29tcGxldGUgZm9yIHN0YWdlIDJcIiksIHRoaXMuYmM/KHRoaXMuYS5kZWJ1ZyhcIlRlc3QgY29ubmVjdGlvbiBzdWNjZWVkZWQ7IHVzaW5nIHN0cmVhbWluZyBjb25uZWN0aW9uXCIpLCBPKDExKSwgdGhpcy5iLnViKHRoaXMsITApKToodGhpcy5hLmRlYnVnKFwiVGVzdCBjb25uZWN0aW9uIGZhaWxlZDsgbm90IHVzaW5nIHN0cmVhbWluZ1wiKSwgTygxMCksIHRoaXMuYi51Yih0aGlzLCExKSkpOih0aGlzLmEuZGVidWcoXCJUZXN0Q29ubmVjdGlvbjogcmVxdWVzdCBmYWlsZWQsIGluIHN0YXRlIFwiK3RoaXMuZyksIDA9PXRoaXMuZz9PKDgpOjE9PXRoaXMuZyYmTyg5KSwgdGhpcy5iLmRkKHRoaXMpKTt9O2UucGM9ZnVuY3Rpb24oYSl7aWYoIXRoaXMuYi50YSYmKGE9YS5oKSl7dmFyIGI9YS5rYihcIlgtQ2xpZW50LVdpcmUtUHJvdG9jb2xcIik7dGhpcy5BZD1iP2I6bnVsbDt0aGlzLmIuYWEmJigoYT1hLmtiKFwiWC1IVFRQLVNlc3Npb24tSWRcIikpP3RoaXMuYi5GZShhKTp0aGlzLmEuVChcIk1pc3NpbmcgWF9IVFRQX1NFU1NJT05fSUQgaW4gdGhlIGhhbmRzaGFrZSByZXNwb25zZVwiKSk7fX07ZS5mYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmIuZmMoKX07ZS5CYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmIuQmEoKX07ZS5aZT1mdW5jdGlvbigpe3JldHVybiFDfHwxMDw9TnVtYmVyKFVhKX07ZnVuY3Rpb24gSWMoKXt0aGlzLm9kPXRoaXMuJGQ9bnVsbDt9ZnVuY3Rpb24gSmMoYSl7dGhpcy5EPW5ldyBTO2EmJnRoaXMuYWRkQWxsKGEpO31mdW5jdGlvbiBLYyhhKXt2YXIgYj10eXBlb2YgYTtyZXR1cm5cIm9iamVjdFwiPT1iJiZhfHxcImZ1bmN0aW9uXCI9PWI/XCJvXCIrKGFbdF18fChhW3RdPSsrZGEpKTpiLnN1YnN0cigwLDEpK2F9ZT1KYy5wcm90b3R5cGU7ZS5DPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuRC5DKCl9O2UuYWRkPWZ1bmN0aW9uKGEpe3RoaXMuRC5zZXQoS2MoYSksYSk7fTtlLmFkZEFsbD1mdW5jdGlvbihhKXthPW5jKGEpO2Zvcih2YXIgYj1hLmxlbmd0aCxjPTA7YzxiO2MrKyl0aGlzLmFkZChhW2NdKTt9O2UucGI9ZnVuY3Rpb24oYSl7YT1uYyhhKTtmb3IodmFyIGI9YS5sZW5ndGgsYz0wO2M8YjtjKyspdGhpcy5yZW1vdmUoYVtjXSk7fTtlLnJlbW92ZT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5ELnJlbW92ZShLYyhhKSl9O2UuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLkQuY2xlYXIoKTt9O2UuWD1mdW5jdGlvbigpe3JldHVybiB0aGlzLkQuWCgpfTtcbmUuY29udGFpbnM9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuRC52YShLYyhhKSl9O2UuSD1mdW5jdGlvbigpe3JldHVybiB0aGlzLkQuSCgpfTtlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBKYyh0aGlzKX07ZnVuY3Rpb24gTGMoYSxiKXt0aGlzLlBjPWE7dGhpcy5tYXA9Yjt0aGlzLmNvbnRleHQ9bnVsbDt9ZnVuY3Rpb24gTWMoYSl7dGhpcy5tZT1hfHxOYztoLlBlcmZvcm1hbmNlTmF2aWdhdGlvblRpbWluZz8oYT1oLnBlcmZvcm1hbmNlLmdldEVudHJpZXNCeVR5cGUoXCJuYXZpZ2F0aW9uXCIpLCBhPTA8YS5sZW5ndGgmJihcImhxXCI9PWFbMF0ubmV4dEhvcFByb3RvY29sfHxcImgyXCI9PWFbMF0ubmV4dEhvcFByb3RvY29sKSk6YT0hIShoLnZjJiZoLnZjLmtlJiZoLnZjLmtlKCkmJmgudmMua2UoKS5uaCk7dGhpcy5YYj1hP3RoaXMubWU6MTt0aGlzLnY9bnVsbDsxPHRoaXMuWGImJih0aGlzLnY9bmV3IEpjKTt0aGlzLmY9bnVsbDt0aGlzLmJhPVtdO312YXIgTmM9MTA7ZT1NYy5wcm90b3R5cGU7ZS5sZD1mdW5jdGlvbihhKXt0aGlzLnZ8fC0xPT1hLmluZGV4T2YoXCJzcGR5XCIpJiYtMT09YS5pbmRleE9mKFwicXVpY1wiKSYmLTE9PWEuaW5kZXhPZihcImgyXCIpfHwodGhpcy5YYj10aGlzLm1lLCB0aGlzLnY9bmV3IEpjLCB0aGlzLmYmJih0aGlzLm9jKHRoaXMuZiksIHRoaXMuZj1udWxsKSk7fTtcbmUuZWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mPyEwOnRoaXMudj90aGlzLnYuQygpPj10aGlzLlhiOiExfTtlLnhmPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZj8xOnRoaXMudj90aGlzLnYuQygpOjB9O2UuSmM9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZj90aGlzLmY9PWE6dGhpcy52P3RoaXMudi5jb250YWlucyhhKTohMX07ZS5vYz1mdW5jdGlvbihhKXt0aGlzLnY/dGhpcy52LmFkZChhKTp0aGlzLmY9YTt9O2UuemU9ZnVuY3Rpb24oYSl7dGhpcy5mJiZ0aGlzLmY9PWE/dGhpcy5mPW51bGw6dGhpcy52JiZ0aGlzLnYuY29udGFpbnMoYSkmJnRoaXMudi5yZW1vdmUoYSk7fTtlLmNhbmNlbD1mdW5jdGlvbigpe3RoaXMuYmE9dGhpcy5sYSgpO3RoaXMuZj8odGhpcy5mLmNhbmNlbCgpLCB0aGlzLmY9bnVsbCk6dGhpcy52JiYhdGhpcy52LlgoKSYmKG5hKHRoaXMudi5IKCksZnVuY3Rpb24oYSl7YS5jYW5jZWwoKTt9KSwgdGhpcy52LmNsZWFyKCkpO307XG5lLmxhPWZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5mKXJldHVybiB0aGlzLmJhLmNvbmNhdCh0aGlzLmYubGEoKSk7aWYobnVsbCE9dGhpcy52JiYhdGhpcy52LlgoKSl7dmFyIGE9dGhpcy5iYTtuYSh0aGlzLnYuSCgpLGZ1bmN0aW9uKGIpe2E9YS5jb25jYXQoYi5sYSgpKTt9KTtyZXR1cm4gYX1yZXR1cm4gdWEodGhpcy5iYSl9O2UuUmU9ZnVuY3Rpb24oYSl7dGhpcy5iYT10aGlzLmJhLmNvbmNhdChhKTt9O2UuJGU9ZnVuY3Rpb24oKXt0aGlzLmJhLmxlbmd0aD0wO307ZnVuY3Rpb24gT2MoKXt0aGlzLnhnPXRoaXMucmc9dm9pZCAwO31PYy5wcm90b3R5cGUuc3RyaW5naWZ5PWZ1bmN0aW9uKGEpe3JldHVybiBoLkpTT04uc3RyaW5naWZ5KGEsdGhpcy5yZyl9O09jLnByb3RvdHlwZS5wYXJzZT1mdW5jdGlvbihhKXtyZXR1cm4gaC5KU09OLnBhcnNlKGEsdGhpcy54Zyl9O2Z1bmN0aW9uIFBjKCl7dGhpcy5qZz1uZXcgT2M7fVBjLnByb3RvdHlwZS5oZj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9Y3x8XCJcIjt0cnl7b2MoYSxmdW5jdGlvbihhLGMpe3ZhciBmPWE7cihhKSYmKGY9dWIoYSkpO2IucHVzaChkK2MrXCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KGYpKTt9KTt9Y2F0Y2goZil7dGhyb3cgYi5wdXNoKGQrXCJ0eXBlPVwiK2VuY29kZVVSSUNvbXBvbmVudChcIl9iYWRtYXBcIikpLCBmO319O1BjLnByb3RvdHlwZS5qZj1mdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPS0xOzspe3ZhciBmPVtcImNvdW50PVwiK2JdOy0xPT1kPzA8Yj8oZD1hWzBdLlBjLCBmLnB1c2goXCJvZnM9XCIrZCkpOmQ9MDpmLnB1c2goXCJvZnM9XCIrZCk7Zm9yKHZhciBnPSEwLGs9MDtrPGI7aysrKXt2YXIgcD1hW2tdLlBjLFViPWFba10ubWFwO3AtPWQ7aWYoMD5wKWQ9TWF0aC5tYXgoMCxhW2tdLlBjLTEwMCksIGc9ITE7ZWxzZSB0cnl7dGhpcy5oZihVYixmLFwicmVxXCIrcCtcIl9cIik7fWNhdGNoKG1kKXtjJiZjKFViKTt9fWlmKGcpcmV0dXJuIGYuam9pbihcIiZcIil9fTtcblBjLnByb3RvdHlwZS56Yz1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5qZy5wYXJzZShhKX07ZnVuY3Rpb24gUWMoYSxiKXt2YXIgYz1uZXcgWGI7Yy5kZWJ1ZyhcIlRlc3RMb2FkSW1hZ2U6IGxvYWRpbmcgXCIrYSk7dmFyIGQ9bmV3IEltYWdlO2Qub25sb2FkPXYoUmMsYyxkLFwiVGVzdExvYWRJbWFnZTogbG9hZGVkXCIsITAsYik7ZC5vbmVycm9yPXYoUmMsYyxkLFwiVGVzdExvYWRJbWFnZTogZXJyb3JcIiwhMSxiKTtkLm9uYWJvcnQ9dihSYyxjLGQsXCJUZXN0TG9hZEltYWdlOiBhYm9ydFwiLCExLGIpO2Qub250aW1lb3V0PXYoUmMsYyxkLFwiVGVzdExvYWRJbWFnZTogdGltZW91dFwiLCExLGIpO2guc2V0VGltZW91dChmdW5jdGlvbigpe2lmKGQub250aW1lb3V0KWQub250aW1lb3V0KCk7fSwxRTQpO2Quc3JjPWE7fWZ1bmN0aW9uIFJjKGEsYixjLGQsZil7dHJ5e2EuZGVidWcoYyksIGIub25sb2FkPW51bGwsIGIub25lcnJvcj1udWxsLCBiLm9uYWJvcnQ9bnVsbCwgYi5vbnRpbWVvdXQ9bnVsbCwgZihkKTt9Y2F0Y2goZyl7YS5jYihnKTt9fXZhciBTYz1oLkpTT04ucGFyc2U7ZnVuY3Rpb24gVihhKXtILmNhbGwodGhpcyk7dGhpcy5oZWFkZXJzPW5ldyBTO3RoaXMuWGE9YXx8bnVsbDt0aGlzLmhhPSExO3RoaXMubWM9dGhpcy5jPW51bGw7dGhpcy5nZT10aGlzLlRiPVwiXCI7dGhpcy5QYT0wO3RoaXMuST1cIlwiO3RoaXMuQWE9dGhpcy5MYz10aGlzLlFiPXRoaXMuRWM9ITE7dGhpcy52Yj0wO3RoaXMuaGM9bnVsbDt0aGlzLkFlPVRjO3RoaXMuamM9dGhpcy5sZz10aGlzLkFiPSExO314KFYsSCk7dmFyIFRjPVwiXCI7Vi5wcm90b3R5cGUucz1WYihcImdvb2cubmV0LlhocklvXCIpO3ZhciBVYz0vXmh0dHBzPyQvaSxWYz1bXCJQT1NUXCIsXCJQVVRcIl07ZT1WLnByb3RvdHlwZTtlLkplPWZ1bmN0aW9uKGEpe3RoaXMuQWI9YTt9O1xuZS5zZW5kPWZ1bmN0aW9uKGEsYixjLGQpe2lmKHRoaXMuYyl0aHJvdyBFcnJvcihcIltnb29nLm5ldC5YaHJJb10gT2JqZWN0IGlzIGFjdGl2ZSB3aXRoIGFub3RoZXIgcmVxdWVzdD1cIit0aGlzLlRiK1wiOyBuZXdVcmk9XCIrYSk7Yj1iP2IudG9VcHBlckNhc2UoKTpcIkdFVFwiO3RoaXMuVGI9YTt0aGlzLkk9XCJcIjt0aGlzLlBhPTA7dGhpcy5nZT1iO3RoaXMuRWM9ITE7dGhpcy5oYT0hMDt0aGlzLmM9dGhpcy5kZigpO3RoaXMubWM9dGhpcy5YYT90aGlzLlhhLlZkKCk6aGMuVmQoKTt0aGlzLmMub25yZWFkeXN0YXRlY2hhbmdlPXUodGhpcy50ZSx0aGlzKTt0aGlzLmxnJiZcIm9ucHJvZ3Jlc3NcImluIHRoaXMuYyYmKHRoaXMuYy5vbnByb2dyZXNzPXUoZnVuY3Rpb24oYSl7dGhpcy5yZShhLCEwKTt9LHRoaXMpLCB0aGlzLmMudXBsb2FkJiYodGhpcy5jLnVwbG9hZC5vbnByb2dyZXNzPXUodGhpcy5yZSx0aGlzKSkpO3RyeXtMKHRoaXMucyx0aGlzLmRhKFwiT3BlbmluZyBYaHJcIikpLCB0aGlzLkxjPVxuITAsIHRoaXMuYy5vcGVuKGIsU3RyaW5nKGEpLCEwKSwgdGhpcy5MYz0hMTt9Y2F0Y2goZyl7TCh0aGlzLnMsdGhpcy5kYShcIkVycm9yIG9wZW5pbmcgWGhyOiBcIitnLm1lc3NhZ2UpKTt0aGlzLkxkKGcpO3JldHVybn1hPWN8fFwiXCI7dmFyIGY9dGhpcy5oZWFkZXJzLmNsb25lKCk7ZCYmb2MoZCxmdW5jdGlvbihhLGIpe2Yuc2V0KGIsYSk7fSk7ZD1wYShmLlcoKSk7Yz1oLkZvcm1EYXRhJiZhIGluc3RhbmNlb2YgaC5Gb3JtRGF0YTshKDA8PWxhKFZjLGIpKXx8ZHx8Y3x8Zi5zZXQoXCJDb250ZW50LVR5cGVcIixcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04XCIpO2YuZm9yRWFjaChmdW5jdGlvbihhLGIpe3RoaXMuYy5zZXRSZXF1ZXN0SGVhZGVyKGIsYSk7fSx0aGlzKTt0aGlzLkFlJiYodGhpcy5jLnJlc3BvbnNlVHlwZT10aGlzLkFlKTtcIndpdGhDcmVkZW50aWFsc1wiaW4gdGhpcy5jJiZ0aGlzLmMud2l0aENyZWRlbnRpYWxzIT09dGhpcy5BYiYmKHRoaXMuYy53aXRoQ3JlZGVudGlhbHM9XG50aGlzLkFiKTt0cnl7dGhpcy55ZCgpLCAwPHRoaXMudmImJih0aGlzLmpjPVdjKHRoaXMuYyksIEwodGhpcy5zLHRoaXMuZGEoXCJXaWxsIGFib3J0IGFmdGVyIFwiK3RoaXMudmIrXCJtcyBpZiBpbmNvbXBsZXRlLCB4aHIyIFwiK3RoaXMuamMpKSwgdGhpcy5qYz8odGhpcy5jLnRpbWVvdXQ9dGhpcy52YiwgdGhpcy5jLm9udGltZW91dD11KHRoaXMuVWEsdGhpcykpOnRoaXMuaGM9SGIodGhpcy5VYSx0aGlzLnZiLHRoaXMpKSwgTCh0aGlzLnMsdGhpcy5kYShcIlNlbmRpbmcgcmVxdWVzdFwiKSksIHRoaXMuUWI9ITAsIHRoaXMuYy5zZW5kKGEpLCB0aGlzLlFiPSExO31jYXRjaChnKXtMKHRoaXMucyx0aGlzLmRhKFwiU2VuZCBlcnJvcjogXCIrZy5tZXNzYWdlKSksIHRoaXMuTGQoZyk7fX07ZnVuY3Rpb24gV2MoYSl7cmV0dXJuIEMmJlRhKDkpJiZcIm51bWJlclwiPT10eXBlb2YgYS50aW1lb3V0JiZ2b2lkIDAhPT1hLm9udGltZW91dH1cbmZ1bmN0aW9uIHFhKGEpe3JldHVyblwiY29udGVudC10eXBlXCI9PWEudG9Mb3dlckNhc2UoKX1lLmRmPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuWGE/dGhpcy5YYS5EZCgpOmhjLkRkKCl9O2UuVWE9ZnVuY3Rpb24oKXtcInVuZGVmaW5lZFwiIT10eXBlb2YgZ29vZyYmdGhpcy5jJiYodGhpcy5JPVwiVGltZWQgb3V0IGFmdGVyIFwiK3RoaXMudmIrXCJtcywgYWJvcnRpbmdcIiwgdGhpcy5QYT04LCBMKHRoaXMucyx0aGlzLmRhKHRoaXMuSSkpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJ0aW1lb3V0XCIpLCB0aGlzLmFib3J0KDgpKTt9O2UuTGQ9ZnVuY3Rpb24oYSl7dGhpcy5oYT0hMTt0aGlzLmMmJih0aGlzLkFhPSEwLCB0aGlzLmMuYWJvcnQoKSwgdGhpcy5BYT0hMSk7dGhpcy5JPWE7dGhpcy5QYT01O3RoaXMuSmQoKTt0aGlzLkdiKCk7fTtlLkpkPWZ1bmN0aW9uKCl7dGhpcy5FY3x8KHRoaXMuRWM9ITAsIHRoaXMuZGlzcGF0Y2hFdmVudChcImNvbXBsZXRlXCIpLCB0aGlzLmRpc3BhdGNoRXZlbnQoXCJlcnJvclwiKSk7fTtcbmUuYWJvcnQ9ZnVuY3Rpb24oYSl7dGhpcy5jJiZ0aGlzLmhhJiYoTCh0aGlzLnMsdGhpcy5kYShcIkFib3J0aW5nXCIpKSwgdGhpcy5oYT0hMSwgdGhpcy5BYT0hMCwgdGhpcy5jLmFib3J0KCksIHRoaXMuQWE9ITEsIHRoaXMuUGE9YXx8NywgdGhpcy5kaXNwYXRjaEV2ZW50KFwiY29tcGxldGVcIiksIHRoaXMuZGlzcGF0Y2hFdmVudChcImFib3J0XCIpLCB0aGlzLkdiKCkpO307ZS5GPWZ1bmN0aW9uKCl7dGhpcy5jJiYodGhpcy5oYSYmKHRoaXMuaGE9ITEsIHRoaXMuQWE9ITAsIHRoaXMuYy5hYm9ydCgpLCB0aGlzLkFhPSExKSwgdGhpcy5HYighMCkpO1YuTC5GLmNhbGwodGhpcyk7fTtlLnRlPWZ1bmN0aW9uKCl7dGhpcy5LYXx8KHRoaXMuTGN8fHRoaXMuUWJ8fHRoaXMuQWE/dGhpcy5zZSgpOnRoaXMuZWcoKSk7fTtlLmVnPWZ1bmN0aW9uKCl7dGhpcy5zZSgpO307XG5lLnNlPWZ1bmN0aW9uKCl7aWYodGhpcy5oYSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdvb2cpaWYodGhpcy5tY1sxXSYmND09dGhpcy5tYSgpJiYyPT10aGlzLnphKCkpTCh0aGlzLnMsdGhpcy5kYShcIkxvY2FsIHJlcXVlc3QgZXJyb3IgZGV0ZWN0ZWQgYW5kIGlnbm9yZWRcIikpO2Vsc2UgaWYodGhpcy5RYiYmND09dGhpcy5tYSgpKUhiKHRoaXMudGUsMCx0aGlzKTtlbHNlIGlmKHRoaXMuZGlzcGF0Y2hFdmVudChcInJlYWR5c3RhdGVjaGFuZ2VcIiksIHRoaXMuTWMoKSl7TCh0aGlzLnMsdGhpcy5kYShcIlJlcXVlc3QgY29tcGxldGVcIikpO3RoaXMuaGE9ITE7dHJ5e3RoaXMuUmYoKT8odGhpcy5kaXNwYXRjaEV2ZW50KFwiY29tcGxldGVcIiksIHRoaXMuZGlzcGF0Y2hFdmVudChcInN1Y2Nlc3NcIikpOih0aGlzLlBhPTYsIHRoaXMuST10aGlzLllkKCkrXCIgW1wiK3RoaXMuemEoKStcIl1cIiwgdGhpcy5KZCgpKTt9ZmluYWxseXt0aGlzLkdiKCk7fX19O1xuZS5yZT1mdW5jdGlvbihhLGIpe3RoaXMuZGlzcGF0Y2hFdmVudChYYyhhLFwicHJvZ3Jlc3NcIikpO3RoaXMuZGlzcGF0Y2hFdmVudChYYyhhLGI/XCJkb3dubG9hZHByb2dyZXNzXCI6XCJ1cGxvYWRwcm9ncmVzc1wiKSk7fTtmdW5jdGlvbiBYYyhhLGIpe3JldHVybnt0eXBlOmIsbGVuZ3RoQ29tcHV0YWJsZTphLmxlbmd0aENvbXB1dGFibGUsbG9hZGVkOmEubG9hZGVkLHRvdGFsOmEudG90YWx9fWUuR2I9ZnVuY3Rpb24oYSl7aWYodGhpcy5jKXt0aGlzLnlkKCk7dmFyIGI9dGhpcy5jLGM9dGhpcy5tY1swXT9hYTpudWxsO3RoaXMubWM9dGhpcy5jPW51bGw7YXx8dGhpcy5kaXNwYXRjaEV2ZW50KFwicmVhZHlcIik7dHJ5e2Iub25yZWFkeXN0YXRlY2hhbmdlPWM7fWNhdGNoKGQpeyhhPXRoaXMucykmJmEuY2EoXCJQcm9ibGVtIGVuY291bnRlcmVkIHJlc2V0dGluZyBvbnJlYWR5c3RhdGVjaGFuZ2U6IFwiK2QubWVzc2FnZSx2b2lkIDApO319fTtcbmUueWQ9ZnVuY3Rpb24oKXt0aGlzLmMmJnRoaXMuamMmJih0aGlzLmMub250aW1lb3V0PW51bGwpO3RoaXMuaGMmJihoLmNsZWFyVGltZW91dCh0aGlzLmhjKSwgdGhpcy5oYz1udWxsKTt9O2UuQmE9ZnVuY3Rpb24oKXtyZXR1cm4hIXRoaXMuY307ZS5NYz1mdW5jdGlvbigpe3JldHVybiA0PT10aGlzLm1hKCl9O2UuUmY9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnphKCk7YTpzd2l0Y2goYSl7Y2FzZSAyMDA6Y2FzZSAyMDE6Y2FzZSAyMDI6Y2FzZSAyMDQ6Y2FzZSAyMDY6Y2FzZSAzMDQ6Y2FzZSAxMjIzOnZhciBiPSEwO2JyZWFrIGE7ZGVmYXVsdDpiPSExO31yZXR1cm4gYnx8MD09PWEmJiF0aGlzLk9mKCl9O1xuZS5PZj1mdW5jdGlvbigpe3ZhciBhPVN0cmluZyh0aGlzLlRiKS5tYXRjaChwYylbMV18fG51bGw7IWEmJmguc2VsZiYmaC5zZWxmLmxvY2F0aW9uJiYoYT1oLnNlbGYubG9jYXRpb24ucHJvdG9jb2wsIGE9YS5zdWJzdHIoMCxhLmxlbmd0aC0xKSk7cmV0dXJuIFVjLnRlc3QoYT9hLnRvTG93ZXJDYXNlKCk6XCJcIil9O2UubWE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jP3RoaXMuYy5yZWFkeVN0YXRlOjB9O2UuemE9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIDI8dGhpcy5tYSgpP3RoaXMuYy5zdGF0dXM6LTF9Y2F0Y2goYSl7cmV0dXJuLTF9fTtlLllkPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiAyPHRoaXMubWEoKT90aGlzLmMuc3RhdHVzVGV4dDpcIlwifWNhdGNoKGEpe3JldHVybiBMKHRoaXMucyxcIkNhbiBub3QgZ2V0IHN0YXR1czogXCIrYS5tZXNzYWdlKSwgXCJcIn19O1xuZS55YT1mdW5jdGlvbigpe3RyeXtyZXR1cm4gdGhpcy5jP3RoaXMuYy5yZXNwb25zZVRleHQ6XCJcIn1jYXRjaChhKXtyZXR1cm4gTCh0aGlzLnMsXCJDYW4gbm90IGdldCByZXNwb25zZVRleHQ6IFwiK2EubWVzc2FnZSksIFwiXCJ9fTtlLnlmPWZ1bmN0aW9uKGEpe2lmKHRoaXMuYyl7dmFyIGI9dGhpcy5jLnJlc3BvbnNlVGV4dDthJiYwPT1iLmluZGV4T2YoYSkmJihiPWIuc3Vic3RyaW5nKGEubGVuZ3RoKSk7cmV0dXJuIFNjKGIpfX07ZS5nZXRSZXNwb25zZUhlYWRlcj1mdW5jdGlvbihhKXtpZih0aGlzLmMmJnRoaXMuTWMoKSlyZXR1cm4gYT10aGlzLmMuZ2V0UmVzcG9uc2VIZWFkZXIoYSksIG51bGw9PT1hP3ZvaWQgMDphfTtlLmdldEFsbFJlc3BvbnNlSGVhZGVycz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmMmJnRoaXMuTWMoKT90aGlzLmMuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCl8fFwiXCI6XCJcIn07XG5lLmtiPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmM/dGhpcy5jLmdldFJlc3BvbnNlSGVhZGVyKGEpOm51bGx9O2UuVWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5QYX07ZS5IYz1mdW5jdGlvbigpe3JldHVybiBsKHRoaXMuSSk/dGhpcy5JOlN0cmluZyh0aGlzLkkpfTtlLmRhPWZ1bmN0aW9uKGEpe3JldHVybiBhK1wiIFtcIit0aGlzLmdlK1wiIFwiK3RoaXMuVGIrXCIgXCIrdGhpcy56YSgpK1wiXVwifTtmdW5jdGlvbiBZYyhhKXt2YXIgYj1cIlwiO0FhKGEsZnVuY3Rpb24oYSxkKXtiKz1kO2IrPVwiOlwiO2IrPWE7Yis9XCJcXHJcXG5cIjt9KTtyZXR1cm4gYn1mdW5jdGlvbiBaYyhhLGIsYyl7YTp7Zm9yKGQgaW4gYyl7dmFyIGQ9ITE7YnJlYWsgYX1kPSEwO31pZihkKXJldHVybiBhO2M9WWMoYyk7aWYobChhKSl7Yj1lbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGIpKTtjPW51bGwhPWM/XCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhjKSk6XCJcIjtpZihiKz1jKXtjPWEuaW5kZXhPZihcIiNcIik7MD5jJiYoYz1hLmxlbmd0aCk7ZD1hLmluZGV4T2YoXCI/XCIpO2lmKDA+ZHx8ZD5jKXtkPWM7dmFyIGY9XCJcIjt9ZWxzZSBmPWEuc3Vic3RyaW5nKGQrMSxjKTthPVthLnN1YnN0cigwLGQpLGYsYS5zdWJzdHIoYyldO2M9YVsxXTthWzFdPWI/Yz9jK1wiJlwiK2I6YjpjO2E9YVswXSsoYVsxXT9cIj9cIithWzFdOlwiXCIpK2FbMl07fXJldHVybiBhfWEubChiLGMpO3JldHVybiBhfWZ1bmN0aW9uICRjKGEpe3RoaXMuQmQ9MjI7dGhpcy5EZT0wO3RoaXMuTT1bXTt0aGlzLmE9bmV3IFhiO3RoaXMuSWI9bmV3IEljO3RoaXMubmE9dGhpcy5tZD10aGlzLmhiPXRoaXMuSz10aGlzLnU9dGhpcy5LYz10aGlzLmFhPXRoaXMuZ2I9dGhpcy5OPXRoaXMuUmI9dGhpcy5BPW51bGw7dGhpcy5UZT0hMDt0aGlzLmFnPXRoaXMuWWI9MDt0aGlzLmtmPSEhbShcImludGVybmFsQ2hhbm5lbFBhcmFtcy5mYWlsRmFzdFwiLGEpO3RoaXMuZmQ9dGhpcy5KYT10aGlzLndhPXRoaXMuaWE9dGhpcy5lYT10aGlzLmk9bnVsbDt0aGlzLlNlPSEwO3RoaXMudz10aGlzLmhlPXRoaXMuU2I9LTE7dGhpcy5yYz10aGlzLkhhPXRoaXMuTGE9MDt0aGlzLlZlPW0oXCJpbnRlcm5hbENoYW5uZWxQYXJhbXMuYmFzZVJldHJ5RGVsYXlNc1wiLGEpfHw1RTM7dGhpcy52Zz1tKFwiaW50ZXJuYWxDaGFubmVsUGFyYW1zLnJldHJ5RGVsYXlTZWVkTXNcIixhKXx8MUU0O3RoaXMubmY9bShcImludGVybmFsQ2hhbm5lbFBhcmFtcy5mb3J3YXJkQ2hhbm5lbE1heFJldHJpZXNcIixcbmEpfHwyO3RoaXMuT2Q9bShcImludGVybmFsQ2hhbm5lbFBhcmFtcy5mb3J3YXJkQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXNcIixhKXx8MkU0O3RoaXMuWGE9YSYmYS5vaHx8dm9pZCAwO3RoaXMuRGI9dm9pZCAwO3RoaXMuUmE9MDt0aGlzLmdjPWEmJmEuc3VwcG9ydHNDcm9zc0RvbWFpblhocnx8ITE7dGhpcy5yYT1cIlwiO3RoaXMuRz1uZXcgTWMoYSYmYS5jb25jdXJyZW50UmVxdWVzdExpbWl0KTt0aGlzLmtjPW5ldyBQYzt0aGlzLnRhPWEmJnZvaWQgMCE9PWEuYmFja2dyb3VuZENoYW5uZWxUZXN0P2EuYmFja2dyb3VuZENoYW5uZWxUZXN0OiEwOyh0aGlzLk5kPWEmJmEuZmFzdEhhbmRzaGFrZXx8ITEpJiYhdGhpcy50YSYmKHRoaXMuYS5UKFwiRm9yY2UgYmFja2dyb3VuZENoYW5uZWxUZXN0IHdoZW4gZmFzdEhhbmRzaGFrZSBpcyBlbmFibGVkLlwiKSwgdGhpcy50YT0hMCk7YSYmYS5JZCYmdGhpcy5hLklkKCk7fWU9JGMucHJvdG90eXBlO2UudGM9ODtlLmc9MTtcbmUuY29ubmVjdD1mdW5jdGlvbihhLGIsYyxkLGYpe3RoaXMuYS5kZWJ1ZyhcImNvbm5lY3QoKVwiKTtPKDApO3RoaXMuSz1iO3RoaXMuZ2I9Y3x8e307ZCYmdm9pZCAwIT09ZiYmKHRoaXMuZ2IuT1NJRD1kLCB0aGlzLmdiLk9BSUQ9Zik7dGhpcy50YSYmKHRoaXMuYS5kZWJ1ZyhcImNvbm5lY3QoKSBieXBhc3NlZCBjaGFubmVsLXRlc3QuXCIpLCB0aGlzLkliLiRkPVtdLCB0aGlzLkliLm9kPSExKTt0aGlzLmJmKGEpO307ZS5kaXNjb25uZWN0PWZ1bmN0aW9uKCl7dGhpcy5hLmRlYnVnKFwiZGlzY29ubmVjdCgpXCIpO3RoaXMucWQoKTtpZigzPT10aGlzLmcpe3ZhciBhPXRoaXMuWWIrKyxiPXRoaXMuaGIuY2xvbmUoKTtiLmwoXCJTSURcIix0aGlzLnJhKTtiLmwoXCJSSURcIixhKTtiLmwoXCJUWVBFXCIsXCJ0ZXJtaW5hdGVcIik7dGhpcy5ZYShiKTsobmV3IFIodGhpcyx0aGlzLmEsdGhpcy5yYSxhLHZvaWQgMCkpLnlnKGIpO310aGlzLnFlKCk7fTtcbmUuYmY9ZnVuY3Rpb24oYSl7dGhpcy5hLmRlYnVnKFwiY29ubmVjdFRlc3RfKClcIik7dGhpcy5KYT1uZXcgSGModGhpcyx0aGlzLmEpO251bGw9PT10aGlzLk4mJnRoaXMuSmEuZ2EodGhpcy5BKTt2YXIgYj1hO3RoaXMuTiYmdGhpcy5BJiYoYj1aYyhhLHRoaXMuTix0aGlzLkEpKTt0aGlzLkphLmNvbm5lY3QoYik7fTtlLmFmPWZ1bmN0aW9uKCl7dGhpcy5hLmRlYnVnKFwiY29ubmVjdENoYW5uZWxfKClcIik7dGhpcy5oYj10aGlzLlNkKHRoaXMuSyk7dGhpcy5EYygpO307ZS5xZD1mdW5jdGlvbigpe3RoaXMuSmEmJih0aGlzLkphLmFib3J0KCksIHRoaXMuSmE9bnVsbCk7dGhpcy51JiYodGhpcy51LmNhbmNlbCgpLCB0aGlzLnU9bnVsbCk7dGhpcy5pYSYmKGguY2xlYXJUaW1lb3V0KHRoaXMuaWEpLCB0aGlzLmlhPW51bGwpO3RoaXMuSGIoKTt0aGlzLkcuY2FuY2VsKCk7dGhpcy5lYSYmKGguY2xlYXJUaW1lb3V0KHRoaXMuZWEpLCB0aGlzLmVhPW51bGwpO307XG5lLmdhPWZ1bmN0aW9uKGEpe3RoaXMuQT1hO307ZS5FZz1mdW5jdGlvbihhKXt0aGlzLlJiPWE7fTtlLkNnPWZ1bmN0aW9uKGEpe3RoaXMuTj1hO307ZS5EZz1mdW5jdGlvbihhKXt0aGlzLmFhPWE7fTtlLkZlPWZ1bmN0aW9uKGEpe3RoaXMuS2M9YTt9O2UuSGU9ZnVuY3Rpb24oYSl7dGhpcy5SYT1hO307ZS5IZz1mdW5jdGlvbigpe3RoaXMuZ2M9ITA7fTtlLkVlPWZ1bmN0aW9uKGEpe3RoaXMuaT1hO307ZS5OZj1mdW5jdGlvbigpe3JldHVybiF0aGlzLmZkfTtlLlpjPWZ1bmN0aW9uKGEpezFFMz09dGhpcy5NLmxlbmd0aCYmdGhpcy5hLmNhKGZ1bmN0aW9uKCl7cmV0dXJuXCJBbHJlYWR5IGhhdmUgMTAwMCBxdWV1ZWQgbWFwcyB1cG9uIHF1ZXVlaW5nIFwiK3ViKGEpfSk7dGhpcy5NLnB1c2gobmV3IExjKHRoaXMuYWcrKyxhKSk7Mz09dGhpcy5nJiZ0aGlzLkRjKCk7fTtlLnFmPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMua2Y/MDp0aGlzLm5mfTtlLmRlPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PXRoaXMuZ307XG5lLmdldFN0YXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ307ZS5EYz1mdW5jdGlvbigpe3RoaXMuRy5lZSgpfHx0aGlzLmVhfHwodGhpcy5lYT1QKHUodGhpcy53ZSx0aGlzKSwwKSwgdGhpcy5MYT0wKTt9O2UuWWY9ZnVuY3Rpb24oYSl7aWYodGhpcy5HLnhmKCk+PXRoaXMuRy5YYi0odGhpcy5lYT8xOjApKXJldHVybiB0aGlzLmEuY2EoXCJVbmV4cGVjdGVkIHJldHJ5IHJlcXVlc3QgaXMgc2NoZWR1bGVkLlwiKSwgITE7aWYodGhpcy5lYSlyZXR1cm4gdGhpcy5hLmRlYnVnKFwiVXNlIHRoZSByZXRyeSByZXF1ZXN0IHRoYXQgaXMgYWxyZWFkeSBzY2hlZHVsZWQuXCIpLCB0aGlzLk09YS5sYSgpLmNvbmNhdCh0aGlzLk0pLCAhMDtpZigxPT10aGlzLmd8fDI9PXRoaXMuZ3x8dGhpcy5MYT49dGhpcy5xZigpKXJldHVybiExO3RoaXMuYS5kZWJ1ZyhcIkdvaW5nIHRvIHJldHJ5IFBPU1RcIik7dGhpcy5lYT1QKHUodGhpcy53ZSx0aGlzLGEpLHRoaXMuWGQodGhpcy5MYSkpO3RoaXMuTGErKztyZXR1cm4hMH07XG5lLndlPWZ1bmN0aW9uKGEpe3RoaXMuZWE9bnVsbDt0aGlzLk1nKGEpO307ZS5NZz1mdW5jdGlvbihhKXt0aGlzLmEuZGVidWcoXCJzdGFydEZvcndhcmRDaGFubmVsX1wiKTsxPT10aGlzLmc/YT90aGlzLmEuY2EoXCJOb3Qgc3VwcG9zZWQgdG8gcmV0cnkgdGhlIG9wZW5cIik6KHRoaXMuaWcoKSwgdGhpcy5nPTIpOjM9PXRoaXMuZyYmKGE/dGhpcy5sZShhKTowPT10aGlzLk0ubGVuZ3RoP3RoaXMuYS5kZWJ1ZyhcInN0YXJ0Rm9yd2FyZENoYW5uZWxfIHJldHVybmVkOiBub3RoaW5nIHRvIHNlbmRcIik6dGhpcy5HLmVlKCk/dGhpcy5hLmNhKFwic3RhcnRGb3J3YXJkQ2hhbm5lbF8gcmV0dXJuZWQ6IGNvbm5lY3Rpb24gYWxyZWFkeSBpbiBwcm9ncmVzc1wiKToodGhpcy5sZSgpLCB0aGlzLmEuZGVidWcoXCJzdGFydEZvcndhcmRDaGFubmVsXyBmaW5pc2hlZCwgc2VudCByZXF1ZXN0XCIpKSk7fTtcbmUuaWc9ZnVuY3Rpb24oKXt0aGlzLmEuZGVidWcoXCJvcGVuXygpXCIpO3RoaXMuWWI9TWF0aC5mbG9vcigxRTUqTWF0aC5yYW5kb20oKSk7dmFyIGE9dGhpcy5ZYisrLGI9bmV3IFIodGhpcyx0aGlzLmEsXCJcIixhLHZvaWQgMCksYz10aGlzLkE7dGhpcy5SYiYmKGM/KGM9RGEoYyksIEZhKGMsdGhpcy5SYikpOmM9dGhpcy5SYik7bnVsbD09PXRoaXMuTiYmYi5nYShjKTt2YXIgZD10aGlzLkhkKGIpLGY9dGhpcy5oYi5jbG9uZSgpO2YubChcIlJJRFwiLGEpOzA8dGhpcy5CZCYmZi5sKFwiQ1ZFUlwiLHRoaXMuQmQpO3RoaXMudGEmJnRoaXMuYWEmJmYubChcIlgtSFRUUC1TZXNzaW9uLUlkXCIsdGhpcy5hYSk7dGhpcy5ZYShmKTt0aGlzLk4mJmMmJlpjKGYsdGhpcy5OLGMpO3RoaXMuRy5vYyhiKTt0aGlzLk5kPyhmLmwoXCIkcmVxXCIsZCksIGYubChcIlNJRFwiLFwibnVsbFwiKSwgYi5BZygpLCBiLmtkKGYsbnVsbCkpOmIua2QoZixkKTt9O1xuZS5sZT1mdW5jdGlvbihhKXt2YXIgYj1hP2EuUjp0aGlzLlliKys7dmFyIGM9dGhpcy5oYi5jbG9uZSgpO2MubChcIlNJRFwiLHRoaXMucmEpO2MubChcIlJJRFwiLGIpO2MubChcIkFJRFwiLHRoaXMuU2IpO3RoaXMuWWEoYyk7dGhpcy5OJiZ0aGlzLkEmJlpjKGMsdGhpcy5OLHRoaXMuQSk7Yj1uZXcgUih0aGlzLHRoaXMuYSx0aGlzLnJhLGIsdGhpcy5MYSsxKTtudWxsPT09dGhpcy5OJiZiLmdhKHRoaXMuQSk7YSYmdGhpcy5zZyhhKTthPXRoaXMuSGQoYik7Yi5zZXRUaW1lb3V0KE1hdGgucm91bmQoLjUqdGhpcy5PZCkrTWF0aC5yb3VuZCguNSp0aGlzLk9kKk1hdGgucmFuZG9tKCkpKTt0aGlzLkcub2MoYik7Yi5rZChjLGEpO307ZS5ZYT1mdW5jdGlvbihhKXt0aGlzLmkmJm9jKHt9LGZ1bmN0aW9uKGIsYyl7YS5sKGMsYik7fSk7fTtcbmUuSGQ9ZnVuY3Rpb24oYSl7dmFyIGI9TWF0aC5taW4odGhpcy5NLmxlbmd0aCwxRTMpLGM9dGhpcy5pP3UodGhpcy5pLlVlLHRoaXMuaSx0aGlzKTpudWxsO2M9dGhpcy5rYy5qZih0aGlzLk0sYixjKTthLkdnKHRoaXMuTS5zcGxpY2UoMCxiKSk7cmV0dXJuIGN9O2Uuc2c9ZnVuY3Rpb24oYSl7dGhpcy5NPWEubGEoKS5jb25jYXQodGhpcy5NKTt9O2UuS2Q9ZnVuY3Rpb24oKXtpZighdGhpcy51JiYhdGhpcy5pYSl7dGhpcy5yYz0xO3ZhciBhPXRoaXMudmU7QmJ8fENiKCk7RWJ8fChCYigpLCBFYj0hMCk7RmIuYWRkKGEsdGhpcyk7dGhpcy5IYT0wO319O1xuZS5RYz1mdW5jdGlvbigpe2lmKHRoaXMudXx8dGhpcy5pYSlyZXR1cm4gdGhpcy5hLmNhKFwiUmVxdWVzdCBhbHJlYWR5IGluIHByb2dyZXNzXCIpLCAhMTtpZigzPD10aGlzLkhhKXJldHVybiExO3RoaXMuYS5kZWJ1ZyhcIkdvaW5nIHRvIHJldHJ5IEdFVFwiKTt0aGlzLnJjKys7dGhpcy5pYT1QKHUodGhpcy52ZSx0aGlzKSx0aGlzLlhkKHRoaXMuSGEpKTt0aGlzLkhhKys7cmV0dXJuITB9O2UudmU9ZnVuY3Rpb24oKXt0aGlzLmlhPW51bGw7dGhpcy5LZygpO307XG5lLktnPWZ1bmN0aW9uKCl7dGhpcy5hLmRlYnVnKFwiQ3JlYXRpbmcgbmV3IEh0dHBSZXF1ZXN0XCIpO3RoaXMudT1uZXcgUih0aGlzLHRoaXMuYSx0aGlzLnJhLFwicnBjXCIsdGhpcy5yYyk7bnVsbD09PXRoaXMuTiYmdGhpcy51LmdhKHRoaXMuQSk7dGhpcy51LkhlKHRoaXMuUmEpO3ZhciBhPXRoaXMubWQuY2xvbmUoKTthLmwoXCJSSURcIixcInJwY1wiKTthLmwoXCJTSURcIix0aGlzLnJhKTthLmwoXCJDSVwiLHRoaXMuZmQ/XCIwXCI6XCIxXCIpO2EubChcIkFJRFwiLHRoaXMuU2IpO3RoaXMuWWEoYSk7YS5sKFwiVFlQRVwiLFwieG1saHR0cFwiKTt0aGlzLk4mJnRoaXMuQSYmWmMoYSx0aGlzLk4sdGhpcy5BKTt0aGlzLkRiJiZ0aGlzLnUuc2V0VGltZW91dCh0aGlzLkRiKTt0aGlzLnUuamQoYSwhMCx0aGlzLm5hKTt0aGlzLmEuZGVidWcoXCJOZXcgUmVxdWVzdCBjcmVhdGVkXCIpO307XG5lLnViPWZ1bmN0aW9uKGEsYil7dGhpcy5hLmRlYnVnKFwiVGVzdCBDb25uZWN0aW9uIEZpbmlzaGVkXCIpO3ZhciBjPWEuQWQ7YyYmdGhpcy5HLmxkKGMpO3RoaXMuZmQ9dGhpcy5TZSYmYjt0aGlzLnc9YS53O3RoaXMuYWYoKTt9O2UuZGQ9ZnVuY3Rpb24oYSl7dGhpcy5hLmRlYnVnKFwiVGVzdCBDb25uZWN0aW9uIEZhaWxlZFwiKTt0aGlzLnc9YS53O3RoaXMuc2EoMik7fTtcbmUudWU9ZnVuY3Rpb24oYSxiKXtpZigwIT10aGlzLmcmJih0aGlzLnU9PWF8fHRoaXMuRy5KYyhhKSkpaWYodGhpcy53PWEudywgIWEubGImJnRoaXMuRy5KYyhhKSYmMz09dGhpcy5nKXt0cnl7dmFyIGM9dGhpcy5rYy56YyhiKTt9Y2F0Y2goZCl7Yz1udWxsO31uKGMpJiYzPT1jLmxlbmd0aD90aGlzLkNmKGMsYSk6KHRoaXMuYS5kZWJ1ZyhcIkJhZCBQT1NUIHJlc3BvbnNlIGRhdGEgcmV0dXJuZWRcIiksIHRoaXMuc2EoMTEpKTt9ZWxzZShhLmxifHx0aGlzLnU9PWEpJiZ0aGlzLkhiKCksIHZhKGIpfHwoYz10aGlzLmtjLnpjKGIpLCB0aGlzLmRnKGMsYSkpO307XG5lLkNmPWZ1bmN0aW9uKGEsYil7MD09YVswXT90aGlzLkJmKGIpOih0aGlzLmhlPWFbMV0sIGI9dGhpcy5oZS10aGlzLlNiLCAwPGImJihhPWFbMl0sIHRoaXMuYS5kZWJ1ZyhhK1wiIGJ5dGVzIChpbiBcIitiK1wiIGFycmF5cykgYXJlIG91dHN0YW5kaW5nIG9uIHRoZSBCYWNrQ2hhbm5lbFwiKSwgdGhpcy5KZyhhKSYmIXRoaXMud2EmJih0aGlzLndhPVAodSh0aGlzLmJnLHRoaXMpLDZFMykpKSk7fTtcbmUuQmY9ZnVuY3Rpb24oYSl7dGhpcy5hLmRlYnVnKFwiU2VydmVyIGNsYWltcyBvdXIgYmFja2NoYW5uZWwgaXMgbWlzc2luZy5cIik7aWYodGhpcy5pYSl0aGlzLmEuZGVidWcoXCJCdXQgd2UgYXJlIGN1cnJlbnRseSBzdGFydGluZyB0aGUgcmVxdWVzdC5cIik7ZWxzZXtpZih0aGlzLnUpaWYodGhpcy51LnFiKzNFMzxhLnFiKXRoaXMuSGIoKSwgdGhpcy51LmNhbmNlbCgpLCB0aGlzLnU9bnVsbDtlbHNlIHJldHVybjtlbHNlIHRoaXMuYS5UKFwiV2UgZG8gbm90IGhhdmUgYSBCYWNrQ2hhbm5lbCBlc3RhYmxpc2hlZFwiKTt0aGlzLlFjKCk7TygxOCk7fX07ZS5KZz1mdW5jdGlvbihhKXtyZXR1cm4gMzc1MDA+YSYmIXRoaXMuTmYoKSYmMD09dGhpcy5IYX07ZS4kYT1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5UZT90aGlzLmk/dGhpcy5pLiRhKGEpOmE6bnVsbH07XG5lLmJnPWZ1bmN0aW9uKCl7bnVsbCE9dGhpcy53YSYmKHRoaXMud2E9bnVsbCwgdGhpcy51LmNhbmNlbCgpLCB0aGlzLnU9bnVsbCwgdGhpcy5RYygpLCBPKDE5KSk7fTtlLkhiPWZ1bmN0aW9uKCl7bnVsbCE9dGhpcy53YSYmKGguY2xlYXJUaW1lb3V0KHRoaXMud2EpLCB0aGlzLndhPW51bGwpO307XG5lLlRjPWZ1bmN0aW9uKGEpe3RoaXMuYS5kZWJ1ZyhcIlJlcXVlc3QgY29tcGxldGVcIik7dmFyIGI9bnVsbDtpZih0aGlzLnU9PWEpe3RoaXMuSGIoKTt0aGlzLnU9bnVsbDt2YXIgYz0yO31lbHNlIGlmKHRoaXMuRy5KYyhhKSliPWEubGEoKSwgdGhpcy5HLnplKGEpLCBjPTE7ZWxzZSByZXR1cm47dGhpcy53PWEudztpZigwIT10aGlzLmcpaWYoYS5TKTE9PWM/KGFjKGEuRGE/YS5EYS5sZW5ndGg6MCx3KCktYS5xYix0aGlzLkxhKSwgdGhpcy5EYygpKTp0aGlzLktkKCk7ZWxzZXt2YXIgZD1hLkhjKCk7aWYoMz09ZHx8MD09ZCYmMDx0aGlzLncpdGhpcy5hLmRlYnVnKFwiTm90IHJldHJ5aW5nIGR1ZSB0byBlcnJvciB0eXBlXCIpO2Vsc2V7dmFyIGY9dGhpczt0aGlzLmEuZGVidWcoZnVuY3Rpb24oKXtyZXR1cm5cIk1heWJlIHJldHJ5aW5nLCBsYXN0IGVycm9yOiBcIitrYyhkLGYudyl9KTtpZigxPT1jJiZ0aGlzLllmKGEpfHwyPT1jJiZ0aGlzLlFjKCkpcmV0dXJuO3RoaXMuYS5kZWJ1ZyhcIkV4Y2VlZGVkIG1heCBudW1iZXIgb2YgcmV0cmllc1wiKTt9YiYmXG4wPGIubGVuZ3RoJiZ0aGlzLkcuUmUoYik7dGhpcy5hLmRlYnVnKFwiRXJyb3I6IEhUVFAgcmVxdWVzdCBmYWlsZWRcIik7c3dpdGNoKGQpe2Nhc2UgMTp0aGlzLnNhKDUpO2JyZWFrO2Nhc2UgNDp0aGlzLnNhKDEwKTticmVhaztjYXNlIDM6dGhpcy5zYSg2KTticmVhaztkZWZhdWx0OnRoaXMuc2EoMik7fX19O2UuWGQ9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5WZStNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqdGhpcy52Zyk7dGhpcy5CYSgpfHwodGhpcy5hLmRlYnVnKFwiSW5hY3RpdmUgY2hhbm5lbFwiKSwgYio9Mik7cmV0dXJuIGIqYX07ZS5wYz1mdW5jdGlvbihhKXtpZih0aGlzLnRhJiYoYT1hLmgpKXt2YXIgYj1hLmtiKFwiWC1DbGllbnQtV2lyZS1Qcm90b2NvbFwiKTtiJiZ0aGlzLkcubGQoYik7dGhpcy5hYSYmKChhPWEua2IoXCJYLUhUVFAtU2Vzc2lvbi1JZFwiKSk/KHRoaXMuRmUoYSksIHRoaXMuaGIubCh0aGlzLmFhLGEpKTp0aGlzLmEuVChcIk1pc3NpbmcgWF9IVFRQX1NFU1NJT05fSUQgaW4gdGhlIGhhbmRzaGFrZSByZXNwb25zZVwiKSk7fX07XG5lLmRnPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPXRoaXMuaSYmdGhpcy5pLnNjP1tdOm51bGwsZD0wO2Q8YS5sZW5ndGg7ZCsrKXt2YXIgZj1hW2RdO3RoaXMuU2I9ZlswXTtmPWZbMV07aWYoMj09dGhpcy5nKWlmKFwiY1wiPT1mWzBdKXt0aGlzLnJhPWZbMV07dGhpcy5uYT10aGlzLiRhKGZbMl0pO3ZhciBnPWZbM107bnVsbCE9ZyYmKHRoaXMudGM9ZywgdGhpcy5hLmluZm8oXCJWRVI9XCIrdGhpcy50YykpO2c9Zls0XTtudWxsIT1nJiYodGhpcy5EZT1nLCB0aGlzLmEuaW5mbyhcIlNWRVI9XCIrdGhpcy5EZSkpO2Y9Zls1XTtudWxsIT1mJiZcIm51bWJlclwiPT10eXBlb2YgZiYmMDxmJiYodGhpcy5EYj1mKj0xLjUsIHRoaXMuYS5pbmZvKFwiYmFja0NoYW5uZWxSZXF1ZXN0VGltZW91dE1zXz1cIitmKSk7dGhpcy5wYyhiKTt0aGlzLmc9Mzt0aGlzLmkmJnRoaXMuaS53ZCgpO3RoaXMuTGcoYik7fWVsc2VcInN0b3BcIiE9ZlswXSYmXCJjbG9zZVwiIT1mWzBdfHx0aGlzLnNhKDcpO2Vsc2UgMz09dGhpcy5nJiZcbihcInN0b3BcIj09ZlswXXx8XCJjbG9zZVwiPT1mWzBdPyhjJiYwIT1jLmxlbmd0aCYmKHRoaXMuaS5zYyh0aGlzLGMpLCBjLmxlbmd0aD0wKSwgXCJzdG9wXCI9PWZbMF0/dGhpcy5zYSg3KTp0aGlzLmRpc2Nvbm5lY3QoKSk6XCJub29wXCIhPWZbMF0mJihjP2MucHVzaChmKTp0aGlzLmkmJnRoaXMuaS51ZChmKSksIHRoaXMuSGE9MCk7fWMmJjAhPWMubGVuZ3RoJiZ0aGlzLmkuc2ModGhpcyxjKTt9O2UuTGc9ZnVuY3Rpb24oYSl7dGhpcy5tZD10aGlzLlBkKHRoaXMubmEsdGhpcy5LKTthLmxiPyh0aGlzLmEuZGVidWcoXCJVcGdyYWRlIHRoZSBoYW5kc2hha2UgcmVxdWVzdCB0byBhIGJhY2tjaGFubmVsLlwiKSwgdGhpcy5HLnplKGEpLCBhLnRnKHRoaXMuRGIpLCB0aGlzLnU9YSk6dGhpcy5LZCgpO307XG5lLnNhPWZ1bmN0aW9uKGEpe3RoaXMuYS5pbmZvKFwiRXJyb3IgY29kZSBcIithKTtpZigyPT1hKXt2YXIgYj1udWxsO3RoaXMuaSYmKGI9bnVsbCk7dmFyIGM9dSh0aGlzLlBnLHRoaXMpO2J8fChiPW5ldyBVKFwiLy93d3cuZ29vZ2xlLmNvbS9pbWFnZXMvY2xlYXJkb3QuZ2lmXCIpLCBoLmxvY2F0aW9uJiZcImh0dHBcIj09aC5sb2NhdGlvbi5wcm90b2NvbHx8Yi50YihcImh0dHBzXCIpLCBiLlViKCkpO1FjKGIudG9TdHJpbmcoKSxjKTt9ZWxzZSBPKDIpO3RoaXMuY2coYSk7fTtlLlBnPWZ1bmN0aW9uKGEpe2E/KHRoaXMuYS5pbmZvKFwiU3VjY2Vzc2Z1bGx5IHBpbmdlZCBnb29nbGUuY29tXCIpLCBPKDIpKToodGhpcy5hLmluZm8oXCJGYWlsZWQgdG8gcGluZyBnb29nbGUuY29tXCIpLCBPKDEpKTt9O2UuY2c9ZnVuY3Rpb24oYSl7dGhpcy5hLmRlYnVnKFwiSHR0cENoYW5uZWw6IGVycm9yIC0gXCIrYSk7dGhpcy5nPTA7dGhpcy5pJiZ0aGlzLmkudGQoYSk7dGhpcy5xZSgpO3RoaXMucWQoKTt9O1xuZS5xZT1mdW5jdGlvbigpe3RoaXMuZz0wO3RoaXMudz0tMTtpZih0aGlzLmkpe3ZhciBhPXRoaXMuRy5sYSgpO2lmKDAhPWEubGVuZ3RofHwwIT10aGlzLk0ubGVuZ3RoKXt2YXIgYj10aGlzO3RoaXMuYS5kZWJ1ZyhmdW5jdGlvbigpe3JldHVyblwiTnVtYmVyIG9mIHVuZGVsaXZlcmVkIG1hcHMsIHBlbmRpbmc6IFwiK2EubGVuZ3RoK1wiLCBvdXRnb2luZzogXCIrYi5NLmxlbmd0aH0pO3RoaXMuRy4kZSgpO3VhKHRoaXMuTSk7dGhpcy5NLmxlbmd0aD0wO310aGlzLmkuc2QoKTt9fTtlLlNkPWZ1bmN0aW9uKGEpe2E9dGhpcy5DZChudWxsLGEpO3RoaXMuYS5kZWJ1ZyhcIkdldEZvcndhcmRDaGFubmVsVXJpOiBcIithKTtyZXR1cm4gYX07ZS5QZD1mdW5jdGlvbihhLGIpe2E9dGhpcy5DZCh0aGlzLmZjKCk/YTpudWxsLGIpO3RoaXMuYS5kZWJ1ZyhcIkdldEJhY2tDaGFubmVsVXJpOiBcIithKTtyZXR1cm4gYX07XG5lLkNkPWZ1bmN0aW9uKGEsYil7dmFyIGM9QWMoYik7aWYoXCJcIiE9Yy54YSlhJiZjLnJiKGErXCIuXCIrYy54YSksIGMuc2IoYy5DYSk7ZWxzZXt2YXIgZD1oLmxvY2F0aW9uO2M9QmMoZC5wcm90b2NvbCxhP2ErXCIuXCIrZC5ob3N0bmFtZTpkLmhvc3RuYW1lLCtkLnBvcnQsYik7fXRoaXMuZ2ImJkFhKHRoaXMuZ2IsZnVuY3Rpb24oYSxiKXtjLmwoYixhKTt9KTthPXRoaXMuYWE7Yj10aGlzLktjO2EmJmImJmMubChhLGIpO2MubChcIlZFUlwiLHRoaXMudGMpO3RoaXMuWWEoYyk7cmV0dXJuIGN9O2UuSmI9ZnVuY3Rpb24oYSl7aWYoYSYmIXRoaXMuZ2MpdGhyb3cgRXJyb3IoXCJDYW4ndCBjcmVhdGUgc2Vjb25kYXJ5IGRvbWFpbiBjYXBhYmxlIFhocklvIG9iamVjdC5cIik7YT1uZXcgVih0aGlzLlhhKTthLkplKHRoaXMuZ2MpO3JldHVybiBhfTtlLkJhPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmkmJnRoaXMuaS5CYSgpfTtlLmZjPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2N9O2Z1bmN0aW9uIGFkKCl7fWU9YWQucHJvdG90eXBlO2Uuc2M9bnVsbDtlLndkPWZ1bmN0aW9uKCl7fTtlLnVkPWZ1bmN0aW9uKCl7fTtlLnRkPWZ1bmN0aW9uKCl7fTtlLnNkPWZ1bmN0aW9uKCl7fTtlLkJhPWZ1bmN0aW9uKCl7cmV0dXJuITB9O2UuVWU9ZnVuY3Rpb24oKXt9O2UuJGE9ZnVuY3Rpb24oYSl7cmV0dXJuIGF9O2Z1bmN0aW9uIGJkKGEpe2Zvcih2YXIgYj1hcmd1bWVudHNbMF0sYz0xO2M8YXJndW1lbnRzLmxlbmd0aDtjKyspe3ZhciBkPWFyZ3VtZW50c1tjXTtpZigwPT1kLmxhc3RJbmRleE9mKFwiL1wiLDApKWI9ZDtlbHNle3ZhciBmOyhmPVwiXCI9PWIpfHwoZj1iLmxlbmd0aC0xLCBmPTA8PWYmJmIuaW5kZXhPZihcIi9cIixmKT09Zik7Yj1mP2IrZDpiKyhcIi9cIitkKTt9fXJldHVybiBifWZ1bmN0aW9uIGNkKCl7aWYoQyYmISgxMDw9TnVtYmVyKFVhKSkpdGhyb3cgRXJyb3IoXCJFbnZpcm9ubWVudGFsIGVycm9yOiBubyBhdmFpbGFibGUgdHJhbnNwb3J0LlwiKTt9Y2QucHJvdG90eXBlLmNmPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBXKGEsYil9O1xuZnVuY3Rpb24gVyhhLGIpe0guY2FsbCh0aGlzKTt0aGlzLmI9bmV3ICRjKGIpO3RoaXMueWI9YTt0aGlzLlFnPWImJmIudGVzdFVybD9iLnRlc3RVcmw6YmQodGhpcy55YixcInRlc3RcIik7dGhpcy5zPVZiKFwiZ29vZy5sYWJzLm5ldC53ZWJDaGFubmVsLldlYkNoYW5uZWxCYXNlVHJhbnNwb3J0XCIpO3RoaXMuUmM9YiYmYi5tZXNzYWdlVXJsUGFyYW1zfHxudWxsO2E9YiYmYi5tZXNzYWdlSGVhZGVyc3x8bnVsbDtiJiZiLmNsaWVudFByb3RvY29sSGVhZGVyUmVxdWlyZWQmJihhP2FbXCJYLUNsaWVudC1Qcm90b2NvbFwiXT1cIndlYmNoYW5uZWxcIjphPXtcIlgtQ2xpZW50LVByb3RvY29sXCI6XCJ3ZWJjaGFubmVsXCJ9KTt0aGlzLmIuZ2EoYSk7YT1iJiZiLmluaXRNZXNzYWdlSGVhZGVyc3x8bnVsbDtiJiZiLm1lc3NhZ2VDb250ZW50VHlwZSYmKGE/YVtcIlgtV2ViQ2hhbm5lbC1Db250ZW50LVR5cGVcIl09Yi5tZXNzYWdlQ29udGVudFR5cGU6YT17XCJYLVdlYkNoYW5uZWwtQ29udGVudC1UeXBlXCI6Yi5tZXNzYWdlQ29udGVudFR5cGV9KTtcbmImJmIuemQmJihhP2FbXCJYLVdlYkNoYW5uZWwtQ2xpZW50LVByb2ZpbGVcIl09Yi56ZDphPXtcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiOmIuemR9KTt0aGlzLmIuRWcoYSk7KGE9YiYmYi5odHRwSGVhZGVyc092ZXJ3cml0ZVBhcmFtKSYmIXZhKGEpJiZ0aGlzLmIuQ2coYSk7dGhpcy5PZz1iJiZiLnN1cHBvcnRzQ3Jvc3NEb21haW5YaHJ8fCExO3RoaXMuemc9YiYmYi5zZW5kUmF3SnNvbnx8ITE7KGI9YiYmYi5odHRwU2Vzc2lvbklkUGFyYW0pJiYhdmEoYikmJih0aGlzLmIuRGcoYiksIGE9dGhpcy5SYywgbnVsbCE9PWEmJmIgaW4gYSYmKGE9dGhpcy5SYywgYiBpbiBhJiZkZWxldGUgYVtiXSwgKGE9dGhpcy5zKSYmYS5UKFwiSWdub3JlIGh0dHBTZXNzaW9uSWRQYXJhbSBhbHNvIHNwZWNpZmllZCB3aXRoIG1lc3NhZ2VVcmxQYXJhbXM6IFwiK2Isdm9pZCAwKSkpO3RoaXMudmQ9bmV3IFgodGhpcyk7fXgoVyxIKTtlPVcucHJvdG90eXBlO1xuZS5hZGRFdmVudExpc3RlbmVyPWZ1bmN0aW9uKGEsYixjLGQpe1cuTC5hZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcyxhLGIsYyxkKTt9O2UucmVtb3ZlRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyxkKXtXLkwucmVtb3ZlRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsYSxiLGMsZCk7fTtlLm9wZW49ZnVuY3Rpb24oKXt0aGlzLmIuRWUodGhpcy52ZCk7dGhpcy5PZyYmdGhpcy5iLkhnKCk7dGhpcy5iLmNvbm5lY3QodGhpcy5RZyx0aGlzLnliLHRoaXMuUmN8fHZvaWQgMCk7fTtlLmNsb3NlPWZ1bmN0aW9uKCl7dGhpcy5iLmRpc2Nvbm5lY3QoKTt9O2Uuc2VuZD1mdW5jdGlvbihhKXtpZihsKGEpKXt2YXIgYj17fTtiLl9fZGF0YV9fPWE7dGhpcy5iLlpjKGIpO31lbHNlIHRoaXMuemc/KGI9e30sIGIuX19kYXRhX189dWIoYSksIHRoaXMuYi5aYyhiKSk6dGhpcy5iLlpjKGEpO307XG5lLkY9ZnVuY3Rpb24oKXt0aGlzLmIuRWUobnVsbCk7ZGVsZXRlIHRoaXMudmQ7dGhpcy5iLmRpc2Nvbm5lY3QoKTtkZWxldGUgdGhpcy5iO1cuTC5GLmNhbGwodGhpcyk7fTtmdW5jdGlvbiBkZChhKXtmYy5jYWxsKHRoaXMpO3ZhciBiPWEuX19zbV9fO2lmKGIpe2E6e2Zvcih2YXIgYyBpbiBiKXthPWM7YnJlYWsgYX1hPXZvaWQgMDt9aWYodGhpcy5uZT1hKWE9dGhpcy5uZSwgYj1udWxsIT09YiYmYSBpbiBiP2JbYV06dm9pZCAwO3RoaXMuZGF0YT1iO31lbHNlIHRoaXMuZGF0YT1hO314KGRkLGZjKTtmdW5jdGlvbiBlZChhKXtnYy5jYWxsKHRoaXMpO3RoaXMuc3RhdHVzPTE7dGhpcy5lcnJvckNvZGU9YTt9eChlZCxnYyk7ZnVuY3Rpb24gWChhKXt0aGlzLmI9YTt9eChYLGFkKTtYLnByb3RvdHlwZS53ZD1mdW5jdGlvbigpe1diKHRoaXMuYi5zLFwiV2ViQ2hhbm5lbCBvcGVuZWQgb24gXCIrdGhpcy5iLnliKTt0aGlzLmIuZGlzcGF0Y2hFdmVudChcImFcIik7fTtYLnByb3RvdHlwZS51ZD1mdW5jdGlvbihhKXt0aGlzLmIuZGlzcGF0Y2hFdmVudChuZXcgZGQoYSkpO307XG5YLnByb3RvdHlwZS50ZD1mdW5jdGlvbihhKXtXYih0aGlzLmIucyxcIldlYkNoYW5uZWwgYWJvcnRlZCBvbiBcIit0aGlzLmIueWIrXCIgZHVlIHRvIGNoYW5uZWwgZXJyb3I6IFwiK2EpO3RoaXMuYi5kaXNwYXRjaEV2ZW50KG5ldyBlZChhKSk7fTtYLnByb3RvdHlwZS5zZD1mdW5jdGlvbigpe1diKHRoaXMuYi5zLFwiV2ViQ2hhbm5lbCBjbG9zZWQgb24gXCIrdGhpcy5iLnliKTt0aGlzLmIuZGlzcGF0Y2hFdmVudChcImJcIik7fTt2YXIgZmQ9dihmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGMoKXt9Yy5wcm90b3R5cGU9YS5wcm90b3R5cGU7dmFyIGQ9bmV3IGM7YS5hcHBseShkLEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSk7cmV0dXJuIGR9LGNkKTtmdW5jdGlvbiBnZCgpe3RoaXMuVj1bXTt0aGlzLlo9W107fWU9Z2QucHJvdG90eXBlO2UuVmY9ZnVuY3Rpb24oKXswPT10aGlzLlYubGVuZ3RoJiYodGhpcy5WPXRoaXMuWiwgdGhpcy5WLnJldmVyc2UoKSwgdGhpcy5aPVtdKTt9O2UuZW5xdWV1ZT1mdW5jdGlvbihhKXt0aGlzLloucHVzaChhKTt9O2UuYWI9ZnVuY3Rpb24oKXt0aGlzLlZmKCk7cmV0dXJuIHRoaXMuVi5wb3AoKX07ZS5DPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuVi5sZW5ndGgrdGhpcy5aLmxlbmd0aH07ZS5YPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PXRoaXMuVi5sZW5ndGgmJjA9PXRoaXMuWi5sZW5ndGh9O2UuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLlY9W107dGhpcy5aPVtdO307ZS5jb250YWlucz1mdW5jdGlvbihhKXtyZXR1cm4gMDw9bGEodGhpcy5WLGEpfHwwPD1sYSh0aGlzLlosYSl9O1xuZS5yZW1vdmU9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5WO3ZhciBjPW1hKGIsYSk7MDw9Yz8oQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGIsYywxKSwgYj0hMCk6Yj0hMTtyZXR1cm4gYnx8c2EodGhpcy5aLGEpfTtlLkg9ZnVuY3Rpb24oKXtmb3IodmFyIGE9W10sYj10aGlzLlYubGVuZ3RoLTE7MDw9YjstLWIpYS5wdXNoKHRoaXMuVltiXSk7dmFyIGM9dGhpcy5aLmxlbmd0aDtmb3IoYj0wO2I8YzsrK2IpYS5wdXNoKHRoaXMuWltiXSk7cmV0dXJuIGF9O2Z1bmN0aW9uIGhkKGEsYil7ei5jYWxsKHRoaXMpO3RoaXMub2U9YXx8MDt0aGlzLldiPWJ8fDEwO2lmKHRoaXMub2U+dGhpcy5XYil0aHJvdyBFcnJvcihpZCk7dGhpcy5mYT1uZXcgZ2Q7dGhpcy5vYT1uZXcgSmM7dGhpcy5BYz0wO3RoaXMuTmM9bnVsbDt0aGlzLkNiKCk7fXgoaGQseik7dmFyIGlkPVwiW2dvb2cuc3RydWN0cy5Qb29sXSBNaW4gY2FuIG5vdCBiZSBncmVhdGVyIHRoYW4gbWF4XCI7ZT1oZC5wcm90b3R5cGU7ZS5NYj1mdW5jdGlvbigpe3ZhciBhPXcoKTtpZighKG51bGwhPXRoaXMuTmMmJmEtdGhpcy5OYzx0aGlzLkFjKSl7dmFyIGI9dGhpcy5xZygpO2ImJih0aGlzLk5jPWEsIHRoaXMub2EuYWRkKGIpKTtyZXR1cm4gYn19O2Uub2c9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMub2EucmVtb3ZlKGEpPyh0aGlzLm5jKGEpLCAhMCk6ITF9O1xuZS5xZz1mdW5jdGlvbigpe2Zvcih2YXIgYTswPHRoaXMuVGQoKSYmKGE9dGhpcy5mYS5hYigpLCAhdGhpcy5TYyhhKSk7KXRoaXMuQ2IoKTshYSYmdGhpcy5DKCk8dGhpcy5XYiYmKGE9dGhpcy54YygpKTtyZXR1cm4gYX07ZS5uYz1mdW5jdGlvbihhKXt0aGlzLm9hLnJlbW92ZShhKTt0aGlzLlNjKGEpJiZ0aGlzLkMoKTx0aGlzLldiP3RoaXMuZmEuZW5xdWV1ZShhKTp0aGlzLkJjKGEpO307ZS5DYj1mdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmZhO3RoaXMuQygpPHRoaXMub2U7KWEuZW5xdWV1ZSh0aGlzLnhjKCkpO2Zvcig7dGhpcy5DKCk+dGhpcy5XYiYmMDx0aGlzLlRkKCk7KXRoaXMuQmMoYS5hYigpKTt9O2UueGM9ZnVuY3Rpb24oKXtyZXR1cm57fX07ZS5CYz1mdW5jdGlvbihhKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLmJiKWEuYmIoKTtlbHNlIGZvcih2YXIgYiBpbiBhKWFbYl09bnVsbDt9O1xuZS5TYz1mdW5jdGlvbihhKXtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiBhLlllP2EuWWUoKTohMH07ZS5jb250YWlucz1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5mYS5jb250YWlucyhhKXx8dGhpcy5vYS5jb250YWlucyhhKX07ZS5DPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmEuQygpK3RoaXMub2EuQygpfTtlLnJmPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub2EuQygpfTtlLlRkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmEuQygpfTtlLlg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mYS5YKCkmJnRoaXMub2EuWCgpfTtlLkY9ZnVuY3Rpb24oKXtoZC5MLkYuY2FsbCh0aGlzKTtpZigwPHRoaXMucmYoKSl0aHJvdyBFcnJvcihcIltnb29nLnN0cnVjdHMuUG9vbF0gT2JqZWN0cyBub3QgcmVsZWFzZWRcIik7ZGVsZXRlIHRoaXMub2E7Zm9yKHZhciBhPXRoaXMuZmE7IWEuWCgpOyl0aGlzLkJjKGEuYWIoKSk7ZGVsZXRlIHRoaXMuZmE7fTtmdW5jdGlvbiBqZChhLGIpe3RoaXMuZmU9YTt0aGlzLmdkPWI7fWpkLnByb3RvdHlwZS5nZXRLZXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mZX07amQucHJvdG90eXBlLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBqZCh0aGlzLmZlLHRoaXMuZ2QpfTtmdW5jdGlvbiBrZChhKXt0aGlzLlk9W107YSYmdGhpcy5MZihhKTt9ZT1rZC5wcm90b3R5cGU7ZS5jZT1mdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuWTtjLnB1c2gobmV3IGpkKGEsYikpO3RoaXMuJGYoYy5sZW5ndGgtMSk7fTtlLkxmPWZ1bmN0aW9uKGEpe2lmKGEgaW5zdGFuY2VvZiBrZCl7dmFyIGI9YS5XKCk7YT1hLkgoKTtpZigwPj10aGlzLkMoKSl7Zm9yKHZhciBjPXRoaXMuWSxkPTA7ZDxiLmxlbmd0aDtkKyspYy5wdXNoKG5ldyBqZChiW2RdLGFbZF0pKTtyZXR1cm59fWVsc2UgYj1DYShhKSwgYT1CYShhKTtmb3IoZD0wO2Q8Yi5sZW5ndGg7ZCsrKXRoaXMuY2UoYltkXSxhW2RdKTt9O2UucmVtb3ZlPWZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5ZLGI9YS5sZW5ndGgsYz1hWzBdO2lmKCEoMD49YikpcmV0dXJuIDE9PWI/cmEoYSk6KGFbMF09YS5wb3AoKSwgdGhpcy5aZigpKSwgYy5nZH07XG5lLlpmPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPTAsYj10aGlzLlksYz1iLmxlbmd0aCxkPWJbYV07YTxjPj4xOyl7dmFyIGY9dGhpcy50ZihhKSxnPXRoaXMuemYoYSk7Zj1nPGMmJmJbZ10uZ2V0S2V5KCk8YltmXS5nZXRLZXkoKT9nOmY7aWYoYltmXS5nZXRLZXkoKT5kLmdldEtleSgpKWJyZWFrO2JbYV09YltmXTthPWY7fWJbYV09ZDt9O2UuJGY9ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPXRoaXMuWSxjPWJbYV07MDxhOyl7dmFyIGQ9dGhpcy53ZihhKTtpZihiW2RdLmdldEtleSgpPmMuZ2V0S2V5KCkpYlthXT1iW2RdLCBhPWQ7ZWxzZSBicmVha31iW2FdPWM7fTtlLnRmPWZ1bmN0aW9uKGEpe3JldHVybiAyKmErMX07ZS56Zj1mdW5jdGlvbihhKXtyZXR1cm4gMiphKzJ9O2Uud2Y9ZnVuY3Rpb24oYSl7cmV0dXJuIGEtMT4+MX07ZS5IPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuWSxiPVtdLGM9YS5sZW5ndGgsZD0wO2Q8YztkKyspYi5wdXNoKGFbZF0uZ2QpO3JldHVybiBifTtcbmUuVz1mdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLlksYj1bXSxjPWEubGVuZ3RoLGQ9MDtkPGM7ZCsrKWIucHVzaChhW2RdLmdldEtleSgpKTtyZXR1cm4gYn07ZS52YT1mdW5jdGlvbihhKXtyZXR1cm4gb2EodGhpcy5ZLGZ1bmN0aW9uKGIpe3JldHVybiBiLmdldEtleSgpPT1hfSl9O2UuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGtkKHRoaXMpfTtlLkM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ZLmxlbmd0aH07ZS5YPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PXRoaXMuWS5sZW5ndGh9O2UuY2xlYXI9ZnVuY3Rpb24oKXtyYSh0aGlzLlkpO307ZnVuY3Rpb24gbGQoKXtrZC5jYWxsKHRoaXMpO314KGxkLGtkKTtsZC5wcm90b3R5cGUuZW5xdWV1ZT1mdW5jdGlvbihhLGIpe3RoaXMuY2UoYSxiKTt9O2xkLnByb3RvdHlwZS5hYj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlbW92ZSgpfTtmdW5jdGlvbiBZKGEsYil7dGhpcy5HZD12b2lkIDA7dGhpcy5jYz1uZXcgbGQ7aGQuY2FsbCh0aGlzLGEsYik7fXgoWSxoZCk7ZT1ZLnByb3RvdHlwZTtlLk1iPWZ1bmN0aW9uKGEsYil7aWYoIWEpcmV0dXJuKGE9WS5MLk1iLmNhbGwodGhpcykpJiZ0aGlzLkFjJiYodGhpcy5HZD1oLnNldFRpbWVvdXQodSh0aGlzLk5iLHRoaXMpLHRoaXMuQWMpKSwgYTt0aGlzLmNjLmVucXVldWUodm9pZCAwIT09Yj9iOjEwMCxhKTt0aGlzLk5iKCk7fTtlLk5iPWZ1bmN0aW9uKCl7Zm9yKHZhciBhPXRoaXMuY2M7MDxhLkMoKTspe3ZhciBiPXRoaXMuTWIoKTtpZihiKWEuYWIoKS5hcHBseSh0aGlzLFtiXSk7ZWxzZSBicmVha319O2UubmM9ZnVuY3Rpb24oYSl7WS5MLm5jLmNhbGwodGhpcyxhKTt0aGlzLk5iKCk7fTtlLkNiPWZ1bmN0aW9uKCl7WS5MLkNiLmNhbGwodGhpcyk7dGhpcy5OYigpO307XG5lLkY9ZnVuY3Rpb24oKXtZLkwuRi5jYWxsKHRoaXMpO2guY2xlYXJUaW1lb3V0KHRoaXMuR2QpO3RoaXMuY2MuY2xlYXIoKTt0aGlzLmNjPW51bGw7fTtmdW5jdGlvbiBaKGEsYixjLGQpe3RoaXMuSmY9YTt0aGlzLkFiPSEhZDtZLmNhbGwodGhpcyxiLGMpO314KFosWSk7Wi5wcm90b3R5cGUueGM9ZnVuY3Rpb24oKXt2YXIgYT1uZXcgVixiPXRoaXMuSmY7YiYmYi5mb3JFYWNoKGZ1bmN0aW9uKGIsZCl7YS5oZWFkZXJzLnNldChkLGIpO30pO3RoaXMuQWImJmEuSmUoITApO3JldHVybiBhfTtaLnByb3RvdHlwZS5TYz1mdW5jdGlvbihhKXtyZXR1cm4hYS5LYSYmIWEuQmEoKX07Y2QucHJvdG90eXBlLmNyZWF0ZVdlYkNoYW5uZWw9Y2QucHJvdG90eXBlLmNmO1cucHJvdG90eXBlLnNlbmQ9Vy5wcm90b3R5cGUuc2VuZDtXLnByb3RvdHlwZS5vcGVuPVcucHJvdG90eXBlLm9wZW47Vy5wcm90b3R5cGUuY2xvc2U9Vy5wcm90b3R5cGUuY2xvc2U7YmMuTk9fRVJST1I9MDtiYy5USU1FT1VUPTg7YmMuSFRUUF9FUlJPUj02O2NjLkNPTVBMRVRFPVwiY29tcGxldGVcIjtlYy5FdmVudFR5cGU9UTtRLk9QRU49XCJhXCI7US5DTE9TRT1cImJcIjtRLkVSUk9SPVwiY1wiO1EuTUVTU0FHRT1cImRcIjtILnByb3RvdHlwZS5saXN0ZW49SC5wcm90b3R5cGUubmI7Wi5wcm90b3R5cGUuZ2V0T2JqZWN0PVoucHJvdG90eXBlLk1iO1oucHJvdG90eXBlLnJlbGVhc2VPYmplY3Q9Wi5wcm90b3R5cGUub2c7Vi5wcm90b3R5cGUubGlzdGVuT25jZT1WLnByb3RvdHlwZS5PYztWLnByb3RvdHlwZS5nZXRMYXN0RXJyb3I9Vi5wcm90b3R5cGUuSGM7Vi5wcm90b3R5cGUuZ2V0TGFzdEVycm9yQ29kZT1WLnByb3RvdHlwZS5VZDtcblYucHJvdG90eXBlLmdldFN0YXR1cz1WLnByb3RvdHlwZS56YTtWLnByb3RvdHlwZS5nZXRTdGF0dXNUZXh0PVYucHJvdG90eXBlLllkO1YucHJvdG90eXBlLmdldFJlc3BvbnNlSnNvbj1WLnByb3RvdHlwZS55ZjtWLnByb3RvdHlwZS5nZXRSZXNwb25zZVRleHQ9Vi5wcm90b3R5cGUueWE7Vi5wcm90b3R5cGUuZ2V0UmVzcG9uc2VUZXh0PVYucHJvdG90eXBlLnlhO1YucHJvdG90eXBlLnNlbmQ9Vi5wcm90b3R5cGUuc2VuZDt2YXIgc3JjPXtjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0OmZkLEVycm9yQ29kZTpiYyxFdmVudFR5cGU6Y2MsV2ViQ2hhbm5lbDplYyxYaHJJb1Bvb2w6Wn07XG52YXIgc3JjXzEgPSBzcmMuY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydDtcbnZhciBzcmNfMiA9IHNyYy5FcnJvckNvZGU7XG52YXIgc3JjXzMgPSBzcmMuRXZlbnRUeXBlO1xudmFyIHNyY180ID0gc3JjLldlYkNoYW5uZWw7XG52YXIgc3JjXzUgPSBzcmMuWGhySW9Qb29sO1xuXG5leHBvcnQgZGVmYXVsdCBzcmM7XG5leHBvcnQgeyBzcmNfMSBhcyBjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0LCBzcmNfMiBhcyBFcnJvckNvZGUsIHNyY18zIGFzIEV2ZW50VHlwZSwgc3JjXzQgYXMgV2ViQ2hhbm5lbCwgc3JjXzUgYXMgWGhySW9Qb29sIH07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vQGZpcmViYXNlL3dlYmNoYW5uZWwtd3JhcHBlci9kaXN0L2luZGV4LmVzbS5qc1xuLy8gbW9kdWxlIGlkID0gMzlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLypcclxuICogUHJvdmlkZXMgYSBkZWNvcmF0b3IgZnVuY3RvciBmb3IgYW5ub3RhdGluZyBmdW5jdGlvbnMgaW4gQ29tcG9uZW50IGRlZmluaXRpb25zIHNvIHRoYXQgdGhleSBhcmUgYXV0b21hdGljYWxseVxyXG4gKiBib3VuZCBhbmQgdW5ib3VuZCBmcm9tIGV2ZW50cyB3aXRob3V0IG5lZWRpbmcgdG8gY2FsbCBlbC5hZGRFdmVudExpc3RlbmVyIG9yIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIgeW91cnNlbGYuXHJcbiAqXHJcbiAqIERlY29yYXRpb25zIHNob3VsZCBiZSBtYWRlIGluIHRoZSBDb21wb25lbnRzIGRlZmluaXRpb24gb2JqZWN0LiBIZXJlIGlzIHRoZSBzaW1wbGVzdCBleGFtcGxlOlxyXG4gKlxyXG4gKiBjb25zdCB7YmluZEV2ZW50fSA9IHJlcXVpcmUoJ2V2ZW50LWJpbmRlcicpO1xyXG4gKlxyXG4gKiBBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoXCJmb29cIiwge1xyXG4gKiAgIGNvbXBvbmVudGNoYW5nZWQ6IGJpbmRFdmVudCggZnVuY3Rpb24oZXZ0KSB7XHJcbiAqICAgICBjb25zb2xlLmxvZyhldnQuZGV0YWlsKTtcclxuICogICB9KVxyXG4gKiB9KVxyXG4gKlxyXG4gKiBCeSBkZWZhdWx0IHRoZSBmdW5jdGlvbiB3aWxsIGJlIGJvdW5kIHRvIGV2ZW50cyBjb3JyZXNwb25kaW5nIHRvIGl0cyBwcm9wZXJ0eSBuYW1lLCBpbiB0aGlzIGNhc2U6ICdjb21wb25lbnRjaGFuZ2VkJy5cclxuICogSXQgd2lsbCBsaXN0ZW4gZm9yIGV2ZW50cyBvbiBpdHMgcGFyZW50IGVsZW1lbnQsIGFuZCB3aWxsIGJlZ2luIGxpc3RlbmluZyBvciBlbmQgbGlzdGVuaW5nIHdoZW4gaW5pdCBvciByZW1vdmUgaXNcclxuICogY2FsbGVkLiBIb3dldmVyIHRoaXMgY2FuIGFsc28gYmUgY29uZmlndXJlZCBieSBwYXNzaW5nIGEgY29uZmlndXJhdGlvbiBvYmplY3Q6XHJcbiAqXHJcbiAqIEFGUkFNRS5yZWdpc3RlckNvbXBvbmVudChcImZvb1wiLCB7XHJcbiAqICAgd2hlblNjZW5lTG9hZHM6IGJpbmRFdmVudCgge1xyXG4gKiAgICAgZXZlbnQ6IFwibG9hZGVkXCIsICAgIC8vIEV2ZW50IHRvIGxpc3RlbiBmb3IuIERlZmF1bHRzIHRvIGZ1bmN0aW9ucyBwcm9wZXJ5IG5hbWUuXHJcbiAqICAgICB0YXJnZXQ6IFwiYS1zY2VuZVwiLCAgLy8gU2VsZWN0b3Igc3RyaW5nIGZvciB3aGljaCBlbGVtZW50IHRvIGxpc3RlbiBvbiwgZGVmYXVsdHMgdG8gdGhpcy5lbFxyXG4gKiAgICAgbGlzdGVuSW46IFwiaW5pdFwiLCAgIC8vIFdoaWNoIGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIgaXMgY2FsbGVkIGluLCBkZWZhdWx0cyB0byAnaW5pdCdcclxuICogICAgIHJlbW92ZUluOiBcInJlbW92ZVwiLCAvLyBXaGljaCBmdW5jdGlvbiByZW1vdmVFdmVudExpc3RlbmVyIGlzIGNhbGxlZCBpbiwgZGVmYXVsdHMgdG8gJ3JlbW92ZSdcclxuICogICB9LCBmdW5jdGlvbihldnQpIHtcclxuICogICAgIGNvbnNvbGUubG9nKGV2dC5kZXRhaWwpO1xyXG4gKiAgIH0pXHJcbiAqIH0pXHJcbiAqXHJcbiAqIEZ1bmN0aW9ucyB3aWxsIG9ubHkgYmUgYm91bmQgdG8gZXZlbnRzIHdoZW4gYSBuZXcgY29tcG9uZW50IGlzIGNyZWF0ZWQuIERlY29yYXRpbmcgYSBmdW5jdGlvbiB3aXRoIGJpbmRFdmVudCgpXHJcbiAqIGluIGEgY29tcG9uZW50cyBpbml0LCBvciB0aWNrIGZ1bmN0aW9ucyBmb3IgZXhhbXBsZSB3aWxsIGhhdmUgbm8gZWZmZWN0LlxyXG4gKlxyXG4gKiBEb24ndCBiaW5kIHRvIGFycm93IGZ1bmN0aW9ucyBiZWNhdXNlIHRoZXkgZG9uJ3QgaGF2ZSB0aGVpciBvd24gdGhpcy5cclxuICpcclxuICovXHJcblxyXG5jb25zdCBkZWNvcmF0ZSA9IHJlcXVpcmUoJy4vY29tcG9uZW50LWRlY29yYXRvcnMnKS5kZWNvcmF0ZTtcclxuXHJcbi8vIEltcGxlbWVudHMgdGhlIGF1dG9tYXRpYyBiaW5kaW5nIGFuZCB1bmJpbmRpbmcgb2YgdGhlIGNob3NlbiBmdW5jdGlvbi4gV3JhcHMgaXRzIGxpc3RlbkluIGFuZCByZW1vdmVJblxyXG4vLyBmdW5jdGlvbnMgdG8gYWRkIGFuZCByZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVyIGF0IHRoZSBjb3JyZWN0IHRpbWVzLlxyXG5mdW5jdGlvbiBCaW5kVG9FdmVudERlY29yYXRvcihfZXZlbnQsIF90YXJnZXQsIF9saXN0ZW5JbiwgX3JlbW92ZUluKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKHByb3BlcnR5TmFtZSwgZnVuYykge1xyXG4gICAgY29uc3Qgc2NvcGUgPSB0aGlzO1xyXG4gICAgY29uc3QgZXZlbnQgPSBfZXZlbnQgfHwgcHJvcGVydHlOYW1lO1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gIV90YXJnZXQgPyB0aGlzLmVsIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihfdGFyZ2V0KTtcclxuICAgIGlmICghdGFyZ2V0KSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIkNvdWxkbid0IHN1YnNjcmliZSBcIit0aGlzLm5hbWUrXCIuXCIrcHJvcGVydHlOYW1lK1wiIHRvIFwiK2V2ZW50K1wiIG9uIFwiK190YXJnZXRcclxuICAgICAgICArXCIgYmVjYXVzZSBxdWVyeVNlbGVjdG9yIHJldHVybmVkIHVuZGVmaW5lZC5cIik7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGxpc3RlbkluID0gX2xpc3RlbkluIHx8IFwiaW5pdFwiO1xyXG4gICAgY29uc3QgcmVtb3ZlSW4gPSBfcmVtb3ZlSW4gfHwgXCJyZW1vdmVcIjtcclxuXHJcbiAgICBjb25zdCBsaXN0ZW5GdW5jID0gdGhpc1tsaXN0ZW5Jbl07XHJcbiAgICBjb25zdCByZW1vdmVGdW5jID0gdGhpc1tyZW1vdmVJbl07XHJcbiAgICBjb25zdCBib3VuZEZ1bmMgPSBmdW5jLmJpbmQodGhpcyk7XHJcbiAgICBcclxuICAgIHRoaXNbbGlzdGVuSW5dID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmIChsaXN0ZW5GdW5jICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBsaXN0ZW5GdW5jLmFwcGx5KHNjb3BlLCBhcmd1bWVudHMpO1xyXG4gICAgICB9XHJcbiAgICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBib3VuZEZ1bmMpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXNbcmVtb3ZlSW5dID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgIGlmIChyZW1vdmVGdW5jICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZW1vdmVGdW5jLmFwcGx5KHNjb3BlLCBhcmd1bWVudHMpO1xyXG4gICAgICB9XHJcbiAgICAgIHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBib3VuZEZ1bmMpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmdW5jO1xyXG4gIH1cclxufVxyXG5cclxuLypcclxuICogRGVjb3JhdGVzIGEgZnVuY3Rpb24gd2l0aCBjb25maWd1cmF0aW9ucyBmb3IgYXV0b21hdGljYWxseSBiaW5kaW5nIHRvIGFuIGV2ZW50LlxyXG4gKlxyXG4gKiBAcGFyYW0gcDEgLSBJZiB0aGlzIGlzIGEgZnVuY3Rpb24gaXQgd2lsbCBiZSBkZWNvcmF0ZWQgd2l0aCBkZWZhdWx0IG9wdGlvbnMgYW5kIHAyIGlzIGlnbm9yZWQuIE90aGVyd2lzZSB0aGlzIGNhbiBiZVxyXG4gKiAgIGFuIG9iamVjdCB3aGljaCBmaW5lIHR1bmVzIHRoZSBiaW5kaW5nLlxyXG4gKiBAcGFyYW0gcDIgLSBJZiBwMSBpcyBhbiBvYmplY3QgdGhlbiB0aGlzIHdpbGwgYmUgdGhlIGZ1bmN0aW9uIHRvIGJpbmQgdG8uXHJcbiAqXHJcbiAqIEByZXR1cm5zIHtmdW5jdGlvbn0gRGVjb3JhdGVkIGZ1bmN0aW9uIHdoaWNoIHdyYXBzIHRoZSBpbnB1dCBmdW5jdGlvbi5cclxuICovXHJcbmZ1bmN0aW9uIGJpbmRFdmVudChwMSwgcDIpIHtcclxuICBpZiAodHlwZW9mIHAxID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgIHJldHVybiBkZWNvcmF0ZShwMSwgQmluZFRvRXZlbnREZWNvcmF0b3IoKSk7XHJcbiAgfSBlbHNlIGlmICh0eXBlb2YgcDEgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIHAyID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgIHJldHVybiBkZWNvcmF0ZShwMiwgQmluZFRvRXZlbnREZWNvcmF0b3IocDEuZXZlbnQsIHAxLnRhcmdldCwgcDEubGlzdGVuSW4sIHAxLnJlbW92ZUluKSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcImJpbmRFdmVudCBtdXN0IHRha2U6IChmdW5jdGlvbiksIG9yIGEgKFtvYmplY3RdLCBmdW5jdGlvbilcIilcclxuICB9XHJcbn1cclxuXHJcbi8qXHJcbiAqIENvbnZlbmllbmNlIGZ1bmN0aW9uLCB3aWxsIGFsd2F5cyBiaW5kL3VuYmluZCBsaXN0ZW5lciBpbiBwbGF5L3BhdXNlIGZ1bmN0aW9uLCByYXRoZXIgdGhhbiB0aGUgZGVmYXVsdCBpbml0L3JlbW92ZVxyXG4gKi9cclxuZnVuY3Rpb24gYmluZEV2ZW50UGxheVBhdXNlIChwMSwgcDIpIHtcclxuICBpZiAodHlwZW9mIHAxID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgIHJldHVybiBkZWNvcmF0ZShwMSwgQmluZFRvRXZlbnREZWNvcmF0b3IodW5kZWZpbmVkLCB1bmRlZmluZWQsIFwicGxheVwiLCBcInBhdXNlXCIpKTtcclxuICB9IGVsc2UgaWYgKHR5cGVvZiBwMSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcDIgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgcmV0dXJuIGRlY29yYXRlKHAyLCBCaW5kVG9FdmVudERlY29yYXRvcihwMS5ldmVudCwgcDEudGFyZ2V0LCBcInBsYXlcIiwgXCJwYXVzZVwiKSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcImJpbmRFdmVudFBsYXlQYXVzZSBtdXN0IHRha2U6IChmdW5jdGlvbiksIG9yIGEgKFtvYmplY3RdLCBmdW5jdGlvbilcIilcclxuICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzLmJpbmRFdmVudCA9IGJpbmRFdmVudDtcclxubW9kdWxlLmV4cG9ydHMuYmluZEV2ZW50UGxheVBhdXNlID0gYmluZEV2ZW50UGxheVBhdXNlO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtZXZlbnQtZGVjb3JhdG9ycy9ldmVudC1iaW5kZXIuanNcbi8vIG1vZHVsZSBpZCA9IDQwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxuICogQGF1dGhvciBtcmRvb2IgLyBodHRwOi8vbXJkb29iLmNvbS9cbiAqL1xuXG5USFJFRS5CdWZmZXJHZW9tZXRyeVV0aWxzID0ge1xuXG5cdGNvbXB1dGVUYW5nZW50czogZnVuY3Rpb24gKCBnZW9tZXRyeSApIHtcblxuXHRcdHZhciBpbmRleCA9IGdlb21ldHJ5LmluZGV4O1xuXHRcdHZhciBhdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlcztcblxuXHRcdC8vIGJhc2VkIG9uIGh0dHA6Ly93d3cudGVyYXRob24uY29tL2NvZGUvdGFuZ2VudC5odG1sXG5cdFx0Ly8gKHBlciB2ZXJ0ZXggdGFuZ2VudHMpXG5cblx0XHRpZiAoIGluZGV4ID09PSBudWxsIHx8XG5cdFx0XHQgYXR0cmlidXRlcy5wb3NpdGlvbiA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHQgYXR0cmlidXRlcy5ub3JtYWwgPT09IHVuZGVmaW5lZCB8fFxuXHRcdFx0IGF0dHJpYnV0ZXMudXYgPT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuQnVmZmVyR2VvbWV0cnk6IE1pc3NpbmcgcmVxdWlyZWQgYXR0cmlidXRlcyAoaW5kZXgsIHBvc2l0aW9uLCBub3JtYWwgb3IgdXYpIGluIEJ1ZmZlckdlb21ldHJ5LmNvbXB1dGVUYW5nZW50cygpJyApO1xuXHRcdFx0cmV0dXJuO1xuXG5cdFx0fVxuXG5cdFx0dmFyIGluZGljZXMgPSBpbmRleC5hcnJheTtcblx0XHR2YXIgcG9zaXRpb25zID0gYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTtcblx0XHR2YXIgbm9ybWFscyA9IGF0dHJpYnV0ZXMubm9ybWFsLmFycmF5O1xuXHRcdHZhciB1dnMgPSBhdHRyaWJ1dGVzLnV2LmFycmF5O1xuXG5cdFx0dmFyIG5WZXJ0aWNlcyA9IHBvc2l0aW9ucy5sZW5ndGggLyAzO1xuXG5cdFx0aWYgKCBhdHRyaWJ1dGVzLnRhbmdlbnQgPT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0Z2VvbWV0cnkuYWRkQXR0cmlidXRlKCAndGFuZ2VudCcsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoIG5ldyBGbG9hdDMyQXJyYXkoIDQgKiBuVmVydGljZXMgKSwgNCApICk7XG5cblx0XHR9XG5cblx0XHR2YXIgdGFuZ2VudHMgPSBhdHRyaWJ1dGVzLnRhbmdlbnQuYXJyYXk7XG5cblx0XHR2YXIgdGFuMSA9IFtdLCB0YW4yID0gW107XG5cblx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBuVmVydGljZXM7IGkgKysgKSB7XG5cblx0XHRcdHRhbjFbIGkgXSA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdFx0XHR0YW4yWyBpIF0gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdFx0fVxuXG5cdFx0dmFyIHZBID0gbmV3IFRIUkVFLlZlY3RvcjMoKSxcblx0XHRcdHZCID0gbmV3IFRIUkVFLlZlY3RvcjMoKSxcblx0XHRcdHZDID0gbmV3IFRIUkVFLlZlY3RvcjMoKSxcblxuXHRcdFx0dXZBID0gbmV3IFRIUkVFLlZlY3RvcjIoKSxcblx0XHRcdHV2QiA9IG5ldyBUSFJFRS5WZWN0b3IyKCksXG5cdFx0XHR1dkMgPSBuZXcgVEhSRUUuVmVjdG9yMigpLFxuXG5cdFx0XHRzZGlyID0gbmV3IFRIUkVFLlZlY3RvcjMoKSxcblx0XHRcdHRkaXIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdFx0ZnVuY3Rpb24gaGFuZGxlVHJpYW5nbGUoIGEsIGIsIGMgKSB7XG5cblx0XHRcdHZBLmZyb21BcnJheSggcG9zaXRpb25zLCBhICogMyApO1xuXHRcdFx0dkIuZnJvbUFycmF5KCBwb3NpdGlvbnMsIGIgKiAzICk7XG5cdFx0XHR2Qy5mcm9tQXJyYXkoIHBvc2l0aW9ucywgYyAqIDMgKTtcblxuXHRcdFx0dXZBLmZyb21BcnJheSggdXZzLCBhICogMiApO1xuXHRcdFx0dXZCLmZyb21BcnJheSggdXZzLCBiICogMiApO1xuXHRcdFx0dXZDLmZyb21BcnJheSggdXZzLCBjICogMiApO1xuXG5cdFx0XHR2YXIgeDEgPSB2Qi54IC0gdkEueDtcblx0XHRcdHZhciB4MiA9IHZDLnggLSB2QS54O1xuXG5cdFx0XHR2YXIgeTEgPSB2Qi55IC0gdkEueTtcblx0XHRcdHZhciB5MiA9IHZDLnkgLSB2QS55O1xuXG5cdFx0XHR2YXIgejEgPSB2Qi56IC0gdkEuejtcblx0XHRcdHZhciB6MiA9IHZDLnogLSB2QS56O1xuXG5cdFx0XHR2YXIgczEgPSB1dkIueCAtIHV2QS54O1xuXHRcdFx0dmFyIHMyID0gdXZDLnggLSB1dkEueDtcblxuXHRcdFx0dmFyIHQxID0gdXZCLnkgLSB1dkEueTtcblx0XHRcdHZhciB0MiA9IHV2Qy55IC0gdXZBLnk7XG5cblx0XHRcdHZhciByID0gMS4wIC8gKCBzMSAqIHQyIC0gczIgKiB0MSApO1xuXG5cdFx0XHRzZGlyLnNldChcblx0XHRcdFx0KCB0MiAqIHgxIC0gdDEgKiB4MiApICogcixcblx0XHRcdFx0KCB0MiAqIHkxIC0gdDEgKiB5MiApICogcixcblx0XHRcdFx0KCB0MiAqIHoxIC0gdDEgKiB6MiApICogclxuXHRcdFx0KTtcblxuXHRcdFx0dGRpci5zZXQoXG5cdFx0XHRcdCggczEgKiB4MiAtIHMyICogeDEgKSAqIHIsXG5cdFx0XHRcdCggczEgKiB5MiAtIHMyICogeTEgKSAqIHIsXG5cdFx0XHRcdCggczEgKiB6MiAtIHMyICogejEgKSAqIHJcblx0XHRcdCk7XG5cblx0XHRcdHRhbjFbIGEgXS5hZGQoIHNkaXIgKTtcblx0XHRcdHRhbjFbIGIgXS5hZGQoIHNkaXIgKTtcblx0XHRcdHRhbjFbIGMgXS5hZGQoIHNkaXIgKTtcblxuXHRcdFx0dGFuMlsgYSBdLmFkZCggdGRpciApO1xuXHRcdFx0dGFuMlsgYiBdLmFkZCggdGRpciApO1xuXHRcdFx0dGFuMlsgYyBdLmFkZCggdGRpciApO1xuXG5cdFx0fVxuXG5cdFx0dmFyIGdyb3VwcyA9IGdlb21ldHJ5Lmdyb3VwcztcblxuXHRcdGlmICggZ3JvdXBzLmxlbmd0aCA9PT0gMCApIHtcblxuXHRcdFx0Z3JvdXBzID0gWyB7XG5cdFx0XHRcdHN0YXJ0OiAwLFxuXHRcdFx0XHRjb3VudDogaW5kaWNlcy5sZW5ndGhcblx0XHRcdH0gXTtcblxuXHRcdH1cblxuXHRcdGZvciAoIHZhciBpID0gMCwgaWwgPSBncm91cHMubGVuZ3RoOyBpIDwgaWw7ICsrIGkgKSB7XG5cblx0XHRcdHZhciBncm91cCA9IGdyb3Vwc1sgaSBdO1xuXG5cdFx0XHR2YXIgc3RhcnQgPSBncm91cC5zdGFydDtcblx0XHRcdHZhciBjb3VudCA9IGdyb3VwLmNvdW50O1xuXG5cdFx0XHRmb3IgKCB2YXIgaiA9IHN0YXJ0LCBqbCA9IHN0YXJ0ICsgY291bnQ7IGogPCBqbDsgaiArPSAzICkge1xuXG5cdFx0XHRcdGhhbmRsZVRyaWFuZ2xlKFxuXHRcdFx0XHRcdGluZGljZXNbIGogKyAwIF0sXG5cdFx0XHRcdFx0aW5kaWNlc1sgaiArIDEgXSxcblx0XHRcdFx0XHRpbmRpY2VzWyBqICsgMiBdXG5cdFx0XHRcdCk7XG5cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdHZhciB0bXAgPSBuZXcgVEhSRUUuVmVjdG9yMygpLCB0bXAyID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0XHR2YXIgbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCksIG4yID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0XHR2YXIgdywgdCwgdGVzdDtcblxuXHRcdGZ1bmN0aW9uIGhhbmRsZVZlcnRleCggdiApIHtcblxuXHRcdFx0bi5mcm9tQXJyYXkoIG5vcm1hbHMsIHYgKiAzICk7XG5cdFx0XHRuMi5jb3B5KCBuICk7XG5cblx0XHRcdHQgPSB0YW4xWyB2IF07XG5cblx0XHRcdC8vIEdyYW0tU2NobWlkdCBvcnRob2dvbmFsaXplXG5cblx0XHRcdHRtcC5jb3B5KCB0ICk7XG5cdFx0XHR0bXAuc3ViKCBuLm11bHRpcGx5U2NhbGFyKCBuLmRvdCggdCApICkgKS5ub3JtYWxpemUoKTtcblxuXHRcdFx0Ly8gQ2FsY3VsYXRlIGhhbmRlZG5lc3NcblxuXHRcdFx0dG1wMi5jcm9zc1ZlY3RvcnMoIG4yLCB0ICk7XG5cdFx0XHR0ZXN0ID0gdG1wMi5kb3QoIHRhbjJbIHYgXSApO1xuXHRcdFx0dyA9ICggdGVzdCA8IDAuMCApID8gLSAxLjAgOiAxLjA7XG5cblx0XHRcdHRhbmdlbnRzWyB2ICogNCBdID0gdG1wLng7XG5cdFx0XHR0YW5nZW50c1sgdiAqIDQgKyAxIF0gPSB0bXAueTtcblx0XHRcdHRhbmdlbnRzWyB2ICogNCArIDIgXSA9IHRtcC56O1xuXHRcdFx0dGFuZ2VudHNbIHYgKiA0ICsgMyBdID0gdztcblxuXHRcdH1cblxuXHRcdGZvciAoIHZhciBpID0gMCwgaWwgPSBncm91cHMubGVuZ3RoOyBpIDwgaWw7ICsrIGkgKSB7XG5cblx0XHRcdHZhciBncm91cCA9IGdyb3Vwc1sgaSBdO1xuXG5cdFx0XHR2YXIgc3RhcnQgPSBncm91cC5zdGFydDtcblx0XHRcdHZhciBjb3VudCA9IGdyb3VwLmNvdW50O1xuXG5cdFx0XHRmb3IgKCB2YXIgaiA9IHN0YXJ0LCBqbCA9IHN0YXJ0ICsgY291bnQ7IGogPCBqbDsgaiArPSAzICkge1xuXG5cdFx0XHRcdGhhbmRsZVZlcnRleCggaW5kaWNlc1sgaiArIDAgXSApO1xuXHRcdFx0XHRoYW5kbGVWZXJ0ZXgoIGluZGljZXNbIGogKyAxIF0gKTtcblx0XHRcdFx0aGFuZGxlVmVydGV4KCBpbmRpY2VzWyBqICsgMiBdICk7XG5cblx0XHRcdH1cblxuXHRcdH1cblxuXHR9LFxuXG5cdC8qKlxuXHQgKiBAcGFyYW0gIHtBcnJheTxUSFJFRS5CdWZmZXJHZW9tZXRyeT59IGdlb21ldHJpZXNcblx0ICogQHJldHVybiB7VEhSRUUuQnVmZmVyR2VvbWV0cnl9XG5cdCAqL1xuXHRtZXJnZUJ1ZmZlckdlb21ldHJpZXM6IGZ1bmN0aW9uICggZ2VvbWV0cmllcywgdXNlR3JvdXBzICkge1xuXG5cdFx0dmFyIGlzSW5kZXhlZCA9IGdlb21ldHJpZXNbIDAgXS5pbmRleCAhPT0gbnVsbDtcblxuXHRcdHZhciBhdHRyaWJ1dGVzVXNlZCA9IG5ldyBTZXQoIE9iamVjdC5rZXlzKCBnZW9tZXRyaWVzWyAwIF0uYXR0cmlidXRlcyApICk7XG5cdFx0dmFyIG1vcnBoQXR0cmlidXRlc1VzZWQgPSBuZXcgU2V0KCBPYmplY3Qua2V5cyggZ2VvbWV0cmllc1sgMCBdLm1vcnBoQXR0cmlidXRlcyApICk7XG5cblx0XHR2YXIgYXR0cmlidXRlcyA9IHt9O1xuXHRcdHZhciBtb3JwaEF0dHJpYnV0ZXMgPSB7fTtcblxuXHRcdHZhciBtZXJnZWRHZW9tZXRyeSA9IG5ldyBUSFJFRS5CdWZmZXJHZW9tZXRyeSgpO1xuXG5cdFx0dmFyIG9mZnNldCA9IDA7XG5cblx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBnZW9tZXRyaWVzLmxlbmd0aDsgKysgaSApIHtcblxuXHRcdFx0dmFyIGdlb21ldHJ5ID0gZ2VvbWV0cmllc1sgaSBdO1xuXG5cdFx0XHQvLyBlbnN1cmUgdGhhdCBhbGwgZ2VvbWV0cmllcyBhcmUgaW5kZXhlZCwgb3Igbm9uZVxuXG5cdFx0XHRpZiAoIGlzSW5kZXhlZCAhPT0gKCBnZW9tZXRyeS5pbmRleCAhPT0gbnVsbCApICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdC8vIGdhdGhlciBhdHRyaWJ1dGVzLCBleGl0IGVhcmx5IGlmIHRoZXkncmUgZGlmZmVyZW50XG5cblx0XHRcdGZvciAoIHZhciBuYW1lIGluIGdlb21ldHJ5LmF0dHJpYnV0ZXMgKSB7XG5cblx0XHRcdFx0aWYgKCAhIGF0dHJpYnV0ZXNVc2VkLmhhcyggbmFtZSApICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdFx0aWYgKCBhdHRyaWJ1dGVzWyBuYW1lIF0gPT09IHVuZGVmaW5lZCApIGF0dHJpYnV0ZXNbIG5hbWUgXSA9IFtdO1xuXG5cdFx0XHRcdGF0dHJpYnV0ZXNbIG5hbWUgXS5wdXNoKCBnZW9tZXRyeS5hdHRyaWJ1dGVzWyBuYW1lIF0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBnYXRoZXIgbW9ycGggYXR0cmlidXRlcywgZXhpdCBlYXJseSBpZiB0aGV5J3JlIGRpZmZlcmVudFxuXG5cdFx0XHRmb3IgKCB2YXIgbmFtZSBpbiBnZW9tZXRyeS5tb3JwaEF0dHJpYnV0ZXMgKSB7XG5cblx0XHRcdFx0aWYgKCAhIG1vcnBoQXR0cmlidXRlc1VzZWQuaGFzKCBuYW1lICkgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0XHRpZiAoIG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdID09PSB1bmRlZmluZWQgKSBtb3JwaEF0dHJpYnV0ZXNbIG5hbWUgXSA9IFtdO1xuXG5cdFx0XHRcdG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdLnB1c2goIGdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1sgbmFtZSBdICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gZ2F0aGVyIC51c2VyRGF0YVxuXG4gICAgICBpZiAobWVyZ2VkR2VvbWV0cnkudXNlckRhdGEpIHtcblxuICAgICAgICBtZXJnZWRHZW9tZXRyeS51c2VyRGF0YS5tZXJnZWRVc2VyRGF0YSA9IG1lcmdlZEdlb21ldHJ5LnVzZXJEYXRhLm1lcmdlZFVzZXJEYXRhIHx8IFtdO1xuICAgICAgICBtZXJnZWRHZW9tZXRyeS51c2VyRGF0YS5tZXJnZWRVc2VyRGF0YS5wdXNoKCBnZW9tZXRyeS51c2VyRGF0YSApO1xuXG4gICAgICB9XG5cblx0XHRcdGlmICggdXNlR3JvdXBzICkge1xuXG5cdFx0XHRcdHZhciBjb3VudDtcblxuXHRcdFx0XHRpZiAoIGlzSW5kZXhlZCApIHtcblxuXHRcdFx0XHRcdGNvdW50ID0gZ2VvbWV0cnkuaW5kZXguY291bnQ7XG5cblx0XHRcdFx0fSBlbHNlIGlmICggZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbiAhPT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRcdFx0Y291bnQgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmNvdW50O1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0bWVyZ2VkR2VvbWV0cnkuYWRkR3JvdXAoIG9mZnNldCwgY291bnQsIGkgKTtcblxuXHRcdFx0XHRvZmZzZXQgKz0gY291bnQ7XG5cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdC8vIG1lcmdlIGluZGljZXNcblxuXHRcdGlmICggaXNJbmRleGVkICkge1xuXG5cdFx0XHR2YXIgaW5kZXhPZmZzZXQgPSAwO1xuXHRcdFx0dmFyIG1lcmdlZEluZGV4ID0gW107XG5cblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGdlb21ldHJpZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHRcdHZhciBpbmRleCA9IGdlb21ldHJpZXNbIGkgXS5pbmRleDtcblxuXHRcdFx0XHRmb3IgKCB2YXIgaiA9IDA7IGogPCBpbmRleC5jb3VudDsgKysgaiApIHtcblxuXHRcdFx0XHRcdG1lcmdlZEluZGV4LnB1c2goIGluZGV4LmdldFgoIGogKSArIGluZGV4T2Zmc2V0ICk7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGluZGV4T2Zmc2V0ICs9IGdlb21ldHJpZXNbIGkgXS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmNvdW50O1xuXG5cdFx0XHR9XG5cblx0XHRcdG1lcmdlZEdlb21ldHJ5LnNldEluZGV4KCBtZXJnZWRJbmRleCApO1xuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgYXR0cmlidXRlc1xuXG5cdFx0Zm9yICggdmFyIG5hbWUgaW4gYXR0cmlidXRlcyApIHtcblxuXHRcdFx0dmFyIG1lcmdlZEF0dHJpYnV0ZSA9IHRoaXMubWVyZ2VCdWZmZXJBdHRyaWJ1dGVzKCBhdHRyaWJ1dGVzWyBuYW1lIF0gKTtcblxuXHRcdFx0aWYgKCAhIG1lcmdlZEF0dHJpYnV0ZSApIHJldHVybiBudWxsO1xuXG5cdFx0XHRtZXJnZWRHZW9tZXRyeS5hZGRBdHRyaWJ1dGUoIG5hbWUsIG1lcmdlZEF0dHJpYnV0ZSApO1xuXG5cdFx0fVxuXG5cdFx0Ly8gbWVyZ2UgbW9ycGggYXR0cmlidXRlc1xuXG5cdFx0Zm9yICggdmFyIG5hbWUgaW4gbW9ycGhBdHRyaWJ1dGVzICkge1xuXG5cdFx0XHR2YXIgbnVtTW9ycGhUYXJnZXRzID0gbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF1bIDAgXS5sZW5ndGg7XG5cblx0XHRcdGlmICggbnVtTW9ycGhUYXJnZXRzID09PSAwICkgYnJlYWs7XG5cblx0XHRcdG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcyA9IG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcyB8fCB7fTtcblx0XHRcdG1lcmdlZEdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlc1sgbmFtZSBdID0gW107XG5cblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IG51bU1vcnBoVGFyZ2V0czsgKysgaSApIHtcblxuXHRcdFx0XHR2YXIgbW9ycGhBdHRyaWJ1dGVzVG9NZXJnZSA9IFtdO1xuXG5cdFx0XHRcdGZvciAoIHZhciBqID0gMDsgaiA8IG1vcnBoQXR0cmlidXRlc1sgbmFtZSBdLmxlbmd0aDsgKysgaiApIHtcblxuXHRcdFx0XHRcdG1vcnBoQXR0cmlidXRlc1RvTWVyZ2UucHVzaCggbW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF1bIGogXVsgaSBdICk7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdHZhciBtZXJnZWRNb3JwaEF0dHJpYnV0ZSA9IHRoaXMubWVyZ2VCdWZmZXJBdHRyaWJ1dGVzKCBtb3JwaEF0dHJpYnV0ZXNUb01lcmdlICk7XG5cblx0XHRcdFx0aWYgKCAhIG1lcmdlZE1vcnBoQXR0cmlidXRlICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdFx0bWVyZ2VkR2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzWyBuYW1lIF0ucHVzaCggbWVyZ2VkTW9ycGhBdHRyaWJ1dGUgKTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1lcmdlZEdlb21ldHJ5O1xuXG5cdH0sXG5cblx0LyoqXG5cdCAqIEBwYXJhbSB7QXJyYXk8VEhSRUUuQnVmZmVyQXR0cmlidXRlPn0gYXR0cmlidXRlc1xuXHQgKiBAcmV0dXJuIHtUSFJFRS5CdWZmZXJBdHRyaWJ1dGV9XG5cdCAqL1xuXHRtZXJnZUJ1ZmZlckF0dHJpYnV0ZXM6IGZ1bmN0aW9uICggYXR0cmlidXRlcyApIHtcblxuXHRcdHZhciBUeXBlZEFycmF5O1xuXHRcdHZhciBpdGVtU2l6ZTtcblx0XHR2YXIgbm9ybWFsaXplZDtcblx0XHR2YXIgYXJyYXlMZW5ndGggPSAwO1xuXG5cdFx0Zm9yICggdmFyIGkgPSAwOyBpIDwgYXR0cmlidXRlcy5sZW5ndGg7ICsrIGkgKSB7XG5cblx0XHRcdHZhciBhdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzWyBpIF07XG5cblx0XHRcdGlmICggYXR0cmlidXRlLmlzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0aWYgKCBUeXBlZEFycmF5ID09PSB1bmRlZmluZWQgKSBUeXBlZEFycmF5ID0gYXR0cmlidXRlLmFycmF5LmNvbnN0cnVjdG9yO1xuXHRcdFx0aWYgKCBUeXBlZEFycmF5ICE9PSBhdHRyaWJ1dGUuYXJyYXkuY29uc3RydWN0b3IgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0aWYgKCBpdGVtU2l6ZSA9PT0gdW5kZWZpbmVkICkgaXRlbVNpemUgPSBhdHRyaWJ1dGUuaXRlbVNpemU7XG5cdFx0XHRpZiAoIGl0ZW1TaXplICE9PSBhdHRyaWJ1dGUuaXRlbVNpemUgKSByZXR1cm4gbnVsbDtcblxuXHRcdFx0aWYgKCBub3JtYWxpemVkID09PSB1bmRlZmluZWQgKSBub3JtYWxpemVkID0gYXR0cmlidXRlLm5vcm1hbGl6ZWQ7XG5cdFx0XHRpZiAoIG5vcm1hbGl6ZWQgIT09IGF0dHJpYnV0ZS5ub3JtYWxpemVkICkgcmV0dXJuIG51bGw7XG5cblx0XHRcdGFycmF5TGVuZ3RoICs9IGF0dHJpYnV0ZS5hcnJheS5sZW5ndGg7XG5cblx0XHR9XG5cblx0XHR2YXIgYXJyYXkgPSBuZXcgVHlwZWRBcnJheSggYXJyYXlMZW5ndGggKTtcblx0XHR2YXIgb2Zmc2V0ID0gMDtcblxuXHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyArKyBpICkge1xuXG5cdFx0XHRhcnJheS5zZXQoIGF0dHJpYnV0ZXNbIGkgXS5hcnJheSwgb2Zmc2V0ICk7XG5cblx0XHRcdG9mZnNldCArPSBhdHRyaWJ1dGVzWyBpIF0uYXJyYXkubGVuZ3RoO1xuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoIGFycmF5LCBpdGVtU2l6ZSwgbm9ybWFsaXplZCApO1xuXG5cdH1cblxufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hZnJhbWUtZ2VvbWV0cnktbWVyZ2VyLWNvbXBvbmVudC9saWIvQnVmZmVyR2VvbWV0cnlVdGlscy5qc1xuLy8gbW9kdWxlIGlkID0gNDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXG4gKiBAYXV0aG9yIHFpYW8gLyBodHRwczovL2dpdGh1Yi5jb20vcWlhb1xuICogQGF1dGhvciBtcmRvb2IgLyBodHRwOi8vbXJkb29iLmNvbVxuICogQGF1dGhvciBhbHRlcmVkcSAvIGh0dHA6Ly9hbHRlcmVkcXVhbGlhLmNvbS9cbiAqIEBhdXRob3IgV2VzdExhbmdsZXkgLyBodHRwOi8vZ2l0aHViLmNvbS9XZXN0TGFuZ2xleVxuICogQGF1dGhvciBlcmljaDY2NiAvIGh0dHA6Ly9lcmljaGFpbmVzLmNvbVxuICovXG5cbi8vIFRoaXMgc2V0IG9mIGNvbnRyb2xzIHBlcmZvcm1zIG9yYml0aW5nLCBkb2xseWluZyAoem9vbWluZyksIGFuZCBwYW5uaW5nLlxuLy8gVW5saWtlIFRyYWNrYmFsbENvbnRyb2xzLCBpdCBtYWludGFpbnMgdGhlIFwidXBcIiBkaXJlY3Rpb24gb2JqZWN0LnVwICgrWSBieSBkZWZhdWx0KS5cbi8vXG4vLyAgICBPcmJpdCAtIGxlZnQgbW91c2UgLyB0b3VjaDogb25lIGZpbmdlciBtb3ZlXG4vLyAgICBab29tIC0gbWlkZGxlIG1vdXNlLCBvciBtb3VzZXdoZWVsIC8gdG91Y2g6IHR3byBmaW5nZXIgc3ByZWFkIG9yIHNxdWlzaFxuLy8gICAgUGFuIC0gcmlnaHQgbW91c2UsIG9yIGFycm93IGtleXMgLyB0b3VjaDogdGhyZWUgZmluZ2VyIHN3aXBlXG5cblRIUkVFLk9yYml0Q29udHJvbHMgPSBmdW5jdGlvbiAoIG9iamVjdCwgZG9tRWxlbWVudCApIHtcblxuXHR0aGlzLm9iamVjdCA9IG9iamVjdDtcblxuXHR0aGlzLmRvbUVsZW1lbnQgPSAoIGRvbUVsZW1lbnQgIT09IHVuZGVmaW5lZCApID8gZG9tRWxlbWVudCA6IGRvY3VtZW50O1xuXG5cdC8vIFNldCB0byBmYWxzZSB0byBkaXNhYmxlIHRoaXMgY29udHJvbFxuXHR0aGlzLmVuYWJsZWQgPSB0cnVlO1xuXG5cdC8vIFwidGFyZ2V0XCIgc2V0cyB0aGUgbG9jYXRpb24gb2YgZm9jdXMsIHdoZXJlIHRoZSBvYmplY3Qgb3JiaXRzIGFyb3VuZFxuXHR0aGlzLnRhcmdldCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cblx0Ly8gSG93IGZhciB5b3UgY2FuIGRvbGx5IGluIGFuZCBvdXQgKCBQZXJzcGVjdGl2ZUNhbWVyYSBvbmx5IClcblx0dGhpcy5taW5EaXN0YW5jZSA9IDA7XG5cdHRoaXMubWF4RGlzdGFuY2UgPSBJbmZpbml0eTtcblxuXHQvLyBIb3cgZmFyIHlvdSBjYW4gem9vbSBpbiBhbmQgb3V0ICggT3J0aG9ncmFwaGljQ2FtZXJhIG9ubHkgKVxuXHR0aGlzLm1pblpvb20gPSAwO1xuXHR0aGlzLm1heFpvb20gPSBJbmZpbml0eTtcblxuXHQvLyBIb3cgZmFyIHlvdSBjYW4gb3JiaXQgdmVydGljYWxseSwgdXBwZXIgYW5kIGxvd2VyIGxpbWl0cy5cblx0Ly8gUmFuZ2UgaXMgMCB0byBNYXRoLlBJIHJhZGlhbnMuXG5cdHRoaXMubWluUG9sYXJBbmdsZSA9IDA7IC8vIHJhZGlhbnNcblx0dGhpcy5tYXhQb2xhckFuZ2xlID0gTWF0aC5QSTsgLy8gcmFkaWFuc1xuXG5cdC8vIEhvdyBmYXIgeW91IGNhbiBvcmJpdCBob3Jpem9udGFsbHksIHVwcGVyIGFuZCBsb3dlciBsaW1pdHMuXG5cdC8vIElmIHNldCwgbXVzdCBiZSBhIHN1Yi1pbnRlcnZhbCBvZiB0aGUgaW50ZXJ2YWwgWyAtIE1hdGguUEksIE1hdGguUEkgXS5cblx0dGhpcy5taW5BemltdXRoQW5nbGUgPSAtIEluZmluaXR5OyAvLyByYWRpYW5zXG5cdHRoaXMubWF4QXppbXV0aEFuZ2xlID0gSW5maW5pdHk7IC8vIHJhZGlhbnNcblxuXHQvLyBTZXQgdG8gdHJ1ZSB0byBlbmFibGUgZGFtcGluZyAoaW5lcnRpYSlcblx0Ly8gSWYgZGFtcGluZyBpcyBlbmFibGVkLCB5b3UgbXVzdCBjYWxsIGNvbnRyb2xzLnVwZGF0ZSgpIGluIHlvdXIgYW5pbWF0aW9uIGxvb3Bcblx0dGhpcy5lbmFibGVEYW1waW5nID0gZmFsc2U7XG5cdHRoaXMuZGFtcGluZ0ZhY3RvciA9IDAuMjU7XG5cblx0Ly8gVGhpcyBvcHRpb24gYWN0dWFsbHkgZW5hYmxlcyBkb2xseWluZyBpbiBhbmQgb3V0OyBsZWZ0IGFzIFwiem9vbVwiIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS5cblx0Ly8gU2V0IHRvIGZhbHNlIHRvIGRpc2FibGUgem9vbWluZ1xuXHR0aGlzLmVuYWJsZVpvb20gPSB0cnVlO1xuXHR0aGlzLnpvb21TcGVlZCA9IDEuMDtcblxuXHQvLyBTZXQgdG8gZmFsc2UgdG8gZGlzYWJsZSByb3RhdGluZ1xuXHR0aGlzLmVuYWJsZVJvdGF0ZSA9IHRydWU7XG5cdHRoaXMucm90YXRlU3BlZWQgPSAxLjA7XG5cblx0Ly8gU2V0IHRvIGZhbHNlIHRvIGRpc2FibGUgcGFubmluZ1xuXHR0aGlzLmVuYWJsZVBhbiA9IHRydWU7XG5cdHRoaXMua2V5UGFuU3BlZWQgPSA3LjA7XHQvLyBwaXhlbHMgbW92ZWQgcGVyIGFycm93IGtleSBwdXNoXG5cblx0Ly8gU2V0IHRvIHRydWUgdG8gYXV0b21hdGljYWxseSByb3RhdGUgYXJvdW5kIHRoZSB0YXJnZXRcblx0Ly8gSWYgYXV0by1yb3RhdGUgaXMgZW5hYmxlZCwgeW91IG11c3QgY2FsbCBjb250cm9scy51cGRhdGUoKSBpbiB5b3VyIGFuaW1hdGlvbiBsb29wXG5cdHRoaXMuYXV0b1JvdGF0ZSA9IGZhbHNlO1xuXHR0aGlzLmF1dG9Sb3RhdGVTcGVlZCA9IDIuMDsgLy8gMzAgc2Vjb25kcyBwZXIgcm91bmQgd2hlbiBmcHMgaXMgNjBcblxuXHQvLyBTZXQgdG8gZmFsc2UgdG8gZGlzYWJsZSB1c2Ugb2YgdGhlIGtleXNcblx0dGhpcy5lbmFibGVLZXlzID0gdHJ1ZTtcblxuXHQvLyBUaGUgZm91ciBhcnJvdyBrZXlzXG5cdHRoaXMua2V5cyA9IHsgTEVGVDogMzcsIFVQOiAzOCwgUklHSFQ6IDM5LCBCT1RUT006IDQwIH07XG5cblx0Ly8gTW91c2UgYnV0dG9uc1xuXHR0aGlzLm1vdXNlQnV0dG9ucyA9IHsgT1JCSVQ6IFRIUkVFLk1PVVNFLkxFRlQsIFpPT006IFRIUkVFLk1PVVNFLk1JRERMRSwgUEFOOiBUSFJFRS5NT1VTRS5SSUdIVCB9O1xuXG5cdC8vIGZvciByZXNldFxuXHR0aGlzLnRhcmdldDAgPSB0aGlzLnRhcmdldC5jbG9uZSgpO1xuXHR0aGlzLnBvc2l0aW9uMCA9IHRoaXMub2JqZWN0LnBvc2l0aW9uLmNsb25lKCk7XG5cdHRoaXMuem9vbTAgPSB0aGlzLm9iamVjdC56b29tO1xuXG5cdC8vXG5cdC8vIHB1YmxpYyBtZXRob2RzXG5cdC8vXG5cblx0dGhpcy5nZXRQb2xhckFuZ2xlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0cmV0dXJuIHNwaGVyaWNhbC5waGk7XG5cblx0fTtcblxuXHR0aGlzLmdldEF6aW11dGhhbEFuZ2xlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0cmV0dXJuIHNwaGVyaWNhbC50aGV0YTtcblxuXHR9O1xuXG5cdHRoaXMuc2F2ZVN0YXRlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0c2NvcGUudGFyZ2V0MC5jb3B5KCBzY29wZS50YXJnZXQgKTtcblx0XHRzY29wZS5wb3NpdGlvbjAuY29weSggc2NvcGUub2JqZWN0LnBvc2l0aW9uICk7XG5cdFx0c2NvcGUuem9vbTAgPSBzY29wZS5vYmplY3Quem9vbTtcblxuXHR9O1xuXG5cdHRoaXMucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRzY29wZS50YXJnZXQuY29weSggc2NvcGUudGFyZ2V0MCApO1xuXHRcdHNjb3BlLm9iamVjdC5wb3NpdGlvbi5jb3B5KCBzY29wZS5wb3NpdGlvbjAgKTtcblx0XHRzY29wZS5vYmplY3Quem9vbSA9IHNjb3BlLnpvb20wO1xuXG5cdFx0c2NvcGUub2JqZWN0LnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcblx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCBjaGFuZ2VFdmVudCApO1xuXG5cdFx0c2NvcGUudXBkYXRlKCk7XG5cblx0XHRzdGF0ZSA9IFNUQVRFLk5PTkU7XG5cblx0fTtcblxuXHQvLyB0aGlzIG1ldGhvZCBpcyBleHBvc2VkLCBidXQgcGVyaGFwcyBpdCB3b3VsZCBiZSBiZXR0ZXIgaWYgd2UgY2FuIG1ha2UgaXQgcHJpdmF0ZS4uLlxuXHR0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciBvZmZzZXQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdFx0Ly8gc28gY2FtZXJhLnVwIGlzIHRoZSBvcmJpdCBheGlzXG5cdFx0dmFyIHF1YXQgPSBuZXcgVEhSRUUuUXVhdGVybmlvbigpLnNldEZyb21Vbml0VmVjdG9ycyggb2JqZWN0LnVwLCBuZXcgVEhSRUUuVmVjdG9yMyggMCwgMSwgMCApICk7XG5cdFx0dmFyIHF1YXRJbnZlcnNlID0gcXVhdC5jbG9uZSgpLmludmVyc2UoKTtcblxuXHRcdHZhciBsYXN0UG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHRcdHZhciBsYXN0UXVhdGVybmlvbiA9IG5ldyBUSFJFRS5RdWF0ZXJuaW9uKCk7XG5cblx0XHRyZXR1cm4gZnVuY3Rpb24gdXBkYXRlKCkge1xuXG5cdFx0XHR2YXIgcG9zaXRpb24gPSBzY29wZS5vYmplY3QucG9zaXRpb247XG5cblx0XHRcdG9mZnNldC5jb3B5KCBwb3NpdGlvbiApLnN1Yiggc2NvcGUudGFyZ2V0ICk7XG5cblx0XHRcdC8vIHJvdGF0ZSBvZmZzZXQgdG8gXCJ5LWF4aXMtaXMtdXBcIiBzcGFjZVxuXHRcdFx0b2Zmc2V0LmFwcGx5UXVhdGVybmlvbiggcXVhdCApO1xuXG5cdFx0XHQvLyBhbmdsZSBmcm9tIHotYXhpcyBhcm91bmQgeS1heGlzXG5cdFx0XHRzcGhlcmljYWwuc2V0RnJvbVZlY3RvcjMoIG9mZnNldCApO1xuXG5cdFx0XHRpZiAoIHNjb3BlLmF1dG9Sb3RhdGUgJiYgc3RhdGUgPT09IFNUQVRFLk5PTkUgKSB7XG5cblx0XHRcdFx0cm90YXRlTGVmdCggZ2V0QXV0b1JvdGF0aW9uQW5nbGUoKSApO1xuXG5cdFx0XHR9XG5cblx0XHRcdHNwaGVyaWNhbC50aGV0YSArPSBzcGhlcmljYWxEZWx0YS50aGV0YTtcblx0XHRcdHNwaGVyaWNhbC5waGkgKz0gc3BoZXJpY2FsRGVsdGEucGhpO1xuXG5cdFx0XHQvLyByZXN0cmljdCB0aGV0YSB0byBiZSBiZXR3ZWVuIGRlc2lyZWQgbGltaXRzXG5cdFx0XHRzcGhlcmljYWwudGhldGEgPSBNYXRoLm1heCggc2NvcGUubWluQXppbXV0aEFuZ2xlLCBNYXRoLm1pbiggc2NvcGUubWF4QXppbXV0aEFuZ2xlLCBzcGhlcmljYWwudGhldGEgKSApO1xuXG5cdFx0XHQvLyByZXN0cmljdCBwaGkgdG8gYmUgYmV0d2VlbiBkZXNpcmVkIGxpbWl0c1xuXHRcdFx0c3BoZXJpY2FsLnBoaSA9IE1hdGgubWF4KCBzY29wZS5taW5Qb2xhckFuZ2xlLCBNYXRoLm1pbiggc2NvcGUubWF4UG9sYXJBbmdsZSwgc3BoZXJpY2FsLnBoaSApICk7XG5cblx0XHRcdHNwaGVyaWNhbC5tYWtlU2FmZSgpO1xuXG5cblx0XHRcdHNwaGVyaWNhbC5yYWRpdXMgKj0gc2NhbGU7XG5cblx0XHRcdC8vIHJlc3RyaWN0IHJhZGl1cyB0byBiZSBiZXR3ZWVuIGRlc2lyZWQgbGltaXRzXG5cdFx0XHRzcGhlcmljYWwucmFkaXVzID0gTWF0aC5tYXgoIHNjb3BlLm1pbkRpc3RhbmNlLCBNYXRoLm1pbiggc2NvcGUubWF4RGlzdGFuY2UsIHNwaGVyaWNhbC5yYWRpdXMgKSApO1xuXG5cdFx0XHQvLyBtb3ZlIHRhcmdldCB0byBwYW5uZWQgbG9jYXRpb25cblx0XHRcdHNjb3BlLnRhcmdldC5hZGQoIHBhbk9mZnNldCApO1xuXG5cdFx0XHRvZmZzZXQuc2V0RnJvbVNwaGVyaWNhbCggc3BoZXJpY2FsICk7XG5cblx0XHRcdC8vIHJvdGF0ZSBvZmZzZXQgYmFjayB0byBcImNhbWVyYS11cC12ZWN0b3ItaXMtdXBcIiBzcGFjZVxuXHRcdFx0b2Zmc2V0LmFwcGx5UXVhdGVybmlvbiggcXVhdEludmVyc2UgKTtcblxuXHRcdFx0cG9zaXRpb24uY29weSggc2NvcGUudGFyZ2V0ICkuYWRkKCBvZmZzZXQgKTtcblxuXHRcdFx0c2NvcGUub2JqZWN0Lmxvb2tBdCggc2NvcGUudGFyZ2V0ICk7XG5cblx0XHRcdGlmICggc2NvcGUuZW5hYmxlRGFtcGluZyA9PT0gdHJ1ZSApIHtcblxuXHRcdFx0XHRzcGhlcmljYWxEZWx0YS50aGV0YSAqPSAoIDEgLSBzY29wZS5kYW1waW5nRmFjdG9yICk7XG5cdFx0XHRcdHNwaGVyaWNhbERlbHRhLnBoaSAqPSAoIDEgLSBzY29wZS5kYW1waW5nRmFjdG9yICk7XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0c3BoZXJpY2FsRGVsdGEuc2V0KCAwLCAwLCAwICk7XG5cblx0XHRcdH1cblxuXHRcdFx0c2NhbGUgPSAxO1xuXHRcdFx0cGFuT2Zmc2V0LnNldCggMCwgMCwgMCApO1xuXG5cdFx0XHQvLyB1cGRhdGUgY29uZGl0aW9uIGlzOlxuXHRcdFx0Ly8gbWluKGNhbWVyYSBkaXNwbGFjZW1lbnQsIGNhbWVyYSByb3RhdGlvbiBpbiByYWRpYW5zKV4yID4gRVBTXG5cdFx0XHQvLyB1c2luZyBzbWFsbC1hbmdsZSBhcHByb3hpbWF0aW9uIGNvcyh4LzIpID0gMSAtIHheMiAvIDhcblxuXHRcdFx0aWYgKCB6b29tQ2hhbmdlZCB8fFxuXHRcdFx0XHRsYXN0UG9zaXRpb24uZGlzdGFuY2VUb1NxdWFyZWQoIHNjb3BlLm9iamVjdC5wb3NpdGlvbiApID4gRVBTIHx8XG5cdFx0XHRcdDggKiAoIDEgLSBsYXN0UXVhdGVybmlvbi5kb3QoIHNjb3BlLm9iamVjdC5xdWF0ZXJuaW9uICkgKSA+IEVQUyApIHtcblxuXHRcdFx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCBjaGFuZ2VFdmVudCApO1xuXG5cdFx0XHRcdGxhc3RQb3NpdGlvbi5jb3B5KCBzY29wZS5vYmplY3QucG9zaXRpb24gKTtcblx0XHRcdFx0bGFzdFF1YXRlcm5pb24uY29weSggc2NvcGUub2JqZWN0LnF1YXRlcm5pb24gKTtcblx0XHRcdFx0em9vbUNoYW5nZWQgPSBmYWxzZTtcblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cblx0XHR9O1xuXG5cdH0oKTtcblxuXHR0aGlzLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdjb250ZXh0bWVudScsIG9uQ29udGV4dE1lbnUsIGZhbHNlICk7XG5cdFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vkb3duJywgb25Nb3VzZURvd24sIGZhbHNlICk7XG5cdFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnd2hlZWwnLCBvbk1vdXNlV2hlZWwsIGZhbHNlICk7XG5cblx0XHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd0b3VjaHN0YXJ0Jywgb25Ub3VjaFN0YXJ0LCBmYWxzZSApO1xuXHRcdHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3RvdWNoZW5kJywgb25Ub3VjaEVuZCwgZmFsc2UgKTtcblx0XHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd0b3VjaG1vdmUnLCBvblRvdWNoTW92ZSwgZmFsc2UgKTtcblxuXHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSwgZmFsc2UgKTtcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UgKTtcblxuXHRcdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIG9uS2V5RG93biwgZmFsc2UgKTtcblxuXHRcdC8vc2NvcGUuZGlzcGF0Y2hFdmVudCggeyB0eXBlOiAnZGlzcG9zZScgfSApOyAvLyBzaG91bGQgdGhpcyBiZSBhZGRlZCBoZXJlP1xuXG5cdH07XG5cblx0Ly9cblx0Ly8gaW50ZXJuYWxzXG5cdC8vXG5cblx0dmFyIHNjb3BlID0gdGhpcztcblxuXHR2YXIgY2hhbmdlRXZlbnQgPSB7IHR5cGU6ICdjaGFuZ2UnIH07XG5cdHZhciBzdGFydEV2ZW50ID0geyB0eXBlOiAnc3RhcnQnIH07XG5cdHZhciBlbmRFdmVudCA9IHsgdHlwZTogJ2VuZCcgfTtcblxuXHR2YXIgU1RBVEUgPSB7IE5PTkU6IC0gMSwgUk9UQVRFOiAwLCBET0xMWTogMSwgUEFOOiAyLCBUT1VDSF9ST1RBVEU6IDMsIFRPVUNIX0RPTExZOiA0LCBUT1VDSF9QQU46IDUgfTtcblxuXHR2YXIgc3RhdGUgPSBTVEFURS5OT05FO1xuXG5cdHZhciBFUFMgPSAwLjAwMDAwMTtcblxuXHQvLyBjdXJyZW50IHBvc2l0aW9uIGluIHNwaGVyaWNhbCBjb29yZGluYXRlc1xuXHR2YXIgc3BoZXJpY2FsID0gbmV3IFRIUkVFLlNwaGVyaWNhbCgpO1xuXHR2YXIgc3BoZXJpY2FsRGVsdGEgPSBuZXcgVEhSRUUuU3BoZXJpY2FsKCk7XG5cblx0dmFyIHNjYWxlID0gMTtcblx0dmFyIHBhbk9mZnNldCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdHZhciB6b29tQ2hhbmdlZCA9IGZhbHNlO1xuXG5cdHZhciByb3RhdGVTdGFydCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cdHZhciByb3RhdGVFbmQgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXHR2YXIgcm90YXRlRGVsdGEgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXG5cdHZhciBwYW5TdGFydCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cdHZhciBwYW5FbmQgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXHR2YXIgcGFuRGVsdGEgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXG5cdHZhciBkb2xseVN0YXJ0ID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblx0dmFyIGRvbGx5RW5kID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcblx0dmFyIGRvbGx5RGVsdGEgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xuXG5cdGZ1bmN0aW9uIGdldEF1dG9Sb3RhdGlvbkFuZ2xlKCkge1xuXG5cdFx0cmV0dXJuIDIgKiBNYXRoLlBJIC8gNjAgLyA2MCAqIHNjb3BlLmF1dG9Sb3RhdGVTcGVlZDtcblxuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0Wm9vbVNjYWxlKCkge1xuXG5cdFx0cmV0dXJuIE1hdGgucG93KCAwLjk1LCBzY29wZS56b29tU3BlZWQgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gcm90YXRlTGVmdCggYW5nbGUgKSB7XG5cblx0XHRzcGhlcmljYWxEZWx0YS50aGV0YSAtPSBhbmdsZTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gcm90YXRlVXAoIGFuZ2xlICkge1xuXG5cdFx0c3BoZXJpY2FsRGVsdGEucGhpIC09IGFuZ2xlO1xuXG5cdH1cblxuXHR2YXIgcGFuTGVmdCA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciB2ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHRcdHJldHVybiBmdW5jdGlvbiBwYW5MZWZ0KCBkaXN0YW5jZSwgb2JqZWN0TWF0cml4ICkge1xuXG5cdFx0XHR2LnNldEZyb21NYXRyaXhDb2x1bW4oIG9iamVjdE1hdHJpeCwgMCApOyAvLyBnZXQgWCBjb2x1bW4gb2Ygb2JqZWN0TWF0cml4XG5cdFx0XHR2Lm11bHRpcGx5U2NhbGFyKCAtIGRpc3RhbmNlICk7XG5cblx0XHRcdHBhbk9mZnNldC5hZGQoIHYgKTtcblxuXHRcdH07XG5cblx0fSgpO1xuXG5cdHZhciBwYW5VcCA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciB2ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHRcdHJldHVybiBmdW5jdGlvbiBwYW5VcCggZGlzdGFuY2UsIG9iamVjdE1hdHJpeCApIHtcblxuXHRcdFx0di5zZXRGcm9tTWF0cml4Q29sdW1uKCBvYmplY3RNYXRyaXgsIDEgKTsgLy8gZ2V0IFkgY29sdW1uIG9mIG9iamVjdE1hdHJpeFxuXHRcdFx0di5tdWx0aXBseVNjYWxhciggZGlzdGFuY2UgKTtcblxuXHRcdFx0cGFuT2Zmc2V0LmFkZCggdiApO1xuXG5cdFx0fTtcblxuXHR9KCk7XG5cblx0Ly8gZGVsdGFYIGFuZCBkZWx0YVkgYXJlIGluIHBpeGVsczsgcmlnaHQgYW5kIGRvd24gYXJlIHBvc2l0aXZlXG5cdHZhciBwYW4gPSBmdW5jdGlvbiAoKSB7XG5cblx0XHR2YXIgb2Zmc2V0ID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuXHRcdHJldHVybiBmdW5jdGlvbiBwYW4oIGRlbHRhWCwgZGVsdGFZICkge1xuXG5cdFx0XHR2YXIgZWxlbWVudCA9IHNjb3BlLmRvbUVsZW1lbnQgPT09IGRvY3VtZW50ID8gc2NvcGUuZG9tRWxlbWVudC5ib2R5IDogc2NvcGUuZG9tRWxlbWVudDtcblxuXHRcdFx0aWYgKCBzY29wZS5vYmplY3QuaXNQZXJzcGVjdGl2ZUNhbWVyYSApIHtcblxuXHRcdFx0XHQvLyBwZXJzcGVjdGl2ZVxuXHRcdFx0XHR2YXIgcG9zaXRpb24gPSBzY29wZS5vYmplY3QucG9zaXRpb247XG5cdFx0XHRcdG9mZnNldC5jb3B5KCBwb3NpdGlvbiApLnN1Yiggc2NvcGUudGFyZ2V0ICk7XG5cdFx0XHRcdHZhciB0YXJnZXREaXN0YW5jZSA9IG9mZnNldC5sZW5ndGgoKTtcblxuXHRcdFx0XHQvLyBoYWxmIG9mIHRoZSBmb3YgaXMgY2VudGVyIHRvIHRvcCBvZiBzY3JlZW5cblx0XHRcdFx0dGFyZ2V0RGlzdGFuY2UgKj0gTWF0aC50YW4oICggc2NvcGUub2JqZWN0LmZvdiAvIDIgKSAqIE1hdGguUEkgLyAxODAuMCApO1xuXG5cdFx0XHRcdC8vIHdlIGFjdHVhbGx5IGRvbid0IHVzZSBzY3JlZW5XaWR0aCwgc2luY2UgcGVyc3BlY3RpdmUgY2FtZXJhIGlzIGZpeGVkIHRvIHNjcmVlbiBoZWlnaHRcblx0XHRcdFx0cGFuTGVmdCggMiAqIGRlbHRhWCAqIHRhcmdldERpc3RhbmNlIC8gZWxlbWVudC5jbGllbnRIZWlnaHQsIHNjb3BlLm9iamVjdC5tYXRyaXggKTtcblx0XHRcdFx0cGFuVXAoIDIgKiBkZWx0YVkgKiB0YXJnZXREaXN0YW5jZSAvIGVsZW1lbnQuY2xpZW50SGVpZ2h0LCBzY29wZS5vYmplY3QubWF0cml4ICk7XG5cblx0XHRcdH0gZWxzZSBpZiAoIHNjb3BlLm9iamVjdC5pc09ydGhvZ3JhcGhpY0NhbWVyYSApIHtcblxuXHRcdFx0XHQvLyBvcnRob2dyYXBoaWNcblx0XHRcdFx0cGFuTGVmdCggZGVsdGFYICogKCBzY29wZS5vYmplY3QucmlnaHQgLSBzY29wZS5vYmplY3QubGVmdCApIC8gc2NvcGUub2JqZWN0Lnpvb20gLyBlbGVtZW50LmNsaWVudFdpZHRoLCBzY29wZS5vYmplY3QubWF0cml4ICk7XG5cdFx0XHRcdHBhblVwKCBkZWx0YVkgKiAoIHNjb3BlLm9iamVjdC50b3AgLSBzY29wZS5vYmplY3QuYm90dG9tICkgLyBzY29wZS5vYmplY3Quem9vbSAvIGVsZW1lbnQuY2xpZW50SGVpZ2h0LCBzY29wZS5vYmplY3QubWF0cml4ICk7XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0Ly8gY2FtZXJhIG5laXRoZXIgb3J0aG9ncmFwaGljIG5vciBwZXJzcGVjdGl2ZVxuXHRcdFx0XHRjb25zb2xlLndhcm4oICdXQVJOSU5HOiBPcmJpdENvbnRyb2xzLmpzIGVuY291bnRlcmVkIGFuIHVua25vd24gY2FtZXJhIHR5cGUgLSBwYW4gZGlzYWJsZWQuJyApO1xuXHRcdFx0XHRzY29wZS5lbmFibGVQYW4gPSBmYWxzZTtcblxuXHRcdFx0fVxuXG5cdFx0fTtcblxuXHR9KCk7XG5cblx0ZnVuY3Rpb24gZG9sbHlJbiggZG9sbHlTY2FsZSApIHtcblxuXHRcdGlmICggc2NvcGUub2JqZWN0LmlzUGVyc3BlY3RpdmVDYW1lcmEgKSB7XG5cblx0XHRcdHNjYWxlIC89IGRvbGx5U2NhbGU7XG5cblx0XHR9IGVsc2UgaWYgKCBzY29wZS5vYmplY3QuaXNPcnRob2dyYXBoaWNDYW1lcmEgKSB7XG5cblx0XHRcdHNjb3BlLm9iamVjdC56b29tID0gTWF0aC5tYXgoIHNjb3BlLm1pblpvb20sIE1hdGgubWluKCBzY29wZS5tYXhab29tLCBzY29wZS5vYmplY3Quem9vbSAqIGRvbGx5U2NhbGUgKSApO1xuXHRcdFx0c2NvcGUub2JqZWN0LnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcblx0XHRcdHpvb21DaGFuZ2VkID0gdHJ1ZTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1dBUk5JTkc6IE9yYml0Q29udHJvbHMuanMgZW5jb3VudGVyZWQgYW4gdW5rbm93biBjYW1lcmEgdHlwZSAtIGRvbGx5L3pvb20gZGlzYWJsZWQuJyApO1xuXHRcdFx0c2NvcGUuZW5hYmxlWm9vbSA9IGZhbHNlO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRmdW5jdGlvbiBkb2xseU91dCggZG9sbHlTY2FsZSApIHtcblxuXHRcdGlmICggc2NvcGUub2JqZWN0LmlzUGVyc3BlY3RpdmVDYW1lcmEgKSB7XG5cblx0XHRcdHNjYWxlICo9IGRvbGx5U2NhbGU7XG5cblx0XHR9IGVsc2UgaWYgKCBzY29wZS5vYmplY3QuaXNPcnRob2dyYXBoaWNDYW1lcmEgKSB7XG5cblx0XHRcdHNjb3BlLm9iamVjdC56b29tID0gTWF0aC5tYXgoIHNjb3BlLm1pblpvb20sIE1hdGgubWluKCBzY29wZS5tYXhab29tLCBzY29wZS5vYmplY3Quem9vbSAvIGRvbGx5U2NhbGUgKSApO1xuXHRcdFx0c2NvcGUub2JqZWN0LnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTtcblx0XHRcdHpvb21DaGFuZ2VkID0gdHJ1ZTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1dBUk5JTkc6IE9yYml0Q29udHJvbHMuanMgZW5jb3VudGVyZWQgYW4gdW5rbm93biBjYW1lcmEgdHlwZSAtIGRvbGx5L3pvb20gZGlzYWJsZWQuJyApO1xuXHRcdFx0c2NvcGUuZW5hYmxlWm9vbSA9IGZhbHNlO1xuXG5cdFx0fVxuXG5cdH1cblxuXHQvL1xuXHQvLyBldmVudCBjYWxsYmFja3MgLSB1cGRhdGUgdGhlIG9iamVjdCBzdGF0ZVxuXHQvL1xuXG5cdGZ1bmN0aW9uIGhhbmRsZU1vdXNlRG93blJvdGF0ZSggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlTW91c2VEb3duUm90YXRlJyApO1xuXG5cdFx0cm90YXRlU3RhcnQuc2V0KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZU1vdXNlRG93bkRvbGx5KCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVNb3VzZURvd25Eb2xseScgKTtcblxuXHRcdGRvbGx5U3RhcnQuc2V0KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZU1vdXNlRG93blBhbiggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlTW91c2VEb3duUGFuJyApO1xuXG5cdFx0cGFuU3RhcnQuc2V0KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZVJvdGF0ZSggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlTW91c2VNb3ZlUm90YXRlJyApO1xuXG5cdFx0cm90YXRlRW5kLnNldCggZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSApO1xuXHRcdHJvdGF0ZURlbHRhLnN1YlZlY3RvcnMoIHJvdGF0ZUVuZCwgcm90YXRlU3RhcnQgKTtcblxuXHRcdHZhciBlbGVtZW50ID0gc2NvcGUuZG9tRWxlbWVudCA9PT0gZG9jdW1lbnQgPyBzY29wZS5kb21FbGVtZW50LmJvZHkgOiBzY29wZS5kb21FbGVtZW50O1xuXG5cdFx0Ly8gcm90YXRpbmcgYWNyb3NzIHdob2xlIHNjcmVlbiBnb2VzIDM2MCBkZWdyZWVzIGFyb3VuZFxuXHRcdHJvdGF0ZUxlZnQoIDIgKiBNYXRoLlBJICogcm90YXRlRGVsdGEueCAvIGVsZW1lbnQuY2xpZW50V2lkdGggKiBzY29wZS5yb3RhdGVTcGVlZCApO1xuXG5cdFx0Ly8gcm90YXRpbmcgdXAgYW5kIGRvd24gYWxvbmcgd2hvbGUgc2NyZWVuIGF0dGVtcHRzIHRvIGdvIDM2MCwgYnV0IGxpbWl0ZWQgdG8gMTgwXG5cdFx0cm90YXRlVXAoIDIgKiBNYXRoLlBJICogcm90YXRlRGVsdGEueSAvIGVsZW1lbnQuY2xpZW50SGVpZ2h0ICogc2NvcGUucm90YXRlU3BlZWQgKTtcblxuXHRcdHJvdGF0ZVN0YXJ0LmNvcHkoIHJvdGF0ZUVuZCApO1xuXG5cdFx0c2NvcGUudXBkYXRlKCk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZURvbGx5KCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVNb3VzZU1vdmVEb2xseScgKTtcblxuXHRcdGRvbGx5RW5kLnNldCggZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSApO1xuXG5cdFx0ZG9sbHlEZWx0YS5zdWJWZWN0b3JzKCBkb2xseUVuZCwgZG9sbHlTdGFydCApO1xuXG5cdFx0aWYgKCBkb2xseURlbHRhLnkgPiAwICkge1xuXG5cdFx0XHRkb2xseUluKCBnZXRab29tU2NhbGUoKSApO1xuXG5cdFx0fSBlbHNlIGlmICggZG9sbHlEZWx0YS55IDwgMCApIHtcblxuXHRcdFx0ZG9sbHlPdXQoIGdldFpvb21TY2FsZSgpICk7XG5cblx0XHR9XG5cblx0XHRkb2xseVN0YXJ0LmNvcHkoIGRvbGx5RW5kICk7XG5cblx0XHRzY29wZS51cGRhdGUoKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlTW91c2VNb3ZlUGFuKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVNb3VzZU1vdmVQYW4nICk7XG5cblx0XHRwYW5FbmQuc2V0KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XG5cblx0XHRwYW5EZWx0YS5zdWJWZWN0b3JzKCBwYW5FbmQsIHBhblN0YXJ0ICk7XG5cblx0XHRwYW4oIHBhbkRlbHRhLngsIHBhbkRlbHRhLnkgKTtcblxuXHRcdHBhblN0YXJ0LmNvcHkoIHBhbkVuZCApO1xuXG5cdFx0c2NvcGUudXBkYXRlKCk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZU1vdXNlVXAoIGV2ZW50ICkge1xuXG5cdFx0Ly8gY29uc29sZS5sb2coICdoYW5kbGVNb3VzZVVwJyApO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVNb3VzZVdoZWVsKCBldmVudCApIHtcblxuXHRcdC8vIGNvbnNvbGUubG9nKCAnaGFuZGxlTW91c2VXaGVlbCcgKTtcblxuXHRcdGlmICggZXZlbnQuZGVsdGFZIDwgMCApIHtcblxuXHRcdFx0ZG9sbHlPdXQoIGdldFpvb21TY2FsZSgpICk7XG5cblx0XHR9IGVsc2UgaWYgKCBldmVudC5kZWx0YVkgPiAwICkge1xuXG5cdFx0XHRkb2xseUluKCBnZXRab29tU2NhbGUoKSApO1xuXG5cdFx0fVxuXG5cdFx0c2NvcGUudXBkYXRlKCk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZUtleURvd24oIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZUtleURvd24nICk7XG5cblx0XHRzd2l0Y2ggKCBldmVudC5rZXlDb2RlICkge1xuXG5cdFx0XHRjYXNlIHNjb3BlLmtleXMuVVA6XG5cdFx0XHRcdHBhbiggMCwgc2NvcGUua2V5UGFuU3BlZWQgKTtcblx0XHRcdFx0c2NvcGUudXBkYXRlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIHNjb3BlLmtleXMuQk9UVE9NOlxuXHRcdFx0XHRwYW4oIDAsIC0gc2NvcGUua2V5UGFuU3BlZWQgKTtcblx0XHRcdFx0c2NvcGUudXBkYXRlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIHNjb3BlLmtleXMuTEVGVDpcblx0XHRcdFx0cGFuKCBzY29wZS5rZXlQYW5TcGVlZCwgMCApO1xuXHRcdFx0XHRzY29wZS51cGRhdGUoKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5SSUdIVDpcblx0XHRcdFx0cGFuKCAtIHNjb3BlLmtleVBhblNwZWVkLCAwICk7XG5cdFx0XHRcdHNjb3BlLnVwZGF0ZSgpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlVG91Y2hTdGFydFJvdGF0ZSggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlVG91Y2hTdGFydFJvdGF0ZScgKTtcblxuXHRcdHJvdGF0ZVN0YXJ0LnNldCggZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VYLCBldmVudC50b3VjaGVzWyAwIF0ucGFnZVkgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlVG91Y2hTdGFydERvbGx5KCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVUb3VjaFN0YXJ0RG9sbHknICk7XG5cblx0XHR2YXIgZHggPSBldmVudC50b3VjaGVzWyAwIF0ucGFnZVggLSBldmVudC50b3VjaGVzWyAxIF0ucGFnZVg7XG5cdFx0dmFyIGR5ID0gZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VZIC0gZXZlbnQudG91Y2hlc1sgMSBdLnBhZ2VZO1xuXG5cdFx0dmFyIGRpc3RhbmNlID0gTWF0aC5zcXJ0KCBkeCAqIGR4ICsgZHkgKiBkeSApO1xuXG5cdFx0ZG9sbHlTdGFydC5zZXQoIDAsIGRpc3RhbmNlICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZVRvdWNoU3RhcnRQYW4oIGV2ZW50ICkge1xuXG5cdFx0Ly9jb25zb2xlLmxvZyggJ2hhbmRsZVRvdWNoU3RhcnRQYW4nICk7XG5cblx0XHRwYW5TdGFydC5zZXQoIGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWCwgZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VZICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGhhbmRsZVRvdWNoTW92ZVJvdGF0ZSggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlVG91Y2hNb3ZlUm90YXRlJyApO1xuXG5cdFx0cm90YXRlRW5kLnNldCggZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VYLCBldmVudC50b3VjaGVzWyAwIF0ucGFnZVkgKTtcblx0XHRyb3RhdGVEZWx0YS5zdWJWZWN0b3JzKCByb3RhdGVFbmQsIHJvdGF0ZVN0YXJ0ICk7XG5cblx0XHR2YXIgZWxlbWVudCA9IHNjb3BlLmRvbUVsZW1lbnQgPT09IGRvY3VtZW50ID8gc2NvcGUuZG9tRWxlbWVudC5ib2R5IDogc2NvcGUuZG9tRWxlbWVudDtcblxuXHRcdC8vIHJvdGF0aW5nIGFjcm9zcyB3aG9sZSBzY3JlZW4gZ29lcyAzNjAgZGVncmVlcyBhcm91bmRcblx0XHRyb3RhdGVMZWZ0KCAyICogTWF0aC5QSSAqIHJvdGF0ZURlbHRhLnggLyBlbGVtZW50LmNsaWVudFdpZHRoICogc2NvcGUucm90YXRlU3BlZWQgKTtcblxuXHRcdC8vIHJvdGF0aW5nIHVwIGFuZCBkb3duIGFsb25nIHdob2xlIHNjcmVlbiBhdHRlbXB0cyB0byBnbyAzNjAsIGJ1dCBsaW1pdGVkIHRvIDE4MFxuXHRcdHJvdGF0ZVVwKCAyICogTWF0aC5QSSAqIHJvdGF0ZURlbHRhLnkgLyBlbGVtZW50LmNsaWVudEhlaWdodCAqIHNjb3BlLnJvdGF0ZVNwZWVkICk7XG5cblx0XHRyb3RhdGVTdGFydC5jb3B5KCByb3RhdGVFbmQgKTtcblxuXHRcdHNjb3BlLnVwZGF0ZSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVUb3VjaE1vdmVEb2xseSggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlVG91Y2hNb3ZlRG9sbHknICk7XG5cblx0XHR2YXIgZHggPSBldmVudC50b3VjaGVzWyAwIF0ucGFnZVggLSBldmVudC50b3VjaGVzWyAxIF0ucGFnZVg7XG5cdFx0dmFyIGR5ID0gZXZlbnQudG91Y2hlc1sgMCBdLnBhZ2VZIC0gZXZlbnQudG91Y2hlc1sgMSBdLnBhZ2VZO1xuXG5cdFx0dmFyIGRpc3RhbmNlID0gTWF0aC5zcXJ0KCBkeCAqIGR4ICsgZHkgKiBkeSApO1xuXG5cdFx0ZG9sbHlFbmQuc2V0KCAwLCBkaXN0YW5jZSApO1xuXG5cdFx0ZG9sbHlEZWx0YS5zdWJWZWN0b3JzKCBkb2xseUVuZCwgZG9sbHlTdGFydCApO1xuXG5cdFx0aWYgKCBkb2xseURlbHRhLnkgPiAwICkge1xuXG5cdFx0XHRkb2xseU91dCggZ2V0Wm9vbVNjYWxlKCkgKTtcblxuXHRcdH0gZWxzZSBpZiAoIGRvbGx5RGVsdGEueSA8IDAgKSB7XG5cblx0XHRcdGRvbGx5SW4oIGdldFpvb21TY2FsZSgpICk7XG5cblx0XHR9XG5cblx0XHRkb2xseVN0YXJ0LmNvcHkoIGRvbGx5RW5kICk7XG5cblx0XHRzY29wZS51cGRhdGUoKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gaGFuZGxlVG91Y2hNb3ZlUGFuKCBldmVudCApIHtcblxuXHRcdC8vY29uc29sZS5sb2coICdoYW5kbGVUb3VjaE1vdmVQYW4nICk7XG5cblx0XHRwYW5FbmQuc2V0KCBldmVudC50b3VjaGVzWyAwIF0ucGFnZVgsIGV2ZW50LnRvdWNoZXNbIDAgXS5wYWdlWSApO1xuXG5cdFx0cGFuRGVsdGEuc3ViVmVjdG9ycyggcGFuRW5kLCBwYW5TdGFydCApO1xuXG5cdFx0cGFuKCBwYW5EZWx0YS54LCBwYW5EZWx0YS55ICk7XG5cblx0XHRwYW5TdGFydC5jb3B5KCBwYW5FbmQgKTtcblxuXHRcdHNjb3BlLnVwZGF0ZSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBoYW5kbGVUb3VjaEVuZCggZXZlbnQgKSB7XG5cblx0XHQvL2NvbnNvbGUubG9nKCAnaGFuZGxlVG91Y2hFbmQnICk7XG5cblx0fVxuXG5cdC8vXG5cdC8vIGV2ZW50IGhhbmRsZXJzIC0gRlNNOiBsaXN0ZW4gZm9yIGV2ZW50cyBhbmQgcmVzZXQgc3RhdGVcblx0Ly9cblxuXHRmdW5jdGlvbiBvbk1vdXNlRG93biggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHN3aXRjaCAoIGV2ZW50LmJ1dHRvbiApIHtcblxuXHRcdFx0Y2FzZSBzY29wZS5tb3VzZUJ1dHRvbnMuT1JCSVQ6XG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVSb3RhdGUgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZU1vdXNlRG93blJvdGF0ZSggZXZlbnQgKTtcblxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLlJPVEFURTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBzY29wZS5tb3VzZUJ1dHRvbnMuWk9PTTpcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVpvb20gPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZU1vdXNlRG93bkRvbGx5KCBldmVudCApO1xuXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuRE9MTFk7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2Ugc2NvcGUubW91c2VCdXR0b25zLlBBTjpcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVBhbiA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlTW91c2VEb3duUGFuKCBldmVudCApO1xuXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuUEFOO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0fVxuXG5cdFx0aWYgKCBzdGF0ZSAhPT0gU1RBVEUuTk9ORSApIHtcblxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlLCBmYWxzZSApO1xuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBvbk1vdXNlVXAsIGZhbHNlICk7XG5cblx0XHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIHN0YXJ0RXZlbnQgKTtcblxuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gb25Nb3VzZU1vdmUoIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRzd2l0Y2ggKCBzdGF0ZSApIHtcblxuXHRcdFx0Y2FzZSBTVEFURS5ST1RBVEU6XG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVSb3RhdGUgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZU1vdXNlTW92ZVJvdGF0ZSggZXZlbnQgKTtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBTVEFURS5ET0xMWTpcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVpvb20gPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZU1vdXNlTW92ZURvbGx5KCBldmVudCApO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFNUQVRFLlBBTjpcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVBhbiA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlTW91c2VNb3ZlUGFuKCBldmVudCApO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRmdW5jdGlvbiBvbk1vdXNlVXAoIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdGhhbmRsZU1vdXNlVXAoIGV2ZW50ICk7XG5cblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XG5cdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBvbk1vdXNlVXAsIGZhbHNlICk7XG5cblx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCBlbmRFdmVudCApO1xuXG5cdFx0c3RhdGUgPSBTVEFURS5OT05FO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBvbk1vdXNlV2hlZWwoIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSB8fCBzY29wZS5lbmFibGVab29tID09PSBmYWxzZSB8fCAoIHN0YXRlICE9PSBTVEFURS5OT05FICYmIHN0YXRlICE9PSBTVEFURS5ST1RBVEUgKSApIHJldHVybjtcblxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCBzdGFydEV2ZW50ICk7XG5cblx0XHRoYW5kbGVNb3VzZVdoZWVsKCBldmVudCApO1xuXG5cdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggZW5kRXZlbnQgKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gb25LZXlEb3duKCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgfHwgc2NvcGUuZW5hYmxlS2V5cyA9PT0gZmFsc2UgfHwgc2NvcGUuZW5hYmxlUGFuID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdGhhbmRsZUtleURvd24oIGV2ZW50ICk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIG9uVG91Y2hTdGFydCggZXZlbnQgKSB7XG5cblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0c3dpdGNoICggZXZlbnQudG91Y2hlcy5sZW5ndGggKSB7XG5cblx0XHRcdGNhc2UgMTpcdC8vIG9uZS1maW5nZXJlZCB0b3VjaDogcm90YXRlXG5cblx0XHRcdFx0aWYgKCBzY29wZS5lbmFibGVSb3RhdGUgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZVRvdWNoU3RhcnRSb3RhdGUoIGV2ZW50ICk7XG5cblx0XHRcdFx0c3RhdGUgPSBTVEFURS5UT1VDSF9ST1RBVEU7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMjpcdC8vIHR3by1maW5nZXJlZCB0b3VjaDogZG9sbHlcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVpvb20gPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGhhbmRsZVRvdWNoU3RhcnREb2xseSggZXZlbnQgKTtcblxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLlRPVUNIX0RPTExZO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDM6IC8vIHRocmVlLWZpbmdlcmVkIHRvdWNoOiBwYW5cblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVBhbiA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdFx0aGFuZGxlVG91Y2hTdGFydFBhbiggZXZlbnQgKTtcblxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLlRPVUNIX1BBTjtcblxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0ZGVmYXVsdDpcblxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLk5PTkU7XG5cblx0XHR9XG5cblx0XHRpZiAoIHN0YXRlICE9PSBTVEFURS5OT05FICkge1xuXG5cdFx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCBzdGFydEV2ZW50ICk7XG5cblx0XHR9XG5cblx0fVxuXG5cdGZ1bmN0aW9uIG9uVG91Y2hNb3ZlKCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0c3dpdGNoICggZXZlbnQudG91Y2hlcy5sZW5ndGggKSB7XG5cblx0XHRcdGNhc2UgMTogLy8gb25lLWZpbmdlcmVkIHRvdWNoOiByb3RhdGVcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVJvdGF0ZSA9PT0gZmFsc2UgKSByZXR1cm47XG5cdFx0XHRcdGlmICggc3RhdGUgIT09IFNUQVRFLlRPVUNIX1JPVEFURSApIHJldHVybjsgLy8gaXMgdGhpcyBuZWVkZWQ/Li4uXG5cblx0XHRcdFx0aGFuZGxlVG91Y2hNb3ZlUm90YXRlKCBldmVudCApO1xuXG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIDI6IC8vIHR3by1maW5nZXJlZCB0b3VjaDogZG9sbHlcblxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZVpvb20gPT09IGZhbHNlICkgcmV0dXJuO1xuXHRcdFx0XHRpZiAoIHN0YXRlICE9PSBTVEFURS5UT1VDSF9ET0xMWSApIHJldHVybjsgLy8gaXMgdGhpcyBuZWVkZWQ/Li4uXG5cblx0XHRcdFx0aGFuZGxlVG91Y2hNb3ZlRG9sbHkoIGV2ZW50ICk7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgMzogLy8gdGhyZWUtZmluZ2VyZWQgdG91Y2g6IHBhblxuXG5cdFx0XHRcdGlmICggc2NvcGUuZW5hYmxlUGFuID09PSBmYWxzZSApIHJldHVybjtcblx0XHRcdFx0aWYgKCBzdGF0ZSAhPT0gU1RBVEUuVE9VQ0hfUEFOICkgcmV0dXJuOyAvLyBpcyB0aGlzIG5lZWRlZD8uLi5cblxuXHRcdFx0XHRoYW5kbGVUb3VjaE1vdmVQYW4oIGV2ZW50ICk7XG5cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGRlZmF1bHQ6XG5cblx0XHRcdFx0c3RhdGUgPSBTVEFURS5OT05FO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRmdW5jdGlvbiBvblRvdWNoRW5kKCBldmVudCApIHtcblxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRoYW5kbGVUb3VjaEVuZCggZXZlbnQgKTtcblxuXHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIGVuZEV2ZW50ICk7XG5cblx0XHRzdGF0ZSA9IFNUQVRFLk5PTkU7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIG9uQ29udGV4dE1lbnUoIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0fVxuXG5cdC8vXG5cblx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnY29udGV4dG1lbnUnLCBvbkNvbnRleHRNZW51LCBmYWxzZSApO1xuXG5cdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsIG9uTW91c2VEb3duLCBmYWxzZSApO1xuXHRzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd3aGVlbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTtcblxuXHRzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaHN0YXJ0Jywgb25Ub3VjaFN0YXJ0LCBmYWxzZSApO1xuXHRzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaGVuZCcsIG9uVG91Y2hFbmQsIGZhbHNlICk7XG5cdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlLCBmYWxzZSApO1xuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIG9uS2V5RG93biwgZmFsc2UgKTtcblxuXHQvLyBmb3JjZSBhbiB1cGRhdGUgYXQgc3RhcnRcblxuXHR0aGlzLnVwZGF0ZSgpO1xuXG59O1xuXG5USFJFRS5PcmJpdENvbnRyb2xzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIFRIUkVFLkV2ZW50RGlzcGF0Y2hlci5wcm90b3R5cGUgKTtcblRIUkVFLk9yYml0Q29udHJvbHMucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVEhSRUUuT3JiaXRDb250cm9scztcblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoIFRIUkVFLk9yYml0Q29udHJvbHMucHJvdG90eXBlLCB7XG5cblx0Y2VudGVyOiB7XG5cblx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLmNlbnRlciBoYXMgYmVlbiByZW5hbWVkIHRvIC50YXJnZXQnICk7XG5cdFx0XHRyZXR1cm4gdGhpcy50YXJnZXQ7XG5cblx0XHR9XG5cblx0fSxcblxuXHQvLyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XG5cblx0bm9ab29tOiB7XG5cblx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLm5vWm9vbSBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZVpvb20gaW5zdGVhZC4nICk7XG5cdFx0XHRyZXR1cm4gISB0aGlzLmVuYWJsZVpvb207XG5cblx0XHR9LFxuXG5cdFx0c2V0OiBmdW5jdGlvbiAoIHZhbHVlICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAubm9ab29tIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlWm9vbSBpbnN0ZWFkLicgKTtcblx0XHRcdHRoaXMuZW5hYmxlWm9vbSA9ICEgdmFsdWU7XG5cblx0XHR9XG5cblx0fSxcblxuXHRub1JvdGF0ZToge1xuXG5cdFx0Z2V0OiBmdW5jdGlvbiAoKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5ub1JvdGF0ZSBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZVJvdGF0ZSBpbnN0ZWFkLicgKTtcblx0XHRcdHJldHVybiAhIHRoaXMuZW5hYmxlUm90YXRlO1xuXG5cdFx0fSxcblxuXHRcdHNldDogZnVuY3Rpb24gKCB2YWx1ZSApIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLm5vUm90YXRlIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlUm90YXRlIGluc3RlYWQuJyApO1xuXHRcdFx0dGhpcy5lbmFibGVSb3RhdGUgPSAhIHZhbHVlO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0bm9QYW46IHtcblxuXHRcdGdldDogZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAubm9QYW4gaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVQYW4gaW5zdGVhZC4nICk7XG5cdFx0XHRyZXR1cm4gISB0aGlzLmVuYWJsZVBhbjtcblxuXHRcdH0sXG5cblx0XHRzZXQ6IGZ1bmN0aW9uICggdmFsdWUgKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5ub1BhbiBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZVBhbiBpbnN0ZWFkLicgKTtcblx0XHRcdHRoaXMuZW5hYmxlUGFuID0gISB2YWx1ZTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdG5vS2V5czoge1xuXG5cdFx0Z2V0OiBmdW5jdGlvbiAoKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5ub0tleXMgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5lbmFibGVLZXlzIGluc3RlYWQuJyApO1xuXHRcdFx0cmV0dXJuICEgdGhpcy5lbmFibGVLZXlzO1xuXG5cdFx0fSxcblxuXHRcdHNldDogZnVuY3Rpb24gKCB2YWx1ZSApIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLm5vS2V5cyBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZUtleXMgaW5zdGVhZC4nICk7XG5cdFx0XHR0aGlzLmVuYWJsZUtleXMgPSAhIHZhbHVlO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0c3RhdGljTW92aW5nOiB7XG5cblx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLnN0YXRpY01vdmluZyBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLmVuYWJsZURhbXBpbmcgaW5zdGVhZC4nICk7XG5cdFx0XHRyZXR1cm4gISB0aGlzLmVuYWJsZURhbXBpbmc7XG5cblx0XHR9LFxuXG5cdFx0c2V0OiBmdW5jdGlvbiAoIHZhbHVlICkge1xuXG5cdFx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5PcmJpdENvbnRyb2xzOiAuc3RhdGljTW92aW5nIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuZW5hYmxlRGFtcGluZyBpbnN0ZWFkLicgKTtcblx0XHRcdHRoaXMuZW5hYmxlRGFtcGluZyA9ICEgdmFsdWU7XG5cblx0XHR9XG5cblx0fSxcblxuXHRkeW5hbWljRGFtcGluZ0ZhY3Rvcjoge1xuXG5cdFx0Z2V0OiBmdW5jdGlvbiAoKSB7XG5cblx0XHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLk9yYml0Q29udHJvbHM6IC5keW5hbWljRGFtcGluZ0ZhY3RvciBoYXMgYmVlbiByZW5hbWVkLiBVc2UgLmRhbXBpbmdGYWN0b3IgaW5zdGVhZC4nICk7XG5cdFx0XHRyZXR1cm4gdGhpcy5kYW1waW5nRmFjdG9yO1xuXG5cdFx0fSxcblxuXHRcdHNldDogZnVuY3Rpb24gKCB2YWx1ZSApIHtcblxuXHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuT3JiaXRDb250cm9sczogLmR5bmFtaWNEYW1waW5nRmFjdG9yIGhhcyBiZWVuIHJlbmFtZWQuIFVzZSAuZGFtcGluZ0ZhY3RvciBpbnN0ZWFkLicgKTtcblx0XHRcdHRoaXMuZGFtcGluZ0ZhY3RvciA9IHZhbHVlO1xuXG5cdFx0fVxuXG5cdH1cblxufSApO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FmcmFtZS1vcmJpdC1jb250cm9scy9saWIvT3JiaXRDb250cm9scy5qc1xuLy8gbW9kdWxlIGlkID0gNDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBBbGdvbGlhU2VhcmNoQ29yZTtcblxudmFyIGVycm9ycyA9IHJlcXVpcmUoJy4vZXJyb3JzJyk7XG52YXIgZXhpdFByb21pc2UgPSByZXF1aXJlKCcuL2V4aXRQcm9taXNlLmpzJyk7XG52YXIgSW5kZXhDb3JlID0gcmVxdWlyZSgnLi9JbmRleENvcmUuanMnKTtcbnZhciBzdG9yZSA9IHJlcXVpcmUoJy4vc3RvcmUuanMnKTtcblxuLy8gV2Ugd2lsbCBhbHdheXMgcHV0IHRoZSBBUEkgS0VZIGluIHRoZSBKU09OIGJvZHkgaW4gY2FzZSBvZiB0b28gbG9uZyBBUEkgS0VZLFxuLy8gdG8gYXZvaWQgcXVlcnkgc3RyaW5nIGJlaW5nIHRvbyBsb25nIGFuZCBmYWlsaW5nIGluIHZhcmlvdXMgY29uZGl0aW9ucyAob3VyIHNlcnZlciBsaW1pdCwgYnJvd3NlciBsaW1pdCxcbi8vIHByb3hpZXMgbGltaXQpXG52YXIgTUFYX0FQSV9LRVlfTEVOR1RIID0gNTAwO1xudmFyIFJFU0VUX0FQUF9EQVRBX1RJTUVSID1cbiAgcHJvY2Vzcy5lbnYuUkVTRVRfQVBQX0RBVEFfVElNRVIgJiYgcGFyc2VJbnQocHJvY2Vzcy5lbnYuUkVTRVRfQVBQX0RBVEFfVElNRVIsIDEwKSB8fFxuICA2MCAqIDIgKiAxMDAwOyAvLyBhZnRlciAyIG1pbnV0ZXMgcmVzZXQgdG8gZmlyc3QgaG9zdFxuXG4vKlxuICogQWxnb2xpYSBTZWFyY2ggbGlicmFyeSBpbml0aWFsaXphdGlvblxuICogaHR0cHM6Ly93d3cuYWxnb2xpYS5jb20vXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcGxpY2F0aW9uSUQgLSBZb3VyIGFwcGxpY2F0aW9uSUQsIGZvdW5kIGluIHlvdXIgZGFzaGJvYXJkXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBpS2V5IC0gWW91ciBBUEkga2V5LCBmb3VuZCBpbiB5b3VyIGRhc2hib2FyZFxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRzXVxuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRzLnRpbWVvdXQ9MjAwMF0gLSBUaGUgcmVxdWVzdCB0aW1lb3V0IHNldCBpbiBtaWxsaXNlY29uZHMsXG4gKiBhbm90aGVyIHJlcXVlc3Qgd2lsbCBiZSBpc3N1ZWQgYWZ0ZXIgdGhpcyB0aW1lb3V0XG4gKiBAcGFyYW0ge3N0cmluZ30gW29wdHMucHJvdG9jb2w9J2h0dHBzOiddIC0gVGhlIHByb3RvY29sIHVzZWQgdG8gcXVlcnkgQWxnb2xpYSBTZWFyY2ggQVBJLlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V0IHRvICdodHRwOicgdG8gZm9yY2UgdXNpbmcgaHR0cC5cbiAqIEBwYXJhbSB7T2JqZWN0fEFycmF5fSBbb3B0cy5ob3N0cz17XG4gKiAgICAgICAgICAgcmVhZDogW3RoaXMuYXBwbGljYXRpb25JRCArICctZHNuLmFsZ29saWEubmV0J10uY29uY2F0KFtcbiAqICAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25JRCArICctMS5hbGdvbGlhbmV0LmNvbScsXG4gKiAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLTIuYWxnb2xpYW5ldC5jb20nLFxuICogICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbklEICsgJy0zLmFsZ29saWFuZXQuY29tJ11cbiAqICAgICAgICAgICBdKSxcbiAqICAgICAgICAgICB3cml0ZTogW3RoaXMuYXBwbGljYXRpb25JRCArICcuYWxnb2xpYS5uZXQnXS5jb25jYXQoW1xuICogICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbklEICsgJy0xLmFsZ29saWFuZXQuY29tJyxcbiAqICAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25JRCArICctMi5hbGdvbGlhbmV0LmNvbScsXG4gKiAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLTMuYWxnb2xpYW5ldC5jb20nXVxuICogICAgICAgICAgIF0pIC0gVGhlIGhvc3RzIHRvIHVzZSBmb3IgQWxnb2xpYSBTZWFyY2ggQVBJLlxuICogICAgICAgICAgIElmIHlvdSBwcm92aWRlIHRoZW0sIHlvdSB3aWxsIGxlc3MgYmVuZWZpdCBmcm9tIG91ciBIQSBpbXBsZW1lbnRhdGlvblxuICovXG5mdW5jdGlvbiBBbGdvbGlhU2VhcmNoQ29yZShhcHBsaWNhdGlvbklELCBhcGlLZXksIG9wdHMpIHtcbiAgdmFyIGRlYnVnID0gcmVxdWlyZSgnZGVidWcnKSgnYWxnb2xpYXNlYXJjaCcpO1xuXG4gIHZhciBjbG9uZSA9IHJlcXVpcmUoJy4vY2xvbmUuanMnKTtcbiAgdmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5Jyk7XG4gIHZhciBtYXAgPSByZXF1aXJlKCcuL21hcC5qcycpO1xuXG4gIHZhciB1c2FnZSA9ICdVc2FnZTogYWxnb2xpYXNlYXJjaChhcHBsaWNhdGlvbklELCBhcGlLZXksIG9wdHMpJztcblxuICBpZiAob3B0cy5fYWxsb3dFbXB0eUNyZWRlbnRpYWxzICE9PSB0cnVlICYmICFhcHBsaWNhdGlvbklEKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5BbGdvbGlhU2VhcmNoRXJyb3IoJ1BsZWFzZSBwcm92aWRlIGFuIGFwcGxpY2F0aW9uIElELiAnICsgdXNhZ2UpO1xuICB9XG5cbiAgaWYgKG9wdHMuX2FsbG93RW1wdHlDcmVkZW50aWFscyAhPT0gdHJ1ZSAmJiAhYXBpS2V5KSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5BbGdvbGlhU2VhcmNoRXJyb3IoJ1BsZWFzZSBwcm92aWRlIGFuIEFQSSBrZXkuICcgKyB1c2FnZSk7XG4gIH1cblxuICB0aGlzLmFwcGxpY2F0aW9uSUQgPSBhcHBsaWNhdGlvbklEO1xuICB0aGlzLmFwaUtleSA9IGFwaUtleTtcblxuICB0aGlzLmhvc3RzID0ge1xuICAgIHJlYWQ6IFtdLFxuICAgIHdyaXRlOiBbXVxuICB9O1xuXG4gIG9wdHMgPSBvcHRzIHx8IHt9O1xuXG4gIHRoaXMuX3RpbWVvdXRzID0gb3B0cy50aW1lb3V0cyB8fCB7XG4gICAgY29ubmVjdDogMSAqIDEwMDAsIC8vIDUwMG1zIGNvbm5lY3QgaXMgR1BSUyBsYXRlbmN5XG4gICAgcmVhZDogMiAqIDEwMDAsXG4gICAgd3JpdGU6IDMwICogMTAwMFxuICB9O1xuXG4gIC8vIGJhY2t3YXJkIGNvbXBhdCwgaWYgb3B0cy50aW1lb3V0IGlzIHBhc3NlZCwgd2UgdXNlIGl0IHRvIGNvbmZpZ3VyZSBhbGwgdGltZW91dHMgbGlrZSBiZWZvcmVcbiAgaWYgKG9wdHMudGltZW91dCkge1xuICAgIHRoaXMuX3RpbWVvdXRzLmNvbm5lY3QgPSB0aGlzLl90aW1lb3V0cy5yZWFkID0gdGhpcy5fdGltZW91dHMud3JpdGUgPSBvcHRzLnRpbWVvdXQ7XG4gIH1cblxuICB2YXIgcHJvdG9jb2wgPSBvcHRzLnByb3RvY29sIHx8ICdodHRwczonO1xuICAvLyB3aGlsZSB3ZSBhZHZvY2F0ZSBmb3IgY29sb24tYXQtdGhlLWVuZCB2YWx1ZXM6ICdodHRwOicgZm9yIGBvcHRzLnByb3RvY29sYFxuICAvLyB3ZSBhbHNvIGFjY2VwdCBgaHR0cGAgYW5kIGBodHRwc2AuIEl0J3MgYSBjb21tb24gZXJyb3IuXG4gIGlmICghLzokLy50ZXN0KHByb3RvY29sKSkge1xuICAgIHByb3RvY29sID0gcHJvdG9jb2wgKyAnOic7XG4gIH1cblxuICBpZiAocHJvdG9jb2wgIT09ICdodHRwOicgJiYgcHJvdG9jb2wgIT09ICdodHRwczonKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5BbGdvbGlhU2VhcmNoRXJyb3IoJ3Byb3RvY29sIG11c3QgYmUgYGh0dHA6YCBvciBgaHR0cHM6YCAod2FzIGAnICsgb3B0cy5wcm90b2NvbCArICdgKScpO1xuICB9XG5cbiAgdGhpcy5fY2hlY2tBcHBJZERhdGEoKTtcblxuICBpZiAoIW9wdHMuaG9zdHMpIHtcbiAgICB2YXIgZGVmYXVsdEhvc3RzID0gbWFwKHRoaXMuX3NodWZmbGVSZXN1bHQsIGZ1bmN0aW9uKGhvc3ROdW1iZXIpIHtcbiAgICAgIHJldHVybiBhcHBsaWNhdGlvbklEICsgJy0nICsgaG9zdE51bWJlciArICcuYWxnb2xpYW5ldC5jb20nO1xuICAgIH0pO1xuXG4gICAgLy8gbm8gaG9zdHMgZ2l2ZW4sIGNvbXB1dGUgZGVmYXVsdHNcbiAgICB2YXIgbWFpblN1ZmZpeCA9IChvcHRzLmRzbiA9PT0gZmFsc2UgPyAnJyA6ICctZHNuJykgKyAnLmFsZ29saWEubmV0JztcbiAgICB0aGlzLmhvc3RzLnJlYWQgPSBbdGhpcy5hcHBsaWNhdGlvbklEICsgbWFpblN1ZmZpeF0uY29uY2F0KGRlZmF1bHRIb3N0cyk7XG4gICAgdGhpcy5ob3N0cy53cml0ZSA9IFt0aGlzLmFwcGxpY2F0aW9uSUQgKyAnLmFsZ29saWEubmV0J10uY29uY2F0KGRlZmF1bHRIb3N0cyk7XG4gIH0gZWxzZSBpZiAoaXNBcnJheShvcHRzLmhvc3RzKSkge1xuICAgIC8vIHdoZW4gcGFzc2luZyBjdXN0b20gaG9zdHMsIHdlIG5lZWQgdG8gaGF2ZSBhIGRpZmZlcmVudCBob3N0IGluZGV4IGlmIHRoZSBudW1iZXJcbiAgICAvLyBvZiB3cml0ZS9yZWFkIGhvc3RzIGFyZSBkaWZmZXJlbnQuXG4gICAgdGhpcy5ob3N0cy5yZWFkID0gY2xvbmUob3B0cy5ob3N0cyk7XG4gICAgdGhpcy5ob3N0cy53cml0ZSA9IGNsb25lKG9wdHMuaG9zdHMpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuaG9zdHMucmVhZCA9IGNsb25lKG9wdHMuaG9zdHMucmVhZCk7XG4gICAgdGhpcy5ob3N0cy53cml0ZSA9IGNsb25lKG9wdHMuaG9zdHMud3JpdGUpO1xuICB9XG5cbiAgLy8gYWRkIHByb3RvY29sIGFuZCBsb3dlcmNhc2UgaG9zdHNcbiAgdGhpcy5ob3N0cy5yZWFkID0gbWFwKHRoaXMuaG9zdHMucmVhZCwgcHJlcGFyZUhvc3QocHJvdG9jb2wpKTtcbiAgdGhpcy5ob3N0cy53cml0ZSA9IG1hcCh0aGlzLmhvc3RzLndyaXRlLCBwcmVwYXJlSG9zdChwcm90b2NvbCkpO1xuXG4gIHRoaXMuZXh0cmFIZWFkZXJzID0ge307XG5cbiAgLy8gSW4gc29tZSBzaXR1YXRpb25zIHlvdSBtaWdodCB3YW50IHRvIHdhcm0gdGhlIGNhY2hlXG4gIHRoaXMuY2FjaGUgPSBvcHRzLl9jYWNoZSB8fCB7fTtcblxuICB0aGlzLl91YSA9IG9wdHMuX3VhO1xuICB0aGlzLl91c2VDYWNoZSA9IG9wdHMuX3VzZUNhY2hlID09PSB1bmRlZmluZWQgfHwgb3B0cy5fY2FjaGUgPyB0cnVlIDogb3B0cy5fdXNlQ2FjaGU7XG4gIHRoaXMuX3VzZVJlcXVlc3RDYWNoZSA9IHRoaXMuX3VzZUNhY2hlICYmIG9wdHMuX3VzZVJlcXVlc3RDYWNoZTtcbiAgdGhpcy5fdXNlRmFsbGJhY2sgPSBvcHRzLnVzZUZhbGxiYWNrID09PSB1bmRlZmluZWQgPyB0cnVlIDogb3B0cy51c2VGYWxsYmFjaztcblxuICB0aGlzLl9zZXRUaW1lb3V0ID0gb3B0cy5fc2V0VGltZW91dDtcblxuICBkZWJ1ZygnaW5pdCBkb25lLCAlaicsIHRoaXMpO1xufVxuXG4vKlxuICogR2V0IHRoZSBpbmRleCBvYmplY3QgaW5pdGlhbGl6ZWRcbiAqXG4gKiBAcGFyYW0gaW5kZXhOYW1lIHRoZSBuYW1lIG9mIGluZGV4XG4gKiBAcGFyYW0gY2FsbGJhY2sgdGhlIHJlc3VsdCBjYWxsYmFjayB3aXRoIG9uZSBhcmd1bWVudCAodGhlIEluZGV4IGluc3RhbmNlKVxuICovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuaW5pdEluZGV4ID0gZnVuY3Rpb24oaW5kZXhOYW1lKSB7XG4gIHJldHVybiBuZXcgSW5kZXhDb3JlKHRoaXMsIGluZGV4TmFtZSk7XG59O1xuXG4vKipcbiogQWRkIGFuIGV4dHJhIGZpZWxkIHRvIHRoZSBIVFRQIHJlcXVlc3RcbipcbiogQHBhcmFtIG5hbWUgdGhlIGhlYWRlciBmaWVsZCBuYW1lXG4qIEBwYXJhbSB2YWx1ZSB0aGUgaGVhZGVyIGZpZWxkIHZhbHVlXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLnNldEV4dHJhSGVhZGVyID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgdGhpcy5leHRyYUhlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlO1xufTtcblxuLyoqXG4qIEdldCB0aGUgdmFsdWUgb2YgYW4gZXh0cmEgSFRUUCBoZWFkZXJcbipcbiogQHBhcmFtIG5hbWUgdGhlIGhlYWRlciBmaWVsZCBuYW1lXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLmdldEV4dHJhSGVhZGVyID0gZnVuY3Rpb24obmFtZSkge1xuICByZXR1cm4gdGhpcy5leHRyYUhlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXTtcbn07XG5cbi8qKlxuKiBSZW1vdmUgYW4gZXh0cmEgZmllbGQgZnJvbSB0aGUgSFRUUCByZXF1ZXN0XG4qXG4qIEBwYXJhbSBuYW1lIHRoZSBoZWFkZXIgZmllbGQgbmFtZVxuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS51bnNldEV4dHJhSGVhZGVyID0gZnVuY3Rpb24obmFtZSkge1xuICBkZWxldGUgdGhpcy5leHRyYUhlYWRlcnNbbmFtZS50b0xvd2VyQ2FzZSgpXTtcbn07XG5cbi8qKlxuKiBBdWdtZW50IHNlbnQgeC1hbGdvbGlhLWFnZW50IHdpdGggbW9yZSBkYXRhLCBlYWNoIGFnZW50IHBhcnRcbiogaXMgYXV0b21hdGljYWxseSBzZXBhcmF0ZWQgZnJvbSB0aGUgb3RoZXJzIGJ5IGEgc2VtaWNvbG9uO1xuKlxuKiBAcGFyYW0gYWxnb2xpYUFnZW50IHRoZSBhZ2VudCB0byBhZGRcbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuYWRkQWxnb2xpYUFnZW50ID0gZnVuY3Rpb24oYWxnb2xpYUFnZW50KSB7XG4gIGlmICh0aGlzLl91YS5pbmRleE9mKCc7JyArIGFsZ29saWFBZ2VudCkgPT09IC0xKSB7XG4gICAgdGhpcy5fdWEgKz0gJzsnICsgYWxnb2xpYUFnZW50O1xuICB9XG59O1xuXG4vKlxuICogV3JhcHBlciB0aGF0IHRyeSBhbGwgaG9zdHMgdG8gbWF4aW1pemUgdGhlIHF1YWxpdHkgb2Ygc2VydmljZVxuICovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2pzb25SZXF1ZXN0ID0gZnVuY3Rpb24oaW5pdGlhbE9wdHMpIHtcbiAgdGhpcy5fY2hlY2tBcHBJZERhdGEoKTtcblxuICB2YXIgcmVxdWVzdERlYnVnID0gcmVxdWlyZSgnZGVidWcnKSgnYWxnb2xpYXNlYXJjaDonICsgaW5pdGlhbE9wdHMudXJsKTtcblxuXG4gIHZhciBib2R5O1xuICB2YXIgY2FjaGVJRDtcbiAgdmFyIGFkZGl0aW9uYWxVQSA9IGluaXRpYWxPcHRzLmFkZGl0aW9uYWxVQSB8fCAnJztcbiAgdmFyIGNhY2hlID0gaW5pdGlhbE9wdHMuY2FjaGU7XG4gIHZhciBjbGllbnQgPSB0aGlzO1xuICB2YXIgdHJpZXMgPSAwO1xuICB2YXIgdXNpbmdGYWxsYmFjayA9IGZhbHNlO1xuICB2YXIgaGFzRmFsbGJhY2sgPSBjbGllbnQuX3VzZUZhbGxiYWNrICYmIGNsaWVudC5fcmVxdWVzdC5mYWxsYmFjayAmJiBpbml0aWFsT3B0cy5mYWxsYmFjaztcbiAgdmFyIGhlYWRlcnM7XG5cbiAgaWYgKFxuICAgIHRoaXMuYXBpS2V5Lmxlbmd0aCA+IE1BWF9BUElfS0VZX0xFTkdUSCAmJlxuICAgIGluaXRpYWxPcHRzLmJvZHkgIT09IHVuZGVmaW5lZCAmJlxuICAgIChpbml0aWFsT3B0cy5ib2R5LnBhcmFtcyAhPT0gdW5kZWZpbmVkIHx8IC8vIGluZGV4LnNlYXJjaCgpXG4gICAgaW5pdGlhbE9wdHMuYm9keS5yZXF1ZXN0cyAhPT0gdW5kZWZpbmVkKSAvLyBjbGllbnQuc2VhcmNoKClcbiAgKSB7XG4gICAgaW5pdGlhbE9wdHMuYm9keS5hcGlLZXkgPSB0aGlzLmFwaUtleTtcbiAgICBoZWFkZXJzID0gdGhpcy5fY29tcHV0ZVJlcXVlc3RIZWFkZXJzKHtcbiAgICAgIGFkZGl0aW9uYWxVQTogYWRkaXRpb25hbFVBLFxuICAgICAgd2l0aEFwaUtleTogZmFsc2UsXG4gICAgICBoZWFkZXJzOiBpbml0aWFsT3B0cy5oZWFkZXJzXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgaGVhZGVycyA9IHRoaXMuX2NvbXB1dGVSZXF1ZXN0SGVhZGVycyh7XG4gICAgICBhZGRpdGlvbmFsVUE6IGFkZGl0aW9uYWxVQSxcbiAgICAgIGhlYWRlcnM6IGluaXRpYWxPcHRzLmhlYWRlcnNcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChpbml0aWFsT3B0cy5ib2R5ICE9PSB1bmRlZmluZWQpIHtcbiAgICBib2R5ID0gc2FmZUpTT05TdHJpbmdpZnkoaW5pdGlhbE9wdHMuYm9keSk7XG4gIH1cblxuICByZXF1ZXN0RGVidWcoJ3JlcXVlc3Qgc3RhcnQnKTtcbiAgdmFyIGRlYnVnRGF0YSA9IFtdO1xuXG5cbiAgZnVuY3Rpb24gZG9SZXF1ZXN0KHJlcXVlc3RlciwgcmVxT3B0cykge1xuICAgIGNsaWVudC5fY2hlY2tBcHBJZERhdGEoKTtcblxuICAgIHZhciBzdGFydFRpbWUgPSBuZXcgRGF0ZSgpO1xuXG4gICAgaWYgKGNsaWVudC5fdXNlQ2FjaGUgJiYgIWNsaWVudC5fdXNlUmVxdWVzdENhY2hlKSB7XG4gICAgICBjYWNoZUlEID0gaW5pdGlhbE9wdHMudXJsO1xuICAgIH1cblxuICAgIC8vIGFzIHdlIHNvbWV0aW1lIHVzZSBQT1NUIHJlcXVlc3RzIHRvIHBhc3MgcGFyYW1ldGVycyAobGlrZSBxdWVyeT0nYWEnKSxcbiAgICAvLyB0aGUgY2FjaGVJRCBtdXN0IGFsc28gaW5jbHVkZSB0aGUgYm9keSB0byBiZSBkaWZmZXJlbnQgYmV0d2VlbiBjYWxsc1xuICAgIGlmIChjbGllbnQuX3VzZUNhY2hlICYmICFjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSAmJiBib2R5KSB7XG4gICAgICBjYWNoZUlEICs9ICdfYm9keV8nICsgcmVxT3B0cy5ib2R5O1xuICAgIH1cblxuICAgIC8vIGhhbmRsZSBjYWNoZSBleGlzdGVuY2VcbiAgICBpZiAoaXNDYWNoZVZhbGlkV2l0aEN1cnJlbnRJRCghY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUsIGNhY2hlLCBjYWNoZUlEKSkge1xuICAgICAgcmVxdWVzdERlYnVnKCdzZXJ2aW5nIHJlc3BvbnNlIGZyb20gY2FjaGUnKTtcblxuICAgICAgdmFyIHJlc3BvbnNlVGV4dCA9IGNhY2hlW2NhY2hlSURdO1xuXG4gICAgICAvLyBDYWNoZSByZXNwb25zZSBtdXN0IG1hdGNoIHRoZSB0eXBlIG9mIHRoZSBvcmlnaW5hbCBvbmVcbiAgICAgIHJldHVybiBjbGllbnQuX3Byb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIGJvZHk6IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KSxcbiAgICAgICAgcmVzcG9uc2VUZXh0OiByZXNwb25zZVRleHRcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIGlmIHdlIHJlYWNoZWQgbWF4IHRyaWVzXG4gICAgaWYgKHRyaWVzID49IGNsaWVudC5ob3N0c1tpbml0aWFsT3B0cy5ob3N0VHlwZV0ubGVuZ3RoKSB7XG4gICAgICBpZiAoIWhhc0ZhbGxiYWNrIHx8IHVzaW5nRmFsbGJhY2spIHtcbiAgICAgICAgcmVxdWVzdERlYnVnKCdjb3VsZCBub3QgZ2V0IGFueSByZXNwb25zZScpO1xuICAgICAgICAvLyB0aGVuIHN0b3BcbiAgICAgICAgcmV0dXJuIGNsaWVudC5fcHJvbWlzZS5yZWplY3QobmV3IGVycm9ycy5BbGdvbGlhU2VhcmNoRXJyb3IoXG4gICAgICAgICAgJ0Nhbm5vdCBjb25uZWN0IHRvIHRoZSBBbGdvbGlhU2VhcmNoIEFQSS4nICtcbiAgICAgICAgICAnIFNlbmQgYW4gZW1haWwgdG8gc3VwcG9ydEBhbGdvbGlhLmNvbSB0byByZXBvcnQgYW5kIHJlc29sdmUgdGhlIGlzc3VlLicgK1xuICAgICAgICAgICcgQXBwbGljYXRpb24gaWQgd2FzOiAnICsgY2xpZW50LmFwcGxpY2F0aW9uSUQsIHtkZWJ1Z0RhdGE6IGRlYnVnRGF0YX1cbiAgICAgICAgKSk7XG4gICAgICB9XG5cbiAgICAgIHJlcXVlc3REZWJ1Zygnc3dpdGNoaW5nIHRvIGZhbGxiYWNrJyk7XG5cbiAgICAgIC8vIGxldCdzIHRyeSB0aGUgZmFsbGJhY2sgc3RhcnRpbmcgZnJvbSBoZXJlXG4gICAgICB0cmllcyA9IDA7XG5cbiAgICAgIC8vIG1ldGhvZCwgdXJsIGFuZCBib2R5IGFyZSBmYWxsYmFjayBkZXBlbmRlbnRcbiAgICAgIHJlcU9wdHMubWV0aG9kID0gaW5pdGlhbE9wdHMuZmFsbGJhY2subWV0aG9kO1xuICAgICAgcmVxT3B0cy51cmwgPSBpbml0aWFsT3B0cy5mYWxsYmFjay51cmw7XG4gICAgICByZXFPcHRzLmpzb25Cb2R5ID0gaW5pdGlhbE9wdHMuZmFsbGJhY2suYm9keTtcbiAgICAgIGlmIChyZXFPcHRzLmpzb25Cb2R5KSB7XG4gICAgICAgIHJlcU9wdHMuYm9keSA9IHNhZmVKU09OU3RyaW5naWZ5KHJlcU9wdHMuanNvbkJvZHkpO1xuICAgICAgfVxuICAgICAgLy8gcmUtY29tcHV0ZSBoZWFkZXJzLCB0aGV5IGNvdWxkIGJlIG9taXR0aW5nIHRoZSBBUEkgS0VZXG4gICAgICBoZWFkZXJzID0gY2xpZW50Ll9jb21wdXRlUmVxdWVzdEhlYWRlcnMoe1xuICAgICAgICBhZGRpdGlvbmFsVUE6IGFkZGl0aW9uYWxVQSxcbiAgICAgICAgaGVhZGVyczogaW5pdGlhbE9wdHMuaGVhZGVyc1xuICAgICAgfSk7XG5cbiAgICAgIHJlcU9wdHMudGltZW91dHMgPSBjbGllbnQuX2dldFRpbWVvdXRzRm9yUmVxdWVzdChpbml0aWFsT3B0cy5ob3N0VHlwZSk7XG4gICAgICBjbGllbnQuX3NldEhvc3RJbmRleEJ5VHlwZSgwLCBpbml0aWFsT3B0cy5ob3N0VHlwZSk7XG4gICAgICB1c2luZ0ZhbGxiYWNrID0gdHJ1ZTsgLy8gdGhlIGN1cnJlbnQgcmVxdWVzdCBpcyBub3cgdXNpbmcgZmFsbGJhY2tcbiAgICAgIHJldHVybiBkb1JlcXVlc3QoY2xpZW50Ll9yZXF1ZXN0LmZhbGxiYWNrLCByZXFPcHRzKTtcbiAgICB9XG5cbiAgICB2YXIgY3VycmVudEhvc3QgPSBjbGllbnQuX2dldEhvc3RCeVR5cGUoaW5pdGlhbE9wdHMuaG9zdFR5cGUpO1xuXG4gICAgdmFyIHVybCA9IGN1cnJlbnRIb3N0ICsgcmVxT3B0cy51cmw7XG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICBib2R5OiByZXFPcHRzLmJvZHksXG4gICAgICBqc29uQm9keTogcmVxT3B0cy5qc29uQm9keSxcbiAgICAgIG1ldGhvZDogcmVxT3B0cy5tZXRob2QsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgICAgdGltZW91dHM6IHJlcU9wdHMudGltZW91dHMsXG4gICAgICBkZWJ1ZzogcmVxdWVzdERlYnVnLFxuICAgICAgZm9yY2VBdXRoSGVhZGVyczogcmVxT3B0cy5mb3JjZUF1dGhIZWFkZXJzXG4gICAgfTtcblxuICAgIHJlcXVlc3REZWJ1ZygnbWV0aG9kOiAlcywgdXJsOiAlcywgaGVhZGVyczogJWosIHRpbWVvdXRzOiAlZCcsXG4gICAgICBvcHRpb25zLm1ldGhvZCwgdXJsLCBvcHRpb25zLmhlYWRlcnMsIG9wdGlvbnMudGltZW91dHMpO1xuXG4gICAgaWYgKHJlcXVlc3RlciA9PT0gY2xpZW50Ll9yZXF1ZXN0LmZhbGxiYWNrKSB7XG4gICAgICByZXF1ZXN0RGVidWcoJ3VzaW5nIGZhbGxiYWNrJyk7XG4gICAgfVxuXG4gICAgLy8gYHJlcXVlc3RlcmAgaXMgYW55IG9mIHRoaXMuX3JlcXVlc3Qgb3IgdGhpcy5fcmVxdWVzdC5mYWxsYmFja1xuICAgIC8vIHRodXMgaXQgbmVlZHMgdG8gYmUgY2FsbGVkIHVzaW5nIHRoZSBjbGllbnQgYXMgY29udGV4dFxuICAgIHJldHVybiByZXF1ZXN0ZXIuY2FsbChjbGllbnQsIHVybCwgb3B0aW9ucykudGhlbihzdWNjZXNzLCB0cnlGYWxsYmFjayk7XG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKGh0dHBSZXNwb25zZSkge1xuICAgICAgLy8gY29tcHV0ZSB0aGUgc3RhdHVzIG9mIHRoZSByZXNwb25zZSxcbiAgICAgIC8vXG4gICAgICAvLyBXaGVuIGluIGJyb3dzZXIgbW9kZSwgdXNpbmcgWERSIG9yIEpTT05QLCB3ZSBoYXZlIG5vIHN0YXR1c0NvZGUgYXZhaWxhYmxlXG4gICAgICAvLyBTbyB3ZSByZWx5IG9uIG91ciBBUEkgcmVzcG9uc2UgYHN0YXR1c2AgcHJvcGVydHkuXG4gICAgICAvLyBCdXQgYHdhaXRUYXNrYCBjYW4gc2V0IGEgYHN0YXR1c2AgcHJvcGVydHkgd2hpY2ggaXMgbm90IHRoZSBzdGF0dXNDb2RlIChpdCdzIHRoZSB0YXNrIHN0YXR1cylcbiAgICAgIC8vIFNvIHdlIGNoZWNrIGlmIHRoZXJlJ3MgYSBgbWVzc2FnZWAgYWxvbmcgYHN0YXR1c2AgYW5kIGl0IG1lYW5zIGl0J3MgYW4gZXJyb3JcbiAgICAgIC8vXG4gICAgICAvLyBUaGF0J3MgdGhlIG9ubHkgY2FzZSB3aGVyZSB3ZSBoYXZlIGEgcmVzcG9uc2Uuc3RhdHVzIHRoYXQncyBub3QgdGhlIGh0dHAgc3RhdHVzQ29kZVxuICAgICAgdmFyIHN0YXR1cyA9IGh0dHBSZXNwb25zZSAmJiBodHRwUmVzcG9uc2UuYm9keSAmJiBodHRwUmVzcG9uc2UuYm9keS5tZXNzYWdlICYmIGh0dHBSZXNwb25zZS5ib2R5LnN0YXR1cyB8fFxuXG4gICAgICAgIC8vIHRoaXMgaXMgaW1wb3J0YW50IHRvIGNoZWNrIHRoZSByZXF1ZXN0IHN0YXR1c0NvZGUgQUZURVIgdGhlIGJvZHkgZXZlbnR1YWxcbiAgICAgICAgLy8gc3RhdHVzQ29kZSBiZWNhdXNlIHNvbWUgaW1wbGVtZW50YXRpb25zIChqUXVlcnkgWERvbWFpblJlcXVlc3QgdHJhbnNwb3J0KSBtYXlcbiAgICAgICAgLy8gc2VuZCBzdGF0dXNDb2RlIDIwMCB3aGlsZSB3ZSBoYWQgYW4gZXJyb3JcbiAgICAgICAgaHR0cFJlc3BvbnNlLnN0YXR1c0NvZGUgfHxcblxuICAgICAgICAvLyBXaGVuIGluIGJyb3dzZXIgbW9kZSwgdXNpbmcgWERSIG9yIEpTT05QXG4gICAgICAgIC8vIHdlIGRlZmF1bHQgdG8gc3VjY2VzcyB3aGVuIG5vIGVycm9yIChubyByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UubWVzc2FnZSlcbiAgICAgICAgLy8gSWYgdGhlcmUgd2FzIGEgSlNPTi5wYXJzZSgpIGVycm9yIHRoZW4gYm9keSBpcyBudWxsIGFuZCBpdCBmYWlsc1xuICAgICAgICBodHRwUmVzcG9uc2UgJiYgaHR0cFJlc3BvbnNlLmJvZHkgJiYgMjAwO1xuXG4gICAgICByZXF1ZXN0RGVidWcoJ3JlY2VpdmVkIHJlc3BvbnNlOiBzdGF0dXNDb2RlOiAlcywgY29tcHV0ZWQgc3RhdHVzQ29kZTogJWQsIGhlYWRlcnM6ICVqJyxcbiAgICAgICAgaHR0cFJlc3BvbnNlLnN0YXR1c0NvZGUsIHN0YXR1cywgaHR0cFJlc3BvbnNlLmhlYWRlcnMpO1xuXG4gICAgICB2YXIgaHR0cFJlc3BvbnNlT2sgPSBNYXRoLmZsb29yKHN0YXR1cyAvIDEwMCkgPT09IDI7XG5cbiAgICAgIHZhciBlbmRUaW1lID0gbmV3IERhdGUoKTtcbiAgICAgIGRlYnVnRGF0YS5wdXNoKHtcbiAgICAgICAgY3VycmVudEhvc3Q6IGN1cnJlbnRIb3N0LFxuICAgICAgICBoZWFkZXJzOiByZW1vdmVDcmVkZW50aWFscyhoZWFkZXJzKSxcbiAgICAgICAgY29udGVudDogYm9keSB8fCBudWxsLFxuICAgICAgICBjb250ZW50TGVuZ3RoOiBib2R5ICE9PSB1bmRlZmluZWQgPyBib2R5Lmxlbmd0aCA6IG51bGwsXG4gICAgICAgIG1ldGhvZDogcmVxT3B0cy5tZXRob2QsXG4gICAgICAgIHRpbWVvdXRzOiByZXFPcHRzLnRpbWVvdXRzLFxuICAgICAgICB1cmw6IHJlcU9wdHMudXJsLFxuICAgICAgICBzdGFydFRpbWU6IHN0YXJ0VGltZSxcbiAgICAgICAgZW5kVGltZTogZW5kVGltZSxcbiAgICAgICAgZHVyYXRpb246IGVuZFRpbWUgLSBzdGFydFRpbWUsXG4gICAgICAgIHN0YXR1c0NvZGU6IHN0YXR1c1xuICAgICAgfSk7XG5cbiAgICAgIGlmIChodHRwUmVzcG9uc2VPaykge1xuICAgICAgICBpZiAoY2xpZW50Ll91c2VDYWNoZSAmJiAhY2xpZW50Ll91c2VSZXF1ZXN0Q2FjaGUgJiYgY2FjaGUpIHtcbiAgICAgICAgICBjYWNoZVtjYWNoZUlEXSA9IGh0dHBSZXNwb25zZS5yZXNwb25zZVRleHQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlc3BvbnNlVGV4dDogaHR0cFJlc3BvbnNlLnJlc3BvbnNlVGV4dCxcbiAgICAgICAgICBib2R5OiBodHRwUmVzcG9uc2UuYm9keVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICB2YXIgc2hvdWxkUmV0cnkgPSBNYXRoLmZsb29yKHN0YXR1cyAvIDEwMCkgIT09IDQ7XG5cbiAgICAgIGlmIChzaG91bGRSZXRyeSkge1xuICAgICAgICB0cmllcyArPSAxO1xuICAgICAgICByZXR1cm4gcmV0cnlSZXF1ZXN0KCk7XG4gICAgICB9XG5cbiAgICAgIHJlcXVlc3REZWJ1ZygndW5yZWNvdmVyYWJsZSBlcnJvcicpO1xuXG4gICAgICAvLyBubyBzdWNjZXNzIGFuZCBubyByZXRyeSA9PiBmYWlsXG4gICAgICB2YXIgdW5yZWNvdmVyYWJsZUVycm9yID0gbmV3IGVycm9ycy5BbGdvbGlhU2VhcmNoRXJyb3IoXG4gICAgICAgIGh0dHBSZXNwb25zZS5ib2R5ICYmIGh0dHBSZXNwb25zZS5ib2R5Lm1lc3NhZ2UsIHtkZWJ1Z0RhdGE6IGRlYnVnRGF0YSwgc3RhdHVzQ29kZTogc3RhdHVzfVxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIGNsaWVudC5fcHJvbWlzZS5yZWplY3QodW5yZWNvdmVyYWJsZUVycm9yKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0cnlGYWxsYmFjayhlcnIpIHtcbiAgICAgIC8vIGVycm9yIGNhc2VzOlxuICAgICAgLy8gIFdoaWxlIG5vdCBpbiBmYWxsYmFjayBtb2RlOlxuICAgICAgLy8gICAgLSBDT1JTIG5vdCBzdXBwb3J0ZWRcbiAgICAgIC8vICAgIC0gbmV0d29yayBlcnJvclxuICAgICAgLy8gIFdoaWxlIGluIGZhbGxiYWNrIG1vZGU6XG4gICAgICAvLyAgICAtIHRpbWVvdXRcbiAgICAgIC8vICAgIC0gbmV0d29yayBlcnJvclxuICAgICAgLy8gICAgLSBiYWRseSBmb3JtYXR0ZWQgSlNPTlAgKHNjcmlwdCBsb2FkZWQsIGRpZCBub3QgY2FsbCBvdXIgY2FsbGJhY2spXG4gICAgICAvLyAgSW4gYm90aCBjYXNlczpcbiAgICAgIC8vICAgIC0gdW5jYXVnaHQgZXhjZXB0aW9uIG9jY3VycyAoVHlwZUVycm9yKVxuICAgICAgcmVxdWVzdERlYnVnKCdlcnJvcjogJXMsIHN0YWNrOiAlcycsIGVyci5tZXNzYWdlLCBlcnIuc3RhY2spO1xuXG4gICAgICB2YXIgZW5kVGltZSA9IG5ldyBEYXRlKCk7XG4gICAgICBkZWJ1Z0RhdGEucHVzaCh7XG4gICAgICAgIGN1cnJlbnRIb3N0OiBjdXJyZW50SG9zdCxcbiAgICAgICAgaGVhZGVyczogcmVtb3ZlQ3JlZGVudGlhbHMoaGVhZGVycyksXG4gICAgICAgIGNvbnRlbnQ6IGJvZHkgfHwgbnVsbCxcbiAgICAgICAgY29udGVudExlbmd0aDogYm9keSAhPT0gdW5kZWZpbmVkID8gYm9keS5sZW5ndGggOiBudWxsLFxuICAgICAgICBtZXRob2Q6IHJlcU9wdHMubWV0aG9kLFxuICAgICAgICB0aW1lb3V0czogcmVxT3B0cy50aW1lb3V0cyxcbiAgICAgICAgdXJsOiByZXFPcHRzLnVybCxcbiAgICAgICAgc3RhcnRUaW1lOiBzdGFydFRpbWUsXG4gICAgICAgIGVuZFRpbWU6IGVuZFRpbWUsXG4gICAgICAgIGR1cmF0aW9uOiBlbmRUaW1lIC0gc3RhcnRUaW1lXG4gICAgICB9KTtcblxuICAgICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgZXJyb3JzLkFsZ29saWFTZWFyY2hFcnJvcikpIHtcbiAgICAgICAgZXJyID0gbmV3IGVycm9ycy5Vbmtub3duKGVyciAmJiBlcnIubWVzc2FnZSwgZXJyKTtcbiAgICAgIH1cblxuICAgICAgdHJpZXMgKz0gMTtcblxuICAgICAgLy8gc3RvcCB0aGUgcmVxdWVzdCBpbXBsZW1lbnRhdGlvbiB3aGVuOlxuICAgICAgaWYgKFxuICAgICAgICAvLyB3ZSBkaWQgbm90IGdlbmVyYXRlIHRoaXMgZXJyb3IsXG4gICAgICAgIC8vIGl0IGNvbWVzIGZyb20gYSB0aHJvdyBpbiBzb21lIG90aGVyIHBpZWNlIG9mIGNvZGVcbiAgICAgICAgZXJyIGluc3RhbmNlb2YgZXJyb3JzLlVua25vd24gfHxcblxuICAgICAgICAvLyBzZXJ2ZXIgc2VudCB1bnBhcnNhYmxlIEpTT05cbiAgICAgICAgZXJyIGluc3RhbmNlb2YgZXJyb3JzLlVucGFyc2FibGVKU09OIHx8XG5cbiAgICAgICAgLy8gbWF4IHRyaWVzIGFuZCBhbHJlYWR5IHVzaW5nIGZhbGxiYWNrIG9yIG5vIGZhbGxiYWNrXG4gICAgICAgIHRyaWVzID49IGNsaWVudC5ob3N0c1tpbml0aWFsT3B0cy5ob3N0VHlwZV0ubGVuZ3RoICYmXG4gICAgICAgICh1c2luZ0ZhbGxiYWNrIHx8ICFoYXNGYWxsYmFjaykpIHtcbiAgICAgICAgLy8gc3RvcCByZXF1ZXN0IGltcGxlbWVudGF0aW9uIGZvciB0aGlzIGNvbW1hbmRcbiAgICAgICAgZXJyLmRlYnVnRGF0YSA9IGRlYnVnRGF0YTtcbiAgICAgICAgcmV0dXJuIGNsaWVudC5fcHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgIH1cblxuICAgICAgLy8gV2hlbiBhIHRpbWVvdXQgb2NjdXJlZCwgcmV0cnkgYnkgcmFpc2luZyB0aW1lb3V0XG4gICAgICBpZiAoZXJyIGluc3RhbmNlb2YgZXJyb3JzLlJlcXVlc3RUaW1lb3V0KSB7XG4gICAgICAgIHJldHVybiByZXRyeVJlcXVlc3RXaXRoSGlnaGVyVGltZW91dCgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmV0cnlSZXF1ZXN0KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmV0cnlSZXF1ZXN0KCkge1xuICAgICAgcmVxdWVzdERlYnVnKCdyZXRyeWluZyByZXF1ZXN0Jyk7XG4gICAgICBjbGllbnQuX2luY3JlbWVudEhvc3RJbmRleChpbml0aWFsT3B0cy5ob3N0VHlwZSk7XG4gICAgICByZXR1cm4gZG9SZXF1ZXN0KHJlcXVlc3RlciwgcmVxT3B0cyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmV0cnlSZXF1ZXN0V2l0aEhpZ2hlclRpbWVvdXQoKSB7XG4gICAgICByZXF1ZXN0RGVidWcoJ3JldHJ5aW5nIHJlcXVlc3Qgd2l0aCBoaWdoZXIgdGltZW91dCcpO1xuICAgICAgY2xpZW50Ll9pbmNyZW1lbnRIb3N0SW5kZXgoaW5pdGlhbE9wdHMuaG9zdFR5cGUpO1xuICAgICAgY2xpZW50Ll9pbmNyZW1lbnRUaW1lb3V0TXVsdGlwbGVyKCk7XG4gICAgICByZXFPcHRzLnRpbWVvdXRzID0gY2xpZW50Ll9nZXRUaW1lb3V0c0ZvclJlcXVlc3QoaW5pdGlhbE9wdHMuaG9zdFR5cGUpO1xuICAgICAgcmV0dXJuIGRvUmVxdWVzdChyZXF1ZXN0ZXIsIHJlcU9wdHMpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGlzQ2FjaGVWYWxpZFdpdGhDdXJyZW50SUQoXG4gICAgdXNlUmVxdWVzdENhY2hlLFxuICAgIGN1cnJlbnRDYWNoZSxcbiAgICBjdXJyZW50Q2FjaGVJRFxuICApIHtcbiAgICByZXR1cm4gKFxuICAgICAgY2xpZW50Ll91c2VDYWNoZSAmJlxuICAgICAgdXNlUmVxdWVzdENhY2hlICYmXG4gICAgICBjdXJyZW50Q2FjaGUgJiZcbiAgICAgIGN1cnJlbnRDYWNoZVtjdXJyZW50Q2FjaGVJRF0gIT09IHVuZGVmaW5lZFxuICAgICk7XG4gIH1cblxuXG4gIGZ1bmN0aW9uIGludGVyb3BDYWxsYmFja1JldHVybihyZXF1ZXN0LCBjYWxsYmFjaykge1xuICAgIGlmIChpc0NhY2hlVmFsaWRXaXRoQ3VycmVudElEKGNsaWVudC5fdXNlUmVxdWVzdENhY2hlLCBjYWNoZSwgY2FjaGVJRCkpIHtcbiAgICAgIHJlcXVlc3QuY2F0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFJlbGVhc2UgdGhlIGNhY2hlIG9uIGVycm9yXG4gICAgICAgIGRlbGV0ZSBjYWNoZVtjYWNoZUlEXTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgaW5pdGlhbE9wdHMuY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIC8vIGVpdGhlciB3ZSBoYXZlIGEgY2FsbGJhY2tcbiAgICAgIHJlcXVlc3QudGhlbihmdW5jdGlvbiBva0NiKGNvbnRlbnQpIHtcbiAgICAgICAgZXhpdFByb21pc2UoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaW5pdGlhbE9wdHMuY2FsbGJhY2sobnVsbCwgY2FsbGJhY2soY29udGVudCkpO1xuICAgICAgICB9LCBjbGllbnQuX3NldFRpbWVvdXQgfHwgc2V0VGltZW91dCk7XG4gICAgICB9LCBmdW5jdGlvbiBub29rQ2IoZXJyKSB7XG4gICAgICAgIGV4aXRQcm9taXNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGluaXRpYWxPcHRzLmNhbGxiYWNrKGVycik7XG4gICAgICAgIH0sIGNsaWVudC5fc2V0VGltZW91dCB8fCBzZXRUaW1lb3V0KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBlaXRoZXIgd2UgYXJlIHVzaW5nIHByb21pc2VzXG4gICAgICByZXR1cm4gcmVxdWVzdC50aGVuKGNhbGxiYWNrKTtcbiAgICB9XG4gIH1cblxuICBpZiAoY2xpZW50Ll91c2VDYWNoZSAmJiBjbGllbnQuX3VzZVJlcXVlc3RDYWNoZSkge1xuICAgIGNhY2hlSUQgPSBpbml0aWFsT3B0cy51cmw7XG4gIH1cblxuICAvLyBhcyB3ZSBzb21ldGltZSB1c2UgUE9TVCByZXF1ZXN0cyB0byBwYXNzIHBhcmFtZXRlcnMgKGxpa2UgcXVlcnk9J2FhJyksXG4gIC8vIHRoZSBjYWNoZUlEIG11c3QgYWxzbyBpbmNsdWRlIHRoZSBib2R5IHRvIGJlIGRpZmZlcmVudCBiZXR3ZWVuIGNhbGxzXG4gIGlmIChjbGllbnQuX3VzZUNhY2hlICYmIGNsaWVudC5fdXNlUmVxdWVzdENhY2hlICYmIGJvZHkpIHtcbiAgICBjYWNoZUlEICs9ICdfYm9keV8nICsgYm9keTtcbiAgfVxuXG4gIGlmIChpc0NhY2hlVmFsaWRXaXRoQ3VycmVudElEKGNsaWVudC5fdXNlUmVxdWVzdENhY2hlLCBjYWNoZSwgY2FjaGVJRCkpIHtcbiAgICByZXF1ZXN0RGVidWcoJ3NlcnZpbmcgcmVxdWVzdCBmcm9tIGNhY2hlJyk7XG5cbiAgICB2YXIgbWF5YmVQcm9taXNlRm9yQ2FjaGUgPSBjYWNoZVtjYWNoZUlEXTtcblxuICAgIC8vIEluIGNhc2UgdGhlIGNhY2hlIGlzIHdhcm11cCB3aXRoIHZhbHVlIHRoYXQgaXMgbm90IGEgcHJvbWlzZVxuICAgIHZhciBwcm9taXNlRm9yQ2FjaGUgPSB0eXBlb2YgbWF5YmVQcm9taXNlRm9yQ2FjaGUudGhlbiAhPT0gJ2Z1bmN0aW9uJ1xuICAgICAgPyBjbGllbnQuX3Byb21pc2UucmVzb2x2ZSh7cmVzcG9uc2VUZXh0OiBtYXliZVByb21pc2VGb3JDYWNoZX0pXG4gICAgICA6IG1heWJlUHJvbWlzZUZvckNhY2hlO1xuXG4gICAgcmV0dXJuIGludGVyb3BDYWxsYmFja1JldHVybihwcm9taXNlRm9yQ2FjaGUsIGZ1bmN0aW9uKGNvbnRlbnQpIHtcbiAgICAgIC8vIEluIGNhc2Ugb2YgdGhlIGNhY2hlIHJlcXVlc3QsIHJldHVybiB0aGUgb3JpZ2luYWwgdmFsdWVcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGNvbnRlbnQucmVzcG9uc2VUZXh0KTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciByZXF1ZXN0ID0gZG9SZXF1ZXN0KFxuICAgIGNsaWVudC5fcmVxdWVzdCwge1xuICAgICAgdXJsOiBpbml0aWFsT3B0cy51cmwsXG4gICAgICBtZXRob2Q6IGluaXRpYWxPcHRzLm1ldGhvZCxcbiAgICAgIGJvZHk6IGJvZHksXG4gICAgICBqc29uQm9keTogaW5pdGlhbE9wdHMuYm9keSxcbiAgICAgIHRpbWVvdXRzOiBjbGllbnQuX2dldFRpbWVvdXRzRm9yUmVxdWVzdChpbml0aWFsT3B0cy5ob3N0VHlwZSksXG4gICAgICBmb3JjZUF1dGhIZWFkZXJzOiBpbml0aWFsT3B0cy5mb3JjZUF1dGhIZWFkZXJzXG4gICAgfVxuICApO1xuXG4gIGlmIChjbGllbnQuX3VzZUNhY2hlICYmIGNsaWVudC5fdXNlUmVxdWVzdENhY2hlICYmIGNhY2hlKSB7XG4gICAgY2FjaGVbY2FjaGVJRF0gPSByZXF1ZXN0O1xuICB9XG5cbiAgcmV0dXJuIGludGVyb3BDYWxsYmFja1JldHVybihyZXF1ZXN0LCBmdW5jdGlvbihjb250ZW50KSB7XG4gICAgLy8gSW4gY2FzZSBvZiB0aGUgZmlyc3QgcmVxdWVzdCwgcmV0dXJuIHRoZSBKU09OIHZhbHVlXG4gICAgcmV0dXJuIGNvbnRlbnQuYm9keTtcbiAgfSk7XG59O1xuXG4vKlxuKiBUcmFuc2Zvcm0gc2VhcmNoIHBhcmFtIG9iamVjdCBpbiBxdWVyeSBzdHJpbmdcbiogQHBhcmFtIHtvYmplY3R9IGFyZ3MgYXJndW1lbnRzIHRvIGFkZCB0byB0aGUgY3VycmVudCBxdWVyeSBzdHJpbmdcbiogQHBhcmFtIHtzdHJpbmd9IHBhcmFtcyBjdXJyZW50IHF1ZXJ5IHN0cmluZ1xuKiBAcmV0dXJuIHtzdHJpbmd9IHRoZSBmaW5hbCBxdWVyeSBzdHJpbmdcbiovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2dldFNlYXJjaFBhcmFtcyA9IGZ1bmN0aW9uKGFyZ3MsIHBhcmFtcykge1xuICBpZiAoYXJncyA9PT0gdW5kZWZpbmVkIHx8IGFyZ3MgPT09IG51bGwpIHtcbiAgICByZXR1cm4gcGFyYW1zO1xuICB9XG4gIGZvciAodmFyIGtleSBpbiBhcmdzKSB7XG4gICAgaWYgKGtleSAhPT0gbnVsbCAmJiBhcmdzW2tleV0gIT09IHVuZGVmaW5lZCAmJiBhcmdzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIHBhcmFtcyArPSBwYXJhbXMgPT09ICcnID8gJycgOiAnJic7XG4gICAgICBwYXJhbXMgKz0ga2V5ICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmdzW2tleV0pID09PSAnW29iamVjdCBBcnJheV0nID8gc2FmZUpTT05TdHJpbmdpZnkoYXJnc1trZXldKSA6IGFyZ3Nba2V5XSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBwYXJhbXM7XG59O1xuXG4vKipcbiAqIENvbXB1dGUgdGhlIGhlYWRlcnMgZm9yIGEgcmVxdWVzdFxuICpcbiAqIEBwYXJhbSBbc3RyaW5nXSBvcHRpb25zLmFkZGl0aW9uYWxVQSBzZW1pLWNvbG9uIHNlcGFyYXRlZCBzdHJpbmcgd2l0aCBvdGhlciB1c2VyIGFnZW50cyB0byBhZGRcbiAqIEBwYXJhbSBbYm9vbGVhbj10cnVlXSBvcHRpb25zLndpdGhBcGlLZXkgU2VuZCB0aGUgYXBpIGtleSBhcyBhIGhlYWRlclxuICogQHBhcmFtIFtPYmplY3RdIG9wdGlvbnMuaGVhZGVycyBFeHRyYSBoZWFkZXJzIHRvIHNlbmRcbiAqL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9jb21wdXRlUmVxdWVzdEhlYWRlcnMgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gIHZhciBmb3JFYWNoID0gcmVxdWlyZSgnZm9yZWFjaCcpO1xuXG4gIHZhciB1YSA9IG9wdGlvbnMuYWRkaXRpb25hbFVBID9cbiAgICB0aGlzLl91YSArICc7JyArIG9wdGlvbnMuYWRkaXRpb25hbFVBIDpcbiAgICB0aGlzLl91YTtcblxuICB2YXIgcmVxdWVzdEhlYWRlcnMgPSB7XG4gICAgJ3gtYWxnb2xpYS1hZ2VudCc6IHVhLFxuICAgICd4LWFsZ29saWEtYXBwbGljYXRpb24taWQnOiB0aGlzLmFwcGxpY2F0aW9uSURcbiAgfTtcblxuICAvLyBicm93c2VyIHdpbGwgaW5saW5lIGhlYWRlcnMgaW4gdGhlIHVybCwgbm9kZS5qcyB3aWxsIHVzZSBodHRwIGhlYWRlcnNcbiAgLy8gYnV0IGluIHNvbWUgc2l0dWF0aW9ucywgdGhlIEFQSSBLRVkgd2lsbCBiZSB0b28gbG9uZyAoYmlnIHNlY3VyZWQgQVBJIGtleXMpXG4gIC8vIHNvIGlmIHRoZSByZXF1ZXN0IGlzIGEgUE9TVCBhbmQgdGhlIEtFWSBpcyB2ZXJ5IGxvbmcsIHdlIHdpbGwgYmUgYXNrZWQgdG8gbm90IHB1dFxuICAvLyBpdCBpbnRvIGhlYWRlcnMgYnV0IGluIHRoZSBKU09OIGJvZHlcbiAgaWYgKG9wdGlvbnMud2l0aEFwaUtleSAhPT0gZmFsc2UpIHtcbiAgICByZXF1ZXN0SGVhZGVyc1sneC1hbGdvbGlhLWFwaS1rZXknXSA9IHRoaXMuYXBpS2V5O1xuICB9XG5cbiAgaWYgKHRoaXMudXNlclRva2VuKSB7XG4gICAgcmVxdWVzdEhlYWRlcnNbJ3gtYWxnb2xpYS11c2VydG9rZW4nXSA9IHRoaXMudXNlclRva2VuO1xuICB9XG5cbiAgaWYgKHRoaXMuc2VjdXJpdHlUYWdzKSB7XG4gICAgcmVxdWVzdEhlYWRlcnNbJ3gtYWxnb2xpYS10YWdmaWx0ZXJzJ10gPSB0aGlzLnNlY3VyaXR5VGFncztcbiAgfVxuXG4gIGZvckVhY2godGhpcy5leHRyYUhlYWRlcnMsIGZ1bmN0aW9uIGFkZFRvUmVxdWVzdEhlYWRlcnModmFsdWUsIGtleSkge1xuICAgIHJlcXVlc3RIZWFkZXJzW2tleV0gPSB2YWx1ZTtcbiAgfSk7XG5cbiAgaWYgKG9wdGlvbnMuaGVhZGVycykge1xuICAgIGZvckVhY2gob3B0aW9ucy5oZWFkZXJzLCBmdW5jdGlvbiBhZGRUb1JlcXVlc3RIZWFkZXJzKHZhbHVlLCBrZXkpIHtcbiAgICAgIHJlcXVlc3RIZWFkZXJzW2tleV0gPSB2YWx1ZTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiByZXF1ZXN0SGVhZGVycztcbn07XG5cbi8qKlxuICogU2VhcmNoIHRocm91Z2ggbXVsdGlwbGUgaW5kaWNlcyBhdCB0aGUgc2FtZSB0aW1lXG4gKiBAcGFyYW0gIHtPYmplY3RbXX0gICBxdWVyaWVzICBBbiBhcnJheSBvZiBxdWVyaWVzIHlvdSB3YW50IHRvIHJ1bi5cbiAqIEBwYXJhbSB7c3RyaW5nfSBxdWVyaWVzW10uaW5kZXhOYW1lIFRoZSBpbmRleCBuYW1lIHlvdSB3YW50IHRvIHRhcmdldFxuICogQHBhcmFtIHtzdHJpbmd9IFtxdWVyaWVzW10ucXVlcnldIFRoZSBxdWVyeSB0byBpc3N1ZSBvbiB0aGlzIGluZGV4LiBDYW4gYWxzbyBiZSBwYXNzZWQgaW50byBgcGFyYW1zYFxuICogQHBhcmFtIHtPYmplY3R9IHF1ZXJpZXNbXS5wYXJhbXMgQW55IHNlYXJjaCBwYXJhbSBsaWtlIGhpdHNQZXJQYWdlLCAuLlxuICogQHBhcmFtICB7RnVuY3Rpb259IGNhbGxiYWNrIENhbGxiYWNrIHRvIGJlIGNhbGxlZFxuICogQHJldHVybiB7UHJvbWlzZXx1bmRlZmluZWR9IFJldHVybnMgYSBwcm9taXNlIGlmIG5vIGNhbGxiYWNrIGdpdmVuXG4gKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbihxdWVyaWVzLCBvcHRzLCBjYWxsYmFjaykge1xuICB2YXIgaXNBcnJheSA9IHJlcXVpcmUoJ2lzYXJyYXknKTtcbiAgdmFyIG1hcCA9IHJlcXVpcmUoJy4vbWFwLmpzJyk7XG5cbiAgdmFyIHVzYWdlID0gJ1VzYWdlOiBjbGllbnQuc2VhcmNoKGFycmF5T2ZRdWVyaWVzWywgY2FsbGJhY2tdKSc7XG5cbiAgaWYgKCFpc0FycmF5KHF1ZXJpZXMpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKHVzYWdlKTtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb3B0cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrID0gb3B0cztcbiAgICBvcHRzID0ge307XG4gIH0gZWxzZSBpZiAob3B0cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgb3B0cyA9IHt9O1xuICB9XG5cbiAgdmFyIGNsaWVudCA9IHRoaXM7XG5cbiAgdmFyIHBvc3RPYmogPSB7XG4gICAgcmVxdWVzdHM6IG1hcChxdWVyaWVzLCBmdW5jdGlvbiBwcmVwYXJlUmVxdWVzdChxdWVyeSkge1xuICAgICAgdmFyIHBhcmFtcyA9ICcnO1xuXG4gICAgICAvLyBhbGxvdyBxdWVyeS5xdWVyeVxuICAgICAgLy8gc28gd2UgYXJlIG1pbWljaW5nIHRoZSBpbmRleC5zZWFyY2gocXVlcnksIHBhcmFtcykgbWV0aG9kXG4gICAgICAvLyB7aW5kZXhOYW1lOiwgcXVlcnk6LCBwYXJhbXM6fVxuICAgICAgaWYgKHF1ZXJ5LnF1ZXJ5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcGFyYW1zICs9ICdxdWVyeT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5LnF1ZXJ5KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaW5kZXhOYW1lOiBxdWVyeS5pbmRleE5hbWUsXG4gICAgICAgIHBhcmFtczogY2xpZW50Ll9nZXRTZWFyY2hQYXJhbXMocXVlcnkucGFyYW1zLCBwYXJhbXMpXG4gICAgICB9O1xuICAgIH0pXG4gIH07XG5cbiAgdmFyIEpTT05QUGFyYW1zID0gbWFwKHBvc3RPYmoucmVxdWVzdHMsIGZ1bmN0aW9uIHByZXBhcmVKU09OUFBhcmFtcyhyZXF1ZXN0LCByZXF1ZXN0SWQpIHtcbiAgICByZXR1cm4gcmVxdWVzdElkICsgJz0nICtcbiAgICAgIGVuY29kZVVSSUNvbXBvbmVudChcbiAgICAgICAgJy8xL2luZGV4ZXMvJyArIGVuY29kZVVSSUNvbXBvbmVudChyZXF1ZXN0LmluZGV4TmFtZSkgKyAnPycgK1xuICAgICAgICByZXF1ZXN0LnBhcmFtc1xuICAgICAgKTtcbiAgfSkuam9pbignJicpO1xuXG4gIHZhciB1cmwgPSAnLzEvaW5kZXhlcy8qL3F1ZXJpZXMnO1xuXG4gIGlmIChvcHRzLnN0cmF0ZWd5ICE9PSB1bmRlZmluZWQpIHtcbiAgICB1cmwgKz0gJz9zdHJhdGVneT0nICsgb3B0cy5zdHJhdGVneTtcbiAgfVxuXG4gIHJldHVybiB0aGlzLl9qc29uUmVxdWVzdCh7XG4gICAgY2FjaGU6IHRoaXMuY2FjaGUsXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgdXJsOiB1cmwsXG4gICAgYm9keTogcG9zdE9iaixcbiAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgIGZhbGxiYWNrOiB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgdXJsOiAnLzEvaW5kZXhlcy8qJyxcbiAgICAgIGJvZHk6IHtcbiAgICAgICAgcGFyYW1zOiBKU09OUFBhcmFtc1xuICAgICAgfVxuICAgIH0sXG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrXG4gIH0pO1xufTtcblxuLyoqXG4qIFNlYXJjaCBmb3IgZmFjZXQgdmFsdWVzXG4qIGh0dHBzOi8vd3d3LmFsZ29saWEuY29tL2RvYy9yZXN0LWFwaS9zZWFyY2gjc2VhcmNoLWZvci1mYWNldC12YWx1ZXNcbiogVGhpcyBpcyB0aGUgdG9wLWxldmVsIEFQSSBmb3IgU0ZGVi5cbipcbiogQHBhcmFtIHtvYmplY3RbXX0gcXVlcmllcyBBbiBhcnJheSBvZiBxdWVyaWVzIHRvIHJ1bi5cbiogQHBhcmFtIHtzdHJpbmd9IHF1ZXJpZXNbXS5pbmRleE5hbWUgSW5kZXggbmFtZSwgbmFtZSBvZiB0aGUgaW5kZXggdG8gc2VhcmNoLlxuKiBAcGFyYW0ge29iamVjdH0gcXVlcmllc1tdLnBhcmFtcyBRdWVyeSBwYXJhbWV0ZXJzLlxuKiBAcGFyYW0ge3N0cmluZ30gcXVlcmllc1tdLnBhcmFtcy5mYWNldE5hbWUgRmFjZXQgbmFtZSwgbmFtZSBvZiB0aGUgYXR0cmlidXRlIHRvIHNlYXJjaCBmb3IgdmFsdWVzIGluLlxuKiBNdXN0IGJlIGRlY2xhcmVkIGFzIGEgZmFjZXRcbiogQHBhcmFtIHtzdHJpbmd9IHF1ZXJpZXNbXS5wYXJhbXMuZmFjZXRRdWVyeSBRdWVyeSBmb3IgdGhlIGZhY2V0IHNlYXJjaFxuKiBAcGFyYW0ge3N0cmluZ30gW3F1ZXJpZXNbXS5wYXJhbXMuKl0gQW55IHNlYXJjaCBwYXJhbWV0ZXIgb2YgQWxnb2xpYSxcbiogc2VlIGh0dHBzOi8vd3d3LmFsZ29saWEuY29tL2RvYy9hcGktY2xpZW50L2phdmFzY3JpcHQvc2VhcmNoI3NlYXJjaC1wYXJhbWV0ZXJzXG4qIFBhZ2luYXRpb24gaXMgbm90IHN1cHBvcnRlZC4gVGhlIHBhZ2UgYW5kIGhpdHNQZXJQYWdlIHBhcmFtZXRlcnMgd2lsbCBiZSBpZ25vcmVkLlxuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5zZWFyY2hGb3JGYWNldFZhbHVlcyA9IGZ1bmN0aW9uKHF1ZXJpZXMpIHtcbiAgdmFyIGlzQXJyYXkgPSByZXF1aXJlKCdpc2FycmF5Jyk7XG4gIHZhciBtYXAgPSByZXF1aXJlKCcuL21hcC5qcycpO1xuXG4gIHZhciB1c2FnZSA9ICdVc2FnZTogY2xpZW50LnNlYXJjaEZvckZhY2V0VmFsdWVzKFt7aW5kZXhOYW1lLCBwYXJhbXM6IHtmYWNldE5hbWUsIGZhY2V0UXVlcnksIC4uLnBhcmFtc319LCAuLi5xdWVyaWVzXSknOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG1heC1sZW5cblxuICBpZiAoIWlzQXJyYXkocXVlcmllcykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IodXNhZ2UpO1xuICB9XG5cbiAgdmFyIGNsaWVudCA9IHRoaXM7XG5cbiAgcmV0dXJuIGNsaWVudC5fcHJvbWlzZS5hbGwobWFwKHF1ZXJpZXMsIGZ1bmN0aW9uIHBlcmZvcm1RdWVyeShxdWVyeSkge1xuICAgIGlmIChcbiAgICAgICFxdWVyeSB8fFxuICAgICAgcXVlcnkuaW5kZXhOYW1lID09PSB1bmRlZmluZWQgfHxcbiAgICAgIHF1ZXJ5LnBhcmFtcy5mYWNldE5hbWUgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgcXVlcnkucGFyYW1zLmZhY2V0UXVlcnkgPT09IHVuZGVmaW5lZFxuICAgICkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHVzYWdlKTtcbiAgICB9XG5cbiAgICB2YXIgY2xvbmUgPSByZXF1aXJlKCcuL2Nsb25lLmpzJyk7XG4gICAgdmFyIG9taXQgPSByZXF1aXJlKCcuL29taXQuanMnKTtcblxuICAgIHZhciBpbmRleE5hbWUgPSBxdWVyeS5pbmRleE5hbWU7XG4gICAgdmFyIHBhcmFtcyA9IHF1ZXJ5LnBhcmFtcztcblxuICAgIHZhciBmYWNldE5hbWUgPSBwYXJhbXMuZmFjZXROYW1lO1xuICAgIHZhciBmaWx0ZXJlZFBhcmFtcyA9IG9taXQoY2xvbmUocGFyYW1zKSwgZnVuY3Rpb24oa2V5TmFtZSkge1xuICAgICAgcmV0dXJuIGtleU5hbWUgPT09ICdmYWNldE5hbWUnO1xuICAgIH0pO1xuICAgIHZhciBzZWFyY2hQYXJhbWV0ZXJzID0gY2xpZW50Ll9nZXRTZWFyY2hQYXJhbXMoZmlsdGVyZWRQYXJhbXMsICcnKTtcblxuICAgIHJldHVybiBjbGllbnQuX2pzb25SZXF1ZXN0KHtcbiAgICAgIGNhY2hlOiBjbGllbnQuY2FjaGUsXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIHVybDpcbiAgICAgICAgJy8xL2luZGV4ZXMvJyArXG4gICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChpbmRleE5hbWUpICtcbiAgICAgICAgJy9mYWNldHMvJyArXG4gICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChmYWNldE5hbWUpICtcbiAgICAgICAgJy9xdWVyeScsXG4gICAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgICAgYm9keToge3BhcmFtczogc2VhcmNoUGFyYW1ldGVyc31cbiAgICB9KTtcbiAgfSkpO1xufTtcblxuLyoqXG4gKiBTZXQgdGhlIGV4dHJhIHNlY3VyaXR5IHRhZ0ZpbHRlcnMgaGVhZGVyXG4gKiBAcGFyYW0ge3N0cmluZ3xhcnJheX0gdGFncyBUaGUgbGlzdCBvZiB0YWdzIGRlZmluaW5nIHRoZSBjdXJyZW50IHNlY3VyaXR5IGZpbHRlcnNcbiAqL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLnNldFNlY3VyaXR5VGFncyA9IGZ1bmN0aW9uKHRhZ3MpIHtcbiAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0YWdzKSA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgIHZhciBzdHJUYWdzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWdzLmxlbmd0aDsgKytpKSB7XG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHRhZ3NbaV0pID09PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgIHZhciBvcmVkVGFncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRhZ3NbaV0ubGVuZ3RoOyArK2opIHtcbiAgICAgICAgICBvcmVkVGFncy5wdXNoKHRhZ3NbaV1bal0pO1xuICAgICAgICB9XG4gICAgICAgIHN0clRhZ3MucHVzaCgnKCcgKyBvcmVkVGFncy5qb2luKCcsJykgKyAnKScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3RyVGFncy5wdXNoKHRhZ3NbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgICB0YWdzID0gc3RyVGFncy5qb2luKCcsJyk7XG4gIH1cblxuICB0aGlzLnNlY3VyaXR5VGFncyA9IHRhZ3M7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgZXh0cmEgdXNlciB0b2tlbiBoZWFkZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSB1c2VyVG9rZW4gVGhlIHRva2VuIGlkZW50aWZ5aW5nIGEgdW5pcSB1c2VyICh1c2VkIHRvIGFwcGx5IHJhdGUgbGltaXRzKVxuICovXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuc2V0VXNlclRva2VuID0gZnVuY3Rpb24odXNlclRva2VuKSB7XG4gIHRoaXMudXNlclRva2VuID0gdXNlclRva2VuO1xufTtcblxuLyoqXG4gKiBDbGVhciBhbGwgcXVlcmllcyBpbiBjbGllbnQncyBjYWNoZVxuICogQHJldHVybiB1bmRlZmluZWRcbiAqL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jYWNoZSA9IHt9O1xufTtcblxuLyoqXG4qIFNldCB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBhIHJlcXVlc3QgY2FuIHRha2UgYmVmb3JlIGF1dG9tYXRpY2FsbHkgYmVpbmcgdGVybWluYXRlZC5cbiogQGRlcHJlY2F0ZWRcbiogQHBhcmFtIHtOdW1iZXJ9IG1pbGxpc2Vjb25kc1xuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5zZXRSZXF1ZXN0VGltZW91dCA9IGZ1bmN0aW9uKG1pbGxpc2Vjb25kcykge1xuICBpZiAobWlsbGlzZWNvbmRzKSB7XG4gICAgdGhpcy5fdGltZW91dHMuY29ubmVjdCA9IHRoaXMuX3RpbWVvdXRzLnJlYWQgPSB0aGlzLl90aW1lb3V0cy53cml0ZSA9IG1pbGxpc2Vjb25kcztcbiAgfVxufTtcblxuLyoqXG4qIFNldCB0aGUgdGhyZWUgZGlmZmVyZW50IChjb25uZWN0LCByZWFkLCB3cml0ZSkgdGltZW91dHMgdG8gYmUgdXNlZCB3aGVuIHJlcXVlc3RpbmdcbiogQHBhcmFtIHtPYmplY3R9IHRpbWVvdXRzXG4qL1xuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLnNldFRpbWVvdXRzID0gZnVuY3Rpb24odGltZW91dHMpIHtcbiAgdGhpcy5fdGltZW91dHMgPSB0aW1lb3V0cztcbn07XG5cbi8qKlxuKiBHZXQgdGhlIHRocmVlIGRpZmZlcmVudCAoY29ubmVjdCwgcmVhZCwgd3JpdGUpIHRpbWVvdXRzIHRvIGJlIHVzZWQgd2hlbiByZXF1ZXN0aW5nXG4qIEBwYXJhbSB7T2JqZWN0fSB0aW1lb3V0c1xuKi9cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5nZXRUaW1lb3V0cyA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5fdGltZW91dHM7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2dldEFwcElkRGF0YSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgZGF0YSA9IHN0b3JlLmdldCh0aGlzLmFwcGxpY2F0aW9uSUQpO1xuICBpZiAoZGF0YSAhPT0gbnVsbCkgdGhpcy5fY2FjaGVBcHBJZERhdGEoZGF0YSk7XG4gIHJldHVybiBkYXRhO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9zZXRBcHBJZERhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gIGRhdGEubGFzdENoYW5nZSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XG4gIHRoaXMuX2NhY2hlQXBwSWREYXRhKGRhdGEpO1xuICByZXR1cm4gc3RvcmUuc2V0KHRoaXMuYXBwbGljYXRpb25JRCwgZGF0YSk7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2NoZWNrQXBwSWREYXRhID0gZnVuY3Rpb24oKSB7XG4gIHZhciBkYXRhID0gdGhpcy5fZ2V0QXBwSWREYXRhKCk7XG4gIHZhciBub3cgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xuICBpZiAoZGF0YSA9PT0gbnVsbCB8fCBub3cgLSBkYXRhLmxhc3RDaGFuZ2UgPiBSRVNFVF9BUFBfREFUQV9USU1FUikge1xuICAgIHJldHVybiB0aGlzLl9yZXNldEluaXRpYWxBcHBJZERhdGEoZGF0YSk7XG4gIH1cblxuICByZXR1cm4gZGF0YTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fcmVzZXRJbml0aWFsQXBwSWREYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICB2YXIgbmV3RGF0YSA9IGRhdGEgfHwge307XG4gIG5ld0RhdGEuaG9zdEluZGV4ZXMgPSB7cmVhZDogMCwgd3JpdGU6IDB9O1xuICBuZXdEYXRhLnRpbWVvdXRNdWx0aXBsaWVyID0gMTtcbiAgbmV3RGF0YS5zaHVmZmxlUmVzdWx0ID0gbmV3RGF0YS5zaHVmZmxlUmVzdWx0IHx8IHNodWZmbGUoWzEsIDIsIDNdKTtcbiAgcmV0dXJuIHRoaXMuX3NldEFwcElkRGF0YShuZXdEYXRhKTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fY2FjaGVBcHBJZERhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gIHRoaXMuX2hvc3RJbmRleGVzID0gZGF0YS5ob3N0SW5kZXhlcztcbiAgdGhpcy5fdGltZW91dE11bHRpcGxpZXIgPSBkYXRhLnRpbWVvdXRNdWx0aXBsaWVyO1xuICB0aGlzLl9zaHVmZmxlUmVzdWx0ID0gZGF0YS5zaHVmZmxlUmVzdWx0O1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9wYXJ0aWFsQXBwSWREYXRhVXBkYXRlID0gZnVuY3Rpb24obmV3RGF0YSkge1xuICB2YXIgZm9yZWFjaCA9IHJlcXVpcmUoJ2ZvcmVhY2gnKTtcbiAgdmFyIGN1cnJlbnREYXRhID0gdGhpcy5fZ2V0QXBwSWREYXRhKCk7XG4gIGZvcmVhY2gobmV3RGF0YSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgIGN1cnJlbnREYXRhW2tleV0gPSB2YWx1ZTtcbiAgfSk7XG5cbiAgcmV0dXJuIHRoaXMuX3NldEFwcElkRGF0YShjdXJyZW50RGF0YSk7XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2dldEhvc3RCeVR5cGUgPSBmdW5jdGlvbihob3N0VHlwZSkge1xuICByZXR1cm4gdGhpcy5ob3N0c1tob3N0VHlwZV1bdGhpcy5fZ2V0SG9zdEluZGV4QnlUeXBlKGhvc3RUeXBlKV07XG59O1xuXG5BbGdvbGlhU2VhcmNoQ29yZS5wcm90b3R5cGUuX2dldFRpbWVvdXRNdWx0aXBsaWVyID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLl90aW1lb3V0TXVsdGlwbGllcjtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fZ2V0SG9zdEluZGV4QnlUeXBlID0gZnVuY3Rpb24oaG9zdFR5cGUpIHtcbiAgcmV0dXJuIHRoaXMuX2hvc3RJbmRleGVzW2hvc3RUeXBlXTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fc2V0SG9zdEluZGV4QnlUeXBlID0gZnVuY3Rpb24oaG9zdEluZGV4LCBob3N0VHlwZSkge1xuICB2YXIgY2xvbmUgPSByZXF1aXJlKCcuL2Nsb25lJyk7XG4gIHZhciBuZXdIb3N0SW5kZXhlcyA9IGNsb25lKHRoaXMuX2hvc3RJbmRleGVzKTtcbiAgbmV3SG9zdEluZGV4ZXNbaG9zdFR5cGVdID0gaG9zdEluZGV4O1xuICB0aGlzLl9wYXJ0aWFsQXBwSWREYXRhVXBkYXRlKHtob3N0SW5kZXhlczogbmV3SG9zdEluZGV4ZXN9KTtcbiAgcmV0dXJuIGhvc3RJbmRleDtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5faW5jcmVtZW50SG9zdEluZGV4ID0gZnVuY3Rpb24oaG9zdFR5cGUpIHtcbiAgcmV0dXJuIHRoaXMuX3NldEhvc3RJbmRleEJ5VHlwZShcbiAgICAodGhpcy5fZ2V0SG9zdEluZGV4QnlUeXBlKGhvc3RUeXBlKSArIDEpICUgdGhpcy5ob3N0c1tob3N0VHlwZV0ubGVuZ3RoLCBob3N0VHlwZVxuICApO1xufTtcblxuQWxnb2xpYVNlYXJjaENvcmUucHJvdG90eXBlLl9pbmNyZW1lbnRUaW1lb3V0TXVsdGlwbGVyID0gZnVuY3Rpb24oKSB7XG4gIHZhciB0aW1lb3V0TXVsdGlwbGllciA9IE1hdGgubWF4KHRoaXMuX3RpbWVvdXRNdWx0aXBsaWVyICsgMSwgNCk7XG4gIHJldHVybiB0aGlzLl9wYXJ0aWFsQXBwSWREYXRhVXBkYXRlKHt0aW1lb3V0TXVsdGlwbGllcjogdGltZW91dE11bHRpcGxpZXJ9KTtcbn07XG5cbkFsZ29saWFTZWFyY2hDb3JlLnByb3RvdHlwZS5fZ2V0VGltZW91dHNGb3JSZXF1ZXN0ID0gZnVuY3Rpb24oaG9zdFR5cGUpIHtcbiAgcmV0dXJuIHtcbiAgICBjb25uZWN0OiB0aGlzLl90aW1lb3V0cy5jb25uZWN0ICogdGhpcy5fdGltZW91dE11bHRpcGxpZXIsXG4gICAgY29tcGxldGU6IHRoaXMuX3RpbWVvdXRzW2hvc3RUeXBlXSAqIHRoaXMuX3RpbWVvdXRNdWx0aXBsaWVyXG4gIH07XG59O1xuXG5mdW5jdGlvbiBwcmVwYXJlSG9zdChwcm90b2NvbCkge1xuICByZXR1cm4gZnVuY3Rpb24gcHJlcGFyZShob3N0KSB7XG4gICAgcmV0dXJuIHByb3RvY29sICsgJy8vJyArIGhvc3QudG9Mb3dlckNhc2UoKTtcbiAgfTtcbn1cblxuLy8gUHJvdG90eXBlLmpzIDwgMS43LCBhIHdpZGVseSB1c2VkIGxpYnJhcnksIGRlZmluZXMgYSB3ZWlyZFxuLy8gQXJyYXkucHJvdG90eXBlLnRvSlNPTiBmdW5jdGlvbiB0aGF0IHdpbGwgZmFpbCB0byBzdHJpbmdpZnkgb3VyIGNvbnRlbnRcbi8vIGFwcHJvcHJpYXRlbHlcbi8vIHJlZnM6XG4vLyAgIC0gaHR0cHM6Ly9ncm91cHMuZ29vZ2xlLmNvbS9mb3J1bS8jIXRvcGljL3Byb3RvdHlwZS1jb3JlL0UtU0FWdlZfVjlRXG4vLyAgIC0gaHR0cHM6Ly9naXRodWIuY29tL3NzdGVwaGVuc29uL3Byb3RvdHlwZS9jb21taXQvMDM4YTI5ODVhNzA1OTNjMWE4NmMyMzBmYWRiZGZlMmU0ODk4YTQ4Y1xuLy8gICAtIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzMxNDg0NDEvMTQ3MDc5XG5mdW5jdGlvbiBzYWZlSlNPTlN0cmluZ2lmeShvYmopIHtcbiAgLyogZXNsaW50IG5vLWV4dGVuZC1uYXRpdmU6MCAqL1xuXG4gIGlmIChBcnJheS5wcm90b3R5cGUudG9KU09OID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKTtcbiAgfVxuXG4gIHZhciB0b0pTT04gPSBBcnJheS5wcm90b3R5cGUudG9KU09OO1xuICBkZWxldGUgQXJyYXkucHJvdG90eXBlLnRvSlNPTjtcbiAgdmFyIG91dCA9IEpTT04uc3RyaW5naWZ5KG9iaik7XG4gIEFycmF5LnByb3RvdHlwZS50b0pTT04gPSB0b0pTT047XG5cbiAgcmV0dXJuIG91dDtcbn1cblxuZnVuY3Rpb24gc2h1ZmZsZShhcnJheSkge1xuICB2YXIgY3VycmVudEluZGV4ID0gYXJyYXkubGVuZ3RoO1xuICB2YXIgdGVtcG9yYXJ5VmFsdWU7XG4gIHZhciByYW5kb21JbmRleDtcblxuICAvLyBXaGlsZSB0aGVyZSByZW1haW4gZWxlbWVudHMgdG8gc2h1ZmZsZS4uLlxuICB3aGlsZSAoY3VycmVudEluZGV4ICE9PSAwKSB7XG4gICAgLy8gUGljayBhIHJlbWFpbmluZyBlbGVtZW50Li4uXG4gICAgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjdXJyZW50SW5kZXgpO1xuICAgIGN1cnJlbnRJbmRleCAtPSAxO1xuXG4gICAgLy8gQW5kIHN3YXAgaXQgd2l0aCB0aGUgY3VycmVudCBlbGVtZW50LlxuICAgIHRlbXBvcmFyeVZhbHVlID0gYXJyYXlbY3VycmVudEluZGV4XTtcbiAgICBhcnJheVtjdXJyZW50SW5kZXhdID0gYXJyYXlbcmFuZG9tSW5kZXhdO1xuICAgIGFycmF5W3JhbmRvbUluZGV4XSA9IHRlbXBvcmFyeVZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIGFycmF5O1xufVxuXG5mdW5jdGlvbiByZW1vdmVDcmVkZW50aWFscyhoZWFkZXJzKSB7XG4gIHZhciBuZXdIZWFkZXJzID0ge307XG5cbiAgZm9yICh2YXIgaGVhZGVyTmFtZSBpbiBoZWFkZXJzKSB7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChoZWFkZXJzLCBoZWFkZXJOYW1lKSkge1xuICAgICAgdmFyIHZhbHVlO1xuXG4gICAgICBpZiAoaGVhZGVyTmFtZSA9PT0gJ3gtYWxnb2xpYS1hcGkta2V5JyB8fCBoZWFkZXJOYW1lID09PSAneC1hbGdvbGlhLWFwcGxpY2F0aW9uLWlkJykge1xuICAgICAgICB2YWx1ZSA9ICcqKmhpZGRlbiBmb3Igc2VjdXJpdHkgcHVycG9zZXMqKic7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YWx1ZSA9IGhlYWRlcnNbaGVhZGVyTmFtZV07XG4gICAgICB9XG5cbiAgICAgIG5ld0hlYWRlcnNbaGVhZGVyTmFtZV0gPSB2YWx1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmV3SGVhZGVycztcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9BbGdvbGlhU2VhcmNoQ29yZS5qc1xuLy8gbW9kdWxlIGlkID0gNDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIGJ1aWxkU2VhcmNoTWV0aG9kID0gcmVxdWlyZSgnLi9idWlsZFNlYXJjaE1ldGhvZC5qcycpO1xudmFyIGRlcHJlY2F0ZSA9IHJlcXVpcmUoJy4vZGVwcmVjYXRlLmpzJyk7XG52YXIgZGVwcmVjYXRlZE1lc3NhZ2UgPSByZXF1aXJlKCcuL2RlcHJlY2F0ZWRNZXNzYWdlLmpzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gSW5kZXhDb3JlO1xuXG4vKlxuKiBJbmRleCBjbGFzcyBjb25zdHJ1Y3Rvci5cbiogWW91IHNob3VsZCBub3QgdXNlIHRoaXMgbWV0aG9kIGRpcmVjdGx5IGJ1dCB1c2UgaW5pdEluZGV4KCkgZnVuY3Rpb25cbiovXG5mdW5jdGlvbiBJbmRleENvcmUoYWxnb2xpYXNlYXJjaCwgaW5kZXhOYW1lKSB7XG4gIHRoaXMuaW5kZXhOYW1lID0gaW5kZXhOYW1lO1xuICB0aGlzLmFzID0gYWxnb2xpYXNlYXJjaDtcbiAgdGhpcy50eXBlQWhlYWRBcmdzID0gbnVsbDtcbiAgdGhpcy50eXBlQWhlYWRWYWx1ZU9wdGlvbiA9IG51bGw7XG5cbiAgLy8gbWFrZSBzdXJlIGV2ZXJ5IGluZGV4IGluc3RhbmNlIGhhcyBpdCdzIG93biBjYWNoZVxuICB0aGlzLmNhY2hlID0ge307XG59XG5cbi8qXG4qIENsZWFyIGFsbCBxdWVyaWVzIGluIGNhY2hlXG4qL1xuSW5kZXhDb3JlLnByb3RvdHlwZS5jbGVhckNhY2hlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuY2FjaGUgPSB7fTtcbn07XG5cbi8qXG4qIFNlYXJjaCBpbnNpZGUgdGhlIGluZGV4IHVzaW5nIFhNTEh0dHBSZXF1ZXN0IHJlcXVlc3QgKFVzaW5nIGEgUE9TVCBxdWVyeSB0b1xuKiBtaW5pbWl6ZSBudW1iZXIgb2YgT1BUSU9OUyBxdWVyaWVzOiBDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZykuXG4qXG4qIEBwYXJhbSB7c3RyaW5nfSBbcXVlcnldIHRoZSBmdWxsIHRleHQgcXVlcnlcbiogQHBhcmFtIHtvYmplY3R9IFthcmdzXSAob3B0aW9uYWwpIGlmIHNldCwgY29udGFpbnMgYW4gb2JqZWN0IHdpdGggcXVlcnkgcGFyYW1ldGVyczpcbiogLSBwYWdlOiAoaW50ZWdlcikgUGFnaW5hdGlvbiBwYXJhbWV0ZXIgdXNlZCB0byBzZWxlY3QgdGhlIHBhZ2UgdG8gcmV0cmlldmUuXG4qICAgICAgICAgICAgICAgICAgIFBhZ2UgaXMgemVyby1iYXNlZCBhbmQgZGVmYXVsdHMgdG8gMC4gVGh1cyxcbiogICAgICAgICAgICAgICAgICAgdG8gcmV0cmlldmUgdGhlIDEwdGggcGFnZSB5b3UgbmVlZCB0byBzZXQgcGFnZT05XG4qIC0gaGl0c1BlclBhZ2U6IChpbnRlZ2VyKSBQYWdpbmF0aW9uIHBhcmFtZXRlciB1c2VkIHRvIHNlbGVjdCB0aGUgbnVtYmVyIG9mIGhpdHMgcGVyIHBhZ2UuIERlZmF1bHRzIHRvIDIwLlxuKiAtIGF0dHJpYnV0ZXNUb1JldHJpZXZlOiBhIHN0cmluZyB0aGF0IGNvbnRhaW5zIHRoZSBsaXN0IG9mIG9iamVjdCBhdHRyaWJ1dGVzXG4qIHlvdSB3YW50IHRvIHJldHJpZXZlIChsZXQgeW91IG1pbmltaXplIHRoZSBhbnN3ZXIgc2l6ZSkuXG4qICAgQXR0cmlidXRlcyBhcmUgc2VwYXJhdGVkIHdpdGggYSBjb21tYSAoZm9yIGV4YW1wbGUgXCJuYW1lLGFkZHJlc3NcIikuXG4qICAgWW91IGNhbiBhbHNvIHVzZSBhbiBhcnJheSAoZm9yIGV4YW1wbGUgW1wibmFtZVwiLFwiYWRkcmVzc1wiXSkuXG4qICAgQnkgZGVmYXVsdCwgYWxsIGF0dHJpYnV0ZXMgYXJlIHJldHJpZXZlZC4gWW91IGNhbiBhbHNvIHVzZSAnKicgdG8gcmV0cmlldmUgYWxsXG4qICAgdmFsdWVzIHdoZW4gYW4gYXR0cmlidXRlc1RvUmV0cmlldmUgc2V0dGluZyBpcyBzcGVjaWZpZWQgZm9yIHlvdXIgaW5kZXguXG4qIC0gYXR0cmlidXRlc1RvSGlnaGxpZ2h0OiBhIHN0cmluZyB0aGF0IGNvbnRhaW5zIHRoZSBsaXN0IG9mIGF0dHJpYnV0ZXMgeW91XG4qICAgd2FudCB0byBoaWdobGlnaHQgYWNjb3JkaW5nIHRvIHRoZSBxdWVyeS5cbiogICBBdHRyaWJ1dGVzIGFyZSBzZXBhcmF0ZWQgYnkgYSBjb21tYS4gWW91IGNhbiBhbHNvIHVzZSBhbiBhcnJheSAoZm9yIGV4YW1wbGUgW1wibmFtZVwiLFwiYWRkcmVzc1wiXSkuXG4qICAgSWYgYW4gYXR0cmlidXRlIGhhcyBubyBtYXRjaCBmb3IgdGhlIHF1ZXJ5LCB0aGUgcmF3IHZhbHVlIGlzIHJldHVybmVkLlxuKiAgIEJ5IGRlZmF1bHQgYWxsIGluZGV4ZWQgdGV4dCBhdHRyaWJ1dGVzIGFyZSBoaWdobGlnaHRlZC5cbiogICBZb3UgY2FuIHVzZSBgKmAgaWYgeW91IHdhbnQgdG8gaGlnaGxpZ2h0IGFsbCB0ZXh0dWFsIGF0dHJpYnV0ZXMuXG4qICAgTnVtZXJpY2FsIGF0dHJpYnV0ZXMgYXJlIG5vdCBoaWdobGlnaHRlZC5cbiogICBBIG1hdGNoTGV2ZWwgaXMgcmV0dXJuZWQgZm9yIGVhY2ggaGlnaGxpZ2h0ZWQgYXR0cmlidXRlIGFuZCBjYW4gY29udGFpbjpcbiogICAgICAtIGZ1bGw6IGlmIGFsbCB0aGUgcXVlcnkgdGVybXMgd2VyZSBmb3VuZCBpbiB0aGUgYXR0cmlidXRlLFxuKiAgICAgIC0gcGFydGlhbDogaWYgb25seSBzb21lIG9mIHRoZSBxdWVyeSB0ZXJtcyB3ZXJlIGZvdW5kLFxuKiAgICAgIC0gbm9uZTogaWYgbm9uZSBvZiB0aGUgcXVlcnkgdGVybXMgd2VyZSBmb3VuZC5cbiogLSBhdHRyaWJ1dGVzVG9TbmlwcGV0OiBhIHN0cmluZyB0aGF0IGNvbnRhaW5zIHRoZSBsaXN0IG9mIGF0dHJpYnV0ZXMgdG8gc25pcHBldCBhbG9uZ3NpZGVcbiogdGhlIG51bWJlciBvZiB3b3JkcyB0byByZXR1cm4gKHN5bnRheCBpcyBgYXR0cmlidXRlTmFtZTpuYldvcmRzYCkuXG4qICAgIEF0dHJpYnV0ZXMgYXJlIHNlcGFyYXRlZCBieSBhIGNvbW1hIChFeGFtcGxlOiBhdHRyaWJ1dGVzVG9TbmlwcGV0PW5hbWU6MTAsY29udGVudDoxMCkuXG4qICAgIFlvdSBjYW4gYWxzbyB1c2UgYW4gYXJyYXkgKEV4YW1wbGU6IGF0dHJpYnV0ZXNUb1NuaXBwZXQ6IFsnbmFtZToxMCcsJ2NvbnRlbnQ6MTAnXSkuXG4qICAgIEJ5IGRlZmF1bHQgbm8gc25pcHBldCBpcyBjb21wdXRlZC5cbiogLSBtaW5Xb3JkU2l6ZWZvcjFUeXBvOiB0aGUgbWluaW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyBpbiBhIHF1ZXJ5IHdvcmQgdG8gYWNjZXB0IG9uZSB0eXBvIGluIHRoaXMgd29yZC5cbiogRGVmYXVsdHMgdG8gMy5cbiogLSBtaW5Xb3JkU2l6ZWZvcjJUeXBvczogdGhlIG1pbmltdW0gbnVtYmVyIG9mIGNoYXJhY3RlcnMgaW4gYSBxdWVyeSB3b3JkXG4qIHRvIGFjY2VwdCB0d28gdHlwb3MgaW4gdGhpcyB3b3JkLiBEZWZhdWx0cyB0byA3LlxuKiAtIGdldFJhbmtpbmdJbmZvOiBpZiBzZXQgdG8gMSwgdGhlIHJlc3VsdCBoaXRzIHdpbGwgY29udGFpbiByYW5raW5nXG4qIGluZm9ybWF0aW9uIGluIF9yYW5raW5nSW5mbyBhdHRyaWJ1dGUuXG4qIC0gYXJvdW5kTGF0TG5nOiBzZWFyY2ggZm9yIGVudHJpZXMgYXJvdW5kIGEgZ2l2ZW5cbiogbGF0aXR1ZGUvbG9uZ2l0dWRlIChzcGVjaWZpZWQgYXMgdHdvIGZsb2F0cyBzZXBhcmF0ZWQgYnkgYSBjb21tYSkuXG4qICAgRm9yIGV4YW1wbGUgYXJvdW5kTGF0TG5nPTQ3LjMxNjY2OSw1LjAxNjY3MCkuXG4qICAgWW91IGNhbiBzcGVjaWZ5IHRoZSBtYXhpbXVtIGRpc3RhbmNlIGluIG1ldGVycyB3aXRoIHRoZSBhcm91bmRSYWRpdXMgcGFyYW1ldGVyIChpbiBtZXRlcnMpXG4qICAgYW5kIHRoZSBwcmVjaXNpb24gZm9yIHJhbmtpbmcgd2l0aCBhcm91bmRQcmVjaXNpb25cbiogICAoZm9yIGV4YW1wbGUgaWYgeW91IHNldCBhcm91bmRQcmVjaXNpb249MTAwLCB0d28gb2JqZWN0cyB0aGF0IGFyZSBkaXN0YW50IG9mXG4qICAgbGVzcyB0aGFuIDEwMG0gd2lsbCBiZSBjb25zaWRlcmVkIGFzIGlkZW50aWNhbCBmb3IgXCJnZW9cIiByYW5raW5nIHBhcmFtZXRlcikuXG4qICAgQXQgaW5kZXhpbmcsIHlvdSBzaG91bGQgc3BlY2lmeSBnZW9sb2Mgb2YgYW4gb2JqZWN0IHdpdGggdGhlIF9nZW9sb2MgYXR0cmlidXRlXG4qICAgKGluIHRoZSBmb3JtIHtcIl9nZW9sb2NcIjp7XCJsYXRcIjo0OC44NTM0MDksIFwibG5nXCI6Mi4zNDg4MDB9fSlcbiogLSBpbnNpZGVCb3VuZGluZ0JveDogc2VhcmNoIGVudHJpZXMgaW5zaWRlIGEgZ2l2ZW4gYXJlYSBkZWZpbmVkIGJ5IHRoZSB0d28gZXh0cmVtZSBwb2ludHNcbiogb2YgYSByZWN0YW5nbGUgKGRlZmluZWQgYnkgNCBmbG9hdHM6IHAxTGF0LHAxTG5nLHAyTGF0LHAyTG5nKS5cbiogICBGb3IgZXhhbXBsZSBpbnNpZGVCb3VuZGluZ0JveD00Ny4zMTY1LDQuOTY2NSw0Ny4zNDI0LDUuMDIwMSkuXG4qICAgQXQgaW5kZXhpbmcsIHlvdSBzaG91bGQgc3BlY2lmeSBnZW9sb2Mgb2YgYW4gb2JqZWN0IHdpdGggdGhlIF9nZW9sb2MgYXR0cmlidXRlXG4qICAgKGluIHRoZSBmb3JtIHtcIl9nZW9sb2NcIjp7XCJsYXRcIjo0OC44NTM0MDksIFwibG5nXCI6Mi4zNDg4MDB9fSlcbiogLSBudW1lcmljRmlsdGVyczogYSBzdHJpbmcgdGhhdCBjb250YWlucyB0aGUgbGlzdCBvZiBudW1lcmljIGZpbHRlcnMgeW91IHdhbnQgdG9cbiogYXBwbHkgc2VwYXJhdGVkIGJ5IGEgY29tbWEuXG4qICAgVGhlIHN5bnRheCBvZiBvbmUgZmlsdGVyIGlzIGBhdHRyaWJ1dGVOYW1lYCBmb2xsb3dlZCBieSBgb3BlcmFuZGAgZm9sbG93ZWQgYnkgYHZhbHVlYC5cbiogICBTdXBwb3J0ZWQgb3BlcmFuZHMgYXJlIGA8YCwgYDw9YCwgYD1gLCBgPmAgYW5kIGA+PWAuXG4qICAgWW91IGNhbiBoYXZlIG11bHRpcGxlIGNvbmRpdGlvbnMgb24gb25lIGF0dHJpYnV0ZSBsaWtlIGZvciBleGFtcGxlIG51bWVyaWNGaWx0ZXJzPXByaWNlPjEwMCxwcmljZTwxMDAwLlxuKiAgIFlvdSBjYW4gYWxzbyB1c2UgYW4gYXJyYXkgKGZvciBleGFtcGxlIG51bWVyaWNGaWx0ZXJzOiBbXCJwcmljZT4xMDBcIixcInByaWNlPDEwMDBcIl0pLlxuKiAtIHRhZ0ZpbHRlcnM6IGZpbHRlciB0aGUgcXVlcnkgYnkgYSBzZXQgb2YgdGFncy4gWW91IGNhbiBBTkQgdGFncyBieSBzZXBhcmF0aW5nIHRoZW0gYnkgY29tbWFzLlxuKiAgIFRvIE9SIHRhZ3MsIHlvdSBtdXN0IGFkZCBwYXJlbnRoZXNlcy4gRm9yIGV4YW1wbGUsIHRhZ3M9dGFnMSwodGFnMix0YWczKSBtZWFucyB0YWcxIEFORCAodGFnMiBPUiB0YWczKS5cbiogICBZb3UgY2FuIGFsc28gdXNlIGFuIGFycmF5LCBmb3IgZXhhbXBsZSB0YWdGaWx0ZXJzOiBbXCJ0YWcxXCIsW1widGFnMlwiLFwidGFnM1wiXV1cbiogICBtZWFucyB0YWcxIEFORCAodGFnMiBPUiB0YWczKS5cbiogICBBdCBpbmRleGluZywgdGFncyBzaG91bGQgYmUgYWRkZWQgaW4gdGhlIF90YWdzKiogYXR0cmlidXRlXG4qICAgb2Ygb2JqZWN0cyAoZm9yIGV4YW1wbGUge1wiX3RhZ3NcIjpbXCJ0YWcxXCIsXCJ0YWcyXCJdfSkuXG4qIC0gZmFjZXRGaWx0ZXJzOiBmaWx0ZXIgdGhlIHF1ZXJ5IGJ5IGEgbGlzdCBvZiBmYWNldHMuXG4qICAgRmFjZXRzIGFyZSBzZXBhcmF0ZWQgYnkgY29tbWFzIGFuZCBlYWNoIGZhY2V0IGlzIGVuY29kZWQgYXMgYGF0dHJpYnV0ZU5hbWU6dmFsdWVgLlxuKiAgIEZvciBleGFtcGxlOiBgZmFjZXRGaWx0ZXJzPWNhdGVnb3J5OkJvb2ssYXV0aG9yOkpvaG4lMjBEb2VgLlxuKiAgIFlvdSBjYW4gYWxzbyB1c2UgYW4gYXJyYXkgKGZvciBleGFtcGxlIGBbXCJjYXRlZ29yeTpCb29rXCIsXCJhdXRob3I6Sm9obiUyMERvZVwiXWApLlxuKiAtIGZhY2V0czogTGlzdCBvZiBvYmplY3QgYXR0cmlidXRlcyB0aGF0IHlvdSB3YW50IHRvIHVzZSBmb3IgZmFjZXRpbmcuXG4qICAgQ29tbWEgc2VwYXJhdGVkIGxpc3Q6IGBcImNhdGVnb3J5LGF1dGhvclwiYCBvciBhcnJheSBgWydjYXRlZ29yeScsJ2F1dGhvciddYFxuKiAgIE9ubHkgYXR0cmlidXRlcyB0aGF0IGhhdmUgYmVlbiBhZGRlZCBpbiAqKmF0dHJpYnV0ZXNGb3JGYWNldGluZyoqIGluZGV4IHNldHRpbmdcbiogICBjYW4gYmUgdXNlZCBpbiB0aGlzIHBhcmFtZXRlci5cbiogICBZb3UgY2FuIGFsc28gdXNlIGAqYCB0byBwZXJmb3JtIGZhY2V0aW5nIG9uIGFsbCBhdHRyaWJ1dGVzIHNwZWNpZmllZCBpbiAqKmF0dHJpYnV0ZXNGb3JGYWNldGluZyoqLlxuKiAtIHF1ZXJ5VHlwZTogc2VsZWN0IGhvdyB0aGUgcXVlcnkgd29yZHMgYXJlIGludGVycHJldGVkLCBpdCBjYW4gYmUgb25lIG9mIHRoZSBmb2xsb3dpbmcgdmFsdWU6XG4qICAgIC0gcHJlZml4QWxsOiBhbGwgcXVlcnkgd29yZHMgYXJlIGludGVycHJldGVkIGFzIHByZWZpeGVzLFxuKiAgICAtIHByZWZpeExhc3Q6IG9ubHkgdGhlIGxhc3Qgd29yZCBpcyBpbnRlcnByZXRlZCBhcyBhIHByZWZpeCAoZGVmYXVsdCBiZWhhdmlvciksXG4qICAgIC0gcHJlZml4Tm9uZTogbm8gcXVlcnkgd29yZCBpcyBpbnRlcnByZXRlZCBhcyBhIHByZWZpeC4gVGhpcyBvcHRpb24gaXMgbm90IHJlY29tbWVuZGVkLlxuKiAtIG9wdGlvbmFsV29yZHM6IGEgc3RyaW5nIHRoYXQgY29udGFpbnMgdGhlIGxpc3Qgb2Ygd29yZHMgdGhhdCBzaG91bGRcbiogYmUgY29uc2lkZXJlZCBhcyBvcHRpb25hbCB3aGVuIGZvdW5kIGluIHRoZSBxdWVyeS5cbiogICBDb21tYSBzZXBhcmF0ZWQgYW5kIGFycmF5IGFyZSBhY2NlcHRlZC5cbiogLSBkaXN0aW5jdDogSWYgc2V0IHRvIDEsIGVuYWJsZSB0aGUgZGlzdGluY3QgZmVhdHVyZSAoZGlzYWJsZWQgYnkgZGVmYXVsdClcbiogaWYgdGhlIGF0dHJpYnV0ZUZvckRpc3RpbmN0IGluZGV4IHNldHRpbmcgaXMgc2V0LlxuKiAgIFRoaXMgZmVhdHVyZSBpcyBzaW1pbGFyIHRvIHRoZSBTUUwgXCJkaXN0aW5jdFwiIGtleXdvcmQ6IHdoZW4gZW5hYmxlZFxuKiAgIGluIGEgcXVlcnkgd2l0aCB0aGUgZGlzdGluY3Q9MSBwYXJhbWV0ZXIsXG4qICAgYWxsIGhpdHMgY29udGFpbmluZyBhIGR1cGxpY2F0ZSB2YWx1ZSBmb3IgdGhlIGF0dHJpYnV0ZUZvckRpc3RpbmN0IGF0dHJpYnV0ZSBhcmUgcmVtb3ZlZCBmcm9tIHJlc3VsdHMuXG4qICAgRm9yIGV4YW1wbGUsIGlmIHRoZSBjaG9zZW4gYXR0cmlidXRlIGlzIHNob3dfbmFtZSBhbmQgc2V2ZXJhbCBoaXRzIGhhdmVcbiogICB0aGUgc2FtZSB2YWx1ZSBmb3Igc2hvd19uYW1lLCB0aGVuIG9ubHkgdGhlIGJlc3RcbiogICBvbmUgaXMga2VwdCBhbmQgb3RoZXJzIGFyZSByZW1vdmVkLlxuKiAtIHJlc3RyaWN0U2VhcmNoYWJsZUF0dHJpYnV0ZXM6IExpc3Qgb2YgYXR0cmlidXRlcyB5b3Ugd2FudCB0byB1c2UgZm9yXG4qIHRleHR1YWwgc2VhcmNoIChtdXN0IGJlIGEgc3Vic2V0IG9mIHRoZSBhdHRyaWJ1dGVzVG9JbmRleCBpbmRleCBzZXR0aW5nKVxuKiBlaXRoZXIgY29tbWEgc2VwYXJhdGVkIG9yIGFzIGFuIGFycmF5XG4qIEBwYXJhbSB7ZnVuY3Rpb259IFtjYWxsYmFja10gdGhlIHJlc3VsdCBjYWxsYmFjayBjYWxsZWQgd2l0aCB0d28gYXJndW1lbnRzOlxuKiAgZXJyb3I6IG51bGwgb3IgRXJyb3IoJ21lc3NhZ2UnKS4gSWYgZmFsc2UsIHRoZSBjb250ZW50IGNvbnRhaW5zIHRoZSBlcnJvci5cbiogIGNvbnRlbnQ6IHRoZSBzZXJ2ZXIgYW5zd2VyIHRoYXQgY29udGFpbnMgdGhlIGxpc3Qgb2YgcmVzdWx0cy5cbiovXG5JbmRleENvcmUucHJvdG90eXBlLnNlYXJjaCA9IGJ1aWxkU2VhcmNoTWV0aG9kKCdxdWVyeScpO1xuXG4vKlxuKiAtLSBCRVRBIC0tXG4qIFNlYXJjaCBhIHJlY29yZCBzaW1pbGFyIHRvIHRoZSBxdWVyeSBpbnNpZGUgdGhlIGluZGV4IHVzaW5nIFhNTEh0dHBSZXF1ZXN0IHJlcXVlc3QgKFVzaW5nIGEgUE9TVCBxdWVyeSB0b1xuKiBtaW5pbWl6ZSBudW1iZXIgb2YgT1BUSU9OUyBxdWVyaWVzOiBDcm9zcy1PcmlnaW4gUmVzb3VyY2UgU2hhcmluZykuXG4qXG4qIEBwYXJhbSB7c3RyaW5nfSBbcXVlcnldIHRoZSBzaW1pbGFyIHF1ZXJ5XG4qIEBwYXJhbSB7b2JqZWN0fSBbYXJnc10gKG9wdGlvbmFsKSBpZiBzZXQsIGNvbnRhaW5zIGFuIG9iamVjdCB3aXRoIHF1ZXJ5IHBhcmFtZXRlcnMuXG4qICAgQWxsIHNlYXJjaCBwYXJhbWV0ZXJzIGFyZSBzdXBwb3J0ZWQgKHNlZSBzZWFyY2ggZnVuY3Rpb24pLCByZXN0cmljdFNlYXJjaGFibGVBdHRyaWJ1dGVzIGFuZCBmYWNldEZpbHRlcnNcbiogICBhcmUgdGhlIHR3byBtb3N0IHVzZWZ1bCB0byByZXN0cmljdCB0aGUgc2ltaWxhciByZXN1bHRzIGFuZCBnZXQgbW9yZSByZWxldmFudCBjb250ZW50XG4qL1xuSW5kZXhDb3JlLnByb3RvdHlwZS5zaW1pbGFyU2VhcmNoID0gYnVpbGRTZWFyY2hNZXRob2QoJ3NpbWlsYXJRdWVyeScpO1xuXG4vKlxuKiBCcm93c2UgaW5kZXggY29udGVudC4gVGhlIHJlc3BvbnNlIGNvbnRlbnQgd2lsbCBoYXZlIGEgYGN1cnNvcmAgcHJvcGVydHkgdGhhdCB5b3UgY2FuIHVzZVxuKiB0byBicm93c2Ugc3Vic2VxdWVudCBwYWdlcyBmb3IgdGhpcyBxdWVyeS4gVXNlIGBpbmRleC5icm93c2VGcm9tKGN1cnNvcilgIHdoZW4geW91IHdhbnQuXG4qXG4qIEBwYXJhbSB7c3RyaW5nfSBxdWVyeSAtIFRoZSBmdWxsIHRleHQgcXVlcnlcbiogQHBhcmFtIHtPYmplY3R9IFtxdWVyeVBhcmFtZXRlcnNdIC0gQW55IHNlYXJjaCBxdWVyeSBwYXJhbWV0ZXJcbiogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrXSAtIFRoZSByZXN1bHQgY2FsbGJhY2sgY2FsbGVkIHdpdGggdHdvIGFyZ3VtZW50c1xuKiAgIGVycm9yOiBudWxsIG9yIEVycm9yKCdtZXNzYWdlJylcbiogICBjb250ZW50OiB0aGUgc2VydmVyIGFuc3dlciB3aXRoIHRoZSBicm93c2UgcmVzdWx0XG4qIEByZXR1cm4ge1Byb21pc2V8dW5kZWZpbmVkfSBSZXR1cm5zIGEgcHJvbWlzZSBpZiBubyBjYWxsYmFjayBnaXZlblxuKiBAZXhhbXBsZVxuKiBpbmRleC5icm93c2UoJ2Nvb2wgc29uZ3MnLCB7XG4qICAgdGFnRmlsdGVyczogJ3B1YmxpYyxjb21tZW50cycsXG4qICAgaGl0c1BlclBhZ2U6IDUwMFxuKiB9LCBjYWxsYmFjayk7XG4qIEBzZWUge0BsaW5rIGh0dHBzOi8vd3d3LmFsZ29saWEuY29tL2RvYy9yZXN0X2FwaSNCcm93c2V8QWxnb2xpYSBSRVNUIEFQSSBEb2N1bWVudGF0aW9ufVxuKi9cbkluZGV4Q29yZS5wcm90b3R5cGUuYnJvd3NlID0gZnVuY3Rpb24ocXVlcnksIHF1ZXJ5UGFyYW1ldGVycywgY2FsbGJhY2spIHtcbiAgdmFyIG1lcmdlID0gcmVxdWlyZSgnLi9tZXJnZS5qcycpO1xuXG4gIHZhciBpbmRleE9iaiA9IHRoaXM7XG5cbiAgdmFyIHBhZ2U7XG4gIHZhciBoaXRzUGVyUGFnZTtcblxuICAvLyB3ZSBjaGVjayB2YXJpYWRpYyBjYWxscyB0aGF0IGFyZSBub3QgdGhlIG9uZSBkZWZpbmVkXG4gIC8vIC5icm93c2UoKS8uYnJvd3NlKGZuKVxuICAvLyA9PiBwYWdlID0gMFxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdmdW5jdGlvbicpIHtcbiAgICBwYWdlID0gMDtcbiAgICBjYWxsYmFjayA9IGFyZ3VtZW50c1swXTtcbiAgICBxdWVyeSA9IHVuZGVmaW5lZDtcbiAgfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnbnVtYmVyJykge1xuICAgIC8vIC5icm93c2UoMikvLmJyb3dzZSgyLCAxMCkvLmJyb3dzZSgyLCBmbikvLmJyb3dzZSgyLCAxMCwgZm4pXG4gICAgcGFnZSA9IGFyZ3VtZW50c1swXTtcbiAgICBpZiAodHlwZW9mIGFyZ3VtZW50c1sxXSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGhpdHNQZXJQYWdlID0gYXJndW1lbnRzWzFdO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50c1sxXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY2FsbGJhY2sgPSBhcmd1bWVudHNbMV07XG4gICAgICBoaXRzUGVyUGFnZSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcXVlcnkgPSB1bmRlZmluZWQ7XG4gICAgcXVlcnlQYXJhbWV0ZXJzID0gdW5kZWZpbmVkO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdvYmplY3QnKSB7XG4gICAgLy8gLmJyb3dzZShxdWVyeVBhcmFtZXRlcnMpLy5icm93c2UocXVlcnlQYXJhbWV0ZXJzLCBjYilcbiAgICBpZiAodHlwZW9mIGFyZ3VtZW50c1sxXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY2FsbGJhY2sgPSBhcmd1bWVudHNbMV07XG4gICAgfVxuICAgIHF1ZXJ5UGFyYW1ldGVycyA9IGFyZ3VtZW50c1swXTtcbiAgICBxdWVyeSA9IHVuZGVmaW5lZDtcbiAgfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnc3RyaW5nJyAmJiB0eXBlb2YgYXJndW1lbnRzWzFdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgLy8gLmJyb3dzZShxdWVyeSwgY2IpXG4gICAgY2FsbGJhY2sgPSBhcmd1bWVudHNbMV07XG4gICAgcXVlcnlQYXJhbWV0ZXJzID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8gb3RoZXJ3aXNlIGl0J3MgYSAuYnJvd3NlKHF1ZXJ5KS8uYnJvd3NlKHF1ZXJ5LCBxdWVyeVBhcmFtZXRlcnMpLy5icm93c2UocXVlcnksIHF1ZXJ5UGFyYW1ldGVycywgY2IpXG5cbiAgLy8gZ2V0IHNlYXJjaCBxdWVyeSBwYXJhbWV0ZXJzIGNvbWJpbmluZyB2YXJpb3VzIHBvc3NpYmxlIGNhbGxzXG4gIC8vIHRvIC5icm93c2UoKTtcbiAgcXVlcnlQYXJhbWV0ZXJzID0gbWVyZ2Uoe30sIHF1ZXJ5UGFyYW1ldGVycyB8fCB7fSwge1xuICAgIHBhZ2U6IHBhZ2UsXG4gICAgaGl0c1BlclBhZ2U6IGhpdHNQZXJQYWdlLFxuICAgIHF1ZXJ5OiBxdWVyeVxuICB9KTtcblxuICB2YXIgcGFyYW1zID0gdGhpcy5hcy5fZ2V0U2VhcmNoUGFyYW1zKHF1ZXJ5UGFyYW1ldGVycywgJycpO1xuXG4gIHJldHVybiB0aGlzLmFzLl9qc29uUmVxdWVzdCh7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgdXJsOiAnLzEvaW5kZXhlcy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KGluZGV4T2JqLmluZGV4TmFtZSkgKyAnL2Jyb3dzZScsXG4gICAgYm9keToge3BhcmFtczogcGFyYW1zfSxcbiAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuICB9KTtcbn07XG5cbi8qXG4qIENvbnRpbnVlIGJyb3dzaW5nIGZyb20gYSBwcmV2aW91cyBwb3NpdGlvbiAoY3Vyc29yKSwgb2J0YWluZWQgdmlhIGEgY2FsbCB0byBgLmJyb3dzZSgpYC5cbipcbiogQHBhcmFtIHtzdHJpbmd9IHF1ZXJ5IC0gVGhlIGZ1bGwgdGV4dCBxdWVyeVxuKiBAcGFyYW0ge09iamVjdH0gW3F1ZXJ5UGFyYW1ldGVyc10gLSBBbnkgc2VhcmNoIHF1ZXJ5IHBhcmFtZXRlclxuKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2tdIC0gVGhlIHJlc3VsdCBjYWxsYmFjayBjYWxsZWQgd2l0aCB0d28gYXJndW1lbnRzXG4qICAgZXJyb3I6IG51bGwgb3IgRXJyb3IoJ21lc3NhZ2UnKVxuKiAgIGNvbnRlbnQ6IHRoZSBzZXJ2ZXIgYW5zd2VyIHdpdGggdGhlIGJyb3dzZSByZXN1bHRcbiogQHJldHVybiB7UHJvbWlzZXx1bmRlZmluZWR9IFJldHVybnMgYSBwcm9taXNlIGlmIG5vIGNhbGxiYWNrIGdpdmVuXG4qIEBleGFtcGxlXG4qIGluZGV4LmJyb3dzZUZyb20oJzE0bGtmc2FrbDMyJywgY2FsbGJhY2spO1xuKiBAc2VlIHtAbGluayBodHRwczovL3d3dy5hbGdvbGlhLmNvbS9kb2MvcmVzdF9hcGkjQnJvd3NlfEFsZ29saWEgUkVTVCBBUEkgRG9jdW1lbnRhdGlvbn1cbiovXG5JbmRleENvcmUucHJvdG90eXBlLmJyb3dzZUZyb20gPSBmdW5jdGlvbihjdXJzb3IsIGNhbGxiYWNrKSB7XG4gIHJldHVybiB0aGlzLmFzLl9qc29uUmVxdWVzdCh7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgdXJsOiAnLzEvaW5kZXhlcy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuaW5kZXhOYW1lKSArICcvYnJvd3NlJyxcbiAgICBib2R5OiB7Y3Vyc29yOiBjdXJzb3J9LFxuICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrXG4gIH0pO1xufTtcblxuLypcbiogU2VhcmNoIGZvciBmYWNldCB2YWx1ZXNcbiogaHR0cHM6Ly93d3cuYWxnb2xpYS5jb20vZG9jL3Jlc3QtYXBpL3NlYXJjaCNzZWFyY2gtZm9yLWZhY2V0LXZhbHVlc1xuKlxuKiBAcGFyYW0ge3N0cmluZ30gcGFyYW1zLmZhY2V0TmFtZSBGYWNldCBuYW1lLCBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUgdG8gc2VhcmNoIGZvciB2YWx1ZXMgaW4uXG4qIE11c3QgYmUgZGVjbGFyZWQgYXMgYSBmYWNldFxuKiBAcGFyYW0ge3N0cmluZ30gcGFyYW1zLmZhY2V0UXVlcnkgUXVlcnkgZm9yIHRoZSBmYWNldCBzZWFyY2hcbiogQHBhcmFtIHtzdHJpbmd9IFtwYXJhbXMuKl0gQW55IHNlYXJjaCBwYXJhbWV0ZXIgb2YgQWxnb2xpYSxcbiogc2VlIGh0dHBzOi8vd3d3LmFsZ29saWEuY29tL2RvYy9hcGktY2xpZW50L2phdmFzY3JpcHQvc2VhcmNoI3NlYXJjaC1wYXJhbWV0ZXJzXG4qIFBhZ2luYXRpb24gaXMgbm90IHN1cHBvcnRlZC4gVGhlIHBhZ2UgYW5kIGhpdHNQZXJQYWdlIHBhcmFtZXRlcnMgd2lsbCBiZSBpZ25vcmVkLlxuKiBAcGFyYW0gY2FsbGJhY2sgKG9wdGlvbmFsKVxuKi9cbkluZGV4Q29yZS5wcm90b3R5cGUuc2VhcmNoRm9yRmFjZXRWYWx1ZXMgPSBmdW5jdGlvbihwYXJhbXMsIGNhbGxiYWNrKSB7XG4gIHZhciBjbG9uZSA9IHJlcXVpcmUoJy4vY2xvbmUuanMnKTtcbiAgdmFyIG9taXQgPSByZXF1aXJlKCcuL29taXQuanMnKTtcbiAgdmFyIHVzYWdlID0gJ1VzYWdlOiBpbmRleC5zZWFyY2hGb3JGYWNldFZhbHVlcyh7ZmFjZXROYW1lLCBmYWNldFF1ZXJ5LCAuLi5wYXJhbXN9WywgY2FsbGJhY2tdKSc7XG5cbiAgaWYgKHBhcmFtcy5mYWNldE5hbWUgPT09IHVuZGVmaW5lZCB8fCBwYXJhbXMuZmFjZXRRdWVyeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKHVzYWdlKTtcbiAgfVxuXG4gIHZhciBmYWNldE5hbWUgPSBwYXJhbXMuZmFjZXROYW1lO1xuICB2YXIgZmlsdGVyZWRQYXJhbXMgPSBvbWl0KGNsb25lKHBhcmFtcyksIGZ1bmN0aW9uKGtleU5hbWUpIHtcbiAgICByZXR1cm4ga2V5TmFtZSA9PT0gJ2ZhY2V0TmFtZSc7XG4gIH0pO1xuICB2YXIgc2VhcmNoUGFyYW1ldGVycyA9IHRoaXMuYXMuX2dldFNlYXJjaFBhcmFtcyhmaWx0ZXJlZFBhcmFtcywgJycpO1xuXG4gIHJldHVybiB0aGlzLmFzLl9qc29uUmVxdWVzdCh7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgdXJsOiAnLzEvaW5kZXhlcy8nICtcbiAgICAgIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmluZGV4TmFtZSkgKyAnL2ZhY2V0cy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KGZhY2V0TmFtZSkgKyAnL3F1ZXJ5JyxcbiAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgIGJvZHk6IHtwYXJhbXM6IHNlYXJjaFBhcmFtZXRlcnN9LFxuICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuICB9KTtcbn07XG5cbkluZGV4Q29yZS5wcm90b3R5cGUuc2VhcmNoRmFjZXQgPSBkZXByZWNhdGUoZnVuY3Rpb24ocGFyYW1zLCBjYWxsYmFjaykge1xuICByZXR1cm4gdGhpcy5zZWFyY2hGb3JGYWNldFZhbHVlcyhwYXJhbXMsIGNhbGxiYWNrKTtcbn0sIGRlcHJlY2F0ZWRNZXNzYWdlKFxuICAnaW5kZXguc2VhcmNoRmFjZXQocGFyYW1zWywgY2FsbGJhY2tdKScsXG4gICdpbmRleC5zZWFyY2hGb3JGYWNldFZhbHVlcyhwYXJhbXNbLCBjYWxsYmFja10pJ1xuKSk7XG5cbkluZGV4Q29yZS5wcm90b3R5cGUuX3NlYXJjaCA9IGZ1bmN0aW9uKHBhcmFtcywgdXJsLCBjYWxsYmFjaywgYWRkaXRpb25hbFVBKSB7XG4gIHJldHVybiB0aGlzLmFzLl9qc29uUmVxdWVzdCh7XG4gICAgY2FjaGU6IHRoaXMuY2FjaGUsXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgdXJsOiB1cmwgfHwgJy8xL2luZGV4ZXMvJyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmluZGV4TmFtZSkgKyAnL3F1ZXJ5JyxcbiAgICBib2R5OiB7cGFyYW1zOiBwYXJhbXN9LFxuICAgIGhvc3RUeXBlOiAncmVhZCcsXG4gICAgZmFsbGJhY2s6IHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICB1cmw6ICcvMS9pbmRleGVzLycgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5pbmRleE5hbWUpLFxuICAgICAgYm9keToge3BhcmFtczogcGFyYW1zfVxuICAgIH0sXG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuICAgIGFkZGl0aW9uYWxVQTogYWRkaXRpb25hbFVBXG4gIH0pO1xufTtcblxuLypcbiogR2V0IGFuIG9iamVjdCBmcm9tIHRoaXMgaW5kZXhcbipcbiogQHBhcmFtIG9iamVjdElEIHRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgb2JqZWN0IHRvIHJldHJpZXZlXG4qIEBwYXJhbSBhdHRycyAob3B0aW9uYWwpIGlmIHNldCwgY29udGFpbnMgdGhlIGFycmF5IG9mIGF0dHJpYnV0ZSBuYW1lcyB0byByZXRyaWV2ZVxuKiBAcGFyYW0gY2FsbGJhY2sgKG9wdGlvbmFsKSB0aGUgcmVzdWx0IGNhbGxiYWNrIGNhbGxlZCB3aXRoIHR3byBhcmd1bWVudHNcbiogIGVycm9yOiBudWxsIG9yIEVycm9yKCdtZXNzYWdlJylcbiogIGNvbnRlbnQ6IHRoZSBvYmplY3QgdG8gcmV0cmlldmUgb3IgdGhlIGVycm9yIG1lc3NhZ2UgaWYgYSBmYWlsdXJlIG9jY3VyZWRcbiovXG5JbmRleENvcmUucHJvdG90eXBlLmdldE9iamVjdCA9IGZ1bmN0aW9uKG9iamVjdElELCBhdHRycywgY2FsbGJhY2spIHtcbiAgdmFyIGluZGV4T2JqID0gdGhpcztcblxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSB8fCB0eXBlb2YgYXR0cnMgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjYWxsYmFjayA9IGF0dHJzO1xuICAgIGF0dHJzID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgdmFyIHBhcmFtcyA9ICcnO1xuICBpZiAoYXR0cnMgIT09IHVuZGVmaW5lZCkge1xuICAgIHBhcmFtcyA9ICc/YXR0cmlidXRlcz0nO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXR0cnMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGlmIChpICE9PSAwKSB7XG4gICAgICAgIHBhcmFtcyArPSAnLCc7XG4gICAgICB9XG4gICAgICBwYXJhbXMgKz0gYXR0cnNbaV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXMuYXMuX2pzb25SZXF1ZXN0KHtcbiAgICBtZXRob2Q6ICdHRVQnLFxuICAgIHVybDogJy8xL2luZGV4ZXMvJyArIGVuY29kZVVSSUNvbXBvbmVudChpbmRleE9iai5pbmRleE5hbWUpICsgJy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KG9iamVjdElEKSArIHBhcmFtcyxcbiAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuICB9KTtcbn07XG5cbi8qXG4qIEdldCBzZXZlcmFsIG9iamVjdHMgZnJvbSB0aGlzIGluZGV4XG4qXG4qIEBwYXJhbSBvYmplY3RJRHMgdGhlIGFycmF5IG9mIHVuaXF1ZSBpZGVudGlmaWVyIG9mIG9iamVjdHMgdG8gcmV0cmlldmVcbiovXG5JbmRleENvcmUucHJvdG90eXBlLmdldE9iamVjdHMgPSBmdW5jdGlvbihvYmplY3RJRHMsIGF0dHJpYnV0ZXNUb1JldHJpZXZlLCBjYWxsYmFjaykge1xuICB2YXIgaXNBcnJheSA9IHJlcXVpcmUoJ2lzYXJyYXknKTtcbiAgdmFyIG1hcCA9IHJlcXVpcmUoJy4vbWFwLmpzJyk7XG5cbiAgdmFyIHVzYWdlID0gJ1VzYWdlOiBpbmRleC5nZXRPYmplY3RzKGFycmF5T2ZPYmplY3RJRHNbLCBjYWxsYmFja10pJztcblxuICBpZiAoIWlzQXJyYXkob2JqZWN0SURzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcih1c2FnZSk7XG4gIH1cblxuICB2YXIgaW5kZXhPYmogPSB0aGlzO1xuXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxIHx8IHR5cGVvZiBhdHRyaWJ1dGVzVG9SZXRyaWV2ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNhbGxiYWNrID0gYXR0cmlidXRlc1RvUmV0cmlldmU7XG4gICAgYXR0cmlidXRlc1RvUmV0cmlldmUgPSB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgYm9keSA9IHtcbiAgICByZXF1ZXN0czogbWFwKG9iamVjdElEcywgZnVuY3Rpb24gcHJlcGFyZVJlcXVlc3Qob2JqZWN0SUQpIHtcbiAgICAgIHZhciByZXF1ZXN0ID0ge1xuICAgICAgICBpbmRleE5hbWU6IGluZGV4T2JqLmluZGV4TmFtZSxcbiAgICAgICAgb2JqZWN0SUQ6IG9iamVjdElEXG4gICAgICB9O1xuXG4gICAgICBpZiAoYXR0cmlidXRlc1RvUmV0cmlldmUpIHtcbiAgICAgICAgcmVxdWVzdC5hdHRyaWJ1dGVzVG9SZXRyaWV2ZSA9IGF0dHJpYnV0ZXNUb1JldHJpZXZlLmpvaW4oJywnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlcXVlc3Q7XG4gICAgfSlcbiAgfTtcblxuICByZXR1cm4gdGhpcy5hcy5fanNvblJlcXVlc3Qoe1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIHVybDogJy8xL2luZGV4ZXMvKi9vYmplY3RzJyxcbiAgICBob3N0VHlwZTogJ3JlYWQnLFxuICAgIGJvZHk6IGJvZHksXG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrXG4gIH0pO1xufTtcblxuSW5kZXhDb3JlLnByb3RvdHlwZS5hcyA9IG51bGw7XG5JbmRleENvcmUucHJvdG90eXBlLmluZGV4TmFtZSA9IG51bGw7XG5JbmRleENvcmUucHJvdG90eXBlLnR5cGVBaGVhZEFyZ3MgPSBudWxsO1xuSW5kZXhDb3JlLnByb3RvdHlwZS50eXBlQWhlYWRWYWx1ZU9wdGlvbiA9IG51bGw7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvSW5kZXhDb3JlLmpzXG4vLyBtb2R1bGUgaWQgPSA0NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbnZhciBBbGdvbGlhU2VhcmNoQ29yZSA9IHJlcXVpcmUoJy4uLy4uL0FsZ29saWFTZWFyY2hDb3JlLmpzJyk7XG52YXIgY3JlYXRlQWxnb2xpYXNlYXJjaCA9IHJlcXVpcmUoJy4uL2NyZWF0ZUFsZ29saWFzZWFyY2guanMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVBbGdvbGlhc2VhcmNoKEFsZ29saWFTZWFyY2hDb3JlLCAnKGxpdGUpICcpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvYnVpbGRzL2FsZ29saWFzZWFyY2hMaXRlLmpzXG4vLyBtb2R1bGUgaWQgPSA0NVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG5cbnZhciBnbG9iYWwgPSByZXF1aXJlKCdnbG9iYWwnKTtcbnZhciBQcm9taXNlID0gZ2xvYmFsLlByb21pc2UgfHwgcmVxdWlyZSgnZXM2LXByb21pc2UnKS5Qcm9taXNlO1xuXG4vLyBUaGlzIGlzIHRoZSBzdGFuZGFsb25lIGJyb3dzZXIgYnVpbGQgZW50cnkgcG9pbnRcbi8vIEJyb3dzZXIgaW1wbGVtZW50YXRpb24gb2YgdGhlIEFsZ29saWEgU2VhcmNoIEphdmFTY3JpcHQgY2xpZW50LFxuLy8gdXNpbmcgWE1MSHR0cFJlcXVlc3QsIFhEb21haW5SZXF1ZXN0IGFuZCBKU09OUCBhcyBmYWxsYmFja1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGVBbGdvbGlhc2VhcmNoKEFsZ29saWFTZWFyY2gsIHVhU3VmZml4KSB7XG4gIHZhciBpbmhlcml0cyA9IHJlcXVpcmUoJ2luaGVyaXRzJyk7XG4gIHZhciBlcnJvcnMgPSByZXF1aXJlKCcuLi9lcnJvcnMnKTtcbiAgdmFyIGlubGluZUhlYWRlcnMgPSByZXF1aXJlKCcuL2lubGluZS1oZWFkZXJzJyk7XG4gIHZhciBqc29ucFJlcXVlc3QgPSByZXF1aXJlKCcuL2pzb25wLXJlcXVlc3QnKTtcbiAgdmFyIHBsYWNlcyA9IHJlcXVpcmUoJy4uL3BsYWNlcy5qcycpO1xuICB1YVN1ZmZpeCA9IHVhU3VmZml4IHx8ICcnO1xuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RlYnVnJykge1xuICAgIHJlcXVpcmUoJ2RlYnVnJykuZW5hYmxlKCdhbGdvbGlhc2VhcmNoKicpO1xuICB9XG5cbiAgZnVuY3Rpb24gYWxnb2xpYXNlYXJjaChhcHBsaWNhdGlvbklELCBhcGlLZXksIG9wdHMpIHtcbiAgICB2YXIgY2xvbmVEZWVwID0gcmVxdWlyZSgnLi4vY2xvbmUuanMnKTtcblxuICAgIG9wdHMgPSBjbG9uZURlZXAob3B0cyB8fCB7fSk7XG5cbiAgICBvcHRzLl91YSA9IG9wdHMuX3VhIHx8IGFsZ29saWFzZWFyY2gudWE7XG5cbiAgICByZXR1cm4gbmV3IEFsZ29saWFTZWFyY2hCcm93c2VyKGFwcGxpY2F0aW9uSUQsIGFwaUtleSwgb3B0cyk7XG4gIH1cblxuICBhbGdvbGlhc2VhcmNoLnZlcnNpb24gPSByZXF1aXJlKCcuLi92ZXJzaW9uLmpzJyk7XG4gIGFsZ29saWFzZWFyY2gudWEgPSAnQWxnb2xpYSBmb3IgdmFuaWxsYSBKYXZhU2NyaXB0ICcgKyB1YVN1ZmZpeCArIGFsZ29saWFzZWFyY2gudmVyc2lvbjtcbiAgYWxnb2xpYXNlYXJjaC5pbml0UGxhY2VzID0gcGxhY2VzKGFsZ29saWFzZWFyY2gpO1xuXG4gIC8vIHdlIGV4cG9zZSBpbnRvIHdpbmRvdyBubyBtYXR0ZXIgaG93IHdlIGFyZSB1c2VkLCB0aGlzIHdpbGwgYWxsb3dcbiAgLy8gdXMgdG8gZWFzaWx5IGRlYnVnIGFueSB3ZWJzaXRlIHJ1bm5pbmcgYWxnb2xpYVxuICBnbG9iYWwuX19hbGdvbGlhID0ge1xuICAgIGRlYnVnOiByZXF1aXJlKCdkZWJ1ZycpLFxuICAgIGFsZ29saWFzZWFyY2g6IGFsZ29saWFzZWFyY2hcbiAgfTtcblxuICB2YXIgc3VwcG9ydCA9IHtcbiAgICBoYXNYTUxIdHRwUmVxdWVzdDogJ1hNTEh0dHBSZXF1ZXN0JyBpbiBnbG9iYWwsXG4gICAgaGFzWERvbWFpblJlcXVlc3Q6ICdYRG9tYWluUmVxdWVzdCcgaW4gZ2xvYmFsXG4gIH07XG5cbiAgaWYgKHN1cHBvcnQuaGFzWE1MSHR0cFJlcXVlc3QpIHtcbiAgICBzdXBwb3J0LmNvcnMgPSAnd2l0aENyZWRlbnRpYWxzJyBpbiBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIEFsZ29saWFTZWFyY2hCcm93c2VyKCkge1xuICAgIC8vIGNhbGwgQWxnb2xpYVNlYXJjaCBjb25zdHJ1Y3RvclxuICAgIEFsZ29saWFTZWFyY2guYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuXG4gIGluaGVyaXRzKEFsZ29saWFTZWFyY2hCcm93c2VyLCBBbGdvbGlhU2VhcmNoKTtcblxuICBBbGdvbGlhU2VhcmNoQnJvd3Nlci5wcm90b3R5cGUuX3JlcXVlc3QgPSBmdW5jdGlvbiByZXF1ZXN0KHVybCwgb3B0cykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiB3cmFwUmVxdWVzdChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIC8vIG5vIGNvcnMgb3IgWERvbWFpblJlcXVlc3QsIG5vIHJlcXVlc3RcbiAgICAgIGlmICghc3VwcG9ydC5jb3JzICYmICFzdXBwb3J0Lmhhc1hEb21haW5SZXF1ZXN0KSB7XG4gICAgICAgIC8vIHZlcnkgb2xkIGJyb3dzZXIsIG5vdCBzdXBwb3J0ZWRcbiAgICAgICAgcmVqZWN0KG5ldyBlcnJvcnMuTmV0d29yaygnQ09SUyBub3Qgc3VwcG9ydGVkJykpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHVybCA9IGlubGluZUhlYWRlcnModXJsLCBvcHRzLmhlYWRlcnMpO1xuXG4gICAgICB2YXIgYm9keSA9IG9wdHMuYm9keTtcbiAgICAgIHZhciByZXEgPSBzdXBwb3J0LmNvcnMgPyBuZXcgWE1MSHR0cFJlcXVlc3QoKSA6IG5ldyBYRG9tYWluUmVxdWVzdCgpO1xuICAgICAgdmFyIHJlcVRpbWVvdXQ7XG4gICAgICB2YXIgdGltZWRPdXQ7XG4gICAgICB2YXIgY29ubmVjdGVkID0gZmFsc2U7XG5cbiAgICAgIHJlcVRpbWVvdXQgPSBzZXRUaW1lb3V0KG9uVGltZW91dCwgb3B0cy50aW1lb3V0cy5jb25uZWN0KTtcbiAgICAgIC8vIHdlIHNldCBhbiBlbXB0eSBvbnByb2dyZXNzIGxpc3RlbmVyXG4gICAgICAvLyBzbyB0aGF0IFhEb21haW5SZXF1ZXN0IG9uIElFOSBpcyBub3QgYWJvcnRlZFxuICAgICAgLy8gcmVmczpcbiAgICAgIC8vICAtIGh0dHBzOi8vZ2l0aHViLmNvbS9hbGdvbGlhL2FsZ29saWFzZWFyY2gtY2xpZW50LWpzL2lzc3Vlcy83NlxuICAgICAgLy8gIC0gaHR0cHM6Ly9zb2NpYWwubXNkbi5taWNyb3NvZnQuY29tL0ZvcnVtcy9pZS9lbi1VUy8zMGVmM2FkZC03NjdjLTQ0MzYtYjhhOS1mMWNhMTliNDgxMmUvaWU5LXJ0bS14ZG9tYWlucmVxdWVzdC1pc3N1ZWQtcmVxdWVzdHMtbWF5LWFib3J0LWlmLWFsbC1ldmVudC1oYW5kbGVycy1ub3Qtc3BlY2lmaWVkP2ZvcnVtPWlld2ViZGV2ZWxvcG1lbnRcbiAgICAgIHJlcS5vbnByb2dyZXNzID0gb25Qcm9ncmVzcztcbiAgICAgIGlmICgnb25yZWFkeXN0YXRlY2hhbmdlJyBpbiByZXEpIHJlcS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBvblJlYWR5U3RhdGVDaGFuZ2U7XG4gICAgICByZXEub25sb2FkID0gb25Mb2FkO1xuICAgICAgcmVxLm9uZXJyb3IgPSBvbkVycm9yO1xuXG4gICAgICAvLyBkbyBub3QgcmVseSBvbiBkZWZhdWx0IFhIUiBhc3luYyBmbGFnLCBhcyBzb21lIGFuYWx5dGljcyBjb2RlIGxpa2UgaG90amFyXG4gICAgICAvLyBicmVha3MgaXQgYW5kIHNldCBpdCB0byBmYWxzZSBieSBkZWZhdWx0XG4gICAgICBpZiAocmVxIGluc3RhbmNlb2YgWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgICAgcmVxLm9wZW4ob3B0cy5tZXRob2QsIHVybCwgdHJ1ZSk7XG5cbiAgICAgICAgLy8gVGhlIEFuYWx5dGljcyBBUEkgbmV2ZXIgYWNjZXB0cyBBdXRoIGhlYWRlcnMgYXMgcXVlcnkgc3RyaW5nXG4gICAgICAgIC8vIHRoaXMgb3B0aW9uIGV4aXN0cyBzcGVjaWZpY2FsbHkgZm9yIHRoZW0uXG4gICAgICAgIGlmIChvcHRzLmZvcmNlQXV0aEhlYWRlcnMpIHtcbiAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcihcbiAgICAgICAgICAgICd4LWFsZ29saWEtYXBwbGljYXRpb24taWQnLFxuICAgICAgICAgICAgb3B0cy5oZWFkZXJzWyd4LWFsZ29saWEtYXBwbGljYXRpb24taWQnXVxuICAgICAgICAgICk7XG4gICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoXG4gICAgICAgICAgICAneC1hbGdvbGlhLWFwaS1rZXknLFxuICAgICAgICAgICAgb3B0cy5oZWFkZXJzWyd4LWFsZ29saWEtYXBpLWtleSddXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxLm9wZW4ob3B0cy5tZXRob2QsIHVybCk7XG4gICAgICB9XG5cbiAgICAgIC8vIGhlYWRlcnMgYXJlIG1lYW50IHRvIGJlIHNlbnQgYWZ0ZXIgb3BlblxuICAgICAgaWYgKHN1cHBvcnQuY29ycykge1xuICAgICAgICBpZiAoYm9keSkge1xuICAgICAgICAgIGlmIChvcHRzLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVFRQL0FjY2Vzc19jb250cm9sX0NPUlMjU2ltcGxlX3JlcXVlc3RzXG4gICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignY29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignY29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ2FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChib2R5KSB7XG4gICAgICAgIHJlcS5zZW5kKGJvZHkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxLnNlbmQoKTtcbiAgICAgIH1cblxuICAgICAgLy8gZXZlbnQgb2JqZWN0IG5vdCByZWNlaXZlZCBpbiBJRTgsIGF0IGxlYXN0XG4gICAgICAvLyBidXQgd2UgZG8gbm90IHVzZSBpdCwgc3RpbGwgaW1wb3J0YW50IHRvIG5vdGVcbiAgICAgIGZ1bmN0aW9uIG9uTG9hZCgvKiBldmVudCAqLykge1xuICAgICAgICAvLyBXaGVuIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydHMgcmVxLnRpbWVvdXQsIHdlIGNhblxuICAgICAgICAvLyBoYXZlIGJvdGggYSBsb2FkIGFuZCB0aW1lb3V0IGV2ZW50LCBzaW5jZSBoYW5kbGVkIGJ5IGEgZHVtYiBzZXRUaW1lb3V0XG4gICAgICAgIGlmICh0aW1lZE91dCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsZWFyVGltZW91dChyZXFUaW1lb3V0KTtcblxuICAgICAgICB2YXIgb3V0O1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgb3V0ID0ge1xuICAgICAgICAgICAgYm9keTogSlNPTi5wYXJzZShyZXEucmVzcG9uc2VUZXh0KSxcbiAgICAgICAgICAgIHJlc3BvbnNlVGV4dDogcmVxLnJlc3BvbnNlVGV4dCxcbiAgICAgICAgICAgIHN0YXR1c0NvZGU6IHJlcS5zdGF0dXMsXG4gICAgICAgICAgICAvLyBYRG9tYWluUmVxdWVzdCBkb2VzIG5vdCBoYXZlIGFueSByZXNwb25zZSBoZWFkZXJzXG4gICAgICAgICAgICBoZWFkZXJzOiByZXEuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzICYmIHJlcS5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSB8fCB7fVxuICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBvdXQgPSBuZXcgZXJyb3JzLlVucGFyc2FibGVKU09OKHtcbiAgICAgICAgICAgIG1vcmU6IHJlcS5yZXNwb25zZVRleHRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvdXQgaW5zdGFuY2VvZiBlcnJvcnMuVW5wYXJzYWJsZUpTT04pIHtcbiAgICAgICAgICByZWplY3Qob3V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKG91dCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25FcnJvcihldmVudCkge1xuICAgICAgICBpZiAodGltZWRPdXQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjbGVhclRpbWVvdXQocmVxVGltZW91dCk7XG5cbiAgICAgICAgLy8gZXJyb3IgZXZlbnQgaXMgdHJpZ2VycmVkIGJvdGggd2l0aCBYRFIvWEhSIG9uOlxuICAgICAgICAvLyAgIC0gRE5TIGVycm9yXG4gICAgICAgIC8vICAgLSB1bmFsbG93ZWQgY3Jvc3MgZG9tYWluIHJlcXVlc3RcbiAgICAgICAgcmVqZWN0KFxuICAgICAgICAgIG5ldyBlcnJvcnMuTmV0d29yayh7XG4gICAgICAgICAgICBtb3JlOiBldmVudFxuICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uVGltZW91dCgpIHtcbiAgICAgICAgdGltZWRPdXQgPSB0cnVlO1xuICAgICAgICByZXEuYWJvcnQoKTtcblxuICAgICAgICByZWplY3QobmV3IGVycm9ycy5SZXF1ZXN0VGltZW91dCgpKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25Db25uZWN0KCkge1xuICAgICAgICBjb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICBjbGVhclRpbWVvdXQocmVxVGltZW91dCk7XG4gICAgICAgIHJlcVRpbWVvdXQgPSBzZXRUaW1lb3V0KG9uVGltZW91dCwgb3B0cy50aW1lb3V0cy5jb21wbGV0ZSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIG9uUHJvZ3Jlc3MoKSB7XG4gICAgICAgIGlmICghY29ubmVjdGVkKSBvbkNvbm5lY3QoKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25SZWFkeVN0YXRlQ2hhbmdlKCkge1xuICAgICAgICBpZiAoIWNvbm5lY3RlZCAmJiByZXEucmVhZHlTdGF0ZSA+IDEpIG9uQ29ubmVjdCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIEFsZ29saWFTZWFyY2hCcm93c2VyLnByb3RvdHlwZS5fcmVxdWVzdC5mYWxsYmFjayA9IGZ1bmN0aW9uIHJlcXVlc3RGYWxsYmFjayh1cmwsIG9wdHMpIHtcbiAgICB1cmwgPSBpbmxpbmVIZWFkZXJzKHVybCwgb3B0cy5oZWFkZXJzKTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiB3cmFwSnNvbnBSZXF1ZXN0KHJlc29sdmUsIHJlamVjdCkge1xuICAgICAganNvbnBSZXF1ZXN0KHVybCwgb3B0cywgZnVuY3Rpb24ganNvbnBSZXF1ZXN0RG9uZShlcnIsIGNvbnRlbnQpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlc29sdmUoY29udGVudCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBBbGdvbGlhU2VhcmNoQnJvd3Nlci5wcm90b3R5cGUuX3Byb21pc2UgPSB7XG4gICAgcmVqZWN0OiBmdW5jdGlvbiByZWplY3RQcm9taXNlKHZhbCkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHZhbCk7XG4gICAgfSxcbiAgICByZXNvbHZlOiBmdW5jdGlvbiByZXNvbHZlUHJvbWlzZSh2YWwpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsKTtcbiAgICB9LFxuICAgIGRlbGF5OiBmdW5jdGlvbiBkZWxheVByb21pc2UobXMpIHtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiByZXNvbHZlT25UaW1lb3V0KHJlc29sdmUvKiAsIHJlamVjdCovKSB7XG4gICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBhbGw6IGZ1bmN0aW9uIGFsbChwcm9taXNlcykge1xuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIGFsZ29saWFzZWFyY2g7XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvY3JlYXRlQWxnb2xpYXNlYXJjaC5qc1xuLy8gbW9kdWxlIGlkID0gNDZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGlubGluZUhlYWRlcnM7XG5cbnZhciBlbmNvZGUgPSByZXF1aXJlKCdxdWVyeXN0cmluZy1lczMvZW5jb2RlJyk7XG5cbmZ1bmN0aW9uIGlubGluZUhlYWRlcnModXJsLCBoZWFkZXJzKSB7XG4gIGlmICgvXFw/Ly50ZXN0KHVybCkpIHtcbiAgICB1cmwgKz0gJyYnO1xuICB9IGVsc2Uge1xuICAgIHVybCArPSAnPyc7XG4gIH1cblxuICByZXR1cm4gdXJsICsgZW5jb2RlKGhlYWRlcnMpO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvaW5saW5lLWhlYWRlcnMuanNcbi8vIG1vZHVsZSBpZCA9IDQ3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBqc29ucFJlcXVlc3Q7XG5cbnZhciBlcnJvcnMgPSByZXF1aXJlKCcuLi9lcnJvcnMnKTtcblxudmFyIEpTT05QQ291bnRlciA9IDA7XG5cbmZ1bmN0aW9uIGpzb25wUmVxdWVzdCh1cmwsIG9wdHMsIGNiKSB7XG4gIGlmIChvcHRzLm1ldGhvZCAhPT0gJ0dFVCcpIHtcbiAgICBjYihuZXcgRXJyb3IoJ01ldGhvZCAnICsgb3B0cy5tZXRob2QgKyAnICcgKyB1cmwgKyAnIGlzIG5vdCBzdXBwb3J0ZWQgYnkgSlNPTlAuJykpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIG9wdHMuZGVidWcoJ0pTT05QOiBzdGFydCcpO1xuXG4gIHZhciBjYkNhbGxlZCA9IGZhbHNlO1xuICB2YXIgdGltZWRPdXQgPSBmYWxzZTtcblxuICBKU09OUENvdW50ZXIgKz0gMTtcbiAgdmFyIGhlYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdO1xuICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gIHZhciBjYk5hbWUgPSAnYWxnb2xpYUpTT05QXycgKyBKU09OUENvdW50ZXI7XG4gIHZhciBkb25lID0gZmFsc2U7XG5cbiAgd2luZG93W2NiTmFtZV0gPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgcmVtb3ZlR2xvYmFscygpO1xuXG4gICAgaWYgKHRpbWVkT3V0KSB7XG4gICAgICBvcHRzLmRlYnVnKCdKU09OUDogTGF0ZSBhbnN3ZXIsIGlnbm9yaW5nJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY2JDYWxsZWQgPSB0cnVlO1xuXG4gICAgY2xlYW4oKTtcblxuICAgIGNiKG51bGwsIHtcbiAgICAgIGJvZHk6IGRhdGEsXG4gICAgICByZXNwb25zZVRleHQ6IEpTT04uc3RyaW5naWZ5KGRhdGEpLyogLFxuICAgICAgLy8gV2UgZG8gbm90IHNlbmQgdGhlIHN0YXR1c0NvZGUsIHRoZXJlJ3Mgbm8gc3RhdHVzQ29kZSBpbiBKU09OUCwgaXQgd2lsbCBiZVxuICAgICAgLy8gY29tcHV0ZWQgdXNpbmcgZGF0YS5zdGF0dXMgJiYgZGF0YS5tZXNzYWdlIGxpa2Ugd2l0aCBYRFJcbiAgICAgIHN0YXR1c0NvZGUqL1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIGFkZCBjYWxsYmFjayBieSBoYW5kXG4gIHVybCArPSAnJmNhbGxiYWNrPScgKyBjYk5hbWU7XG5cbiAgLy8gYWRkIGJvZHkgcGFyYW1zIG1hbnVhbGx5XG4gIGlmIChvcHRzLmpzb25Cb2R5ICYmIG9wdHMuanNvbkJvZHkucGFyYW1zKSB7XG4gICAgdXJsICs9ICcmJyArIG9wdHMuanNvbkJvZHkucGFyYW1zO1xuICB9XG5cbiAgdmFyIG9udGltZW91dCA9IHNldFRpbWVvdXQodGltZW91dCwgb3B0cy50aW1lb3V0cy5jb21wbGV0ZSk7XG5cbiAgLy8gc2NyaXB0IG9ucmVhZHlzdGF0ZWNoYW5nZSBuZWVkZWQgb25seSBmb3JcbiAgLy8gPD0gSUU4XG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyL2FuZ3VsYXIuanMvaXNzdWVzLzQ1MjNcbiAgc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHJlYWR5c3RhdGVjaGFuZ2U7XG4gIHNjcmlwdC5vbmxvYWQgPSBzdWNjZXNzO1xuICBzY3JpcHQub25lcnJvciA9IGVycm9yO1xuXG4gIHNjcmlwdC5hc3luYyA9IHRydWU7XG4gIHNjcmlwdC5kZWZlciA9IHRydWU7XG4gIHNjcmlwdC5zcmMgPSB1cmw7XG4gIGhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcblxuICBmdW5jdGlvbiBzdWNjZXNzKCkge1xuICAgIG9wdHMuZGVidWcoJ0pTT05QOiBzdWNjZXNzJyk7XG5cbiAgICBpZiAoZG9uZSB8fCB0aW1lZE91dCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRvbmUgPSB0cnVlO1xuXG4gICAgLy8gc2NyaXB0IGxvYWRlZCBidXQgZGlkIG5vdCBjYWxsIHRoZSBmbiA9PiBzY3JpcHQgbG9hZGluZyBlcnJvclxuICAgIGlmICghY2JDYWxsZWQpIHtcbiAgICAgIG9wdHMuZGVidWcoJ0pTT05QOiBGYWlsLiBTY3JpcHQgbG9hZGVkIGJ1dCBkaWQgbm90IGNhbGwgdGhlIGNhbGxiYWNrJyk7XG4gICAgICBjbGVhbigpO1xuICAgICAgY2IobmV3IGVycm9ycy5KU09OUFNjcmlwdEZhaWwoKSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcmVhZHlzdGF0ZWNoYW5nZSgpIHtcbiAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSAnbG9hZGVkJyB8fCB0aGlzLnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcbiAgICAgIHN1Y2Nlc3MoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBjbGVhbigpIHtcbiAgICBjbGVhclRpbWVvdXQob250aW1lb3V0KTtcbiAgICBzY3JpcHQub25sb2FkID0gbnVsbDtcbiAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICBzY3JpcHQub25lcnJvciA9IG51bGw7XG4gICAgaGVhZC5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlR2xvYmFscygpIHtcbiAgICB0cnkge1xuICAgICAgZGVsZXRlIHdpbmRvd1tjYk5hbWVdO1xuICAgICAgZGVsZXRlIHdpbmRvd1tjYk5hbWUgKyAnX2xvYWRlZCddO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHdpbmRvd1tjYk5hbWVdID0gd2luZG93W2NiTmFtZSArICdfbG9hZGVkJ10gPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gdGltZW91dCgpIHtcbiAgICBvcHRzLmRlYnVnKCdKU09OUDogU2NyaXB0IHRpbWVvdXQnKTtcbiAgICB0aW1lZE91dCA9IHRydWU7XG4gICAgY2xlYW4oKTtcbiAgICBjYihuZXcgZXJyb3JzLlJlcXVlc3RUaW1lb3V0KCkpO1xuICB9XG5cbiAgZnVuY3Rpb24gZXJyb3IoKSB7XG4gICAgb3B0cy5kZWJ1ZygnSlNPTlA6IFNjcmlwdCBlcnJvcicpO1xuXG4gICAgaWYgKGRvbmUgfHwgdGltZWRPdXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjbGVhbigpO1xuICAgIGNiKG5ldyBlcnJvcnMuSlNPTlBTY3JpcHRFcnJvcigpKTtcbiAgfVxufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL2Jyb3dzZXIvanNvbnAtcmVxdWVzdC5qc1xuLy8gbW9kdWxlIGlkID0gNDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZXByZWNhdGUoZm4sIG1lc3NhZ2UpIHtcbiAgdmFyIHdhcm5lZCA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIGRlcHJlY2F0ZWQoKSB7XG4gICAgaWYgKCF3YXJuZWQpIHtcbiAgICAgIC8qIGVzbGludCBuby1jb25zb2xlOjAgKi9cbiAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTtcbiAgICAgIHdhcm5lZCA9IHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cblxuICByZXR1cm4gZGVwcmVjYXRlZDtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvZGVwcmVjYXRlLmpzXG4vLyBtb2R1bGUgaWQgPSA0OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlcHJlY2F0ZWRNZXNzYWdlKHByZXZpb3VzVXNhZ2UsIG5ld1VzYWdlKSB7XG4gIHZhciBnaXRodWJBbmNob3JMaW5rID0gcHJldmlvdXNVc2FnZS50b0xvd2VyQ2FzZSgpXG4gICAgLnJlcGxhY2UoL1tcXC5cXChcXCldL2csICcnKTtcblxuICByZXR1cm4gJ2FsZ29saWFzZWFyY2g6IGAnICsgcHJldmlvdXNVc2FnZSArICdgIHdhcyByZXBsYWNlZCBieSBgJyArIG5ld1VzYWdlICtcbiAgICAnYC4gUGxlYXNlIHNlZSBodHRwczovL2dpdGh1Yi5jb20vYWxnb2xpYS9hbGdvbGlhc2VhcmNoLWNsaWVudC1qYXZhc2NyaXB0L3dpa2kvRGVwcmVjYXRlZCMnICsgZ2l0aHViQW5jaG9yTGluaztcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvZGVwcmVjYXRlZE1lc3NhZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDUwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8vIFBhcnNlIGNsb3VkIGRvZXMgbm90IHN1cHBvcnRzIHNldFRpbWVvdXRcbi8vIFdlIGRvIG5vdCBzdG9yZSBhIHNldFRpbWVvdXQgcmVmZXJlbmNlIGluIHRoZSBjbGllbnQgZXZlcnl0aW1lXG4vLyBXZSBvbmx5IGZhbGxiYWNrIHRvIGEgZmFrZSBzZXRUaW1lb3V0IHdoZW4gbm90IGF2YWlsYWJsZVxuLy8gc2V0VGltZW91dCBjYW5ub3QgYmUgb3ZlcnJpZGUgZ2xvYmFsbHkgc2FkbHlcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZXhpdFByb21pc2UoZm4sIF9zZXRUaW1lb3V0KSB7XG4gIF9zZXRUaW1lb3V0KGZuLCAwKTtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYWxnb2xpYXNlYXJjaC9zcmMvZXhpdFByb21pc2UuanNcbi8vIG1vZHVsZSBpZCA9IDUxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBmb3JlYWNoID0gcmVxdWlyZSgnZm9yZWFjaCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG1lcmdlKGRlc3RpbmF0aW9uLyogLCBzb3VyY2VzICovKSB7XG4gIHZhciBzb3VyY2VzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcblxuICBmb3JlYWNoKHNvdXJjZXMsIGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgIGZvciAodmFyIGtleU5hbWUgaW4gc291cmNlKSB7XG4gICAgICBpZiAoc291cmNlLmhhc093blByb3BlcnR5KGtleU5hbWUpKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZGVzdGluYXRpb25ba2V5TmFtZV0gPT09ICdvYmplY3QnICYmIHR5cGVvZiBzb3VyY2Vba2V5TmFtZV0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgZGVzdGluYXRpb25ba2V5TmFtZV0gPSBtZXJnZSh7fSwgZGVzdGluYXRpb25ba2V5TmFtZV0sIHNvdXJjZVtrZXlOYW1lXSk7XG4gICAgICAgIH0gZWxzZSBpZiAoc291cmNlW2tleU5hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBkZXN0aW5hdGlvbltrZXlOYW1lXSA9IHNvdXJjZVtrZXlOYW1lXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGRlc3RpbmF0aW9uO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9tZXJnZS5qc1xuLy8gbW9kdWxlIGlkID0gNTJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVQbGFjZXNDbGllbnQ7XG5cbnZhciBidWlsZFNlYXJjaE1ldGhvZCA9IHJlcXVpcmUoJy4vYnVpbGRTZWFyY2hNZXRob2QuanMnKTtcblxuZnVuY3Rpb24gY3JlYXRlUGxhY2VzQ2xpZW50KGFsZ29saWFzZWFyY2gpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHBsYWNlcyhhcHBJRCwgYXBpS2V5LCBvcHRzKSB7XG4gICAgdmFyIGNsb25lRGVlcCA9IHJlcXVpcmUoJy4vY2xvbmUuanMnKTtcblxuICAgIG9wdHMgPSBvcHRzICYmIGNsb25lRGVlcChvcHRzKSB8fCB7fTtcbiAgICBvcHRzLmhvc3RzID0gb3B0cy5ob3N0cyB8fCBbXG4gICAgICAncGxhY2VzLWRzbi5hbGdvbGlhLm5ldCcsXG4gICAgICAncGxhY2VzLTEuYWxnb2xpYW5ldC5jb20nLFxuICAgICAgJ3BsYWNlcy0yLmFsZ29saWFuZXQuY29tJyxcbiAgICAgICdwbGFjZXMtMy5hbGdvbGlhbmV0LmNvbSdcbiAgICBdO1xuXG4gICAgLy8gYWxsb3cgaW5pdFBsYWNlcygpIG5vIGFyZ3VtZW50cyA9PiBjb21tdW5pdHkgcmF0ZSBsaW1pdGVkXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDAgfHwgdHlwZW9mIGFwcElEID09PSAnb2JqZWN0JyB8fCBhcHBJRCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBhcHBJRCA9ICcnO1xuICAgICAgYXBpS2V5ID0gJyc7XG4gICAgICBvcHRzLl9hbGxvd0VtcHR5Q3JlZGVudGlhbHMgPSB0cnVlO1xuICAgIH1cblxuICAgIHZhciBjbGllbnQgPSBhbGdvbGlhc2VhcmNoKGFwcElELCBhcGlLZXksIG9wdHMpO1xuICAgIHZhciBpbmRleCA9IGNsaWVudC5pbml0SW5kZXgoJ3BsYWNlcycpO1xuICAgIGluZGV4LnNlYXJjaCA9IGJ1aWxkU2VhcmNoTWV0aG9kKCdxdWVyeScsICcvMS9wbGFjZXMvcXVlcnknKTtcbiAgICBpbmRleC5nZXRPYmplY3QgPSBmdW5jdGlvbihvYmplY3RJRCwgY2FsbGJhY2spIHtcbiAgICAgIHJldHVybiB0aGlzLmFzLl9qc29uUmVxdWVzdCh7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIHVybDogJy8xL3BsYWNlcy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KG9iamVjdElEKSxcbiAgICAgICAgaG9zdFR5cGU6ICdyZWFkJyxcbiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrXG4gICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBpbmRleDtcbiAgfTtcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9wbGFjZXMuanNcbi8vIG1vZHVsZSBpZCA9IDUzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBkZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJykoJ2FsZ29saWFzZWFyY2g6c3JjL2hvc3RJbmRleFN0YXRlLmpzJyk7XG52YXIgbG9jYWxTdG9yYWdlTmFtZXNwYWNlID0gJ2FsZ29saWFzZWFyY2gtY2xpZW50LWpzJztcblxudmFyIHN0b3JlO1xudmFyIG1vZHVsZVN0b3JlID0ge1xuICBzdGF0ZToge30sXG4gIHNldDogZnVuY3Rpb24oa2V5LCBkYXRhKSB7XG4gICAgdGhpcy5zdGF0ZVtrZXldID0gZGF0YTtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZVtrZXldO1xuICB9LFxuICBnZXQ6IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlW2tleV0gfHwgbnVsbDtcbiAgfVxufTtcblxudmFyIGxvY2FsU3RvcmFnZVN0b3JlID0ge1xuICBzZXQ6IGZ1bmN0aW9uKGtleSwgZGF0YSkge1xuICAgIG1vZHVsZVN0b3JlLnNldChrZXksIGRhdGEpOyAvLyBhbHdheXMgcmVwbGljYXRlIGxvY2FsU3RvcmFnZVN0b3JlIHRvIG1vZHVsZVN0b3JlIGluIGNhc2Ugb2YgZmFpbHVyZVxuXG4gICAgdHJ5IHtcbiAgICAgIHZhciBuYW1lc3BhY2UgPSBKU09OLnBhcnNlKGdsb2JhbC5sb2NhbFN0b3JhZ2VbbG9jYWxTdG9yYWdlTmFtZXNwYWNlXSk7XG4gICAgICBuYW1lc3BhY2Vba2V5XSA9IGRhdGE7XG4gICAgICBnbG9iYWwubG9jYWxTdG9yYWdlW2xvY2FsU3RvcmFnZU5hbWVzcGFjZV0gPSBKU09OLnN0cmluZ2lmeShuYW1lc3BhY2UpO1xuICAgICAgcmV0dXJuIG5hbWVzcGFjZVtrZXldO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2VGYWlsdXJlKGtleSwgZSk7XG4gICAgfVxuICB9LFxuICBnZXQ6IGZ1bmN0aW9uKGtleSkge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShnbG9iYWwubG9jYWxTdG9yYWdlW2xvY2FsU3RvcmFnZU5hbWVzcGFjZV0pW2tleV0gfHwgbnVsbDtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gbG9jYWxTdG9yYWdlRmFpbHVyZShrZXksIGUpO1xuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gbG9jYWxTdG9yYWdlRmFpbHVyZShrZXksIGUpIHtcbiAgZGVidWcoJ2xvY2FsU3RvcmFnZSBmYWlsZWQgd2l0aCcsIGUpO1xuICBjbGVhbnVwKCk7XG4gIHN0b3JlID0gbW9kdWxlU3RvcmU7XG4gIHJldHVybiBzdG9yZS5nZXQoa2V5KTtcbn1cblxuc3RvcmUgPSBzdXBwb3J0c0xvY2FsU3RvcmFnZSgpID8gbG9jYWxTdG9yYWdlU3RvcmUgOiBtb2R1bGVTdG9yZTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGdldDogZ2V0T3JTZXQsXG4gIHNldDogZ2V0T3JTZXQsXG4gIHN1cHBvcnRzTG9jYWxTdG9yYWdlOiBzdXBwb3J0c0xvY2FsU3RvcmFnZVxufTtcblxuZnVuY3Rpb24gZ2V0T3JTZXQoa2V5LCBkYXRhKSB7XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuIHN0b3JlLmdldChrZXkpO1xuICB9XG5cbiAgcmV0dXJuIHN0b3JlLnNldChrZXksIGRhdGEpO1xufVxuXG5mdW5jdGlvbiBzdXBwb3J0c0xvY2FsU3RvcmFnZSgpIHtcbiAgdHJ5IHtcbiAgICBpZiAoJ2xvY2FsU3RvcmFnZScgaW4gZ2xvYmFsICYmXG4gICAgICBnbG9iYWwubG9jYWxTdG9yYWdlICE9PSBudWxsKSB7XG4gICAgICBpZiAoIWdsb2JhbC5sb2NhbFN0b3JhZ2VbbG9jYWxTdG9yYWdlTmFtZXNwYWNlXSkge1xuICAgICAgICAvLyBhY3R1YWwgY3JlYXRpb24gb2YgdGhlIG5hbWVzcGFjZVxuICAgICAgICBnbG9iYWwubG9jYWxTdG9yYWdlLnNldEl0ZW0obG9jYWxTdG9yYWdlTmFtZXNwYWNlLCBKU09OLnN0cmluZ2lmeSh7fSkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9IGNhdGNoIChfKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8vIEluIGNhc2Ugb2YgYW55IGVycm9yIG9uIGxvY2FsU3RvcmFnZSwgd2UgY2xlYW4gb3VyIG93biBuYW1lc3BhY2UsIHRoaXMgc2hvdWxkIGhhbmRsZVxuLy8gcXVvdGEgZXJyb3JzIHdoZW4gYSBsb3Qgb2Yga2V5cyArIGRhdGEgYXJlIHVzZWRcbmZ1bmN0aW9uIGNsZWFudXAoKSB7XG4gIHRyeSB7XG4gICAgZ2xvYmFsLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGxvY2FsU3RvcmFnZU5hbWVzcGFjZSk7XG4gIH0gY2F0Y2ggKF8pIHtcbiAgICAvLyBub3RoaW5nIHRvIGRvXG4gIH1cbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9hbGdvbGlhc2VhcmNoL3NyYy9zdG9yZS5qc1xuLy8gbW9kdWxlIGlkID0gNTRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9ICczLjI5LjAnO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2FsZ29saWFzZWFyY2gvc3JjL3ZlcnNpb24uanNcbi8vIG1vZHVsZSBpZCA9IDU1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0ge1xuICB2ZXJ0ZXhTaGFkZXIgOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB1dnMueHkgPSB1di54eTtcbiAgICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcbiAgICB9XG4gIGAsXG5cbiAgZnJhZ21lbnRTaGFkZXI6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIHNyYztcblxuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIGdsX0ZyYWdDb2xvciA9IHRleHR1cmUyRChzcmMsIHV2cyk7XG4gICAgfVxuYH07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9hc3NldHMvc2hhZGVycy9mbGF0LmpzIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZlcnRleFNoYWRlciA6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB1dnMueHkgPSB1di54eTtcbiAgICAgIHZlYzQgcCA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XG4gICAgICB3b3JsZFBvcyA9IChtb2RlbE1hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKSkueHl6O1xuICAgICAgZ2xfUG9zaXRpb24gPSBwO1xuICAgIH1cbiAgYCxcblxuICBmcmFnbWVudFNoYWRlcjogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHVuaWZvcm0gdmVjMyB0dW5uZWxOZW9uO1xuICAgIHVuaWZvcm0gdmVjMyBsZWZ0TGFzZXI7XG4gICAgdW5pZm9ybSB2ZWMzIHJpZ2h0TGFzZXI7XG4gICAgdW5pZm9ybSB2ZWMzIGZsb29yTmVvbjtcbiAgICB1bmlmb3JtIHZlYzMgdGV4dEdsb3c7XG4gICAgdW5pZm9ybSBzYW1wbGVyMkQgc3JjO1xuXG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgZmxvYXQgbWFzaztcbiAgICAgIHZlYzQgY29sID0gdGV4dHVyZTJEKHNyYywgdXZzKTtcblxuICAgICAgLy8gdHVubmVsIG5lb25cbiAgICAgIG1hc2sgPSBzdGVwKDAuODcsIHV2cy54KSAqICBzdGVwKDAuNSwgdXZzLnkpICogKDEuMCAtIHN0ZXAoMC45MzUsIHV2cy54KSkgKiAoIDEuMCAtIHN0ZXAoMC43NSwgdXZzLnkpKTtcbiAgICAgIGNvbC54eXogPSBtaXgoY29sLnh5eiwgY29sLnh5eiAqIHR1bm5lbE5lb24sIG1hc2spO1xuXG4gICAgICAvLyBmbG9vciAmIGNvcnJpZG9yIG5lb25zXG4gICAgICBtYXNrID0gc3RlcCgwLjkzNSwgdXZzLngpICogc3RlcCgwLjUsIHV2cy55KSAqICggMS4wIC0gc3RlcCgwLjc1LCB1dnMueSkpO1xuICAgICAgY29sLnh5eiA9IG1peChjb2wueHl6LCBjb2wueHl6ICogZmxvb3JOZW9uLCBtYXNrKTtcblxuICAgICAgLy8gbGVmdCBsYXNlclxuICAgICAgbWFzayA9IHN0ZXAoMC41LCB1dnMueCkgKiAoMS4wIC0gc3RlcCgwLjYyNSwgdXZzLngpKSAqICgxLjAgLSBzdGVwKDAuNSwgdXZzLnkpKTtcbiAgICAgIGNvbC54eXogPSBtaXgoY29sLnh5eiwgY29sLnh5eiAqIGxlZnRMYXNlciwgbWFzayk7XG5cbiAgICAgIC8vIHJpZ2h0IGxhc2VyXG4gICAgICBtYXNrID0gc3RlcCgwLjYyNSwgdXZzLngpICogKDEuMCAtIHN0ZXAoMC43NSwgdXZzLngpKSAqICgxLjAgLSBzdGVwKDAuNSwgdXZzLnkpKTtcbiAgICAgIGNvbC54eXogPSBtaXgoY29sLnh5eiwgY29sLnh5eiAqIHJpZ2h0TGFzZXIsIG1hc2spO1xuXG4gICAgICAvLyB0ZXh0IGdsb3dzXG4gICAgICBtYXNrID0gc3RlcCgwLjg3LCB1dnMueCkgKiAgc3RlcCgwLjI1LCB1dnMueSkgKiAoMS4wIC0gc3RlcCgwLjkzNSwgdXZzLngpKSAqICggMS4wIC0gc3RlcCgwLjUsIHV2cy55KSk7XG4gICAgICBjb2wueHl6ID0gbWl4KGNvbC54eXosIGNvbC54eXogKiB0ZXh0R2xvdywgbWFzayk7XG5cbiAgICAgIGdsX0ZyYWdDb2xvciA9IGNvbDtcbiAgICB9XG4gIGBcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9hc3NldHMvc2hhZGVycy9zdGFnZUFkZGl0aXZlLmpzIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIHZlcnRleFNoYWRlciA6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB1dnMueHkgPSB1di54eTtcbiAgICAgIHZlYzQgcCA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XG4gICAgICB3b3JsZFBvcyA9IChtb2RlbE1hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKSkueHl6O1xuICAgICAgZ2xfUG9zaXRpb24gPSBwO1xuICAgIH1cbiAgYCxcblxuICBmcmFnbWVudFNoYWRlcjogYFxuICAgICNkZWZpbmUgRk9HX1JBRElVUyAgNTUuMFxuICAgICNkZWZpbmUgRk9HX0ZBTExPRkYgNDguMFxuICAgICNkZWZpbmUgRk9HX0NPTE9SX01VTFQgMC44XG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdW5pZm9ybSB2ZWMzIHNreUNvbG9yO1xuICAgIHVuaWZvcm0gdmVjMyBiYWNrZ2xvd0NvbG9yO1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIHNyYztcblxuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHZlYzQgY29sID0gdGV4dHVyZTJEKHNyYywgdXZzKTtcbiAgICAgIGZsb2F0IG1hc2s7XG5cbiAgICAgIC8vIGJnXG4gICAgICBtYXNrID0gc3RlcCgwLjUsIHV2cy54KTtcbiAgICAgIGNvbC54eXogPSBtaXgoY29sLnh5eiAqIHNreUNvbG9yLCBjb2wueHl6LCBtYXNrKTtcblxuICAgICAgLy8gYmFja2dsb3dcbiAgICAgIG1hc2sgPSBzdGVwKDAuNSwgdXZzLngpICogc3RlcCgwLjUsIHV2cy55KSAqICgxLjAgLSBzdGVwKDAuNzUsIHV2cy54KSk7XG4gICAgICBjb2wueHl6ID0gbWl4KGNvbC54eXosIGNvbC54eXogKiBiYWNrZ2xvd0NvbG9yLCBtYXNrKTtcblxuICAgICAgZmxvYXQgZm9nRGVuc2l0eSA9IDEuMCAtIHBvdyhjbGFtcChkaXN0YW5jZSh3b3JsZFBvcywgdmVjMygwLiwgMC4sIC1GT0dfUkFESVVTKSkgLyBGT0dfRkFMTE9GRiwgMC4wLCAxLjApLCAxLjUpO1xuICAgICAgZm9nRGVuc2l0eSArPSBjbGFtcCgwLjIgLSBwb3coZGlzdGFuY2Uod29ybGRQb3MsIHZlYzMoMC4wLCAwLjAsIHdvcmxkUG9zLnopKSAvIDEwLjAsIDIuMCksIDAuMCwgMS4wKTtcbiAgICAgIGNvbC54eXogPSBtaXgoY29sLnh5eiwgYmFja2dsb3dDb2xvciAqIEZPR19DT0xPUl9NVUxULCBmb2dEZW5zaXR5KTtcblxuICAgICAgZ2xfRnJhZ0NvbG9yID0gY29sO1xuICAgIH1cbiAgYFxufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2Fzc2V0cy9zaGFkZXJzL3N0YWdlTm9ybWFsLmpzIiwiLyoqXG4gKiBBY3RpdmUgY29sb3IuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYWN0aXZlLWNvbG9yJywge1xuICBkZXBlbmRlbmNpZXM6IFsnbWF0ZXJpYWwnXSxcblxuICBzY2hlbWE6IHtcbiAgICBhY3RpdmU6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgY29sb3I6IHtkZWZhdWx0OiAnI2ZmZmZmZid9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZGVmYXVsdENvbG9yID0gdGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJykuY29sb3I7XG4gICAgdGhpcy5tYXRlcmlhbE9iaiA9IHtjb2xvcjogdGhpcy5kYXRhLmNvbG9yLCBvcGFjaXR5OiAxfTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuXG4gICAgaWYgKHRoaXMuZGF0YS5hY3RpdmUpIHtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB0aGlzLm1hdGVyaWFsT2JqKTtcbiAgICAgIGVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ2NvbG9yJywgdGhpcy5kZWZhdWx0Q29sb3IpO1xuICAgICAgaWYgKGVsLmNvbXBvbmVudHMuYW5pbWF0aW9uX19tb3VzZWxlYXZlKSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4geyBlbC5lbWl0KCdtb3VzZWxlYXZlJywgbnVsbCwgZmFsc2UpOyB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2FjdGl2ZS10ZXh0LWNvbG9yJywge1xuICBkZXBlbmRlbmNpZXM6IFsndGV4dCddLFxuXG4gIHNjaGVtYToge1xuICAgIGFjdGl2ZToge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBjb2xvcjoge2RlZmF1bHQ6ICcjMzMzJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5kZWZhdWx0Q29sb3IgPSB0aGlzLmVsLmdldEF0dHJpYnV0ZSgndGV4dCcpLmNvbG9yO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgaWYgKHRoaXMuZGF0YS5hY3RpdmUpIHtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgndGV4dCcsICdjb2xvcicsIHRoaXMuZGF0YS5jb2xvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgndGV4dCcsICdjb2xvcicsIHRoaXMuZGVmYXVsdENvbG9yKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvYWN0aXZlLWNvbG9yLmpzIiwiXG5jb25zdCBOVU1fVkFMVUVTX1BFUl9CT1ggPSA5MDtcblxuLyoqXG4gKiBDb2x1bW4gYmFycyBtb3ZpbmcgaW4gc3luYyB0byB0aGUgYXVkaW8gdmlhIGF1ZGlvIGFuYWx5c2VyLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2F1ZGlvLWNvbHVtbnMnLCB7XG4gIHNjaGVtYToge1xuICAgIGFuYWx5c2VyOiB7dHlwZTogJ3NlbGVjdG9yJywgZGVmYXVsdDogJyNhdWRpb0FuYWx5c2VyJ30sXG4gICAgaGVpZ2h0OiB7ZGVmYXVsdDogMS4wfSxcbiAgICBtaXJyb3I6IHtkZWZhdWx0OiAzfSxcbiAgICBzY2FsZToge2RlZmF1bHQ6IDQuMH0sXG4gICAgc2VwYXJhdGlvbjoge2RlZmF1bHQ6IDAuM30sXG4gICAgdGhpY2tuZXNzOiB7ZGVmYXVsdDogMC4xfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb2JqRGF0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdWRpb2NvbHVtbk9iaicpLmRhdGE7XG4gICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5PQkpMb2FkZXIoKTtcbiAgICB2YXIgY29sdW1uR2VvbWV0cnkgPSBsb2FkZXIucGFyc2Uob2JqRGF0YSkuY2hpbGRyZW5bMF0uZ2VvbWV0cnk7XG5cbiAgICB0aGlzLmFuYWx5c2VyID0gdGhpcy5kYXRhLmFuYWx5c2VyLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlcjtcblxuICAgIC8vIE51bWJlciBvZiBsZXZlbHMgaXMgaGFsZiB0aGUgRkZUIHNpemUuXG4gICAgdGhpcy5mcmVxdWVuY3lCaW5Db3VudCA9IHRoaXMuYW5hbHlzZXIuZGF0YS5mZnRTaXplIC8gMjtcblxuICAgIC8vIENyZWF0ZSBib3hlcyAob25lIHJvdyBvbiBlYWNoIHNpZGUgcGVyIGxldmVsKS5cbiAgICBjb25zdCBnZW9tZXRyaWVzID0gW107XG4gICAgbGV0IHpQb3NpdGlvbiA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZyZXF1ZW5jeUJpbkNvdW50OyBpKyspIHtcbiAgICAgIGZvciAobGV0IHNpZGUgPSAwOyBzaWRlIDwgMjsgc2lkZSsrKSB7XG4gICAgICAgIGNvbnN0IGJveCA9IGNvbHVtbkdlb21ldHJ5LmNsb25lKCk7XG4gICAgICAgIHRoaXMuaW5pdEJveChib3gsIHNpZGUgPT09IDAgPyAxIDogLTEsIHpQb3NpdGlvbik7XG4gICAgICAgIGdlb21ldHJpZXMucHVzaChib3gpO1xuICAgICAgICAvLyBNb3ZlIFogYmFjay5cbiAgICAgICAgelBvc2l0aW9uIC09IHRoaXMuZGF0YS5zZXBhcmF0aW9uO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZ2VvbWV0cnkgPSBUSFJFRS5CdWZmZXJHZW9tZXRyeVV0aWxzLm1lcmdlQnVmZmVyR2VvbWV0cmllcyhnZW9tZXRyaWVzKTtcbiAgICBjb25zdCBtZXNoID0gbmV3IFRIUkVFLk1lc2godGhpcy5nZW9tZXRyeSwgdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzLnN0YWdlTm9ybWFsKTtcbiAgICB0aGlzLmVsLnNldE9iamVjdDNEKCdtZXNoJywgbWVzaCk7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKCkge1xuICAgIC8vIFN0ZXAgYnkgMiBzaW5jZSB3ZSBjcmVhdGUgb25lIGJveCBvZiBlYWNoIHNpZGUgcGVyIGxldmVsLlxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5mcmVxdWVuY3lCaW5Db3VudCAqIDI7IGkgKz0gMikge1xuICAgICAgbGV0IHlTY2FsZSA9ICh0aGlzLmRhdGEuaGVpZ2h0IC8gMikgKyB0aGlzLmFuYWx5c2VyLmxldmVsc1tNYXRoLmZsb29yKGkgLyAyKV0gLyAyNTYuMCAqXG4gICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLnNjYWxlO1xuICAgICAgaWYgKGlzTmFOKHlTY2FsZSkpIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLnNldEJveEhlaWdodCh0aGlzLmZyZXF1ZW5jeUJpbkNvdW50ICogMiAtIGkgLSAxLCB5U2NhbGUpO1xuICAgICAgdGhpcy5zZXRCb3hIZWlnaHQodGhpcy5mcmVxdWVuY3lCaW5Db3VudCAqIDIgLSBpIC0gMiwgeVNjYWxlKTtcbiAgICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGJveCBieSBjaGFuZ2luZyB2ZXJ0ZXggYnVmZmVyLCB0byBzZXQgcG9zaXRpb24gYW5kIHNjYWxlLlxuICAgKi9cbiAgaW5pdEJveDogZnVuY3Rpb24gKGJveCwgZmxpcCwgelBvc2l0aW9uKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIC8vIFNldCBwb3NpdGlvbiBhbmQgc2NhbGUgb2YgYm94IHZpYSB2ZXJ0aWNlcy5cbiAgICBmb3IgKGxldCB2ID0gMDsgdiA8IGJveC5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5Lmxlbmd0aDsgdiArPSAzKSB7XG4gICAgICAvLyBBcHBseSB0aGlja25lc3MgdG8gWCBhbmQgWi5cbiAgICAgIC8vIGJveC5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W3ZdICo9IGRhdGEudGhpY2tuZXNzO1xuICAgICAgLy8gYm94LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlbdiArIDJdICo9IGRhdGEudGhpY2tuZXNzO1xuLy8gQXBwbHkgelBvc2l0aW9uLlxuICAgICAgYm94LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlbdiArIDJdICs9IHpQb3NpdGlvbjtcblxuICAgICAgLy8gQXBwbHkgaGVpZ2h0IHRvIFkuXG4gICAgICBib3guYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVt2ICsgMV0gKj0gZGF0YS5oZWlnaHQgLyAyO1xuXG4gICAgICAvLyBDaGFuZ2UgWCB2ZXJ0ZXggcG9zaXRpb25zIGZvciBtaXJyb3JpbmcuXG4gICAgICBib3guYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVt2XSArPSBmbGlwICogZGF0YS5taXJyb3I7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBTZXQgWSBvZiB2ZXJ0aWNlcy5cbiAgICovXG4gIHNldEJveEhlaWdodDogZnVuY3Rpb24gKGJveE51bWJlciwgaGVpZ2h0KSB7XG4gICAgY29uc3QgYm94SW5kZXggPSBib3hOdW1iZXIgKiBOVU1fVkFMVUVTX1BFUl9CT1g7XG4gICAgZm9yIChsZXQgaSA9IGJveEluZGV4OyBpIDwgYm94SW5kZXggKyBOVU1fVkFMVUVTX1BFUl9CT1g7IGkgKz0gMykge1xuICAgICAgLy8gU2V0IFkuXG4gICAgICBsZXQgeVZhbHVlID0gdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W2kgKyAxXTtcbiAgICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheVtpICsgMV0gPSB5VmFsdWUgPj0gMFxuICAgICAgICA/IGhlaWdodFxuICAgICAgICA6IC0xICogaGVpZ2h0O1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9hdWRpby1jb2x1bW5zLmpzIiwiY29uc3QgQU5JTUUgPSBBRlJBTUUuQU5JTUUgfHwgQUZSQU1FLmFuaW1lO1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2JlYW1zJywge1xuICBzY2hlbWE6IHtcbiAgICBpc1BsYXlpbmc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgcG9vbFNpemU6IHtkZWZhdWx0OiAzfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJlYW1zID0gW107XG4gICAgdGhpcy5jdXJyZW50UmVkID0gMDtcbiAgICB0aGlzLmN1cnJlbnRCbHVlID0gMDtcbiAgICB0aGlzLmNsZWFyQmVhbXMgPSB0aGlzLmNsZWFyQmVhbXMuYmluZCh0aGlzKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xlYXJnYW1lJywgdGhpcy5jbGVhckJlYW1zKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmVhbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLmJlYW1zW2ldLnRpbWUpIHtcbiAgICAgICAgdGhpcy5iZWFtc1tpXS52aXNpYmxlID0gdGhpcy5kYXRhLmlzUGxheWluZztcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIC8vIEJlYW0gcG9vbHMuXG4gICAgLy9jb25zdCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KDAuNCwgNTApLnRyYW5zbGF0ZSgwLCAyNSwgMCk7XG5cbiAgICB2YXIgb2JqRGF0YTtcbiAgICB2YXIgbG9hZGVyO1xuICAgIHZhciByZWRHZW9tZXRyeSwgYmx1ZUdlb21ldHJ5O1xuXG4gICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5PQkpMb2FkZXIoKTtcbiAgICBvYmpEYXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZGJlYW1PYmonKS5kYXRhO1xuICAgIHJlZEdlb21ldHJ5ID0gbG9hZGVyLnBhcnNlKG9iakRhdGEpLmNoaWxkcmVuWzBdLmdlb21ldHJ5O1xuXG4gICAgb2JqRGF0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdibHVlYmVhbU9iaicpLmRhdGE7XG4gICAgYmx1ZUdlb21ldHJ5ID0gbG9hZGVyLnBhcnNlKG9iakRhdGEpLmNoaWxkcmVuWzBdLmdlb21ldHJ5O1xuXG4gICAgdGhpcy5yZWRCZWFtcyA9IHRoaXMuY3JlYXRlQmVhbVBvb2wocmVkR2VvbWV0cnksIHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFscy5zdGFnZUFkZGl0aXZlKTtcbiAgICB0aGlzLmJsdWVCZWFtcyA9IHRoaXMuY3JlYXRlQmVhbVBvb2woYmx1ZUdlb21ldHJ5LCB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHMuc3RhZ2VBZGRpdGl2ZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFVzZSB0aWNrIGZvciBtYW51YWwgQU5JTUUgYW5pbWF0aW9ucywgZWxzZSBpdCB3aWxsIGNyZWF0ZSBSQUYuXG4gICAqL1xuICB0aWNrOiBmdW5jdGlvbiAodCwgZHQpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5pc1BsYXlpbmcpIHsgcmV0dXJuOyB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJlYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgYmVhbSA9IHRoaXMuYmVhbXNbaV07XG4gICAgICAvLyBUaWUgYW5pbWF0aW9uIHN0YXRlIHRvIGJlYW0gdmlzaWJpbGl0eS5cbiAgICAgIGlmICghYmVhbS52aXNpYmxlKSB7IGNvbnRpbnVlOyB9XG4gICAgICBiZWFtLnRpbWUgKz0gZHQ7XG4gICAgICBiZWFtLmFuaW1hdGlvbi50aWNrKGJlYW0udGltZSk7XG4gICAgfVxuICB9LFxuXG4gIGNyZWF0ZUJlYW1Qb29sOiBmdW5jdGlvbiAoZ2VvbWV0cnksIG1hdGVyaWFsKSB7XG4gICAgY29uc3QgYmVhbXMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGF0YS5wb29sU2l6ZTsgaSsrKSB7XG4gICAgICBsZXQgYmVhbSA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7XG4gICAgICBiZWFtLnZpc2libGUgPSBmYWxzZTtcbiAgICAgIGJlYW0uYW5pbWF0aW9uID0gQU5JTUUoe1xuICAgICAgICBhdXRvcGxheTogZmFsc2UsXG4gICAgICAgIHRhcmdldHM6IGJlYW0uc2NhbGUsXG4gICAgICAgIHg6IDAuMDAwMDEsXG4gICAgICAgIGR1cmF0aW9uOiAzMDAsXG4gICAgICAgIGVhc2luZzogJ2Vhc2VJbkN1YmljJyxcbiAgICAgICAgY29tcGxldGU6ICgpID0+IHsgYmVhbS52aXNpYmxlID0gZmFsc2U7IH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5lbC5vYmplY3QzRC5hZGQoYmVhbSk7XG4gICAgICBiZWFtcy5wdXNoKGJlYW0pO1xuICAgICAgdGhpcy5iZWFtcy5wdXNoKGJlYW0pO1xuICAgIH1cbiAgICByZXR1cm4gYmVhbXM7XG4gIH0sXG5cbiAgbmV3QmVhbTogZnVuY3Rpb24gKGNvbG9yLCBwb3NpdGlvbikge1xuICAgIHZhciBiZWFtO1xuICAgIGlmIChjb2xvciA9PT0gJ3JlZCcpIHtcbiAgICAgIGJlYW0gPSB0aGlzLnJlZEJlYW1zW3RoaXMuY3VycmVudFJlZF07XG4gICAgICB0aGlzLmN1cnJlbnRSZWQgPSAodGhpcy5jdXJyZW50UmVkICsgMSkgJSB0aGlzLnJlZEJlYW1zLmxlbmd0aDtcbiAgICAgIC8vIHogb2Zmc2V0IHRvIGF2b2lkIHotZmlnaHRpbmcuXG4gICAgICBiZWFtLnBvc2l0aW9uLnNldChwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBwb3NpdGlvbi56ICsgdGhpcy5jdXJyZW50UmVkIC8gNTAuMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJlYW0gPSB0aGlzLmJsdWVCZWFtc1t0aGlzLmN1cnJlbnRCbHVlXTtcbiAgICAgIHRoaXMuY3VycmVudEJsdWUgPSAodGhpcy5jdXJyZW50Qmx1ZSArIDEpICUgdGhpcy5ibHVlQmVhbXMubGVuZ3RoO1xuICAgICAgYmVhbS5wb3NpdGlvbi5zZXQocG9zaXRpb24ueCwgcG9zaXRpb24ueSwgcG9zaXRpb24ueiArIHRoaXMuY3VycmVudEJsdWUgLyA1MC4wKTtcbiAgICB9XG5cbiAgICBiZWFtLnZpc2libGUgPSB0cnVlO1xuICAgIGJlYW0uc2NhbGUueCA9IDE7XG4gICAgYmVhbS50aW1lID0gMDtcbiAgfSxcblxuICBjbGVhckJlYW1zOiBmdW5jdGlvbiAoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJlYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmJlYW1zW2ldLnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHRoaXMuYmVhbXNbaV0udGltZSA9IDA7XG4gICAgICB0aGlzLmJlYW1zW2ldLnNjYWxlLnggPSAxO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9iZWFtcy5qcyIsInZhciBhdWRpb0NvbnRleHQgPSBuZXcgd2luZG93LkF1ZGlvQ29udGV4dCgpO1xudmFyIHNvdXJjZUNyZWF0ZWRDYWxsYmFjaztcblxuY29uc3QgTEFZRVJfQk9UVE9NID0gJ2JvdHRvbSc7XG5jb25zdCBMQVlFUl9NSURETEUgPSAnbWlkZGxlJztcbmNvbnN0IExBWUVSX1RPUCA9ICd0b3AnO1xuY29uc3QgVk9MVU1FID0gMC4yNTtcblxuLy8gQWxsb3dzIGZvciBtb2RpZnlpbmcgZGV0dW5lLiBQUiBoYXMgYmVlbiBzZW50IHRvIHRocmVlLmpzLlxuVEhSRUUuQXVkaW8ucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0aGlzLmlzUGxheWluZyA9PT0gdHJ1ZSkge1xuICAgIGNvbnNvbGUud2FybignVEhSRUUuQXVkaW86IEF1ZGlvIGlzIGFscmVhZHkgcGxheWluZy4nKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodGhpcy5oYXNQbGF5YmFja0NvbnRyb2wgPT09IGZhbHNlKSB7XG4gICAgY29uc29sZS53YXJuKCdUSFJFRS5BdWRpbzogdGhpcyBBdWRpbyBoYXMgbm8gcGxheWJhY2sgY29udHJvbC4nKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc291cmNlID0gdGhpcy5jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xuICBzb3VyY2UuYnVmZmVyID0gdGhpcy5idWZmZXI7XG4gIHNvdXJjZS5kZXR1bmUudmFsdWUgPSB0aGlzLmRldHVuZTtcbiAgc291cmNlLmxvb3AgPSB0aGlzLmxvb3A7XG4gIHNvdXJjZS5vbmVuZGVkID0gdGhpcy5vbkVuZGVkLmJpbmQodGhpcyk7XG4gIHNvdXJjZS5wbGF5YmFja1JhdGUuc2V0VmFsdWVBdFRpbWUodGhpcy5wbGF5YmFja1JhdGUsIHRoaXMuc3RhcnRUaW1lKTtcbiAgdGhpcy5zdGFydFRpbWUgPSB0aGlzLmNvbnRleHQuY3VycmVudFRpbWU7XG4gIGlmIChzb3VyY2VDcmVhdGVkQ2FsbGJhY2spIHsgc291cmNlQ3JlYXRlZENhbGxiYWNrKHNvdXJjZSk7IH1cbiAgc291cmNlLnN0YXJ0KHRoaXMuc3RhcnRUaW1lLCB0aGlzLm9mZnNldCk7XG5cbiAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xuXG4gIHRoaXMuc291cmNlID0gc291cmNlO1xuICByZXR1cm4gdGhpcy5jb25uZWN0KCk7XG59O1xuXG4vKipcbiAqIEJlYXQgaGl0IHNvdW5kIHVzaW5nIHBvc2l0aW9uYWwgYXVkaW8gYW5kIGF1ZGlvIGJ1ZmZlciBzb3VyY2UuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnYmVhdC1oaXQtc291bmQnLCB7XG4gIGRpcmVjdGlvbnNUb1NvdW5kczoge1xuICAgIHVwOiAnJyxcbiAgICBkb3duOiAnJyxcbiAgICB1cGxlZnQ6ICdsZWZ0JyxcbiAgICB1cHJpZ2h0OiAncmlnaHQnLFxuICAgIGRvd25sZWZ0OiAnbGVmdCcsXG4gICAgZG93bnJpZ2h0OiAncmlnaHQnLFxuICAgIGxlZnQ6ICdsZWZ0JyxcbiAgICByaWdodDogJ3JpZ2h0J1xuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmN1cnJlbnRCZWF0RWwgPSBudWxsO1xuICAgIHRoaXMuY3VycmVudEN1dERpcmVjdGlvbiA9ICcnO1xuICAgIHRoaXMucHJvY2Vzc1NvdW5kID0gdGhpcy5wcm9jZXNzU291bmQuYmluZCh0aGlzKTtcbiAgICBzb3VyY2VDcmVhdGVkQ2FsbGJhY2sgPSB0aGlzLnNvdXJjZUNyZWF0ZWRDYWxsYmFjay5iaW5kKHRoaXMpO1xuXG4gICAgLy8gU291bmQgcG9vbHMuXG4gICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gMTA7IGkrKykge1xuICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfWAsIHtcbiAgICAgICAgcG9vbFNpemU6IDQsXG4gICAgICAgIHNyYzogYCNoaXRTb3VuZCR7aX1gLFxuICAgICAgICB2b2x1bWU6IFZPTFVNRVxuICAgICAgfSk7XG4gICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZShgc291bmRfX2JlYXRoaXQke2l9bGVmdGAsIHtcbiAgICAgICAgcG9vbFNpemU6IDQsXG4gICAgICAgIHNyYzogYCNoaXRTb3VuZCR7aX1sZWZ0YCxcbiAgICAgICAgdm9sdW1lOiBWT0xVTUVcbiAgICAgIH0pO1xuICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfXJpZ2h0YCwge1xuICAgICAgICBwb29sU2l6ZTogNCxcbiAgICAgICAgc3JjOiBgI2hpdFNvdW5kJHtpfXJpZ2h0YCxcbiAgICAgICAgdm9sdW1lOiBWT0xVTUVcbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gS2ljayB0aHJlZS5qcyBsb2FkZXIuLi5Eb24ndCBrbm93IHdoeSBzb21ldGltZXMgZG9lc24ndCBsb2FkLlxuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcbiAgICAgIGlmICghdGhpcy5lbC5jb21wb25lbnRzW2Bzb3VuZF9fYmVhdGhpdCR7aX1gXS5sb2FkZWQpIHtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfWAsICdzcmMnLCAnJyk7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1gLCAnc3JjJywgYCNoaXRTb3VuZCR7aX1gKTtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5lbC5jb21wb25lbnRzW2Bzb3VuZF9fYmVhdGhpdCR7aX1sZWZ0YF0ubG9hZGVkKSB7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKGBzb3VuZF9fYmVhdGhpdCR7aX1sZWZ0YCwgJ3NyYycsICcnKTtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfWxlZnRgLCAnc3JjJywgYCNoaXRTb3VuZCR7aX1sZWZ0YCk7XG4gICAgICB9XG4gICAgICBpZiAoIXRoaXMuZWwuY29tcG9uZW50c1tgc291bmRfX2JlYXRoaXQke2l9cmlnaHRgXS5sb2FkZWQpIHtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfXJpZ2h0YCwgJ3NyYycsICcnKTtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoYHNvdW5kX19iZWF0aGl0JHtpfXJpZ2h0YCwgJ3NyYycsIGAjaGl0U291bmQke2l9cmlnaHRgKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgcGxheVNvdW5kOiBmdW5jdGlvbiAoYmVhdEVsLCBjdXREaXJlY3Rpb24pIHtcbiAgICBjb25zdCByYW5kID0gMSArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICBjb25zdCBkaXIgPSB0aGlzLmRpcmVjdGlvbnNUb1NvdW5kc1tjdXREaXJlY3Rpb24gfHwgJ3VwJ107XG4gICAgY29uc3Qgc291bmRQb29sID0gdGhpcy5lbC5jb21wb25lbnRzW2Bzb3VuZF9fYmVhdGhpdCR7cmFuZH0ke2Rpcn1gXTtcbiAgICB0aGlzLmN1cnJlbnRCZWF0RWwgPSBiZWF0RWw7XG4gICAgc291bmRQb29sLnBsYXlTb3VuZCh0aGlzLnByb2Nlc3NTb3VuZCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFNldCBhdWRpbyBzdHVmZiBiZWZvcmUgcGxheWluZy5cbiAgICovXG4gIHByb2Nlc3NTb3VuZDogZnVuY3Rpb24gKGF1ZGlvKSB7XG4gICAgYXVkaW8uZGV0dW5lID0gMDtcbiAgICB0aGlzLmN1cnJlbnRCZWF0RWwub2JqZWN0M0QuZ2V0V29ybGRQb3NpdGlvbihhdWRpby5wb3NpdGlvbik7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEZ1bmN0aW9uIGNhbGxiYWNrIHRvIHByb2Nlc3Mgc291cmNlIGJ1ZmZlciBvbmNlIGNyZWF0ZWQuXG4gICAqIFNldCBkZXR1bmUgZm9yIHBpdGNoIGFuZCBpbmZsZWN0aW9ucy5cbiAgICovXG4gIHNvdXJjZUNyZWF0ZWRDYWxsYmFjazogZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgIC8vIFBpdGNoIGJhc2VkIG9uIGxheWVyLlxuICAgIGNvbnN0IGxheWVyID0gdGhpcy5nZXRMYXllcih0aGlzLmN1cnJlbnRCZWF0RWwub2JqZWN0M0QucG9zaXRpb24ueSk7XG4gICAgaWYgKGxheWVyID09PSBMQVlFUl9CT1RUT00pIHtcbiAgICAgIHNvdXJjZS5kZXR1bmUuc2V0VmFsdWVBdFRpbWUoLTQwMCwgMCk7XG4gICAgfSBlbHNlIGlmIChsYXllciA9PT0gTEFZRVJfVE9QKSB7XG4gICAgICBzb3VyY2UuZGV0dW5lLnNldFZhbHVlQXRUaW1lKDIwMCwgMCk7XG4gICAgfVxuXG4gICAgLy8gSW5mbGVjdGlvbiBvbiBzdHJpa2UgZG93biBvciB1cC5cbiAgICBpZiAodGhpcy5jdXJyZW50Q3V0RGlyZWN0aW9uID09PSAnZG93bicpIHtcbiAgICAgIHNvdXJjZS5kZXR1bmUubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoLTQwMCwgMSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmN1cnJlbnRDdXREaXJlY3Rpb24gPT09ICd1cCcpIHtcbiAgICAgIHNvdXJjZS5kZXR1bmUubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoNDAwLCAxKTtcbiAgICB9XG5cdH0sXG5cbiAgLyoqXG4gICAqIEdldCB3aGV0aGVyIGJlYXQgaXMgb24gYm90dG9tLCBtaWRkbGUsIG9yIHRvcCBsYXllci5cbiAgICovXG4gIGdldExheWVyOiBmdW5jdGlvbiAoeSkge1xuICAgIGlmICh5ID09PSAxKSB7IHJldHVybiBMQVlFUl9CT1RUT007IH1cbiAgICBpZiAoeSA9PT0gMS43MCkgeyByZXR1cm4gTEFZRVJfVE9QOyB9XG4gICAgcmV0dXJuIExBWUVSX01JRERMRTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9iZWF0LWhpdC1zb3VuZC5qcyIsImltcG9ydCB7QkVBVF9XQVJNVVBfT0ZGU0VULCBCRUFUX1dBUk1VUF9TUEVFRCwgQkVBVF9XQVJNVVBfVElNRX0gZnJvbSAnLi4vY29uc3RhbnRzL2JlYXQnO1xuaW1wb3J0IHV0aWxzIGZyb20gJy4uL3V0aWxzJztcblxubGV0IHNraXBEZWJ1ZyA9IEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ3NraXAnKSB8fCAwO1xuc2tpcERlYnVnID0gcGFyc2VJbnQoc2tpcERlYnVnLCAxMCk7XG5cbi8qKlxuICogTG9hZCBiZWF0IGRhdGEgKGFsbCB0aGUgYmVhdHMgYW5kIHN1Y2gpLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2JlYXQtbG9hZGVyJywge1xuICBkZXBlbmRlbmNpZXM6IFsnc3RhZ2UtY29sb3JzJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYmVhdEFudGljaXBhdGlvblRpbWU6IHtkZWZhdWx0OiAxLjF9LFxuICAgIGJlYXRTcGVlZDoge2RlZmF1bHQ6IDguMH0sXG4gICAgYmVhdFdhcm11cFRpbWU6IHtkZWZhdWx0OiBCRUFUX1dBUk1VUF9USU1FIC8gMTAwMH0sXG4gICAgYmVhdFdhcm11cFNwZWVkOiB7ZGVmYXVsdDogQkVBVF9XQVJNVVBfU1BFRUR9LFxuICAgIGNoYWxsZW5nZUlkOiB7dHlwZTogJ3N0cmluZyd9LCAgLy8gSWYgY2xpY2tlZCBwbGF5LlxuICAgIGRpZmZpY3VsdHk6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgaXNQbGF5aW5nOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIG1lbnVTZWxlY3RlZENoYWxsZW5nZUlkOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgb3JpZW50YXRpb25zSHVtYW5pemVkOiBbXG4gICAgJ3VwJyxcbiAgICAnZG93bicsXG4gICAgJ2xlZnQnLFxuICAgICdyaWdodCcsXG4gICAgJ3VwbGVmdCcsXG4gICAgJ3VwcmlnaHQnLFxuICAgICdkb3dubGVmdCcsXG4gICAgJ2Rvd25yaWdodCdcbiAgXSxcblxuICBob3Jpem9udGFsUG9zaXRpb25zOiBbLTAuNzUsIC0wLjI1LCAwLjI1LCAwLjc1XSxcblxuICBob3Jpem9udGFsUG9zaXRpb25zSHVtYW5pemVkOiB7XG4gICAgMDogJ2xlZnQnLFxuICAgIDE6ICdtaWRkbGVsZWZ0JyxcbiAgICAyOiAnbWlkZGxlcmlnaHQnLFxuICAgIDM6ICdyaWdodCdcbiAgfSxcblxuICBwb3NpdGlvbkh1bWFuaXplZDoge1xuICAgIHRvcExlZnQ6IHtsYXllcjogMiwgaW5kZXg6IDB9LFxuICAgIHRvcENlbnRlckxlZnQ6IHtsYXllcjogMiwgaW5kZXg6IDF9LFxuICAgIHRvcENlbnRlclJpZ2h0OiB7bGF5ZXI6IDIsIGluZGV4OiAyfSxcbiAgICB0b3BSaWdodDoge2xheWVyOiAyLCBpbmRleDogM30sXG5cbiAgICBtaWRkbGVMZWZ0OiB7bGF5ZXI6IDEsIGluZGV4OiAwfSxcbiAgICBtaWRkbGVDZW50ZXJMZWZ0OiB7bGF5ZXI6IDEsIGluZGV4OiAxfSxcbiAgICBtaWRkbGVDZW50ZXJSaWdodDoge2xheWVyOiAxLCBpbmRleDogMn0sXG4gICAgbWlkZGxlUmlnaHQ6IHtsYXllcjogMSwgaW5kZXg6IDN9LFxuXG4gICAgYm90dG9tTGVmdDoge2xheWVyOiAwLCBpbmRleDogMH0sXG4gICAgYm90dG9tQ2VudGVyTGVmdDoge2xheWVyOiAwLCBpbmRleDogMX0sXG4gICAgYm90dG9tQ2VudGVyUmlnaHQ6IHtsYXllcjogMCwgaW5kZXg6IDJ9LFxuICAgIGJvdHRvbVJpZ2h0OiB7bGF5ZXI6IDAsIGluZGV4OiAzfSxcbiAgfSxcblxuICB2ZXJ0aWNhbFBvc2l0aW9uc0h1bWFuaXplZDoge1xuICAgIDA6ICdib3R0b20nLFxuICAgIDE6ICdtaWRkbGUnLFxuICAgIDI6ICd0b3AnXG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYXVkaW9BbmFseXNlckVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F1ZGlvYW5hbHlzZXInKTtcbiAgICB0aGlzLmJlYXREYXRhID0gbnVsbDtcbiAgICB0aGlzLmJlYXREYXRhUHJvY2Vzc2VkID0gZmFsc2U7XG4gICAgdGhpcy5iZWF0Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JlYXRDb250YWluZXInKTtcbiAgICB0aGlzLmJlYXRzVGltZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmJlYXRzUHJlbG9hZFRpbWUgPSAwO1xuICAgIHRoaXMuYmVhdHNQcmVsb2FkVGltZVRvdGFsID1cbiAgICAgICh0aGlzLmRhdGEuYmVhdEFudGljaXBhdGlvblRpbWUgKyB0aGlzLmRhdGEuYmVhdFdhcm11cFRpbWUpICogMTAwMDtcbiAgICB0aGlzLmJwbSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnhociA9IG51bGw7XG4gICAgdGhpcy5zdGFnZUNvbG9ycyA9IHRoaXMuZWwuY29tcG9uZW50c1snc3RhZ2UtY29sb3JzJ107XG4gICAgLy8gQmVhdHMgYXJyaXZlIGF0IHN3b3JkIHN0cm9rZSBkaXN0YW5jZSBzeW5jZWQgd2l0aCB0aGUgbXVzaWMuXG4gICAgdGhpcy5zd29yZE9mZnNldCA9IDEuNTtcbiAgICB0aGlzLnR3aXN0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHdpc3RlcicpO1xuICAgIHRoaXMubGVmdFN0YWdlTGFzZXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xlZnRTdGFnZUxhc2VycycpO1xuICAgIHRoaXMucmlnaHRTdGFnZUxhc2VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaWdodFN0YWdlTGFzZXJzJyk7XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsZWFyZ2FtZScsIHRoaXMuY2xlYXJCZWF0cy5iaW5kKHRoaXMpKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIC8vIFN0YXJ0IHBsYXlpbmcuXG4gICAgaWYgKCFvbGREYXRhLmNoYWxsZW5nZUlkICYmIGRhdGEuY2hhbGxlbmdlSWQgJiYgdGhpcy5iZWF0RGF0YSkge1xuICAgICAgdGhpcy5wcm9jZXNzQmVhdHMoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgfHwgIWRhdGEuZGlmZmljdWx0eSkgeyByZXR1cm47IH1cblxuICAgIC8vIFByZWZldGNoIGJlYXRzLlxuICAgIGlmIChkYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkICE9PSBvbGREYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkIHx8XG4gICAgICAgIGRhdGEuZGlmZmljdWx0eSAhPT0gb2xkRGF0YS5kaWZmaWN1bHR5KSB7XG4gICAgICB0aGlzLmZldGNoQmVhdHMoKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFhIUi4gQmVhdCBkYXRhIGlzIHByZWZldGNoZWQgd2hlbiB1c2VyIHNlbGVjdHMgYSBtZW51IGNoYWxsZW5nZSwgYW5kIHN0b3JlZCBhd2F5XG4gICAqIHRvIGJlIHByb2Nlc3NlZCBsYXRlci5cbiAgICovXG4gIGZldGNoQmVhdHM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuXG4gICAgaWYgKHRoaXMueGhyKSB7IHRoaXMueGhyLmFib3J0KCk7IH1cblxuICAgIC8vIExvYWQgYmVhdHMuXG4gICAgbGV0IHVybCA9IHV0aWxzLmdldFMzRmlsZVVybCh0aGlzLmRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgJHt0aGlzLmRhdGEuZGlmZmljdWx0eX0uanNvbmApO1xuICAgIGNvbnN0IHhociA9IHRoaXMueGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgZWwuZW1pdCgnYmVhdGxvYWRlcnN0YXJ0Jyk7XG4gICAgY29uc29sZS5sb2coYFtiZWF0LWxvYWRlcl0gRmV0Y2hpbmcgJHt1cmx9Li4uYCk7XG4gICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG4gICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICB0aGlzLmJlYXREYXRhID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgIHRoaXMuYmVhdERhdGFQcm9jZXNzZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMueGhyID0gbnVsbDtcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdiZWF0bG9hZGVyZmluaXNoJywgbnVsbCwgZmFsc2UpO1xuICAgIH0pO1xuICAgIHhoci5zZW5kKCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIExvYWQgdGhlIGJlYXQgZGF0YSBpbnRvIHRoZSBnYW1lLlxuICAgKi9cbiAgcHJvY2Vzc0JlYXRzOiBmdW5jdGlvbiAoKSB7XG4gICAgLy8gUmVzZXQgdmFyaWFibGVzIHVzZWQgZHVyaW5nIHBsYXliYWNrLlxuICAgIC8vIEJlYXRzIHNwYXduIGFoZWFkIG9mIHRoZSBzb25nIGFuZCBnZXQgdG8gdGhlIHVzZXIgaW4gc3luYyB3aXRoIHRoZSBtdXNpYy5cbiAgICB0aGlzLmJlYXRzVGltZSA9IDA7XG4gICAgdGhpcy5iZWF0c1ByZWxvYWRUaW1lID0gMDtcbiAgICB0aGlzLmJlYXREYXRhLl9ldmVudHMuc29ydChsZXNzVGhhbik7XG4gICAgdGhpcy5iZWF0RGF0YS5fb2JzdGFjbGVzLnNvcnQobGVzc1RoYW4pO1xuICAgIHRoaXMuYmVhdERhdGEuX25vdGVzLnNvcnQobGVzc1RoYW4pO1xuICAgIHRoaXMuYnBtID0gdGhpcy5iZWF0RGF0YS5fYmVhdHNQZXJNaW51dGU7XG5cbiAgICAvLyBTb21lIGV2ZW50cyBoYXZlIG5lZ2F0aXZlIHRpbWUgc3RhbXAgdG8gaW5pdGlhbGl6ZSB0aGUgc3RhZ2UuXG4gICAgY29uc3QgZXZlbnRzID0gdGhpcy5iZWF0RGF0YS5fZXZlbnRzO1xuICAgIGlmIChldmVudHMubGVuZ3RoICYmIGV2ZW50c1swXS5fdGltZSA8IDApIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBldmVudHNbaV0uX3RpbWUgPCAwOyBpKyspIHtcbiAgICAgICAgdGhpcy5nZW5lcmF0ZUV2ZW50KGV2ZW50c1tpXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5iZWF0RGF0YVByb2Nlc3NlZCA9IHRydWU7XG4gICAgY29uc29sZS5sb2coJ1tiZWF0LWxvYWRlcl0gRmluaXNoZWQgcHJvY2Vzc2luZyBiZWF0IGRhdGEuJyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGJlYXRzIGFuZCBzdHVmZiBhY2NvcmRpbmcgdG8gdGltZXN0YW1wLlxuICAgKi9cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuaXNQbGF5aW5nIHx8ICF0aGlzLmRhdGEuY2hhbGxlbmdlSWQgfHwgIXRoaXMuYmVhdERhdGEpIHsgcmV0dXJuOyB9XG5cbiAgICBjb25zdCBwcmV2QmVhdHNUaW1lID0gdGhpcy5iZWF0c1RpbWUgKyBza2lwRGVidWc7XG4gICAgaWYgKHRoaXMuYmVhdHNQcmVsb2FkVGltZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBHZXQgY3VycmVudCBzb25nIHRpbWUuXG4gICAgICBjb25zdCBzb25nID0gdGhpcy5lbC5jb21wb25lbnRzLnNvbmc7XG4gICAgICBpZiAoIXNvbmcuaXNQbGF5aW5nKSB7IHJldHVybjsgfVxuICAgICAgdGhpcy5iZWF0c1RpbWUgPSAoc29uZy5nZXRDdXJyZW50VGltZSgpICsgdGhpcy5kYXRhLmJlYXRBbnRpY2lwYXRpb25UaW1lICtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5iZWF0V2FybXVwVGltZSkgKiAxMDAwO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTb25nIGlzIG5vdCBwbGF5aW5nIGFuZCBpcyBwcmVsb2FkaW5nIGJlYXRzLCB1c2UgbWFpbnRhaW5lZCBiZWF0IHRpbWUuXG4gICAgICB0aGlzLmJlYXRzVGltZSA9IHRoaXMuYmVhdHNQcmVsb2FkVGltZTtcbiAgICB9XG5cbiAgICAvLyBMb2FkIGluIHN0dWZmIHNjaGVkdWxlZCBiZXR3ZWVuIHRoZSBsYXN0IHRpbWVzdGFtcCBhbmQgY3VycmVudCB0aW1lc3RhbXAuXG4gICAgLy8gQmVhdHMuXG4gICAgY29uc3QgYmVhdHNUaW1lID0gdGhpcy5iZWF0c1RpbWUgKyBza2lwRGVidWc7XG4gICAgY29uc3QgYnBtID0gdGhpcy5iZWF0RGF0YS5fYmVhdHNQZXJNaW51dGU7XG4gICAgY29uc3QgbXNQZXJCZWF0ID0gMTAwMCAqIDYwIC8gdGhpcy5iZWF0RGF0YS5fYmVhdHNQZXJNaW51dGU7XG4gICAgY29uc3Qgbm90ZXMgPSB0aGlzLmJlYXREYXRhLl9ub3RlcztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vdGVzLmxlbmd0aDsgKytpKSB7XG4gICAgICBsZXQgbm90ZVRpbWUgPSBub3Rlc1tpXS5fdGltZSAqIG1zUGVyQmVhdDtcbiAgICAgIGlmIChub3RlVGltZSA+IHByZXZCZWF0c1RpbWUgJiYgbm90ZVRpbWUgPD0gYmVhdHNUaW1lKSB7XG4gICAgICAgIG5vdGVzW2ldLnRpbWUgPSBub3RlVGltZTtcbiAgICAgICAgdGhpcy5nZW5lcmF0ZUJlYXQobm90ZXNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFdhbGxzLlxuICAgIGNvbnN0IG9ic3RhY2xlcyA9IHRoaXMuYmVhdERhdGEuX29ic3RhY2xlcztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9ic3RhY2xlcy5sZW5ndGg7ICsraSkge1xuICAgICAgbGV0IG5vdGVUaW1lID0gb2JzdGFjbGVzW2ldLl90aW1lICogbXNQZXJCZWF0O1xuICAgICAgaWYgKG5vdGVUaW1lID4gcHJldkJlYXRzVGltZSAmJiBub3RlVGltZSA8PSBiZWF0c1RpbWUpIHtcbiAgICAgICAgdGhpcy5nZW5lcmF0ZVdhbGwob2JzdGFjbGVzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTdGFnZSBldmVudHMuXG4gICAgY29uc3QgZXZlbnRzID0gdGhpcy5iZWF0RGF0YS5fZXZlbnRzO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgKytpKSB7XG4gICAgICBsZXQgbm90ZVRpbWUgPSBldmVudHNbaV0uX3RpbWUgKiBtc1BlckJlYXQ7XG4gICAgICBpZiAobm90ZVRpbWUgPiBwcmV2QmVhdHNUaW1lICYmIG5vdGVUaW1lIDw9IGJlYXRzVGltZSkge1xuICAgICAgICB0aGlzLmdlbmVyYXRlRXZlbnQoZXZlbnRzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5iZWF0c1ByZWxvYWRUaW1lID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9XG5cbiAgICBpZiAodGhpcy5iZWF0c1ByZWxvYWRUaW1lID49IHRoaXMuYmVhdHNQcmVsb2FkVGltZVRvdGFsKSB7XG4gICAgICAvLyBGaW5pc2hlZCBwcmVsb2FkLlxuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ2JlYXRsb2FkZXJwcmVsb2FkZmluaXNoJywgbnVsbCwgZmFsc2UpO1xuICAgICAgdGhpcy5iZWF0c1ByZWxvYWRUaW1lID0gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDb250aW51ZSBwcmVsb2FkLlxuICAgICAgdGhpcy5iZWF0c1ByZWxvYWRUaW1lICs9IGRlbHRhO1xuICAgIH1cbiAgfSxcblxuICBnZW5lcmF0ZUJlYXQ6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgYmVhdE9iaiA9IHt9O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChub3RlSW5mbykge1xuICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgICAgLy8gaWYgKE1hdGgucmFuZG9tKCkgPCAwLjgpIHsgbm90ZUluZm8uX3R5cGUgPSAzOyB9IC8vIFRvIGRlYnVnIG1pbmVzLlxuICAgICAgbGV0IGNvbG9yO1xuICAgICAgbGV0IHR5cGUgPSBub3RlSW5mby5fY3V0RGlyZWN0aW9uID09PSA4ID8gJ2RvdCcgOiAnYXJyb3cnO1xuICAgICAgaWYgKG5vdGVJbmZvLl90eXBlID09PSAwKSB7XG4gICAgICAgIGNvbG9yID0gJ3JlZCc7XG4gICAgICB9IGVsc2UgaWYgKG5vdGVJbmZvLl90eXBlID09PSAxKSB7XG4gICAgICAgIGNvbG9yID0gJ2JsdWUnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHlwZSA9ICdtaW5lJztcbiAgICAgICAgY29sb3IgPSB1bmRlZmluZWQ7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGJlYXRFbCA9IHRoaXMucmVxdWVzdEJlYXQodHlwZSwgY29sb3IpO1xuICAgICAgaWYgKCFiZWF0RWwpIHsgcmV0dXJuOyB9XG5cbiAgICAgIC8vIEFwcGx5IHN3b3JkIG9mZnNldC4gQmxvY2tzIGFycml2ZSBvbiBiZWF0IGluIGZyb250IG9mIHRoZSB1c2VyLlxuICAgICAgYmVhdE9iai5hbnRpY2lwYXRpb25Qb3NpdGlvbiA9IC1kYXRhLmJlYXRBbnRpY2lwYXRpb25UaW1lICogZGF0YS5iZWF0U3BlZWQgLSB0aGlzLnN3b3JkT2Zmc2V0O1xuICAgICAgYmVhdE9iai5jb2xvciA9IGNvbG9yO1xuICAgICAgYmVhdE9iai5jdXREaXJlY3Rpb24gPSB0aGlzLm9yaWVudGF0aW9uc0h1bWFuaXplZFtub3RlSW5mby5fY3V0RGlyZWN0aW9uXTtcbiAgICAgIGJlYXRPYmouaG9yaXpvbnRhbFBvc2l0aW9uID0gdGhpcy5ob3Jpem9udGFsUG9zaXRpb25zSHVtYW5pemVkW25vdGVJbmZvLl9saW5lSW5kZXhdO1xuICAgICAgYmVhdE9iai5zcGVlZCA9IHRoaXMuZGF0YS5iZWF0U3BlZWQ7XG4gICAgICBiZWF0T2JqLnR5cGUgPSB0eXBlO1xuICAgICAgYmVhdE9iai52ZXJ0aWNhbFBvc2l0aW9uID0gdGhpcy52ZXJ0aWNhbFBvc2l0aW9uc0h1bWFuaXplZFtub3RlSW5mby5fbGluZUxheWVyXSxcbiAgICAgIGJlYXRPYmoud2FybXVwUG9zaXRpb24gPSAtZGF0YS5iZWF0V2FybXVwVGltZSAqIGRhdGEuYmVhdFdhcm11cFNwZWVkO1xuICAgICAgYmVhdEVsLnNldEF0dHJpYnV0ZSgnYmVhdCcsIGJlYXRPYmopO1xuICAgICAgYmVhdEVsLmNvbXBvbmVudHMuYmVhdC51cGRhdGVQb3NpdGlvbigpO1xuXG4gICAgICBiZWF0RWwucGxheSgpO1xuICAgICAgYmVhdEVsLmNvbXBvbmVudHMuYmVhdC5vbkdlbmVyYXRlKCk7XG4gICAgfTtcbiAgfSkoKSxcblxuICBnZW5lcmF0ZVdhbGw6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qgd2FsbE9iaiA9IHt9O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh3YWxsSW5mbykge1xuICAgICAgY29uc3QgZWwgPSB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50cy5wb29sX193YWxsLnJlcXVlc3RFbnRpdHkoKTtcblxuICAgICAgaWYgKCFlbCkgeyByZXR1cm47IH1cblxuICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICAgIGNvbnN0IHNwZWVkID0gdGhpcy5kYXRhLmJlYXRTcGVlZDtcblxuICAgICAgY29uc3QgZHVyYXRpb25TZWNvbmRzID0gNjAgKiAod2FsbEluZm8uX2R1cmF0aW9uIC8gdGhpcy5icG0pO1xuICAgICAgd2FsbE9iai5hbnRpY2lwYXRpb25Qb3NpdGlvbiA9XG4gICAgICAgIC1kYXRhLmJlYXRBbnRpY2lwYXRpb25UaW1lICogZGF0YS5iZWF0U3BlZWQgLSB0aGlzLnN3b3JkT2Zmc2V0O1xuICAgICAgd2FsbE9iai5kdXJhdGlvblNlY29uZHMgPSBkdXJhdGlvblNlY29uZHM7XG4gICAgICB3YWxsT2JqLmhvcml6b250YWxQb3NpdGlvbiA9IHRoaXMuaG9yaXpvbnRhbFBvc2l0aW9uc0h1bWFuaXplZFt3YWxsSW5mby5fbGluZUluZGV4XTtcbiAgICAgIHdhbGxPYmouaXNDZWlsaW5nID0gd2FsbEluZm8uX3R5cGUgPT09IDE7XG4gICAgICB3YWxsT2JqLnNwZWVkID0gc3BlZWQ7XG4gICAgICB3YWxsT2JqLndhcm11cFBvc2l0aW9uID0gLWRhdGEuYmVhdFdhcm11cFRpbWUgKiBkYXRhLmJlYXRXYXJtdXBTcGVlZDtcbiAgICAgIHdhbGxPYmoud2lkdGggPSB3YWxsSW5mby5fd2lkdGg7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3dhbGwnLCB3YWxsT2JqKTtcbiAgICAgIGVsLnBsYXkoKTtcbiAgICB9O1xuICB9KSgpLFxuXG4gIGdlbmVyYXRlRXZlbnQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgIHN3aXRjaChldmVudC5fdHlwZSkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICB0aGlzLnN0YWdlQ29sb3JzLnNldENvbG9yKCdiZycsIGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxOlxuICAgICAgICB0aGlzLnN0YWdlQ29sb3JzLnNldENvbG9yKCd0dW5uZWwnLCBldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgdGhpcy5zdGFnZUNvbG9ycy5zZXRDb2xvcignbGVmdGxhc2VyJywgZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDM6XG4gICAgICAgIHRoaXMuc3RhZ2VDb2xvcnMuc2V0Q29sb3IoJ3JpZ2h0bGFzZXInLCBldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgNDpcbiAgICAgICAgdGhpcy5zdGFnZUNvbG9ycy5zZXRDb2xvcignZmxvb3InLCBldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgODpcbiAgICAgICAgdGhpcy50d2lzdGVyLmNvbXBvbmVudHMudHdpc3Rlci5wdWxzZShldmVudC5fdmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgOTpcbiAgICAgICAgLy8gem9vbSB3YXMgYSBiaXQgZGlzdHVyYmluZ1xuICAgICAgICB0aGlzLnR3aXN0ZXIuY29tcG9uZW50cy50d2lzdGVyLnB1bHNlKGV2ZW50Ll92YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxMjpcbiAgICAgICAgdGhpcy5sZWZ0U3RhZ2VMYXNlcnMuY29tcG9uZW50c1snc3RhZ2UtbGFzZXJzJ10ucHVsc2UoZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDEzOlxuICAgICAgICB0aGlzLnJpZ2h0U3RhZ2VMYXNlcnMuY29tcG9uZW50c1snc3RhZ2UtbGFzZXJzJ10ucHVsc2UoZXZlbnQuX3ZhbHVlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9LFxuXG4gIHJlcXVlc3RCZWF0OiBmdW5jdGlvbiAodHlwZSwgY29sb3IpIHtcbiAgICB2YXIgYmVhdFBvb2xOYW1lID0gJ3Bvb2xfX2JlYXQtJyArIHR5cGU7XG4gICAgdmFyIHBvb2w7XG4gICAgaWYgKGNvbG9yKSB7IGJlYXRQb29sTmFtZSArPSAnLScgKyBjb2xvcjsgfVxuICAgIHBvb2wgPSB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50c1tiZWF0UG9vbE5hbWVdO1xuICAgIGlmICghcG9vbCkge1xuICAgICAgY29uc29sZS53YXJuKCdQb29sICcgKyBiZWF0UG9vbE5hbWUgKyAnIHVuYXZhaWxhYmxlJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiBwb29sLnJlcXVlc3RFbnRpdHkoKTtcbiAgfSxcblxuICAvKipcbiAgICogUmVzdGFydCBieSByZXR1cm5pbmcgYWxsIGJlYXRzIHRvIHBvb2wuXG4gICAqL1xuICBjbGVhckJlYXRzOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5iZWF0c1ByZWxvYWRUaW1lID0gMDtcbiAgICB0aGlzLmJlYXRzVGltZSA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJlYXRDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBjaGlsZCA9IHRoaXMuYmVhdENvbnRhaW5lci5jaGlsZHJlbltpXTtcbiAgICAgIGlmIChjaGlsZC5jb21wb25lbnRzLmJlYXQpIHtcbiAgICAgICAgY2hpbGQuY29tcG9uZW50cy5iZWF0LnJldHVyblRvUG9vbCh0cnVlKTtcbiAgICAgIH1cbiAgICAgIGlmIChjaGlsZC5jb21wb25lbnRzLndhbGwpIHtcbiAgICAgICAgY2hpbGQuY29tcG9uZW50cy53YWxsLnJldHVyblRvUG9vbCh0cnVlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG59KTtcblxuZnVuY3Rpb24gbGVzc1RoYW4gKGEsIGIpIHsgcmV0dXJuIGEuX3RpbWUgLSBiLl90aW1lOyB9XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9iZWF0LWxvYWRlci5qcyIsImltcG9ydCB7QkVBVF9XQVJNVVBfT0ZGU0VULCBCRUFUX1dBUk1VUF9TUEVFRCwgQkVBVF9XQVJNVVBfVElNRX0gZnJvbSAnLi4vY29uc3RhbnRzL2JlYXQnO1xuY29uc3QgQ09MT1JTID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzL2NvbG9ycy5qcycpO1xuXG5jb25zdCBhdXhPYmozRCA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuY29uc3QgY29sbGlzaW9uWlRocmVzaG9sZCA9IC0xLjY1O1xuY29uc3QgQkVBVF9XQVJNVVBfUk9UQVRJT05fQ0hBTkdFID0gTWF0aC5QSSAvIDU7XG5jb25zdCBCRUFUX1dBUk1VUF9ST1RBVElPTl9PRkZTRVQgPSAwLjQ7XG5jb25zdCBCRUFUX1dBUk1VUF9ST1RBVElPTl9USU1FID0gNzUwO1xuY29uc3QgREVTVFJPWUVEX1NQRUVEID0gMS4wO1xuY29uc3QgT05DRSA9IHtvbmNlOiB0cnVlfTtcblxuY29uc3QgU0NPUkVfUE9PTCA9IHtcbiAgT0sgOiAncG9vbF9fYmVhdHNjb3Jlb2snLFxuICBHT09EIDogJ3Bvb2xfX2JlYXRzY29yZWdvb2QnLFxuICBHUkVBVCA6ICdwb29sX19iZWF0c2NvcmVncmVhdCcsXG4gIFNVUEVSIDogJ3Bvb2xfX2JlYXRzY29yZXN1cGVyJ1xufTtcblxuLyoqXG4gKiBCZWFycywgYmVhdHMsIEJhdHRsZXN0YXIgR2FsYWN0aWNhLlxuICogQ3JlYXRlIGJlYXQgZnJvbSBwb29sLCBjb2xsaXNpb24gZGV0ZWN0aW9uLCBjbGlwcGluZyBwbGFuZXMsIG1vdmVtZW50LCBzY29yaW5nLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2JlYXQnLCB7XG4gIHNjaGVtYToge1xuICAgIGFudGljaXBhdGlvblBvc2l0aW9uOiB7ZGVmYXVsdDogMH0sXG4gICAgY29sb3I6IHtkZWZhdWx0OiAncmVkJywgb25lT2Y6IFsncmVkJywgJ2JsdWUnXX0sXG4gICAgY3V0RGlyZWN0aW9uOiB7ZGVmYXVsdDogJ2Rvd24nfSxcbiAgICBkZWJ1Zzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBob3Jpem9udGFsUG9zaXRpb246IHtkZWZhdWx0OiAnbWlkZGxlbGVmdCcsIG9uZU9mOiBbJ2xlZnQnLCAnbWlkZGxlbGVmdCcsICdtaWRkbGVyaWdodCcsICdyaWdodCddfSxcbiAgICBzaXplOiB7ZGVmYXVsdDogMC40MH0sXG4gICAgc3BlZWQ6IHtkZWZhdWx0OiA4LjB9LFxuICAgIHR5cGU6IHtkZWZhdWx0OiAnYXJyb3cnLCBvbmVPZjogWydhcnJvdycsICdkb3QnLCAnbWluZSddfSxcbiAgICB2ZXJ0aWNhbFBvc2l0aW9uOiB7ZGVmYXVsdDogJ21pZGRsZScsIG9uZU9mOiBbJ2JvdHRvbScsICdtaWRkbGUnLCAndG9wJ119LFxuICAgIHdhcm11cFBvc2l0aW9uOiB7ZGVmYXVsdDogMH0sXG4gIH0sXG5cbiAgbWF0ZXJpYWxDb2xvcjoge1xuICAgIGJsdWU6IENPTE9SUy5CRUFUX0JMVUUsXG4gICAgcmVkOiBDT0xPUlMuQkVBVF9SRURcbiAgfSxcblxuICBjdXRDb2xvcjoge1xuICAgIGJsdWU6ICcjZmZmJyxcbiAgICByZWQ6ICcjZmZmJ1xuICB9LFxuXG4gIG1vZGVsczoge1xuICAgIGFycm93OiAnYmVhdE9ialRlbXBsYXRlJyxcbiAgICBkb3Q6ICdiZWF0T2JqVGVtcGxhdGUnLFxuICAgIG1pbmU6ICdtaW5lT2JqVGVtcGxhdGUnXG4gIH0sXG5cbiAgc2lnbk1vZGVsczoge1xuICAgIGFycm93cmVkOiAnYXJyb3dSZWRPYmpUZW1wbGF0ZScsXG4gICAgYXJyb3dibHVlOiAnYXJyb3dCbHVlT2JqVGVtcGxhdGUnLFxuICAgIGRvdHJlZDogJ2RvdFJlZE9ialRlbXBsYXRlJyxcbiAgICBkb3RibHVlOiAnZG90Qmx1ZU9ialRlbXBsYXRlJ1xuICB9LFxuXG4gIG9yaWVudGF0aW9uczogWzE4MCwgMCwgMjcwLCA5MCwgMjI1LCAxMzUsIDMxNSwgNDUsIDBdLFxuXG4gIHJvdGF0aW9uczoge1xuICAgIHVwOiAxODAsXG4gICAgZG93bjogMCxcbiAgICBsZWZ0OiAyNzAsXG4gICAgcmlnaHQ6IDkwLFxuICAgIHVwbGVmdDogMjI1LFxuICAgIHVwcmlnaHQ6IDEzNSxcbiAgICBkb3dubGVmdDogMzE1LFxuICAgIGRvd25yaWdodDogNDVcbiAgfSxcblxuICBob3Jpem9udGFsUG9zaXRpb25zOiB7XG4gICAgbGVmdDogLTAuNzUsXG4gICAgbWlkZGxlbGVmdDogLTAuMjUsXG4gICAgbWlkZGxlcmlnaHQ6IDAuMjUsXG4gICAgcmlnaHQ6IDAuNzVcbiAgfSxcblxuICB2ZXJ0aWNhbFBvc2l0aW9uczoge1xuICAgIGJvdHRvbTogMC43MCxcbiAgICBtaWRkbGU6IDEuMjAsXG4gICAgdG9wOiAxLjcwXG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmFja1RvUG9vbCA9IGZhbHNlO1xuICAgIHRoaXMuYmVhbXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmVhbXMnKS5jb21wb25lbnRzLmJlYW1zO1xuICAgIHRoaXMuYmVhdEJvdW5kaW5nQm94ID0gbmV3IFRIUkVFLkJveDMoKTtcbiAgICB0aGlzLmN1cnJlbnRSb3RhdGlvbldhcm11cFRpbWUgPSAwO1xuICAgIHRoaXMuY3V0RGlyZWN0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xuICAgIHRoaXMuZ3Jhdml0eVZlbG9jaXR5ID0gMDtcbiAgICB0aGlzLmhpdEV2ZW50RGV0YWlsID0ge307XG4gICAgdGhpcy5oaXRCb3VuZGluZ0JveCA9IG5ldyBUSFJFRS5Cb3gzKCk7XG4gICAgdGhpcy5wb29sTmFtZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnJldHVyblRvUG9vbFRpbWVyID0gODAwO1xuICAgIHRoaXMucm90YXRpb25BeGlzID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLnNhYmVyRWxzID0gdGhpcy5lbC5zY2VuZUVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tzYWJlci1jb250cm9sc10nKTtcbiAgICB0aGlzLnNjb3JlRWwgPSBudWxsO1xuICAgIHRoaXMuc2NvcmVFbFRpbWUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zdGFydFBvc2l0aW9uWiA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHMgPSBbXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKClcbiAgICBdO1xuICAgIHRoaXMubGVmdEN1dFBsYW5lUG9pbnRzID0gW1xuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpXG4gICAgXTtcblxuICAgIHRoaXMubWluZVBhcnRpY2xlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaW5lUGFydGljbGVzJyk7XG4gICAgdGhpcy53cm9uZ0VsTGVmdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cm9uZ0xlZnQnKTtcbiAgICB0aGlzLndyb25nRWxSaWdodCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cm9uZ1JpZ2h0Jyk7XG4gICAgdGhpcy5taXNzRWxMZWZ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pc3NMZWZ0Jyk7XG4gICAgdGhpcy5taXNzRWxSaWdodCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaXNzUmlnaHQnKTtcbiAgICB0aGlzLnBhcnRpY2xlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYWJlclBhcnRpY2xlcycpO1xuICAgIHRoaXMubWluZVBhcnRpY2xlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaW5lUGFydGljbGVzJyk7XG5cbiAgICB0aGlzLnN1cGVyQ3V0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zdXBlckN1dEZ4Jyk7XG4gICAgdGhpcy5zdXBlckN1dElkeCA9IDA7XG5cbiAgICB0aGlzLmV4cGxvZGVFdmVudERldGFpbCA9IHtwb3NpdGlvbjogbnVsbCwgcm90YXRpb246IG51bGx9O1xuICAgIHRoaXMuc2FiZXJDb2xvcnMgPSB7cmlnaHQ6ICdibHVlJywgbGVmdDogJ3JlZCd9O1xuXG4gICAgdGhpcy5vbkVuZFN0cm9rZSA9IHRoaXMub25FbmRTdHJva2UuYmluZCh0aGlzKTtcblxuICAgIHRoaXMuaW5pdEJsb2NrKCk7XG4gICAgaWYgKHRoaXMuZGF0YS50eXBlID09PSAnbWluZScpIHtcbiAgICAgIHRoaXMuaW5pdE1pbmVGcmFnbWVudHMoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5pbml0RnJhZ21lbnRzKCk7XG4gICAgfTtcbiAgfSxcblxuICB1cGRhdGVQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgZWwub2JqZWN0M0QucG9zaXRpb24uc2V0KFxuICAgICAgdGhpcy5ob3Jpem9udGFsUG9zaXRpb25zW2RhdGEuaG9yaXpvbnRhbFBvc2l0aW9uXSxcbiAgICAgIHRoaXMudmVydGljYWxQb3NpdGlvbnNbZGF0YS52ZXJ0aWNhbFBvc2l0aW9uXSxcbiAgICAgIGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24gKyBkYXRhLndhcm11cFBvc2l0aW9uXG4gICAgKTtcblxuICAgIGVsLm9iamVjdDNELnJvdGF0aW9uLnogPSBUSFJFRS5NYXRoLmRlZ1RvUmFkKHRoaXMucm90YXRpb25zW2RhdGEuY3V0RGlyZWN0aW9uXSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy51cGRhdGVQb3NpdGlvbigpO1xuICAgIHRoaXMudXBkYXRlQmxvY2soKTtcbiAgICB0aGlzLnVwZGF0ZUZyYWdtZW50cygpO1xuXG4gICAgaWYgKHRoaXMuZGF0YS50eXBlID09PSAnbWluZScpIHtcbiAgICAgIHRoaXMucG9vbE5hbWUgPSBgcG9vbF9fYmVhdC1taW5lYDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wb29sTmFtZSA9IGBwb29sX19iZWF0LSR7dGhpcy5kYXRhLnR5cGV9LSR7dGhpcy5kYXRhLmNvbG9yfWA7XG4gICAgfVxuICB9LFxuXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgaWYgKHRoaXMuZGF0YS50eXBlICE9PSAnbWluZScpIHtcbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICB9XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmxvY2tFbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICB0aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gIH0sXG5cbiAgdG9jazogZnVuY3Rpb24gKHRpbWUsIHRpbWVEZWx0YSkge1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGNvbnN0IHBvc2l0aW9uID0gZWwub2JqZWN0M0QucG9zaXRpb247XG4gICAgY29uc3Qgcm90YXRpb24gPSBlbC5vYmplY3QzRC5yb3RhdGlvbjtcblxuICAgIGlmICh0aGlzLmRlc3Ryb3llZCkge1xuICAgICAgdGhpcy50b2NrRGVzdHJveWVkKHRpbWVEZWx0YSk7XG4gICAgICAvLyBDaGVjayB0byByZW1vdmUgc2NvcmUgZW50aXR5IGZyb20gcG9vbC5cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gT25seSBjaGVjayBjb2xsaXNpb25zIHdoZW4gY2xvc2UuXG4gICAgICBpZiAocG9zaXRpb24ueiA+IGNvbGxpc2lvblpUaHJlc2hvbGQpIHsgdGhpcy5jaGVja0NvbGxpc2lvbnMoKTsgfVxuXG4gICAgICAvLyBNb3ZlLlxuICAgICAgaWYgKHBvc2l0aW9uLnogPCBkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uKSB7XG4gICAgICAgIGxldCBuZXdQb3NpdGlvblogPSBwb3NpdGlvbi56ICsgQkVBVF9XQVJNVVBfU1BFRUQgKiAodGltZURlbHRhIC8gMTAwMCk7XG4gICAgICAgIC8vIFdhcm0gdXAgLyB3YXJwIGluLlxuICAgICAgICBpZiAobmV3UG9zaXRpb25aIDwgZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbikge1xuICAgICAgICAgIHBvc2l0aW9uLnogPSBuZXdQb3NpdGlvblo7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcG9zaXRpb24ueiA9IGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb247XG4gICAgICAgICAgdGhpcy5iZWFtcy5uZXdCZWFtKHRoaXMuZGF0YS5jb2xvciwgcG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBTdGFuZGFyZCBtb3ZpbmcuXG4gICAgICAgIHBvc2l0aW9uLnogKz0gdGhpcy5kYXRhLnNwZWVkICogKHRpbWVEZWx0YSAvIDEwMDApO1xuICAgICAgICByb3RhdGlvbi56ID0gdGhpcy5zdGFydFJvdGF0aW9uWjtcbiAgICAgIH1cblxuICAgICAgaWYgKHBvc2l0aW9uLnogPiAoZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbiAtIEJFQVRfV0FSTVVQX1JPVEFUSU9OX09GRlNFVCkgJiZcbiAgICAgICAgICB0aGlzLmN1cnJlbnRSb3RhdGlvbldhcm11cFRpbWUgPCBCRUFUX1dBUk1VUF9ST1RBVElPTl9USU1FKSB7XG4gICAgICAgIGNvbnN0IHByb2dyZXNzID0gQUZSQU1FLkFOSU1FLmVhc2luZ3MuZWFzZU91dEJhY2soXG4gICAgICAgICAgdGhpcy5jdXJyZW50Um90YXRpb25XYXJtdXBUaW1lIC8gQkVBVF9XQVJNVVBfUk9UQVRJT05fVElNRSk7XG4gICAgICAgIGVsLm9iamVjdDNELnJvdGF0aW9uLnogPSB0aGlzLnJvdGF0aW9uWlN0YXJ0ICsgKHByb2dyZXNzICogdGhpcy5yb3RhdGlvblpDaGFuZ2UpO1xuICAgICAgICB0aGlzLmN1cnJlbnRSb3RhdGlvbldhcm11cFRpbWUgKz0gdGltZURlbHRhO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjay5cbiAgICAgIHRoaXMuYmFja1RvUG9vbCA9IHBvc2l0aW9uLnogPj0gMjtcbiAgICAgIGlmICh0aGlzLmJhY2tUb1Bvb2wpIHsgdGhpcy5taXNzSGl0KCk7IH1cbiAgICB9XG4gICAgdGhpcy5yZXR1cm5Ub1Bvb2woKTtcbiAgfSxcblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gc3VtbW9uZWQgYnkgYmVhdC1sb2FkZXIuXG4gICAqL1xuICBvbkdlbmVyYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zdGFydFJvdGF0aW9uWiA9IHRoaXMuZWwub2JqZWN0M0Qucm90YXRpb24uejtcblxuICAgIC8vIFNldCB1cCByb3RhdGlvbiB3YXJtdXAuXG4gICAgdGhpcy5jdXJyZW50Um90YXRpb25XYXJtdXBUaW1lID0gMDtcbiAgICB0aGlzLnJvdGF0aW9uWkNoYW5nZSA9IEJFQVRfV0FSTVVQX1JPVEFUSU9OX0NIQU5HRTtcbiAgICBpZiAoTWF0aC5yYW5kb20gPiAwLjUpIHsgdGhpcy5yb3RhdGlvblpDaGFuZ2UgKj0gLTE7IH1cbiAgICB0aGlzLmVsLm9iamVjdDNELnJvdGF0aW9uLnogLT0gdGhpcy5yb3RhdGlvblpDaGFuZ2U7XG4gICAgdGhpcy5yb3RhdGlvblpTdGFydCA9IHRoaXMuZWwub2JqZWN0M0Qucm90YXRpb24uejtcbiAgICAvLyBSZXNldCBtaW5lLlxuICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PSAnbWluZScpIHsgdGhpcy5yZXNldE1pbmVGcmFnbWVudHMoKTsgfVxuICB9LFxuXG4gIGluaXRCbG9jazogZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbCA9IHRoaXMuZWw7XG4gICAgdmFyIGJsb2NrRWwgPSB0aGlzLmJsb2NrRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIHZhciBzaWduRWwgPSB0aGlzLnNpZ25FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG5cbiAgICBibG9ja0VsLnNldEF0dHJpYnV0ZSgnbWl4aW4nLCAnYmVhdEJsb2NrJyk7XG4gICAgYmxvY2tFbC5zZXRBdHRyaWJ1dGUoJ21peGluJywgJ2JlYXRTaWduJyk7XG5cbiAgICAvLyBTbWFsbCBvZmZzZXQgdG8gcHJldmVudCB6LWZpZ2h0aW5nIHdoZW4gdGhlIGJsb2NrcyBhcmUgZmFyIGF3YXlcbiAgICBzaWduRWwub2JqZWN0M0QucG9zaXRpb24ueiArPSAwLjAyO1xuICAgIGJsb2NrRWwuYXBwZW5kQ2hpbGQoc2lnbkVsKTtcbiAgICBlbC5hcHBlbmRDaGlsZChibG9ja0VsKTtcbiAgfSxcblxuICB1cGRhdGVCbG9jazogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGJsb2NrRWwgPSB0aGlzLmJsb2NrRWw7XG4gICAgY29uc3Qgc2lnbkVsID0gdGhpcy5zaWduRWw7XG4gICAgaWYgKCFibG9ja0VsKSB7IHJldHVybjsgfVxuXG4gICAgYmxvY2tFbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge1xuICAgICAgbWV0YWxuZXNzOiAwLjcsXG4gICAgICByb3VnaG5lc3M6IDAuMSxcbiAgICAgIHNwaGVyaWNhbEVudk1hcDogJyNlbnZtYXBUZXh0dXJlJyxcbiAgICAgIGVtaXNzaXZlOiB0aGlzLm1hdGVyaWFsQ29sb3JbdGhpcy5kYXRhLmNvbG9yXSxcbiAgICAgIGVtaXNzaXZlSW50ZW5zaXR5OiAwLjA1LFxuICAgICAgY29sb3I6IHRoaXMubWF0ZXJpYWxDb2xvclt0aGlzLmRhdGEuY29sb3JdXG4gICAgfSk7XG4gICAgdGhpcy5zZXRPYmpNb2RlbEZyb21UZW1wbGF0ZShibG9ja0VsLCB0aGlzLm1vZGVsc1t0aGlzLmRhdGEudHlwZV0pO1xuXG4gICAgLy8gTW9kZWwgaXMgMC4yOSBzaXplLiBXZSBtYWtlIGl0IDEuMCBzbyB3ZSBjYW4gZWFzaWx5IHNjYWxlIGJhc2VkIG9uIDFtIHNpemUuXG4gICAgYmxvY2tFbC5vYmplY3QzRC5zY2FsZS5zZXQoMSwgMSwgMSk7XG4gICAgYmxvY2tFbC5vYmplY3QzRC5zY2FsZS5tdWx0aXBseVNjYWxhcigzLjQ1KS5tdWx0aXBseVNjYWxhcih0aGlzLmRhdGEuc2l6ZSk7XG5cbiAgICBpZiAodGhpcy5kYXRhLnR5cGUgPT09ICdtaW5lJykge1xuICAgICAgY29uc3QgbW9kZWwgPSBibG9ja0VsLmdldE9iamVjdDNEKCdtZXNoJyk7XG4gICAgICBpZiAobW9kZWwpIHtcbiAgICAgICAgbW9kZWwubWF0ZXJpYWwgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHNbJ21pbmVNYXRlcmlhbCcgKyB0aGlzLmRhdGEuY29sb3JdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYmxvY2tFbC5hZGRFdmVudExpc3RlbmVyKCdtb2RlbC1sb2FkZWQnLCAoKSA9PiB7XG4gICAgICAgICAgbW9kZWwubWF0ZXJpYWwgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHNbJ21pbmVNYXRlcmlhbCcgKyB0aGlzLmRhdGEuY29sb3JdO1xuICAgICAgICB9LCBPTkNFKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc2lnbkVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWxzJywge25hbWU6ICdzdGFnZUFkZGl0aXZlJ30pO1xuICAgICAgdGhpcy5zZXRPYmpNb2RlbEZyb21UZW1wbGF0ZShzaWduRWwsIHRoaXMuc2lnbk1vZGVsc1t0aGlzLmRhdGEudHlwZSArIHRoaXMuZGF0YS5jb2xvcl0pO1xuICAgIH1cbiAgfSxcblxuICBpbml0RnJhZ21lbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGN1dEVsO1xuICAgIHZhciBwYXJ0RWw7XG5cbiAgICBwYXJ0RWwgPSB0aGlzLnBhcnRMZWZ0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIGN1dEVsID0gdGhpcy5jdXRMZWZ0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuXG4gICAgcGFydEVsLmFwcGVuZENoaWxkKGN1dEVsKTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHBhcnRFbCk7XG5cbiAgICBwYXJ0RWwgPSB0aGlzLnBhcnRSaWdodEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICBjdXRFbCA9IHRoaXMuY3V0UmlnaHRFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG5cbiAgICBwYXJ0RWwuYXBwZW5kQ2hpbGQoY3V0RWwpO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQocGFydEVsKTtcblxuICAgIHRoaXMuaW5pdEN1dHRpbmdDbGlwcGluZ1BsYW5lcygpO1xuICB9LFxuXG4gIGluaXRNaW5lRnJhZ21lbnRzOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGZyYWdtZW50O1xuICAgIHZhciBmcmFnbWVudHMgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtc1snbWluZS1mcmFnbWVudHMtbG9hZGVyJ10uZnJhZ21lbnRzLmNoaWxkcmVuO1xuICAgIHZhciBtYXRlcmlhbCA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFsc1snbWluZU1hdGVyaWFsJyArIHRoaXMuZGF0YS5jb2xvcl07XG5cbiAgICB0aGlzLnJhbmRWZWMgPSBuZXcgVEhSRUUuVmVjdG9yMyhcbiAgICAgIE1hdGgucmFuZG9tKCkgKiBNYXRoLlBJLFxuICAgICAgTWF0aC5yYW5kb20oKSAqIE1hdGguUEksXG4gICAgICBNYXRoLnJhbmRvbSgpICogTWF0aC5QSSk7XG5cbiAgICB0aGlzLm1pbmVGcmFnbWVudHMgPSBbXTtcbiAgICB0aGlzLm1pbmVCcm9rZW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5taW5lQnJva2VuKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZnJhZ21lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmcmFnbWVudCA9IG5ldyBUSFJFRS5NZXNoKGZyYWdtZW50c1tpXS5nZW9tZXRyeSwgbWF0ZXJpYWwpO1xuICAgICAgZnJhZ21lbnQuc3BlZWQgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgICAgZnJhZ21lbnQuc3BlZWQuc2V0KE1hdGgucmFuZG9tKCkgLSAwLjUsIE1hdGgucmFuZG9tKCkgLSAwLjUsIE1hdGgucmFuZG9tKCkgLSAwLjUpO1xuICAgICAgdGhpcy5taW5lRnJhZ21lbnRzLnB1c2goZnJhZ21lbnQpO1xuICAgICAgdGhpcy5taW5lQnJva2VuLm9iamVjdDNELmFkZChmcmFnbWVudCk7XG4gICAgfVxuICB9LFxuXG4gIHVwZGF0ZUZyYWdtZW50czogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdXRMZWZ0RWwgPSB0aGlzLmN1dExlZnRFbDtcbiAgICB2YXIgY3V0UmlnaHRFbCA9IHRoaXMuY3V0UmlnaHRFbDtcbiAgICB2YXIgcGFydExlZnRFbCA9IHRoaXMucGFydExlZnRFbDtcbiAgICB2YXIgcGFydFJpZ2h0RWwgPSB0aGlzLnBhcnRSaWdodEVsO1xuICAgIHZhciBmcmFnbWVudDtcbiAgICBpZiAoIXBhcnRMZWZ0RWwpIHsgcmV0dXJuOyB9XG4gICAgaWYgKHRoaXMuZGF0YS50eXBlID09PSAnbWluZScpIHtcbiAgICAgIHRoaXMucmVzZXRNaW5lRnJhZ21lbnRzKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcGFydExlZnRFbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge1xuICAgICAgbWV0YWxuZXNzOiAwLjcsXG4gICAgICByb3VnaG5lc3M6IDAuMSxcbiAgICAgIHNwaGVyaWNhbEVudk1hcDogJyNlbnZtYXBUZXh0dXJlJyxcbiAgICAgIGVtaXNzaXZlOiB0aGlzLm1hdGVyaWFsQ29sb3JbdGhpcy5kYXRhLmNvbG9yXSxcbiAgICAgIGVtaXNzaXZlSW50ZW5zaXR5OiAwLjA1LFxuICAgICAgY29sb3I6IHRoaXMubWF0ZXJpYWxDb2xvclt0aGlzLmRhdGEuY29sb3JdLFxuICAgICAgc2lkZTogJ2RvdWJsZSdcbiAgICB9KTtcbiAgICB0aGlzLnNldE9iak1vZGVsRnJvbVRlbXBsYXRlKHBhcnRMZWZ0RWwsIHRoaXMubW9kZWxzLmRvdCk7XG4gICAgcGFydExlZnRFbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG5cbiAgICBjdXRMZWZ0RWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtcbiAgICAgIHNoYWRlcjogJ2ZsYXQnLFxuICAgICAgY29sb3I6IHRoaXMuZGF0YS5jdXRDb2xvcixcbiAgICAgIHNpZGU6ICdkb3VibGUnXG4gICAgfSk7XG4gICAgdGhpcy5zZXRPYmpNb2RlbEZyb21UZW1wbGF0ZShjdXRMZWZ0RWwsIHRoaXMubW9kZWxzLmRvdCk7XG5cbiAgICBwYXJ0UmlnaHRFbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywge1xuICAgICAgbWV0YWxuZXNzOiAwLjcsXG4gICAgICByb3VnaG5lc3M6IDAuMSxcbiAgICAgIHNwaGVyaWNhbEVudk1hcDogJyNlbnZtYXBUZXh0dXJlJyxcbiAgICAgIGVtaXNzaXZlOiB0aGlzLm1hdGVyaWFsQ29sb3JbdGhpcy5kYXRhLmNvbG9yXSxcbiAgICAgIGVtaXNzaXZlSW50ZW5zaXR5OiAwLjA1LFxuICAgICAgY29sb3I6IHRoaXMubWF0ZXJpYWxDb2xvclt0aGlzLmRhdGEuY29sb3JdLFxuICAgICAgc2lkZTogJ2RvdWJsZSdcbiAgICB9KTtcbiAgICB0aGlzLnNldE9iak1vZGVsRnJvbVRlbXBsYXRlKHBhcnRSaWdodEVsLCB0aGlzLm1vZGVscy5kb3QpO1xuICAgIHBhcnRSaWdodEVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcblxuICAgIGN1dFJpZ2h0RWwuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtcbiAgICAgIHNoYWRlcjogJ2ZsYXQnLFxuICAgICAgY29sb3I6IHRoaXMuZGF0YS5jdXRDb2xvcixcbiAgICAgIHNpZGU6ICdkb3VibGUnXG4gICAgfSk7XG4gICAgdGhpcy5zZXRPYmpNb2RlbEZyb21UZW1wbGF0ZShjdXRSaWdodEVsLCB0aGlzLm1vZGVscy5kb3QpO1xuICB9LFxuXG4gIHJlc2V0TWluZUZyYWdtZW50czogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmRhdGEudHlwZSAhPT0gJ21pbmUnKSB7IHJldHVybjsgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5taW5lRnJhZ21lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgZnJhZ21lbnQgPSB0aGlzLm1pbmVGcmFnbWVudHNbaV07XG4gICAgICBmcmFnbWVudC52aXNpYmxlID0gZmFsc2U7XG4gICAgICBmcmFnbWVudC5wb3NpdGlvbi5zZXQoMCwgMCwgMCk7XG4gICAgICBmcmFnbWVudC5zY2FsZS5zZXQoMSwgMSwgMSk7XG4gICAgICBmcmFnbWVudC5zcGVlZC5zZXQoXG4gICAgICAgIE1hdGgucmFuZG9tKCkgKiA1IC0gMi41LFxuICAgICAgICBNYXRoLnJhbmRvbSgpICogNSAtIDIuNSxcbiAgICAgICAgTWF0aC5yYW5kb20oKSAqIDUgLSAyLjUpO1xuICAgIH1cbiAgfSxcblxuICB3cm9uZ0hpdDogZnVuY3Rpb24gKGhhbmQpIHtcbiAgICB2YXIgd3JvbmdFbCA9IGhhbmQgPT09ICdsZWZ0JyA/IHRoaXMud3JvbmdFbExlZnQgOiB0aGlzLndyb25nRWxSaWdodDtcbiAgICBpZiAoIXdyb25nRWwpIHsgcmV0dXJuOyB9XG4gICAgd3JvbmdFbC5vYmplY3QzRC5wb3NpdGlvbi5jb3B5KHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24pO1xuICAgIHdyb25nRWwub2JqZWN0M0QucG9zaXRpb24ueSArPSAwLjI7XG4gICAgd3JvbmdFbC5vYmplY3QzRC5wb3NpdGlvbi56IC09IDAuNTtcbiAgICB3cm9uZ0VsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIHdyb25nRWwuZW1pdCgnYmVhdHdyb25nJywgbnVsbCwgdHJ1ZSk7XG4gICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuICB9LFxuXG4gIG1pc3NIaXQ6IGZ1bmN0aW9uIChoYW5kKSB7XG4gICAgdmFyIG1pc3NFbCA9IGhhbmQgPT09ICdsZWZ0JyA/IHRoaXMubWlzc0VsTGVmdCA6IHRoaXMubWlzc0VsUmlnaHQ7XG4gICAgaWYgKCFtaXNzRWwgfHwgdGhpcy5kYXRhLnR5cGUgPT09ICdtaW5lJykgeyByZXR1cm47IH1cbiAgICBtaXNzRWwub2JqZWN0M0QucG9zaXRpb24uY29weSh0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uKTtcbiAgICBtaXNzRWwub2JqZWN0M0QucG9zaXRpb24ueSArPSAwLjI7XG4gICAgbWlzc0VsLm9iamVjdDNELnBvc2l0aW9uLnogLT0gMC41O1xuICAgIG1pc3NFbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICBtaXNzRWwuZW1pdCgnYmVhdG1pc3MnLCBudWxsLCB0cnVlKTtcbiAgICBpZiAoQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignc3luY3Rlc3QnKSkge1xuICAgICAgY29uc29sZS5sb2codGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHMuc29uZy5nZXRDdXJyZW50VGltZSgpKTtcbiAgICB9XG4gIH0sXG5cbiAgZGVzdHJveUJlYXQ6IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHBhcmFsbGVsUGxhbmVNYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XG4gICAgICBjb2xvcjogJyMwMDAwOGInLFxuICAgICAgc2lkZTogVEhSRUUuRG91YmxlU2lkZVxuICAgIH0pO1xuICAgIHZhciBwbGFuZU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtjb2xvcjogJ2dyZXknLCBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlfSk7XG4gICAgdmFyIHBvaW50MSA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdmFyIHBvaW50MiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdmFyIHBvaW50MyA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKHNhYmVyRWwpIHtcbiAgICAgIHZhciBjb3BsYW5hclBvaW50O1xuICAgICAgdmFyIGN1dFRoaWNrbmVzcyA9IHRoaXMuY3V0VGhpY2tuZXNzID0gMC4wMjtcbiAgICAgIHZhciBkaXJlY3Rpb24gPSB0aGlzLmN1dERpcmVjdGlvbjtcbiAgICAgIHZhciBsZWZ0Qm9yZGVySW5uZXJQbGFuZSA9IHRoaXMubGVmdEJvcmRlcklubmVyUGxhbmU7XG4gICAgICB2YXIgbGVmdEJvcmRlck91dGVyUGxhbmUgPSB0aGlzLmxlZnRCb3JkZXJPdXRlclBsYW5lO1xuICAgICAgdmFyIGxlZnRDdXRQbGFuZSA9IHRoaXMubGVmdEN1dFBsYW5lO1xuICAgICAgdmFyIHBsYW5lR2VvbWV0cnk7XG4gICAgICB2YXIgcGxhbmVNZXNoO1xuICAgICAgdmFyIHJpZ2h0Qm9yZGVySW5uZXJQbGFuZSA9IHRoaXMucmlnaHRCb3JkZXJJbm5lclBsYW5lO1xuICAgICAgdmFyIHJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZSA9IHRoaXMucmlnaHRCb3JkZXJPdXRlclBsYW5lO1xuICAgICAgdmFyIHJpZ2h0Q3V0UGxhbmUgPSB0aGlzLnJpZ2h0Q3V0UGxhbmU7XG4gICAgICB2YXIgdHJhaWxQb2ludHMgPSBzYWJlckVsLmNvbXBvbmVudHMudHJhaWwuc2FiZXJUcmFqZWN0b3J5O1xuXG4gICAgICBwb2ludDEuY29weSh0cmFpbFBvaW50c1swXS50b3ApO1xuICAgICAgcG9pbnQyLmNvcHkodHJhaWxQb2ludHNbMF0uY2VudGVyKTtcbiAgICAgIHBvaW50My5jb3B5KHRyYWlsUG9pbnRzW3RyYWlsUG9pbnRzLmxlbmd0aCAtIDFdLnRvcCk7XG4gICAgICBkaXJlY3Rpb24uY29weShwb2ludDEpLnN1Yihwb2ludDMpO1xuXG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnBvc2l0aW9uLnNldCgwLCAwLCAwKTtcbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0Qucm90YXRpb24uc2V0KDAsIDAsIDApO1xuICAgICAgdGhpcy5wYXJ0UmlnaHRFbC5vYmplY3QzRC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuXG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELndvcmxkVG9Mb2NhbCh0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNbMF0uY29weShwb2ludDEpKTtcbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0Qud29ybGRUb0xvY2FsKHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1sxXS5jb3B5KHBvaW50MikpO1xuICAgICAgdGhpcy5wYXJ0UmlnaHRFbC5vYmplY3QzRC53b3JsZFRvTG9jYWwodGhpcy5yaWdodEN1dFBsYW5lUG9pbnRzWzJdLmNvcHkocG9pbnQzKSk7XG5cbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC5wb3NpdGlvbi5zZXQoMCwgMCwgMCk7XG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0Qucm90YXRpb24uc2V0KDAsIDAsIDApO1xuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELnVwZGF0ZU1hdHJpeFdvcmxkKCk7XG5cbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC53b3JsZFRvTG9jYWwodGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHNbMF0uY29weShwb2ludDMpKTtcbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC53b3JsZFRvTG9jYWwodGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHNbMV0uY29weShwb2ludDIpKTtcbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC53b3JsZFRvTG9jYWwodGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHNbMl0uY29weShwb2ludDEpKTtcblxuICAgICAgdGhpcy5nZW5lcmF0ZUN1dENsaXBwaW5nUGxhbmVzKCk7XG5cbiAgICAgIGlmICh0aGlzLmRhdGEuZGVidWcpIHtcbiAgICAgICAgY29wbGFuYXJQb2ludCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgICAgIHBsYW5lR2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVHZW9tZXRyeSg0LjAsIDQuMCwgMS4wLCAxLjApO1xuXG4gICAgICAgIHJpZ2h0Q3V0UGxhbmUuY29wbGFuYXJQb2ludChjb3BsYW5hclBvaW50KTtcbiAgICAgICAgcGxhbmVHZW9tZXRyeS5sb29rQXQocmlnaHRDdXRQbGFuZS5ub3JtYWwpO1xuICAgICAgICBwbGFuZUdlb21ldHJ5LnRyYW5zbGF0ZShjb3BsYW5hclBvaW50LngsIGNvcGxhbmFyUG9pbnQueSwgY29wbGFuYXJQb2ludC56KTtcblxuICAgICAgICBwbGFuZU1lc2ggPSBuZXcgVEhSRUUuTWVzaChwbGFuZUdlb21ldHJ5LCBwbGFuZU1hdGVyaWFsKTtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLnNldE9iamVjdDNEKCdyaWdodEN1dFBsYW5lJywgcGxhbmVNZXNoKTtcblxuICAgICAgICBwbGFuZUdlb21ldHJ5ID0gbmV3IFRIUkVFLlBsYW5lR2VvbWV0cnkoNC4wLCA0LjAsIDEuMCwgMS4wKTtcblxuICAgICAgICByaWdodEJvcmRlck91dGVyUGxhbmUuY29wbGFuYXJQb2ludChjb3BsYW5hclBvaW50KTtcbiAgICAgICAgcGxhbmVHZW9tZXRyeS5sb29rQXQocmlnaHRCb3JkZXJPdXRlclBsYW5lLm5vcm1hbCk7XG4gICAgICAgIHBsYW5lR2VvbWV0cnkudHJhbnNsYXRlKGNvcGxhbmFyUG9pbnQueCwgY29wbGFuYXJQb2ludC55LCBjb3BsYW5hclBvaW50LnopO1xuXG4gICAgICAgIGNvbnN0IHBhcmFsbGVsUGxhbmVNZXNoID0gbmV3IFRIUkVFLk1lc2gocGxhbmVHZW9tZXRyeSwgcGFyYWxsZWxQbGFuZU1hdGVyaWFsKTtcbiAgICAgICAgdGhpcy5lbC5zY2VuZUVsLnNldE9iamVjdDNEKCdwbGFuZVBhcmFsbGVsJywgcGFyYWxsZWxQbGFuZU1lc2gpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmJsb2NrRWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgICBjb25zdCBwYXJ0UmlnaHRNYXRlcmlhbCA9IHRoaXMucGFydFJpZ2h0RWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbDtcbiAgICAgIHBhcnRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzID0gcGFydFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMgfHwgW107XG4gICAgICBwYXJ0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcy5sZW5ndGggPSAwO1xuICAgICAgcGFydFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMucHVzaChyaWdodEN1dFBsYW5lKTtcblxuICAgICAgY29uc3QgY3V0UmlnaHRNYXRlcmlhbCA9IHRoaXMuY3V0UmlnaHRFbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsO1xuICAgICAgY3V0UmlnaHRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcyA9IGN1dFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMgfHwgW107XG4gICAgICBjdXRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLmxlbmd0aCA9IDA7XG4gICAgICBjdXRSaWdodE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLnB1c2gocmlnaHRCb3JkZXJPdXRlclBsYW5lKTtcbiAgICAgIGN1dFJpZ2h0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMucHVzaChyaWdodEJvcmRlcklubmVyUGxhbmUpO1xuXG4gICAgICBjb25zdCBwYXJ0TGVmdE1hdGVyaWFsID0gdGhpcy5wYXJ0TGVmdEVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWw7XG4gICAgICBwYXJ0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzID0gcGFydExlZnRNYXRlcmlhbC5jbGlwcGluZ1BsYW5lcyB8fCBbXTtcbiAgICAgIHBhcnRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMubGVuZ3RoID0gMDtcbiAgICAgIHBhcnRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMucHVzaChsZWZ0Q3V0UGxhbmUpO1xuXG4gICAgICBjb25zdCBjdXRMZWZ0TWF0ZXJpYWwgPSB0aGlzLmN1dExlZnRFbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsO1xuICAgICAgY3V0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzID0gY3V0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzIHx8IFtdO1xuICAgICAgY3V0TGVmdE1hdGVyaWFsLmNsaXBwaW5nUGxhbmVzLmxlbmd0aCA9IDA7XG4gICAgICBjdXRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMucHVzaChsZWZ0Qm9yZGVySW5uZXJQbGFuZSk7XG4gICAgICBjdXRMZWZ0TWF0ZXJpYWwuY2xpcHBpbmdQbGFuZXMucHVzaChsZWZ0Qm9yZGVyT3V0ZXJQbGFuZSk7XG5cbiAgICAgIHRoaXMucGFydExlZnRFbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICAgIHRoaXMucGFydFJpZ2h0RWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG5cbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5yZW5kZXJlci5sb2NhbENsaXBwaW5nRW5hYmxlZCA9IHRydWU7XG4gICAgICB0aGlzLmRlc3Ryb3llZCA9IHRydWU7XG4gICAgICB0aGlzLmdyYXZpdHlWZWxvY2l0eSA9IDAuMTtcblxuICAgICAgdGhpcy5yb3RhdGlvbkF4aXMuY29weSh0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNbMF0pLnN1Yih0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNbMV0pO1xuXG4gICAgICB0aGlzLnJldHVyblRvUG9vbFRpbWVyID0gODAwO1xuXG4gICAgICBhdXhPYmozRC51cC5jb3B5KHJpZ2h0Q3V0UGxhbmUubm9ybWFsKTtcbiAgICAgIGF1eE9iajNELmxvb2tBdChkaXJlY3Rpb24pO1xuICAgICAgdGhpcy5leHBsb2RlRXZlbnREZXRhaWwucG9zaXRpb24gPSB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uO1xuICAgICAgdGhpcy5leHBsb2RlRXZlbnREZXRhaWwucm90YXRpb24gPSBhdXhPYmozRC5yb3RhdGlvbjtcbiAgICAgIHRoaXMucGFydGljbGVzLmVtaXQoJ2V4cGxvZGUnLCB0aGlzLmV4cGxvZGVFdmVudERldGFpbCwgZmFsc2UpO1xuICAgIH07XG4gIH0pKCksXG5cbiAgZGVzdHJveU1pbmU6IGZ1bmN0aW9uICgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWluZUZyYWdtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5taW5lRnJhZ21lbnRzW2ldLnZpc2libGUgPSB0cnVlO1xuICAgIH1cblxuICAgIHRoaXMuYmxvY2tFbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuICAgIHRoaXMuZ3Jhdml0eVZlbG9jaXR5ID0gMC4xO1xuICAgIHRoaXMucmV0dXJuVG9Qb29sVGltZXIgPSA4MDA7XG5cbiAgICB0aGlzLmV4cGxvZGVFdmVudERldGFpbC5wb3NpdGlvbiA9IHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb247XG4gICAgdGhpcy5leHBsb2RlRXZlbnREZXRhaWwucm90YXRpb24gPSB0aGlzLnJhbmRWZWM7XG4gICAgdGhpcy5taW5lUGFydGljbGVzLmVtaXQoJ2V4cGxvZGUnLCB0aGlzLmV4cGxvZGVFdmVudERldGFpbCwgZmFsc2UpO1xuICB9LFxuXG4gIGluaXRDdXR0aW5nQ2xpcHBpbmdQbGFuZXM6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmxlZnRDdXRQbGFuZVBvaW50c1dvcmxkID0gW1xuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKSxcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpXG4gICAgXTtcbiAgICB0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZCA9IFtcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IzKCksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMygpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjMoKVxuICAgIF07XG5cbiAgICB0aGlzLnJpZ2h0Q3V0UGxhbmUgPSBuZXcgVEhSRUUuUGxhbmUoKTtcbiAgICB0aGlzLnJpZ2h0Qm9yZGVyT3V0ZXJQbGFuZSA9IG5ldyBUSFJFRS5QbGFuZSgpO1xuICAgIHRoaXMucmlnaHRCb3JkZXJJbm5lclBsYW5lID0gbmV3IFRIUkVFLlBsYW5lKCk7XG5cbiAgICB0aGlzLmxlZnRDdXRQbGFuZSA9IG5ldyBUSFJFRS5QbGFuZSgpO1xuICAgIHRoaXMubGVmdEJvcmRlck91dGVyUGxhbmUgPSBuZXcgVEhSRUUuUGxhbmUoKTtcbiAgICB0aGlzLmxlZnRCb3JkZXJJbm5lclBsYW5lID0gbmV3IFRIUkVFLlBsYW5lKCk7XG4gIH0sXG5cbiAgZ2VuZXJhdGVDdXRDbGlwcGluZ1BsYW5lczogZnVuY3Rpb24gKCkge1xuICAgIHZhciBsZWZ0Qm9yZGVySW5uZXJQbGFuZSA9IHRoaXMubGVmdEJvcmRlcklubmVyUGxhbmU7XG4gICAgdmFyIGxlZnRCb3JkZXJPdXRlclBsYW5lID0gdGhpcy5sZWZ0Qm9yZGVyT3V0ZXJQbGFuZTtcbiAgICB2YXIgbGVmdEN1dFBsYW5lID0gdGhpcy5sZWZ0Q3V0UGxhbmU7XG4gICAgdmFyIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkID0gdGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZDtcbiAgICB2YXIgcGFydExlZnRFbCA9IHRoaXMucGFydExlZnRFbDtcbiAgICB2YXIgcGFydFJpZ2h0RWwgPSB0aGlzLnBhcnRSaWdodEVsO1xuICAgIHZhciByaWdodEJvcmRlcklubmVyUGxhbmUgPSB0aGlzLnJpZ2h0Qm9yZGVySW5uZXJQbGFuZTtcbiAgICB2YXIgcmlnaHRCb3JkZXJPdXRlclBsYW5lID0gdGhpcy5yaWdodEJvcmRlck91dGVyUGxhbmU7XG4gICAgdmFyIHJpZ2h0Q3V0UGxhbmUgPSB0aGlzLnJpZ2h0Q3V0UGxhbmU7XG4gICAgdmFyIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZCA9IHRoaXMucmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkO1xuXG4gICAgcGFydFJpZ2h0RWwub2JqZWN0M0QudXBkYXRlTWF0cml4V29ybGQoKTtcbiAgICBwYXJ0UmlnaHRFbC5vYmplY3QzRC5sb2NhbFRvV29ybGQoXG4gICAgICByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMF0uY29weSh0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNbMF0pKTtcbiAgICBwYXJ0UmlnaHRFbC5vYmplY3QzRC5sb2NhbFRvV29ybGQoXG4gICAgICByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMV0uY29weSh0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNbMV0pKTtcbiAgICBwYXJ0UmlnaHRFbC5vYmplY3QzRC5sb2NhbFRvV29ybGQoXG4gICAgICByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMl0uY29weSh0aGlzLnJpZ2h0Q3V0UGxhbmVQb2ludHNbMl0pKTtcblxuICAgIHBhcnRMZWZ0RWwub2JqZWN0M0QudXBkYXRlTWF0cml4V29ybGQoKTtcbiAgICBwYXJ0TGVmdEVsLm9iamVjdDNELmxvY2FsVG9Xb3JsZChcbiAgICAgIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzBdLmNvcHkodGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHNbMF0pKTtcbiAgICBwYXJ0TGVmdEVsLm9iamVjdDNELmxvY2FsVG9Xb3JsZChcbiAgICAgIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzFdLmNvcHkodGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHNbMV0pKTtcbiAgICBwYXJ0TGVmdEVsLm9iamVjdDNELmxvY2FsVG9Xb3JsZChcbiAgICAgIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzJdLmNvcHkodGhpcy5sZWZ0Q3V0UGxhbmVQb2ludHNbMl0pKTtcblxuICAgIHJpZ2h0Q3V0UGxhbmUuc2V0RnJvbUNvcGxhbmFyUG9pbnRzKFxuICAgICAgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzBdLCByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMV0sIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFsyXSk7XG4gICAgcmlnaHRCb3JkZXJPdXRlclBsYW5lLnNldChyaWdodEN1dFBsYW5lLm5vcm1hbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0Q3V0UGxhbmUuY29uc3RhbnQgKyB0aGlzLmN1dFRoaWNrbmVzcyk7XG5cbiAgICBsZWZ0Q3V0UGxhbmUuc2V0RnJvbUNvcGxhbmFyUG9pbnRzKFxuICAgICAgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMF0sIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzFdLCBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFsyXSk7XG4gICAgbGVmdEJvcmRlck91dGVyUGxhbmUuc2V0KGxlZnRDdXRQbGFuZS5ub3JtYWwsIGxlZnRDdXRQbGFuZS5jb25zdGFudCArIHRoaXMuY3V0VGhpY2tuZXNzKTtcblxuICAgIHJpZ2h0Qm9yZGVySW5uZXJQbGFuZS5zZXRGcm9tQ29wbGFuYXJQb2ludHMoXG4gICAgICByaWdodEN1dFBsYW5lUG9pbnRzV29ybGRbMl0sIHJpZ2h0Q3V0UGxhbmVQb2ludHNXb3JsZFsxXSwgcmlnaHRDdXRQbGFuZVBvaW50c1dvcmxkWzBdKTtcbiAgICBsZWZ0Qm9yZGVySW5uZXJQbGFuZS5zZXRGcm9tQ29wbGFuYXJQb2ludHMoXG4gICAgICBsZWZ0Q3V0UGxhbmVQb2ludHNXb3JsZFsyXSwgbGVmdEN1dFBsYW5lUG9pbnRzV29ybGRbMV0sIGxlZnRDdXRQbGFuZVBvaW50c1dvcmxkWzBdKTtcbiAgfSxcblxuICByZXR1cm5Ub1Bvb2w6IGZ1bmN0aW9uIChmb3JjZSkge1xuICAgIGlmICghdGhpcy5iYWNrVG9Qb29sICYmICFmb3JjZSkgeyByZXR1cm47IH1cbiAgICB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50c1t0aGlzLnBvb2xOYW1lXS5yZXR1cm5FbnRpdHkodGhpcy5lbCk7XG4gIH0sXG5cbiAgY2hlY2tDb2xsaXNpb25zOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgY3V0RGlyZWN0aW9uID0gdGhpcy5kYXRhLmN1dERpcmVjdGlvbjtcbiAgICBjb25zdCBzYWJlckNvbG9ycyA9IHRoaXMuc2FiZXJDb2xvcnM7XG4gICAgY29uc3Qgc2FiZXJFbHMgPSB0aGlzLnNhYmVyRWxzO1xuICAgIGNvbnN0IGhpdEJvdW5kaW5nQm94ID0gdGhpcy5oaXRDb2xsaWRlckVsICYmIHRoaXMuaGl0Qm91bmRpbmdCb3guc2V0RnJvbU9iamVjdChcbiAgICAgIHRoaXMuaGl0Q29sbGlkZXJFbC5nZXRPYmplY3QzRCgnbWVzaCcpKTtcbiAgICBjb25zdCBiZWF0Qm91bmRpbmdCb3ggPSB0aGlzLmJlYXRCb3VuZGluZ0JveC5zZXRGcm9tT2JqZWN0KFxuICAgICAgdGhpcy5ibG9ja0VsLmdldE9iamVjdDNEKCdtZXNoJykpO1xuICAgIHZhciB3cm9uZ0hhbmRIaXQ7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNhYmVyRWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgc2FiZXJCb3VuZGluZ0JveCA9IHNhYmVyRWxzW2ldLmNvbXBvbmVudHNbJ3NhYmVyLWNvbnRyb2xzJ10uYm91bmRpbmdCb3g7XG4gICAgICBsZXQgc2FiZXJDb250cm9scztcbiAgICAgIGxldCBtYXhBbmdsZTtcblxuICAgICAgaWYgKCFzYWJlckJvdW5kaW5nQm94KSB7IGJyZWFrOyB9XG5cbiAgICAgIGNvbnN0IGhhbmQgPSBzYWJlckVsc1tpXS5nZXRBdHRyaWJ1dGUoJ3NhYmVyLWNvbnRyb2xzJykuaGFuZDtcblxuICAgICAgaWYgKHNhYmVyQm91bmRpbmdCb3guaW50ZXJzZWN0c0JveChiZWF0Qm91bmRpbmdCb3gpKSB7XG4gICAgICAgIC8vIE5vdGlmeSBmb3IgaGFwdGljcy5cbiAgICAgICAgdGhpcy5lbC5lbWl0KGBiZWF0Y29sbGlkZSR7aGFuZH1gLCBudWxsLCB0cnVlKTtcblxuICAgICAgICAvLyBTb3VuZC5cbiAgICAgICAgdGhpcy5lbC5wYXJlbnROb2RlLmNvbXBvbmVudHNbJ2JlYXQtaGl0LXNvdW5kJ10ucGxheVNvdW5kKHRoaXMuZWwpO1xuXG4gICAgICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PT0gJ21pbmUnKSB7XG4gICAgICAgICAgdGhpcy5lbC5lbWl0KCdtaW5laGl0JywgbnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgdGhpcy5kZXN0cm95TWluZSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kZXN0cm95QmVhdChzYWJlckVsc1tpXSk7XG5cbiAgICAgICAgaWYgKHNhYmVyRWxzW2ldLmNvbXBvbmVudHNbJ3NhYmVyLWNvbnRyb2xzJ10uc3dpbmdpbmcgJiZcbiAgICAgICAgICAgIHRoaXMuZGF0YS5jb2xvciA9PT0gc2FiZXJDb2xvcnNbaGFuZF0pIHtcbiAgICAgICAgICB0aGlzLmhpdFNhYmVyRWwgPSBzYWJlckVsc1tpXTtcbiAgICAgICAgICB0aGlzLmhpdFNhYmVyRWwuYWRkRXZlbnRMaXN0ZW5lcignc3Ryb2tlZW5kJywgdGhpcy5vbkVuZFN0cm9rZSwgT05DRSk7XG4gICAgICAgICAgc2FiZXJDb250cm9scyA9IHNhYmVyRWxzW2ldLmNvbXBvbmVudHNbJ3NhYmVyLWNvbnRyb2xzJ107XG4gICAgICAgICAgdGhpcy5oaXRIYW5kID0gaGFuZDtcbiAgICAgICAgICBzYWJlckNvbnRyb2xzLm1heEFuZ2xlUGxhbmVYID0gMDtcbiAgICAgICAgICBzYWJlckNvbnRyb2xzLm1heEFuZ2xlUGxhbmVZID0gMDtcbiAgICAgICAgICBzYWJlckNvbnRyb2xzLm1heEFuZ2xlUGxhbmVYWSA9IDA7XG5cbiAgICAgICAgICBpZiAodGhpcy5kYXRhLnR5cGUgPT09ICdhcnJvdycpIHtcbiAgICAgICAgICAgIHNhYmVyQ29udHJvbHMudXBkYXRlU3Ryb2tlRGlyZWN0aW9uKCk7XG4gICAgICAgICAgICBpZiAoIXNhYmVyQ29udHJvbHMuc3Ryb2tlRGlyZWN0aW9uW3RoaXMuZGF0YS5jdXREaXJlY3Rpb25dKSB7XG4gICAgICAgICAgICAgIHRoaXMud3JvbmdIaXQoaGFuZCk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY3V0RGlyZWN0aW9uID09PSAndXAnIHx8IGN1dERpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XG4gICAgICAgICAgICAgIG1heEFuZ2xlID0gc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3V0RGlyZWN0aW9uID09PSAnbGVmdCcgfHwgY3V0RGlyZWN0aW9uID09PSAncmlnaHQnKSB7XG4gICAgICAgICAgICBtYXhBbmdsZSA9IHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBtYXhBbmdsZSA9IHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVhZO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXhBbmdsZSA9IE1hdGgubWF4KHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVgsIHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVhZKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgd3JvbmdIYW5kSGl0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHRoaXMuYW5nbGVCZWZvcmVIaXQgPSBtYXhBbmdsZTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdyb25nSGFuZEhpdCA9IGhhbmQ7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAod3JvbmdIYW5kSGl0KSB7IHRoaXMud3JvbmdIaXQod3JvbmdIYW5kSGl0KTsgfVxuICAgIH1cbiAgfSxcblxuICBvbkVuZFN0cm9rZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdXREaXJlY3Rpb24gPSB0aGlzLmRhdGEuY3V0RGlyZWN0aW9uO1xuICAgIHZhciBoaXRFdmVudERldGFpbCA9IHRoaXMuaGl0RXZlbnREZXRhaWw7XG4gICAgdmFyIG1heEFuZ2xlO1xuICAgIHZhciBzYWJlckNvbnRyb2xzID0gdGhpcy5oaXRTYWJlckVsLmNvbXBvbmVudHNbJ3NhYmVyLWNvbnRyb2xzJ107XG4gICAgdmFyIHNjb3JlVGV4dDtcblxuICAgIC8vIEhhcmNvZGVkIHRlbXBvcmFyaWx5LlxuICAgIGNvbnN0IHNhYmVyUm90YXRpb24gPSAzLjE0IC8gMTI7XG5cbiAgICBpZiAoY3V0RGlyZWN0aW9uID09PSAndXAnIHx8IGN1dERpcmVjdGlvbiA9PT0gJ2Rvd24nKSB7XG4gICAgICBtYXhBbmdsZSA9IHNhYmVyQ29udHJvbHMubWF4QW5nbGVQbGFuZVg7XG4gICAgfSBlbHNlIGlmIChjdXREaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBjdXREaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgIG1heEFuZ2xlID0gc2FiZXJDb250cm9scy5tYXhBbmdsZVBsYW5lWTtcbiAgICB9IGVsc2Uge1xuICAgICAgbWF4QW5nbGUgPSBzYWJlckNvbnRyb2xzLm1heEFuZ2xlUGxhbmVYWTtcbiAgICB9XG5cbiAgICBjb25zdCBhbmdsZUJlZm9yZUhpdCA9IE1hdGgubWF4KDAsICh0aGlzLmFuZ2xlQmVmb3JlSGl0IC0gc2FiZXJSb3RhdGlvbikgKiAxODAgLyBNYXRoLlBJKTtcbiAgICBjb25zdCBhbmdsZUFmdGVySGl0ID0gTWF0aC5tYXgoMCwgKG1heEFuZ2xlIC0gc2FiZXJSb3RhdGlvbikgKiAxODAgLyBNYXRoLlBJKTtcblxuICAgIGxldCBzY29yZSA9IDA7XG4gICAgc2NvcmUgKz0gYW5nbGVCZWZvcmVIaXQgPj0gODUgPyA3MCA6IChhbmdsZUJlZm9yZUhpdCAvIDgwKSAqIDcwO1xuICAgIHNjb3JlICs9IGFuZ2xlQWZ0ZXJIaXQgPj0gNjAgPyAzMCA6IChhbmdsZUFmdGVySGl0IC8gNjApICogMzA7XG5cbiAgICBoaXRFdmVudERldGFpbC5zY29yZSA9IHNjb3JlO1xuICAgIHRoaXMuZWwuZW1pdCgnYmVhdGhpdCcsIGhpdEV2ZW50RGV0YWlsLCB0cnVlKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgndGV4dGdsb3dib2xkJywgbnVsbCwgZmFsc2UpO1xuXG4gICAgbGV0IGJlYXRTY29yZVBvb2w7XG4gICAgaWYgKHNjb3JlIDwgNjApIHsgYmVhdFNjb3JlUG9vbCA9IFNDT1JFX1BPT0wuT0s7IH1cbiAgICBlbHNlIGlmIChzY29yZSA8IDgwKSB7IGJlYXRTY29yZVBvb2wgPSBTQ09SRV9QT09MLkdPT0Q7IH1cbiAgICBlbHNlIGlmIChzY29yZSA8IDEwMCkgeyBiZWF0U2NvcmVQb29sID0gU0NPUkVfUE9PTC5HUkVBVDsgfVxuICAgIGVsc2Uge1xuICAgICAgYmVhdFNjb3JlUG9vbCA9IFNDT1JFX1BPT0wuU1VQRVI7XG5cbiAgICAgIHRoaXMuc3VwZXJDdXRzW3RoaXMuc3VwZXJDdXRJZHhdLmNvbXBvbmVudHMuc3VwZXJjdXRmeC5jcmVhdGVTdXBlckN1dCh0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uKTtcbiAgICAgIHRoaXMuc3VwZXJDdXRJZHggPSAodGhpcy5zdXBlckN1dElkeCArIDEpICUgdGhpcy5zdXBlckN1dHMubGVuZ3RoO1xuICAgIH1cblxuICAgIGNvbnN0IHNjb3JlRWwgPSB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50c1tiZWF0U2NvcmVQb29sXS5yZXF1ZXN0RW50aXR5KCk7XG4gICAgaWYgKHNjb3JlRWwpIHtcbiAgICAgIHNjb3JlRWwub2JqZWN0M0QucG9zaXRpb24uY29weSh0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uKTtcbiAgICAgIHNjb3JlRWwucGxheSgpO1xuICAgICAgc2NvcmVFbC5lbWl0KCdiZWF0c2NvcmVzdGFydCcsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIERlc3Ryb3llZCBhbmltYXRpb24uXG4gICAqL1xuICB0b2NrRGVzdHJveWVkOiAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBsZWZ0Q3V0Tm9ybWFsID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB2YXIgbGVmdFJvdGF0aW9uID0gMDtcbiAgICB2YXIgcmlnaHRDdXROb3JtYWwgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHZhciByaWdodFJvdGF0aW9uID0gMDtcbiAgICB2YXIgcm90YXRpb25TdGVwID0gMiAqIE1hdGguUEkgLyAxNTA7XG4gICAgdmFyIGZyYWdtZW50O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0aW1lRGVsdGEpIHtcbiAgICAgIC8vIFVwZGF0ZSBncmF2aXR5IHZlbG9jaXR5LlxuICAgICAgdGhpcy5ncmF2aXR5VmVsb2NpdHkgPSBnZXRHcmF2aXR5VmVsb2NpdHkodGhpcy5ncmF2aXR5VmVsb2NpdHksIHRpbWVEZWx0YSk7XG4gICAgICB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uLnkgKz0gdGhpcy5ncmF2aXR5VmVsb2NpdHkgKiAodGltZURlbHRhIC8gMTAwMCk7XG5cbiAgICAgIGlmICh0aGlzLmRhdGEudHlwZSA9PSAnbWluZScpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1pbmVGcmFnbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBmcmFnbWVudCA9IHRoaXMubWluZUZyYWdtZW50c1tpXTtcbiAgICAgICAgICBpZiAoIWZyYWdtZW50LnZpc2libGUpIHsgY29udGludWU7IH1cbiAgICAgICAgICBmcmFnbWVudC5wb3NpdGlvbi5hZGRTY2FsZWRWZWN0b3IoZnJhZ21lbnQuc3BlZWQsIHRpbWVEZWx0YSAvIDEwMDApO1xuICAgICAgICAgIGZyYWdtZW50LnNjYWxlLm11bHRpcGx5U2NhbGFyKDAuOTcpXG4gICAgICAgICAgaWYgKGZyYWdtZW50LnNjYWxlLnkgPCAwLjEpe1xuICAgICAgICAgICAgZnJhZ21lbnQudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHJpZ2h0Q3V0Tm9ybWFsLmNvcHkodGhpcy5yaWdodEN1dFBsYW5lLm5vcm1hbClcbiAgICAgICAgICAgICAgICAgICAgLm11bHRpcGx5U2NhbGFyKERFU1RST1lFRF9TUEVFRCAqICh0aW1lRGVsdGEgLyA1MDApKTtcbiAgICAgIHJpZ2h0Q3V0Tm9ybWFsLnkgPSAwOyAgLy8gWSBoYW5kbGVkIGJ5IGdyYXZpdHkuXG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnBvc2l0aW9uLmFkZChyaWdodEN1dE5vcm1hbCk7XG4gICAgICB0aGlzLnBhcnRSaWdodEVsLm9iamVjdDNELnNldFJvdGF0aW9uRnJvbUF4aXNBbmdsZSh0aGlzLnJvdGF0aW9uQXhpcywgcmlnaHRSb3RhdGlvbik7XG4gICAgICByaWdodFJvdGF0aW9uID0gcmlnaHRSb3RhdGlvbiA+PSAyICogTWF0aC5QSSA/IDAgOiByaWdodFJvdGF0aW9uICsgcm90YXRpb25TdGVwO1xuXG4gICAgICBsZWZ0Q3V0Tm9ybWFsLmNvcHkodGhpcy5sZWZ0Q3V0UGxhbmUubm9ybWFsKVxuICAgICAgICAgICAgICAgICAgIC5tdWx0aXBseVNjYWxhcihERVNUUk9ZRURfU1BFRUQgKiAodGltZURlbHRhIC8gNTAwKSk7XG4gICAgICBsZWZ0Q3V0Tm9ybWFsLnkgPSAwOyAgLy8gWSBoYW5kbGVkIGJ5IGdyYXZpdHkuXG4gICAgICB0aGlzLnBhcnRMZWZ0RWwub2JqZWN0M0QucG9zaXRpb24uYWRkKGxlZnRDdXROb3JtYWwpO1xuICAgICAgdGhpcy5wYXJ0TGVmdEVsLm9iamVjdDNELnNldFJvdGF0aW9uRnJvbUF4aXNBbmdsZSh0aGlzLnJvdGF0aW9uQXhpcywgbGVmdFJvdGF0aW9uKTtcbiAgICAgIGxlZnRSb3RhdGlvbiA9IGxlZnRSb3RhdGlvbiA+PSAyICogTWF0aC5QSSA/IDAgOiBsZWZ0Um90YXRpb24gKyByb3RhdGlvblN0ZXA7XG5cbiAgICAgIHRoaXMuZ2VuZXJhdGVDdXRDbGlwcGluZ1BsYW5lcygpO1xuXG4gICAgICB0aGlzLnJldHVyblRvUG9vbFRpbWVyIC09IHRpbWVEZWx0YTtcbiAgICAgIHRoaXMuYmFja1RvUG9vbCA9IHRoaXMucmV0dXJuVG9Qb29sVGltZXIgPD0gMDtcbiAgICB9O1xuICB9KSgpLFxuXG4gIC8qKlxuICAgKiBMb2FkIE9CSiBmcm9tIGFscmVhZHkgcGFyc2VkIGFuZCBsb2FkZWQgT0JKIHRlbXBsYXRlLlxuICAgKi9cbiAgc2V0T2JqTW9kZWxGcm9tVGVtcGxhdGU6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZ2VvbWV0cmllcyA9IHt9O1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChlbCwgdGVtcGxhdGVJZCkge1xuICAgICAgaWYgKCFnZW9tZXRyaWVzW3RlbXBsYXRlSWRdKSB7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZUlkKTtcbiAgICAgICAgaWYgKHRlbXBsYXRlRWwuZ2V0T2JqZWN0M0QoJ21lc2gnKSkge1xuICAgICAgICAgIGdlb21ldHJpZXNbdGVtcGxhdGVJZF0gPSB0ZW1wbGF0ZUVsLmdldE9iamVjdDNEKCdtZXNoJykuY2hpbGRyZW5bMF0uZ2VvbWV0cnk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGVtcGxhdGVFbC5hZGRFdmVudExpc3RlbmVyKCdtb2RlbC1sb2FkZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICBnZW9tZXRyaWVzW3RlbXBsYXRlSWRdID0gdGVtcGxhdGVFbC5nZXRPYmplY3QzRCgnbWVzaCcpLmNoaWxkcmVuWzBdLmdlb21ldHJ5O1xuICAgICAgICAgICAgdGhpcy5zZXRPYmpNb2RlbEZyb21UZW1wbGF0ZShlbCwgdGVtcGxhdGVJZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICghZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKSkgeyBlbC5zZXRPYmplY3QzRCgnbWVzaCcsIG5ldyBUSFJFRS5NZXNoKCkpOyB9XG4gICAgICBlbC5nZXRPYmplY3QzRCgnbWVzaCcpLmdlb21ldHJ5ID0gZ2VvbWV0cmllc1t0ZW1wbGF0ZUlkXTtcbiAgICB9O1xuICB9KSgpXG59KTtcblxuLyoqXG4gKiBHZXQgdmVsb2NpdHkgZ2l2ZW4gY3VycmVudCB2ZWxvY2l0eSB1c2luZyBncmF2aXR5IGFjY2VsZXJhdGlvbi5cbiAqL1xuZnVuY3Rpb24gZ2V0R3Jhdml0eVZlbG9jaXR5ICh2ZWxvY2l0eSwgdGltZURlbHRhKSB7XG4gIGNvbnN0IEdSQVZJVFkgPSAtOS44O1xuICByZXR1cm4gdmVsb2NpdHkgKyAoR1JBVklUWSAqICh0aW1lRGVsdGEgLyAxMDAwKSk7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9iZWF0LmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdjb25zb2xlLXNob3J0Y3V0cycsIHtcbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHdpbmRvdy4kID0gdmFsID0+IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodmFsKTtcbiAgICB3aW5kb3cuJCQgPSB2YWwgPT4gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWwpO1xuICAgIHdpbmRvdy4kJCQgPSB2YWwgPT4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgWyR7dmFsfV1gKS5nZXRBdHRyaWJ1dGUodmFsKTtcbiAgICB3aW5kb3cuJCQkJCA9IHZhbCA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbJHt2YWx9XWApLmNvbXBvbmVudHNbdmFsXTtcbiAgICB3aW5kb3cuc2NlbmUgPSB0aGlzLmVsO1xuICAgIHdpbmRvdy5zdGF0ZSA9IHRoaXMuZWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9jb25zb2xlLXNob3J0Y3V0cy5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnY29weS10ZXh0dXJlJywge1xuICBkZXBlbmRlbmNpZXM6IFsnZ2VvbWV0cnknLCAnbWF0ZXJpYWwnXSxcblxuICBzY2hlbWE6IHtcbiAgICBmcm9tOiB7dHlwZTogJ3NlbGVjdG9yJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGRhdGEuZnJvbS5hZGRFdmVudExpc3RlbmVyKCdtYXRlcmlhbHRleHR1cmVsb2FkZWQnLCAoKSA9PiB7IHRoaXMuY29weVRleHR1cmUoKTsgfSk7XG4gICAgdGhpcy5jb3B5VGV4dHVyZSgpO1xuICB9LFxuXG4gIGNvcHlUZXh0dXJlOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZGF0YS5mcm9tO1xuICAgIGNvbnN0IG1hdGVyaWFsID0gZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbDtcblxuICAgIGlmICghdGFyZ2V0LmdldE9iamVjdDNEKCdtZXNoJykpIHsgcmV0dXJuOyB9XG5cbiAgICBtYXRlcmlhbC5tYXAgPSB0YXJnZXQuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5tYXA7XG5cbiAgICBpZiAoIW1hdGVyaWFsLm1hcCkgeyByZXR1cm47IH1cblxuICAgIG1hdGVyaWFsLm1hcC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gICAgbWF0ZXJpYWwubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2NvcHktdGV4dHVyZS5qcyIsIi8qKlxuICogTGFzZXIgYmVhbS5cbiAqIEF1dG9tYXRpY2FsbHkgc2V0IGxlbmd0aCBvbiBpbnRlcnNlY3Rpb24uXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnY3Vyc29yLWxhc2VyJywge1xuICBkZXBlbmRlbmNpZXM6IFsnZ2VvbWV0cnknXSxcblxuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIHRoaXMuc2FiZXJFbCA9IHRoaXMuZWwuY2xvc2VzdCgnLnNhYmVyJyk7XG5cbiAgICAvLyBDYWxjdWxhdGUgc2l6ZSB0byBwb3NpdGlvbiBiZWFtIGF0IHRpcCBvZiBjb250cm9sbGVyLlxuICAgIGNvbnN0IGdlb21ldHJ5ID0gdGhpcy5lbC5nZXRBdHRyaWJ1dGUoJ2dlb21ldHJ5Jyk7XG4gICAgZWwub2JqZWN0M0QucG9zaXRpb24ueiA9IC0xICogZ2VvbWV0cnkuaGVpZ2h0IC8gMjtcbiAgICB0aGlzLm9yaWdpbmFsU2l6ZSA9IGdlb21ldHJ5LmhlaWdodDtcbiAgICB0aGlzLmN1cnJlbnRMZW5ndGggPSBnZW9tZXRyeS5oZWlnaHQ7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gdGhpcy5kYXRhLmVuYWJsZWQ7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcblxuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG5cbiAgICBjb25zdCBjdXJzb3IgPSB0aGlzLnNhYmVyRWwuY29tcG9uZW50cy5jdXJzb3I7XG4gICAgaWYgKCFjdXJzb3IpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBUb2dnbGUgYmVhbS5cbiAgICBjb25zdCBpbnRlcnNlY3RlZEVsID0gY3Vyc29yLmludGVyc2VjdGVkRWw7XG5cbiAgICBpZiAoIWludGVyc2VjdGVkRWwpIHtcbiAgICAgIC8vIFJldHJhY3QgdGhlIGJlYW0gaWYgbm90IGludGVyc2VjdGluZy5cbiAgICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLnogPSAtMjU7XG4gICAgICBlbC5vYmplY3QzRC5zY2FsZS54ID0gMC43NTtcbiAgICAgIGVsLmdldE9iamVjdDNEKCdtZXNoJykuc2NhbGUueSA9IDUwO1xuICAgICAgdGhpcy5jdXJyZW50TGVuZ3RoID0gMTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZXQgYXBwcm9wcmlhdGUgbGVuZ3RoIG9mIGJlYW0gb24gaW50ZXJzZWN0aW9uLlxuICAgIGNvbnN0IGludGVyc2VjdGlvbiA9IHRoaXMuc2FiZXJFbC5jb21wb25lbnRzLnJheWNhc3Rlci5pbnRlcnNlY3Rpb25zWzBdO1xuICAgIGlmICghaW50ZXJzZWN0aW9uKSB7IHJldHVybjsgfVxuICAgIGVsLm9iamVjdDNELnNjYWxlLnggPSAxO1xuICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLnogPSAoLWludGVyc2VjdGlvbi5kaXN0YW5jZSAvIDIpO1xuICAgIGVsLmdldE9iamVjdDNEKCdtZXNoJykuc2NhbGUueSA9IHRoaXMuY3VycmVudExlbmd0aCA9IGludGVyc2VjdGlvbi5kaXN0YW5jZTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9jdXJzb3ItbGFzZXIuanMiLCIvKipcbiAqIEN1cnNvciBtZXNoIHRvIHNob3cgYXQgaW50ZXJzZWN0aW9uIHBvaW50IHdpdGggcmVzcGVjdGl2ZSBoYW5kLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2N1cnNvci1tZXNoJywge1xuICBzY2hlbWE6IHtcbiAgICBhY3RpdmU6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBjdXJzb3JFbDoge3R5cGU6ICdzZWxlY3Rvcid9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc2NlbmVQaXZvdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lUGl2b3QnKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0aGlzLmRhdGEuYWN0aXZlO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY3Vyc29yO1xuICAgIHZhciBjdXJzb3JFbCA9IHRoaXMuZGF0YS5jdXJzb3JFbDtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBpbnRlcnNlY3Rpb247XG4gICAgdmFyIGludGVyc2VjdGVkRWw7XG4gICAgdmFyIHNjZW5lUGl2b3RFbCA9IHRoaXMuc2NlbmVQaXZvdEVsO1xuXG4gICAgaWYgKCF0aGlzLmRhdGEuYWN0aXZlKSB7IHJldHVybjsgfVxuXG4gICAgY3Vyc29yID0gY3Vyc29yRWwuY29tcG9uZW50cy5jdXJzb3I7XG4gICAgaWYgKCFjdXJzb3IpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBMb29rIGZvciB2YWxpZCBpbnRlcnNlY3Rpb24gdGFyZ2V0LlxuICAgIGludGVyc2VjdGVkRWwgPSBjdXJzb3JFbC5jb21wb25lbnRzLmN1cnNvci5pbnRlcnNlY3RlZEVsO1xuICAgIGlmIChpbnRlcnNlY3RlZEVsKSB7XG4gICAgICBlbC5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjdXJzb3IgbWVzaC5cbiAgICBpbnRlcnNlY3Rpb24gPSBjdXJzb3JFbC5jb21wb25lbnRzLnJheWNhc3Rlci5nZXRJbnRlcnNlY3Rpb24oaW50ZXJzZWN0ZWRFbCk7XG4gICAgaWYgKCFpbnRlcnNlY3Rpb24pIHsgcmV0dXJuOyB9XG5cbiAgICBlbC5vYmplY3QzRC5wb3NpdGlvbi5jb3B5KGludGVyc2VjdGlvbi5wb2ludCk7XG5cbiAgICBpZiAoc2NlbmVQaXZvdEVsKSB7XG4gICAgICBlbC5vYmplY3QzRC5yb3RhdGlvbi5jb3B5KHNjZW5lUGl2b3RFbC5vYmplY3QzRC5yb3RhdGlvbik7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2N1cnNvci1tZXNoLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdkZWJ1Zy1iZWF0LWxvYWRlcicsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2JlYXQtbG9hZGVyJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYmVhdEVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgc3RhZ2VFbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYmVhdExvYWRlciA9IHRoaXMuZWwuY29tcG9uZW50c1snYmVhdC1sb2FkZXInXTtcbiAgICB0aGlzLnNlbGVjdGVkQmVhdCA9IHtcbiAgICAgIGNvbG9yOiAncmVkJyxcbiAgICAgIHBvc2l0aW9uOiAnbWlkZGxlQ2VudGVyTGVmdCcsXG4gICAgICB0eXBlOiAnYXJyb3cnLFxuICAgICAgb3JpZW50YXRpb246ICd1cCdcbiAgICB9O1xuXG4gICAgdGhpcy5iZWF0cyA9IHt9O1xuXG4gICAgdGhpcy5vbktleURvd24gPSB0aGlzLm9uS2V5RG93bi5iaW5kKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMuZGF0YS5zdGFnZUVuYWJsZWQgfHwgQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWdzdGFnZScpKSB7XG4gICAgICB0aGlzLmFkZERlYnVnU3RhZ2VDb250cm9scygpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEuYmVhdEVuYWJsZWQgfHxcbiAgICAgICAgQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWdzdGF0ZScpLnRyaW0oKSA9PT0gJ2dhbWVwbGF5Jykge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uS2V5RG93bik7XG4gICAgICB0aGlzLmFkZERlYnVnQmVhdENvbnRyb2xzKCk7XG4gICAgfVxuICB9LFxuXG4gIHNwYXduOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIE9iamVjdC5rZXlzKHRoaXMuYmVhdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgc2VsZi5nZW5lcmF0ZUJlYXQoc2VsZi5iZWF0c1trZXldKTtcbiAgICB9KTtcbiAgfSxcblxuICBnZW5lcmF0ZUJlYXQ6IGZ1bmN0aW9uIChiZWF0SW5mbykge1xuICAgIHZhciB0eXBlO1xuICAgIGlmIChiZWF0SW5mby50eXBlID09PSAnd2FsbCcpIHtcbiAgICAgIHRoaXMuZ2VuZXJhdGVXYWxsKGJlYXRJbmZvKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGJlYXRJbmZvLnR5cGUgPT09ICdtaW5lJykge1xuICAgICAgdHlwZSA9IDM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHR5cGUgPSBiZWF0SW5mby5jb2xvciA9PT0gJ3JlZCcgPyAwIDogMTtcbiAgICB9XG4gICAgdGhpcy5iZWF0TG9hZGVyLmdlbmVyYXRlQmVhdCh7XG4gICAgICBfbGluZUluZGV4OiB0aGlzLmJlYXRMb2FkZXIucG9zaXRpb25IdW1hbml6ZWRbYmVhdEluZm8ucG9zaXRpb25dLmluZGV4LFxuICAgICAgX2xpbmVMYXllcjogdGhpcy5iZWF0TG9hZGVyLnBvc2l0aW9uSHVtYW5pemVkW2JlYXRJbmZvLnBvc2l0aW9uXS5sYXllcixcbiAgICAgIF9jdXREaXJlY3Rpb246IGJlYXRJbmZvLnR5cGUgPT09ICdkb3QnXG4gICAgICAgID8gOFxuICAgICAgICA6IHRoaXMuYmVhdExvYWRlci5vcmllbnRhdGlvbnNIdW1hbml6ZWQuaW5kZXhPZihiZWF0SW5mby5vcmllbnRhdGlvbiksXG4gICAgICBfdHlwZTogdHlwZVxuICAgIH0pO1xuICB9LFxuXG5cbiAgZ2VuZXJhdGVXYWxsOiBmdW5jdGlvbiAod2FsbEluZm8pIHtcbiAgICB0aGlzLmJlYXRMb2FkZXIuYnBtID0gOTA7XG4gICAgdGhpcy5iZWF0TG9hZGVyLmdlbmVyYXRlV2FsbCh7XG4gICAgICBfbGluZUluZGV4OiB0aGlzLmJlYXRMb2FkZXIucG9zaXRpb25IdW1hbml6ZWRbd2FsbEluZm8ucG9zaXRpb25dLmluZGV4LFxuICAgICAgX3dpZHRoOiAxLFxuICAgICAgX2R1cmF0aW9uOiAzXG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIERlYnVnIGdlbmVyYXRlIGJlYXRzLlxuICAgKi9cbiAgb25LZXlEb3duOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBjb25zdCBrZXlDb2RlID0gZXZlbnQua2V5Q29kZTtcbiAgICBzd2l0Y2ggKGtleUNvZGUpIHtcbiAgICAgIGNhc2UgMzI6IHsgIC8vIFNwYWNlIGJhci5cbiAgICAgICAgdGhpcy5zcGF3bigpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgYWRkRGVidWdCZWF0Q29udHJvbHM6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBwYXJlbnREaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgIHBhcmVudERpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgcGFyZW50RGl2LnN0eWxlLnJpZ2h0ID0gJzAnO1xuICAgIHBhcmVudERpdi5zdHlsZS50b3AgPSAnMCc7XG4gICAgcGFyZW50RGl2LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XG4gICAgcGFyZW50RGl2LnN0eWxlLndpZHRoID0gJzUwMHB4JztcbiAgICBwYXJlbnREaXYuc3R5bGUuaGVpZ2h0ID0gJzYwMHB4JztcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBhcmVudERpdik7XG5cbiAgICBhZGRUeXBlQmVhdE1lbnUoKTtcbiAgICBhZGRDb2xvckJlYXRNZW51KCk7XG4gICAgYWRkT3JpZW50YXRpb25NZW51KCk7XG5cbiAgICBzZXRCZWF0QnV0dG9uKCk7XG4gICAgYWRkQmVhdFBvc2l0aW9uTWVudSgpO1xuXG4gICAgYWRkR2VuZXJhdGVCdXR0b24oKTtcblxuICAgIGZ1bmN0aW9uIGFkZE9yaWVudGF0aW9uTWVudSAoKSB7XG4gICAgICBjb25zdCBtZW51RGl2ID0gYWRkTWVudSgnb3JpZW50YXRpb24nKTtcbiAgICAgIGFkZEJ1dHRvbigndG9wJywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ2xlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigncmlnaHQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignZG93bicsIG1lbnVEaXYpO1xuICAgICAgcGFyZW50RGl2LmFwcGVuZENoaWxkKG1lbnVEaXYpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZENvbG9yQmVhdE1lbnUgKCkge1xuICAgICAgY29uc3QgbWVudURpdiA9IGFkZE1lbnUoJ2NvbG9yJyk7XG4gICAgICBhZGRCdXR0b24oJ2JsdWUnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigncmVkJywgbWVudURpdik7XG4gICAgICBwYXJlbnREaXYuYXBwZW5kQ2hpbGQobWVudURpdik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkVHlwZUJlYXRNZW51ICgpIHtcbiAgICAgIGNvbnN0IG1lbnVEaXYgPSBhZGRNZW51KCd0eXBlJyk7XG4gICAgICBhZGRCdXR0b24oJ2Fycm93JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ2RvdCcsIG1lbnVEaXYpO1xuICAgICAgYWRkQnV0dG9uKCdtaW5lJywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ3dhbGwnLCBtZW51RGl2KTtcbiAgICAgIHBhcmVudERpdi5hcHBlbmRDaGlsZChtZW51RGl2KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRCZWF0UG9zaXRpb25NZW51ICgpIHtcbiAgICAgIGNvbnN0IG1lbnVEaXYgPSBhZGRNZW51KCdwb3NpdGlvbicpO1xuICAgICAgYWRkQnV0dG9uKCd0b3BMZWZ0JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ3RvcENlbnRlckxlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigndG9wQ2VudGVyUmlnaHQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbigndG9wUmlnaHQnLCBtZW51RGl2KTtcblxuICAgICAgYWRkQnV0dG9uKCdtaWRkbGVMZWZ0JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ21pZGRsZUNlbnRlckxlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignbWlkZGxlQ2VudGVyUmlnaHQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignbWlkZGxlUmlnaHQnLCBtZW51RGl2KTtcblxuICAgICAgYWRkQnV0dG9uKCdib3R0b21MZWZ0JywgbWVudURpdik7XG4gICAgICBhZGRCdXR0b24oJ2JvdHRvbUNlbnRlckxlZnQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignYm90dG9tQ2VudGVyUmlnaHQnLCBtZW51RGl2KTtcbiAgICAgIGFkZEJ1dHRvbignYm90dG9tUmlnaHQnLCBtZW51RGl2KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRNZW51IChuYW1lKSB7XG4gICAgICBjb25zdCBtZW51RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBtZW51RGl2LmlkID0gbmFtZTtcbiAgICAgIG1lbnVEaXYuc3R5bGUubWFyZ2luQm90dG9tID0gJzIwcHgnO1xuICAgICAgbWVudURpdi5zdHlsZS53aWR0aCA9ICc1MDBweCc7XG4gICAgICBtZW51RGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgIHBhcmVudERpdi5hcHBlbmRDaGlsZChtZW51RGl2KTtcbiAgICAgIHJldHVybiBtZW51RGl2O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZEJ1dHRvbiAodGV4dCwgY29udGFpbmVyRWwsIGNsaWNrSGFuZGxlcikge1xuICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBjb25zdCBoYW5kbGVyID0gY2xpY2tIYW5kbGVyIHx8IGZ1bmN0aW9uIG9uQ2xpY2sgKCkge1xuICAgICAgICBjb25zdCBidXR0b25zID0gZGl2LnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJ1dHRvbicpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1dHRvbnMubGVuZ3RoOyBpKyspIHsgYnV0dG9uc1tpXS5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDAnOyB9XG4gICAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJyM2NmYnO1xuICAgICAgICBzZWxmLnNlbGVjdGVkQmVhdFtkaXYucGFyZW50RWxlbWVudC5pZF0gPSB0aGlzLmlkO1xuICAgICAgICBzZWxmWydzZWxlY3RlZCcgKyBkaXYucGFyZW50RWxlbWVudC5pZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGRpdi5wYXJlbnRFbGVtZW50LmlkLnNsaWNlKDEpICsgJ0VsJ10gPSB0aGlzO1xuICAgICAgfTtcbiAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdidXR0b24nKTtcbiAgICAgIGRpdi5pZCA9IHRleHQ7XG4gICAgICBkaXYuc3R5bGUud2lkdGggPSAnMTAwcHgnO1xuICAgICAgZGl2LnN0eWxlLmhlaWdodCA9ICczMHB4JztcbiAgICAgIGRpdi5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDAnO1xuICAgICAgZGl2LnN0eWxlLmNvbG9yID0gJyNmZmYnO1xuICAgICAgZGl2LnN0eWxlLnpJbmRleCA9IDk5OTk5OTk5OTtcbiAgICAgIGRpdi5zdHlsZS5wYWRkaW5nID0gJzVweCc7XG4gICAgICBkaXYuc3R5bGUubWFyZ2luID0gJzVweCc7XG4gICAgICBkaXYuc3R5bGUuZm9udCA9ICcxNHB4IHNhbnMtc2VyaWYnO1xuICAgICAgZGl2LnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xuICAgICAgZGl2LnN0eWxlLmxpbmVIZWlnaHQgPSAnMzBweCc7XG4gICAgICBkaXYuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcbiAgICAgIGRpdi5pbm5lckhUTUwgPSB0ZXh0O1xuICAgICAgY29udGFpbmVyRWwuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZXIpO1xuICAgICAgcmV0dXJuIGRpdjtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gYWRkR2VuZXJhdGVCdXR0b24gKHRleHQsIGNvbnRhaW5lckVsKSB7XG4gICAgICBjb25zdCBidXR0b25FbCA9IGFkZEJ1dHRvbignU3Bhd24gKFNwYWNlIEJhciknLCBwYXJlbnREaXYsICgpID0+IHsgc2VsZi5zcGF3bigpOyB9KTtcbiAgICAgIGJ1dHRvbkVsLnN0eWxlLndpZHRoID0gJzQ2MHB4JztcbiAgICAgIGJ1dHRvbkVsLnN0eWxlLmJvdHRvbU1hcmdpbiA9ICcxMHB4J1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldEJlYXRCdXR0b24odGV4dCwgY29udGFpbmVyRWwpIHtcbiAgICAgIHZhciBidXR0b25FbCA9IGFkZEJ1dHRvbignU2V0IEJlYXQnLCBwYXJlbnREaXYsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gc2VsZi5zZWxlY3RlZEJlYXQudHlwZSAhPT0gJ21pbmUnID8gJyAnICsgc2VsZi5zZWxlY3RlZEJlYXQuY29sb3IgOiAnJztcbiAgICAgICAgdmFyIG9yaWVudGF0aW9uID0gc2VsZi5zZWxlY3RlZEJlYXQudHlwZSAhPT0gJ2Fycm93JyA/ICcnIDogJyAnICsgc2VsZi5zZWxlY3RlZEJlYXQub3JpZW50YXRpb247XG4gICAgICAgIHNlbGYuc2VsZWN0ZWRCZWF0ID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBzZWxmLnNlbGVjdGVkQmVhdC5wb3NpdGlvbixcbiAgICAgICAgICB0eXBlOiBzZWxmLnNlbGVjdGVkQmVhdC50eXBlLFxuICAgICAgICAgIG9yaWVudGF0aW9uOiBzZWxmLnNlbGVjdGVkQmVhdC5vcmllbnRhdGlvbixcbiAgICAgICAgICBjb2xvcjogc2VsZi5zZWxlY3RlZEJlYXQuY29sb3JcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFzZWxmLnNlbGVjdGVkUG9zaXRpb25FbCkgeyByZXR1cm47IH1cbiAgICAgICAgc2VsZi5zZWxlY3RlZFBvc2l0aW9uRWwuaW5uZXJIVE1MID0gc2VsZi5zZWxlY3RlZEJlYXQudHlwZSArIGNvbG9yICsgb3JpZW50YXRpb247XG4gICAgICAgIHNlbGYuYmVhdHNbc2VsZi5zZWxlY3RlZFBvc2l0aW9uRWwuaWRdID0ge1xuICAgICAgICAgIHBvc2l0aW9uOiBzZWxmLnNlbGVjdGVkQmVhdC5wb3NpdGlvbixcbiAgICAgICAgICB0eXBlOiBzZWxmLnNlbGVjdGVkQmVhdC50eXBlLFxuICAgICAgICAgIG9yaWVudGF0aW9uOiBzZWxmLnNlbGVjdGVkQmVhdC5vcmllbnRhdGlvbixcbiAgICAgICAgICBjb2xvcjogc2VsZi5zZWxlY3RlZEJlYXQuY29sb3JcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgYnV0dG9uRWwuc3R5bGUud2lkdGggPSAnNDYwcHgnO1xuICAgICAgYnV0dG9uRWwuc3R5bGUuYm90dG9tTWFyZ2luID0gJzEwcHgnXG4gICAgfTtcbiAgfSxcblxuICBhZGREZWJ1Z1N0YWdlQ29udHJvbHM6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY3VyckNvbnRyb2wgPSAwO1xuXG4gICAgY29uc3QgYWRkQ29udHJvbCA9IChpLCBuYW1lLCB0eXBlKSA9PiB7XG4gICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGRpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICBkaXYuaWQgPSAnc3RhZ2Vjb250cm9sJyArIGk7XG4gICAgICBkaXYuc3R5bGUud2lkdGggPSAnMTAwcHgnO1xuICAgICAgZGl2LnN0eWxlLmhlaWdodCA9ICczMHB4JztcbiAgICAgIGRpdi5zdHlsZS50b3AgPSB0eXBlID09PSAnZWxlbWVudCcgPyAnMjBweCcgOiAnNzBweCc7XG4gICAgICBkaXYuc3R5bGUuYmFja2dyb3VuZCA9ICcjMDAwJztcbiAgICAgIGRpdi5zdHlsZS5jb2xvciA9ICcjZmZmJztcbiAgICAgIGRpdi5zdHlsZS56SW5kZXggPSA5OTk5OTk5OTk7XG4gICAgICBkaXYuc3R5bGUucGFkZGluZyA9ICc1cHgnO1xuICAgICAgZGl2LnN0eWxlLmZvbnQgPSAnMTRweCBzYW5zLXNlcmlmJztcbiAgICAgIGRpdi5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcbiAgICAgIGRpdi5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICBkaXYuc3R5bGUubGVmdCA9ICgyMCArIGkgKiAxMjApKydweCc7XG4gICAgICBkaXYuaW5uZXJIVE1MID0gbmFtZTtcbiAgICAgIGlmICh0eXBlID09PSAnZWxlbWVudCcpIHtcbiAgICAgICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFnZWNvbnRyb2wnICsgY3VyckNvbnRyb2wpLnN0eWxlLmJhY2tncm91bmQgPSAnIzAwMCc7XG4gICAgICAgICAgZGl2LnN0eWxlLmJhY2tncm91bmQgPSAnIzY2Zic7XG4gICAgICAgICAgY3VyckNvbnRyb2wgPSBpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICB0aGlzLmJlYXRMb2FkZXIuZ2VuZXJhdGVFdmVudCh7X3R5cGU6IGN1cnJDb250cm9sLCBfdmFsdWU6IGl9KVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXYpO1xuICAgIH07XG5cbiAgICBbXG4gICAgICAnc2t5JyxcbiAgICAgICd0dW5uZWxOZW9uJyxcbiAgICAgICdsZWZ0U3RhZ2VMYXNlcnMnLFxuICAgICAgJ3JpZ2h0U3RhZ2VMYXNlcnMnLFxuICAgICAgJ2Zsb29yJ1xuICAgIF0uZm9yRWFjaCgoaWQsIGkpID0+IHsgYWRkQ29udHJvbChpLCBpZCwgJ2VsZW1lbnQnKTsgfSk7XG5cbiAgICBbXG4gICAgICAnb2ZmJyxcbiAgICAgICdibHVlJyxcbiAgICAgICdibHVlJyxcbiAgICAgICdibHVlZmFkZScsXG4gICAgICAnJyxcbiAgICAgICdyZWQnLFxuICAgICAgJ3JlZCcsXG4gICAgICAncmVkZmFkZSdcbiAgICBdLmZvckVhY2goKGlkLCBpKSA9PiB7IGFkZENvbnRyb2woaSwgaWQsICd2YWx1ZScpOyB9KTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1iZWF0LWxvYWRlci5qcyIsIi8qKlxuICogS2V5Ym9hcmQgYmluZGluZ3MgdG8gY29udHJvbCBjb250cm9sbGVyLlxuICogUG9zaXRpb24gY29udHJvbGxlciBpbiBmcm9udCBvZiBjYW1lcmEuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZGVidWctY29udHJvbGxlcicsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHZhciBwcmltYXJ5SGFuZDtcbiAgICB2YXIgc2Vjb25kYXJ5SGFuZDtcblxuICAgIGlmICghQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWcnKSkgeyByZXR1cm47IH1cblxuICAgIGNvbnNvbGUubG9nKCclYyBkZWJ1Zy1jb250cm9sbGVyIGVuYWJsZWQgJywgJ2JhY2tncm91bmQ6ICMxMTE7IGNvbG9yOiByZWQnKTtcblxuICAgIHRoaXMuaXNDbG9uaW5nID0gZmFsc2U7XG4gICAgdGhpcy5pc0RlbGV0aW5nID0gZmFsc2U7XG4gICAgdGhpcy5pc1RyaWdnZXJEb3duID0gZmFsc2U7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5vbk1vdXNlTW92ZS5iaW5kKHRoaXMpKTtcblxuICAgIHByaW1hcnlIYW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JpZ2h0SGFuZCcpO1xuICAgIHNlY29uZGFyeUhhbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdEhhbmQnKTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XG4gICAgICBpZiAoIWV2dC5pc1RydXN0ZWQpIHsgcmV0dXJuOyB9XG4gICAgICBwcmltYXJ5SGFuZC5lbWl0KCd0cmlnZ2VyZG93bicpO1xuICAgICAgcHJpbWFyeUhhbmQuZW1pdCgndHJpZ2dlcnVwJyk7XG4gICAgfSk7XG5cbiAgICBpZiAoQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWcnKSA9PT0gJ29jdWx1cycpIHtcbiAgICAgIHByaW1hcnlIYW5kLmVtaXQoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCB7bmFtZTogJ29jdWx1cy10b3VjaC1jb250cm9scyd9KTtcbiAgICAgIHNlY29uZGFyeUhhbmQuZW1pdCgnY29udHJvbGxlcmNvbm5lY3RlZCcsIHtuYW1lOiAnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJ30pO1xuICAgICAgcHJpbWFyeUhhbmQuc2V0QXR0cmlidXRlKCdjb250cm9sbGVyJywgJ2NvbnRyb2xsZXJUeXBlJywgJ29jdWx1cy10b3VjaC1jb250cm9scycpO1xuICAgICAgc2Vjb25kYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xsZXInLCAnY29udHJvbGxlclR5cGUnLCAnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByaW1hcnlIYW5kLmVtaXQoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCB7bmFtZTogJ3ZpdmUtY29udHJvbHMnfSk7XG4gICAgICBzZWNvbmRhcnlIYW5kLmVtaXQoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCB7bmFtZTogJ3ZpdmUtY29udHJvbHMnfSk7XG4gICAgICBwcmltYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xsZXInLCAnY29udHJvbGxlclR5cGUnLCAndml2ZS1jb250cm9scycpO1xuICAgICAgc2Vjb25kYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xsZXInLCAnY29udHJvbGxlclR5cGUnLCAndml2ZS1jb250cm9scycpO1xuICAgIH1cblxuICAgIC8vIEVuYWJsZSByYXljYXN0ZXIuXG4gICAgdGhpcy5lbC5lbWl0KCdlbnRlci12cicsIG51bGwsIGZhbHNlKTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldnQgPT4ge1xuICAgICAgdmFyIHByaW1hcnlQb3NpdGlvbjtcbiAgICAgIHZhciBwcmltYXJ5Um90YXRpb247XG4gICAgICB2YXIgc2Vjb25kYXJ5UG9zaXRpb247XG4gICAgICB2YXIgc2Vjb25kYXJ5Um90YXRpb247XG5cbiAgICAgIGlmICghZXZ0LnNoaWZ0S2V5KSB7IHJldHVybjsgfVxuXG4gICAgICAvLyA8c3BhY2U+IGZvciB0cmlnZ2VyLlxuICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSAzMikge1xuICAgICAgICBpZiAodGhpcy5pc1RyaWdnZXJEb3duKSB7XG4gICAgICAgICAgcHJpbWFyeUhhbmQuZW1pdCgndHJpZ2dlcnVwJyk7XG4gICAgICAgICAgdGhpcy5pc1RyaWdnZXJEb3duID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHJpbWFyeUhhbmQuZW1pdCgndHJpZ2dlcmRvd24nKTtcbiAgICAgICAgICB0aGlzLmlzVHJpZ2dlckRvd24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gPHE+IGZvciBzZWNvbmRhcnkgdHJpZ2dlci5cbiAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gODEpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNTZWNvbmRhcnlUcmlnZ2VyRG93bikge1xuICAgICAgICAgIHNlY29uZGFyeUhhbmQuZW1pdCgndHJpZ2dlcnVwJyk7XG4gICAgICAgICAgdGhpcy5pc1NlY29uZGFyeVRyaWdnZXJEb3duID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2Vjb25kYXJ5SGFuZC5lbWl0KCd0cmlnZ2VyZG93bicpO1xuICAgICAgICAgIHRoaXMuaXNTZWNvbmRhcnlUcmlnZ2VyRG93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyA8bj4gc2Vjb25kYXJ5IGdyaXAuXG4gICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc4KSB7XG4gICAgICAgIGlmICh0aGlzLnNlY29uZGFyeUdyaXBEb3duKSB7XG4gICAgICAgICAgc2Vjb25kYXJ5SGFuZC5lbWl0KCdncmlwdXAnKTtcbiAgICAgICAgICB0aGlzLnNlY29uZGFyeUdyaXBEb3duID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2Vjb25kYXJ5SGFuZC5lbWl0KCdncmlwZG93bicpO1xuICAgICAgICAgIHRoaXMuc2Vjb25kYXJ5R3JpcERvd24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIDxtPiBwcmltYXJ5IGdyaXAuXG4gICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc3KSB7XG4gICAgICAgIGlmICh0aGlzLnByaW1hcnlHcmlwRG93bikge1xuICAgICAgICAgIHByaW1hcnlIYW5kLmVtaXQoJ2dyaXB1cCcpO1xuICAgICAgICAgIHRoaXMucHJpbWFyeUdyaXBEb3duID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHJpbWFyeUhhbmQuZW1pdCgnZ3JpcGRvd24nKTtcbiAgICAgICAgICB0aGlzLnByaW1hcnlHcmlwRG93biA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTWVudSBidXR0b24gPDE+LlxuICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA0OSkge1xuICAgICAgICBzZWNvbmRhcnlIYW5kLmVtaXQoJ21lbnVkb3duJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFBvc2l0aW9uIGJpbmRpbmdzLlxuICAgICAgaWYgKGV2dC5jdHJsS2V5KSB7XG4gICAgICAgIHNlY29uZGFyeVBvc2l0aW9uID0gc2Vjb25kYXJ5SGFuZC5nZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJyk7XG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzIpIHsgc2Vjb25kYXJ5UG9zaXRpb24ueCAtPSAwLjAxOyB9ICAvLyBoLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc0KSB7IHNlY29uZGFyeVBvc2l0aW9uLnkgLT0gMC4wMTsgfSAgLy8gai5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA3NSkgeyBzZWNvbmRhcnlQb3NpdGlvbi55ICs9IDAuMDE7IH0gIC8vIGsuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzYpIHsgc2Vjb25kYXJ5UG9zaXRpb24ueCArPSAwLjAxOyB9ICAvLyBsLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDU5IHx8IGV2dC5rZXlDb2RlID09PSAxODYpIHsgc2Vjb25kYXJ5UG9zaXRpb24ueiAtPSAwLjAxOyB9ICAvLyA7LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDIyMikgeyBzZWNvbmRhcnlQb3NpdGlvbi56ICs9IDAuMDE7IH0gIC8vIDsuXG4gICAgICAgIHNlY29uZGFyeUhhbmQuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIEFGUkFNRS51dGlscy5jbG9uZShzZWNvbmRhcnlQb3NpdGlvbikpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJpbWFyeVBvc2l0aW9uID0gcHJpbWFyeUhhbmQuZ2V0QXR0cmlidXRlKCdwb3NpdGlvbicpO1xuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDcyKSB7IHByaW1hcnlQb3NpdGlvbi54IC09IDAuMDE7IH0gIC8vIGguXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzQpIHsgcHJpbWFyeVBvc2l0aW9uLnkgLT0gMC4wMTsgfSAgLy8gai5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA3NSkgeyBwcmltYXJ5UG9zaXRpb24ueSArPSAwLjAxOyB9ICAvLyBrLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc2KSB7IHByaW1hcnlQb3NpdGlvbi54ICs9IDAuMDE7IH0gIC8vIGwuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNTkgfHwgZXZ0LmtleUNvZGUgPT09IDE4NikgeyBwcmltYXJ5UG9zaXRpb24ueiAtPSAwLjAxOyB9ICAvLyA7LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDIyMikgeyBwcmltYXJ5UG9zaXRpb24ueiArPSAwLjAxOyB9ICAvLyA7LlxuICAgICAgICBwcmltYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgQUZSQU1FLnV0aWxzLmNsb25lKHByaW1hcnlQb3NpdGlvbikpO1xuICAgICAgfVxuXG4gICAgICAvLyBSb3RhdGlvbiBiaW5kaW5ncy5cbiAgICAgIGlmIChldnQuY3RybEtleSkge1xuICAgICAgICBzZWNvbmRhcnlSb3RhdGlvbiA9IHNlY29uZGFyeUhhbmQuZ2V0QXR0cmlidXRlKCdyb3RhdGlvbicpO1xuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDg5KSB7IHNlY29uZGFyeVJvdGF0aW9uLnggLT0gMTA7IH0gIC8vIHkuXG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNzkpIHsgc2Vjb25kYXJ5Um90YXRpb24ueCArPSAxMDsgfSAgLy8gby5cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSA4NSkgeyBzZWNvbmRhcnlSb3RhdGlvbi55IC09IDEwOyB9ICAvLyB1LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDczKSB7IHNlY29uZGFyeVJvdGF0aW9uLnkgKz0gMTA7IH0gIC8vIGkuXG4gICAgICAgIHNlY29uZGFyeUhhbmQuc2V0QXR0cmlidXRlKCdyb3RhdGlvbicsIEFGUkFNRS51dGlscy5jbG9uZShzZWNvbmRhcnlSb3RhdGlvbikpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJpbWFyeVJvdGF0aW9uID0gcHJpbWFyeUhhbmQuZ2V0QXR0cmlidXRlKCdyb3RhdGlvbicpO1xuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDg5KSB7IHByaW1hcnlSb3RhdGlvbi54IC09IDEwOyB9ICAvLyB5LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDc5KSB7IHByaW1hcnlSb3RhdGlvbi54ICs9IDEwOyB9ICAvLyBvLlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDg1KSB7IHByaW1hcnlSb3RhdGlvbi55IC09IDEwOyB9ICAvLyB1LlxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDczKSB7IHByaW1hcnlSb3RhdGlvbi55ICs9IDEwOyB9ICAvLyBpLlxuICAgICAgICBwcmltYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJywgQUZSQU1FLnV0aWxzLmNsb25lKHByaW1hcnlSb3RhdGlvbikpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcHJpbWFyeUhhbmQ7XG4gICAgdmFyIHNlY29uZGFyeUhhbmQ7XG5cbiAgICB0aGlzLmJvdW5kcyA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICBpZiAoIUFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnJykpIHsgcmV0dXJuOyB9XG5cbiAgICBwcmltYXJ5SGFuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyaWdodEhhbmQnKTtcbiAgICBzZWNvbmRhcnlIYW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xlZnRIYW5kJyk7XG5cbiAgICBzZWNvbmRhcnlIYW5kLm9iamVjdDNELnBvc2l0aW9uLnNldCgtMC4yLCAxLjUsIC0wLjUpO1xuICAgIHByaW1hcnlIYW5kLm9iamVjdDNELnBvc2l0aW9uLnNldCgwLjIsIDEuNSwgLTAuNSk7XG4gICAgc2Vjb25kYXJ5SGFuZC5zZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJywge3g6IDM1LCB5OiAwLCB6OiAwfSk7XG4gIH0sXG5cbiAgb25Nb3VzZU1vdmU6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGlyZWN0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICBjb25zdCBtb3VzZSA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG4gICAgY29uc3QgY2FtZXJhUG9zID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICBjb25zdCBib3VuZHMgPSB0aGlzLmJvdW5kcztcbiAgICAgIGNvbnN0IGNhbWVyYSA9IHRoaXMuZWwuc2NlbmVFbC5jYW1lcmE7XG4gICAgICBjb25zdCBsZWZ0ID0gZXZ0LmNsaWVudFggLSBib3VuZHMubGVmdDtcbiAgICAgIGNvbnN0IHRvcCA9IGV2dC5jbGllbnRZIC0gYm91bmRzLnRvcDtcbiAgICAgIG1vdXNlLnggPSAobGVmdCAvIGJvdW5kcy53aWR0aCkgKiAyIC0gMTtcbiAgICAgIG1vdXNlLnkgPSAoLXRvcCAvIGJvdW5kcy5oZWlnaHQpICogMiAtIDE7XG5cbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW1lcmEnKS5vYmplY3QzRC5nZXRXb3JsZFBvc2l0aW9uKGNhbWVyYVBvcyk7XG4gICAgICBkaXJlY3Rpb24uc2V0KG1vdXNlLngsIG1vdXNlLnksIDAuNSkudW5wcm9qZWN0KGNhbWVyYSkuc3ViKGNhbWVyYVBvcykubm9ybWFsaXplKCk7XG5cbiAgICAgIGNvbnN0IGhhbmRQb3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmlnaHRIYW5kJykub2JqZWN0M0QucG9zaXRpb247XG4gICAgICBjb25zdCBkaXN0YW5jZSA9IC1jYW1lcmFQb3MueiAvIGRpcmVjdGlvbi56O1xuICAgICAgY2FtZXJhLmdldFdvcmxkUG9zaXRpb24oaGFuZFBvcykuYWRkKGRpcmVjdGlvbi5tdWx0aXBseVNjYWxhcihkaXN0YW5jZSkpO1xuICAgICAgaGFuZFBvcy55ICs9IDAuODtcbiAgICB9O1xuICB9KSgpXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2RlYnVnLWNvbnRyb2xsZXIuanMiLCIvKipcbiAqIExvZyBjdXJzb3IgZXZlbnRzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2RlYnVnLWN1cnNvcicsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZXZ0ID0+IHtcbiAgICAgIHRoaXMubG9nKCdtb3VzZWVudGVyJywgZXZ0LmRldGFpbC5pbnRlcnNlY3RlZEVsLCAnZ3JlZW4nKTtcbiAgICB9KTtcblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGV2dCA9PiB7XG4gICAgICB0aGlzLmxvZygnbW91c2VsZWF2ZScsIGV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbCwgJ3JlZCcpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XG4gICAgICB0aGlzLmxvZygnY2xpY2snLCBldnQuZGV0YWlsLmludGVyc2VjdGVkRWwsICdibHVlJyk7XG4gICAgfSk7XG4gIH0sXG5cbiAgbG9nOiBmdW5jdGlvbiAoZXZlbnQsIGludGVyc2VjdGVkRWwsIGNvbG9yKSB7XG4gICAgaWYgKGludGVyc2VjdGVkRWwuaWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGAlY1ske2V2ZW50fV0gJHtpbnRlcnNlY3RlZEVsLmlkfWAsIGBjb2xvcjogJHtjb2xvcn1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coYCVjWyR7ZXZlbnR9XWAsIGBjb2xvcjogJHtjb2xvcn1gKTtcbiAgICAgIGNvbnNvbGUubG9nKGludGVyc2VjdGVkRWwpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9kZWJ1Zy1jdXJzb3IuanMiLCIvKipcbiAqIEVtaXQgZXZlbnRzIGZyb20gcXVlcnkgcGFyYW1ldGVyIHRvIHN0YXRlIHRvIGF1dG9tYXRpY2FsbHkgc2V0IHVwIHN0YXRlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2RlYnVnLXNvbmctdGltZScsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ3NvbmcnXSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdkZWJ1Zy1zb25nLXRpbWUnKSkgeyByZXR1cm47IH1cbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyh0aGlzLmVsLmNvbXBvbmVudHMuc29uZy5nZXRDdXJyZW50VGltZSgpKTtcbiAgICB9LCAyNTApO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2RlYnVnLXNvbmctdGltZS5qcyIsIi8qKlxuICogRW1pdCBldmVudHMgZnJvbSBxdWVyeSBwYXJhbWV0ZXIgdG8gc3RhdGUgdG8gYXV0b21hdGljYWxseSBzZXQgdXAgc3RhdGUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnZGVidWctc3RhdGUnLCB7XG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBmbGFncyA9IEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2RlYnVnc3RhdGUnKS50cmltKCk7XG4gICAgaWYgKCFmbGFncykgeyByZXR1cm47IH1cblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZmxhZ3Muc3BsaXQoJywnKS5mb3JFYWNoKGZsYWcgPT4ge1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdChgZGVidWcke2ZsYWcudHJpbSgpfWAsIG51bGwsIGZhbHNlKTtcbiAgICAgIH0pO1xuICAgIH0sIDUwMCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZGVidWctc3RhdGUuanMiLCJpbXBvcnQge2dldEdyaWRVdnN9IGZyb20gJ2FmcmFtZS1hdGxhcy11dnMtY29tcG9uZW50JztcbnJlcXVpcmUoJy4uLy4uL3ZlbmRvci9CdWZmZXJHZW9tZXRyeVV0aWxzJyk7XG5cbmNvbnN0IGNvbG9ySGVscGVyID0gbmV3IFRIUkVFLkNvbG9yKCk7XG5cbmNvbnN0IGdlb21ldHJ5ID0gY3JlYXRlR2VvbWV0cnkoKTtcbmNvbnN0IG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcbiAgYWxwaGFNYXA6IGNyZWF0ZUFscGhhTWFwKCksXG4gIHRyYW5zcGFyZW50OiB0cnVlLFxuICB2ZXJ0ZXhDb2xvcnM6IFRIUkVFLlZlcnRleENvbG9yc1xufSk7XG5cbi8qKlxuICogRmFrZSBnbG93IHVzaW5nIG1lcmdlZCBvdmVybGF5ZWQgY3lsaW5kZXJzIHdpdGggYWxwaGEgbWFwLlxuICogUmVxdWlyZXMgVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdmYWtlLWdsb3cnLCB7XG4gIHNjaGVtYToge1xuICAgIGNvbG9yOiB7ZGVmYXVsdDogJyNGRkYnfVxuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnNldE9iamVjdDNEKCdtZXNoJywgbmV3IFRIUkVFLk1lc2goY3JlYXRlR2VvbWV0cnkodGhpcy5kYXRhLmNvbG9yKSwgbWF0ZXJpYWwpKTtcbiAgfVxufSk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUFscGhhTWFwICgpIHtcbiAgY29uc3QgYWxwaGFDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgYWxwaGFDYW52YXMuaGVpZ2h0ID0gMTtcbiAgYWxwaGFDYW52YXMud2lkdGggPSA0O1xuXG4gIGNvbnN0IGN0eCA9IGFscGhhQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgLy8gRm9yIGZpcnN0IGNvbG9yLlxuICBjdHguZmlsbFN0eWxlID0gJ3JnYigxMCwgMTAsIDEwKSc7XG4gIGN0eC5maWxsUmVjdCgwLCAwLCAxLCAxKTtcbiAgY3R4LmZpbGxTdHlsZSA9ICdyZ2IoMTUsIDE1LCAxNSknO1xuICBjdHguZmlsbFJlY3QoMSwgMCwgMSwgMSk7XG4gIGN0eC5maWxsU3R5bGUgPSAncmdiKDIzLCAyMyAsMjMpJztcbiAgY3R4LmZpbGxSZWN0KDIsIDAsIDEsIDEpO1xuICBjdHguZmlsbFN0eWxlID0gJ3JnYigyOCwgMjgsIDI4KSc7XG4gIGN0eC5maWxsUmVjdCgzLCAwLCAxLCAxKTtcblxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBhbHBoYUNhbnZhcy5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XG4gICAgYWxwaGFDYW52YXMuc3R5bGUuekluZGV4ID0gOTk5OTk5OTk5OTk5O1xuICAgIGFscGhhQ2FudmFzLnN0eWxlLmxlZnQgPSAwO1xuICAgIGFscGhhQ2FudmFzLnN0eWxlLnRvcCA9IDA7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhbHBoYUNhbnZhcyk7XG4gIH0sIDEwMDApO1xuICByZXR1cm4gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoYWxwaGFDYW52YXMpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVHZW9tZXRyeSAoY29sb3IpIHtcbiAgY29sb3JIZWxwZXIuc2V0KGNvbG9yKTtcblxuICBjb25zdCBjeWxpbmRlcnMgPSBbXG4gICAge2hlaWdodDogMC4xODMxLCByYWRpdXM6IDAuMDA1NX0sXG4gICAge2hlaWdodDogMC4xODMyLCByYWRpdXM6IDAuMDA2NX0sXG4gICAge2hlaWdodDogMC4xODMzLCByYWRpdXM6IDAuMDA3NX0sXG4gICAge2hlaWdodDogMC4xODM0LCByYWRpdXM6IDAuMDA4NX1cbiAgXTtcblxuICBjb25zdCBnZW9tZXRyaWVzID0gY3lsaW5kZXJzLm1hcCgoY3lsaW5kZXJEYXRhLCBpKSA9PiB7XG4gICAgY29uc3QgY3lsaW5kZXIgPSBuZXcgVEhSRUUuQ3lsaW5kZXJCdWZmZXJHZW9tZXRyeShcbiAgICAgIGN5bGluZGVyRGF0YS5yYWRpdXMsXG4gICAgICBjeWxpbmRlckRhdGEucmFkaXVzLFxuICAgICAgY3lsaW5kZXJEYXRhLmhlaWdodFxuICAgICk7XG5cbiAgICBjb25zdCBjb2xvckFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjeWxpbmRlci5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5Lmxlbmd0aDsgaSArPSAzKSB7XG4gICAgICBjb2xvckFycmF5W2ldID0gY29sb3JIZWxwZXIucjtcbiAgICAgIGNvbG9yQXJyYXlbaSArIDFdID0gY29sb3JIZWxwZXIuZztcbiAgICAgIGNvbG9yQXJyYXlbaSArIDJdID0gY29sb3JIZWxwZXIuYjtcbiAgICB9XG4gICAgY3lsaW5kZXIuYWRkQXR0cmlidXRlKCdjb2xvcicsIG5ldyBUSFJFRS5GbG9hdDMyQnVmZmVyQXR0cmlidXRlKGNvbG9yQXJyYXksIDMpKTtcblxuICAgIGNvbnN0IGFscGhhVXZzID0gZ2V0R3JpZFV2cygwLCBpLCAxLCA0KTtcbiAgICBjb25zdCB1dnMgPSBjeWxpbmRlci5hdHRyaWJ1dGVzLnV2LmFycmF5O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXZzLmxlbmd0aDsgaSArPSA2KSB7XG4gICAgICB1dnNbaV0gPSBhbHBoYVV2c1swXS54O1xuICAgICAgdXZzW2kgKyAxXSA9IGFscGhhVXZzWzBdLnk7XG5cbiAgICAgIHV2c1tpICsgMl0gPSBhbHBoYVV2c1sxXS54O1xuICAgICAgdXZzW2kgKyAzXSA9IGFscGhhVXZzWzFdLnk7XG5cbiAgICAgIHV2c1tpICsgNF0gPSBhbHBoYVV2c1syXS54O1xuICAgICAgdXZzW2kgKyA1XSA9IGFscGhhVXZzWzJdLnk7XG4gICAgfVxuICAgIGN5bGluZGVyLmF0dHJpYnV0ZXMudXYubmVlZHNVcGRhdGUgPSB0cnVlO1xuXG4gICAgcmV0dXJuIGN5bGluZGVyO1xuICB9KTtcblxuICBjb25zdCBnZW9tZXRyeSA9IFRIUkVFLkJ1ZmZlckdlb21ldHJ5VXRpbHMubWVyZ2VCdWZmZXJHZW9tZXRyaWVzKGdlb21ldHJpZXMpO1xuICByZXR1cm4gZ2VvbWV0cnlcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2Zha2UtZ2xvdy5qcyIsIlxuY29uc3QgQ09MT1JTID0gcmVxdWlyZSgnLi4vY29uc3RhbnRzL2NvbG9ycy5qcycpO1xuY29uc3QgSElUX0NPTE9SID0gbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5ORU9OX1JFRCk7XG5jb25zdCBCT1JERVJfQ09MT1IgPSBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fQkxVRSk7XG5cbkFGUkFNRS5yZWdpc3RlclNoYWRlcignZmxvb3JTaGFkZXInLCB7XG4gIHNjaGVtYToge1xuICAgIG5vcm1hbE1hcDoge3R5cGU6ICdtYXAnLCBpczogJ3VuaWZvcm0nfSxcbiAgICBlbnZNYXA6IHt0eXBlOiAnbWFwJywgaXM6ICd1bmlmb3JtJ30sXG4gICAgaGl0UmlnaHQ6IHt0eXBlOiAndmVjMycsIGlzOiAndW5pZm9ybScsIGRlZmF1bHQ6IHt4OiAwLCB5OiAxLCB6OiAwfX0sXG4gICAgaGl0TGVmdDoge3R5cGU6ICd2ZWMzJywgaXM6ICd1bmlmb3JtJywgZGVmYXVsdDoge3g6IDAsIHk6IDAsIHo6IDB9fVxuICB9LFxuXG4gIHZlcnRleFNoYWRlcjogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHV2cy54eSA9IHV2Lnh5O1xuICAgICAgdmVjNCBwID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcbiAgICAgIHdvcmxkUG9zID0gKG1vZGVsTWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApKS54eXo7XG4gICAgICBnbF9Qb3NpdGlvbiA9IHA7XG4gICAgfVxuICBgLFxuXG4gIGZyYWdtZW50U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdW5pZm9ybSB2ZWMzIGNvbG9yO1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIG5vcm1hbE1hcDtcbiAgICB1bmlmb3JtIHNhbXBsZXIyRCBlbnZNYXA7XG4gICAgdW5pZm9ybSB2ZWMzIGhpdFJpZ2h0O1xuICAgIHVuaWZvcm0gdmVjMyBoaXRMZWZ0O1xuXG4gICAgI2RlZmluZSBISVRfQ09MT1IgdmVjMygke0hJVF9DT0xPUi5yfSwgJHtISVRfQ09MT1IuZ30sICR7SElUX0NPTE9SLmJ9KVxuICAgICNkZWZpbmUgQk9SREVSX0NPTE9SIHZlYzMoJHtCT1JERVJfQ09MT1Iucn0sICR7Qk9SREVSX0NPTE9SLmd9LCAke0JPUkRFUl9DT0xPUi5ifSlcblxuICAgIHZlYzMgZHJhd0NpcmNsZSh2ZWMzIHAsIHZlYzMgY2VudGVyLCBmbG9hdCByYWRpdXMsIGZsb2F0IGVkZ2VXaWR0aCwgdmVjMyBjb2xvcikge1xuICAgICAgcmV0dXJuIGNvbG9yKigxLjAtc21vb3Roc3RlcChyYWRpdXMsIHJhZGl1cytlZGdlV2lkdGgsIGxlbmd0aChwLWNlbnRlcikpKTtcbiAgICB9XG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB2ZWMyIHAgPSB1dnMueHkgLSAwLjU7XG4gICAgICB2ZWMzIGJvcmRlciA9IHZlYzMoc21vb3Roc3RlcCgwLjQ5LCAwLjQ5NSwgYWJzKHAueCkpICsgc21vb3Roc3RlcCgwLjQ5LCAwLjQ5NSwgYWJzKHAueSkpKTtcbiAgICAgIGJvcmRlciArPSBCT1JERVJfQ09MT1IgKiAoc21vb3Roc3RlcCgwLjQ3NSwgMC40OTUsIGFicyhwLngpKSArIHNtb290aHN0ZXAoMC40NzUsIDAuNDk1LCBhYnMocC55KSkpICogLjc7XG4gICAgICBwKj0gNC4wO1xuXG4gICAgICB2ZWMzIGhpdENvbG9yID0gSElUX0NPTE9SO1xuICAgICAgdmVjMyBoaXQgPSB2ZWMzKDAuMCk7XG5cbiAgICAgIGhpdCArPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRSaWdodCwgMC4wNCwgMC4wNSwgaGl0Q29sb3IpO1xuICAgICAgaGl0ICs9IGRyYXdDaXJjbGUod29ybGRQb3MsIGhpdFJpZ2h0LCAwLjAyLCAwLjAzLCB2ZWMzKDAuNywgMC43LCAwLjcpKTtcbiAgICAgIGhpdCArPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRMZWZ0LCAwLjA0LCAwLjA1LCBoaXRDb2xvcik7XG4gICAgICBoaXQgKz0gZHJhd0NpcmNsZSh3b3JsZFBvcywgaGl0TGVmdCwgMC4wMiwgMC4wMywgdmVjMygwLjcsIDAuNywgMC43KSk7XG5cbiAgICAgIHZlYzMgbm9ybWFsID0gbm9ybWFsaXplKHRleHR1cmUyRChub3JtYWxNYXAsIHV2cykueHl6KTtcblxuICAgICAgLy8gZW52aXJvbm1lbnQgcmVmbGVjdGlvblxuICAgICAgdmVjMyByZWZsZWN0VmVjID0gbm9ybWFsaXplKHJlZmxlY3Qobm9ybWFsaXplKHdvcmxkUG9zIC0gY2FtZXJhUG9zaXRpb24pLCBub3JtYWwpKTtcbiAgICAgIC8vdmVjMyByZWZsZWN0VmlldyA9IG5vcm1hbGl6ZSgodmlld01hdHJpeCAqIHZlYzQocmVmbGVjdFZlYywgMC4wKSkueHl6ICsgdmVjMygwLjAsIDAuMCwgMS4wKSk7XG5cbiAgICAgIHZlYzMgcmVmID0gdGV4dHVyZTJEKGVudk1hcCwgcmVmbGVjdFZlYy54eSAqIHZlYzIoMC4zLCAxLjApICsgdmVjMigwLjc1LCAtY2FtZXJhUG9zaXRpb24ueiAqIDAuMDUpKS54eXogKiAwLjE0O1xuXG4gICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KHJlZiArIGJvcmRlciArIGhpdCwgMS4wKTtcbiAgICB9XG4gIGBcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZmxvb3Itc2hhZGVyLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdnYW1lb3ZlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNHYW1lT3Zlcjoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJlYXRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmVhdENvbnRhaW5lcicpO1xuICAgIHRoaXMuZ2FtZU92ZXJFbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbYW5pbWF0aW9uX19nYW1lb3Zlcl0nKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgaWYgKCFvbGREYXRhLmlzR2FtZU92ZXIgJiYgdGhpcy5kYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgIHRoaXMudHJpZ2dlckFuaW1hdGlvbnMoKTtcbiAgICAgIHRoaXMuY291bnREb3duID0gMTtcbiAgICB9XG4gICAgaWYgKG9sZERhdGEuaXNHYW1lT3ZlciAmJiAhdGhpcy5kYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuaXNHYW1lT3ZlcikgeyByZXR1cm47IH1cbiAgICBpZiAodGhpcy5jb3VudERvd24gPj0gMCkge1xuICAgICAgdGhpcy5iZWF0Q29udGFpbmVyLm9iamVjdDNELnBvc2l0aW9uLnogPSAtTWF0aC5wb3coMSAtIHRoaXMuY291bnREb3duLCAyKSAqIDEuNTtcbiAgICAgIHRoaXMuY291bnREb3duIC09IGRlbHRhIC8gMTAwMDtcbiAgICB9XG4gIH0sXG5cbiAgcmVzZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmJlYXRDb250YWluZXIub2JqZWN0M0QucG9zaXRpb24ueiA9IDA7XG4gICAgdGhpcy5lbC5zY2VuZUVsLnNldEF0dHJpYnV0ZSgnc3RhZ2UtY29sb3JzJywgJ2NvbG9yJywgJ2JsdWUnKTtcbiAgfSxcblxuICB0cmlnZ2VyQW5pbWF0aW9uczogZnVuY3Rpb24gKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5nYW1lT3ZlckVscy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5nYW1lT3ZlckVsc1tpXS5lbWl0KCdnYW1lb3ZlcicsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gICAgdGhpcy5lbC5lbWl0KCd0ZXh0Z2xvd29mZicsIG51bGwsIGZhbHNlKTtcbiAgICB0aGlzLmVsLmVtaXQoJ2JnY29sb3JnYW1lb3ZlcicsIG51bGwsIGZhbHNlKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9nYW1lb3Zlci5qcyIsImxldCBpID0gMDtcblxuLyoqXG4gKiBQcmVsb2FkIHRleHR1cmVzIHRvIEdQVSB0aGF0IGFyZSBub3QgdmlzaWJsZSBmcm9tIHRoZSBzdGFydC4uXG4gKiB0aHJlZS5qcyByZW5kZXJlciBieSBkZWZhdWx0IHdpbGwgbm90IHVwbG9hZCB0ZXh0dXJlcyBmcm9tIG5vbi12aXNpYmxlIGVudGl0aWVzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2dwdS1wcmVsb2FkZXInLCB7XG4gIGRlcGVuZGVuY2llczogWydtYXRlcmlhbHMnXSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5wcmVsb2FkTWluZUVudk1hcHMoKTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5wcmVsb2FkQXRsYXMoKTtcbiAgICAgIHRoaXMucHJlbG9hZExvZ28oKTtcbiAgICAgIC8vdGhpcy5wcmVsb2RCZWFtTWFwKCk7XG4gICAgICB0aGlzLnByZWxvYWRCZWF0RW52TWFwKCk7XG4gICAgICB0aGlzLnByZWxvYWRDdXRQYXJ0aWNsZXMoKTtcbiAgICAgIHRoaXMucHJlbG9hZEtleWJvYXJkKCk7XG4gICAgICAvL3RoaXMucHJlbG9hZE1pc3NNYXAoKTtcbiAgICAgIHRoaXMucHJlbG9hZFBsYXlCdXR0b24oKTtcbiAgICAgIHRoaXMucHJlbG9hZFNlYXJjaFByZXZQYWdlKCk7XG4gICAgICAvL3RoaXMucHJlbG9hZFdhbGxNYXAoKTtcbiAgICAgIC8vdGhpcy5wcmVsb2FkV3JvbmdNYXAoKTtcbiAgICAgIHRoaXMucHJlbG9hZEdlbnJlcygpO1xuICAgIH0sIDEwMDApO1xuICB9LFxuXG4gIHByZWxvYWRBdGxhczogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHN0YWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0YWdlT2JqJyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShzdGFnZS5nZXRPYmplY3QzRCgnbWVzaCcpLmNoaWxkcmVuWzBdLm1hdGVyaWFsLnVuaWZvcm1zLnNyYy52YWx1ZSk7XG4gIH0sXG5cbiAgcHJlbG9hZExvZ286IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBsb2dvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xvZ29Cb2R5Jyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShsb2dvLmdldE9iamVjdDNEKCdtZXNoJykuY2hpbGRyZW5bMF0ubWF0ZXJpYWwudW5pZm9ybXMuc3JjLnZhbHVlKTtcbiAgfSxcblxuICBwcmVsb2FkQmVhbU1hcDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGJlYW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2JlYW1zXScpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUoYmVhbXMuY29tcG9uZW50cy5iZWFtcy50ZXh0dXJlKTtcbiAgfSxcblxuICBwcmVsb2FkQmVhdEVudk1hcDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGJlYXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYmVhdENvbnRhaW5lciBbbWl4aW5+PVwiYmVhdFwiXScpO1xuICAgIGJlYXQub2JqZWN0M0QudHJhdmVyc2Uobm9kZSA9PiB7XG4gICAgICBpZiAoIW5vZGUubWF0ZXJpYWwpIHsgcmV0dXJuOyB9XG4gICAgICBpZiAobm9kZS5tYXRlcmlhbC5lbnZNYXApIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkVGV4dHVyZShub2RlLm1hdGVyaWFsLmVudk1hcCk7XG4gICAgICB9XG4gICAgICBpZiAobm9kZS5tYXRlcmlhbC5tYXApIHtcbiAgICAgICAgdGhpcy5wcmVsb2FkVGV4dHVyZShub2RlLm1hdGVyaWFsLm1hcCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgcHJlbG9hZEN1dFBhcnRpY2xlczogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHBhcnRpY2xlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzYWJlclBhcnRpY2xlcycpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUocGFydGljbGVzLmNvbXBvbmVudHMucGFydGljbGVwbGF5ZXIubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkS2V5Ym9hcmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBrZXlib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXlib2FyZCcpLmNvbXBvbmVudHNbJ3N1cGVyLWtleWJvYXJkJ107XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShrZXlib2FyZC5rYkltZy5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm1hcCk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShrZXlib2FyZC5rZXlDb2xvclBsYW5lLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkTWluZUVudk1hcHM6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBzdGFnZUNvbG9ycyA9IHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzWydzdGFnZS1jb2xvcnMnXTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignbWluZXJlZGVudm1hcGxvYWRlZCcsICgpID0+IHtcbiAgICAgIHRoaXMucHJlbG9hZFRleHR1cmUoc3RhZ2VDb2xvcnMubWluZUVudk1hcC5yZWQpO1xuICAgIH0pO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdtaW5lYmx1ZWVudm1hcGxvYWRlZCcsICgpID0+IHtcbiAgICAgIHRoaXMucHJlbG9hZFRleHR1cmUoc3RhZ2VDb2xvcnMubWluZUVudk1hcC5ibHVlKTtcbiAgICB9KTtcbiAgfSxcblxuICBwcmVsb2FkTWlzc01hcDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IG1pc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWlzc0xlZnQnKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKG1pc3MuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5tYXApO1xuICB9LFxuXG4gIHByZWxvYWRQbGF5QnV0dG9uOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcGxheUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwbGF5QnV0dG9uJyk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZShwbGF5QnV0dG9uLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkU2VhcmNoUHJldlBhZ2UgOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcHJldlBhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2VhcmNoUHJldlBhZ2UnKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKHByZXZQYWdlLmNoaWxkcmVuWzBdLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkV2FsbE1hcDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHdhbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhLWVudGl0eVt3YWxsXScpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUod2FsbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLnVuaWZvcm1zLnRleC52YWx1ZSk7XG4gICAgdGhpcy5wcmVsb2FkVGV4dHVyZSh3YWxsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwudW5pZm9ybXMuZW52LnZhbHVlKTtcbiAgfSxcblxuICBwcmVsb2FkV3JvbmdNYXA6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB3cm9uZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN3cm9uZ0xlZnQnKTtcbiAgICB0aGlzLnByZWxvYWRUZXh0dXJlKHdyb25nLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkR2VucmVzOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZ2VucmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdlbnJlSWNvbicpO1xuICAgIHRoaXMucHJlbG9hZFRleHR1cmUoZ2VucmVzLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwKTtcbiAgfSxcblxuICBwcmVsb2FkVGV4dHVyZTogZnVuY3Rpb24gKHRleHR1cmUpIHtcbiAgICBpZiAoIXRleHR1cmUgfHwgIXRleHR1cmUuaW1hZ2UpIHtcbiAgICAgIGNvbnNvbGUud2FybignW2dwdS1wcmVsb2FkZXJdIEVycm9yIHByZWxvYWRpbmcgdGV4dHVyZScsIHRleHR1cmUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRleHR1cmUuaW1hZ2UuY29tcGxldGUpIHtcbiAgICAgIGNvbnNvbGUud2FybignW2dwdS1wcmVsb2FkZXJdIEVycm9yIHByZWxvYWRpbmcsIGltYWdlIG5vdCBsb2FkZWQnLCB0ZXh0dXJlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5lbC5yZW5kZXJlci5zZXRUZXh0dXJlMkQodGV4dHVyZSwgaSsrICUgOCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvZ3B1LXByZWxvYWRlci5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnaGFjaycsIHtcbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVudGVyVlIoKTtcbiAgICB9LCAzMDAwKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9oYWNrLmpzIiwiY29uc3QgZXZlbnRzID0gW1xuICAndHJpZ2dlcmRvd24nLFxuICAnZ3JpcGRvd24nLFxuICAnYWJ1dHRvbmRvd24nLFxuICAnYmJ1dHRvbmRvd24nLFxuICAneGJ1dHRvbmRvd24nLFxuICAneWJ1dHRvbmRvd24nLFxuICAndHJhY2twYWRkb3duJ1xuXTtcblxuLyoqXG4gKiBTd2FwIGxlZnQgb3IgcmlnaHQtaGFuZGVkIG1vZGUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnaGFuZC1zd2FwcGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3dhcEhhbmQgPSB0aGlzLnN3YXBIYW5kLmJpbmQodGhpcyk7XG4gICAgZXZlbnRzLmZvckVhY2goZXZlbnQgPT4ge1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCB0aGlzLnN3YXBIYW5kKTtcbiAgICB9KTtcbiAgfSxcblxuICBzd2FwSGFuZDogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBIYW5kbGVkIHZpYSBzdGF0ZS5cbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnYWN0aXZlaGFuZHN3YXAnLCBudWxsLCBmYWxzZSk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvaGFuZC1zd2FwcGVyLmpzIiwiLyoqXG4gKiBIYXB0aWNzIHdoZW4gc2FiZXJzIGNvbGxpZGUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnaGFwdGljcy1zYWJlcicsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcblxuICAgIHRoaXMuaXNDb2xsaWRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnRpY2sgPSBBRlJBTUUudXRpbHMudGhyb3R0bGVUaWNrKHRoaXMudGljay5iaW5kKHRoaXMpLCAxMDApO1xuXG4gICAgZWwuc2V0QXR0cmlidXRlKCdoYXB0aWNzX19zYWJlcicsIHtkdXI6IDEwMCwgZm9yY2U6IDAuMDc1fSk7XG5cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZXZ0ID0+IHtcbiAgICAgIGlmICghZXZ0LmRldGFpbCB8fCAhZXZ0LmRldGFpbC5pbnRlcnNlY3RlZEVsKSB7IHJldHVybjsgfVxuXG4gICAgICBjb25zdCBpbnRlcnNlY3RlZEVsID0gZXZ0LmRldGFpbC5pbnRlcnNlY3RlZEVsO1xuICAgICAgaWYgKCFpbnRlcnNlY3RlZEVsLmNsYXNzTGlzdC5jb250YWlucygnYmxhZGUnKSB8fCBpbnRlcnNlY3RlZEVsID09PSBlbCkge1xuICAgICAgICB0aGlzLmlzQ29sbGlkaW5nID0gZmFsc2U7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5pc0NvbGxpZGluZyA9IHRydWU7XG4gICAgICB0aGlzLmVsLmNvbXBvbmVudHMuaGFwdGljc19fc2FiZXIucHVsc2UoKTtcbiAgICB9KTtcblxuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCBldnQgPT4ge1xuICAgICAgdGhpcy5pc0NvbGxpZGluZyA9IGZhbHNlO1xuICAgIH0pO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNDb2xsaWRpbmcpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5jb21wb25lbnRzLmhhcHRpY3NfX3NhYmVyLnB1bHNlKCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvaGFwdGljcy1zYWJlci5qcyIsIi8qKlxuICogTGlzdGVuIHRvIGFhYmItY29sbGlkZXIgZXZlbnQgZm9yIHdhbGwgaGFwdGljcy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdoYXB0aWNzLXdhbGwnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgdGhpcy5pc0hpdHRpbmdXYWxsID0gZmFsc2U7XG4gICAgZWwuc2V0QXR0cmlidXRlKCdoYXB0aWNzX193YWxsJywge2R1cjogNTAsIGZvcmNlOiAwLjA3NX0pO1xuXG4gICAgdGhpcy5jaGVja0lmSGl0dGluZ1dhbGwgPSB0aGlzLmNoZWNrSWZIaXR0aW5nV2FsbC5iaW5kKHRoaXMpO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCB0aGlzLmNoZWNrSWZIaXR0aW5nV2FsbCk7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMuY2hlY2tJZkhpdHRpbmdXYWxsKTtcblxuICAgIHRoaXMudGljayA9IEFGUkFNRS51dGlscy50aHJvdHRsZVRpY2sodGhpcy50aWNrLmJpbmQodGhpcyksIDUwKTtcbiAgfSxcblxuICAvKipcbiAgICogT24gcmF5Y2FzdGVyIGV2ZW50LCBjaGVjayBpZiB3ZSBhcmUgc3RpbGwgaGl0dGluZyBhIHdhbGwuXG4gICAqL1xuICBjaGVja0lmSGl0dGluZ1dhbGw6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBpbnRlcnNlY3RlZEVscyA9IHRoaXMuZWwuY29tcG9uZW50cy5yYXljYXN0ZXJfX2dhbWUuaW50ZXJzZWN0ZWRFbHM7XG4gICAgdGhpcy5pc0hpdHRpbmdXYWxsID0gZmFsc2U7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnRlcnNlY3RlZEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGludGVyc2VjdGVkRWxzW2ldLmNvbXBvbmVudHMud2FsbCkge1xuICAgICAgICB0aGlzLmlzSGl0dGluZ1dhbGwgPSB0cnVlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNIaXR0aW5nV2FsbCkgeyByZXR1cm47IH1cbiAgICB0aGlzLmVsLmNvbXBvbmVudHMuaGFwdGljc19fd2FsbC5wdWxzZSgpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2hhcHRpY3Mtd2FsbC5qcyIsIi8qKlxuICogVXBkYXRlIHdpbmRvdyB0aXRsZSBhbmQgaGlzdG9yeS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdoaXN0b3J5Jywge1xuICBzY2hlbWE6IHtcbiAgICBjaGFsbGVuZ2VJZDoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBzb25nTmFtZToge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBzb25nU3ViTmFtZToge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgaGlzdG9yeS5wdXNoU3RhdGUoXG4gICAgICAnJyxcbiAgICAgIGRhdGEuc29uZ05hbWUsXG4gICAgICB1cGRhdGVRdWVyeVBhcmFtKHdpbmRvdy5sb2NhdGlvbi5ocmVmLCAnY2hhbGxlbmdlJywgZGF0YS5jaGFsbGVuZ2VJZClcbiAgICApO1xuICAgIGRvY3VtZW50LnRpdGxlID0gYFN1cGVyIFNhYmVyIC0gJHtkYXRhLnNvbmdOYW1lfWA7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvaGlzdG9yeS5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnaW50cm8tc29uZycsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNQbGF5aW5nOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgaXNTZWFyY2hpbmc6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5hbmFseXNlckVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F1ZGlvQW5hbHlzZXInKTtcbiAgICB0aGlzLmF1ZGlvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ludHJvU29uZycpO1xuICAgIHRoaXMudGltZW91dCA9IG51bGw7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGNvbnN0IGF1ZGlvID0gdGhpcy5hdWRpbztcblxuICAgIGlmICghdGhpcy5lbC5zY2VuZUVsLmlzUGxheWluZykgeyByZXR1cm47IH1cblxuICAgIGlmICghb2xkRGF0YS5pc1NlYXJjaGluZyAmJiB0aGlzLmRhdGEuaXNTZWFyY2hpbmcpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBQbGF5LlxuICAgIGlmICghb2xkRGF0YS5pc1BsYXlpbmcgJiYgdGhpcy5kYXRhLmlzUGxheWluZykge1xuICAgICAgdGhpcy5hbmFseXNlckVsLmNvbXBvbmVudHMuYXVkaW9hbmFseXNlci5yZXN1bWVDb250ZXh0KCk7XG4gICAgICB0aGlzLmFuYWx5c2VyRWwuc2V0QXR0cmlidXRlKCdhdWRpb2FuYWx5c2VyJywgJ3NyYycsIGF1ZGlvKTtcbiAgICAgIHRoaXMuZmFkZUluQXVkaW8oKTtcbiAgICB9XG5cbiAgICAvLyBQYXVzZS5cbiAgICBpZiAob2xkRGF0YS5pc1BsYXlpbmcgJiYgIXRoaXMuZGF0YS5pc1BsYXlpbmcpIHsgYXVkaW8ucGF1c2UoKTsgfVxuICB9LFxuXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5hdWRpby5wYXVzZSgpO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZhZGVJbkF1ZGlvKCk7XG4gIH0sXG5cbiAgZmFkZUluQXVkaW86IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignbXV0ZScpKSB7IHJldHVybjsgfVxuICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmFuYWx5c2VyRWwuY29tcG9uZW50cy5hdWRpb2FuYWx5c2VyLmNvbnRleHQ7XG4gICAgY29uc3QgZ2Fpbk5vZGUgPSB0aGlzLmFuYWx5c2VyRWwuY29tcG9uZW50cy5hdWRpb2FuYWx5c2VyLmdhaW5Ob2RlO1xuICAgIGdhaW5Ob2RlLmdhaW4uc2V0VmFsdWVBdFRpbWUoMCwgY29udGV4dC5jdXJyZW50VGltZSk7XG4gICAgdGhpcy5hdWRpby5wbGF5KCk7XG4gICAgZ2Fpbk5vZGUuZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgwLjUsIGNvbnRleHQuY3VycmVudFRpbWUgKyAwLjUpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2ludHJvLXNvbmcuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2tleWJvYXJkLXJheWNhc3RhYmxlJywge1xuICBkZXBlbmRlbmNpZXM6IFsnc3VwZXIta2V5Ym9hcmQnXSxcblxuICBzY2hlbWE6IHtcbiAgICBjb25kaXRpb246IHtkZWZhdWx0OiAnJ31cbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5jb21wb25lbnRzWydzdXBlci1rZXlib2FyZCddLmtiSW1nLnNldEF0dHJpYnV0ZSgnYmluZC10b2dnbGVfX3JheWNhc3RhYmxlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5jb25kaXRpb24pO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL2tleWJvYXJkLXJheWNhc3RhYmxlLmpzIiwiY29uc3QgZmlyZWJhc2UgPSByZXF1aXJlKCdmaXJlYmFzZS9hcHAnKTtcbnJlcXVpcmUoJ2ZpcmViYXNlL2ZpcmVzdG9yZScpO1xuXG5jb25zdCBOVU1fU0NPUkVTX0RJU1BMQVlFRCA9IDEwO1xuXG4vKipcbiAqIEhpZ2ggc2NvcmUgd2l0aCBGaXJlYmFzZSBjbG91ZCBzdG9yZS5cbiAqIEluZGV4OiBjaGFsbGVuZ2VJZCBBU0MgZGlmZmljdWx0eSBBU0Mgc2NvcmUgREVTQyB0aW1lIEFTQ1xuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ2xlYWRlcmJvYXJkJywge1xuICBzY2hlbWE6IHtcbiAgICBhcGlLZXk6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgYXV0aERvbWFpbjoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBkYXRhYmFzZVVSTDoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBwcm9qZWN0SWQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgc3RvcmFnZUJ1Y2tldDoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBtZXNzYWdpbmdTZW5kZXJJZDoge3R5cGU6ICdzdHJpbmcnfSxcblxuICAgIGNoYWxsZW5nZUlkOiB7ZGVmYXVsdDogJyd9LFxuICAgIG1lbnVTZWxlY3RlZENoYWxsZW5nZUlkOiB7ZGVmYXVsdDogJyd9LFxuICAgIGlzVmljdG9yeToge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnF1YWxpZnlpbmdJbmRleCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNjb3JlcyA9IFtdO1xuICAgIHRoaXMuZXZlbnREZXRhaWwgPSB7c2NvcmVzOiB0aGlzLnNjb3Jlc307XG4gICAgdGhpcy5hZGRFdmVudERldGFpbCA9IHtzY29yZURhdGE6IHVuZGVmaW5lZCwgaW5kZXg6IHVuZGVmaW5lZH07XG5cbiAgICB0aGlzLnVzZXJuYW1lID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3N1cGVyc2FiZXJ1c2VybmFtZScpIHx8ICdTdXBlciBaZWFsb3QnO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbGVhZGVyYm9hcmR1c2VybmFtZScsIGV2dCA9PiB7XG4gICAgICB0aGlzLnVzZXJuYW1lID0gZXZ0LmRldGFpbC52YWx1ZTtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzdXBlcnNhYmVydXNlcm5hbWUnLCB0aGlzLnVzZXJuYW1lKTtcbiAgICB9KTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xlYWRlcmJvYXJkc3VibWl0JywgdGhpcy5hZGRTY29yZS5iaW5kKHRoaXMpKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgLy8gSW5pdGlhbGl6ZSBDbG91ZCBGaXJlc3RvcmUgdGhyb3VnaCBGaXJlYmFzZS5cbiAgICBpZiAoIWZpcmViYXNlLmFwcHMubGVuZ3RoICYmIHRoaXMuZGF0YS5hcGlLZXkpIHtcbiAgICAgIGZpcmViYXNlLmluaXRpYWxpemVBcHAoe1xuICAgICAgICBhcGlLZXk6IHRoaXMuZGF0YS5hcGlLZXksXG4gICAgICAgIGF1dGhEb21haW46IHRoaXMuZGF0YS5hdXRoRG9tYWluLFxuICAgICAgICBkYXRhYmFzZVVSTDogdGhpcy5kYXRhLmRhdGFiYXNlVVJMLFxuICAgICAgICBwcm9qZWN0SWQ6IHRoaXMuZGF0YS5wcm9qZWN0SWQsXG4gICAgICAgIHN0b3JhZ2VCdWNrZXQ6IHRoaXMuZGF0YS5zdG9yYWdlQnVja2V0LFxuICAgICAgICBtZXNzYWdpbmdTZW5kZXJJZDogdGhpcy5kYXRhLm1lc3NhZ2luZ1NlbmRlcklkXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZmlyZXN0b3JlID0gZmlyZWJhc2UuZmlyZXN0b3JlKCk7XG4gICAgICB0aGlzLmZpcmVzdG9yZS5zZXR0aW5ncyh7dGltZXN0YW1wc0luU25hcHNob3RzOiB0cnVlfSk7XG4gICAgICB0aGlzLmRiID0gdGhpcy5maXJlc3RvcmUuY29sbGVjdGlvbignc2NvcmVzJyk7XG4gICAgfVxuXG4gICAgaWYgKCFvbGREYXRhLmlzVmljdG9yeSAmJiB0aGlzLmRhdGEuaXNWaWN0b3J5KSB7XG4gICAgICB0aGlzLmNoZWNrTGVhZGVyYm9hcmRRdWFsaWZ5KCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCAmJlxuICAgICAgICBvbGREYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkICE9PSB0aGlzLmRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQpIHtcbiAgICAgIHRoaXMuZmV0Y2hTY29yZXModGhpcy5kYXRhLm1lbnVTZWxlY3RlZENoYWxsZW5nZUlkKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kYXRhLmNoYWxsZW5nZUlkICYmIG9sZERhdGEuY2hhbGxlbmdlSWQgIT09IHRoaXMuZGF0YS5jaGFsbGVuZ2VJZCkge1xuICAgICAgdGhpcy5mZXRjaFNjb3Jlcyh0aGlzLmRhdGEuY2hhbGxlbmdlSWQpO1xuICAgIH1cbiAgfSxcblxuICBhZGRTY29yZTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMuc3RhdGUuc3RhdGU7XG4gICAgaWYgKCFzdGF0ZS5pc1ZpY3RvcnkpIHsgcmV0dXJuOyB9XG4gICAgY29uc3Qgc2NvcmVEYXRhID0ge1xuICAgICAgYWNjdXJhY3k6IHN0YXRlLnNjb3JlLmFjY3VyYWN5LFxuICAgICAgY2hhbGxlbmdlSWQ6IHN0YXRlLmNoYWxsZW5nZS5pZCxcbiAgICAgIHNjb3JlOiBzdGF0ZS5zY29yZS5zY29yZSxcbiAgICAgIHVzZXJuYW1lOiB0aGlzLnVzZXJuYW1lLFxuICAgICAgZGlmZmljdWx0eTogc3RhdGUuY2hhbGxlbmdlLmRpZmZpY3VsdHksXG4gICAgICB0aW1lOiBuZXcgRGF0ZSgpXG4gICAgfTtcbiAgICB0aGlzLmRiLmFkZChzY29yZURhdGEpO1xuICAgIHRoaXMuYWRkRXZlbnREZXRhaWwuc2NvcmVEYXRhID0gc2NvcmVEYXRhO1xuICAgIHRoaXMuZWwuZW1pdCgnbGVhZGVyYm9hcmRzY29yZWFkZGVkJywgdGhpcy5hZGRFdmVudERldGFpbCwgZmFsc2UpO1xuICB9LFxuXG4gIGZldGNoU2NvcmVzOiBmdW5jdGlvbiAoY2hhbGxlbmdlSWQpIHtcbiAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlLnN0YXRlO1xuICAgIGNvbnN0IHF1ZXJ5ID0gdGhpcy5kYlxuICAgICAgLndoZXJlKCdjaGFsbGVuZ2VJZCcsICc9PScsIGNoYWxsZW5nZUlkKVxuICAgICAgLndoZXJlKFxuICAgICAgICAnZGlmZmljdWx0eScsICc9PScsXG4gICAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pZFxuICAgICAgICAgID8gc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmRpZmZpY3VsdHlcbiAgICAgICAgICA6IHN0YXRlLmNoYWxsZW5nZS5kaWZmaWN1bHR5KVxuICAgICAgLm9yZGVyQnkoJ3Njb3JlJywgJ2Rlc2MnKVxuICAgICAgLm9yZGVyQnkoJ3RpbWUnLCAnYXNjJylcbiAgICAgIC5saW1pdCgxMCk7XG4gICAgcXVlcnkuZ2V0KCkudGhlbihzbmFwc2hvdCA9PiB7XG4gICAgICB0aGlzLmV2ZW50RGV0YWlsLmNoYWxsZW5nZUlkID0gY2hhbGxlbmdlSWQ7XG4gICAgICB0aGlzLnNjb3Jlcy5sZW5ndGggPSAwO1xuICAgICAgaWYgKCFzbmFwc2hvdC5lbXB0eSkge1xuICAgICAgICBzbmFwc2hvdC5mb3JFYWNoKHNjb3JlID0+IHRoaXMuc2NvcmVzLnB1c2goc2NvcmUuZGF0YSgpKSk7XG4gICAgICB9XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbGVhZGVyYm9hcmQnLCB0aGlzLmV2ZW50RGV0YWlsLCBmYWxzZSk7XG4gICAgfSkuY2F0Y2goZSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbZmlyZXN0b3JlXScsIGUpO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJcyBoaWdoIHNjb3JlP1xuICAgKi9cbiAgY2hlY2tMZWFkZXJib2FyZFF1YWxpZnk6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnN0YXRlLnN0YXRlO1xuICAgIGNvbnN0IHNjb3JlID0gc3RhdGUuc2NvcmUuc2NvcmU7XG5cbiAgICAvLyBJZiBsZXNzIHRoYW4gMTAsIHRoZW4gYXV0b21hdGljIGhpZ2ggc2NvcmUuXG4gICAgaWYgKHRoaXMuc2NvcmVzLmxlbmd0aCA8IE5VTV9TQ09SRVNfRElTUExBWUVEKSB7XG4gICAgICB0aGlzLnF1YWxpZnlpbmdJbmRleCA9IHRoaXMuc2NvcmVzLmxlbmd0aDtcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdsZWFkZXJib2FyZHF1YWxpZnknLCB0aGlzLnNjb3Jlcy5sZW5ndGgsIGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiBvdmVydG9vayBhbnkgZXhpc3RpbmcgaGlnaCBzY29yZS5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2NvcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoc2NvcmUgPiB0aGlzLnNjb3Jlc1tpXS5zY29yZSkge1xuICAgICAgICB0aGlzLnF1YWxpZnlpbmdJbmRleCA9IGk7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdsZWFkZXJib2FyZHF1YWxpZnknLCBpLCBmYWxzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbGVhZGVyYm9hcmQuanMiLCJ2YXIgT05DRSA9IHtvbmNlOiB0cnVlfTtcblxuLyoqXG4gKiBEZWxheSBsb2dvIGxpZ2h0IHNvIGl0IG9ubHkgYXBwbGllcyB0byB0aGUgbG9nby5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdsb2dvLWxpZ2h0Jywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5sb2dvQmFjayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvQmFjaycpO1xuICAgIHRoaXMubG9nb0Zyb250ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ29Gcm9udCcpO1xuICAgIHRoaXMubG9nb0Zyb250VSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvRnJvbnRVJyk7XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ2xpZ2h0Jywge1xuICAgICAgICB0eXBlOiAnc3BvdCcsXG4gICAgICAgIHBlbnVtYnJhOiAxLFxuICAgICAgICBpbnRlbnNpdHk6IDUsXG4gICAgICAgIGFuZ2xlOiAyMFxuICAgICAgfSk7XG4gICAgICB0aGlzLndhaXRBbmRVcGRhdGUodGhpcy5sb2dvQmFjayk7XG4gICAgICB0aGlzLndhaXRBbmRVcGRhdGUodGhpcy5sb2dvRnJvbnQpO1xuICAgICAgdGhpcy53YWl0QW5kVXBkYXRlKHRoaXMubG9nb0Zyb250VSk7XG4gICAgfSwgMTAwMCk7XG4gIH0sXG5cbiAgd2FpdEFuZFVwZGF0ZTogZnVuY3Rpb24gKGVsKSB7XG4gICAgaWYgKGVsLmdldE9iamVjdDNEKCdtZXNoJykpIHtcbiAgICAgIGVsLm9iamVjdDNELnRyYXZlcnNlKHRoaXMudXBkYXRlTWF0ZXJpYWxzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW9kZWwtbG9hZGVkJywgKCkgPT4ge1xuICAgICAgICBlbC5vYmplY3QzRC50cmF2ZXJzZSh0aGlzLnVwZGF0ZU1hdGVyaWFscyk7XG4gICAgICB9LCBPTkNFKTtcbiAgICB9XG4gIH0sXG5cbiAgdXBkYXRlTWF0ZXJpYWxzOiBmdW5jdGlvbiAobm9kZSkge1xuICAgIGlmIChub2RlLm1hdGVyaWFsKSB7XG4gICAgICBub2RlLm1hdGVyaWFsLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbG9nby1saWdodC5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbG9nb2ZsaWNrZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGRlbGF5OiB7ZGVmYXVsdDogMTAwMC4wfSxcbiAgICBhY3RpdmU6IHtkZWZhdWx0OiB0cnVlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnNldE9mZiA9IHRoaXMuc2V0T2ZmLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZXRPbiA9IHRoaXMuc2V0T24uYmluZCh0aGlzKTtcbiAgICB0aGlzLnRpbWVvdXQgPSAwO1xuXG4gICAgdGhpcy5zcGFya3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nb3NwYXJrcycpO1xuICAgIHRoaXMuc3BhcmtQb3NpdGlvbnMgPSBbXG4gICAgICB7cG9zaXRpb246IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAuMTAsIDApfSxcbiAgICAgIHtwb3NpdGlvbjogbmV3IFRIUkVFLlZlY3RvcjMoMC4zLCAwLjgsIDApfSxcbiAgICAgIHtwb3NpdGlvbjogbmV3IFRIUkVFLlZlY3RvcjMoLTAuMywgMC44LCAwKX1cbiAgICBdO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICBpZiAodGhpcy5kYXRhLmFjdGl2ZSAhPT0gb2xkRGF0YS5hY3RpdmUpIHtcbiAgICAgIGlmICh0aGlzLmRhdGEuYWN0aXZlKSB7XG4gICAgICAgIHRoaXMuc2V0T24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICBzZXRPZmY6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLnNwYXJrcy5lbWl0KCdsb2dvZmxpY2tlcicsXG4gICAgICB0aGlzLnNwYXJrUG9zaXRpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuc3BhcmtQb3NpdGlvbnMubGVuZ3RoKV0sXG4gICAgICBmYWxzZSk7XG5cbiAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMuc2V0T24sIDUwKTtcbiAgfSxcblxuICBzZXRPbjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCh0aGlzLnNldE9mZixcbiAgICAgICAgICAgICAgIE1hdGguZmxvb3IoKHRoaXMuZGF0YS5kZWxheSAqIDMgLyAxMCkgKyBNYXRoLnJhbmRvbSgpICogdGhpcy5kYXRhLmRlbGF5KSk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbG9nb2ZsaWNrZXIuanMiLCJjb25zdCBDT0xPUlMgPSByZXF1aXJlKCcuLi9jb25zdGFudHMvY29sb3JzLmpzJyk7XG5jb25zdCBmbGF0U2hhZGVycyA9IHJlcXVpcmUoJy4uLy4uL2Fzc2V0cy9zaGFkZXJzL2ZsYXQuanMnKTtcbmNvbnN0IHN0YWdlQWRkaXRpdmVTaGFkZXJzID0gcmVxdWlyZSgnLi4vLi4vYXNzZXRzL3NoYWRlcnMvc3RhZ2VBZGRpdGl2ZS5qcycpO1xuY29uc3Qgc3RhZ2VOb3JtYWxTaGFkZXJzID0gcmVxdWlyZSgnLi4vLi4vYXNzZXRzL3NoYWRlcnMvc3RhZ2VOb3JtYWwuanMnKTtcblxuQUZSQU1FLnJlZ2lzdGVyU3lzdGVtKCdtYXRlcmlhbHMnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgdGhpcy5jcmVhdGVNYXRlcmlhbHMuYmluZCh0aGlzKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY3JlYXRlTWF0ZXJpYWxzKCk7XG4gICAgfVxuICB9LFxuXG4gIGNyZWF0ZU1hdGVyaWFsczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3RhZ2VOb3JtYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoe1xuICAgICAgdW5pZm9ybXM6IHtcbiAgICAgICAgc2t5Q29sb3I6IHt2YWx1ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5TS1lfQkxVRSl9LFxuICAgICAgICBiYWNrZ2xvd0NvbG9yOiB7dmFsdWU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuQkdfQkxVRSl9LFxuICAgICAgICBzcmM6IHtcbiAgICAgICAgICB2YWx1ZTogbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdGxhc0ltZycpLnNyYylcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB2ZXJ0ZXhTaGFkZXI6IHN0YWdlTm9ybWFsU2hhZGVycy52ZXJ0ZXhTaGFkZXIsXG4gICAgICBmcmFnbWVudFNoYWRlcjogc3RhZ2VOb3JtYWxTaGFkZXJzLmZyYWdtZW50U2hhZGVyLFxuICAgICAgZm9nOiBmYWxzZSxcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlXG4gICAgfSk7XG5cbiAgICB0aGlzLnN0YWdlQWRkaXRpdmUgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoe1xuICAgICAgdW5pZm9ybXM6IHtcbiAgICAgICAgdHVubmVsTmVvbjoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fUkVEKX0sXG4gICAgICAgIGZsb29yTmVvbjoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fUkVEKX0sXG4gICAgICAgIGxlZnRMYXNlcjoge3ZhbHVlOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fQkxVRSl9LFxuICAgICAgICByaWdodExhc2VyOiB7dmFsdWU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuTkVPTl9CTFVFKX0sXG4gICAgICAgIHRleHRHbG93OiB7dmFsdWU6IG5ldyBUSFJFRS5Db2xvcihDT0xPUlMuVEVYVF9PRkYpfSxcbiAgICAgICAgc3JjOiB7XG4gICAgICAgICAgdmFsdWU6IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXRsYXNJbWcnKS5zcmMpXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgdmVydGV4U2hhZGVyOiBzdGFnZUFkZGl0aXZlU2hhZGVycy52ZXJ0ZXhTaGFkZXIsXG4gICAgICBmcmFnbWVudFNoYWRlcjogc3RhZ2VBZGRpdGl2ZVNoYWRlcnMuZnJhZ21lbnRTaGFkZXIsXG4gICAgICBibGVuZGluZzogVEhSRUUuQWRkaXRpdmVCbGVuZGluZyxcbiAgICAgIGZvZzogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgIH0pO1xuXG4gICAgdGhpcy5sb2dvID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKHtcbiAgICAgIHVuaWZvcm1zOiB7XG4gICAgICAgIHNyYzoge1xuICAgICAgICAgIHZhbHVlOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ290ZXhJbWcnKS5zcmMpXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgdmVydGV4U2hhZGVyOiBmbGF0U2hhZGVycy52ZXJ0ZXhTaGFkZXIsXG4gICAgICBmcmFnbWVudFNoYWRlcjogZmxhdFNoYWRlcnMuZnJhZ21lbnRTaGFkZXIsXG4gICAgICBkZXB0aFRlc3Q6IGZhbHNlLFxuICAgICAgZm9nOiBmYWxzZSxcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlXG4gICAgfSk7XG5cbiAgICB0aGlzLmxvZ29hZGRpdGl2ZSA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCh7XG4gICAgICB1bmlmb3Jtczoge1xuICAgICAgICBzcmM6IHtcbiAgICAgICAgICB2YWx1ZTogbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvdGV4SW1nJykuc3JjKVxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHZlcnRleFNoYWRlcjogZmxhdFNoYWRlcnMudmVydGV4U2hhZGVyLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IGZsYXRTaGFkZXJzLmZyYWdtZW50U2hhZGVyLFxuICAgICAgZGVwdGhUZXN0OiBmYWxzZSxcbiAgICAgIGJsZW5kaW5nOiBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nLFxuICAgICAgZm9nOiBmYWxzZSxcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlXG4gICAgfSk7XG5cbiAgICB0aGlzLm1pbmVNYXRlcmlhbHJlZCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7XG4gICAgICByb3VnaG5lc3M6IDAuMzgsXG4gICAgICBtZXRhbG5lc3M6IDAuNDgsXG4gICAgICBjb2xvcjogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5NSU5FX1JFRCksXG4gICAgICBlbWlzc2l2ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5NSU5FX1JFRF9FTUlTU0lPTiksXG4gICAgICBlbnZNYXA6IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZCgnYXNzZXRzL2ltZy9taW5lZW52aXJvLXJlZC5qcGcnKVxuICAgIH0pO1xuXG4gICAgdGhpcy5taW5lTWF0ZXJpYWxibHVlID0gbmV3IFRIUkVFLk1lc2hTdGFuZGFyZE1hdGVyaWFsKHtcbiAgICAgIHJvdWdobmVzczogMC4zOCxcbiAgICAgIG1ldGFsbmVzczogMC40OCxcbiAgICAgIGNvbG9yOiBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk1JTkVfQkxVRSksXG4gICAgICBlbWlzc2l2ZTogbmV3IFRIUkVFLkNvbG9yKENPTE9SUy5NSU5FX0JMVUVfRU1JU1NJT04pLFxuICAgICAgZW52TWFwOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoJ2Fzc2V0cy9pbWcvbWluZWVudmlyby1ibHVlLmpwZycpXG4gICAgfSk7XG5cbiAgfVxufSk7XG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbWF0ZXJpYWxzJywge1xuICBzY2hlbWE6IHtcbiAgICBuYW1lOiB7IGRlZmF1bHQ6ICcnfSxcbiAgICByZWN1cnNpdmU6IHsgZGVmYXVsdDogdHJ1ZX1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kYXRhLm5hbWUgPT09ICcnKSB7IHJldHVybjsgfVxuXG4gICAgY29uc3QgbWF0ZXJpYWwgPSB0aGlzLnN5c3RlbVt0aGlzLmRhdGEubmFtZV07XG4gICAgaWYgKCFtYXRlcmlhbCkge1xuICAgICAgY29uc29sZS53YXJuKGB1bmRlZmluZWQgbWF0ZXJpYWwgXCIke3RoaXMuc3lzdGVtW3RoaXMuZGF0YS5uYW1lXX1cImApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG1lc2ggPSB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJyk7XG4gICAgaWYgKCFtZXNoKSB7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vZGVsLWxvYWRlZCcsIHRoaXMuYXBwbHlNYXRlcmlhbC5iaW5kKHRoaXMpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hcHBseU1hdGVyaWFsKG1lc2gpO1xuICAgIH1cbiAgfSxcblxuICBhcHBseU1hdGVyaWFsOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgY29uc3QgbWF0ZXJpYWwgPSB0aGlzLnN5c3RlbVt0aGlzLmRhdGEubmFtZV07XG4gICAgaWYgKG9ialsnZGV0YWlsJ10pIHsgb2JqID0gb2JqLmRldGFpbC5tb2RlbDsgfVxuICAgIGlmICh0aGlzLmRhdGEucmVjdXJzaXZlKSB7XG4gICAgICBvYmoudHJhdmVyc2UobyA9PiB7XG4gICAgICAgIGlmIChvLnR5cGUgPT09ICdNZXNoJykge1xuICAgICAgICAgIG8ubWF0ZXJpYWwgPSBtYXRlcmlhbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9iai5tYXRlcmlhbCA9IG1hdGVyaWFsO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9tYXRlcmlhbHMuanMiLCJ2YXIgaG92ZXJlZEluZGV4O1xudmFyIGtleUV2ZW50c1JlZ2lzdGVyZWQgPSBmYWxzZTtcbnZhciByZXN1bHRzID0gbnVsbDtcblxuY29uc3QgUEVSX1BBR0UgPSA2O1xuXG4vKipcbiAqIFVzZSBtZW51IHdpdGggdGh1bWIuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnbWVudS1jb250cm9scycsIHtcbiAgc2NoZW1hOiB7XG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IHRydWV9LFxuICAgIHBhZ2U6IHtkZWZhdWx0OiAwfSxcbiAgICBzZWxlY3RlZENoYWxsZW5nZUlkOiB7ZGVmYXVsdDogJyd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcblxuICAgIHJlc3VsdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoUmVzdWx0TGlzdCcpLmNoaWxkcmVuO1xuXG4gICAgdGhpcy5nb1ByZXZSZXN1bHQgPSB0aGlzLmdvUHJldlJlc3VsdC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuZ29OZXh0UmVzdWx0ID0gdGhpcy5nb05leHRSZXN1bHQuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNlbGVjdCA9IHRoaXMuc2VsZWN0LmJpbmQodGhpcyk7XG4gICAgdGhpcy51bnNlbGVjdCA9IHRoaXMudW5zZWxlY3QuYmluZCh0aGlzKTtcblxuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RodW1idXBzdGFydCcsIHRoaXMuZ29QcmV2UmVzdWx0KTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0aHVtYmRvd25zdGFydCcsIHRoaXMuZ29OZXh0UmVzdWx0KTtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCd0aHVtYmxlZnRzdGFydCcsIHRoaXMudW5zZWxlY3QpO1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3RodW1icmlnaHRzdGFydCcsIHRoaXMuc2VsZWN0KTtcblxuICAgIC8vIFdoZW4gcmF5Y2FzdGVyIGJlY29tZXMgYWN0aXZlIGFnYWluLCBjYW5jZWwuXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGV2dCA9PiB7XG4gICAgICBpZiAoIWVsLmNvbXBvbmVudHMuY3Vyc29yLmludGVyc2VjdGVkRWwpIHsgcmV0dXJuOyB9XG4gICAgICBpZiAoZWwuY29tcG9uZW50cy5jdXJzb3IuaW50ZXJzZWN0ZWRFbC5jbG9zZXN0KCcjc2VhcmNoUmVzdWx0TGlzdCcpKSB7XG4gICAgICAgIHRoaXMuY2FuY2VsTWVudUNvbnRyb2xzKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZGVidWcnKSAmJiAha2V5RXZlbnRzUmVnaXN0ZXJlZCkge1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldnQgPT4ge1xuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDM3KSB7IHRoaXMudW5zZWxlY3QoKTsgfVxuICAgICAgICBpZiAoZXZ0LmtleUNvZGUgPT09IDM4KSB7IHRoaXMuZ29QcmV2UmVzdWx0KCk7IH1cbiAgICAgICAgaWYgKGV2dC5rZXlDb2RlID09PSAzOSkgeyB0aGlzLnNlbGVjdCgpOyB9XG4gICAgICAgIGlmIChldnQua2V5Q29kZSA9PT0gNDApIHsgdGhpcy5nb05leHRSZXN1bHQoKTsgfVxuICAgICAgfSk7XG4gICAgICBrZXlFdmVudHNSZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICB9XG4gIH0sXG5cbiAgZ29QcmV2UmVzdWx0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cblxuICAgIGlmIChob3ZlcmVkSW5kZXggPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5ob3ZlclJlc3VsdCgwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGhvdmVyZWRJbmRleCA+IDApIHtcbiAgICAgIGlmIChyZXN1bHRzW2hvdmVyZWRJbmRleCAtIDFdLmRhdGFzZXQuaWQgPT09IHRoaXMuZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICAgIGlmIChob3ZlcmVkSW5kZXggLSAyIDwgMCkge1xuICAgICAgICAgIHRoaXMuZ29QcmV2UGFnZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuaG92ZXJSZXN1bHQoaG92ZXJlZEluZGV4IC0gMik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaG92ZXJSZXN1bHQoaG92ZXJlZEluZGV4IC0gMSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZ29QcmV2UGFnZSgpO1xuICAgIH1cbiAgfSxcblxuICBnb1ByZXZQYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5ob3ZlclJlc3VsdChQRVJfUEFHRSAtIDEpO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzZWFyY2hwcmV2cGFnZScsIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICBnb05leHRSZXN1bHQ6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuXG4gICAgaWYgKGhvdmVyZWRJbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmhvdmVyUmVzdWx0KDApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoaG92ZXJlZEluZGV4IDwgUEVSX1BBR0UgLSAxKSB7XG4gICAgICBpZiAocmVzdWx0c1tob3ZlcmVkSW5kZXggKyAxXS5kYXRhc2V0LmlkID09PSB0aGlzLmRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCkge1xuICAgICAgICBpZiAoaG92ZXJlZEluZGV4ICsgMiA+IFBFUl9QQUdFIC0gMSkge1xuICAgICAgICAgIHRoaXMuZ29OZXh0UGFnZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuaG92ZXJSZXN1bHQoaG92ZXJlZEluZGV4ICsgMik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaG92ZXJSZXN1bHQoaG92ZXJlZEluZGV4ICsgMSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZ29OZXh0UGFnZSgpO1xuICAgIH1cbiAgfSxcblxuICBnb05leHRQYWdlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5ob3ZlclJlc3VsdCgwKTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc2VhcmNobmV4dHBhZ2UnLCBudWxsLCBmYWxzZSk7XG4gIH0sXG5cbiAgc2VsZWN0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICBpZiAoaG92ZXJlZEluZGV4ID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ21lbnVjaGFsbGVuZ2VzZWxlY3QnLCByZXN1bHRzW2hvdmVyZWRJbmRleF0uZGF0YXNldC5pZCwgZmFsc2UpO1xuICB9LFxuXG4gIHVuc2VsZWN0OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICBpZiAodGhpcy5kYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQpIHtcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdtZW51Y2hhbGxlbmdldW5zZWxlY3QnLCBudWxsLCBmYWxzZSk7XG4gICAgfVxuICB9LFxuXG4gIGhvdmVyUmVzdWx0OiBmdW5jdGlvbiAoaSkge1xuICAgIGlmIChob3ZlcmVkSW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmVzdWx0c1tob3ZlcmVkSW5kZXhdLnF1ZXJ5U2VsZWN0b3IoJy5zZWFyY2hSZXN1bHRCYWNrZ3JvdW5kJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIC5lbWl0KCdtb3VzZWxlYXZlJywgbnVsbCwgZmFsc2UpO1xuICAgIH1cbiAgICBob3ZlcmVkSW5kZXggPSBpO1xuICAgIHJlc3VsdHNbaV0ucXVlcnlTZWxlY3RvcignLnNlYXJjaFJlc3VsdEJhY2tncm91bmQnKVxuICAgICAgICAgICAgICAuZW1pdCgnbW91c2VlbnRlcicsIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICBjYW5jZWxNZW51Q29udHJvbHM6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoaG92ZXJlZEluZGV4ID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9XG4gICAgcmVzdWx0c1tob3ZlcmVkSW5kZXhdLnF1ZXJ5U2VsZWN0b3IoJy5zZWFyY2hSZXN1bHRCYWNrZ3JvdW5kJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAuZW1pdCgnbW91c2VsZWF2ZScsIG51bGwsIGZhbHNlKTtcbiAgICBob3ZlcmVkSW5kZXggPSB1bmRlZmluZWQ7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbWVudS1jb250cm9scy5qcyIsInZhciBiaW5kRXZlbnQgPSByZXF1aXJlKCdhZnJhbWUtZXZlbnQtZGVjb3JhdG9ycycpLmJpbmRFdmVudDtcblxuLyoqXG4gKiBTZWxlY3QgZGlmZmljdWx0eS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdtZW51LWRpZmZpY3VsdHktc2VsZWN0Jywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ21lbnVjaGFsbGVuZ2VzZWxlY3QnLCAoKSA9PiB7XG4gICAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLmVsLmNvbXBvbmVudHMubGF5b3V0LnVwZGF0ZSgpO1xuICAgICAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgICAgfSwgMTUwKTtcbiAgICB9KTtcbiAgfSxcblxuICBjbGljazogYmluZEV2ZW50KGZ1bmN0aW9uIChldnQpIHtcbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdChcbiAgICAgICdtZW51ZGlmZmljdWx0eXNlbGVjdCcsXG4gICAgICBldnQudGFyZ2V0LmNsb3Nlc3QoJy5kaWZmaWN1bHR5T3B0aW9uJykuZGF0YXNldC5kaWZmaWN1bHR5LFxuICAgICAgZmFsc2UpO1xuICB9KVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9tZW51LWRpZmZpY3VsdHktc2VsZWN0LmpzIiwiaW1wb3J0IHV0aWxzIGZyb20gJy4uL3V0aWxzJztcblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdtZW51LXNlbGVjdGVkLWNoYWxsZW5nZS1pbWFnZScsIHtcbiAgc2NoZW1hOiB7XG4gICAgc2VsZWN0ZWRDaGFsbGVuZ2VJZDoge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcbiAgICBpZiAoIXRoaXMuZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKSB7IHJldHVybjsgfVxuICAgIGVsLnNldEF0dHJpYnV0ZShcbiAgICAgICdtYXRlcmlhbCcsICdzcmMnLFxuICAgICAgdXRpbHMuZ2V0UzNGaWxlVXJsKHRoaXMuZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkLCAnaW1hZ2UuanBnJykpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL21lbnUtc2VsZWN0ZWQtY2hhbGxlbmdlLWltYWdlLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdtZW51LXNsaWRlLWFuaW1hdGlvbicsIHtcbiAgc2NoZW1hOiB7XG4gICAgaXNTZWFyY2hpbmc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgbWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5pc0xlZnQgPSBmYWxzZTsgIC8vIE1lYW5zIHRvbGVmdC5cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGlmICh0aGlzLmlzTGVmdCkge1xuICAgICAgLy8gVW5zZWxlY3QuXG4gICAgICBpZiAob2xkRGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCAmJiAhZGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCAmJlxuICAgICAgICAgICFkYXRhLmlzU2VhcmNoaW5nKSB7IHRoaXMucmlnaHRNZW51KCk7IH1cbiAgICAgIC8vIEtleWJvYXJkIGNsb3NlLlxuICAgICAgaWYgKG9sZERhdGEuaXNTZWFyY2hpbmcgJiYgIWRhdGEuaXNTZWFyY2hpbmcgJiYgIWRhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQpIHtcbiAgICAgICAgdGhpcy5yaWdodE1lbnUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaXNMZWZ0KSB7XG4gICAgICAvLyBTZWxlY3QuXG4gICAgICBpZiAoIW9sZERhdGEubWVudVNlbGVjdGVkQ2hhbGxlbmdlSWQgJiYgZGF0YS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2VJZCkgeyB0aGlzLmxlZnRNZW51KCk7IH1cbiAgICAgIC8vIEtleWJvYXJkIG9wZW4uXG4gICAgICBpZiAoIW9sZERhdGEuaXNTZWFyY2hpbmcgJiYgZGF0YS5pc1NlYXJjaGluZykgeyB0aGlzLmxlZnRNZW51KCk7IH1cbiAgICB9XG4gIH0sXG5cbiAgcmlnaHRNZW51OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzTGVmdCkgeyByZXR1cm47IH1cbiAgICB0aGlzLmVsLmNvbXBvbmVudHMuYW5pbWF0aW9uX19tZW51cmlnaHQuYmVnaW5BbmltYXRpb24oKTtcbiAgICB0aGlzLmlzTGVmdCA9IGZhbHNlO1xuICB9LFxuXG4gIGxlZnRNZW51OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuaXNMZWZ0KSB7IHJldHVybjsgfVxuICAgIHRoaXMuZWwuY29tcG9uZW50cy5hbmltYXRpb25fX21lbnVsZWZ0LmJlZ2luQW5pbWF0aW9uKCk7XG4gICAgdGhpcy5pc0xlZnQgPSB0cnVlO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL21lbnUtc2xpZGUtYW5pbWF0aW9uLmpzIiwiY29uc3Qgb2JqTG9hZGVyID0gbmV3IFRIUkVFLk9CSkxvYWRlcigpO1xuXG5BRlJBTUUucmVnaXN0ZXJTeXN0ZW0oJ21pbmUtZnJhZ21lbnRzLWxvYWRlcicsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnJhZ21lbnRzID0gbnVsbDtcbiAgICBjb25zdCBvYmpEYXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pbmVCcm9rZW5PYmonKTtcbiAgICBvYmpEYXRhLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZCcsIGV2dCA9PiB7XG4gICAgICB0aGlzLmZyYWdtZW50cyA9IG9iakxvYWRlci5wYXJzZShldnQudGFyZ2V0LmRhdGEpO1xuICAgIH0pXG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvbWluZS1mcmFnbWVudHMtbG9hZGVyLmpzIiwiY29uc3QgQ09NQk9fUFJPR1JFU1NfTUFQID0ge1xuICAwOiAwLFxuICAxOiAwLjUsXG4gIDI6IDAsXG4gIDM6IDAuMjUsXG4gIDQ6IDAuNSxcbiAgNTogMC43NSxcbiAgNjogMCxcbiAgNzogMC4xMjUsXG4gIDg6IDAuMjUsXG4gIDk6IDAuMzc1LFxuICAxMDogMC41LFxuICAxMTogMC42MjUsXG4gIDEyOiAwLjc1LFxuICAxMzogMC44NzVcbn07XG5cbi8qXG4gKiBDb21ibyBuZWVkZWQgdG90YWwgZm9yIG11bHRpcGxpZXIgbGV2ZWw6XG4gKlxuICogMCAtIDF4XG4gKiAyIC0gMnhcbiAqIDYgLSA0eFxuICogMTQgLSA4eFxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ211bHRpcGxpZXItcmluZycsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2dlb21ldHJ5JywgJ21hdGVyaWFsJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgY29tYm86IHtkZWZhdWx0OiAwfSxcbiAgICBtdWx0aXBsaWVyOiB7ZGVmYXVsdDogMX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5hbmltYXRpb25TZXQgPSB7ZnJvbTogdW5kZWZpbmVkLCB0bzogdW5kZWZpbmVkfTtcbiAgICB0aGlzLnByb2dyZXNzID0gdGhpcy5lbC5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLnVuaWZvcm1zLnByb2dyZXNzO1xuXG4gICAgLy8gU2V0IHVwIGFuaW1hdGlvbi5cbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnYW5pbWF0aW9uJywge1xuICAgICAgcHJvcGVydHk6ICdjb21wb25lbnRzLm1hdGVyaWFsLm1hdGVyaWFsLnVuaWZvcm1zLnByb2dyZXNzLnZhbHVlJyxcbiAgICAgIGR1cjogMTAwLFxuICAgICAgYXV0b3BsYXk6IGZhbHNlXG4gICAgfSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy51cGRhdGVSaW5nKCk7XG4gIH0sXG5cbiAgdXBkYXRlUmluZzogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuICAgIGNvbnN0IHByb2dyZXNzID0gdGhpcy5wcm9ncmVzcztcblxuICAgIGlmIChkYXRhLm11bHRpcGxpZXIgPT09IDgpIHtcbiAgICAgIHByb2dyZXNzLnZhbHVlID0gMTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBhbmltYXRpb25TZXQgPSB0aGlzLmFuaW1hdGlvblNldDtcbiAgICBhbmltYXRpb25TZXQuZnJvbSA9IHByb2dyZXNzLnZhbHVlO1xuICAgIGFuaW1hdGlvblNldC50byA9IENPTUJPX1BST0dSRVNTX01BUFtkYXRhLmNvbWJvXTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoJ2FuaW1hdGlvbicsIGFuaW1hdGlvblNldCk7XG4gICAgZWwuY29tcG9uZW50cy5hbmltYXRpb24uYmVnaW5BbmltYXRpb24oKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9tdWx0aXBsaWVyLXJpbmcuanMiLCJjb25zdCBOVU1fUExBTkVfUE9TSVRJT05TID0gMTI7XG5cbmNvbnN0IEJMRU5ESU5HUyA9IHtcbiAgbm9ybWFsOiBUSFJFRS5Ob3JtYWxCbGVuZGluZyxcbiAgYWRkaXRpdmU6IFRIUkVFLkFkZGl0aXZlQmxlbmRpbmcsXG4gIHN1YnN0cmFjdGl2ZTogVEhSRUUuU3Vic3RyYWN0aXZlQmxlbmRpbmcsXG4gIG11bHRpcGx5OiBUSFJFRS5NdWx0aXBseUJsZW5kaW5nXG59O1xuXG5jb25zdCBTSEFERVJTID0ge1xuICBmbGF0OiBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCxcbiAgbGFtYmVydDogVEhSRUUuTWVzaExhbWJlcnRNYXRlcmlhbCxcbiAgcGhvbmc6IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsLFxuICBzdGFuZGFyZDogVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWxcbn07XG5cbmNvbnN0IE9GRlNDUkVFTl9WRUMzID0gbmV3IFRIUkVFLlZlY3RvcjMoLTk5OTk5LCAtOTk5OTksIC05OTk5OSk7XG5cbi8qKlxuICogUGFydGljbGUgUGxheWVyIGNvbXBvbmVudCBmb3IgQS1GcmFtZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdwYXJ0aWNsZXBsYXllcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgYmxlbmRpbmc6IHtcbiAgICAgIGRlZmF1bHQ6ICdhZGRpdGl2ZScsXG4gICAgICBvbmVPZjogWydub3JtYWwnLCAnYWRkaXRpdmUnLCAnbXVsdGlwbHknLCAnc3Vic3RyYWN0aXZlJ11cbiAgICB9LFxuICAgIGNvbG9yOiB7ZGVmYXVsdDogJyNmZmYnLCB0eXBlOiAnY29sb3InfSxcbiAgICBjb3VudDoge2RlZmF1bHQ6ICcxMDAlJ30sXG4gICAgZGVsYXk6IHtkZWZhdWx0OiAwLCB0eXBlOiAnaW50J30sXG4gICAgZHVyOiB7ZGVmYXVsdDogMTAwMCwgdHlwZTogJ2ludCd9LFxuICAgIGltZzoge3R5cGU6ICdzZWxlY3Rvcid9LFxuICAgIGludGVycG9sYXRlOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGxvb3A6IHtkZWZhdWx0OiAnZmFsc2UnfSxcbiAgICBvbjoge2RlZmF1bHQ6ICdpbml0J30sXG4gICAgcG9vbFNpemU6IHtkZWZhdWx0OiA1LCB0eXBlOiAnaW50J30sIC8vIG51bWJlciBvZiBzaW11bHRhbmVvdXMgcGFydGljbGUgc3lzdGVtc1xuICAgIHByb3RhdGlvbjoge3R5cGU6ICd2ZWMzJ30sXG4gICAgcHNjYWxlOiB7ZGVmYXVsdDogMS4wLCB0eXBlOiAnZmxvYXQnfSxcbiAgICBzY2FsZToge2RlZmF1bHQ6IDEuMCwgdHlwZTogJ2Zsb2F0J30sXG4gICAgaW5pdGlhbFNjYWxlOiB7dHlwZTogJ3ZlYzMnfSxcbiAgICBmaW5hbFNjYWxlOiB7dHlwZTogJ3ZlYzMnfSxcbiAgICBhbmltYXRlU2NhbGU6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgc2hhZGVyOiB7XG4gICAgICBkZWZhdWx0OiAnZmxhdCcsXG4gICAgICBvbmVPZjogWydmbGF0JywgJ2xhbWJlcnQnLCAncGhvbmcnLCAnc3RhbmRhcmQnXVxuICAgIH0sXG4gICAgc3JjOiB7dHlwZTogJ3NlbGVjdG9yJ31cbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mcmFtZSA9IDA7XG4gICAgdGhpcy5mcmFtZWRhdGEgPSBudWxsO1xuICAgIHRoaXMuaW5kZXhQb29sID0gbnVsbDtcbiAgICB0aGlzLmxhc3RGcmFtZSA9IDA7XG4gICAgdGhpcy5tYXRlcmlhbCA9IG51bGw7XG4gICAgdGhpcy5tc1BlckZyYW1lID0gMDtcbiAgICB0aGlzLm51bUZyYW1lcyA9IDA7XG4gICAgdGhpcy5udW1QYXJ0aWNsZXMgPSAwOyAvLyB0b3RhbCBudW1iZXIgb2YgcGFydGljbGVzIHBlciBzeXN0ZW1cbiAgICB0aGlzLm9yaWdpbmFsVmVydGV4UG9zaXRpb25zID0gW107XG4gICAgdGhpcy5wYXJ0aWNsZUNvdW50ID0gMDsgLy8gYWN0dWFsIG51bWJlciBvZiBwYXJ0aWNsZXMgdG8gc3Bhd24gcGVyIGV2ZW50IChkYXRhLmNvdW50KVxuICAgIHRoaXMucGFydGljbGVTeXN0ZW1zID0gW107XG4gICAgdGhpcy5wcm90YXRpb24gPSBmYWxzZTtcbiAgICB0aGlzLnJlc3RQb3NpdGlvbnMgPSBbXTsgLy8gcG9zaXRpb24gYXQgZmlyc3QgZnJhbWUgZWFjaCBwYXJ0aWNsZSBpcyBhbGl2ZVxuICAgIHRoaXMucmVzdFJvdGF0aW9ucyA9IFtdO1xuICAgIHRoaXMuc3ByaXRlX3JvdGF0aW9uID0gZmFsc2U7XG4gICAgdGhpcy5zeXN0ZW1zID0gbnVsbDtcbiAgICB0aGlzLnVzZVJvdGF0aW9uID0gZmFsc2U7XG4gICAgdGhpcy51c2VBZ2UgPSBmYWxzZTtcbiAgICB0aGlzLnNjYWxlQW5pbSA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5wYXJ0U2NhbGUgPSBuZXcgVEhSRUUuVmVjdG9yMygxLjAsIDEuMCwgMS4wKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGlmICghZGF0YS5zcmMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAob2xkRGF0YS5vbiAhPT0gZGF0YS5vbikge1xuICAgICAgaWYgKG9sZERhdGEub24pIHtcbiAgICAgICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKG9sZERhdGEub24sIHRoaXMuc3RhcnQpO1xuICAgICAgfVxuICAgICAgaWYgKGRhdGEub24gIT09ICdwbGF5Jykge1xuICAgICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoZGF0YS5vbiwgdGhpcy5zdGFydC5iaW5kKHRoaXMpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnBhcnRTY2FsZS5zZXQoMS4wLCAxLjAsIDEuMCk7XG5cbiAgICB0aGlzLmxvYWRQYXJ0aWNsZXNKU09OKGRhdGEuc3JjLCBkYXRhLnNjYWxlKTtcblxuICAgIHRoaXMubnVtRnJhbWVzID0gdGhpcy5mcmFtZWRhdGEubGVuZ3RoO1xuICAgIHRoaXMubnVtUGFydGljbGVzID0gdGhpcy5udW1GcmFtZXMgPiAwID8gdGhpcy5mcmFtZWRhdGFbMF0ubGVuZ3RoIDogMDtcblxuICAgIGlmIChkYXRhLmNvdW50W2RhdGEuY291bnQubGVuZ3RoIC0gMV0gPT09ICclJykge1xuICAgICAgdGhpcy5wYXJ0aWNsZUNvdW50ID0gTWF0aC5mbG9vcihcbiAgICAgICAgKHBhcnNlSW50KGRhdGEuY291bnQpICogdGhpcy5udW1QYXJ0aWNsZXMpIC8gMTAwLjBcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucGFydGljbGVDb3VudCA9IHBhcnNlSW50KGRhdGEuY291bnQpO1xuICAgIH1cbiAgICB0aGlzLnBhcnRpY2xlQ291bnQgPSBNYXRoLm1pbihcbiAgICAgIHRoaXMubnVtUGFydGljbGVzLFxuICAgICAgTWF0aC5tYXgoMCwgdGhpcy5wYXJ0aWNsZUNvdW50KVxuICAgICk7XG5cbiAgICB0aGlzLm1zUGVyRnJhbWUgPSBkYXRhLmR1ciAvIHRoaXMubnVtRnJhbWVzO1xuXG4gICAgdGhpcy5pbmRleFBvb2wgPSBuZXcgQXJyYXkodGhpcy5udW1QYXJ0aWNsZXMpO1xuXG4gICAgY29uc3QgbWF0ZXJpYWxQYXJhbXMgPSB7XG4gICAgICBjb2xvcjogbmV3IFRIUkVFLkNvbG9yKGRhdGEuY29sb3IpLFxuICAgICAgc2lkZTogVEhSRUUuRG91YmxlU2lkZSxcbiAgICAgIGJsZW5kaW5nOiBCTEVORElOR1NbZGF0YS5ibGVuZGluZ10sXG4gICAgICBtYXA6IGRhdGEuaW1nID8gbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKGRhdGEuaW1nLnNyYykgOiBudWxsLFxuICAgICAgZGVwdGhXcml0ZTogZmFsc2UsXG4gICAgICBvcGFjaXR5OiBkYXRhLm9wYWNpdHksXG4gICAgICB0cmFuc3BhcmVudDogISFkYXRhLmltZyB8fCBkYXRhLmJsZW5kaW5nICE9PSAnbm9ybWFsJyB8fCBkYXRhLm9wYWNpdHkgPCAxXG4gICAgfTtcbiAgICBpZiAoU0hBREVSU1tkYXRhLnNoYWRlcl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5tYXRlcmlhbCA9IG5ldyBTSEFERVJTW2RhdGEuc2hhZGVyXShtYXRlcmlhbFBhcmFtcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubWF0ZXJpYWwgPSBuZXcgU0hBREVSU1snZmxhdCddKG1hdGVyaWFsUGFyYW1zKTtcbiAgICB9XG5cbiAgICB0aGlzLmNyZWF0ZVBhcnRpY2xlcyhkYXRhLnBvb2xTaXplKTtcblxuICAgIGlmIChkYXRhLm9uID09PSAnaW5pdCcpIHtcbiAgICAgIHRoaXMuc3RhcnQoKTtcbiAgICB9XG4gIH0sXG5cbiAgbG9hZFBhcnRpY2xlc0pTT046IGZ1bmN0aW9uIChqc29uLCBzY2FsZSkge1xuICAgIHZhciBhbGl2ZTtcblxuICAgIHRoaXMucmVzdFBvc2l0aW9ucy5sZW5ndGggPSAwO1xuICAgIHRoaXMucmVzdFJvdGF0aW9ucy5sZW5ndGggPSAwO1xuXG4gICAgY29uc3QganNvbkRhdGEgPSBKU09OLnBhcnNlKGpzb24uZGF0YSk7XG4gICAgY29uc3QgZnJhbWVzID0ganNvbkRhdGEuZnJhbWVzO1xuICAgIGNvbnN0IHByZWNpc2lvbiA9IGpzb25EYXRhLnByZWNpc2lvbjtcblxuICAgIHRoaXMudXNlUm90YXRpb24gPSBqc29uRGF0YS5yb3RhdGlvbjtcbiAgICB0aGlzLnVzZUFnZSA9IGpzb25EYXRhWydhZ2UnXSAhPT0gdW5kZWZpbmVkID8ganNvbkRhdGEuYWdlIDogZmFsc2U7XG5cbiAgICBpZiAoanNvbkRhdGEuc3ByaXRlX3JvdGF0aW9uICE9PSBmYWxzZSkge1xuICAgICAgdGhpcy5zcHJpdGVfcm90YXRpb24gPSB7XG4gICAgICAgIHg6IGpzb25EYXRhLnNwcml0ZV9yb3RhdGlvblswXSAvIHByZWNpc2lvbixcbiAgICAgICAgeToganNvbkRhdGEuc3ByaXRlX3JvdGF0aW9uWzFdIC8gcHJlY2lzaW9uLFxuICAgICAgICB6OiBqc29uRGF0YS5zcHJpdGVfcm90YXRpb25bMl0gLyBwcmVjaXNpb25cbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3ByaXRlX3JvdGF0aW9uID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhpcy5mcmFtZWRhdGEgPSBuZXcgQXJyYXkoZnJhbWVzLmxlbmd0aCk7XG4gICAgZm9yIChsZXQgZnJhbWVJbmRleCA9IDA7IGZyYW1lSW5kZXggPCBmcmFtZXMubGVuZ3RoOyBmcmFtZUluZGV4KyspIHtcbiAgICAgIHRoaXMuZnJhbWVkYXRhW2ZyYW1lSW5kZXhdID0gbmV3IEFycmF5KGZyYW1lc1tmcmFtZUluZGV4XS5sZW5ndGgpO1xuICAgICAgZm9yIChcbiAgICAgICAgbGV0IHBhcnRpY2xlSW5kZXggPSAwO1xuICAgICAgICBwYXJ0aWNsZUluZGV4IDwgZnJhbWVzW2ZyYW1lSW5kZXhdLmxlbmd0aDtcbiAgICAgICAgcGFydGljbGVJbmRleCsrXG4gICAgICApIHtcbiAgICAgICAgbGV0IHJhd1AgPSBmcmFtZXNbZnJhbWVJbmRleF1bcGFydGljbGVJbmRleF07IC8vIGRhdGEgb2YgcGFydGljbGUgaSBpbiBmcmFtZSBmXG4gICAgICAgIGFsaXZlID0gcmF3UCAhPT0gMDsgLy8gMCBtZWFucyBub3QgYWxpdmUgeWV0IHRoaXMgZnJhbWUuXG5cbiAgICAgICAgbGV0IHAgPSAodGhpcy5mcmFtZWRhdGFbZnJhbWVJbmRleF1bcGFydGljbGVJbmRleF0gPSB7XG4gICAgICAgICAgcG9zaXRpb246IGFsaXZlXG4gICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgeDogKHJhd1BbMF0gLyBwcmVjaXNpb24pICogc2NhbGUsXG4gICAgICAgICAgICAgIHk6IChyYXdQWzFdIC8gcHJlY2lzaW9uKSAqIHNjYWxlLFxuICAgICAgICAgICAgICB6OiAocmF3UFsyXSAvIHByZWNpc2lvbikgKiBzY2FsZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAgIGFsaXZlOiBhbGl2ZVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAodGhpcy51c2VSb3RhdGlvbikge1xuICAgICAgICAgIHAucm90YXRpb24gPSBhbGl2ZVxuICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIHg6IHJhd1BbM10gLyBwcmVjaXNpb24sXG4gICAgICAgICAgICAgIHk6IHJhd1BbNF0gLyBwcmVjaXNpb24sXG4gICAgICAgICAgICAgIHo6IHJhd1BbNV0gLyBwcmVjaXNpb25cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnVzZUFnZSkge1xuICAgICAgICAgIHAuYWdlID0gYWxpdmUgPyByYXdQWzZdIC8gcHJlY2lzaW9uIDogMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhbGl2ZSAmJiBmcmFtZUluZGV4ID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5yZXN0UG9zaXRpb25zW3BhcnRpY2xlSW5kZXhdID0gcC5wb3NpdGlvblxuICAgICAgICAgICAgPyB7eDogcC5wb3NpdGlvbi55LCB5OiBwLnBvc2l0aW9uLnksIHo6IHAucG9zaXRpb24uen1cbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgICB0aGlzLnJlc3RSb3RhdGlvbnNbcGFydGljbGVJbmRleF0gPSBwLnJvdGF0aW9uXG4gICAgICAgICAgICA/IHt4OiBwLnJvdGF0aW9uLnksIHk6IHAucm90YXRpb24ueSwgejogcC5yb3RhdGlvbi56fVxuICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIGNyZWF0ZVBhcnRpY2xlczogKGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB0ZW1wR2VvbWV0cmllcyA9IFtdO1xuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChudW1QYXJ0aWNsZVN5c3RlbXMpIHtcbiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgICB2YXIgbG9vcCA9IHBhcnNlSW50KHRoaXMuZGF0YS5sb29wKTtcblxuICAgICAgdGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoID0gMDtcblxuICAgICAgaWYgKGlzTmFOKGxvb3ApKSB7XG4gICAgICAgIGxvb3AgPSB0aGlzLmRhdGEubG9vcCA9PT0gJ3RydWUnID8gTnVtYmVyLk1BWF9WQUxVRSA6IDA7XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtUGFydGljbGVTeXN0ZW1zOyBpKyspIHtcbiAgICAgICAgbGV0IHBhcnRpY2xlU3lzdGVtID0ge1xuICAgICAgICAgIGFjdGl2ZTogZmFsc2UsXG4gICAgICAgICAgYWN0aXZlUGFydGljbGVJbmRpY2VzOiBuZXcgQXJyYXkodGhpcy5wYXJ0aWNsZUNvdW50KSxcbiAgICAgICAgICBsb29wQ291bnQ6IDAsXG4gICAgICAgICAgbG9vcFRvdGFsOiBsb29wLFxuICAgICAgICAgIG1lc2g6IG51bGwsXG4gICAgICAgICAgdGltZTogMFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEZpbGwgYXJyYXkgb2YgZ2VvbWV0cmllcyB0byBtZXJnZS5cbiAgICAgICAgY29uc3QgcmF0aW8gPSBkYXRhLmltZyA/IGRhdGEuaW1nLndpZHRoIC8gZGF0YS5pbWcuaGVpZ2h0IDogMTtcbiAgICAgICAgdGVtcEdlb21ldHJpZXMubGVuZ3RoID0gMDtcbiAgICAgICAgZm9yIChsZXQgcCA9IDA7IHAgPCB0aGlzLm51bVBhcnRpY2xlczsgcCsrKSB7XG4gICAgICAgICAgbGV0IGdlb21ldHJ5ID0gbmV3IFRIUkVFLlBsYW5lQnVmZmVyR2VvbWV0cnkoXG4gICAgICAgICAgICAwLjEgKiByYXRpbyAqIGRhdGEucHNjYWxlLFxuICAgICAgICAgICAgMC4xICogZGF0YS5wc2NhbGVcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmICh0aGlzLnNwcml0ZV9yb3RhdGlvbiAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGdlb21ldHJ5LnJvdGF0ZVgodGhpcy5zcHJpdGVfcm90YXRpb24ueCk7XG4gICAgICAgICAgICBnZW9tZXRyeS5yb3RhdGVZKHRoaXMuc3ByaXRlX3JvdGF0aW9uLnkpO1xuICAgICAgICAgICAgZ2VvbWV0cnkucm90YXRlWih0aGlzLnNwcml0ZV9yb3RhdGlvbi56KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2VvbWV0cnkucm90YXRlWCgodGhpcy5kYXRhLnByb3RhdGlvbi54ICogTWF0aC5QSSkgLyAxODApO1xuICAgICAgICAgICAgZ2VvbWV0cnkucm90YXRlWSgodGhpcy5kYXRhLnByb3RhdGlvbi55ICogTWF0aC5QSSkgLyAxODApO1xuICAgICAgICAgICAgZ2VvbWV0cnkucm90YXRlWigodGhpcy5kYXRhLnByb3RhdGlvbi56ICogTWF0aC5QSSkgLyAxODApO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0ZW1wR2VvbWV0cmllcy5wdXNoKGdlb21ldHJ5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSBtZXJnZWQgZ2VvbWV0cnkgZm9yIHdob2xlIHBhcnRpY2xlIHN5c3RlbS5cbiAgICAgICAgbGV0IG1lcmdlZEJ1ZmZlckdlb21ldHJ5ID0gVEhSRUUuQnVmZmVyR2VvbWV0cnlVdGlscy5tZXJnZUJ1ZmZlckdlb21ldHJpZXMoXG4gICAgICAgICAgdGVtcEdlb21ldHJpZXNcbiAgICAgICAgKTtcblxuICAgICAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoID0gbmV3IFRIUkVFLk1lc2goXG4gICAgICAgICAgbWVyZ2VkQnVmZmVyR2VvbWV0cnksXG4gICAgICAgICAgdGhpcy5tYXRlcmlhbFxuICAgICAgICApO1xuICAgICAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5lbC5zZXRPYmplY3QzRChgcGFydGljbGVwbGF5ZXIke2l9YCwgcGFydGljbGVTeXN0ZW0ubWVzaCk7XG4gICAgICAgIGNvcHlBcnJheShcbiAgICAgICAgICB0aGlzLm9yaWdpbmFsVmVydGV4UG9zaXRpb25zLFxuICAgICAgICAgIG1lcmdlZEJ1ZmZlckdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBIaWRlIGFsbCBwYXJ0aWNsZXMgYnkgZGVmYXVsdC5cbiAgICAgICAgZm9yIChcbiAgICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgICAgaSA8IG1lcmdlZEJ1ZmZlckdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXkubGVuZ3RoO1xuICAgICAgICAgIGkrK1xuICAgICAgICApIHtcbiAgICAgICAgICBtZXJnZWRCdWZmZXJHZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W2ldID0gLTk5OTk5O1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJ0aWNsZVN5c3RlbS5hY3RpdmVQYXJ0aWNsZUluZGljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5hY3RpdmVQYXJ0aWNsZUluZGljZXNbaV0gPSBpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wYXJ0aWNsZVN5c3RlbXMucHVzaChwYXJ0aWNsZVN5c3RlbSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSkoKSxcblxuICBzdGFydDogZnVuY3Rpb24gKGV2dCkge1xuICAgIGlmICh0aGlzLmRhdGEuZGVsYXkgPiAwKSB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuc3RhcnRBZnRlckRlbGF5KGV2dCksIHRoaXMuZGF0YS5kZWxheSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhcnRBZnRlckRlbGF5KGV2dCk7XG4gICAgfVxuICB9LFxuXG4gIHN0YXJ0QWZ0ZXJEZWxheTogZnVuY3Rpb24gKGV2dCkge1xuICAgIC8vIHBvc2l0aW9uLCByb3RhdGlvblxuICAgIHZhciBmb3VuZCA9IC0xO1xuICAgIHZhciBwYXJ0aWNsZVN5c3RlbTtcbiAgICB2YXIgb2xkZXN0VGltZSA9IDA7XG4gICAgdmFyIHBvc2l0aW9uID0gZXZ0ID8gZXZ0LmRldGFpbC5wb3NpdGlvbiA6IG51bGw7XG4gICAgdmFyIHJvdGF0aW9uID0gZXZ0ID8gZXZ0LmRldGFpbC5yb3RhdGlvbiA6IG51bGw7XG5cbiAgICBpZiAoIShwb3NpdGlvbiBpbnN0YW5jZW9mIFRIUkVFLlZlY3RvcjMpKSB7XG4gICAgICBwb3NpdGlvbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgfVxuICAgIGlmICghKHJvdGF0aW9uIGluc3RhbmNlb2YgVEhSRUUuRXVsZXIpKSB7XG4gICAgICByb3RhdGlvbiA9IG5ldyBUSFJFRS5FdWxlcigpO1xuICAgIH1cblxuICAgIC8vIGZpbmQgYXZhaWxhYmxlIChvciBvbGRlc3QpIHBhcnRpY2xlIHN5c3RlbVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wYXJ0aWNsZVN5c3RlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLnBhcnRpY2xlU3lzdGVtc1tpXS5hY3RpdmUgPT09IGZhbHNlKSB7XG4gICAgICAgIGZvdW5kID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5wYXJ0aWNsZVN5c3RlbXNbaV0udGltZSA+IG9sZGVzdFRpbWUpIHtcbiAgICAgICAgZm91bmQgPSBpO1xuICAgICAgICBvbGRlc3RUaW1lID0gdGhpcy5wYXJ0aWNsZVN5c3RlbXNbaV0udGltZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZm91bmQgPT09IC0xKSB7IHJldHVybjsgfVxuXG4gICAgcGFydGljbGVTeXN0ZW0gPSB0aGlzLnBhcnRpY2xlU3lzdGVtc1tmb3VuZF07XG4gICAgcGFydGljbGVTeXN0ZW0uYWN0aXZlID0gdHJ1ZTtcbiAgICBwYXJ0aWNsZVN5c3RlbS5sb29wQ291bnQgPSAxO1xuICAgIHBhcnRpY2xlU3lzdGVtLm1lc2gudmlzaWJsZSA9IHRydWU7XG4gICAgcGFydGljbGVTeXN0ZW0ubWVzaC5wb3NpdGlvbi5jb3B5KHBvc2l0aW9uKTtcbiAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLnJvdGF0aW9uLmNvcHkocm90YXRpb24pO1xuICAgIHBhcnRpY2xlU3lzdGVtLnRpbWUgPSAwO1xuICAgIHRoaXMucmVzZXRQYXJ0aWNsZXMocGFydGljbGVTeXN0ZW0pO1xuICAgIHJldHVybiBwYXJ0aWNsZVN5c3RlbTtcbiAgfSxcblxuICBkb0xvb3A6IGZ1bmN0aW9uIChwYXJ0aWNsZVN5c3RlbSkge1xuICAgIHBhcnRpY2xlU3lzdGVtLmxvb3BDb3VudCsrO1xuICAgIHBhcnRpY2xlU3lzdGVtLmZyYW1lID0gLTE7XG4gICAgcGFydGljbGVTeXN0ZW0udGltZSA9IDA7XG4gICAgdGhpcy5yZXNldFBhcnRpY2xlcyhwYXJ0aWNsZVN5c3RlbSk7XG4gIH0sXG5cbiAgcmVzZXRQYXJ0aWNsZTogZnVuY3Rpb24gKHBhcnRpY2xlU3lzdGVtLCBwYXJ0aWNsZUluZGV4KSB7XG4gICAgY29uc3QgZ2VvbWV0cnkgPSBwYXJ0aWNsZVN5c3RlbS5tZXNoLmdlb21ldHJ5O1xuXG4gICAgaWYgKHRoaXMucmVzdFBvc2l0aW9uc1twYXJ0aWNsZUluZGV4XSkge1xuICAgICAgdHJhbnNmb3JtUGxhbmUoXG4gICAgICAgIHBhcnRpY2xlSW5kZXgsXG4gICAgICAgIGdlb21ldHJ5LFxuICAgICAgICB0aGlzLm9yaWdpbmFsVmVydGV4UG9zaXRpb25zLFxuICAgICAgICB0aGlzLnJlc3RQb3NpdGlvbnNbcGFydGljbGVJbmRleF0sXG4gICAgICAgIHRoaXMudXNlUm90YXRpb24gJiYgdGhpcy5yZXN0Um90YXRpb25zW3BhcnRpY2xlSW5kZXhdLFxuICAgICAgICBudWxsXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBIaWRlLlxuICAgICAgdHJhbnNmb3JtUGxhbmUoXG4gICAgICAgIHBhcnRpY2xlSW5kZXgsXG4gICAgICAgIGdlb21ldHJ5LFxuICAgICAgICB0aGlzLm9yaWdpbmFsVmVydGV4UG9zaXRpb25zLFxuICAgICAgICBPRkZTQ1JFRU5fVkVDMyxcbiAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICBudWxsXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFRPRE86IENhbiB1cGRhdGUgdHJhbnNmb3JtUGxhbmUgZm9yIGxvb2tBdC5cbiAgICAvLyBsb29rQXQgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGVkIG9yIHRyYW5zbGF0ZWQgcGFyZW50cyEgOl8oXG4gICAgLy8gcGFydC5sb29rQXQodGhpcy5jYW1lcmEucG9zaXRpb24pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBXaGVuIHN0YXJ0aW5nIG9yIGZpbmlzaGluZyAobG9vcGluZykgYW5pbWF0aW9uLCB0aGlzIHJlc2V0cyBwYXJ0aWNsZXNcbiAgICogdG8gdGhlaXIgaW5pdGlhbCBwb3NpdGlvbiBhbmQsIGlmIHVzZXIgYXNrZWQgZm9yIHJlcGxheWluZyBsZXNzIHRoYW4gMTAwJVxuICAgKiBvZiBwYXJ0aWNsZXMsIHJhbmRvbWx5IGNob29zZSB0aGVtLlxuICAgKi9cbiAgcmVzZXRQYXJ0aWNsZXM6IGZ1bmN0aW9uIChwYXJ0aWNsZVN5c3RlbSkge1xuICAgIHZhciBpO1xuICAgIHZhciByYW5kO1xuXG4gICAgLy8gbm8gcGlja2luZywganVzdCBoaWRlIGFuZCByZXNldFxuICAgIGlmICh0aGlzLnBhcnRpY2xlQ291bnQgPT09IHRoaXMubnVtUGFydGljbGVzKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5udW1QYXJ0aWNsZXM7IGkrKykge1xuICAgICAgICB0aGlzLnJlc2V0UGFydGljbGUocGFydGljbGVTeXN0ZW0sIGkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGhpZGUgcGFydGljbGVzIGZyb20gbGFzdCBhbmltYXRpb24gYW5kIGluaXRpYWxpemUgaW5kZXhQb29sXG4gICAgY29uc3QgZ2VvbWV0cnkgPSBwYXJ0aWNsZVN5c3RlbS5tZXNoLmdlb21ldHJ5O1xuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLm51bVBhcnRpY2xlczsgaSsrKSB7XG4gICAgICBpZiAoaSA8IHRoaXMucGFydGljbGVDb3VudCkge1xuICAgICAgICB0cmFuc2Zvcm1QbGFuZShcbiAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5hY3RpdmVQYXJ0aWNsZUluZGljZXNbaV0sXG4gICAgICAgICAgZ2VvbWV0cnksXG4gICAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgICBPRkZTQ1JFRU5fVkVDMyxcbiAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgbnVsbFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdGhpcy5pbmRleFBvb2xbaV0gPSBpO1xuICAgIH1cblxuICAgIC8vIHNjcmFtYmxlIGluZGV4UG9vbFxuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnBhcnRpY2xlQ291bnQ7IGkrKykge1xuICAgICAgcmFuZCA9IGkgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAodGhpcy5udW1QYXJ0aWNsZXMgLSBpKSk7XG4gICAgICBwYXJ0aWNsZVN5c3RlbS5hY3RpdmVQYXJ0aWNsZUluZGljZXNbaV0gPSB0aGlzLmluZGV4UG9vbFtyYW5kXTtcbiAgICAgIHRoaXMuaW5kZXhQb29sW3JhbmRdID0gdGhpcy5pbmRleFBvb2xbaV07XG4gICAgICB0aGlzLnJlc2V0UGFydGljbGUoXG4gICAgICAgIHBhcnRpY2xlU3lzdGVtLFxuICAgICAgICBwYXJ0aWNsZVN5c3RlbS5hY3RpdmVQYXJ0aWNsZUluZGljZXNbaV1cbiAgICAgICk7XG4gICAgfVxuICB9LFxuXG4gIHRpY2s6IChmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgaGVscGVyUG9zaXRpb25WZWMzID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICAgIHZhciBmcmFtZTsgLy8gY3VycmVudCBwYXJ0aWNsZSBzeXN0ZW0gZnJhbWVcbiAgICAgIHZhciBmZGF0YTsgLy8gYWxsIHBhcnRpY2xlcyBkYXRhIGluIGN1cnJlbnQgZnJhbWVcbiAgICAgIHZhciBmZGF0YU5leHQ7IC8vIG5leHQgZnJhbWUgKGZvciBpbnRlcnBvbGF0aW9uKVxuICAgICAgdmFyIHVzZVJvdGF0aW9uID0gdGhpcy51c2VSb3RhdGlvbjtcbiAgICAgIHZhciBmcmFtZVRpbWU7IC8vIHRpbWUgaW4gY3VycmVudCBmcmFtZSAoZm9yIGludGVycG9sYXRpb24pXG4gICAgICB2YXIgcmVsVGltZTsgLy8gY3VycmVudCBwYXJ0aWNsZSBzeXN0ZW0gcmVsYXRpdmUgdGltZSAoMC0xKVxuICAgICAgdmFyIGludGVycG9sYXRlOyAvLyB3aGV0aGVyIGludGVycG9sYXRlIGJldHdlZW4gZnJhbWVzIG9yIG5vdFxuICAgICAgY29uc3Qgc2NhbGVTeXN0ZW0gPSB0aGlzLmRhdGEuYW5pbWF0ZVNjYWxlICYmICF0aGlzLnVzZUFnZTtcbiAgICAgIGNvbnN0IHNjYWxlUGFydGljbGUgPSB0aGlzLmRhdGEuYW5pbWF0ZVNjYWxlICYmIHRoaXMudXNlQWdlO1xuXG4gICAgICBmb3IgKFxuICAgICAgICBsZXQgcGFydGljbGVTeXN0ZW1JbmRleCA9IDA7XG4gICAgICAgIHBhcnRpY2xlU3lzdGVtSW5kZXggPCB0aGlzLnBhcnRpY2xlU3lzdGVtcy5sZW5ndGg7XG4gICAgICAgIHBhcnRpY2xlU3lzdGVtSW5kZXgrK1xuICAgICAgKSB7XG4gICAgICAgIGxldCBwYXJ0aWNsZVN5c3RlbSA9IHRoaXMucGFydGljbGVTeXN0ZW1zW3BhcnRpY2xlU3lzdGVtSW5kZXhdO1xuICAgICAgICBpZiAoIXBhcnRpY2xlU3lzdGVtLmFjdGl2ZSkge1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgdGhlIGR1cmF0aW9uIGlzIHNvIHNob3J0IHRoYXQgdGhlcmUncyBubyBuZWVkIHRvIGludGVycG9sYXRlLCBkb24ndCBkbyBpdFxuICAgICAgICAvLyBldmVuIGlmIHVzZXIgYXNrZWQgZm9yIGl0LlxuICAgICAgICBpbnRlcnBvbGF0ZSA9XG4gICAgICAgICAgdGhpcy5kYXRhLmludGVycG9sYXRlICYmIHRoaXMuZGF0YS5kdXIgLyB0aGlzLm51bUZyYW1lcyA+IGRlbHRhO1xuICAgICAgICByZWxUaW1lID0gcGFydGljbGVTeXN0ZW0udGltZSAvIHRoaXMuZGF0YS5kdXI7XG4gICAgICAgIGZyYW1lID0gcmVsVGltZSAqIHRoaXMubnVtRnJhbWVzO1xuICAgICAgICBmZGF0YSA9IHRoaXMuZnJhbWVkYXRhW01hdGguZmxvb3IoZnJhbWUpXTtcbiAgICAgICAgaWYgKGludGVycG9sYXRlKSB7XG4gICAgICAgICAgZnJhbWVUaW1lID0gZnJhbWUgLSBNYXRoLmZsb29yKGZyYW1lKTtcbiAgICAgICAgICBmZGF0YU5leHQgPVxuICAgICAgICAgICAgZnJhbWUgPCB0aGlzLm51bUZyYW1lcyAtIDFcbiAgICAgICAgICAgICAgPyB0aGlzLmZyYW1lZGF0YVtNYXRoLmZsb29yKGZyYW1lKSArIDFdXG4gICAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzY2FsZVN5c3RlbSkge1xuICAgICAgICAgIHRoaXMucGFydFNjYWxlLmxlcnBWZWN0b3JzKHRoaXMuZGF0YS5pbml0aWFsU2NhbGUsIHRoaXMuZGF0YS5maW5hbFNjYWxlLCByZWxUaW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoXG4gICAgICAgICAgbGV0IGFjdGl2ZVBhcnRpY2xlSW5kZXggPSAwO1xuICAgICAgICAgIGFjdGl2ZVBhcnRpY2xlSW5kZXggPCBwYXJ0aWNsZVN5c3RlbS5hY3RpdmVQYXJ0aWNsZUluZGljZXMubGVuZ3RoO1xuICAgICAgICAgIGFjdGl2ZVBhcnRpY2xlSW5kZXgrK1xuICAgICAgICApIHtcbiAgICAgICAgICBsZXQgcGFydGljbGVJbmRleCA9XG4gICAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5hY3RpdmVQYXJ0aWNsZUluZGljZXNbYWN0aXZlUGFydGljbGVJbmRleF07XG4gICAgICAgICAgbGV0IHJvdGF0aW9uID0gdXNlUm90YXRpb24gJiYgZmRhdGFbcGFydGljbGVJbmRleF0ucm90YXRpb247XG5cbiAgICAgICAgICBpZiAoc2NhbGVQYXJ0aWNsZSkge1xuICAgICAgICAgICAgdGhpcy5wYXJ0U2NhbGUubGVycFZlY3RvcnModGhpcy5kYXRhLmluaXRpYWxTY2FsZSwgdGhpcy5kYXRhLmZpbmFsU2NhbGUsIGZkYXRhW3BhcnRpY2xlSW5kZXhdLmFnZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gVE9ETzogQWRkIHZlcnRleCBwb3NpdGlvbiB0byBvcmlnaW5hbCBwb3NpdGlvbiB0byBhbGwgdmVydGljZXMgb2YgcGxhbmUuLi5cbiAgICAgICAgICBpZiAoIWZkYXRhW3BhcnRpY2xlSW5kZXhdLmFsaXZlKSB7XG4gICAgICAgICAgICAvLyBIaWRlIHBsYW5lIG9mZi1zY3JlZW4gd2hlbiBub3QgYWxpdmUuXG4gICAgICAgICAgICB0cmFuc2Zvcm1QbGFuZShcbiAgICAgICAgICAgICAgcGFydGljbGVJbmRleCxcbiAgICAgICAgICAgICAgcGFydGljbGVTeXN0ZW0ubWVzaC5nZW9tZXRyeSxcbiAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFZlcnRleFBvc2l0aW9ucyxcbiAgICAgICAgICAgICAgT0ZGU0NSRUVOX1ZFQzMsXG4gICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgbnVsbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChpbnRlcnBvbGF0ZSAmJiBmZGF0YU5leHQgJiYgZmRhdGFOZXh0W3BhcnRpY2xlSW5kZXhdLmFsaXZlKSB7XG4gICAgICAgICAgICBoZWxwZXJQb3NpdGlvblZlYzMubGVycFZlY3RvcnMoXG4gICAgICAgICAgICAgIGZkYXRhW3BhcnRpY2xlSW5kZXhdLnBvc2l0aW9uLFxuICAgICAgICAgICAgICBmZGF0YU5leHRbcGFydGljbGVJbmRleF0ucG9zaXRpb24sXG4gICAgICAgICAgICAgIGZyYW1lVGltZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRyYW5zZm9ybVBsYW5lKFxuICAgICAgICAgICAgICBwYXJ0aWNsZUluZGV4LFxuICAgICAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5tZXNoLmdlb21ldHJ5LFxuICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsVmVydGV4UG9zaXRpb25zLFxuICAgICAgICAgICAgICBoZWxwZXJQb3NpdGlvblZlYzMsXG4gICAgICAgICAgICAgIHJvdGF0aW9uLFxuICAgICAgICAgICAgICB0aGlzLnBhcnRTY2FsZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJhbnNmb3JtUGxhbmUoXG4gICAgICAgICAgICAgIHBhcnRpY2xlSW5kZXgsXG4gICAgICAgICAgICAgIHBhcnRpY2xlU3lzdGVtLm1lc2guZ2VvbWV0cnksXG4gICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxWZXJ0ZXhQb3NpdGlvbnMsXG4gICAgICAgICAgICAgIGZkYXRhW3BhcnRpY2xlSW5kZXhdLnBvc2l0aW9uLFxuICAgICAgICAgICAgICByb3RhdGlvbixcbiAgICAgICAgICAgICAgdGhpcy5wYXJ0U2NhbGVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcGFydGljbGVTeXN0ZW0udGltZSArPSBkZWx0YTtcbiAgICAgICAgaWYgKHBhcnRpY2xlU3lzdGVtLnRpbWUgPj0gdGhpcy5kYXRhLmR1cikge1xuICAgICAgICAgIGlmIChwYXJ0aWNsZVN5c3RlbS5sb29wQ291bnQgPCBwYXJ0aWNsZVN5c3RlbS5sb29wVG90YWwpIHtcbiAgICAgICAgICAgIHRoaXMuZWwuZW1pdCgncGFydGljbGVwbGF5ZXJsb29wJywgbnVsbCwgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5kb0xvb3AocGFydGljbGVTeXN0ZW0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVsLmVtaXQoJ3BhcnRpY2xlcGxheWVyZmluaXNoZWQnLCBudWxsLCBmYWxzZSk7XG4gICAgICAgICAgICBwYXJ0aWNsZVN5c3RlbS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIHBhcnRpY2xlU3lzdGVtLm1lc2gudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH0pKCksXG5cbiAgX3RyYW5zZm9ybVBsYW5lOiB0cmFuc2Zvcm1QbGFuZVxufSk7XG5cbi8vIFVzZSB0cmlhbmdsZSBnZW9tZXRyeSBhcyBhIGhlbHBlciBmb3Igcm90YXRpbmcuXG5jb25zdCB0cmkgPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCB0cmkgPSBuZXcgVEhSRUUuR2VvbWV0cnkoKTtcbiAgdHJpLnZlcnRpY2VzLnB1c2gobmV3IFRIUkVFLlZlY3RvcjMoKSk7XG4gIHRyaS52ZXJ0aWNlcy5wdXNoKG5ldyBUSFJFRS5WZWN0b3IzKCkpO1xuICB0cmkudmVydGljZXMucHVzaChuZXcgVEhSRUUuVmVjdG9yMygpKTtcbiAgdHJpLmZhY2VzLnB1c2gobmV3IFRIUkVFLkZhY2UzKDAsIDEsIDIpKTtcbiAgcmV0dXJuIHRyaTtcbn0pKCk7XG5cbi8qKlxuICogRmFjZXMgb2YgYSBwbGFuZSBhcmUgdjAsIHYyLCB2MSBhbmQgdjIsIHYzLCB2MS5cbiAqIFBvc2l0aW9ucyBhcmUgMTIgbnVtYmVyczogW3YwLCB2MSwgdjIsIHYzXS5cbiAqL1xuZnVuY3Rpb24gdHJhbnNmb3JtUGxhbmUgKFxuICBwYXJ0aWNsZUluZGV4LFxuICBnZW9tZXRyeSxcbiAgb3JpZ2luYWxBcnJheSxcbiAgcG9zaXRpb24sXG4gIHJvdGF0aW9uLFxuICBzY2FsZVxuKSB7XG4gIGNvbnN0IGFycmF5ID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTtcbiAgY29uc3QgaW5kZXggPSBwYXJ0aWNsZUluZGV4ICogTlVNX1BMQU5FX1BPU0lUSU9OUztcblxuICAvLyBDYWxjdWxhdGUgZmlyc3QgZmFjZSAoMCwgMiwgMSkuXG4gIHRyaS52ZXJ0aWNlc1swXS5zZXQoXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDBdLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyAxXSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgMl1cbiAgKTtcbiAgdHJpLnZlcnRpY2VzWzFdLnNldChcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgM10sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDRdLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA1XVxuICApO1xuICB0cmkudmVydGljZXNbMl0uc2V0KFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA2XSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgN10sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDhdXG4gICk7XG4gIGlmIChzY2FsZSAhPT0gbnVsbCkge1xuICAgIHRyaS5zY2FsZShzY2FsZS54LCBzY2FsZS55LCBzY2FsZS56KTtcbiAgfVxuICBpZiAocm90YXRpb24pIHtcbiAgICB0cmkucm90YXRlWChyb3RhdGlvbi54KTtcbiAgICB0cmkucm90YXRlWShyb3RhdGlvbi55KTtcbiAgICB0cmkucm90YXRlWihyb3RhdGlvbi56KTtcbiAgfVxuICB0cmkudmVydGljZXNbMF0uYWRkKHBvc2l0aW9uKTtcbiAgdHJpLnZlcnRpY2VzWzFdLmFkZChwb3NpdGlvbik7XG4gIHRyaS52ZXJ0aWNlc1syXS5hZGQocG9zaXRpb24pO1xuICBhcnJheVtpbmRleCArIDBdID0gdHJpLnZlcnRpY2VzWzBdLng7XG4gIGFycmF5W2luZGV4ICsgMV0gPSB0cmkudmVydGljZXNbMF0ueTtcbiAgYXJyYXlbaW5kZXggKyAyXSA9IHRyaS52ZXJ0aWNlc1swXS56O1xuICBhcnJheVtpbmRleCArIDNdID0gdHJpLnZlcnRpY2VzWzFdLng7XG4gIGFycmF5W2luZGV4ICsgNF0gPSB0cmkudmVydGljZXNbMV0ueTtcbiAgYXJyYXlbaW5kZXggKyA1XSA9IHRyaS52ZXJ0aWNlc1sxXS56O1xuICBhcnJheVtpbmRleCArIDZdID0gdHJpLnZlcnRpY2VzWzJdLng7XG4gIGFycmF5W2luZGV4ICsgN10gPSB0cmkudmVydGljZXNbMl0ueTtcbiAgYXJyYXlbaW5kZXggKyA4XSA9IHRyaS52ZXJ0aWNlc1syXS56O1xuXG4gIC8vIENhbGN1bGF0ZSBzZWNvbmQgZmFjZSAoMiwgMywgMSkganVzdCBmb3IgdGhlIGxhc3QgdmVydGV4LlxuICB0cmkudmVydGljZXNbMF0uc2V0KFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyAzXSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgNF0sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDVdXG4gICk7XG4gIHRyaS52ZXJ0aWNlc1sxXS5zZXQoXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDZdLFxuICAgIG9yaWdpbmFsQXJyYXlbaW5kZXggKyA3XSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgOF1cbiAgKTtcbiAgdHJpLnZlcnRpY2VzWzJdLnNldChcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgOV0sXG4gICAgb3JpZ2luYWxBcnJheVtpbmRleCArIDEwXSxcbiAgICBvcmlnaW5hbEFycmF5W2luZGV4ICsgMTFdXG4gICk7XG4gIGlmIChzY2FsZSAhPT0gbnVsbCkge1xuICAgIHRyaS5zY2FsZShzY2FsZS54LCBzY2FsZS55LCBzY2FsZS56KTtcbiAgfVxuICBpZiAocm90YXRpb24pIHtcbiAgICB0cmkucm90YXRlWChyb3RhdGlvbi54KTtcbiAgICB0cmkucm90YXRlWShyb3RhdGlvbi55KTtcbiAgICB0cmkucm90YXRlWihyb3RhdGlvbi56KTtcbiAgfVxuICB0cmkudmVydGljZXNbMF0uYWRkKHBvc2l0aW9uKTtcbiAgdHJpLnZlcnRpY2VzWzFdLmFkZChwb3NpdGlvbik7XG4gIHRyaS52ZXJ0aWNlc1syXS5hZGQocG9zaXRpb24pO1xuICBhcnJheVtpbmRleCArIDldID0gdHJpLnZlcnRpY2VzWzJdLng7XG4gIGFycmF5W2luZGV4ICsgMTBdID0gdHJpLnZlcnRpY2VzWzJdLnk7XG4gIGFycmF5W2luZGV4ICsgMTFdID0gdHJpLnZlcnRpY2VzWzJdLno7XG5cbiAgZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5uZWVkc1VwZGF0ZSA9IHRydWU7XG59XG5tb2R1bGUuZXhwb3J0cy50cmFuc2Zvcm1QbGFuZSA9IHRyYW5zZm9ybVBsYW5lO1xuXG5mdW5jdGlvbiBjb3B5QXJyYXkgKGRlc3QsIHNyYykge1xuICBkZXN0Lmxlbmd0aCA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3JjLmxlbmd0aDsgaSsrKSB7XG4gICAgZGVzdFtpXSA9IHNyY1tpXTtcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvcGFydGljbGVwbGF5ZXIuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3BhdXNlJywge1xuICBzY2hlbWE6IHtcbiAgICBpc1BhdXNlZDoge2RlZmF1bHQ6IGZhbHNlfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmRhdGEuaXNQYXVzZWQgJiYgdGhpcy5lbC5pc1BsYXlpbmcpIHtcbiAgICAgIHRoaXMuZWwucGF1c2UoKTtcbiAgICB9IGVsc2UgaWYgKCF0aGlzLmRhdGEuaXNQYXVzZWQgJiYgIXRoaXMuZWwuaXNQbGF5aW5nICYmIHRoaXMuZWwuc2NlbmVFbC5pc1BsYXlpbmcpIHtcbiAgICAgIHRoaXMuZWwucGxheSgpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9wYXVzZS5qcyIsIi8qKlxuICogVGVsbCBhcHAgdG8gcGF1c2UgZ2FtZSBpZiBwbGF5aW5nLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3BhdXNlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IHRydWV9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMucGF1c2VHYW1lID0gdGhpcy5wYXVzZUdhbWUuYmluZCh0aGlzKTtcblxuICAgIHRoaXMuZWwuc2NlbmVFbC5hZGRFdmVudExpc3RlbmVyKCdjb250cm9sbGVyY29ubmVjdGVkJywgZXZ0ID0+IHtcbiAgICAgIGlmIChldnQuZGV0YWlsLm5hbWUgPT09ICd2aXZlLWNvbnRyb2xzJykge1xuICAgICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21lbnVkb3duJywgdGhpcy5wYXVzZUdhbWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCd0aHVtYnN0aWNrZG93bicsIHRoaXMucGF1c2VHYW1lKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Zpc2liaWxpdHljaGFuZ2UnLCAoKSA9PiB7XG4gICAgICBpZiAoZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlID09PSAnaGlkZGVuJykgeyB0aGlzLnBhdXNlR2FtZSgpOyB9XG4gICAgfSk7XG4gIH0sXG5cbiAgcGF1c2VHYW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgncGF1c2VnYW1lJywgbnVsbCwgZmFsc2UpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3BhdXNlci5qcyIsInZhciBTb3VuZFBvb2wgPSByZXF1aXJlKCcuLi9saWIvc291bmRwb29sJyk7XG5cbkFGUkFNRS5yZWdpc3RlclN5c3RlbSgncGxheS1zb3VuZCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubGFzdFNvdW5kUGxheWVkID0gJyc7XG4gICAgdGhpcy5sYXN0U291bmRQbGF5ZWRUaW1lID0gMDtcbiAgICB0aGlzLnBvb2xzID0ge307XG4gIH0sXG5cbiAgY3JlYXRlUG9vbDogZnVuY3Rpb24gKHNvdW5kLCB2b2x1bWUpIHtcbiAgICBpZiAodGhpcy5wb29sc1tzb3VuZF0pIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5wb29sc1tzb3VuZF0gPSBuZXcgU291bmRQb29sKHNvdW5kLCB2b2x1bWUpO1xuICB9LFxuXG4gIHBsYXlTb3VuZDogZnVuY3Rpb24gKHNvdW5kLCB2b2x1bWUpIHtcbiAgICBpZiAoIXRoaXMucG9vbHNbc291bmRdKSB7XG4gICAgICB0aGlzLmNyZWF0ZVBvb2woc291bmQsIHZvbHVtZSk7XG4gICAgfVxuICAgIHRoaXMucG9vbHNbc291bmRdLnBsYXkoKTtcblxuICAgIHRoaXMubGFzdFNvdW5kUGxheWVkID0gc291bmQ7XG4gICAgdGhpcy5sYXN0U291bmRUaW1lID0gdGhpcy5lbC50aW1lO1xuICB9XG59KTtcblxuLyoqXG4gKiBQbGF5IHNvdW5kIG9uIGV2ZW50LlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3BsYXktc291bmQnLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfSxcbiAgICBldmVudDoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICBzb3VuZDoge3R5cGU6ICdzdHJpbmcnfSxcbiAgICB2b2x1bWU6IHt0eXBlOiAnbnVtYmVyJywgZGVmYXVsdDogMX1cbiAgfSxcblxuICBtdWx0aXBsZTogdHJ1ZSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKHRoaXMuZGF0YS5ldmVudCwgZXZ0ID0+IHtcbiAgICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgICB0aGlzLnN5c3RlbS5wbGF5U291bmQodGhpcy5zcmMsIHRoaXMuZGF0YS52b2x1bWUpO1xuICAgIH0pO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3JjID0gdGhpcy5kYXRhLnNvdW5kO1xuICAgIGlmICh0aGlzLmRhdGEuc291bmQuc3RhcnRzV2l0aCgnIycpKSB7XG4gICAgICB0aGlzLnNyYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5kYXRhLnNvdW5kKS5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuICAgIH1cbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9wbGF5LXNvdW5kLmpzIiwiLyoqXG4gKiBTZXQgcmF5Y2FzdCB0YXJnZXQgYXMgYSBjaGlsZCBpbmRlcGVuZG5lbnQgZnJvbSBlbnRpdHkuXG4gKiBVc2VmdWwgZm9yIHBhZGRpbmcgdGhlIHJheWNhc3QgdGFyZ2V0IG9mIGEgbWVzaCB3aXRob3V0IGNoYW5naW5nIHRoZSBtZXNoLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3JheWNhc3Rlci10YXJnZXQnLCB7XG4gIHNjaGVtYToge1xuICAgIGJpbmRUb2dnbGU6IHtkZWZhdWx0OiAnJ30sXG4gICAgZGVwdGg6IHt0eXBlOiAnbnVtYmVyJ30sXG4gICAgaGVpZ2h0OiB7dHlwZTogJ251bWJlcid9LFxuICAgIHBvc2l0aW9uOiB7dHlwZTogJ3ZlYzMnLCBkZWZhdWx0OiB7eDogMCwgeTogMCwgejogMH19LFxuICAgIHJvdGF0aW9uOiB7dHlwZTogJ3ZlYzMnLCBkZWZhdWx0OiB7eDogMCwgeTogMCwgejogMH19LFxuICAgIHVzZUJveFRhcmdldDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICB3aWR0aDoge3R5cGU6ICdudW1iZXInfVxuICB9LFxuXG4gIGluaXQ6IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGJveEdlb21ldHJ5ID0ge3ByaW1pdGl2ZTogJ2JveCd9O1xuICAgIHZhciBwbGFuZUdlb21ldHJ5ID0ge3ByaW1pdGl2ZTogJ3BsYW5lJ307XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgICAgdmFyIGdlb21ldHJ5O1xuICAgICAgdmFyIHJheWNhc3RUYXJnZXQ7XG5cbiAgICAgIHJheWNhc3RUYXJnZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgICAgcmF5Y2FzdFRhcmdldC5jbGFzc0xpc3QuYWRkKCdyYXljYXN0ZXJUYXJnZXQnKTtcblxuICAgICAgaWYgKGRhdGEuYmluZFRvZ2dsZSkge1xuICAgICAgICByYXljYXN0VGFyZ2V0LnNldEF0dHJpYnV0ZSgnYmluZC10b2dnbGVfX3JheWNhc3RhYmxlJywgZGF0YS5iaW5kVG9nZ2xlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJheWNhc3RUYXJnZXQuc2V0QXR0cmlidXRlKCdkYXRhLXJheWNhc3RhYmxlJywgJycpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGF0YS51c2VCb3hUYXJnZXQpIHtcbiAgICAgICAgLy8gM0QgdGFyZ2V0LlxuICAgICAgICBnZW9tZXRyeSA9IGJveEdlb21ldHJ5O1xuICAgICAgICBnZW9tZXRyeS5kZXB0aCA9IGRhdGEuZGVwdGg7XG4gICAgICAgIGdlb21ldHJ5LmhlaWdodCA9IGRhdGEuaGVpZ2h0O1xuICAgICAgICBnZW9tZXRyeS53aWR0aCA9IGRhdGEud2lkdGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyAyRCB0YXJnZXQuXG4gICAgICAgIGdlb21ldHJ5ID0gcGxhbmVHZW9tZXRyeTtcbiAgICAgICAgZ2VvbWV0cnkuaGVpZ2h0ID0gZGF0YS5oZWlnaHQ7XG4gICAgICAgIGdlb21ldHJ5LndpZHRoID0gZGF0YS53aWR0aDtcbiAgICAgIH1cbiAgICAgIHJheWNhc3RUYXJnZXQuc2V0QXR0cmlidXRlKCdnZW9tZXRyeScsIGdlb21ldHJ5KTtcblxuICAgICAgcmF5Y2FzdFRhcmdldC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICByYXljYXN0VGFyZ2V0Lm9iamVjdDNELnBvc2l0aW9uLmNvcHkoZGF0YS5wb3NpdGlvbik7XG4gICAgICByYXljYXN0VGFyZ2V0Lm9iamVjdDNELnJvdGF0aW9uLnggPSBUSFJFRS5NYXRoLmRlZ1RvUmFkKGRhdGEucm90YXRpb24ueCk7XG4gICAgICByYXljYXN0VGFyZ2V0Lm9iamVjdDNELnJvdGF0aW9uLnkgPSBUSFJFRS5NYXRoLmRlZ1RvUmFkKGRhdGEucm90YXRpb24ueSk7XG4gICAgICByYXljYXN0VGFyZ2V0Lm9iamVjdDNELnJvdGF0aW9uLnogPSBUSFJFRS5NYXRoLmRlZ1RvUmFkKGRhdGEucm90YXRpb24ueik7XG5cbiAgICAgIGVsLmFwcGVuZENoaWxkKHJheWNhc3RUYXJnZXQpO1xuICAgIH07XG4gIH0pKClcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvcmF5Y2FzdGVyLXRhcmdldC5qcyIsIi8qKlxuICogUmVjZW50ZXIgY2FtZXJhIGJhY2sgdG8gZmFjaW5nIGRvd24gbmVnYXRpdmUgWiBheGlzIGF0IDAsIDAsIDAuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgncmVjZW50ZXInLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiB0cnVlfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2NlbmVFbCA9IHRoaXMuZWwuc2NlbmVFbDtcbiAgICB0aGlzLnJlY2VudGVyID0gdGhpcy5yZWNlbnRlci5iaW5kKHRoaXMpO1xuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3RyYWNrZWQtY29udHJvbHNdJykuZm9yRWFjaChjb250cm9sRWwgPT4ge1xuICAgICAgY29udHJvbEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21lbnVkb3duJywgdGhpcy5yZWNlbnRlcik7XG4gICAgICBjb250cm9sRWwuYWRkRXZlbnRMaXN0ZW5lcigndGh1bWJzdGlja2Rvd24nLCB0aGlzLnJlY2VudGVyKTtcbiAgICB9KTtcblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigncmVjZW50ZXInLCB0aGlzLnJlY2VudGVyKTtcbiAgfSxcblxuICByZWNlbnRlcjogKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXVsZXIgPSBuZXcgVEhSRUUuRXVsZXIoKTtcbiAgICB2YXIgbWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDQoKTtcbiAgICB2YXIgcm90YXRpb25NYXRyaXggPSBuZXcgVEhSRUUuTWF0cml4NCgpO1xuICAgIHZhciB0cmFuc2xhdGlvbk1hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KCk7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZWwgPSB0aGlzLmVsO1xuXG4gICAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuXG4gICAgICBjb25zdCBjYW1lcmEgPSBlbC5zY2VuZUVsLmNhbWVyYS5lbC5vYmplY3QzRDtcblxuICAgICAgLy8gUmVzZXQgbWF0cml4LlxuICAgICAgbWF0cml4LmlkZW50aXR5KCk7XG5cbiAgICAgIC8vIENyZWF0ZSBtYXRyaXggdG8gcmVzZXQgWSByb3RhdGlvbi5cbiAgICAgIGV1bGVyLnNldCgwLCAtMSAqIGNhbWVyYS5yb3RhdGlvbi55LCAwKTtcbiAgICAgIHJvdGF0aW9uTWF0cml4Lm1ha2VSb3RhdGlvbkZyb21FdWxlcihldWxlcik7XG5cbiAgICAgIC8vIENyZWF0ZSBtYXRyaXggdG8gemVybyBwb3NpdGlvbi5cbiAgICAgIHRyYW5zbGF0aW9uTWF0cml4Lm1ha2VUcmFuc2xhdGlvbigtMSAqIGNhbWVyYS5wb3NpdGlvbi54LCAwLCAtMSAqIGNhbWVyYS5wb3NpdGlvbi56KTtcblxuICAgICAgLy8gTXVsdGlwbHkgYW5kIGRlY29tcG9zZSBiYWNrIHRvIG9iamVjdDNELlxuICAgICAgbWF0cml4Lm11bHRpcGx5KHJvdGF0aW9uTWF0cml4KS5tdWx0aXBseSh0cmFuc2xhdGlvbk1hdHJpeCk7XG4gICAgICBtYXRyaXguZGVjb21wb3NlKGVsLm9iamVjdDNELnBvc2l0aW9uLCBlbC5vYmplY3QzRC5xdWF0ZXJuaW9uLCBlbC5vYmplY3QzRC5zY2FsZSk7XG4gICAgICBlbC5vYmplY3QzRC51cGRhdGVNYXRyaXhXb3JsZCh0cnVlKTtcbiAgICAgIGVsLmVtaXQoJ3JlY2VudGVyZWQnLCBudWxsLCBmYWxzZSk7XG4gICAgfTtcbiAgfSkoKVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9yZWNlbnRlci5qcyIsIi8qKlxuICogQ29udHJvbGxlciwgY3Vyc29yLCByYXljYXN0ZXIuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2FiZXItY29udHJvbHMnLCB7XG4gIHNjaGVtYToge1xuICAgIGJsYWRlRW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBoYW5kOiB7ZGVmYXVsdDogJ3JpZ2h0Jywgb25lT2Y6IFsnbGVmdCcsICdyaWdodCddfSxcbiAgICBpc1BhdXNlZDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBzdHJva2VNaW5TcGVlZDoge2RlZmF1bHQ6IDAuMDAyfSxcbiAgICBzdHJva2VNaW5EdXJhdGlvbjoge2RlZmF1bHQ6IDMwfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuICAgIHZhciBkYXRhID0gdGhpcy5kYXRhO1xuXG4gICAgdGhpcy5ib3VuZGluZ0JveCA9IG5ldyBUSFJFRS5Cb3gzKCk7XG4gICAgdGhpcy5jb250cm9sbGVyVHlwZSA9ICcnO1xuICAgIHRoaXMueFBsYW5lTm9ybWFsID0gbmV3IFRIUkVFLlZlY3RvcjMoMCwgMSwgMCk7XG4gICAgdGhpcy55UGxhbmVOb3JtYWwgPSBuZXcgVEhSRUUuVmVjdG9yMygxLCAwLCAwKTtcbiAgICB0aGlzLnh5UGxhbmVOb3JtYWwgPSBuZXcgVEhSRUUuVmVjdG9yMygxLCAxLCAwKTtcbiAgICB0aGlzLmJsYWRlVGlwUG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuYmxhZGVQb3NpdGlvbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5ibGFkZVZlY3RvciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5ibGFkZVRpcFByZXZpb3VzUG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMucHJvamVjdGVkQmxhZGVWZWN0b3IgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuc2FiZXJQb3NpdGlvbiA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG4gICAgdGhpcy5zd2luZ2luZyA9IGZhbHNlO1xuICAgIHRoaXMuc3Ryb2tlQ291bnQgPSAwO1xuICAgIHRoaXMuZGlzdGFuY2VTYW1wbGVzID0gW107XG4gICAgdGhpcy5kZWx0YVNhbXBsZXMgPSBbXTtcbiAgICB0aGlzLnN0YXJ0U3Ryb2tlUG9zaXRpb24gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuICAgIHRoaXMuc3Ryb2tlRGlyZWN0aW9uVmVjdG9yID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcbiAgICB0aGlzLnN0cm9rZURpcmVjdGlvbiA9IHtcbiAgICAgIGRvd246IGZhbHNlLFxuICAgICAgbGVmdDogZmFsc2UsXG4gICAgICByaWdodDogZmFsc2UsXG4gICAgICB1cDogZmFsc2VcbiAgICB9O1xuICAgIHRoaXMuYWNjdW11bGF0ZWREaXN0YW5jZSA9IDA7XG4gICAgdGhpcy5hY2N1bXVsYXRlZERlbHRhID0gMDtcblxuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRyb2xsZXJjb25uZWN0ZWQnLCB0aGlzLmluaXRTYWJlci5iaW5kKHRoaXMpKTtcblxuICAgIGNvbnN0IGhhbmQgPSB7aGFuZDogZGF0YS5oYW5kLCBtb2RlbDogZmFsc2V9O1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnb2N1bHVzLXRvdWNoLWNvbnRyb2xzJywgaGFuZCk7XG4gICAgZWwuc2V0QXR0cmlidXRlKCd2aXZlLWNvbnRyb2xzJywgaGFuZCk7XG4gICAgZWwuc2V0QXR0cmlidXRlKCd3aW5kb3dzLW1vdGlvbi1jb250cm9scycsIGhhbmQpO1xuXG4gICAgdGhpcy5ibGFkZUVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuYmxhZGUnKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgaWYgKCFvbGREYXRhLmJsYWRlRW5hYmxlZCAmJiB0aGlzLmRhdGEuYmxhZGVFbmFibGVkKSB7XG4gICAgICB0aGlzLmJsYWRlRWwuZW1pdCgnZHJhd2JsYWRlJyk7XG4gICAgfVxuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lLCBkZWx0YSkge1xuICAgIGlmICghdGhpcy5kYXRhLmJsYWRlRW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICB0aGlzLmJvdW5kaW5nQm94LnNldEZyb21PYmplY3QodGhpcy5ibGFkZUVsLmdldE9iamVjdDNEKCdtZXNoJykpO1xuICAgIHRoaXMuZGV0ZWN0U3Ryb2tlKGRlbHRhKTtcbiAgfSxcblxuICBkZXRlY3RTdHJva2U6IGZ1bmN0aW9uIChkZWx0YSkge1xuICAgIHZhciBkaXN0YW5jZTtcbiAgICB2YXIgZGlzdGFuY2VTYW1wbGVzID0gdGhpcy5kaXN0YW5jZVNhbXBsZXM7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGRpcmVjdGlvbkNoYW5nZTtcblxuICAgIC8vIFRpcCBvZiB0aGUgYmxhZGUgcG9zaXRpb24gaW4gd29ybGQgY29vcmRpbmF0ZXMuXG4gICAgdGhpcy5ibGFkZVRpcFBvc2l0aW9uLnNldCgwLCAwLCAtMC44KTtcbiAgICB0aGlzLmJsYWRlUG9zaXRpb24uc2V0KDAsIDAsIDApO1xuXG4gICAgY29uc3Qgc2FiZXJPYmogPSB0aGlzLmVsLm9iamVjdDNEO1xuICAgIHNhYmVyT2JqLnBhcmVudC51cGRhdGVNYXRyaXhXb3JsZCgpO1xuICAgIHNhYmVyT2JqLmxvY2FsVG9Xb3JsZCh0aGlzLmJsYWRlVGlwUG9zaXRpb24pO1xuICAgIHNhYmVyT2JqLmxvY2FsVG9Xb3JsZCh0aGlzLmJsYWRlUG9zaXRpb24pO1xuXG4gICAgLy8gQW5nbGVzIGJldHdlZW4gc2FiZXIgYW5kIG1ham9yIHBsYW5lcy5cbiAgICB0aGlzLmJsYWRlVmVjdG9yLmNvcHkodGhpcy5ibGFkZVRpcFBvc2l0aW9uKS5zdWIodGhpcy5ibGFkZVBvc2l0aW9uKS5ub3JtYWxpemUoKTtcbiAgICB2YXIgYW5nbGVQbGFuZVggPSB0aGlzLnByb2plY3RlZEJsYWRlVmVjdG9yLmNvcHkodGhpcy5ibGFkZVRpcFBvc2l0aW9uKS5wcm9qZWN0T25QbGFuZSh0aGlzLnhQbGFuZU5vcm1hbCkuYW5nbGVUbyh0aGlzLmJsYWRlVmVjdG9yKTtcbiAgICB2YXIgYW5nbGVQbGFuZVkgPSB0aGlzLnByb2plY3RlZEJsYWRlVmVjdG9yLmNvcHkodGhpcy5ibGFkZVRpcFBvc2l0aW9uKS5wcm9qZWN0T25QbGFuZSh0aGlzLnlQbGFuZU5vcm1hbCkuYW5nbGVUbyh0aGlzLmJsYWRlVmVjdG9yKTtcbiAgICB2YXIgYW5nbGVQbGFuZVhZID0gdGhpcy5wcm9qZWN0ZWRCbGFkZVZlY3Rvci5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbikucHJvamVjdE9uUGxhbmUodGhpcy54eVBsYW5lTm9ybWFsKS5hbmdsZVRvKHRoaXMuYmxhZGVWZWN0b3IpO1xuXG4gICAgLy8gRGlzdGFuY2UgY292ZXJlZCBidXQgdGhlIHNhYmVyIHRpcCBpbiBvbmUgZnJhbWUuXG4gICAgZGlzdGFuY2UgPSB0aGlzLmJsYWRlVGlwUHJldmlvdXNQb3NpdGlvbi5zdWIodGhpcy5ibGFkZVRpcFBvc2l0aW9uKS5sZW5ndGgoKTtcblxuICAgIC8vIFNhbXBsZSBkaXN0YW5jZSBvZiB0aGUgbGFzdCA1IGZyYW1lcy5cbiAgICBpZiAodGhpcy5kaXN0YW5jZVNhbXBsZXMubGVuZ3RoID09PSA1KSB7XG4gICAgICB0aGlzLmFjY3VtdWxhdGVkRGlzdGFuY2UgLT0gdGhpcy5kaXN0YW5jZVNhbXBsZXMuc2hpZnQoKTtcbiAgICAgIHRoaXMuYWNjdW11bGF0ZWREZWx0YSAtPSB0aGlzLmRlbHRhU2FtcGxlcy5zaGlmdCgpO1xuICAgIH1cbiAgICB0aGlzLmRpc3RhbmNlU2FtcGxlcy5wdXNoKGRpc3RhbmNlKTtcbiAgICB0aGlzLmFjY3VtdWxhdGVkRGlzdGFuY2UgKz0gZGlzdGFuY2U7XG5cbiAgICB0aGlzLmRlbHRhU2FtcGxlcy5wdXNoKGRlbHRhKTtcbiAgICB0aGlzLmFjY3VtdWxhdGVkRGVsdGEgKz0gZGVsdGE7XG5cbiAgICAvLyBGaWx0ZXIgb3V0IHNhYmVyIG1vdmVtZW50cyB0aGF0IGFyZSB0b28gc2xvdy4gVG9vIHNsb3cgaXMgY29uc2lkZXJlZCB3cm9uZyBoaXQuXG4gICAgaWYgKHRoaXMuYWNjdW11bGF0ZWREaXN0YW5jZSAvIHRoaXMuYWNjdW11bGF0ZWREZWx0YSA+IHRoaXMuZGF0YS5zdHJva2VNaW5TcGVlZCkge1xuICAgICAgLy8gVGhpcyBmaWx0ZXJzIG91dCB1bmludGVudGlvbmFsIHN3aW5ncy5cbiAgICAgIGlmICghdGhpcy5zd2luZ2luZykge1xuICAgICAgICB0aGlzLnN0YXJ0U3Ryb2tlUG9zaXRpb24uY29weSh0aGlzLmJsYWRlVGlwUG9zaXRpb24pO1xuICAgICAgICB0aGlzLnN3aW5naW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdHJva2VEdXJhdGlvbiA9IDA7XG4gICAgICAgIHRoaXMubWF4QW5nbGVQbGFuZVggPSAwO1xuICAgICAgICB0aGlzLm1heEFuZ2xlUGxhbmVZID0gMDtcbiAgICAgICAgdGhpcy5tYXhBbmdsZVBsYW5lWFkgPSAwO1xuICAgICAgfVxuICAgICAgdGhpcy51cGRhdGVTdHJva2VEaXJlY3Rpb24oKTtcbiAgICAgIHRoaXMuc3Ryb2tlRHVyYXRpb24gKz0gZGVsdGE7XG4gICAgICBjb25zdCBhbmdsZVBsYW5lWEluY3JlYXNlZCA9IGFuZ2xlUGxhbmVYID4gdGhpcy5tYXhBbmdsZVBsYW5lWDtcbiAgICAgIGNvbnN0IGFuZ2xlUGxhbmVZSW5jcmVhc2VkID0gYW5nbGVQbGFuZVkgPiB0aGlzLm1heEFuZ2xlUGxhbmVZO1xuICAgICAgY29uc3QgYW5nbGVQbGFuZVhZSW5jcmVhc2VkID0gYW5nbGVQbGFuZVhZID4gdGhpcy5tYXhBbmdsZVBsYW5lWFk7XG4gICAgICB0aGlzLm1heEFuZ2xlUGxhbmVYID0gYW5nbGVQbGFuZVhJbmNyZWFzZWQgPyBhbmdsZVBsYW5lWCA6IHRoaXMubWF4QW5nbGVQbGFuZVg7XG4gICAgICB0aGlzLm1heEFuZ2xlUGxhbmVZID0gYW5nbGVQbGFuZVlJbmNyZWFzZWQgPyBhbmdsZVBsYW5lWSA6IHRoaXMubWF4QW5nbGVQbGFuZVk7XG4gICAgICB0aGlzLm1heEFuZ2xlUGxhbmVYWSA9IGFuZ2xlUGxhbmVYWUluY3JlYXNlZCA/IGFuZ2xlUGxhbmVYWSA6IHRoaXMubWF4QW5nbGVQbGFuZVhZO1xuICAgICAgaWYgKCFhbmdsZVBsYW5lWEluY3JlYXNlZCAmJiAhYW5nbGVQbGFuZVlJbmNyZWFzZWQpIHsgdGhpcy5lbmRTdHJva2UoKTsgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVuZFN0cm9rZSgpO1xuICAgIH1cblxuICAgIHRoaXMuYmxhZGVUaXBQcmV2aW91c1Bvc2l0aW9uLmNvcHkodGhpcy5ibGFkZVRpcFBvc2l0aW9uKTtcbiAgfSxcblxuICBlbmRTdHJva2U6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuc3dpbmdpbmcgfHwgdGhpcy5zdHJva2VEdXJhdGlvbiA8IHRoaXMuZGF0YS5zdHJva2VNaW5EdXJhdGlvbikgeyByZXR1cm47IH1cblxuICAgIHRoaXMuZWwuZW1pdCgnc3Ryb2tlZW5kJyk7XG4gICAgdGhpcy5zd2luZ2luZyA9IGZhbHNlO1xuICAgIC8vIFN0cm9rZSBmaW5pc2hlcy4gUmVzZXQgc3dpbmdpbmcgc3RhdGUuXG4gICAgdGhpcy5hY2N1bXVsYXRlZERpc3RhbmNlID0gMDtcbiAgICB0aGlzLmFjY3VtdWxhdGVkRGVsdGEgPSAwO1xuICAgIHRoaXMubWF4QW5nbGVQbGFuZVggPSAwO1xuICAgIHRoaXMubWF4QW5nbGVQbGFuZVkgPSAwO1xuICAgIHRoaXMubWF4QW5nbGVQbGFuZVhZID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGlzdGFuY2VTYW1wbGVzLmxlbmd0aDsgaSsrKSB7IHRoaXMuZGlzdGFuY2VTYW1wbGVzW2ldID0gMDsgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kZWx0YVNhbXBsZXMubGVuZ3RoOyBpKyspIHsgdGhpcy5kZWx0YVNhbXBsZXNbaV0gPSAwOyB9XG5cbiAgICB2YXIgZGlyZWN0aW9uID0gJ0RJUkVDVElPTiAnXG4gICAgaWYgKHRoaXMuc3Ryb2tlRGlyZWN0aW9uLnJpZ2h0KSB7XG4gICAgICBkaXJlY3Rpb24gKz0gJ1JJR0hUJztcbiAgICB9IGVsc2Uge1xuICAgICAgZGlyZWN0aW9uICs9ICdMRUZUJztcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdHJva2VEaXJlY3Rpb24udXApIHtcbiAgICAgIGRpcmVjdGlvbiArPSAnIFRPUCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpcmVjdGlvbiArPSAnIEJPVFRPTSc7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGRpcmVjdGlvbik7XG4gICAgdGhpcy5lbC5lbWl0KCdzdHJva2VlbmQnKTtcbiAgfSxcblxuICB1cGRhdGVTdHJva2VEaXJlY3Rpb246IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnN0cm9rZURpcmVjdGlvblZlY3Rvci5jb3B5KHRoaXMuYmxhZGVUaXBQb3NpdGlvbikuc3ViKHRoaXMuc3RhcnRTdHJva2VQb3NpdGlvbik7XG4gICAgaWYgKHRoaXMuc3Ryb2tlRGlyZWN0aW9uVmVjdG9yLnggPT09IDAgJiYgdGhpcy5zdHJva2VEaXJlY3Rpb25WZWN0b3IueSA9PT0gMCkgeyByZXR1cm47IH1cbiAgICB0aGlzLnN0cm9rZURpcmVjdGlvbi5yaWdodCA9IHRoaXMuc3Ryb2tlRGlyZWN0aW9uVmVjdG9yLnggPiAwO1xuICAgIHRoaXMuc3Ryb2tlRGlyZWN0aW9uLmxlZnQgPSB0aGlzLnN0cm9rZURpcmVjdGlvblZlY3Rvci54IDwgMDtcbiAgICB0aGlzLnN0cm9rZURpcmVjdGlvbi51cCA9IHRoaXMuc3Ryb2tlRGlyZWN0aW9uVmVjdG9yLnkgPiAwO1xuICAgIHRoaXMuc3Ryb2tlRGlyZWN0aW9uLmRvd24gPSB0aGlzLnN0cm9rZURpcmVjdGlvblZlY3Rvci55IDwgMDtcbiAgfSxcblxuICBpbml0U2FiZXI6IGZ1bmN0aW9uIChldnQpIHtcbiAgICB0aGlzLmNvbnRyb2xsZXJUeXBlID0gZXZ0LmRldGFpbC5uYW1lO1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdjdXJzb3InLCB0aGlzLmNvbmZpZ1t0aGlzLmNvbnRyb2xsZXJUeXBlXS5jdXJzb3IgfHwge30pO1xuICB9LFxuXG4gIGNvbmZpZzoge1xuICAgICdvY3VsdXMtdG91Y2gtY29udHJvbHMnOiB7XG4gICAgICBjdXJzb3I6IHtcbiAgICAgICAgZG93bkV2ZW50czogW1xuICAgICAgICAgICd0cmlnZ2VyZG93bicsXG4gICAgICAgICAgJ2dyaXBkb3duJyxcbiAgICAgICAgICAnYWJ1dHRvbmRvd24nLFxuICAgICAgICAgICdiYnV0dG9uZG93bicsXG4gICAgICAgICAgJ3hidXR0b25kb3duJyxcbiAgICAgICAgICAneWJ1dHRvbmRvd24nXG4gICAgICAgIF0sXG4gICAgICAgIHVwRXZlbnRzOiBbXG4gICAgICAgICAgJ3RyaWdnZXJ1cCcsXG4gICAgICAgICAgJ2dyaXB1cCcsXG4gICAgICAgICAgJ2FidXR0b251cCcsXG4gICAgICAgICAgJ2JidXR0b251cCcsXG4gICAgICAgICAgJ3hidXR0b251cCcsXG4gICAgICAgICAgJ3lidXR0b251cCdcbiAgICAgICAgXVxuICAgICAgfVxuICAgIH0sXG5cbiAgICAndml2ZS1jb250cm9scyc6IHtcbiAgICAgIGN1cnNvcjoge1xuICAgICAgICBkb3duRXZlbnRzOiBbJ3RyYWNrcGFkZG93bicsICd0cmlnZ2VyZG93bicsICdncmlwZG93biddLFxuICAgICAgICB1cEV2ZW50czogWyd0cmFja3BhZHVwJywgJ3RyaWdnZXJ1cCcsICdncmlwdXAnXVxuICAgICAgfVxuICAgIH0sXG5cbiAgICAnd2luZG93cy1tb3Rpb24tY29udHJvbHMnOiB7XG4gICAgICBjdXJzb3I6IHtcbiAgICAgICAgZG93bkV2ZW50czogWyd0cmFja3BhZGRvd24nLCAndHJpZ2dlcmRvd24nLCAnZ3JpcGRvd24nXSxcbiAgICAgICAgdXBFdmVudHM6IFsndHJhY2twYWR1cCcsICd0cmlnZ2VydXAnLCAnZ3JpcHVwJ11cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc2FiZXItY29udHJvbHMuanMiLCJjb25zdCBISVRfTEVGVCA9ICdoaXRMZWZ0JztcbmNvbnN0IEhJVF9SSUdIVCA9ICdoaXRSaWdodCc7XG5jb25zdCBMRUZUID0gJ2xlZnQnO1xuY29uc3QgUklHSFQgPSAncmlnaHQnO1xuXG4vKipcbiAqIFNob3cgcGFydGljbGVzIHdoZW4gdG91Y2hlZCBieSBzYWJlci5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzYWJlci1wYXJ0aWNsZXMnLCB7XG4gIHNjaGVtYToge1xuICAgIGVuYWJsZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaGFuZDoge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmhpZGRlbkludGVyc2VjdGlvbiA9IHt4OiA5OTksIHk6IDAsIHo6IDB9O1xuICAgIHRoaXMuaW50ZXJzZWN0ZWRFbCA9IG51bGw7XG5cbiAgICB0aGlzLnBhcnRpY2xlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcGFya1BhcnRpY2xlcycpO1xuICAgIHRoaXMucGFydGljbGVFdmVudERldGFpbCA9IHtwb3NpdGlvbjogbmV3IFRIUkVFLlZlY3RvcjMoKSwgcm90YXRpb246IG5ldyBUSFJFRS5FdWxlcigpfTtcbiAgICB0aGlzLnBhcnRpY2xlRXZlbnQgPSB7ZGV0YWlsOiB0aGlzLnBhcnRpY2xlRXZlbnREZXRhaWx9O1xuICAgIHRoaXMucGFydGljbGVTeXN0ZW0gPSBudWxsO1xuXG4gICAgdGhpcy5zYWJlckVudGVyID0gdGhpcy5zYWJlckVudGVyLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zYWJlckxlYXZlID0gdGhpcy5zYWJlckxlYXZlLmJpbmQodGhpcyk7XG5cbiAgfSxcblxuICBwYXVzZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIHRoaXMuc2FiZXJFbnRlcik7XG4gICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgdGhpcy5zYWJlckxlYXZlKTtcbiAgfSxcblxuICBwbGF5OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgdGhpcy5zYWJlckVudGVyKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLnNhYmVyTGVhdmUpO1xuICAgIHRoaXMucGFydGljbGVzRHVyID0gdGhpcy5wYXJ0aWNsZXMuZ2V0QXR0cmlidXRlKCdwYXJ0aWNsZXBsYXllcicpLmR1cjtcbiAgfSxcblxuICBzYWJlckVudGVyOiBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICBpZiAoZXZ0LnRhcmdldCAhPT0gdGhpcy5lbCkgeyByZXR1cm47IH1cbiAgICBpZiAoIWV2dC5kZXRhaWwuaW50ZXJzZWN0ZWRFbC5oYXNBdHRyaWJ1dGUoJ2RhdGEtc2FiZXItcGFydGljbGVzJykpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5pbnRlcnNlY3RlZEVsID0gZXZ0LmRldGFpbC5pbnRlcnNlY3RlZEVsO1xuICB9LFxuXG4gIHNhYmVyTGVhdmU6IGZ1bmN0aW9uIChldnQpIHtcbiAgICBpZiAoZXZ0LmRldGFpbC50YXJnZXQgIT09IHRoaXMuZWwpIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBIaWRlIGhpdCBpbnRlcnNlY3Rpb24gdGV4dHVyZS5cbiAgICBpZiAodGhpcy5pbnRlcnNlY3RlZEVsLmNvbXBvbmVudHMud2FsbCB8fCB0aGlzLmludGVyc2VjdGVkRWwuaWQgPT09ICdmbG9vcicpIHtcbiAgICAgIGNvbnN0IHVuaWZvcm0gPSB0aGlzLmRhdGEuaGFuZCA9PT0gUklHSFQgPyBISVRfUklHSFQgOiBISVRfTEVGVDtcbiAgICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5pbnRlcnNlY3RlZEVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWw7XG4gICAgICBtYXRlcmlhbC51bmlmb3Jtc1t1bmlmb3JtXS52YWx1ZSA9IHRoaXMuaGlkZGVuSW50ZXJzZWN0aW9uO1xuICAgIH1cbiAgICB0aGlzLmludGVyc2VjdGVkRWwgPSBudWxsO1xuICAgIHRoaXMucGFydGljbGVTeXN0ZW0gPSBudWxsO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lLCBkZWx0YSkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQgfHwgIXRoaXMuaW50ZXJzZWN0ZWRFbCkgeyByZXR1cm47IH1cblxuICAgIGNvbnN0IHJheWNhc3RlciA9IHRoaXMuZWwuY29tcG9uZW50cy5yYXljYXN0ZXJfX2dhbWU7XG4gICAgY29uc3QgaW50ZXJzZWN0aW9uID0gcmF5Y2FzdGVyLmdldEludGVyc2VjdGlvbih0aGlzLmludGVyc2VjdGVkRWwpO1xuXG4gICAgaWYgKCFpbnRlcnNlY3Rpb24pIHsgcmV0dXJuOyB9XG5cbiAgICAvLyBVcGRhdGUgaW50ZXJzZWN0aW9uIG1hdGVyaWFsIGlmIG5lY2Vzc2FyeS5cbiAgICAvKlxuICAgIGlmICh0aGlzLmludGVyc2VjdGVkRWwuY29tcG9uZW50cy53YWxsIHx8IHRoaXMuaW50ZXJzZWN0ZWRFbC5pZCA9PT0gJ2Zsb29yJykge1xuICAgICAgY29uc3QgdW5pZm9ybSA9IHRoaXMuZGF0YS5oYW5kID09PSBSSUdIVCA/IEhJVF9SSUdIVCA6IEhJVF9MRUZUO1xuICAgICAgY29uc3QgbWF0ZXJpYWwgPSB0aGlzLmludGVyc2VjdGVkRWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbDtcbiAgICAgIG1hdGVyaWFsLnVuaWZvcm1zW3VuaWZvcm1dLnZhbHVlID0gaW50ZXJzZWN0aW9uLnBvaW50O1xuICAgIH1cbiAgICAqL1xuXG4gICAgaWYgKHRoaXMucGFydGljbGVTeXN0ZW0gJiYgdGhpcy5wYXJ0aWNsZVN5c3RlbS5hY3RpdmUpIHtcbiAgICAgIC8vIFVwZGF0ZSBwYXJ0aWNsZSBwb3NpdGlvbi5cbiAgICAgIHRoaXMucGFydGljbGVTeXN0ZW0ubWVzaC5wb3NpdGlvbi5jb3B5KGludGVyc2VjdGlvbi5wb2ludCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFN0YXJ0IHBhcnRpY2xlIHN5c3RlbS5cbiAgICAgIHRoaXMucGFydGljbGVFdmVudERldGFpbC5wb3NpdGlvbi5jb3B5KGludGVyc2VjdGlvbi5wb2ludCk7XG4gICAgICB0aGlzLnBhcnRpY2xlU3lzdGVtID0gdGhpcy5wYXJ0aWNsZXMuY29tcG9uZW50cy5wYXJ0aWNsZXBsYXllci5zdGFydEFmdGVyRGVsYXkoXG4gICAgICAgIHRoaXMucGFydGljbGVFdmVudCk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3NhYmVyLXBhcnRpY2xlcy5qcyIsIi8qKlxuICogU2NvcmUgYmVhdCwgYXV0by1yZXR1cm4gdG8gcG9vbCBpbiAxLjJzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3Njb3JlLWJlYXQnLCB7XG4gIHNjaGVtYToge1xuICAgIHR5cGU6IHsgdHlwZTogJ3N0cmluZycgfVxuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnBvb2xDb21wb25lbnQgPSBgcG9vbF9fYmVhdHNjb3JlJHt0aGlzLmRhdGEudHlwZX1gO1xuICAgIHRoaXMuc3RhcnRUaW1lID0gdGhpcy5lbC5zY2VuZUVsLnRpbWU7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUpIHtcbiAgICBpZiAodGltZSA+IHRoaXMuc3RhcnRUaW1lICsgMTIwMCkge1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmNvbXBvbmVudHNbdGhpcy5wb29sQ29tcG9uZW50XS5yZXR1cm5FbnRpdHkodGhpcy5lbCk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3Njb3JlLWJlYXQuanMiLCIvKipcbiAqIFNjb3JlIHRleHQgZmFkZSBpbiBhbmltYXRpb24uXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2NvcmUtdGV4dHMnLCB7XG4gIHNjaGVtYToge1xuICAgIGlzU29uZ0xvYWRpbmc6IHtkZWZhdWx0OiBmYWxzZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy50ZXh0RWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKCdbdGV4dF0nKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50ZXh0RWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLnRleHRFbHNbaV0uc2V0QXR0cmlidXRlKCdhbmltYXRpb25fX2ZhZGVpbicsIHtcbiAgICAgICAgYXV0b3BsYXk6IGZhbHNlLFxuICAgICAgICBwcm9wZXJ0eTonY29tcG9uZW50cy50ZXh0Lm1hdGVyaWFsLnVuaWZvcm1zLm9wYWNpdHkudmFsdWUnLFxuICAgICAgICBkZWxheTogMjUwLFxuICAgICAgICBkdXI6IDc1MCxcbiAgICAgICAgZWFzaW5nOiAnZWFzZUluT3V0Q3ViaWMnLFxuICAgICAgICBmcm9tOiAwLFxuICAgICAgICB0bzogMVxuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICAvLyBGaW5pc2hlZCBsb2FkaW5nLlxuICAgIGlmIChvbGREYXRhLmlzU29uZ0xvYWRpbmcgJiYgIXRoaXMuZGF0YS5pc1NvbmdMb2FkaW5nKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGV4dEVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLnRleHRFbHNbaV0uY29tcG9uZW50c1snYW5pbWF0aW9uX19mYWRlaW4nXS5iZWdpbkFuaW1hdGlvbigpO1xuICAgICAgfVxuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3RleHRnbG93bm9ybWFsJywgbnVsbCwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8vIFN0YXJ0ZWQgbG9hZGluZy5cbiAgICBpZiAoIW9sZERhdGEuaXNTb25nTG9hZGluZyAmJiB0aGlzLmRhdGEuaXNTb25nTG9hZGluZykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRleHRFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy50ZXh0RWxzW2ldLmNvbXBvbmVudHMudGV4dC5tYXRlcmlhbC51bmlmb3Jtcy5vcGFjaXR5LnZhbHVlID0gMDtcbiAgICAgIH1cbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCd0ZXh0Z2xvd29mZicsIG51bGwsIGZhbHNlKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc2NvcmUtdGV4dHMuanMiLCJpbXBvcnQgdXRpbHMgZnJvbSAnLi4vdXRpbHMnO1xuXG52YXIgQ0FOVkFTX0hFSUdIVCA9IDUxMjsgIC8vIFBvd2VyLW9mLXR3by5cbnZhciBIRUlHSFQgPSA2NDtcbnZhciBOVU1fUEVSX1BBR0UgPSA2O1xudmFyIFdJRFRIID0gNjQ7XG5cbi8vIEFwcGx5IGhlaWdodCBmYWN0b3Igc2luY2UgdGhlIGltYWdlcyBkb24ndCByZWFjaCB0aGUgcG93ZXItb2YtdHdvIGhlaWdodCwgbmVlZCB0byBzdHJldGNoLlxudmFyIEhFSUdIVF9GQUNUT1IgPSBDQU5WQVNfSEVJR0hUIC8gKEhFSUdIVCAqIE5VTV9QRVJfUEFHRSk7XG52YXIgSU1BR0VfSEVJR0hUX0NBTlZBUyA9IEhFSUdIVCAqIEhFSUdIVF9GQUNUT1I7XG5cbi8qKlxuICogQ3JlYXRlIHRodW1ibmFpbCBhdGxhcyBmb3IgYWxsIHRoZSB0aHVtYm5haWwgaW1hZ2VzIHRvZ2V0aGVyIHBlciBwYWdlLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NlYXJjaC10aHVtYm5haWwtYXRsYXMnLCB7XG4gIGRlcGVuZGVuY2llczogWydnZW9tZXRyeScsICdtYXRlcmlhbCddLFxuXG4gIHNjaGVtYToge1xuICAgIGR1bW15VXBkYXRlcjoge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBDcmVhdGUgY2FudmFzIGZvciB0ZXh0dXJlIGF0bGFzLlxuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgY2FudmFzLnNldEF0dHJpYnV0ZSgnaWQnLCAndGh1bWJuYWlsQXRsYXNNYXAnKTtcbiAgICBjYW52YXMuaGVpZ2h0ID0gQ0FOVkFTX0hFSUdIVDsgIC8vIFBvd2VyLW9mLXR3by5cbiAgICBjYW52YXMud2lkdGggPSBXSURUSDtcbiAgICB0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHRoaXMuY2xlYXJDYW52YXMoKTtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNhbnZhcyk7XG5cbiAgICAvLyBBbHBoYSBtYXAgZm9yIHdoZW4gc2VhcmNoIHJlc3VsdHMgZG9uJ3QgY29udGFpbiBtYXggbnVtYmVyIG9mIHJlc3VsdHMuXG4gICAgY29uc3QgYWxwaGFDYW52YXMgPSB0aGlzLmFscGhhQ2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgYWxwaGFDYW52YXMuc2V0QXR0cmlidXRlKCdpZCcsICd0aHVtYm5haWxBbHBoYU1hcCcpO1xuICAgIGFscGhhQ2FudmFzLmhlaWdodCA9IENBTlZBU19IRUlHSFQ7XG4gICAgYWxwaGFDYW52YXMud2lkdGggPSBXSURUSDtcbiAgICB0aGlzLmFscGhhQ3R4ID0gYWxwaGFDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFscGhhQ2FudmFzKTtcblxuICAgIHRoaXMuZWwuY29tcG9uZW50cy5tYXRlcmlhbC5tYXRlcmlhbC5hbHBoYU1hcCA9IG5ldyBUSFJFRS5DYW52YXNUZXh0dXJlKGFscGhhQ2FudmFzKTtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnc3JjJywgY2FudmFzKTtcbiAgICB0aGlzLmltYWdlcyA9IFtdO1xuXG4gICAgdGhpcy5sYXN0TnVtUmVzdWx0cyA9IE5VTV9QRVJfUEFHRTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZWwgPSB0aGlzLmVsO1xuXG4gICAgY29uc3QgcmVzdWx0cyA9IGVsLnNjZW5lRWwuc3lzdGVtcy5zdGF0ZS5zdGF0ZS5zZWFyY2hSZXN1bHRzUGFnZTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBpbWcgPSB0aGlzLmltYWdlc1tpXSA9IHRoaXMuaW1hZ2VzW2ldIHx8IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgICAgaW1nLmNyb3NzT3JpZ2luID0gJ2Fub255bW91cyc7XG4gICAgICBpbWcuc3JjID0gdXRpbHMuZ2V0UzNGaWxlVXJsKHJlc3VsdHNbaV0uaWQsICdpbWFnZS5qcGcnKTtcbiAgICAgIGlmIChpbWcuY29tcGxldGUpIHtcbiAgICAgICAgdGhpcy5kcmF3KGltZywgaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbWcub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZHJhdyhpbWcsIGkpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBhbHBoYSBtYXAuXG4gICAgaWYgKHJlc3VsdHMubGVuZ3RoICE9PSB0aGlzLmxhc3ROdW1SZXN1bHRzKSB7IHRoaXMudXBkYXRlQWxwaGFNYXAocmVzdWx0cy5sZW5ndGgpOyB9XG4gICAgdGhpcy5sYXN0TnVtUmVzdWx0cyA9IHJlc3VsdHMubGVuZ3RoO1xuICB9LFxuXG4gIC8qKlxuICAgKiBEcmF3IHRodW1ibmFpbCBvbiBjYW52YXMgYXQgcm93IGkuXG4gICAqL1xuICBkcmF3OiBmdW5jdGlvbiAoaW1nLCBpKSB7XG4gICAgdGhpcy5jdHguZHJhd0ltYWdlKFxuICAgICAgaW1nLFxuICAgICAgMCxcbiAgICAgIGkgKiBJTUFHRV9IRUlHSFRfQ0FOVkFTLFxuICAgICAgV0lEVEgsXG4gICAgICBJTUFHRV9IRUlHSFRfQ0FOVkFTKTtcbiAgICB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwubWFwLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgfSxcblxuICBjbGVhckNhbnZhczogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuY2FudmFzO1xuICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9ICcjMTExJztcbiAgICB0aGlzLmN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuICB9LFxuXG4gIHVwZGF0ZUFscGhhTWFwOiBmdW5jdGlvbiAobnVtUmVzdWx0cykge1xuICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuYWxwaGFDYW52YXM7XG4gICAgY29uc3QgY3R4ID0gdGhpcy5hbHBoYUN0eDtcbiAgICBjdHguZmlsbFN0eWxlID0gJyNGRkYnO1xuICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuICAgIGN0eC5maWxsU3R5bGUgPSAnIzAwMCc7XG4gICAgY3R4LmZpbGxSZWN0KFxuICAgICAgMCxcbiAgICAgIG51bVJlc3VsdHMgKiBJTUFHRV9IRUlHSFRfQ0FOVkFTLFxuICAgICAgY2FudmFzLndpZHRoLFxuICAgICAgY2FudmFzLmhlaWdodCAtIG51bVJlc3VsdHMgKiBJTUFHRV9IRUlHSFRfQ0FOVkFTKTtcbiAgICB0aGlzLmVsLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwuYWxwaGFNYXAubmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc2VhcmNoLXRodW1ibmFpbC1hdGxhcy5qcyIsInZhciBhbGdvbGlhc2VhcmNoID0gcmVxdWlyZSgnYWxnb2xpYXNlYXJjaC9saXRlJyk7XG52YXIgYmluZEV2ZW50ID0gcmVxdWlyZSgnYWZyYW1lLWV2ZW50LWRlY29yYXRvcnMnKS5iaW5kRXZlbnQ7XG5cbnZhciBjbGllbnQgPSBhbGdvbGlhc2VhcmNoKCdRVUxUT1kzWldVJywgJ2JlMDcxNjQxOTI0NzFkZjdlOTdlNmZhNzBjMWQwNDFkJyk7XG52YXIgYWxnb2xpYSA9IGNsaWVudC5pbml0SW5kZXgoJ3N1cGVyc2FiZXInKTtcblxuLyoqXG4gKiBTZWFyY2ggKGluY2x1ZGluZyB0aGUgaW5pdGlhbCBsaXN0IG9mIHBvcHVsYXIgc2VhcmNoZXMpLlxuICogQXR0YWNoZWQgdG8gc3VwZXIta2V5Ym9hcmQuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc2VhcmNoJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5ldmVudERldGFpbCA9IHtxdWVyeTogJycsIHJlc3VsdHM6IFtdfTtcbiAgICB0aGlzLnBvcHVsYXJIaXRzID0gbnVsbDtcbiAgICB0aGlzLnF1ZXJ5T2JqZWN0ID0ge2hpdHNQZXJQYWdlOiAxMDAsIHF1ZXJ5OiAnJ307XG5cbiAgICAvLyBQb3B1bGF0ZSBwb3B1bGFyLlxuICAgIHRoaXMuc2VhcmNoKCcnKTtcblxuICAgIC8vIExlc3MgaGl0cyBvbiBub3JtYWwgc2VhcmNoZXMuXG4gICAgdGhpcy5xdWVyeU9iamVjdC5oaXRzUGVyUGFnZSA9IDMwO1xuXG4gICAgdGhpcy5lbC5zY2VuZUVsLmFkZEV2ZW50TGlzdGVuZXIoJ3NlYXJjaGNsZWFyJywgKCkgPT4geyB0aGlzLnNlYXJjaCgnJyk7IH0pO1xuICB9LFxuXG4gIHN1cGVya2V5Ym9hcmRjaGFuZ2U6IGJpbmRFdmVudChmdW5jdGlvbiAoZXZ0KSB7XG4gICAgaWYgKGV2dC50YXJnZXQgIT09IHRoaXMuZWwpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5zZWFyY2goZXZ0LmRldGFpbC52YWx1ZSk7XG4gIH0pLFxuXG4gIHNlYXJjaDogZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgLy8gVXNlIGNhY2hlZCBmb3IgcG9wdWxhciBoaXRzLlxuICAgIGlmICghcXVlcnkgJiYgdGhpcy5wb3B1bGFySGl0cykge1xuICAgICAgdGhpcy5ldmVudERldGFpbC5yZXN1bHRzID0gdGhpcy5wb3B1bGFySGl0cztcbiAgICAgIHRoaXMuZXZlbnREZXRhaWwucXVlcnkgPSAnJztcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzZWFyY2hyZXN1bHRzJywgdGhpcy5ldmVudERldGFpbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5ldmVudERldGFpbC5xdWVyeSA9IHF1ZXJ5O1xuICAgIHRoaXMucXVlcnlPYmplY3QucXVlcnkgPSBxdWVyeTtcbiAgICBhbGdvbGlhLnNlYXJjaCh0aGlzLnF1ZXJ5T2JqZWN0LCAoZXJyLCBjb250ZW50KSA9PiB7XG4gICAgICAvLyBDYWNoZSBwb3B1bGFyIGhpdHMuXG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzZWFyY2hlcnJvcicsIG51bGwsIGZhbHNlKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICghcXVlcnkpIHsgdGhpcy5wb3B1bGFySGl0cyA9IGNvbnRlbnQuaGl0czsgfVxuICAgICAgdGhpcy5ldmVudERldGFpbC5yZXN1bHRzID0gY29udGVudC5oaXRzO1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3NlYXJjaHJlc3VsdHMnLCB0aGlzLmV2ZW50RGV0YWlsKTtcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8qKlxuICogU2VsZWN0IGdlbnJlIGZpbHRlci5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzZWFyY2gtZ2VucmUnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmV2ZW50RGV0YWlsID0ge2lzR2VucmVTZWFyY2g6IHRydWUsIGdlbnJlOiAnJywgcmVzdWx0czogW119O1xuICAgIHRoaXMucXVlcnlPYmplY3QgPSB7XG4gICAgICBmaWx0ZXJzOiAnJyxcbiAgICAgIGhpdHNQZXJQYWdlOiAxMDBcbiAgICB9O1xuXG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XG4gICAgICB0aGlzLnNlYXJjaChldnQudGFyZ2V0LmNsb3Nlc3QoJy5nZW5yZScpLmRhdGFzZXQuYmluZEZvcktleSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgc2VhcmNoOiBmdW5jdGlvbiAoZ2VucmUpIHtcbiAgICBpZiAoZ2VucmUgPT09ICdWaWRlbyBHYW1lcycpIHtcbiAgICAgIHRoaXMucXVlcnlPYmplY3QuZmlsdGVycyA9IGBnZW5yZTpcIlZpZGVvIEdhbWVcIiBPUiBnZW5yZTpcIlZpZGVvIEdhbWVzXCJgO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnF1ZXJ5T2JqZWN0LmZpbHRlcnMgPSBgZ2VucmU6XCIke2dlbnJlfVwiYDtcbiAgICB9XG4gICAgYWxnb2xpYS5zZWFyY2godGhpcy5xdWVyeU9iamVjdCwgKGVyciwgY29udGVudCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc2VhcmNoZXJyb3InLCBudWxsLCBmYWxzZSk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmV2ZW50RGV0YWlsLmdlbnJlID0gZ2VucmU7XG4gICAgICB0aGlzLmV2ZW50RGV0YWlsLnJlc3VsdHMgPSBjb250ZW50LmhpdHM7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc2VhcmNocmVzdWx0cycsIHRoaXMuZXZlbnREZXRhaWwpO1xuICAgIH0pO1xuICB9XG59KTtcblxuLyoqXG4gKiBDbGljayBsaXN0ZW5lciBmb3Igc2VhcmNoIHJlc3VsdC5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzZWFyY2gtcmVzdWx0LWxpc3QnLCB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBvYnYgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihtdXRhdGlvbnMgPT4ge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtdXRhdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKG11dGF0aW9uc1tpXS5hdHRyaWJ1dGVOYW1lID09PSAnZGF0YS1pbmRleCcpIHtcbiAgICAgICAgICB0aGlzLnJlZnJlc2hMYXlvdXQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIG9idi5vYnNlcnZlKHRoaXMuZWwsIHthdHRyaWJ1dGVzOiB0cnVlLCBjaGlsZExpc3Q6IGZhbHNlLCBzdWJ0cmVlOiB0cnVlfSk7XG4gIH0sXG5cbiAgcmVmcmVzaExheW91dDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuZW1pdCgnbGF5b3V0cmVmcmVzaCcsIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICBjbGljazogYmluZEV2ZW50KGZ1bmN0aW9uIChldnQpIHtcbiAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbWVudWNoYWxsZW5nZXNlbGVjdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgZXZ0LnRhcmdldC5jbG9zZXN0KCcuc2VhcmNoUmVzdWx0JykuZGF0YXNldC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSk7XG4gIH0pXG59KTtcblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzZWFyY2gtc29uZy1uYW1lLXNlbGVjdGVkJywge1xuICBzY2hlbWE6IHtcbiAgICBhbmNob3I6IHtkZWZhdWx0OiAwfSxcbiAgICBpbmRleDoge2RlZmF1bHQ6IDB9LFxuICAgIG9mZnNldDoge2RlZmF1bHQ6IDB9LFxuICAgIHNlbGVjdGVkQ2hhbGxlbmdlSWQ6IHtkZWZhdWx0OiAnJ31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhO1xuICAgIGNvbnN0IGVsID0gdGhpcy5lbDtcbiAgICBlbC5vYmplY3QzRC52aXNpYmxlID0gISFkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQgJiYgZGF0YS5pbmRleCAhPT0gLTE7XG4gICAgZWwub2JqZWN0M0QucG9zaXRpb24ueSA9IGRhdGEuaW5kZXggKiBkYXRhLm9mZnNldCArIGRhdGEuYW5jaG9yO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3NlYXJjaC5qcyIsInZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbmNvbnN0IFBSRVZJRVdfVk9MVU1FID0gMC41O1xuXG4vKipcbiAqIFNvbmcgcHJldmlldyB3aGVuIHNlYXJjaCByZXN1bHQgc2VsZWN0ZWQgd2l0aCBzbWFydCBsb2dpYyBmb3IgcHJlbG9hZGluZy5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzb25nLXByZXZpZXctc3lzdGVtJywge1xuICBzY2hlbWE6IHtcbiAgICBjaGFsbGVuZ2VJZDoge2RlZmF1bHQ6ICcnfSxcbiAgICBkZWJ1Zzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBpc1NlYXJjaGluZzoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBpc1NvbmdMb2FkaW5nOiB7ZGVmYXVsdDogZmFsc2V9LCAgLy8gQ29udGludWUgdG8gcGxheSBwcmV2aWV3IHNvbmcgZHVyaW5nIGxvYWRpbmcuXG4gICAgc2VsZWN0ZWRDaGFsbGVuZ2VJZDoge3R5cGU6ICdzdHJpbmcnfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmFuYWx5c2VyRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXVkaW9BbmFseXNlcicpO1xuICAgIHRoaXMuYXVkaW8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpOyAgLy8gRHVtbXkuXG4gICAgdGhpcy5hdWRpb1N0b3JlID0ge307XG4gICAgdGhpcy5wcmVsb2FkZWRBdWRpb0lkcyA9IFtdO1xuICAgIHRoaXMucHJlbG9hZFF1ZXVlID0gW107XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICAvLyBQbGF5IGNsaWNrZWQuXG4gICAgLy8gQnV0IGRvbid0IHN0YXJ0IHBsYXlpbmcgaXQgaWYgaXQgd2Fzbid0IHBsYXlpbmcgYWxyZWFkeS5cbiAgICBpZiAoIW9sZERhdGEuY2hhbGxlbmdlSWQgJiYgZGF0YS5jaGFsbGVuZ2VJZCkge1xuICAgICAgaWYgKHRoaXMuYW5hbHlzZXJFbC5jb21wb25lbnRzLmF1ZGlvYW5hbHlzZXIudm9sdW1lID09PSAwIHx8XG4gICAgICAgICAgdGhpcy5hdWRpby5jdXJyZW50VGltZSA8IDEpIHtcbiAgICAgICAgdGhpcy5zdG9wU29uZygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdGhpcy5mYWRlRG93bigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFVuc2VsZWN0LlxuICAgIGlmIChvbGREYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQgJiYgIWRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZCAmJiAhZGF0YS5pc1NlYXJjaGluZykge1xuICAgICAgdGhpcy5zdG9wU29uZygpO1xuICAgIH1cblxuICAgIC8vIFNvbmcgZmluaXNoZWQgbG9hZGluZy5cbiAgICAvLyBDb250aW51ZSB0byBwbGF5IHByZXZpZXcgc29uZyBkdXJpbmcgbG9hZGluZyB0byBrZWVwIGVudGVydGFpbmVkLlxuICAgIGlmIChvbGREYXRhLmlzU29uZ0xvYWRpbmcgJiYgIWRhdGEuaXNTb25nTG9hZGluZykge1xuICAgICAgdGhpcy5zdG9wU29uZygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFNlbGVjdGVkIGNoYWxsZW5nZSBJRCB1cGRhdGVkLlxuICAgIGlmIChkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQgJiYgb2xkRGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkICE9PSBkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQpIHtcbiAgICAgIGlmICh0aGlzLmF1ZGlvKSB7IHRoaXMuc3RvcFNvbmcoKTsgfVxuXG4gICAgICAvLyBJZiBub3QgeWV0IHByZWxvYWRlZCwgcGF1c2UgdGhlIHByZWxvYWQgcXVldWUgdW50aWwgdGhpcyBzb25nIGlzIGxvYWRlZC5cbiAgICAgIGlmICghdGhpcy5wcmVsb2FkZWRBdWRpb0lkcy5pbmNsdWRlcyhkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQpICYmXG4gICAgICAgICAgZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkICE9PSB0aGlzLmN1cnJlbnRMb2FkaW5nSWQpIHtcbiAgICAgICAgdGhpcy5wcmlvcml0aXplUHJlbG9hZFNvbmcoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5wbGF5U29uZyhkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQpO1xuICAgIH1cbiAgfSxcblxuICBsb2c6IGZ1bmN0aW9uIChzdHIpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5kZWJ1ZykgeyByZXR1cm47IH1cbiAgICBjb25zb2xlLmxvZyhzdHIpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBTb25nIHdhcyBzZWxlY3RlZCBzbyBwYXVzZSBwcmVsb2FkIHF1ZXVlLCBwcmlvcml0aXplIGl0cyBsb2FkaW5nLCBhbmQgdHJ5IHRvIHBsYXkgQVNBUC5cbiAgICovXG4gIHByaW9yaXRpemVQcmVsb2FkU29uZzogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgY29uc3QgcHJlbG9hZFF1ZXVlID0gdGhpcy5wcmVsb2FkUXVldWU7XG5cbiAgICB0aGlzLmxvZyhgW3NvbmctcHJldmlld10gUHJpb3JpdGl6aW5nIGxvYWRpbmcgb2YgJHtkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWR9YCk7XG4gICAgdGhpcy5wcmlvcml0eUxvYWRpbmdDaGFsbGVuZ2VJZCA9IGRhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZDtcblxuICAgIHRoaXMuYXVkaW9TdG9yZVtkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWRdLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZGRhdGEnLCAoKSA9PiB7XG4gICAgICB0aGlzLmxvZyhgW3NvbmctcHJldmlld10gRmluaXNoZWQgbG9hZCBvZiBwcmlvcml0eSAke2RhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZH1gKTtcbiAgICAgIHRoaXMucHJlbG9hZGVkQXVkaW9JZHMucHVzaChkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQpO1xuICAgICAgdGhpcy5wcmlvcml0eUxvYWRpbmdDaGFsbGVuZ2VJZCA9ICcnO1xuICAgICAgLy8gUmVzdW1lIHByZWxvYWRpbmcgcXVldWUuXG4gICAgICBpZiAocHJlbG9hZFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmxvZyhgW3NvbmctcHJldmlld10gUmVzdW1pbmcgcXVldWUgd2l0aCAke3ByZWxvYWRRdWV1ZVswXS5jaGFsbGVuZ2VJZH1gKTtcbiAgICAgICAgdGhpcy5wcmVsb2FkTWV0YWRhdGEocHJlbG9hZFF1ZXVlWzBdKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFByZWxvYWQuXG4gICAgdGhpcy5hdWRpb1N0b3JlW2RhdGEuc2VsZWN0ZWRDaGFsbGVuZ2VJZF0uc3JjID1cbiAgICAgIHV0aWxzLmdldFMzRmlsZVVybChkYXRhLnNlbGVjdGVkQ2hhbGxlbmdlSWQsICdzb25nLm9nZycpO1xuXG4gICAgLy8gUmVtb3ZlIGZyb20gcHJlbG9hZCBxdWV1ZS5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZWxvYWRRdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHByZWxvYWRRdWV1ZVtpXS5jaGFsbGVuZ2VJZCA9PT0gZGF0YS5zZWxlY3RlZENoYWxsZW5nZUlkKSB7XG4gICAgICAgIHByZWxvYWRRdWV1ZS5zcGxpY2UoaSwgMSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQ3JlYXRlIGFuIGF1ZGlvIGVsZW1lbnQgYW5kIHF1ZXVlIHRvIHByZWxvYWQuIElmIHRoZSBxdWV1ZSBpcyBlbXB0eSwgcHJlbG9hZCBpdFxuICAgKiBpbW1lZGlhdGVseS5cbiAgICovXG4gIHF1ZXVlUHJlbG9hZFNvbmc6IGZ1bmN0aW9uIChjaGFsbGVuZ2VJZCwgcHJldmlld1N0YXJ0VGltZSkge1xuICAgIGlmICh0aGlzLmF1ZGlvU3RvcmVbY2hhbGxlbmdlSWRdKSB7IHJldHVybjsgfVxuXG4gICAgY29uc3QgYXVkaW8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpO1xuICAgIGF1ZGlvLmNyb3NzT3JpZ2luID0gJ2Fub255bW91cyc7XG4gICAgYXVkaW8uZGF0YXNldC5wcmV2aWV3U3RhcnRUaW1lID0gcHJldmlld1N0YXJ0VGltZTtcbiAgICB0aGlzLmF1ZGlvU3RvcmVbY2hhbGxlbmdlSWRdID0gYXVkaW87XG5cbiAgICBsZXQgc3JjID0gdXRpbHMuZ2V0UzNGaWxlVXJsKGNoYWxsZW5nZUlkLCAnc29uZy5vZ2cnKTtcbiAgICBpZiAodGhpcy5jdXJyZW50TG9hZGluZ0lkKSB7XG4gICAgICAvLyBBdWRpbyBjdXJyZW50bHkgbG9hZGluZywgYWRkIHRvIHF1ZXVlLlxuICAgICAgdGhpcy5wcmVsb2FkUXVldWUucHVzaCh7XG4gICAgICAgIGF1ZGlvOiBhdWRpbyxcbiAgICAgICAgY2hhbGxlbmdlSWQ6IGNoYWxsZW5nZUlkLFxuICAgICAgICBzcmM6IHNyY1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEVtcHR5IHF1ZXVlLCBwcmVsb2FkIG5vdy5cbiAgICAgIHRoaXMucHJlbG9hZE1ldGFkYXRhKHtcbiAgICAgICAgYXVkaW86IGF1ZGlvLFxuICAgICAgICBjaGFsbGVuZ2VJZDogY2hhbGxlbmdlSWQsXG4gICAgICAgIHNyYzogc3JjXG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFByZWxvYWQgbWV0YWRhdGEgb2YgYXVkaW8gZmlsZSBmb3IgcXVpY2sgcGxheS5cbiAgICogU2V0IGBzcmNgIGFuZCBgcHJlbG9hZGAuXG4gICAqIEEgcHJlbG9hZCBxdWV1ZSBpcyBzZXQgdXAgc28gd2Ugb25seSBwcmVsb2FkIG9uZSBhdCBhIHRpbWUgdG8gbm90IGJvZyBkb3duXG4gICAqIHRoZSBuZXR3b3JrLiBJZiBhIHNvbmcgaXMgc2VsZWN0ZWQgdG8gcHJldmlldywgd2UgY2FuIGJ1bXAgaXQgdG8gdGhlIGZyb250IG9mIHRoZVxuICAgKiBxdWV1ZS5cbiAgICovXG4gIHByZWxvYWRNZXRhZGF0YTogZnVuY3Rpb24gKHByZWxvYWRJdGVtKSB7XG4gICAgY29uc3QgYXVkaW8gPSBwcmVsb2FkSXRlbS5hdWRpbztcbiAgICB0aGlzLmxvZyhgW3NvbmctcHJldmlld10gUHJlbG9hZGluZyBzb25nIHByZXZpZXcgJHtwcmVsb2FkSXRlbS5jaGFsbGVuZ2VJZH1gKTtcblxuICAgIGF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZG1ldGFkYXRhJywgKCkgPT4ge1xuICAgICAgLy8gU29uZyBwcmVsb2FkZWQuXG4gICAgICB0aGlzLmxvZyhgW3NvbmctcHJldmlld10gRmluaXNoZWQgcHJlbG9hZGluZyBzb25nIHByZXZpZXcgJHtwcmVsb2FkSXRlbS5jaGFsbGVuZ2VJZH1gKTtcbiAgICAgIHRoaXMucHJlbG9hZGVkQXVkaW9JZHMucHVzaChwcmVsb2FkSXRlbS5jaGFsbGVuZ2VJZCk7XG4gICAgICB0aGlzLmN1cnJlbnRMb2FkaW5nSWQgPSAnJztcblxuICAgICAgLy8gTW92ZSBvbiB0byBuZXh0IHNvbmcgaW4gcXVldWUgaWYgYW55LlxuICAgICAgdGhpcy5sb2coYFtzb25nLXByZXZpZXddICR7dGhpcy5wcmVsb2FkUXVldWUubGVuZ3RofSBpbiBxdWV1ZWApO1xuICAgICAgaWYgKHRoaXMucHJlbG9hZFF1ZXVlLmxlbmd0aCAmJiAhdGhpcy5wcmlvcml0eUxvYWRpbmdDaGFsbGVuZ2VJZCkge1xuICAgICAgICB0aGlzLnByZWxvYWRNZXRhZGF0YSh0aGlzLnByZWxvYWRRdWV1ZS5zaGlmdCgpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGF1ZGlvLnByZWxvYWQgPSAnbWV0YWRhdGEnO1xuICAgIGF1ZGlvLnNyYyA9IHByZWxvYWRJdGVtLnNyYztcbiAgICB0aGlzLmN1cnJlbnRMb2FkaW5nSWQgPSBwcmVsb2FkSXRlbS5jaGFsbGVuZ2VJZDtcbiAgfSxcblxuICBzdG9wU29uZzogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5hdWRpbykgeyByZXR1cm47IH1cbiAgICBpZiAoIXRoaXMuYXVkaW8ucGF1c2VkKSB7IHRoaXMuYXVkaW8ucGF1c2UoKTsgfVxuICB9LFxuXG4gIHBsYXlTb25nOiBmdW5jdGlvbiAoY2hhbGxlbmdlSWQpIHtcbiAgICBpZiAoIWNoYWxsZW5nZUlkKSB7IHJldHVybjsgfVxuXG4gICAgdGhpcy5hdWRpbyA9IHRoaXMuYXVkaW9TdG9yZVtjaGFsbGVuZ2VJZF07XG4gICAgdGhpcy5hdWRpby5sb2FkKCk7XG4gICAgdGhpcy5hdWRpby52b2x1bWUgPSBQUkVWSUVXX1ZPTFVNRTtcbiAgICB0aGlzLmF1ZGlvLmN1cnJlbnRUaW1lID0gdGhpcy5hdWRpby5kYXRhc2V0LnByZXZpZXdTdGFydFRpbWU7XG4gICAgdGhpcy5hbmFseXNlckVsLnNldEF0dHJpYnV0ZSgnYXVkaW9hbmFseXNlcicsICdzcmMnLCB0aGlzLmF1ZGlvKTtcblxuICAgIGNvbnN0IGF1ZGlvYW5hbHlzZXIgPSB0aGlzLmFuYWx5c2VyRWwuY29tcG9uZW50cy5hdWRpb2FuYWx5c2VyO1xuICAgIGF1ZGlvYW5hbHlzZXIucmVzdW1lQ29udGV4dCgpO1xuXG4gICAgdGhpcy5hdWRpby5wbGF5KCk7XG4gICAgLy8gdGhpcy5mYWRlSW4oKTtcblxuICAgIC8vIFByZWZldGNoIGJ1ZmZlciBmb3IgcGxheWluZy5cbiAgICBpZiAoYXVkaW9hbmFseXNlci54aHIpIHsgYXVkaW9hbmFseXNlci54aHIuYWJvcnQoKTsgfVxuICAgIGF1ZGlvYW5hbHlzZXIuZmV0Y2hBdWRpb0J1ZmZlcih1dGlscy5nZXRTM0ZpbGVVcmwoY2hhbGxlbmdlSWQsICdzb25nLm9nZycpKTtcbiAgfSxcblxuICAvKipcbiAgICogU3RvcCBzb25nIGZyb20gcHJlbG9hZGluZy5cbiAgICovXG4gIGNsZWFyU29uZzogZnVuY3Rpb24gKGNoYWxsZW5nZUlkKSB7XG4gICAgbGV0IGF1ZGlvID0gdGhpcy5hdWRpb1N0b3JlW2NoYWxsZW5nZUlkXTtcbiAgICBhdWRpby5wcmVsb2FkID0gJ25vbmUnO1xuXG4gICAgLy8gUmVtb3ZlIGZyb20gcXVldWUgaWYgaW4gdGhlcmUuXG4gICAgbGV0IGluZGV4O1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wcmVsb2FkUXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLnByZWxvYWRRdWV1ZVtpXS5pZCA9PT0gY2hhbGxlbmdlSWQpIHtcbiAgICAgICAgaW5kZXggPSBpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFpbmRleCkgeyByZXR1cm47IH1cbiAgICB0aGlzLnByZWxvYWRRdWV1ZS5zcGxpY2UoaW5kZXgsIDEpO1xuICB9XG59KTtcblxuLyoqXG4gKiBEYXRhIGNvbXBvbmVudCBhdHRhY2hlZCB0byBzZWFyY2ggcmVzdWx0IGZvciBzb25nIHByZXZpZXcgc3lzdGVtLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3NvbmctcHJldmlldycsIHtcbiAgc2NoZW1hOiB7XG4gICAgY2hhbGxlbmdlSWQ6IHt0eXBlOiAnc3RyaW5nJ30sXG4gICAgcHJldmlld1N0YXJ0VGltZToge3R5cGU6ICdudW1iZXInfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICBpZiAob2xkRGF0YS5jaGFsbGVuZ2VJZCAmJiB0aGlzLmRhdGEuY2hhbGxlbmdlSWQgIT09IG9sZERhdGEuY2hhbGxlbmdlSWQpIHtcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzWydzb25nLXByZXZpZXctc3lzdGVtJ10uY2xlYXJTb25nKG9sZERhdGEuY2hhbGxlbmdlSWQpO1xuICAgIH1cblxuICAgIHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzWydzb25nLXByZXZpZXctc3lzdGVtJ10ucXVldWVQcmVsb2FkU29uZyhcbiAgICAgIHRoaXMuZGF0YS5jaGFsbGVuZ2VJZCwgdGhpcy5kYXRhLnByZXZpZXdTdGFydFRpbWVcbiAgICApO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3NvbmctcHJldmlldy5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc29uZy1wcm9ncmVzcy1yaW5nJywge1xuICBkZXBlbmRlbmNpZXM6IFsnZ2VvbWV0cnknLCAnbWF0ZXJpYWwnXSxcblxuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudGljayA9IEFGUkFNRS51dGlscy50aHJvdHRsZVRpY2sodGhpcy50aWNrLmJpbmQodGhpcyksIDEwMDApO1xuXG4gICAgdGhpcy5wcm9ncmVzcyA9IHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC51bmlmb3Jtcy5wcm9ncmVzcztcbiAgICB0aGlzLmVsLnNjZW5lRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xlYXJnYW1lJywgKCkgPT4ge1xuICAgICAgdGhpcy5wcm9ncmVzcy52YWx1ZSA9IDA7XG4gICAgfSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHRoaXMucHJvZ3Jlc3MudmFsdWUgPSAwO1xuICB9LFxuXG4gIHVwZGF0ZVJpbmc6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBzb3VyY2UgPSB0aGlzLmVsLnNjZW5lRWwuY29tcG9uZW50cy5zb25nLnNvdXJjZTtcbiAgICBpZiAoIXNvdXJjZSkgeyByZXR1cm47IH1cblxuICAgIGNvbnN0IHByb2dyZXNzID1cbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzLnNvbmcuZ2V0Q3VycmVudFRpbWUoKSAvXG4gICAgICBzb3VyY2UuYnVmZmVyLmR1cmF0aW9uO1xuICAgIHRoaXMucHJvZ3Jlc3MudmFsdWUgPSBwcm9ncmVzcztcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkgeyByZXR1cm47IH1cbiAgICB0aGlzLnVwZGF0ZVJpbmcoKTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zb25nLXByb2dyZXNzLXJpbmcuanMiLCJjb25zdCB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbmNvbnN0IEdBTUVfT1ZFUl9MRU5HVEggPSAzLjU7XG5jb25zdCBPTkNFID0ge29uY2U6IHRydWV9O1xuY29uc3QgQkFTRV9WT0xVTUUgPSAwLjc1O1xuXG5sZXQgc2tpcERlYnVnID0gQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignc2tpcCcpO1xuaWYgKCEhc2tpcERlYnVnKSB7IHNraXBEZWJ1ZyA9IHBhcnNlSW50KHNraXBEZWJ1ZykgLyAxMDAwOyB9XG5cbi8qKlxuICogQWN0aXZlIGNoYWxsZW5nZSBzb25nIC8gYXVkaW8uXG4gKlxuICogT3JkZXIgb2Ygc29uZyBpbml0IGluIGNvbmp1Y3Rpb24gd2l0aCBiZWF0LWxvYWRlcjpcbiAqXG4gKiAxLiBwcmV2aWV3U3RhcnRUaW1lIGlzIHBsYXlpbmdcbiAqIDIuIHNvbmdsb2FkZmluaXNoXG4gKiAzLiBiZWF0LWxvYWRlciBwcmVsb2FkaW5nXG4gKiA0LiBwcmVsb2FkZWQgYmVhdHMgZ2VuZXJhdGVkXG4gKiA1LiBiZWF0LWxvYWRlciBwcmVsb2FkaW5nIGZpbmlzaFxuICogNi4gc3RhcnRBdWRpbyAvIHNvbmdTdGFydFRpbWUgaXMgc2V0XG4gKiA3LiBiZWF0LWxvYWRlciBjb250aW51ZXMgb2ZmIHNvbmcgY3VycmVudCB0aW1lXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc29uZycsIHtcbiAgc2NoZW1hOiB7XG4gICAgYW5hbHlzZXJFbDoge3R5cGU6ICdzZWxlY3RvcicsIGRlZmF1bHQ6ICcjYXVkaW9BbmFseXNlcid9LFxuICAgIGNoYWxsZW5nZUlkOiB7ZGVmYXVsdDogJyd9LFxuICAgIGlzQmVhdHNQcmVsb2FkZWQ6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaXNHYW1lT3Zlcjoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBpc1BsYXlpbmc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgaXNWaWN0b3J5OiB7ZGVmYXVsdDogZmFsc2V9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYW5hbHlzZXJTZXR0ZXIgPSB7YnVmZmVyOiB0cnVlfTtcbiAgICB0aGlzLmF1ZGlvQW5hbHlzZXIgPSB0aGlzLmRhdGEuYW5hbHlzZXJFbC5jb21wb25lbnRzLmF1ZGlvYW5hbHlzZXI7XG4gICAgdGhpcy5jb250ZXh0ID0gdGhpcy5hdWRpb0FuYWx5c2VyLmNvbnRleHQ7XG4gICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnNvbmdMb2FkaW5nSW5kaWNhdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvbmdMb2FkaW5nSW5kaWNhdG9yJyk7XG4gICAgdGhpcy5zb25nU3RhcnRUaW1lID0gMDtcblxuICAgIHRoaXMudmljdG9yeSA9IHRoaXMudmljdG9yeS5iaW5kKHRoaXMpO1xuXG4gICAgLy8gQmFzZSB2b2x1bWUuXG4gICAgdGhpcy5hdWRpb0FuYWx5c2VyLmdhaW5Ob2RlLmdhaW4udmFsdWUgPSBCQVNFX1ZPTFVNRTtcblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignZ2FtZW1lbnVyZXN0YXJ0JywgdGhpcy5vblJlc3RhcnQuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCd3YWxsaGl0c3RhcnQnLCB0aGlzLm9uV2FsbEhpdFN0YXJ0LmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignd2FsbGhpdGVuZCcsIHRoaXMub25XYWxsSGl0RW5kLmJpbmQodGhpcykpO1xuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigndmljdG9yeWZha2UnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuc291cmNlLnN0b3AoKTtcbiAgICAgICAgdGhpcy5zb3VyY2UuZGlzY29ubmVjdCgpO1xuICAgICAgICB0aGlzLnZpY3RvcnkoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG5cbiAgICAvLyBHYW1lIG92ZXIsIHNsb3cgZG93biBhdWRpbywgYW5kIHRoZW4gc3RvcC5cbiAgICBpZiAoIW9sZERhdGEuaXNHYW1lT3ZlciAmJiBkYXRhLmlzR2FtZU92ZXIpIHtcbiAgICAgIHRoaXMub25HYW1lT3ZlcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChvbGREYXRhLmlzR2FtZU92ZXIgJiYgIWRhdGEuaXNHYW1lT3Zlcikge1xuICAgICAgdGhpcy5hdWRpb0FuYWx5c2VyLmdhaW5Ob2RlLnZhbHVlID0gQkFTRV9WT0xVTUU7XG4gICAgfVxuXG4gICAgLy8gT24gdmljdG9yeSBzY3JlZW4sIHBsYXkgc29uZyBpbiBiYWNrZ3JvdW5kLlxuICAgIGlmICghb2xkRGF0YS5pc1ZpY3RvcnkgJiYgZGF0YS5pc1ZpY3RvcnkpIHtcbiAgICAgIHRoaXMuZGF0YS5hbmFseXNlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2F1ZGlvYW5hbHlzZXJidWZmZXJzb3VyY2UnLCBldnQgPT4ge1xuICAgICAgICB0aGlzLmF1ZGlvQW5hbHlzZXIucmVzdW1lQ29udGV4dCgpO1xuICAgICAgICBjb25zdCBnYWluID0gdGhpcy5hdWRpb0FuYWx5c2VyLmdhaW5Ob2RlLmdhaW47XG4gICAgICAgIGdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKDApO1xuICAgICAgICBnYWluLnNldFZhbHVlQXRUaW1lKDAuMDUsIDApO1xuICAgICAgICB0aGlzLnNvdXJjZSA9IGV2dC5kZXRhaWw7XG4gICAgICAgIHRoaXMuc291cmNlLnN0YXJ0KCk7XG4gICAgICB9LCBPTkNFKTtcbiAgICAgIHRoaXMuYXVkaW9BbmFseXNlci5yZWZyZXNoU291cmNlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gTmV3IGNoYWxsZW5nZSwgcGxheSBpZiB3ZSBoYXZlIGxvYWRlZCBhbmQgd2VyZSB3YWl0aW5nIGZvciBiZWF0cyB0byBwcmVsb2FkLlxuICAgIGlmICghb2xkRGF0YS5pc0JlYXRzUHJlbG9hZGVkICYmIHRoaXMuZGF0YS5pc0JlYXRzUHJlbG9hZGVkICYmIHRoaXMuc291cmNlKSB7XG4gICAgICB0aGlzLnN0YXJ0QXVkaW8oKTtcbiAgICB9XG5cbiAgICBpZiAob2xkRGF0YS5jaGFsbGVuZ2VJZCAmJiAhZGF0YS5jaGFsbGVuZ2VJZCkge1xuICAgICAgdGhpcy5zdG9wQXVkaW8oKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBOZXcgY2hhbGxlbmdlLCBsb2FkIGF1ZGlvIGFuZCBwbGF5IHdoZW4gcmVhZHkuXG4gICAgaWYgKG9sZERhdGEuY2hhbGxlbmdlSWQgIT09IGRhdGEuY2hhbGxlbmdlSWQgJiYgZGF0YS5jaGFsbGVuZ2VJZCkge1xuICAgICAgdGhpcy5lbC5zY2VuZUVsLmVtaXQoJ3Nvbmdsb2Fkc3RhcnQnLCBudWxsLCBmYWxzZSk7XG4gICAgICB0aGlzLmdldEF1ZGlvKCkudGhlbihzb3VyY2UgPT4ge1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc29uZ2xvYWRmaW5pc2gnLCBudWxsLCBmYWxzZSk7XG4gICAgICB9KS5jYXRjaChjb25zb2xlLmVycm9yKTtcbiAgICB9XG5cbiAgICAvLyBQYXVzZSAvIHN0b3AuXG4gICAgaWYgKG9sZERhdGEuaXNQbGF5aW5nICYmICFkYXRhLmlzUGxheWluZykge1xuICAgICAgdGhpcy5hdWRpb0FuYWx5c2VyLnN1c3BlbmRDb250ZXh0KCk7XG4gICAgfVxuXG4gICAgLy8gUmVzdW1lLlxuICAgIGlmICghb2xkRGF0YS5pc1BsYXlpbmcgJiYgZGF0YS5pc1BsYXlpbmcgJiYgdGhpcy5zb3VyY2UpIHtcbiAgICAgIHRoaXMuYXVkaW9BbmFseXNlci5yZXN1bWVDb250ZXh0KCk7XG4gICAgfVxuICB9LFxuXG4gIGdldEF1ZGlvOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2U7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgZGF0YS5hbmFseXNlckVsLmFkZEV2ZW50TGlzdGVuZXIoJ2F1ZGlvYW5hbHlzZXJidWZmZXJzb3VyY2UnLCBldnQgPT4ge1xuICAgICAgICAvLyBGaW5pc2hlZCBkZWNvZGluZy5cbiAgICAgICAgdGhpcy5zb3VyY2UgPSBldnQuZGV0YWlsO1xuICAgICAgICByZXNvbHZlKHRoaXMuc291cmNlKTtcbiAgICAgIH0sIE9OQ0UpO1xuICAgICAgdGhpcy5hbmFseXNlclNldHRlci5zcmMgPSB1dGlscy5nZXRTM0ZpbGVVcmwoZGF0YS5jaGFsbGVuZ2VJZCwgJ3Nvbmcub2dnJyk7XG4gICAgICBkYXRhLmFuYWx5c2VyRWwuc2V0QXR0cmlidXRlKCdhdWRpb2FuYWx5c2VyJywgdGhpcy5hbmFseXNlclNldHRlcik7XG5cbiAgICAgIC8vIEFscmVhZHkgbG9hZGVkLlxuICAgICAgaWYgKHRoaXMuYXVkaW9BbmFseXNlci54aHIucmVzcG9uc2UpIHtcbiAgICAgICAgdGhpcy5zb25nTG9hZGluZ0luZGljYXRvci5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3Byb2dyZXNzJywgMSk7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzb25nZmV0Y2hmaW5pc2gnLCBudWxsLCBmYWxzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5hdWRpb0FuYWx5c2VyLnhoci5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGV2dCA9PiB7XG4gICAgICAgIHRoaXMub25GZXRjaFByb2dyZXNzKGV2dCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICBzdG9wQXVkaW86IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuc291cmNlKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tzb25nXSBUcmllZCB0byBzdG9wQXVkaW8sIGJ1dCBub3QgcGxheWluZy4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5zb3VyY2Uuc3RvcCgpO1xuICAgIHRoaXMuc291cmNlLmRpc2Nvbm5lY3QoKTtcbiAgICB0aGlzLnNvdXJjZSA9IG51bGw7XG4gICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcbiAgfSxcblxuICB2aWN0b3J5OiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmRhdGEuaXNQbGF5aW5nKSB7IHJldHVybjsgfVxuICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCd2aWN0b3J5JywgbnVsbCwgZmFsc2UpO1xuICB9LFxuXG4gIG9uRmV0Y2hQcm9ncmVzczogZnVuY3Rpb24gKGV2dCkge1xuICAgIGNvbnN0IHByb2dyZXNzID0gZXZ0LmxvYWRlZCAvIGV2dC50b3RhbDtcbiAgICB0aGlzLnNvbmdMb2FkaW5nSW5kaWNhdG9yLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAncHJvZ3Jlc3MnLCBwcm9ncmVzcyk7XG4gICAgaWYgKHByb2dyZXNzID49IDEpIHtcbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdzb25nZmV0Y2hmaW5pc2gnLCBudWxsLCBmYWxzZSk7XG4gICAgfVxuICB9LFxuXG4gIG9uR2FtZU92ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuXG4gICAgLy8gUGxheWJhY2sgcmF0ZS5cbiAgICBjb25zdCBwbGF5YmFja1JhdGUgPSB0aGlzLnNvdXJjZS5wbGF5YmFja1JhdGU7XG4gICAgcGxheWJhY2tSYXRlLnNldFZhbHVlQXRUaW1lKHBsYXliYWNrUmF0ZS52YWx1ZSwgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lKTtcbiAgICBwbGF5YmFja1JhdGUubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoMCwgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lICsgR0FNRV9PVkVSX0xFTkdUSCk7XG5cbiAgICAvLyBHYWluLlxuICAgIGNvbnN0IGdhaW4gPSB0aGlzLmF1ZGlvQW5hbHlzZXIuZ2Fpbk5vZGUuZ2FpbjtcbiAgICBnYWluLnNldFZhbHVlQXRUaW1lKGdhaW4udmFsdWUsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSk7XG4gICAgZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSgwLCB0aGlzLmNvbnRleHQuY3VycmVudFRpbWUgKyBHQU1FX09WRVJfTEVOR1RIKTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmRhdGEuaXNHYW1lT3ZlcikgeyByZXR1cm47IH1cbiAgICAgIHRoaXMuc3RvcEF1ZGlvKCk7XG4gICAgfSwgMzUwMCk7XG4gIH0sXG5cbiAgb25SZXN0YXJ0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcblxuICAgIC8vIFJlc3RhcnQsIGdldCBuZXcgYnVmZmVyIHNvdXJjZSBub2RlIGFuZCBwbGF5LlxuICAgIGlmICh0aGlzLnNvdXJjZSkgeyB0aGlzLnNvdXJjZS5kaXNjb25uZWN0KCk7IH1cblxuICAgIC8vIENsZWFyIGdhaW4gaW50ZXJwb2xhdGlvbiB2YWx1ZXMgZnJvbSBnYW1lIG92ZXIuXG4gICAgY29uc3QgZ2FpbiA9IHRoaXMuYXVkaW9BbmFseXNlci5nYWluTm9kZS5nYWluO1xuICAgIGdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKDApO1xuXG4gICAgdGhpcy5kYXRhLmFuYWx5c2VyRWwuYWRkRXZlbnRMaXN0ZW5lcignYXVkaW9hbmFseXNlcmJ1ZmZlcnNvdXJjZScsIGV2dCA9PiB7XG4gICAgICB0aGlzLnNvdXJjZSA9IGV2dC5kZXRhaWw7XG4gICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnc29uZ2xvYWRmaW5pc2gnLCBudWxsLCBmYWxzZSk7XG4gICAgfSwgT05DRSk7XG4gICAgdGhpcy5hdWRpb0FuYWx5c2VyLnJlZnJlc2hTb3VyY2UoKTtcbiAgfSxcblxuICBvbldhbGxIaXRTdGFydDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGdhaW4gPSB0aGlzLmF1ZGlvQW5hbHlzZXIuZ2Fpbk5vZGUuZ2FpbjtcbiAgICBnYWluLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKDAuMiwgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lICsgMC4xKTtcbiAgfSxcblxuICBvbldhbGxIaXRFbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBnYWluID0gdGhpcy5hdWRpb0FuYWx5c2VyLmdhaW5Ob2RlLmdhaW47XG4gICAgZ2Fpbi5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZShCQVNFX1ZPTFVNRSwgdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lICsgMC4xKTtcbiAgfSxcblxuICBzdGFydEF1ZGlvOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZ2FpbiA9IHRoaXMuYXVkaW9BbmFseXNlci5nYWluTm9kZS5nYWluO1xuICAgIGdhaW4uc2V0VmFsdWVBdFRpbWUoQkFTRV9WT0xVTUUsIHRoaXMuY29udGV4dC5jdXJyZW50VGltZSk7XG4gICAgdGhpcy5zb25nU3RhcnRUaW1lID0gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lO1xuICAgIHRoaXMuc291cmNlLm9uZW5kZWQgPSB0aGlzLnZpY3Rvcnk7XG4gICAgdGhpcy5zb3VyY2Uuc3RhcnQoMCwgc2tpcERlYnVnKTtcbiAgICB0aGlzLmlzUGxheWluZyA9IHRydWU7XG4gIH0sXG5cbiAgZ2V0Q3VycmVudFRpbWU6IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lIC0gdGhpcy5zb25nU3RhcnRUaW1lO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3NvbmcuanMiLCJmdW5jdGlvbiAkIChpZCkgeyByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOyB9O1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3N0YWdlLWNvbG9ycycsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2JhY2tncm91bmQnXSxcblxuICBzY2hlbWE6IHtcbiAgICBjb2xvcjoge2RlZmF1bHQ6ICdibHVlJywgb25lT2Y6IFsnYmx1ZScsICdyZWQnXX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jb2xvckNvZGVzID0gWydvZmYnLCAnYmx1ZScsICdibHVlJywgJ2JsdWVmYWRlJywgJycsICdyZWQnLCAncmVkJywgJ3JlZGZhZGUnXTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsZWFyZ2FtZScsIHRoaXMucmVzZXRDb2xvcnMuYmluZCh0aGlzKSk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHRoaXMudXBkYXRlQ29sb3JzKHRoaXMuZGF0YS5jb2xvcik7XG4gIH0sXG5cbiAgc2V0Q29sb3I6IGZ1bmN0aW9uICh0YXJnZXQsIGNvZGUpIHtcbiAgICB0aGlzLmVsLmVtaXQoYCR7dGFyZ2V0fWNvbG9yJHt0aGlzLmNvbG9yQ29kZXNbY29kZV19YCwgbnVsbCwgZmFsc2UpO1xuICB9LFxuXG4gIHJlc2V0Q29sb3JzOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy51cGRhdGVDb2xvcnMoJ2JsdWUnKTtcbiAgICB0aGlzLmVsLmVtaXQoJ2JnY29sb3JibHVlJywgbnVsbCwgZmFsc2UpO1xuICAgIHRoaXMuZWwuZW1pdCgndHVubmVsY29sb3JyZWQnLCBudWxsLCBmYWxzZSk7XG4gICAgdGhpcy5lbC5lbWl0KCdmbG9vcmNvbG9ycmVkJywgbnVsbCwgZmFsc2UpO1xuICAgIHRoaXMuZWwuZW1pdCgnbGVmdGxhc2VyY29sb3JibHVlJywgbnVsbCwgZmFsc2UpO1xuICAgIHRoaXMuZWwuZW1pdCgncmlnaHRsYXNlcmNvbG9yYmx1ZScsIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICB1cGRhdGVDb2xvcnM6IGZ1bmN0aW9uIChjb2xvcikge1xuICB9XG5cbi8qXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLm5lb25SZWQgPSBuZXcgVEhSRUUuQ29sb3IoMHhmZjk5OTkpO1xuICAgIHRoaXMubmVvbkJsdWUgPSBuZXcgVEhSRUUuQ29sb3IoMHg5OTk5ZmYpO1xuICAgIHRoaXMuZGVmYXVsdFJlZCA9IG5ldyBUSFJFRS5Db2xvcigweGZmMDAwMCk7XG4gICAgdGhpcy5kZWZhdWx0Qmx1ZSA9IG5ldyBUSFJFRS5Db2xvcigweDAwMDBmZik7XG4gICAgdGhpcy5taW5lRW52TWFwID0ge1xuICAgICAgcmVkOiBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoJ2Fzc2V0cy9pbWcvbWluZWVudmlyby1yZWQuanBnJywgKCkgPT4ge1xuICAgICAgICB0aGlzLmVsLnNjZW5lRWwuZW1pdCgnbWluZXJlZGVudm1hcGxvYWRlZCcsIG51bGwsIGZhbHNlKTtcbiAgICAgIH0pLFxuICAgICAgYmx1ZTogbmV3IFRIUkVFLlRleHR1cmVMb2FkZXIoKS5sb2FkKCdhc3NldHMvaW1nL21pbmVlbnZpcm8tYmx1ZS5qcGcnLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuZWwuc2NlbmVFbC5lbWl0KCdtaW5lYmx1ZWVudm1hcGxvYWRlZCcsIG51bGwsIGZhbHNlKTtcbiAgICAgIH0pXG4gICAgfTtcbiAgICB0aGlzLm1pbmVDb2xvciA9IHtyZWQ6IG5ldyBUSFJFRS5Db2xvcigweDA3MDMwNCksIGJsdWU6IG5ldyBUSFJFRS5Db2xvcigweDAzMDQwNyl9O1xuICAgIHRoaXMubWluZUVtaXNzaW9uID0ge3JlZDogbmV3IFRIUkVFLkNvbG9yKDB4MDkwNzA3KSwgYmx1ZTogbmV3IFRIUkVFLkNvbG9yKDB4MDcwNzA5KX07XG4gICAgdGhpcy5taW5lTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoe1xuICAgICAgcm91Z2huZXNzOiAwLjM4LFxuICAgICAgbWV0YWxuZXNzOiAwLjQ4LFxuICAgICAgY29sb3I6IHRoaXMubWluZUNvbG9yW3RoaXMuZGF0YS5jb2xvcl0sXG4gICAgICBlbWlzc2l2ZTogdGhpcy5taW5lRW1pc3Npb25bdGhpcy5kYXRhLmNvbG9yXSxcbiAgICAgIGVudk1hcDogdGhpcy5taW5lRW52TWFwW3RoaXMuZGF0YS5jb2xvcl1cbiAgICB9KTtcbiAgICB0aGlzLnNreSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdza3knKTtcbiAgICB0aGlzLmF1eENvbG9yID0gbmV3IFRIUkVFLkNvbG9yKCk7XG5cbiAgICB0aGlzLnRhcmdldHMgPSB7fTtcbiAgICBbJ3N0YWdlTm9ybWFsJyxcbiAgICAgJ3R1bm5lbE5lb24nLFxuICAgICAnbGVmdFN0YWdlTGFzZXIwJyxcbiAgICAgJ2xlZnRTdGFnZUxhc2VyMScsXG4gICAgICdsZWZ0U3RhZ2VMYXNlcjInLFxuICAgICAncmlnaHRTdGFnZUxhc2VyMCcsXG4gICAgICdyaWdodFN0YWdlTGFzZXIxJyxcbiAgICAgJ3JpZ2h0U3RhZ2VMYXNlcjInLFxuICAgICAnZmxvb3InLFxuICAgICAnc3RhZ2VOZW9uJ10uZm9yRWFjaChpZCA9PiB7XG4gICAgICAgIHRoaXMudGFyZ2V0c1tpZF0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgIH0pO1xuXG4gICAgdGhpcy5jb2xvckNvZGVzID0gWydvZmYnLCAnYmx1ZScsICdibHVlJywgJ2JsdWVmYWRlJywgJycsICdyZWQnLCAncmVkJywgJ3JlZGZhZGUnXTtcblxuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xlYXJnYW1lJywgdGhpcy5yZXNldENvbG9ycy5iaW5kKHRoaXMpKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uIChvbGREYXRhKSB7XG4gICAgdGhpcy51cGRhdGVDb2xvcnModGhpcy5kYXRhLmNvbG9yKTtcbiAgfSxcblxuICBzZXRDb2xvcjogZnVuY3Rpb24gKHRhcmdldCwgY29kZSkge1xuICAgIGNvbnN0IG1lc2ggPSB0aGlzLnRhcmdldHNbdGFyZ2V0XS5nZXRPYmplY3QzRCgnbWVzaCcpO1xuICAgIGlmIChtZXNoKSB7IG1lc2gubWF0ZXJpYWwub3BhY2l0eSA9IDE7IH1cbiAgICB0aGlzLnRhcmdldHNbdGFyZ2V0XS5lbWl0KCdjb2xvcicgKyB0aGlzLmNvbG9yQ29kZXNbY29kZV0sIG51bGwsIGZhbHNlKTtcbiAgfSxcblxuICByZXNldENvbG9yczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMudXBkYXRlQ29sb3JzKCdibHVlJyk7XG4gICAgZm9yIChsZXQgdGFyZ2V0IGluIHRoaXMudGFyZ2V0cykge1xuICAgICAgdGhpcy50YXJnZXRzW3RhcmdldF0uZW1pdCgnY29sb3JibHVlJywgbnVsbCwgZmFsc2UpO1xuICAgIH1cbiAgfSxcblxuICB1cGRhdGVDb2xvcnM6IGZ1bmN0aW9uIChjb2xvcikge1xuICAgIGNvbnN0IHJlZCA9IGNvbG9yID09PSAncmVkJztcblxuICAgIHRoaXMuc2t5LmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwuY29sb3Iuc2V0KHJlZCA/ICcjZjEwJyA6ICcjMDBhY2ZjJyk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLm9iamVjdDNELmJhY2tncm91bmQuc2V0KHJlZCA/ICcjNzcwMTAwJyA6ICcjMTUyNTJkJyk7XG4gICAgdGhpcy5lbC5zY2VuZUVsLm9iamVjdDNELmZvZy5jb2xvci5zZXQocmVkID8gJyNhMDAnIDogJyMwMDdjYjknKTtcblxuICAgIHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLm1hdGVyaWFscy5uZW9uLmNvbG9yID0gcmVkID8gdGhpcy5uZW9uUmVkIDogdGhpcy5uZW9uQmx1ZTtcbiAgICB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5tYXRlcmlhbHMuZGVmYXVsdC5jb2xvciA9IHJlZCA/IHRoaXMuZGVmYXVsdFJlZCA6IHRoaXMuZGVmYXVsdEJsdWU7XG5cbiAgICB0aGlzLm1pbmVNYXRlcmlhbC5jb2xvciA9IHRoaXMubWluZUNvbG9yW3JlZCA/ICdyZWQnIDogJ2JsdWUnXTtcbiAgICB0aGlzLm1pbmVNYXRlcmlhbC5lbWlzc2l2ZSA9IHRoaXMubWluZUVtaXNzaW9uW3JlZCA/ICdyZWQnIDogJ2JsdWUnXTtcbiAgICB0aGlzLm1pbmVNYXRlcmlhbC5lbnZNYXAgPSB0aGlzLm1pbmVFbnZNYXBbcmVkID8gJ3JlZCcgOiAnYmx1ZSddO1xuICAgIHRoaXMubWluZU1hdGVyaWFsLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgfVxuXG4gICovXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3N0YWdlLWNvbG9ycy5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc3RhZ2UtbGFzZXJzJywge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogdHJ1ZX1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zcGVlZCA9IDA7XG4gICAgdGhpcy5sYXNlcnMgPSBbXG4gICAgICB0aGlzLmVsLmNoaWxkcmVuWzBdLm9iamVjdDNELFxuICAgICAgdGhpcy5lbC5jaGlsZHJlblsxXS5vYmplY3QzRCxcbiAgICAgIHRoaXMuZWwuY2hpbGRyZW5bMl0ub2JqZWN0M0RcbiAgICBdO1xuICB9LFxuXG4gIHB1bHNlOiBmdW5jdGlvbiAoc3BlZWQpIHtcbiAgICB0aGlzLnNwZWVkID0gc3BlZWQgLyA4O1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lLCBkZWx0YSkge1xuICAgIGlmICh0aGlzLnNwZWVkID09PSAwKSB7IHJldHVybjsgfVxuICAgIGRlbHRhIC89IDEwMDA7XG4gICAgaWYgKCF0aGlzLmRhdGEuZW5hYmxlZCkge1xuICAgICAgdGhpcy5zcGVlZCAqPSAwLjk3O1xuICAgICAgaWYgKE1hdGguYWJzKHRoaXMuc3BlZWQpIDwgMC4wMSkge1xuICAgICAgICB0aGlzLnNwZWVkID0gMDtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmxhc2Vyc1swXS5yb3RhdGlvbi56ICs9IHRoaXMuc3BlZWQgKiBkZWx0YTtcbiAgICB0aGlzLmxhc2Vyc1sxXS5yb3RhdGlvbi56IC09IHRoaXMuc3BlZWQgKiBkZWx0YSAqIDEuMDE7XG4gICAgdGhpcy5sYXNlcnNbMl0ucm90YXRpb24ueiArPSB0aGlzLnNwZWVkICogZGVsdGEgKiAxLjAyO1xuICB9XG59KVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3RhZ2UtbGFzZXJzLmpzIiwiQUZSQU1FLnJlZ2lzdGVyU2hhZGVyKCdzdGFnZVNoYWRlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgY29sb3I6IHt0eXBlOiAndmVjMycsIGlzOiAndW5pZm9ybScsIGRlZmF1bHQ6IHt4OiAwLCB5OiAwLCB6OiAwfX0sXG4gICAgZm9nQ29sb3I6IHt0eXBlOiAndmVjMycsIGlzOiAndW5pZm9ybScsIGRlZmF1bHQ6IHt4OiAwLCB5OiAwLjQ4LCB6OiAwLjcyfX0sXG4gICAgc3JjOiB7dHlwZTogJ21hcCcsIGlzOiAndW5pZm9ybSd9LFxuXG4gIH0sXG5cbiAgdmVydGV4U2hhZGVyOiBgXG4gICAgdmFyeWluZyB2ZWMyIHV2cztcbiAgICB2YXJ5aW5nIHZlYzMgd29ybGRQb3M7XG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdXZzLnh5ID0gdXYueHk7XG4gICAgICB2ZWM0IHAgPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1xuICAgICAgd29ybGRQb3MgPSAobW9kZWxNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICkpLnh5ejtcbiAgICAgIGdsX1Bvc2l0aW9uID0gcDtcbiAgICB9XG4gIGAsXG5cbiAgZnJhZ21lbnRTaGFkZXI6IGBcbiAgICAjZGVmaW5lIEZPR19SQURJVVMgIDUwLjBcbiAgICAjZGVmaW5lIEZPR19GQUxMT0ZGIDQ1LjBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB1bmlmb3JtIHZlYzMgY29sb3I7XG4gICAgdW5pZm9ybSB2ZWMzIGZvZ0NvbG9yO1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIHNyYztcblxuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHZlYzQgY29sID0gdGV4dHVyZTJEKHNyYywgdXZzKTtcbiAgICAgIGNvbC54eXogPSBtaXgoZm9nQ29sb3IsIGNvbC54eXosIGNsYW1wKGRpc3RhbmNlKHdvcmxkUG9zLCB2ZWMzKDAuLCAwLiwgLUZPR19SQURJVVMpKSAvIEZPR19GQUxMT0ZGLCAwLiwgMS4pKTtcbiAgICAgIGdsX0ZyYWdDb2xvciA9IGNvbDtcbiAgICB9XG4gIGBcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3RhZ2Utc2hhZGVyLmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCdzdGF0cy1wYXJhbScsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIGlmIChBRlJBTUUudXRpbHMuZ2V0VXJsUGFyYW1ldGVyKCdzdGF0cycpID09PSAndHJ1ZScpIHtcbiAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdzdGF0cycsICcnKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3RhdHMtcGFyYW0uanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3N0ZXBiYWNrJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0ZXBiYWNrJyk7XG4gICAgdGhpcy5jYW1lcmEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FtZXJhJyk7XG4gICAgdGhpcy5sYXN0VGltZSA9IDA7XG4gICAgdGhpcy5saW1pdCA9ICAtICh0aGlzLmVsLmdldEF0dHJpYnV0ZSgnZ2VvbWV0cnknKS5oZWlnaHQgLyAyIC0gMC42KTtcbiAgICB0aGlzLnRocm90dGxpbmcgPSAzMDA7XG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIGRlbHRhKSB7XG4gICAgaWYgKHRpbWUgLSB0aGlzLmxhc3RUaW1lIDwgdGhpcy50aHJvdHRsaW5nKSB7IHJldHVybjsgfVxuXG4gICAgdmFyIGNhbVBvcyA9IHRoaXMuY2FtZXJhLm9iamVjdDNELnBvc2l0aW9uO1xuICAgIHZhciBtc2dQb3MgPSB0aGlzLm1lc3NhZ2Uub2JqZWN0M0QucG9zaXRpb247XG5cbiAgICBpZiAoY2FtUG9zLnogPCB0aGlzLmxpbWl0KSB7XG4gICAgICB0aGlzLnRocm90dGxpbmcgPSAyMDtcbiAgICAgIHRoaXMubWVzc2FnZS5vYmplY3QzRC52aXNpYmxlID0gdHJ1ZTtcbiAgICAgIHRoaXMubWVzc2FnZS5nZXRPYmplY3QzRCgnbWVzaCcpLm1hdGVyaWFsLm9wYWNpdHkgPSAxIC0gTWF0aC5hYnMoY2FtUG9zLnogLSBtc2dQb3Mueik7XG4gICAgICBtc2dQb3MueCA9IGNhbVBvcy54O1xuICAgICAgbXNnUG9zLnkgPSBjYW1Qb3MueTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLm1lc3NhZ2Uub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgdGhpcy50aHJvdHRsaW5nID0gMzAwO1xuICAgIH1cblxuICAgIHRoaXMubGFzdFRpbWUgPSB0aW1lO1xuICB9XG5cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3RlcGJhY2suanMiLCIvKipcbiAqIFB1bGwgYSBzdWJtZXNoIG91dCBvZiBhIG1vZGVsIGZpbGUuXG4gKi9cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc3ViLW9iamVjdCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgZnJvbToge3R5cGU6ICdzZWxlY3Rvcid9LFxuICAgIG5hbWU6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YTtcblxuICAgIGRhdGEuZnJvbS5hZGRFdmVudExpc3RlbmVyKCdtb2RlbC1sb2FkZWQnLCBldnQgPT4ge1xuICAgICAgY29uc3QgbW9kZWwgPSBldnQuZGV0YWlsLm1vZGVsO1xuICAgICAgY29uc3Qgc3Vic2V0ID0gbW9kZWwuZ2V0T2JqZWN0QnlOYW1lKGRhdGEubmFtZSk7XG4gICAgICBlbC5zZXRPYmplY3QzRCgnbWVzaCcsIHN1YnNldC5jbG9uZSgpKTtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnc2hhZGVyJywgJ2ZsYXQnKTtcbiAgICAgIGVsLmVtaXQoJ3N1Ym9iamVjdGxvYWRlZCcsIG51bGwsIGZhbHNlKTtcbiAgICB9KTtcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdWItb2JqZWN0LmpzIiwiLyogZ2xvYmFsIEFGUkFNRSAqL1xudmFyIEtFWUJPQVJEUyA9IHtcbiAgc3VwZXJzYWJlcjoge3dyYXBDb3VudDogMjAsIGlucHV0T2Zmc2V0WTogMC4wMDgsIGlucHV0T2Zmc2V0WDogMC4wOCwgaW1nOiAna2V5Ym9hcmQucG5nJywgaG92ZXJJbWc6ICdrZXlib2FyZC1ob3Zlci5wbmcnLCBsYXlvdXQ6IFt7XCJrZXlcIjpcIjFcIiwgXCJ4XCI6MC4wMTQsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjJcIiwgXCJ4XCI6MC4xMDgsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjNcIiwgXCJ4XCI6MC4yMDMsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjRcIiwgXCJ4XCI6MC4yOTksIFwieVwiOjAuMDI0LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjVcIiwgXCJ4XCI6MC4zOTQsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjZcIiwgXCJ4XCI6MC40ODcsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjdcIiwgXCJ4XCI6MC41ODMsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjhcIiwgXCJ4XCI6MC42NzcsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjlcIiwgXCJ4XCI6MC43NzIsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIjBcIiwgXCJ4XCI6MC44NjYsIFwieVwiOjAuMDI0LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcInFcIiwgXCJ4XCI6MC4wMTQsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIndcIiwgXCJ4XCI6MC4xMDgsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImVcIiwgXCJ4XCI6MC4yMDMsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcInJcIiwgXCJ4XCI6MC4yOTksIFwieVwiOjAuMjE1LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcInRcIiwgXCJ4XCI6MC4zOTQsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcInlcIiwgXCJ4XCI6MC40ODcsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImlcIiwgXCJ4XCI6MC42NzcsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcInVcIiwgXCJ4XCI6MC41ODMsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcIm9cIiwgXCJ4XCI6MC43NzIsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcInBcIiwgXCJ4XCI6MC44NjYsIFwieVwiOjAuMjE1LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImFcIiwgXCJ4XCI6MC4wNjMsIFwieVwiOjAuNDA1LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcInNcIiwgXCJ4XCI6MC4xNTgsIFwieVwiOjAuNDA1LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImRcIiwgXCJ4XCI6MC4yNTMsIFwieVwiOjAuNDA1LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImZcIiwgXCJ4XCI6MC4zNDksIFwieVwiOjAuNDA1LCBcIndcIjowLjA5NCwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImdcIiwgXCJ4XCI6MC40NDMsIFwieVwiOjAuNDA1LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImhcIiwgXCJ4XCI6MC41MzcsIFwieVwiOjAuNDA1LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImpcIiwgXCJ4XCI6MC42MzMsIFwieVwiOjAuNDA1LCBcIndcIjowLjA5MiwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImtcIiwgXCJ4XCI6MC43MjYsIFwieVwiOjAuNDA1LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcImxcIiwgXCJ4XCI6MC44MjEsIFwieVwiOjAuNDA1LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODN9LCB7XCJrZXlcIjpcInpcIiwgXCJ4XCI6MC4xMTEsIFwieVwiOjAuNTk4LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcInhcIiwgXCJ4XCI6MC4yMDUsIFwieVwiOjAuNTk4LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcImNcIiwgXCJ4XCI6MC4zMDEsIFwieVwiOjAuNTk4LCBcIndcIjowLjA5NSwgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcInZcIiwgXCJ4XCI6MC4zOTYsIFwieVwiOjAuNTk4LCBcIndcIjowLjA5MywgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcImJcIiwgXCJ4XCI6MC40OSwgXCJ5XCI6MC41OTgsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwiblwiLCBcInhcIjowLjU4NSwgXCJ5XCI6MC41OTgsIFwid1wiOjAuMDk0LCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwibVwiLCBcInhcIjowLjY4LCBcInlcIjowLjU5OCwgXCJ3XCI6MC4wOTMsIFwiaFwiOjAuMTgxfSwge1wia2V5XCI6XCJEZWxldGVcIiwgXCJ4XCI6MC43NzcsIFwieVwiOjAuNTk4LCBcIndcIjowLjEzNywgXCJoXCI6MC4xODF9LCB7XCJrZXlcIjpcIiBcIiwgXCJ4XCI6MC4yOTcsIFwieVwiOjAuNzg4LCBcIndcIjowLjM4MSwgXCJoXCI6MC4yMDF9LCB7XCJrZXlcIjpcIkVzY2FwZVwiLCBcInhcIjowLjAxMywgXCJ5XCI6MC43OTcsIFwid1wiOjAuMTM3LCBcImhcIjowLjE4MX0sIHtcImtleVwiOlwiSW5zZXJ0XCIsIFwieFwiOjAuMDE0LCBcInlcIjotMC4wMDEsIFwid1wiOjAuMDEsIFwiaFwiOjAuMDA1fV19XG59O1xuXG5pZiAodHlwZW9mIEFGUkFNRSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb21wb25lbnQgYXR0ZW1wdGVkIHRvIHJlZ2lzdGVyIGJlZm9yZSBBRlJBTUUgd2FzIGF2YWlsYWJsZS4nKTtcbn1cblxudmFyIEZvbnRGYWN0b3JzID0ge1xuICByb2JvdG86IDE3LFxuICBhaWxlcm9uc2VtaWJvbGQ6IDIwLFxuICBkZWphdnU6IDIwLjUsXG4gIGV4bzJib2xkOiAyMCxcbiAgZXhvMnNlbWlib2xkOiAyMC4zLFxuICBrZWxzb25zYW5zOiAyMi44LFxuICBtb25vaWQ6IDE5LjUsXG4gIG1vemlsbGF2cjogOS41LFxuICBzb3VyY2Vjb2RlcHJvOiAyMC4zXG59O1xuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3N1cGVyLWtleWJvYXJkJywge1xuICBzY2hlbWE6IHtcbiAgICBhbGlnbjoge2RlZmF1bHQ6ICdsZWZ0Jywgb25lT2Y6IFsnbGVmdCcsICdjZW50ZXInLCAncmlnaHQnXX0sXG4gICAgYmxpbmtpbmdTcGVlZDoge3R5cGU6ICdpbnQnLCBkZWZhdWx0OiA0MDB9LFxuICAgIGZpbHRlcnM6IHt0eXBlOiAnYXJyYXknfSxcbiAgICAvLyByb2JvdG8gYWlsZXJvbnNlbWlib2xkIGRlamF2dSBleG8yYm9sZCBleG8yc2VtaWJvbGQga2Vsc29uc2FucyBtb25vaWQgc291cmNlY29kZXByb1xuICAgIGZvbnQ6IHtkZWZhdWx0OiAnYWlsZXJvbnNlbWlib2xkJ30sXG4gICAgaGFuZDoge3R5cGU6ICdzZWxlY3Rvcid9LFxuICAgIGltYWdlUGF0aDoge2RlZmF1bHQ6ICcuJ30sXG4gICAgaW5qZWN0VG9SYXljYXN0ZXJPYmplY3RzOiB7ZGVmYXVsdDogdHJ1ZX0sXG4gICAgaW5wdXRDb2xvcjoge3R5cGU6ICdjb2xvcicsIGRlZmF1bHQ6ICcjNjY5OWZmJ30sXG4gICAgaW50ZXJ2YWw6IHt0eXBlOiAnaW50JywgZGVmYXVsdDogNTB9LFxuICAgIGtleUJnQ29sb3I6IHt0eXBlOiAnY29sb3InLCBkZWZhdWx0OiAnIzAwMCd9LFxuICAgIGtleUNvbG9yOiB7dHlwZTogJ2NvbG9yJywgZGVmYXVsdDogJyM2Njk5ZmYnfSxcbiAgICBrZXlIb3ZlckNvbG9yOiB7dHlwZTogJ2NvbG9yJywgZGVmYXVsdDogJyMxQTQwN0YnfSxcbiAgICBrZXlQcmVzc0NvbG9yOiB7dHlwZTogJ2NvbG9yJywgZGVmYXVsdDogJyM1MjkwRjYnfSxcbiAgICBsYWJlbDoge3R5cGU6ICdzdHJpbmcnLCBkZWZhdWx0OiAnJ30sXG4gICAgbGFiZWxDb2xvcjoge3R5cGU6ICdjb2xvcicsIGRlZmF1bHQ6ICcjYWFhJ30sXG4gICAgbWF4TGVuZ3RoOiB7dHlwZTogJ2ludCcsIGRlZmF1bHQ6IDB9LFxuICAgIG1vZGVsOiB7ZGVmYXVsdDogJ2Jhc2ljJ30sXG4gICAgc2hvdzoge2RlZmF1bHQ6IHRydWV9LFxuICAgIHZhbHVlOiB7dHlwZTogJ3N0cmluZycsIGRlZmF1bHQ6ICcnfSxcbiAgICB3aWR0aDoge2RlZmF1bHQ6IDAuOH1cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2suYmluZCh0aGlzKSk7XG4gICAgdGhpcy5jaGFuZ2VFdmVudERldGFpbCA9IHt9O1xuICAgIHRoaXMudGV4dElucHV0T2JqZWN0ID0ge307XG5cbiAgICB0aGlzLmtleXMgPSBudWxsO1xuICAgIHRoaXMuZm9jdXNlZCA9IGZhbHNlO1xuICAgIHRoaXMua2V5SG92ZXIgPSBudWxsO1xuICAgIHRoaXMucHJldkNoZWNrVGltZSA9IG51bGw7XG4gICAgdGhpcy5zaGlmdCA9IGZhbHNlO1xuXG4gICAgdGhpcy5yYXdWYWx1ZSA9IHRoaXMuZGF0YS52YWx1ZTtcbiAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IHRoaXMuZGF0YS52YWx1ZTtcblxuICAgIHRoaXMudXNlckZpbHRlckZ1bmMgPSBudWxsO1xuICAgIHRoaXMuaW50ZXJ2YWxJZCA9IDA7XG5cbiAgICAvLyBDcmVhdGUga2V5Ym9hcmQgaW1hZ2UuXG4gICAgdGhpcy5rYkltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAgdGhpcy5rYkltZy5jbGFzc0xpc3QuYWRkKCdrZXlib2FyZFJheWNhc3RhYmxlJyk7XG4gICAgdGhpcy5rYkltZy5jbGFzc0xpc3QuYWRkKCdzdXBlcktleWJvYXJkSW1hZ2UnKTtcbiAgICB0aGlzLmtiSW1nLmFkZEV2ZW50TGlzdGVuZXIoJ3JheWNhc3Rlci1pbnRlcnNlY3RlZCcsIHRoaXMuaG92ZXIuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5rYkltZy5hZGRFdmVudExpc3RlbmVyKCdyYXljYXN0ZXItaW50ZXJzZWN0ZWQtY2xlYXJlZCcsIHRoaXMuYmx1ci5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMua2JJbWcpO1xuXG4gICAgLy8gQ3JlYXRlIGxhYmVsLlxuICAgIHRoaXMubGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWVudGl0eScpO1xuICAgIHRoaXMubGFiZWwuc2V0QXR0cmlidXRlKCd0ZXh0Jywge1xuICAgICAgYWxpZ246ICdjZW50ZXInLFxuICAgICAgZm9udDogdGhpcy5kYXRhLmZvbnQsXG4gICAgICBiYXNlbGluZTogJ2JvdHRvbScsXG4gICAgICBsaW5lSGVpZ2h0OiA0MCxcbiAgICAgIHNoYWRlcjogJ21zZGYnLFxuICAgICAgbmVnYXRlOiB0cnVlLFxuICAgICAgdmFsdWU6IHRoaXMuZGF0YS5sYWJlbCxcbiAgICAgIGNvbG9yOiB0aGlzLmRhdGEubGFiZWxDb2xvcixcbiAgICAgIHdpZHRoOiB0aGlzLmRhdGEud2lkdGgsXG4gICAgICB3cmFwQ291bnQ6IDMwfSk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmxhYmVsKTtcblxuICAgIC8vIENyZWF0ZSBpbnB1dC5cbiAgICB0aGlzLnRleHRJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZW50aXR5Jyk7XG4gICAgdGhpcy50ZXh0SW5wdXQuc2V0QXR0cmlidXRlKCdtaXhpbicsICdzdXBlcktleWJvYXJkVGV4dElucHV0Jyk7XG4gICAgdGhpcy50ZXh0SW5wdXQuc2V0QXR0cmlidXRlKCd0ZXh0Jywge1xuICAgICAgYWxpZ246IHRoaXMuZGF0YS5hbGlnbixcbiAgICAgIGZvbnQ6IHRoaXMuZGF0YS5mb250LFxuICAgICAgbGluZUhlaWdodDogMzUsXG4gICAgICB2YWx1ZTogdGhpcy5kYXRhLnZhbHVlLFxuICAgICAgY29sb3I6IHRoaXMuZGF0YS5pbnB1dENvbG9yLFxuICAgICAgd2lkdGg6IHRoaXMuZGF0YS53aWR0aCxcbiAgICAgIHdyYXBDb3VudDogMjBcbiAgICB9KTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMudGV4dElucHV0KTtcblxuICAgIHRoaXMuY3Vyc29yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICB0aGlzLmN1cnNvci5vYmplY3QzRC5wb3NpdGlvbi5zZXQoMCwgMCwgMC4wMDEpO1xuICAgIHRoaXMuY3Vyc29yLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7c2hhZGVyOiAnZmxhdCcsIGNvbG9yOiB0aGlzLmRhdGEuaW5wdXRDb2xvcn0pO1xuICAgIHRoaXMudGV4dElucHV0LmFwcGVuZENoaWxkKHRoaXMuY3Vyc29yKTtcbiAgICB0aGlzLmN1cnNvclVwZGF0ZWQgPSBmYWxzZTtcblxuICAgIHRoaXMua2V5QmdDb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpO1xuICAgIHRoaXMua2V5SG92ZXJDb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpO1xuICAgIHRoaXMua2V5UHJlc3NDb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgIGlmIChldi5rZXkgPT09ICd0Jykge1xuICAgICAgICB2YXIgc3MgPSAnJztcbiAgICAgICAgdmFyIHMgPSAnYWJjZGVmZ2hpamtsbW9wcXJzdHV2UVdJRVVUR0FTRExJR0tCWEFDUVdFVEwxMDIzOTQ2NzY0NTcnO1xuICAgICAgICB2YXIgbCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIwKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHNzICs9IHNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcy5sZW5ndGgpXTtcbiAgICAgICAgc2VsZi5lbC5zZXRBdHRyaWJ1dGUoJ3N1cGVyLWtleWJvYXJkJywge3ZhbHVlOiBzc30pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2hvdycsIHRoaXMub3Blbi5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMuaGFuZCA9IG51bGw7XG4gICAgdGhpcy5oYW5kTGlzdGVuZXJzU2V0ID0gZmFsc2U7XG4gICAgdGhpcy5yYXljYXN0ZXIgPSBudWxsO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB2YXIga2JkYXRhID0gS0VZQk9BUkRTW3RoaXMuZGF0YS5tb2RlbF07XG4gICAgdmFyIHcgPSB0aGlzLmRhdGEud2lkdGg7XG4gICAgdmFyIGggPSB0aGlzLmRhdGEud2lkdGggLyAyO1xuICAgIHZhciB3MiA9IHcgLyAyO1xuICAgIHZhciBoMiA9IGggLyAyO1xuXG4gICAgaWYgKGtiZGF0YSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdzdXBlci1rZXlib2FyZCBFUlJPUjogbW9kZWwgXCInICsgdGhpcy5kYXRhLm1vZGVsICsgJ1wiIHVuZGVmaW5lZC4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIW9sZERhdGEgfHwgdGhpcy5kZWZhdWx0VmFsdWUgIT09IG9sZERhdGEuZGVmYXVsdFZhbHVlKSB7XG4gICAgICB0aGlzLnJhd1ZhbHVlID0gdGhpcy5kYXRhLnZhbHVlO1xuICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSB0aGlzLmRhdGEudmFsdWU7XG4gICAgICB0aGlzLnVwZGF0ZVRleHRJbnB1dCh0aGlzLmZpbHRlcih0aGlzLmRhdGEudmFsdWUpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy51cGRhdGVUZXh0SW5wdXQodGhpcy5maWx0ZXIodGhpcy5yYXdWYWx1ZSkpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmRhdGEud2lkdGggIT09IG9sZERhdGEud2lkdGggfHxcbiAgICAgICAgdGhpcy5kYXRhLmhlaWdodCAhPT0gb2xkRGF0YS5oZWlnaHQgfHxcbiAgICAgICAgdGhpcy5kYXRhLmtleUNvbG9yICE9PSBvbGREYXRhLmtleUNvbG9yKSB7XG4gICAgICB0aGlzLmtiSW1nLnNldEF0dHJpYnV0ZSgnZ2VvbWV0cnknLCB7cHJpbWl0aXZlOiAncGxhbmUnLCB3aWR0aDogdywgaGVpZ2h0OiBofSk7XG4gICAgICB0aGlzLmtiSW1nLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCB7XG4gICAgICAgIHNoYWRlcjogJ2ZsYXQnLFxuICAgICAgICBzcmM6IHRoaXMuZGF0YS5pbWFnZVBhdGggKyAnLycgKyBrYmRhdGEuaW1nLFxuICAgICAgICBjb2xvcjogdGhpcy5kYXRhLmtleUNvbG9yLFxuICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS5sYWJlbCAhPT0gb2xkRGF0YS5sYWJlbCB8fFxuICAgICAgICB0aGlzLmRhdGEubGFiZWxDb2xvciAhPT0gb2xkRGF0YS5sYWJlbENvbG9yIHx8XG4gICAgICAgIHRoaXMuZGF0YS53aWR0aCAhPT0gb2xkRGF0YS53aWR0aCkge1xuICAgICAgdGhpcy5sYWJlbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCB7XG4gICAgICAgIHZhbHVlOiB0aGlzLmRhdGEubGFiZWwsIGNvbG9yOiB0aGlzLmRhdGEubGFiZWxDb2xvciwgd2lkdGg6IHRoaXMuZGF0YS53aWR0aH0pO1xuICAgICAgdGhpcy5sYWJlbC5vYmplY3QzRC5wb3NpdGlvbi5zZXQoMCwgMC4zNSAqIHcsIC0wLjAyKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kYXRhLndpZHRoICE9PSBvbGREYXRhLndpZHRoIHx8XG4gICAgICAgIHRoaXMuZGF0YS5rZXlCZ0NvbG9yICE9PSBvbGREYXRhLmtleUJnQ29sb3IpIHtcbiAgICAgIHRoaXMuaW5pdEtleUNvbG9yUGxhbmUoKTtcbiAgICB9XG5cbiAgICB2YXIgaW5wdXR4ID0gdGhpcy5kYXRhLmFsaWduICE9PSAnY2VudGVyJyA/IGtiZGF0YS5pbnB1dE9mZnNldFggKiB3IDogMDtcbiAgICBpZiAodGhpcy5kYXRhLmFsaWduID09PSAncmlnaHQnKSB7IGlucHV0eCAqPSAtMTsgfVxuXG4gICAgaWYgKHRoaXMuZGF0YS5mb250ICE9PSBvbGREYXRhLmZvbnQgfHxcbiAgICAgICAgdGhpcy5kYXRhLmlucHV0Q29sb3IgIT09IG9sZERhdGEuaW5wdXRDb2xvciB8fFxuICAgICAgICB0aGlzLmRhdGEud2lkdGggIT09IG9sZERhdGEud2lkdGggfHxcbiAgICAgICAgdGhpcy5kYXRhLmFsaWduICE9PSBvbGREYXRhLmFsaWduKSB7XG4gICAgICB0aGlzLnRleHRJbnB1dC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCB7XG4gICAgICAgIGZvbnQ6IHRoaXMuZGF0YS5mb250LFxuICAgICAgICBjb2xvcjogdGhpcy5kYXRhLmlucHV0Q29sb3IsXG4gICAgICAgIHdpZHRoOiB3LFxuICAgICAgICB3cmFwQ291bnQ6IGtiZGF0YS53cmFwQ291bnQsXG4gICAgICAgIGFsaWduOiB0aGlzLmRhdGEuYWxpZ25cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFNvbWUgaGFjayB3aGVyZSB0aGUgaW5wdXRSZWN0IGlzIHN0b3JlZCBpbiB0aGUgSW5zZXJ0IGtleS5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtiZGF0YS5sYXlvdXQubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBrZGF0YSA9IGtiZGF0YS5sYXlvdXRbaV07XG4gICAgICBpZiAoa2RhdGEua2V5ID09PSAnSW5zZXJ0Jykge1xuICAgICAgICB0aGlzLmlucHV0UmVjdCA9IGtkYXRhO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMudGV4dElucHV0Lm9iamVjdDNELnBvc2l0aW9uLnNldChcbiAgICAgIGlucHV0eCxcbiAgICAgICh3IC8gNCkgLSAodGhpcy5pbnB1dFJlY3QueSArIHRoaXMuaW5wdXRSZWN0LmggLyAyKSAqIHcgLyAyICsga2JkYXRhLmlucHV0T2Zmc2V0WSAqIHcsXG4gICAgICAwLjAwMlxuICAgICk7XG5cbiAgICBpZiAodGhpcy5kYXRhLndpZHRoICE9PSBvbGREYXRhLndpZHRoKSB7XG4gICAgICB0aGlzLmN1cnNvci5zZXRBdHRyaWJ1dGUoJ2dlb21ldHJ5Jywge1xuICAgICAgICBwcmltaXRpdmU6ICdwbGFuZScsIHdpZHRoOiAwLjAzICogdywgaGVpZ2h0OiAwLjAxICogd30pO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlQ3Vyc29yUG9zaXRpb24oKTtcbiAgICB0aGlzLnNldHVwSGFuZCgpO1xuXG4gICAgdGhpcy5rZXlCZ0NvbG9yLnNldCh0aGlzLmRhdGEua2V5QmdDb2xvcik7XG4gICAgdGhpcy5rZXlIb3ZlckNvbG9yLnNldCh0aGlzLmRhdGEua2V5SG92ZXJDb2xvcik7XG4gICAgdGhpcy5rZXlQcmVzc0NvbG9yLnNldCh0aGlzLmRhdGEua2V5UHJlc3NDb2xvcik7XG5cbiAgICBpZiAodGhpcy5kYXRhLnNob3cpIHtcbiAgICAgIHRoaXMub3BlbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lKSB7XG4gICAgdmFyIGludGVyc2VjdGlvbjtcblxuICAgIGlmICh0aGlzLnByZXZDaGVja1RpbWUgJiYgKHRpbWUgLSB0aGlzLnByZXZDaGVja1RpbWUgPCB0aGlzLmRhdGEuaW50ZXJ2YWwpKSB7IHJldHVybjsgfVxuICAgIGlmICghdGhpcy5wcmV2Q2hlY2tUaW1lKSB7XG4gICAgICB0aGlzLnByZXZDaGVja1RpbWUgPSB0aW1lO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5yYXljYXN0ZXIpIHsgcmV0dXJuOyB9XG4gICAgaWYgKCF0aGlzLmZvY3VzZWQpIHsgcmV0dXJuOyB9XG5cbiAgICBpbnRlcnNlY3Rpb24gPSB0aGlzLnJheWNhc3Rlci5nZXRJbnRlcnNlY3Rpb24odGhpcy5rYkltZyk7XG4gICAgaWYgKCFpbnRlcnNlY3Rpb24pIHsgcmV0dXJuOyB9XG5cbiAgICB2YXIgdXYgPSBpbnRlcnNlY3Rpb24udXY7XG4gICAgdmFyIGtleXMgPSBLRVlCT0FSRFNbdGhpcy5kYXRhLm1vZGVsXS5sYXlvdXQ7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgayA9IGtleXNbaV07XG4gICAgICBpZiAodXYueCA+IGsueCAmJiB1di54IDwgay54ICsgay53ICYmICgxLjAgLSB1di55KSA+IGsueSAmJiAoMS4wIC0gdXYueSkgPCBrLnkgKyBrLmgpIHtcbiAgICAgICAgaWYgKHRoaXMua2V5SG92ZXIgIT09IGspIHtcbiAgICAgICAgICAvLyBVcGRhdGUga2V5IGhvdmVyLlxuICAgICAgICAgIHRoaXMua2V5SG92ZXIgPSBrO1xuICAgICAgICAgIHRoaXMudXBkYXRlS2V5Q29sb3JQbGFuZSh0aGlzLmtleUhvdmVyLmtleSwgdGhpcy5rZXlIb3ZlckNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5jdXJzb3JVcGRhdGVkKSB7IHJldHVybjsgfVxuICAgIHRoaXMuc3RhcnRCbGlua2luZygpO1xuICB9LFxuXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5zdG9wQmxpbmtpbmcoKTtcbiAgfSxcblxuICAvKipcbiAgICogVGhlIHBsYW5lIGZvciB2aXN1YWwgZmVlZGJhY2sgd2hlbiBhIGtleSBpcyBob3ZlcmVkIG9yIGNsaWNrZWRcbiAgICovXG4gIGluaXRLZXlDb2xvclBsYW5lOiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGtiZGF0YSA9IEtFWUJPQVJEU1t0aGlzLmRhdGEubW9kZWxdO1xuICAgIHZhciBrZXlDb2xvclBsYW5lID0gdGhpcy5rZXlDb2xvclBsYW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcbiAgICBrZXlDb2xvclBsYW5lLmNsYXNzTGlzdC5hZGQoJ3N1cGVyS2V5Ym9hcmRLZXlDb2xvclBsYW5lJyk7XG4gICAga2V5Q29sb3JQbGFuZS5vYmplY3QzRC5wb3NpdGlvbi56ID0gMC4wMDE7XG4gICAga2V5Q29sb3JQbGFuZS5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAga2V5Q29sb3JQbGFuZS5zZXRBdHRyaWJ1dGUoJ2dlb21ldHJ5Jywge3ByaW1pdGl2ZTogJ3BsYW5lJywgYnVmZmVyOiBmYWxzZX0pO1xuICAgIGtleUNvbG9yUGxhbmUuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtzaGFkZXI6ICdmbGF0JywgY29sb3I6IHRoaXMuZGF0YS5rZXlCZ0NvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc3BhcmVudDogdHJ1ZX0pO1xuICAgIGlmIChrYmRhdGEuaG92ZXJJbWcpIHtcbiAgICAgIGtleUNvbG9yUGxhbmUuc2V0QXR0cmlidXRlKCdtYXRlcmlhbCcsIHtzcmM6IHRoaXMuZGF0YS5pbWFnZVBhdGggKyAnLycgKyBrYmRhdGEuaG92ZXJJbWd9KTtcbiAgICB9XG5cbiAgICBrZXlDb2xvclBsYW5lLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbXBvbmVudGluaXRpYWxpemVkJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgaWYgKGV2dC5kZXRhaWwubmFtZSAhPT0gJ21hdGVyaWFsJykgeyByZXR1cm47IH1cbiAgICAgIGlmICgha2JkYXRhLmhvdmVySW1nKSB7XG4gICAgICAgIHRoaXMuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC5ibGVuZGluZyA9IFRIUkVFLkFkZGl0aXZlQmxlbmRpbmc7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZChrZXlDb2xvclBsYW5lKTtcbiAgfSxcblxuICAvKipcbiAgICogTW92ZSBrZXkgY29sb3IgcGxhbmUgdG8gYXBwcm9wcmlhdGUgcG9zaXRpb24sIHNjYWxlLCBhbmQgY2hhbmdlIGNvbG9yLlxuICAgKi9cbiAgdXBkYXRlS2V5Q29sb3JQbGFuZTogZnVuY3Rpb24gKGtleSwgY29sb3IpIHtcbiAgICB2YXIga2JkYXRhID0gS0VZQk9BUkRTW3RoaXMuZGF0YS5tb2RlbF07XG4gICAgdmFyIGtleUNvbG9yUGxhbmUgPSB0aGlzLmtleUNvbG9yUGxhbmU7XG5cbiAgICAvLyBVbnNldC5cbiAgICBpZiAoIWtleSkge1xuICAgICAga2V5Q29sb3JQbGFuZS5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrYmRhdGEubGF5b3V0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIga2RhdGEgPSBrYmRhdGEubGF5b3V0W2ldO1xuICAgICAgaWYgKGtkYXRhLmtleSAhPT0ga2V5KSB7IGNvbnRpbnVlOyB9XG4gICAgICB2YXIgdyA9IHRoaXMuZGF0YS53aWR0aDtcbiAgICAgIHZhciBoID0gdGhpcy5kYXRhLndpZHRoIC8gMjtcbiAgICAgIHZhciB3MiA9IHcgLyAyO1xuICAgICAgdmFyIGgyID0gaCAvIDI7XG4gICAgICB2YXIga2V5dyA9IGtkYXRhLncgKiB3O1xuICAgICAgdmFyIGtleWggPSBrZGF0YS5oICogaDtcbiAgICAgIC8vIFNpemUuXG4gICAgICBrZXlDb2xvclBsYW5lLm9iamVjdDNELnNjYWxlLnggPSBrZXl3O1xuICAgICAga2V5Q29sb3JQbGFuZS5vYmplY3QzRC5zY2FsZS55ID0ga2V5aDtcbiAgICAgIC8vIFBvc2l0aW9uLlxuICAgICAga2V5Q29sb3JQbGFuZS5vYmplY3QzRC5wb3NpdGlvbi54ID0ga2RhdGEueCAqIHcgLSB3MiArIGtleXcgLyAyO1xuICAgICAga2V5Q29sb3JQbGFuZS5vYmplY3QzRC5wb3NpdGlvbi55ID0gKDEgLSBrZGF0YS55KSAqIGggLSBoMiAtIGtleWggLyAyO1xuICAgICAgLy8gQ29sb3IuXG4gICAgICBrZXlDb2xvclBsYW5lLmdldE9iamVjdDNEKCdtZXNoJykubWF0ZXJpYWwuY29sb3IuY29weShjb2xvcik7XG4gICAgICAvLyBVVnMuXG5cbiAgICAgIHZhciBnZW9tZXRyeSA9IGtleUNvbG9yUGxhbmUuZ2V0T2JqZWN0M0QoJ21lc2gnKS5nZW9tZXRyeVxuICAgICAgdmFyIHV2U2V0ID0gZ2VvbWV0cnkuZmFjZVZlcnRleFV2c1swXTtcbiAgICAgIHZhciBrZGF0YVkgPSAxIC0ga2RhdGEueTtcbiAgICAgIHV2U2V0WzBdWzBdLnNldChrZGF0YS54LCBrZGF0YVkpO1xuICAgICAgdXZTZXRbMF1bMV0uc2V0KGtkYXRhLngsIGtkYXRhWSAtIGtkYXRhLmgpO1xuICAgICAgdXZTZXRbMF1bMl0uc2V0KGtkYXRhLnggKyBrZGF0YS53LCBrZGF0YVkpO1xuICAgICAgdXZTZXRbMV1bMF0uc2V0KGtkYXRhLngsIGtkYXRhWSAtIGtkYXRhLmgpO1xuICAgICAgdXZTZXRbMV1bMV0uc2V0KGtkYXRhLnggKyBrZGF0YS53LCBrZGF0YVkgLSBrZGF0YS5oKTtcbiAgICAgIHV2U2V0WzFdWzJdLnNldChrZGF0YS54ICsga2RhdGEudywga2RhdGFZKTtcbiAgICAgIGdlb21ldHJ5LnV2c05lZWRVcGRhdGUgPSB0cnVlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGtleUNvbG9yUGxhbmUub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gIH0sXG5cbiAgc2V0dXBIYW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuaGFuZCAmJiB0aGlzLmhhbmQub3duUmF5Y2FzdGVyKSB7XG4gICAgICB0aGlzLmhhbmQucmVtb3ZlQXR0cmlidXRlKCdyYXljYXN0ZXInKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZGF0YS5oYW5kKSB7XG4gICAgICB0aGlzLmhhbmQgPSB0aGlzLmRhdGEuaGFuZDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oYW5kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihbXG4gICAgICAgICdbY3Vyc29yXScsXG4gICAgICAgICdbdml2ZS1jb250cm9sc10nLFxuICAgICAgICAnW3RyYWNrZWQtY29udHJvbHNdJyxcbiAgICAgICAgJ1tvY3VsdXMtdG91Y2gtY29udHJvbHNdJyxcbiAgICAgICAgJ1t3aW5kb3dzLW1vdGlvbi1jb250cm9sc10nLFxuICAgICAgICAnW2hhbmQtY29udHJvbHNdJyxcbiAgICAgICAgJ1tkYXlkcmVhbS1jb250cm9sc10gW2N1cnNvcl0gPiBbcmF5Y2FzdGVyXSdcbiAgICAgIF0uam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaGFuZCkge1xuICAgICAgY29uc29sZS5lcnJvcignc3VwZXIta2V5Ym9hcmQ6IG5vIGNvbnRyb2xsZXIgZm91bmQuIEFkZCA8YS1lbnRpdHk+IHdpdGggY29udHJvbGxlciBvciBzcGVjaWZ5IHdpdGggc3VwZXIta2V5Ym9hcmQ9XCJoYW5kOiAjc2VsZWN0b3JUb0NvbnRyb2xsZXJcIi4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCF0aGlzLmhhbmQuaGFzTG9hZGVkKSB7XG4gICAgICAgIHRoaXMuaGFuZC5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWQnLCB0aGlzLnNldHVwSGFuZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIHJheWNhc3RlciA9IHRoaXMuaGFuZC5jb21wb25lbnRzWydyYXljYXN0ZXInXTtcbiAgICAgIHZhciBwYXJhbXMgPSB7fTtcblxuICAgICAgaWYgKCFyYXljYXN0ZXIpIHtcbiAgICAgICAgdGhpcy5oYW5kLm93blJheWNhc3RlciA9IHRydWU7XG4gICAgICAgIHBhcmFtcy5zaG93TGluZSA9IHRoaXMuZGF0YS5zaG93O1xuICAgICAgICBwYXJhbXMuZW5hYmxlZCA9IHRoaXMuZGF0YS5zaG93O1xuICAgICAgICBpZiAodGhpcy5kYXRhLmluamVjdFRvUmF5Y2FzdGVyT2JqZWN0cykge1xuICAgICAgICAgIHBhcmFtcy5vYmplY3RzID0gJy5rZXlib2FyZFJheWNhc3RhYmxlJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmhhbmQuc2V0QXR0cmlidXRlKCdyYXljYXN0ZXInLCBwYXJhbXMpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5oYW5kLm93blJheWNhc3RlciA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5kYXRhLmluamVjdFRvUmF5Y2FzdGVyT2JqZWN0cykge1xuICAgICAgICAgIHZhciBvYmpzID0gcmF5Y2FzdGVyLmRhdGEub2JqZWN0cy5zcGxpdCgnLCcpO1xuICAgICAgICAgIGlmIChvYmpzLmluZGV4T2YoJy5rZXlib2FyZFJheWNhc3RhYmxlJykgPT09IC0xKSB7XG4gICAgICAgICAgICBvYmpzLnB1c2goJy5rZXlib2FyZFJheWNhc3RhYmxlJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBhcmFtcy5vYmplY3RzID0gb2Jqcy5qb2luKCcsJykucmVwbGFjZSgvXiwvLCAnJyk7XG4gICAgICAgICAgdGhpcy5oYW5kLnNldEF0dHJpYnV0ZSgncmF5Y2FzdGVyJywgcGFyYW1zKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLnJheWNhc3RlciA9IHRoaXMuaGFuZC5jb21wb25lbnRzLnJheWNhc3RlcjtcbiAgICB9XG4gIH0sXG5cbiAgZmlsdGVyOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgaWYgKHN0ciA9PT0gJycpIHsgcmV0dXJuICcnOyB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmRhdGEuZmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgc3dpdGNoICh0aGlzLmRhdGEuZmlsdGVyc1tpXSkge1xuICAgICAgICBjYXNlICdjdXN0b20nOiB7XG4gICAgICAgICAgaWYgKHRoaXMudXNlckZpbHRlckZ1bmMpIHN0ciA9IHRoaXMudXNlckZpbHRlckZ1bmMoc3RyKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdhbGx1cHBlcic6IHtcbiAgICAgICAgICBzdHIgPSBzdHIudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdhbGxsb3dlcic6IHtcbiAgICAgICAgICBzdHIgPSBzdHIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICd0aXRsZSc6IHtcbiAgICAgICAgICBzdHIgPSBzdHIuc3BsaXQoJyAnKS5tYXAoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc3Vic3RyKDEpOyB9KS5qb2luKCcgJyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnbnVtYmVycyc6IHtcbiAgICAgICAgICBzdHIgPSBzdHIuc3BsaXQoJycpLmZpbHRlcihmdW5jdGlvbiAoYykgeyByZXR1cm4gIWlzTmFOKHBhcnNlSW50KGMpKSB8fCBjID09PSAnLic7IH0pLmpvaW4oJycpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ2ZpcnN0Jzoge1xuICAgICAgICAgIHN0ciA9IHN0clswXS50b1VwcGVyQ2FzZSgpICsgc3RyLnN1YnN0cigxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICd0cmltJzoge1xuICAgICAgICAgIHN0ciA9IHN0ci50cmltKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZGF0YS5tYXhMZW5ndGggPiAwID8gc3RyLnN1YnN0cigwLCB0aGlzLmRhdGEubWF4TGVuZ3RoKSA6IHN0cjtcbiAgfSxcblxuICBjbGljazogZnVuY3Rpb24gKGV2KSB7XG4gICAgaWYgKCF0aGlzLmtleUhvdmVyKSB7IHJldHVybjsgfVxuXG4gICAgc3dpdGNoICh0aGlzLmtleUhvdmVyLmtleSkge1xuICAgICAgY2FzZSAnRW50ZXInOiB7XG4gICAgICAgIHRoaXMuYWNjZXB0KCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnSW5zZXJ0Jzoge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjYXNlICdEZWxldGUnOiB7XG4gICAgICAgIHRoaXMucmF3VmFsdWUgPSB0aGlzLnJhd1ZhbHVlLnN1YnN0cigwLCB0aGlzLnJhd1ZhbHVlLmxlbmd0aCAtIDEpO1xuICAgICAgICB2YXIgbmV3VmFsdWUgPSB0aGlzLmZpbHRlcih0aGlzLnJhd1ZhbHVlKTtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3N1cGVyLWtleWJvYXJkJywgJ3ZhbHVlJywgbmV3VmFsdWUpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRleHRJbnB1dChuZXdWYWx1ZSk7XG4gICAgICAgIHRoaXMuY2hhbmdlRXZlbnREZXRhaWwudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5lbC5lbWl0KCdzdXBlcmtleWJvYXJkY2hhbmdlJywgdGhpcy5jaGFuZ2VFdmVudERldGFpbCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnU2hpZnQnOiB7XG4gICAgICAgIHRoaXMuc2hpZnQgPSAhdGhpcy5zaGlmdDtcbiAgICAgICAgdGhpcy5rZXlIb3Zlci5lbC5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ2NvbG9yJyxcbiAgICAgICAgICB0aGlzLnNoaWZ0ID8gdGhpcy5kYXRhLmtleUhvdmVyQ29sb3IgOiB0aGlzLmRhdGEua2V5QmdDb2xvclxuICAgICAgICApO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ0VzY2FwZSc6IHtcbiAgICAgICAgdGhpcy5kaXNtaXNzKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgZGVmYXVsdDoge1xuICAgICAgICBpZiAodGhpcy5kYXRhLm1heExlbmd0aCA+IDAgJiYgdGhpcy5yYXdWYWx1ZS5sZW5ndGggPiB0aGlzLmRhdGEubWF4TGVuZ3RoKSB7IGJyZWFrOyB9XG4gICAgICAgIHRoaXMucmF3VmFsdWUgKz0gdGhpcy5zaGlmdCA/IHRoaXMua2V5SG92ZXIua2V5LnRvVXBwZXJDYXNlKCkgOiB0aGlzLmtleUhvdmVyLmtleTtcbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gdGhpcy5maWx0ZXIodGhpcy5yYXdWYWx1ZSk7XG4gICAgICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdzdXBlci1rZXlib2FyZCcsICd2YWx1ZScsIG5ld1ZhbHVlKTtcbiAgICAgICAgdGhpcy51cGRhdGVUZXh0SW5wdXQobmV3VmFsdWUpO1xuICAgICAgICB0aGlzLmNoYW5nZUV2ZW50RGV0YWlsLnZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMuZWwuZW1pdCgnc3VwZXJrZXlib2FyZGNoYW5nZScsIHRoaXMuY2hhbmdlRXZlbnREZXRhaWwpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZUtleUNvbG9yUGxhbmUodGhpcy5rZXlIb3Zlci5rZXksIHRoaXMua2V5UHJlc3NDb2xvcik7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgc2VsZi51cGRhdGVLZXlDb2xvclBsYW5lKHNlbGYua2V5SG92ZXIua2V5LCBzZWxmLmtleUhvdmVyQ29sb3IpO1xuICAgIH0sIDEwMCk7XG4gICAgdGhpcy51cGRhdGVDdXJzb3JQb3NpdGlvbigpO1xuICB9LFxuXG4gIG9wZW46IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgIGlmICh0aGlzLmhhbmQgJiYgdGhpcy5oYW5kLm93blJheWNhc3Rlcikge1xuICAgICAgdGhpcy5oYW5kLnNldEF0dHJpYnV0ZSgncmF5Y2FzdGVyJywge3Nob3dMaW5lOiB0cnVlLCBlbmFibGVkOiB0cnVlfSk7XG4gICAgfVxuICB9LFxuXG4gIGNsb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgaWYgKHRoaXMuaGFuZCAmJiB0aGlzLmhhbmQub3duUmF5Y2FzdGVyKSB7XG4gICAgICB0aGlzLmhhbmQuc2V0QXR0cmlidXRlKCdyYXljYXN0ZXInLCB7c2hvd0xpbmU6IGZhbHNlLCBlbmFibGVkOiBmYWxzZX0pO1xuICAgIH1cbiAgfSxcblxuICBhY2NlcHQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5oYW5kICYmIHRoaXMuaGFuZC5vd25SYXljYXN0ZXIpIHtcbiAgICAgIHRoaXMuaGFuZC5zZXRBdHRyaWJ1dGUoJ3JheWNhc3RlcicsIHtzaG93TGluZTogZmFsc2UsIGVuYWJsZWQ6IGZhbHNlfSk7XG4gICAgfVxuICAgIHRoaXMuZWwuZW1pdCgnc3VwZXJrZXlib2FyZGlucHV0Jywge3ZhbHVlOiB0aGlzLmRhdGEudmFsdWV9KTtcbiAgICB0aGlzLmRhdGEuc2hvdyA9IGZhbHNlO1xuICB9LFxuXG4gIGRpc21pc3M6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmRhdGEudmFsdWUgPSB0aGlzLmRlZmF1bHRWYWx1ZTtcbiAgICB0aGlzLnVwZGF0ZVRleHRJbnB1dCgpO1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgIGlmICh0aGlzLmhhbmQgJiYgdGhpcy5oYW5kLm93blJheWNhc3Rlcikge1xuICAgICAgdGhpcy5oYW5kLnNldEF0dHJpYnV0ZSgncmF5Y2FzdGVyJywge3Nob3dMaW5lOiBmYWxzZSwgZW5hYmxlZDogZmFsc2V9KTtcbiAgICB9XG4gICAgdGhpcy5lbC5lbWl0KCdzdXBlcmtleWJvYXJkZGlzbWlzcycpO1xuICAgIHRoaXMuZGF0YS5zaG93ID0gZmFsc2U7XG4gIH0sXG5cbiAgYmx1cjogZnVuY3Rpb24gKGV2KSB7XG4gICAgdGhpcy5mb2N1c2VkID0gZmFsc2U7XG4gICAgaWYgKHRoaXMua2V5SG92ZXIgJiYgdGhpcy5rZXlIb3Zlci5rZXkgIT09ICdTaGlmdCcpIHtcbiAgICAgIHRoaXMudXBkYXRlS2V5Q29sb3JQbGFuZSh0aGlzLmtleUhvdmVyLmtleSwgdGhpcy5rZXlCZ0NvbG9yKTtcbiAgICB9XG4gICAgdGhpcy5rZXlIb3ZlciA9IG51bGw7XG4gIH0sXG5cbiAgaG92ZXI6IGZ1bmN0aW9uIChldikge1xuICAgIHRoaXMuZm9jdXNlZCA9IHRydWU7XG4gIH0sXG5cbiAgc3RhcnRCbGlua2luZzogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3RvcEJsaW5raW5nKCk7XG4gICAgdGhpcy5pbnRlcnZhbElkID0gd2luZG93LnNldEludGVydmFsKHRoaXMuYmxpbmsuYmluZCh0aGlzKSwgdGhpcy5kYXRhLmJsaW5raW5nU3BlZWQpO1xuICB9LFxuXG4gIHN0b3BCbGlua2luZzogZnVuY3Rpb24gKCkge1xuICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWxJZCk7XG4gICAgdGhpcy5pbnRlcnZhbElkID0gMDtcbiAgfSxcblxuICBibGluazogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY3Vyc29yLm9iamVjdDNELnZpc2libGUgPSAhdGhpcy5jdXJzb3Iub2JqZWN0M0QudmlzaWJsZTtcbiAgfSxcblxuICBzZXRDdXN0b21GaWx0ZXI6IGZ1bmN0aW9uIChmKSB7XG4gICAgdGhpcy51c2VyRmlsdGVyRnVuYyA9IGY7XG4gIH0sXG5cbiAgYWRkQ3VzdG9tTW9kZWw6IGZ1bmN0aW9uIChuYW1lLCBtb2RlbCkge1xuICAgIGlmICghbmFtZSkgeyByZXR1cm47IH1cbiAgICBLRVlCT0FSRFNbbmFtZV0gPSBtb2RlbDtcbiAgfSxcblxuICB1cGRhdGVDdXJzb3JQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xuICAgIHZhciBmb250ID0gdGhpcy50ZXh0SW5wdXQuY29tcG9uZW50cy50ZXh0LmN1cnJlbnRGb250O1xuICAgIGlmICghZm9udCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5jdXJzb3Iub2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnVwZGF0ZUN1cnNvclBvc2l0aW9uKCk7XG4gICAgICAgIHNlbGYuc3RhcnRCbGlua2luZygpO1xuICAgICAgfSwgNzAwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgdyA9IHRoaXMuZGF0YS53aWR0aDtcbiAgICB2YXIga2JkYXRhID0gS0VZQk9BUkRTW3RoaXMuZGF0YS5tb2RlbF07XG4gICAgdmFyIHBvc3kgPSAtdGhpcy5pbnB1dFJlY3QuaCAvIDIgKiB3IC8gMi40ICsga2JkYXRhLmlucHV0T2Zmc2V0WSAqIHc7XG4gICAgdmFyIHJhdGlvID0gdGhpcy5kYXRhLndpZHRoIC8gdGhpcy50ZXh0SW5wdXQuY29tcG9uZW50cy50ZXh0LmRhdGEud3JhcENvdW50O1xuICAgIHZhciBwb3MgPSAwO1xuICAgIHZhciBmb250RmFjdG9yID0gRm9udEZhY3RvcnNbdGhpcy50ZXh0SW5wdXQuY29tcG9uZW50cy50ZXh0LmRhdGEuZm9udF07XG4gICAgaWYgKGZvbnRGYWN0b3IgPT09IHVuZGVmaW5lZCkgeyBmb250RmFjdG9yID0gMjA7IH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZGF0YS52YWx1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGNoYXIgPSBmaW5kRm9udENoYXIoZm9udC5jaGFycywgdGhpcy5kYXRhLnZhbHVlLmNoYXJDb2RlQXQoaSkpO1xuICAgICAgcG9zICs9IGNoYXIud2lkdGggKyBjaGFyLnhhZHZhbmNlICogKGNoYXIuaWQgPT09IDMyID8gMiA6IDEpO1xuICAgIH1cbiAgICBpZiAodGhpcy5kYXRhLmFsaWduID09PSAnY2VudGVyJykge1xuICAgICAgcG9zID0gcG9zICogcmF0aW8gKiBmb250RmFjdG9yICogMC4wMDExIC8gMi4wICsgMC4wMiAqIHc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmRhdGEuYWxpZ24gPT09ICdsZWZ0Jykge1xuICAgICAgcG9zID0gcG9zICogcmF0aW8gKiBmb250RmFjdG9yICogMC4wMDExICsgMC4wMiAqIHc7XG4gICAgICBwb3MgLT0gdyAvIDI7XG4gICAgfSBlbHNlIGlmICh0aGlzLmRhdGEuYWxpZ24gPT09ICdyaWdodCcpIHtcbiAgICAgIHBvcyA9IC1wb3MgKiByYXRpbyAqIGZvbnRGYWN0b3IgKiAwLjAwMTEgLSAwLjAyICogdztcbiAgICAgIHBvcyArPSB3IC8gMjtcbiAgICB9XG4gICAgdGhpcy5jdXJzb3Iub2JqZWN0M0QucG9zaXRpb24uc2V0KHBvcywgcG9zeSwgMC4wMDEpO1xuICAgIHRoaXMuY3Vyc29yVXBkYXRlZCA9IHRydWU7XG4gIH0sXG5cbiAgdXBkYXRlVGV4dElucHV0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB0aGlzLnRleHRJbnB1dE9iamVjdC52YWx1ZSA9IHZhbHVlIHx8IHRoaXMuZGF0YS52YWx1ZTtcbiAgICB0aGlzLnRleHRJbnB1dC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCB0aGlzLnRleHRJbnB1dE9iamVjdCk7XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBmaW5kRm9udENoYXIgKGNoYXJzLCBjb2RlKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhcnMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoY2hhcnNbaV0uaWQgPT09IGNvZGUpIHsgcmV0dXJuIGNoYXJzW2ldOyB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdXBlci1rZXlib2FyZC5qcyIsIkFGUkFNRS5yZWdpc3RlclNoYWRlcignc3VwZXJDdXRGeFNoYWRlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgc3RhcnRUaW1lOiB7dHlwZTogJ2Zsb2F0JywgaXM6ICd1bmlmb3JtJ30sXG4gICAgdGltZW1zOiB7dHlwZTogJ3RpbWUnLCBpczogJ3VuaWZvcm0nfVxuICB9LFxuXG4gIHZlcnRleFNoYWRlcjogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHZvaWQgbWFpbigpIHtcbiAgICAgIHV2cy54eSA9IHV2Lnh5O1xuICAgICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1xuICAgIH1cbiAgYCxcblxuICBmcmFnbWVudFNoYWRlcjogYFxuICAgIHVuaWZvcm0gZmxvYXQgc3RhcnRUaW1lO1xuICAgIHVuaWZvcm0gZmxvYXQgdGltZW1zO1xuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuXG4gICAgI2RlZmluZSBDT0xPUiB2ZWMzKDAsIDAuNjcsIDAuOTgpXG5cbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICBmbG9hdCB0aW1lID0gKHRpbWVtcyAtIHN0YXJ0VGltZSkgLyAyMDAwLjA7XG4gICAgICB2ZWMyIHAgPSB1dnMueHkgLSAwLjU7XG4gICAgICBmbG9hdCByID0gcC54ICogcC54ICsgcC55ICogcC55O1xuICAgICAgZmxvYXQgYWxwaGEgPSAxLjAgLSBzbW9vdGhzdGVwKHRpbWUgLSAwLjAxLCB0aW1lLCByKTtcbiAgICAgIGFscGhhICo9IHNtb290aHN0ZXAodGltZSAtIDAuMSwgdGltZSwgcik7XG4gICAgICBhbHBoYSAqPSAxLjAgLSB0aW1lICogNS41O1xuICAgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNChDT0xPUiwgYWxwaGEpO1xuICAgIH1cbiAgYFxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy9zdXBlcmN1dGZ4LXNoYWRlci5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgnc3VwZXJjdXRmeCcsIHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuc3RhcnRUaW1lID0gLTExMDA7IC8vIHBhdXNlIG9uIGZpcnN0IHRpY2tcbiAgfSxcblxuICBjcmVhdGVTdXBlckN1dDogZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgY29uc3QgbWVzaCA9IHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKTtcbiAgICB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uLmNvcHkocG9zaXRpb24pO1xuICAgIHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24ueiA9IC0xO1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG5cbiAgICB0aGlzLnN0YXJ0VGltZSA9IHRoaXMuZWwuc2NlbmVFbC50aW1lO1xuICAgIG1lc2gubWF0ZXJpYWwudW5pZm9ybXMuc3RhcnRUaW1lLnZhbHVlID0gdGhpcy5zdGFydFRpbWUgLSA1MDtcbiAgICB0aGlzLmVsLnBsYXkoKTtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSkge1xuICAgIGlmICh0aW1lID4gdGhpcy5zdGFydFRpbWUgKyAxMDAwKSB7XG4gICAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHRoaXMuZWwucGF1c2UoKTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvc3VwZXJjdXRmeC5qcyIsIi8qKlxuICogQW5pbWF0ZSB0ZXh0IG51bWJlciB2YWx1ZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd0ZXh0LWNvdW50ZXInLCB7XG4gIGRlcGVuZGVuY2llczogWyd0ZXh0J10sXG5cbiAgc2NoZW1hOiB7XG4gICAgZGVjaW1hbHM6IHtkZWZhdWx0OiAwfSxcbiAgICBkdXI6IHtkZWZhdWx0OiAyMDAwLCB0eXBlOiAnaW50J30sXG4gICAgZW5hYmxlZDoge2RlZmF1bHQ6IGZhbHNlfSxcbiAgICBlbWl0OiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHByZWZpeDoge2RlZmF1bHQ6ICcnfSxcbiAgICBzdWZmaXg6IHtkZWZhdWx0OiAnJ30sXG4gICAgdmFsdWU6IHtkZWZhdWx0OiAwLjAsIHR5cGU6ICdmbG9hdCd9XG4gIH0sXG5cbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY3VycmVudFZhbHVlID0gMDtcbiAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IGZhbHNlO1xuICAgIHRoaXMudGV4dFZhbHVlID0ge3ZhbHVlIDogJyd9O1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IDA7XG4gICAgdGhpcy50ZXh0VmFsdWUudmFsdWUgPSBgJHt0aGlzLmRhdGEucHJlZml4fSR7dGhpcy5kZWNpbWFscygwKX0ke3RoaXMuZGF0YS5zdWZmaXh9YDtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgndGV4dCcsIHRoaXMudGV4dFZhbHVlKTtcbiAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IGZhbHNlO1xuICB9LFxuXG4gIHRpY2s6IGZ1bmN0aW9uICh0aW1lLCB0aW1lRGVsdGEpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkIHx8IHRoaXMuaGFzQ29tcGxldGVkKSB7IHJldHVybjsgfVxuXG4gICAgdGhpcy5jdXJyZW50VmFsdWUgKz0gdGhpcy5kYXRhLnZhbHVlICogKHRpbWVEZWx0YSAvIHRoaXMuZGF0YS5kdXIpO1xuXG4gICAgaWYgKHRoaXMuY3VycmVudFZhbHVlID49IHRoaXMuZGF0YS52YWx1ZSkge1xuICAgICAgdGhpcy5jdXJyZW50VmFsdWUgPSB0aGlzLmRhdGEudmFsdWU7XG4gICAgICBpZiAodGhpcy5kYXRhLmVtaXQpIHsgdGhpcy5lbC5lbWl0KCd0ZXh0Y291bnRlcmRvbmUnLCBudWxsLCBmYWxzZSk7IH1cbiAgICAgIHRoaXMuaGFzQ29tcGxldGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICB0aGlzLnRleHRWYWx1ZS52YWx1ZSA9XG4gICAgICBgJHt0aGlzLmRhdGEucHJlZml4fSR7dGhpcy5kZWNpbWFscyh0aGlzLmN1cnJlbnRWYWx1ZSl9JHt0aGlzLmRhdGEuc3VmZml4fWA7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCB0aGlzLnRleHRWYWx1ZSk7XG4gIH0sXG5cbiAgZGVjaW1hbHM6IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGQgPSBNYXRoLnBvdygxMCwgdGhpcy5kYXRhLmRlY2ltYWxzKTtcbiAgICByZXR1cm4gKHBhcnNlSW50KG4gKiBkKSAvIGQpLnRvRml4ZWQodGhpcy5kYXRhLmRlY2ltYWxzKTtcbiAgfVxufSlcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3RleHQtY291bnRlci5qcyIsIkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudCgndGV4dC11cHBlcmNhc2UnLCB7XG4gIHNjaGVtYToge1xuICAgIHZhbHVlOiB7dHlwZTogJ3N0cmluZyd9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCAndmFsdWUnLCB0aGlzLmRhdGEudmFsdWUudG9VcHBlckNhc2UoKSk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdGV4dC11cHBlcmNhc2UuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3RvZ2dsZS1wYXVzZS1wbGF5Jywge1xuICBzY2hlbWE6IHtcbiAgICBpc1BsYXlpbmc6IHsgZGVmYXVsdDogZmFsc2UgfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMuZGF0YS5pc1BsYXlpbmcgPyAncGF1c2UnIDogJ3BsYXknO1xuICAgIHBhcmVudC5wb3N0TWVzc2FnZShKU09OLnN0cmluZ2lmeSh7IHZlcmlmeTogJ2dhbWUtYWN0aW9uJywgYWN0aW9uIH0pLCAnKicpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3RvZ2dsZS1wYXVzZS1wbGF5LmpzIiwiQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd0cmFpbCcsIHtcbiAgc2NoZW1hOiB7XG4gICAgY29sb3I6IHt0eXBlOiAnY29sb3InfSxcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIGhhbmQ6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGdlb21ldHJ5ID0gdGhpcy5nZW9tZXRyeSA9IG5ldyBUSFJFRS5CdWZmZXJHZW9tZXRyeSgpO1xuICAgIHZhciBtYXhQb2ludHMgPSB0aGlzLm1heFBvaW50cyA9IDEyO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMgPSBuZXcgRmxvYXQzMkFycmF5KDM2ICogbWF4UG9pbnRzKTtcbiAgICB2YXIgY29sb3JzID0gdGhpcy5jb2xvcnMgPSBuZXcgRmxvYXQzMkFycmF5KDQ4ICogbWF4UG9pbnRzKTtcbiAgICB2YXIgYmxhZGVDb2xvciA9IHRoaXMuYmxhZGVDb2xvciA9IG5ldyBUSFJFRS5Db2xvcih0aGlzLmRhdGEuY29sb3IpO1xuXG4gICAgdGhpcy5ibGFkZUNvbG9yID0ge1xuICAgICAgcmVkOiBibGFkZUNvbG9yLnIsXG4gICAgICBncmVlbjogYmxhZGVDb2xvci5nLFxuICAgICAgYmx1ZTogYmxhZGVDb2xvci5iLFxuICAgICAgYWxwaGE6IDEuMFxuICAgIH07XG4gICAgdGhpcy5zYWJlckVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuYmxhZGUnKTtcblxuICAgIHRoaXMubGF5ZXJzID0gMDtcbiAgICB0aGlzLnNhYmVyVHJhamVjdG9yeSA9IFtcbiAgICAgIHt0b3A6IG5ldyBUSFJFRS5WZWN0b3IzKC0wLjUsIDAsIDApLCBjZW50ZXI6IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDAsIDApLCBib3R0b206IG5ldyBUSFJFRS5WZWN0b3IzKDAuNSwgMCwgMCl9LFxuICAgICAge3RvcDogbmV3IFRIUkVFLlZlY3RvcjMoLTAuNSwgMC41LCAwKSwgY2VudGVyOiBuZXcgVEhSRUUuVmVjdG9yMygwLCAwLjUsIDApLCBib3R0b206IG5ldyBUSFJFRS5WZWN0b3IzKDAuNSwgMC41LCAwKX0sXG4gICAgICB7dG9wOiBuZXcgVEhSRUUuVmVjdG9yMygtMC41LCAxLjAsIDApLCBjZW50ZXI6IG5ldyBUSFJFRS5WZWN0b3IzKDAsIDEuMCwgMCksIGJvdHRvbTogbmV3IFRIUkVFLlZlY3RvcjMoMC41LCAxLjAsIDApfVxuICAgIF07XG5cbiAgICBnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSh2ZXJ0aWNlcywgMykuc2V0RHluYW1pYyh0cnVlKSk7XG4gICAgZ2VvbWV0cnkuYWRkQXR0cmlidXRlKCd2ZXJ0ZXhDb2xvcicsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoY29sb3JzLCA0KS5zZXREeW5hbWljKHRydWUpKTtcblxuICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IFRIUkVFLlNoYWRlck1hdGVyaWFsKHtcbiAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGUsXG4gICAgICB2ZXJ0ZXhDb2xvcnM6IFRIUkVFLlZlcnRleENvbG9ycyxcbiAgICAgIHRyYW5zcGFyZW50OiB0cnVlLFxuICAgICAgYmxlbmRpbmc6IFRIUkVFLkFkZGl0aXZlQmxlbmRpbmcsXG4gICAgICB2ZXJ0ZXhTaGFkZXI6IFtcbiAgICAgICAgJ3ZhcnlpbmcgdmVjNCB2Q29sb3I7JyxcbiAgICAgICAgJ2F0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOycsXG4gICAgICAgICd2b2lkIG1haW4oKSB7JyxcbiAgICAgICAgJ3ZlYzQgbW9kZWxWaWV3UG9zaXRpb24gPSBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KHBvc2l0aW9uLCAxLjApOycsXG4gICAgICAgICd2Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsnLFxuICAgICAgICAnZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3UG9zaXRpb247JyxcbiAgICAgICAgJ30nXG4gICAgICBdLmpvaW4oJycpLFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IFtcbiAgICAgICAgJ3ZhcnlpbmcgdmVjNCB2Q29sb3I7JyxcbiAgICAgICAgJ3ZvaWQgbWFpbigpIHsnLFxuICAgICAgICAnZ2xfRnJhZ0NvbG9yID0gdkNvbG9yOycsXG4gICAgICAgICd9J1xuICAgICAgXS5qb2luKCcnKVxuICAgIH0pO1xuXG4gICAgY29uc3QgbWVzaCA9IHRoaXMubWVzaCA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7XG4gICAgbWVzaC5mcnVzdHVtQ3VsbGVkID0gZmFsc2U7XG4gICAgbWVzaC52ZXJ0aWNlcyA9IHZlcnRpY2VzO1xuICAgIHRoaXMuZWwuc2NlbmVFbC5zZXRPYmplY3QzRChgdHJhaWxfXyR7dGhpcy5kYXRhLmhhbmR9YCwgbWVzaCk7XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIGlmICghb2xkRGF0YS5lbmFibGVkICYmIHRoaXMuZGF0YS5lbmFibGVkKSB7XG4gICAgICB0aGlzLmVuYWJsZWRUaW1lID0gdGhpcy5lbC5zY2VuZUVsLnRpbWU7XG4gICAgICB0aGlzLm1lc2gudmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChvbGREYXRhLmVuYWJsZWQgJiYgIXRoaXMuZGF0YS5lbmFibGVkKSB7XG4gICAgICB0aGlzLm1lc2gudmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgfSxcblxuICB0b2NrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAoIXRoaXMuZGF0YS5lbmFibGVkKSB7IHJldHVybjsgfVxuICAgIC8vIERlbGF5IGJlZm9yZSBzaG93aW5nIGFmdGVyIGVuYWJsZWQgdG8gcHJldmVudCBmbGFzaCBmcm9tIG9sZCBzYWJlciBwb3NpdGlvbi5cbiAgICBpZiAoIXRoaXMubWVzaC52aXNpYmxlICYmIHRpbWUgPiB0aGlzLmVuYWJsZWRUaW1lICsgMjUwKSB7IHRoaXMubWVzaC52aXNpYmxlID0gdHJ1ZTsgfVxuICAgIHRoaXMuc2FtcGxlU2FiZXJQb3NpdGlvbigpO1xuICB9LFxuXG4gIGFkZExheWVyOiBmdW5jdGlvbiAobGVuZ3RoKSB7XG4gICAgdmFyIHN0YXJ0WCA9IC0xLjA7XG4gICAgdmFyIHNlZ21lbnRzID0gdGhpcy5zZWdtZW50cztcbiAgICB2YXIgZHggPSAyIC8gc2VnbWVudHM7XG4gICAgdmFyIGNvbG9ycyA9IHRoaXMuY29sb3JzO1xuICAgIHZhciB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7XG4gICAgdmFyIGNvbG9yID0gdGhpcy5ibGFkZUNvbG9yO1xuXG4gICAgaWYgKHRoaXMubGF5ZXJzID49IHRoaXMubWF4TGF5ZXJzKSB7IHRoaXMubGF5ZXJzID0gMDsgfVxuXG4gICAgY29uc3QgYm90dG9tTGF5ZXIgPSB0aGlzLmxheWVycyAqIGxlbmd0aDtcbiAgICBsZW5ndGggPSBib3R0b21MYXllciArIGxlbmd0aDtcbiAgICBjb25zdCBpbmRleE9mZnNldCA9IHRoaXMubGF5ZXJzICogc2VnbWVudHMgKiAxODtcbiAgICBjb25zdCBjb2xvck9mZnNldCA9IHRoaXMubGF5ZXJzICogc2VnbWVudHMgKiAyNDtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VnbWVudHM7ICsraSkge1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGldID0gc3RhcnRYICsgaSAqIGR4O1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxXSA9IGJvdHRvbUxheWVyO1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAyXSA9IDAuMDtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaV0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxXSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMl0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgM10gPSBjb2xvci5hbHBoYTtcblxuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAzXSA9IHN0YXJ0WCArIGkgKiBkeDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgNF0gPSBsZW5ndGg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDVdID0gMC4wO1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgNF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyA1XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgNl0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgN10gPSBjb2xvci5hbHBoYTtcblxuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyA2XSA9IHN0YXJ0WCArIGkgKiBkeCArIGR4O1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyA3XSA9IGxlbmd0aDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgOF0gPSAwLjA7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyA4XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDldID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbY29sb3JPZmZzZXQgKyAyNCAqIGkgKyAxMF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTFdID0gY29sb3IuYWxwaGE7XG5cbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgOV0gPSBzdGFydFggKyBpICogZHggKyBkeDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMTBdID0gYm90dG9tTGF5ZXI7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDExXSA9IDAuMDtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDEyXSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDEzXSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMTRdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDE1XSA9IGNvbG9yLmFscGhhO1xuXG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDEyXSA9IHN0YXJ0WCArIGkgKiBkeDtcbiAgICAgIHZlcnRpY2VzW2luZGV4T2Zmc2V0ICsgMTggKiBpICsgMTNdID0gYm90dG9tTGF5ZXI7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDE0XSA9IDAuMDtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDE2XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDE3XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMThdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDE5XSA9IGNvbG9yLmFscGhhO1xuXG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDE1XSA9IHN0YXJ0WCArIGkgKiBkeCArIGR4O1xuICAgICAgdmVydGljZXNbaW5kZXhPZmZzZXQgKyAxOCAqIGkgKyAxNl0gPSBsZW5ndGg7XG4gICAgICB2ZXJ0aWNlc1tpbmRleE9mZnNldCArIDE4ICogaSArIDE3XSA9IDAuMDtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDIwXSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDIxXSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzW2NvbG9yT2Zmc2V0ICsgMjQgKiBpICsgMjJdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1tjb2xvck9mZnNldCArIDI0ICogaSArIDIzXSA9IGNvbG9yLmFscGhhO1xuICAgIH1cblxuICAgIHRoaXMubGF5ZXJzKys7XG4gICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMudmVydGV4Q29sb3IubmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy51di5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH0sXG5cbiAgaW5pdEdlb21ldHJ5OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGk7XG4gICAgdmFyIHByZXZpb3VzUG9pbnQ7XG4gICAgdmFyIGN1cnJlbnRQb2ludDtcbiAgICB2YXIgc2FiZXJUcmFqZWN0b3J5ID0gdGhpcy5zYWJlclRyYWplY3Rvcnk7XG4gICAgdmFyIHZlcnRpY2VzID0gdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5O1xuICAgIHZhciBjb2xvcnMgPSB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMudmVydGV4Q29sb3IuYXJyYXk7XG4gICAgdmFyIGNvbG9yID0gdGhpcy5ibGFkZUNvbG9yO1xuICAgIHZhciBhbHBoYTtcbiAgICB2YXIgcHJldmlvdXNBbHBoYTtcblxuICAgIGZvciAoaSA9IDE7IGkgPCBzYWJlclRyYWplY3RvcnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChpID09PSAxKSB7IHByZXZpb3VzQWxwaGEgPSBhbHBoYTsgfVxuICAgICAgYWxwaGEgPSAxLjAgLSAoKHNhYmVyVHJhamVjdG9yeS5sZW5ndGggLSBpKSAvIHNhYmVyVHJhamVjdG9yeS5sZW5ndGgpO1xuXG4gICAgICBjdXJyZW50UG9pbnQgPSBzYWJlclRyYWplY3RvcnlbaV07XG4gICAgICBwcmV2aW91c1BvaW50ID0gc2FiZXJUcmFqZWN0b3J5W2kgLSAxXTtcblxuICAgICAgdmVydGljZXNbMzYgKiBpXSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxXSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyXSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpXSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxXSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDJdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzXSA9IHByZXZpb3VzQWxwaGEgKiAwLjI7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDNdID0gY3VycmVudFBvaW50LnRvcC54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgNF0gPSBjdXJyZW50UG9pbnQudG9wLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyA1XSA9IGN1cnJlbnRQb2ludC50b3AuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA0XSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA1XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDZdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyA3XSA9IGFscGhhO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyA2XSA9IHByZXZpb3VzUG9pbnQudG9wLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyA3XSA9IHByZXZpb3VzUG9pbnQudG9wLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyA4XSA9IHByZXZpb3VzUG9pbnQudG9wLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgOF0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgOV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxMF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDExXSA9IHByZXZpb3VzQWxwaGE7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDldID0gcHJldmlvdXNQb2ludC5jZW50ZXIueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDEwXSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxMV0gPSBwcmV2aW91c1BvaW50LmNlbnRlci56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDEyXSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxM10gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxNF0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDE1XSA9IHByZXZpb3VzQWxwaGEgKiAwLjI7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDEyXSA9IGN1cnJlbnRQb2ludC5jZW50ZXIueDtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDEzXSA9IGN1cnJlbnRQb2ludC5jZW50ZXIueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDE0XSA9IGN1cnJlbnRQb2ludC5jZW50ZXIuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxNl0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMTddID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMThdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAxOV0gPSBhbHBoYSAqIDAuMjtcblxuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTVdID0gY3VycmVudFBvaW50LnRvcC54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTZdID0gY3VycmVudFBvaW50LnRvcC55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTddID0gY3VycmVudFBvaW50LnRvcC56O1xuXG4gICAgICAvLyBDb2xvclxuICAgICAgY29sb3JzWzQ4ICogaSArIDIwXSA9IGNvbG9yLnJlZDtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyMV0gPSBjb2xvci5ncmVlbjtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAyMl0gPSBjb2xvci5ibHVlO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDIzXSA9IGFscGhhO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAxOF0gPSBwcmV2aW91c1BvaW50LmJvdHRvbS54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMTldID0gcHJldmlvdXNQb2ludC5ib3R0b20ueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDIwXSA9IHByZXZpb3VzUG9pbnQuYm90dG9tLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgMjRdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDI1XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDI2XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMjddID0gMC4wO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyMV0gPSBjdXJyZW50UG9pbnQuY2VudGVyLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyMl0gPSBjdXJyZW50UG9pbnQuY2VudGVyLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyM10gPSBjdXJyZW50UG9pbnQuY2VudGVyLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgMjhdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDI5XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDMwXSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMzFdID0gYWxwaGEgKiAwLjI7XG5cbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDI0XSA9IHByZXZpb3VzUG9pbnQuY2VudGVyLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyNV0gPSBwcmV2aW91c1BvaW50LmNlbnRlci55O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjZdID0gcHJldmlvdXNQb2ludC5jZW50ZXIuejtcblxuICAgICAgLy8gQ29sb3JcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzMl0gPSBjb2xvci5yZWQ7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMzNdID0gY29sb3IuZ3JlZW47XG4gICAgICBjb2xvcnNbNDggKiBpICsgMzRdID0gY29sb3IuYmx1ZTtcbiAgICAgIGNvbG9yc1s0OCAqIGkgKyAzNV0gPSBwcmV2aW91c0FscGhhICogMC4yO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAyN10gPSBwcmV2aW91c1BvaW50LmJvdHRvbS54O1xuICAgICAgdmVydGljZXNbMzYgKiBpICsgMjhdID0gcHJldmlvdXNQb2ludC5ib3R0b20ueTtcbiAgICAgIHZlcnRpY2VzWzM2ICogaSArIDI5XSA9IHByZXZpb3VzUG9pbnQuYm90dG9tLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgMzZdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDM3XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDM4XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgMzldID0gMC4wO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAzMF0gPSBjdXJyZW50UG9pbnQuYm90dG9tLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAzMV0gPSBjdXJyZW50UG9pbnQuYm90dG9tLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAzMl0gPSBjdXJyZW50UG9pbnQuYm90dG9tLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgNDBdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDQxXSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDQyXSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgNDNdID0gMC4wO1xuXG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAzM10gPSBjdXJyZW50UG9pbnQuY2VudGVyLng7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAzNF0gPSBjdXJyZW50UG9pbnQuY2VudGVyLnk7XG4gICAgICB2ZXJ0aWNlc1szNiAqIGkgKyAzNV0gPSBjdXJyZW50UG9pbnQuY2VudGVyLno7XG5cbiAgICAgIC8vIENvbG9yXG4gICAgICBjb2xvcnNbNDggKiBpICsgNDRdID0gY29sb3IucmVkO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDQ1XSA9IGNvbG9yLmdyZWVuO1xuICAgICAgY29sb3JzWzQ4ICogaSArIDQ2XSA9IGNvbG9yLmJsdWU7XG4gICAgICBjb2xvcnNbNDggKiBpICsgNDddID0gYWxwaGEgKiAwLjI7XG5cbiAgICAgIHByZXZpb3VzQWxwaGEgPSBhbHBoYTtcbiAgICB9XG5cbiAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy52ZXJ0ZXhDb2xvci5uZWVkc1VwZGF0ZSA9IHRydWU7XG4gIH0sXG5cbiAgc2FtcGxlU2FiZXJQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xuICAgIHZhciBzYWJlckVsID0gdGhpcy5zYWJlckVsO1xuICAgIHZhciBzYWJlck9iamVjdDtcbiAgICB2YXIgc2FtcGxlO1xuXG4gICAgaWYgKHRoaXMuc2FiZXJUcmFqZWN0b3J5Lmxlbmd0aCA9PT0gdGhpcy5tYXhQb2ludHMpIHtcbiAgICAgIC8vIER1bXAgb2xkZXN0IHBvaW50LlxuICAgICAgc2FtcGxlID0gdGhpcy5zYWJlclRyYWplY3Rvcnkuc2hpZnQoKTtcbiAgICAgIHNhbXBsZS50b3Auc2V0KDAsIC0wLjQsIDApO1xuICAgICAgc2FtcGxlLmNlbnRlci5zZXQoMCwgMCwgMCk7XG4gICAgICBzYW1wbGUuYm90dG9tLnNldCgwLCAwLjQsIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBzYW1wbGUgPSB7XG4gICAgICAgIHRvcDogbmV3IFRIUkVFLlZlY3RvcjMoMCwgLTAuNCwgMCksXG4gICAgICAgIGNlbnRlcjogbmV3IFRIUkVFLlZlY3RvcjMoMCwgMCwgMCksXG4gICAgICAgIGJvdHRvbTogbmV3IFRIUkVFLlZlY3RvcjMoMCwgMC40LCAwKVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBzYWJlck9iamVjdCA9IHNhYmVyRWwub2JqZWN0M0Q7XG5cbiAgICBzYWJlck9iamVjdC5wYXJlbnQudXBkYXRlTWF0cml4V29ybGQoKTtcbiAgICBzYWJlck9iamVjdC5sb2NhbFRvV29ybGQoc2FtcGxlLnRvcCk7XG4gICAgc2FiZXJPYmplY3QubG9jYWxUb1dvcmxkKHNhbXBsZS5jZW50ZXIpO1xuICAgIHNhYmVyT2JqZWN0LmxvY2FsVG9Xb3JsZChzYW1wbGUuYm90dG9tKTtcblxuICAgIHRoaXMuc2FiZXJUcmFqZWN0b3J5LnB1c2goc2FtcGxlKTtcblxuICAgIHRoaXMuaW5pdEdlb21ldHJ5KCk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdHJhaWwuanMiLCJBRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3R1dG9yaWFsLTJkJywge1xuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5zY2VuZUVsLmNhbnZhcy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnNjZW5lRWwuY2FudmFzLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dXRvcmlhbDJkJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgfVxufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29tcG9uZW50cy90dXRvcmlhbC0yZC5qcyIsImNvbnN0IE5VTV9WQUxVRVNfUEVSX1NFR01FTlQgPSA3NTtcblxuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd0d2lzdGVyJywge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7ZGVmYXVsdDogZmFsc2V9LFxuICAgIHR3aXN0OiB7ZGVmYXVsdDogMH0sXG4gICAgdmVydGljZXM6IHtkZWZhdWx0OiA0LCB0eXBlOiAnaW50J30sXG4gICAgY291bnQ6IHtkZWZhdWx0OiAxMiwgdHlwZTogJ2ludCd9LFxuICAgIHBvc2l0aW9uSW5jcmVtZW50OiB7ZGVmYXVsdDogMS40fSxcbiAgICByYWRpdXNJbmNyZW1lbnQ6IHtkZWZhdWx0OiAwLjQwfSxcbiAgICB0aGlja25lc3M6IHtkZWZhdWx0OiAwLjM3fVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmN1cnJlbnRUd2lzdCA9IDA7XG4gICAgdGhpcy5hbmltYXRlID0gZmFsc2U7XG4gICAgdGhpcy5nZW9tZXRyeSA9IG51bGw7XG4gIH0sXG5cbiAgcHVsc2U6IGZ1bmN0aW9uICh0d2lzdCkge1xuICAgIGlmICghdGhpcy5kYXRhLmVuYWJsZWQpIHsgcmV0dXJuOyB9XG4gICAgaWYgKHR3aXN0ID09IDApIHsgdHdpc3QgPSAwLjAzICsgTWF0aC5yYW5kb20oKSAqIDAuMjU7IH1cbiAgICBlbHNlIHR3aXN0ID0gTWF0aC5taW4odHdpc3QgKiAwLjQsIDAuNCk7XG4gICAgdHdpc3QgKj0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTsgLy8gcmFuZG9tIGRpcmVjdGlvblxuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCd0d2lzdGVyJywge3R3aXN0OiB0d2lzdH0pO1xuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKG9sZERhdGEpIHtcbiAgICB2YXIgcmFkaXVzID0gNjtcbiAgICB2YXIgc2VnbWVudHMgPSBbXTtcblxuICAgIGlmIChNYXRoLmFicyh0aGlzLmRhdGEudHdpc3QgLSB0aGlzLmN1cnJlbnRUd2lzdCkgPiAwLjAwMSkge1xuICAgICAgdGhpcy5hbmltYXRlID0gdHJ1ZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmNsZWFyKCk7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZGF0YS5jb3VudDsgaSsrKSB7XG4gICAgICBsZXQgc2VnbWVudCA9IHRoaXMuY3JlYXRlU2VnbWVudChyYWRpdXMpO1xuICAgICAgc2VnbWVudC50cmFuc2xhdGUoMCwgdGhpcy5kYXRhLnBvc2l0aW9uSW5jcmVtZW50ICogaSwgMCk7XG4gICAgICBzZWdtZW50cy5wdXNoKHNlZ21lbnQpO1xuICAgICAgcmFkaXVzICs9IHRoaXMuZGF0YS5yYWRpdXNJbmNyZW1lbnQ7XG4gICAgfVxuICAgIHRoaXMuZ2VvbWV0cnkgPSBUSFJFRS5CdWZmZXJHZW9tZXRyeVV0aWxzLm1lcmdlQnVmZmVyR2VvbWV0cmllcyhzZWdtZW50cyk7XG4gICAgdmFyIG1hdGVyaWFsID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMubWF0ZXJpYWxzLnN0YWdlTm9ybWFsO1xuICAgIHZhciBtZXNoID0gbmV3IFRIUkVFLk1lc2godGhpcy5nZW9tZXRyeSwgbWF0ZXJpYWwpO1xuICAgIHRoaXMuZWwub2JqZWN0M0QuYWRkKG1lc2gpO1xuICB9LFxuXG4gIGNyZWF0ZVNlZ21lbnQ6IGZ1bmN0aW9uIChyYWRpdXMpIHtcbiAgICBjb25zdCBSID0gdGhpcy5kYXRhLnRoaWNrbmVzcztcbiAgICB2YXIgZ2VvbWV0cnk7XG4gICAgdmFyIHBvaW50cyA9IFtcbiAgICAgIG5ldyBUSFJFRS5WZWN0b3IyKHJhZGl1cyAtIFIsIFIpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjIocmFkaXVzIC0gUiwgLVIpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjIocmFkaXVzICsgUiwgLVIpLFxuICAgICAgbmV3IFRIUkVFLlZlY3RvcjIocmFkaXVzICsgUiwgUiksXG4gICAgICBuZXcgVEhSRUUuVmVjdG9yMihyYWRpdXMgLSBSLCBSKVxuICAgIF07XG4gICAgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuTGF0aGVCdWZmZXJHZW9tZXRyeShwb2ludHMsIHRoaXMuZGF0YS52ZXJ0aWNlcyk7XG4gICAgLy8gbW92ZSB1dnMgdG8gYSBzcGVjaWZpYyBwb2ludCBpbiBhdGxhcy5wbmdcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdlb21ldHJ5LmF0dHJpYnV0ZXMudXYuYXJyYXkubGVuZ3RoOyBpICs9IDIpIHtcbiAgICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXMudXYuYXJyYXlbaV0gPSAwLjc3O1xuICAgICAgZ2VvbWV0cnkuYXR0cmlidXRlcy51di5hcnJheVtpICsgMV0gPSAwLjAwMTtcbiAgICB9XG4gICAgcmV0dXJuIGdlb21ldHJ5O1xuICB9LFxuXG4gIGNsZWFyOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC5yZW1vdmUodGhpcy5lbC5vYmplY3QzRC5jaGlsZHJlblswXSk7XG4gICAgaWYgKHRoaXMuZ2VvbWV0cnkpIHRoaXMuZ2VvbWV0cnkuZGlzcG9zZSgpO1xuICAgIHRoaXMuZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQnVmZmVyR2VvbWV0cnkoKTtcbiAgfSxcblxuICB0aWNrOiBmdW5jdGlvbiAodGltZSwgZGVsdGEpIHtcbiAgICBpZiAoIXRoaXMuYW5pbWF0ZSkgeyByZXR1cm47IH1cblxuICAgIHZhciBwb3NBcnJheSA9IHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTtcbiAgICB2YXIgcm90YXRpb247XG4gICAgdmFyIHgsIHk7XG4gICAgdmFyIHNpbiwgY29zO1xuICAgIHZhciBkaWZmO1xuXG4gICAgZGVsdGEgKj0gMC4wMDE7XG5cbiAgICBkaWZmID0gKHRoaXMuZGF0YS50d2lzdCAtIHRoaXMuY3VycmVudFR3aXN0KSAqIGRlbHRhO1xuXG4gICAgdGhpcy5jdXJyZW50VHdpc3QgKz0gZGlmZjtcbiAgICByb3RhdGlvbiA9IGRpZmYgKiAzLjA7XG5cbiAgICBmb3IgKHZhciBzID0gMDsgcyA8IHRoaXMuZGF0YS5jb3VudDsgcysrKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE5VTV9WQUxVRVNfUEVSX1NFR01FTlQ7IGkgKz0gMykge1xuICAgICAgICBjb3MgPSBNYXRoLmNvcyhyb3RhdGlvbik7XG4gICAgICAgIHNpbiA9IE1hdGguc2luKHJvdGF0aW9uKTtcbiAgICAgICAgeCA9IHBvc0FycmF5W3MgKiBOVU1fVkFMVUVTX1BFUl9TRUdNRU5UICsgaV07XG4gICAgICAgIHkgPSBwb3NBcnJheVtzICogTlVNX1ZBTFVFU19QRVJfU0VHTUVOVCArIGkgKyAyXTtcbiAgICAgICAgcG9zQXJyYXlbcyAqIE5VTV9WQUxVRVNfUEVSX1NFR01FTlQgKyBpXSA9IHggKiBjb3MgLSB5ICogc2luO1xuICAgICAgICBwb3NBcnJheVtzICogTlVNX1ZBTFVFU19QRVJfU0VHTUVOVCArIGkgKyAyXSA9IHkgKiBjb3MgKyB4ICogc2luO1xuICAgICAgfVxuICAgICAgcm90YXRpb24gKj0gMS4wNTtcbiAgICB9XG4gICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTtcblxuICAgIGlmIChNYXRoLmFicyh0aGlzLmRhdGEudHdpc3QgLSB0aGlzLmN1cnJlbnRUd2lzdCkgPCAwLjAwMSl7XG4gICAgICB0aGlzLmFuaW1hdGUgPSBmYWxzZTtcbiAgICB9XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvdHdpc3Rlci5qcyIsInZhciBjb2xvckhlbHBlciA9IG5ldyBUSFJFRS5Db2xvcigpO1xuXG4vKipcbiAqIFNldCBnZW9tZXRyeSB2ZXJ0ZXggY29sb3JzLCBhbGxvd3MgZm9yIGdlb21ldHJ5IG1lcmdpbmcgdXNpbmcgb25lIG1hdGVyaWFsXG4gKiB3aGlsZSByZXRhaW5pbmcgY29sb3JzLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3ZlcnRleC1jb2xvcnMtYnVmZmVyJywge1xuICBzY2hlbWE6IHtcbiAgICBiYXNlQ29sb3I6IHt0eXBlOiAnY29sb3InfSxcbiAgICBpdGVtU2l6ZToge2RlZmF1bHQ6IDN9XG4gIH0sXG5cbiAgdXBkYXRlOiBmdW5jdGlvbiAob2xkRGF0YSkge1xuICAgIHZhciBjb2xvcnM7XG4gICAgdmFyIGRhdGEgPSB0aGlzLmRhdGE7XG4gICAgdmFyIGk7XG4gICAgdmFyIGVsID0gdGhpcy5lbDtcbiAgICB2YXIgZ2VvbWV0cnk7XG4gICAgdmFyIG1lc2g7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgbWVzaCA9IHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKTtcblxuICAgIGlmICghbWVzaCB8fCAhbWVzaC5nZW9tZXRyeSkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignb2JqZWN0M2RzZXQnLCBmdW5jdGlvbiByZVVwZGF0ZSAoZXZ0KSB7XG4gICAgICAgIGlmIChldnQuZGV0YWlsLnR5cGUgIT09ICdtZXNoJykgeyByZXR1cm47IH1cbiAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignb2JqZWN0M2RzZXQnLCByZVVwZGF0ZSk7XG4gICAgICAgIHNlbGYudXBkYXRlKG9sZERhdGEpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZ2VvbWV0cnkgPSBtZXNoLmdlb21ldHJ5O1xuXG4gICAgLy8gRW1wdHkgZ2VvbWV0cnkuXG4gICAgaWYgKCFnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0dlb21ldHJ5IGhhcyBubyB2ZXJ0aWNlcycsIGVsKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIWdlb21ldHJ5LmF0dHJpYnV0ZXMuY29sb3IpIHtcbiAgICAgIGdlb21ldHJ5LmFkZEF0dHJpYnV0ZSgnY29sb3InLFxuICAgICAgICBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKFxuICAgICAgICAgIG5ldyBGbG9hdDMyQXJyYXkoZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheS5sZW5ndGgpLCAzXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29sb3JzID0gZ2VvbWV0cnkuYXR0cmlidXRlcy5jb2xvci5hcnJheTtcblxuICAgIC8vIFRPRE86IEZvciBzb21lIHJlYXNvbiwgaW5jcmVtZW50aW5nIGxvb3AgYnkgMyBkb2Vzbid0IHdvcmsuIE5lZWQgdG8gZG8gYnkgNCBmb3IgZ2xURi5cbiAgICBjb2xvckhlbHBlci5zZXQoZGF0YS5iYXNlQ29sb3IpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBjb2xvcnMubGVuZ3RoOyBpICs9IGRhdGEuaXRlbVNpemUpIHtcbiAgICAgIGNvbG9yc1tpXSA9IGNvbG9ySGVscGVyLnI7XG4gICAgICBjb2xvcnNbaSArIDFdID0gY29sb3JIZWxwZXIuZztcbiAgICAgIGNvbG9yc1tpICsgMl0gPSBjb2xvckhlbHBlci5iO1xuICAgIH1cblxuICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXMuY29sb3IubmVlZHNVcGRhdGUgPSB0cnVlO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3ZlcnRleC1jb2xvcnMtYnVmZmVyLmpzIiwiLyoqXG4gKiBUcmlnZ2VyIGFjY3VyYWN5IHJpbmcgYW5pbWF0aW9uIG9uIHZpY3Rvcnkgc2NyZWVuLlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3ZpY3RvcnktYWNjdXJhY3ktcmluZycsIHtcbiAgZGVwZW5kZW5jaWVzOiBbJ2dlb21ldHJ5JywgJ21hdGVyaWFsJ10sXG5cbiAgc2NoZW1hOiB7XG4gICAgYWNjdXJhY3k6IHtkZWZhdWx0OiAwfVxuICB9LFxuXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuZ2V0T2JqZWN0M0QoJ21lc2gnKS5tYXRlcmlhbC51bmlmb3Jtcy5wcm9ncmVzcy52YWx1ZSA9IDA7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ2FuaW1hdGlvbicsICd0bycsIHRoaXMuZGF0YS5hY2N1cmFjeSAvIDEwMCk7XG4gICAgdGhpcy5lbC5jb21wb25lbnRzWydhbmltYXRpb24nXS5iZWdpbkFuaW1hdGlvbigpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3ZpY3RvcnktYWNjdXJhY3ktcmluZy5qcyIsIi8qKlxuICogUmFuayBjb2xvci5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd2aWN0b3J5LXJhbmsnLCB7XG4gIHNjaGVtYToge1xuICAgIHJhbms6IHt0eXBlOiAnc3RyaW5nJ31cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCByYW5rID0gdGhpcy5kYXRhLnJhbms7XG4gICAgaWYgKCFyYW5rKSB7IHJldHVybjsgfVxuXG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3RleHQnLCAndmFsdWUnLCByYW5rKTtcbiAgICBzd2l0Y2ggKHJhbmtbMF0pIHtcbiAgICAgIGNhc2UgJ1MnOiB7XG4gICAgICAgIHRoaXMuc2V0Q29sb3IoJyNGRkYnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdBJzoge1xuICAgICAgICB0aGlzLnNldENvbG9yKCcjYzJkMDc2Jyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnQic6IHtcbiAgICAgICAgdGhpcy5zZXRDb2xvcignIzIzZjBjNycpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgJ0MnOiB7XG4gICAgICAgIHRoaXMuc2V0Q29sb3IoJyNmZmUzNDcnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlICdEJzoge1xuICAgICAgICB0aGlzLnNldENvbG9yKCcjY2U2YzQ3Jyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSAnRic6IHtcbiAgICAgICAgdGhpcy5zZXRDb2xvcignIzk2MDIwMCcpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH0sXG5cbiAgc2V0Q29sb3I6IGZ1bmN0aW9uIChjb2xvcikge1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCd0ZXh0JywgJ2NvbG9yJywgY29sb3IpO1xuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3ZpY3RvcnktcmFuay5qcyIsIi8qKlxuICogQ291cGxlIHZpc2liaWxpdHkgYW5kIHJheWNhc3RhYmlsaXR5LlxuICovXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoJ3Zpc2libGUtcmF5Y2FzdGFibGUnLCB7XG4gIHNjaGVtYToge1xuICAgIGRlZmF1bHQ6IHRydWVcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLm9iamVjdDNELnZpc2libGUgPSB0aGlzLmRhdGE7XG4gICAgaWYgKHRoaXMuZGF0YSkge1xuICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ3JheWNhc3RhYmxlJywgJycpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVsLnJlbW92ZUF0dHJpYnV0ZSgncmF5Y2FzdGFibGUnLCAnJyk7XG4gICAgfVxuICB9XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3Zpc2libGUtcmF5Y2FzdGFibGUuanMiLCJjb25zdCBDT0xPUlMgPSByZXF1aXJlKCcuLi9jb25zdGFudHMvY29sb3JzLmpzJyk7XG5cbmNvbnN0IFdBTExfQ09MT1IgPSBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLk5FT05fUkVEKTtcbmNvbnN0IFdBTExfQkcgPSBuZXcgVEhSRUUuQ29sb3IoQ09MT1JTLlNLWV9SRUQpO1xuXG5cbkFGUkFNRS5yZWdpc3RlclNoYWRlcignd2FsbFNoYWRlcicsIHtcbiAgc2NoZW1hOiB7XG4gICAgaVRpbWU6IHt0eXBlOiAndGltZScsIGlzOiAndW5pZm9ybSd9LFxuICAgIGhpdFJpZ2h0OiB7dHlwZTogJ3ZlYzMnLCBpczogJ3VuaWZvcm0nLCBkZWZhdWx0OiB7eDogMCwgeTogMSwgejogMH19LFxuICAgIGhpdExlZnQ6IHt0eXBlOiAndmVjMycsIGlzOiAndW5pZm9ybScsIGRlZmF1bHQ6IHt4OiAwLCB5OiAwLCB6OiAwfX1cbiAgfSxcblxuICB2ZXJ0ZXhTaGFkZXI6IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXZzO1xuICAgIHZhcnlpbmcgdmVjMyBucm1sO1xuICAgIHZhcnlpbmcgdmVjMyB3b3JsZFBvcztcbiAgICB2b2lkIG1haW4oKSB7XG4gICAgICB1dnMueHkgPSB1di54eTtcbiAgICAgIG5ybWwueHl6ID0gbm9ybWFsLnh5ejtcbiAgICAgIHZlYzQgcCA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XG4gICAgICB3b3JsZFBvcyA9IChtb2RlbE1hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKSkueHl6O1xuICAgICAgZ2xfUG9zaXRpb24gPSBwO1xuICAgIH1cbiAgYCxcblxuICBmcmFnbWVudFNoYWRlcjogYFxuICAgIHZhcnlpbmcgdmVjMiB1dnM7XG4gICAgdmFyeWluZyB2ZWMzIG5ybWw7XG4gICAgdmFyeWluZyB2ZWMzIHdvcmxkUG9zO1xuICAgIHVuaWZvcm0gZmxvYXQgaVRpbWU7XG4gICAgLy91bmlmb3JtIHNhbXBsZXIyRCBlbnY7XG4gICAgdW5pZm9ybSB2ZWMzIGhpdFJpZ2h0O1xuICAgIHVuaWZvcm0gdmVjMyBoaXRMZWZ0O1xuXG4gICAgI2RlZmluZSBTRUVEIDE5LjEyNTRcbiAgICAjZGVmaW5lIHRpbWUgKDMuMCArIGlUaW1lKS8xMDAwLjAgKiAwLjE1XG5cbiAgICBmbG9hdCBub2lzZSh2ZWMzIHV2KSB7XG4gICAgICByZXR1cm4gZnJhY3Qoc2luKHV2LngqMTIzMjQzLiArIHV2LnkqNDI0LiArIHV2LnoqNjQyLiArIFNFRUQpICogMTUyNC4pO1xuICAgIH1cblxuICAgIHZlYzMgZHJhd0NpcmNsZSh2ZWMzIHAsIHZlYzMgY2VudGVyLCBmbG9hdCByYWRpdXMsIGZsb2F0IGVkZ2VXaWR0aCwgdmVjMyBjb2xvcikge1xuICAgICAgcmV0dXJuIGNvbG9yICogKDEuMCAtIHNtb290aHN0ZXAocmFkaXVzLCByYWRpdXMgKyBlZGdlV2lkdGgsIGxlbmd0aChwIC0gY2VudGVyKSkpO1xuICAgIH1cblxuICAgIGZsb2F0IHNtb290aE5vaXNlKHZlYzMgdXZ3LCBmbG9hdCBmcmVjKXtcbiAgICAgIHZlYzMgbHV2dyA9IHZlYzMoc21vb3Roc3RlcCgwLjAsIDEuMCwgZnJhY3QodXZ3Lnh5ICogZnJlYykpLCBmcmFjdCh1dncueiAqIGZyZWMpKTtcbiAgICAgIHZlYzMgaWQgPSBmbG9vcih1dncgKiBmcmVjKTtcbiAgICAgIGZsb2F0IGJsdCA9IG5vaXNlKGlkKTtcbiAgICAgIGZsb2F0IGJydCA9IG5vaXNlKGlkICsgdmVjMygxLjAsIDAuMCwgMC4wKSk7XG4gICAgICBmbG9hdCB0bHQgPSBub2lzZShpZCArIHZlYzMoMC4wLCAxLjAsIDAuMCkpO1xuICAgICAgZmxvYXQgdHJ0ID0gbm9pc2UoaWQgKyB2ZWMzKDEuMCwgMS4wLCAwLjApKTtcblxuICAgICAgZmxvYXQgYmxiID0gbm9pc2UoaWQgKyB2ZWMzKDAuMCwgMC4wLCAxLjApKTtcbiAgICAgIGZsb2F0IGJyYiA9IG5vaXNlKGlkICsgdmVjMygxLjAsIDAuMCwgMS4wKSk7XG4gICAgICBmbG9hdCB0bGIgPSBub2lzZShpZCArIHZlYzMoMC4wLCAxLjAsIDEuMCkpO1xuICAgICAgZmxvYXQgdHJiID0gbm9pc2UoaWQgKyB2ZWMzKDEuMCwgMS4wLCAxLjApKTtcblxuICAgICAgZmxvYXQgYSA9IG1peChibHQsIGJydCwgbHV2dy54KTtcbiAgICAgIGZsb2F0IGIgPSBtaXgodGx0LCB0cnQsIGx1dncueCk7XG4gICAgICBmbG9hdCBjID0gbWl4KGEsIGIsIGx1dncueSk7XG5cbiAgICAgIGZsb2F0IGQgPSBtaXgoYmxiLCBicmIsIGx1dncueCk7XG4gICAgICBmbG9hdCBlID0gbWl4KHRsYiwgdHJiLCBsdXZ3LngpO1xuICAgICAgZmxvYXQgZiA9IG1peChkLCBlLCBsdXZ3LnkpO1xuXG4gICAgICByZXR1cm4gbWl4KGMsIGYsIGx1dncueik7XG4gICAgfVxuXG4gICAgI2RlZmluZSBXQUxMX0NPTE9SIHZlYzMoJHtXQUxMX0NPTE9SLnJ9LCAke1dBTExfQ09MT1IuZ30sICR7V0FMTF9DT0xPUi5ifSlcbiAgICAjZGVmaW5lIFdBTExfQkcgdmVjMygke1dBTExfQkcucn0sICR7V0FMTF9CRy5nfSwgJHtXQUxMX0JHLmJ9KVxuXG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgdmVjMiB1djEgPSB1dnMueHktMC41O1xuICAgICAgZmxvYXQgYW5nbGUgPSB0aW1lIC8gMTAuMDtcbiAgICAgIHZlYzIgdXY7XG4gICAgICB1di54ID0gdXYxLnggKiBjb3MoYW5nbGUpIC0gdXYxLnkgKiBzaW4oYW5nbGUpO1xuICAgICAgdXYueSA9IHV2MS55ICogY29zKGFuZ2xlKSArIHV2MS54ICogc2luKGFuZ2xlKTtcbiAgICAgIHV2LnggKz0gc2luKHV2LnkgKiAyLjcgKyB0aW1lIC8gMS43KSAqIDAuMjtcbiAgICAgIHV2LnkgKz0gc2luKHV2LnggKiAzLjEgKyB0aW1lIC8gMi40KSAqIDAuMztcblxuICAgICAgZmxvYXQgdywgciwgYmc7XG4gICAgICByID0gc21vb3RoTm9pc2UodmVjMyh1diArIHdvcmxkUG9zLngsIHRpbWUgLyAyLjApLCAzLjApICogMC42NTtcbiAgICAgIHIgKz0gc21vb3RoTm9pc2UodmVjMyh1diwgdGltZSAvIDYuMCksIDguMCkgKiAwLjM7XG4gICAgICByICs9IHNtb290aE5vaXNlKHZlYzModXYsIHRpbWUgLyAxNC4wKSwgNTAuMCkgKiAwLjA0O1xuXG4gICAgICBiZyA9IHNtb290aHN0ZXAoMC41LCAxLjAsIHIpICsgc21vb3Roc3RlcCgwLjUsIDAuMCwgcik7XG4gICAgICByID0gc21vb3Roc3RlcCgwLjQsIDAuNTAsIHIpIC0gc21vb3Roc3RlcCgwLjUwLCAwLjYsIHIpO1xuICAgICAgdyA9IHNtb290aHN0ZXAoMC45NywgMS4wLCByKTtcblxuXG4gICAgICByICs9IHNtb290aHN0ZXAoMC40NCwgMC41MCwgYWJzKHV2MS54KSk7XG4gICAgICByICs9IHNtb290aHN0ZXAoMC40NCwgMC41MCwgYWJzKHV2MS55KSk7XG5cbiAgICAgIHcgKz0gc21vb3Roc3RlcCgwLjQ5LCAwLjQ5OCwgYWJzKHV2MS54KSk7XG4gICAgICB3ICs9IHNtb290aHN0ZXAoMC40OSwgMC40OTgsIGFicyh1djEueSkpO1xuXG4gICAgICB3ICo9IDAuOTtcbiAgICAgIGJnICo9IDAuNTtcblxuICAgICAgdmVjMyBDT0wgPSBXQUxMX0NPTE9SO1xuICAgICAgdmVjMyBCRyA9IFdBTExfQkcgKiAwLjE7XG5cbiAgICAgIHZlYzMgY29sID0gdmVjMyhyICogQ09MLnIgKyB3ICsgQkcuciwgciAqIENPTC5nICsgdyArIEJHLmcsIHIgKiBDT0wuYiArIHcgKyBCRy5iKTtcblxuICAgICAgdmVjMyBoaXQ7XG4gICAgICBoaXQgPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRSaWdodCwgMC4wNCwgMC4wNSwgQ09MKTtcbiAgICAgIGhpdCArPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRSaWdodCwgMC4wMiwgMC4wMywgdmVjMygwLjcsIDAuNywgMC43KSk7XG4gICAgICBoaXQgKz0gZHJhd0NpcmNsZSh3b3JsZFBvcywgaGl0TGVmdCwgMC4wNCwgMC4wNSwgQ09MKTtcbiAgICAgIGhpdCArPSBkcmF3Q2lyY2xlKHdvcmxkUG9zLCBoaXRMZWZ0LCAwLjAyLCAwLjAzLCB2ZWMzKDAuNywgMC43LCAwLjcpKTtcblxuICAgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNChjb2wgKyBoaXQsIDAuNyArIHcgKyBoaXQueCk7XG4gICAgfVxuYFxuXG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb21wb25lbnRzL3dhbGwtc2hhZGVyLmpzIiwiaW1wb3J0IHtCRUFUX1dBUk1VUF9PRkZTRVQsIEJFQVRfV0FSTVVQX1NQRUVELCBCRUFUX1dBUk1VUF9USU1FfSBmcm9tICcuLi9jb25zdGFudHMvYmVhdCc7XG5cbi8vIFNvIHdhbGwgZG9lcyBub3QgY2xpcCB0aGUgc3RhZ2UgZ3JvdW5kLlxuY29uc3QgUkFJU0VfWV9PRkZTRVQgPSAwLjE7XG5cbmNvbnN0IFdBTExfVEhJQ0tORVNTID0gMC41MDtcbmNvbnN0IENFSUxJTkdfVEhJQ0tORVNTID0gMS41O1xuY29uc3QgQ0VJTElOR19IRUlHSFQgPSAxLjQgKyBDRUlMSU5HX1RISUNLTkVTUyAvIDI7XG5cbi8qKlxuICogV2FsbCB0byBkb2RnZS5cbiAqL1xuQUZSQU1FLnJlZ2lzdGVyQ29tcG9uZW50KCd3YWxsJywge1xuICBzY2hlbWE6IHtcbiAgICBhbnRpY2lwYXRpb25Qb3NpdGlvbjoge2RlZmF1bHQ6IDB9LFxuICAgIGR1cmF0aW9uU2Vjb25kczoge2RlZmF1bHQ6IDB9LFxuICAgIGhlaWdodDoge2RlZmF1bHQ6IDEuM30sXG4gICAgaG9yaXpvbnRhbFBvc2l0aW9uOiB7ZGVmYXVsdDogJ21pZGRsZWxlZnQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgIG9uZU9mOiBbJ2xlZnQnLCAnbWlkZGxlbGVmdCcsICdtaWRkbGVyaWdodCcsICdyaWdodCddfSxcbiAgICBpc0NlaWxpbmc6IHtkZWZhdWx0OiBmYWxzZX0sXG4gICAgc3BlZWQ6IHtkZWZhdWx0OiAxLjB9LFxuICAgIHdhcm11cFBvc2l0aW9uOiB7ZGVmYXVsdDogMH0sXG4gICAgd2lkdGg6IHtkZWZhdWx0OiAxfVxuICB9LFxuXG4gIGhvcml6b250YWxQb3NpdGlvbnM6IHtcbiAgICBsZWZ0OiAtMC43NSxcbiAgICBtaWRkbGVsZWZ0OiAtMC4yNSxcbiAgICBtaWRkbGVyaWdodDogMC4yNSxcbiAgICByaWdodDogMC43NVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLm1heFogPSAxMDtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBlbCA9IHRoaXMuZWw7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBjb25zdCB3aWR0aCA9IGRhdGEud2lkdGggKiBXQUxMX1RISUNLTkVTUztcblxuICAgIGNvbnN0IGhhbGZEZXB0aCA9IGRhdGEuZHVyYXRpb25TZWNvbmRzICogZGF0YS5zcGVlZCAvIDI7XG5cbiAgICBpZiAoZGF0YS5pc0NlaWxpbmcpIHtcbiAgICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLnNldChcbiAgICAgICAgMCxcbiAgICAgICAgQ0VJTElOR19IRUlHSFQsXG4gICAgICAgIGRhdGEuYW50aWNpcGF0aW9uUG9zaXRpb24gKyBkYXRhLndhcm11cFBvc2l0aW9uIC0gaGFsZkRlcHRoXG4gICAgICApO1xuICAgICAgZWwub2JqZWN0M0Quc2NhbGUuc2V0KFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgQ0VJTElOR19USElDS05FU1MsXG4gICAgICAgIGRhdGEuZHVyYXRpb25TZWNvbmRzICogZGF0YS5zcGVlZFxuICAgICAgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBCb3ggZ2VvbWV0cnkgaXMgY29uc3RydWN0ZWQgZnJvbSB0aGUgbG9jYWwgMCwwLDAgZ3Jvd2luZyBpbiB0aGUgcG9zaXRpdmUgYW5kIG5lZ2F0aXZlXG4gICAgLy8geCBhbmQgeiBheGlzLiBXZSBoYXZlIHRvIHNoaWZ0IGJ5IGhhbGYgd2lkdGggYW5kIGRlcHRoIHRvIGJlIHBvc2l0aW9uZWQgY29ycmVjdGx5LlxuICAgIGVsLm9iamVjdDNELnBvc2l0aW9uLnNldChcbiAgICAgIHRoaXMuaG9yaXpvbnRhbFBvc2l0aW9uc1tkYXRhLmhvcml6b250YWxQb3NpdGlvbl0gKyB3aWR0aCAvIDIgIC0gMC4yNSxcbiAgICAgIGRhdGEuaGVpZ2h0ICsgUkFJU0VfWV9PRkZTRVQsXG4gICAgICBkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uICsgZGF0YS53YXJtdXBQb3NpdGlvbiAtIGhhbGZEZXB0aFxuICAgICk7XG4gICAgZWwub2JqZWN0M0Quc2NhbGUuc2V0KFxuICAgICAgd2lkdGgsXG4gICAgICAyLjUsXG4gICAgICBkYXRhLmR1cmF0aW9uU2Vjb25kcyAqIGRhdGEuc3BlZWRcbiAgICApO1xuICB9LFxuXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5lbC5vYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5lbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtY29sbGlkYWJsZS1oZWFkJyk7XG4gIH0sXG5cbiAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwub2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtY29sbGlkYWJsZS1oZWFkJywgJycpO1xuICAgIHRoaXMuZWwuc2V0QXR0cmlidXRlKCdkYXRhLXNhYmVyLXBhcnRpY2xlcycsICcnKTtcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSgncmF5Y2FzdGFibGUtZ2FtZScsICcnKTtcbiAgfSxcblxuICB0b2NrOiBmdW5jdGlvbiAodGltZSwgdGltZURlbHRhKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICBjb25zdCBoYWxmRGVwdGggPSBkYXRhLmR1cmF0aW9uU2Vjb25kcyAqIGRhdGEuc3BlZWQgLyAyO1xuICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbjtcblxuICAgIC8vIE1vdmUuXG4gICAgaWYgKHBvc2l0aW9uLnogPCAoZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbiAtIGhhbGZEZXB0aCkpIHtcbiAgICAgIGxldCBuZXdQb3NpdGlvblogPSBwb3NpdGlvbi56ICsgQkVBVF9XQVJNVVBfU1BFRUQgKiAodGltZURlbHRhIC8gMTAwMCk7XG4gICAgICAvLyBXYXJtIHVwIC8gd2FycCBpbi5cbiAgICAgIGlmIChuZXdQb3NpdGlvblogPCAoZGF0YS5hbnRpY2lwYXRpb25Qb3NpdGlvbiAtIGhhbGZEZXB0aCkpIHtcbiAgICAgICAgcG9zaXRpb24ueiA9IG5ld1Bvc2l0aW9uWjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBvc2l0aW9uLnogPSBkYXRhLmFudGljaXBhdGlvblBvc2l0aW9uIC0gaGFsZkRlcHRoO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTdGFuZGFyZCBtb3ZpbmcuXG4gICAgICBwb3NpdGlvbi56ICs9IHRoaXMuZGF0YS5zcGVlZCAqICh0aW1lRGVsdGEgLyAxMDAwKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbi56ID4gKHRoaXMubWF4WiArIGhhbGZEZXB0aCkpIHtcbiAgICAgIHRoaXMucmV0dXJuVG9Qb29sKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9LFxuXG4gIHJldHVyblRvUG9vbDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwuc2NlbmVFbC5jb21wb25lbnRzLnBvb2xfX3dhbGwucmV0dXJuRW50aXR5KHRoaXMuZWwpO1xuICAgIHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24ueiA9IDk5OTk7XG4gICAgdGhpcy5lbC5wYXVzZSgpO1xuICAgIHRoaXMuZWwucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWNvbGxpZGFibGUtaGVhZCcpO1xuICAgIHRoaXMuZWwucmVtb3ZlQXR0cmlidXRlKCdyYXljYXN0YWJsZS1nYW1lJyk7XG4gIH1cbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2NvbXBvbmVudHMvd2FsbC5qcyIsIm1vZHVsZS5leHBvcnRzID0gW1xuICB7bmFtZTogJ1BvcCcsIHJvdzogMSwgY29sdW1uOiAxfSxcbiAge25hbWU6ICdSJkInLCByb3c6IDEsIGNvbHVtbjogMn0sXG4gIHtuYW1lOiAnUmFwJywgcm93OiAxLCBjb2x1bW46IDN9LFxuICB7bmFtZTogJ1JvY2snLCByb3c6IDEsIGNvbHVtbjogNH0sXG4gIHtuYW1lOiAnU291bmR0cmFjaycsIHJvdzogMSwgY29sdW1uOiA1fSxcbiAge25hbWU6ICdWaWRlbyBHYW1lcycsIHJvdzogMSwgY29sdW1uOiA2fSxcblxuICB7bmFtZTogJ0VsZWN0cm9uaWMnLCByb3c6IDIsIGNvbHVtbjogMX0sXG4gIHtuYW1lOiAnSGlwIEhvcCcsIHJvdzogMiwgY29sdW1uOiAyfSxcbiAge25hbWU6ICdIb3VzZScsIHJvdzogMiwgY29sdW1uOiAzfSxcbiAge25hbWU6ICdKLVBvcCcsIHJvdzogMiwgY29sdW1uOiA0fSxcbiAge25hbWU6ICdLLVBvcCcsIHJvdzogMiwgY29sdW1uOiA1fSxcbiAge25hbWU6ICdNZW1lJywgcm93OiAyLCBjb2x1bW46IDZ9LFxuXG4gIHtuYW1lOiAnQWx0ZXJuYXRpdmUnLCByb3c6IDMsIGNvbHVtbjogMX0sXG4gIHtuYW1lOiAnQW5pbWUnLCByb3c6IDMsIGNvbHVtbjogMn0sXG4gIHtuYW1lOiAnQ29tZWR5Jywgcm93OiAzLCBjb2x1bW46IDN9LFxuICB7bmFtZTogJ0Rpc25leScsIHJvdzogMywgY29sdW1uOiA0fSxcbiAge25hbWU6ICdEdWJzdGVwJywgcm93OiAzLCBjb2x1bW46IDV9LFxuICB7bmFtZTogJ0VETScsIHJvdzogMywgY29sdW1uOiA2fVxuXTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9jb25zdGFudHMvZ2VucmVzLmpzIiwiZnVuY3Rpb24gcmVxdWlyZUFsbCAocmVxKSB7IHJlcS5rZXlzKCkuZm9yRWFjaChyZXEpOyB9XG5cbnJlcXVpcmUoJy4uL3ZlbmRvci9CdWZmZXJHZW9tZXRyeVV0aWxzJyk7XG5cbnJlcXVpcmUoJ2FmcmFtZS1hYWJiLWNvbGxpZGVyLWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLWF0bGFzLXV2cy1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1hdWRpb2FuYWx5c2VyLWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLWV2ZW50LXNldC1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1nZW9tZXRyeS1tZXJnZXItY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtaGFwdGljcy1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1sYXlvdXQtY29tcG9uZW50Jyk7XG5yZXF1aXJlKCdhZnJhbWUtb3JiaXQtY29udHJvbHMnKTtcbnJlcXVpcmUoJ2FmcmFtZS1wcm94eS1ldmVudC1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS1yaW5nLXNoYWRlcicpO1xucmVxdWlyZSgnYWZyYW1lLXN0YXRlLWNvbXBvbmVudCcpO1xucmVxdWlyZSgnYWZyYW1lLXNsaWNlOS1jb21wb25lbnQnKTtcbnJlcXVpcmUoJ2FmcmFtZS10aHVtYi1jb250cm9scy1jb21wb25lbnQnKTtcblxucmVxdWlyZUFsbChyZXF1aXJlLmNvbnRleHQoJy4vY29tcG9uZW50cy8nLCB0cnVlLCAvXFwuanMkLykpO1xucmVxdWlyZUFsbChyZXF1aXJlLmNvbnRleHQoJy4vc3RhdGUvJywgdHJ1ZSwgL1xcLmpzJC8pKTtcblxucmVxdWlyZSgnLi9pbmRleC5jc3MnKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC5qcyIsIi8qIGdsb2JhbCBBdWRpbyAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBTb3VuZFBvb2wgKHNyYywgdm9sdW1lKSB7XG4gIHZhciBjdXJyU291bmQgPSAwO1xuICB2YXIgcG9vbCA9IFtdO1xuICB2YXIgc291bmQ7XG5cbiAgc291bmQgPSBuZXcgQXVkaW8oc3JjKTtcbiAgc291bmQudm9sdW1lID0gdm9sdW1lO1xuICBwb29sLnB1c2goc291bmQpO1xuXG4gIHJldHVybiB7XG4gICAgcGxheTogZnVuY3Rpb24gKCkge1xuICAgICAgLy8gRHluYW1pYyBzaXplIHBvb2wuXG4gICAgICBpZiAocG9vbFtjdXJyU291bmRdLmN1cnJlbnRUaW1lICE9PSAwIHx8ICFwb29sW2N1cnJTb3VuZF0uZW5kZWQpIHtcbiAgICAgICAgc291bmQgPSBuZXcgQXVkaW8oc3JjKTtcbiAgICAgICAgc291bmQudm9sdW1lID0gdm9sdW1lO1xuICAgICAgICBwb29sLnB1c2goc291bmQpO1xuICAgICAgICBjdXJyU291bmQrKztcbiAgICAgIH1cblxuICAgICAgaWYgKHBvb2xbY3VyclNvdW5kXS5jdXJyZW50VGltZSA9PT0gMCB8fCBwb29sW2N1cnJTb3VuZF0uZW5kZWQpIHtcbiAgICAgICAgcG9vbFtjdXJyU291bmRdLnBsYXkoKTtcbiAgICAgIH1cbiAgICAgIGN1cnJTb3VuZCA9IChjdXJyU291bmQgKyAxKSAlIHBvb2wubGVuZ3RoO1xuICAgIH1cbiAgfTtcbn07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvbGliL3NvdW5kcG9vbC5qcyIsIi8qIGdsb2JhbCBsb2NhbFN0b3JhZ2UgKi9cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbmNvbnN0IGNoYWxsZW5nZURhdGFTdG9yZSA9IHt9O1xuY29uc3QgTlVNX0xFQURFUkJPQVJEX0RJU1BMQVkgPSAxMDtcbmNvbnN0IFNFQVJDSF9QRVJfUEFHRSA9IDY7XG5jb25zdCBTT05HX05BTUVfVFJVTkNBVEUgPSAyNDtcbmNvbnN0IFNPTkdfU1VCX05BTUVfVFJVTkNBVEUgPSAzMjtcblxuY29uc3QgREFNQUdFX0RFQ0FZID0gMC4yNTtcbmNvbnN0IERBTUFHRV9NQVggPSAxMDtcblxuY29uc3QgREVCVUdfQ0hBTExFTkdFID0ge1xuICBhdXRob3I6ICdTdXBlcm1hbicsXG4gIGRpZmZpY3VsdHk6ICdFeHBlcnQnLFxuICBpZDogJzMxJyxcbiAgaW1hZ2U6ICdhc3NldHMvaW1nL21vbGVyYXQuanBnJyxcbiAgc29uZ05hbWU6ICdGcmlkYXknLFxuICBzb25nTGVuZ3RoOiAxMDAsXG4gIHNvbmdTdWJOYW1lOiAnUmViZWNjYSBCbGFjaydcbn07XG5cbi8qKlxuICogU3RhdGUgaGFuZGxlci5cbiAqXG4gKiAxLiBgaGFuZGxlcnNgIGlzIGFuIG9iamVjdCBvZiBldmVudHMgdGhhdCB3aGVuIGVtaXR0ZWQgdG8gdGhlIHNjZW5lIHdpbGwgcnVuIHRoZSBoYW5kbGVyLlxuICpcbiAqIDIuIFRoZSBoYW5kbGVyIGZ1bmN0aW9uIG1vZGlmaWVzIHRoZSBzdGF0ZS5cbiAqXG4gKiAzLiBFbnRpdGllcyBhbmQgY29tcG9uZW50cyB0aGF0IGFyZSBgYmluZGBlZCBhdXRvbWF0aWNhbGx5IHVwZGF0ZTpcbiAqICAgIGBiaW5kX188Y29tcG9uZW50TmFtZT49XCI8cHJvcGVydHlOYW1lPjogc29tZS5pdGVtLmluLnN0YXRlXCJgXG4gKi9cbkFGUkFNRS5yZWdpc3RlclN0YXRlKHtcbiAgbm9uQmluZGVkU3RhdGVLZXlzOiBbJ2dlbnJlcyddLFxuXG4gIGluaXRpYWxTdGF0ZToge1xuICAgIGFjdGl2ZUhhbmQ6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdoYW5kJykgfHwgJ3JpZ2h0JyxcbiAgICBjaGFsbGVuZ2U6IHsgIC8vIEFjdGl2ZWx5IHBsYXlpbmcgY2hhbGxlbmdlLlxuICAgICAgYXV0aG9yOiAnJyxcbiAgICAgIGRpZmZpY3VsdHk6ICcnLFxuICAgICAgaWQ6IEFGUkFNRS51dGlscy5nZXRVcmxQYXJhbWV0ZXIoJ2NoYWxsZW5nZScpLCAgLy8gV2lsbCBiZSBlbXB0eSBzdHJpbmcgaWYgbm90IHBsYXlpbmcuXG4gICAgICBpbWFnZTogJycsXG4gICAgICBpc0xvYWRpbmc6IGZhbHNlLFxuICAgICAgaXNCZWF0c1ByZWxvYWRlZDogZmFsc2UsICAvLyBXaGV0aGVyIHdlIGhhdmUgcGFzc2VkIHRoZSBuZWdhdGl2ZSB0aW1lLlxuICAgICAgbnVtQmVhdHM6IHVuZGVmaW5lZCxcbiAgICAgIHNvbmdEdXJhdGlvbjogMCxcbiAgICAgIHNvbmdOYW1lOiAnJyxcbiAgICAgIHNvbmdTdWJOYW1lOiAnJ1xuICAgIH0sXG4gICAgY29udHJvbGxlclR5cGU6ICcnLFxuICAgIGRhbWFnZTogMCxcbiAgICBnZW5yZTogJycsXG4gICAgZ2VucmVzOiByZXF1aXJlKCcuLi9jb25zdGFudHMvZ2VucmVzJyksXG4gICAgZ2VucmVNZW51T3BlbjogZmFsc2UsXG4gICAgaW5WUjogZmFsc2UsXG4gICAgaXNHYW1lT3ZlcjogZmFsc2UsICAvLyBHYW1lIG92ZXIgc2NyZWVuLlxuICAgIGlzUGF1c2VkOiBmYWxzZSwgIC8vIFBsYXlpbmcsIGJ1dCBwYXVzZWQuIE5vdCBhY3RpdmUgZHVyaW5nIG1lbnUuXG4gICAgaXNQbGF5aW5nOiBmYWxzZSwgIC8vIEFjdGl2ZWx5IHBsYXlpbmcgKHNsaWNpbmcgYmVhdHMpLlxuICAgIGlzU2VhcmNoaW5nOiBmYWxzZSwgIC8vIFdoZXRoZXIgc2VhcmNoIGlzIG9wZW4uXG4gICAgaXNTb25nRmV0Y2hpbmc6IGZhbHNlLCAgLy8gRmV0Y2hpbmcgc3RhZ2UuXG4gICAgaXNTb25nTG9hZGluZzogZmFsc2UsICAvLyBFaXRoZXIgZmV0Y2hpbmcgb3IgZGVjb2RpbmcuXG4gICAgaXNWaWN0b3J5OiBmYWxzZSwgIC8vIFZpY3Rvcnkgc2NyZWVuLlxuICAgIGxlYWRlcmJvYXJkOiBbXSxcbiAgICBsZWFkZXJib2FyZEZldGNoZWQ6IGZhbHNlLFxuICAgIGxlYWRlcmJvYXJkUXVhbGlmaWVkOiBmYWxzZSxcbiAgICBsZWFkZXJib2FyZE5hbWVzOiAnJyxcbiAgICBsZWFkZXJib2FyZFNjb3JlczogJycsXG4gICAgbWVudUFjdGl2ZTogdHJ1ZSwgIC8vIE1haW4gbWVudSBhY3RpdmUuXG4gICAgbWVudURpZmZpY3VsdGllczogW10sICAvLyBMaXN0IG9mIHN0cmluZ3Mgb2YgYXZhaWxhYmxlIGRpZmZpY3VsdGllcyBmb3Igc2VsZWN0ZWQuXG4gICAgbWVudVNlbGVjdGVkQ2hhbGxlbmdlOiB7ICAvLyBDdXJyZW50bHkgc2VsZWN0ZWQgY2hhbGxlbmdlIGluIHRoZSBtYWluIG1lbnUuXG4gICAgICBhdXRob3I6ICcnLFxuICAgICAgZGlmZmljdWx0eTogJycsXG4gICAgICBkb3dubG9hZHM6ICcnLFxuICAgICAgZG93bmxvYWRzVGV4dDogJycsXG4gICAgICBnZW5yZTogJycsXG4gICAgICBpZDogJycsXG4gICAgICBpbmRleDogLTEsXG4gICAgICBpbWFnZTogJycsXG4gICAgICBudW1CZWF0czogdW5kZWZpbmVkLFxuICAgICAgc29uZ0R1cmF0aW9uOiAwLFxuICAgICAgc29uZ0luZm9UZXh0OiAnJyxcbiAgICAgIHNvbmdMZW5ndGg6IHVuZGVmaW5lZCxcbiAgICAgIHNvbmdOYW1lOiAnJyxcbiAgICAgIHNvbmdTdWJOYW1lOiAnJ1xuICAgIH0sXG4gICAgc2NvcmU6IHtcbiAgICAgIGFjY3VyYWN5OiAwLCAgLy8gT3V0IG9mIDEwMC5cbiAgICAgIGJlYXRzSGl0OiAwLFxuICAgICAgYmVhdHNNaXNzZWQ6IDAsXG4gICAgICBiZWF0c1RleHQ6ICcnLFxuICAgICAgY29tYm86IDAsXG4gICAgICBtYXhDb21ibzogMCxcbiAgICAgIG11bHRpcGxpZXI6IDEsXG4gICAgICByYW5rOiAnJywgIC8vIEdyYWRlIChTIHRvIEYpLlxuICAgICAgc2NvcmU6IDBcbiAgICB9LFxuICAgIHNlYXJjaDoge1xuICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgcGFnZTogMCxcbiAgICAgIGhhc0Vycm9yOiBmYWxzZSxcbiAgICAgIGhhc05leHQ6IGZhbHNlLFxuICAgICAgaGFzUHJldjogZmFsc2UsXG4gICAgICBxdWVyeTogJycsXG4gICAgICByZXN1bHRzOiBbXSxcbiAgICAgIHNvbmdOYW1lVGV4dHM6ICcnLCAgLy8gQWxsIG5hbWVzIGluIHNlYXJjaCByZXN1bHRzIG1lcmdlZCB0b2dldGhlci5cbiAgICAgIHNvbmdTdWJOYW1lVGV4dHM6ICcnICAvLyBBbGwgc3ViIG5hbWVzIGluIHNlYXJjaCByZXN1bHRzIG1lcmdlZCB0b2dldGhlci5cbiAgICB9LFxuICAgIHNlYXJjaFJlc3VsdHNQYWdlOiBbXVxuICB9LFxuXG4gIGhhbmRsZXJzOiB7XG4gICAgLyoqXG4gICAgICogU3dhcCBsZWZ0LWhhbmRlZCBvciByaWdodC1oYW5kZWQgbW9kZS5cbiAgICAgKi9cbiAgICBhY3RpdmVoYW5kc3dhcDogc3RhdGUgPT4ge1xuICAgICAgc3RhdGUuYWN0aXZlSGFuZCA9IHN0YXRlLmFjdGl2ZUhhbmQgPT09ICdyaWdodCcgPyAnbGVmdCcgOiAncmlnaHQnO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZUhhbmQnLCBzdGF0ZS5hY3RpdmVIYW5kKTtcbiAgICB9LFxuXG4gICAgYmVhdGhpdDogKHN0YXRlLCBwYXlsb2FkKSA9PiB7XG4gICAgICBpZiAoc3RhdGUuZGFtYWdlID4gREFNQUdFX0RFQ0FZKSB7XG4gICAgICAgIHN0YXRlLmRhbWFnZSAtPSBEQU1BR0VfREVDQVk7XG4gICAgICB9XG4gICAgICBzdGF0ZS5zY29yZS5iZWF0c0hpdCsrO1xuICAgICAgc3RhdGUuc2NvcmUuY29tYm8rKztcbiAgICAgIGlmIChzdGF0ZS5zY29yZS5jb21ibyA+IHN0YXRlLnNjb3JlLm1heENvbWJvKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLm1heENvbWJvID0gc3RhdGUuc2NvcmUuY29tYm87XG4gICAgICB9XG5cbiAgICAgIHN0YXRlLnNjb3JlLnNjb3JlICs9IE1hdGguZmxvb3IocGF5bG9hZC5zY29yZSAqIHN0YXRlLnNjb3JlLm11bHRpcGxpZXIpO1xuXG4gICAgICAvLyBNaWdodCBiZSBhIG1hdGggZm9ybXVsYSBmb3IgdGhpcywgYnV0IHRoZSBtdWx0aXBsaWVyIHN5c3RlbSBpcyBlYXN5IHJlZHVjZWQuXG4gICAgICBpZiAoc3RhdGUuc2NvcmUuY29tYm8gPCAyKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLm11bHRpcGxpZXIgPSAxO1xuICAgICAgfSBlbHNlIGlmIChzdGF0ZS5zY29yZS5jb21ibyA8IDYpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUubXVsdGlwbGllciA9IDI7XG4gICAgICB9IGVsc2UgaWYgKHN0YXRlLnNjb3JlLmNvbWJvIDwgMTQpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUubXVsdGlwbGllciA9IDQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGF0ZS5zY29yZS5tdWx0aXBsaWVyID0gODtcbiAgICAgIH1cblxuICAgICAgdXBkYXRlU2NvcmVBY2N1cmFjeShzdGF0ZSk7XG4gICAgfSxcblxuICAgIGJlYXRtaXNzOiBzdGF0ZSA9PiB7XG4gICAgICBzdGF0ZS5zY29yZS5iZWF0c01pc3NlZCsrO1xuICAgICAgdGFrZURhbWFnZShzdGF0ZSk7XG4gICAgICB1cGRhdGVTY29yZUFjY3VyYWN5KHN0YXRlKTtcbiAgICB9LFxuXG4gICAgYmVhdHdyb25nOiBzdGF0ZSA9PiB7XG4gICAgICBzdGF0ZS5zY29yZS5iZWF0c01pc3NlZCsrO1xuICAgICAgdGFrZURhbWFnZShzdGF0ZSk7XG4gICAgICB1cGRhdGVTY29yZUFjY3VyYWN5KHN0YXRlKTtcbiAgICB9LFxuXG4gICAgYmVhdGxvYWRlcmZpbmlzaDogKHN0YXRlLCBwYXlsb2FkKSA9PiB7XG4gICAgICBzdGF0ZS5jaGFsbGVuZ2UuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgfSxcblxuICAgIGJlYXRsb2FkZXJwcmVsb2FkZmluaXNoOiAoc3RhdGUpID0+IHtcbiAgICAgIGlmIChzdGF0ZS5tZW51QWN0aXZlKSB7IHJldHVybjsgfSAgLy8gQ2FuY2VsbGVkLlxuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlzQmVhdHNQcmVsb2FkZWQgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBiZWF0bG9hZGVyc3RhcnQ6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlzQmVhdHNQcmVsb2FkZWQgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pc0xvYWRpbmcgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBjb250cm9sbGVyY29ubmVjdGVkOiAoc3RhdGUsIHBheWxvYWQpID0+IHtcbiAgICAgIHN0YXRlLmNvbnRyb2xsZXJUeXBlID0gcGF5bG9hZC5uYW1lO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBUbyB3b3JrIG9uIGdhbWUgb3ZlciBwYWdlLlxuICAgICAqXG4gICAgICogP2RlYnVnc3RhdGU9Z2FtZXBsYXlcbiAgICAgKi9cbiAgICBkZWJ1Z2dhbWVwbGF5OiBzdGF0ZSA9PiB7XG4gICAgICByZXNldFNjb3JlKHN0YXRlKTtcblxuICAgICAgLy8gU2V0IGNoYWxsZW5nZS4gYGJlYXQtbG9hZGVyYCBpcyBsaXN0ZW5pbmcuXG4gICAgICBPYmplY3QuYXNzaWduKHN0YXRlLmNoYWxsZW5nZSwgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlKTtcblxuICAgICAgLy8gUmVzZXQgbWVudS5cbiAgICAgIHN0YXRlLm1lbnVBY3RpdmUgPSBmYWxzZTtcbiAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pZCA9ICcnO1xuXG4gICAgICBzdGF0ZS5pc1NlYXJjaGluZyA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNTb25nTG9hZGluZyA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBUbyB3b3JrIG9uIGdhbWUgb3ZlciBwYWdlLlxuICAgICAqXG4gICAgICogP2RlYnVnc3RhdGU9Z2FtZW92ZXJcbiAgICAgKi9cbiAgICBkZWJ1Z2dhbWVvdmVyOiBzdGF0ZSA9PiB7XG4gICAgICBzdGF0ZS5pc0dhbWVPdmVyID0gdHJ1ZTtcbiAgICAgIHN0YXRlLm1lbnVBY3RpdmUgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVG8gd29yayBvbiB2aWN0b3J5IHBhZ2UuXG4gICAgICpcbiAgICAgKiA/ZGVidWdzdGF0ZT1sb2FkaW5nXG4gICAgICovXG4gICAgZGVidWdsb2FkaW5nOiBzdGF0ZSA9PiB7XG4gICAgICBERUJVR19DSEFMTEVOR0UuaWQgPSAnLTEnO1xuICAgICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UsIERFQlVHX0NIQUxMRU5HRSk7XG4gICAgICBPYmplY3QuYXNzaWduKHN0YXRlLmNoYWxsZW5nZSwgREVCVUdfQ0hBTExFTkdFKTtcbiAgICAgIHN0YXRlLm1lbnVBY3RpdmUgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzU29uZ0ZldGNoaW5nID0gdHJ1ZTtcbiAgICAgIHN0YXRlLmlzU29uZ0xvYWRpbmcgPSB0cnVlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBUbyB3b3JrIG9uIHZpY3RvcnkgcGFnZS5cbiAgICAgKlxuICAgICAqID9kZWJ1Z3N0YXRlPXZpY3RvcnlcbiAgICAgKi9cbiAgICBkZWJ1Z3ZpY3Rvcnk6IHN0YXRlID0+IHtcbiAgICAgIE9iamVjdC5hc3NpZ24oc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLCBERUJVR19DSEFMTEVOR0UpO1xuICAgICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5jaGFsbGVuZ2UsIERFQlVHX0NIQUxMRU5HRSk7XG4gICAgICBzdGF0ZS5pc1ZpY3RvcnkgPSB0cnVlO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRRdWFsaWZpZWQgPSB0cnVlO1xuICAgICAgc3RhdGUubWVudUFjdGl2ZSA9IGZhbHNlO1xuICAgICAgc3RhdGUuc2NvcmUuYWNjdXJhY3kgPSA3NC45OTtcbiAgICAgIHN0YXRlLnNjb3JlLmJlYXRzSGl0ID0gMTI1O1xuICAgICAgc3RhdGUuc2NvcmUuYmVhdHNNaXNzZWQgPSAxMjU7XG4gICAgICBzdGF0ZS5zY29yZS5tYXhDb21ibyA9IDEyMztcbiAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQyc7XG4gICAgICBzdGF0ZS5zY29yZS5zY29yZSA9IDkwMDE7XG4gICAgICBjb21wdXRlQmVhdHNUZXh0KHN0YXRlKTtcbiAgICB9LFxuXG4gICAgZ2FtZW1lbnVyZXN1bWU6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuaXNQYXVzZWQgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgZ2FtZW1lbnVyZXN0YXJ0OiAoc3RhdGUpID0+IHtcbiAgICAgIHJlc2V0U2NvcmUoc3RhdGUpO1xuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlzQmVhdHNQcmVsb2FkZWQgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzR2FtZU92ZXIgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzUGF1c2VkID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1NvbmdMb2FkaW5nID0gdHJ1ZTtcbiAgICAgIHN0YXRlLmlzVmljdG9yeSA9IGZhbHNlO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRRdWFsaWZpZWQgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgZ2FtZW1lbnVleGl0OiAoc3RhdGUpID0+IHtcbiAgICAgIHJlc2V0U2NvcmUoc3RhdGUpO1xuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlzQmVhdHNQcmVsb2FkZWQgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzR2FtZU92ZXIgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzUGF1c2VkID0gZmFsc2U7XG4gICAgICBzdGF0ZS5pc1ZpY3RvcnkgPSBmYWxzZTtcbiAgICAgIHN0YXRlLm1lbnVBY3RpdmUgPSB0cnVlO1xuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlkID0gJyc7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZFF1YWxpZmllZCA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBnZW5yZWNsZWFyOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmdlbnJlID0gJyc7XG4gICAgfSxcblxuICAgIGdlbnJlbWVudWNsb3NlOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmdlbnJlTWVudU9wZW4gPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgZ2VucmVtZW51b3BlbjogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5nZW5yZU1lbnVPcGVuID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAga2V5Ym9hcmRjbG9zZTogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5pc1NlYXJjaGluZyA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBrZXlib2FyZG9wZW46IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuaXNTZWFyY2hpbmcgPSB0cnVlO1xuICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmlkID0gJyc7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEhpZ2ggc2NvcmVzLlxuICAgICAqL1xuICAgIGxlYWRlcmJvYXJkOiAoc3RhdGUsIHBheWxvYWQpID0+IHtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkLmxlbmd0aCA9IDA7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZEZldGNoZWQgPSB0cnVlO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmROYW1lcyA9ICcnO1xuICAgICAgc3RhdGUubGVhZGVyYm9hcmRTY29yZXMgPSAnJztcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGF5bG9hZC5zY29yZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IHNjb3JlID0gcGF5bG9hZC5zY29yZXNbaV07XG4gICAgICAgIHN0YXRlLmxlYWRlcmJvYXJkLnB1c2goc2NvcmUpO1xuICAgICAgICBzdGF0ZS5sZWFkZXJib2FyZE5hbWVzICs9IGAke3Njb3JlLnVzZXJuYW1lfSAoJHtzY29yZS5hY2N1cmFjeSB8fCAwfSUpXFxuYDtcbiAgICAgICAgc3RhdGUubGVhZGVyYm9hcmRTY29yZXMgKz0gYCR7c2NvcmUuc2NvcmV9XFxuYDtcbiAgICAgIH1cbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkTG9hZGluZyA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBsZWFkZXJib2FyZHF1YWxpZnk6IHN0YXRlID0+IHtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkUXVhbGlmaWVkID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0IG5ldyBzY29yZSBpbnRvIGxlYWRlcmJvYXJkIGxvY2FsbHkuXG4gICAgICovXG4gICAgbGVhZGVyYm9hcmRzY29yZWFkZGVkOiAoc3RhdGUsIHBheWxvYWQpID0+IHtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkLnNwbGljZShwYXlsb2FkLmluZGV4LCAwLCBwYXlsb2FkLnNjb3JlRGF0YSk7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZE5hbWVzID0gJyc7XG4gICAgICBzdGF0ZS5sZWFkZXJib2FyZFNjb3JlcyA9ICcnO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBOVU1fTEVBREVSQk9BUkRfRElTUExBWTsgaSsrKSB7XG4gICAgICAgIGxldCBzY29yZSA9IHN0YXRlLmxlYWRlcmJvYXJkW2ldO1xuICAgICAgICBzdGF0ZS5sZWFkZXJib2FyZE5hbWVzICs9IGAke3Njb3JlLnVzZXJuYW1lfSAoJHtzY29yZS5hY2N1cmFjeSB8fCAwfSUpXFxuYDtcbiAgICAgICAgc3RhdGUubGVhZGVyYm9hcmRTY29yZXMgKz0gYCR7c2NvcmUuc2NvcmV9XFxuYDtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgbGVhZGVyYm9hcmRzdWJtaXQ6IHN0YXRlID0+IHtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkUXVhbGlmaWVkID0gZmFsc2U7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNvbmcgY2xpY2tlZCBmcm9tIG1lbnUuXG4gICAgICovXG4gICAgbWVudWNoYWxsZW5nZXNlbGVjdDogKHN0YXRlLCBpZCkgPT4ge1xuICAgICAgLy8gQ29weSBmcm9tIGNoYWxsZW5nZSBzdG9yZSBwb3B1bGF0ZWQgZnJvbSBzZWFyY2ggcmVzdWx0cy5cbiAgICAgIGxldCBjaGFsbGVuZ2UgPSBjaGFsbGVuZ2VEYXRhU3RvcmVbaWRdO1xuICAgICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UsIGNoYWxsZW5nZSk7XG5cbiAgICAgIC8vIFBvcHVsYXRlIGRpZmZpY3VsdHkgb3B0aW9ucy5cbiAgICAgIHN0YXRlLm1lbnVEaWZmaWN1bHRpZXMubGVuZ3RoID0gMDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhbGxlbmdlLmRpZmZpY3VsdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBzdGF0ZS5tZW51RGlmZmljdWx0aWVzLnVuc2hpZnQoY2hhbGxlbmdlLmRpZmZpY3VsdGllc1tpXSk7XG4gICAgICB9XG4gICAgICBzdGF0ZS5tZW51RGlmZmljdWx0aWVzLnNvcnQoZGlmZmljdWx0eUNvbXBhcmF0b3IpO1xuXG4gICAgICAvLyBEZWZhdWx0IHRvIGVhc2llc3QgZGlmZmljdWx0eS5cbiAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5kaWZmaWN1bHR5ID0gc3RhdGUubWVudURpZmZpY3VsdGllc1swXTtcblxuICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmltYWdlID0gdXRpbHMuZ2V0UzNGaWxlVXJsKGlkLCAnaW1hZ2UuanBnJyk7XG4gICAgICB1cGRhdGVNZW51U29uZ0luZm8oc3RhdGUsIGNoYWxsZW5nZSk7XG5cbiAgICAgIGNvbXB1dGVNZW51U2VsZWN0ZWRDaGFsbGVuZ2VJbmRleChzdGF0ZSk7XG4gICAgICBzdGF0ZS5pc1NlYXJjaGluZyA9IGZhbHNlO1xuXG4gICAgICBjbGVhckxlYWRlcmJvYXJkKHN0YXRlKTtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkTG9hZGluZyA9IHRydWU7XG4gICAgfSxcblxuICAgIG1lbnVjaGFsbGVuZ2V1bnNlbGVjdDogc3RhdGUgPT4ge1xuICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmlkID0gJyc7XG4gICAgICBjbGVhckxlYWRlcmJvYXJkKHN0YXRlKTtcbiAgICB9LFxuXG4gICAgbWVudWRpZmZpY3VsdHlzZWxlY3Q6IChzdGF0ZSwgZGlmZmljdWx0eSkgPT4ge1xuICAgICAgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlLmRpZmZpY3VsdHkgPSBkaWZmaWN1bHR5O1xuICAgICAgdXBkYXRlTWVudVNvbmdJbmZvKHN0YXRlLCBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UpO1xuXG4gICAgICBjbGVhckxlYWRlcmJvYXJkKHN0YXRlKTtcbiAgICAgIHN0YXRlLmxlYWRlcmJvYXJkTG9hZGluZyA9IHRydWU7XG4gICAgfSxcblxuICAgIG1pbmVoaXQ6IHN0YXRlID0+IHtcbiAgICAgIHRha2VEYW1hZ2Uoc3RhdGUpO1xuICAgIH0sXG5cbiAgICBwYXVzZWdhbWU6IChzdGF0ZSkgPT4ge1xuICAgICAgaWYgKCFzdGF0ZS5pc1BsYXlpbmcpIHsgcmV0dXJuOyB9XG4gICAgICBzdGF0ZS5pc1BhdXNlZCA9IHRydWU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IGNoYWxsZW5nZS5cbiAgICAgKiBUcmFuc2ZlciBzdGFnZWQgY2hhbGxlbmdlIHRvIHRoZSBhY3RpdmUgY2hhbGxlbmdlLlxuICAgICAqL1xuICAgIHBsYXlidXR0b25jbGljazogKHN0YXRlKSA9PiB7XG4gICAgICByZXNldFNjb3JlKHN0YXRlKTtcblxuICAgICAgLy8gU2V0IGNoYWxsZW5nZS4gYGJlYXQtbG9hZGVyYCBpcyBsaXN0ZW5pbmcuXG4gICAgICBPYmplY3QuYXNzaWduKHN0YXRlLmNoYWxsZW5nZSwgc3RhdGUubWVudVNlbGVjdGVkQ2hhbGxlbmdlKTtcblxuICAgICAgLy8gUmVzZXQgbWVudS5cbiAgICAgIHN0YXRlLm1lbnVBY3RpdmUgPSBmYWxzZTtcbiAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pZCA9ICcnO1xuXG4gICAgICBzdGF0ZS5pc1NlYXJjaGluZyA9IGZhbHNlO1xuICAgICAgc3RhdGUuaXNTb25nTG9hZGluZyA9IHRydWU7XG4gICAgfSxcblxuICAgIHNlYXJjaGVycm9yOiAoc3RhdGUsIHBheWxvYWQpID0+IHtcbiAgICAgIHN0YXRlLnNlYXJjaC5oYXNFcnJvciA9IHRydWU7XG4gICAgfSxcblxuICAgIHNlYXJjaHByZXZwYWdlOiBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIGlmIChzdGF0ZS5zZWFyY2gucGFnZSA9PT0gMCkgeyByZXR1cm47IH1cbiAgICAgIHN0YXRlLnNlYXJjaC5wYWdlLS07XG4gICAgICBjb21wdXRlU2VhcmNoUGFnaW5hdGlvbihzdGF0ZSk7XG4gICAgfSxcblxuICAgIHNlYXJjaG5leHRwYWdlOiBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIGlmIChzdGF0ZS5zZWFyY2gucGFnZSA+IE1hdGguZmxvb3Ioc3RhdGUuc2VhcmNoLnJlc3VsdHMubGVuZ3RoIC8gU0VBUkNIX1BFUl9QQUdFKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzdGF0ZS5zZWFyY2gucGFnZSsrO1xuICAgICAgY29tcHV0ZVNlYXJjaFBhZ2luYXRpb24oc3RhdGUpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgc2VhcmNoIHJlc3VsdHMuIFdpbGwgYXV0b21hdGljYWxseSByZW5kZXIgdXNpbmcgYGJpbmQtZm9yYCAobWVudS5odG1sKS5cbiAgICAgKi9cbiAgICBzZWFyY2hyZXN1bHRzOiAoc3RhdGUsIHBheWxvYWQpID0+IHtcbiAgICAgIHZhciBpO1xuICAgICAgc3RhdGUuc2VhcmNoLmhhc0Vycm9yID0gZmFsc2U7XG4gICAgICBzdGF0ZS5zZWFyY2gucGFnZSA9IDA7XG4gICAgICBzdGF0ZS5zZWFyY2gucXVlcnkgPSBwYXlsb2FkLnF1ZXJ5O1xuICAgICAgc3RhdGUuc2VhcmNoLnJlc3VsdHMgPSBwYXlsb2FkLnJlc3VsdHM7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgcGF5bG9hZC5yZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBwYXlsb2FkLnJlc3VsdHNbaV07XG4gICAgICAgIHJlc3VsdC5zb25nU3ViTmFtZSA9IHJlc3VsdC5zb25nU3ViTmFtZSB8fCAnVW5rbm93biBBcnRpc3QnO1xuICAgICAgICByZXN1bHQuc2hvcnRTb25nTmFtZSA9IHRydW5jYXRlKHJlc3VsdC5zb25nTmFtZSwgU09OR19OQU1FX1RSVU5DQVRFKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICByZXN1bHQuc2hvcnRTb25nU3ViTmFtZSA9IHRydW5jYXRlKHJlc3VsdC5zb25nU3ViTmFtZSwgU09OR19TVUJfTkFNRV9UUlVOQ0FURSk7XG4gICAgICAgIGNoYWxsZW5nZURhdGFTdG9yZVtyZXN1bHQuaWRdID0gcmVzdWx0O1xuICAgICAgfVxuICAgICAgY29tcHV0ZVNlYXJjaFBhZ2luYXRpb24oc3RhdGUpO1xuXG4gICAgICBpZiAocGF5bG9hZC5pc0dlbnJlU2VhcmNoKSB7XG4gICAgICAgIHN0YXRlLmdlbnJlTWVudU9wZW4gPSBmYWxzZTtcbiAgICAgICAgc3RhdGUuZ2VucmUgPSBwYXlsb2FkLmdlbnJlO1xuICAgICAgICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaWQgPSAnJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0YXRlLmdlbnJlID0gJyc7XG4gICAgICAgIGNvbXB1dGVNZW51U2VsZWN0ZWRDaGFsbGVuZ2VJbmRleChzdGF0ZSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHNvbmdmZXRjaGZpbmlzaDogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5pc1NvbmdGZXRjaGluZyA9IGZhbHNlO1xuICAgIH0sXG5cbiAgICBzb25nbG9hZGNhbmNlbDogc3RhdGUgPT4ge1xuICAgICAgc3RhdGUuY2hhbGxlbmdlLmlzQmVhdHNQcmVsb2FkZWQgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmNoYWxsZW5nZS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzU29uZ0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzU29uZ0ZldGNoaW5nID0gZmFsc2U7XG4gICAgICBzdGF0ZS5tZW51QWN0aXZlID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc29uZ2xvYWRmaW5pc2g6IChzdGF0ZSkgPT4ge1xuICAgICAgc3RhdGUuaXNTb25nRmV0Y2hpbmcgPSBmYWxzZTtcbiAgICAgIHN0YXRlLmlzU29uZ0xvYWRpbmcgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgc29uZ2xvYWRzdGFydDogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5pc1NvbmdGZXRjaGluZyA9IHRydWU7XG4gICAgICBzdGF0ZS5pc1NvbmdMb2FkaW5nID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgJ2VudGVyLXZyJzogKHN0YXRlKSA9PiB7XG4gICAgICBzdGF0ZS5pblZSID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgJ2V4aXQtdnInOiAoc3RhdGUpID0+IHtcbiAgICAgIHN0YXRlLmluVlIgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgdmljdG9yeTogZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICBzdGF0ZS5pc1ZpY3RvcnkgPSB0cnVlO1xuXG4gICAgICAvLyBQZXJjZW50YWdlIGlzIHNjb3JlIGRpdmlkZWQgYnkgdG90YWwgcG9zc2libGUgc2NvcmUuXG4gICAgICBjb25zdCBhY2N1cmFjeSA9IChzdGF0ZS5zY29yZS5zY29yZSAvIChzdGF0ZS5jaGFsbGVuZ2UubnVtQmVhdHMgKiAxMTApKSAqIDEwMDtcbiAgICAgIHN0YXRlLnNjb3JlLmFjY3VyYWN5ID0gaXNOYU4oYWNjdXJhY3kpID8gMCA6IGFjY3VyYWN5O1xuICAgICAgc3RhdGUuc2NvcmUuc2NvcmUgPSBpc05hTihzdGF0ZS5zY29yZS5zY29yZSkgPyAwIDogc3RhdGUuc2NvcmUuc2NvcmU7XG5cbiAgICAgIGlmIChhY2N1cmFjeSA+PSA5NSkge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ1MnO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA5Mykge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0EnO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA5MCkge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0EtJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gODgpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdCKyc7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDgzKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQic7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDgwKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnQi0nO1xuICAgICAgfSBlbHNlIGlmIChhY2N1cmFjeSA+PSA3OCkge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0MrJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gNzMpIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdDJztcbiAgICAgIH0gZWxzZSBpZiAoYWNjdXJhY3kgPj0gNzApIHtcbiAgICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdDLSc7XG4gICAgICB9IGVsc2UgaWYgKGFjY3VyYWN5ID49IDYwKSB7XG4gICAgICAgIHN0YXRlLnNjb3JlLnJhbmsgPSAnRCc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGF0ZS5zY29yZS5yYW5rID0gJ0YnO1xuICAgICAgfVxuXG4gICAgICBjb21wdXRlQmVhdHNUZXh0KHN0YXRlKTtcbiAgICB9LFxuXG4gICAgdmljdG9yeWZha2U6IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgc3RhdGUuc2NvcmUuYWNjdXJhY3kgPSAnNzQuOTknO1xuICAgICAgc3RhdGUuc2NvcmUucmFuayA9ICdDJztcbiAgICB9LFxuXG4gICAgd2FsbGhpdHN0YXJ0OiBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIHRha2VEYW1hZ2Uoc3RhdGUpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogUG9zdC1wcm9jZXNzIHRoZSBzdGF0ZSBhZnRlciBlYWNoIGFjdGlvbi5cbiAgICovXG4gIGNvbXB1dGVTdGF0ZTogKHN0YXRlKSA9PiB7XG4gICAgc3RhdGUuaXNQbGF5aW5nID1cbiAgICAgICFzdGF0ZS5tZW51QWN0aXZlICYmICFzdGF0ZS5pc1BhdXNlZCAmJiAhc3RhdGUuaXNWaWN0b3J5ICYmICFzdGF0ZS5pc0dhbWVPdmVyICYmXG4gICAgICAhc3RhdGUuY2hhbGxlbmdlLmlzTG9hZGluZyAmJiAhc3RhdGUuaXNTb25nTG9hZGluZyAmJiAhIXN0YXRlLmNoYWxsZW5nZS5pZDtcblxuICAgIGNvbnN0IGFueU1lbnVPcGVuID0gc3RhdGUubWVudUFjdGl2ZSB8fCBzdGF0ZS5pc1BhdXNlZCB8fCBzdGF0ZS5pc1ZpY3RvcnkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLmlzR2FtZU92ZXIgfHwgc3RhdGUuaXNTb25nTG9hZGluZyB8fCBzdGF0ZS5pc1NvbmdGZXRjaGluZztcbiAgICBzdGF0ZS5sZWZ0UmF5Y2FzdGVyQWN0aXZlID0gYW55TWVudU9wZW4gJiYgc3RhdGUuYWN0aXZlSGFuZCA9PT0gJ2xlZnQnICYmIHN0YXRlLmluVlI7XG4gICAgc3RhdGUucmlnaHRSYXljYXN0ZXJBY3RpdmUgPSBhbnlNZW51T3BlbiAmJiBzdGF0ZS5hY3RpdmVIYW5kID09PSAncmlnaHQnICYmIHN0YXRlLmluVlI7XG5cbiAgICAvLyBTb25nIGlzIGRlY29kaW5nIGlmIGl0IGlzIGxvYWRpbmcsIGJ1dCBub3QgZmV0Y2hpbmcuXG4gICAgaWYgKHN0YXRlLmlzU29uZ0xvYWRpbmcpIHtcbiAgICAgIHN0YXRlLmxvYWRpbmdUZXh0ID0gc3RhdGUuaXNTb25nRmV0Y2hpbmcgPyAnRG93bmxvYWRpbmcgc29uZy4uLicgOiAnUHJvY2Vzc2luZyBzb25nLi4uJztcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhdGUubG9hZGluZ1RleHQgPSAnJztcbiAgICB9XG4gIH1cbn0pO1xuXG5mdW5jdGlvbiBjb21wdXRlU2VhcmNoUGFnaW5hdGlvbiAoc3RhdGUpIHtcbiAgbGV0IG51bVBhZ2VzID0gTWF0aC5jZWlsKHN0YXRlLnNlYXJjaC5yZXN1bHRzLmxlbmd0aCAvIFNFQVJDSF9QRVJfUEFHRSk7XG4gIHN0YXRlLnNlYXJjaC5oYXNQcmV2ID0gc3RhdGUuc2VhcmNoLnBhZ2UgPiAwO1xuICBzdGF0ZS5zZWFyY2guaGFzTmV4dCA9IHN0YXRlLnNlYXJjaC5wYWdlIDwgbnVtUGFnZXMgLSAxO1xuXG4gIHN0YXRlLnNlYXJjaC5zb25nTmFtZVRleHRzID0gJyc7XG4gIHN0YXRlLnNlYXJjaC5zb25nU3ViTmFtZVRleHRzID0gJyc7XG5cbiAgc3RhdGUuc2VhcmNoUmVzdWx0c1BhZ2UubGVuZ3RoID0gMDtcbiAgc3RhdGUuc2VhcmNoUmVzdWx0c1BhZ2UuX19kaXJ0eSA9IHRydWU7XG4gIGZvciAobGV0IGkgPSBzdGF0ZS5zZWFyY2gucGFnZSAqIFNFQVJDSF9QRVJfUEFHRTtcbiAgICAgICBpIDwgc3RhdGUuc2VhcmNoLnBhZ2UgKiBTRUFSQ0hfUEVSX1BBR0UgKyBTRUFSQ0hfUEVSX1BBR0U7IGkrKykge1xuICAgIGlmICghc3RhdGUuc2VhcmNoLnJlc3VsdHNbaV0pIHsgYnJlYWs7IH1cbiAgICBzdGF0ZS5zZWFyY2hSZXN1bHRzUGFnZS5wdXNoKHN0YXRlLnNlYXJjaC5yZXN1bHRzW2ldKTtcblxuICAgIHN0YXRlLnNlYXJjaC5zb25nTmFtZVRleHRzICs9XG4gICAgICB0cnVuY2F0ZShzdGF0ZS5zZWFyY2gucmVzdWx0c1tpXS5zb25nTmFtZSwgU09OR19OQU1FX1RSVU5DQVRFKS50b1VwcGVyQ2FzZSgpICsgJ1xcbic7XG4gICAgc3RhdGUuc2VhcmNoLnNvbmdTdWJOYW1lVGV4dHMgKz1cbiAgICAgIHRydW5jYXRlKHN0YXRlLnNlYXJjaC5yZXN1bHRzW2ldLnNvbmdTdWJOYW1lLCBTT05HX1NVQl9OQU1FX1RSVU5DQVRFKSArICdcXG4nO1xuICB9XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdGF0ZS5zZWFyY2hSZXN1bHRzUGFnZS5sZW5ndGg7IGkrKykge1xuICAgIHN0YXRlLnNlYXJjaFJlc3VsdHNQYWdlW2ldLmluZGV4ID0gaTtcbiAgfVxuXG4gIGNvbXB1dGVNZW51U2VsZWN0ZWRDaGFsbGVuZ2VJbmRleChzdGF0ZSk7XG59XG5cbmZ1bmN0aW9uIHRydW5jYXRlIChzdHIsIGxlbmd0aCkge1xuICBpZiAoIXN0cikgeyByZXR1cm4gJyc7IH1cbiAgaWYgKHN0ci5sZW5ndGggPj0gbGVuZ3RoKSB7XG4gICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCwgbGVuZ3RoIC0gMykgKyAnLi4uJztcbiAgfVxuICByZXR1cm4gc3RyO1xufVxuXG5jb25zdCBESUZGSUNVTFRJRVMgPSBbJ0Vhc3knLCAnTm9ybWFsJywgJ0hhcmQnLCAnRXhwZXJ0JywgJ0V4cGVydFBsdXMnXTtcbmZ1bmN0aW9uIGRpZmZpY3VsdHlDb21wYXJhdG9yIChhLCBiKSB7XG4gIGNvbnN0IGFJbmRleCA9IERJRkZJQ1VMVElFUy5pbmRleE9mKGEpO1xuICBjb25zdCBiSW5kZXggPSBESUZGSUNVTFRJRVMuaW5kZXhPZihiKTtcbiAgaWYgKGFJbmRleCA8IGJJbmRleCkgeyByZXR1cm4gLTE7IH1cbiAgaWYgKGFJbmRleCA+IGJJbmRleCkgeyByZXR1cm4gMTsgfVxuICByZXR1cm4gMDtcbn1cblxuZnVuY3Rpb24gdGFrZURhbWFnZSAoc3RhdGUpIHtcbiAgaWYgKCFzdGF0ZS5pc1BsYXlpbmcpIHsgcmV0dXJuOyB9XG4gIHN0YXRlLnNjb3JlLmNvbWJvID0gMDtcbiAgc3RhdGUuc2NvcmUubXVsdGlwbGllciA9IHN0YXRlLnNjb3JlLm11bHRpcGxpZXIgPiAxXG4gICAgPyBNYXRoLmNlaWwoc3RhdGUuc2NvcmUubXVsdGlwbGllciAvIDIpXG4gICAgOiAxO1xuICBpZiAoQUZSQU1FLnV0aWxzLmdldFVybFBhcmFtZXRlcignZ29kbW9kZScpKSB7IHJldHVybjsgfVxuICBzdGF0ZS5kYW1hZ2UrKztcbiAgY2hlY2tHYW1lT3ZlcihzdGF0ZSk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrR2FtZU92ZXIgKHN0YXRlKSB7XG4gIGlmIChzdGF0ZS5kYW1hZ2UgPj0gREFNQUdFX01BWCkge1xuICAgIHN0YXRlLmRhbWFnZSA9IDA7XG4gICAgc3RhdGUuaXNHYW1lT3ZlciA9IHRydWU7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVzZXRTY29yZSAoc3RhdGUpIHtcbiAgc3RhdGUuZGFtYWdlID0gMDtcbiAgc3RhdGUuc2NvcmUuYmVhdHNIaXQgPSAwO1xuICBzdGF0ZS5zY29yZS5iZWF0c01pc3NlZCA9IDA7XG4gIHN0YXRlLnNjb3JlLmNvbWJvID0gMDtcbiAgc3RhdGUuc2NvcmUubWF4Q29tYm8gPSAwO1xuICBzdGF0ZS5zY29yZS5zY29yZSA9IDA7XG4gIHN0YXRlLnNjb3JlLm11bHRpcGxpZXIgPSAxO1xufVxuXG5mdW5jdGlvbiBjb21wdXRlTWVudVNlbGVjdGVkQ2hhbGxlbmdlSW5kZXggKHN0YXRlKSB7XG4gIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pbmRleCA9IC0xO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlLnNlYXJjaFJlc3VsdHNQYWdlLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHN0YXRlLnNlYXJjaFJlc3VsdHNQYWdlW2ldLmlkID09PSBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2UuaWQpIHtcbiAgICAgIHN0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5pbmRleCA9IGk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZm9ybWF0U29uZ0xlbmd0aCAoc29uZ0xlbmd0aCkge1xuICBzb25nTGVuZ3RoIC89IDYwO1xuICBjb25zdCBtaW51dGVzID0gYCR7TWF0aC5mbG9vcihzb25nTGVuZ3RoKX1gO1xuICByZXR1cm4gYCR7bWludXRlc306JHtNYXRoLnJvdW5kKChzb25nTGVuZ3RoIC0gbWludXRlcykgKiA2MCl9YDtcbn1cblxuZnVuY3Rpb24gY29tcHV0ZUJlYXRzVGV4dCAoc3RhdGUpIHtcbiAgc3RhdGUuc2NvcmUuYmVhdHNUZXh0ID1cbiAgICBgJHtzdGF0ZS5zY29yZS5iZWF0c0hpdH0gLyAke3N0YXRlLnNjb3JlLmJlYXRzTWlzc2VkICsgc3RhdGUuc2NvcmUuYmVhdHNIaXR9IEJFQVRTYDtcbn1cblxuZnVuY3Rpb24gY2xlYXJMZWFkZXJib2FyZCAoc3RhdGUpIHtcbiAgc3RhdGUubGVhZGVyYm9hcmQubGVuZ3RoID0gMDtcbiAgc3RhdGUubGVhZGVyYm9hcmQuX19kaXJ0eSA9IHRydWU7XG4gIHN0YXRlLmxlYWRlcmJvYXJkTmFtZXMgPSAnJztcbiAgc3RhdGUubGVhZGVyYm9hcmRTY29yZXMgPSAnJztcbiAgc3RhdGUubGVhZGVyYm9hcmRGZXRjaGVkID0gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZU1lbnVTb25nSW5mbyAoc3RhdGUsIGNoYWxsZW5nZSkge1xuICBzdGF0ZS5tZW51U2VsZWN0ZWRDaGFsbGVuZ2Uuc29uZ0luZm9UZXh0ID0gYEJ5ICR7dHJ1bmNhdGUoY2hhbGxlbmdlLmF1dGhvciwgMTIpfSAke2NoYWxsZW5nZS5nZW5yZSAmJiBjaGFsbGVuZ2UuZ2VucmUgIT09ICdVbmNhdGVnb3JpemVkJyA/ICcvICcgKyBjaGFsbGVuZ2UuZ2VucmUgOiAnJ31cXG4ke2NoYWxsZW5nZS5kb3dubG9hZHN9IERvd25sb2Fkc1xcblVwdm90ZXM6ICR7Y2hhbGxlbmdlLnVwdm90ZXN9IC8gRG93bnZvdGVzOiAke2NoYWxsZW5nZS5kb3dudm90ZXN9XFxuJHtmb3JtYXRTb25nTGVuZ3RoKGNoYWxsZW5nZS5zb25nRHVyYXRpb24pfSAvICR7Y2hhbGxlbmdlLm51bUJlYXRzW3N0YXRlLm1lbnVTZWxlY3RlZENoYWxsZW5nZS5kaWZmaWN1bHR5XX0gYmVhdHNgO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVTY29yZUFjY3VyYWN5IChzdGF0ZSkge1xuICAvLyBVcGRhdGUgbGl2ZSBhY2N1cmFjeS5cbiAgY29uc3QgY3VycmVudE51bUJlYXRzID0gc3RhdGUuc2NvcmUuYmVhdHNIaXQgKyBzdGF0ZS5zY29yZS5iZWF0c01pc3NlZDtcbiAgc3RhdGUuc2NvcmUuYWNjdXJhY3kgPSAoc3RhdGUuc2NvcmUuc2NvcmUgLyAoY3VycmVudE51bUJlYXRzICogMTEwKSkgKiAxMDA7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvc3RhdGUvaW5kZXguanMiLCJ2YXIgZXNjYXBlID0gcmVxdWlyZShcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2xpYi91cmwvZXNjYXBlLmpzXCIpO1xuZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1wiKShmYWxzZSk7XG4vLyBpbXBvcnRzXG5cblxuLy8gbW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCJodG1sIHtcXG4gIGJhY2tncm91bmQ6ICMwMDA7XFxufVxcblxcbiN2ckJ1dHRvbiB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICBiYWNrZ3JvdW5kOiB1cmwoXCIgKyBlc2NhcGUocmVxdWlyZShcIi4uL2Fzc2V0cy9pbWcvZW50ZXItdnItYnV0dG9uLWJhY2tncm91bmQucG5nXCIpKSArIFwiKSBuby1yZXBlYXQ7XFxuICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyO1xcbiAgYm9yZGVyOiAwO1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgcmlnaHQ6IDIwcHg7XFxuICBib3R0b206IDIwcHg7XFxuICB6LWluZGV4OiA5OTk5OTk5O1xcbiAgd2lkdGg6IDg0cHg7XFxuICBoZWlnaHQ6IDQ3cHg7XFxufVxcblxcbiN2ckJ1dHRvbi5hLWhpZGRlbiB7XFxuICB2aXNpYmlsaXR5OiBoaWRkZW47XFxufVxcblxcbiN2ckJ1dHRvbjphY3RpdmUge1xcbiAgYm9yZGVyOiAwO1xcbn1cXG5cXG4jdnJCdXR0b246aG92ZXIge1xcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogMCAtNTAuNXB4O1xcbn1cXG5cXG4uYS1sb2FkZXItdGl0bGUge1xcbiAgYW5pbWF0aW9uOiBsb2FkZXJUaXRsZSAxcyBpbmZpbml0ZSBhbHRlcm5hdGU7XFxuICBjb2xvcjogcmdiYSgwLDAsMCwwKTtcXG4gIGJhY2tncm91bmQ6IG5vbmU7XFxuICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCIgKyBlc2NhcGUocmVxdWlyZShcIi4uL2Fzc2V0cy9pbWcvbG9hZGluZ0xvZ28uanBnXCIpKSArIFwiKTtcXG4gIGhlaWdodDogMzYuMnZoO1xcbiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDtcXG4gIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjtcXG4gIG1hcmdpbi10b3A6IDA7XFxuICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XFxuICBtYXJnaW4tbGVmdDogLTF2aDtcXG59XFxuXFxuQGtleWZyYW1lcyBsb2FkZXJUaXRsZSB7XFxuICAwJSB7IG9wYWNpdHk6IDE7IH1cXG4gIDUwJSB7IG9wYWNpdHk6IDAuODsgfVxcbiAgMTAwJSB7IG9wYWNpdHk6IDE7IH1cXG59XFxuXFxuI3R1dG9yaWFsMmQge1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgd2lkdGg6IDYwJTtcXG4gIGxlZnQ6IDIwJTtcXG4gIHRvcDogMzUlO1xcbn1cXG5cXG5AbWVkaWEgKG1heC13aWR0aDogMTI4MHB4KSB7XFxuICAjdHV0b3JpYWwyZCB7XFxuICAgIHdpZHRoOiA4MCU7XFxuICAgIGxlZnQ6IDEwJTtcXG4gIH1cXG59XFxuXCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2Nzcy1sb2FkZXIhLi9zcmMvaW5kZXguY3NzXG4vLyBtb2R1bGUgaWQgPSAxMzVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLypcblx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcblx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxuKi9cbi8vIGNzcyBiYXNlIGNvZGUsIGluamVjdGVkIGJ5IHRoZSBjc3MtbG9hZGVyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHVzZVNvdXJjZU1hcCkge1xuXHR2YXIgbGlzdCA9IFtdO1xuXG5cdC8vIHJldHVybiB0aGUgbGlzdCBvZiBtb2R1bGVzIGFzIGNzcyBzdHJpbmdcblx0bGlzdC50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuXHRcdHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0dmFyIGNvbnRlbnQgPSBjc3NXaXRoTWFwcGluZ1RvU3RyaW5nKGl0ZW0sIHVzZVNvdXJjZU1hcCk7XG5cdFx0XHRpZihpdGVtWzJdKSB7XG5cdFx0XHRcdHJldHVybiBcIkBtZWRpYSBcIiArIGl0ZW1bMl0gKyBcIntcIiArIGNvbnRlbnQgKyBcIn1cIjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBjb250ZW50O1xuXHRcdFx0fVxuXHRcdH0pLmpvaW4oXCJcIik7XG5cdH07XG5cblx0Ly8gaW1wb3J0IGEgbGlzdCBvZiBtb2R1bGVzIGludG8gdGhlIGxpc3Rcblx0bGlzdC5pID0gZnVuY3Rpb24obW9kdWxlcywgbWVkaWFRdWVyeSkge1xuXHRcdGlmKHR5cGVvZiBtb2R1bGVzID09PSBcInN0cmluZ1wiKVxuXHRcdFx0bW9kdWxlcyA9IFtbbnVsbCwgbW9kdWxlcywgXCJcIl1dO1xuXHRcdHZhciBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzID0ge307XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBpZCA9IHRoaXNbaV1bMF07XG5cdFx0XHRpZih0eXBlb2YgaWQgPT09IFwibnVtYmVyXCIpXG5cdFx0XHRcdGFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaWRdID0gdHJ1ZTtcblx0XHR9XG5cdFx0Zm9yKGkgPSAwOyBpIDwgbW9kdWxlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGl0ZW0gPSBtb2R1bGVzW2ldO1xuXHRcdFx0Ly8gc2tpcCBhbHJlYWR5IGltcG9ydGVkIG1vZHVsZVxuXHRcdFx0Ly8gdGhpcyBpbXBsZW1lbnRhdGlvbiBpcyBub3QgMTAwJSBwZXJmZWN0IGZvciB3ZWlyZCBtZWRpYSBxdWVyeSBjb21iaW5hdGlvbnNcblx0XHRcdC8vICB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXG5cdFx0XHQvLyAgSSBob3BlIHRoaXMgd2lsbCBuZXZlciBvY2N1ciAoSGV5IHRoaXMgd2F5IHdlIGhhdmUgc21hbGxlciBidW5kbGVzKVxuXHRcdFx0aWYodHlwZW9mIGl0ZW1bMF0gIT09IFwibnVtYmVyXCIgfHwgIWFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaXRlbVswXV0pIHtcblx0XHRcdFx0aWYobWVkaWFRdWVyeSAmJiAhaXRlbVsyXSkge1xuXHRcdFx0XHRcdGl0ZW1bMl0gPSBtZWRpYVF1ZXJ5O1xuXHRcdFx0XHR9IGVsc2UgaWYobWVkaWFRdWVyeSkge1xuXHRcdFx0XHRcdGl0ZW1bMl0gPSBcIihcIiArIGl0ZW1bMl0gKyBcIikgYW5kIChcIiArIG1lZGlhUXVlcnkgKyBcIilcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHRsaXN0LnB1c2goaXRlbSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXHRyZXR1cm4gbGlzdDtcbn07XG5cbmZ1bmN0aW9uIGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKSB7XG5cdHZhciBjb250ZW50ID0gaXRlbVsxXSB8fCAnJztcblx0dmFyIGNzc01hcHBpbmcgPSBpdGVtWzNdO1xuXHRpZiAoIWNzc01hcHBpbmcpIHtcblx0XHRyZXR1cm4gY29udGVudDtcblx0fVxuXG5cdGlmICh1c2VTb3VyY2VNYXAgJiYgdHlwZW9mIGJ0b2EgPT09ICdmdW5jdGlvbicpIHtcblx0XHR2YXIgc291cmNlTWFwcGluZyA9IHRvQ29tbWVudChjc3NNYXBwaW5nKTtcblx0XHR2YXIgc291cmNlVVJMcyA9IGNzc01hcHBpbmcuc291cmNlcy5tYXAoZnVuY3Rpb24gKHNvdXJjZSkge1xuXHRcdFx0cmV0dXJuICcvKiMgc291cmNlVVJMPScgKyBjc3NNYXBwaW5nLnNvdXJjZVJvb3QgKyBzb3VyY2UgKyAnICovJ1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIFtjb250ZW50XS5jb25jYXQoc291cmNlVVJMcykuY29uY2F0KFtzb3VyY2VNYXBwaW5nXSkuam9pbignXFxuJyk7XG5cdH1cblxuXHRyZXR1cm4gW2NvbnRlbnRdLmpvaW4oJ1xcbicpO1xufVxuXG4vLyBBZGFwdGVkIGZyb20gY29udmVydC1zb3VyY2UtbWFwIChNSVQpXG5mdW5jdGlvbiB0b0NvbW1lbnQoc291cmNlTWFwKSB7XG5cdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZlxuXHR2YXIgYmFzZTY0ID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKTtcblx0dmFyIGRhdGEgPSAnc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtODtiYXNlNjQsJyArIGJhc2U2NDtcblxuXHRyZXR1cm4gJy8qIyAnICsgZGF0YSArICcgKi8nO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2Nzcy1sb2FkZXIvbGliL2Nzcy1iYXNlLmpzXG4vLyBtb2R1bGUgaWQgPSAxMzZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlc2NhcGUodXJsKSB7XG4gICAgaWYgKHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiB1cmxcbiAgICB9XG4gICAgLy8gSWYgdXJsIGlzIGFscmVhZHkgd3JhcHBlZCBpbiBxdW90ZXMsIHJlbW92ZSB0aGVtXG4gICAgaWYgKC9eWydcIl0uKlsnXCJdJC8udGVzdCh1cmwpKSB7XG4gICAgICAgIHVybCA9IHVybC5zbGljZSgxLCAtMSk7XG4gICAgfVxuICAgIC8vIFNob3VsZCB1cmwgYmUgd3JhcHBlZD9cbiAgICAvLyBTZWUgaHR0cHM6Ly9kcmFmdHMuY3Nzd2cub3JnL2Nzcy12YWx1ZXMtMy8jdXJsc1xuICAgIGlmICgvW1wiJygpIFxcdFxcbl0vLnRlc3QodXJsKSkge1xuICAgICAgICByZXR1cm4gJ1wiJyArIHVybC5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJykucmVwbGFjZSgvXFxuL2csICdcXFxcbicpICsgJ1wiJ1xuICAgIH1cblxuICAgIHJldHVybiB1cmxcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9jc3MtbG9hZGVyL2xpYi91cmwvZXNjYXBlLmpzXG4vLyBtb2R1bGUgaWQgPSAxMzdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiXG4vKipcbiAqIFRoaXMgaXMgdGhlIGNvbW1vbiBsb2dpYyBmb3IgYm90aCB0aGUgTm9kZS5qcyBhbmQgd2ViIGJyb3dzZXJcbiAqIGltcGxlbWVudGF0aW9ucyBvZiBgZGVidWcoKWAuXG4gKlxuICogRXhwb3NlIGBkZWJ1ZygpYCBhcyB0aGUgbW9kdWxlLlxuICovXG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGRlYnVnO1xuZXhwb3J0cy5jb2VyY2UgPSBjb2VyY2U7XG5leHBvcnRzLmRpc2FibGUgPSBkaXNhYmxlO1xuZXhwb3J0cy5lbmFibGUgPSBlbmFibGU7XG5leHBvcnRzLmVuYWJsZWQgPSBlbmFibGVkO1xuXG4vKipcbiAqIFRoZSBjdXJyZW50bHkgYWN0aXZlIGRlYnVnIG1vZGUgbmFtZXMsIGFuZCBuYW1lcyB0byBza2lwLlxuICovXG5cbmV4cG9ydHMubmFtZXMgPSBbXTtcbmV4cG9ydHMuc2tpcHMgPSBbXTtcblxuLyoqXG4gKiBNYXAgb2Ygc3BlY2lhbCBcIiVuXCIgaGFuZGxpbmcgZnVuY3Rpb25zLCBmb3IgdGhlIGRlYnVnIFwiZm9ybWF0XCIgYXJndW1lbnQuXG4gKlxuICogVmFsaWQga2V5IG5hbWVzIGFyZSBhIHNpbmdsZSwgbG93ZXJjYXNlZCBsZXR0ZXIsIGkuZS4gXCJuXCIuXG4gKi9cblxuZXhwb3J0cy5mb3JtYXR0ZXJzID0ge307XG5cbi8qKlxuICogUHJldmlvdXNseSBhc3NpZ25lZCBjb2xvci5cbiAqL1xuXG52YXIgcHJldkNvbG9yID0gMDtcblxuLyoqXG4gKiBTZWxlY3QgYSBjb2xvci5cbiAqXG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBzZWxlY3RDb2xvcigpIHtcbiAgcmV0dXJuIGV4cG9ydHMuY29sb3JzW3ByZXZDb2xvcisrICUgZXhwb3J0cy5jb2xvcnMubGVuZ3RoXTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBkZWJ1Z2dlciB3aXRoIHRoZSBnaXZlbiBgbmFtZXNwYWNlYC5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZXNwYWNlXG4gKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gZGVidWcobmFtZXNwYWNlKSB7XG5cbiAgLy8gZGVmaW5lIHRoZSBgZGlzYWJsZWRgIHZlcnNpb25cbiAgZnVuY3Rpb24gZGlzYWJsZWQoKSB7XG4gIH1cbiAgZGlzYWJsZWQuZW5hYmxlZCA9IGZhbHNlO1xuXG4gIC8vIGRlZmluZSB0aGUgYGVuYWJsZWRgIHZlcnNpb25cbiAgZnVuY3Rpb24gZW5hYmxlZCgpIHtcblxuICAgIHZhciBzZWxmID0gZW5hYmxlZDtcblxuICAgIC8vIGFkZCB0aGUgYGNvbG9yYCBpZiBub3Qgc2V0XG4gICAgaWYgKG51bGwgPT0gc2VsZi51c2VDb2xvcnMpIHNlbGYudXNlQ29sb3JzID0gZXhwb3J0cy51c2VDb2xvcnMoKTtcbiAgICBpZiAobnVsbCA9PSBzZWxmLmNvbG9yICYmIHNlbGYudXNlQ29sb3JzKSBzZWxmLmNvbG9yID0gc2VsZWN0Q29sb3IoKTtcblxuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcblxuICAgIGFyZ3NbMF0gPSBleHBvcnRzLmNvZXJjZShhcmdzWzBdKTtcblxuICAgIGlmICgnc3RyaW5nJyAhPT0gdHlwZW9mIGFyZ3NbMF0pIHtcbiAgICAgIC8vIGFueXRoaW5nIGVsc2UgbGV0J3MgaW5zcGVjdCB3aXRoICVvXG4gICAgICBhcmdzID0gWyclbyddLmNvbmNhdChhcmdzKTtcbiAgICB9XG5cbiAgICAvLyBhcHBseSBhbnkgYGZvcm1hdHRlcnNgIHRyYW5zZm9ybWF0aW9uc1xuICAgIHZhciBpbmRleCA9IDA7XG4gICAgYXJnc1swXSA9IGFyZ3NbMF0ucmVwbGFjZSgvJShbYS16JV0pL2csIGZ1bmN0aW9uKG1hdGNoLCBmb3JtYXQpIHtcbiAgICAgIC8vIGlmIHdlIGVuY291bnRlciBhbiBlc2NhcGVkICUgdGhlbiBkb24ndCBpbmNyZWFzZSB0aGUgYXJyYXkgaW5kZXhcbiAgICAgIGlmIChtYXRjaCA9PT0gJyUlJykgcmV0dXJuIG1hdGNoO1xuICAgICAgaW5kZXgrKztcbiAgICAgIHZhciBmb3JtYXR0ZXIgPSBleHBvcnRzLmZvcm1hdHRlcnNbZm9ybWF0XTtcbiAgICAgIGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2YgZm9ybWF0dGVyKSB7XG4gICAgICAgIHZhciB2YWwgPSBhcmdzW2luZGV4XTtcbiAgICAgICAgbWF0Y2ggPSBmb3JtYXR0ZXIuY2FsbChzZWxmLCB2YWwpO1xuXG4gICAgICAgIC8vIG5vdyB3ZSBuZWVkIHRvIHJlbW92ZSBgYXJnc1tpbmRleF1gIHNpbmNlIGl0J3MgaW5saW5lZCBpbiB0aGUgYGZvcm1hdGBcbiAgICAgICAgYXJncy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBpbmRleC0tO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1hdGNoO1xuICAgIH0pO1xuXG4gICAgaWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBleHBvcnRzLmZvcm1hdEFyZ3MpIHtcbiAgICAgIGFyZ3MgPSBleHBvcnRzLmZvcm1hdEFyZ3MuYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgfVxuICAgIHZhciBsb2dGbiA9IGVuYWJsZWQubG9nIHx8IGV4cG9ydHMubG9nIHx8IGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSk7XG4gICAgbG9nRm4uYXBwbHkoc2VsZiwgYXJncyk7XG4gIH1cbiAgZW5hYmxlZC5lbmFibGVkID0gdHJ1ZTtcblxuICB2YXIgZm4gPSBleHBvcnRzLmVuYWJsZWQobmFtZXNwYWNlKSA/IGVuYWJsZWQgOiBkaXNhYmxlZDtcblxuICBmbi5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XG5cbiAgcmV0dXJuIGZuO1xufVxuXG4vKipcbiAqIEVuYWJsZXMgYSBkZWJ1ZyBtb2RlIGJ5IG5hbWVzcGFjZXMuIFRoaXMgY2FuIGluY2x1ZGUgbW9kZXNcbiAqIHNlcGFyYXRlZCBieSBhIGNvbG9uIGFuZCB3aWxkY2FyZHMuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVzcGFjZXNcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuZnVuY3Rpb24gZW5hYmxlKG5hbWVzcGFjZXMpIHtcbiAgZXhwb3J0cy5zYXZlKG5hbWVzcGFjZXMpO1xuXG4gIHZhciBzcGxpdCA9IChuYW1lc3BhY2VzIHx8ICcnKS5zcGxpdCgvW1xccyxdKy8pO1xuICB2YXIgbGVuID0gc3BsaXQubGVuZ3RoO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICBpZiAoIXNwbGl0W2ldKSBjb250aW51ZTsgLy8gaWdub3JlIGVtcHR5IHN0cmluZ3NcbiAgICBuYW1lc3BhY2VzID0gc3BsaXRbaV0ucmVwbGFjZSgvXFwqL2csICcuKj8nKTtcbiAgICBpZiAobmFtZXNwYWNlc1swXSA9PT0gJy0nKSB7XG4gICAgICBleHBvcnRzLnNraXBzLnB1c2gobmV3IFJlZ0V4cCgnXicgKyBuYW1lc3BhY2VzLnN1YnN0cigxKSArICckJykpO1xuICAgIH0gZWxzZSB7XG4gICAgICBleHBvcnRzLm5hbWVzLnB1c2gobmV3IFJlZ0V4cCgnXicgKyBuYW1lc3BhY2VzICsgJyQnKSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRGlzYWJsZSBkZWJ1ZyBvdXRwdXQuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBkaXNhYmxlKCkge1xuICBleHBvcnRzLmVuYWJsZSgnJyk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBtb2RlIG5hbWUgaXMgZW5hYmxlZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gKiBAcmV0dXJuIHtCb29sZWFufVxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5mdW5jdGlvbiBlbmFibGVkKG5hbWUpIHtcbiAgdmFyIGksIGxlbjtcbiAgZm9yIChpID0gMCwgbGVuID0gZXhwb3J0cy5za2lwcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIGlmIChleHBvcnRzLnNraXBzW2ldLnRlc3QobmFtZSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgZm9yIChpID0gMCwgbGVuID0gZXhwb3J0cy5uYW1lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIGlmIChleHBvcnRzLm5hbWVzW2ldLnRlc3QobmFtZSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQ29lcmNlIGB2YWxgLlxuICpcbiAqIEBwYXJhbSB7TWl4ZWR9IHZhbFxuICogQHJldHVybiB7TWl4ZWR9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5mdW5jdGlvbiBjb2VyY2UodmFsKSB7XG4gIGlmICh2YWwgaW5zdGFuY2VvZiBFcnJvcikgcmV0dXJuIHZhbC5zdGFjayB8fCB2YWwubWVzc2FnZTtcbiAgcmV0dXJuIHZhbDtcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9kZWJ1Zy9kZWJ1Zy5qc1xuLy8gbW9kdWxlIGlkID0gMTM4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qIVxuICogQG92ZXJ2aWV3IGVzNi1wcm9taXNlIC0gYSB0aW55IGltcGxlbWVudGF0aW9uIG9mIFByb21pc2VzL0ErLlxuICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTQgWWVodWRhIEthdHosIFRvbSBEYWxlLCBTdGVmYW4gUGVubmVyIGFuZCBjb250cmlidXRvcnMgKENvbnZlcnNpb24gdG8gRVM2IEFQSSBieSBKYWtlIEFyY2hpYmFsZClcbiAqIEBsaWNlbnNlICAgTGljZW5zZWQgdW5kZXIgTUlUIGxpY2Vuc2VcbiAqICAgICAgICAgICAgU2VlIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGVmYW5wZW5uZXIvZXM2LXByb21pc2UvbWFzdGVyL0xJQ0VOU0VcbiAqIEB2ZXJzaW9uICAgdjQuMi40KzMxNGU0ODMxXG4gKi9cblxuKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcblx0dHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuXHR0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOlxuXHQoZ2xvYmFsLkVTNlByb21pc2UgPSBmYWN0b3J5KCkpO1xufSh0aGlzLCAoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIG9iamVjdE9yRnVuY3Rpb24oeCkge1xuICB2YXIgdHlwZSA9IHR5cGVvZiB4O1xuICByZXR1cm4geCAhPT0gbnVsbCAmJiAodHlwZSA9PT0gJ29iamVjdCcgfHwgdHlwZSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oeCkge1xuICByZXR1cm4gdHlwZW9mIHggPT09ICdmdW5jdGlvbic7XG59XG5cblxuXG52YXIgX2lzQXJyYXkgPSB2b2lkIDA7XG5pZiAoQXJyYXkuaXNBcnJheSkge1xuICBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXk7XG59IGVsc2Uge1xuICBfaXNBcnJheSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4KSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgfTtcbn1cblxudmFyIGlzQXJyYXkgPSBfaXNBcnJheTtcblxudmFyIGxlbiA9IDA7XG52YXIgdmVydHhOZXh0ID0gdm9pZCAwO1xudmFyIGN1c3RvbVNjaGVkdWxlckZuID0gdm9pZCAwO1xuXG52YXIgYXNhcCA9IGZ1bmN0aW9uIGFzYXAoY2FsbGJhY2ssIGFyZykge1xuICBxdWV1ZVtsZW5dID0gY2FsbGJhY2s7XG4gIHF1ZXVlW2xlbiArIDFdID0gYXJnO1xuICBsZW4gKz0gMjtcbiAgaWYgKGxlbiA9PT0gMikge1xuICAgIC8vIElmIGxlbiBpcyAyLCB0aGF0IG1lYW5zIHRoYXQgd2UgbmVlZCB0byBzY2hlZHVsZSBhbiBhc3luYyBmbHVzaC5cbiAgICAvLyBJZiBhZGRpdGlvbmFsIGNhbGxiYWNrcyBhcmUgcXVldWVkIGJlZm9yZSB0aGUgcXVldWUgaXMgZmx1c2hlZCwgdGhleVxuICAgIC8vIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IHRoaXMgZmx1c2ggdGhhdCB3ZSBhcmUgc2NoZWR1bGluZy5cbiAgICBpZiAoY3VzdG9tU2NoZWR1bGVyRm4pIHtcbiAgICAgIGN1c3RvbVNjaGVkdWxlckZuKGZsdXNoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2NoZWR1bGVGbHVzaCgpO1xuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gc2V0U2NoZWR1bGVyKHNjaGVkdWxlRm4pIHtcbiAgY3VzdG9tU2NoZWR1bGVyRm4gPSBzY2hlZHVsZUZuO1xufVxuXG5mdW5jdGlvbiBzZXRBc2FwKGFzYXBGbikge1xuICBhc2FwID0gYXNhcEZuO1xufVxuXG52YXIgYnJvd3NlcldpbmRvdyA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdW5kZWZpbmVkO1xudmFyIGJyb3dzZXJHbG9iYWwgPSBicm93c2VyV2luZG93IHx8IHt9O1xudmFyIEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyID0gYnJvd3Nlckdsb2JhbC5NdXRhdGlvbk9ic2VydmVyIHx8IGJyb3dzZXJHbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcjtcbnZhciBpc05vZGUgPSB0eXBlb2Ygc2VsZiA9PT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHt9LnRvU3RyaW5nLmNhbGwocHJvY2VzcykgPT09ICdbb2JqZWN0IHByb2Nlc3NdJztcblxuLy8gdGVzdCBmb3Igd2ViIHdvcmtlciBidXQgbm90IGluIElFMTBcbnZhciBpc1dvcmtlciA9IHR5cGVvZiBVaW50OENsYW1wZWRBcnJheSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGltcG9ydFNjcmlwdHMgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBNZXNzYWdlQ2hhbm5lbCAhPT0gJ3VuZGVmaW5lZCc7XG5cbi8vIG5vZGVcbmZ1bmN0aW9uIHVzZU5leHRUaWNrKCkge1xuICAvLyBub2RlIHZlcnNpb24gMC4xMC54IGRpc3BsYXlzIGEgZGVwcmVjYXRpb24gd2FybmluZyB3aGVuIG5leHRUaWNrIGlzIHVzZWQgcmVjdXJzaXZlbHlcbiAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9jdWpvanMvd2hlbi9pc3N1ZXMvNDEwIGZvciBkZXRhaWxzXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpO1xuICB9O1xufVxuXG4vLyB2ZXJ0eFxuZnVuY3Rpb24gdXNlVmVydHhUaW1lcigpIHtcbiAgaWYgKHR5cGVvZiB2ZXJ0eE5leHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZlcnR4TmV4dChmbHVzaCk7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB1c2VTZXRUaW1lb3V0KCk7XG59XG5cbmZ1bmN0aW9uIHVzZU11dGF0aW9uT2JzZXJ2ZXIoKSB7XG4gIHZhciBpdGVyYXRpb25zID0gMDtcbiAgdmFyIG9ic2VydmVyID0gbmV3IEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyKGZsdXNoKTtcbiAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7XG4gIG9ic2VydmVyLm9ic2VydmUobm9kZSwgeyBjaGFyYWN0ZXJEYXRhOiB0cnVlIH0pO1xuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgbm9kZS5kYXRhID0gaXRlcmF0aW9ucyA9ICsraXRlcmF0aW9ucyAlIDI7XG4gIH07XG59XG5cbi8vIHdlYiB3b3JrZXJcbmZ1bmN0aW9uIHVzZU1lc3NhZ2VDaGFubmVsKCkge1xuICB2YXIgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpO1xuICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGZsdXNoO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjaGFubmVsLnBvcnQyLnBvc3RNZXNzYWdlKDApO1xuICB9O1xufVxuXG5mdW5jdGlvbiB1c2VTZXRUaW1lb3V0KCkge1xuICAvLyBTdG9yZSBzZXRUaW1lb3V0IHJlZmVyZW5jZSBzbyBlczYtcHJvbWlzZSB3aWxsIGJlIHVuYWZmZWN0ZWQgYnlcbiAgLy8gb3RoZXIgY29kZSBtb2RpZnlpbmcgc2V0VGltZW91dCAobGlrZSBzaW5vbi51c2VGYWtlVGltZXJzKCkpXG4gIHZhciBnbG9iYWxTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZ2xvYmFsU2V0VGltZW91dChmbHVzaCwgMSk7XG4gIH07XG59XG5cbnZhciBxdWV1ZSA9IG5ldyBBcnJheSgxMDAwKTtcbmZ1bmN0aW9uIGZsdXNoKCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgdmFyIGNhbGxiYWNrID0gcXVldWVbaV07XG4gICAgdmFyIGFyZyA9IHF1ZXVlW2kgKyAxXTtcblxuICAgIGNhbGxiYWNrKGFyZyk7XG5cbiAgICBxdWV1ZVtpXSA9IHVuZGVmaW5lZDtcbiAgICBxdWV1ZVtpICsgMV0gPSB1bmRlZmluZWQ7XG4gIH1cblxuICBsZW4gPSAwO1xufVxuXG5mdW5jdGlvbiBhdHRlbXB0VmVydHgoKSB7XG4gIHRyeSB7XG4gICAgdmFyIHZlcnR4ID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKS5yZXF1aXJlKCd2ZXJ0eCcpO1xuICAgIHZlcnR4TmV4dCA9IHZlcnR4LnJ1bk9uTG9vcCB8fCB2ZXJ0eC5ydW5PbkNvbnRleHQ7XG4gICAgcmV0dXJuIHVzZVZlcnR4VGltZXIoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB1c2VTZXRUaW1lb3V0KCk7XG4gIH1cbn1cblxudmFyIHNjaGVkdWxlRmx1c2ggPSB2b2lkIDA7XG4vLyBEZWNpZGUgd2hhdCBhc3luYyBtZXRob2QgdG8gdXNlIHRvIHRyaWdnZXJpbmcgcHJvY2Vzc2luZyBvZiBxdWV1ZWQgY2FsbGJhY2tzOlxuaWYgKGlzTm9kZSkge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTmV4dFRpY2soKTtcbn0gZWxzZSBpZiAoQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgc2NoZWR1bGVGbHVzaCA9IHVzZU11dGF0aW9uT2JzZXJ2ZXIoKTtcbn0gZWxzZSBpZiAoaXNXb3JrZXIpIHtcbiAgc2NoZWR1bGVGbHVzaCA9IHVzZU1lc3NhZ2VDaGFubmVsKCk7XG59IGVsc2UgaWYgKGJyb3dzZXJXaW5kb3cgPT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgcmVxdWlyZSA9PT0gJ2Z1bmN0aW9uJykge1xuICBzY2hlZHVsZUZsdXNoID0gYXR0ZW1wdFZlcnR4KCk7XG59IGVsc2Uge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlU2V0VGltZW91dCgpO1xufVxuXG5mdW5jdGlvbiB0aGVuKG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG4gIHZhciBwYXJlbnQgPSB0aGlzO1xuXG4gIHZhciBjaGlsZCA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG5vb3ApO1xuXG4gIGlmIChjaGlsZFtQUk9NSVNFX0lEXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbWFrZVByb21pc2UoY2hpbGQpO1xuICB9XG5cbiAgdmFyIF9zdGF0ZSA9IHBhcmVudC5fc3RhdGU7XG5cblxuICBpZiAoX3N0YXRlKSB7XG4gICAgdmFyIGNhbGxiYWNrID0gYXJndW1lbnRzW19zdGF0ZSAtIDFdO1xuICAgIGFzYXAoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGludm9rZUNhbGxiYWNrKF9zdGF0ZSwgY2hpbGQsIGNhbGxiYWNrLCBwYXJlbnQuX3Jlc3VsdCk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKTtcbiAgfVxuXG4gIHJldHVybiBjaGlsZDtcbn1cblxuLyoqXG4gIGBQcm9taXNlLnJlc29sdmVgIHJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCBiZWNvbWUgcmVzb2x2ZWQgd2l0aCB0aGVcbiAgcGFzc2VkIGB2YWx1ZWAuIEl0IGlzIHNob3J0aGFuZCBmb3IgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICByZXNvbHZlKDEpO1xuICB9KTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgIC8vIHZhbHVlID09PSAxXG4gIH0pO1xuICBgYGBcblxuICBJbnN0ZWFkIG9mIHdyaXRpbmcgdGhlIGFib3ZlLCB5b3VyIGNvZGUgbm93IHNpbXBseSBiZWNvbWVzIHRoZSBmb2xsb3dpbmc6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgxKTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgIC8vIHZhbHVlID09PSAxXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIHJlc29sdmVcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FueX0gdmFsdWUgdmFsdWUgdGhhdCB0aGUgcmV0dXJuZWQgcHJvbWlzZSB3aWxsIGJlIHJlc29sdmVkIHdpdGhcbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2UgdGhhdCB3aWxsIGJlY29tZSBmdWxmaWxsZWQgd2l0aCB0aGUgZ2l2ZW5cbiAgYHZhbHVlYFxuKi9cbmZ1bmN0aW9uIHJlc29sdmUkMShvYmplY3QpIHtcbiAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcblxuICBpZiAob2JqZWN0ICYmIHR5cGVvZiBvYmplY3QgPT09ICdvYmplY3QnICYmIG9iamVjdC5jb25zdHJ1Y3RvciA9PT0gQ29uc3RydWN0b3IpIHtcbiAgICByZXR1cm4gb2JqZWN0O1xuICB9XG5cbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3Iobm9vcCk7XG4gIHJlc29sdmUocHJvbWlzZSwgb2JqZWN0KTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cbnZhciBQUk9NSVNFX0lEID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIpO1xuXG5mdW5jdGlvbiBub29wKCkge31cblxudmFyIFBFTkRJTkcgPSB2b2lkIDA7XG52YXIgRlVMRklMTEVEID0gMTtcbnZhciBSRUpFQ1RFRCA9IDI7XG5cbnZhciBUUllfQ0FUQ0hfRVJST1IgPSB7IGVycm9yOiBudWxsIH07XG5cbmZ1bmN0aW9uIHNlbGZGdWxmaWxsbWVudCgpIHtcbiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoXCJZb3UgY2Fubm90IHJlc29sdmUgYSBwcm9taXNlIHdpdGggaXRzZWxmXCIpO1xufVxuXG5mdW5jdGlvbiBjYW5ub3RSZXR1cm5Pd24oKSB7XG4gIHJldHVybiBuZXcgVHlwZUVycm9yKCdBIHByb21pc2VzIGNhbGxiYWNrIGNhbm5vdCByZXR1cm4gdGhhdCBzYW1lIHByb21pc2UuJyk7XG59XG5cbmZ1bmN0aW9uIGdldFRoZW4ocHJvbWlzZSkge1xuICB0cnkge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgVFJZX0NBVENIX0VSUk9SLmVycm9yID0gZXJyb3I7XG4gICAgcmV0dXJuIFRSWV9DQVRDSF9FUlJPUjtcbiAgfVxufVxuXG5mdW5jdGlvbiB0cnlUaGVuKHRoZW4kJDEsIHZhbHVlLCBmdWxmaWxsbWVudEhhbmRsZXIsIHJlamVjdGlvbkhhbmRsZXIpIHtcbiAgdHJ5IHtcbiAgICB0aGVuJCQxLmNhbGwodmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUsIHRoZW4kJDEpIHtcbiAgYXNhcChmdW5jdGlvbiAocHJvbWlzZSkge1xuICAgIHZhciBzZWFsZWQgPSBmYWxzZTtcbiAgICB2YXIgZXJyb3IgPSB0cnlUaGVuKHRoZW4kJDEsIHRoZW5hYmxlLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIGlmIChzZWFsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2VhbGVkID0gdHJ1ZTtcbiAgICAgIGlmICh0aGVuYWJsZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICBpZiAoc2VhbGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHNlYWxlZCA9IHRydWU7XG5cbiAgICAgIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgIH0sICdTZXR0bGU6ICcgKyAocHJvbWlzZS5fbGFiZWwgfHwgJyB1bmtub3duIHByb21pc2UnKSk7XG5cbiAgICBpZiAoIXNlYWxlZCAmJiBlcnJvcikge1xuICAgICAgc2VhbGVkID0gdHJ1ZTtcbiAgICAgIHJlamVjdChwcm9taXNlLCBlcnJvcik7XG4gICAgfVxuICB9LCBwcm9taXNlKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlT3duVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUpIHtcbiAgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gRlVMRklMTEVEKSB7XG4gICAgZnVsZmlsbChwcm9taXNlLCB0aGVuYWJsZS5fcmVzdWx0KTtcbiAgfSBlbHNlIGlmICh0aGVuYWJsZS5fc3RhdGUgPT09IFJFSkVDVEVEKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuICB9IGVsc2Uge1xuICAgIHN1YnNjcmliZSh0aGVuYWJsZSwgdW5kZWZpbmVkLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICByZXR1cm4gcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuJCQxKSB7XG4gIGlmIChtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yID09PSBwcm9taXNlLmNvbnN0cnVjdG9yICYmIHRoZW4kJDEgPT09IHRoZW4gJiYgbWF5YmVUaGVuYWJsZS5jb25zdHJ1Y3Rvci5yZXNvbHZlID09PSByZXNvbHZlJDEpIHtcbiAgICBoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAodGhlbiQkMSA9PT0gVFJZX0NBVENIX0VSUk9SKSB7XG4gICAgICByZWplY3QocHJvbWlzZSwgVFJZX0NBVENIX0VSUk9SLmVycm9yKTtcbiAgICAgIFRSWV9DQVRDSF9FUlJPUi5lcnJvciA9IG51bGw7XG4gICAgfSBlbHNlIGlmICh0aGVuJCQxID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG4gICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoZW4kJDEpKSB7XG4gICAgICBoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSwgdGhlbiQkMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpIHtcbiAgaWYgKHByb21pc2UgPT09IHZhbHVlKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHNlbGZGdWxmaWxsbWVudCgpKTtcbiAgfSBlbHNlIGlmIChvYmplY3RPckZ1bmN0aW9uKHZhbHVlKSkge1xuICAgIGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgdmFsdWUsIGdldFRoZW4odmFsdWUpKTtcbiAgfSBlbHNlIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwdWJsaXNoUmVqZWN0aW9uKHByb21pc2UpIHtcbiAgaWYgKHByb21pc2UuX29uZXJyb3IpIHtcbiAgICBwcm9taXNlLl9vbmVycm9yKHByb21pc2UuX3Jlc3VsdCk7XG4gIH1cblxuICBwdWJsaXNoKHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBmdWxmaWxsKHByb21pc2UsIHZhbHVlKSB7XG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHByb21pc2UuX3Jlc3VsdCA9IHZhbHVlO1xuICBwcm9taXNlLl9zdGF0ZSA9IEZVTEZJTExFRDtcblxuICBpZiAocHJvbWlzZS5fc3Vic2NyaWJlcnMubGVuZ3RoICE9PSAwKSB7XG4gICAgYXNhcChwdWJsaXNoLCBwcm9taXNlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZWplY3QocHJvbWlzZSwgcmVhc29uKSB7XG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIHJldHVybjtcbiAgfVxuICBwcm9taXNlLl9zdGF0ZSA9IFJFSkVDVEVEO1xuICBwcm9taXNlLl9yZXN1bHQgPSByZWFzb247XG5cbiAgYXNhcChwdWJsaXNoUmVqZWN0aW9uLCBwcm9taXNlKTtcbn1cblxuZnVuY3Rpb24gc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG4gIHZhciBfc3Vic2NyaWJlcnMgPSBwYXJlbnQuX3N1YnNjcmliZXJzO1xuICB2YXIgbGVuZ3RoID0gX3N1YnNjcmliZXJzLmxlbmd0aDtcblxuXG4gIHBhcmVudC5fb25lcnJvciA9IG51bGw7XG5cbiAgX3N1YnNjcmliZXJzW2xlbmd0aF0gPSBjaGlsZDtcbiAgX3N1YnNjcmliZXJzW2xlbmd0aCArIEZVTEZJTExFRF0gPSBvbkZ1bGZpbGxtZW50O1xuICBfc3Vic2NyaWJlcnNbbGVuZ3RoICsgUkVKRUNURURdID0gb25SZWplY3Rpb247XG5cbiAgaWYgKGxlbmd0aCA9PT0gMCAmJiBwYXJlbnQuX3N0YXRlKSB7XG4gICAgYXNhcChwdWJsaXNoLCBwYXJlbnQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2gocHJvbWlzZSkge1xuICB2YXIgc3Vic2NyaWJlcnMgPSBwcm9taXNlLl9zdWJzY3JpYmVycztcbiAgdmFyIHNldHRsZWQgPSBwcm9taXNlLl9zdGF0ZTtcblxuICBpZiAoc3Vic2NyaWJlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNoaWxkID0gdm9pZCAwLFxuICAgICAgY2FsbGJhY2sgPSB2b2lkIDAsXG4gICAgICBkZXRhaWwgPSBwcm9taXNlLl9yZXN1bHQ7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJzY3JpYmVycy5sZW5ndGg7IGkgKz0gMykge1xuICAgIGNoaWxkID0gc3Vic2NyaWJlcnNbaV07XG4gICAgY2FsbGJhY2sgPSBzdWJzY3JpYmVyc1tpICsgc2V0dGxlZF07XG5cbiAgICBpZiAoY2hpbGQpIHtcbiAgICAgIGludm9rZUNhbGxiYWNrKHNldHRsZWQsIGNoaWxkLCBjYWxsYmFjaywgZGV0YWlsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FsbGJhY2soZGV0YWlsKTtcbiAgICB9XG4gIH1cblxuICBwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggPSAwO1xufVxuXG5mdW5jdGlvbiB0cnlDYXRjaChjYWxsYmFjaywgZGV0YWlsKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrKGRldGFpbCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBUUllfQ0FUQ0hfRVJST1IuZXJyb3IgPSBlO1xuICAgIHJldHVybiBUUllfQ0FUQ0hfRVJST1I7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW52b2tlQ2FsbGJhY2soc2V0dGxlZCwgcHJvbWlzZSwgY2FsbGJhY2ssIGRldGFpbCkge1xuICB2YXIgaGFzQ2FsbGJhY2sgPSBpc0Z1bmN0aW9uKGNhbGxiYWNrKSxcbiAgICAgIHZhbHVlID0gdm9pZCAwLFxuICAgICAgZXJyb3IgPSB2b2lkIDAsXG4gICAgICBzdWNjZWVkZWQgPSB2b2lkIDAsXG4gICAgICBmYWlsZWQgPSB2b2lkIDA7XG5cbiAgaWYgKGhhc0NhbGxiYWNrKSB7XG4gICAgdmFsdWUgPSB0cnlDYXRjaChjYWxsYmFjaywgZGV0YWlsKTtcblxuICAgIGlmICh2YWx1ZSA9PT0gVFJZX0NBVENIX0VSUk9SKSB7XG4gICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgZXJyb3IgPSB2YWx1ZS5lcnJvcjtcbiAgICAgIHZhbHVlLmVycm9yID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VjY2VlZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCBjYW5ub3RSZXR1cm5Pd24oKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhbHVlID0gZGV0YWlsO1xuICAgIHN1Y2NlZWRlZCA9IHRydWU7XG4gIH1cblxuICBpZiAocHJvbWlzZS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcbiAgICAvLyBub29wXG4gIH0gZWxzZSBpZiAoaGFzQ2FsbGJhY2sgJiYgc3VjY2VlZGVkKSB7XG4gICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gIH0gZWxzZSBpZiAoZmFpbGVkKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTtcbiAgfSBlbHNlIGlmIChzZXR0bGVkID09PSBGVUxGSUxMRUQpIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgfSBlbHNlIGlmIChzZXR0bGVkID09PSBSRUpFQ1RFRCkge1xuICAgIHJlamVjdChwcm9taXNlLCB2YWx1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdGlhbGl6ZVByb21pc2UocHJvbWlzZSwgcmVzb2x2ZXIpIHtcbiAgdHJ5IHtcbiAgICByZXNvbHZlcihmdW5jdGlvbiByZXNvbHZlUHJvbWlzZSh2YWx1ZSkge1xuICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gICAgfSwgZnVuY3Rpb24gcmVqZWN0UHJvbWlzZShyZWFzb24pIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIGUpO1xuICB9XG59XG5cbnZhciBpZCA9IDA7XG5mdW5jdGlvbiBuZXh0SWQoKSB7XG4gIHJldHVybiBpZCsrO1xufVxuXG5mdW5jdGlvbiBtYWtlUHJvbWlzZShwcm9taXNlKSB7XG4gIHByb21pc2VbUFJPTUlTRV9JRF0gPSBpZCsrO1xuICBwcm9taXNlLl9zdGF0ZSA9IHVuZGVmaW5lZDtcbiAgcHJvbWlzZS5fcmVzdWx0ID0gdW5kZWZpbmVkO1xuICBwcm9taXNlLl9zdWJzY3JpYmVycyA9IFtdO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0aW9uRXJyb3IoKSB7XG4gIHJldHVybiBuZXcgRXJyb3IoJ0FycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheScpO1xufVxuXG52YXIgRW51bWVyYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRW51bWVyYXRvcihDb25zdHJ1Y3RvciwgaW5wdXQpIHtcbiAgICB0aGlzLl9pbnN0YW5jZUNvbnN0cnVjdG9yID0gQ29uc3RydWN0b3I7XG4gICAgdGhpcy5wcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuXG4gICAgaWYgKCF0aGlzLnByb21pc2VbUFJPTUlTRV9JRF0pIHtcbiAgICAgIG1ha2VQcm9taXNlKHRoaXMucHJvbWlzZSk7XG4gICAgfVxuXG4gICAgaWYgKGlzQXJyYXkoaW5wdXQpKSB7XG4gICAgICB0aGlzLmxlbmd0aCA9IGlucHV0Lmxlbmd0aDtcbiAgICAgIHRoaXMuX3JlbWFpbmluZyA9IGlucHV0Lmxlbmd0aDtcblxuICAgICAgdGhpcy5fcmVzdWx0ID0gbmV3IEFycmF5KHRoaXMubGVuZ3RoKTtcblxuICAgICAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGZ1bGZpbGwodGhpcy5wcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLmxlbmd0aCB8fCAwO1xuICAgICAgICB0aGlzLl9lbnVtZXJhdGUoaW5wdXQpO1xuICAgICAgICBpZiAodGhpcy5fcmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgICAgZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmVqZWN0KHRoaXMucHJvbWlzZSwgdmFsaWRhdGlvbkVycm9yKCkpO1xuICAgIH1cbiAgfVxuXG4gIEVudW1lcmF0b3IucHJvdG90eXBlLl9lbnVtZXJhdGUgPSBmdW5jdGlvbiBfZW51bWVyYXRlKGlucHV0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IHRoaXMuX3N0YXRlID09PSBQRU5ESU5HICYmIGkgPCBpbnB1dC5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5fZWFjaEVudHJ5KGlucHV0W2ldLCBpKTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX2VhY2hFbnRyeSA9IGZ1bmN0aW9uIF9lYWNoRW50cnkoZW50cnksIGkpIHtcbiAgICB2YXIgYyA9IHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3I7XG4gICAgdmFyIHJlc29sdmUkJDEgPSBjLnJlc29sdmU7XG5cblxuICAgIGlmIChyZXNvbHZlJCQxID09PSByZXNvbHZlJDEpIHtcbiAgICAgIHZhciBfdGhlbiA9IGdldFRoZW4oZW50cnkpO1xuXG4gICAgICBpZiAoX3RoZW4gPT09IHRoZW4gJiYgZW50cnkuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgICAgIHRoaXMuX3NldHRsZWRBdChlbnRyeS5fc3RhdGUsIGksIGVudHJ5Ll9yZXN1bHQpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgX3RoZW4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG4gICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IGVudHJ5O1xuICAgICAgfSBlbHNlIGlmIChjID09PSBQcm9taXNlJDEpIHtcbiAgICAgICAgdmFyIHByb21pc2UgPSBuZXcgYyhub29wKTtcbiAgICAgICAgaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBlbnRyeSwgX3RoZW4pO1xuICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQocHJvbWlzZSwgaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQobmV3IGMoZnVuY3Rpb24gKHJlc29sdmUkJDEpIHtcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZSQkMShlbnRyeSk7XG4gICAgICAgIH0pLCBpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fd2lsbFNldHRsZUF0KHJlc29sdmUkJDEoZW50cnkpLCBpKTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX3NldHRsZWRBdCA9IGZ1bmN0aW9uIF9zZXR0bGVkQXQoc3RhdGUsIGksIHZhbHVlKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG5cblxuICAgIGlmIChwcm9taXNlLl9zdGF0ZSA9PT0gUEVORElORykge1xuICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gUkVKRUNURUQpIHtcbiAgICAgICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLl9yZW1haW5pbmcgPT09IDApIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX3dpbGxTZXR0bGVBdCA9IGZ1bmN0aW9uIF93aWxsU2V0dGxlQXQocHJvbWlzZSwgaSkge1xuICAgIHZhciBlbnVtZXJhdG9yID0gdGhpcztcblxuICAgIHN1YnNjcmliZShwcm9taXNlLCB1bmRlZmluZWQsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGVudW1lcmF0b3IuX3NldHRsZWRBdChGVUxGSUxMRUQsIGksIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICByZXR1cm4gZW51bWVyYXRvci5fc2V0dGxlZEF0KFJFSkVDVEVELCBpLCByZWFzb24pO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBFbnVtZXJhdG9yO1xufSgpO1xuXG4vKipcbiAgYFByb21pc2UuYWxsYCBhY2NlcHRzIGFuIGFycmF5IG9mIHByb21pc2VzLCBhbmQgcmV0dXJucyBhIG5ldyBwcm9taXNlIHdoaWNoXG4gIGlzIGZ1bGZpbGxlZCB3aXRoIGFuIGFycmF5IG9mIGZ1bGZpbGxtZW50IHZhbHVlcyBmb3IgdGhlIHBhc3NlZCBwcm9taXNlcywgb3JcbiAgcmVqZWN0ZWQgd2l0aCB0aGUgcmVhc29uIG9mIHRoZSBmaXJzdCBwYXNzZWQgcHJvbWlzZSB0byBiZSByZWplY3RlZC4gSXQgY2FzdHMgYWxsXG4gIGVsZW1lbnRzIG9mIHRoZSBwYXNzZWQgaXRlcmFibGUgdG8gcHJvbWlzZXMgYXMgaXQgcnVucyB0aGlzIGFsZ29yaXRobS5cblxuICBFeGFtcGxlOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gcmVzb2x2ZSgxKTtcbiAgbGV0IHByb21pc2UyID0gcmVzb2x2ZSgyKTtcbiAgbGV0IHByb21pc2UzID0gcmVzb2x2ZSgzKTtcbiAgbGV0IHByb21pc2VzID0gWyBwcm9taXNlMSwgcHJvbWlzZTIsIHByb21pc2UzIF07XG5cbiAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oYXJyYXkpe1xuICAgIC8vIFRoZSBhcnJheSBoZXJlIHdvdWxkIGJlIFsgMSwgMiwgMyBdO1xuICB9KTtcbiAgYGBgXG5cbiAgSWYgYW55IG9mIHRoZSBgcHJvbWlzZXNgIGdpdmVuIHRvIGBhbGxgIGFyZSByZWplY3RlZCwgdGhlIGZpcnN0IHByb21pc2VcbiAgdGhhdCBpcyByZWplY3RlZCB3aWxsIGJlIGdpdmVuIGFzIGFuIGFyZ3VtZW50IHRvIHRoZSByZXR1cm5lZCBwcm9taXNlcydzXG4gIHJlamVjdGlvbiBoYW5kbGVyLiBGb3IgZXhhbXBsZTpcblxuICBFeGFtcGxlOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gcmVzb2x2ZSgxKTtcbiAgbGV0IHByb21pc2UyID0gcmVqZWN0KG5ldyBFcnJvcihcIjJcIikpO1xuICBsZXQgcHJvbWlzZTMgPSByZWplY3QobmV3IEVycm9yKFwiM1wiKSk7XG4gIGxldCBwcm9taXNlcyA9IFsgcHJvbWlzZTEsIHByb21pc2UyLCBwcm9taXNlMyBdO1xuXG4gIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKGFycmF5KXtcbiAgICAvLyBDb2RlIGhlcmUgbmV2ZXIgcnVucyBiZWNhdXNlIHRoZXJlIGFyZSByZWplY3RlZCBwcm9taXNlcyFcbiAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAvLyBlcnJvci5tZXNzYWdlID09PSBcIjJcIlxuICB9KTtcbiAgYGBgXG5cbiAgQG1ldGhvZCBhbGxcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FycmF5fSBlbnRyaWVzIGFycmF5IG9mIHByb21pc2VzXG4gIEBwYXJhbSB7U3RyaW5nfSBsYWJlbCBvcHRpb25hbCBzdHJpbmcgZm9yIGxhYmVsaW5nIHRoZSBwcm9taXNlLlxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgdGhhdCBpcyBmdWxmaWxsZWQgd2hlbiBhbGwgYHByb21pc2VzYCBoYXZlIGJlZW5cbiAgZnVsZmlsbGVkLCBvciByZWplY3RlZCBpZiBhbnkgb2YgdGhlbSBiZWNvbWUgcmVqZWN0ZWQuXG4gIEBzdGF0aWNcbiovXG5mdW5jdGlvbiBhbGwoZW50cmllcykge1xuICByZXR1cm4gbmV3IEVudW1lcmF0b3IodGhpcywgZW50cmllcykucHJvbWlzZTtcbn1cblxuLyoqXG4gIGBQcm9taXNlLnJhY2VgIHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aGljaCBpcyBzZXR0bGVkIGluIHRoZSBzYW1lIHdheSBhcyB0aGVcbiAgZmlyc3QgcGFzc2VkIHByb21pc2UgdG8gc2V0dGxlLlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJlc29sdmUoJ3Byb21pc2UgMScpO1xuICAgIH0sIDIwMCk7XG4gIH0pO1xuXG4gIGxldCBwcm9taXNlMiA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAyJyk7XG4gICAgfSwgMTAwKTtcbiAgfSk7XG5cbiAgUHJvbWlzZS5yYWNlKFtwcm9taXNlMSwgcHJvbWlzZTJdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gcmVzdWx0ID09PSAncHJvbWlzZSAyJyBiZWNhdXNlIGl0IHdhcyByZXNvbHZlZCBiZWZvcmUgcHJvbWlzZTFcbiAgICAvLyB3YXMgcmVzb2x2ZWQuXG4gIH0pO1xuICBgYGBcblxuICBgUHJvbWlzZS5yYWNlYCBpcyBkZXRlcm1pbmlzdGljIGluIHRoYXQgb25seSB0aGUgc3RhdGUgb2YgdGhlIGZpcnN0XG4gIHNldHRsZWQgcHJvbWlzZSBtYXR0ZXJzLiBGb3IgZXhhbXBsZSwgZXZlbiBpZiBvdGhlciBwcm9taXNlcyBnaXZlbiB0byB0aGVcbiAgYHByb21pc2VzYCBhcnJheSBhcmd1bWVudCBhcmUgcmVzb2x2ZWQsIGJ1dCB0aGUgZmlyc3Qgc2V0dGxlZCBwcm9taXNlIGhhc1xuICBiZWNvbWUgcmVqZWN0ZWQgYmVmb3JlIHRoZSBvdGhlciBwcm9taXNlcyBiZWNhbWUgZnVsZmlsbGVkLCB0aGUgcmV0dXJuZWRcbiAgcHJvbWlzZSB3aWxsIGJlY29tZSByZWplY3RlZDpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlMSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAxJyk7XG4gICAgfSwgMjAwKTtcbiAgfSk7XG5cbiAgbGV0IHByb21pc2UyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZWplY3QobmV3IEVycm9yKCdwcm9taXNlIDInKSk7XG4gICAgfSwgMTAwKTtcbiAgfSk7XG5cbiAgUHJvbWlzZS5yYWNlKFtwcm9taXNlMSwgcHJvbWlzZTJdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gQ29kZSBoZXJlIG5ldmVyIHJ1bnNcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ3Byb21pc2UgMicgYmVjYXVzZSBwcm9taXNlIDIgYmVjYW1lIHJlamVjdGVkIGJlZm9yZVxuICAgIC8vIHByb21pc2UgMSBiZWNhbWUgZnVsZmlsbGVkXG4gIH0pO1xuICBgYGBcblxuICBBbiBleGFtcGxlIHJlYWwtd29ybGQgdXNlIGNhc2UgaXMgaW1wbGVtZW50aW5nIHRpbWVvdXRzOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgUHJvbWlzZS5yYWNlKFthamF4KCdmb28uanNvbicpLCB0aW1lb3V0KDUwMDApXSlcbiAgYGBgXG5cbiAgQG1ldGhvZCByYWNlXG4gIEBzdGF0aWNcbiAgQHBhcmFtIHtBcnJheX0gcHJvbWlzZXMgYXJyYXkgb2YgcHJvbWlzZXMgdG8gb2JzZXJ2ZVxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSB3aGljaCBzZXR0bGVzIGluIHRoZSBzYW1lIHdheSBhcyB0aGUgZmlyc3QgcGFzc2VkXG4gIHByb21pc2UgdG8gc2V0dGxlLlxuKi9cbmZ1bmN0aW9uIHJhY2UoZW50cmllcykge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXG4gIGlmICghaXNBcnJheShlbnRyaWVzKSkge1xuICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24gKF8sIHJlamVjdCkge1xuICAgICAgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGFuIGFycmF5IHRvIHJhY2UuJykpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGVudHJpZXMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKGVudHJpZXNbaV0pLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAgYFByb21pc2UucmVqZWN0YCByZXR1cm5zIGEgcHJvbWlzZSByZWplY3RlZCB3aXRoIHRoZSBwYXNzZWQgYHJlYXNvbmAuXG4gIEl0IGlzIHNob3J0aGFuZCBmb3IgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICByZWplY3QobmV3IEVycm9yKCdXSE9PUFMnKSk7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gQ29kZSBoZXJlIGRvZXNuJ3QgcnVuIGJlY2F1c2UgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQhXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gcmVhc29uLm1lc3NhZ2UgPT09ICdXSE9PUFMnXG4gIH0pO1xuICBgYGBcblxuICBJbnN0ZWFkIG9mIHdyaXRpbmcgdGhlIGFib3ZlLCB5b3VyIGNvZGUgbm93IHNpbXBseSBiZWNvbWVzIHRoZSBmb2xsb3dpbmc6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignV0hPT1BTJykpO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gQ29kZSBoZXJlIGRvZXNuJ3QgcnVuIGJlY2F1c2UgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQhXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gcmVhc29uLm1lc3NhZ2UgPT09ICdXSE9PUFMnXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIHJlamVjdFxuICBAc3RhdGljXG4gIEBwYXJhbSB7QW55fSByZWFzb24gdmFsdWUgdGhhdCB0aGUgcmV0dXJuZWQgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHdpdGguXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHJlamVjdGVkIHdpdGggdGhlIGdpdmVuIGByZWFzb25gLlxuKi9cbmZ1bmN0aW9uIHJlamVjdCQxKHJlYXNvbikge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcbiAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG5mdW5jdGlvbiBuZWVkc1Jlc29sdmVyKCkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGEgcmVzb2x2ZXIgZnVuY3Rpb24gYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yJyk7XG59XG5cbmZ1bmN0aW9uIG5lZWRzTmV3KCkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmFpbGVkIHRvIGNvbnN0cnVjdCAnUHJvbWlzZSc6IFBsZWFzZSB1c2UgdGhlICduZXcnIG9wZXJhdG9yLCB0aGlzIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uXCIpO1xufVxuXG4vKipcbiAgUHJvbWlzZSBvYmplY3RzIHJlcHJlc2VudCB0aGUgZXZlbnR1YWwgcmVzdWx0IG9mIGFuIGFzeW5jaHJvbm91cyBvcGVyYXRpb24uIFRoZVxuICBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLCB3aGljaFxuICByZWdpc3RlcnMgY2FsbGJhY2tzIHRvIHJlY2VpdmUgZWl0aGVyIGEgcHJvbWlzZSdzIGV2ZW50dWFsIHZhbHVlIG9yIHRoZSByZWFzb25cbiAgd2h5IHRoZSBwcm9taXNlIGNhbm5vdCBiZSBmdWxmaWxsZWQuXG5cbiAgVGVybWlub2xvZ3lcbiAgLS0tLS0tLS0tLS1cblxuICAtIGBwcm9taXNlYCBpcyBhbiBvYmplY3Qgb3IgZnVuY3Rpb24gd2l0aCBhIGB0aGVuYCBtZXRob2Qgd2hvc2UgYmVoYXZpb3IgY29uZm9ybXMgdG8gdGhpcyBzcGVjaWZpY2F0aW9uLlxuICAtIGB0aGVuYWJsZWAgaXMgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHRoYXQgZGVmaW5lcyBhIGB0aGVuYCBtZXRob2QuXG4gIC0gYHZhbHVlYCBpcyBhbnkgbGVnYWwgSmF2YVNjcmlwdCB2YWx1ZSAoaW5jbHVkaW5nIHVuZGVmaW5lZCwgYSB0aGVuYWJsZSwgb3IgYSBwcm9taXNlKS5cbiAgLSBgZXhjZXB0aW9uYCBpcyBhIHZhbHVlIHRoYXQgaXMgdGhyb3duIHVzaW5nIHRoZSB0aHJvdyBzdGF0ZW1lbnQuXG4gIC0gYHJlYXNvbmAgaXMgYSB2YWx1ZSB0aGF0IGluZGljYXRlcyB3aHkgYSBwcm9taXNlIHdhcyByZWplY3RlZC5cbiAgLSBgc2V0dGxlZGAgdGhlIGZpbmFsIHJlc3Rpbmcgc3RhdGUgb2YgYSBwcm9taXNlLCBmdWxmaWxsZWQgb3IgcmVqZWN0ZWQuXG5cbiAgQSBwcm9taXNlIGNhbiBiZSBpbiBvbmUgb2YgdGhyZWUgc3RhdGVzOiBwZW5kaW5nLCBmdWxmaWxsZWQsIG9yIHJlamVjdGVkLlxuXG4gIFByb21pc2VzIHRoYXQgYXJlIGZ1bGZpbGxlZCBoYXZlIGEgZnVsZmlsbG1lbnQgdmFsdWUgYW5kIGFyZSBpbiB0aGUgZnVsZmlsbGVkXG4gIHN0YXRlLiAgUHJvbWlzZXMgdGhhdCBhcmUgcmVqZWN0ZWQgaGF2ZSBhIHJlamVjdGlvbiByZWFzb24gYW5kIGFyZSBpbiB0aGVcbiAgcmVqZWN0ZWQgc3RhdGUuICBBIGZ1bGZpbGxtZW50IHZhbHVlIGlzIG5ldmVyIGEgdGhlbmFibGUuXG5cbiAgUHJvbWlzZXMgY2FuIGFsc28gYmUgc2FpZCB0byAqcmVzb2x2ZSogYSB2YWx1ZS4gIElmIHRoaXMgdmFsdWUgaXMgYWxzbyBhXG4gIHByb21pc2UsIHRoZW4gdGhlIG9yaWdpbmFsIHByb21pc2UncyBzZXR0bGVkIHN0YXRlIHdpbGwgbWF0Y2ggdGhlIHZhbHVlJ3NcbiAgc2V0dGxlZCBzdGF0ZS4gIFNvIGEgcHJvbWlzZSB0aGF0ICpyZXNvbHZlcyogYSBwcm9taXNlIHRoYXQgcmVqZWN0cyB3aWxsXG4gIGl0c2VsZiByZWplY3QsIGFuZCBhIHByb21pc2UgdGhhdCAqcmVzb2x2ZXMqIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIHdpbGxcbiAgaXRzZWxmIGZ1bGZpbGwuXG5cblxuICBCYXNpYyBVc2FnZTpcbiAgLS0tLS0tLS0tLS0tXG5cbiAgYGBganNcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAvLyBvbiBzdWNjZXNzXG4gICAgcmVzb2x2ZSh2YWx1ZSk7XG5cbiAgICAvLyBvbiBmYWlsdXJlXG4gICAgcmVqZWN0KHJlYXNvbik7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgIC8vIG9uIGZ1bGZpbGxtZW50XG4gIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgIC8vIG9uIHJlamVjdGlvblxuICB9KTtcbiAgYGBgXG5cbiAgQWR2YW5jZWQgVXNhZ2U6XG4gIC0tLS0tLS0tLS0tLS0tLVxuXG4gIFByb21pc2VzIHNoaW5lIHdoZW4gYWJzdHJhY3RpbmcgYXdheSBhc3luY2hyb25vdXMgaW50ZXJhY3Rpb25zIHN1Y2ggYXNcbiAgYFhNTEh0dHBSZXF1ZXN0YHMuXG5cbiAgYGBganNcbiAgZnVuY3Rpb24gZ2V0SlNPTih1cmwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG4gICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gaGFuZGxlcjtcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnanNvbic7XG4gICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgIHhoci5zZW5kKCk7XG5cbiAgICAgIGZ1bmN0aW9uIGhhbmRsZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IHRoaXMuRE9ORSkge1xuICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdnZXRKU09OOiBgJyArIHVybCArICdgIGZhaWxlZCB3aXRoIHN0YXR1czogWycgKyB0aGlzLnN0YXR1cyArICddJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldEpTT04oJy9wb3N0cy5qc29uJykudGhlbihmdW5jdGlvbihqc29uKSB7XG4gICAgLy8gb24gZnVsZmlsbG1lbnRcbiAgfSwgZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgLy8gb24gcmVqZWN0aW9uXG4gIH0pO1xuICBgYGBcblxuICBVbmxpa2UgY2FsbGJhY2tzLCBwcm9taXNlcyBhcmUgZ3JlYXQgY29tcG9zYWJsZSBwcmltaXRpdmVzLlxuXG4gIGBgYGpzXG4gIFByb21pc2UuYWxsKFtcbiAgICBnZXRKU09OKCcvcG9zdHMnKSxcbiAgICBnZXRKU09OKCcvY29tbWVudHMnKVxuICBdKS50aGVuKGZ1bmN0aW9uKHZhbHVlcyl7XG4gICAgdmFsdWVzWzBdIC8vID0+IHBvc3RzSlNPTlxuICAgIHZhbHVlc1sxXSAvLyA9PiBjb21tZW50c0pTT05cblxuICAgIHJldHVybiB2YWx1ZXM7XG4gIH0pO1xuICBgYGBcblxuICBAY2xhc3MgUHJvbWlzZVxuICBAcGFyYW0ge0Z1bmN0aW9ufSByZXNvbHZlclxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEBjb25zdHJ1Y3RvclxuKi9cblxudmFyIFByb21pc2UkMSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICAgIHRoaXNbUFJPTUlTRV9JRF0gPSBuZXh0SWQoKTtcbiAgICB0aGlzLl9yZXN1bHQgPSB0aGlzLl9zdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl9zdWJzY3JpYmVycyA9IFtdO1xuXG4gICAgaWYgKG5vb3AgIT09IHJlc29sdmVyKSB7XG4gICAgICB0eXBlb2YgcmVzb2x2ZXIgIT09ICdmdW5jdGlvbicgJiYgbmVlZHNSZXNvbHZlcigpO1xuICAgICAgdGhpcyBpbnN0YW5jZW9mIFByb21pc2UgPyBpbml0aWFsaXplUHJvbWlzZSh0aGlzLCByZXNvbHZlcikgOiBuZWVkc05ldygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICBUaGUgcHJpbWFyeSB3YXkgb2YgaW50ZXJhY3Rpbmcgd2l0aCBhIHByb21pc2UgaXMgdGhyb3VnaCBpdHMgYHRoZW5gIG1ldGhvZCxcbiAgd2hpY2ggcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGVcbiAgcmVhc29uIHdoeSB0aGUgcHJvbWlzZSBjYW5ub3QgYmUgZnVsZmlsbGVkLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uKHVzZXIpe1xuICAgIC8vIHVzZXIgaXMgYXZhaWxhYmxlXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gdXNlciBpcyB1bmF2YWlsYWJsZSwgYW5kIHlvdSBhcmUgZ2l2ZW4gdGhlIHJlYXNvbiB3aHlcbiAgfSk7XG4gIGBgYFxuICAgQ2hhaW5pbmdcbiAgLS0tLS0tLS1cbiAgIFRoZSByZXR1cm4gdmFsdWUgb2YgYHRoZW5gIGlzIGl0c2VsZiBhIHByb21pc2UuICBUaGlzIHNlY29uZCwgJ2Rvd25zdHJlYW0nXG4gIHByb21pc2UgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmaXJzdCBwcm9taXNlJ3MgZnVsZmlsbG1lbnRcbiAgb3IgcmVqZWN0aW9uIGhhbmRsZXIsIG9yIHJlamVjdGVkIGlmIHRoZSBoYW5kbGVyIHRocm93cyBhbiBleGNlcHRpb24uXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gdXNlci5uYW1lO1xuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgcmV0dXJuICdkZWZhdWx0IG5hbWUnO1xuICB9KS50aGVuKGZ1bmN0aW9uICh1c2VyTmFtZSkge1xuICAgIC8vIElmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgdXNlck5hbWVgIHdpbGwgYmUgdGhlIHVzZXIncyBuYW1lLCBvdGhlcndpc2UgaXRcbiAgICAvLyB3aWxsIGJlIGAnZGVmYXVsdCBuYW1lJ2BcbiAgfSk7XG4gICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZvdW5kIHVzZXIsIGJ1dCBzdGlsbCB1bmhhcHB5Jyk7XG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknKTtcbiAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAvLyBuZXZlciByZWFjaGVkXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBpZiBgZmluZFVzZXJgIGZ1bGZpbGxlZCwgYHJlYXNvbmAgd2lsbCBiZSAnRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknLlxuICAgIC8vIElmIGBmaW5kVXNlcmAgcmVqZWN0ZWQsIGByZWFzb25gIHdpbGwgYmUgJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknLlxuICB9KTtcbiAgYGBgXG4gIElmIHRoZSBkb3duc3RyZWFtIHByb21pc2UgZG9lcyBub3Qgc3BlY2lmeSBhIHJlamVjdGlvbiBoYW5kbGVyLCByZWplY3Rpb24gcmVhc29ucyB3aWxsIGJlIHByb3BhZ2F0ZWQgZnVydGhlciBkb3duc3RyZWFtLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgdGhyb3cgbmV3IFBlZGFnb2dpY2FsRXhjZXB0aW9uKCdVcHN0cmVhbSBlcnJvcicpO1xuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAvLyBuZXZlciByZWFjaGVkXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBUaGUgYFBlZGdhZ29jaWFsRXhjZXB0aW9uYCBpcyBwcm9wYWdhdGVkIGFsbCB0aGUgd2F5IGRvd24gdG8gaGVyZVxuICB9KTtcbiAgYGBgXG4gICBBc3NpbWlsYXRpb25cbiAgLS0tLS0tLS0tLS0tXG4gICBTb21ldGltZXMgdGhlIHZhbHVlIHlvdSB3YW50IHRvIHByb3BhZ2F0ZSB0byBhIGRvd25zdHJlYW0gcHJvbWlzZSBjYW4gb25seSBiZVxuICByZXRyaWV2ZWQgYXN5bmNocm9ub3VzbHkuIFRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHJldHVybmluZyBhIHByb21pc2UgaW4gdGhlXG4gIGZ1bGZpbGxtZW50IG9yIHJlamVjdGlvbiBoYW5kbGVyLiBUaGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgdGhlbiBiZSBwZW5kaW5nXG4gIHVudGlsIHRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHNldHRsZWQuIFRoaXMgaXMgY2FsbGVkICphc3NpbWlsYXRpb24qLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuICB9KS50aGVuKGZ1bmN0aW9uIChjb21tZW50cykge1xuICAgIC8vIFRoZSB1c2VyJ3MgY29tbWVudHMgYXJlIG5vdyBhdmFpbGFibGVcbiAgfSk7XG4gIGBgYFxuICAgSWYgdGhlIGFzc2ltbGlhdGVkIHByb21pc2UgcmVqZWN0cywgdGhlbiB0aGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgYWxzbyByZWplY3QuXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gZmluZENvbW1lbnRzQnlBdXRob3IodXNlcik7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGNvbW1lbnRzKSB7XG4gICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCBmdWxmaWxscywgd2UnbGwgaGF2ZSB0aGUgdmFsdWUgaGVyZVxuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCByZWplY3RzLCB3ZSdsbCBoYXZlIHRoZSByZWFzb24gaGVyZVxuICB9KTtcbiAgYGBgXG4gICBTaW1wbGUgRXhhbXBsZVxuICAtLS0tLS0tLS0tLS0tLVxuICAgU3luY2hyb25vdXMgRXhhbXBsZVxuICAgYGBgamF2YXNjcmlwdFxuICBsZXQgcmVzdWx0O1xuICAgdHJ5IHtcbiAgICByZXN1bHQgPSBmaW5kUmVzdWx0KCk7XG4gICAgLy8gc3VjY2Vzc1xuICB9IGNhdGNoKHJlYXNvbikge1xuICAgIC8vIGZhaWx1cmVcbiAgfVxuICBgYGBcbiAgIEVycmJhY2sgRXhhbXBsZVxuICAgYGBganNcbiAgZmluZFJlc3VsdChmdW5jdGlvbihyZXN1bHQsIGVycil7XG4gICAgaWYgKGVycikge1xuICAgICAgLy8gZmFpbHVyZVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBzdWNjZXNzXG4gICAgfVxuICB9KTtcbiAgYGBgXG4gICBQcm9taXNlIEV4YW1wbGU7XG4gICBgYGBqYXZhc2NyaXB0XG4gIGZpbmRSZXN1bHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gc3VjY2Vzc1xuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIGZhaWx1cmVcbiAgfSk7XG4gIGBgYFxuICAgQWR2YW5jZWQgRXhhbXBsZVxuICAtLS0tLS0tLS0tLS0tLVxuICAgU3luY2hyb25vdXMgRXhhbXBsZVxuICAgYGBgamF2YXNjcmlwdFxuICBsZXQgYXV0aG9yLCBib29rcztcbiAgIHRyeSB7XG4gICAgYXV0aG9yID0gZmluZEF1dGhvcigpO1xuICAgIGJvb2tzICA9IGZpbmRCb29rc0J5QXV0aG9yKGF1dGhvcik7XG4gICAgLy8gc3VjY2Vzc1xuICB9IGNhdGNoKHJlYXNvbikge1xuICAgIC8vIGZhaWx1cmVcbiAgfVxuICBgYGBcbiAgIEVycmJhY2sgRXhhbXBsZVxuICAgYGBganNcbiAgIGZ1bmN0aW9uIGZvdW5kQm9va3MoYm9va3MpIHtcbiAgIH1cbiAgIGZ1bmN0aW9uIGZhaWx1cmUocmVhc29uKSB7XG4gICB9XG4gICBmaW5kQXV0aG9yKGZ1bmN0aW9uKGF1dGhvciwgZXJyKXtcbiAgICBpZiAoZXJyKSB7XG4gICAgICBmYWlsdXJlKGVycik7XG4gICAgICAvLyBmYWlsdXJlXG4gICAgfSBlbHNlIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZpbmRCb29va3NCeUF1dGhvcihhdXRob3IsIGZ1bmN0aW9uKGJvb2tzLCBlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBmYWlsdXJlKGVycik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGZvdW5kQm9va3MoYm9va3MpO1xuICAgICAgICAgICAgfSBjYXRjaChyZWFzb24pIHtcbiAgICAgICAgICAgICAgZmFpbHVyZShyZWFzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoKGVycm9yKSB7XG4gICAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgIH1cbiAgICAgIC8vIHN1Y2Nlc3NcbiAgICB9XG4gIH0pO1xuICBgYGBcbiAgIFByb21pc2UgRXhhbXBsZTtcbiAgIGBgYGphdmFzY3JpcHRcbiAgZmluZEF1dGhvcigpLlxuICAgIHRoZW4oZmluZEJvb2tzQnlBdXRob3IpLlxuICAgIHRoZW4oZnVuY3Rpb24oYm9va3Mpe1xuICAgICAgLy8gZm91bmQgYm9va3NcbiAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICB9KTtcbiAgYGBgXG4gICBAbWV0aG9kIHRoZW5cbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25GdWxmaWxsZWRcbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3RlZFxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9XG4gICovXG5cbiAgLyoqXG4gIGBjYXRjaGAgaXMgc2ltcGx5IHN1Z2FyIGZvciBgdGhlbih1bmRlZmluZWQsIG9uUmVqZWN0aW9uKWAgd2hpY2ggbWFrZXMgaXQgdGhlIHNhbWVcbiAgYXMgdGhlIGNhdGNoIGJsb2NrIG9mIGEgdHJ5L2NhdGNoIHN0YXRlbWVudC5cbiAgYGBganNcbiAgZnVuY3Rpb24gZmluZEF1dGhvcigpe1xuICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkbid0IGZpbmQgdGhhdCBhdXRob3InKTtcbiAgfVxuICAvLyBzeW5jaHJvbm91c1xuICB0cnkge1xuICBmaW5kQXV0aG9yKCk7XG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gIH1cbiAgLy8gYXN5bmMgd2l0aCBwcm9taXNlc1xuICBmaW5kQXV0aG9yKCkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcbiAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgfSk7XG4gIGBgYFxuICBAbWV0aG9kIGNhdGNoXG4gIEBwYXJhbSB7RnVuY3Rpb259IG9uUmVqZWN0aW9uXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX1cbiAgKi9cblxuXG4gIFByb21pc2UucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24gX2NhdGNoKG9uUmVqZWN0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBvblJlamVjdGlvbik7XG4gIH07XG5cbiAgLyoqXG4gICAgYGZpbmFsbHlgIHdpbGwgYmUgaW52b2tlZCByZWdhcmRsZXNzIG9mIHRoZSBwcm9taXNlJ3MgZmF0ZSBqdXN0IGFzIG5hdGl2ZVxuICAgIHRyeS9jYXRjaC9maW5hbGx5IGJlaGF2ZXNcbiAgXG4gICAgU3luY2hyb25vdXMgZXhhbXBsZTpcbiAgXG4gICAgYGBganNcbiAgICBmaW5kQXV0aG9yKCkge1xuICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPiAwLjUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IEF1dGhvcigpO1xuICAgIH1cbiAgXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBmaW5kQXV0aG9yKCk7IC8vIHN1Y2NlZWQgb3IgZmFpbFxuICAgIH0gY2F0Y2goZXJyb3IpIHtcbiAgICAgIHJldHVybiBmaW5kT3RoZXJBdXRoZXIoKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gYWx3YXlzIHJ1bnNcbiAgICAgIC8vIGRvZXNuJ3QgYWZmZWN0IHRoZSByZXR1cm4gdmFsdWVcbiAgICB9XG4gICAgYGBgXG4gIFxuICAgIEFzeW5jaHJvbm91cyBleGFtcGxlOlxuICBcbiAgICBgYGBqc1xuICAgIGZpbmRBdXRob3IoKS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAgICAgcmV0dXJuIGZpbmRPdGhlckF1dGhlcigpO1xuICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24oKXtcbiAgICAgIC8vIGF1dGhvciB3YXMgZWl0aGVyIGZvdW5kLCBvciBub3RcbiAgICB9KTtcbiAgICBgYGBcbiAgXG4gICAgQG1ldGhvZCBmaW5hbGx5XG4gICAgQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcbiAgICBAcmV0dXJuIHtQcm9taXNlfVxuICAqL1xuXG5cbiAgUHJvbWlzZS5wcm90b3R5cGUuZmluYWxseSA9IGZ1bmN0aW9uIF9maW5hbGx5KGNhbGxiYWNrKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzO1xuICAgIHZhciBjb25zdHJ1Y3RvciA9IHByb21pc2UuY29uc3RydWN0b3I7XG5cbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5yZXNvbHZlKGNhbGxiYWNrKCkpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICB0aHJvdyByZWFzb247XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gUHJvbWlzZTtcbn0oKTtcblxuUHJvbWlzZSQxLnByb3RvdHlwZS50aGVuID0gdGhlbjtcblByb21pc2UkMS5hbGwgPSBhbGw7XG5Qcm9taXNlJDEucmFjZSA9IHJhY2U7XG5Qcm9taXNlJDEucmVzb2x2ZSA9IHJlc29sdmUkMTtcblByb21pc2UkMS5yZWplY3QgPSByZWplY3QkMTtcblByb21pc2UkMS5fc2V0U2NoZWR1bGVyID0gc2V0U2NoZWR1bGVyO1xuUHJvbWlzZSQxLl9zZXRBc2FwID0gc2V0QXNhcDtcblByb21pc2UkMS5fYXNhcCA9IGFzYXA7XG5cbi8qZ2xvYmFsIHNlbGYqL1xuZnVuY3Rpb24gcG9seWZpbGwoKSB7XG4gIHZhciBsb2NhbCA9IHZvaWQgMDtcblxuICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBsb2NhbCA9IGdsb2JhbDtcbiAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBsb2NhbCA9IHNlbGY7XG4gIH0gZWxzZSB7XG4gICAgdHJ5IHtcbiAgICAgIGxvY2FsID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BvbHlmaWxsIGZhaWxlZCBiZWNhdXNlIGdsb2JhbCBvYmplY3QgaXMgdW5hdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBQID0gbG9jYWwuUHJvbWlzZTtcblxuICBpZiAoUCkge1xuICAgIHZhciBwcm9taXNlVG9TdHJpbmcgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICBwcm9taXNlVG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUC5yZXNvbHZlKCkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIHNpbGVudGx5IGlnbm9yZWRcbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZVRvU3RyaW5nID09PSAnW29iamVjdCBQcm9taXNlXScgJiYgIVAuY2FzdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGxvY2FsLlByb21pc2UgPSBQcm9taXNlJDE7XG59XG5cbi8vIFN0cmFuZ2UgY29tcGF0Li5cblByb21pc2UkMS5wb2x5ZmlsbCA9IHBvbHlmaWxsO1xuUHJvbWlzZSQxLlByb21pc2UgPSBQcm9taXNlJDE7XG5cbnJldHVybiBQcm9taXNlJDE7XG5cbn0pKSk7XG5cblxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1lczYtcHJvbWlzZS5tYXBcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9lczYtcHJvbWlzZS9kaXN0L2VzNi1wcm9taXNlLmpzXG4vLyBtb2R1bGUgaWQgPSAxMzlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBfaW50ZXJvcERlZmF1bHQgKGV4KSB7IHJldHVybiAoZXggJiYgKHR5cGVvZiBleCA9PT0gJ29iamVjdCcpICYmICdkZWZhdWx0JyBpbiBleCkgPyBleFsnZGVmYXVsdCddIDogZXg7IH1cblxucmVxdWlyZSgnQGZpcmViYXNlL3BvbHlmaWxsJyk7XG52YXIgZmlyZWJhc2UgPSBfaW50ZXJvcERlZmF1bHQocmVxdWlyZSgnQGZpcmViYXNlL2FwcCcpKTtcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZmlyZWJhc2U7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vZmlyZWJhc2UvYXBwL2Rpc3QvaW5kZXguY2pzLmpzXG4vLyBtb2R1bGUgaWQgPSAxNDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICdAZmlyZWJhc2UvZmlyZXN0b3JlJztcblxuLyoqXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBJbmMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vZmlyZWJhc2UvZmlyZXN0b3JlL2Rpc3QvaW5kZXguZXNtLmpzXG4vLyBtb2R1bGUgaWQgPSAxNDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIHdpbjtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICB3aW4gPSB3aW5kb3c7XG59IGVsc2UgaWYgKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICB3aW4gPSBnbG9iYWw7XG59IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiKXtcbiAgICB3aW4gPSBzZWxmO1xufSBlbHNlIHtcbiAgICB3aW4gPSB7fTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB3aW47XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vZ2xvYmFsL3dpbmRvdy5qc1xuLy8gbW9kdWxlIGlkID0gMTQyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0JztcblxuLy8gbW9kaWZpZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vZXMtc2hpbXMvZXM1LXNoaW1cbnZhciBoYXMgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xudmFyIHRvU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciBpc0FyZ3MgPSByZXF1aXJlKCcuL2lzQXJndW1lbnRzJyk7XG52YXIgaXNFbnVtZXJhYmxlID0gT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcbnZhciBoYXNEb250RW51bUJ1ZyA9ICFpc0VudW1lcmFibGUuY2FsbCh7IHRvU3RyaW5nOiBudWxsIH0sICd0b1N0cmluZycpO1xudmFyIGhhc1Byb3RvRW51bUJ1ZyA9IGlzRW51bWVyYWJsZS5jYWxsKGZ1bmN0aW9uICgpIHt9LCAncHJvdG90eXBlJyk7XG52YXIgZG9udEVudW1zID0gW1xuXHQndG9TdHJpbmcnLFxuXHQndG9Mb2NhbGVTdHJpbmcnLFxuXHQndmFsdWVPZicsXG5cdCdoYXNPd25Qcm9wZXJ0eScsXG5cdCdpc1Byb3RvdHlwZU9mJyxcblx0J3Byb3BlcnR5SXNFbnVtZXJhYmxlJyxcblx0J2NvbnN0cnVjdG9yJ1xuXTtcbnZhciBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZSA9IGZ1bmN0aW9uIChvKSB7XG5cdHZhciBjdG9yID0gby5jb25zdHJ1Y3Rvcjtcblx0cmV0dXJuIGN0b3IgJiYgY3Rvci5wcm90b3R5cGUgPT09IG87XG59O1xudmFyIGV4Y2x1ZGVkS2V5cyA9IHtcblx0JGFwcGxpY2F0aW9uQ2FjaGU6IHRydWUsXG5cdCRjb25zb2xlOiB0cnVlLFxuXHQkZXh0ZXJuYWw6IHRydWUsXG5cdCRmcmFtZTogdHJ1ZSxcblx0JGZyYW1lRWxlbWVudDogdHJ1ZSxcblx0JGZyYW1lczogdHJ1ZSxcblx0JGlubmVySGVpZ2h0OiB0cnVlLFxuXHQkaW5uZXJXaWR0aDogdHJ1ZSxcblx0JG91dGVySGVpZ2h0OiB0cnVlLFxuXHQkb3V0ZXJXaWR0aDogdHJ1ZSxcblx0JHBhZ2VYT2Zmc2V0OiB0cnVlLFxuXHQkcGFnZVlPZmZzZXQ6IHRydWUsXG5cdCRwYXJlbnQ6IHRydWUsXG5cdCRzY3JvbGxMZWZ0OiB0cnVlLFxuXHQkc2Nyb2xsVG9wOiB0cnVlLFxuXHQkc2Nyb2xsWDogdHJ1ZSxcblx0JHNjcm9sbFk6IHRydWUsXG5cdCRzZWxmOiB0cnVlLFxuXHQkd2Via2l0SW5kZXhlZERCOiB0cnVlLFxuXHQkd2Via2l0U3RvcmFnZUluZm86IHRydWUsXG5cdCR3aW5kb3c6IHRydWVcbn07XG52YXIgaGFzQXV0b21hdGlvbkVxdWFsaXR5QnVnID0gKGZ1bmN0aW9uICgpIHtcblx0LyogZ2xvYmFsIHdpbmRvdyAqL1xuXHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdGZvciAodmFyIGsgaW4gd2luZG93KSB7XG5cdFx0dHJ5IHtcblx0XHRcdGlmICghZXhjbHVkZWRLZXlzWyckJyArIGtdICYmIGhhcy5jYWxsKHdpbmRvdywgaykgJiYgd2luZG93W2tdICE9PSBudWxsICYmIHR5cGVvZiB3aW5kb3dba10gPT09ICdvYmplY3QnKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0ZXF1YWxzQ29uc3RydWN0b3JQcm90b3R5cGUod2luZG93W2tdKTtcblx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBmYWxzZTtcbn0oKSk7XG52YXIgZXF1YWxzQ29uc3RydWN0b3JQcm90b3R5cGVJZk5vdEJ1Z2d5ID0gZnVuY3Rpb24gKG8pIHtcblx0LyogZ2xvYmFsIHdpbmRvdyAqL1xuXHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgIWhhc0F1dG9tYXRpb25FcXVhbGl0eUJ1Zykge1xuXHRcdHJldHVybiBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZShvKTtcblx0fVxuXHR0cnkge1xuXHRcdHJldHVybiBlcXVhbHNDb25zdHJ1Y3RvclByb3RvdHlwZShvKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufTtcblxudmFyIGtleXNTaGltID0gZnVuY3Rpb24ga2V5cyhvYmplY3QpIHtcblx0dmFyIGlzT2JqZWN0ID0gb2JqZWN0ICE9PSBudWxsICYmIHR5cGVvZiBvYmplY3QgPT09ICdvYmplY3QnO1xuXHR2YXIgaXNGdW5jdGlvbiA9IHRvU3RyLmNhbGwob2JqZWN0KSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcblx0dmFyIGlzQXJndW1lbnRzID0gaXNBcmdzKG9iamVjdCk7XG5cdHZhciBpc1N0cmluZyA9IGlzT2JqZWN0ICYmIHRvU3RyLmNhbGwob2JqZWN0KSA9PT0gJ1tvYmplY3QgU3RyaW5nXSc7XG5cdHZhciB0aGVLZXlzID0gW107XG5cblx0aWYgKCFpc09iamVjdCAmJiAhaXNGdW5jdGlvbiAmJiAhaXNBcmd1bWVudHMpIHtcblx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCdPYmplY3Qua2V5cyBjYWxsZWQgb24gYSBub24tb2JqZWN0Jyk7XG5cdH1cblxuXHR2YXIgc2tpcFByb3RvID0gaGFzUHJvdG9FbnVtQnVnICYmIGlzRnVuY3Rpb247XG5cdGlmIChpc1N0cmluZyAmJiBvYmplY3QubGVuZ3RoID4gMCAmJiAhaGFzLmNhbGwob2JqZWN0LCAwKSkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgb2JqZWN0Lmxlbmd0aDsgKytpKSB7XG5cdFx0XHR0aGVLZXlzLnB1c2goU3RyaW5nKGkpKTtcblx0XHR9XG5cdH1cblxuXHRpZiAoaXNBcmd1bWVudHMgJiYgb2JqZWN0Lmxlbmd0aCA+IDApIHtcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IG9iamVjdC5sZW5ndGg7ICsraikge1xuXHRcdFx0dGhlS2V5cy5wdXNoKFN0cmluZyhqKSk7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdGZvciAodmFyIG5hbWUgaW4gb2JqZWN0KSB7XG5cdFx0XHRpZiAoIShza2lwUHJvdG8gJiYgbmFtZSA9PT0gJ3Byb3RvdHlwZScpICYmIGhhcy5jYWxsKG9iamVjdCwgbmFtZSkpIHtcblx0XHRcdFx0dGhlS2V5cy5wdXNoKFN0cmluZyhuYW1lKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKGhhc0RvbnRFbnVtQnVnKSB7XG5cdFx0dmFyIHNraXBDb25zdHJ1Y3RvciA9IGVxdWFsc0NvbnN0cnVjdG9yUHJvdG90eXBlSWZOb3RCdWdneShvYmplY3QpO1xuXG5cdFx0Zm9yICh2YXIgayA9IDA7IGsgPCBkb250RW51bXMubGVuZ3RoOyArK2spIHtcblx0XHRcdGlmICghKHNraXBDb25zdHJ1Y3RvciAmJiBkb250RW51bXNba10gPT09ICdjb25zdHJ1Y3RvcicpICYmIGhhcy5jYWxsKG9iamVjdCwgZG9udEVudW1zW2tdKSkge1xuXHRcdFx0XHR0aGVLZXlzLnB1c2goZG9udEVudW1zW2tdKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIHRoZUtleXM7XG59O1xuXG5rZXlzU2hpbS5zaGltID0gZnVuY3Rpb24gc2hpbU9iamVjdEtleXMoKSB7XG5cdGlmIChPYmplY3Qua2V5cykge1xuXHRcdHZhciBrZXlzV29ya3NXaXRoQXJndW1lbnRzID0gKGZ1bmN0aW9uICgpIHtcblx0XHRcdC8vIFNhZmFyaSA1LjAgYnVnXG5cdFx0XHRyZXR1cm4gKE9iamVjdC5rZXlzKGFyZ3VtZW50cykgfHwgJycpLmxlbmd0aCA9PT0gMjtcblx0XHR9KDEsIDIpKTtcblx0XHRpZiAoIWtleXNXb3Jrc1dpdGhBcmd1bWVudHMpIHtcblx0XHRcdHZhciBvcmlnaW5hbEtleXMgPSBPYmplY3Qua2V5cztcblx0XHRcdE9iamVjdC5rZXlzID0gZnVuY3Rpb24ga2V5cyhvYmplY3QpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBmdW5jLW5hbWUtbWF0Y2hpbmdcblx0XHRcdFx0aWYgKGlzQXJncyhvYmplY3QpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9yaWdpbmFsS2V5cyhzbGljZS5jYWxsKG9iamVjdCkpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiBvcmlnaW5hbEtleXMob2JqZWN0KTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0T2JqZWN0LmtleXMgPSBrZXlzU2hpbTtcblx0fVxuXHRyZXR1cm4gT2JqZWN0LmtleXMgfHwga2V5c1NoaW07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGtleXNTaGltO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L29iamVjdC1rZXlzL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAxNDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdG9TdHIgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQXJndW1lbnRzKHZhbHVlKSB7XG5cdHZhciBzdHIgPSB0b1N0ci5jYWxsKHZhbHVlKTtcblx0dmFyIGlzQXJncyA9IHN0ciA9PT0gJ1tvYmplY3QgQXJndW1lbnRzXSc7XG5cdGlmICghaXNBcmdzKSB7XG5cdFx0aXNBcmdzID0gc3RyICE9PSAnW29iamVjdCBBcnJheV0nICYmXG5cdFx0XHR2YWx1ZSAhPT0gbnVsbCAmJlxuXHRcdFx0dHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJlxuXHRcdFx0dHlwZW9mIHZhbHVlLmxlbmd0aCA9PT0gJ251bWJlcicgJiZcblx0XHRcdHZhbHVlLmxlbmd0aCA+PSAwICYmXG5cdFx0XHR0b1N0ci5jYWxsKHZhbHVlLmNhbGxlZSkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG5cdH1cblx0cmV0dXJuIGlzQXJncztcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vb2JqZWN0LWtleXMvaXNBcmd1bWVudHMuanNcbi8vIG1vZHVsZSBpZCA9IDE0NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgc3RyaW5naWZ5UHJpbWl0aXZlID0gZnVuY3Rpb24odikge1xuICBzd2l0Y2ggKHR5cGVvZiB2KSB7XG4gICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgIHJldHVybiB2O1xuXG4gICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICByZXR1cm4gdiA/ICd0cnVlJyA6ICdmYWxzZSc7XG5cbiAgICBjYXNlICdudW1iZXInOlxuICAgICAgcmV0dXJuIGlzRmluaXRlKHYpID8gdiA6ICcnO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiAnJztcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmosIHNlcCwgZXEsIG5hbWUpIHtcbiAgc2VwID0gc2VwIHx8ICcmJztcbiAgZXEgPSBlcSB8fCAnPSc7XG4gIGlmIChvYmogPT09IG51bGwpIHtcbiAgICBvYmogPSB1bmRlZmluZWQ7XG4gIH1cblxuICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gbWFwKG9iamVjdEtleXMob2JqKSwgZnVuY3Rpb24oaykge1xuICAgICAgdmFyIGtzID0gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShrKSkgKyBlcTtcbiAgICAgIGlmIChpc0FycmF5KG9ialtrXSkpIHtcbiAgICAgICAgcmV0dXJuIG1hcChvYmpba10sIGZ1bmN0aW9uKHYpIHtcbiAgICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKHYpKTtcbiAgICAgICAgfSkuam9pbihzZXApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGtzICsgZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShvYmpba10pKTtcbiAgICAgIH1cbiAgICB9KS5qb2luKHNlcCk7XG5cbiAgfVxuXG4gIGlmICghbmFtZSkgcmV0dXJuICcnO1xuICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cmluZ2lmeVByaW1pdGl2ZShuYW1lKSkgKyBlcSArXG4gICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9iaikpO1xufTtcblxudmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uICh4cykge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHhzKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn07XG5cbmZ1bmN0aW9uIG1hcCAoeHMsIGYpIHtcbiAgaWYgKHhzLm1hcCkgcmV0dXJuIHhzLm1hcChmKTtcbiAgdmFyIHJlcyA9IFtdO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHhzLmxlbmd0aDsgaSsrKSB7XG4gICAgcmVzLnB1c2goZih4c1tpXSwgaSkpO1xuICB9XG4gIHJldHVybiByZXM7XG59XG5cbnZhciBvYmplY3RLZXlzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24gKG9iaikge1xuICB2YXIgcmVzID0gW107XG4gIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgcmVzLnB1c2goa2V5KTtcbiAgfVxuICByZXR1cm4gcmVzO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9xdWVyeXN0cmluZy1lczMvZW5jb2RlLmpzXG4vLyBtb2R1bGUgaWQgPSAxNDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiKGZ1bmN0aW9uIChnbG9iYWwsIHVuZGVmaW5lZCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaWYgKGdsb2JhbC5zZXRJbW1lZGlhdGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBuZXh0SGFuZGxlID0gMTsgLy8gU3BlYyBzYXlzIGdyZWF0ZXIgdGhhbiB6ZXJvXG4gICAgdmFyIHRhc2tzQnlIYW5kbGUgPSB7fTtcbiAgICB2YXIgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7XG4gICAgdmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDtcbiAgICB2YXIgcmVnaXN0ZXJJbW1lZGlhdGU7XG5cbiAgICBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoY2FsbGJhY2spIHtcbiAgICAgIC8vIENhbGxiYWNrIGNhbiBlaXRoZXIgYmUgYSBmdW5jdGlvbiBvciBhIHN0cmluZ1xuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGNhbGxiYWNrID0gbmV3IEZ1bmN0aW9uKFwiXCIgKyBjYWxsYmFjayk7XG4gICAgICB9XG4gICAgICAvLyBDb3B5IGZ1bmN0aW9uIGFyZ3VtZW50c1xuICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpICsgMV07XG4gICAgICB9XG4gICAgICAvLyBTdG9yZSBhbmQgcmVnaXN0ZXIgdGhlIHRhc2tcbiAgICAgIHZhciB0YXNrID0geyBjYWxsYmFjazogY2FsbGJhY2ssIGFyZ3M6IGFyZ3MgfTtcbiAgICAgIHRhc2tzQnlIYW5kbGVbbmV4dEhhbmRsZV0gPSB0YXNrO1xuICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUobmV4dEhhbmRsZSk7XG4gICAgICByZXR1cm4gbmV4dEhhbmRsZSsrO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGhhbmRsZSkge1xuICAgICAgICBkZWxldGUgdGFza3NCeUhhbmRsZVtoYW5kbGVdO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJ1bih0YXNrKSB7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IHRhc2suY2FsbGJhY2s7XG4gICAgICAgIHZhciBhcmdzID0gdGFzay5hcmdzO1xuICAgICAgICBzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSwgYXJnc1sxXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJ1bklmUHJlc2VudChoYW5kbGUpIHtcbiAgICAgICAgLy8gRnJvbSB0aGUgc3BlYzogXCJXYWl0IHVudGlsIGFueSBpbnZvY2F0aW9ucyBvZiB0aGlzIGFsZ29yaXRobSBzdGFydGVkIGJlZm9yZSB0aGlzIG9uZSBoYXZlIGNvbXBsZXRlZC5cIlxuICAgICAgICAvLyBTbyBpZiB3ZSdyZSBjdXJyZW50bHkgcnVubmluZyBhIHRhc2ssIHdlJ2xsIG5lZWQgdG8gZGVsYXkgdGhpcyBpbnZvY2F0aW9uLlxuICAgICAgICBpZiAoY3VycmVudGx5UnVubmluZ0FUYXNrKSB7XG4gICAgICAgICAgICAvLyBEZWxheSBieSBkb2luZyBhIHNldFRpbWVvdXQuIHNldEltbWVkaWF0ZSB3YXMgdHJpZWQgaW5zdGVhZCwgYnV0IGluIEZpcmVmb3ggNyBpdCBnZW5lcmF0ZWQgYVxuICAgICAgICAgICAgLy8gXCJ0b28gbXVjaCByZWN1cnNpb25cIiBlcnJvci5cbiAgICAgICAgICAgIHNldFRpbWVvdXQocnVuSWZQcmVzZW50LCAwLCBoYW5kbGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRhc2sgPSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG4gICAgICAgICAgICBpZiAodGFzaykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IHRydWU7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcnVuKHRhc2spO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW1tZWRpYXRlKGhhbmRsZSk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxOZXh0VGlja0ltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7IHJ1bklmUHJlc2VudChoYW5kbGUpOyB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYW5Vc2VQb3N0TWVzc2FnZSgpIHtcbiAgICAgICAgLy8gVGhlIHRlc3QgYWdhaW5zdCBgaW1wb3J0U2NyaXB0c2AgcHJldmVudHMgdGhpcyBpbXBsZW1lbnRhdGlvbiBmcm9tIGJlaW5nIGluc3RhbGxlZCBpbnNpZGUgYSB3ZWIgd29ya2VyLFxuICAgICAgICAvLyB3aGVyZSBgZ2xvYmFsLnBvc3RNZXNzYWdlYCBtZWFucyBzb21ldGhpbmcgY29tcGxldGVseSBkaWZmZXJlbnQgYW5kIGNhbid0IGJlIHVzZWQgZm9yIHRoaXMgcHVycG9zZS5cbiAgICAgICAgaWYgKGdsb2JhbC5wb3N0TWVzc2FnZSAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpIHtcbiAgICAgICAgICAgIHZhciBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBvbGRPbk1lc3NhZ2UgPSBnbG9iYWwub25tZXNzYWdlO1xuICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBnbG9iYWwucG9zdE1lc3NhZ2UoXCJcIiwgXCIqXCIpO1xuICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IG9sZE9uTWVzc2FnZTtcbiAgICAgICAgICAgIHJldHVybiBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIC8vIEluc3RhbGxzIGFuIGV2ZW50IGhhbmRsZXIgb24gYGdsb2JhbGAgZm9yIHRoZSBgbWVzc2FnZWAgZXZlbnQ6IHNlZVxuICAgICAgICAvLyAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0RPTS93aW5kb3cucG9zdE1lc3NhZ2VcbiAgICAgICAgLy8gKiBodHRwOi8vd3d3LndoYXR3Zy5vcmcvc3BlY3Mvd2ViLWFwcHMvY3VycmVudC13b3JrL211bHRpcGFnZS9jb21tcy5odG1sI2Nyb3NzRG9jdW1lbnRNZXNzYWdlc1xuXG4gICAgICAgIHZhciBtZXNzYWdlUHJlZml4ID0gXCJzZXRJbW1lZGlhdGUkXCIgKyBNYXRoLnJhbmRvbSgpICsgXCIkXCI7XG4gICAgICAgIHZhciBvbkdsb2JhbE1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gZ2xvYmFsICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIGV2ZW50LmRhdGEgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgICAgICAgICBldmVudC5kYXRhLmluZGV4T2YobWVzc2FnZVByZWZpeCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBydW5JZlByZXNlbnQoK2V2ZW50LmRhdGEuc2xpY2UobWVzc2FnZVByZWZpeC5sZW5ndGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBvbkdsb2JhbE1lc3NhZ2UsIGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdsb2JhbC5hdHRhY2hFdmVudChcIm9ubWVzc2FnZVwiLCBvbkdsb2JhbE1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShtZXNzYWdlUHJlZml4ICsgaGFuZGxlLCBcIipcIik7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gICAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGUgPSBldmVudC5kYXRhO1xuICAgICAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoaGFuZGxlKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICB2YXIgaHRtbCA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgYSA8c2NyaXB0PiBlbGVtZW50OyBpdHMgcmVhZHlzdGF0ZWNoYW5nZSBldmVudCB3aWxsIGJlIGZpcmVkIGFzeW5jaHJvbm91c2x5IG9uY2UgaXQgaXMgaW5zZXJ0ZWRcbiAgICAgICAgICAgIC8vIGludG8gdGhlIGRvY3VtZW50LiBEbyBzbywgdGh1cyBxdWV1aW5nIHVwIHRoZSB0YXNrLiBSZW1lbWJlciB0byBjbGVhbiB1cCBvbmNlIGl0J3MgYmVlbiBjYWxsZWQuXG4gICAgICAgICAgICB2YXIgc2NyaXB0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgICAgICAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpO1xuICAgICAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICBzY3JpcHQgPSBudWxsO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChydW5JZlByZXNlbnQsIDAsIGhhbmRsZSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gSWYgc3VwcG9ydGVkLCB3ZSBzaG91bGQgYXR0YWNoIHRvIHRoZSBwcm90b3R5cGUgb2YgZ2xvYmFsLCBzaW5jZSB0aGF0IGlzIHdoZXJlIHNldFRpbWVvdXQgZXQgYWwuIGxpdmUuXG4gICAgdmFyIGF0dGFjaFRvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mICYmIE9iamVjdC5nZXRQcm90b3R5cGVPZihnbG9iYWwpO1xuICAgIGF0dGFjaFRvID0gYXR0YWNoVG8gJiYgYXR0YWNoVG8uc2V0VGltZW91dCA/IGF0dGFjaFRvIDogZ2xvYmFsO1xuXG4gICAgLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBlLmcuIGJyb3dzZXJpZnkgZW52aXJvbm1lbnRzLlxuICAgIGlmICh7fS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gXCJbb2JqZWN0IHByb2Nlc3NdXCIpIHtcbiAgICAgICAgLy8gRm9yIE5vZGUuanMgYmVmb3JlIDAuOVxuICAgICAgICBpbnN0YWxsTmV4dFRpY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgfSBlbHNlIGlmIChjYW5Vc2VQb3N0TWVzc2FnZSgpKSB7XG4gICAgICAgIC8vIEZvciBub24tSUUxMCBtb2Rlcm4gYnJvd3NlcnNcbiAgICAgICAgaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSBpZiAoZ2xvYmFsLk1lc3NhZ2VDaGFubmVsKSB7XG4gICAgICAgIC8vIEZvciB3ZWIgd29ya2Vycywgd2hlcmUgc3VwcG9ydGVkXG4gICAgICAgIGluc3RhbGxNZXNzYWdlQ2hhbm5lbEltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2UgaWYgKGRvYyAmJiBcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiIGluIGRvYy5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpKSB7XG4gICAgICAgIC8vIEZvciBJRSA24oCTOFxuICAgICAgICBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGb3Igb2xkZXIgYnJvd3NlcnNcbiAgICAgICAgaW5zdGFsbFNldFRpbWVvdXRJbXBsZW1lbnRhdGlvbigpO1xuICAgIH1cblxuICAgIGF0dGFjaFRvLnNldEltbWVkaWF0ZSA9IHNldEltbWVkaWF0ZTtcbiAgICBhdHRhY2hUby5jbGVhckltbWVkaWF0ZSA9IGNsZWFySW1tZWRpYXRlO1xufSh0eXBlb2Ygc2VsZiA9PT0gXCJ1bmRlZmluZWRcIiA/IHR5cGVvZiBnbG9iYWwgPT09IFwidW5kZWZpbmVkXCIgPyB0aGlzIDogZ2xvYmFsIDogc2VsZikpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3NldGltbWVkaWF0ZS9zZXRJbW1lZGlhdGUuanNcbi8vIG1vZHVsZSBpZCA9IDE0NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKlxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuXHRBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXG4qL1xuXG52YXIgc3R5bGVzSW5Eb20gPSB7fTtcblxudmFyXHRtZW1vaXplID0gZnVuY3Rpb24gKGZuKSB7XG5cdHZhciBtZW1vO1xuXG5cdHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKHR5cGVvZiBtZW1vID09PSBcInVuZGVmaW5lZFwiKSBtZW1vID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRyZXR1cm4gbWVtbztcblx0fTtcbn07XG5cbnZhciBpc09sZElFID0gbWVtb2l6ZShmdW5jdGlvbiAoKSB7XG5cdC8vIFRlc3QgZm9yIElFIDw9IDkgYXMgcHJvcG9zZWQgYnkgQnJvd3NlcmhhY2tzXG5cdC8vIEBzZWUgaHR0cDovL2Jyb3dzZXJoYWNrcy5jb20vI2hhY2stZTcxZDg2OTJmNjUzMzQxNzNmZWU3MTVjMjIyY2I4MDVcblx0Ly8gVGVzdHMgZm9yIGV4aXN0ZW5jZSBvZiBzdGFuZGFyZCBnbG9iYWxzIGlzIHRvIGFsbG93IHN0eWxlLWxvYWRlclxuXHQvLyB0byBvcGVyYXRlIGNvcnJlY3RseSBpbnRvIG5vbi1zdGFuZGFyZCBlbnZpcm9ubWVudHNcblx0Ly8gQHNlZSBodHRwczovL2dpdGh1Yi5jb20vd2VicGFjay1jb250cmliL3N0eWxlLWxvYWRlci9pc3N1ZXMvMTc3XG5cdHJldHVybiB3aW5kb3cgJiYgZG9jdW1lbnQgJiYgZG9jdW1lbnQuYWxsICYmICF3aW5kb3cuYXRvYjtcbn0pO1xuXG52YXIgZ2V0VGFyZ2V0ID0gZnVuY3Rpb24gKHRhcmdldCwgcGFyZW50KSB7XG4gIGlmIChwYXJlbnQpe1xuICAgIHJldHVybiBwYXJlbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpO1xuICB9XG4gIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7XG59O1xuXG52YXIgZ2V0RWxlbWVudCA9IChmdW5jdGlvbiAoZm4pIHtcblx0dmFyIG1lbW8gPSB7fTtcblxuXHRyZXR1cm4gZnVuY3Rpb24odGFyZ2V0LCBwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBwYXNzaW5nIGZ1bmN0aW9uIGluIG9wdGlvbnMsIHRoZW4gdXNlIGl0IGZvciByZXNvbHZlIFwiaGVhZFwiIGVsZW1lbnQuXG4gICAgICAgICAgICAgICAgLy8gVXNlZnVsIGZvciBTaGFkb3cgUm9vdCBzdHlsZSBpLmVcbiAgICAgICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAgICAgLy8gICBpbnNlcnRJbnRvOiBmdW5jdGlvbiAoKSB7IHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvb1wiKS5zaGFkb3dSb290IH1cbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZW1vW3RhcmdldF0gPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdHZhciBzdHlsZVRhcmdldCA9IGdldFRhcmdldC5jYWxsKHRoaXMsIHRhcmdldCwgcGFyZW50KTtcblx0XHRcdC8vIFNwZWNpYWwgY2FzZSB0byByZXR1cm4gaGVhZCBvZiBpZnJhbWUgaW5zdGVhZCBvZiBpZnJhbWUgaXRzZWxmXG5cdFx0XHRpZiAod2luZG93LkhUTUxJRnJhbWVFbGVtZW50ICYmIHN0eWxlVGFyZ2V0IGluc3RhbmNlb2Ygd2luZG93LkhUTUxJRnJhbWVFbGVtZW50KSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Ly8gVGhpcyB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhY2Nlc3MgdG8gaWZyYW1lIGlzIGJsb2NrZWRcblx0XHRcdFx0XHQvLyBkdWUgdG8gY3Jvc3Mtb3JpZ2luIHJlc3RyaWN0aW9uc1xuXHRcdFx0XHRcdHN0eWxlVGFyZ2V0ID0gc3R5bGVUYXJnZXQuY29udGVudERvY3VtZW50LmhlYWQ7XG5cdFx0XHRcdH0gY2F0Y2goZSkge1xuXHRcdFx0XHRcdHN0eWxlVGFyZ2V0ID0gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0bWVtb1t0YXJnZXRdID0gc3R5bGVUYXJnZXQ7XG5cdFx0fVxuXHRcdHJldHVybiBtZW1vW3RhcmdldF1cblx0fTtcbn0pKCk7XG5cbnZhciBzaW5nbGV0b24gPSBudWxsO1xudmFyXHRzaW5nbGV0b25Db3VudGVyID0gMDtcbnZhclx0c3R5bGVzSW5zZXJ0ZWRBdFRvcCA9IFtdO1xuXG52YXJcdGZpeFVybHMgPSByZXF1aXJlKFwiLi91cmxzXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxpc3QsIG9wdGlvbnMpIHtcblx0aWYgKHR5cGVvZiBERUJVRyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBERUJVRykge1xuXHRcdGlmICh0eXBlb2YgZG9jdW1lbnQgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBFcnJvcihcIlRoZSBzdHlsZS1sb2FkZXIgY2Fubm90IGJlIHVzZWQgaW4gYSBub24tYnJvd3NlciBlbnZpcm9ubWVudFwiKTtcblx0fVxuXG5cdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG5cdG9wdGlvbnMuYXR0cnMgPSB0eXBlb2Ygb3B0aW9ucy5hdHRycyA9PT0gXCJvYmplY3RcIiA/IG9wdGlvbnMuYXR0cnMgOiB7fTtcblxuXHQvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT5cblx0Ly8gdGFncyBpdCB3aWxsIGFsbG93IG9uIGEgcGFnZVxuXHRpZiAoIW9wdGlvbnMuc2luZ2xldG9uICYmIHR5cGVvZiBvcHRpb25zLnNpbmdsZXRvbiAhPT0gXCJib29sZWFuXCIpIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xuXG5cdC8vIEJ5IGRlZmF1bHQsIGFkZCA8c3R5bGU+IHRhZ3MgdG8gdGhlIDxoZWFkPiBlbGVtZW50XG4gICAgICAgIGlmICghb3B0aW9ucy5pbnNlcnRJbnRvKSBvcHRpb25zLmluc2VydEludG8gPSBcImhlYWRcIjtcblxuXHQvLyBCeSBkZWZhdWx0LCBhZGQgPHN0eWxlPiB0YWdzIHRvIHRoZSBib3R0b20gb2YgdGhlIHRhcmdldFxuXHRpZiAoIW9wdGlvbnMuaW5zZXJ0QXQpIG9wdGlvbnMuaW5zZXJ0QXQgPSBcImJvdHRvbVwiO1xuXG5cdHZhciBzdHlsZXMgPSBsaXN0VG9TdHlsZXMobGlzdCwgb3B0aW9ucyk7XG5cblx0YWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKTtcblxuXHRyZXR1cm4gZnVuY3Rpb24gdXBkYXRlIChuZXdMaXN0KSB7XG5cdFx0dmFyIG1heVJlbW92ZSA9IFtdO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xuXHRcdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XG5cblx0XHRcdGRvbVN0eWxlLnJlZnMtLTtcblx0XHRcdG1heVJlbW92ZS5wdXNoKGRvbVN0eWxlKTtcblx0XHR9XG5cblx0XHRpZihuZXdMaXN0KSB7XG5cdFx0XHR2YXIgbmV3U3R5bGVzID0gbGlzdFRvU3R5bGVzKG5ld0xpc3QsIG9wdGlvbnMpO1xuXHRcdFx0YWRkU3R5bGVzVG9Eb20obmV3U3R5bGVzLCBvcHRpb25zKTtcblx0XHR9XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG1heVJlbW92ZS5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGRvbVN0eWxlID0gbWF5UmVtb3ZlW2ldO1xuXG5cdFx0XHRpZihkb21TdHlsZS5yZWZzID09PSAwKSB7XG5cdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIGRvbVN0eWxlLnBhcnRzW2pdKCk7XG5cblx0XHRcdFx0ZGVsZXRlIHN0eWxlc0luRG9tW2RvbVN0eWxlLmlkXTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG59O1xuXG5mdW5jdGlvbiBhZGRTdHlsZXNUb0RvbSAoc3R5bGVzLCBvcHRpb25zKSB7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XG5cdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XG5cblx0XHRpZihkb21TdHlsZSkge1xuXHRcdFx0ZG9tU3R5bGUucmVmcysrO1xuXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0ZG9tU3R5bGUucGFydHNbal0oaXRlbS5wYXJ0c1tqXSk7XG5cdFx0XHR9XG5cblx0XHRcdGZvcig7IGogPCBpdGVtLnBhcnRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdGRvbVN0eWxlLnBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSwgb3B0aW9ucykpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgcGFydHMgPSBbXTtcblxuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0cGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XG5cdFx0XHR9XG5cblx0XHRcdHN0eWxlc0luRG9tW2l0ZW0uaWRdID0ge2lkOiBpdGVtLmlkLCByZWZzOiAxLCBwYXJ0czogcGFydHN9O1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBsaXN0VG9TdHlsZXMgKGxpc3QsIG9wdGlvbnMpIHtcblx0dmFyIHN0eWxlcyA9IFtdO1xuXHR2YXIgbmV3U3R5bGVzID0ge307XG5cblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIGl0ZW0gPSBsaXN0W2ldO1xuXHRcdHZhciBpZCA9IG9wdGlvbnMuYmFzZSA/IGl0ZW1bMF0gKyBvcHRpb25zLmJhc2UgOiBpdGVtWzBdO1xuXHRcdHZhciBjc3MgPSBpdGVtWzFdO1xuXHRcdHZhciBtZWRpYSA9IGl0ZW1bMl07XG5cdFx0dmFyIHNvdXJjZU1hcCA9IGl0ZW1bM107XG5cdFx0dmFyIHBhcnQgPSB7Y3NzOiBjc3MsIG1lZGlhOiBtZWRpYSwgc291cmNlTWFwOiBzb3VyY2VNYXB9O1xuXG5cdFx0aWYoIW5ld1N0eWxlc1tpZF0pIHN0eWxlcy5wdXNoKG5ld1N0eWxlc1tpZF0gPSB7aWQ6IGlkLCBwYXJ0czogW3BhcnRdfSk7XG5cdFx0ZWxzZSBuZXdTdHlsZXNbaWRdLnBhcnRzLnB1c2gocGFydCk7XG5cdH1cblxuXHRyZXR1cm4gc3R5bGVzO1xufVxuXG5mdW5jdGlvbiBpbnNlcnRTdHlsZUVsZW1lbnQgKG9wdGlvbnMsIHN0eWxlKSB7XG5cdHZhciB0YXJnZXQgPSBnZXRFbGVtZW50KG9wdGlvbnMuaW5zZXJ0SW50bylcblxuXHRpZiAoIXRhcmdldCkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkNvdWxkbid0IGZpbmQgYSBzdHlsZSB0YXJnZXQuIFRoaXMgcHJvYmFibHkgbWVhbnMgdGhhdCB0aGUgdmFsdWUgZm9yIHRoZSAnaW5zZXJ0SW50bycgcGFyYW1ldGVyIGlzIGludmFsaWQuXCIpO1xuXHR9XG5cblx0dmFyIGxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wID0gc3R5bGVzSW5zZXJ0ZWRBdFRvcFtzdHlsZXNJbnNlcnRlZEF0VG9wLmxlbmd0aCAtIDFdO1xuXG5cdGlmIChvcHRpb25zLmluc2VydEF0ID09PSBcInRvcFwiKSB7XG5cdFx0aWYgKCFsYXN0U3R5bGVFbGVtZW50SW5zZXJ0ZWRBdFRvcCkge1xuXHRcdFx0dGFyZ2V0Lmluc2VydEJlZm9yZShzdHlsZSwgdGFyZ2V0LmZpcnN0Q2hpbGQpO1xuXHRcdH0gZWxzZSBpZiAobGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpIHtcblx0XHRcdHRhcmdldC5pbnNlcnRCZWZvcmUoc3R5bGUsIGxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wLm5leHRTaWJsaW5nKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGFyZ2V0LmFwcGVuZENoaWxkKHN0eWxlKTtcblx0XHR9XG5cdFx0c3R5bGVzSW5zZXJ0ZWRBdFRvcC5wdXNoKHN0eWxlKTtcblx0fSBlbHNlIGlmIChvcHRpb25zLmluc2VydEF0ID09PSBcImJvdHRvbVwiKSB7XG5cdFx0dGFyZ2V0LmFwcGVuZENoaWxkKHN0eWxlKTtcblx0fSBlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucy5pbnNlcnRBdCA9PT0gXCJvYmplY3RcIiAmJiBvcHRpb25zLmluc2VydEF0LmJlZm9yZSkge1xuXHRcdHZhciBuZXh0U2libGluZyA9IGdldEVsZW1lbnQob3B0aW9ucy5pbnNlcnRBdC5iZWZvcmUsIHRhcmdldCk7XG5cdFx0dGFyZ2V0Lmluc2VydEJlZm9yZShzdHlsZSwgbmV4dFNpYmxpbmcpO1xuXHR9IGVsc2Uge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIltTdHlsZSBMb2FkZXJdXFxuXFxuIEludmFsaWQgdmFsdWUgZm9yIHBhcmFtZXRlciAnaW5zZXJ0QXQnICgnb3B0aW9ucy5pbnNlcnRBdCcpIGZvdW5kLlxcbiBNdXN0IGJlICd0b3AnLCAnYm90dG9tJywgb3IgT2JqZWN0LlxcbiAoaHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9zdHlsZS1sb2FkZXIjaW5zZXJ0YXQpXFxuXCIpO1xuXHR9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVN0eWxlRWxlbWVudCAoc3R5bGUpIHtcblx0aWYgKHN0eWxlLnBhcmVudE5vZGUgPT09IG51bGwpIHJldHVybiBmYWxzZTtcblx0c3R5bGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZSk7XG5cblx0dmFyIGlkeCA9IHN0eWxlc0luc2VydGVkQXRUb3AuaW5kZXhPZihzdHlsZSk7XG5cdGlmKGlkeCA+PSAwKSB7XG5cdFx0c3R5bGVzSW5zZXJ0ZWRBdFRvcC5zcGxpY2UoaWR4LCAxKTtcblx0fVxufVxuXG5mdW5jdGlvbiBjcmVhdGVTdHlsZUVsZW1lbnQgKG9wdGlvbnMpIHtcblx0dmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuXG5cdGlmKG9wdGlvbnMuYXR0cnMudHlwZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0b3B0aW9ucy5hdHRycy50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuXHR9XG5cblx0aWYob3B0aW9ucy5hdHRycy5ub25jZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0dmFyIG5vbmNlID0gZ2V0Tm9uY2UoKTtcblx0XHRpZiAobm9uY2UpIHtcblx0XHRcdG9wdGlvbnMuYXR0cnMubm9uY2UgPSBub25jZTtcblx0XHR9XG5cdH1cblxuXHRhZGRBdHRycyhzdHlsZSwgb3B0aW9ucy5hdHRycyk7XG5cdGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zLCBzdHlsZSk7XG5cblx0cmV0dXJuIHN0eWxlO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVMaW5rRWxlbWVudCAob3B0aW9ucykge1xuXHR2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xuXG5cdGlmKG9wdGlvbnMuYXR0cnMudHlwZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0b3B0aW9ucy5hdHRycy50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuXHR9XG5cdG9wdGlvbnMuYXR0cnMucmVsID0gXCJzdHlsZXNoZWV0XCI7XG5cblx0YWRkQXR0cnMobGluaywgb3B0aW9ucy5hdHRycyk7XG5cdGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zLCBsaW5rKTtcblxuXHRyZXR1cm4gbGluaztcbn1cblxuZnVuY3Rpb24gYWRkQXR0cnMgKGVsLCBhdHRycykge1xuXHRPYmplY3Qua2V5cyhhdHRycykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG5cdFx0ZWwuc2V0QXR0cmlidXRlKGtleSwgYXR0cnNba2V5XSk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiBnZXROb25jZSgpIHtcblx0aWYgKHR5cGVvZiBfX3dlYnBhY2tfbm9uY2VfXyA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdHJldHVybiBfX3dlYnBhY2tfbm9uY2VfXztcbn1cblxuZnVuY3Rpb24gYWRkU3R5bGUgKG9iaiwgb3B0aW9ucykge1xuXHR2YXIgc3R5bGUsIHVwZGF0ZSwgcmVtb3ZlLCByZXN1bHQ7XG5cblx0Ly8gSWYgYSB0cmFuc2Zvcm0gZnVuY3Rpb24gd2FzIGRlZmluZWQsIHJ1biBpdCBvbiB0aGUgY3NzXG5cdGlmIChvcHRpb25zLnRyYW5zZm9ybSAmJiBvYmouY3NzKSB7XG5cdCAgICByZXN1bHQgPSB0eXBlb2Ygb3B0aW9ucy50cmFuc2Zvcm0gPT09ICdmdW5jdGlvbidcblx0XHQgPyBvcHRpb25zLnRyYW5zZm9ybShvYmouY3NzKSBcblx0XHQgOiBvcHRpb25zLnRyYW5zZm9ybS5kZWZhdWx0KG9iai5jc3MpO1xuXG5cdCAgICBpZiAocmVzdWx0KSB7XG5cdCAgICBcdC8vIElmIHRyYW5zZm9ybSByZXR1cm5zIGEgdmFsdWUsIHVzZSB0aGF0IGluc3RlYWQgb2YgdGhlIG9yaWdpbmFsIGNzcy5cblx0ICAgIFx0Ly8gVGhpcyBhbGxvd3MgcnVubmluZyBydW50aW1lIHRyYW5zZm9ybWF0aW9ucyBvbiB0aGUgY3NzLlxuXHQgICAgXHRvYmouY3NzID0gcmVzdWx0O1xuXHQgICAgfSBlbHNlIHtcblx0ICAgIFx0Ly8gSWYgdGhlIHRyYW5zZm9ybSBmdW5jdGlvbiByZXR1cm5zIGEgZmFsc3kgdmFsdWUsIGRvbid0IGFkZCB0aGlzIGNzcy5cblx0ICAgIFx0Ly8gVGhpcyBhbGxvd3MgY29uZGl0aW9uYWwgbG9hZGluZyBvZiBjc3Ncblx0ICAgIFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgXHRcdC8vIG5vb3Bcblx0ICAgIFx0fTtcblx0ICAgIH1cblx0fVxuXG5cdGlmIChvcHRpb25zLnNpbmdsZXRvbikge1xuXHRcdHZhciBzdHlsZUluZGV4ID0gc2luZ2xldG9uQ291bnRlcisrO1xuXG5cdFx0c3R5bGUgPSBzaW5nbGV0b24gfHwgKHNpbmdsZXRvbiA9IGNyZWF0ZVN0eWxlRWxlbWVudChvcHRpb25zKSk7XG5cblx0XHR1cGRhdGUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGUsIHN0eWxlSW5kZXgsIGZhbHNlKTtcblx0XHRyZW1vdmUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGUsIHN0eWxlSW5kZXgsIHRydWUpO1xuXG5cdH0gZWxzZSBpZiAoXG5cdFx0b2JqLnNvdXJjZU1hcCAmJlxuXHRcdHR5cGVvZiBVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxuXHRcdHR5cGVvZiBVUkwuY3JlYXRlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcblx0XHR0eXBlb2YgVVJMLnJldm9rZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXG5cdFx0dHlwZW9mIEJsb2IgPT09IFwiZnVuY3Rpb25cIiAmJlxuXHRcdHR5cGVvZiBidG9hID09PSBcImZ1bmN0aW9uXCJcblx0KSB7XG5cdFx0c3R5bGUgPSBjcmVhdGVMaW5rRWxlbWVudChvcHRpb25zKTtcblx0XHR1cGRhdGUgPSB1cGRhdGVMaW5rLmJpbmQobnVsbCwgc3R5bGUsIG9wdGlvbnMpO1xuXHRcdHJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZSk7XG5cblx0XHRcdGlmKHN0eWxlLmhyZWYpIFVSTC5yZXZva2VPYmplY3RVUkwoc3R5bGUuaHJlZik7XG5cdFx0fTtcblx0fSBlbHNlIHtcblx0XHRzdHlsZSA9IGNyZWF0ZVN0eWxlRWxlbWVudChvcHRpb25zKTtcblx0XHR1cGRhdGUgPSBhcHBseVRvVGFnLmJpbmQobnVsbCwgc3R5bGUpO1xuXHRcdHJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZSk7XG5cdFx0fTtcblx0fVxuXG5cdHVwZGF0ZShvYmopO1xuXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZSAobmV3T2JqKSB7XG5cdFx0aWYgKG5ld09iaikge1xuXHRcdFx0aWYgKFxuXHRcdFx0XHRuZXdPYmouY3NzID09PSBvYmouY3NzICYmXG5cdFx0XHRcdG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmXG5cdFx0XHRcdG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXBcblx0XHRcdCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdHVwZGF0ZShvYmogPSBuZXdPYmopO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZW1vdmUoKTtcblx0XHR9XG5cdH07XG59XG5cbnZhciByZXBsYWNlVGV4dCA9IChmdW5jdGlvbiAoKSB7XG5cdHZhciB0ZXh0U3RvcmUgPSBbXTtcblxuXHRyZXR1cm4gZnVuY3Rpb24gKGluZGV4LCByZXBsYWNlbWVudCkge1xuXHRcdHRleHRTdG9yZVtpbmRleF0gPSByZXBsYWNlbWVudDtcblxuXHRcdHJldHVybiB0ZXh0U3RvcmUuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJ1xcbicpO1xuXHR9O1xufSkoKTtcblxuZnVuY3Rpb24gYXBwbHlUb1NpbmdsZXRvblRhZyAoc3R5bGUsIGluZGV4LCByZW1vdmUsIG9iaikge1xuXHR2YXIgY3NzID0gcmVtb3ZlID8gXCJcIiA6IG9iai5jc3M7XG5cblx0aWYgKHN0eWxlLnN0eWxlU2hlZXQpIHtcblx0XHRzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSByZXBsYWNlVGV4dChpbmRleCwgY3NzKTtcblx0fSBlbHNlIHtcblx0XHR2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XG5cdFx0dmFyIGNoaWxkTm9kZXMgPSBzdHlsZS5jaGlsZE5vZGVzO1xuXG5cdFx0aWYgKGNoaWxkTm9kZXNbaW5kZXhdKSBzdHlsZS5yZW1vdmVDaGlsZChjaGlsZE5vZGVzW2luZGV4XSk7XG5cblx0XHRpZiAoY2hpbGROb2Rlcy5sZW5ndGgpIHtcblx0XHRcdHN0eWxlLmluc2VydEJlZm9yZShjc3NOb2RlLCBjaGlsZE5vZGVzW2luZGV4XSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN0eWxlLmFwcGVuZENoaWxkKGNzc05vZGUpO1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBhcHBseVRvVGFnIChzdHlsZSwgb2JqKSB7XG5cdHZhciBjc3MgPSBvYmouY3NzO1xuXHR2YXIgbWVkaWEgPSBvYmoubWVkaWE7XG5cblx0aWYobWVkaWEpIHtcblx0XHRzdHlsZS5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBtZWRpYSlcblx0fVxuXG5cdGlmKHN0eWxlLnN0eWxlU2hlZXQpIHtcblx0XHRzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSBjc3M7XG5cdH0gZWxzZSB7XG5cdFx0d2hpbGUoc3R5bGUuZmlyc3RDaGlsZCkge1xuXHRcdFx0c3R5bGUucmVtb3ZlQ2hpbGQoc3R5bGUuZmlyc3RDaGlsZCk7XG5cdFx0fVxuXG5cdFx0c3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XG5cdH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlTGluayAobGluaywgb3B0aW9ucywgb2JqKSB7XG5cdHZhciBjc3MgPSBvYmouY3NzO1xuXHR2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcblxuXHQvKlxuXHRcdElmIGNvbnZlcnRUb0Fic29sdXRlVXJscyBpc24ndCBkZWZpbmVkLCBidXQgc291cmNlbWFwcyBhcmUgZW5hYmxlZFxuXHRcdGFuZCB0aGVyZSBpcyBubyBwdWJsaWNQYXRoIGRlZmluZWQgdGhlbiBsZXRzIHR1cm4gY29udmVydFRvQWJzb2x1dGVVcmxzXG5cdFx0b24gYnkgZGVmYXVsdC4gIE90aGVyd2lzZSBkZWZhdWx0IHRvIHRoZSBjb252ZXJ0VG9BYnNvbHV0ZVVybHMgb3B0aW9uXG5cdFx0ZGlyZWN0bHlcblx0Ki9cblx0dmFyIGF1dG9GaXhVcmxzID0gb3B0aW9ucy5jb252ZXJ0VG9BYnNvbHV0ZVVybHMgPT09IHVuZGVmaW5lZCAmJiBzb3VyY2VNYXA7XG5cblx0aWYgKG9wdGlvbnMuY29udmVydFRvQWJzb2x1dGVVcmxzIHx8IGF1dG9GaXhVcmxzKSB7XG5cdFx0Y3NzID0gZml4VXJscyhjc3MpO1xuXHR9XG5cblx0aWYgKHNvdXJjZU1hcCkge1xuXHRcdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI2NjAzODc1XG5cdFx0Y3NzICs9IFwiXFxuLyojIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxcIiArIGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSkgKyBcIiAqL1wiO1xuXHR9XG5cblx0dmFyIGJsb2IgPSBuZXcgQmxvYihbY3NzXSwgeyB0eXBlOiBcInRleHQvY3NzXCIgfSk7XG5cblx0dmFyIG9sZFNyYyA9IGxpbmsuaHJlZjtcblxuXHRsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuXG5cdGlmKG9sZFNyYykgVVJMLnJldm9rZU9iamVjdFVSTChvbGRTcmMpO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3N0eWxlLWxvYWRlci9saWIvYWRkU3R5bGVzLmpzXG4vLyBtb2R1bGUgaWQgPSAxNDdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiXG4vKipcbiAqIFdoZW4gc291cmNlIG1hcHMgYXJlIGVuYWJsZWQsIGBzdHlsZS1sb2FkZXJgIHVzZXMgYSBsaW5rIGVsZW1lbnQgd2l0aCBhIGRhdGEtdXJpIHRvXG4gKiBlbWJlZCB0aGUgY3NzIG9uIHRoZSBwYWdlLiBUaGlzIGJyZWFrcyBhbGwgcmVsYXRpdmUgdXJscyBiZWNhdXNlIG5vdyB0aGV5IGFyZSByZWxhdGl2ZSB0byBhXG4gKiBidW5kbGUgaW5zdGVhZCBvZiB0aGUgY3VycmVudCBwYWdlLlxuICpcbiAqIE9uZSBzb2x1dGlvbiBpcyB0byBvbmx5IHVzZSBmdWxsIHVybHMsIGJ1dCB0aGF0IG1heSBiZSBpbXBvc3NpYmxlLlxuICpcbiAqIEluc3RlYWQsIHRoaXMgZnVuY3Rpb24gXCJmaXhlc1wiIHRoZSByZWxhdGl2ZSB1cmxzIHRvIGJlIGFic29sdXRlIGFjY29yZGluZyB0byB0aGUgY3VycmVudCBwYWdlIGxvY2F0aW9uLlxuICpcbiAqIEEgcnVkaW1lbnRhcnkgdGVzdCBzdWl0ZSBpcyBsb2NhdGVkIGF0IGB0ZXN0L2ZpeFVybHMuanNgIGFuZCBjYW4gYmUgcnVuIHZpYSB0aGUgYG5wbSB0ZXN0YCBjb21tYW5kLlxuICpcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChjc3MpIHtcbiAgLy8gZ2V0IGN1cnJlbnQgbG9jYXRpb25cbiAgdmFyIGxvY2F0aW9uID0gdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cubG9jYXRpb247XG5cbiAgaWYgKCFsb2NhdGlvbikge1xuICAgIHRocm93IG5ldyBFcnJvcihcImZpeFVybHMgcmVxdWlyZXMgd2luZG93LmxvY2F0aW9uXCIpO1xuICB9XG5cblx0Ly8gYmxhbmsgb3IgbnVsbD9cblx0aWYgKCFjc3MgfHwgdHlwZW9mIGNzcyAhPT0gXCJzdHJpbmdcIikge1xuXHQgIHJldHVybiBjc3M7XG4gIH1cblxuICB2YXIgYmFzZVVybCA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdDtcbiAgdmFyIGN1cnJlbnREaXIgPSBiYXNlVXJsICsgbG9jYXRpb24ucGF0aG5hbWUucmVwbGFjZSgvXFwvW15cXC9dKiQvLCBcIi9cIik7XG5cblx0Ly8gY29udmVydCBlYWNoIHVybCguLi4pXG5cdC8qXG5cdFRoaXMgcmVndWxhciBleHByZXNzaW9uIGlzIGp1c3QgYSB3YXkgdG8gcmVjdXJzaXZlbHkgbWF0Y2ggYnJhY2tldHMgd2l0aGluXG5cdGEgc3RyaW5nLlxuXG5cdCAvdXJsXFxzKlxcKCAgPSBNYXRjaCBvbiB0aGUgd29yZCBcInVybFwiIHdpdGggYW55IHdoaXRlc3BhY2UgYWZ0ZXIgaXQgYW5kIHRoZW4gYSBwYXJlbnNcblx0ICAgKCAgPSBTdGFydCBhIGNhcHR1cmluZyBncm91cFxuXHQgICAgICg/OiAgPSBTdGFydCBhIG5vbi1jYXB0dXJpbmcgZ3JvdXBcblx0ICAgICAgICAgW14pKF0gID0gTWF0Y2ggYW55dGhpbmcgdGhhdCBpc24ndCBhIHBhcmVudGhlc2VzXG5cdCAgICAgICAgIHwgID0gT1Jcblx0ICAgICAgICAgXFwoICA9IE1hdGNoIGEgc3RhcnQgcGFyZW50aGVzZXNcblx0ICAgICAgICAgICAgICg/OiAgPSBTdGFydCBhbm90aGVyIG5vbi1jYXB0dXJpbmcgZ3JvdXBzXG5cdCAgICAgICAgICAgICAgICAgW14pKF0rICA9IE1hdGNoIGFueXRoaW5nIHRoYXQgaXNuJ3QgYSBwYXJlbnRoZXNlc1xuXHQgICAgICAgICAgICAgICAgIHwgID0gT1Jcblx0ICAgICAgICAgICAgICAgICBcXCggID0gTWF0Y2ggYSBzdGFydCBwYXJlbnRoZXNlc1xuXHQgICAgICAgICAgICAgICAgICAgICBbXikoXSogID0gTWF0Y2ggYW55dGhpbmcgdGhhdCBpc24ndCBhIHBhcmVudGhlc2VzXG5cdCAgICAgICAgICAgICAgICAgXFwpICA9IE1hdGNoIGEgZW5kIHBhcmVudGhlc2VzXG5cdCAgICAgICAgICAgICApICA9IEVuZCBHcm91cFxuICAgICAgICAgICAgICAqXFwpID0gTWF0Y2ggYW55dGhpbmcgYW5kIHRoZW4gYSBjbG9zZSBwYXJlbnNcbiAgICAgICAgICApICA9IENsb3NlIG5vbi1jYXB0dXJpbmcgZ3JvdXBcbiAgICAgICAgICAqICA9IE1hdGNoIGFueXRoaW5nXG4gICAgICAgKSAgPSBDbG9zZSBjYXB0dXJpbmcgZ3JvdXBcblx0IFxcKSAgPSBNYXRjaCBhIGNsb3NlIHBhcmVuc1xuXG5cdCAvZ2kgID0gR2V0IGFsbCBtYXRjaGVzLCBub3QgdGhlIGZpcnN0LiAgQmUgY2FzZSBpbnNlbnNpdGl2ZS5cblx0ICovXG5cdHZhciBmaXhlZENzcyA9IGNzcy5yZXBsYWNlKC91cmxcXHMqXFwoKCg/OlteKShdfFxcKCg/OlteKShdK3xcXChbXikoXSpcXCkpKlxcKSkqKVxcKS9naSwgZnVuY3Rpb24oZnVsbE1hdGNoLCBvcmlnVXJsKSB7XG5cdFx0Ly8gc3RyaXAgcXVvdGVzIChpZiB0aGV5IGV4aXN0KVxuXHRcdHZhciB1bnF1b3RlZE9yaWdVcmwgPSBvcmlnVXJsXG5cdFx0XHQudHJpbSgpXG5cdFx0XHQucmVwbGFjZSgvXlwiKC4qKVwiJC8sIGZ1bmN0aW9uKG8sICQxKXsgcmV0dXJuICQxOyB9KVxuXHRcdFx0LnJlcGxhY2UoL14nKC4qKSckLywgZnVuY3Rpb24obywgJDEpeyByZXR1cm4gJDE7IH0pO1xuXG5cdFx0Ly8gYWxyZWFkeSBhIGZ1bGwgdXJsPyBubyBjaGFuZ2Vcblx0XHRpZiAoL14oI3xkYXRhOnxodHRwOlxcL1xcL3xodHRwczpcXC9cXC98ZmlsZTpcXC9cXC9cXC98XFxzKiQpL2kudGVzdCh1bnF1b3RlZE9yaWdVcmwpKSB7XG5cdFx0ICByZXR1cm4gZnVsbE1hdGNoO1xuXHRcdH1cblxuXHRcdC8vIGNvbnZlcnQgdGhlIHVybCB0byBhIGZ1bGwgdXJsXG5cdFx0dmFyIG5ld1VybDtcblxuXHRcdGlmICh1bnF1b3RlZE9yaWdVcmwuaW5kZXhPZihcIi8vXCIpID09PSAwKSB7XG5cdFx0ICBcdC8vVE9ETzogc2hvdWxkIHdlIGFkZCBwcm90b2NvbD9cblx0XHRcdG5ld1VybCA9IHVucXVvdGVkT3JpZ1VybDtcblx0XHR9IGVsc2UgaWYgKHVucXVvdGVkT3JpZ1VybC5pbmRleE9mKFwiL1wiKSA9PT0gMCkge1xuXHRcdFx0Ly8gcGF0aCBzaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJhc2UgdXJsXG5cdFx0XHRuZXdVcmwgPSBiYXNlVXJsICsgdW5xdW90ZWRPcmlnVXJsOyAvLyBhbHJlYWR5IHN0YXJ0cyB3aXRoICcvJ1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBwYXRoIHNob3VsZCBiZSByZWxhdGl2ZSB0byBjdXJyZW50IGRpcmVjdG9yeVxuXHRcdFx0bmV3VXJsID0gY3VycmVudERpciArIHVucXVvdGVkT3JpZ1VybC5yZXBsYWNlKC9eXFwuXFwvLywgXCJcIik7IC8vIFN0cmlwIGxlYWRpbmcgJy4vJ1xuXHRcdH1cblxuXHRcdC8vIHNlbmQgYmFjayB0aGUgZml4ZWQgdXJsKC4uLilcblx0XHRyZXR1cm4gXCJ1cmwoXCIgKyBKU09OLnN0cmluZ2lmeShuZXdVcmwpICsgXCIpXCI7XG5cdH0pO1xuXG5cdC8vIHNlbmQgYmFjayB0aGUgZml4ZWQgY3NzXG5cdHJldHVybiBmaXhlZENzcztcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vc3R5bGUtbG9hZGVyL2xpYi91cmxzLmpzXG4vLyBtb2R1bGUgaWQgPSAxNDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIHNjb3BlID0gKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgJiYgZ2xvYmFsKSB8fFxuICAgICAgICAgICAgKHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYpIHx8XG4gICAgICAgICAgICB3aW5kb3c7XG52YXIgYXBwbHkgPSBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHk7XG5cbi8vIERPTSBBUElzLCBmb3IgY29tcGxldGVuZXNzXG5cbmV4cG9ydHMuc2V0VGltZW91dCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFRpbWVvdXQoYXBwbHkuY2FsbChzZXRUaW1lb3V0LCBzY29wZSwgYXJndW1lbnRzKSwgY2xlYXJUaW1lb3V0KTtcbn07XG5leHBvcnRzLnNldEludGVydmFsID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgVGltZW91dChhcHBseS5jYWxsKHNldEludGVydmFsLCBzY29wZSwgYXJndW1lbnRzKSwgY2xlYXJJbnRlcnZhbCk7XG59O1xuZXhwb3J0cy5jbGVhclRpbWVvdXQgPVxuZXhwb3J0cy5jbGVhckludGVydmFsID0gZnVuY3Rpb24odGltZW91dCkge1xuICBpZiAodGltZW91dCkge1xuICAgIHRpbWVvdXQuY2xvc2UoKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gVGltZW91dChpZCwgY2xlYXJGbikge1xuICB0aGlzLl9pZCA9IGlkO1xuICB0aGlzLl9jbGVhckZuID0gY2xlYXJGbjtcbn1cblRpbWVvdXQucHJvdG90eXBlLnVucmVmID0gVGltZW91dC5wcm90b3R5cGUucmVmID0gZnVuY3Rpb24oKSB7fTtcblRpbWVvdXQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuX2NsZWFyRm4uY2FsbChzY29wZSwgdGhpcy5faWQpO1xufTtcblxuLy8gRG9lcyBub3Qgc3RhcnQgdGhlIHRpbWUsIGp1c3Qgc2V0cyB1cCB0aGUgbWVtYmVycyBuZWVkZWQuXG5leHBvcnRzLmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0sIG1zZWNzKSB7XG4gIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTtcbiAgaXRlbS5faWRsZVRpbWVvdXQgPSBtc2Vjcztcbn07XG5cbmV4cG9ydHMudW5lbnJvbGwgPSBmdW5jdGlvbihpdGVtKSB7XG4gIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTtcbiAgaXRlbS5faWRsZVRpbWVvdXQgPSAtMTtcbn07XG5cbmV4cG9ydHMuX3VucmVmQWN0aXZlID0gZXhwb3J0cy5hY3RpdmUgPSBmdW5jdGlvbihpdGVtKSB7XG4gIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTtcblxuICB2YXIgbXNlY3MgPSBpdGVtLl9pZGxlVGltZW91dDtcbiAgaWYgKG1zZWNzID49IDApIHtcbiAgICBpdGVtLl9pZGxlVGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiBvblRpbWVvdXQoKSB7XG4gICAgICBpZiAoaXRlbS5fb25UaW1lb3V0KVxuICAgICAgICBpdGVtLl9vblRpbWVvdXQoKTtcbiAgICB9LCBtc2Vjcyk7XG4gIH1cbn07XG5cbi8vIHNldGltbWVkaWF0ZSBhdHRhY2hlcyBpdHNlbGYgdG8gdGhlIGdsb2JhbCBvYmplY3RcbnJlcXVpcmUoXCJzZXRpbW1lZGlhdGVcIik7XG4vLyBPbiBzb21lIGV4b3RpYyBlbnZpcm9ubWVudHMsIGl0J3Mgbm90IGNsZWFyIHdoaWNoIG9iamVjdCBgc2V0aW1tZWRpYXRlYCB3YXNcbi8vIGFibGUgdG8gaW5zdGFsbCBvbnRvLiAgU2VhcmNoIGVhY2ggcG9zc2liaWxpdHkgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhlXG4vLyBgc2V0aW1tZWRpYXRlYCBsaWJyYXJ5LlxuZXhwb3J0cy5zZXRJbW1lZGlhdGUgPSAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgJiYgc2VsZi5zZXRJbW1lZGlhdGUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiICYmIGdsb2JhbC5zZXRJbW1lZGlhdGUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICh0aGlzICYmIHRoaXMuc2V0SW1tZWRpYXRlKTtcbmV4cG9ydHMuY2xlYXJJbW1lZGlhdGUgPSAodHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgJiYgc2VsZi5jbGVhckltbWVkaWF0ZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAodHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBnbG9iYWwuY2xlYXJJbW1lZGlhdGUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMgJiYgdGhpcy5jbGVhckltbWVkaWF0ZSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vdGltZXJzLWJyb3dzZXJpZnkvbWFpbi5qc1xuLy8gbW9kdWxlIGlkID0gMTQ5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQVUwQUFBR0RDQU1BQUFDWXpMSXlBQUFDV0ZCTVZFVUFBQUFBa1A4QWtQOEFrUDhBa1A4QWtQOEFrUDhBa1A4QWtQOEFrUDhBa1A4QmtQOEFrUDhBa1A4QWtQOEFrUDhCa2Y4QWtQOEFrUDhEa2Y4QmtQOEJrUDhCa2Y4VmoveTQ0UDhSbC8vL2RyYi9kclp4LytuL2RyWngvK24vZHJiL2RyWngvK24vZHJmL2RyWncvK3B1L3VweC8rbi9kcmR4LytsV3R2Ly9kcmIvZHJiTDZmOXcvK3IrZHJkeC8rbi9kclp3LytwdS91dHgvK2xsOWV4TXN2OXgvK2x4Lytsdy8rci9kcmIvZHJiL2RyYjhkcmYrZHJkeC8rbmg4djlxK3V6UjdQOXcvK3BodS8vZThmOHdwZjlzKytxSnpQOEVrLzl3L3VyWjd2OXYvdXJsOVA5eC8rbjlkcmYvZHJiOWRyZERydjl4LytsMncvOXV3Zjl1L2VwcysrcHgvK210M1AvL2RyWTdxdi8vZHJaN3h2LzJkN21sMlA5eC8ra25vdjl4LyttKzQvL1c3ZiswMy85STEvSDhkcmYvZHJZcnUvaVowLytBeVAvQjVQLy9kclp4LytrWHAvdHB2di90OS84Nnl2WC9kcmFVMFA4Z252LytkcmJwOXYvL2RyWitnOXh4LyttU2dkWksyZkhGNXY5eC8rbldlOFB5K2Y4WHAvdVF6Ly8vZHJZYm5QLzMvUCtmMWY5eC8ra1ZwZnN4d1BaTzN2RC9kcmJmZWNBcmpQTXdpL0lrdFBuY2VzQngvK2xWNWU5V2grZHgvK2toamZZOWl1NStnOXVjZ05NYWp2aHgvK21EeWY4S212NitmY21PZ3RlNGZjci9kcmE1ZmNwR2lleE9pT2twalBTd2ZzMUoyUEVWcGZ1SWd0a3B1ZmNvdVBqL2RyYi9kcmJ0ZUx6U2U4TVBvUHlvZjg5S2llc1BvUHpyZUx4Z2h1UTh5L1J4LytuL2RyWngvK2trdFBuR2ZNYzl6Zk5MaWVybGViNjRmY3RkN08zb2VMMXgvK24vZHJaYjZ2ai8vLy8vZHJaeC8rbHYvZXhyK3ZFa0tacTlBQUFBdzNSU1RsTUFlVUtFV0c5bm1sQ01LaG8yWUpNVkNrb2xEeUV3T2diZm9YcUVaNVIzWm02RU4weFBJNHhVazdpTlJPWkVIMXFjTGphY0NiUmdiVDhxWUZvVlAzenhGZXBLdk8rckQ4eWdWdTBwODNFUGRUQ3hPc1BDSFJuZzJ1Q3VKY1VLMSsycG9lSHQzUThab3g3UngrTHZtRUMrOXhheno2Y0c5Y1ZEOGc4aTVMa20rU3ZONnFYODA2bElOeStzUUdSWEx6ZkFTRFcwWEV3aEZXZjR5Rkl2TEJybUlWUkRRallwWWpZbFVkalBiRjVZVGhoc1UweEp4N3JPVzFSQktVbENQR1RaK3V4RXpPeTZBQUJEZkVsRVFWUjQydXljejA1aVNSVEdaMnphSzlvaXlQOUh1QWxiMW9RQW9VUFlFRmtRUW93Qk44cENFdzByRTJOc1g2SmZoeGViK251L1cvZFVVVnl3cDNzbWZHYVNuaG03KzlTdnZuT3E2bFRoWHdjZGROQkJCeDEwMEVFSEhYVFEvMWRWS2ZZTDhYWFFyaHp6eFF1aUlsTmVpalAranhHdUNuUGtEVVVEcXY2eWtlUTV5Yk96VXVsU3F5UjFGZ21BZFN4L0lOaXFBS2l4NllqUHJKSkQrZlFRRk1uTDA5Tnl1ZnhOcXF4MEdpbGlETGdnKzF2UWdtQUUwTVJYVXU0NE5ZUUI4YkY4THRGcVVaUDhWcWtjV1ZUaGlqT08yQ2JKL210bzRVQUFCRC9nNCtiUXFpUWtoc01IQXFLZmdQS0NvV1FrQmNqQ1NVS0ZrNEpVZ20vRTlqU0cxcXdJbjEyY1lFQUhRTTBQOEl5Z0MxcHNVQmdSR3dtSTdzc1NLRG5JVE9hYzZaanBITXBFaWdFMm5BdXlGdGNDcmFhN0hWK3NIclFBdWdFYTlMUTNNZzZKMFlEb25qenpqR1dFTXNNeGZoWDYrKyt2aG82RkFObGd5d1N5RVZvbWdoWjBGV0dJQVZPNjRGOEdPMUlBQ1VBblB4a3VqL3ZZS2pFV0VBWFAzWXpKV0xJL1NhSmtGSm0rR1BvYitzcS9UTHdnQzdSR1BUQUtBdWhpTWFNcVNWMUtSYit0REg0T2dPQUhkQ3BjRVR1RUVZbWhSRVRCYzBkak1wWUZGZ2RIeVVGbXM5bGNYRm1JTUpac0NWbWdCVnZEdHNaaVJsVld3dUlCZkZzQU5QQ1ozc2dtcEljU0VkMkRaMTRZazdFRXlsd1FCTDNtdzlXczM1OWRqUjg2WVhNMDdVMERDSVFCMTdDdFVSQUlXczZXcWdJZFdTVVdEdkJ6QXhReTZlV0VBb2Y0YU1RUVJPZ3hudm5VTUlVeE9Vdmx5aUJvOXBldE5kR1AxOGRodDkyWVQ2N3YrdmRYblhBMDFZQUpXaVNRamExV2NzTndvci9FTHlPQkhmaDVBRkorWWRnWnovcHZkOWVUMi9sTG85MGVkRnV0MW5BNDdDNGFML1ByL2pqOEhrUkV3Yk4wVmt3RnM4aGdDbU1LbGl5R1lQcldYbStyNFlEQi9YaWJQWVNqVWN5MklHdGhheFIvTFk0cGpreXZHMkFIZkc2QWhOOTkvMjV5dTJ3UGhvLytvZHorN0VpaTRNbnRXYXltZ01sTHBqSW16L0JldjdIZVVZK3RkcVBHYkh2VmFZNlFRVndHVzdxVVFRbGlJQ2UrZ00vbHdHWXpITisvZlV6bWpVV0w4dk5yK1BIUStSN25XVUcyYndYejhyUnlwSXpKV0FMbGZucGxwbDNlQ3JSaHMwblFnaTBJUXhRYjRBRmZET0NNT2JEMjB1NnVQaVAwNFJnOEdVNlM3WDZZeXBoZytibGFkZHN2dGNsSGZ6WUdXdUFWaERsa1V6bWdNMWFQVVpObk1DdUF0MHM0OEZNMWZOQThvMnpmRW1aWncyVDE4dGZBcEFXQjEvMWJ0cFM5c2JWc3pMd0x3b1pHVEUyT2J2YXpMeFlQUnErTEF2Z3JOWlQ1L2xWbSszWTQ4d1pNc1B3Tit2SGp4K3ZyNCtOcU9HUUw3V3IxK01yK3cvcDNhaGgrejNHYzV3cG5mcHV0MFI4QzgwL1VrT05rUEFYTzBrVjFpMzJtaHZtOXZUNG9pZk05a05sK3dtb25jdDBITXhzOGQ5Y0hFYTFZdGl1YzVjMmxzM3B4QnBpOTFmb2dtMW9DNTNuR1Z6cUxaMGp6NmV2Nm9BMDRVVHFkMWl5Vmp3cXFacmJXTnJVbi9hdUhzUE53eFRZb1QzeUhVbHMyeEJIdC95RFdjbGkxdU5hclZ3L09MRXJuWm11ZXUxZnpXZytiYTdQMVVxOC9UNXY4Qk13UGNOMy9SbzFnaDk0WGRqSVR4NGRwNzcxZU53YzA3VXhhcnQ4YUJxSjBGbGpwZEprenI2enBnRm1iMWdPMmV5WENPWVZMeDlKcmRtWjlkakpaRE5kL2tJYUx4dTMxMDg5eE9PcEplT2dqVXVYWU9KcFBiZXRFUE12U0NYUFNQTmZXekZwZ3RrT0dNaXU2cDByT0l6VFlScllOeC8yNzMyVGE0WUIzWFJqQTZiTUdDSHd3aDdVbElJaSsxMnk1SGpDY01LY3J6NFUxZTlTWVFVNmlqUHBsN0JmaVMrZ3JSV3dZTjI3YVVYakYreEdOd1dlN0Zoa3NISGpQQU41b2dPQkg2ZEYrMVZjNUlFazBGOVJyTnB6WmplWlVlUTVybWpDL1NKUVowcXhGdDViMHUwR1dvSVZyNzUrdWIxOFdyZGZkNlExNS80UVh3QWZKendzd2pvN2JRaW5aU0QwV3R3NE9uaDJyT1pIb2wzb0pDdGVtdXIxQUhVOHpKd1Y2azhDVlFBeTJJT3RHcTltKzMweWJvaG4rOURGaHU0WDVmUG5TWUEzeHhhRGI3UTRXN1hhanNaelhiaWVUNit1UEo3WjJkRmoxWS9BMFBTUXdBRHI0R2ZCT0lOeW9GK1JZMkJnVVQ0S3phemNuRXIxeVpGMkNHdSt5ZFNKUmlpdXdiNUMrc3FuWXI3a29XVGRhOUNtOVFsc1UrTndHcEhmVDlISmFma25Kd2FpTGI5WGxmVTRtN0JqbXRDWTZyNW8wenhlQlB1Z0xsT0o2OWhJM3NOWTdXTUFGV1FQdE9XRUx1cDU3UkFqc3dNOExNSWFQYWNNVmFabU5oQU1WUEdGUGFrNGNpTWhlODBzMnVRUk5veWJVdHpKL1FuSUJtZGZjQXJLTVFzMHNNZ2ltcFdoaFcrRDFDZWhvL2FQM3pMamFoQ0VaU0FFdytkd1BBeEpqRVR5VlBlY21tQ3Rwem9vbDFiSFg3Q2NYb0t6S2N0Nit2eWpLKzZVcUYxNDhjckUzTnBwa1FRR0xsM2Y5Q3NYejhNTGNMVkNwLzJsN3VoT3ZmakNnaUFaRkovRWtCZ1lwU21FODhsa2c1Nm5zbWF2YnpNbWFINldMUEZtRHNOY2txN2xxM3BjdUpFb3F3WktobENSRjJJYmR6RmNvUmoyQWNTQmpjY1dYK0hmcjJnRjh5R0F6R2k0WTJRaW16SGdXaS9iSHY1S250R2MybWV0aDdvdGFoeEtWTTg4VFhWaHphdjZPdXRqMDh5ekhQWjJkcFF3K285OHJKUk1UcjFBSzNCUmx2QmNDV2dFWEtqREtrR0lHZ1I1OTNrU2pjUWR6Qko3V29URXlhaCtld1BrVVNLTjl3eVlKSzNwQnJFRXZOTS9GeXNYK1Bqdk12R1NwMzlqSTkwckpKVVN0R0dJUWFnaW5xTFZLeHB1WUN2OGk0djlWeTN5Tml3SklvaEhoMklNUlFBVlAxL2lZUHkvTGV1OVlwNmwrTE15WkoyVlRKUHFOZVo0TWNoby9TaTM1MjFUMEluaDlJc3VwN1hsUHR4UDRia1lPUWc1QmpzQjRacW5wQXJCTHRyZmlGMElrR3JZYzYzQUN2VG5OSVJnMXV6TDNpZzYzNEZ4am1yUEpjZXAxaU5KTTd0eERtZWZ1dzMxZVpJTGVTT2pZZy9ybzZtUGVqYTdFWGhlMXAzR3ZMb25xSVVTT3FFYVZINXNGbitLdkV2SG8zeFZOcjlPZnRGdWl6ZmE2YXJHdVlnZkJzR2dVejFPblBjOHV4Wm1ibVBOSEwxcUh5Q0xFdnoxNE1xdG1sT2YybXBtWFZ0RFJmNUVrKzh1MVZiVVpINFFhQWh5UnR6eHo5YW5LUkVkdGk2WjNYOXNRREFPcWVTSVlWNnVTbW5QRzF5RmRPT2tpRk13VFZYTmpuaGZOdDE4OCtDYUpuYlJJeFJEZ0NFelVqa0thcEkybTFtUkFOVSs5YmRuY3EyeWFXMDdRdEM1Q2czVk1QVkUxa2Vja2ZMejlRblBBcDhhTURRR093QWoyRWRJRTBUeHZFMDN0V2ZOa3dTRGJhYTRyYzlaZE5MMkxVSnRaVTMxejNoaytUbDUrbHZBOEhPRWF3WTVQSk5OSFV4UCtsTUU0czczSXpVblAzZU9OTk0xajVTUlE1L3BTMFJtK3NnS0ozdVBQRUk3QUNQYUdXVWdiRFhpcVlGeWxweGlWd3BxZHByR2tYNm9sdmJPT3FjOFRIVlhUSGo1YUFxazBIMGxIWUFUN3c2UU5pbFRKZ214SE1IUmh1ZDdvVFp3cmp4bk5XYUloS3RaL2tMZUhud3VhTCt2VXF0MEVPVEtDUFdBaVRVTGM1YVJKRnBYdENNYWtXYkZrK2dNSUVacG9lZUFjaXQyVU0zeFlJUzFQTW9JOVlhWTNKcjFlSU1GNGFDTFQ2WGJ6YmgzVENEUzk0ZTgvZ3JQaTNqQkZ4Vnp1R014U3ZDY0VUZ2ZOdHJ0dTRwV2hyU3BncDA5ck1zSi9OMlpyeDNxRjZyd256TnJ1d1hTblFZN2lURThUTlhheWp1bFoweXlTM2RkKzRVTXZmRG5GZWV1M3dVU3VJRlgycG1sR1U1YzBUMEhUT0JsNHcxOHM1eFArL0xmUjlZN2dmTGZTaVR6eFJ6TWN0QnZMUnJzNzlPTWtxZUtuV1RXLzkwaDg3OUpERTJZNDN4aCsrN28vR3NXZnBjOFdHMGVBOVBJcmZaNTBXWjhERDcvRGgvNmt1eEVuVFpWOHRMSjhPTTVDdmhYclZmYWJqbUI2STdQYzRiZjdVOTMxNHBJdE1VWjA0UnBCTnMxS2xEWlB1bThNcFA1RVRYVHBIRDYxVXFTS2RkZmpweGtmOENySTRoYkprbGxaZS9qdG43eXZZZDRvQ3FRTTZOanFpUnVTWGltczZjbVRic2hRbXRHSUNlWkFXMDZjbU51OWFMYmlnVVEwOC9iTW10cFlka1R3OHJyZ0dGZTlmQkRjb1F2Yjc5bHhKVUkwZ0VsWUd0Rnd4WjdFZEZyMlZNSGNVcG8vdlRUUlFsb1pnN1RRakQveEhORG9yMlQwK3RwRjYxeC85Slg1YytGTUwvZ2hWWjQ3ODZRN0Zoc3dGWTBPeDNnU2MyVlprNmFXdWNWcDhaNzJOeWxORmhTUDZYVU5OVUNUdEthTTYyWHdWOUhyejNRWDhHUkNmaXhiakdBMHNPT0VIM2JJOHpxbE1qQ2lrVGZyN0IvalNZenQxVy8zTzUxYlAwMWZRMjRlNk81bVBtRk5aQmJOMlBoN3BZcTZNRlAzaDFIbkVUZ3R0M25GbmZLY25JQldUUktOMUpHK3pkU24ra2R5S2lKelN6c1pvSG04SGMxYjBDVFdSR2FSbzhTNXZ1UEZkYUwrY1JiUkNBYjI5RHBQWjg3aWhqd2YxQVBWdE13a295bkxhREtxNHhROHR6eHppL2NHU1pyM29PbHJiMTZESnUzb3YxdU1pYmRmRmY2RUFpOVI5STlhS1dTaXB0UFE1dXN0elVtclRraGdLbU55bHVMRnoyVXBGZ3lQUnZDVWswdXpQVXpPTFdoZTBaNGxwU20vZGJTTzZVN1FST2VkM0RZUkdnS21qRjcrb0NzbDlXT0E5QWhFdlJwUVA2UTBaeEZWcDAxaENtT3FhRW95R2dSenhuaWlVMDl4TnNqY1JqVEhXOU0wNS9ndHdMY202MVNQd01RSEVFWDB4VHo1dVVvbE5RS1Y3Y210WnowYXdJV1BJNjA2RktZMHBqMGFScFR6Rk1taWNIcm1GdjMwQnk5TnRONGRSY0ZYcDlwby9GWkU5RlhYendPcVJJYTRlZDNQbktnNmRRdE1mUExaR2sxVjhGU1RDNXp1dVFVaVlyaU1TYk1LR3p1M3B1YnI0NmJ0MDEzazdaZDFCTm9RMmFEcEhFQnhMMnNDWnFXOEtSb3h1Y0Rwbmx0Myt0NFJtblF6UlM4eVVEVmxuWHFoQ3pMQ0J3c0xUeGdDdDgxa0FJak5yYUxMbXNPNmlNYi9FeVB5ZkhJNVRxU0thMjc5TlBPcExqSVF2eTNQc3pyOEVzSjN2RnJTaHJCc2xKN0o5VDBWWW5aWnN4a0FKb3hwbjF6Z3pBYWhlMjVCTTVHV0g1cm1XZDU3a1pFRlRTUCt1cVZvS3BnNmZKOGhNdkk0MVNVRDJIWWRRcUk4Si9NOEM1aStXWW5qVE9iNk8rYldTZk1hTkZOZVpDRCswTDd4cm5qNms4ajI2S2cvVG1UWHRxbnVUcFF1cGhZd3ZUaGx4Vmc1NWpaT016dHliTW5UWFdUUStKSG5wRW5ndFpXOWRNNmtIU3JlVkhjbnloaWZkZ1pNRDA2VktzSE1QYmM0NEJpTnN3bG9wcnJJY01jL0pmMUFMNG1TOEFPMWVjT3dnMU1JbVd3dkJ0SFVBcVlYWjltZTY2TWNVSUZtYjN1YWN6ZE54RDhtMXRSNVh0MjJrU2I5UU0xNWs4V216T2Z2aWkxUndoUlRTejhSK1dDbU9ycmxMcHEzZHBvVkFjcnN4Q2hNS2k0YVB6WjNhUnU5cW5SU2EvMkVIZnhsRTRsaVd2TThRNmJXbnlxWmMyck9lcXpVRlgyTkljOGwydy9RM0JEL2ZjbytML3hnTStlY3RGUjlaYk5IckNuekhGTzcxYzhzVXVic21KbUN3cG1PSmo1Q1lOTE1LSm80TDRreURQV3dCUG5NUUg5S0Erb0dyUzVibHMyWnhacVkyclJ6KzMxb0hnYkJ5a3N6elpVbDRqZDMrQXVKSFBHbkhBQlNuZTV4cVN3UjE4aXhPZDNVd3VuWWNOUEN1VC9OUjN6Z3dQaWVPZGx3b1U2bE0rY0pVdDNSbEhHWHpWTmIyV25tdnFTM0pyYlNPRGVTVE5tSlp0dE8weDEvVHkzQ2pqcmxYNVRSZnFXM0oyNWhoYVUwVDFKWWs3UjlRbHZoTE85RmsxNm4wMFVJMnlOSFp2cDNTVWgxZXV2c3BXbnJqdzJNU3A5dWJwbFhzS3JUVHNWT05CZHJhQWlhem5QcUpNRGhKYVZJcXZ1WElYZWJCdnNyOTFUNDZ6QSs0VU03dkx2UUhOaHArdTlGVXNlUFZBK1dqdVlBa2U4bzNCRmxNMjNad1IrSTRkRmorRVY2bWtaUHB4VlB1anphVE80V3FGLytsK1FkSkJlUlo5bEUyVXdmamIxd05vQWdCVTNmd3htbkc2YXB5MmI2bHoyUVovcUhxY3VtNzJaczhIazBCM2FhTlVkZXBoV3RIYWg5b09rN3BmL0QzcG5zcGhFRVlUaTc3U3cyTVVtQVJ4aHBycHdSWWhBUjhnVU5CNFNRWllFdmhnT1dRRDVaaWl5U2w4anI1TVhTSzM4M1JkTXp3d3gybGtvVUo1SGlGRjlYOVZKZFhYWGhHdjRjbGlHNFo5NmU3ajh1WlhldVB0bUFKNlBKVjdCYlQ5NlVSenhMeHgwMmlWNmFhUklPL1Z2UzdNN1ZjdHkwcE4yOGg3blFiRzYzbHJNOFQ1YitaVCtucVFyTGFHcWFNL2xQOTZRWmJnK2plZUtiM29nY3RuNy9yRzBhQnBYOFhnaEx6TFdEWnFIejV2eEp6WnVSWTk3MDNBQ251QmY2djZhWE1QYStJQTN1TEg5c1IvVm43RGZ2aXR4dmVqTU9mWFVvOEREd1h6MEwzWU9tZCt6VDVIcjQ4eGYvOW5NNnJNbnpCaGlvSEErcS81QVlVaWR6REtuc2l5SFJCQTczSzJsdmpwd3p2aWtYdmNlTGJ3WTV4RGNCd0IzZkpONUE1cFkwK1p2dTJQdnp2eUQyTGxsaGRPaXVCalRIUHByKzNHTG52VkQvOUMrNUYxSkQyM0xjQzVGMWoxeVNRNUN5NURnMk9lOHN3N3p2TEUvM3ViTmNwTHV6eEhlRG96dnVMTk9jQlhHa2Q1elVDcnhQbnovNmZicE85b0J2MHZ0MDBJdzhjUXB5dHFBbmdVUGxlc3dlSTllREppTFJYQTlNTGY0MWs5Z3hNWlFENVNGMUhpVVBDVWx5cmp5a1ZIRVdlZ3FuQ1p4d3JyaTRITG4ydmpseXJXdzVjaXJYdWUvS2tYTnNJcXAwQjBJckE5RDEvNkQ1bThlcDhqZDdPZVZ2MG5jWlF6Z0tEUi9TZ0p6elVRYmRjUDR4dWNWeDF0eGkrRG10b2xjaGdPaCt6cjNocEZ1a1B5YnZ2ZkUxVzk0Ny9WZ2RQSEdoemt1THBIaTNTQk5NSE1uZlpEdzc5SnVNVlVGdk1tcDZEbjlYSmdzTE9YazZKdlhJc2FoNTN3dmhpVXZtOTBKWHl0R2Z6SHNoT1llZmtZQ3FKd1RvWUQrRTU5bHYyVUxpNitUMTJLTzlaYnRkbWRxQUoxWEdlc3ZXL2s3ZXNtRm8zZHROZXJDazhXSjZHTmpaNWFWQlhqYjYzMW0rUE5BN1M0d3VuWEk4N3l3eHRIaHlUa0kwMkc0Nm8waDB4K1Y3QTR4bnEwbmZBQzl2RC9FR1dJeHVhWHVWNE0va0RiQ2orQUFOQU5OM2dmNWxDQlBuR2N3QkhRc2NUNm8vUzU2KzkrbmRRN3hQVjIrcU5WQThUeGZ2cWQzdjAxdFc4WVF5YmwzY05WTDhOSHRZMTN5MUUwaTFna1BXVGdnZHRSUFVlLzl6clU1WmwwNVFiLzFkdFJQdTdjSWVXSCtiN2lYZDM5bWhnOHJGcU91QnQ2SUVwN091eDZmTnVoNk5BOVQxMEtQNzViMVdCMlU5dnF4TG1XK3I0bE0zaXM2UXZhR2ZKazVxY3hLK1ZNYnNxem5UWFI2ZDBKb3o1N3JNaTZmbVRDKzNtalBRUm80dTFMRkt6aHpyZ2tKSDdlMDFaeEFZdzJhbTVWblNhWWpMOVdUY1d3L3AxcWhBOUhHakhoSlR2OWg2U09OdDJzalJOUW9pdlRES0llbUswY0Yzb293WkYzTnZ0SDg0bG5SZ1FxaWVQQ3NtdGJwbU8ycDF2ZHFvMVhWY2NLMnViUVhxdW1wMGpXSmRacWt1VlZ1cTRTaHJCOU9ram83clgzY25NV2VuRERpZ1hVY3VvaC9BcXR4bU5XaDhVMlFkT1ZUQnNTVGkyaWlnVEpRcUdpWHFudG5TTnVySTJZZFllNGtPY0VPZTlNbE1ENHREc2hxSGdmNEVUTkRla3F2dnJIRTQyYlBHb2J0OFpUUS9PalhWNFQrTmdvdDlmNDFENHVqK2FaTmVxcm8zTHY3Nm15T2ovdVpyOFVPWHZPek40ZVRFR0RMVzMvU1VWbzFhZFFHVWlWVitrL240M0Y5L2MxZVBqQVdtelYzUjdOQjEza3RjRy9iblVIVm5FcUs3TnhWVEc5WmY5amNLMXNWaFVSbzJpQktWVVlacEVsOXNZZHIwVkNOd0dHZUt1c1UzVTZ0dWNTKytuT1JWdHpoRFNlcm9JYTdyd3NWQkVDK0EwbHUzdUdRR3EvelRKZzF4TlYwbnZsSzZtdHJOOFRYck1qdW96cnE1MXRUT1dpNjlFVFcvcVpMYVBwaWJNeHZDQWQ1cGszYTBkRzVsYzYvM0hxNklNYVRIV1ZTOWQzeFcxMzBlcHMzRTNWWnI1bDZRZm9EbEFYb1JvRytZcjN4K2U1SlptV2FiOUNLQUg1SWJoOENhTnFuR3BCTXdqQlBXYzdnK0dSWFYrKzdNRU5uU0RtVHowd1lqQzVqMitXQk8rNmRqMnR6VnBUb2d4b21acmRBZUxnREpJS0l2NDBhL1JZWVZUSWsyK2ZWd2daL1RHcDhCYlFLY3Fuc3RESWoyRndyQ0RPcTNTWDhoeFpHRFpBalJNM1NqRnlnbkM2YTVkRHVhMWNuSU9tcDJ3elRoNko1b2RzdHpQTWplK3dycWs5NVhGZWJYa3VPNWFyak41QVdSTDV3c21KYkxsYjIwUVpGNmpDeGd1bXAyVCszbTZaNjJqU0gxZFV5ZDJmdXlRWDNTbDAyU0ZCelJNNXkzMlQrRzhEK2hZZmQ3d1ZUMHpTNWwxZ1l6cGpteTNuTks0TThVcmV3d1RreWRzTTc4ZWdZcWtuYnZkYnQ5dlJZMDdFYkxibTZpV2JWQmp6djBERVN6VHNjWnV2RjF2UVpWbnFVM1RreWQ2SmRJKzFtdXFrbnM4aWZwWndtU21xUHUwdjJhQ3Z0YkRWVzM3SlltU3JwcmRwckpsRUdRRzUrT2ZUZ0ZFMzd1V29QOHhobTREdE5meE9nNWU2MEdIcURWSWVtMWlpNzJkdTkxZEFuUm92L0dZR3AxbGJlMVllb01xd21Vd1FVTU9wVktVOWN3dDVzbWt1T1NHeWVpOEJJbi9rOVhIK0Q2UStoUWZpcjdBRU45NWxnQ0pVZ3lqcVJKOTZrU05Pd0dVM1NWRjBBdGJjVHdMdnVPUHNEOUpaVGhUZzR2UjlkMEF5WTFUV3cyZmNaSm82K2hqcHZCSDJpUGFnV1VFUjFkem95QVZ6UytpWWRiZWxUTCt5NzBqVGRCNmliZDdWN1FuNDdpVmxBZnRwZXFlemlZV2wzbDJUZUVObXA0T2RGVndOU1pSSGZmdm4rN2l5YXp5MUY5WlNpamV5ckxUNFdHOEI4Qms1b20xcUJzeGhsaVI0Wm00KzcrNllMRXFqMGNYcTFxdGUzOTA1VlZIcHRkN0RYSFdvOEJhRGFRd1lEdTRkY1ByVGErbzlWVm5uOVQ5S0luL2RPMW5CSmxWRklGUHBDWU1Wd3dZWnFWcE9uOUZPZFh0QnNRNWxuZTJkdi94TlBibjZQRVAzb091NzVxUFZRamI0Ty82bzNxeUM2K000QnlBLzJzQm1uRDJxRUxWZVljTExWNTQyaEYvUnltbWNnNDRldVE1Z3A3WE81VW1tZFo4WVRIWWcweFZnNDRKYitRdFZGcW53eHV3bFRucVRrelVtVm5KaHN4Z1VBYnFLTjBzWlZSWGZFbFMweTlNb3RpL0d1Ym44TTBFeGtuZk4yUXlSTGVUbm5hcXdrVHNxdlJDd1krcTV6ZGROLzRjWmFZM2tOUG1xamx0d0tvdFV0UUNvbXZIeXhsM3NyUEFaWXZjUEUvSktIWmk2L2ttSjN3cGlWMHhBYXdJc3VNSTYwSjJUTmFXMjY5bVZIUVlaVWNaYXU2VDF5eXYxSkFiUU9GTnNmcTdsUitPWVl5OGlQd2hBN0pFazZPRXlyMWN6ejc4QnFuOG5VblRtTzNxSlVwVmJoOW5wSHpqQmFjWERCWkF1V3FFLzdhVis3bnpFS3BnVUtiRitJeW5mK0M0NzQ2bUZZWVNyREVjYXFIM2I5aG1naFpsTkxldEV3Y0J6SHdWQ2M3RVhmRVdWdkVMSmpLOG9jNlZac29zVDN0ei9aR2lhQVVOVkNoRFVJby9Jc01tMmk5TmNxM1lJbWovajUrVGlQcjdaMm5iSmpBdVk0N2xoRUhZb0l3bXZZNm9NVFJLVGU1NzI4MTBIT2hEb1JIbjdRRmxOWW93ZEp5Y2dyek5YMm02L2QxckVTMDg3bkpFMTRqSTdvSTh2SW9yMENxU1dxVWpuTmZJUVlxZ2RvcGUyelVoWWhBcWtKcHMrek5YRERUK0RrTlJZV091QXN5anJDOEtEdUVWZXFVTHF6MG1DeC9PbUlTZWMrZ0dPNjN3aWJYVkQrSmlEUlFndVVTdzB4aHdzL1Q0TVJLdEp2bkcrdzJwQ0RHcXppdVNXSUpqekgyQlVoMUNRT0ZjbksraENDUWl2a0hzVHczVEx5TXluTG4zNzdieVJNcFhBd2JZeWZYVHY0N3hOWTBTZXlHQ3BacW9MVlR5bUZqb1FVYkQ0VlNzcnlDY202WThQTzBLOUhKMGRXRlo0NlNSRlZJRjBGZXhOYldKRk91TzQxdU9MNitYSFRpZU5SNXVMa2NETVozVVdLZ25DZUdXeURsVExWb3A3SG1uNTVMdSs4dEV5YjhQTlZLSkZPWlY2NlBFSTVVTEVZaVZZSkRrQjBUcXRVVGJDd1JkVUt5eXltWGRSWk9NUG94N2liYjFDdWdPTmhhYVpBU3BEbi9PTlc3YUIrZFpJVkpyd0hkRkdiVHRpYUtlQzZpdkRxQ1V4ditKT2RHVDdmelV6UU5oK2lBVUs4K1RaS0hNSTdKY0NNTkVsNkR6WnJUeTArZVo0TkpMaVdCMHlIVlVhK21BMTBRWlZDMWRxc3phQ2EyeVZnbHRHMEcyKzFCRWt4N3dVMENvdmZUWlEwaFVRaWN4amVWWHlndnp3Z1RPQkYvN2pWMks5MnQvcGkyaGl5V3FZSzhWeXpLMitvdnF2QkpQOGxPSGNtV1JqN3RCK2FpL0F2L3FTMUtFbVUyT2twaW9yTkZhMVVqd3kyZHBoWjBzTUZ3R0tiMDhtd3c4ZmdNVCtkWWJDcmhuUGZ0N3VJV2lmbkpVYzdyeWlicExIY3M1SlVVTEcwcXJiVVhKOHM5R2ovTTYxZU1xWmJhVlQxZVNKdjBHQ2JDdXBsZzBoYUY4UFlpcEJ0cm95UXI4QXRiUHE3alUyYVArM3B5RDdpOWFIU2I0YVJ4Z2JDKzF6QzFsK1ArTzUzZ3liRzVGclVMNGRudDFJM3M5TTNkNFh0THNFdFVSUFdKdng0RGFINXlFV2pEeEFQblBhUzhrWkxTQzNObmFhQ1VOa2xPTHVkYWNJSUJVUUVVQnBvdlMyV1k4SElDTS90YUpIajJ3enhSc3EwUVVIS1NlSGgydmc1VW5DblJ4MnVPRlhlZHhuVnZmWlFIVUV5WU9xRm1MeStuYTlGN013T2hGZWFFc2kvTUVpaGxnRUozTzhlNzE0b1U4WHVSenlrN3N1UHl4ekRRSUNlZURja1NoZ2t2M3hlbjhQWjhlWGFuOEhEY2QrbFFLWklKaVNDOWt4RlZRRzBEN1VUN3N3eldMR0dZZThHRThuTHl0SGdPOStJNTZWaVRKVkJxa2ttMDRrUWxVR0tnODI1dUxLbGg1dVR0TnM5MlJnT2QvSmozanV6SkVpaUZUYVlZWndFVUJwckhETnFJTjFubWFKanc5ZzJlV1lCT0xtTkcwclJLYVpaQW1jRnhYQVphajZQMEtCOFlTc1RCT2N0Y0RSTksyencxME9HMG1VelBjRERTSkRWS2VEaEZtZGxBMWZ0WUNYUWVwVVNKUEMrd2hHYkY4VVNDeG5BNFg0emRha2V6eTJuQVFJSWtSMmxObHZzcVhDSUdDcUJCWnhBbElEbUlnYkpRbHBRblZOWkVqeGpUWUxRWVhJL3ZteE4yY3B0VkI1YzNpODRvcml1T0p4WkpHeVVwVWJPL2dRS29lT0haNmx4SFRwRGpHMEVTS0l0bFNYa0NLTUxCVmlJYW9yd0lmSUlrVUJJUHo4dEFBUlJJcDR2Qk9PeEc3SWorN2E0UlRacXp3V0xVQ3VBMTJQY1d6Qkk4dFFsQVp5WjJkQmd4WGpPMkJwTDVvNlFHQ3VXZUcwaUppS2dWblg4RXl3d3VrM2tSdFZLckVjbTJCQ2xkQWlSSTVvcVNHcWdHQ3QwMkJodEREcTh4VVI2Q0pYaHFsVGRTdUhoQVY0djhnL1dJQWlTQnNoanRBQlREVFVjYlhtT0dDRGpLUTdDa0ttdWlMOVFOb0NtS0loNzRtQ1FMMWJWa0FqV1JhdEdYUTV3akFvQkE2Ui9wUW9CS29zaERFMXk1ME1kblJaT2tRS1Z5UUVwR20zak53VkhTbzdJT2tYR29UTDVJZVM4RnNUV1FQSkFvNVlBVWczMk0xRU1CVXBGOEZKU1VxRlFiaVdoR2tKYzgyajJrNkNld2FyZ3gyQ3JqQTZNdFNaYWVQUUdwQ0tZQ3FoUUVlUitKSXczZmNhUVliUXk0QlBsVVNGcE1LeVZMS2t5ZVBRV3BjQ3ZGYUVPZXdHai9xZktiUFRxbUFRQUFnUmdvZ2dIL1RpRWhlUGpoYnVyZS90dTFya0p1QXdBQUFBQUFBTUN3ZHdhcmlRUkJHTDZFaUxLUVFOalZWeEM4emxrR0ZaZlFGMWtQUVdRUGlaZU5CejBzbmdTUjFaZkk2L2hpVzJQYjgwMVBNZWhNeHRVRnY0NFFra3Z5VWZaNHFQcnJ4bzJ6VWJmSU4zSnV2UktmNm9kVFBBbHgzOUgvSnJnZW5YVDcxRC9vcTNta1Y5UENGaEFIZ3QzZmNvMW0wU2ZhbU5VR2VEaFA3OXpCSkQydnd0Y0RxWDVOQlB0bUwxT3pGS0FUNk90eisyRnFDcmFiWUxTc0lReDYzSDNJRWtzNmp0Mm16YUwyZkc2cFFDMFFmMlFIRW5LUjRndWJPTW95V3RjTitSYjJnRmhTZm1PM3RZUmEvMFlvKzNMQ1g3WkEvT2tGTVhFZ21od3ZRaGFqbjNXcGhrV0UvU3dEM01VNHc0Slh1WmhWVll2YXZDMjBkZVNwQ3pCYm9HZlAxY1lkNkJFRGpPS3orQnkxVStteXZnVTdaZ1AzTVVtL3FNVnNyRmJRYXJGckRZTUljenhFQjNmcUFsUUNNLzJ4SU1ZbWdOOHI5djhMUnZGWnJEQnJjUTU5UEtUcWtaeGprcFBTaTFuVWV2ZUJkeUZnbDRjWm9HMFBJVFJPSC80eUJPTFB5WExGWVUvbWFKWXppcytDaFprYVViYmhjRkFGNWRpNlZXWlJpMXZLMXNIREROQ0dPb0VveldNQzhSZkw4L0wrZkJpMmRVYnhXVEI4UWx5aU1ocjY3QVV6aWNLVVNlbmhyTk1NQnFQZXFBSUp3OWxteWVuVWx5M0FOMUMvSTNrY2YwcGdsaisydzFRQUdHazlCTEVWalZJZ0JvbmRNdFdLaExtd2xnVTJxN25waHExWG1VZnZ2OHVtbGNISUNVYXRiemJiTFhyWkd5WXZkMWdyaGp2dFR3dk05dGVVNEVDYmt5cUQ5YTB3bEhIcmR0c1kwMzFyTFY5LzlvZHVibDNGZkJTTDZHTHYwVHJjbllwNUZybmI5WGpXSEF3U1pZdFozS0lXdksxaDhrS1pmTUU5OEFhV293UXFmKy85WHkrVGFmaDhRcFNjbVh4MHhLaUtvTWt6MUdxWEJoSEszeXUrTEdEZURsc05LZHNmblVETVdyaDBsVm9xRnpBR1BEeW92NndLREFKWlVMVGV5cVQvR3h0MmNtQzJNNkttOGdmS1BSRnRXR29XMzBxS2RqclpxMjBHZ1ZLTFd3eUQxb1k4OUNVRWpxVUNHOHV3dTlpVmdCbmlreGkwWERKdFllS3lYQmJkY05sNDJmYkhROVNpVjZpS1k3RFNVQ2RVWUJCRTcyQzVBQ2RUS3JCVXpFeDg1Z2ppUkdhY1lVb28xNW1adDZON2Z5S1BzclU4eTRaU3V4ajJHQWhCcEc3ODBkOC9QTVJlbHd2d25KaE8vcERZUjA4bUxpL0Fack5acmViemhUSHlvRjBzNWl2NXdlNVNFTWNwcVJXRXZoLy9hSFFsTXE4UlErd3VpMGRPVzBiK1BkemRTR0grVktwcVdjWnhtZFhLNys3dXhsLzJ6c0kzcWlBSTR3U0hRRklndUJ4V2lwUUNwUlRvWGFFVUtFRXFTSkVpcFZpUkt3UjNEZTd1cnNIZDNmOHRabVozMzl5OTJYZVB1NUlnNFN1UWQvQWc0Y2MzTTd1ekcwWm9CVWE3R2N6R09IMW00ZUI0alA4aXlRbU1ORXlNVTZmL25LYVNqWi8vS3daT1RwMCs4d0lwWnc2MFR5R2VPR3pzb2k2REY0MkZCY3BTWEtFMFc1QktXN1IvUWRCeVdERVE5WG5GUmgrY2RmeFRaeU14MzA0T2JhSEZ0V3k5TkcrK3JLUVA3b0J4QXpmazc4Z1JzT2xkQnpzejJqNlVETlZURlBndlZESjRvbmFVVkpkYWVwNjg5MHpMSlB1Y1ZSN29UQ043aE9vWU1XS2MzdHRuOEpSaHNET1pPZXJ6SDZSUk0xTmh3TTdwY1YxR0R5VjQzRWNVMHZPTWx3Nnkva01zRS9OV1JaekxHY0NzUVYxNFdnL0pld3ZOYkIzYmRoazNiTjV2TXUyb0VkaDFBWUFseXd6QUNIeGVUUUdlN1dJZkNqOFFCeWNLYzlySGdnNlZ4dVJKVXFZaFJsL3UvbzZiTGR1MkZvK2NIb3Y5aU5RUnY5cTFITUhrd1BrQWNMb0J5UHdrUGRtdnFzSERUY3hvTVlrejlweHE2OGhhaG1tbW5JbG1MY2tnVm53WnNDWXIwYkpyNXkrZE5tdmR6SUViRTZjM0N2c25tQUFYS1g2K0FCbWRtZ3lqNVdxazZrbHlIandIVzgzSmdkNVF4Ym1jNno5a0tNRGtDWHd1cVVObzFsSFFYdnlPT3JuM0pLaUdQMXFhRHo2OXBBODF3NWR1bXdpcmhSa3pGcXhMaFliNHpCRkRoZ3daTVhQUW9OVFVCVE9helpvNGNkcTBiVXVoZGd5RzdBZndnSjRJWUFud29kRjFSL2VVenFENE9BVlZtOGVNZVk2M0hHSTNKd2Q2azZyV0VwVEtvNmxwT2lTZmNZSDR5QWEvWDdseTVkaVZZNlJMUnZ0QUNCYTVvaGtNVm9sVzlpbWxaTWVaOFVrRFJoSjhvWFh6eFUybEhWb0xXZVp2MDhUTU8rVFJxOHZjQVR1T3pXa05kTXlhTXM1bk9vT1VDU1Vkei9JWUVOY1o3R0dsVlk0ZWEybXVaRnptU2hLVnpPY2MwYk9oN0dyV1gyZUlDTy9KelNkYXI1UjJPdHFQMnNTcXk5TmhJOFlDTi9Nd0oyK0l4RnF6V2gxM0NTb3hUU2p6MzdLajVPMEEvUEgxNitQbnpwMjdjZVBxcXJlZys0NVczWGZJb21zWks1L3Z1Q2JqK1VtV0RxeUpKdjFSQkpQL05NRkRicjE3OXk0OWZkYzEwRnFqdVJFeW8wTWJSODJsZHcyV0c2dk0yY1FTNnJ6V0hPWXVRSFhNQVBxNk5JKzZxWE1sbG04OGd0WThPSDRjU0Y2OUNoeGZvdTZ5OENOQzFib013bnlnRXk0WE1pNWwrR1dYK1VWNWRhZTJsZ3BmNDBDQzE3Rmp4eDZzanFqYzd0MkpLT0FjbndPYXJaU1JBWCtmMmM1WVd4Nm5EbVNhMjh3SnpRODlLbFRXSUF4MFdjMVZsTU9tVktHVVdrTXNrZVNlTjI4ZVBYcjBIblFuUXZBUm9CcWtOMjdjT0F5cWQva0tpTS9FV1pHMTFmblMzd3c2VnRTdE1raCs5ZXBoOU83YWxmNE9RUkxIekZhb3ZpaDZ5c3pNN0RHY2lQWkxUKytWbkR3K0w4OTYrWmRIL2ROYXA1a1lwYTdya0N0ekptR2drelZMb245SGMxcjBZNVR6T1oxa2VlTDR4Yk5YMys3WkF5UlRnbG1CUU51MmJRdGJSS2l3c0pDWUtwKytmWHYxNmpuUTY5ZkFsSzhMT2NtZjFjQWxlWGNCdnlLdU4wSDYyNzhmNGhkUmRzOEZrcG1aU0RHL0RXb0FpcDd5a1NvU0phRE1VNmlST3I3VjYzQVh6cVcxOVBSdlhpUnhSVzlBTldpZGpIT3FYSjZUTjVxdU9YSHg0dGtEQ2lXUUpKQXRRVjBqQkIrUktTRjk5T2pObmoxdnI1NjdlQnoxK2pWUHRTS1p4UUorQ2RGUDgvVWE5dzBtU0hsclFjQVNVQTVIU3dKSW9OaXVYYnRPTFBpRVZQT0JLQUUxUERQc1Z3dmdhQWZqVnNiNkVJSkQ1a3dTYVpNQ2ZYcjBmdExFZVQzUHh1aWFFK2MzQU12c0RvUVNTU0xIMXFDZVBjdkx5M2Z2aGg5NjRrZGdTa1FEZ2ZjcENQVEEyUTBYejU4QVBRQzU3MnZWalMzTFhYR3Nqb3RCYzRGbFAyQkpLSkVrY3V6Y3VhS2lkKy9lWldWbDhHTkZSZWZPeUJTSkVsRE5zempIYXM4a3NDZlZGQm5yZlJDbnFVT1NwbnZsM3NYRXVYbGZHdlA4eFEwSHNyTTdwQUJMUXRrVlVQWXNYN0x5OXFUd3h5OWFIOE9UYnEvY0RWQ0phR0hiUUNBcnBVTzI0cm1tS1lrcUdTOFcvQlI1SzVFdi9XZk1YcHc4a2xnT3p5U1VSTEozMmZhRHp6K1VyajUxNnV2WHI2ZE9yUzc5OEh6OTlyTGVSSlNBWmlwL2ptUjdpbE5jMm5NTGMyNGQ2dFFoVVlUdzlWcExvN09tRStmMm5Oa1VqRm5VM21IWlVwRzhmZUdMVlpPSUtQQkVvRUhnbVgyZ2FNUDVFMDI5cnJsS3hiNHpPenVuT0xsWGVqL0RzcDBpK1hUQ1Y1c21QRlZFMnhtZXlwNFpNVnFWMHB4VHNBNlp4Q21Ma0Y1VGNkYmtPTGRHT1Jxeld3Zk5rbEJPWW5wV29ydUJKd0J0RzhnQ250MnkyMjlJQzAydDhpdVVNWHM4R2RPd1JKUkhtS1NWNkJFRWFuaVNQVG5hN2IzS1BxNGxKOU8wRmFHb2tWRkRLV3R5bkZ1aUhJMFpkRmhLbEZJWFZvSkJNZDZKWjNiNy9tbWhnbDhCMHhpemgyRzVYYUMwQWQxdWVQWWdlM0swaTFnbmN6YjNvdWxiaEFhQk5mWExTZllvUHdBdzBaaUNwWTlCd1orS3A4STVwMkJxNVdHeU1aVXZtYVVQVC9LbnRxZFh0RGRDYzhwOTk3aVlOS08zbFJOeFBVVlpzNUVGcG9seU1xWmc2ZVBQWjRZbjRpeWFUTkZlZVpoa1RLZzlncVUvVDZoSFlFOGQ3Um1TcHBNS205bHBScFgwaHJxa0Q0NThkeGdHT21kTkNST2pYQnRUc1BTejV4TGlpVGk3VWJSUHJUeE1OcVpnNmNlVDdFblJic2ZKaFdWYVRHL3l2ckltMEp6aWFvaFMvV2Z5QWlaRU9ScHppYXppL2p3cGZWSnhaNXlWZzRrWkU0eTV2dlJydkNwZEQvWnNrNC9Scm5CS21rMHNrYjZJQ1FtYTNQTGdmU2l2cGlSTUhlWHhHNVBUSnhWM3hwa3d6RjRJTXpGanNqMHAyaEZuTDhicFM1TWpYUzQzNTBXK08xclFGREE1eWhQRlNjbVRjQlpVeHBuZENXYXNqUG1ONVpFOVZiUkRMV0ozU3BxRHZQTW0zekswWlFXeDBqZGFjNTVXUmlyS3krT01jbG5jRmM3SmN3b3FFK1k5Rk13SjNoaS9HM253TElYRkVpVlBEdmFFYUhLT25SajU3akpEczVFYjVtU0dpY1pNWEJjb2VSTE9JbzcxQkhPbWhLa29Tbm5aVStHazNGbWNWeW1hc3Y0M1Z6VHJ1bWcyRGFVVi9SVE04SVZKdDI3ZG1qVHBRdGczZVdhbGRFc3dkZVlWZThCMGcveGtKR2hhY2NJeVBoNmFUYVBmclVydkx2Q25PVFdVMXI5OXQ1U3NtREMzM0xxOUJOWkFTbER6bDZ3TXg4SlpHQWgyU0F4bjN2aGtBVk9vOU1QVGcwZDZWeWoxWG84OWtLK3hjZWIyaTY1RVNVNWwyZWE3RjdKWHJJMnEzMVNWOTVVTXMwTXdVT2dKYzh0dEJFa05JeEk4RU5Hd0Y4NnVMYmdTeFYvTysrWEdoRm42SEVCMmhpWWNpTHFjOEF4SW42K09nVE1US3BIQ0tWYzljZENjR1hudkUyaktVNlFDZ0puZEFSZnRYZTB3dDZ5a3ZvYnFENk9vNVVudEpRK0hscmVPdXhKeG5HTTV6MlNZY2lFSktMRS9qTTAzMGdEODBBbUJydmJFaWJzaVNKMnpLMGx6b0t1MXJHZ21SY0Njd3hWb3Q0MGw3aGtKSkp4bUJMVGdFWW1pUThPMjN4Ti9KZUk0cDNMT01BVkxSSW1OZHV5MGsvcm01eU5TWEprZVhHM0YyV2xBUHVERTFEbGIwanp0UzVOYlNDdGNUUTlCa3l1UWpVeDRwV0tKSUxPeWdzRmdTa3BLRUpTVkZWQkF3Wi9oMkpXb0lLRTQ3MlNEV1hvUVdBSktBRW5uYWtyd2hFZ0JxQWZQN1piVXlidkYrYksvS1dsQ2h3U2JvWkczZ1ZJbFRiS21kd1hhUXN0SDNONWdzdzNValFRUHdKU0FnaitacDZ4RUZPc0p4WG1aQmFabVNjZHBlT2FibTlzZHZzUFRjRHg4VXp6TEpNN1NNcE02T2RiOWFmbzE1R2JVTXQzTkpMYzFDNzFnRWt0QVNTQ3oyMnRsQTFFRUNwWW1ubUh2U2xURTVxeGNuSjg2UWx2RmZIMlFCa2VUWTVUNndUTWV3UkZQM05XZjhrcWRIT3V5azhFMGEvNGN6VmxNVTFqVFVvSENTd0NtWm9rZ2k0cjZPeW9Db2dBVS9kbkNuaU4yNjFpUHg1eDVPczRIUUp4TGcxV0FNWWxsTG9CTTd3VWFpY0tIZEVDYVN6ekJuaFhiVjl0U3A0NzFLSnIxM1RUbk0wMi85dVkwUVhNcVdaTVdSK1cyS0VlWWltVlIvOGxwYVdsenROTFNKaU5RYUlZU1Q1VTlwYThMaFRuOXJHbmlmTDJBcVkxSkxOTjdqVXhPVGk0dUhvOHFMb2Jua2IzU2lhZXlwNHoyOVNiV2pUbVo1bGpaczVRMDFhdWpJMStkUnpTcDg4NnJJN2FtUGNxRGhtVW9GQ3FZcWxVUUNpRlE5S2RwaUphSFpheXpPZU93SnNWNXFZU3BqTmxSc1N5R3F6RjVHVXA1T1Ruaml4WFBqbWhQalZQR2VwUTVIWnJqZkduYXozODMxM0plNVRqWDF0d3RZVktVQTB4Z21aWVdjcDFOTEVlZzRFL2dHZlNJOW5MSG5LSDRyRWx4TG1FcVk0NGhscTZ6SGlDS1BNZWdQYjF3ZG1KelJ2WFRGL25SbEsxM2UxSW9VQ1dJckNsZ21paHZUeXlYVjJGeG1rQ2VnRk5GZS9uSHlwa3p4N0ZtbVIybU1pYXpGRHpKbmg0NHl4eHo1dGdSc2VHcVI5TnNLbXhzWFpvdUR6bXJveVd1QXFSaDBxR0VaTW4reEhEWDBkNFYveEJwemlCbnpnU3R5VERKbUlhbDVEa2U3U2x4U25ONmgrODhRVk1zcHVSQmhnbDBRS0ZXUnhjc0JUbEFVYzdudVhhZWxEMzF4alRzWmM3UThwL01tajBzMWx4ZHhqRDVBTkxqekpoeGJqL2xaYzZmb3BrVTcwRkdnU3JvbGpoSERMb0w1TE0xTEtEc2lUaFY2cFRteEEyUkNIVWJDaTlySHFsZ21NS1l3cDRHWjZlSzlWN216TWxnbXE3ckNUL1l1NVlWSjZJZ0d0U05qNFhnSXVJTFJIQ2grTUx4QVQ1UTBZaVBBUjFRVVluaTIwVWk2cVpKUUJIUkxHWWhBUmVTamJvY3h2V01XLzB6dTI3bjl1bk91WmZxbTg2TW1XaC9RRU9mMURsVnQ2ck96VWVMNXZxTjZpQmpMZERNRW4zUE00ZG85c0ZrbHJONjNrVkRyMEhCbVZEOVpBR2l4OGNnbzVxZFFaN3Z6b0NwdmdWd0RuSzlZNEl6UGhBSjFUMW8zZ09hZ1lNTUVIMlJlRjZvM1F1Mm14Z1hPS09CNENTcXEwUkhhRUkwZHhDWU9weWlHRDBLem0wSEVxb0R6YlhYUFNWNXdDQ0RpTTQ4TDlJQVF0WHFsczdJNUNGUVhTZDZIRkw1aU9yR29ubnM2Q1dBV1FqT1MwZGo2V3d1OUp2MlZqbDNuMDZwamdQT0hkcmZJRFQxUVlhZjZMUGd1UzUzeVp2NmNHNFpEUE52S2RWVk5GT2lmMmFlbTRnQ21EcWN4OEgxREpxZlU2cG4wYnhRSE0ySGZqVHJLZEVqQ2szTGMvQlQwYzVFT2hHY29QcldZbFN2M1RnMDR5TDZHN1I2YTBHTktNUDFMdEFFMVdjTzNYaENhSElyZzhaQ3EvTmpvV1NuU3dZWmxwOTlvbE9wU1R4WEhpdWRWTGxHYVZhdjY3TEpSSmZRVEhrK0ZkQWtGYTZiNEV6UkJOVVQ0ZHlrTllhVUlkc0hvSm5LSmhNOUN1dno4b0cvNGNqcThjdnFCV1JUQU9nNFFoTjkzbUp3Q3RjUm5FQ3pBK0VNUVpNdEJCYk5OUW1ha00ydGUyYnpxb2tVQkhJV2tVNGJuQkZuOVYybjhOTm9zcm5nQ2szbXVjNTFCR2M2SHU1Q09BUFFWRWVXZnRsc2lHb2lCUVVINXlEVlg0dHc3dHFyVlp4VGJ0bjgyUXdNVFVSNkVwek5uNEltQzJkNU5GL21EQWQxdDJ6T0c5VkVDZ29MVHFiNkR4Rk9Ta09xYkNJTFR5TTBRNE56MjdRMFNnVk5GczZoMER6clExT0N5U1dic3pZSmN3clNnOU5COWR2bTExSFQwQm1MWm9mUWpJVXVMRFFodzRJbUM2ZWdXYXM4S1lFbWo5T1JoTGc4b3JOZ3NTckpSZlVHMHBDQ1p2L3JTVFlQeEY5UG9ha0hwNDMxVmo2cDJWK244dVM1Z3FheW5IQVZhQ2JqTlh3OEV6MThYWkNvVG1sSWl5VkpRckhPNFZsSU12cU1aQTE2RkIyK0lqb3N3am53d3VsdFNWSWZCczNMUGpTcmFTaEZUcGtETWNPcGZqc3ZIUWgyUGFVM2YxRW94YklaUm5TOFVJSzltMzNocjJhYTFGOE5nZWI1N0QwZ0dLZGJOQ1dsLzhoKysrSjJJNXZYN2dZU1BWY2t6RHZlcUtLWnBQVG1mYmRzVmtJZkNHZXU4ZEZNa25vWW12cmlUTlg5N2ErSGswMmMrMUZ5NFRTQXM2VmVJR1hSYkdteUdTN0VGczBicGRHOFRHaktmSTE0V1FwTjFvNElKVktSVTNxTHY5MlVoNVdScEtHV0xUZ0Z6VThqWlByVGZybTVQVHZFK0cxcWQrU01vRWRSWWgxTjJVcm9FWnFoU1FqUnp0clJrLzY3UWJPbW9obXljQWcwM3pPYVF6a0FVQ1VzdXRHc0J4YnZPcHJCU3R5RGRoQ2FaVTZXMWYwV3pRWlZoeU5GY3g1ZHBGQTBiNWx6NWI3eWFPSXg1MzZneWYxTnRTUEgvYzEvUERiUFdUU1Z1UkIxaXgrNzBmeXZtMEJUbXdEcmM2RVZrdE1QTDJWT245dWdiTTd3elBLamUyYTVNdXJOM3BMV20zUEt4cUYyRHdXTWdmL1BRb0ttNGlJSTJQV29xaW8zQnVmMDdsS2UwK2RvZ1lNOHdMUTQ2OTVER3Q4ZTBrS3U5VDUwRDZtbTlaQ0E1ajNWSlYxZ1I2N3Q3MitlV1BuOVRUUEs4UGMzQmMxM3JrUjlCR2dHN1crMmZiMzNMWlBRZXpkRXg2L0R2WGVnK1ZCSFU5OHRycnJuUXRHa3pJVU0wUWZSZkpCRkU4ZEY1NUFjRDYwczhiR3A2cDVaZmh2MXpITDczNWhaM2h3Z09zOHNCVTFsZE9aM3VMRDdxdnJGenROZlQ5bzgzUzU3Z09nOFQ1OTZidEU4N3gzMnNEUHdxcThsVjJtUDRhN0hzWks3SHJ5SXhMSnB4MEx2WHREdFV1UkVwYUdsZDYyci9YU0M5NUN3Sk9lV3pRcWh5ZXhWVmc3ekM1elZyOHV3SXpkYmRrZXVHN3dqaDcwWmhDYnZ5TWtnZ3h0eW02a2hSemNET1BPL0NPZGs3Mi91SUY5R0I3SXBhRklOU1EwNU5tWDR6L1R0dDVPOVcyeDVqaDhHc2puMWlnSGlGaElYblA3T2N2dnJTdGg3YnowWWN1OGRDUjNIU3J2M3p1VGxTMUxVRXVrUkNnQkQ5YmRGUEJtVjVmWmtQQml4SndNNWFPZTB0Vjl0ZlBXT0Vnc2YwN2xFT3M5SjNmb0kydDhWdnhBc0xpWDlRdnZIeEM4VXYwVUVtS2E2cnNTaUovVTdnaWFFOCt0YjFjc201dC82OG5uWlhNSFo2MlM5Yk1DVHNTemdaZHNYZDRyTm52YTZWYzV5a3crVzNDOUdGd25DQ2FxN2ZKYXdCaGIxV1c1ZEhwOGx2SUhzQzlSOGxqWUhzZVVjbDB1ZzNGUzdTSnNobkpicUhnOHdiS3ZqNWdHR2I1VTlxMzRQOFAyY1FaMGJ3T3dMMU5PUUNDZUVRYWpPL25TMlZGOUw4QndQZjNyaXFlNERDbzdmTkg1cXZ6KzltN3M4WVJQdU1sWHVTQ0UweVdwcGI0Y1ZPUG51QkxiN254STh0YnNURG83eTdnUWZuRWV0Mzk5ZW5sQ3pWeWRZcnovZG5lQzgyQU8zRnAvMXAzVDlueDB1Wm04dUZ1VjAzdXNCT0wzM2V1ei9TL2Q2bUxzb1p0S0xQZjR3ZDk0dFRrUlJGTWR1eE42U0FVVUZFYUlSYkZGQnNCRGppZzFqN0lxUjJIdkZzdmJlQy9iZVJWRVFVY1EvRkZFQ2ZpN3ZmV1hPSkRlVGx5WjZiQnRCV1g4NTU3Mlp0K005aS95eEhnc281SHJzVExrcFBqY3hkQVpCeHlia29vbldrUjJsdC9WQk03ZFdtam16WWVCd09YTm1oWjQ1TTk4MWMyWjNzMmZPbk4wMnpNeEpHWXFoTTZNeGNtYW9tcEVTUG5NR0E1RVFkTjVWM0Z1NnhvL2JlbWh2eWNSM0RKMlJPSC90cmpBUGFjUy9tSWVrWi9nRUJpSk5ESXhEMHZON3d1Y2g0V0FQUVkrSlRRaGJ1bXhyd2xFOWRuVWJkVEdyNjJtRldWMlRTbVoxRWN1L09xc0xZMmVnbkprdk5RSER1Z0tqdWlhWTJWTEttSEkvMTlia25NdWc0OHUvRlpyRXdwb3lzQThWejVIYkVESkhqbmhpamh4SnpaRWpsbjl4amh6KzA3K2NmV2FBa3N3WU9ZdFN6ajJUYytTSzBIUmZMWlpOT1hJY1VaY0hIL3pBaHpDbnhibTcwb3pEd2NVekRvbGw2SXpEclEzUE9KeUxwVlBNNVROQTFaQkQvazRmYVpSVnpUaVVRWGN2bTNKZUY2SU9jell3ZjVNVVBuL3pZb1B6TjdGMGx1TkplZmNIY0U3MngyOVN4cG1sSHNiN08zeitabmhIeGg2eGJJcHJKTm5BNk1HY3J0bXc0RW43RVViRG12YW1VWlZudzA2cWV6YXNHR2NxaG5ENncyRXhHdFpNMkdlYUdMR04yYkJtU2ptc0tVdldVbUxaTEh1TmxBdzFadzF6aTkvdkw1bGIvRzVyMCtjV3UwZnRZdHJ1OVpzOHVIanN0ckVFOHZyWEhDWkZFOHlLYzR0N292OHZWc1d5S1ZzRHB3bHpvckdKY1RwbWFnUHBzbVh2U0kzTTFHNThERFIwTUplN244dnBwUkkweThMRW9obllnN3lDYTlsME4xckNuUHpuekU3MEg4MTdGeVBLcXhOb1ZwcjNqaFl4V0JOQkY4dW1xMjBWNWpSWngwN1UvQzZDMWxCaTZBMXpkUkdjemRVTlUzWVJvUFVLZXhDQ2ptV3piTlRSQkN6TldaSjE0R3hhVDBZcHpLaHBjZTBSa0s2MGk0YjBaTlJYT2dKamlwNE1XSXh2dVdWL09wYk5TaTNWY1dGT2szV0JzNWtkTHRFZ1NJS29DNFpaSlgyTGhGVXpsUjB1azJ0SisyLzZGdHJoVXRvV1dMS2J4R1VKY0czdHRWZzZnYk9SZnFHTG9sL0ljR1NRaEJEbDF5VmRvRXdXVEl2S211WnkybSs2ZWNxK085a3ZoSnpMRFgyS0xLZ08zNGRTQlpsMUxKM0FXWC8zMVZQWmZSV05VcXdWeDk2bWNKdlVWcWcva3dYVFB1dkdCWXJFYWs4N3hzS2ord293ZGM1bG8vSm1VWjVlcWJZeEliT09wUk00NisxbE95bDcyVnBicVhGVkdaSzlxQ21xbXYxZ2Z6Si82MldaZGxWTSsrN2FSYzNTcHVTdXpsNDJZbWxTUGxMQ1JBT3czSU1RVnFsb0JYTmk2UXk0YzhYOFpuVUczbjFDamNDOXU0Q2piYXEySmVEQmZtOEYxdmZwOGJjYk4rNmFxbWU5MXRzWlNDeEZaMkFmQ3hNNVI5Qm4rbnNRbG0rM09lWFN5VGlqR3VlODlXVFBtdnNzVDhvK3l5ZlA3anorZG9OSWdpTWpKSFdRb3QvVlVBM1RybDJ2SG4vTEplaUxrWGJOODB2T25mRXZmdjhpcFJ6dHRkeithMkNLbklzOXlHM09lQ0ZrNmV3ZnFQNmV4Mmx2cUd1VllSNDkrdmd4TlgrL1ZDUXR4MERGZnp0ZjVqZUNUQlhRL2tTVVd1Vkx1bFpWUWFpN0d0VHZCZzEycmE3YnRiRjNQeDltZVd2S2NtcTNPWEVLenpqOVducWt2ZlllWURhbS9mclIwYU5ISDcxNVExMy9iVFZKeTVFWlJveTZHNW1YRnF0aXlrQ0pLSFhRbitlYS9xSWU0Q0c2VVRta0IvajZXV1ZMOU5ZaTVlc0lKajBxQTVobHJZbUxUYmM1MDRWaUpkSnFKeUl6NkxUM0RLWjloT1dwZ0txTzZuZkJ1M1B1cU41ZDFGRnRXVDU2OWViQWl4ZTNyM1EySkFHeWV5ZVc1NlV6OFlXYlYyWlQ4ZVR5OUY3UDQ5L3NEcVlFVkZ2MDNQYnRWT2gvNkpEZlVUMWdManFxajN6NXVTU1hvNUxxKzNTbnZ1VG5sNXZvcUo0N3dIWXEyNVNQSTVadi9VWi93SlRXUk5Cck5tZEM3VVJrQmxQMGIrOHkyWjZLcCtoUDUvcjAzZHlmVGh4dGY3cFpMOVZXVGloZkhUaEFLSy9jdW14SStoeTl6TXBWVzZaTjJWa28xYkUxYTArazBwNWh5a1NOUlI4eVVESW85NmViSW95aS92UnRZN1cyRmZlbjJ6NTZZcWxUeml5dmR0MU94dXdXQmhQV3hCN2tNS2ZFeVgrTFRUdmJzNCsxcDg5elVxRGJmN2pvOWllU2JFdVY4VXZYRk1vRG41OFR5bnNkdFNjVlNHOTE2a1JzZXNHaDZiRk5DOU1lRTFVZU5VQ05RWm5ueUtHNmtINkM2UGFuRjVxa3JhSkhGejIzaHU4NjlMYnI5dTNhbUJxbXpMbXdwc09jeURvMDdWVDNpRWs3MjlQbjJkcHFlR3FnVEpTUktqRkU1a2dnbVNTaHBGci9TOWVJWlRGSzdVa3Z2aWxScUVHeEhXUlN0cWdCU2p5MVFTK00rV0VNeWtTNW9JazFtU0N5NXM1VkpJMHRGeEJMRHJsaHljWTg5MUFiTTlKOVpyNVFMdWV3WmxYbUZGbG5yZG1MdEpmd2ZIS1VhdWtWVUV1VW1Wb05ZcEJNOHROM1l2bUtGa3RHU1N6djNXTURLRk42NmMzNVF1MUtuTWlRUlMxUUdQUTFHNVNBTWxGR3lwcEFFRW5FVVpFMHRwek5MR2NFV0c2bmtCdGpMcDlWS05FY2szTlkwMjFPWkwzTWRhZTJwK1pKNjJkVUY5TS9lVVpBci9sRXVaL0oxeVJlS1JYSmE2OWV2WG5EdGxRb085cDhlNmxZb1g3RkZwNVNRSVZCeHl6UVJKa3BhenoveEJ5WkpMdVNiTWtabjZIMkhzMlNqYWxZUnBEeU1qbnYzNlV2VzlOcFRtUzlQTTZJc1NkNDlvbEdpYWNHYW9reVU0aEJNc25IaEpMMm5lZFhybHdHeWxNdGlVS2pPcnlESFdvTitzRTNxQ0pLU0FrcWFTajlJSXdFVXBGVXRxVG5rd2dsc1ZTYlR5RGtuVEk0Tm9JMVRjNzFlWWRUT0RoaG5Hc2tUay9aRXp5N0VOQ1BIMXRiNlVTWGdSSlIwalhXSlYvMDR0V2p4NFNTcjRiTVltbGR1WEJMb1RtS3Bjc1o5TkRyQy9Td0RERWxUWnc0OFFlSk9TcVNpeFpQWGJmT29qd09saXJrSG96cHpyazc2OWlKcEQyRFBBbW9Ja29pcUpyb00yTDZDRklrOVlXbGo3S2QyblVhQ2JnMDZFSnBVSDFSVDllaHN5OW92YWJYSkxxMzU5TVNvT1NOM0xCRXlDVk1EcWJJdVR2cjJJa0V6dFhnYWUvc21HanYzblNVUzFUdkJQU1lSQ1J2TUVtZzFMWmM3a0Rac0VHSnB3SDZtdmtaN1NLdFU2SVA2TFZCMlRiSU1yTWxES2JNdVR2cklUc1I0ZzZlZkdkbmpzajBjZTQzMW8wYjlGM3BCY21RREtJODlXQ2FtMDNqSzZnRmV2N3ExYXR2My9vODFTOE04dmp4Zm9TeUxhTUV5NzJ4Z2dPbXlMa2JwOXlKSkUrMmdDRnE5Skt3dnJTNi9mSTJnYlFrZlpSZWRrdmhMeXEyRndabG9KMlo2SGI2dks3Mk94NlFmNURhcXpPajFDemxnaWxoY3M1aHpkcDJvdlMrVUo2NHM3UG5qb1NWeEFlN1d1MkpZN2Q3bGlTdWh2NnlZbkVZVkgxeUQvMGpVU3NjcEJxVW11WHFXTUVORXptdmRTZUtkRm85eDdGR2FhTG1TQmVIdkRoYjgwbld1TzlNbVpYSXIxMjFweVdiWGRseVl0T3FwVXZ6KzZaWERaUjU0dTNXQ1NLbVJ2eCsyd05BckQrWnNNL3VkQ29JRXptdmRTZHFFK2wrS3V5ZmtGanA2Y01IamRTSUFGcTFDWjRKZWNucUx5eW41emRsazhsT1d0MVpuWXd5OFpWbjhyT3F1NmpYUUhGOHgweDlkZE1nZyt0UDZLYzNKOTBwVWg5TUxKMDRSd21uc0dWejJoTEZlYTZGYURpeUo1Yy95RmNMY21sTEtxa1o4bDhMNGE4anBzbk5hd3B1NWJQaTdlNW94QjhqTlFoTlNNb2piZXFFQ1p3NDQwdFVOTUhLaktmKytaR2dqS0c4ZEtwbDZiU3FQWmxOS281NGN3eUc0amRKTWMzRU4xVkI5UERtdlI2T1JDR0V4cldVenpFcHJ4TW1jT0w4T1RPbFVGR3pZbWMycDVhZjhqeHp5THVhVG5sVEMvZkVrRWszeVJiS3RnR3BFSnJWbUNPcVA0Q2pORkh5Nk1wcUxMcGxUK3FVSjk1dUhSb3YzaUl1TUlReFZjb0JzeDZjdEhiMjYwODR6ZGxVbFd2ZXNYMXpkcDR1MUt6cE81TEdrM0tWTTVjSFd0amFtQ2hiTk10QTNjcWYySkZjVFV5dHZOWEo3Qjd0U1ljeGNhd0xtUFhnN04zRjRFVGEvNFptWmEwcHhRN2N0bGk5L0s5cFdxSU1ORmw5QW5iT21USnJXbUxObERrNDFuY2EwNlljWC8rdVIxRjZEaWU0RjZYL0NzOVpMUWFsOXFRQ2lhdkRya1hDVmFJbWFvQVN6eXlBTms5ejRzcVlTRGt1MnV0UkgreEYrdjQxMFhTV0FaVDRvaTRla0NIMXRsS3YxQjBNaUNxZ01HaHpXUnBqSXVVQ1p2MTdrZUs1TU5GTWxIUXBaRkhpRHJVL2NiVFBHYkY2R1BISDlqbWxmcHFvQVdvTnVySXBRTEZnUm1CTWtmTDY5eUtWZHNzemxXZ1N5b1hLbGtESkpCa2xnY1NEaGFTb2x2cFlQYy9KVEExUkJobzBhTHhKUEtkb2xqQW1VdDRvVHBYMjV2S2N0UmtKTnlnMXlTNU1FZzhUQ3VIeFRpSnFnQllidEdWNjR5empQa3NZRXpBYlVWUXZua1U4bC85cDM0NVpFd2FpT0lCTEYxdW9FQ3pVZmdYQjFWbkVsSUJieVJJa09DUXU2cEFoMEtsUU92Ujc5MTd1SHY4N0g0TEdTMHdoL3c0dG5SNi85eTZZWjNLVFp4NDVGMHRRc3VRbFZaR29CaFVEV3F5OVdjckI5SFRhWGMvM21nT2EveFlmUS9kaUNjcHFKcS9wTTRGaVFIMWNRUmZ4cWFYSHdjUnBQL0dzQTVwdlk1SzBwbEtQSlNockhKeHpBenFQdytzcGZ4UWw5dUJrNlhVd1ViVHJ5YUNidy9LeU9tZEp5cEpNaVJNdUtXc1A2SWdIbEVDTDhFcEtPalRDRXBVMTVva0hORGFib3N6T2x4MGV0NGVwZ29Ra1VUb1h5MXNMRHNTQUFuUWFKZUVGa2trTXlrWXRwU2RLWnRHaE1wMm1aYkxMdnBhNXVuTTd2aVhiZlJtbDhkdzRQam1TTGlVOTRJRDRHVkNBcXVMbXEyZ1hub1hNOXBVa0tCdTJsSjRNcWtXeGQrUmd5NHZGSnlSQktVNjRyd0VGS0VnUFpaTE4xcUc2UmYvK1hJVDU4cGlVNldxS1U0UFB2UTFid3BOSEFEV3J1TnRoN0hpZDNSb2svVlBLQVgzRVpnU2tJbnBySmE0L3hsSWVtVVk4eHd5S2IxWU1Lb0psTjBOQzBpdWxIRkFHUlcwbnpVYkxjV3BzeWpZczRja2x1NC85ajJpZnl4bFZQODVMRkpBRVpUUFZBUlR0bHQzR3FiRlhCRVRaaHFVc21VVnA3YWhSRWFPSUYzeHN5VVpyRFd4UW01UkRnaFJ5eEFJUWxEVTY3UU8wRXNYYlV0cVZJbDgrYTBjU29OeHVrSXB1aTFQVE9xVzhWZVlWR2FHcXZPbzg2MkMzQnNtV3dzV0JsR0srU2tmTENaSWw3MEVwUlhYWmhHcG5UQkV2N2JZWmZnWFd0QnZOZnRDLzBHMHRHUXc2a0lrMnBjTHQwRC91NVlqYWlOUnNSTW5VemRoQWRrWFNNWjBFVGlZcWcyNGs0Q1BrNXY3ZC9xOUJ0MTlVOUYrZDZYYWZQbjM2OU9semEvNEFIVE1LOWNsaG5ZQUFBQUFBU1VWT1JLNUNZSUk9XCJcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2Fzc2V0cy9pbWcvZW50ZXItdnItYnV0dG9uLWJhY2tncm91bmQucG5nXG4vLyBtb2R1bGUgaWQgPSAxNTBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBcImRhdGE6aW1hZ2UvanBlZztiYXNlNjQsLzlqLzRRQVlSWGhwWmdBQVNVa3FBQWdBQUFBQUFBQUFBQUFBQVAvc0FCRkVkV05yZVFBQkFBUUFBQUJWQUFELzdnQU9RV1J2WW1VQVpNQUFBQUFCLzlzQWhBQUNBUUVCQVFFQ0FRRUNBd0lCQWdNREFnSUNBZ01EQXdNREF3TURCUU1FQkFRRUF3VUZCUVlHQmdVRkJ3Y0lDQWNIQ2dvS0Nnb01EQXdNREF3TURBd01BUUlDQWdRREJBY0ZCUWNLQ0FjSUNnd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXdNREF3TURBd01EQXovd0FBUkNBRllCRHNEQVJFQUFoRUJBeEVCLzhRQTZBQUFBd0VBQWdNQkFRQUFBQUFBQUFBQUFBRUNBd2dKQkFZSEJRb0JBUUVCQUFNQkFRRUFBQUFBQUFBQUFBQUJBZ01FQlFZSENCQUFBUU1DQXdjQ0FnVUdCZ29NQ2dZTEFRQUNBd1FGRVJJR0lURkJVUk1IQ0dFSmNSU0JrYUVpRmRFeVFsSWpDckZpazlNa0Z2REJjcExTTTVUVUZ4amg4WUpUYzRPalJDVkZoWldpUXpSVXhEVlZkVllad25TRXhkVWFzbU96dytPa1plVW1SbGNSQVFBQ0FRSURCQVlHQ0FNR0JRTUZBUUFCRVFJU0F5RVRCREZCVVFWaGNaR2gwUWFCc2NFaVVoVHc0VEpDa2hVV0IySWpVL0Z5b3RJems0TENReVJWWTFRSXNuUFRORVFsLzlvQURBTUJBQUlSQXhFQVB3RCtmOUFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFZRkFZRkE4cFJMR1VvV01wUXNaU2hZeWxDeGxLRmpLVUxHVW9XTWlGakloWXlJV01pRmpJaFo1UWhZeWhDeGxDRmpLRUxHVUlXV1JDeGtRc1pFTEdSQ3hrUXNaU2hZeWxDeGxLRmpLVUxHVW9XTXBRc1pTaFl5bEN5d0tLTUNnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUJnVUR5bEVzWlNoWXlsQ3hrUXM4cUZqS0VMQWFGVXNaUFJDenllaUZnTUtGbmtLSlo5TnlGanBPUXMra1VMSFJRc2RGQ3gwa1N4MGtMUHBEaWhZNlFRc2RJSVdPa0VCMGdnZlRieFFIVGFnT20xQWRNY0VCMC9pZ09uOFVCMC9pZ09tM2lnT20xQWROcUJkSUlEcEJBZElJRHBCQ3gwZ2haZEpDeDBrTEhTUmJIUlFzZElvV1hTS0ZqcGxDeUxIRDRJV01wUXNzcDVJdGpMNklXV1QwUXNaUWhZeWhSYkdWQ3l5SVdNcFFzWlNoWXlsQ3hnVVVrQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQmdVRHlsQ3hsS0pZeUlXZVVJV01vNUtwWjVmUkN6eWxFcyttNUN6NlJRc2RGQ3o2UTRvbGpwQkErbTFBQ01JSDB4eVFQcCtpcVdNbm9oWjVTaFl5b1dNaUZqS0VMUEtFTEdVSWxqS0VMR0FRR1gwUXNaZlJDeGw5RUxHWDBRczh2b2hZeWxFc1pTaFl5bEN4bEtGaktVTEdVb1dNcFFzWlNoWXlsQ3hsS0ZqS1VMR1VvV01wUmJMTDZJV012b2hZeStpRmpMNklXTXZvaFl5aEN4bENGaktFTExLRVd4bENGakloWXlsQ3l5WTcwTEdUMFFzdW1PU0xZNlk1S0JkTWNVQzZRUUhTQ0JkSkN3WWlpMlJpS0ZrV0VJV01wUXNpM21FV3l5aEN4bENpMldSQ3hsS0ZqS1VXeXdLQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQVFQQW9XTXBSTFBLaFl5aEN6eStpcVdNcFFzd3dsRXN4R1VMTVJJV1lpQ0paaU1CQXd3Y2tEeWVpcFo1U2lXTWlGaktFTFBLRVN4Z09TQjVmUkN4Z1VMR1VvbGpLVUxQS1VMR1JDejZaOVVMQWpLRm4wanlWU3dJVHlRcytpNzBRcytpVVN6NlBNb1dPaWhZNkk1b1dPaU9hRmpvam1oWjlFSVdPaUVMSFJieVFzZEZ2SkVzZEZ2SkN6Nkk1SlJZNkk1SlJZNlE1SVdmU0hKQ3k2UTVJV09pT1NVV09pT1NVV1hSYnlRc2RGdkpDeDBRaTJPaUVMSFJDRmwwUnpRc2RFYzBMSFJDRmpvb1dYUlBOQ3gwU2kyWFJkeVFzakNlU0ZqcEhraFpkUDRxTFpkTW9XTWlGaktVTExLVUxHVW9XTUNpbGw5RUxHQVFHVUl0bGxDRmpLaFpGaFFzaXowVVVGZytDQkdNSUYwa0xMcEZGc3VtVUxMS1VMTEtVV3hsOUVMTEtGRnNaUWhaWlVMR1VvdGtnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUFnRUR3S0F5bEVzOG9Rc0JvVlN6eWxDekRDVVMxQ0lvV1lpUkR5QkF3d2NBZ1laNktwWjVTaFl5b1dlVUlXTUFpR0J5UUdVb1dNcFJMUEloWjVFTFBwSGtxbG1JbklXZlJQTkVzK2lPYUZuMFFoWmlGdkpFc2RJY2tMTVJoQ3o2YXFXZlQvc3dTalVCR1NpV2ZSZHlLVVdZaEtVYWgwRHlTaXo2SHdSTE1Rb1dmUkhOVXNkQkVzZEZDejZMZlZDeDBXK3FGam9CQ3gwQWhZNklRcytrT1NGanBEa2hZNkxlU0Zqb3Q1SWxuMGdoWmRGdkpDeDBXOGtXeDBoeVFzZEVja0xMb2hDeDBBaFk2RFVMSFJiNm9XT2lFTExvSVdPZ2hZNkk1cUxaZEJDeU1CUXN1Z2VTTFpHRThrbzFEcE81RktMSXhsRnN1bWxHb2RORnNqR09TaFpkSWNrTExvdDVJdGd3aEN5NktGbDBpaFpkSThrVzA5UDBSYklzd1VMR1ZDeXlsQ3hnVVd5STVvREFJV1dVSXRqS2hZeWxDeXllaUZrV0Rrb3BkTnFCR0lJV2t4RkZzaXdoQ3l3S0xaWUJBWlFvdGxsS0ZqQW9wSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBSUJBWUVvSGxLSlo1VUxHVUtwWmhwUXN3d2xFc3hHVUxVSWtRd3dJR0dEZ0VGWlNxbGpLaFo1UWhZUkR3S0F5bEVzOGlGbUl6eVZMTVJIa2lXb1FsRXN4RHpLRm1JbW9XWWlISkVzeEg2SVdZWXFsbUl5aFppSThrUzFDRW9sbUlmVkN6RUkrS3FXWWhISkN6NlRlU0ZtSWdFU3gwd2haaG5KQ3p5SWxnUjQ4RUxQcEhraFppRjNKVXNkRjNKRXMraWVhRm1JRHhRcytnaVdQbDBvc2RCQ3pGT2xGajVmMEtVYWg4djZGS05RK1hDVW1vL2x3bEdvQ245RW8xSDh0NkpScUh5M29yUnFIeXc1SlNhaDh0NktVdW9mTGVpVWFpTlBod1NqVVBsd2xHb3Zsd2xHb2ZMK2hTbDFENWYwS1VhZ2FkS0xMNWRDeDh1bEZqb0lXWFFjaTJSaEtGbDBYY2tMQmlQSlJiTHBIa2haZE5DeGtSYklzSEZDeTZZUXNkSUZDeTZRNUl0a1lRaFpHRUl0a1lTb1drd25raTJSaVBKQ3k2WlJiTEloWkdQSGdvdHBNUVBCRnNqRU9DRmtZVHdRc2pFVVd5TVI1SVdSalVXeXlvV1dVb1dNQ2lsZ0VCbENMWlpVTExLVUxJdEhFS0tSakJRU1l1U0ZrWXlFV3l5bEN5SVBGRkxLRUxHVlJiTEtVTExBb29RQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0JocFJMUEtFTE1BRGNxZ0RTVUxVR1lvbG1Ja1MxQ01JR0dEZ0VEeWxWTFBLaFo1UWhZd0NJZUJRR1VvbG5sUXN3ejBWUzFDSjN3UXRRaDVsRXN4RTFDMUJuSUlsbUdLcFpoaUZxRUpQQkVzeENVU3o2UE1vV29RaFZMTVJEa2haOU1JbG1HSVdZWWlXWWlQSkN6RVRsVXRRaEtGbUlFU3pFQTVJV29VK1BCS1RVWXB6eVZwTlJpblBKS1RVWXB5bEd0UXBpZHlVbXMvbFR5Vm8xbUtVcFNhekZLbEpxTVV3Q1VhakZNM2lsR3FUK1hIOWdWUzFmTHQ1RktUVVBsMjhpbEdvZkxqa2xHb2ZMK2hTalVZZzlFbzFIMFBSS1RVT2g2SlJxSHk0NUpScUh5NDVKUnFNVTVHMEJLTlE2RHVTVWFpTlB6Q1VhaDh1T1NVYWg4dU9TVWFoMFBSS05SZEQwU2pVWHkvb1VwZFErWDlDbEdvZkxqa2xHb2ZMdDVGS05SR25ieVNqVVJwMjhWS1d5Tk0zZ2xMcUkwd1NqVVh5dm9sTHFJMHBDVWF5K1ZQSlNsMXBOT1VvMWthYy9GS1hXWHk1U2wxRWFmSGdsR29qVDRid3BTNmttQUl0a1lFTFNZU0VXeU1UdVNGa1l6eENpMldSQ3lMQVVXeTZZUXNqQ09TTGFUQ09DRmtZZVJVV3lNSjRJV2t4RWNFV3lMRVd5TEVXMG1NY1FvV2t4QkZzakVlQ0ZwTVo0aEZJc1VXeXlvV1dVb1dNQ2lsZ0VCbENMWlpVTElzOUVMSXNDaXBNYUJHSkZ0SllRaFpZRUlwRUE3MEJsQ2kyUmFVTEpGQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRR0JLQmhwUkxQS0VMTURrcWhocFJMTVI0b1dvUjRJaWcwQkF3MHFwWmh2TkN6QUFSQWdlVW9sbmxRc3d6a0ZTMUNKM0pFc3hEektKYWhFMElXb01BM0JFc3d4VkxNTVF0UWlKM0JFdFFoS0paaUVmRlZMVUlnT0NGcURNRVN6REVTekVaTzRJV29SRlZMTVFvV29RQkVzeEI2YlVwTlNoQWQyQ3RKcVVJRDlDVW10UXB5U2xKclUybTlGYVRXb1UzTktUVVlwMmhLVFVvUU5WUzFDRDBSTFVJVHVBU2pVWXAzY0I5aVVtcFh5ejFhTlJpbGVsSnJNVWpqc1NrMXFGR2VLVWF6RkZpclNhMUNpUEpLVFdvVVNVbXN4UmppbEdvL2syOEVwTlovSmhLTlovS041SzBtb2ZLTTVmWWxHby9sR3BSckh5WTVKUnJIeVk1SlJyUDVYRGdsSnFNVW9QQktOUi9LZWlVYWg4bjZKU2FoOHA2SlM2aU5LQndTalVScGNlQ1VhaStUSEpLWFdQa3h5U2pXRFJ0NGhLTlpHalp5U2pVUnBHbmdsTHFIeVlVbzFrYU51Q1VhMC9KcFM2eU5FbEd0Sm9qeVNsMXBOR3BTNnlOR2VDVXVzalNPU2wxcE5LNEpScUkwejhFcGRSR25QTDdGS05TVERqd1NsMUVZQnlSYlNZR290cE5PQ3BScVNhYmFsTHFTYWIwU2wxcE5QdFVwZFpHQS93QzJsTHFTWVBSS1hVa3dlaWxMcVNZRVd5TUJDTFpHSW9Xa3NQRUl0a1dCUXNqR0NpMmt3amtpMmt3b1drd240cUxhVEdSd1JiSXNSYlNXS0xaR01jUWhhVEVPQ0xaR0k4RVcwbU04a0xJc1VXeXlvV1dCQ0tTQUxRVUxJdDVJdGtRZUtpa1d0S0NYUjh0cUNTekJGdEphUWkyTU9hQkZvVVd5eWxDeVJRZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBQVR1UU1ONW9sbmxDcVdZQk81QXcwOFVTMUNQK3dvV29SaEVNTkhBSUtEU3FsaktFTE5FTkFaU2lXWWFFTFVHRTdncWloRWVLSmFoRzBJV29ONUJFc3czbXFscURQUkV0UWlQd1JMVUlSeFZMVUloeVJMVUdZSWxtR0lXWWo1QkV0UWlQMEtwWmlGRXRiWURqc0NGckZPN2dGYVRVb1V6K1NVenFVMmxkeTJxMG10YmFSM0pLWjFLRlBodlJMVUlSd1ZTMUNEMFJMVUlEdndTazFLRk81V2pVb1Vqa3BOYWhSbmtsTTYxaWorcFdrMXJGR09LVW10UXBHcTBtcFFwZ055VW1wYmFZWTdBbEpxVUtVbjlGV2sxS0ZLN2tsSnFWOG03aUVwTlp0bzNKUnJQNUlxMG10UW9VcE9Zb1VCNUpTY3hRb1BSV2s1aW0wSG9sSnpGQ2g5RXBPWWY0ZWxITU1VR0N0SnpCOGo2SlJ6REZCancreEtPWVBrUFEvVWxITU1XOEhnbEp6REZ2UEpLVG1IOGdlU1Vjd2ZJSGtsSE1IeUI1SlJ6Q052U2w1aEczNGNDbEhNTDVEMFAxSlM4d0doU2ptRjhqNkpSekFhREZTam1KTnZBM3BTOHd2a2ZSS09ZVHFBOGtwZVlrMFBvbEx6RW1nUEVLVXZNUzZpMmJBbEx6RS9KRktYV1RxTTdsS1hXWHlaU2pXazBoUEJLWFVrMHVHekJLWFVoMUtCdzJxVXVwSnBRbExxUWFNS1V1cEpvOWlVdXREcVAwU2wxb05JZVNsTmEwbWxJU2wxSk5PNEpTNmttQWpncFM2a21EMFF0SmhhaTJrd0tMYVRUK2lVdXBCZ1NtdFNUQ3BTNmttSDBTbHRCaCt0UnEwbUVvV2t4dUNMWkZub290a1dJdHBNWUtGa1lSeVJiU1lVVzB1aUlVTFFXSXRrV0l0cExCeFVXMG1JRkZ0SmpJUlVsbk1JRmw1S0xaRnBDTFpJREFGQXNvUmJJdEtGcExCOENvcEdQNlVFbG1Ib2kyV1VvV1JITkZMS0ZGc2kwOEVMTGNpaEFJQkFJQkFJQkFBRW9LRFJ4UkxOVkREU1VTemF6a2hhd3ptaUtEZVNCaHZOVkxNTkFSTENCZ0U3a0R5bEVzdzBLbG1HT080SWl4RHpSTFVHTkc1QzFCcFZTekRFU3pFWjRCRXRZaVBGRXRUWXdGVVVHZlFpV29NUXRRWWVDck5xRVhOQzFDSUlscUVYb2lXdHNEaXJUT3A1RlBibnluQURFcFNhMzYxdjBuUFU3bUhhclRPcCt2U2R2S3FSb0laOVFSTGVXM3RyVkhhSXlWVXRRN2FWdkNNb2xyYjJ6cmorZ2ZvU2sxRzd0cFdOYVNZemo2cTBtcDRkWG9hZW4ydVpzK0NVek9UOHlwc1RxYzRPQng5VmFaMVBGZFJ0WWNNRmFUVW9VN2QyQ1V6cVcybnhHd0pTYWxDbGR5VnBOU3hTT1NrMXFGR3JTYTF0b2NlQ1V6ekZpaDlQclZwT1kwYlJjY0Vwbld0dEYvWUZhVFd0dEQ2SlRPdG8yZ0o0SzB6clVMZWVTVW5NV0xjZVd4V2s1aWhia3BPWW9XNUtUbUtiYmh5MnEwbk1VTGNPU1VuTVcyM0Q5VktTZHhRdHgvVlZwT1lzVzQ0Zm1wU2N3QzNIa2xKekQvQUE0cFJ6REZ0Y09BU2ptSCtHbmtGYVRtSCtISGtsSE1BdHA1SlNjdy93QU45UHNTam1EOE1UU2MwZmh2cDlpVWN3dnc0OGtvNWdOdVBKS1htRWJhZVFVbzVpVGJYRGdsTHpCK0hGS09ZWDRjZVNVY3duVzQvcXBTeHVJTnUvaXBTOHhMcmNEK2lwUzh4SnQ3ZVNVdk1RYmNNZHlsTHpDZGIwcGVZZzI0cFM4eExyZTdrbEx6RW1nSTRLVXV0RHFFamdsTmEyYnFJRGVGS1hXZzBTVTFyUWFJNzhGS1hXZzBYb2xOYTBHaTlGS1hXZzBaU210YVhVaFVwZFNEU25rbExxUTZsSEVLVXVwRHFZRkthMUlkU0FsU2wxTTNVaFNtdFROMUtlU2xOUmtnMDVTbDFKZEM3L2JVcGRTSFE4d2kya3doRnRKZ1VXMEdEMFNtdFNUQXBTeGtrdy9VbExxUVlnbzFhRENpMmt4RkZ0SmFVV3lMUW90cExNVUxTNklmQkZ0QmlJM0tMYVRIekNMYWN2SkZzaTNtRkZ0SmpCUmJTWWp3UmJTV0hpRUVsbzRLTFpGcFFzSXBJREtFV3lMU2hhUzBGUlVsaEhxRUVsdjFvdHBJSVJSdlFJdDVLTGFTQ042S0VBZ0VERFNVTE1OQVJMTlZERFNpV3ByT1gxb2lnd0RlZ29BbmNnWWJ6VlN6UkFnWWFTaVdZYUFxV29OSjNJaTJ4ZnJJbHFEV2pjRVMxQnBWU3pERUxVMk1uY2pOcUVYTlV0Yll4d0NKYWd4RXN3eEV0UWpKVlMxQ0xtaVdzUmhDMUNJOEZhWnRiWVVwSnlXMkQwVnBtY21qSUNUZ2pOdk5vYmE2VjREUmlxbHZjOUk2RXFiakkwQm13K2lKYmszNDBlQ0d0TzhkZEREUVVqeFR2YzFvZGxPMGs3QUFOK0tzUmFSY3pVZHJtTnAzMkpPOE5UYllhNk94VnJvWldoN1hHbWUwa0hjUUg0SEE4RjJJNlRjbnVlaGo1VDFPVVhvbjZhajNUeGZyUit4UDNlQXdOaHJSL3dBUVZyOG51ZUh2Zy9rL1ZmZzk4ZkZxMzJLZTdnLzZoclA1QXArVDNQRDN3bjhtNnI4SHZqNHFIc1dkMndQL0FGRlcvd0FnVmZ5ZTU0ZStFL2t2VmZnOThmRm5VZXhUM2dsYVF5eFZnUHJBZjdTZmxOenc5OEovSmVxL0I3NCtMMEx1NzdGL2YvVG1sYXZVTnZzRlpJMm1qZE04TmhPT0RSaWRpM2owRzdsTlJGejlEZTE4djlidTVSamh0ek16M1JVelBxaTNYbDNYN1MzN1FPcWEzU21wS1NXanZ0RklZWjZhb2pkSEl3NFlqRnJzRHRCQkhvdXRudHpqTlRGUzg3cnVqM3VqM2N0bmZ3eXd6eDdjY29tSmp2NHhQbzQrcmk5R24wek9IN0drajRLVTZVNW9PbmFobTF6Y0ZhWm5NdndpUnB3TzlLWm5OdERaSkpOZ0J4VnBtYzNreGFhcWlOakZhWm5OWjAzVU4ya2ZVclRQTURiQkp1SUtVenpHOFdtWjM3aGlyU1R1UEpqMGxVa1k5UDdFcG1jMnJkSTFYNm4ySzB6T2EyNlJxK0xQc1Nrbk1qcFdxYnZicytDdE16dUpOZ2tZY0NDclRNN2ltV1IrUDVxVWs3amVIVFU4dXhyZnNWcG5tUEtacEdxY01SSDlpVW5NVzNSOVgrcDlpVW5NV05IVmY2bjJLMHp6QTdTRld3WVpmc1RTbk1ablRVek5qZ3JTY3dNMDlJVGdRVXBPWTNacFNvZnVCKzFOS2MxcTNSOVdkbVg3RTBwelZEUmxYdCs3ajlDdEhNTCtwOVYrcDlpYVRtcGRwT29ZTVMwNEpwVG1zbjZla2pPMXArcE5KelVHemx1OXYxSnBPYVg0V09TYVU1cGZoV0ovTlRTdk5VeXh1ZWRnK3hOSnpYa1E2VmxsUDNXNGptbWxlYThtUFF0VklNUXduNkUwbk5hZjFCcS8xQ2xITVpTNkZxVy9vRlRTdk5lSFU2Vm5oL09HNzBTam1QRWxzcm1jRXBlWXkvQ25FN0FwVFhNV3l4U1NIQURGTkp6SGtSNlJxcFJpR2ZZbE5jeG9kRDFoR0lqMmZCU2w1akNmUnRUSGlTekREMFNsNWp3cWl3UGkydWJzVXBlWThWOXJ3T0FDVTF6QTJ6dWtPRGRxbE5jeHZIcFdvbTJ0Ymo5Q1V2TWFEUkZZN2JreEhvcFRXc242RnE5NWpQMUpUV3RrL1ExUU51UlNtdGJHWFJOVTBZbGhBK0NsTHpIaDFPbDZtTFpoOWlVMXpIaHlXV1Zwd3cyS1VzWnBGam1mc0RTbE5SbXR1bUtoL3dDajlpbE5SbVR0S1ZXOEQ3Rkthak5tL1NkWHhiOWlVM0diS1RTMVNNZnVuNkFwVFVadkZtMC9VTU9KR0NsTlJrd2ZhWmdjTU1mVktYVVFzVXo5elQ5U2xMcVArcmRTUmdHL1lsTmFrdTB0Vm5hRy9ZcFRXcG5KcGlzYnZiOWlVc1pNSk5PVlRmMGR2RWJsS2FqSjQ4MW9uaTNnZytxVTFxZVBKVFBidkdLaTJ5ZEUzNEZGdERvU290b2RDbE5Sa2d4S1UxR1NIUmMwVzBHSlJxMG1Ma2kya3NJUXRKYUZGc2l6RkZ0RG9oeFJiU1lqd1VXMEZoNGhGc2l4RnRKYnpVV3lMQVVXME9qdzNJcUMwOFVDTGVTaTJXQlJTUUJBTzlBaTNraTJrdEIzcUtrc0kzSUpMUjlLTGFTMGhGc0lFVzhsRnNzcFFzdzBCVkxOQXcwOFVTMU5ZZUNJb01BUVVBU2dZYUZVczBRSUdHa29scURRRlVzdzBuY2d0c1g2eUphd0FOeUlZYVZVdFFieVJMVTJNbEV0YldBS29zTktKWmhvNElscURDVlV0YlkrYUlvUmovYlJMVzJJbFdrbkpiWWY3QWxNemt0c1BJSzB6T1N4Q0J2VlMxdGo1QkV0YllYSFovQWxNNm5uVysxUHFIZ0FZNDgxYVNjbnYyaGUzMDl5blkwTUp4SUdHQ3RNVGs1dWVFZmdOcVh1emY2Qm55RWtrTTBrY2NNVEdFdWtjNDdBQXRZNFRsTlExdDRaYm1VWTR4Y3k3Ny9CRDIzTkQrTnRnb05TNndwWWFqWExHTmtwNk1OQmhvWFlBN1R1ZklPSjNEaHpVejNvMitHUGI0L0Q0K3owKzcwK3pIVDluSFB4OFBSSHg5bmpQS3BkTlFnRUFnRUg1ZXR0YWFaN2RhU3VHdU5aVmNkQnBpMXd2cTZ5cW5jR3RZeGczRE1SaTV4d2EwYnlTQU5wWEp0YldXNWxHT01YTXU1NWYwRzcxdTloczdPTTVaNXpVUkg2ZGtkc3ozUnhmendlNFA0NTIzeWN1V3F1K25hdTIvS3kycXJxYXlsdHpJY0paTFBMVXZsRVgzWHZhRFRSSFB2ZDkzRUFuajlsNWg1ZmxsdFJuMjVZeHg5UGpMK2hQNzFmSk9mV2VVN0hXeDk3cWVsMjR4M0ppdnY0eEVYTXp3L1ptOG80WFdVOFBEaHpENG42OXFHOVQ4TW13TzMvQUJidnlMNXVuOGR6bS9NMUg0djYzdEZLK3BxTGJLMkZveExuUnVBKzFLWm5OODlyTkRTMDFTWW5Sa1NOSkJHRzRxMHhPYjJUUkhabSthcHFHd1dta2ZQSnMyTmFTclRNNXZvZEw0amR3RERtTnFteHcvM3QzNUZhWm5OK1ZxUHhsMXBZNmMxVmRicFk2ZHU5em1PQTJmRUpUTTdqMWFsN1kxTTlRS2VPSW1RbkFEQldtSjNIdjJuUEZmVzl6aFpQRGJKVEc0WWdpTjJCOWR5dE04eDdOVGVJR3VTMFpyWExoL3didnlLMHp6R3c4UU5hZy84QXF5WCtUUDVFcG5tTkcrSCt0eU1SYkpmNU0va1Zwbm1QQ3V2aVhyT2ppTDVMWktCL3didnlLMHpPNDlGMUwyWHVWbmtkSFZVem8zamc1cENVenpINDFQMjVuZE1HaU03OEFyVE03ajZGb3p4ajFucUdtYlYwRnVsa3AzZnBOWVNQNEZhWm5jZTVVUGh4cngwWWM2MXkvRHB1L0ltbG5tUEpIaDFyaHV6OExtdy80TjM5c0s2VTVwTzhQZGI0SEMxekgvaXorUk5LYzE0Rnk4UjlkUk5PVzFURWN4Rzc4aXVsbm12UnRYZGk5UWFZa3kzZWlmQmp1enRJVFNrN3J3TEoybnJicFZOcDZTQXZtY2NBR2pFcTZXZWEraFdQeFExdFZSdGYrRnk0SGFEMDNZZndKcFRuUDI0L0VUV21HSnRrdjhtZnlKcFRuSC9xa2F4LzluU2Z5Wi9JcnBPYVA5VVBXYmhpTGJLUi9jSDhpYVU1cjh5OStLZXI2R0l5elcyVU5HM0hJZnlKcFRtdm5lcU8wbFZhSE9qcVlURzhidzVwQ2FUbXZTN25waDFLOGdqY21sT2EvUGZhQUhFWUpwT2F1bnNuVk9BRzlOSzgxN0RwL1FqNjE0QVpqajZKcE9hK3A5di9BQm8xTnE1eldXbWhmTVRodGEwbE5LODE5YXMzdDU5MDZ5bkVvdGNnQkEzc1A1RTBuTmZvajI2TzZKLzZzay92RCtSTks4MStkZXZicjdyd1U3NVcydVF0SEpoVTBuT2ZGdTZYamhxZlEwN29MNVJQZ2VNUjk5aENhVjVyNUxmZEpPbzNsdVhBZkJUUzF6WDVjTmhkSkxsTGZxVFNzYnIyZlRYYjZhNHlNWXhoTGlkZ0FUU3ZOZmRlM25nMTNKMWRiWTduYkxaSStrZUFXdXlIRG1wcGE1cjNGbnQyOTFCRmdiWEovSmxOS3h1dndkVGUzejNZbzZkOHpiVklXdEJKd1lWS2E1amo5M0Q3VDNUU2R3a3QxeWdNZFZHUzF6U051eFNtdVk5QnJiRVk1aTNMOVNVMUc0L1FzZWtqVnlBQmhKUG9wVFViajdmMnQ4T2U0UGNDM3R1Tml0OGsxTWYwbXNKSDJLVTFHNDkvcHZiMTdxaG0yMXlmM2gvSWxMRzRKZmI4N3FSN0JhcE1QN2cva1Vwcm1NajdmL2RRNzdUSi9KbjhpVTFHNDhTNGUzLzNTWkVYL2hNaFAvQmxTbTQzSHpUdUw0bjYyMGl4OGwxdHNrVWJkN2l3NGJQb1VwcU54OG91WGJ5V25xSE1jd2pBN3NGS2FqY2ZxNk43TDN6VkZTS2ExVXpwcGoraXhwSit4U200emZRN2I0Zjl3SldEUGFadjVOMzVFcHFNM21POE90ZGh1SnRVdVA4QXdidnlLVTFHYkNUdysxMFArcTVmNU1xVTFHYndhL3hGMTR4cEl0Y3BIRDltNzhpbE5SbTlTMVY0eWE2dE1ENm1wdGN6SUc3UzR4dXdTbW96ZlA1dEFTTnFqQzVoRHdjQ01PS2xOeG05cTB0NDlhcXYwSXFMZlFTU3duYm1hd2tLVTFHYjJlbjhVdGF1YnR0a3Y4bTc4aWxOUm1jbmlyckZwd051bEIvNE0va1NtNHladThWZFp1R0F0c3AvNHMva1VwcU1uaDNEeFYxbkhHUzYyUzd2OTdQNUZGdDZOckRzZmU3R0hmT1VqNHY3cGhIOEtVMUdUNXpmdEtQbzN1QlpoZ3BUV3A2NVZVUmpjUVJ0OVZLYWpKNDdvQ0VwcU1rR0kvRlJxME9qSEVJdHBNUEpSYlE2SG1FcFl5UTZKU21veVE2TEJLYWpKRG9oL3RLTGFIUmNrYXRCYVFoWkVBcUtrdCtwRnRMb3dkeUt6TENGRnRKYVBwUnF5SUlSVWxvS2kyaDBYRUl0cExTTis1Qkphb3RrUVVVa0J2UUl0NUl0a1c4MUZRV2NrRWx2MW9XUmFRaTJTS1liajhFUzFOYmpzQ0lzTkErS0JnRW9LRFFGVXNJZ1FNTlBGRXRRQUNxRzFybmJrRnRpQTNvbHJBdzNJaGhwNHFwYWcza2lUSzJ4RTcwUzF0WUJ1M3Fvb05QRkVzdzNraVdvTUpWUzF0anczb2l3eEV0Yll5clRNNUxiR0ZhWm5KcTJMbXF6YXd3RGNpS0VaTzlFbVdqSWNkdytsVm1aYXNwOFZhWW5KNUZOU0J6OE9DVXpPVDNMUk9uUG5LaGdEY2NTQXF6TXV3TDI2dmI4MWIzMjFKUUNqdDBsVUpudEVVTVRDNHUyN3p5QTNrbllGdkRDY3BxSEwwK3hsdlphY1l1ZnE5TXozUjZYZjM0VStCK2lQRnJUdFBjSzZLR3I3aEdNTWRORUE2R2tCRzFrT1lBbDNOMzFMajNkK0lqVGg5TStQcTlIdm52OEgwR3p0NDlQanB3NHpQYmw0K2lQQ1BmUGZYWTVCTHFJRUFnRUFneHVOeHQ5b3Q4OTJ1MDhkTGE2V045UlUxTlE5c2NVTVViUzk4a2oza05hMXJRU1NUZ0FyampPVTFIYTFoaGxubEdPTVhNOElpTzJaZFRYbmQ1OVhYeTgxK2UyM2JtV1NtN0YybWNQcGN6REcrdWxZQ3cxazdYSEhBNHVFVERnUTA0a0J4T0g2RDVaNVZqMFczcno0NXo3dlJIMnY2dS90ZDhpZmtQdlRGNytVZmV5N1l3eC9ESDIrTTluQ0g3L0FJUzl1YmJxTFY5RFpKb1d1dGxWUEJSeU5lR3VEbVR5dGllWFp3UWRqamppRDhGN09PN3k5amMzSjQxak0rNTlsL2NucThlajZIUEdJNFJqbE5UMzhKN2ZHM0w3L3dDVmg0bHRjVEZRMXpHYmNHTnFvOEI2RE5FVDlxL0x2elUrRWUvNHY0UW55M1luOTMzejhYZzZ1OXFQdzR2R25LcWl2MUpYeDJrUnZkUExIVnh0Y3lOclNYSEVRbmNCanVTT3Fud2ozL0V4OHIySm45bjN6OFg4L0hjM3NMUTNYUS8rbS9TMUcyazAzV1hldnBJYVJoa09TaWJOMDZhUnpxaVY3blBMMnZhY293MmNGNjJYVHp5NHplcjV2OG1aZnlEYTg0MnNZeHduZHl3bUl1dE1UV09WNVpUTXpPVVpST25HSTdKcUhNajJTZkV2Um5kbnV2RGJkY1V4a3NqNHBwcGNoYXg1NlVMcEFHdWRqdEpISTdQckhGRVJHR1dVOTBlKzRqN2JmSGVROUZoMVdXNU9mR01NTCtuVmpqSGZIamYwVHdkcjU5dHJ4Z0xzM3lGWDhPdkhoLzhBc2w1MzV1ZkNQZjhBRjYvOHA2ZjhQdm40dm5IbDM3ZC9pUHBueHUxdHI2OFcrczZlbmJKZEwzRTF0U0dpU1dqbzVLaU5qc2tZY1E1N1EwNEVIYnZHOWJ3Nm1jcGlLajMvQUJQNVgwMk1UTTQ4STQ4Wm1PejZmalBoRXVudlNIaXZPTlJhTjFRNmxaK0dhbHA0cTkwTUlrTWNNem41K21Pcm1kZ1luTWNNU2NTWFliQXZXM2VubkhISEt2Mm9jM3puOG5idmxmVGRGMW1PTmJmVjdVWlJFWE1ZNWZoalZjOGNaeHlpNW01bktJNFE3c08wWHR5K1B0TDIyc2o3dFJWQXU4dEhCUFVkTjhMRzU1SXc4NE5kRzhqZnhKWFQ2enFZMnQzTERIR0t4bXUvdStseWRaNUQwdXp1NWJjWVhwbXJ1ZU14d21lM3gvMnoydlpoN2UzamtOMUpWZnlzSDgwdXQrZW44TWUvNHVyL0FDZnBmd2UvTDRuL0FQTDM4Yy8vQURTcS9sWVA1cFB6MC9oajMvRS9rL1MvZzkrWHhVUGI4OGRSL3dBMHF2NVdEK2FUOC9QNFk5L3hUK1RkTCtEMzVmRmxXZTNsNDQxc0xvcEtTcDJnZ0hxUUhEL2tsZno4L2hqMy9GUDVKMHY0UGZsOFhHYnpqOW12UXVvTzNWeDFkMmtKbHZsRkcrb052bWliMUhzYU1Ua2ZFTnBHL0RMdVhjNlhmMjk3TFRQM1puc3VlSHE5SHZUYStUdG5yYzQyOW5jMGJrOW11WTB6UGRGeEVhYjdJbWJqakYxMnVwZW03SFNVZXMzV0dxaExhbUdvTlBJd2phMXpINVNEOUlYUGxoT00xTDg5NjNZM2VsM3M5bmR4bkhQREtjY29udGlZbXBpZlZNVTdxUEFUd1E3TlZmamZaYjdxNjNPZmZhc1BrTDQzdGEweGpBTjJZSGFEaXVEcjkza1RqampFWHBpWjljM1AxVSs5MnZsM3BvNmZabktKblBMQ01zdU0vdlRNeC93emo5TnZ0cmZCeng5YU1HMjZYK1ZaL2dMby9uc3ZDUGY4VCtuK2wvRFB0ay85Ujd4K08rM1Mvd0Fvei9BVDg5bDRSNy9pbjlQZEwrR2ZiSmY2am5qN3YvRHBmNVJuK0FuNTdMd2ozL0ZQNmQ2WDhNKzJTZjRNK1BUeGc2MnlIL2pHZjRDZm44L0NQMCtrL3AzcFB3ejdaK0xoQjd1L2hKMkMwdlo3SFM2TXBhbUhXOTFwN3pXUmw4dzZUZnc2a2JMRU1Bd0RCOGpzRHYyY3VQcitXeFBVNDV6TWRuWjczNkY4cGYydjh2OEFOdkxQTWQvTEhLTnpZMnIyNnlyNzh4bE1YZDNIM1l2czRUN09IZnR4K09GcDdxK1FGaTA3ZVlzYlhVMU1jRXJpTmdEM1pjZHg0bGMreHR4TXpPVVhFUk16OUVUUDJQeFA1UTh2MnZNT3V4MjkySm5iakhQTEtwcWF3d3l5N2ZUTVJINlc3bWFQd0U4ZUtHQmxQQlIxQVl3Qm9KZlQ0NEQvQUlsZUwvTWN2dzQrL3dDTDYzK24rai8wL2ZsOFczK29wMkMvODFxTVA3dUQrYVQrWTVmaHg5L3hQNmY2UC9UOStYeEgrb3AyQi84QU5LaisvZy9tay9tV1g0Y2ZmOFUvcDdvL3dlL0w0bVBCYnNHTjFMVWYzOEg4MG44eXkvRGo3L2lmMDkwZituNzh2aThPOGVBUFlLNjB6b1BscG1sd0l4ZjBIakVqWWNCRzMrRldQTVo3OFkraS9qS1pmTGZSWmR1TXg2c3ArM1Y5WHRjRC9kSDlySzBkdk5BMUhkUFFzYmFpeHc1dm1IUng1SHhIYVJuQXgyRURmL3NZK24wMmVIVVl6T1BES08ySjhQR0o3LzA3WG5kZDhrWlpiRzV2ZEpsT1hLeG5MTERLdFdtSXZMTEdZcU1veDdaaW9tSTQ4YW11bzNYT2p4UlZNakEzQWduZ3JwZm5YT2VsVDJmQ1V0QTlOeWFVNXJ6N0ZwejVtWU5MZHVQSk5LODV5RzhYdXdNL2NmV2REWW9ZY3dsZTFwQUdPOGdMV08zT1V4RWNabHpkUGpudjdtTzN0eE9XV1V4RVJIYk16TlJFZW1aZDVIaW43YVhhN3Rab3lobjFuU0NhOXZpWStTalkzcDlKeEFPRWovemllWUdHQzgzcXVzakRLY2NPTmQvZDlIeGZvM1RmS1d6czhOM0xYbDMxTlkrbUlyalArOWNYM1IyUysvVVBZM3REYm91aFM2ZW91bnUvYVJDUS9YSm1LOCtlcHpudmVsajVOMHVQWnR4OWYxdC85RHZhci80ZXQvOEFrc1g1Rk9mbjR5My9BQ25wdjlQSDJNNm5zcjJscTRYVTgybmFIcHZHQnkwN0duRDBjMEFqNkNySFVaK01wbDVSMHN4WEx4OWpoeDdydnQvOXRMejJCdS9kZlFOQzJpdWxtWUtpdXBXNHZZNkF1eU9rWVg1bkJ3YzV1SXh3dzI3TUY2UFJiODdrNmN1MnBtUG83dlpieXV2K1Z0dmQyODh0ajd1V0dPV2RUY3hNWXhxeWp2cVl4aVpqdW1xNzNRNzNFMHMybHJKbzJEODF6aHU5Y09DN3VsK2M4MTZ6WmRLbXBxd01OaE93WUpwYTVya3o0ZjhBamxXOXp1NFZzc05QRm1iTkxHMXhEU2NBWERFNERrRnk3R3hPN25HTWQ4dlY4azh2ejh5NnZhNmJEaE81bEVYNFIzNVQ2TVl1WjlFUDZCdXlQaVYyZzdhOXM3VHBXcTAvUnkzT25wMkNwbGxpYTU1a0l4TFNlT1hkangzcnl2TU90akxkeTVYRENPRWVxT0YrdWUxK3NlWmREME03MHhzYldNYmVOUmp3aVptSWlybWE0elBiTStNdmJQOEFRVDJkL3dEaHloL2tXcnAvbXR6eGREK1g5UDhBNmVQOE1mQm5QMkE3SzFNUmhxTk0wRDRuREJ6WFFOSUlUODF1ZUsveS9ZLzA4ZjRZK0RvYTk0anNCWnUzSGxWcWUzV0Npam83RTZkMDFIVHdOd1l5Rnh4WUI5RzByM3QySW5UbEhmakUvVFhIMzIrYStlZWsyK2w2M0dkckdNY056YTI4b2lJcUluVEdPWHR6eHluaHc0dUJOODAzMHE0dEF3MnJoMHZrSTNYMERzRjJqdW5jUFhObjBaWTRIVDNpN1ZkUGI2YUtOb2M1MGs4b2liZ0NRTjU0a0JJd3QydWoycytwM2NkckRqbGxNUkhybWFmMFdlQVhpbDJOMDk0OVcrVjJuYUNybG1ucU9sV1RRUkdhU0dKNGdZWk1nRE1Ua0pPVVliVlBPcytUdXhoaHdyR0w0UjI5cjk5K2V2SWVpNkRyWTZiYTJzSWpiMjhNWis3RVhscDQ1VHc3Wjc3NzMyNy9BRmZPeVgvd3hiLzVCcThmOHpuNHZqdnlXeitESCtHUGdSOGV1eUR0K2w3ZWYvczdVL001K0orUzJmd1kvd0FNZkF2OVhqc2Qvd0RDMXUveWRxZm1jL0UvSmJQNE1mNFkrQ0ovRy9zVFV4bU9YU3R2eW5mbGhEVDliY0NuNW5QeEo2TFpuOXpIMlErWWQ5L2JYOGRPOE9scXUxMnkzQ3pYeVdONGduaGM2V0hxRnVEZXBITm5PWCs0SVB4V3NPcHlqdDR1aDFIa3V6bkgzZnV6N3ZwL1U2Q3ZMYnhubTdRZDU3eG9TdHAraFgwRlROU3p3bkE1SkkzbHBHTGRtd3IwczhOTTArVzYzcDgrbDNjdHJPcmp3bTQ0OFltSjhKamk1Nit5eDdjL2F6V2tVbW8rNzFESlBkSmFBM2VLSmtyNGpFMldka2NEY0FNRGpIaTg0OHdPQzdYVTdNYkhUUnVURjVaWlY5RlMvWmQzNUQ2Znk3NWY2ZnErb3dtZW82ak80dVppTWR1Y2J4aW9tT004TXVQalhjN0YyZTNyNHdzR0RiUEtBTm4vQUpRZnlMeGZ6ay9oajMvRjhmOEF5M3B2OU9QYmwvekc3MjkvR0ovNTFvbFAvd0JvZCtSUHpjL2hqMy9GZjVkMC93RHB4N2N2K1pCOXUveGRkdnM4ditVTy9JbjV1Znd4Ny9pZnkvcC85T1BibC96SWQ3ZEhpeThZT3MwMytVTy9JbjV1Znd4Ny9pdjVEcC85T1BibC93QXo1bDVkK0FYaUpvbnh2MWpycXVza3dGb3RsVlhSbjVtVURxTVpnekVNQUpHWWpaaVBpdXowZTlHNXVSamxqRmQvYjNSZmk5WHlYeWpvOS9xY2NkemJpY09NNWNjdjJjWW5LZjN2Q0pkQi9ZVHgyZDM2NzFqVGtYN0xUOERuM0M2MUxSL2k2U0Z3THcwN3N6eVExdnFjZHdLN1hSZEpPL25wN3UvMU9uL2IzNVIzUG1UekxEcG80YmNmZXpud3dpWXY2WnVJajB6ZmM3MVBELzJsL0ZhMzloOVAzcTVVTmY4QWpOeHBoVnpOZFVSWkExNzNHUEtIUk9PQmp5bmFUajZibHcrWWJtR3p2WllZNHhNUjQzNGNlL3hlNTgyK1I5QjBQbU85c2RQaC9sN2VWUmVXVXp3aUx1Ymp2dnVmVS84QTVYbmltQmdLS3R3LytzUWZ6SzZYNXY4QXd4Ny9BSXZuUHlleCtDUGJsOFV1OXJmeFJkdm9xNy9LSWY1bFB6WCtHUGY4Vi9LYlA0STl1WHhUL3dES3o4VDkvd0FsWFkvL0FGaUgrWlUvTmY0WTkveFg4cnMvZ2oyNWZGblYrMVo0bzFNRG9tMGxjeDUzTzY4RHNOdTNZWVUvTXgrR1BmOEFFL0s3UDRJOXMvR1h3RHkzOWpydDNxblFsZmNlMUxqWFhXR0tTUnRzcTRZMjFFb2FDY0laSWdHdWZ5YVdqSGdjY0FtTzdqUERzZFRlOHZpdnVYOVA2US9uOThzZXgwM2F6WHR3MDQrTXM2RWoyWlhES1c0RWdnZzdpRnlUak1UVXZMeXZHWmllRXc0NjN5MzlHWXRJd0dPMVpMZmxPcDIvQkthakptK205RkthakprK0RsOVJVYWlXVDRjT0dDVTFFb2N3ajRLTlJLQ3dGRlE2SWo0S0xiTjBmMW8xRW9kR1ZHNGxEbzFGdERvK1NLZ3RJUmJTUUR2VVVpMzZrVzBPakJSVU9qSVVXMEZ2MW90a1drSXRwSUJVVzB1aTVJdG9MQ042S25Lb3RrUWhaSW9RSXRIQkZ0SkhOUlV1Wmh0RzVBa0RhM0g0SUtBQTJCQXczSDRLcGFrUUlIdlFNREQ0cXBab2kyUjhTaVcwM0loZ0VxaWdPU01xYkhpaVcwRFFOeXFLRGVhSmFnM2tpV3ByTVZVdFRZK2FJc01STFcySXEwek9UUnNmSldtSnlhTmk1cXBhMnRBM2IwUmJZeWQ2TXpMUmtKNERCVm1aYXNnL3NLdE16azJaRGh2VlltV2pZd055STh1MlV4bG5IRlZtWmZaZXl1bkcxbDJwbVBiamk1dXo2VmFabkovVGQ3SXZhSFN1anZFNmoxcFQwVFc2b3VFajRaS3R6UVhOaWpBeXNZZUFJSUorSzVlcys1dDRSSDcwVE0rMllqNk9EN0hEcG82ZnBObVk3ZDNHY3N2NHNzWWoxVmpjZW1aYzBGNWpyQkFJQkFJQkIxVCs3bDdsVlQzQ3U5ZDR5OWxLekwyM281VFRhaHVrSkgvU2xWQkx0aWplMG5HbWpjMEhFZjR4d3hHTFEwbjd6eUR5aU5tSTNkeVB2ejJSNFI4ZnFmdHZ5SDhwL2w5UFVic2Y1dVg3TWZoaWUrZlQ5VWNPMXc4N1czYVA1dGxQQWNTNXdMM25lNTNNcjJ1b2ljbjlQZkwrV0hUNHhqajlNK0xzeTlzdlJocTlWMHQwZTA5T2pwNTY1NTNZN0JBMGYzMGdQMEx6L085L2xkQk1kK2N4SDIvWS9HdjczZVphT255dy9GbEdQMno3b2M2VitjdjVaZkYvY1Q3b3g5bmZCL3Vmcm5QMDZ5T3dWOXZvM2ZwZk0zR0UyK0V0R0J4SWZNSGJqdXhPeGRybzl2WHVSNkxuMlJmMk94MDBUYzVSTlRoamxuL0JqT1VlcTVpblRYMmswL2FhdnRoYmUyZDZabm9LcWhiQlZ4T3hEZzZwWVpKQU13eEJEM25BN3dWOTloMGtSc1l4UGh4K2wvWFA5dS9LZGpmK1g4UExlb2k4TnpaMDVSMy9BSDR1YXZzbUptYW50aVlpWE9uMlJlek5kb0RVZXEzWEFBdXROTEJRbDdjVzVuMUwrcEhKZ0duN3I0MmtnT2NQZ1R0YjhuNWx0NWJHRTRUMzVmVkgyNm9meURIeTl2ZVI3blU5TnZmdFk3MmkreTR3aTdyd3lqY3h5ampIcW1lenNUWGhzT0xQdks2MmwwbDRDYXFzOUc0aTY2bXFiWHBta0RRQ1hQcXE1azBqUU4vM29ZbmpZQ2Y0UjNPaTI1enptdTZQcjRmYTFPM25udGJtajlyVFVkdkhYbEdGY0luOFgwOWppTjQ2OXI3UnJ1NldIVGNMR2syMmFqaG9YRUJ4YjAzTWlEY1hrN0hOMmJUeXhYNkxsMGVHbjczWmhVL1JIYjdZZjA5ODVlUmRMMTNrdXh0NTFYVFpZWll6VjhNS3VPTnpXV01USHJxWnVxZHJkSlRRMFZMSFIwNERhZUZqWW8yZ0FBTmFNb0dBMmJndnpEUE9jcG1aN1pmekZ1WnpubE9VOXN6YnhOVlgyRFMrbUxscWFxLzhtdDFMVVYwbXduN3RQRTZVN0JnVHNhdGJPM3J6akh4bUljdlNiRTcrN2h0eCs5bEVlMmFkY09zUGZwdXVoNy9KcDNVRm90RlBjR0JyOHJxZTd2Qlk4WXRjMTBiaTF3K0IzNGplRjlSMUhsSFJiT1duUGN5aVk5SDZuNkw1ejVQOHNlVmI4N0hVOVh1NGJrUkUxb3luaE1YRXhNYmN4UDBUUEc0N1lsOXU4R2ZkR3BmTGZYcDBQVVc2bEUwc1praGx0VGF5TjBlWDg1MGpLemV6YUJpMDdQVmRQcWZMT21uYnl5MmR5NXhpNWllSEQwY0llSDF2UStSOVJzWjUrWGRYTzVudHhlV09XTTR6TVhFWEY0NDlrekhqOURsK3ZuM3h6d2RVWFMyMlRUTnh2VjVhMTFubzZXb3FxdHNqUzVwaGlpZEpJQzBCMkl5ZzdNRDhGeWJPTTVaeEVkc3pGT3gwbTNsdWJ1R09FMWxPVVJIcm1lRHBFL3FSUmFvN3dVMThvNDJ1WldTNFNsdVVmdDRuNVhEQWJ2dUZoOWNjZWErdzh4d2puNVJIbytwNHY5N09uaVBtUGV5MjQ0YnVpZjhBeGFjWW4yekYvUzduK3h1bkl0SmRvTk9XQ0Z1VmtGQlR1TFJoc2RLenJPR3dBYjNGZk4rYTU2dW96OUUxOUdQQ1BxZlErYVk0NGIrV0dQN09GWVI2c0lqR1BkSCt4N1V2UGRCMTUrUWZ2blcvc1ozQ3V1aTU3RlFUUVVWUlVSVWt6NUxnNHpVOGM3NG81Q1lZaTM3d2JpdnBzL0tPbDJvaU56ZG5IS1lpYXJ4K2g5LzEzay9rUGx1amI2M3JNOXZkeXd4eW5IbDVUVng0NDR6SGJmZmI1VFgvQUx6SGFxTjdtalRGc09IT1M3ZnpLeC9MK2gvMXAvaG40T2pmeW4vOGhuLzJzLzhBa2ZrMW43MExRVXh3WnBTMW40eTNiK1pUK1g5RC9yVC9BQXo4Qy9sUC93Q1F6LzdXZi9JOU1vL2N0Zzl4cnlGcHRTMUZQVDI2S3dXVTBNVm9vL21YeEhxVnhmSk9UVnNhU1hDUU1JR3pCb1hxOURIVDdXR2phejFUTTNQQ1kreCswLzJvOHc4bDNOdmY2UG9kL25UTjU1WGhsak5jTWErOWpFVEVmYSt0ZTBOMm0vRCsvUitZak9hMlZGVkdYUHdhNEdsem5FNGNjekFGMXR6L0FDdG5lbnd4cjJ6RWZWYitUZmtyeXVlZzZyektNbzQ3R003WEh0aWN0eU1aNGVOWTVlcDJvcjVCN0QwSHliN3gxWFliczFkTzVGdHBvcXk4VXJxYUNqcGFweGJGSkxVVkRJY0hGcGFjQTF4T3c4UHBYb2VWOUZIVmIwWVROUnh2NklmUS9LM2sySG1uVzRiR2VVNDR6RXpNeDIxRVRQMTFEcjgvL01LeEdwK1hiYjdNZHVHUHl0Ni9LdlcvSWVYL0FPcmw3Si81WHNhdmsvOEErLzNmNE0vL0FPSnk4OERmT2VsOHlyRFcxbnlFTk5XVVRlcDh6UU9uNkVvemdGdlRxRzVvM05EMjczSEhISFpndWw1ajVkdGJXRWJtMW5xeG1hOU1UVi9wd2REenZ5cnkvSHA4ZXE2RHFPZHRaWmFadUtuR2F2amRUeC8zWXIwdVFxOFo4cStKKzRwY3FXMitHK3RQbVdkVjFSRFIwa01aSmJtbG11TURHN2QydzdkdXc0WUwxL0lzTlhWWS9UOVV2cy83ZjR4UG0yMXEvWnJPL1ZPR1VUSDB4TmZTL25aN3AyaHZ6c3h3NGxlcnBmeVR6bnpLb3MrTlFjQnN4VFNjNTdKb3JUZlZxbUREaUUwbk9ka0hzNTlvNk8vOSs3UlBYUWlTbWhmMTNNZUNXdUVMRE1RUVA0clN0eGxPMWhubkhDY2NacjF6d2o2MzZYL2EvWmpMcTkvcU8vWTJjc29tL3dCN0tjZHVQZG5NK3VMdTZkemErUWZjUGlmbnA1U1ZIaWYyUmRyeTFpTDhmcXFtT2dvM1ZMT295UEZycEh2NllJTGpnM0tCdXhJeFhxZVZkSGh2NXp6SnJIR0xuNm9mVWZLdmxuUzlYdlpaZFZNeHM3ZU56WGJQR0lpSTRkOHorbmJIQy94Nzk0dnU3M0I3dzJmUlY4ckJQUTF0UXlHU0NlMjBVYlh0YzdLV2gxSzRQellIWmdkNjk2UEx1aTNieHh4eWlhbXB2OWN2dXNmTC9sM3JZeTJ0bmEzZHZjbkdkTXpQQ0ppSm44V1hoeHVPeDJlTDQxK092Z2Z1ZGE0cE5CZUVXdDdwVXZheVdwZ3ByZEJuSUdaOVJXeE5JR0pHM0ptSXc1Y2w2dmsyR3JxSTlFVFB1bDczeTd1UnRiK2U3bCt6dDdXN2xQcWphemZ6cWEycHhYMThybTdTNXhQMnIxZEwrWk9hMjBCb1o5YlhzRFk4U1NNTmlhV3VhN2RmWm04VGFlRzRudWxmYVlmSzI5ckpJaTl1d3pIL0FCWTIrb3pmUjZxZFR2Zmw5aWN2M3MvdXg2djNwK3o2WDdCOGhlWC9BSlRvOXpyc3YyOTI5dmI5R1A4QTZtWDA4TUluMDVPeXhmTFBiZXRhUjdtNmYxbnJiVW1qckpMMWFuVFQ2U21ybk53TFJQVU1rZVdnamkzTGxQSWdydTcvQUVlVzF0WVp6Ky9kZXFLZXYxM2xHNTB2VGJPOW4vNjJxWTlVVjlkM0hvZXlycFBJZFJmdjJkdW9SM3FqMVBGSGkrdG9hZDc4VzREN2pPbHM1NGxwT1BQRmZTN0gzdW4yNThMajJUZjJ2bnY3aDRYMC9SYjAvaDNOdnQvQm5yN083L3F1cVhVK25jTGtSbDJZcHBmbU1icmxWN1dIYXFDOGQzcTN1SFh4TWZiTkhXcXZ2clJOR1hzTllLZDhWS0FkalE4U0hPM01kcGJzSEVkbnBOclZ1WXg2WWZxWDlvL0s0Njd6akRMS0x4MnZ2ZlRNMUgwOGIraDMzZU9GZy9xejJJMHJhUzBzY0xkQlVPYVFHa09xVy9Na0VEMWY4ZWE4UHpqZDVuVTdrK212WncreCtoZk9QV2Ztdk5PbzNQSE9ZOW5EN0h1eTgxODA2WXZQejNJZTZuYS95WjFibzNUVmRjdnd5anVOUzJJMGQ2cXFXSnJIU0Y3V3NqaVlXZ05hUU1RZHErd3k2M2E2ZU1kdWRxTXBqSEc1K2lKOEpmcG5XLzNMNkx5Q2NPaW55L2Izc3NOdmJ2T1ppSm1jc01jcHVKMjh2SHhsWGhsNTArVFBlQzlYRytXKzlYZTNXS3hpbG1xYWllOVZsWEZOTlBVQ0dLRXd5TURIWWh6ajk3RWJOeTdIUjcreDFtZkxuWmlMNytId2g2SHkxL2NieTM1ajYzRG90enl6YndqT012dlJPTXpGUmY0TUpqczdZbTdwM0oyaW9xcXkwMHRYWE5ESzJXR09TWmpQeld2Y3dPY0J0T3dIMVh4VzdqR09VeEhaRXZ5bnFNTWNOekxISHNpWnIxVzhoWWNMcEI4NU5IVW5mWDNDdFMwSWJqWlB4R2FhdmxqMllVbE04TkpMbWs3WHREV0FqSGFRdnJNZWwxWjRZK0dPTi93dzluWitVUDU5OHo3UFJSSDNNZHJaeTNaN0t4eDJzSnk0K200d2llNmNvdnNkaVB0ZTJXSDhEMVhxT0poYkFacUszUUVNQVlCRkU1NzJ0ZHUzdWJzRzdaelQ1bHkwNDdlSHJuNnFmcW45NVBNY2QzUHA5ckdxeDFUWHNpT0gwUzVXcjVOK0pPT1BudDU4Vy93cVpaM1ZkSEJXUHVrY3N1RlY4eUEzSTdLM0EwN1hiOER2SEJldjBIUTdPN3R6bnU1empGMUhDKzYzMG5sWFIrV1IwODcvQUpoMUU3T09yVGpXTTVYTlhQWkUxVVU0Z1g3OTVBdEZua2N4dW03YzhEbSs2aitDRmR2K1g5RC9BSzAvd3o4SGR2NVQvd0RrTS84QXRaLzhqMStyL2VkYlpUWTRhV3RoUHJKZHY1bFA1ZjBQK3RQOE0vQXY1VC8rUXovN1dmOEF5UGtYbUwrOEYxUGxMNDhhbDdDV2F4VWxzcjlRUXgwc2RWYlpiaVp2dXpza3lnVFJCaERnM0RhUjZiVnlZZE4wdXplVzN1VGxsVXhFVlBmRmVEajMvTS9JT2kyZDNQb3VzejNkL0xiend4eDVlY1hPNWpPSENaeGlwaU1wNy9SSEYrRjRtZHBJZXlmYll3VjdXdTF0ZHpCVVhtVnVPeDhqaEhGVDQ4b2hJUjZ1THVCWHYrV2RORzFFWTk4OXIray83ZWZJZjlJK1MzdXhINWpkckxjbnduOTNEL3dYUDB6bFBZN3grMDlsR25PMStuTEZrZEc2a3R0REE1anppNE9aVE1EZ2ZYSEZmQ2RkdWE5N1BMeHluNjM4cStmOVYrWjY3ZjNMdlZ1WlQ3Y3Bld0xxdkpjRmU3ZnV4OXdOQjY4dU9rN0JZTFhWMHRKVVMwOFQ1eFdoN214dkxRWEVTTkdPQTVMNnpIeWJwT3lkeksrL2gzK3grbmRIOHY4QXkvdVpjclBxdHptNDhNNGpHYWpMdmk5RlRVK0V6NjNuOWxmZFcxdHJMdUhhOU1hOTB2UnhXRzVUeDBUcHJTK1lUeFNUT0RHUEFta2V4d0JPMXB3T0hIWmdlWGYrV3R2bHpsdDV6Y1JmSC9ZOWZyUDdiOUh1ZEpudjlMdlp6T1A0bzRUVVhYWkUvVHg5VG0ydmpuNDBFSDh3UHZNUTJlczh4TmVUMlRLYUIxMXJKR0ZtN0Y4cGU0YnppY3hPSnhYc2Raalc1UDBlMnVQdmVmOEFNdTNqdGRkdVl4Nkwvd0I2Y1luTC9pdDE4NnJwOHRRL1ppTVYxYWVKR1QxMThBTzVTbTR5WlBpTGQrNUdvbG0rSUhlbzFFc253SDZGS2FqSmsrSDZDamNTeWZGekgwcU5STE1zSStDalVTZ3NCUlVPaUkzYmxGdG02TkdvbERveW8xRW9MRkdyUTZNRkZRNWhDTGFTQWQ2aWtXNGJrVzBPWTBvcUhNd1VXMEZvUHhScTBrWUtLQ0FVR2IyY2VLTklJNEZBaU9mMXFLUkdDS1NBSUJRU1JnbzBXQVFOQXczaVZVczBRSUdCaWdvREJWa3dDZHlEUmtZRzA3MFMxSWhodU8vY3FscUF4MkJFYU1aejNLc3JBNEJCUWJoOFVTekF4K0NyTnJhekg0SWl3T0EzSUxhM2dGV1psb3htSHhWWW1Xakk4VldiYUJvRzVFVzJQSGFkeU16TFNPUEhkdVZabVcwY0lWcG1jbXJJUnZWWW1XaldEZ2lOR1F1Y3JUTTVObzZmNlZhWW5KK3BZcVF2cUduRFpqaGg5S3RNVGs1QmVPbHFaUHFLaFlSaVRJejRiMVdKbC9VVDdYVmxaWlBEWFRNRWJjclpnNm8rSmV4bUozbmlNRk92bTV3and4ajdaKzErZzlkRVk3UFRZeDNiT1B2bWN2dGNoVjBIbWhBSUJBSVBXZTlkN3FOTmRtdFc2anBKUkJWVyt5M1N0am5mbExZM3dVTWtvZWMrTGNBUmp0MkxtNmVMM01ZbnhqNjNkOHMyNDNPcDJzWmk0blBHUGJNUDV4KzVGNGMrNFMxZWI3MGtyeHQ5Q3YxUG90Mk1vZjFCMG05cHlleWRpWkpLKyswME9PT1o3UjlaWFB1NFcrNThyNjJxZHovdHVhYUZCcGU2M2QwWXl0aW9xT0tYR01rT0psbWxiZ1B2alowenR3QjljTm54M3pWMUgvVDJvN291ZnA3SDgrLzNrODA1M1c0N01mdTNsUEh4NFJ3OUZUN2VEazJ2a0g0MjRMZS8zM0NkWmZFSzBkcXFXWEpYYTB2OURReXN3ZWM5SlNIcnk3c0c3SkhSSGE0YnZpUjZYbDJFVE9VejRWN1pqN0xlajBmU1J2N2VlTS92emhoSHJ6engvd0RMR1hoNjNYTjJ5dWhxTmQwdE13NFJCN1FHallBTVYramRQbEc1Zy9xcnlEclB5K1VSSENIY1I3ZldqcWV5ZHA2N1ZYU0RheThWYkdObUJhUyttb3FhT0ZnT1g5V1l6Yjl1M2xndml2bWZlakxxSXhqOTNHSDRkL2RYcUkzZk5aaUsrN2pFVDdabjZxK1BkSDNwZk9QelYxOWUrYnJhbHE2M3RUMmdZOHVsbXVWWnFlc2d4R0Fqb1lBMm5jVzhjWGRRYi9UYmpzOW55ckd1TS9pajNYTS9ZK2k4aDZTTjdkMmNaajlyZXhuNk52SExPZmZwdjF2elBiRXNEOVJkeEtPcWxabmhnbE5VNC9xOUNOMHJYY2YwMnRYMlBtM1ZhT2p6bU8zS0s5djZuN1A4MytZenRlVWJrWHhtbzl2Q2ZkYnNZWDVxL25aOGk4OHRZLzFHOFE5ZVhscncyYWEydnRjZUxpQzUxeGtiUTRETHRKd2xKdyt2Wml2UjhveHZxY1BSTit6aStpK1U5am0rWTdNZUdWL3c4ZnNkR1BtNTJ5cW4yRFRQY1NnamNaNmVObG11TDJnT0dCWjFvWE9JMmpCMmNZNEViUU5tekg2RHo3WjFWdWZSUDJQdi93RDhpUGxiR09sNlB6SGJqampFYldjeDZ0V016Mzl1cUw3T01SdzRYekQvQUhmdnQzTFVkeTdocXlwanhGdXRzcjg1YVNNMDBqSWdOK0FPM0hqdStrZlB4dWFOdlA4QXhSRWUrL3NmZ1B5bm55OGQvTDhXT09QdHlqTC9BTWp0b1huUGRmSnZPaldMZERlSmV1TDBYaHNrdHZkYkdZdUlMamNKV1VPQXk3U2NKU2NQcjJZcjBmS01kWFU0ZWliOW5GOUY4cDdITjh4Mlk4TXIvaDQvWTZ2L0FBVnQ1N3A5eTNhY2JqSlV0cm9hNmtEV3NKSW1xRzBzalE0L2VHT2RqdUkyYnVLOTNEcVl5M0ozSjdMbWZaeGVMMU1ZK2NlWWJYVlhjYmZVVG5QKzVFem45V01mYlBmSGN0QkJGVFFNcG9HaHNFYlF4alJ1RFdqQUFmUXZrc3NweW01Y09lVTVUTXoyeThQVk43aTB6cGk0NmptR01OdnBhaXVlQUM3RnNFVHBUc0dCTzdjdGJlR3ZLSThaY25UYk03dTVqaEg3MHhIdG1uODd2bU5vdlZPc0xsL1dub1NTVkxwNW9waUdiQzZUOXBqc3dBMmc4RjlGNXpuR2U3TXgyUnc5elg5MDg4ZW82ckxjeDdNTXRIL0RIMnhQNlE0c2FtN1hheFk5eFpSU2svM0pYa1B5ZDg3MVRwMi9XYVV0dU1MNGh3emdqK0ZCOTM5c0hVanRQK1R0dW81SEJqTHRTMVZzeGNCdE9WdFdCaWQySmhHSDFjVjMvTGM2M2ZYSDYzN1IvWVR6S09sK1ljTUptdWR0NTRlN1g5ZUgyZDd2aTl0UHQwMng2NjFWcU5zZUVKaGprenR4RGVwY1h0cU1mVS9jZDlPSzd2bnVYTDI5UDRzcjlrZnJlcjh5ZVV4NWQxbm1NeHduZjZ2VjY0amJqTy80dDJiOVBaWGZ6RFh5cjVKeHE5eXk2T3FOR2FHMEhBL0NlOGFscEtpU0lNek9mVFVFVDVKc0NSbEFHZHVPTzM0akZmUS9MdkRjenkvdzE3WDMvd0RiN0hUMUc3dS9od3I2Wm1QZzZBZGU2THVHbXU2MTkwdzZGMEJ0MXpyYUF3dUFCaitYcW54WlNHZ0RabHcyTHpjOGF5bUg0QjVuc2NqcWQzYnF0T2VVVjZwbUhjOTdDV2hLaXlkZ2I5cWl0aExQbXEyT21wWlhERE0wUXRmTGhqd3h5cmZVYmt4c1k0ZjRwbjNSRWZhKzg4bXp5Mi9LOE51WXJWdTU1K3VOT0dNVDZyaktIUFZlYTVIR0gzUE5TQ0hSL2I3UWNPUHpkNDFWUTEwZzJBT3BMVkUrcHFHNGtqRDg1cDJISFpzeDNMMy9BSmY0WjU1ZjRaajJ2c3ZrL3dEeXZ6RzkzWTdVeDlPVXhFZlU2TGU4VVRaOVFWcE8wbWFYZC9kbGVucGZ4OTFHNy9tWmV1ZnJmTnBMV0RVWWpIZnlUUzRlYTl4N2ZXcHZ6TEM3MFRTYzEyeGV5Wm8rSjJzS3U5aHV5anQ4MDJiSEQ3MGtqSUc3T09JYzVkWHpIUFIwOHgrS1lqMlhQd2Z0UDl0ZHVjUEx1cjNmeDU3ZUVmUkdXZVhIK0g5ZmQyVEw1ZDlZNjhmZnB1ZXBycHAvUStpYkRTUzFGRG5yS3l0ZERHWEJuVmZGRkVYT0FQOEF2YnhnTUY3M2xmRGF6bnhtSTlsejlyNmp5bUp3NlBjbjhlZU1md3hNL2JEclZzRm03a2RzdFhVdXV0TzB0UTI4VWNqSmFLYW5KamtpbmE4UFpJMXdCd0xTM0VMMGRuZmpheXVjYmpzcjF1YkR6bkh5emN4M1oyK1pkNDFkZnRSTVR4cWU2Kzd2ZllQOWUvejJkVHVtcU5iYWxwMkQ5STNHcGQrUmR6YXk2Yk9hNU9QNmZRL1EvS2VtNlByY0l5L0tiZU4rcWY4QXl3K2NkNXZKL3dBbSs5V2xYNmE3cWE3dkY2MHJCS3l0RnJ1ZFZOTkFaNHdZMk95dWRoaUE4NEhCZWx2OUx0YkczT1dHRVJNeFhDUEYwZjdoK1dkUDVkOHVkYjFPM3Q0YmM4dU1PempPdkxIQ29xdkcvb3VlRnZoMzRUSlcxMlV0eHhLOEtuOEhSdVB1M2k3MlhtMWZxdWpvbVFsN1M5bUlEU1NjVHVHSEVxNDRYTlBWOG04dTNmTStxMittMnYydHpLSWowZU16NklqalBvaDN2ZU5mYUtrN0o5b0xWb3VPTU11YlkyMUZ3TGNOdFJJMEZ6Zjl3TUcvUXZuZk1lcTUrNWNmc3h3ajFmcjdYOURkYmx0WXpqczdQL1Myc1l3dzlVZC9yeW04cDlNdjErOGZjdTA5bk8xMTg3blhyQTBObXBKS29SdWNHOVdYOHlHTEU3akpJNXJCNmxkZnB0aWQ3Y3h3anZscnl2b2N1dDZqRFp4N2NwcjFSM3o5RWNYRkQyd2RlMzdVUGVIdUZTYXBuYzdVdHpqaXZkeGlmbEIrYitaSnFNV2pjV1NWRG00Y01jQ3ZwZlA4c2N0bkNNWTRZelVlcXYxUDBINTNuRGM2TFpuYmo3dTNsT0VlcXVIdGpHSE5SZkp2eTkxOWUrbm9wdHkwOXByVWdqYm5kVDFkTDFQMGo4dkt5VEtmUWRiRWZFcjMvTE03MmNzZkRLL2JINm5qL09XMU81NVBHVWNlVnZSZm9qUEdZdjZad2lQWTZjdFU2Y2VMbzdaK2wvYlhicCtOUnVPZVh0OTl0NnZSL2pIVzNDampKMVByV3ZwS0ttWTJWbzZrTHF0dEhHdzVzR3R4SFZ4NWc3U09IZTZHc2NvbVg5UWYyVzh2anArbG5meTdkeVpuNk1lejMyN21MVGJxZXoycW10RklBMmxwWW82YU1OR0FESW1CZ0FHM2dGOFZ1WnpubE9VOXN6YndkL2RuZHp5em50eW1aOXFyaFZzdDlCUFh5WUZrRWI1blluS01HTkxqaWVHNVp4aTVpR2R2RFhsR1BqTlA1dy9LUFRlcDlmZDY5U1g2U2xmMXBhNmZISzEyR0xYNU5tUHdYdCtZWjZ0N0tmVFhzNFBuUG5UcU9iNXIxRStHYzQvdy9kK3h6bThEL0ZpNzlyOUFkdnRIYWh0ajQ3anFhK1cyNFg4T2pEaVlKcWpxQnJzNElHV0ZyY1FRUnYyYjE2WGwrWDVmRExjNzR4bVk5ajdYKzJQU3pzYmZVZGJIN1dPM25wK2lQdG42bmE0dmtYbFB6OVdhbXRPak5NWEhWMSttYkJaYlpUVFY5Vk5LY3JXUlFSbVJ4SkFQQWNsdmJ3blBLTVk3WmMzVGJHVy91WTdlTVhPVXhFZlM2WGFLNHVxOVMzdnVmZGR1b2RTMWNqNG5ISE0ybUVoSS9PeFAzM2ZlMzdSZ3YwWHB0bU5lV2Y2VkhDSDlGL0pIa1VlVzdmVitaN2tWdTlWbk9PSENwamEyNTA0L3gxcTlNUmpMc3I5c2l3RzJlTkRMMi84QVB2RnlyYTVyczJPTWJDMm1ic0dHRzJNcjVYNWgzK1p2eEhoakVmYS9KLzdnOVZPNzEwWS9od2lQYmMvYTVEcndYd3pxdjkvNnB1bCs3bmFWMDFReE9rcHFhMXVjN0lNY0h5MUR6dzJnNFliRC9iWHA0VFd4akhqbGxQdXhoNTN6VmxwNkhwOGZIUGNuM2JjUjlycW8xejJvMWZKSzkwVkZLZVdEU3VKOEErYTZqN1lhMXBHT2VhR1VNRzg1WElQcUhnMTQvd0JSZDlXeWR6OWEwdjhBMEZaM2o1S0tkcHl5MTM1ekNBUmdSRVB2bkg5SXQzN1Y3SGxuVFhPdWU3NjM5Ty8vQUkyLzIyanpqcnN2TStxd3ZwK21uN3Q5bVc3MnhYZE1iY2Zlbi9GT0hieHJuSDJwZFByenVWWU5GVXJ2djNLNTBWQ0JpQmlaWmczZWNjTnVHMWZUNFpjbkNjNThIOU9mM0E4OGpIYXlqSHN4dWZaRnU3MWpHUk1FY1lEWTJnTmExb3dBQTJBQUJmbVV6YitGNW0rTXZIdk54aXRGb3FydE80TWhwWVphaDduL0FKb2JHd3ZKT0hBQUxXR09yS0k4WEpzYlU3bWVPTWQ4eEh0ZE8vZGpUVlE3VkZYZkpzWHpTdmM4T09KYzV6amp0NXI3cm8rbjE1emxQWmI5VStWZmxyTHFPb25DSSs5bmxNNVQ2NTR2WS9GYlM5VFYrUUdnTEcvRTFsUmU2T3FxU043WTZlWnNqZ01NZHpTVHUzK2k5SHJ0N2w3R2MvNFppUFkvVnZuSGYyK2k4dTNOamI3TU1NdnBtcGo3WGJjdnpKL0tEeHJ4Y0lyUmFLcTZ6dURJYVdHV29lNS81b2JHd3ZKT0hEQUxXR09yS0k4WExzYlU3bWVPTWQ4eEh0ZnlxKzRYcVdUVXZmRFU5MmxmMUh6VjlYSm1Kelk0ek9JMjhkbkZleDFtV3JkeW4wejliNS81aDZqbmVZZFJuNDdtZnMxVFh1Y050VWpQVXVQcVYxbmt4TDhHU25VcHVNbUw0VDhWS2JqSmsrQUhjcFRjWk1ueEZxalVTeWZFRHZVYWlXYjRNTjI1S2FqSmkrSWZBcU54TEo4WXh3TzlScUpadVlXL0JScUpRV2cvRkZadVpnb3RvY3pIY2pVU3pjM2dWRzRsRG04Q28wemZHVVcwcUtrdHgyaEZ0SkdPd29xSHN3UmJRUndLaW9JSVVhQkdPOUJEMllvdG9JdzJGRlNSOVNpa1JoOEVVa0FnV1ZGc0J1Ry9laFpvZ1FNTngrQ0phdHlxRzFwY2NBZzBhd05IcWlXcEVNTjRsVkxXR2tvemJSckFONnFLQUpRVUJnaktnM0hhVlV0YldjU2lMRGNmZ2lXdHJNZDI1Vm1aYU5iaHNDckV5MFpIeE81VmxZSEFJTkdNdzJsVm1aYXNqeDJuY2pOdG1ScXNUTFpyTU42ckMydEpSSmxySERqdE81VmlaYnNqK3BWaVpieHhBYlhidVMwNDVsK3hwNkV2cVdqRGxnRldabHlXOFdiWDh6cTYyc3cyOVZnKzFWaVpmMUdlQmR1RnQ4VE5Hd0FBQTBaK1AzSlhSZmUyRGI5MWRmckorLzZvajZuNlI1dE5aN2VQSDd1MXR4eDlHM2krdnJxdkxDQVFDQVFmTi9NVzRSV3Z4TTdtVmt3SllOTFg2TVpjTWMwdHNtaWJ2dzJZdUdLNSttLzZtUHJoNm5rY2YrOTJmOS9IM1REK2NmVjl4RlU1ckIrY1pYay9ITVY5dDBYVWFNbjlEYkc5cW1YMVh4THRUN3RyaTMwaEdKNnJNZjc1ZlQ0NVJsRnZwZWc2cXBkNi9obnBzYWU3Q1d5ZHpTeW91VXRSY0pHdVk1bXd5Zkx4bkI0YVNIUlJNSU9HQngyWWpBbjh4ODgzK2IxV2MrSEQyUDV0K2V1dS9OZWE3K1hkR1dtUC9Ed24zMitxTHlYeVRxZC9lQnU2VU55OGcrM3ZhMkdScjZmVHRycTcvVU1CZDl5ZXZsTUdWMjBqRU5paWR1RzhZazdBUFg2Q0t3dnhuNnY5cjZ2eU90dU5tLzN0MmN2WEdHRlI3OXoxY0hFcngrcW0zTFdNZGNUOTJMUElmUU1qTHQ0WDFmbDNVYVpwKzQ5SHYzRVREdmE4VzdHN1QzanZvNmhmc21sdGROWHlqRU93a3JtZk92R0xRMGJIU25oOUozcjR6elBkNW5VWjVlbjZ1RDhCK2FPc25xdk1ON2NuOFV4N1B1L1k5OVhRZUM2aWZkczdsUjZxODk2dXp4NWpUYVVzMUhabXVKT1hxVldGYzRnSGtaSHQ1YitlSzl6b28wNFkvVFB0NGZZKzcrVzhvMnQ3WWllN0RQTDZjOG94ajNiYysxeWw5b3ZTaFpwdTU2cWN6N3JJSTZZT0kvU3FKTSt6NklqajhWMlBPT3B2YXh3OU4vcDdYdS8zQzZ5UHkrMXRSUDdXVit5SysxelJYemI4bmNjL2N6MHhxM1gvQUdKdC9iM1NMSHVudWQycG4xb2p6NEdscDQ1SGtPRGRoSFVMRDk3WnMzY1I2M2sxYzY1ZmMvSUdPRWRabG5sTVJHT1BmNHpNZlpiaUZxcnd0MWIzQTBMWGFGdUVKWkpjSVRCSEk2TXVEWmdRK0oyVWc0NVpBMDdOdkxhdnZlcDJOcmR3eXhuUEdManhqNlBlL2MvbXZ6WHBQTnZLTjdvYzg0Ky9oTVh3bUl5ampqUDBaUkUrUERoVThYSlgybnZFelVYamIyd3VkejFyUlBvdFMzWjBNRWNkUU1zZ3A0TXpzY0NNUUhPY0NPZUdQSmZtM1VURVJFZC9lL2tueTd5Nk9qNmVJeTRidVV6T1VYY1JFY01ZcU9GL3RUUGJ3bU96akRsb3VxN1RocDcydmM2RFJmakphdEp4eVpMbmZMc0pHTisvOTZDaHBaSkgvbWpMc2traTNuNERpUFI4dG5UbGxsNFErbytXdDZlbXg2bnFlemw3T1V4NjY0ZlYrdHhOOW1UVEZScVR5TXQ5WUdsMU5TTm1yWlNDUUEyQ056Mmsvd0RHWlZxTjNUdDVlcDhMOHFkWE9FYnNmNEo5OHhqOVV1MzFlWTlKNHQ5czlMcUd5MWRocmk0VU5iREpTVEdNZ1A2Y3JDeHdCSU9Cd0pXOXZQUmxFeDNPZnB0K2RqY3gzSXFaeG1KaSt5NDR2amwwOXZyeHJ2VlBMU1hTMnp5MDh6dW85cG1hTnVPT3d0WUYyTXV0enl1Nm01Y2ZVNVIxTTdrN3NSbHpNcHltNW50bWI0Vk1jUEIrTEw3Vy9oNU1jWkxETVNlZFNmOEFCV1B6SG9qMy9GNTM4cTZUL1NqMjUvOEFNNjlQZS84QWI1OForMkZQb3ZUbmFXZ3FxSFgybzIzMnVtbWZNNmFHT250TnZFckdobVZ2NTgwamNUdE9EY0JnU0YzZWoydWZHWGRUNkx5WDVEMlBPTnZkNWNSaGxoak14V3FiblRsTVJ4eW52aU83ajJPc2p4SHFScDN2eHBDOWJvb0x0UW1VaHVZOUoxUTFrbUE1NUNjRTZiTFR1WXo2WHdmeVQ1aCtSODQ2VGU3c2Q3Qy9WT1VSUHVtWDlLM2dkYWpEMjh1OTdkL3ppdmJSTTIvb1VWSkd6WU9IMzN1K0s3SHpCdTZ0NnZDSDdaL2NycStiMXNZK0VUUDB6TS9aRVB1YThKK2R2aG5rMzJNMUIzbTd4Nkh1Y1ViMjZhMHpCZEt5V2NNTG1HZXRZeUFNR1ZwT1lDTU8vZzlmWjhxNnJEWWpLY3A3WDJ2eTM1bHRkSDB1OU9XVWFzOHNZcnZxTG0vVnhwMS85Ni9hQTcyNnM4Z05UNnEweFpacDlOWFM2VlYwaHFTV1J0ZTJxbU03aisxZUhmblBQNUZ3YjJXT1djekV4VXo0dy9Mdk92SStwNnJxOTNld2pIVG5uT1VmZnc3NXZzMVg3bllyNFErTzFSNHg5aHFMdHZjR3h0dkpsZlcxZ2hJY0JKSXhrZUJjQ1FUZ3pIWnMycnFkUm5HVXhYWkVQZTVXR3poaHRZVGNZWXhGeGRUUGJNMVBaYy9GOWVYQXk0Qys1VjNVdE41OHhkRmR0S0NyWSt1MGZZYm5xQ3VpamM1em9acnE1bEN5T1FZaHJTWWkxNDNuQWpFWVlGZlJlUzR6R016NC9ZK3U2SEtlbThwM2M1ai9BS3VlT1AwWThmcnVIVXAzYmQ4M3E2NXZ3eERxcW9QMXl1WHJVL2pqekRjL3o5ei9BSHArdVhwUXR1TXVPR3hLZFBtUGE5RjAvUm5ZUU9TbEx6SGFYN0hmZEt3eDY3MU4ycXVVc2NXbzZ5MFVsMHRrVWh3Zk5EUzFVc1U0ajJiU0RJMGtZNDRESEFnRWp4L09JblRIb2wvUlh5RHN4UHk3R2VNZi93Q2pQVjlPR0VSZnM0ZDN0ZGtpOEI3VDFydVQyZTdiZDNiZXkyZHhMVkZjcVdJZ3hsN3BJcEc0SE5nSklYTWZoand4d1hOdGIrZTMrekxuMitwM051S3huaGQvUzlNazhHL0ZhVm9hL1NNSkFJY1A2WGNkNEJIKy93RHF1U2V0M0o3L0FLbWQvZXkzcTF6ZFRjZXQ0T28vQWJ4aDFCYVpiVkZwOFVMWkdsb2xwcHBYdWFlZjlKTWcreGMyejVudTdlVjhKZlJlVy9OdldkSFVZekU0eDNUSHdxWFUvd0NmWGkwM3gvN3AzWFJsS3oraU5sYTZCNEdEWklKR2lhTndPQUcxcmhqaHVPSTRMN1RQcnNlcDJNY3NlL3Q5RXc3L0FQZXY1b3czL2xEYTVjMU8vdjQ0NVJmWm94eXl5aWZWbEdQdW4wVHg4MDlvZVNvdVRXNU1TVHNHRzFkQ244V2N4MlRlMDM0ejAxeDFreldGM2hhNjNXSmtWeG1hNGI2bVFrVWpDRDZ0ZEovdVJ6WG5lWTlSeThLanRsKzIvd0J0ZkxQeXZTN25YNVI5N2N2YjIvVi82bVVlN0NKOU9Uc2pYemI3QnhWOXhQdVI4OWZ0TmRsYU9acHNGSzJiWGV0SXQ0RnN0VGcrbWhrNFpaNW11QkIvVkJYdGVUN2ZHYzU3djBsOVo1QlhUYkc3dnorM2wvbDRmNzJYYk1lcVB0aHg1OXFidUpMVytXMWJIWHpnVjE5b0xpSGh4T01zdWNWcmdNRHYvWkYyM2t1VHJzdFd6TWVFMjduVTlWSFVlV2IyRWY4QXA3c1Q2b21JaDJZTHdYdzdpeDd0K2ovNnhlTjFMZFdNTDMwTndFVDhyUWNzVlRTeWd1SjNqOW94ZytsZW41WG5XY3g0dzZYbm0zemZLdXJ3NzR4eHpqajM0NTQzL3dBTTVPbFhWdW1BTHZJQTNjNGo3VjdsUHdHTngyUGVMR21wS0MrOW1lM2RLTUs2bnU5bnJKR2c1eVk3VlN1bW1PMERZRGdTUmhoeTRKMWs2Tm5MMHhUK3h2bCtJNlR5bWNKL2QyTlAwempFT3pOZklQaEdOeG9LYTZXK2UyVnJjMUhVeHZnbGJqaGl5UnBZNFlqMEsxamxPTXhNZHprMmQzTGF6alBIdHhtSmoxdytRU2VBUGloUGNuWFdvMHJGSldQZjFuR1Nlb2NDOHV6RWtGKzNFODlpNXA2bktadWE5anJiMnh0YnU1bHVaNFl6T1V6TThPK2VNeSttMDJnZEkwdHpwcnpGUk1OMG84NHBabkZ6akVKQmxPVUU0Zm03TWNNY0ZjK3IzTXNkTXp3ZWh0OWJ1YmV6T3poT25ibW9xSWlJNGZwZnJmcTFFcGdnZk0xanBDeHBjSTQ4QzUyQXh3YmlRTVR3MnJyeERyWTQzTVIyT3ZmM1IvSnJ2enFHeDFQWjZ5MktwMHZvS1RLK3VrcmMzelZ5WjFXaUlPTEc1R01EaGprWTUyYkRITmdNRjdYUmJPRzNsY1RHV1hvN0llNzFubVBTZVJiTVR0YmtiM1didjNkdU1lekNjdUdxZSs0N29tSW1leXU5dzV1ZDdENzlGUnhIK2lVald4dEdHekxFM0FiUG9YMlBVWjhuYXJ2bC9Tbm5uVVk0UmpzNFQ5emJ4akdQVkVWRHQrOEp0T3hhWDhWTkVXNkxLVExiWTY5N21ZN1hWajNWWnhKMmtqcVlmN0MvUHV1ejE3dVV2NXIrYU9wNS9YN3VYcHIyUkVmWStwcnFQQWZMKzhQaUIyVDc2NmticXZ1TlJUVmQyWkcyQmhaT1dOYXhnd0FBQUs1OGVvbU1ZeHFPQ2RWdDdmVTQ0WTd1RVpSaGRkc2RzM1BaTVBUYWoyeWZFNm9QM3JUVWdic0JVZy8vQUtUQ2s3OCtFZS80dk96OG42V1o0WVY5T1gyekw4YlYvdGVlRjFGcHF2dXQ4dEZRTFhTVTgxWFVPZFZOYUJIREdaSEV1Nlp3QUE1SzRiMHpNUlVOOVA1RjAyZWNZNkx1YTdjdS93QlV3Nm50UlQyUFNPbnFhMldKallhSnpYMURHTmFHN0tpVjAyT3pmK2R2NHI3N3BObUpqR0k3SWgvZmZ5YmhzZVIvTG14czdFYWNKakxLUFZsbE9VWDQ4SjdlL3RmVWZiVXRmOWMvTUxRbEZLNFpZN2wrSmpOanZ0N0RWajgzYmlTekFMZzg5M293MnB4ancvVS9Jdm5ielNjdWwzc3A3OFpqMjhQdGQxYStBZnpnL0M3b1VkeXVQYmUvMjJ6eHVsdTFWYjZ5bHBtUmpNNHlUUU9qYmdNRGlRVGpndWJwNWlOekdaN0xoNlBsR1dHUFZiVTV6V01aNHpNK2lKdHd6MVo0WGF6dk4vbnFLVzNWWm9BVDBjMUxOZ1R6d3k0TDlCMmZNT2t4d2lPWkQ5NStYL20zeS95M2E0WjQ2OHUyYmo0dmJ2Ri93ZjFWb1B2ZGFlNTJvQWFlMldXT29sWUpSbGZMTlV3dWhER3RPMFlBZ2trZW0vZDRYblhtbTN1NHpoaE52a1BtMzV0NmZxZW16Mjl2TFZsbk1SNklpSmliK3lQYjJPWGErVmZrajU3NVk5dzdWMnE4YWRjYTh2TTdhZWpvYlBXdGJMSWNHaWFvaU5OQU54SDNwWkdnWWpERXJuNldMM01mWDlUMHZKNC85MXR6UFpqbEdVK3JINzArNkpmeWorUnVzRzZqMVpjTGtIWW1hVjc5bTdhNGxkMmVMODJ6M0p6eW5LZStYd0MrZ1N6dUozNHFVUmsvSmtpTFRnVmx5UkxGOFlPOVJxSllTUmM5L05TbTRsazVuQTcxSEpFc0pJc05vM2NsRzRsazV2MUtOV3praUJScUpZdlp3Y28zRXNYeGtiOXlqVE56TU5vM0tOUktDQWQ2Tk0zc0lSYlp1Wmo4VkdvbG01dUd3cU54S1NNUGdvMHpmSGp0Q0NDTUZHaUxjZmlpMmtqZ1VWRDQrSTNJTXlPQlVhU1c0ZkJGc2xGUzVnS0xiTXRJK0NLa2praWtSeVVVa0FnRUFnZTlCU3JJUWFzR0RVU1ZJaHRIRlZKVUJpVVNXckFNTVZXVkFZbkJCVzVHVk5IRlZKVzFvM25laUxhTWRwUkphTWJqOEZXWmxvMXZBYmxXSmxveGdBeEtyS3dDZGdRYU1ZQjhWV0psckhIeE85R1psdEhHdE1UTFZyUTM0b3l0ck1maXFreTNqaDRsVmlaYnh4cXVPWmJ4eFpkcDNxc1RMVmtaY2NCdlZZbVhzR2s2Sjc2cG1BNGhXbUp5Y3NQRDJ4UHFOYzIxdVhaMUdISC9BSFFWY2N5L3FBOFVLRjF1OGNkSDBqOFFSYm9uZ0VZYkpDWkJ2OUR2NHJwOVQvMUpmcFBtbVY3K1ZkMVI3SWlIMEpjRHp3Z0VBZ0VIeGozRXIxL1Yvd0FIdTU5eXpNYi9BTkExbFBqS2NCL1NXaW13RzBiVG53SHJndWZwWXZjeDliMGZLTXRQVTdjK0dWdjV3YnZlUzY0UXNjN0ZwYy9ENlhsZlI0WlZMOWE4czgzakxleXh2OUtjcC9BeXlmUDZ6cDdreU15Q0V0ZmxZMHVjY051QUhFcjZMbytzckdiN29mYWZuSTJkdkxjbnN4aVo5a1c3NU8zR2x4b250OVk5SDdNOXJvS1NnZTVyUTNNK0NCc2JuWUJ6dHBjQ1Q5NC9FNzErYmJtZXJLWjhaZnpKdmJ1VzduT2VYYmxNelBybmpMOXBZY2IrZnIzVXU3VHU2UG5kM0kxRkRKMUtDM1hCK25LUndlWHN5MnByYmEvSWNHakJ6cWNPMkRqdk84KzNzZmN4eGowZlc3ZlcrYVJzWjlQdHgrN2hNL3hUYy9WRDFydzV0MXgxMXJ5MWR1TFc1ekw5cWF0aDA3UnlORHNXUzNGN2FScjhSZ0FHbVRNU2RnQXhLN3M3dkx4bWZRL1V1bDgrMGRCdVp4UEdNWnIxOWtlK245RTFIU1FVRkpGUTBveTBzTEd4UnRKYzRockc1UU1YRWs3QnZKWHk4emI4aW1iYUlQNS8rKy9jMXZkenlXMWwzQnAzWm9MNWZxNnBwVHNIOUdkVlBmQ01HT2MzWTErR3duNGxlL3RmZCs3NFJEMHA4MzVYWDQ0eFA3R0dHUHNpL3JtWGJ4N1krbHZ3SHhscExwSXdObnVOUkk5cjhHNHVpaFkyRUFrYmRqdy9mL3Nuei9NTTd6aVBDSHAvTS9tUDVyZXhxZUdPTVI5UGJQMk9SQzZENW9JQkFJUGpmZjczQmZEZnhudFU5ZjNhN2dXbWx1VU1icFcyYWdxV1hDNlM0UE1ZYXlpb2pKTjk1NExjem1ob0lPSkFCSTV0dnA4OCt5SFB0ZE5udVR3aDAyZWMvblYzQzg2TzZNZmNxNFVFbGs3VzBzWm9kSTJXWitkOGRLWFpuenlPYUdoMGt6eG1jUU1NQUdqRU5CUGZ5eGpheDBSMnoydXY4eWVlYlBTZEpsME96T3JQT1luT2ZDcHVJK3I2THZ0YzJ2WWs3Zm1LZlVXdXBHN0tlaGhvd2NYRDcxWE1KQWNBTU4wTHQ1K3ZoMWQzaGg2NStwNUh5L3R4ajArV1ZjY3NxK2lJdWZmTWV4Mk9ycVBZZkFmY1A4MEt2d2o3UjIzdUphclhCZUxyY0xrTGNLT3NsZkV3UU5wWmFpU1FHTEY1SUxHREFERGI4RjJPbjJZM0ptNXFJaDIrazJ0ckxWTzdscHh4aTVudGNCNzkrODA2b3M3M05ab0cxUHczRTFsZVA0R0xzL2xkdjhTZm5QS2Y5ZWY0Y3ZnOWFyLzNxTFd0THNpN2MyZHg0WTExdy9tMVB5dTMrSS9PZVUvNjgvdzVmQjhXN2plNWpxLzNIUElPZzdwYW5zdEhwK2cwdlpIV09pdDl2bmxuYTZhcXIrcytvL3BPRGc1MFp5SEszY0JpZHVDOXZ5WFp3aktZaWI0Vy9VLzdYZWFkSCtiNWV4dWFwajcwM0V4UGRIZkVmcEw1MTJjOEV2bmU1cmZsYi84QUxVb3EzU3hSeDI4bnBSOVF2YUdrVkFPeHVHQzRzdks2bWZ2ZTc5YitUZm0vcjgvS1BPT3A2T05xcDJ0N1BHS211RVpUcG1PSENKaXBqME8vM3c3c3RaWlBHelNvdVFQNGxYVXJydk80akRPNjRUUHJBN0RFNFl0a0d6K0hldkQ2M2NuUGR5bWZGK3orYjlabjFYVVpibWMzTTFmcnJqNzMweGRWNXIwbVB5UTdGU2QwbmRraHFpaEhkZGoraTZ4UGtMS29TR0xyaHVWd0F4TE5vMjdlQzVlVGxwMVZ3Y3ZJejA2cTRQZGx4T0o0dDd2RnYwN1phelVGMmM1bHJvWUpheXBmRkhMTTlzVU1aa2VXeHd0ZEk4aG9PRFd0Sk80QWxXSXVhWEdMbW9jRVBMWDM0ZXpIYWV5MTFtOGY3UlU2bjE4MWoyMGRmZHFlU2t0RWNyWmd3R1NOejQ2cVJwWUhPd0FaK2lNY1Njdm9iZmwyVS90Y0h2ZEI1SGx2WlJxbmg0UjIvQjF4OWtmSVhXM2VIeUgxUDNXN21YRTNIdUJxS25ucmJwV095c1lNSllzakdNWUF4ckdOQWFBQUFBQU53QytpNkhiakhoRDZmNXcyTWVsOHF4aU9FWTV4OVUvcGI1WHFxb04zdk5WWHNHV09hYVNVTkdPQUQzbDJHM2J4WFpwL0IzVmRSRzV1NVpSMlRNejdaZm5VOXRlK1FiTnBTbkJ6SHRla3JCUExNME5hU2NSaHZTam1IM08xbDNLN1M5dzdKcVB0NVYxbHQxWlFVMGM5TFgyMmFXbHFLZHpwcFJqSExUbHIydXc0NDQ3ZVM4enE1ckovUXY4QWJuenZjOHU4dHhtSWpMRFBMTFZqUFpQSDYrRDdqb24zc2ZjSzBwWm9yWFc2bWZYVXNMR1JSU1hPMVdxcG1BWUNNWFR2Z2JLOG5pNlJ6aWVhODZkamFudWZkejh5ZVZaOGN0alBHZlJQRC84QVZIMVBZN1Y3NC9tNWRwbXl6WDlrYjJ1QUFpdEZvRWJ0aHhEbXVpTy9FY1ZPUnRlRGpuei9BTXFuL3dCTGNpUFJWKy9KMlgrMm41VTl5L0s3c2pVNnY3bzBrRWQrb0tsbEd5dm80dWd5clk2bmJKaStNT2MwU0E3WEZtRGNIREJvd09QUzZyYXh3bU5QZXZVenNaNDRibXhlbktMckx0ampYNmR2cmNpMTFYVWRXdnV1VGpWbmtSY1N5UjhsSlROZ29vbVBkRzVyVFQwN0dTWk1neEE2dWNFT0oyamh1WDEvbDJHbnA4UFRjKy85VDVMKzhQVnhoNVo1YnNSbHhtZC9jbVBYbGhoalBaY2ZzWmQvR2I0ZVBIYnRsMjVwNTdzSytxWi9RYWY5dExnTnBEVHNhUFVuWVBWZG5MaEZ2eER5em85enJ1b3cyTVAyczVpUFY2ZlZFY1o5RHVEOFFPeTcreWZaTzNXUzZRaUxXRnhBdXQ2R0dCWlVUdEdXRGJ0QWhqRFk4TWNNUVNONitSNnZmNXVjejNQNmd5eHcyc01ObmE0YmUxakdPUHFqdG4xNVRjejYzMHE0VjlGYXFDZTZYR1JzTnZwbzMxRTgwaHdheU9OcGU1emp5QUdKWFdpTFlpTGRiSGVUK3ZtdXRBZHdmSnVxcFovbSs0ZHdkYU5QeFN0ZUhRV1NpcUgwdFBHV3VKd2MrR0Y1ZGhzT3doZlVkTmhHM3RURjhmMHQ3MjUxbitadDdNZnM3T001VDZjcGo0ekQ1bjdlbEpxL1JIbWZvNjZWZE0rQ2ptcXBxQ1I4akhGdUZYVHlVcEgwaVRBSGh2WG5iczZzYzRlSDVENWpyMityMjUvZTB6N0puOVR0NVhqc1BqM252WUliL3dDSjJyV3k1V3lVTU5OZEdQa3h3YjhuV1JUdnd5OFhSdGMzNlYydWl5MDdzR2VITTI5emIvSHQ1NC94WXpIMXpicGcxQm9QOFI3Z1IyUXQyMUZYSFRiai93Q01sRFAwZHZIZ3ZxWXh0L09mUWJYUDM5dmIvRmxFZTJhYy9QRHEzeWFpODBkSlVRR05QWUxOZDc5S3d1YmwvcFlOdVljcEdKSWNObjJjVjFQT2Nxd3AvV25WZGJYUzU0OStWZXlIWUl2bDN5NzRWN2tQZWpVbllYeEgxRnIvQUViY0hXelZySDBWUGI2dUlnU2g3NnBqM2lQTUNNVEV4Kzhic1YyT2x3akxQajJPMzBXN3Q3V2M1N21PckhISEtaanhxSmRRbFI3d0htYzJzZFRSYTZ1cE9PVWZmcDkrUC9CcnY2ZHY4TGY5WWVYZi9hKytIWkg3WFBrbDVKOXp0UlhudHQ1QzNLTzcxY05vb05TMFZROWtZcTZWdFYwMmlubGRFeU1FNUhoeERnU0R4T0s0ZXMyTWNjWXlpS2N2VmRUMHZWN09POXNZVGhjekV4UG83Kzl6TlhuUE1jYlBkUVpiQjR5UjFOY3d1cW83eFEvS3VhQjkxNWptelk4Y01nZDlPQzlieVdKeTZqR0hyK1ErWFlkYjFtemhsKzduaG5FOThUaGxHVng5RVRIcW1YVTk4NlgzYVFiM3lPeWZ5ajhuOXRmUStZYi9BRE02ZnRIekI1bkd6amN6eG1YZTdvRFRiTkhhRXNta0l4aEhhcUNqdHJSZzBiS2FuWkNOalB1L284TmkrS3p5MVRNdndicU4yZDNjeXpudm1aOXN2MTFsd3V1SHlnOTlpK2VQdmQzVW5iZWgwbGJxK2hzZHhyYlpEVXpWTll4OHJLYW9kQzE3Z3hoQUxnMEVqZ3ZReDZYQ292TGk3bWU5NWR0Vmp1YjB4blVYR21acTR2dGlKZkY3dCs5QmFzdHp5eG5iNjB1STUxdHdILzBFL0s3ZjRtZnp2bFgrdlA4QURsOEhxSGNqOTVlN3I5MXUzK29PMldudTN0cnBhKy9XeTRXZGxmQldWajVLWDV1a2ZUOWRySldaQ1k4MllCMndrWUZiMittMjR5aVl5NzNMc2VZK1Y3V2VPZU85TXpqTVRFYWN1TmNhL1o3M0dMVU91cXE1endVazhoZTZHT0tCeEoybnBzRE9Hemd2MExHSTJOdmoyMC9yUHpIck10cnA5cnA3L3dDbmhqai9BQTR4SDJPYVhzZzJPYlVubURCYzQ4SFFXT3lYQzR2SmFYWUdmQ2gySEQ3cC9iRGI5SEZmRytiNzJ2R1o4WmZpSHoxNWxHaWRtTyt2cnY3SGNBdm5INVkvRTdnZHh0RDlxOU5TNng3aVhPRzBhWGdjeU9XdHJIRnNUWFBPRFFTQWQ1V3NNSnptbzR0NFlUbk5RZmIvQUxqYUQ3cTZZZzFuMjN1OUxlOUsxQmMyS3V0c3pKb2k1aHdjd2xoMk9hZDdUZ1J4Q1o0VGpOVHdNOEp3bXA3WDdTeXcrVmVTbm1UMlY4VmFDT3A3b3kxenErZU16VXREYktDZWVXZG9EdjhBRnlQREtmSE0zTGdaUVFTTWNCdFhZMmVteTNPTWRqczdIUzVic1hGUkVkOHk2ZjhBM2Y4QTNaTzR2a2RZWSsxbWxhT1hTL2FoNGpxL3dtVjdIVnRZNTBJUFdyWE1kc1lDNDlKZ0dCQnpIRTVjTzd0N01iVWVNeTZmbVhuV3gwZXpuczdFeG51WnhPT1dYZGpqMlRFZW1leWZRNmxkZVhlU3JxWGt1eEpKMjgwZkNSTDBXdC9hT09LamNTOE9XTFpnN2NvM0V2R2xoTGZoelVja1N4Zkh3VWJpV01rV3owVWJpV0QyWWJEOWF5NUlsbEpGanRHOVJxSll1Ymg4VWJpV2I0d1FvckY4ZUd3N2xHNGxpK1BEYU55amJKN09JVWFpVUVjQ2pTSHNRWnVianNLalVTemMzRFlvNUlsQkdCVWFROWdJeDRvTXlNRGdvMFJHSVFTalNIdEgwSU0vUlJwSkdCUnFDVUV2SDJvc01rVWpzT0tpa1JnY0VVa0FnRUZOSEZFazFVVXdZdVFhb3lFRkFZREJWbGJCOXFKTFZWRGFPS0pLa1JRR094VmxvZ3NEZ3F5MFlNQXF4TFJneDJLc3kwUkZ4amlqTXRZeGk1Vmx2R01UNktzVExaZzRxc0thTnFKTGFGdkZWaVhrUmpFclRFeTNpYnN6Y1ZYSExWZ3grSlZabDU5QlNPbElEUXE0NWw3OTIrMHZOVlZUQTF2RVlxdUp6cjhCK3hXb2RVNjJ0ejdaU1BsZTZTTmtiWTJPY1hPTGdBQUFNU3RRMXQ0NnM0ajB2Nk8rMCttNnJSL2JEVDJscTRaYSszMjZqcGFocElPV1dPbmExNHhIQU94Qzg3ZXkxWnpQcGZkN3VldktjdkY3QXVOZ0lCQUlCQnh2OTNhOHdXSDI1dTU5eHFBVEg4bFFVNHlZWTVxaTgwbE8wN1NOZ2M4WStpN1BSLzhBVWh5Ylc3eXNveThIODROMXZMSDNhRm9kOTRZbjZ6aXZheDNMbVljbmx2bnM0ZFhseDczWTM3TXVtZjYzOTF0UDAvVEVuVXVGTkk5ajgyRG9xVnJxeVVmY0JQOEFpNG5lbk1nYlZ2ZTZpZHZieThhK3QrcWVaL01QSzh1eXl4L2F5ckdPM3Y3ZXp3aTU4SGRtdm1YNUcvRDduNjl0WGF2dHJxSHVmZld1ZlpOTjJ5dnYxWXlMRXZkQmI2VjlYSUc0QTdTMWh3Mkt4RnpUT1dXbUpud2Z5bzY3OGlhL1ZycXpXV29KSFRYKzgxTlZjNnlaN1h2Yythb21jOTdpNlI3bkhGeEp4Y1NlWlhxWjUvZTlUNDdydXRuZDN0WGhVT1VYc1AwczNmMzNJdEMyaWFIcmFlMDAyNTZ4dUF3WXpLTGZRbGxJL3dEYVB4T1d0a2dPRFd1UG9CaTRiNm5kL3dBcDlaMEhtdVc1MC9LOFppL1ZISDY2ZjBVTHgzTytkK1hIYzZEc3o0dzY5N215eTlHZTAyTzRUVWtoeUgrbHZwM1Ewby9hQnpkczcyRGFEdjNIY3VUYWk4b2h4NzI1RzNqT1U5em9CN2FPZmVOZVd1a0cxMGtqWlNEeWU3UHQrdGVqRzU5K1pmSDU5Wk9XL09mcGYwQytMdWxXYU04ZU5IV0JveXViYkthcWtiaTA0U1ZiUG01QmkwQWZuU0g4cDNyejkvUFZuTXZzc001emlNcDczdnE0bW5Sdjd2M2tSZjhBVWZtbDNCaDA1ZXF5bXMrbW4wTmlpaHBhbWVOclhVdEkyS29HVjJHR0U0ZWZ1akE3eGp2UHQ5TmhNYkU1UkhZNUl3Mzh1aTZqcU5tcDVFNDNIb203NzQ3T0h3NzQ0TDMvQU1oOWVNbmNHYWt1WStGYkwrVmNQNXJMd2g4Zi9WSFVlR1BzbjR2V2J4M2p2bDdsRTk0dTFYVnpob1lIMU5RNlJ3YUNUbEJkaWNNVHVWL05aZWhKK1orcG5zMHg5RS9Gdm92V1ZzTjdncmFpTVR6c2VIZjBnOVFBZy9xdXhIdzJMR1hVWjVkN3BkVDU3MWU5RXhPY3hIbzRmVnhjczdyU2Y2U3RKV3JVMEgzNS91d3luZWZSY1V2QTI1cWFkdWZ0RmR2UDZtZU5FMTNsaU1kVmRLOXpXbHdlTThOTEF5TnBHYjdwSFVkSU1RUHA0RGczOHV5SDZENUZmNWVQWExsU3VCN0RySS9lRGRjQ3Z1K2crMVZHOE9xYVdodWQvcW9BMEU1S3VXT2tnY1NlR05QSUFNUHI0ZDNwNXJETDB2STgzNnpsN2M0Uis5SDJ1bDdXbWticytwbGJrZmdNMlU1VHRJVnQ4YnFlZzNiU1Y2WVM3cE8yZWhTMDF2cHZoKys0V0h1WDhuT0N5T3NoY3c1Z1J0amNKQi9BdlU4bTNkUFVZK200L1Q2WDZML2Ezekw4dDV6dFJkUm5FNHo5TVhIdmlIWS8yV3NjajVhaTcwWS9wVXRJMXNPWERaTk9CU3M0akQ3N2djU3ZiNjMvQUM5VXZCL3ZoNUpIVGZPbU9jUjkzcU1kcmRyaDNScHk5dVczbE0zVTNNOTFPNXpURmtoMDFwcTNhY3B2L0o3ZlRRVVVlMHUrN0JFMkliVGdUc0MrRHltNXQ5Rzg1UWRLZHg3cTN3ZVdHcGZKYlNrNUYraTFCZnRUMjF4WVlnYWUyWEtDWU1PWEU1VFRHVnJtdXhCQXdJTzlmUVk0M3RWUGczSFdYMGVXZmhsWDBmN1hjcDI5MXhZZTVtaGJSM0MwdktKdFAzcWpwN2xTU05PUDdPb2pFZ0IzRU9iamdRUmlDQ0R0WGdaWTFOT0hET004WW1PeVg2dFJUMDlaVHlVbFhHMldsbGE2T1dLUm9jeDdIREs1cm11MkVFYkNDbzI2R1BkdDhiYXp4dzcrWGJUdEpHVzZZckNidlpwTUFBK2dxcEhHTUREREV4dURvbkhBRE0wNGJNRjlCMCs5ek1ZbnZmb3Z5ejFjYm0zR016OTZQalgrMzF1TVhqVmVLbTI2L3VrZ2NRNDIyc0RjT0xnMFpkL3F2VzZUdGNQOTJOL2svTCs3bjM0ekgydzlrbnBDWGJXcnRVL2dMVzhtMDIvcVRBRnV4S05iNjkyYjB4U1RYTmxWVXhnMDlPMTFSSU1wUDNZbW1RN0J2MkJUTGhGdWJwOGVidVk0ZmltSTlzdTFmUTN0c2VNL2N6dGhwUFZQY3V4dWZyYWV6VzZXNHZvNVgwOGZYbHBtenlBTWNDUmc5eEF4MjRMNURmNi9QTEtleC9UM2wza3V6MDNUNDdPRjZZNHh4NDhadnc5TDh2dkg3V2ZoVHBqdFhxUFYwMWhySE1zOXNycnQwNHExN0MvNU9sZlVaY3dqY1Jqa3cyQXJpeDZuS1ppT0RrM1BLOXJIR1o0OElkTWp0QlhxRFVVdExTMGIyd09tY1kyQnJzR2d1MkRidDJCZDJYem1kWE5kanZBOXAzdDFOMi84TmJKTFdSbU92dkZSVlhPUnIyNVhBTmNLSmdPSkp3d2d4R3diOTNFOURxc3J5OVVQcnVoeXZaeDlUa291czdicDI3dzYyZjNiMXhlTmNPcVJWVU4xdXQ1cnFBTUVRWXlrbXU5UTZBTUVRR0FNZUR2dkZ6aVR0UEFmWjlGRThyR0g0SC9jSHpuYzYzcm94eW04ZHJDTWNZOEl1Y3A5K1V2c3ZnUDJJaTdnZDZyUEJYUWRYVE5oYU5UWHNFZmNMNDNaYmRBNDdRYzg0TWptRWJXczlWMHZOZW8wWTZZN1plMS9iWHkrY3R6UHFKanNpbyszN0k5cnNrWHpMOWlZM0MzME4yb0o3VmM0bVZGdHFZMzA5UkJLME9aSkZJMHNleHpUc0lMU1FRckUxTndQdzZqdEoyenE3ZERaNnF4MGtsb3B3QlQwc2tUWFF4QURBWkdIN3JkbXpZRnlSdlp4eHR2bVpjZU04V0ZEMlE3UFd5NHdYZTNhWnRzRjBwWkdWRk5VUlVrTFpJNVkzQjdYdGNHNGdnakVGVG01ZU04WEZ0NFJoZW5oYjJsY2JUMTd1MXBlSFcvYXpVbWpwNFRVUjNXMTE5djZETU16elVVcjRnR2s3blluWWVCVzl2TFRsRXBNekVjSFRqcG16UlhmdWhhTG84WTlWckxnNGtqRU9GUDF0cEhITnNLKzE2ZjcweEw4UitYZW0vOEEreGpoSFpqbk0vdzNNZlZEbW43WmRyZ3ZYa2YzSzFVekk1MWl0VmswODE4YlJqaFhGOXdlSE9KeHhEbzhQdTdPZTBMNS93QTIzdFdWZWwrNGIzVWE5MmNPN0dJOTdtNHZIUndVOSsvV3RUWnZHYlQyaktjdkF2RjJrcVhsaEFhVzBWSzVtVjNFNG1vQkhEWjhGMitrNFhQb2VkNW4xRTdlM01SKzl3ZFVYaWwyTHErNm5maTNVdHhnYzdTdHJjYjNkM1pDNXZ5MUgrMnlPL3UzQU4rbGVoMCsxek00aDh2dGJXVzduamhqMjVURVI5THQ3OXFLMVZ0NjFmM1g3blhHTnpSVVY5dHNkTGkzQmpSUTB6dXF4aGRpY0JpellNQi9hNC9OOXlKejB4MlErNnowNFp6dFlmczdkWXg5RWNmZTVtcnlFY0wvQUhvdGJ3V0h0VG8zVEQzbHMxYmM2MjU0Wm00RmxEYjNVN3NXbmY4QWVxMjdjTm4wcjFmS010TzVPWGhENlg1UG1mNWp0K2lNcG4xUkZmWE1PdW54a29JTzQva2RvelNMd1pJYnJxQzAwRDJ0TGdSSEpXc3p1eGFDUUEwRWs0YkF1NTFHN1VUTFh6cDU1ek4rTnZHZTkzekw1NTh3eXJhdU9nb3BxNllFd3dzZks4Tnd4SVkwdU9HT0czWWlUTlA1b1BLcXJ1ZXUrNDk3MUVHUGRKVlZjODdzeEwzWXlTRjIxeDM3OTY5SFBMaStBNjNxT2J1NVplTXVPOTUwTmU2dXJMV3hQeTQ3Y0dsWXQxb3plMWFWN1czVFQxTkI4NVR2RmZXdmlkSmkwNHNoekJ6Vzh3WGJISDZGNkhRYk9yUEcrK1lkM3lqRDh6NWgwL1Q5MmU3aEUrcWNvLzJ2ZURVVFUxVVphakVQSjNGZlJlWTlWcW1vZjJsNW4xMmlKeW1YYUQrN3ZhWVpjdFc5eHRmdUg3V2dvYlpaMnV3YnVycFgxRGhpZnZEYlNqWU5uUGd2a3ZNTTdxSDg3K2IrWi9uT3MzSmllRVZEdEpYbU9pNHJlN2hjb20rUE5uMDVVdERxRzRYdUYxVmk3QjNTcHFLb213QTJiQy9JSEhsanp4SG9lVzQzdVhQWkVQWDhoNlQ4eDFtM2hsZWk1bkwxUkV6WDB6RVJQb3Q4STlrdnlObHNtdk5XZUgxOGtra3RUblM2cDBzOStMeEZoa1pWVTVkOTdZOWhaSTNjMEZyOGZ2T3dXdXZ4dWRUb2VhZjVIVzdtejRUdzlYYkh1ZGtDODExM3hQenM3UldmdUgyVnVHcDVhRmxaZmRPMDg5d2dhNW9CZkd5SWx6WE9heHo4clRnOGpFREFIRWplT2ZZeTQxUGU4bnpucGVkc3pVOW5GL09ONWVXMi93QUd1cnJOcUNSMHQxbW1rbG1sZUFDNXhkd0RRQUFOd0FBQUd3YkY2RlBqc2V5bkZUVmpIdHFYNWtseVJMMXFwWU1Uekc1WmNzUzhaN1I5Q2pjTUh0NEZSdUplTkt6QWtmU0ZISkVzWGdmUXN0d3drYnZCUnVKWXVIRGlzdVNHTXczT1ViaGk0YlZHb1p5Tnh4SE5GaGdSc3dVY2tNWERBNEtOTTNqQXFOd2x3eEdDS3ljT0tpd3prSEZSdUdiaHNSdUVxS3lrR0JSWVNvcVhEQW9zRTRZaEZaT0czRlJZUzRiTVVhaEtpazRZaEZobThZSEZGU1JpTUVFbmFNVkZKRkNBUVdCZ0ZXUWcwaUd6RkVsYUliUmlWVWxXOUVhUmppcXl0QlFHQXdSazJqYmlxa3RHRGlpTGFNU2lTdGd4S3JNdFFPQ3JEVmc0cXNxUWFOR0FWWWxyRU1CaWpNdDR4Z1BWYWNjdFFNQmdpTFlGV1plUkczQUtzUzJqYnc0cXVPWmVRMFlBQUtzUEpwSVRJOEFCVmlYdU9qOU52cloyZ04ySCtGYWh4NVM1V2VKSGpEZnU2R29xV2dvS1Z6NG52YUhGclNkNXc0S3NPLzhBOXVIMitkTGVOdWk2SFd1cTZOcis0TTBiWDB0UEt3ZjBGcEd4eEIvOGFSdC9pajEzZFRlM3I0UStqOHQ2SFJHdkx0bjNPV0M2ejF3Z0VBZ0VBZzRHL3ZDM2tsMjg3VWVCdDM3UVhXNnh4ZHlkY1ZGdWd0Tm5qTEgxRXRMUTNLRzRUMUQyazVtUk42QWJuNHVJYU9PSFo2V1B2WDRQTzh5NmlOdkNyNHkvbmp1ZXJRTHhUeTV0aGFNVjI0enJKOHBqMU14dWFvOFhhRDdJdmtkcEx0djNMMHpOZkpJR1VWVldpMlZrMVRLSVcwOGRiVHlVZ25MM09heHJZM1NCemk3Wmx4M0hBalhXNTZzSWZaeDV4Tzl0YmVFOWtUTS9UVmZiTHZOWGt1eS9KMTVvblRYY3ZRMTY3Y2F6cG0xdWo5UVVGWFpMdFJ5aHJtVDBkZFR1cFo0bkJ3SUlkRzhnZ2ppckUwemxqR1VURTlrdXRmVmY3clA0ZzMydWsvQ2RiNmpvYkdIRTBsSzlsRFVTUlJmb3NkS1dNejRic2NvWEx6cGVIbDVEdHpONnBjbGZibzlvZnhnOXRxcXV1cWUxTDYrOWQwYjNUbTJWK283NUpHWldVUFhiVUdscG9ZR3RaRkc1OGNibjQ1bk9jMEhFQUJvem51emx3ZWowZlE0ZFAyWE11Vks0M2RkZlB2OEEzbUhwYnRyNDhVM2lqcG01UXk5M3RmVlZHNnZ0c1Q4WjZTeFVrL3piNmlRc09NZlZuaGpZM01QdnRFbUg1cFhQc1k4YjhIaStjOVZHRzNvdmpQMU90enduMDNKM1E4amJMcFdnd0pxNnlsdDBYSUdvbmJBMzgwTzU4QWZndWE2NHZrOXFKenppSTc1ZjBUVThFVkxBeW1nR1dDTm9qWTNFbkJyUmdCaWR1NWRKK2l4RkpyYXltdDFGTmNLeDJTamdZK2FWK0JPVmpHbHpqZzNFbkFEZ2hNMC9sMTd2ZDVxenV6M0IxbDNRdVp4cU5WWHU2WGlhUGJoL1RLbDhybW5NNTd2em5PM3VQeE85ZlYrV1l4b3FleVg2ZC9iRG9NZDN5dmRuY2lKeDM4OHJqeHhyVE1UNzNHM1Z0WFUwVjJtcEM0bHJIRU5jZG1MVHRCK3BlUDFHMXlzNXg4SDgrZk1QaytYbGZXN3ZUVGM2TXBxWjRYSGRQMHhYbzhINUg0akxqaVNWdzI4Vis5bys2dlpXdE9ZNFloRWwyQmUzL1V4ZHdnelFOUWM4ankxMFFPM2FOb3dWaDF0emhOdTlIeEcwdEZwRHh1MGhhNHdQMjFCSGNpY3JtRS9QdU5hTVE4NXNRSkFOdUc3YzNjT3B1VGN2MHp5emE1ZXhoSG92MjhYMGRZZDU4RDhsZmI2N1krVUhjUDhBMGk2N3VWVXk1dG9ZYlBCREV5RjhjVlBESStZQnVjWTdYeU9jZml1VEhjcUtlWDF2bGNkVGxxbktZZko1Zlk1OFlLaHVGVGNLMTc5dUo2TktOLzhBdVN0YzZYUm41ZDI1L2VsNGxSN0R2aWJVL3dDTXJhNytTcGY4Rk9jZjA3dC9pbHdkOTFmd0o3SWVCT3UrMjFkMjJ1VlRVM2JVazF4ZlZVdFZCRXhrVUZFYWFOcm12akl4TGpPN1pnZDNEajJPbTM1eHpqTHdtSmNXRzNIbFBWYk85ak16T09jWmV5WWw5VDhBN00vV1BjZlE5aWlZWkhWdDdvSHpNR1lINWUxNTd2S2NSdXdGTnQvdGJ4OUw1OXV4R0UxMzA3UDl3dk1wODIrYzU0NnNkamJ3eHg5V25YTmVNWG5seDRmSHR1WHhqM25wZmtkM0cvMFFlUDhBcmJ1bURsbTA5WXJyZUljUTQ0eTB0RkpOR1B1T2FkcndCc2NQaU42dU1YTGg2amM1ZTNsbDRSTG9hN0s5eFcyZXYwYk5VT0Q0cGFpcGpxWW5ocGE5dHlvWjNZT0J6WTRPYzBmdzRCZlI3TVh0dk84czNPWjVmdjRlRVg3SmgycmV6ejN2cnRXZG9yOTJDMUxWTWx2dWdhN3Ayb0Y3ekxKWXJnWFZGSTc5cG1MZ3gyZG1JZTdMc1ljTUJqNGZVWTFrNC9JK3E1bTNPTTl1UDFPWWE2NzIzQlQzNGZHYVR1ajQxdzk4ckhFK1crNkljNXR5amp4T2EwMXIyc2ZMbEdKUFJtREhIQWZtRnhPeG93N25SN3VqS3A3M2U4czYvRG9lb3czc3V5Nm1mREdlRTM2SW1wNyt4MHNka3JkY1hhK3Jud05JcG9LZVJsUy9nTTdnR3QrSkkreGZVOUk3MzkrUE45bnB2bDZkbktmdjcyZU1ZeC91enF5bjFSRVZmak1lTDZIVVVuM3o4VjNxZnc1cWVWWjZjTW1HTzVLVFcra1diVVA5VzlGWG01eGZuUlVNN240WnRrUVorMVAzZHVBanpFOE9leGRickpyYXluMFBZOGdqVjF1MUgrS0o5bkYzeTl2ZFZhWTExb1N6YXowVk15bzBqZEtLbXI3Wk5GSXlWcnFhZUZza2VENDNQYWZ1a2JuSDRyNGFYOVc3ZVVaWXhNZGt2MWFpbnA2dW5mU1ZiR3kwc3JYUnl4U05EbVBZNFlPYTVwMkVFYkNDbzNNVytURHdROFNCZHpmUDZrMGY0Z1hDVC9HMW5TekFnN0l1dDB3Tm03TGd1WG41K0xvejVac1RONmZmUHhmVTdQWjdYcDYxVTFpc2xPeWxzOUpHeW5wcWFCb2JISEhHM0sxclFOd0FDNDVtM2N4eGpHS2pzaDhXOXc3eTMwMTRlK010OTE1VjFuUzdqWFNDYXhhSW9JQTJTcXE3NVdSR0ttNlViaU1Xd3VjSlpDZG1WdUF4Y1dnNnd4dVhVNi9xbzJOdVp2ajNldDFjNmRsaTB4UlV0azFCSzEzNERSeHczR2FFREJ6NktBTm5jd0RESE01cExlSjQ3VjlydFZ0N1VUUGREK1p1dnl5NnZyYzR4N2NzNmoyMUR0TjhET3lkZDJnN0ZVbHoxVEFJZTQycVhOMUJmR0g4NkRyUmdVdEhpZHVGUEJsWmdkenN5K1A2cmZuZHpuS1g5R2VRZVdZOUQwdUczSGgrbng5Y3Z0YTY3Mm5UejdpUHVsZVNWZDVHNmp0WGpkck9mVFBhM1QxUS9UTklhWHA1YTZxb0NSVjFCRG11ZHRsZVd0TzR0QTRncnRZWVJFY1lmSCtZZWNaeHV6R0UxRWNIR3lYM1JmY2JiVTVSM2dyOGdPN0NMK2JXOU9QZzZYODQzdnhTOXEwLzdvdm5qOCt5NTNydW5YUHQ1ZkUwMDBmU0dJYzRNT0JNZjBsU01NZkJjUE50NmYzcGQ4R2xiMDNVbW1MYnFKb3l0cjZXbnJRM0REQVR4Tmx3d3hQUG1WMDVmZFlaYW9pZkY1Nk5PbmkrV3loMEYzMTFMcFZyV1JzMC9jYjNabU1qYTVyV2ZLM1NXbmlMUThZZ09pQWNQUXI2N290My9KaWZRL05QSU9qakR6dmVtZXpHSm1QcG1QMXVZZnMyVWtkNzdUOXdPNnJuT2ROZnRYVjlIQ1M1cndhUzJReHhRRVpUZ1A4QUdPSHdBMzcxODMxZWVyTjl6NWRuelozTnp4eTkwT1lpNnIwbnlYeWc4TXUwZmx3MjB4OTFwYmcyQ3lpb0ZGSGJacWVKdU5VWXpJNXduaGwyL3NtN3NQVmNtM3V6aDJPbjFYUlk5UldxWjRlRDFmdFA3YWZqZDJZdHQxdCtpbTNCc2w0RUxLdXFxWmFLU2JKQVM1ckdINVlOQXpIRTdOcTdXejVobnRUY1V6MGZsK0hUYnNidU16cWpzdXVGL1ErdGRwdXp1Zyt5bW01ZE1hQnBQbDZPcHFacmpXVFNFT21xYW1vZG1mTEs4QVluY0JnQUFCZ0YxTnpjbk9ibDI4TUl4bVo3NW1abjB6TDJPdHJhTzIwY3R4dU1ySUxmQXgwMDg4em1zampqWTB1Yzk3bkVBTkFHSkozTERVelRwVDk0RHo4MFY1RWQ5bVdudFBXaXU3V2FTbzViRFIzV0pyVFQzRzRUMUhWcnFpbWt3QmZFMFJ4Uk5PMEVndWFjSEwxdWcyNXhpWmwydmxyelhESGYzOTJKNFliZW42Y3B1LzhBaHIydlYvWnJZenVQNTY2Rm9aMmlXaW81TG5lWmMyQkREUTIyYVdGMjBqYjFjdUdHNDdlQzR1cTNMdDhyUFZUMVhXUmxQak11OWxlYytoZUZxU3lRNmwwN1g2Y3FKSHcwOXdwcDZLU1dFNFNNYlBFWWk1aE80Z0hFS3hOTTU0NnNaanhjVWE3MllQRmU0VHZxYXFxdWpwWkRpNGw5R2R2OGl1WG5TOEtmbDdhbjk2ZmN5b2ZaUThSS09vYlVFMThybW5ObGtOSVdram1PanVUblNSOHY3VWZ2Uzg2cjluVHhackpETksrdDYySmRtQXBONTQvNHBkbkR6SFBDWW1Jamc3SGxQayszNWYxT0hVN2N6T2VFM0Y4WXYwOW5yZExmbWZadEw5dmZJTFVtak5Ldno2ZHRsMnVOQlF5T3loNzZhbnJaSUlIUDZlTFM1MGJXa2x1ekU3Tmk5U042Y3NZeXk3WDZINXQ4MTcyNzBXT1c3TWE4cjdPRVZjMTN6M1U3VVAzZGJUaGk4VjlXNjhraWV5Uzc2amZSc2xjZnVTUlVGRkU1dVFIazZkd0ozSGR3WGk5VGxlVDg4OG96bmNqUE9lL0oyRExyUFhkZXZ2eDl6MmFRc09oN0VITmE4eFhpdkp6ZmZ6RTB0T3o3dU93WUYrM2l2UTh2ampMMXZJTjNSMW1xZXpIREtmcHVJajNUTHJDN1llV1dwZkgvQUw0YVI4aGRIU1kzM1RWZkhMVVFsNVkycXBKQ1lwcWFSd0JJWkxHOThUaU51RHpodFhiNnZHSmg0SHpWMXVyZXgzc2Yyc2VIMGVIMSsxL1Jqb0xXK25lNVdpTFIzQzBqTzJxMHZlNk9udXR2cUkzeHlOZkJWUkNaaHpRdWV3N0hiY3JpTWVLOFdZcHpZWnhuakV4MlMvVG5nZ3FvSDAxU3hzbE5JMHh5UnlBT2E1cmhnV3VCMkVFYndvMU1XNkMvZTU4VEoreFBkMjR6VytGdzA1VWYwNjJ5NEU1Nk9keE1lMDdTV0VPamNlTG1rcjFOclBYamI0VHJ1bTVHN09QZDJ4NnYwNE9yUFdjQTY3dmlWdDFucU5RM0IyUEViRkpjdUx4Slc0RWhaY2tNWlJ4VWJoNDg3ZjBsRzRlTzhLT1NHTXJlS2pjTUpCZzdIbW81SVpTTnhCQ2pjTUhEWW8xRE40eENqVENRWU8rS2pjTXBSZ2NWRzJVZzJZbzFETlJwRHh0S0RNakVLTlF5STRLT1JCMkZScE1nMllvTWxHZzRiRVdFb3JON2VDRUlVYVFvMEVFUEd6QkdtYUJjU09haXBSUWdhQ2xXUWcxak9MVVNWSWh0VlNWTjNva3RXSFpncXlvYjBGSXlwdkpWSmFNT3pCRVcxRWxjWjJxc1MwYnZWWWxxdzdGVVVOaFFhamFGWEcyWVFSaUZVbHN3N2lxNDVhSWpSaDI0cXN5OGhoMkt1T1c4YmdDRHdWY2N0MjcxV1pmcDJPSVBuRGVLckV1UWZpMzJucis1K3NhTFR0c2pNazB6MnR3YUNUdFBBTFRpeWYwVisyQjdhdW5QSGJSZHQ3aGR3S05qOWFUUlJ6MEZESTBINVlPYUhDV1VjWkR2QS9SK083cTd1N2ZDSHVlWGVYMVdlZjBSOXJtbXVzOXdJQkFJQkFJT05udVErNWYyWDl1L3RnKzhhcW1qdW5lTzV3U1NhVzBsRThpYXFjRDB4VVZKYmowcVpyOTdqZ1hZRnJNU0RodkREVTZQWGRmajAyUEhqbFBaRCtiWHkvOEFLdnU5NVY5MXJyM243MDNXUzQ2dHVqeTc3NUxZb0lXNGlLQ0NMODJPR01iR05IOEpKUGJqaEZRK0o2anFzdDNLY3Buakw0TFczK1oxVUpITy9OMkk2Mk9WUytzK1BYZlc0Nk0xRFF4c3VENkNpZFBFMmFwWXd5bUZoZUd1ZUl3V2wyVUhITGlNZWE1c1oxUlQwTnJjdUs3KzcxdTRmdEw3OXZrRjJLMFBadEVkM08zVkZyZWdvYU9tZ29kUzJlN3lVRDdoU05oQWdsa2JQQlVPTHl3dEpjV054MjdNVGl1cmxzeGZnNzNUZk1jeGpFWlkzVDN1bS9lV05HU1U3SDFIWnk3c3FDMEdSakx4RTlyWFliUUhHamFTQWVPQStDeHlmUzdYOVNZL2c5NmorOHJhSEc3czdlZis5b2Y4MFY1SHBhajVqdy9EUHRlSmRQM21QU2xQVFBkYSt6RjFxSzRFQmtjOTdpaGpKSkdPWjRvWkNObTM4MU9SNlRMNWl4N3NmZjhBcWZLTzYzN3doNXI5M0lwTk8rUFdqYkYyL2pxVEpHMjhYbW9ONHJLY095c2pkSDFXc2h4Wmk1eEw2VjRkczJiQ0hhalppTzJYUzMvbUxQOEFkaUk5OC9Cd3A3ejZiMWxUWCt2N3M5eDlRVDZzN29YNldTdHU5K3JNMlo4czJEbk5hSE9kZ0J1eDJiQmdBMGJGeTlrVStmeTZ1ZDNLWmw0L2hQNWoxM2lYNUoyUHV3M1RUOVcwOXJxSFYwbGpocURTUHFNc0w0MkVUaUtmSVdTT2EvSHB1L053OVZqS0xpblk2WHFJMmR5TTVpNmRrY0g3elZjWldaejQvd0J3YWVYOVpuSC9BTzZGeGNuMHZmOEE2bS93ZS84QVU5SThodjNrWFhQY0RzeHF6dHJvM3NmWFdiVW1vYlJjYkhSM3gyb1gxQnQ4dGRTUHBXMVRZQmE0ODdvcytjTnp0eEkzcEd5NDk3NWkxNFRqR0ZYRlhmNm5VN0ZlNm1udHNkdXF3WTZ5TUVUUnUzdGtMaTU0STVoeEsrazZUN3VFUDZjK1I5cU5qeXpwOEkvQkUveGZlbjN5OVkxbmE2bTZQanI2Q04wdFQvaTNzamFYT0kzZzREYnM0clBtZlQ2OFl6anQ3SmZuMzk1ZklzT1h0OWZqVVRIM00rNjRuampQMFRjVDM4WTdvZmhmMWIxRWQxQlUvd0FoTCtSZUx5c3ZDWDg5L210djhVZTJINk5pc1dwWXFsbVMzMU9iRVlBUVM0azh0eTFHMW40VDdFbnF0cjhXUHRoeVE4Y3U1MnV1eXNGYnJHam9wMjFFTkhPeUZuM281VEpKRVkyWlFQdmdnbkhkc1cveTJjUk16RlJEcVQxK3hsbkdFWlJNelBkeGRvT2svd0I1WTBCYjdIUjJPMzlsTDVGUVVVRVZKQTE5NGhjUkhER0kyZ241TVluQUxvOHA5MWg4eFlZeEVSaHdqMC9xZnVSL3ZKMmk1RzV2OURsNkgvYXNQK2FKeVd2Nmt4L0I3LzFCMzd5Ym8wYnV6bDVQL2EwUCthSnlUK3BNZndlLzlTSC9BTHlqbzVneC93QkRWNlAvQUd0RC9taWNrL3FUSDhIdi9VOE9zL2VhTkhVZ0ovMEszdDJIL3dEVjRSLzZJbkpQNmt4L0I3LzFPQmZ1Tys0M1YrZnZrZForN1ROTFZPa2RKV0t3czAvUjIyNFRNcVh2cWZuNXF1U2ZyTmpqeHpOa0FBRGRtWDEyOXZwY0lpYWx6K1Y5YnQ5WjF1TTU0L2RxcW5qM3ZkT3dQdVZVM2hqM1kwWjNPWm8rZldsc3A3WGNKWXJmQlhpM3RaVTNDR09sWktaeFRWWUxvNHhNMHREZjA5NHcyOS96U2RXT0dQb2ZEZVdaYm5SZWE5WG52UnF6amN5eDhPeVo0OW5aTVZVMXg3WEtPTDk2SHA1R1p6MkpxeDZmMW94Lys2RjR2SjlMN0QrcGY4SHYvVStSZWIvN3c1ZS9KenhsMVo0ODZZN1JWT203bnFxbWh0MzQ5SnFGOVkybGpGWEZOTGpUc3QxT1g1NDJPai94b0F6WW5FREtkWTdWUzYzVitmYzdibkRSVituOVRodm9uVWwwdWRaYjZLeFlTVmR2cWFHclpIbURBWXFhb2lNZ3hjY0IreURzUHlyNkRvOGRXTlE0UExQT05ub3RqZG5leXJDY1ppL1RsRXhIdnI2NTRPU1haWHo1MUo0STk5Ylo1R1dDdy8xb3MxWFIxbWxkUldPT3FORkpWUVRnMVZLNXM3WTU4am81b2c0a3hPeERjdXpFRWVWMWUzeGVmNVg1aFBUNTZxdnVweVdqL2VncWFTUFAvb0txeDZmMW8vOEE3UXVseWZTK2cvcVgvQjcvQU5UMVh1OSs4dTZaN2g5dmIzMjMxWjQ5MVZmcGUrMFZUYXErQTZxYUM2R3BpTVRpMHlXV1JvY01jV2t0T0JBS3NiVmQ3RzU4eFJuak9NN2ZDWXJ0L1U0UCtQZXJMWmYrMVVWYkZRR2d2akpwYWE2TmthUTZXb2p3Y0pNWERhREc1aDVBNGdibDlmNWR1Um50UjR4d2wrTGZQdm1uV2RkMWtUMU81T2NZNHhHSGRFWTlsUkVjSTR4Tjk4OXN2WVo1V2w1STRuRmQ1OFJTcVdvYkc4RWJ3cVU5cDAzZjJNeGdtY0RUT2E0U3RKd0RvOHB6dE9INnpjUXVuMTgvNU9UMnZsMlAvZTdmMC9WTDF6eDQ5ejd5NjhFcmxQb2pzaHF2NTd0VEROSjBOTDZuWjgvUXdCOGhrSWhEc0h4NHVKSk1UbVk0NG5FN1Y4amxoRXYyL3BQTTk3WWlzWjRlSGM1RVVmN3kxNWJQcFd4eTZVMHk2cDJCMGdqcmhpZU9BRlJnRmprdzlIK29kM3docWYzbHp5NmhnREtiU09rWHlZNG1Tcmd1cnpoeXdocm9nRTVNSDlRNzNoajcvaTlXMTMrOGVlZkdxSUhVdW1LZlMybXBYUnZnYlVXeTJUenVhNTRJRXdGenFLdHVkbThBakx6QlY1VU9QUHovQUg4dXlvOVVmRzN4N1FmZVB1RDVDZHdqM3E4aTlTMXVzTmZRdnBLR2lxYnpLWktlaWhNaldTZkx3Z1pXRVJnN1c0YnljQVNTdWZhd3ZLSWp2bDRQWGRibk1Ubm5OMUUrNStOMzU4bU5mNkV2MWtyTkROcHFpOS9pTUY5clk3aUJMVHpNb3FsdFRIQk5HNC9mamtsYjk4RTdRTU9LOXJ6VGQwNHhoSGUrRytVdW0xYjA5Umx4MHp3OWMvcDczMmkzL3ZEbnVXVE1CcVhhYXpjU0xaR1Avd0I0dm51VkQ5VS9uL1VlTWV3cjErOEZlNWJjNktXMVcrZlQwRlZVc2RUeHpRMjZKc2pIU0RJSE1jNStBY0NjUVR1S3ZLZ256N2Y4WTlqaTczcjFSTHB1NjBXaEdQYVo3SGI2TzMxY2tKSmJKV3VpK2FySDRrbkhOVXl5TG4zSXFhZlA3V2V1TlhqTDVzL1Z0V1pzMlk0WTgxeHVRNi9YMTBsQXROdmt3ck9tNlJ1SndHYkE1TnZEYUVjMjN3aVpjMSsyUHYzKzR0b1hRdG0wSFF5NmVsdFZrb2FTMFVzbFJib25TdWhvNEcwOFprYzE0QmRsWU1UZ01Tc2NxSHFZZWViK0dNUkV4VWVoKzNWL3ZESHVSeHN4aE9tODMvdXlQK2NVNVVOZnovcVBHUFk5QTBaNWQ5ek83ODJ0KyszZWwxTEZxcTZYQjF5cVhVT2FLbC9aMExBL0l3bDViaTVtWWdFN1RzQUd4ZXYwMmVqWm4xdUxwTjZzOTdmbjlyT01ZOWwvR0g0L2laN3pYbk40bjlwS1RzdjI0a3NqdEhVYzlUV1JHNFcrR2FvNmxYS1o1QzZWcm1GMzNqc3hHd2JOd0M4bkxDSlRwL050M1p4MDQxWHFmWUtYOTRjOXd5Vm9MM2FkeC84QWRqUDV4VGxRNS81OTFIakhzYXUvZUZQY0t3eER0Ty85MnMvbkU1VUg4KzZqeGoyRS93RGVGL2NLYkdCbTA3bU8zSDhNWmo4UDhaZ25LZy9uMi82UFl3cVAzaEwzRmFtRjlQVHo2ZWdsZTB0Yk0yMXhFc0pHQWNBNXpoaU9HSUk5RTVVSDgrNmp4ajJQbm1yZk5Yekg4djRwWGVUWGRDNVM5czZHS1IxWmFiQ1liWFNWTFhzTVJaTEhib1lZblptSEw5NkluQnpnQ01UanZEYnVhaUhtOVg1cnU1eDkvTGg3dlpEaTEzMzdsMnVrdTlQWTlOd3NvckhCRzQwdEpFWEVSeHZlUUFTNGtseHk0dWNTUzRrazdTdlQzcTI4SXhoeWVROWJNZE51NWQrNW5FZlJqSEQ2NWZiZmE0OXdDTHdROGdKZTgyb05IVjJzYlBQWXFxelV0SmI2aGxJWWFxcXE0WkRQMUpJWmdRSW9uTklBQkpjTnVBSVBsNTQ2blo2VHI0NmZkMVRGOEhZdlEvdk5Paksxb2Qvb1d2YkNlQnU4Si84QVJGeGNsNjM5U1kvZzkvNm5tajk1UTBZUmovb2J2UDhBM3REL0FKb25KUDZreC9CNy93QlJPL2VVZEhOM2RtcjBmKzFvZjgwVGtuOVNZL2c5L3dDcEQvM2xiUjdHNWgyWXZSLzdXaC96Uk9UNlQrcE1md2UvOVR3SzM5NXkwaFJuRC9RbmUzY1AvWEVBL3dEUTA1UHBYSDVreG1mMlBmOEFxZE4vZEx2ZmR1NVd2Wjc5WE5INHBWek9sZkRBSFlkUjdpNHRZTnB3eDJCZWp1N25DSWRmekx6Q2QyTWNlN0dJajJRNTdlMjE3NWsvZ3g0MVVYai9BRmZaNnQxSmNJSzJ0dXRWZXhmelF0bmtxM2pLRzAzNGJQa0RJMk5iL2pEaVFUc3h3WFJ6MjlVdXYwUG5VZE50NmRGOGI3ZjFPUS8vQU9aL2p5Wi85QkZiankvck9mOEE4SVdPVDZYYy9xWC9BT24vQU1YNm5CYjNUUGRjdTNuUjNDdFdxenBTWFJObnRkcWl0RWRxbnJ4Y1hTeUNzbnFKS25yZkxVcEFjSkdNeWxod3k0NDdTQjZIUlk2SW1YcGVXK2J6bnpOeXRQQ01lMi9HWjhQUTRtMFBjMXRjWFV0US9HQ1FGanhqd1BMMVRkenQ0ZldkVE83TTI3SWZidTkvdnVMNGtlTnRyOGVPNFhiV3AxekRZWjZsbGx2Ykx3NjJ2aXRzenhOSFN2amRRMWVmcHlPa0xYNXdBd3RZR2dNQlBSeTI3azZQenllbncwVGpxcjAxOWt2dmp2M251TU16anNSV24wL3JPZjhBOEpXZVQ2WGEvcVgvQU9uNy93QlRpaDdwSHZJV3J6eDdaMnpURGUwMVRwRFVWb25sa0Y5bHZRdUxIMFU4ZUVsTytIOFBwVGoxR3h1YTh5SExnNFpUbXhIUHNScGw1L1grWngxVmZjcVk3N3Y3SWRZV3FLOXRUTTl3M2trcnRPbTlZcUNNU2Vha3VURjRreEdiNExMa2hoSWNBbzJ3bUlEVkhKRHhubFJ1R1Vod0NqYng1VHVIRlNYSml5ZVZHNFlPTzBsUnVHWk9BVWFZeWtiQnhVbHJGaktSaGh4VWJoazg0QkdvWktOcGtLRE1uaW8weWR2VWJoRHQ2amNKZWNHb01sR2lPd0lKUnBFaDJvTTFHa25hVWFKUVM4OFVXR1NLUjNxS1dQNVVDUlFncHAySWttcWk0amdjRUdpTWdIQTRvTFZaWEdkdjJLc3RFRk5PSVJKTUhBcW90aHdLTXRBY0RpZ29IQTRxc3RRY1JpcTQyc1oyL0ZWbFNEU000akJWaVdzVHVDTXkzalBCYWhqSnEwNGhHVnRQQlZKYnd1eEdDckV0NHp3VmNjdklqZG1iOWlyamZxMlNZUnpOZHpWWmx5bThDUElpMmVQL0FIZ3MrdmJqVHRxNlNocVlLcVNCemcwU05qa0R5ek1RN0RFRERIQTRKUEdIRG5PbUw4SDlFZWlmZkc5dGZWV2w3ZmU3cjNBYlo3MVZ3UlQxZHBxN1ZmSnBxT1o3QTU4RDVLV2praGVXT3hHWmppRHdYUm5ibDlGaDUzMDh4RXpsVStGVDhIN1RQZVg5dE40eFozUGdJLzhBYytvdjh4VGx5MS9PZW0vSDdwK0FQdkxlMm8zZjNPZy83bjFGL21LY3VUK2M5TitMM1Q4Qy93RG5NKzJsL3dEOVBnLzduMUYvbUtjdVQrYzlOK1AzVDhIZ3plOWY3Y0VVcm8yYThkSXhwSUVqTFRkc3JnRGhpTTFPRGdmVUFweTVaL25uVGZpbjJTeGw5NzMyM0lSakpycVFELzNUZGY1aE9YS2Z6enB2eFQ3SmZFUE12OTR3OFlPMy9iYXJ0UGlhNnExaDNydUVicWUxVDFGQk5UV3lnbWVRd1N6aXE2YzByeGppeU9OaGE0ajd6aHVPc2RxZTkxdXE4LzI4Y2Y4QUw0ejZ1RU9tYnZacWZ2RjNYMTFkTzhQa0pYVk54N2lYbVYxZlZPdURnNmQwanhzTXJXNE5ZR3RBYXlOb0FZMEJ1QUF3SFlxbnlXNXZ6dVpUbE0zTXZnK3ZYelRUdmR0dzJvekQwU3VMMnZPS0NMWmRLaW1yNFdzZGhpOWd4K0xzRnJHZUxlT2RRNWY5bXU3cytwTFVPMXQvbGZKVW5NK3pUUGNNSThzWmU2QWwrMEFodUxjRHYyY1F1MXY3ZDhZZVZ0NTA4Qys2cHVsbHI1S1NmTUhOY1FmaXVtN3NUYnd6M0VyRCtrVUdGUnJ5c2xQNTV3NGpFN3djUnVRYldQdUhYMGRlMlFQSXdPL0hnaE1XKzBXbS93QVBjYlJzbHFxam1xUXc1Q1R0eHdXblduN3N1UE91QmQ5RGFrK2RwZ1JQVFNaaXc3R3lORHNTeDNvNGJDc3Uxak53K2dXWFhkVlYycW5xaklYaVJqWGlRNERPQ05qOEc3Qm1HM0RoaWxzU2RacWllY1lGMzJwWmI1cDNMcHBLUzdzdmNRd3BxcjdrdUc0U3RILzBtajZ3VjZmUmJ0eHA4SDlCL3dCcHZtSG5iR1hTWno5N2I0NCtuR1ovOHMrNllqdWVUMjVjSmF5V3FPNWpBMGZGeC8yRjZ1dmhUby8vQUpBK1phUExlbjZlTzNjM0p5K2pER3Zyemp1K254OTBqbDRjRmwvSk13OHFtcVRHUVFkbkFxdU9ZZnFVdDIvWk9oa1A3SjdTeHc1aHd3TzlKaTRxVXhtY01veWp0aDZzN1UxWGFxcVNqZS85cEc0c0pISEE3L3BYemU1aG95bVBCK2g3RzdHN2hHVWQ4UElaM0FxbWdETWRpdzVsZjZSS3Y5WW9FN3VGVnVINXh4UWVMVTYxcUpjUVhIYWc5YzFuZjZpUzB1cUduYkU1c2gyN2NNY3AvaFhKdFRXVHYrVjczSzM4WmZydjFUTmV1MUZtdXhKZE5icWlvdHozN2lXdi9iTUJPRzBBYkJoc0h4WG85WmpxMjhaOEpwUG1iYWpaODUzSmpzM3R2RGMrbUkwejdaaTV2ajlGUHlSckNkb3dEamg4VjVicFU4YXIxTFBQdEx2aHRRcDc5NDkzS2FhOTF0YS9Fc2lpRFE3azU1Yi9BR2dWNzNsdlpMNUQ1bTZpY2RubHgrOWw5Vi9iVDJidkxlcG1hUXF3MTJ4a2xQT1BwbExPSjV1WFU4eDI2eWR6NWU2dm03VVJQYkhEMlBrck5aVHRiaG1LOHg5SFRDcjFQTk8zQXV4UXA5UzhjYndIYWJ1TUpKemlxRHllR0RvbWorMHZlOHBuN2srdCtlL09PSCtkaFA4QWgrMTlBZFdnbmZzWHJXK1EwQVZqVzdjVXMwTm9ybEsyR1dXSitYcHNMeWNjTVJpRzRmYXVsNWhQK1RsK25lOXI1ZXcvOTVoUHIrcVhGSHVMcVdvYnFTcWt6YjVuNGJmVmZMdjFmRitEUzYycnFWNGV4KzBjOW8rbkZWcGMydXEyZHhlOS93QjQ4dGdRT2cxUlZWRlMxcGNTY2VhZzVIOWdydFUyM1NFTlp0RHBKSjNrZzRIRDVaOElQMFBrQzduUTRhdDJIaGVlNzNMNmZPZkdLOXN2UWUrdXBwcTNYem9NeElwWUlZUU1SZ0M3R2JjUDdzTGw4eXl2ZHJ3aHdmTEd6bzZXL3dBVXpQMmZZOVdpMURVTUdHWS9XdlBmUlU5bzdOVlUxOTdvMldDVnhGTEJVdHI1aUNka2RHRFZPeEkyN1F6RDZWeWJPTjVRNjNWN25MMjhwOUQ4YlZXcTZqVStvSzYvMVJQWHJaNWFwd084R1dRdncrakZZeW01bVhKdDRhY1lqd2grWDF4amlzdHZ3N1pkWkszVU5aV05KNmNSNkxOK3dOSlpzeDU0RXF1VHVmdndYK2VJYi90Um1sblVWUklRMEVsM0RiaWxEM3JYZXI2elJIWmFoMHBTeUdPNFhTUTljY2VtQVhUNEVmeGkxdndLOURxZjh2Ynh3ZFhvZW81bTNNeDJaWlRQMVl4N29mS29yL1VSbkVPWG11MjhpUFYxWEh1ZDlxQy82NTF1N05zK0tBL3JuV2ZyZmFnODJ5M3V2dU5TeUtNa3ZlUUFNZVoyS3BMNnpxYTlmMVMwVlNhUWpQOEEwaFVaYXFzd08wQWJXZy9UdFhmNkxhL2VsNFhtZS84QXV4M3VQT3VhMnUxUjNRZmE2Y2tpTVF3WTRmbWpJSHVKK0dZcmk2ek84NjhIcitXZmM2ZVBUY3ZvMXB1SXRkUEhTVStMWVl3R3RCUExtdXE1Wm0zN0ZOck9vaEdBZVFnOGthL3F3TUE0NGZGQWY2UUt6OVkvV2dUdGZWYmhnWEg2MEhwSGVEdkpVMlMwaTBVYnorSlZqWEF1Qnd5UjdpZmlkdytsY21FZDdzOU5qRjZwN25xdmJDbXFCLzhBNVJjbW5xdkJiU05kamlHbmUvYnpHd0xFemJPOXVhcGUrVStxS2lQYUQ5cWpycHZuYzBXRzJTWEdzY2Vrelkxb08xempzQUMxaGhxbW5ZNlhwNTM4NHhoOE4xdDNGdUYvcjVhMnJrTHBubkViZGdIQUQwQzdXZVVZeFVQYjZyZHh3eGpERGhFUDJlMFZ2ckx3L3dESExnMTM0YkM3Q01PQndsZU4rL2UwSGZ6M2MxMUpsNDI3dTl6NnpSNm5xSU5nSit0UjFYbUhYTXpHRnozRU1BeEpKMkFjVUh6THVWM1VtMUZOK0cwRHlMVkdkcmdUKzFkelBvT0gxcm53d3AyZHJDdUwwT3RySFNrazdsdHp3L09uZmk0bmdGbVhMakR4WG5INHFPU0dNcnNTbzFEeHAzWXV3NEtPU0dEeW81SVl5dXhPQ2pVTUhIRTRyTGtoaks3N3ZxVkc0WXVQQkc0WnlIZ29yQnh4T0tqa2lHVHppNVJwbElkdUNqVUlScG04NC9TaXd6ZWNBbzFETW5pbzJoUnBFcnVDTEROUlNjZUNMQ1RzMm9yTjVVV0VFNEJGU28wRHNDREtROEVhU2dXT3pIaVZGU2loQUlHMDRGRWxTcUdEZ2NVR29PSVJrMEZOT0lWU1ZOUEJHWmF0T0l4VlJUVHRSSk5FVzA3RldXZ09JeFFVMDRoVkphUm5FWUtzUzBhZUNNUzFCeEdLcUtZY0NpUzFhY0Rqd1ZZYk1keFZabUd6SEQ2RlhHMEJ3T0tEU040QlZZbUhrTWVONFZZbUc4VW9Id0swNDVoNWxKVWRNZ2o4MUdKaDdGWk5UT3BDTURoaHV3VlltSDMvQU1mdTl2YnE3eXdhUDdpVytsL0ZDR3cyKzV2YUl4SmdNcllaaTBnWnVEWG5mdVBBcVREek9xNmVZKzlpKzd3MEhiVm93Tm5weHpCempEN1ZoNStxV240YjJ6LzlqMDMvQUlYNVVOVXBOczdaL3dEc2VtK3AzNVVOY25IYisyc1R3OXRucGlSdURtbHc1Ym5FaERWS0txbDdkeUFqOEZvdjVDUDhpR3FYajJXbzBkcGE4eDNxejJpamhyV09EbXpNcDR1b3d0T0lMSFpTV2tIa2pPVXpMeWU3RmlwZTRsa2RmcllBYTFyY1pHdDQ3TjYweGhscG1uR0hXK21wWUpwSXBXa09CT09JV1hhaVh6ZStXcDBFaHhHeEczaFdMVDAxeHVzY3VHRkpDOXNramovRk9PVVk4U3VYYXcxUzQ5ek9vZlFxYXJramUyV0p4YkswaHpYTkpCQkJ4QkJDOUI1MHcrdDFWMW8rNnVrMjZsaGRHM1Y5TUMyNjBrTGNnSDNpR3lzYmorYTRZRTRianM1TG9iMjNwbjBPeHM1OXoweVRORTh4dnhEZ3VGMkU5UWMwVXhMbGNIQTdRZytnZG9kYnZ0RnhaRkk3OW1TQjhSdXdWY1dlTnYyL0lqUzFxdUZyaDFKQkl4aHFCbERTUUM5Mkg2STNuNkZ2SGJuT2VEaGplamJqaTlEMGlZNk9nWloydUpFVGZ1RW5IRUU0bjdUc1hQMUd4b2lKaHc5TDFVN21VeFAwUDJOdk5kU25lcDRPb2JUSGViUFBiM0RGN21reG5aaUpHN1duYjZyazJzOUdVUzl2NWQ4Mnk4czYzYjM4Wi9abmo2Y1o0VEhzOTlTL0k3Y3NkRGFwWHlqQ1l5bGhIOXdBUGh2Slh2WTVYRDEvNzMrYXgxZlg3RzNqTjQ0YlVUSHJ6bVo5ZlpHUGI3UEgyYUtxYzMxQzFiOFNuRjVNVlkwOGNEeUt0dU9jWGtSMUdHNDRIMFZ0aWNYcnV0SUhzcm1WekQ5MlZ1VjM5MHpaL0Jndko2L2JyS012RjlSNUh2WHR6aDRUOWI4WFBKelhRcDdnenljMG9HZVRtbEF6eWMwb1lYS0I5ZGJwNk1uSHF4dllOMjh0d0cvMVZqZzFobE9NeFBnOWgwMVo4ZkhtRmp3VzFiMm00dXhHQko2NWNDUVAvd0JYZ05xOXJkdzFkUDczZ2VhZVpaYi9BSnhxbWJpSWpDUDRmK2EzcE8zbXZFZThQcFFmVk93VVFvN0ZXMXgzenpoZ1BwSEdQeXIzdkxmMkxmQS9NczN2Umo0UjliMkR1YXdYRFJkZXdBT3lST2tJMjdtZnRBZG5JakZhOHcyOVdGK0RqK1hkL2w3K21lekw2M3d2YnpYejc5Q0czbWcrcStPdFlZYmRkSVRobDZzTGh6eExYQS93TDJ2S1o0WlBpUG0zQzg5dWZSUDJQcEh6dzVyMXJmSWFCODk2cTJhRXlWNU1UMk1kZ1hOTFNNU0FjZWVDNi9VN2ZNd25HSGY4czMveSsvam5QWkhhNHFkem9LcWwxSlUwOVpHNktvRWp5V3ZCQndKT0IyOEY4dG5oT00xUGEvVmRqZHgzTVl5eG00bDZ6amh1UnlqRTgwSDZHbTZhYXJ1TElhZGpueW5IQnJBWEU4ZHc5RWlMbG5QS01ZdWVEay9vdWlObTB2YjZLb1prcllJM2g3VGhzZEs0RS9UZzBmYXZjNkRwWjIvdlpkcjRMejN6UEhxSjBZY2NZbTVueGw4YzE1WC9BSW5ySzVWbU9JTTcyQTRZYkl6MHg5Z1hsZFZscTNNcDlMNjN5dmE1ZlQ0UjZJOS9GK1Q5SzRIZmUrOWhJbVU5M3VkNGt3SmpwZmxJOFFDUStwZU1TTWQzN05qeHM1cnYrWGJlck8vQjgvOEFNVy9vMll4anR5bjZ2MGg3NjkxSU4wYlA3MEwyNmg4VkU1ZUxHUjlOL3ZiZjcwS1ZEY1RsNHkrRFJXNTF0cjYrQ1gvSGZPVlRYSForak81dkQ0TDVyZWlzcDliOU02WExWdFlUNkkrcHI5SzQzTS9VMGJiRzNUVUVNVW96VTBmN2FVSGRsWnV4K0p3QzdIUzdldk9IUTh6MytWc3pNVHhuaEgwc3U3V3BmeHZVM3lVYmk2anQ3QlNNYndFZ09hVS8zeHcraE9zM05XNVBvYjh0MjlHeGpIb2VyNXd1cTd3emhBWndnY2Y3UjRhRUgwTHRUUjJ1MTFYOVliM3RwNllHU0tIOUthUVlZTmI5SjIraTV0clp5em5nNmZWZFRqdHh4bmk4eS9YNnF2bHlsdWxjUjE1VGpnM1kxbzNBTkI0TDJNTVl4aW9mTjdtVTU1VE05NzBYU2xzZkxlTG5xbW9CNnRYUEpIVGwyL29zZmxCK25BZlV2SDNadktaOUw2clpqVHQ0NCtoN0JtZU54WEhUUXp5YzBvR2VUbWxBenljMG9aVnRkOGpUdXFKSGJCc0E1bmdGckREVk5NNTVhWXQ4NnVObHFkY2R3Qjg0U2JWU3hzZlV1RzdFdUxoSDlJdytoY20vd21vY25UNXpHSHBtWHZjZlRpamJGRUEySm9EV3RhTUFBTmdBQVhBRytaakdsNzNZTUF4SlBBQkI2UnJLNE8xSEhMVE5jVzB3QkVJSjNPRzV4K243RjNkdkRUSHBYWjNzc000eWg2Tm92UnR3MXJmRFN2eGp0a0RnYXliZmxHUDVnL2pPd3crMWRiUEoyOTNkZmE2T2xvN2ZTeDBOQ3hzVkpFME1qallNQTBEZ0Z4dW0xNmc1b1BTKzRPdFd5aDlodGJ6a0JMYW1WcEl4SS9RSHB6WE5oajN1YmIyKzk2VkpNZUpYSTdFUThlV1hEYWQ2bHVTTVhqU3k1dG5CWmNzUXdra3cyY1VhaUdFc3diczRyTGNROFo3OGNTVkhKRU1wSkFQaW8zRU1KSkJ1NHFOeERGemdBbzVJaGpJOE9PUEJSdUladUkzbmNvMHhsZU5vNGxGaUdMM0FEMVVja01uSERhZDZpc2ljU281RXZPQXc0b01uSEVxTERPUTRsUnVFT1BCUnVFazRERkZZdU9KUllKUlVrNG5GR2t2T3pCQmtUaVZHa3VQQkZnbEZKeDRJc01uSEU0b3FYYnNFV0NkdndVSUpGQ0FRQ0N3Y2ZpcXlFRnh2QTJGRWxvaUdEZ1ZSUVBFSXl0ajFXVmc4UWdvT3gyRkVwUUpDcUxhL0RkdVJsYlhjUWd0cnVJM3FzekRScndkKzlWaVlhTWZnVldhYUFnaEVVMTViczRJa3cxWS9EYU55ckZObzVPSVZabUd6SlBxVlltR2dQRUlqU09RamFxeE1ONDVjZG9WWW1HOFV4RzdkeVZjY3c4aU9kdzJ0T3hWbVlidzEwcmVPeFZpWWZmdkhqeUZxYm02SFFPdGFrZlA0Q0syVjh4MnluWUd3U09QNlg2cE8vZHZ3eGt3OHJxK2xyNzJMN1d5dWwzRjJ4WWVjdjV1WDlaQWZOeS9ySUExTHora2drek9kdktEOWJTbXBuMmFyRWN6c2FKNXdjMDdoaXJFczVZMi9JN3o5dEtXNVVoMUxaR0IxUElNWkd0NEZKWGJ6N25ISFdsQlNVVllhT2IveWplV2plQjZyZTN0NnZVN0Z2ejZhU09GZ2pod2F4dXdBTHVSd2NPV0x5b3F2RGV0VzRwd2VkUVhlcW9waFVVY3I0Wnh1a2ljV09IMHRJS3ZhNDV4ZWIrUDNHYzU1WlM5M053YVQ5ZUN4eWNaN2ptWlIzdEdYYXBPOTMyRDhpY2pEd1NkN1B4YlIzR1IyOTMyQlhrWWVEam5lejhYbDBkMnE2VjRrcDVDMTQyZ3QyRmFqWXc4SEhsdjV6M3ZKa3U5VlhTQ1d0bWZOTmhselN1THpodnd4Y1Z6NDFIWTZ1VVRQYTJwYStTQ1FUUXV3a2J0QjMrbkZNb2pLS2xqR1p4bTQ3WG5NMURjRHZrLzhGbjVGeC9sc1BCeXoxZTc0KzZHMGQ5cXorYy82ZzM4aXY1YmI4R1o2emQ4ZmRCdzFiR2tsdXd1SmU3MUxqaVZ6NHhHTVZEcmRWdmJtL2xxem01cUkraUlxUGM4cUt2dzQ3RnUzVW5CdkhXdE85VzNIT0RlT3NQQnl0c1RncWQxUFd4ZEdzWm5peEJBeEkyajRMT2VHT2NWTGV6dVo3T1dyQ2FsRExSWWp2aCt0OG41VnhmbE5ydyt0Mko4ejZqOFh1ajROVzJLd08vOEFFLzhBaHlmNFN2NVBhOFBmTE0rYWRUK0wzUjhHamRQNmVPK25CLzR5VC9DVDhudGVIMXMvelhxZnhlNlBnMFpwelRaMzAzL0tTLzRTdjVQYThQZkxNK2JkVCtQM1I4R2pkTmFYTyttLzVTWC9BQWsvSjdYaDc1Wi9tL1ZmajkwZkIralQwOXRndFFza1VZYmFoRjhzSWNUaDA4dVRERW5IZHh4eFhaMHhwMDkzWTg3TGN6blBtWDk2N3YwdnpXOXZ0REgvQUprUDVhby93MTEveVcxNGUrWGUvbkhWZmo5MGZCVGUzbWhUL3dBeHhQOEF3MVIvaHEva3Rydzk4cC9PZXEvSDdvK0Q5cXlVbHMwOVJmaDlvaTZOSm1MOG1aN3Z2TzNuRjVKWFkyOE1kdUt4N0huZFR1NTcrV3JPYm42UHNlVFUxRlBYVXNsRlZ0RDZhWnJvcEdISDd6WERLUnM5RnJLSXlpcDdIRnQ2dHZLTXNacVlmaGp0ejIrNDIvOEE1ZXAvbkYxdnlXMStIM3o4WHAvem5xL3grNlBnb2R0KzNoLzVoL3k5Ui9PSitTMnZEM3o4VS9uWFYvajkwZkIrbHAreDZjMHYxdndLRG9kZkwxZjJrajgyVEhML0FJeHpzTU14M0xtMnRuRGF2VEZXNmZWOVh2ZFRYTW02N09FUjIrcCtsK0lSODF6VzZmTEg0aEh6U3psajhRWndLV2N0aFh0dGQwaUVGenA0Nm1FYlF5ZGpKRzQvQjRJV2Nvakx0aTNKdHpsaE40ek1lcCtZZEc5dlIvMUhiLzhBSTZiL0FBVng4amIvQUF4N0lkbjg3MUgrcGwvRktUbzdRSEN4Mi84QXlPbi9BTUJPUnQvaGoyUXY1M3FQOVRMK0tmaTh5aHA3TmFRRzJxa2dwZ0JrSHk4VWNlRGNjY1B1QWJGdkhISEhzaW5EdVpaN243V1V6NjV0dSs0dTVxMnhHMi9MbHN1bVpIbVI5dXBYUGNTWEUwOEpKSjNrL2RYRk96aCtHUFpEdVk5WHZ4SERQTDJ6OFdickhwYmhicVgvQUNlTC9CVTVPMytHUFkxK2IzL3g1ZTJXbExGYTdZMXpiZEJIVHRmZ1hpQ05rZVlqZGpsQXhXc2NjY2V5SWh4N21lZTUrMU16NjV0VDY4YzFxMll3WlByeXBiVVlQenA3YllacEhUUzBWTzZWNUwzdU1NWmNYRTRra2tiU1N1S2RyQ2U2UFk3ZVBVYnVNVkdlVVJIcGxnKzE2ZUgvQURLbi9rWS95TFBKdy9ESHNja2RUdmZqeTlzbERIYktKNWtvb0k0cENNQ1lZMk1KR09PQkxRRmNjTWNleUloTTl6Y3ppc3NwbjF6Ync1N1ZZSlh1bGZRMHhrY1M1em5ReGtrbmFTU1FzenRZVDNSN0hMajFHN0VWcnk5c3ZIZlo5T2ovQUpqVC93QWpGK1JaNVdINFk5amtqcWQzOGVYdGxqSmJOUGpkUlUvOGpIK1JUbFllRWV4dU9vM2Z4NWUyV0VsdXNYQ2lnL2tZL3dBaW5LdzhJOWpjYis3K0tmYkxQNWExUUhHR0NKaC9pUnNIOEFUUmpIZERYTTNKN2NwOXBTVm16QnV3TFZwR0R4NUtrYnljU3BiY1l2SEZVeW1qYkJEZzJKZ0RXdGFCZ0FCZ0FGMTU2ZkR3ZDJPcTNmSDZtVWwwbkg1cnZzQ3orWHc4SEpIVTduajlURjkzcTI3YytIME4vSXArWHc4RzQ2amM4V0Vtb0t4djVrbVArNWIrUlRrWWVEY2IyZml3ZnFTNWphSmYvQlorUlRrWWVEY2J1Zmk4T3Z2VlhXZ0NxZm1EY2Nvd0EzK2pRRnJIQ01leFptY3UxNHNWMW5vTTVwWEJoa09kNXl0SmNRQTNFNGprTUZuTGJ4bWJseVl6TVJVSmsxUmRoK2JMZ1A3bG41RmpsWStEa2laZUxXNmt1VlZDYWVvbXpSTzNnTmFNZjcwQXBHR01kamNSTXZ6SmFuSFp3V3JiakU3ZGZhNnh3dmd0VG13UnlQZEsvTEhHUzU3dDVKTFNTVnh6aEV1U3JYTHIzVXcvTXF2K1RpL3dWbmw0dFJoRHg1OWZhb2tqZEU2cis0NEZwd2ppQndJdzNodUlVMFEzRzFEOEtTWDYxcHpSRHg1WmdGTGNrWXZIa2xKK0N5NUloaEpMd0NqY1E4ZVdiRFkzZW8zRU1IdngzcU9TSVl5Uzh0NmpVUXdrbHgzZldwYmtqRmsrUU5VYmlHRWtoTy9kd0NqY1F6YzdpVkdtVWt2QWIwYWlHTDVNUFVxTnhESjcrSjNxTlJESnppNHFOUkNYT3crS0t6Yy9GUllobTkvQUtOeEROenZyUnVJU1RodEtpczN5RTdBaTBoUlNMdUFSWWhKSUFSV2Iza24xVVdrRWdJcWQ2alFKQTNvTTN2NWIwYVFnUk8zSDZsRlNpaEJJT0NOS0J4UmtJQkJRZGpzTzlFbzFVV3lRallkeURRRUVZaEdRQ1J1UVVEaXF5dGo4Q2lVMEJCQ3FLRHVhSlNnY05vUkZOZHhHOVZsYlhBL0ZCYlhmV3FrdzBZL2dVWW1HalhZS3NURFJyZzc0cW9wcmkwK2lKTU5XUDRoVm1ZYXh5NC9GVmlZYnh5ZldxeE1OR3VCMmplaUxaSmdxek1ONDVoeDNxc1REZU9iRGFyYkU0dG1UQStoVlltR3pKaTFXMkp4ZllOQitXVjRzTmxodEdxcUUzU29nQll5dEUvVG1ld1laQkptYTRPY051THNjVHN4MjRreVllZHU5QkdVM0UwOWhqOHlMVVIvNmhrL3l0djhBTnBwY005QlBpMEhtSGFqL0FOUXkvd0NWTi9tMDBKK1JueFczeSt0VHYrb3BQOHFiL05wb1ovSlQ0bko1Y1VPVUdDeFBjN0hjNnNEUmg4UkVWZVduNVNmRW0rV2tidjhBL1gvL0FPZS8vZ0s4dG44cjZYazNIekwxUk5wcW8wOVliYkhSU1RzTVlxcHB2bVhSZ2tiV05kR3h1SUdJMjQ3L0FFMjZqYlovS3hkdmxVbHluclozVlZYSTZXcGVjejVKSEZ6bkhtU2RwWE5Ea25GcEhVa2NWYlluRjVNVlh6VnR4emc4aUtxL1ZLMWJqbkI1RVZZUnZQMUsyNDV3ZVRGV3RPOHJWdUtjSGtSMWJlQlZ0aWNIa1IxaEhGVzNIT0xlT3U1cTJ4TzI4aUt1NUZXMkp3YngxNTRyVnVPY0hrUlY0NTdWYmNjNE40NnoxVnRpY0c4ZGJoeFZ0aWNHOGR3d1Z0aWR0dkhjY09LdHNUdHRvN2w2cTI0NTIyN0xsNnEyeE8yMlpjRy83U3RzVHR0V1hEK01yYk03Ylp0eVBQRlcyT1cwYmNpbHM4dG8yNURpcmJNN2JSdHlieEt0cE8yMGJjeCt0c1RVenkxdHVmSXE2bVoybE51Wi9XMkphY3RZdVhxcmFjcy94VDFUVW5MVUxuNnBxT1VQeElwcVRsajhTS2FqbGo4VDlVMUx5aU56dzRwcU9VUnVlUEZMT1drM0k4MHRlV2czTEhpcGE4dExybU9hYW11VWgxeWJ4S2xyeTJicmtPYVcxeTJicmw5YWx0UnRzMzNJNFlZcVcxRzJ5ZmNmVkxhNWI3VDQ2ZU9WbDd1OXRidDNFdkR5K2x0ZFVhYXBhKzR5MjJPR0VTMFZNMTROUGJibkpJNTg5ZkczS0kyZ0FFbDNCZFBxdXE1TmNMdDdma25rZVhtT2VXTVpSanBpK3krMmZYRDMrNmVDbGlvTDlxRFRrRnJyYWk1YWRtcktXNEYyb0lvb29uMEVOWFBQTEs5bG5sREtYQ2dxV1JUYlhTUGp5bU5tT0k0Y3V2cXVIYkhCMzlqNVYzTnpYL21ZMWhsTVplaW91SjdlL2h3N25IbS9kdHE2Njk3YTd0RjJ3eHVFc05UTERITlZQeXNoaGhlMk9TU2VTRmppV3NlNE14WXdsN2lBMXBjNE5YY3ozTk1QbmVqMitkRVRVOGV5b3VadnNpSThaLzJ6VU9RdXFmYWc3c2FVc1F2MTlOM29yZkhTRzQxZFZXYWN1TWROQkczQUZ6NUE1eGEwRTdROXJYWWJjcTZzZGRoTTFxOTB2b056NWI2ekRHY3AySnFJdjl2SHM5WDJlOWpwZjJsKzhXcnRNemFvdEUxWlhXcWxscktLcnJMYlpxK29wUG1MZk8ra3FteFN1NlpleGtzYm1oMlVZNFk0Sm4xbUdNekV6eGowU3gwbmtQVmRUdFk3dTNzek9PVVJNWG5qRTFQR09IZDZuNTlWN1dmY2ovUm5TZDJZYTZxaDBOY1dVVDdmZGJoWmJoVDBiL3hPZU9sb3pKTDk5ekdTU3pNR2JJY01keVlkWmhsTlJQR2ZSTFhWZVJkVjAyMWx1N216TVk0eGMxbmpNMUhidzczNldrdlozNzA2NzB4UTZ3MHcrNDEybmJqQ3lxbzZ5bXNWYzZHYUo0eGErTnpuTkphZDRKQTJMTTliaEUxcTkwdWJaK1grdDNNWXl4MkpxWXVQdjR2UmRkZTJOMzIwSjNDaDB6cUVmSWFhTUpxcWlzdWxKWDBWYUdDUnNBK1hvcDRzMVNYU3lNWU9nOTJCY00rVUVZN3g2aU1vbVltS2o5T3gxT3A2SGQ2YlBEYjNOcktNODVyR09FeE16L2lpYWo2YTlGdm9nOWtUeURsWUpHeFhYSzRaZ2Y2djF1NDdmMTF4Zm5kdjhYdWw2bVB5MzF2ZnMvOEFIaTlWdlB0Szl5Yk4zRG8rMmx5dWs4R3JhMFJOaHRVdG51QXVFcjZpS29uaDZVQXhhNWhqbzUzT2NYakRKdU9JVi9NNDZkVjhQcGNmOG8zc2Q2Tm1kdVl6eWlaaU5XTlZIYnhldzFmc2NlUWtGTytjeDNjNUdsMkEwOVhrN0JqdWE4bjZndUw4N2g0KzZYcDQvTFBVZCtGZitMRngrMHI0TDk1cjM1RHU3QVhxbk5IY2ZscEsrR3NoaHFaek8xbGZIYkJBeW1kSEhPS2o1aVFOZEZJMWhhQVhIWmxMdVNlbzRXbXg4djVaWjZabjBlbS8wNzMwcnZsN1FQZmZzejI2cjllM2lLdkRLVmgrWFpXMm1ycFlwNThwZEhCMW5GN1d2bEl5UmdqQnp5RzdNVng0OVZHVTFFdlhqNVM0VFdYRitONDVlMDkzNDhpZTJsTDNDc2RKWEJ0UTJLU1NDaXRsVlZ0aEZUVHgxa0xKSlc1RzlRd3lzYzVveHlrNEU0Z2dUUHFZeG5pN1hUZkoyRTR4TzV1NmNwanNxNmVmYS9hQzd0YWc3bDNEdFBhYW1ycWRkVzJGMVRXV3FDMDFqcXVCa2ZRTDNUTU9EV3QvcE1XVWh4eHhPd1lLVDFNVmR2VWo1RTZhTVl6eTZpb25zKzVQZDI5Nzk2cTlpVHlkaGpkS2JkZHNqQVhPL3dDaHFqY0JpZjAxbjgxajQvVzVNZmtub2UvcTUvN2MvRjZiMnE5b1h1LzN0dDlmZGUyajZ5OTBGdXFSUVZjMXV0ZFZJeUdaMEVkVTJLUXZ5WVNDS1ZoY0JpQVRoaVZyTGZ4eDdaZDdlL3QvMFd4TVJuMWxUTVJQRGJ5bmhNWEhmNFB6KytuczUrVS9hRFNNK3JKclBYL0owemVyUE5jcmZWMGRLeGczbDlVV3ZoaS91cFhNYnpjRk1kL0hLYWlYSFB5RjAyN0ZkUDFlT1dmZEdXTTRSUDB6dzlyRHNGN1Aza04zNDBZZFIyYWhyblhTbWtiVDNTam9hR1dyYlJ6eVFSMWJZWkpXRnJTL295eHVjRzRnWTRZbkJYUGRqQ2FtYWwyTjMrM3V6MGxZZFYxUEwzYWlaeGpDY3F2czR4THlxVDJjdThOejd0MWZaU2lscTVPNDFEQjgzVjJadHNxald4UjlPS2JxT2ovTjZlU2RuM3MrT0p3d1U1dU5YZkQ2WEwvUVBSUnRSdmZuUHVYWC9UeXUrM3N0K2lmWTQ3L3YxMmUydnk5MU90VzBBdmpxSDhHcU13b25WQnBSTGptd3dNZ0xkK0t4ejhQSDNTNGY2Tzh1L3dEdkovN2VYeGZrYVY5bC92SHJmWDk4N2NhYW1yS3pWbW5TeU83MjZudGRVNnFvNUhiY0oySEJyUVFRV2tPT08zZGdyTzVqRVJOOEo5YnRibnlIMGUzdDQ3czlYOTNPNi95OHI0ZHZDM3o3eXA5cjN2aDR6M2V3V0M5VXRTTHhmS3Vtb1d3M09sbG9PbXlyYzlqS25OSm1hWVdPamNKWEEvYzJZamFGY1oxL3N6YmhuNUNqZmpHZWszdWI5K01adkdjZE9xK1BIdTRjZkI5VHRmc0wrUjE1MGxUNnpncGJ0K0F6MHJiaTJvTm1xV3M2RG91cm53a2Mxd0dYYnRBUG9zYzNEOFh1bHIra2ZMNG12em5IL3dEYnkrTGhEM2g3ZlZmYWpYZFpvdXNxRzFSZ3l5UXp4WmcyU0dRWjRuNFBBSXpNd09CR0l4d1dwNFBsZk9mS3A4dTZuUFltZFdudjhZbmpIdWVwU1ZJSEg2QXBiell4WVNWQk93YkFwYmtqRmkrVURlbzNFTVpKd3BiVVlzSHk0N09DbHVTTVdUNWdOeWpjUXhjOGs0bmFWR29obTU0SHhVYVl2a0ozZldvMUVNbnljR3FOMHllL0Q0bzFFTXlTZDZqYUh2QUd4Qm01MzFLTlJETjd5ZGlqVVFoenVBVWJpRU9jQjhVVm01NWNVV2txS2t1eCtDTFNYT0RmaWlzM094VVdrbDJHN2VqVkpVVWljUGlnemMvSGNqU1NjRUNKNXFLU0tTQVFRMXdQeFVhTUVoQlFJS3JJUUNDZzdnVVNqVlJUWGx2d1FhTmNIRFlqSm9LRHNmaXFsS2E0aEdhYXRjRDhWVU1PdytDSlNnZVNJb08rdFZLYU5lRHZSRkIzTkVwbzJURDFDck13dHNuSlZpWWFObDVxczB0cnYxU2d0c3A0cGJNNHRXVEg0aFZtWWFzblZ0aWNXekpnZGhWWm1GdGZ5UkdqSm5OVnRtY1cwZFI5YXRzVGkzanFDT094VzJKeGFzbkIzcXNURFpreEcwSFlyYkU0dDQ2cm1yYkU0dDQ2Z0ZXMkp4YlIxQkhGVmlZYngxUTRxMnhPTGVPcEhBcTI0NXdiUjFXSEZXMkp4YngxdUN0c1RnM2pyUVZiWW5CdkhXY2NWYlluQnZIV2tjVnEzSE9EZU91eDNxMnhPMjhpS3U1RlcySndieFY1SEZXM0hPRHlJN2dEdkt0dU9kdDVFZGMzbXRXeE9EYU91dzNGVzJKd2JNdUJWdGlkdHN5NCtxV3hPMjNqdVhxcmJFN2JhTzVGYXRpZHRzeTVEbWxzVHR0bVhFSGlyYkU3YlpseDVGVzJaMjJyTG1lYXRzenR0R1hNODFkVEU3VFZsMDlVMU16dE5HWFQxVjFNenROVzNYMVYxTXp0TGJkdHU5TlRQS1cyNitxdXBPVXR0MEhOTlNjcFl1Z1BGWFV6eWxDNmpnVTFKeWpGMUhFL2FtbzVSaTZnL3BKcU9VQmRRTnprMUp5ai9GZjR5dW81UmZpZzVxYWpsRitLam45cWFsNVEvRmZWTlJ5a202am50VFV2S1M2NkRtbXBlVWczUUthbDVTWFhYMVRVdktabTdZamVwcWE1U0hYWDFUVXNiVEoxMDlWTlRjYlROMTA1RlRVMUcwNU9lRC9sdm9Qc1oyNHUrbWRRM0dxdDE0cjZ5U2I1aTIxVTlCVXNoTTlzcTJtR2VHbXFSOTQwTDQzdExSOTF5Nm5WZFBPOUVWTlU5cnlUemVQTGR6UEtjSnlqS0lqaFhDcG54bUgwalV2dVBkc2JwRHF6OEJybjBBdlZkVVZ0UXhyYWtDV25xTDlTNmhmVHhoc1g3WnVhT29nL2E1TVJJWFlETVdxL2wvMk9QN0x6bzh5M3I2ejdreCtaaW80eDkzdGk1K2lZN0h3ejIzdTVGZHBYekRsN2hSVVl1c3R1dGpidStsZjFIUG5mRHFpMTFUSVdzaFpMSTU4N21kT01OWTdCNUJJd0JUcVB2Uk1YWEQ3WWR6eTNMOHZuczVSak9VeHV4d2lPTS9jemlhOVYyN1A5ZFZkWjVENlk3aitWZmlmM0x2bzdjM0dta3FlOFhhRFYxSElMbmI2T2xFZ3FaYll5NWh6cVVzWkRLME1aR1d5RnJtdGUwdHdYamJWUmxqcWpnL1MvTXB6M3VuM3Z5MlVUdVRqTVZQR0ltdXlyNFMvWTdIdjFUWi9CZnladFZiWFRVbFVhdU4xS0xWWDFZaW96ZTlPVUZkSTZoa0R3K0VTUHFqSit6eS9lY1R2SlhjNnZDSjZpdkd2ZStUK1ZPdXovQUpCbHVZNVRNNFk1eEV6MnhwdUk5bFBoSG5SclRWZlliMjBMUFY5djdoVnRicGpWVituc1ZIWDFkWFdVcldXNlg1ZWlqbWhua2MyYUtua2UxOGNjbVpqWE5hUVB1aFhIR01ON09vN096M09HT3AzZXM4bDZTTjNLWm5lcU01dXBtS3ltWXYwMCs1ZUo5UHFUVmZ0UmFnaDFScktIUlU4dXA3ZlVPdW1vTC9XV0tpb0lCVFdtcW1vSXE3UDFLU0tSL1VZeGtaQWFYNEFjRjErb3JIZDdQRGcrazhpalBmOEFLNHhqY25HZnZSR2ZiTVZNeEUrbW9ldmVYM2Zmc0pmKzFuYXJzaFZheWkxemU3UytXbHJOWVd5cG1tanVOVlZVRXRIRGI2RzRNa2MrZDdaWHRxSFBqbGM1amFjT2VRNGhkam9kbTg1bktLeG4zMzNQQStkdk5ZeDZQSFoyTnpYdllUamxxaXZ1eGoyNVQ0VFBaRWQ5dmNQTWFGK292RVhzdmQ2N3VacUxTbXRxZlNrbHlqcHJIYk5TM3VTN1BGcnAzT21yWkxGV1V6NCtrL0Q5ck81emNYa25pdWxzeE16TlkyK3g4MjNkckRhdzVtOU8zeGl1TVJxbnc0OXQrRGh2cnp5RDhpOWY5MWRMUWFqcTMzMkdTMXlSMU91N1RNeWtxYVYrbjdQUFBiV0Q4UGxkVVFTU3ZxcEM2U1I0NnJTVzRFWmwzNDJzY2NKaU9NY2VQcWg4WFBYNzNVOVZodTdzVHRibU00NHhqVXhjWlpSRTl2Ync4SFpwM0IwWmFOY2U0SG9XdGg3cTNLeTZvMC9wMkcvVDl1cVNLdmJUM2VtcHFsekhTdXFCVk1vem5mSzFza2JxZDhoYUFRNW8ycnlvbmgyUDBuTEM5eUoxVHdqczhYVng1ZWVVbW8rNWZ1U2Fhb2RLMlM0MkcwNnhkcUc5WGgwc1UxTFZVMUxGYTRXVTBES21BdGZGVVExTmxiSktZMy9kYzRzSk9CWG83V05ZeEhqRS9wN25oN203cTNzc280Vk1SN1A5cm55N1VIY0R2NXJqdWg0WDNxckw3dFY2TzA3cUx0dFYzRjc1NHY2eFdpZ2pxNmd6OVE3bVZNdEZJUmppOE9keUs4L0c4YXlmUnhsVXYxZkNMVU9xdTMzbEVmRktLVmpiUm9iUmxYZDlYdW8zazA4K3JyN1gwMTFxMk13Mk9iVFJ6dFl3OEE3RFpncnVUT1gzcDczSm5Fejk2ZTl3QTltM3ZGM2M3Z2U0M29iVDJ0TGpjSjZTa1pSeVRYR29xS3cxTnltdU9pSys1VmJhMnBrZVgxVFhUVTBVZ2JLWE5hV3R5Z1lMczd2N0ZlRlBlNnYvQVByVGpPTVZqcHJoNHh4OXI3YjVsZDFOYTlqUE02ODkxK3dmZU85VityMzNpL1JWbWs3eFpMOGJEUkJ0bmxwcGFPS3FycTRXcWNSeVpjb2ppRG11T2JIN3BXTnJiMVJ4aW84WEo1VjBPUFVZUmp2UkczdDhaMTlsekVjTWJuZ3k5aGZWM2NTOStYR3VJOVZRVk5udGtOa3VNN0xXeXNra29xdnBpek5pdURvNFgvS3lTeU5lNGlSamNRd2h1SkFXK3F4cUk0ZnB3ZWw4MTdVWTdlM2VFWXpFNlludm5HTWNhbVo3SnZ0ZWQ3T0hlbnZyM0Y4aWIvMm83aVZkMnZYYkc1Vyt2TnlPbzYrdXVWUFBUT3BLT3FGUXhseGZLR1lUVkw0OFk4clNEbHd4YW5VYmNZNFJOVlA2bWZtSHkvWjJPajJjOGNOT2ZDTC9BQlJwaWIraVo3Zmc5dTlzaTFTNko4ME5TVzdTMWZWdDBEU1cvdUhib2FSbFpVbWdyS1d4Nm5vclZhS3cwK2ZvT2xGREVHaVVOek9hZCtDZFR4d3dtZTJYWitiZHVKNkRvZDdLUDh6UERMVlBmTVkxR04vUTRtK0VQZER1WnFuM2RiZG8ydnUxZTZsWmZMQmQyVjBsWldtdHJJcmhIRFcxRVZSVlBrTWswRG1SbG5SZVRHR3NhQTBZTG0zc1lqYm1LN29uMjA3WG1tR09IUTU3T2lJeHd3MjhvbXVPcktNYm0vVDJPWmNGOHUwM3VpZHpOYU11bHdGeHRNZXFyZTBDNFZuUWp0OXIwclFWVWNEWU9wMG1zWlUxTHBRQTNZOGs3eXV0T0VjbUo3N2VOdmREczQrUzdlOXAvd0F6TGR5aSsrb2lPRGh4N1UzZVh1WHJIenp1RlBjYnRYZmhObnA3ZFdmTmlzck90Y0pLclROZFdWb3VFenBDYXNpYUpqMmlZdTZlUDNjQVZ5Ny9BUDA2OEsvVzliNWdqR09peXcwUkViVTdjWXpFY2Z2WXpPZkh2dVloekRzZWlMLzdpL2pIMnA3eDYxcUthbTFGbzY0M0RTM2RoOXpsYUJIcGtacTZXWnNrbTNxVFJRVWoyazdReVYySlhYeHp5MnBtUEdIekhUOVoxSGxPZTd0UjI3bUdtZlZsVXhNZW12cmZuZCt2SlR1UjNmOEFhRjdnOStHMWxkYmEyNzZ3blpaNmFocWFxa3FJTFRRYWdpcDRhUE5UdlpJMFBwNmZMSXdFWTVuQTcxcloyLzhBTXFWOHI2R2NPdXgyOXpHNWk1bVBWRjAvbkY3Z2R3ZFY5eDlVMVdyOVp5aVhVRlk3cVRsc2JZbXR4MmhqV01BRFd0eHdBQTJEWXV4cXZpL1BQTk9zM2VzNmpQZDNmMnNwNDkzMFYzVS9CZk1CdlMzUmlHTWxRcGJjWXNYekVxVzNHTEowNEc1UzI0aGsrVXVVYWlHYnBRTjZqVVF5ZlB5UzJveFl2bStrcU5SRE44eDRuNkFvMUVNeklUdVViaUVGNEc5Rlp1bHgzSXRJZElPS2pVUXpjOVJxSVFYZlVvMVNIU0RnaXN5N0ZGb2lRTjZpcEp4UnBMbmdEWWd6TGlWRlFYY0FqVkVvcE9jQWkwemM3SGR1UlVrL1dna242MUZKRkNCRjJHN2VpMFdKVVZrRGo4VUZ0ZmpzTzlCU0NnN0hmdlZTZ2lCQXc3RDRJbEtCQjNLb2JYRnB4Q0RSc2dPdzcwU2xJaGgzTlZLVUhja1NsdGw1cXBTMnVCM0lpZzdtaVVvTzVJbEtiSmdxbExFZ1JGQjZKVFJzcCtJVnRtY1Z0bDVLMnhPTFJzdk5WS1dIRGh2UkZ0a0kzcGJNNHRHVEhnY1Fxek1OV1RxMnpPTFprM05WaVlhTmVPQ0kwWk01cXRzemkxWlVqanY5RmJabkZ0SFU4aXJiRTROV1ZRNHEyeE9MVmxUeUtXeE9MWmxVNEsyek9EWmxZT0t0c1RnMlpWQTdpcmJFNHRvNnNqaXJiTTR0bzZ6bXJiRTRObzZ3SGlyYkU0Tm1WZnFyYkU0TjQ2MGppcmJFNE5tVnc0cTJ4T0RabGMzbXJiRTRONDYva1ZiWW5Cc3k0SG1yYkU3YlZseDlWYlpuYmJSM0gxVnRpZHR2SGNqejJLMjQ1MjJ6TG56VnRpZHR0SGNtbmlyYk03Ylpsd0hBcTJ4TzIxWmN1VGxiWm5iYXR1UjVwYkU3YlJ0ejlWYlNkdG95NmVxdXBtZHBxeTZlcWFtSjJtckxyNjdGZFRNN1RSdDF3VjFNOHBiYnFPSlRVbktVTHFPYXVwT1VzWFVjMDFNOHBiYm8zY0NtcE9Vb1hVZnJLNms1Umk2RDlaTlJ5bGZpdjhaTlNjb0M2NDhVMUp5akYxUE5OUnlqL0ZYZnJmYXJxT1VYNHFlYW1vNVJHNi94azFMeWkvRmY0eWFqbEVicVAxazFMeWlOMHgvU1RVY3BCdXJlYW1wZVVoMTFBNHBxYTVTWFhVRlRVdktRNjdZYmltcGVVaDExMmIwMU5jcG02NmVxbXBZMm1UN3AvRzJxYW00Mm1UcnB3eFUxTmNwOW85dUh2ZnAvc041RjNMdkhmMmw1b0k3VFQwSWZEVXp3T250OTFodTdvNXhSc2xtYTJSamNBNXNidHVHT3phdXJ1MWxPVVROWEgyMjdlUFdmazh0ak9JdlRsT1ZYRVhlTTQ4Sm5od2M3TzZmdkllUCtsZTBYY2U3YWIweGJyQnF6dU5UMVZCcTJ1MHhGcUQ4UXJJYW96bDhWTkRkNlNDa2drbCtabC9hQ1g4OTVma2M3N3E2MGRQakZYbGNSM2NiZXovVk9XOXF4Mk5tTWR6UHR5bkxHWThMblRNek5SNlBwcmk5WDhPL2VCMDNidEE2bDAvM2NzZEZjZEk2L2dnYmVhQ3BaY21XK29pcG92bEtZc250TU5UVVJTeDBqWW9IZ3haVDBtdURnN0VMbDNvamZtTXIwejduaStTZVovd0Fud3o2YWNOZTNjOEptSW1KbnQ3YWlZbWJudHZqVlU5UDh3ZmRUN2FkeXJqb3J4OTdiV0tHaDBMYXFtS3AvRDdaRlcxRVZOUngzT0c3VmxVNmE5TmhxcW1vbmRBSXhuaWEzQXVPWjVQM1cxVzFQYnFtZTJmZTVmTmV0eTYvWWpUaEcxdGJkNll1T016RTR4K3p3aUl1K0V6TDYvYVBkZDhlYlA0dC82cjlkcEcyVnVrWHRpcksrdXFScThUVlYyall3bTVTZjBBdUVwbGpFbUFmZ0NNRng1ZFBFNVhyNCtxWG83SHpadDdlekd6R3hHbXFyVmhYMXVEbllUeW4wL3FmelYxVDNsMXRXVjE0N1BPczhOaHMxTGNXVlR5MytrMExuUGMyazZsVEN5cGhvWld1TVlMaDFjQ01DNWM4NTNsUEdlTVZEdzh0amI2UGEyY1p3eG1ZM05XVVhVVEVhdUZ6d21weWp0NGNQVTdBTzRmdkMrTC9kT3kyTFQrdSszZG9xN1JwdW1OdHM4RFpkWndOcDZWekdSdWgvWVc5bVpoYkcwRU94R3hkYkhwdFBabjdwZlNibnpadDc5YTlpSnFiaThzSnFmYTlPMXY3b0hqcjNCN3ZPN2xhc3NzTTlBNTF2SjB6SFNhaGlzem9MWlF1cElJNUo0cVp0VTU0a2QxY3BnTVp3QUxzZGk1WTI0amIwUmwyejRPcm41eHp1dHg2akxiaXNjYWlOV04zZDM0ZSszbmQ3ZmR4N05kMk8vdWhQSktDamkwLzNQME5VQ1drcTdQVDZsbkZmQ0kzd2ZLVnJhaWxnYUtjeHl5Z2xyWkhndUdEVHc0STZhTytYdno4eFRubEU0NFJIajk2T3p3ZXI5MWZjaThZZTVmZDQ5ejZ5eVFVRlBXVHhWdDRzTkJGcWY4TXVjclpKSlp6VXlHbWpsaU1oZTA0UXhPYTR0T2ZESGJ5WTdjeGpPTjlydFIxKzN1YmtaNllpdlREOW5WbnUrOW1hdnlwMG41WDZPdHRQWU5lNmZncmFDdm82R0xVczlCZWFlcXBvS1JqYXpyVXNaak1NVU9FYm9vbmtrL2V3RzFjY2ROd3EzdGJYV2JlWGZFTXZHVDNpZXl2alhxM1YvY1MzMnlMVU92TlpWRWxWY3J6ZjR0UTA5VTF0UUd6VlVNYktTbHFZbXd5VmZVbVlNd2NHdURTQVJnR2ZUMzJTOVRITFozSy96SWlQcGV0ZVBudWgrTDNqajNpLzB0YVMwMVNWVlRiVFUvMVZ0TlV6VWtkSFlXMVFtaGMyaGUybGxra0h5MHhoSmxZMGdZNWRoVzg5bWNzWWkreDdPNW5zNysxaHR6dmZzK2lYdDcvZXI4VzdkcnE5ZDE5T2R0ckxTZDA3MUZjSXFpOEdiVmtwRWx6YmhVU0NHV2dNWWM4Z0VrTkJXUHlzekZhdnJXT2kyczhJd25xUHV4M1ZsWDFQVi9FTDNpZXhIaU5VM1hVR25kTlV0ODF0ZFlJN1krKzNjYWdwcXRsdlpUd1Jta2JGVDB0UkN5UHF3ZFFaWFluSGJ0eFhKdTlQcm50K3Q2L211eHNkZHVhdnpIM1lpSWlKeHk0VkVSNFRIYzhiVTN2bjltK3pYYTY5YVI4YU5DMjNRbHkxREU2aHJMelltM0thdmRFLzd2UmpxYnpGQjBzUTRocm10a0xNY1dzeFUvTFJIN1V6THJaZEYwdU14bHY3K1c1R1BaakVUN0x5N0k5VVNyd3g5NVBzVjRwNmNmVjJyUk5GV2E1cjZkMUZWVjF4bDFBSjZlamxERCtIc0ZQUzFFUFNqTEEwT1k3RjRBSjJyZTlzY3lidW84SGU4NDJ0anpIY2pQbmFNWWlJakNZeW5Ud2lLamhNZDMwdmhsUjduUGJEUTNtdGFlN0hZNjBDejAxb1A0MUhRVVVOVlUwOXVkMUtkc2NFSXVmUm5taklpbEVyVGt3Yk9TdzVnRnJURTQ2Sm0rRG1uekRwK1RIUjU3azV4T00zbEVjWTR4T05STlRNUlhzbmc1Rzk3dmZMOGVaN1RyRHV0cFRSbHNzbmVuV3RxcWJIZjlTMm1TOXoxb3BxeW1aU3ptR0c2VWxOUnhTUGpqWTB5RjVQM1c0aCtVQmNFZE5YYlBCNWNlWGRQdFl4emVwMWJXTTNweGpLL1QyeEVSZGNaK3Q4ZzhBZmRRN0o5aGFjZDBOVmFNbzdscnVyZ3FhYWtwN2grTHhRVytDcHFxb2wxTWJkQlVNazYxSE5ERTkwZ2E4ZFBERERCYzI3dDgySTQwOVB6VHFkcnpiYjI1bmQ1Y1JkNDFNeDJ6VThMN3FqanhmcldiM1J1MitpdTJmZGZzdDI3bGxzWGFmdWxWVWxYVzJ1aW83dE8rMU1peVExTlBiNUtsalMrR3BwWW80SDlVeGxnenVZQ1NGbjh0RnhNejJPTEhvZWh5M05yUGMzNXkweDk3N3M4YXVxOUhaRTNYWndlNTN2M2l2SGlxOEtaL0RhSFIxdW85SkNpbk5QZDQ1TlR1cUtlOHlOZEtMc0dtaWFYVE5xbmRmQXlBRjI4NExNZE5NVGVyajlMcDRlWDdXTzl6ZnpYM3J1OU9WL1U2aXZJUFg5aDdqZDVkUWEzMHhDYWV3M0twK1lwb2kxckNHbU5veGMxbXdFa0VrRGlwbGxjMi9OUFBPb3g2bnJOM2R3NFk1WlRNZTE2UytmbWNGbTNteGl5ZFVEZ3BiVVlzbnlsMjlHb2htK1VEZW8xRU1uems3dHlsdFJpeWZOOUpSdUlaUGx4M242RkdvaG1aQ2ZnbzFFSUx3RVZEcFNkMjVSYVp1a1Myb2hEcENvMUVJYzlScWtPa1JVT2VTaTBrbm1vcEYzSkZwRG5nSXFIU0U3bEZwQmR6M290RVhFb3RFU0FvcUhTQWJBaTBndUozN2tWSktLUktpa2dFQ0x1QVJhU1NCdlVWT2NvTTBhTU81b2xMYS82UWlLRGdVRERpRlVwUWNDaFFSQWdZY2VLSlNnUVZVTVBjM2NndHNvTzlFcFlQSkVNT1BGVktVSGNrU1lXMlVqZWlVdHJ3ZDI5VkZCM05Fb3c3a2lVcHI4RlVwWWtCUkZ0ZWlVdHNwVnRtY1Z0bEN0c3ppMGJMelJtbGlScFZSWWtQeENKUzJ6NEsyenBhTXFUL3RKYk00dFdWSTVxMnpPTFJ0UUR2VnRtbWpaZVJSbW1qSjNEanNWdEp4YU1xdWF0c3ppMmpxdVJTMkp3YXNxdWF0c1RnMVpVamdWYlpuRnF5cWNOeHhWdG1jV3pLM21yYkU0TldWcmVhdHNUZzJaV2NpcmJNNE5XVng1cGJNNE5XVnl0c1R0dEdWdzVxMnpPMjJaVytxdHN6ZzFaWHVIRlcySndiTXVCNXEyeE8yMVpjQWxzenR0V1hBYzFiWW5iYk11UElxMnpPMjBiY2p6VnRtZHRveTVZSmJNN2JWdHo0WXE2bVoybWpicDZxNm1aMm1yTG9lQlYxTVR0TlczVTgwMU16dE5HM1VLNm1lVXR0MUhOTlNjcFl1cmVhdXBPVXR0MWIrc21wbmxMYmRCK3NyYVR0cUYwL2pKcVRsckYwUDZ5dXBubEgrSyt2MnBxT1VmNHFlYWFrNVIvaWg1cHFPVWY0b21vNVJpNmtiTVUxSnlqL0ZYYzFkUnlpTjBKNHFhamxKL0ZQVk5TOG9maWg1cHFPVVJ1cDVwcU9VUnV2OEFHKzFOUzhwSnVoL1dUVXZLUzY2ZnhsTlM4cERyb09MazFMeWtPdXJlSlUxTmNwQnVyZUJUVXZLUTY3REhmdFUxTHltVDdtNDQ0UDhBb3dDYW1vMjJiN2xKK3Y4QVlGTGFqYll4WEdXa3FIMVZITytDcGtEV3l2Z2U2TXZEZDJiSVJqaGpzeFhIbGhHWGE1OGJxcWlZOU1SUDF4SjNXKzFsNWtpbHVzN3FoOEgrSzZ2M2d3N3NRRHN4dzQ3MUl4aURISFRGUkVSZmhFUjlTTFRxRzQ2ZlpKRlpLaDFORks0dmtaRDkxcGNkN3NOd0o0a0tUaERXZU1aMXFpSnJ4aUplQ0oyeDF2NGxHNHR1UWVaaFV0SkUyZHdMUzdxRDcySkJ3MzdrMFJWT1dNcDdPRmVGUlhzN0cxVnFTOFZjRDZXcXJxaVNta0JiSkcrZVV0YzA3Q0NDZG9Lenk4U0lpSnVNY2Y0Y2ZnOFdrdWs5c2xkVVcyZDlOTTVyWTN1cDNPakxtdHhMUWNoR0lHSndWbkdKYTdlRXhFK3VJbjY3YlAxanFMaGNxbitYbC93bG5sdzFHTWZoeC9oeCtEeFc2bXZjRDVKSWE2b2ErUTU1Q0pwUHZPd3d4TzNmZ0ZORU9XL1JqL0RId1pTYW52anB4VW11bk5RR2xqWG1XVEVOSkJJeHgzRWdKb2h5WTdreDNSN0krRE02bnZqWlhUaXVuNnJnQTUzVmZpUU4zSDFUVERramZ6anc5a2ZCaFBxRzZ5dWVaYXlWeGtia2ZqSTg1bThqdDNiVk5NT1dPcTNJNy9kSHdRN1ZON2FNamEyYktCaGgxSGZsVXFITEhXNzNqN28rREJ1cEx6QzNweFZjcldERTRCNTNrNGxLY3VQbU8vSDczMWZCbk5xUzhTc01jdFhJNk53d2NDNGtFSlRrL21mVWZpbjNJZHFtOURaODVKL2ZGUnVQTmVwL0hMOCs0VnB1VWdtcjNkZVViQTZVQnhBK2xTWWNlNTF1OXVURTVaVE5OdjYxNmdhTXJheVVBYkI5NUw5THN4NXAxUDQ1ZUN5NDFGUGNCZG9uNFhJT01nbXdHZk1SZ1RqNnFPTEhxOTJNOWNaVHFWZTlTWFcvRnY0dk9ad3phd09hMEFIbUEwQVlwTTIzdmRidmIwVmxsTXdtRFZsL29xZGxKUjFja2ROR0F4a2JDQUd0R3dBQlM2YzJIbUcvRVZHVXN6cTIvc3lZVmtuN0lsMGUzODBrRUVqNnlwY3RSNWh2L2lsblhheDFEWDB6Nk9ycTVKS1dRWlh4dUlJSVBBaEp5bnhYTHI5N0tLbktYNXI1M0hqZ282bE1uVGdieW8xRU0zMU9HNUxhakZtK3B4NC9VcGJVWXNuVkNsdFJpemRNVDZwYldsRHBDZDV3VVdrR1JvUlVPbHhVV2tPa1Myb3hRNlJScUlRNTZqVklkSnlSVUZ4S0xTU2NONmlrWEl0SWRJQjhVVkRwQ1ZGcEJkOWFMUkZ4S0xTU1FGRnBMcGVTTFNDOG5laXBMZ2kwUk9LaWhBa0NMaHdSYUl1NXFLa3Y1SUlMdWU5QXN5TFNBNGhScWpEZ1ZVbzBERHVhSlNtdlJGQjRLQ2dTRUZCd1ZTZ2lCQXc0aEVwUUlLcUdIRnU1QmJaUWQ2SlN3UWR5SVljZUtxVW9PNUlsS2JJUWlVc1NOS3FLRC9wUktVSGhDbEI1VlpwUWw1b1VvU29sTGJKeSt4RXBRbUt0c3ppMGJNcmJPbGJadnBSbWxpVnBWUlRaRHdPS0pTMnprZWl0cHBhTXFEelMyWnhhc3FWYlluRnEyb0JWdE5LMnpEbWpOTGJPUnVLdHBwYU5xbkRlbHM2V2phejYxYlpuQm95czRZcTJ6T0RSdFo5U1d6T0RSdFlGYlpuQnF5czVPVnRtY0dySzF5V3hPRFZsZHpWdG1jR2pLMXZOVzJad2FzcmNPS3RzemcxYlhubWxzemcwYmNQN01WYlpuYlcyNERuc1Z0bWR0b3k0RG1sc3p0dEdYRGtWYlpuYmFNdUR1YVdrN2JSbHlkelZ0aWR0bzI1SzJuTGFOdVlHOUxabmJXMjVqbXJxVGxMRjBITkxaNWFtM1QrTXJhY3RZdWgvV1MwNWEyM1E4MWRUUEtVMjVubW1wSjJsaTZIbW1wT1VZdXA1L2FycVRsS0YySTQvYW1vNVIvaXg0bE5TY294ZGZWTlJ5aCtMSG1tbzVSaTdIbW1wT1NmNHNmMXY0RTFISkkzWTgwMUhKTDhXUE5OUzhvamRmVk5SeWdic2VhYWw1U1RkanorMU5SeWlOMVBQN1ZOUzhvblhRODAxSEtRYm1lYWFtdVVoMTBQTlRVdktRYnAvR1MxNWFIWFQrTXBiVWJhWFhRYzAxTHlrRzVqbW1wZVVoMXpVdGVXemRjanpTMnVXemRjWGMxTGFqYlp1dUI1cVcxRzJ6ZGNCelMybzIyYnJnT2FsdFJ0czNYQlMydVdoMXdLV3NiYko5Y2VmMUtXMUdETjlhT0pVdHVNR1RxNGMvb1Myb3daT3JpcGJVWU1uMXJ1ZUNsdFJnemZWOHlwYlVZTW5WZ1Myb3dRNnJLbHRSZ3lmVjh5cGJVWU0zVmFXMUdDSFZSNEtXMXBadW54M25ZalZNM1ZEVkxYU3pmVTRlaWx0Uml5ZFU0OFV0cU1XYnFqMStwUzJveFp1bUovMlZMYTBwZEp6S0xTREtCdVJhUTZZcUxTSFNwYlVZb01xbHRhVU9rNXFOVWwwcUxTREtUdVJhU1hIaWkwUmNGRnBKZmg2SVVoMG9HN2VpMGh6eVZGcEpjUHBScWlMaVVXa2x3Q2kwaDBuSkZwSmNUdjNJSkx1U2kwUk9LS1NBM0lFWGNrV2lMdWFpb0wrU0NTN252UW9pNGxGb2tVc1FnbFJvSUdIRUlsR0hBb1VhcUdIRkVwVFg4dnFSRkI0TzlCUUpHNUF3N21xbEdpQkF3NGhFb3c0SVVvT0kzRlZGQ1U4VVNsQ1JwUXBRZHlLSlJoM05WS1VKT1JSS1VKU042SlN4SzFWS1VINDdrU2pEMEtVSG5ncWxLRXA0b2xLRW9SRnRrNUlsTEV4VnRKeFUyWlcyWnhhTm45VXRuU3NUQTcxVXBRbDVGRXBRbVBCTFowckZRUXJhYVZ0cWp6UzBuRm8yckt0czZXamFzRkxaMHJiVUJXMDByYk9PQlJLVzJvY054VnRuUzBiVkViMHROQzIxZytsVzJad2FOcmZYNjFiWjBORzF2QkxaMExiVy8yQlcwMExiWGVxV3pvYU5yenpWdG1jRnRyenpTMmVXMGJYbjZGYlRscmJjQnpTMmVXMGJYamdWYlRRMGJjT1RsYlowTEZ4UFBGTFRscWJjVHpDV2s3YWhjU3JiUExXTGpzMi93QUtXbkxNWEljMHM1YXhjUnpWdG5scWJjaHpUVWs3U3hjZlZXMDVaaTUveHZ0VFVuS01YTCtNbG5MUDhUUDYzMnBhY3N4Y3p6VFVjcy94TjNOTlJ5ekZ6ZHpWMUp5ai9FM2MwMUhLSDRtN21tbzVRL0V6elRVY292eE4zTlRVY3BKdVI0bExYbGwrSm45YjdVMUhMSDRrZjF2dFMxNVpmaWY4Wk5SeWlOeTRZN1BpbXBlVWszSWMxTE9XZzNJY0NtcHJsSk54UzE1YVRjaHdVdGVXbDF4UDBmRkxYbHBOeFBOTFhsb054UFA2bExYbHBkY0Qrc2xyRzJ6ZFhnOGZ0VXRyUXpkWGpudFMxakJEcmdEOFZMYTVhSFY1M0phOHRtNnZQTlMydENIVngzRXBiVVlNM1Z3Tzg0cVd1aERxMUxhMElkVzhGTFhRaDFaanZLbHRhR2JxdjFTMm93WnVxandVdHJTaDFTZWFXdWxtNnBIRXFXMXBRNnFDV3VsbTZyOVZMYTBvZFZsTFdNV2JxazgxTGEwb003aWx0YVVtVTgxRnBEcGh4T0tMU1RNT0NpMGgwM01wYTZVT2xVdHFNVW1WTGEwb01vVVdrT21SYVNaQ1VXa2x4NHFMU1M0Y0VXaU1nQ0ZJTW80SXRKTXJpb3RJTDBXaUxpaTBSY0ZGcEpsQTNJdElNaEtLa3Y1bEFpN2tvdEZpU2lrZ0NRTjZCRjNKRnBKY0J2VVZKZWVDQ1M3NlNpMGt1SlFvSXBGdzRLTFNTU1VVSUJBSUJBSUdDUWdZY09LSlJxb1ljUWlVWWt3UXBRa3hSRkI0UVBNVlVvdzRjVUtNRUhjaUJBdzRvbEdIYzBLTU81RlZGaVZ3M29Vb1N0TzlFcFFjT0JSS01PUEZWS01QUktXMlZ3K0NKU2hLT0twU2hJT2FKU2c3bWlVWWVpVW9TbFZLVUpVS1VKa1NsQ1gxUktVSmlyYWFWTm5TMlp3VzJvOVZiVFN0czRLV3pwVUptcXBTbXpjaWlVdHN4LzJrdE5LMjFKQ3RwcFUyckk0cGFUZzBiV2ZVcmJPaFlyQnhTMDBLRlcwbFcwMHFGUzBuWWxwcFcycDI3Q2xwcFUycWR3S3RwcFcycmNPS1d6cFUyc1BGTFRRdHRhcmFUZ3R0ZHMzcGJNNExiWCtvVnRPV29WNlduTFVLNVcwNWFtMS94UzA1YWhYbm1scHkxQzRjaXJhVHRxRndQTkxUbHJGd1BOTFRscWJjVHoySzJuTFA4Ui9zeFMwNVppNDRwWnl6L0VVczVaaTVGTFRsbitJcFp5eCtJam1scHl4K0lqbWxuTE1YRm80L3dxMmNzL3hKdlA4QWhTemxrYmkzbnRVczVaZmlJNXBaeXgrSWptbHJ5eCtJcFp5MG01SmE4c0c0azdrczVhZnhIK3pGTE9XUHhGTE9XbDF3ZGp2VXRlV2szQTgwdGVXazNBODB0ZVdsMWY2cVdzYmFUWCtxV3ZMUWE0WXBhOHNqWGJGTFhscE5kNnBhOHRMcTcxUzFqQkRxMDgxTFhRaDFaanVPMUxhMElOV1R1VXRyUWsxWk80cGE2VU9xaWQ1UzEwb05VT0oycVd1bEpxZ2xycFFhd0tXdWhKck5pV3VoRHF6MVMxMElkVmVxbHRSaWcxRGlsdGFVR1lxV3VsSm1IRW90SU13UmFTWjFMWFNrenBhNlVHWlMxMHBNM3FsdGFVbVpSYVFaa1drbVlsRm9qSVR2UXBKZjZxTFJGNFJhUzZVRGlpMGd6Y2xGcExwQ2Q2RkpMMGFvaTRvVWt2QTNxTlVreWpnaFNUSVNpcEx1WlFvczNKUmFJa2xGSkFFZ0lFWGNrV2lMdVpSYVNYamdvSk1oUVNYb3RFU1NpakVCQWk3a290SkpKM29vUUNBUUNBUUNBUUNBUUNCNWlpVVljT0tGR0NEdVZRWmlpVW9Qd1FwUWtSRER3VUZCeDRGQ2p6YzFVbzhRaVVFRHhJUU1PNW9sR0hEZ1ZVcFFrY0VGQ1VjVVNsQ1J2QW9VWWVpVW9QVlNqRW1IRkVwUW1kOFVTbENZY1ZTakVvNW9sS0VpSlJoNkZLRWlKUmlVcXBTaE1oU2hNRVNsQ2IxUktXSmlyYWFWQ28ycGJPaFRha3EybWhRcWVhV21reFVOS1dsS0U0VlNsQ2YxUktVSmp2eFN6U29WRGg4RXROS2hWT0N0cHBVMnJJMllwYWFGdHJGYlowS2JXZldscG9VS3djVXMwbjg0MUxUUW9WYlR4VnROSmlxRzRKWnBVS2tjOXFXbWxRcWlkeFMwMG1Lc2o5Sld6U29WYnVhV21sWHpqdWFXbWdDc2Q4VXMwSytkY2xwb0h6cFZzMEQ1MHBab1A1MHBaeXg4OGVPS1duTFY4OGxweXg4OWh1S1djcy9uenpTemxqNTg4MHM1WStmUE5MT1dYejNxbG5MSHp5V3ZMU2E1eVdjc2ZPbExYUVh6cFN6UVBuU2xtZ0d0S2xtaEpyRGlscm9JMWhLV2FFbXJJNHBhNlNOV1R4UzEwcCtidzRxV2FTTlVPYVd1bFB6WVMxMEpOWTNnVXRkQkdzR0NsbWhQemlXdWduVm5JcGE2RUdzMjcwdGRDRFZubXBhNkVtcGNscnBTWjNjVkxYU2t6WWNVdGRKR2NjMFdrbWNJdEpOUUFwWnBTYWxMWFNrMUhxbHJvU1oxTFhRa3plcVcxcFNabEZwSm5DTFNUTVNpMGt5T0tGSkwvVlJhSXZDTFJHUUJDa21ZSXRKTTNJS0xTVE1lYUZKTWlMUkY2TFJGL3FvdEpNalVXa21Ya2hTUzhvcEZ3UmFJdVBCUW9zU1VVa0JtQ0xSWmloU1M3bW9wRi9KQkprOWZxUXBKZHlSYUxFbEZJa0JBRjNKUmFMTVVLSkZDQVFDQVFDQVFDQVFDQVFDQVFDQVFDQjVpaFFEdWFKUmdncW9lSkNCaDZKU2hKL1lVU2xCNDRvS0R1UlFNT1BGVktHWUlVZUlSRFFHWW9sSG1Rb3c5Q2pFanVCVlNsQ1k4VVNqRXJlS0ZLRWc0RkVwUWVxbEdIb1VZbEk0b2xLRXgrS0pTaE1PS3BTaEtPYUpSaVFJbEdIb1VZa1JLTVNubWhSaVZ5cVVvVEZDakU2SlJpY2MwS1VKK1JWdE5LaE9keVdtbFFxQ2xwb1VLazgxYlRRb1ZLV3pwUDVrSlpwTVZEZnBTMDB5ZnpBL3NLcFNoT09CS0pSaWZIaWxsSDEvVkxUU1luT0d3cFpwTVZEdWYycGFhVmZNdlZzMG1LcDZXbWd4VnVHMUxUUWZ6cmtzMEQ1MTNGTE5CL09sTE5BK2NQTkxUUVlyRXMwRDU3RGNyYWFEK2VQRXBab0h6M3FsbWcvbmZYN1VzMEQ1MzErMUxOQStkOWZ0U3pRWHozcWxtZ2ZQRkxOQmZPcFpvSTFoNXFXdWdmT0htbG1nZk9sTFhRWHpya3MwRDUxeVdhQytiS1d1aEpxbmxMTkpHcGZnbHJwSTFEdWYycVdhU001NGxMWFNYWDlVczBwK1k5U2xyUkdjYzBLTDVnS0xSR3Bid1MxMGtha0pacFNhblp2UzEwcE5TY0ZMWFFSbktXdWhKblBOTFhTa3o4eXBhNlVtY0l0RVowS1NaaVVXaU1ydWFGRVpEeEtpMFdkQ2lMK2FMUkdRSVVrekRtaTBremNrV2lNeFVLU1pDZDVSYVNYb3RFWHFMU1RJRVdpTW80SVVreXVSU01oNW9Va3ZVV2htS0ZGaVVVa0JpRUtMTUVXaUxpaFJGdzRsUlNNZ0NDVEtmOXBGcEplU2hSWWtvcEVnSUVYY2xGb0Vrb3BJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFJQkFZa0lIbUtKUjVnaFJnOGxVUE1VU2pFaENGR0pVS1VKQVVRdzhJR0hGVktQTWhSNWdoUXhDSWVKUUdZb2xIbTVvVVlmNnFsS0VqaHVLSlJpWThVU2xDVnZGQ2pFbzVvbEdKUFZDakQxVW94SVVLTVRIbWlVb1RGRW94TnpHeENqRXcrQ3FVWW1ITkNsQ1VIaWlVWWZpaFI1MEtNU1liaWlVWWxkelZLSFdkelJLUHJIa2hSaWM4VUtNVG9sR0p3aFJpb0hOTFRTWXFQVkxOSmlvUE5XMDBtS2c4MHMwbUtncGFhRkNwSTNKYWFCODA3aVVzMEg4MTZsV3pRUG12VXBab1A1c3BhYUI4MlVzMEQ1c3Bab1A1cjFTelFQbXZWTE5CL05CTFRTUG1oeVN6U1BtaHlTelNQbWh5U3pTUnFoOEVzMEQ1cjFTMTBENXIxU3pRWHpaU3pRUG15bG1nalZGTE5BK2E5U2xyb0h6WHFVczBGODA3bXBab0kxQlN6UVJxRDhFdGRCZk1GTFhTUnFNTjVTelNScU1lS2xycFNhZ2MwdGRJTTZGRjEwS0l6bEZvdXNVS0xyTzVvVVJsUE5SYUl5ZXFGRVhvdEF5QkNrbVVjMEtJekRtaTBSbUNMUkdZcUZKTXg1b3RFWlR6UW91b1VXaXpvVVJrdzRxTFNUSzNtaTBSbEhCQ2lNcFJhU1pEelFJditsUmFMTWhSWmlpMFBpZ1dJUUxNRVdobUtGRVg4eW90Skx3Z1JrUUl5SXRKTHloUXpGQ2lKSEZGTE1GRm9zeFFvaVNkNktFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQmlVRHpGRW9aa0tQTUVLTU81RlZLUE1VU2pFaFFveEtpVW9TQW9HSGpnVUREaXFsSG1Rbzh3UW9ZaEVNSGtnTXhRb1ppaVVlZENqem9VWWxQTlZLTVRPUW94TWVJUktNVEJDakVyZWFGS0VnTzRvbEhuVktQT1VTakVwRzVFb3hNZWFXYVIxenpRbyt2OEFCRW94TWhSOVljbFNqNnc0b2xEckJDajZyZWFGR0pRZHlKUTZnUW93L2lFS1BPaFF6b2xEcUlVZlZQTkNoMVR6UW9kVTgwS0hWUE5DaDFqelFvK3M3bXFVT3M3bWlVT3M3bWhRNnp1YUZEckZDaDFuYzBLSFdkelFvZFozTkNoMWp6VVdpNnA1b1VPcWVhRkRxbm1oUTZwNW9VT3FlYUZGMUVLR2RDaG5SYUxPQnZRb3VvRUtIVkFRb3VzT2FMUkdZSVVSbUhCQ2gxaHlVV2lNNkZGMTBLTHJubWkwRE1lYVdhVW1RbENpTW5ORm9qSW90RVpSelFvaksxRm91c0VLTHFsQ2k2cDVvdEo2bnFpMFJmaW9VTXlGRm1LRkRFb3RFVHpRR0lRb3N3UmFHWkNpTGlpMFJjT0pVQ01nQ0NUTHlSYUl5RW9VV1lvVVJQTkZMTUZGb3MzSkNobUtGRmlVVUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQUlCQVlsQTh4UktQTWhRekJWS01PUEFvVVllVVNqRWhRb3hLaFJpVUloaVFGQTg0NW9IbjlWU2p6RkVvWjBLR1lJVWVZSWxBSGtnZUpRR1lvbEhtUW9CK0NGR0pDaFI5VTgxVW94TWVhRkRyRkNqNng1SWxIMXVZUW9kWWNrS1ByQkNqRXplYUpRNm81b1VZa0hOQ2o2aXFVT29sbWsrb1VLSFZjTnlXbWsrczdtVXNvZFozTXBaUTZ6dVpTeWgxbkpacFBydUNXYVIxM2MwczBqcm5taFE2NTVvVU91VXMwbjEwdE5JNjZGRHJwWnBMcm5tbHJRNjU1b1VPdWVhRkRydVN6U1hXS1dhUjFuYzBzMGpyTzVsTEtIV2R6S1dVT3M3bVVzb3VxNUxOSTZoUmFMcUpacEhVUmFJeWptb1VYVkhOQ2k2emVhTFFNd1FvdXNPU0ZGMXVRUW9kWW90RjFuY3doUkdZODBLSFZQTkNpNmhVV2lMMEtHWW9VV1lvVU1TaWxpRUJtQ0xSWmdoUXpJVVJlVUtJdjlWRm9GNCtLQkdRSUVaVUtMcWxGb3VvVUtJdUpRb2lUeFJTekJDaG1VV2l6RkNpeEpSUWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQmlVRHpGQ2htS0pRem9VZVlJVU13NXFwUmgzcWhSNWlpVWZVY2hSOVVvVU9xaFI5VUloaDRRTVBITkE4L3FxbEhtS0ZETWhRem9VTXdRbzh3UW9aZ2lVTVJ6UUdiMVFvOFNoUXpGRW9aaWhSNWloUXpvVWZVUHFoUTZueFFvZFQ0b1VPb1VLSFZLRkFTbm1xVWZWUE5Fb2RVODBLSFdQTkNoMWloUjlZODBLSFdkNklVT3M3MFFvZFozb2hRNnp2UkNoMW5jd2hSZFk4MEtIV0tGRHFubWhRNnA1b1VPcWVhRkYxU290RHFsQ2gxUGloUTZueFFvZFQ0b1VSZVVLR2RDaG1LRkZtS0ZETVVLR0pSYUxONm9VTVFnTXdRb3N3UmFHWUlVTTZGRE1oUlo4TjZGRFA2b1VXY2MxRkxxTlFMcWhBdXFpMFJsS0ZFWGtvVU14UW9pN21VV2lMaHhRb1pnb3RGblFvWmloUXpGQ2l4S0tFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQWdFQmlVRHpGRW9aa0tQTWhRekJDaG45VlVvOC9xaFFEaWhSNXlOeUpSOVJ5RkRxdVFvK3FVS0hXUW8rcU9LSlE2b1FQcU5RSFVDQjlRYzBERW5xcVVNL3FpVU9wOEVLR2RDanpGQ2htS0ZETVVLR2RDaG5Rb1owS0dkQ2huUW9aZ2hRekJDaG1DRkRNRUtHWUlVTXdRb1pnaFF6b1VNNkZET2hRem9VTXlGRE1VS0dZb1VXZkRlaFE2bndRb2RUNElVTS9xaFJkUWMxRm9kUWMwQzZnUUxxaEFkVUlGMVVLQmxLTFJkVW9VT29VS0l2Y1VLR1lvVVdZb3RETjZvVVdiMVFvWmdvdERNRUtMTWhRekZDaGlVVWtBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ0VBZ01TZ01TZ2VZb2xETVVLR1lvVU02RkhtUW9aZ2hRRGdxbERQNm9VWWY2b1VNL3FoUXorcUZEUDZvVU0vcWhSaDVSS0dZb1VNNVFvZFJ5RkRxT1FvK281Q2gxQ2hRNmhRb2RWeUZEcXVRb2RWeUZEcUZDaDFDaFJkUnlGRHFPUW9aM0hlaFF6RkNobUtGQXVLRkZuOVVXaG45VUtHZjFRb1ovVkNobTlVS0xQNm9VTXdVV2htQ0ZETWhSWjBLR1lvVU14UW9aaWhSWWxGR0pRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0F4S0F4S0F4S0F4S0F4S0F4S0F4S0F4S0F4S0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRQ0FRZi9aXCJcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2Fzc2V0cy9pbWcvbG9hZGluZ0xvZ28uanBnXG4vLyBtb2R1bGUgaWQgPSAxNTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIHN1cHBvcnQgPSB7XG4gIHNlYXJjaFBhcmFtczogJ1VSTFNlYXJjaFBhcmFtcycgaW4gc2VsZixcbiAgaXRlcmFibGU6ICdTeW1ib2wnIGluIHNlbGYgJiYgJ2l0ZXJhdG9yJyBpbiBTeW1ib2wsXG4gIGJsb2I6XG4gICAgJ0ZpbGVSZWFkZXInIGluIHNlbGYgJiZcbiAgICAnQmxvYicgaW4gc2VsZiAmJlxuICAgIChmdW5jdGlvbigpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIG5ldyBCbG9iKClcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfSkoKSxcbiAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gc2VsZixcbiAgYXJyYXlCdWZmZXI6ICdBcnJheUJ1ZmZlcicgaW4gc2VsZlxufVxuXG5mdW5jdGlvbiBpc0RhdGFWaWV3KG9iaikge1xuICByZXR1cm4gb2JqICYmIERhdGFWaWV3LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKG9iailcbn1cblxuaWYgKHN1cHBvcnQuYXJyYXlCdWZmZXIpIHtcbiAgdmFyIHZpZXdDbGFzc2VzID0gW1xuICAgICdbb2JqZWN0IEludDhBcnJheV0nLFxuICAgICdbb2JqZWN0IFVpbnQ4QXJyYXldJyxcbiAgICAnW29iamVjdCBVaW50OENsYW1wZWRBcnJheV0nLFxuICAgICdbb2JqZWN0IEludDE2QXJyYXldJyxcbiAgICAnW29iamVjdCBVaW50MTZBcnJheV0nLFxuICAgICdbb2JqZWN0IEludDMyQXJyYXldJyxcbiAgICAnW29iamVjdCBVaW50MzJBcnJheV0nLFxuICAgICdbb2JqZWN0IEZsb2F0MzJBcnJheV0nLFxuICAgICdbb2JqZWN0IEZsb2F0NjRBcnJheV0nXG4gIF1cblxuICB2YXIgaXNBcnJheUJ1ZmZlclZpZXcgPVxuICAgIEFycmF5QnVmZmVyLmlzVmlldyB8fFxuICAgIGZ1bmN0aW9uKG9iaikge1xuICAgICAgcmV0dXJuIG9iaiAmJiB2aWV3Q2xhc3Nlcy5pbmRleE9mKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopKSA+IC0xXG4gICAgfVxufVxuXG5mdW5jdGlvbiBub3JtYWxpemVOYW1lKG5hbWUpIHtcbiAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykge1xuICAgIG5hbWUgPSBTdHJpbmcobmFtZSlcbiAgfVxuICBpZiAoL1teYS16MC05XFwtIyQlJicqKy5eX2B8fl0vaS50ZXN0KG5hbWUpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjaGFyYWN0ZXIgaW4gaGVhZGVyIGZpZWxkIG5hbWUnKVxuICB9XG4gIHJldHVybiBuYW1lLnRvTG93ZXJDYXNlKClcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplVmFsdWUodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICB2YWx1ZSA9IFN0cmluZyh2YWx1ZSlcbiAgfVxuICByZXR1cm4gdmFsdWVcbn1cblxuLy8gQnVpbGQgYSBkZXN0cnVjdGl2ZSBpdGVyYXRvciBmb3IgdGhlIHZhbHVlIGxpc3RcbmZ1bmN0aW9uIGl0ZXJhdG9yRm9yKGl0ZW1zKSB7XG4gIHZhciBpdGVyYXRvciA9IHtcbiAgICBuZXh0OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGl0ZW1zLnNoaWZ0KClcbiAgICAgIHJldHVybiB7ZG9uZTogdmFsdWUgPT09IHVuZGVmaW5lZCwgdmFsdWU6IHZhbHVlfVxuICAgIH1cbiAgfVxuXG4gIGlmIChzdXBwb3J0Lml0ZXJhYmxlKSB7XG4gICAgaXRlcmF0b3JbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGl0ZXJhdG9yXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGl0ZXJhdG9yXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBIZWFkZXJzKGhlYWRlcnMpIHtcbiAgdGhpcy5tYXAgPSB7fVxuXG4gIGlmIChoZWFkZXJzIGluc3RhbmNlb2YgSGVhZGVycykge1xuICAgIGhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpXG4gICAgfSwgdGhpcylcbiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGhlYWRlcnMpKSB7XG4gICAgaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgdGhpcy5hcHBlbmQoaGVhZGVyWzBdLCBoZWFkZXJbMV0pXG4gICAgfSwgdGhpcylcbiAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoaGVhZGVycykuZm9yRWFjaChmdW5jdGlvbihuYW1lKSB7XG4gICAgICB0aGlzLmFwcGVuZChuYW1lLCBoZWFkZXJzW25hbWVdKVxuICAgIH0sIHRoaXMpXG4gIH1cbn1cblxuSGVhZGVycy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgbmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSlcbiAgdmFsdWUgPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSlcbiAgdmFyIG9sZFZhbHVlID0gdGhpcy5tYXBbbmFtZV1cbiAgdGhpcy5tYXBbbmFtZV0gPSBvbGRWYWx1ZSA/IG9sZFZhbHVlICsgJywgJyArIHZhbHVlIDogdmFsdWVcbn1cblxuSGVhZGVycy5wcm90b3R5cGVbJ2RlbGV0ZSddID0gZnVuY3Rpb24obmFtZSkge1xuICBkZWxldGUgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV1cbn1cblxuSGVhZGVycy5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24obmFtZSkge1xuICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICByZXR1cm4gdGhpcy5oYXMobmFtZSkgPyB0aGlzLm1hcFtuYW1lXSA6IG51bGxcbn1cblxuSGVhZGVycy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24obmFtZSkge1xuICByZXR1cm4gdGhpcy5tYXAuaGFzT3duUHJvcGVydHkobm9ybWFsaXplTmFtZShuYW1lKSlcbn1cblxuSGVhZGVycy5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgdGhpcy5tYXBbbm9ybWFsaXplTmFtZShuYW1lKV0gPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSlcbn1cblxuSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uKGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gIGZvciAodmFyIG5hbWUgaW4gdGhpcy5tYXApIHtcbiAgICBpZiAodGhpcy5tYXAuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdGhpcy5tYXBbbmFtZV0sIG5hbWUsIHRoaXMpXG4gICAgfVxuICB9XG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmtleXMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGl0ZW1zID0gW11cbiAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgaXRlbXMucHVzaChuYW1lKVxuICB9KVxuICByZXR1cm4gaXRlcmF0b3JGb3IoaXRlbXMpXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLnZhbHVlcyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaXRlbXMgPSBbXVxuICB0aGlzLmZvckVhY2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpdGVtcy5wdXNoKHZhbHVlKVxuICB9KVxuICByZXR1cm4gaXRlcmF0b3JGb3IoaXRlbXMpXG59XG5cbkhlYWRlcnMucHJvdG90eXBlLmVudHJpZXMgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGl0ZW1zID0gW11cbiAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgaXRlbXMucHVzaChbbmFtZSwgdmFsdWVdKVxuICB9KVxuICByZXR1cm4gaXRlcmF0b3JGb3IoaXRlbXMpXG59XG5cbmlmIChzdXBwb3J0Lml0ZXJhYmxlKSB7XG4gIEhlYWRlcnMucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl0gPSBIZWFkZXJzLnByb3RvdHlwZS5lbnRyaWVzXG59XG5cbmZ1bmN0aW9uIGNvbnN1bWVkKGJvZHkpIHtcbiAgaWYgKGJvZHkuYm9keVVzZWQpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gIH1cbiAgYm9keS5ib2R5VXNlZCA9IHRydWVcbn1cblxuZnVuY3Rpb24gZmlsZVJlYWRlclJlYWR5KHJlYWRlcikge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmVzb2x2ZShyZWFkZXIucmVzdWx0KVxuICAgIH1cbiAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmVqZWN0KHJlYWRlci5lcnJvcilcbiAgICB9XG4gIH0pXG59XG5cbmZ1bmN0aW9uIHJlYWRCbG9iQXNBcnJheUJ1ZmZlcihibG9iKSB7XG4gIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gIHZhciBwcm9taXNlID0gZmlsZVJlYWRlclJlYWR5KHJlYWRlcilcbiAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGJsb2IpXG4gIHJldHVybiBwcm9taXNlXG59XG5cbmZ1bmN0aW9uIHJlYWRCbG9iQXNUZXh0KGJsb2IpIHtcbiAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgdmFyIHByb21pc2UgPSBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICByZWFkZXIucmVhZEFzVGV4dChibG9iKVxuICByZXR1cm4gcHJvbWlzZVxufVxuXG5mdW5jdGlvbiByZWFkQXJyYXlCdWZmZXJBc1RleHQoYnVmKSB7XG4gIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKVxuICB2YXIgY2hhcnMgPSBuZXcgQXJyYXkodmlldy5sZW5ndGgpXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB2aWV3Lmxlbmd0aDsgaSsrKSB7XG4gICAgY2hhcnNbaV0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHZpZXdbaV0pXG4gIH1cbiAgcmV0dXJuIGNoYXJzLmpvaW4oJycpXG59XG5cbmZ1bmN0aW9uIGJ1ZmZlckNsb25lKGJ1Zikge1xuICBpZiAoYnVmLnNsaWNlKSB7XG4gICAgcmV0dXJuIGJ1Zi5zbGljZSgwKVxuICB9IGVsc2Uge1xuICAgIHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmLmJ5dGVMZW5ndGgpXG4gICAgdmlldy5zZXQobmV3IFVpbnQ4QXJyYXkoYnVmKSlcbiAgICByZXR1cm4gdmlldy5idWZmZXJcbiAgfVxufVxuXG5mdW5jdGlvbiBCb2R5KCkge1xuICB0aGlzLmJvZHlVc2VkID0gZmFsc2VcblxuICB0aGlzLl9pbml0Qm9keSA9IGZ1bmN0aW9uKGJvZHkpIHtcbiAgICB0aGlzLl9ib2R5SW5pdCA9IGJvZHlcbiAgICBpZiAoIWJvZHkpIHtcbiAgICAgIHRoaXMuX2JvZHlUZXh0ID0gJydcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBib2R5ID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5XG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgdGhpcy5fYm9keUJsb2IgPSBib2R5XG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmZvcm1EYXRhICYmIEZvcm1EYXRhLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5XG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LnNlYXJjaFBhcmFtcyAmJiBVUkxTZWFyY2hQYXJhbXMucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkpIHtcbiAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keS50b1N0cmluZygpXG4gICAgfSBlbHNlIGlmIChzdXBwb3J0LmFycmF5QnVmZmVyICYmIHN1cHBvcnQuYmxvYiAmJiBpc0RhdGFWaWV3KGJvZHkpKSB7XG4gICAgICB0aGlzLl9ib2R5QXJyYXlCdWZmZXIgPSBidWZmZXJDbG9uZShib2R5LmJ1ZmZlcilcbiAgICAgIC8vIElFIDEwLTExIGNhbid0IGhhbmRsZSBhIERhdGFWaWV3IGJvZHkuXG4gICAgICB0aGlzLl9ib2R5SW5pdCA9IG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKVxuICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlciAmJiAoQXJyYXlCdWZmZXIucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYm9keSkgfHwgaXNBcnJheUJ1ZmZlclZpZXcoYm9keSkpKSB7XG4gICAgICB0aGlzLl9ib2R5QXJyYXlCdWZmZXIgPSBidWZmZXJDbG9uZShib2R5KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9ib2R5VGV4dCA9IGJvZHkgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYm9keSlcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaGVhZGVycy5nZXQoJ2NvbnRlbnQtdHlwZScpKSB7XG4gICAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsICd0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgnKVxuICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5QmxvYiAmJiB0aGlzLl9ib2R5QmxvYi50eXBlKSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoJ2NvbnRlbnQtdHlwZScsIHRoaXMuX2JvZHlCbG9iLnR5cGUpXG4gICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuc2VhcmNoUGFyYW1zICYmIFVSTFNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KCdjb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9VVRGLTgnKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGlmIChzdXBwb3J0LmJsb2IpIHtcbiAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICBpZiAocmVqZWN0ZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlCbG9iKVxuICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgQmxvYihbdGhpcy5fYm9keUFycmF5QnVmZmVyXSkpXG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgYmxvYicpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5VGV4dF0pKVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuYXJyYXlCdWZmZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpIHtcbiAgICAgICAgcmV0dXJuIGNvbnN1bWVkKHRoaXMpIHx8IFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5ibG9iKCkudGhlbihyZWFkQmxvYkFzQXJyYXlCdWZmZXIpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdGhpcy50ZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICBpZiAocmVqZWN0ZWQpIHtcbiAgICAgIHJldHVybiByZWplY3RlZFxuICAgIH1cblxuICAgIGlmICh0aGlzLl9ib2R5QmxvYikge1xuICAgICAgcmV0dXJuIHJlYWRCbG9iQXNUZXh0KHRoaXMuX2JvZHlCbG9iKVxuICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlYWRBcnJheUJ1ZmZlckFzVGV4dCh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpKVxuICAgIH0gZWxzZSBpZiAodGhpcy5fYm9keUZvcm1EYXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgdGV4dCcpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpXG4gICAgfVxuICB9XG5cbiAgaWYgKHN1cHBvcnQuZm9ybURhdGEpIHtcbiAgICB0aGlzLmZvcm1EYXRhID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihkZWNvZGUpXG4gICAgfVxuICB9XG5cbiAgdGhpcy5qc29uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMudGV4dCgpLnRoZW4oSlNPTi5wYXJzZSlcbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8vIEhUVFAgbWV0aG9kcyB3aG9zZSBjYXBpdGFsaXphdGlvbiBzaG91bGQgYmUgbm9ybWFsaXplZFxudmFyIG1ldGhvZHMgPSBbJ0RFTEVURScsICdHRVQnLCAnSEVBRCcsICdPUFRJT05TJywgJ1BPU1QnLCAnUFVUJ11cblxuZnVuY3Rpb24gbm9ybWFsaXplTWV0aG9kKG1ldGhvZCkge1xuICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gIHJldHVybiBtZXRob2RzLmluZGV4T2YodXBjYXNlZCkgPiAtMSA/IHVwY2FzZWQgOiBtZXRob2Rcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFJlcXVlc3QoaW5wdXQsIG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgdmFyIGJvZHkgPSBvcHRpb25zLmJvZHlcblxuICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBSZXF1ZXN0KSB7XG4gICAgaWYgKGlucHV0LmJvZHlVc2VkKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBbHJlYWR5IHJlYWQnKVxuICAgIH1cbiAgICB0aGlzLnVybCA9IGlucHV0LnVybFxuICAgIHRoaXMuY3JlZGVudGlhbHMgPSBpbnB1dC5jcmVkZW50aWFsc1xuICAgIGlmICghb3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhpbnB1dC5oZWFkZXJzKVxuICAgIH1cbiAgICB0aGlzLm1ldGhvZCA9IGlucHV0Lm1ldGhvZFxuICAgIHRoaXMubW9kZSA9IGlucHV0Lm1vZGVcbiAgICB0aGlzLnNpZ25hbCA9IGlucHV0LnNpZ25hbFxuICAgIGlmICghYm9keSAmJiBpbnB1dC5fYm9keUluaXQgIT0gbnVsbCkge1xuICAgICAgYm9keSA9IGlucHV0Ll9ib2R5SW5pdFxuICAgICAgaW5wdXQuYm9keVVzZWQgPSB0cnVlXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHRoaXMudXJsID0gU3RyaW5nKGlucHV0KVxuICB9XG5cbiAgdGhpcy5jcmVkZW50aWFscyA9IG9wdGlvbnMuY3JlZGVudGlhbHMgfHwgdGhpcy5jcmVkZW50aWFscyB8fCAnc2FtZS1vcmlnaW4nXG4gIGlmIChvcHRpb25zLmhlYWRlcnMgfHwgIXRoaXMuaGVhZGVycykge1xuICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycylcbiAgfVxuICB0aGlzLm1ldGhvZCA9IG5vcm1hbGl6ZU1ldGhvZChvcHRpb25zLm1ldGhvZCB8fCB0aGlzLm1ldGhvZCB8fCAnR0VUJylcbiAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IHRoaXMubW9kZSB8fCBudWxsXG4gIHRoaXMuc2lnbmFsID0gb3B0aW9ucy5zaWduYWwgfHwgdGhpcy5zaWduYWxcbiAgdGhpcy5yZWZlcnJlciA9IG51bGxcblxuICBpZiAoKHRoaXMubWV0aG9kID09PSAnR0VUJyB8fCB0aGlzLm1ldGhvZCA9PT0gJ0hFQUQnKSAmJiBib2R5KSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQm9keSBub3QgYWxsb3dlZCBmb3IgR0VUIG9yIEhFQUQgcmVxdWVzdHMnKVxuICB9XG4gIHRoaXMuX2luaXRCb2R5KGJvZHkpXG59XG5cblJlcXVlc3QucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgUmVxdWVzdCh0aGlzLCB7Ym9keTogdGhpcy5fYm9keUluaXR9KVxufVxuXG5mdW5jdGlvbiBkZWNvZGUoYm9keSkge1xuICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpXG4gIGJvZHlcbiAgICAudHJpbSgpXG4gICAgLnNwbGl0KCcmJylcbiAgICAuZm9yRWFjaChmdW5jdGlvbihieXRlcykge1xuICAgICAgaWYgKGJ5dGVzKSB7XG4gICAgICAgIHZhciBzcGxpdCA9IGJ5dGVzLnNwbGl0KCc9JylcbiAgICAgICAgdmFyIG5hbWUgPSBzcGxpdC5zaGlmdCgpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIHZhciB2YWx1ZSA9IHNwbGl0LmpvaW4oJz0nKS5yZXBsYWNlKC9cXCsvZywgJyAnKVxuICAgICAgICBmb3JtLmFwcGVuZChkZWNvZGVVUklDb21wb25lbnQobmFtZSksIGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpXG4gICAgICB9XG4gICAgfSlcbiAgcmV0dXJuIGZvcm1cbn1cblxuZnVuY3Rpb24gcGFyc2VIZWFkZXJzKHJhd0hlYWRlcnMpIHtcbiAgdmFyIGhlYWRlcnMgPSBuZXcgSGVhZGVycygpXG4gIC8vIFJlcGxhY2UgaW5zdGFuY2VzIG9mIFxcclxcbiBhbmQgXFxuIGZvbGxvd2VkIGJ5IGF0IGxlYXN0IG9uZSBzcGFjZSBvciBob3Jpem9udGFsIHRhYiB3aXRoIGEgc3BhY2VcbiAgLy8gaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzcyMzAjc2VjdGlvbi0zLjJcbiAgdmFyIHByZVByb2Nlc3NlZEhlYWRlcnMgPSByYXdIZWFkZXJzLnJlcGxhY2UoL1xccj9cXG5bXFx0IF0rL2csICcgJylcbiAgcHJlUHJvY2Vzc2VkSGVhZGVycy5zcGxpdCgvXFxyP1xcbi8pLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgIHZhciBwYXJ0cyA9IGxpbmUuc3BsaXQoJzonKVxuICAgIHZhciBrZXkgPSBwYXJ0cy5zaGlmdCgpLnRyaW0oKVxuICAgIGlmIChrZXkpIHtcbiAgICAgIHZhciB2YWx1ZSA9IHBhcnRzLmpvaW4oJzonKS50cmltKClcbiAgICAgIGhlYWRlcnMuYXBwZW5kKGtleSwgdmFsdWUpXG4gICAgfVxuICB9KVxuICByZXR1cm4gaGVhZGVyc1xufVxuXG5Cb2R5LmNhbGwoUmVxdWVzdC5wcm90b3R5cGUpXG5cbmV4cG9ydCBmdW5jdGlvbiBSZXNwb25zZShib2R5SW5pdCwgb3B0aW9ucykge1xuICBpZiAoIW9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0ge31cbiAgfVxuXG4gIHRoaXMudHlwZSA9ICdkZWZhdWx0J1xuICB0aGlzLnN0YXR1cyA9IG9wdGlvbnMuc3RhdHVzID09PSB1bmRlZmluZWQgPyAyMDAgOiBvcHRpb25zLnN0YXR1c1xuICB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwXG4gIHRoaXMuc3RhdHVzVGV4dCA9ICdzdGF0dXNUZXh0JyBpbiBvcHRpb25zID8gb3B0aW9ucy5zdGF0dXNUZXh0IDogJ09LJ1xuICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgdGhpcy5faW5pdEJvZHkoYm9keUluaXQpXG59XG5cbkJvZHkuY2FsbChSZXNwb25zZS5wcm90b3R5cGUpXG5cblJlc3BvbnNlLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFJlc3BvbnNlKHRoaXMuX2JvZHlJbml0LCB7XG4gICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcbiAgICBzdGF0dXNUZXh0OiB0aGlzLnN0YXR1c1RleHQsXG4gICAgaGVhZGVyczogbmV3IEhlYWRlcnModGhpcy5oZWFkZXJzKSxcbiAgICB1cmw6IHRoaXMudXJsXG4gIH0pXG59XG5cblJlc3BvbnNlLmVycm9yID0gZnVuY3Rpb24oKSB7XG4gIHZhciByZXNwb25zZSA9IG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiAwLCBzdGF0dXNUZXh0OiAnJ30pXG4gIHJlc3BvbnNlLnR5cGUgPSAnZXJyb3InXG4gIHJldHVybiByZXNwb25zZVxufVxuXG52YXIgcmVkaXJlY3RTdGF0dXNlcyA9IFszMDEsIDMwMiwgMzAzLCAzMDcsIDMwOF1cblxuUmVzcG9uc2UucmVkaXJlY3QgPSBmdW5jdGlvbih1cmwsIHN0YXR1cykge1xuICBpZiAocmVkaXJlY3RTdGF0dXNlcy5pbmRleE9mKHN0YXR1cykgPT09IC0xKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgc3RhdHVzIGNvZGUnKVxuICB9XG5cbiAgcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7c3RhdHVzOiBzdGF0dXMsIGhlYWRlcnM6IHtsb2NhdGlvbjogdXJsfX0pXG59XG5cbmV4cG9ydCB2YXIgRE9NRXhjZXB0aW9uID0gc2VsZi5ET01FeGNlcHRpb25cbnRyeSB7XG4gIG5ldyBET01FeGNlcHRpb24oKVxufSBjYXRjaCAoZXJyKSB7XG4gIERPTUV4Y2VwdGlvbiA9IGZ1bmN0aW9uKG1lc3NhZ2UsIG5hbWUpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlXG4gICAgdGhpcy5uYW1lID0gbmFtZVxuICAgIHZhciBlcnJvciA9IEVycm9yKG1lc3NhZ2UpXG4gICAgdGhpcy5zdGFjayA9IGVycm9yLnN0YWNrXG4gIH1cbiAgRE9NRXhjZXB0aW9uLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKVxuICBET01FeGNlcHRpb24ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRE9NRXhjZXB0aW9uXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmZXRjaChpbnB1dCwgaW5pdCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIHJlcXVlc3QgPSBuZXcgUmVxdWVzdChpbnB1dCwgaW5pdClcblxuICAgIGlmIChyZXF1ZXN0LnNpZ25hbCAmJiByZXF1ZXN0LnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICByZXR1cm4gcmVqZWN0KG5ldyBET01FeGNlcHRpb24oJ0Fib3J0ZWQnLCAnQWJvcnRFcnJvcicpKVxuICAgIH1cblxuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKVxuXG4gICAgZnVuY3Rpb24gYWJvcnRYaHIoKSB7XG4gICAgICB4aHIuYWJvcnQoKVxuICAgIH1cblxuICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBzdGF0dXM6IHhoci5zdGF0dXMsXG4gICAgICAgIHN0YXR1c1RleHQ6IHhoci5zdGF0dXNUZXh0LFxuICAgICAgICBoZWFkZXJzOiBwYXJzZUhlYWRlcnMoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpIHx8ICcnKVxuICAgICAgfVxuICAgICAgb3B0aW9ucy51cmwgPSAncmVzcG9uc2VVUkwnIGluIHhociA/IHhoci5yZXNwb25zZVVSTCA6IG9wdGlvbnMuaGVhZGVycy5nZXQoJ1gtUmVxdWVzdC1VUkwnKVxuICAgICAgdmFyIGJvZHkgPSAncmVzcG9uc2UnIGluIHhociA/IHhoci5yZXNwb25zZSA6IHhoci5yZXNwb25zZVRleHRcbiAgICAgIHJlc29sdmUobmV3IFJlc3BvbnNlKGJvZHksIG9wdGlvbnMpKVxuICAgIH1cblxuICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgIH1cblxuICAgIHhoci5vbnRpbWVvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJlamVjdChuZXcgVHlwZUVycm9yKCdOZXR3b3JrIHJlcXVlc3QgZmFpbGVkJykpXG4gICAgfVxuXG4gICAgeGhyLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJlamVjdChuZXcgRE9NRXhjZXB0aW9uKCdBYm9ydGVkJywgJ0Fib3J0RXJyb3InKSlcbiAgICB9XG5cbiAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC51cmwsIHRydWUpXG5cbiAgICBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ2luY2x1ZGUnKSB7XG4gICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZVxuICAgIH0gZWxzZSBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ29taXQnKSB7XG4gICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoJ3Jlc3BvbnNlVHlwZScgaW4geGhyICYmIHN1cHBvcnQuYmxvYikge1xuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJ1xuICAgIH1cblxuICAgIHJlcXVlc3QuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBuYW1lKSB7XG4gICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCB2YWx1ZSlcbiAgICB9KVxuXG4gICAgaWYgKHJlcXVlc3Quc2lnbmFsKSB7XG4gICAgICByZXF1ZXN0LnNpZ25hbC5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsIGFib3J0WGhyKVxuXG4gICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIERPTkUgKHN1Y2Nlc3Mgb3IgZmFpbHVyZSlcbiAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG4gICAgICAgICAgcmVxdWVzdC5zaWduYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBhYm9ydFhocilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHhoci5zZW5kKHR5cGVvZiByZXF1ZXN0Ll9ib2R5SW5pdCA9PT0gJ3VuZGVmaW5lZCcgPyBudWxsIDogcmVxdWVzdC5fYm9keUluaXQpXG4gIH0pXG59XG5cbmZldGNoLnBvbHlmaWxsID0gdHJ1ZVxuXG5pZiAoIXNlbGYuZmV0Y2gpIHtcbiAgc2VsZi5mZXRjaCA9IGZldGNoXG4gIHNlbGYuSGVhZGVycyA9IEhlYWRlcnNcbiAgc2VsZi5SZXF1ZXN0ID0gUmVxdWVzdFxuICBzZWxmLlJlc3BvbnNlID0gUmVzcG9uc2Vcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi93aGF0d2ctZmV0Y2gvZmV0Y2guanNcbi8vIG1vZHVsZSBpZCA9IDE1MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9